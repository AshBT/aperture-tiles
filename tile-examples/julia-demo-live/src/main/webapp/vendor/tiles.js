!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.tiles=e()}}(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/*
 * Copyright (c) 2014 Oculus Info Inc.
 * http://www.oculusinfo.com/
 * 
 * Released under the MIT License.
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

( function() {

    "use strict";

    module.exports = {

        // Binning
        AreaOfInterestTilePyramid: require('./binning/AreaOfInterestTilePyramid'),
        TileIterator: require('./binning/TileIterator'),
        WebMercatorTilePyramid: require('./binning/WebMercatorTilePyramid'),

        // Layer
        AnnotationLayer: require('./layer/AnnotationLayer'),
        BaseLayer: require('./layer/BaseLayer'),
        ServerLayer: require('./layer/ServerLayer'),
        ClientLayer: require('./layer/ClientLayer'),
        LayerUtil: require('./layer/LayerUtil'),

        // Renderers
        GraphLabelRenderer: require('./layer/renderer/GraphLabelRenderer'),
        GraphNodeRenderer: require('./layer/renderer/GraphNodeRenderer'),
        PointAggregateRenderer: require('./layer/renderer/PointAggregateRenderer'),
        PointRenderer: require('./layer/renderer/PointRenderer'),
        TextByFrequencyRenderer: require('./layer/renderer/TextByFrequencyRenderer'),
        TextScoreRenderer: require('./layer/renderer/TextScoreRenderer'),
        WordCloudRenderer: require('./layer/renderer/WordCloudRenderer'),
        RenderTheme: require('./layer/renderer/RenderTheme'),

        // Map
        Map: require('./map/Map'),
        MapUtil: require('./map/MapUtil'),
        Axis: require('./map/Axis'),
        AxisUtil: require('./map/AxisUtil'),

        // REST
        AnnotationService: require('./rest/AnnotationService'),
        LayerService: require('./rest/LayerService'),
        LegendService: require('./rest/LegendService'),
        TileService: require('./rest/TileService'),

        // UI
        OverlayButton: require('./ui/OverlayButton'),

        // Util
        PubSub: require('./util/PubSub'),
        Util: require('./util/Util')
    };

}());

},{"./binning/AreaOfInterestTilePyramid":4,"./binning/TileIterator":5,"./binning/WebMercatorTilePyramid":6,"./layer/AnnotationLayer":7,"./layer/BaseLayer":8,"./layer/ClientLayer":9,"./layer/LayerUtil":13,"./layer/ServerLayer":14,"./layer/renderer/GraphLabelRenderer":15,"./layer/renderer/GraphNodeRenderer":16,"./layer/renderer/PointAggregateRenderer":17,"./layer/renderer/PointRenderer":18,"./layer/renderer/RenderTheme":19,"./layer/renderer/TextByFrequencyRenderer":22,"./layer/renderer/TextScoreRenderer":23,"./layer/renderer/WordCloudRenderer":24,"./map/Axis":25,"./map/AxisUtil":26,"./map/Map":27,"./map/MapUtil":28,"./rest/AnnotationService":30,"./rest/LayerService":31,"./rest/LegendService":32,"./rest/TileService":33,"./ui/OverlayButton":34,"./util/PubSub":35,"./util/Util":36}],2:[function(require,module,exports){
/*!
 * jQuery JavaScript Library v2.1.1
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2005, 2014 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2014-05-01T17:11Z
 */

(function( global, factory ) {

	if ( typeof module === "object" && typeof module.exports === "object" ) {
		// For CommonJS and CommonJS-like environments where a proper window is present,
		// execute the factory and get jQuery
		// For environments that do not inherently posses a window with a document
		// (such as Node.js), expose a jQuery-making factory as module.exports
		// This accentuates the need for the creation of a real window
		// e.g. var jQuery = require("jquery")(window);
		// See ticket #14549 for more info
		module.exports = global.document ?
			factory( global, true ) :
			function( w ) {
				if ( !w.document ) {
					throw new Error( "jQuery requires a window with a document" );
				}
				return factory( w );
			};
	} else {
		factory( global );
	}

// Pass this if window is not defined yet
}(typeof window !== "undefined" ? window : this, function( window, noGlobal ) {

// Can't do this because several apps including ASP.NET trace
// the stack via arguments.caller.callee and Firefox dies if
// you try to trace through "use strict" call chains. (#13335)
// Support: Firefox 18+
//

var arr = [];

var slice = arr.slice;

var concat = arr.concat;

var push = arr.push;

var indexOf = arr.indexOf;

var class2type = {};

var toString = class2type.toString;

var hasOwn = class2type.hasOwnProperty;

var support = {};



var
	// Use the correct document accordingly with window argument (sandbox)
	document = window.document,

	version = "2.1.1",

	// Define a local copy of jQuery
	jQuery = function( selector, context ) {
		// The jQuery object is actually just the init constructor 'enhanced'
		// Need init if jQuery is called (just allow error to be thrown if not included)
		return new jQuery.fn.init( selector, context );
	},

	// Support: Android<4.1
	// Make sure we trim BOM and NBSP
	rtrim = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,

	// Matches dashed string for camelizing
	rmsPrefix = /^-ms-/,
	rdashAlpha = /-([\da-z])/gi,

	// Used by jQuery.camelCase as callback to replace()
	fcamelCase = function( all, letter ) {
		return letter.toUpperCase();
	};

jQuery.fn = jQuery.prototype = {
	// The current version of jQuery being used
	jquery: version,

	constructor: jQuery,

	// Start with an empty selector
	selector: "",

	// The default length of a jQuery object is 0
	length: 0,

	toArray: function() {
		return slice.call( this );
	},

	// Get the Nth element in the matched element set OR
	// Get the whole matched element set as a clean array
	get: function( num ) {
		return num != null ?

			// Return just the one element from the set
			( num < 0 ? this[ num + this.length ] : this[ num ] ) :

			// Return all the elements in a clean array
			slice.call( this );
	},

	// Take an array of elements and push it onto the stack
	// (returning the new matched element set)
	pushStack: function( elems ) {

		// Build a new jQuery matched element set
		var ret = jQuery.merge( this.constructor(), elems );

		// Add the old object onto the stack (as a reference)
		ret.prevObject = this;
		ret.context = this.context;

		// Return the newly-formed element set
		return ret;
	},

	// Execute a callback for every element in the matched set.
	// (You can seed the arguments with an array of args, but this is
	// only used internally.)
	each: function( callback, args ) {
		return jQuery.each( this, callback, args );
	},

	map: function( callback ) {
		return this.pushStack( jQuery.map(this, function( elem, i ) {
			return callback.call( elem, i, elem );
		}));
	},

	slice: function() {
		return this.pushStack( slice.apply( this, arguments ) );
	},

	first: function() {
		return this.eq( 0 );
	},

	last: function() {
		return this.eq( -1 );
	},

	eq: function( i ) {
		var len = this.length,
			j = +i + ( i < 0 ? len : 0 );
		return this.pushStack( j >= 0 && j < len ? [ this[j] ] : [] );
	},

	end: function() {
		return this.prevObject || this.constructor(null);
	},

	// For internal use only.
	// Behaves like an Array's method, not like a jQuery method.
	push: push,
	sort: arr.sort,
	splice: arr.splice
};

jQuery.extend = jQuery.fn.extend = function() {
	var options, name, src, copy, copyIsArray, clone,
		target = arguments[0] || {},
		i = 1,
		length = arguments.length,
		deep = false;

	// Handle a deep copy situation
	if ( typeof target === "boolean" ) {
		deep = target;

		// skip the boolean and the target
		target = arguments[ i ] || {};
		i++;
	}

	// Handle case when target is a string or something (possible in deep copy)
	if ( typeof target !== "object" && !jQuery.isFunction(target) ) {
		target = {};
	}

	// extend jQuery itself if only one argument is passed
	if ( i === length ) {
		target = this;
		i--;
	}

	for ( ; i < length; i++ ) {
		// Only deal with non-null/undefined values
		if ( (options = arguments[ i ]) != null ) {
			// Extend the base object
			for ( name in options ) {
				src = target[ name ];
				copy = options[ name ];

				// Prevent never-ending loop
				if ( target === copy ) {
					continue;
				}

				// Recurse if we're merging plain objects or arrays
				if ( deep && copy && ( jQuery.isPlainObject(copy) || (copyIsArray = jQuery.isArray(copy)) ) ) {
					if ( copyIsArray ) {
						copyIsArray = false;
						clone = src && jQuery.isArray(src) ? src : [];

					} else {
						clone = src && jQuery.isPlainObject(src) ? src : {};
					}

					// Never move original objects, clone them
					target[ name ] = jQuery.extend( deep, clone, copy );

				// Don't bring in undefined values
				} else if ( copy !== undefined ) {
					target[ name ] = copy;
				}
			}
		}
	}

	// Return the modified object
	return target;
};

jQuery.extend({
	// Unique for each copy of jQuery on the page
	expando: "jQuery" + ( version + Math.random() ).replace( /\D/g, "" ),

	// Assume jQuery is ready without the ready module
	isReady: true,

	error: function( msg ) {
		throw new Error( msg );
	},

	noop: function() {},

	// See test/unit/core.js for details concerning isFunction.
	// Since version 1.3, DOM methods and functions like alert
	// aren't supported. They return false on IE (#2968).
	isFunction: function( obj ) {
		return jQuery.type(obj) === "function";
	},

	isArray: Array.isArray,

	isWindow: function( obj ) {
		return obj != null && obj === obj.window;
	},

	isNumeric: function( obj ) {
		// parseFloat NaNs numeric-cast false positives (null|true|false|"")
		// ...but misinterprets leading-number strings, particularly hex literals ("0x...")
		// subtraction forces infinities to NaN
		return !jQuery.isArray( obj ) && obj - parseFloat( obj ) >= 0;
	},

	isPlainObject: function( obj ) {
		// Not plain objects:
		// - Any object or value whose internal [[Class]] property is not "[object Object]"
		// - DOM nodes
		// - window
		if ( jQuery.type( obj ) !== "object" || obj.nodeType || jQuery.isWindow( obj ) ) {
			return false;
		}

		if ( obj.constructor &&
				!hasOwn.call( obj.constructor.prototype, "isPrototypeOf" ) ) {
			return false;
		}

		// If the function hasn't returned already, we're confident that
		// |obj| is a plain object, created by {} or constructed with new Object
		return true;
	},

	isEmptyObject: function( obj ) {
		var name;
		for ( name in obj ) {
			return false;
		}
		return true;
	},

	type: function( obj ) {
		if ( obj == null ) {
			return obj + "";
		}
		// Support: Android < 4.0, iOS < 6 (functionish RegExp)
		return typeof obj === "object" || typeof obj === "function" ?
			class2type[ toString.call(obj) ] || "object" :
			typeof obj;
	},

	// Evaluates a script in a global context
	globalEval: function( code ) {
		var script,
			indirect = eval;

		code = jQuery.trim( code );

		if ( code ) {
			// If the code includes a valid, prologue position
			// strict mode pragma, execute code by injecting a
			// script tag into the document.
			if ( code.indexOf("use strict") === 1 ) {
				script = document.createElement("script");
				script.text = code;
				document.head.appendChild( script ).parentNode.removeChild( script );
			} else {
			// Otherwise, avoid the DOM node creation, insertion
			// and removal by using an indirect global eval
				indirect( code );
			}
		}
	},

	// Convert dashed to camelCase; used by the css and data modules
	// Microsoft forgot to hump their vendor prefix (#9572)
	camelCase: function( string ) {
		return string.replace( rmsPrefix, "ms-" ).replace( rdashAlpha, fcamelCase );
	},

	nodeName: function( elem, name ) {
		return elem.nodeName && elem.nodeName.toLowerCase() === name.toLowerCase();
	},

	// args is for internal usage only
	each: function( obj, callback, args ) {
		var value,
			i = 0,
			length = obj.length,
			isArray = isArraylike( obj );

		if ( args ) {
			if ( isArray ) {
				for ( ; i < length; i++ ) {
					value = callback.apply( obj[ i ], args );

					if ( value === false ) {
						break;
					}
				}
			} else {
				for ( i in obj ) {
					value = callback.apply( obj[ i ], args );

					if ( value === false ) {
						break;
					}
				}
			}

		// A special, fast, case for the most common use of each
		} else {
			if ( isArray ) {
				for ( ; i < length; i++ ) {
					value = callback.call( obj[ i ], i, obj[ i ] );

					if ( value === false ) {
						break;
					}
				}
			} else {
				for ( i in obj ) {
					value = callback.call( obj[ i ], i, obj[ i ] );

					if ( value === false ) {
						break;
					}
				}
			}
		}

		return obj;
	},

	// Support: Android<4.1
	trim: function( text ) {
		return text == null ?
			"" :
			( text + "" ).replace( rtrim, "" );
	},

	// results is for internal usage only
	makeArray: function( arr, results ) {
		var ret = results || [];

		if ( arr != null ) {
			if ( isArraylike( Object(arr) ) ) {
				jQuery.merge( ret,
					typeof arr === "string" ?
					[ arr ] : arr
				);
			} else {
				push.call( ret, arr );
			}
		}

		return ret;
	},

	inArray: function( elem, arr, i ) {
		return arr == null ? -1 : indexOf.call( arr, elem, i );
	},

	merge: function( first, second ) {
		var len = +second.length,
			j = 0,
			i = first.length;

		for ( ; j < len; j++ ) {
			first[ i++ ] = second[ j ];
		}

		first.length = i;

		return first;
	},

	grep: function( elems, callback, invert ) {
		var callbackInverse,
			matches = [],
			i = 0,
			length = elems.length,
			callbackExpect = !invert;

		// Go through the array, only saving the items
		// that pass the validator function
		for ( ; i < length; i++ ) {
			callbackInverse = !callback( elems[ i ], i );
			if ( callbackInverse !== callbackExpect ) {
				matches.push( elems[ i ] );
			}
		}

		return matches;
	},

	// arg is for internal usage only
	map: function( elems, callback, arg ) {
		var value,
			i = 0,
			length = elems.length,
			isArray = isArraylike( elems ),
			ret = [];

		// Go through the array, translating each of the items to their new values
		if ( isArray ) {
			for ( ; i < length; i++ ) {
				value = callback( elems[ i ], i, arg );

				if ( value != null ) {
					ret.push( value );
				}
			}

		// Go through every key on the object,
		} else {
			for ( i in elems ) {
				value = callback( elems[ i ], i, arg );

				if ( value != null ) {
					ret.push( value );
				}
			}
		}

		// Flatten any nested arrays
		return concat.apply( [], ret );
	},

	// A global GUID counter for objects
	guid: 1,

	// Bind a function to a context, optionally partially applying any
	// arguments.
	proxy: function( fn, context ) {
		var tmp, args, proxy;

		if ( typeof context === "string" ) {
			tmp = fn[ context ];
			context = fn;
			fn = tmp;
		}

		// Quick check to determine if target is callable, in the spec
		// this throws a TypeError, but we will just return undefined.
		if ( !jQuery.isFunction( fn ) ) {
			return undefined;
		}

		// Simulated bind
		args = slice.call( arguments, 2 );
		proxy = function() {
			return fn.apply( context || this, args.concat( slice.call( arguments ) ) );
		};

		// Set the guid of unique handler to the same of original handler, so it can be removed
		proxy.guid = fn.guid = fn.guid || jQuery.guid++;

		return proxy;
	},

	now: Date.now,

	// jQuery.support is not used in Core but other projects attach their
	// properties to it so it needs to exist.
	support: support
});

// Populate the class2type map
jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "), function(i, name) {
	class2type[ "[object " + name + "]" ] = name.toLowerCase();
});

function isArraylike( obj ) {
	var length = obj.length,
		type = jQuery.type( obj );

	if ( type === "function" || jQuery.isWindow( obj ) ) {
		return false;
	}

	if ( obj.nodeType === 1 && length ) {
		return true;
	}

	return type === "array" || length === 0 ||
		typeof length === "number" && length > 0 && ( length - 1 ) in obj;
}
var Sizzle =
/*!
 * Sizzle CSS Selector Engine v1.10.19
 * http://sizzlejs.com/
 *
 * Copyright 2013 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2014-04-18
 */
(function( window ) {

var i,
	support,
	Expr,
	getText,
	isXML,
	tokenize,
	compile,
	select,
	outermostContext,
	sortInput,
	hasDuplicate,

	// Local document vars
	setDocument,
	document,
	docElem,
	documentIsHTML,
	rbuggyQSA,
	rbuggyMatches,
	matches,
	contains,

	// Instance-specific data
	expando = "sizzle" + -(new Date()),
	preferredDoc = window.document,
	dirruns = 0,
	done = 0,
	classCache = createCache(),
	tokenCache = createCache(),
	compilerCache = createCache(),
	sortOrder = function( a, b ) {
		if ( a === b ) {
			hasDuplicate = true;
		}
		return 0;
	},

	// General-purpose constants
	strundefined = typeof undefined,
	MAX_NEGATIVE = 1 << 31,

	// Instance methods
	hasOwn = ({}).hasOwnProperty,
	arr = [],
	pop = arr.pop,
	push_native = arr.push,
	push = arr.push,
	slice = arr.slice,
	// Use a stripped-down indexOf if we can't use a native one
	indexOf = arr.indexOf || function( elem ) {
		var i = 0,
			len = this.length;
		for ( ; i < len; i++ ) {
			if ( this[i] === elem ) {
				return i;
			}
		}
		return -1;
	},

	booleans = "checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",

	// Regular expressions

	// Whitespace characters http://www.w3.org/TR/css3-selectors/#whitespace
	whitespace = "[\\x20\\t\\r\\n\\f]",
	// http://www.w3.org/TR/css3-syntax/#characters
	characterEncoding = "(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",

	// Loosely modeled on CSS identifier characters
	// An unquoted value should be a CSS identifier http://www.w3.org/TR/css3-selectors/#attribute-selectors
	// Proper syntax: http://www.w3.org/TR/CSS21/syndata.html#value-def-identifier
	identifier = characterEncoding.replace( "w", "w#" ),

	// Attribute selectors: http://www.w3.org/TR/selectors/#attribute-selectors
	attributes = "\\[" + whitespace + "*(" + characterEncoding + ")(?:" + whitespace +
		// Operator (capture 2)
		"*([*^$|!~]?=)" + whitespace +
		// "Attribute values must be CSS identifiers [capture 5] or strings [capture 3 or capture 4]"
		"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|(" + identifier + "))|)" + whitespace +
		"*\\]",

	pseudos = ":(" + characterEncoding + ")(?:\\((" +
		// To reduce the number of selectors needing tokenize in the preFilter, prefer arguments:
		// 1. quoted (capture 3; capture 4 or capture 5)
		"('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|" +
		// 2. simple (capture 6)
		"((?:\\\\.|[^\\\\()[\\]]|" + attributes + ")*)|" +
		// 3. anything else (capture 2)
		".*" +
		")\\)|)",

	// Leading and non-escaped trailing whitespace, capturing some non-whitespace characters preceding the latter
	rtrim = new RegExp( "^" + whitespace + "+|((?:^|[^\\\\])(?:\\\\.)*)" + whitespace + "+$", "g" ),

	rcomma = new RegExp( "^" + whitespace + "*," + whitespace + "*" ),
	rcombinators = new RegExp( "^" + whitespace + "*([>+~]|" + whitespace + ")" + whitespace + "*" ),

	rattributeQuotes = new RegExp( "=" + whitespace + "*([^\\]'\"]*?)" + whitespace + "*\\]", "g" ),

	rpseudo = new RegExp( pseudos ),
	ridentifier = new RegExp( "^" + identifier + "$" ),

	matchExpr = {
		"ID": new RegExp( "^#(" + characterEncoding + ")" ),
		"CLASS": new RegExp( "^\\.(" + characterEncoding + ")" ),
		"TAG": new RegExp( "^(" + characterEncoding.replace( "w", "w*" ) + ")" ),
		"ATTR": new RegExp( "^" + attributes ),
		"PSEUDO": new RegExp( "^" + pseudos ),
		"CHILD": new RegExp( "^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(" + whitespace +
			"*(even|odd|(([+-]|)(\\d*)n|)" + whitespace + "*(?:([+-]|)" + whitespace +
			"*(\\d+)|))" + whitespace + "*\\)|)", "i" ),
		"bool": new RegExp( "^(?:" + booleans + ")$", "i" ),
		// For use in libraries implementing .is()
		// We use this for POS matching in `select`
		"needsContext": new RegExp( "^" + whitespace + "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(" +
			whitespace + "*((?:-\\d)?\\d*)" + whitespace + "*\\)|)(?=[^-]|$)", "i" )
	},

	rinputs = /^(?:input|select|textarea|button)$/i,
	rheader = /^h\d$/i,

	rnative = /^[^{]+\{\s*\[native \w/,

	// Easily-parseable/retrievable ID or TAG or CLASS selectors
	rquickExpr = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,

	rsibling = /[+~]/,
	rescape = /'|\\/g,

	// CSS escapes http://www.w3.org/TR/CSS21/syndata.html#escaped-characters
	runescape = new RegExp( "\\\\([\\da-f]{1,6}" + whitespace + "?|(" + whitespace + ")|.)", "ig" ),
	funescape = function( _, escaped, escapedWhitespace ) {
		var high = "0x" + escaped - 0x10000;
		// NaN means non-codepoint
		// Support: Firefox<24
		// Workaround erroneous numeric interpretation of +"0x"
		return high !== high || escapedWhitespace ?
			escaped :
			high < 0 ?
				// BMP codepoint
				String.fromCharCode( high + 0x10000 ) :
				// Supplemental Plane codepoint (surrogate pair)
				String.fromCharCode( high >> 10 | 0xD800, high & 0x3FF | 0xDC00 );
	};

// Optimize for push.apply( _, NodeList )
try {
	push.apply(
		(arr = slice.call( preferredDoc.childNodes )),
		preferredDoc.childNodes
	);
	// Support: Android<4.0
	// Detect silently failing push.apply
	arr[ preferredDoc.childNodes.length ].nodeType;
} catch ( e ) {
	push = { apply: arr.length ?

		// Leverage slice if possible
		function( target, els ) {
			push_native.apply( target, slice.call(els) );
		} :

		// Support: IE<9
		// Otherwise append directly
		function( target, els ) {
			var j = target.length,
				i = 0;
			// Can't trust NodeList.length
			while ( (target[j++] = els[i++]) ) {}
			target.length = j - 1;
		}
	};
}

function Sizzle( selector, context, results, seed ) {
	var match, elem, m, nodeType,
		// QSA vars
		i, groups, old, nid, newContext, newSelector;

	if ( ( context ? context.ownerDocument || context : preferredDoc ) !== document ) {
		setDocument( context );
	}

	context = context || document;
	results = results || [];

	if ( !selector || typeof selector !== "string" ) {
		return results;
	}

	if ( (nodeType = context.nodeType) !== 1 && nodeType !== 9 ) {
		return [];
	}

	if ( documentIsHTML && !seed ) {

		// Shortcuts
		if ( (match = rquickExpr.exec( selector )) ) {
			// Speed-up: Sizzle("#ID")
			if ( (m = match[1]) ) {
				if ( nodeType === 9 ) {
					elem = context.getElementById( m );
					// Check parentNode to catch when Blackberry 4.6 returns
					// nodes that are no longer in the document (jQuery #6963)
					if ( elem && elem.parentNode ) {
						// Handle the case where IE, Opera, and Webkit return items
						// by name instead of ID
						if ( elem.id === m ) {
							results.push( elem );
							return results;
						}
					} else {
						return results;
					}
				} else {
					// Context is not a document
					if ( context.ownerDocument && (elem = context.ownerDocument.getElementById( m )) &&
						contains( context, elem ) && elem.id === m ) {
						results.push( elem );
						return results;
					}
				}

			// Speed-up: Sizzle("TAG")
			} else if ( match[2] ) {
				push.apply( results, context.getElementsByTagName( selector ) );
				return results;

			// Speed-up: Sizzle(".CLASS")
			} else if ( (m = match[3]) && support.getElementsByClassName && context.getElementsByClassName ) {
				push.apply( results, context.getElementsByClassName( m ) );
				return results;
			}
		}

		// QSA path
		if ( support.qsa && (!rbuggyQSA || !rbuggyQSA.test( selector )) ) {
			nid = old = expando;
			newContext = context;
			newSelector = nodeType === 9 && selector;

			// qSA works strangely on Element-rooted queries
			// We can work around this by specifying an extra ID on the root
			// and working up from there (Thanks to Andrew Dupont for the technique)
			// IE 8 doesn't work on object elements
			if ( nodeType === 1 && context.nodeName.toLowerCase() !== "object" ) {
				groups = tokenize( selector );

				if ( (old = context.getAttribute("id")) ) {
					nid = old.replace( rescape, "\\$&" );
				} else {
					context.setAttribute( "id", nid );
				}
				nid = "[id='" + nid + "'] ";

				i = groups.length;
				while ( i-- ) {
					groups[i] = nid + toSelector( groups[i] );
				}
				newContext = rsibling.test( selector ) && testContext( context.parentNode ) || context;
				newSelector = groups.join(",");
			}

			if ( newSelector ) {
				try {
					push.apply( results,
						newContext.querySelectorAll( newSelector )
					);
					return results;
				} catch(qsaError) {
				} finally {
					if ( !old ) {
						context.removeAttribute("id");
					}
				}
			}
		}
	}

	// All others
	return select( selector.replace( rtrim, "$1" ), context, results, seed );
}

/**
 * Create key-value caches of limited size
 * @returns {Function(string, Object)} Returns the Object data after storing it on itself with
 *	property name the (space-suffixed) string and (if the cache is larger than Expr.cacheLength)
 *	deleting the oldest entry
 */
function createCache() {
	var keys = [];

	function cache( key, value ) {
		// Use (key + " ") to avoid collision with native prototype properties (see Issue #157)
		if ( keys.push( key + " " ) > Expr.cacheLength ) {
			// Only keep the most recent entries
			delete cache[ keys.shift() ];
		}
		return (cache[ key + " " ] = value);
	}
	return cache;
}

/**
 * Mark a function for special use by Sizzle
 * @param {Function} fn The function to mark
 */
function markFunction( fn ) {
	fn[ expando ] = true;
	return fn;
}

/**
 * Support testing using an element
 * @param {Function} fn Passed the created div and expects a boolean result
 */
function assert( fn ) {
	var div = document.createElement("div");

	try {
		return !!fn( div );
	} catch (e) {
		return false;
	} finally {
		// Remove from its parent by default
		if ( div.parentNode ) {
			div.parentNode.removeChild( div );
		}
		// release memory in IE
		div = null;
	}
}

/**
 * Adds the same handler for all of the specified attrs
 * @param {String} attrs Pipe-separated list of attributes
 * @param {Function} handler The method that will be applied
 */
function addHandle( attrs, handler ) {
	var arr = attrs.split("|"),
		i = attrs.length;

	while ( i-- ) {
		Expr.attrHandle[ arr[i] ] = handler;
	}
}

/**
 * Checks document order of two siblings
 * @param {Element} a
 * @param {Element} b
 * @returns {Number} Returns less than 0 if a precedes b, greater than 0 if a follows b
 */
function siblingCheck( a, b ) {
	var cur = b && a,
		diff = cur && a.nodeType === 1 && b.nodeType === 1 &&
			( ~b.sourceIndex || MAX_NEGATIVE ) -
			( ~a.sourceIndex || MAX_NEGATIVE );

	// Use IE sourceIndex if available on both nodes
	if ( diff ) {
		return diff;
	}

	// Check if b follows a
	if ( cur ) {
		while ( (cur = cur.nextSibling) ) {
			if ( cur === b ) {
				return -1;
			}
		}
	}

	return a ? 1 : -1;
}

/**
 * Returns a function to use in pseudos for input types
 * @param {String} type
 */
function createInputPseudo( type ) {
	return function( elem ) {
		var name = elem.nodeName.toLowerCase();
		return name === "input" && elem.type === type;
	};
}

/**
 * Returns a function to use in pseudos for buttons
 * @param {String} type
 */
function createButtonPseudo( type ) {
	return function( elem ) {
		var name = elem.nodeName.toLowerCase();
		return (name === "input" || name === "button") && elem.type === type;
	};
}

/**
 * Returns a function to use in pseudos for positionals
 * @param {Function} fn
 */
function createPositionalPseudo( fn ) {
	return markFunction(function( argument ) {
		argument = +argument;
		return markFunction(function( seed, matches ) {
			var j,
				matchIndexes = fn( [], seed.length, argument ),
				i = matchIndexes.length;

			// Match elements found at the specified indexes
			while ( i-- ) {
				if ( seed[ (j = matchIndexes[i]) ] ) {
					seed[j] = !(matches[j] = seed[j]);
				}
			}
		});
	});
}

/**
 * Checks a node for validity as a Sizzle context
 * @param {Element|Object=} context
 * @returns {Element|Object|Boolean} The input node if acceptable, otherwise a falsy value
 */
function testContext( context ) {
	return context && typeof context.getElementsByTagName !== strundefined && context;
}

// Expose support vars for convenience
support = Sizzle.support = {};

/**
 * Detects XML nodes
 * @param {Element|Object} elem An element or a document
 * @returns {Boolean} True iff elem is a non-HTML XML node
 */
isXML = Sizzle.isXML = function( elem ) {
	// documentElement is verified for cases where it doesn't yet exist
	// (such as loading iframes in IE - #4833)
	var documentElement = elem && (elem.ownerDocument || elem).documentElement;
	return documentElement ? documentElement.nodeName !== "HTML" : false;
};

/**
 * Sets document-related variables once based on the current document
 * @param {Element|Object} [doc] An element or document object to use to set the document
 * @returns {Object} Returns the current document
 */
setDocument = Sizzle.setDocument = function( node ) {
	var hasCompare,
		doc = node ? node.ownerDocument || node : preferredDoc,
		parent = doc.defaultView;

	// If no document and documentElement is available, return
	if ( doc === document || doc.nodeType !== 9 || !doc.documentElement ) {
		return document;
	}

	// Set our document
	document = doc;
	docElem = doc.documentElement;

	// Support tests
	documentIsHTML = !isXML( doc );

	// Support: IE>8
	// If iframe document is assigned to "document" variable and if iframe has been reloaded,
	// IE will throw "permission denied" error when accessing "document" variable, see jQuery #13936
	// IE6-8 do not support the defaultView property so parent will be undefined
	if ( parent && parent !== parent.top ) {
		// IE11 does not have attachEvent, so all must suffer
		if ( parent.addEventListener ) {
			parent.addEventListener( "unload", function() {
				setDocument();
			}, false );
		} else if ( parent.attachEvent ) {
			parent.attachEvent( "onunload", function() {
				setDocument();
			});
		}
	}

	/* Attributes
	---------------------------------------------------------------------- */

	// Support: IE<8
	// Verify that getAttribute really returns attributes and not properties (excepting IE8 booleans)
	support.attributes = assert(function( div ) {
		div.className = "i";
		return !div.getAttribute("className");
	});

	/* getElement(s)By*
	---------------------------------------------------------------------- */

	// Check if getElementsByTagName("*") returns only elements
	support.getElementsByTagName = assert(function( div ) {
		div.appendChild( doc.createComment("") );
		return !div.getElementsByTagName("*").length;
	});

	// Check if getElementsByClassName can be trusted
	support.getElementsByClassName = rnative.test( doc.getElementsByClassName ) && assert(function( div ) {
		div.innerHTML = "<div class='a'></div><div class='a i'></div>";

		// Support: Safari<4
		// Catch class over-caching
		div.firstChild.className = "i";
		// Support: Opera<10
		// Catch gEBCN failure to find non-leading classes
		return div.getElementsByClassName("i").length === 2;
	});

	// Support: IE<10
	// Check if getElementById returns elements by name
	// The broken getElementById methods don't pick up programatically-set names,
	// so use a roundabout getElementsByName test
	support.getById = assert(function( div ) {
		docElem.appendChild( div ).id = expando;
		return !doc.getElementsByName || !doc.getElementsByName( expando ).length;
	});

	// ID find and filter
	if ( support.getById ) {
		Expr.find["ID"] = function( id, context ) {
			if ( typeof context.getElementById !== strundefined && documentIsHTML ) {
				var m = context.getElementById( id );
				// Check parentNode to catch when Blackberry 4.6 returns
				// nodes that are no longer in the document #6963
				return m && m.parentNode ? [ m ] : [];
			}
		};
		Expr.filter["ID"] = function( id ) {
			var attrId = id.replace( runescape, funescape );
			return function( elem ) {
				return elem.getAttribute("id") === attrId;
			};
		};
	} else {
		// Support: IE6/7
		// getElementById is not reliable as a find shortcut
		delete Expr.find["ID"];

		Expr.filter["ID"] =  function( id ) {
			var attrId = id.replace( runescape, funescape );
			return function( elem ) {
				var node = typeof elem.getAttributeNode !== strundefined && elem.getAttributeNode("id");
				return node && node.value === attrId;
			};
		};
	}

	// Tag
	Expr.find["TAG"] = support.getElementsByTagName ?
		function( tag, context ) {
			if ( typeof context.getElementsByTagName !== strundefined ) {
				return context.getElementsByTagName( tag );
			}
		} :
		function( tag, context ) {
			var elem,
				tmp = [],
				i = 0,
				results = context.getElementsByTagName( tag );

			// Filter out possible comments
			if ( tag === "*" ) {
				while ( (elem = results[i++]) ) {
					if ( elem.nodeType === 1 ) {
						tmp.push( elem );
					}
				}

				return tmp;
			}
			return results;
		};

	// Class
	Expr.find["CLASS"] = support.getElementsByClassName && function( className, context ) {
		if ( typeof context.getElementsByClassName !== strundefined && documentIsHTML ) {
			return context.getElementsByClassName( className );
		}
	};

	/* QSA/matchesSelector
	---------------------------------------------------------------------- */

	// QSA and matchesSelector support

	// matchesSelector(:active) reports false when true (IE9/Opera 11.5)
	rbuggyMatches = [];

	// qSa(:focus) reports false when true (Chrome 21)
	// We allow this because of a bug in IE8/9 that throws an error
	// whenever `document.activeElement` is accessed on an iframe
	// So, we allow :focus to pass through QSA all the time to avoid the IE error
	// See http://bugs.jquery.com/ticket/13378
	rbuggyQSA = [];

	if ( (support.qsa = rnative.test( doc.querySelectorAll )) ) {
		// Build QSA regex
		// Regex strategy adopted from Diego Perini
		assert(function( div ) {
			// Select is set to empty string on purpose
			// This is to test IE's treatment of not explicitly
			// setting a boolean content attribute,
			// since its presence should be enough
			// http://bugs.jquery.com/ticket/12359
			div.innerHTML = "<select msallowclip=''><option selected=''></option></select>";

			// Support: IE8, Opera 11-12.16
			// Nothing should be selected when empty strings follow ^= or $= or *=
			// The test attribute must be unknown in Opera but "safe" for WinRT
			// http://msdn.microsoft.com/en-us/library/ie/hh465388.aspx#attribute_section
			if ( div.querySelectorAll("[msallowclip^='']").length ) {
				rbuggyQSA.push( "[*^$]=" + whitespace + "*(?:''|\"\")" );
			}

			// Support: IE8
			// Boolean attributes and "value" are not treated correctly
			if ( !div.querySelectorAll("[selected]").length ) {
				rbuggyQSA.push( "\\[" + whitespace + "*(?:value|" + booleans + ")" );
			}

			// Webkit/Opera - :checked should return selected option elements
			// http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#checked
			// IE8 throws error here and will not see later tests
			if ( !div.querySelectorAll(":checked").length ) {
				rbuggyQSA.push(":checked");
			}
		});

		assert(function( div ) {
			// Support: Windows 8 Native Apps
			// The type and name attributes are restricted during .innerHTML assignment
			var input = doc.createElement("input");
			input.setAttribute( "type", "hidden" );
			div.appendChild( input ).setAttribute( "name", "D" );

			// Support: IE8
			// Enforce case-sensitivity of name attribute
			if ( div.querySelectorAll("[name=d]").length ) {
				rbuggyQSA.push( "name" + whitespace + "*[*^$|!~]?=" );
			}

			// FF 3.5 - :enabled/:disabled and hidden elements (hidden elements are still enabled)
			// IE8 throws error here and will not see later tests
			if ( !div.querySelectorAll(":enabled").length ) {
				rbuggyQSA.push( ":enabled", ":disabled" );
			}

			// Opera 10-11 does not throw on post-comma invalid pseudos
			div.querySelectorAll("*,:x");
			rbuggyQSA.push(",.*:");
		});
	}

	if ( (support.matchesSelector = rnative.test( (matches = docElem.matches ||
		docElem.webkitMatchesSelector ||
		docElem.mozMatchesSelector ||
		docElem.oMatchesSelector ||
		docElem.msMatchesSelector) )) ) {

		assert(function( div ) {
			// Check to see if it's possible to do matchesSelector
			// on a disconnected node (IE 9)
			support.disconnectedMatch = matches.call( div, "div" );

			// This should fail with an exception
			// Gecko does not error, returns false instead
			matches.call( div, "[s!='']:x" );
			rbuggyMatches.push( "!=", pseudos );
		});
	}

	rbuggyQSA = rbuggyQSA.length && new RegExp( rbuggyQSA.join("|") );
	rbuggyMatches = rbuggyMatches.length && new RegExp( rbuggyMatches.join("|") );

	/* Contains
	---------------------------------------------------------------------- */
	hasCompare = rnative.test( docElem.compareDocumentPosition );

	// Element contains another
	// Purposefully does not implement inclusive descendent
	// As in, an element does not contain itself
	contains = hasCompare || rnative.test( docElem.contains ) ?
		function( a, b ) {
			var adown = a.nodeType === 9 ? a.documentElement : a,
				bup = b && b.parentNode;
			return a === bup || !!( bup && bup.nodeType === 1 && (
				adown.contains ?
					adown.contains( bup ) :
					a.compareDocumentPosition && a.compareDocumentPosition( bup ) & 16
			));
		} :
		function( a, b ) {
			if ( b ) {
				while ( (b = b.parentNode) ) {
					if ( b === a ) {
						return true;
					}
				}
			}
			return false;
		};

	/* Sorting
	---------------------------------------------------------------------- */

	// Document order sorting
	sortOrder = hasCompare ?
	function( a, b ) {

		// Flag for duplicate removal
		if ( a === b ) {
			hasDuplicate = true;
			return 0;
		}

		// Sort on method existence if only one input has compareDocumentPosition
		var compare = !a.compareDocumentPosition - !b.compareDocumentPosition;
		if ( compare ) {
			return compare;
		}

		// Calculate position if both inputs belong to the same document
		compare = ( a.ownerDocument || a ) === ( b.ownerDocument || b ) ?
			a.compareDocumentPosition( b ) :

			// Otherwise we know they are disconnected
			1;

		// Disconnected nodes
		if ( compare & 1 ||
			(!support.sortDetached && b.compareDocumentPosition( a ) === compare) ) {

			// Choose the first element that is related to our preferred document
			if ( a === doc || a.ownerDocument === preferredDoc && contains(preferredDoc, a) ) {
				return -1;
			}
			if ( b === doc || b.ownerDocument === preferredDoc && contains(preferredDoc, b) ) {
				return 1;
			}

			// Maintain original order
			return sortInput ?
				( indexOf.call( sortInput, a ) - indexOf.call( sortInput, b ) ) :
				0;
		}

		return compare & 4 ? -1 : 1;
	} :
	function( a, b ) {
		// Exit early if the nodes are identical
		if ( a === b ) {
			hasDuplicate = true;
			return 0;
		}

		var cur,
			i = 0,
			aup = a.parentNode,
			bup = b.parentNode,
			ap = [ a ],
			bp = [ b ];

		// Parentless nodes are either documents or disconnected
		if ( !aup || !bup ) {
			return a === doc ? -1 :
				b === doc ? 1 :
				aup ? -1 :
				bup ? 1 :
				sortInput ?
				( indexOf.call( sortInput, a ) - indexOf.call( sortInput, b ) ) :
				0;

		// If the nodes are siblings, we can do a quick check
		} else if ( aup === bup ) {
			return siblingCheck( a, b );
		}

		// Otherwise we need full lists of their ancestors for comparison
		cur = a;
		while ( (cur = cur.parentNode) ) {
			ap.unshift( cur );
		}
		cur = b;
		while ( (cur = cur.parentNode) ) {
			bp.unshift( cur );
		}

		// Walk down the tree looking for a discrepancy
		while ( ap[i] === bp[i] ) {
			i++;
		}

		return i ?
			// Do a sibling check if the nodes have a common ancestor
			siblingCheck( ap[i], bp[i] ) :

			// Otherwise nodes in our document sort first
			ap[i] === preferredDoc ? -1 :
			bp[i] === preferredDoc ? 1 :
			0;
	};

	return doc;
};

Sizzle.matches = function( expr, elements ) {
	return Sizzle( expr, null, null, elements );
};

Sizzle.matchesSelector = function( elem, expr ) {
	// Set document vars if needed
	if ( ( elem.ownerDocument || elem ) !== document ) {
		setDocument( elem );
	}

	// Make sure that attribute selectors are quoted
	expr = expr.replace( rattributeQuotes, "='$1']" );

	if ( support.matchesSelector && documentIsHTML &&
		( !rbuggyMatches || !rbuggyMatches.test( expr ) ) &&
		( !rbuggyQSA     || !rbuggyQSA.test( expr ) ) ) {

		try {
			var ret = matches.call( elem, expr );

			// IE 9's matchesSelector returns false on disconnected nodes
			if ( ret || support.disconnectedMatch ||
					// As well, disconnected nodes are said to be in a document
					// fragment in IE 9
					elem.document && elem.document.nodeType !== 11 ) {
				return ret;
			}
		} catch(e) {}
	}

	return Sizzle( expr, document, null, [ elem ] ).length > 0;
};

Sizzle.contains = function( context, elem ) {
	// Set document vars if needed
	if ( ( context.ownerDocument || context ) !== document ) {
		setDocument( context );
	}
	return contains( context, elem );
};

Sizzle.attr = function( elem, name ) {
	// Set document vars if needed
	if ( ( elem.ownerDocument || elem ) !== document ) {
		setDocument( elem );
	}

	var fn = Expr.attrHandle[ name.toLowerCase() ],
		// Don't get fooled by Object.prototype properties (jQuery #13807)
		val = fn && hasOwn.call( Expr.attrHandle, name.toLowerCase() ) ?
			fn( elem, name, !documentIsHTML ) :
			undefined;

	return val !== undefined ?
		val :
		support.attributes || !documentIsHTML ?
			elem.getAttribute( name ) :
			(val = elem.getAttributeNode(name)) && val.specified ?
				val.value :
				null;
};

Sizzle.error = function( msg ) {
	throw new Error( "Syntax error, unrecognized expression: " + msg );
};

/**
 * Document sorting and removing duplicates
 * @param {ArrayLike} results
 */
Sizzle.uniqueSort = function( results ) {
	var elem,
		duplicates = [],
		j = 0,
		i = 0;

	// Unless we *know* we can detect duplicates, assume their presence
	hasDuplicate = !support.detectDuplicates;
	sortInput = !support.sortStable && results.slice( 0 );
	results.sort( sortOrder );

	if ( hasDuplicate ) {
		while ( (elem = results[i++]) ) {
			if ( elem === results[ i ] ) {
				j = duplicates.push( i );
			}
		}
		while ( j-- ) {
			results.splice( duplicates[ j ], 1 );
		}
	}

	// Clear input after sorting to release objects
	// See https://github.com/jquery/sizzle/pull/225
	sortInput = null;

	return results;
};

/**
 * Utility function for retrieving the text value of an array of DOM nodes
 * @param {Array|Element} elem
 */
getText = Sizzle.getText = function( elem ) {
	var node,
		ret = "",
		i = 0,
		nodeType = elem.nodeType;

	if ( !nodeType ) {
		// If no nodeType, this is expected to be an array
		while ( (node = elem[i++]) ) {
			// Do not traverse comment nodes
			ret += getText( node );
		}
	} else if ( nodeType === 1 || nodeType === 9 || nodeType === 11 ) {
		// Use textContent for elements
		// innerText usage removed for consistency of new lines (jQuery #11153)
		if ( typeof elem.textContent === "string" ) {
			return elem.textContent;
		} else {
			// Traverse its children
			for ( elem = elem.firstChild; elem; elem = elem.nextSibling ) {
				ret += getText( elem );
			}
		}
	} else if ( nodeType === 3 || nodeType === 4 ) {
		return elem.nodeValue;
	}
	// Do not include comment or processing instruction nodes

	return ret;
};

Expr = Sizzle.selectors = {

	// Can be adjusted by the user
	cacheLength: 50,

	createPseudo: markFunction,

	match: matchExpr,

	attrHandle: {},

	find: {},

	relative: {
		">": { dir: "parentNode", first: true },
		" ": { dir: "parentNode" },
		"+": { dir: "previousSibling", first: true },
		"~": { dir: "previousSibling" }
	},

	preFilter: {
		"ATTR": function( match ) {
			match[1] = match[1].replace( runescape, funescape );

			// Move the given value to match[3] whether quoted or unquoted
			match[3] = ( match[3] || match[4] || match[5] || "" ).replace( runescape, funescape );

			if ( match[2] === "~=" ) {
				match[3] = " " + match[3] + " ";
			}

			return match.slice( 0, 4 );
		},

		"CHILD": function( match ) {
			/* matches from matchExpr["CHILD"]
				1 type (only|nth|...)
				2 what (child|of-type)
				3 argument (even|odd|\d*|\d*n([+-]\d+)?|...)
				4 xn-component of xn+y argument ([+-]?\d*n|)
				5 sign of xn-component
				6 x of xn-component
				7 sign of y-component
				8 y of y-component
			*/
			match[1] = match[1].toLowerCase();

			if ( match[1].slice( 0, 3 ) === "nth" ) {
				// nth-* requires argument
				if ( !match[3] ) {
					Sizzle.error( match[0] );
				}

				// numeric x and y parameters for Expr.filter.CHILD
				// remember that false/true cast respectively to 0/1
				match[4] = +( match[4] ? match[5] + (match[6] || 1) : 2 * ( match[3] === "even" || match[3] === "odd" ) );
				match[5] = +( ( match[7] + match[8] ) || match[3] === "odd" );

			// other types prohibit arguments
			} else if ( match[3] ) {
				Sizzle.error( match[0] );
			}

			return match;
		},

		"PSEUDO": function( match ) {
			var excess,
				unquoted = !match[6] && match[2];

			if ( matchExpr["CHILD"].test( match[0] ) ) {
				return null;
			}

			// Accept quoted arguments as-is
			if ( match[3] ) {
				match[2] = match[4] || match[5] || "";

			// Strip excess characters from unquoted arguments
			} else if ( unquoted && rpseudo.test( unquoted ) &&
				// Get excess from tokenize (recursively)
				(excess = tokenize( unquoted, true )) &&
				// advance to the next closing parenthesis
				(excess = unquoted.indexOf( ")", unquoted.length - excess ) - unquoted.length) ) {

				// excess is a negative index
				match[0] = match[0].slice( 0, excess );
				match[2] = unquoted.slice( 0, excess );
			}

			// Return only captures needed by the pseudo filter method (type and argument)
			return match.slice( 0, 3 );
		}
	},

	filter: {

		"TAG": function( nodeNameSelector ) {
			var nodeName = nodeNameSelector.replace( runescape, funescape ).toLowerCase();
			return nodeNameSelector === "*" ?
				function() { return true; } :
				function( elem ) {
					return elem.nodeName && elem.nodeName.toLowerCase() === nodeName;
				};
		},

		"CLASS": function( className ) {
			var pattern = classCache[ className + " " ];

			return pattern ||
				(pattern = new RegExp( "(^|" + whitespace + ")" + className + "(" + whitespace + "|$)" )) &&
				classCache( className, function( elem ) {
					return pattern.test( typeof elem.className === "string" && elem.className || typeof elem.getAttribute !== strundefined && elem.getAttribute("class") || "" );
				});
		},

		"ATTR": function( name, operator, check ) {
			return function( elem ) {
				var result = Sizzle.attr( elem, name );

				if ( result == null ) {
					return operator === "!=";
				}
				if ( !operator ) {
					return true;
				}

				result += "";

				return operator === "=" ? result === check :
					operator === "!=" ? result !== check :
					operator === "^=" ? check && result.indexOf( check ) === 0 :
					operator === "*=" ? check && result.indexOf( check ) > -1 :
					operator === "$=" ? check && result.slice( -check.length ) === check :
					operator === "~=" ? ( " " + result + " " ).indexOf( check ) > -1 :
					operator === "|=" ? result === check || result.slice( 0, check.length + 1 ) === check + "-" :
					false;
			};
		},

		"CHILD": function( type, what, argument, first, last ) {
			var simple = type.slice( 0, 3 ) !== "nth",
				forward = type.slice( -4 ) !== "last",
				ofType = what === "of-type";

			return first === 1 && last === 0 ?

				// Shortcut for :nth-*(n)
				function( elem ) {
					return !!elem.parentNode;
				} :

				function( elem, context, xml ) {
					var cache, outerCache, node, diff, nodeIndex, start,
						dir = simple !== forward ? "nextSibling" : "previousSibling",
						parent = elem.parentNode,
						name = ofType && elem.nodeName.toLowerCase(),
						useCache = !xml && !ofType;

					if ( parent ) {

						// :(first|last|only)-(child|of-type)
						if ( simple ) {
							while ( dir ) {
								node = elem;
								while ( (node = node[ dir ]) ) {
									if ( ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1 ) {
										return false;
									}
								}
								// Reverse direction for :only-* (if we haven't yet done so)
								start = dir = type === "only" && !start && "nextSibling";
							}
							return true;
						}

						start = [ forward ? parent.firstChild : parent.lastChild ];

						// non-xml :nth-child(...) stores cache data on `parent`
						if ( forward && useCache ) {
							// Seek `elem` from a previously-cached index
							outerCache = parent[ expando ] || (parent[ expando ] = {});
							cache = outerCache[ type ] || [];
							nodeIndex = cache[0] === dirruns && cache[1];
							diff = cache[0] === dirruns && cache[2];
							node = nodeIndex && parent.childNodes[ nodeIndex ];

							while ( (node = ++nodeIndex && node && node[ dir ] ||

								// Fallback to seeking `elem` from the start
								(diff = nodeIndex = 0) || start.pop()) ) {

								// When found, cache indexes on `parent` and break
								if ( node.nodeType === 1 && ++diff && node === elem ) {
									outerCache[ type ] = [ dirruns, nodeIndex, diff ];
									break;
								}
							}

						// Use previously-cached element index if available
						} else if ( useCache && (cache = (elem[ expando ] || (elem[ expando ] = {}))[ type ]) && cache[0] === dirruns ) {
							diff = cache[1];

						// xml :nth-child(...) or :nth-last-child(...) or :nth(-last)?-of-type(...)
						} else {
							// Use the same loop as above to seek `elem` from the start
							while ( (node = ++nodeIndex && node && node[ dir ] ||
								(diff = nodeIndex = 0) || start.pop()) ) {

								if ( ( ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1 ) && ++diff ) {
									// Cache the index of each encountered element
									if ( useCache ) {
										(node[ expando ] || (node[ expando ] = {}))[ type ] = [ dirruns, diff ];
									}

									if ( node === elem ) {
										break;
									}
								}
							}
						}

						// Incorporate the offset, then check against cycle size
						diff -= last;
						return diff === first || ( diff % first === 0 && diff / first >= 0 );
					}
				};
		},

		"PSEUDO": function( pseudo, argument ) {
			// pseudo-class names are case-insensitive
			// http://www.w3.org/TR/selectors/#pseudo-classes
			// Prioritize by case sensitivity in case custom pseudos are added with uppercase letters
			// Remember that setFilters inherits from pseudos
			var args,
				fn = Expr.pseudos[ pseudo ] || Expr.setFilters[ pseudo.toLowerCase() ] ||
					Sizzle.error( "unsupported pseudo: " + pseudo );

			// The user may use createPseudo to indicate that
			// arguments are needed to create the filter function
			// just as Sizzle does
			if ( fn[ expando ] ) {
				return fn( argument );
			}

			// But maintain support for old signatures
			if ( fn.length > 1 ) {
				args = [ pseudo, pseudo, "", argument ];
				return Expr.setFilters.hasOwnProperty( pseudo.toLowerCase() ) ?
					markFunction(function( seed, matches ) {
						var idx,
							matched = fn( seed, argument ),
							i = matched.length;
						while ( i-- ) {
							idx = indexOf.call( seed, matched[i] );
							seed[ idx ] = !( matches[ idx ] = matched[i] );
						}
					}) :
					function( elem ) {
						return fn( elem, 0, args );
					};
			}

			return fn;
		}
	},

	pseudos: {
		// Potentially complex pseudos
		"not": markFunction(function( selector ) {
			// Trim the selector passed to compile
			// to avoid treating leading and trailing
			// spaces as combinators
			var input = [],
				results = [],
				matcher = compile( selector.replace( rtrim, "$1" ) );

			return matcher[ expando ] ?
				markFunction(function( seed, matches, context, xml ) {
					var elem,
						unmatched = matcher( seed, null, xml, [] ),
						i = seed.length;

					// Match elements unmatched by `matcher`
					while ( i-- ) {
						if ( (elem = unmatched[i]) ) {
							seed[i] = !(matches[i] = elem);
						}
					}
				}) :
				function( elem, context, xml ) {
					input[0] = elem;
					matcher( input, null, xml, results );
					return !results.pop();
				};
		}),

		"has": markFunction(function( selector ) {
			return function( elem ) {
				return Sizzle( selector, elem ).length > 0;
			};
		}),

		"contains": markFunction(function( text ) {
			return function( elem ) {
				return ( elem.textContent || elem.innerText || getText( elem ) ).indexOf( text ) > -1;
			};
		}),

		// "Whether an element is represented by a :lang() selector
		// is based solely on the element's language value
		// being equal to the identifier C,
		// or beginning with the identifier C immediately followed by "-".
		// The matching of C against the element's language value is performed case-insensitively.
		// The identifier C does not have to be a valid language name."
		// http://www.w3.org/TR/selectors/#lang-pseudo
		"lang": markFunction( function( lang ) {
			// lang value must be a valid identifier
			if ( !ridentifier.test(lang || "") ) {
				Sizzle.error( "unsupported lang: " + lang );
			}
			lang = lang.replace( runescape, funescape ).toLowerCase();
			return function( elem ) {
				var elemLang;
				do {
					if ( (elemLang = documentIsHTML ?
						elem.lang :
						elem.getAttribute("xml:lang") || elem.getAttribute("lang")) ) {

						elemLang = elemLang.toLowerCase();
						return elemLang === lang || elemLang.indexOf( lang + "-" ) === 0;
					}
				} while ( (elem = elem.parentNode) && elem.nodeType === 1 );
				return false;
			};
		}),

		// Miscellaneous
		"target": function( elem ) {
			var hash = window.location && window.location.hash;
			return hash && hash.slice( 1 ) === elem.id;
		},

		"root": function( elem ) {
			return elem === docElem;
		},

		"focus": function( elem ) {
			return elem === document.activeElement && (!document.hasFocus || document.hasFocus()) && !!(elem.type || elem.href || ~elem.tabIndex);
		},

		// Boolean properties
		"enabled": function( elem ) {
			return elem.disabled === false;
		},

		"disabled": function( elem ) {
			return elem.disabled === true;
		},

		"checked": function( elem ) {
			// In CSS3, :checked should return both checked and selected elements
			// http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#checked
			var nodeName = elem.nodeName.toLowerCase();
			return (nodeName === "input" && !!elem.checked) || (nodeName === "option" && !!elem.selected);
		},

		"selected": function( elem ) {
			// Accessing this property makes selected-by-default
			// options in Safari work properly
			if ( elem.parentNode ) {
				elem.parentNode.selectedIndex;
			}

			return elem.selected === true;
		},

		// Contents
		"empty": function( elem ) {
			// http://www.w3.org/TR/selectors/#empty-pseudo
			// :empty is negated by element (1) or content nodes (text: 3; cdata: 4; entity ref: 5),
			//   but not by others (comment: 8; processing instruction: 7; etc.)
			// nodeType < 6 works because attributes (2) do not appear as children
			for ( elem = elem.firstChild; elem; elem = elem.nextSibling ) {
				if ( elem.nodeType < 6 ) {
					return false;
				}
			}
			return true;
		},

		"parent": function( elem ) {
			return !Expr.pseudos["empty"]( elem );
		},

		// Element/input types
		"header": function( elem ) {
			return rheader.test( elem.nodeName );
		},

		"input": function( elem ) {
			return rinputs.test( elem.nodeName );
		},

		"button": function( elem ) {
			var name = elem.nodeName.toLowerCase();
			return name === "input" && elem.type === "button" || name === "button";
		},

		"text": function( elem ) {
			var attr;
			return elem.nodeName.toLowerCase() === "input" &&
				elem.type === "text" &&

				// Support: IE<8
				// New HTML5 attribute values (e.g., "search") appear with elem.type === "text"
				( (attr = elem.getAttribute("type")) == null || attr.toLowerCase() === "text" );
		},

		// Position-in-collection
		"first": createPositionalPseudo(function() {
			return [ 0 ];
		}),

		"last": createPositionalPseudo(function( matchIndexes, length ) {
			return [ length - 1 ];
		}),

		"eq": createPositionalPseudo(function( matchIndexes, length, argument ) {
			return [ argument < 0 ? argument + length : argument ];
		}),

		"even": createPositionalPseudo(function( matchIndexes, length ) {
			var i = 0;
			for ( ; i < length; i += 2 ) {
				matchIndexes.push( i );
			}
			return matchIndexes;
		}),

		"odd": createPositionalPseudo(function( matchIndexes, length ) {
			var i = 1;
			for ( ; i < length; i += 2 ) {
				matchIndexes.push( i );
			}
			return matchIndexes;
		}),

		"lt": createPositionalPseudo(function( matchIndexes, length, argument ) {
			var i = argument < 0 ? argument + length : argument;
			for ( ; --i >= 0; ) {
				matchIndexes.push( i );
			}
			return matchIndexes;
		}),

		"gt": createPositionalPseudo(function( matchIndexes, length, argument ) {
			var i = argument < 0 ? argument + length : argument;
			for ( ; ++i < length; ) {
				matchIndexes.push( i );
			}
			return matchIndexes;
		})
	}
};

Expr.pseudos["nth"] = Expr.pseudos["eq"];

// Add button/input type pseudos
for ( i in { radio: true, checkbox: true, file: true, password: true, image: true } ) {
	Expr.pseudos[ i ] = createInputPseudo( i );
}
for ( i in { submit: true, reset: true } ) {
	Expr.pseudos[ i ] = createButtonPseudo( i );
}

// Easy API for creating new setFilters
function setFilters() {}
setFilters.prototype = Expr.filters = Expr.pseudos;
Expr.setFilters = new setFilters();

tokenize = Sizzle.tokenize = function( selector, parseOnly ) {
	var matched, match, tokens, type,
		soFar, groups, preFilters,
		cached = tokenCache[ selector + " " ];

	if ( cached ) {
		return parseOnly ? 0 : cached.slice( 0 );
	}

	soFar = selector;
	groups = [];
	preFilters = Expr.preFilter;

	while ( soFar ) {

		// Comma and first run
		if ( !matched || (match = rcomma.exec( soFar )) ) {
			if ( match ) {
				// Don't consume trailing commas as valid
				soFar = soFar.slice( match[0].length ) || soFar;
			}
			groups.push( (tokens = []) );
		}

		matched = false;

		// Combinators
		if ( (match = rcombinators.exec( soFar )) ) {
			matched = match.shift();
			tokens.push({
				value: matched,
				// Cast descendant combinators to space
				type: match[0].replace( rtrim, " " )
			});
			soFar = soFar.slice( matched.length );
		}

		// Filters
		for ( type in Expr.filter ) {
			if ( (match = matchExpr[ type ].exec( soFar )) && (!preFilters[ type ] ||
				(match = preFilters[ type ]( match ))) ) {
				matched = match.shift();
				tokens.push({
					value: matched,
					type: type,
					matches: match
				});
				soFar = soFar.slice( matched.length );
			}
		}

		if ( !matched ) {
			break;
		}
	}

	// Return the length of the invalid excess
	// if we're just parsing
	// Otherwise, throw an error or return tokens
	return parseOnly ?
		soFar.length :
		soFar ?
			Sizzle.error( selector ) :
			// Cache the tokens
			tokenCache( selector, groups ).slice( 0 );
};

function toSelector( tokens ) {
	var i = 0,
		len = tokens.length,
		selector = "";
	for ( ; i < len; i++ ) {
		selector += tokens[i].value;
	}
	return selector;
}

function addCombinator( matcher, combinator, base ) {
	var dir = combinator.dir,
		checkNonElements = base && dir === "parentNode",
		doneName = done++;

	return combinator.first ?
		// Check against closest ancestor/preceding element
		function( elem, context, xml ) {
			while ( (elem = elem[ dir ]) ) {
				if ( elem.nodeType === 1 || checkNonElements ) {
					return matcher( elem, context, xml );
				}
			}
		} :

		// Check against all ancestor/preceding elements
		function( elem, context, xml ) {
			var oldCache, outerCache,
				newCache = [ dirruns, doneName ];

			// We can't set arbitrary data on XML nodes, so they don't benefit from dir caching
			if ( xml ) {
				while ( (elem = elem[ dir ]) ) {
					if ( elem.nodeType === 1 || checkNonElements ) {
						if ( matcher( elem, context, xml ) ) {
							return true;
						}
					}
				}
			} else {
				while ( (elem = elem[ dir ]) ) {
					if ( elem.nodeType === 1 || checkNonElements ) {
						outerCache = elem[ expando ] || (elem[ expando ] = {});
						if ( (oldCache = outerCache[ dir ]) &&
							oldCache[ 0 ] === dirruns && oldCache[ 1 ] === doneName ) {

							// Assign to newCache so results back-propagate to previous elements
							return (newCache[ 2 ] = oldCache[ 2 ]);
						} else {
							// Reuse newcache so results back-propagate to previous elements
							outerCache[ dir ] = newCache;

							// A match means we're done; a fail means we have to keep checking
							if ( (newCache[ 2 ] = matcher( elem, context, xml )) ) {
								return true;
							}
						}
					}
				}
			}
		};
}

function elementMatcher( matchers ) {
	return matchers.length > 1 ?
		function( elem, context, xml ) {
			var i = matchers.length;
			while ( i-- ) {
				if ( !matchers[i]( elem, context, xml ) ) {
					return false;
				}
			}
			return true;
		} :
		matchers[0];
}

function multipleContexts( selector, contexts, results ) {
	var i = 0,
		len = contexts.length;
	for ( ; i < len; i++ ) {
		Sizzle( selector, contexts[i], results );
	}
	return results;
}

function condense( unmatched, map, filter, context, xml ) {
	var elem,
		newUnmatched = [],
		i = 0,
		len = unmatched.length,
		mapped = map != null;

	for ( ; i < len; i++ ) {
		if ( (elem = unmatched[i]) ) {
			if ( !filter || filter( elem, context, xml ) ) {
				newUnmatched.push( elem );
				if ( mapped ) {
					map.push( i );
				}
			}
		}
	}

	return newUnmatched;
}

function setMatcher( preFilter, selector, matcher, postFilter, postFinder, postSelector ) {
	if ( postFilter && !postFilter[ expando ] ) {
		postFilter = setMatcher( postFilter );
	}
	if ( postFinder && !postFinder[ expando ] ) {
		postFinder = setMatcher( postFinder, postSelector );
	}
	return markFunction(function( seed, results, context, xml ) {
		var temp, i, elem,
			preMap = [],
			postMap = [],
			preexisting = results.length,

			// Get initial elements from seed or context
			elems = seed || multipleContexts( selector || "*", context.nodeType ? [ context ] : context, [] ),

			// Prefilter to get matcher input, preserving a map for seed-results synchronization
			matcherIn = preFilter && ( seed || !selector ) ?
				condense( elems, preMap, preFilter, context, xml ) :
				elems,

			matcherOut = matcher ?
				// If we have a postFinder, or filtered seed, or non-seed postFilter or preexisting results,
				postFinder || ( seed ? preFilter : preexisting || postFilter ) ?

					// ...intermediate processing is necessary
					[] :

					// ...otherwise use results directly
					results :
				matcherIn;

		// Find primary matches
		if ( matcher ) {
			matcher( matcherIn, matcherOut, context, xml );
		}

		// Apply postFilter
		if ( postFilter ) {
			temp = condense( matcherOut, postMap );
			postFilter( temp, [], context, xml );

			// Un-match failing elements by moving them back to matcherIn
			i = temp.length;
			while ( i-- ) {
				if ( (elem = temp[i]) ) {
					matcherOut[ postMap[i] ] = !(matcherIn[ postMap[i] ] = elem);
				}
			}
		}

		if ( seed ) {
			if ( postFinder || preFilter ) {
				if ( postFinder ) {
					// Get the final matcherOut by condensing this intermediate into postFinder contexts
					temp = [];
					i = matcherOut.length;
					while ( i-- ) {
						if ( (elem = matcherOut[i]) ) {
							// Restore matcherIn since elem is not yet a final match
							temp.push( (matcherIn[i] = elem) );
						}
					}
					postFinder( null, (matcherOut = []), temp, xml );
				}

				// Move matched elements from seed to results to keep them synchronized
				i = matcherOut.length;
				while ( i-- ) {
					if ( (elem = matcherOut[i]) &&
						(temp = postFinder ? indexOf.call( seed, elem ) : preMap[i]) > -1 ) {

						seed[temp] = !(results[temp] = elem);
					}
				}
			}

		// Add elements to results, through postFinder if defined
		} else {
			matcherOut = condense(
				matcherOut === results ?
					matcherOut.splice( preexisting, matcherOut.length ) :
					matcherOut
			);
			if ( postFinder ) {
				postFinder( null, results, matcherOut, xml );
			} else {
				push.apply( results, matcherOut );
			}
		}
	});
}

function matcherFromTokens( tokens ) {
	var checkContext, matcher, j,
		len = tokens.length,
		leadingRelative = Expr.relative[ tokens[0].type ],
		implicitRelative = leadingRelative || Expr.relative[" "],
		i = leadingRelative ? 1 : 0,

		// The foundational matcher ensures that elements are reachable from top-level context(s)
		matchContext = addCombinator( function( elem ) {
			return elem === checkContext;
		}, implicitRelative, true ),
		matchAnyContext = addCombinator( function( elem ) {
			return indexOf.call( checkContext, elem ) > -1;
		}, implicitRelative, true ),
		matchers = [ function( elem, context, xml ) {
			return ( !leadingRelative && ( xml || context !== outermostContext ) ) || (
				(checkContext = context).nodeType ?
					matchContext( elem, context, xml ) :
					matchAnyContext( elem, context, xml ) );
		} ];

	for ( ; i < len; i++ ) {
		if ( (matcher = Expr.relative[ tokens[i].type ]) ) {
			matchers = [ addCombinator(elementMatcher( matchers ), matcher) ];
		} else {
			matcher = Expr.filter[ tokens[i].type ].apply( null, tokens[i].matches );

			// Return special upon seeing a positional matcher
			if ( matcher[ expando ] ) {
				// Find the next relative operator (if any) for proper handling
				j = ++i;
				for ( ; j < len; j++ ) {
					if ( Expr.relative[ tokens[j].type ] ) {
						break;
					}
				}
				return setMatcher(
					i > 1 && elementMatcher( matchers ),
					i > 1 && toSelector(
						// If the preceding token was a descendant combinator, insert an implicit any-element `*`
						tokens.slice( 0, i - 1 ).concat({ value: tokens[ i - 2 ].type === " " ? "*" : "" })
					).replace( rtrim, "$1" ),
					matcher,
					i < j && matcherFromTokens( tokens.slice( i, j ) ),
					j < len && matcherFromTokens( (tokens = tokens.slice( j )) ),
					j < len && toSelector( tokens )
				);
			}
			matchers.push( matcher );
		}
	}

	return elementMatcher( matchers );
}

function matcherFromGroupMatchers( elementMatchers, setMatchers ) {
	var bySet = setMatchers.length > 0,
		byElement = elementMatchers.length > 0,
		superMatcher = function( seed, context, xml, results, outermost ) {
			var elem, j, matcher,
				matchedCount = 0,
				i = "0",
				unmatched = seed && [],
				setMatched = [],
				contextBackup = outermostContext,
				// We must always have either seed elements or outermost context
				elems = seed || byElement && Expr.find["TAG"]( "*", outermost ),
				// Use integer dirruns iff this is the outermost matcher
				dirrunsUnique = (dirruns += contextBackup == null ? 1 : Math.random() || 0.1),
				len = elems.length;

			if ( outermost ) {
				outermostContext = context !== document && context;
			}

			// Add elements passing elementMatchers directly to results
			// Keep `i` a string if there are no elements so `matchedCount` will be "00" below
			// Support: IE<9, Safari
			// Tolerate NodeList properties (IE: "length"; Safari: <number>) matching elements by id
			for ( ; i !== len && (elem = elems[i]) != null; i++ ) {
				if ( byElement && elem ) {
					j = 0;
					while ( (matcher = elementMatchers[j++]) ) {
						if ( matcher( elem, context, xml ) ) {
							results.push( elem );
							break;
						}
					}
					if ( outermost ) {
						dirruns = dirrunsUnique;
					}
				}

				// Track unmatched elements for set filters
				if ( bySet ) {
					// They will have gone through all possible matchers
					if ( (elem = !matcher && elem) ) {
						matchedCount--;
					}

					// Lengthen the array for every element, matched or not
					if ( seed ) {
						unmatched.push( elem );
					}
				}
			}

			// Apply set filters to unmatched elements
			matchedCount += i;
			if ( bySet && i !== matchedCount ) {
				j = 0;
				while ( (matcher = setMatchers[j++]) ) {
					matcher( unmatched, setMatched, context, xml );
				}

				if ( seed ) {
					// Reintegrate element matches to eliminate the need for sorting
					if ( matchedCount > 0 ) {
						while ( i-- ) {
							if ( !(unmatched[i] || setMatched[i]) ) {
								setMatched[i] = pop.call( results );
							}
						}
					}

					// Discard index placeholder values to get only actual matches
					setMatched = condense( setMatched );
				}

				// Add matches to results
				push.apply( results, setMatched );

				// Seedless set matches succeeding multiple successful matchers stipulate sorting
				if ( outermost && !seed && setMatched.length > 0 &&
					( matchedCount + setMatchers.length ) > 1 ) {

					Sizzle.uniqueSort( results );
				}
			}

			// Override manipulation of globals by nested matchers
			if ( outermost ) {
				dirruns = dirrunsUnique;
				outermostContext = contextBackup;
			}

			return unmatched;
		};

	return bySet ?
		markFunction( superMatcher ) :
		superMatcher;
}

compile = Sizzle.compile = function( selector, match /* Internal Use Only */ ) {
	var i,
		setMatchers = [],
		elementMatchers = [],
		cached = compilerCache[ selector + " " ];

	if ( !cached ) {
		// Generate a function of recursive functions that can be used to check each element
		if ( !match ) {
			match = tokenize( selector );
		}
		i = match.length;
		while ( i-- ) {
			cached = matcherFromTokens( match[i] );
			if ( cached[ expando ] ) {
				setMatchers.push( cached );
			} else {
				elementMatchers.push( cached );
			}
		}

		// Cache the compiled function
		cached = compilerCache( selector, matcherFromGroupMatchers( elementMatchers, setMatchers ) );

		// Save selector and tokenization
		cached.selector = selector;
	}
	return cached;
};

/**
 * A low-level selection function that works with Sizzle's compiled
 *  selector functions
 * @param {String|Function} selector A selector or a pre-compiled
 *  selector function built with Sizzle.compile
 * @param {Element} context
 * @param {Array} [results]
 * @param {Array} [seed] A set of elements to match against
 */
select = Sizzle.select = function( selector, context, results, seed ) {
	var i, tokens, token, type, find,
		compiled = typeof selector === "function" && selector,
		match = !seed && tokenize( (selector = compiled.selector || selector) );

	results = results || [];

	// Try to minimize operations if there is no seed and only one group
	if ( match.length === 1 ) {

		// Take a shortcut and set the context if the root selector is an ID
		tokens = match[0] = match[0].slice( 0 );
		if ( tokens.length > 2 && (token = tokens[0]).type === "ID" &&
				support.getById && context.nodeType === 9 && documentIsHTML &&
				Expr.relative[ tokens[1].type ] ) {

			context = ( Expr.find["ID"]( token.matches[0].replace(runescape, funescape), context ) || [] )[0];
			if ( !context ) {
				return results;

			// Precompiled matchers will still verify ancestry, so step up a level
			} else if ( compiled ) {
				context = context.parentNode;
			}

			selector = selector.slice( tokens.shift().value.length );
		}

		// Fetch a seed set for right-to-left matching
		i = matchExpr["needsContext"].test( selector ) ? 0 : tokens.length;
		while ( i-- ) {
			token = tokens[i];

			// Abort if we hit a combinator
			if ( Expr.relative[ (type = token.type) ] ) {
				break;
			}
			if ( (find = Expr.find[ type ]) ) {
				// Search, expanding context for leading sibling combinators
				if ( (seed = find(
					token.matches[0].replace( runescape, funescape ),
					rsibling.test( tokens[0].type ) && testContext( context.parentNode ) || context
				)) ) {

					// If seed is empty or no tokens remain, we can return early
					tokens.splice( i, 1 );
					selector = seed.length && toSelector( tokens );
					if ( !selector ) {
						push.apply( results, seed );
						return results;
					}

					break;
				}
			}
		}
	}

	// Compile and execute a filtering function if one is not provided
	// Provide `match` to avoid retokenization if we modified the selector above
	( compiled || compile( selector, match ) )(
		seed,
		context,
		!documentIsHTML,
		results,
		rsibling.test( selector ) && testContext( context.parentNode ) || context
	);
	return results;
};

// One-time assignments

// Sort stability
support.sortStable = expando.split("").sort( sortOrder ).join("") === expando;

// Support: Chrome<14
// Always assume duplicates if they aren't passed to the comparison function
support.detectDuplicates = !!hasDuplicate;

// Initialize against the default document
setDocument();

// Support: Webkit<537.32 - Safari 6.0.3/Chrome 25 (fixed in Chrome 27)
// Detached nodes confoundingly follow *each other*
support.sortDetached = assert(function( div1 ) {
	// Should return 1, but returns 4 (following)
	return div1.compareDocumentPosition( document.createElement("div") ) & 1;
});

// Support: IE<8
// Prevent attribute/property "interpolation"
// http://msdn.microsoft.com/en-us/library/ms536429%28VS.85%29.aspx
if ( !assert(function( div ) {
	div.innerHTML = "<a href='#'></a>";
	return div.firstChild.getAttribute("href") === "#" ;
}) ) {
	addHandle( "type|href|height|width", function( elem, name, isXML ) {
		if ( !isXML ) {
			return elem.getAttribute( name, name.toLowerCase() === "type" ? 1 : 2 );
		}
	});
}

// Support: IE<9
// Use defaultValue in place of getAttribute("value")
if ( !support.attributes || !assert(function( div ) {
	div.innerHTML = "<input/>";
	div.firstChild.setAttribute( "value", "" );
	return div.firstChild.getAttribute( "value" ) === "";
}) ) {
	addHandle( "value", function( elem, name, isXML ) {
		if ( !isXML && elem.nodeName.toLowerCase() === "input" ) {
			return elem.defaultValue;
		}
	});
}

// Support: IE<9
// Use getAttributeNode to fetch booleans when getAttribute lies
if ( !assert(function( div ) {
	return div.getAttribute("disabled") == null;
}) ) {
	addHandle( booleans, function( elem, name, isXML ) {
		var val;
		if ( !isXML ) {
			return elem[ name ] === true ? name.toLowerCase() :
					(val = elem.getAttributeNode( name )) && val.specified ?
					val.value :
				null;
		}
	});
}

return Sizzle;

})( window );



jQuery.find = Sizzle;
jQuery.expr = Sizzle.selectors;
jQuery.expr[":"] = jQuery.expr.pseudos;
jQuery.unique = Sizzle.uniqueSort;
jQuery.text = Sizzle.getText;
jQuery.isXMLDoc = Sizzle.isXML;
jQuery.contains = Sizzle.contains;



var rneedsContext = jQuery.expr.match.needsContext;

var rsingleTag = (/^<(\w+)\s*\/?>(?:<\/\1>|)$/);



var risSimple = /^.[^:#\[\.,]*$/;

// Implement the identical functionality for filter and not
function winnow( elements, qualifier, not ) {
	if ( jQuery.isFunction( qualifier ) ) {
		return jQuery.grep( elements, function( elem, i ) {
			/* jshint -W018 */
			return !!qualifier.call( elem, i, elem ) !== not;
		});

	}

	if ( qualifier.nodeType ) {
		return jQuery.grep( elements, function( elem ) {
			return ( elem === qualifier ) !== not;
		});

	}

	if ( typeof qualifier === "string" ) {
		if ( risSimple.test( qualifier ) ) {
			return jQuery.filter( qualifier, elements, not );
		}

		qualifier = jQuery.filter( qualifier, elements );
	}

	return jQuery.grep( elements, function( elem ) {
		return ( indexOf.call( qualifier, elem ) >= 0 ) !== not;
	});
}

jQuery.filter = function( expr, elems, not ) {
	var elem = elems[ 0 ];

	if ( not ) {
		expr = ":not(" + expr + ")";
	}

	return elems.length === 1 && elem.nodeType === 1 ?
		jQuery.find.matchesSelector( elem, expr ) ? [ elem ] : [] :
		jQuery.find.matches( expr, jQuery.grep( elems, function( elem ) {
			return elem.nodeType === 1;
		}));
};

jQuery.fn.extend({
	find: function( selector ) {
		var i,
			len = this.length,
			ret = [],
			self = this;

		if ( typeof selector !== "string" ) {
			return this.pushStack( jQuery( selector ).filter(function() {
				for ( i = 0; i < len; i++ ) {
					if ( jQuery.contains( self[ i ], this ) ) {
						return true;
					}
				}
			}) );
		}

		for ( i = 0; i < len; i++ ) {
			jQuery.find( selector, self[ i ], ret );
		}

		// Needed because $( selector, context ) becomes $( context ).find( selector )
		ret = this.pushStack( len > 1 ? jQuery.unique( ret ) : ret );
		ret.selector = this.selector ? this.selector + " " + selector : selector;
		return ret;
	},
	filter: function( selector ) {
		return this.pushStack( winnow(this, selector || [], false) );
	},
	not: function( selector ) {
		return this.pushStack( winnow(this, selector || [], true) );
	},
	is: function( selector ) {
		return !!winnow(
			this,

			// If this is a positional/relative selector, check membership in the returned set
			// so $("p:first").is("p:last") won't return true for a doc with two "p".
			typeof selector === "string" && rneedsContext.test( selector ) ?
				jQuery( selector ) :
				selector || [],
			false
		).length;
	}
});


// Initialize a jQuery object


// A central reference to the root jQuery(document)
var rootjQuery,

	// A simple way to check for HTML strings
	// Prioritize #id over <tag> to avoid XSS via location.hash (#9521)
	// Strict HTML recognition (#11290: must start with <)
	rquickExpr = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,

	init = jQuery.fn.init = function( selector, context ) {
		var match, elem;

		// HANDLE: $(""), $(null), $(undefined), $(false)
		if ( !selector ) {
			return this;
		}

		// Handle HTML strings
		if ( typeof selector === "string" ) {
			if ( selector[0] === "<" && selector[ selector.length - 1 ] === ">" && selector.length >= 3 ) {
				// Assume that strings that start and end with <> are HTML and skip the regex check
				match = [ null, selector, null ];

			} else {
				match = rquickExpr.exec( selector );
			}

			// Match html or make sure no context is specified for #id
			if ( match && (match[1] || !context) ) {

				// HANDLE: $(html) -> $(array)
				if ( match[1] ) {
					context = context instanceof jQuery ? context[0] : context;

					// scripts is true for back-compat
					// Intentionally let the error be thrown if parseHTML is not present
					jQuery.merge( this, jQuery.parseHTML(
						match[1],
						context && context.nodeType ? context.ownerDocument || context : document,
						true
					) );

					// HANDLE: $(html, props)
					if ( rsingleTag.test( match[1] ) && jQuery.isPlainObject( context ) ) {
						for ( match in context ) {
							// Properties of context are called as methods if possible
							if ( jQuery.isFunction( this[ match ] ) ) {
								this[ match ]( context[ match ] );

							// ...and otherwise set as attributes
							} else {
								this.attr( match, context[ match ] );
							}
						}
					}

					return this;

				// HANDLE: $(#id)
				} else {
					elem = document.getElementById( match[2] );

					// Check parentNode to catch when Blackberry 4.6 returns
					// nodes that are no longer in the document #6963
					if ( elem && elem.parentNode ) {
						// Inject the element directly into the jQuery object
						this.length = 1;
						this[0] = elem;
					}

					this.context = document;
					this.selector = selector;
					return this;
				}

			// HANDLE: $(expr, $(...))
			} else if ( !context || context.jquery ) {
				return ( context || rootjQuery ).find( selector );

			// HANDLE: $(expr, context)
			// (which is just equivalent to: $(context).find(expr)
			} else {
				return this.constructor( context ).find( selector );
			}

		// HANDLE: $(DOMElement)
		} else if ( selector.nodeType ) {
			this.context = this[0] = selector;
			this.length = 1;
			return this;

		// HANDLE: $(function)
		// Shortcut for document ready
		} else if ( jQuery.isFunction( selector ) ) {
			return typeof rootjQuery.ready !== "undefined" ?
				rootjQuery.ready( selector ) :
				// Execute immediately if ready is not present
				selector( jQuery );
		}

		if ( selector.selector !== undefined ) {
			this.selector = selector.selector;
			this.context = selector.context;
		}

		return jQuery.makeArray( selector, this );
	};

// Give the init function the jQuery prototype for later instantiation
init.prototype = jQuery.fn;

// Initialize central reference
rootjQuery = jQuery( document );


var rparentsprev = /^(?:parents|prev(?:Until|All))/,
	// methods guaranteed to produce a unique set when starting from a unique set
	guaranteedUnique = {
		children: true,
		contents: true,
		next: true,
		prev: true
	};

jQuery.extend({
	dir: function( elem, dir, until ) {
		var matched = [],
			truncate = until !== undefined;

		while ( (elem = elem[ dir ]) && elem.nodeType !== 9 ) {
			if ( elem.nodeType === 1 ) {
				if ( truncate && jQuery( elem ).is( until ) ) {
					break;
				}
				matched.push( elem );
			}
		}
		return matched;
	},

	sibling: function( n, elem ) {
		var matched = [];

		for ( ; n; n = n.nextSibling ) {
			if ( n.nodeType === 1 && n !== elem ) {
				matched.push( n );
			}
		}

		return matched;
	}
});

jQuery.fn.extend({
	has: function( target ) {
		var targets = jQuery( target, this ),
			l = targets.length;

		return this.filter(function() {
			var i = 0;
			for ( ; i < l; i++ ) {
				if ( jQuery.contains( this, targets[i] ) ) {
					return true;
				}
			}
		});
	},

	closest: function( selectors, context ) {
		var cur,
			i = 0,
			l = this.length,
			matched = [],
			pos = rneedsContext.test( selectors ) || typeof selectors !== "string" ?
				jQuery( selectors, context || this.context ) :
				0;

		for ( ; i < l; i++ ) {
			for ( cur = this[i]; cur && cur !== context; cur = cur.parentNode ) {
				// Always skip document fragments
				if ( cur.nodeType < 11 && (pos ?
					pos.index(cur) > -1 :

					// Don't pass non-elements to Sizzle
					cur.nodeType === 1 &&
						jQuery.find.matchesSelector(cur, selectors)) ) {

					matched.push( cur );
					break;
				}
			}
		}

		return this.pushStack( matched.length > 1 ? jQuery.unique( matched ) : matched );
	},

	// Determine the position of an element within
	// the matched set of elements
	index: function( elem ) {

		// No argument, return index in parent
		if ( !elem ) {
			return ( this[ 0 ] && this[ 0 ].parentNode ) ? this.first().prevAll().length : -1;
		}

		// index in selector
		if ( typeof elem === "string" ) {
			return indexOf.call( jQuery( elem ), this[ 0 ] );
		}

		// Locate the position of the desired element
		return indexOf.call( this,

			// If it receives a jQuery object, the first element is used
			elem.jquery ? elem[ 0 ] : elem
		);
	},

	add: function( selector, context ) {
		return this.pushStack(
			jQuery.unique(
				jQuery.merge( this.get(), jQuery( selector, context ) )
			)
		);
	},

	addBack: function( selector ) {
		return this.add( selector == null ?
			this.prevObject : this.prevObject.filter(selector)
		);
	}
});

function sibling( cur, dir ) {
	while ( (cur = cur[dir]) && cur.nodeType !== 1 ) {}
	return cur;
}

jQuery.each({
	parent: function( elem ) {
		var parent = elem.parentNode;
		return parent && parent.nodeType !== 11 ? parent : null;
	},
	parents: function( elem ) {
		return jQuery.dir( elem, "parentNode" );
	},
	parentsUntil: function( elem, i, until ) {
		return jQuery.dir( elem, "parentNode", until );
	},
	next: function( elem ) {
		return sibling( elem, "nextSibling" );
	},
	prev: function( elem ) {
		return sibling( elem, "previousSibling" );
	},
	nextAll: function( elem ) {
		return jQuery.dir( elem, "nextSibling" );
	},
	prevAll: function( elem ) {
		return jQuery.dir( elem, "previousSibling" );
	},
	nextUntil: function( elem, i, until ) {
		return jQuery.dir( elem, "nextSibling", until );
	},
	prevUntil: function( elem, i, until ) {
		return jQuery.dir( elem, "previousSibling", until );
	},
	siblings: function( elem ) {
		return jQuery.sibling( ( elem.parentNode || {} ).firstChild, elem );
	},
	children: function( elem ) {
		return jQuery.sibling( elem.firstChild );
	},
	contents: function( elem ) {
		return elem.contentDocument || jQuery.merge( [], elem.childNodes );
	}
}, function( name, fn ) {
	jQuery.fn[ name ] = function( until, selector ) {
		var matched = jQuery.map( this, fn, until );

		if ( name.slice( -5 ) !== "Until" ) {
			selector = until;
		}

		if ( selector && typeof selector === "string" ) {
			matched = jQuery.filter( selector, matched );
		}

		if ( this.length > 1 ) {
			// Remove duplicates
			if ( !guaranteedUnique[ name ] ) {
				jQuery.unique( matched );
			}

			// Reverse order for parents* and prev-derivatives
			if ( rparentsprev.test( name ) ) {
				matched.reverse();
			}
		}

		return this.pushStack( matched );
	};
});
var rnotwhite = (/\S+/g);



// String to Object options format cache
var optionsCache = {};

// Convert String-formatted options into Object-formatted ones and store in cache
function createOptions( options ) {
	var object = optionsCache[ options ] = {};
	jQuery.each( options.match( rnotwhite ) || [], function( _, flag ) {
		object[ flag ] = true;
	});
	return object;
}

/*
 * Create a callback list using the following parameters:
 *
 *	options: an optional list of space-separated options that will change how
 *			the callback list behaves or a more traditional option object
 *
 * By default a callback list will act like an event callback list and can be
 * "fired" multiple times.
 *
 * Possible options:
 *
 *	once:			will ensure the callback list can only be fired once (like a Deferred)
 *
 *	memory:			will keep track of previous values and will call any callback added
 *					after the list has been fired right away with the latest "memorized"
 *					values (like a Deferred)
 *
 *	unique:			will ensure a callback can only be added once (no duplicate in the list)
 *
 *	stopOnFalse:	interrupt callings when a callback returns false
 *
 */
jQuery.Callbacks = function( options ) {

	// Convert options from String-formatted to Object-formatted if needed
	// (we check in cache first)
	options = typeof options === "string" ?
		( optionsCache[ options ] || createOptions( options ) ) :
		jQuery.extend( {}, options );

	var // Last fire value (for non-forgettable lists)
		memory,
		// Flag to know if list was already fired
		fired,
		// Flag to know if list is currently firing
		firing,
		// First callback to fire (used internally by add and fireWith)
		firingStart,
		// End of the loop when firing
		firingLength,
		// Index of currently firing callback (modified by remove if needed)
		firingIndex,
		// Actual callback list
		list = [],
		// Stack of fire calls for repeatable lists
		stack = !options.once && [],
		// Fire callbacks
		fire = function( data ) {
			memory = options.memory && data;
			fired = true;
			firingIndex = firingStart || 0;
			firingStart = 0;
			firingLength = list.length;
			firing = true;
			for ( ; list && firingIndex < firingLength; firingIndex++ ) {
				if ( list[ firingIndex ].apply( data[ 0 ], data[ 1 ] ) === false && options.stopOnFalse ) {
					memory = false; // To prevent further calls using add
					break;
				}
			}
			firing = false;
			if ( list ) {
				if ( stack ) {
					if ( stack.length ) {
						fire( stack.shift() );
					}
				} else if ( memory ) {
					list = [];
				} else {
					self.disable();
				}
			}
		},
		// Actual Callbacks object
		self = {
			// Add a callback or a collection of callbacks to the list
			add: function() {
				if ( list ) {
					// First, we save the current length
					var start = list.length;
					(function add( args ) {
						jQuery.each( args, function( _, arg ) {
							var type = jQuery.type( arg );
							if ( type === "function" ) {
								if ( !options.unique || !self.has( arg ) ) {
									list.push( arg );
								}
							} else if ( arg && arg.length && type !== "string" ) {
								// Inspect recursively
								add( arg );
							}
						});
					})( arguments );
					// Do we need to add the callbacks to the
					// current firing batch?
					if ( firing ) {
						firingLength = list.length;
					// With memory, if we're not firing then
					// we should call right away
					} else if ( memory ) {
						firingStart = start;
						fire( memory );
					}
				}
				return this;
			},
			// Remove a callback from the list
			remove: function() {
				if ( list ) {
					jQuery.each( arguments, function( _, arg ) {
						var index;
						while ( ( index = jQuery.inArray( arg, list, index ) ) > -1 ) {
							list.splice( index, 1 );
							// Handle firing indexes
							if ( firing ) {
								if ( index <= firingLength ) {
									firingLength--;
								}
								if ( index <= firingIndex ) {
									firingIndex--;
								}
							}
						}
					});
				}
				return this;
			},
			// Check if a given callback is in the list.
			// If no argument is given, return whether or not list has callbacks attached.
			has: function( fn ) {
				return fn ? jQuery.inArray( fn, list ) > -1 : !!( list && list.length );
			},
			// Remove all callbacks from the list
			empty: function() {
				list = [];
				firingLength = 0;
				return this;
			},
			// Have the list do nothing anymore
			disable: function() {
				list = stack = memory = undefined;
				return this;
			},
			// Is it disabled?
			disabled: function() {
				return !list;
			},
			// Lock the list in its current state
			lock: function() {
				stack = undefined;
				if ( !memory ) {
					self.disable();
				}
				return this;
			},
			// Is it locked?
			locked: function() {
				return !stack;
			},
			// Call all callbacks with the given context and arguments
			fireWith: function( context, args ) {
				if ( list && ( !fired || stack ) ) {
					args = args || [];
					args = [ context, args.slice ? args.slice() : args ];
					if ( firing ) {
						stack.push( args );
					} else {
						fire( args );
					}
				}
				return this;
			},
			// Call all the callbacks with the given arguments
			fire: function() {
				self.fireWith( this, arguments );
				return this;
			},
			// To know if the callbacks have already been called at least once
			fired: function() {
				return !!fired;
			}
		};

	return self;
};


jQuery.extend({

	Deferred: function( func ) {
		var tuples = [
				// action, add listener, listener list, final state
				[ "resolve", "done", jQuery.Callbacks("once memory"), "resolved" ],
				[ "reject", "fail", jQuery.Callbacks("once memory"), "rejected" ],
				[ "notify", "progress", jQuery.Callbacks("memory") ]
			],
			state = "pending",
			promise = {
				state: function() {
					return state;
				},
				always: function() {
					deferred.done( arguments ).fail( arguments );
					return this;
				},
				then: function( /* fnDone, fnFail, fnProgress */ ) {
					var fns = arguments;
					return jQuery.Deferred(function( newDefer ) {
						jQuery.each( tuples, function( i, tuple ) {
							var fn = jQuery.isFunction( fns[ i ] ) && fns[ i ];
							// deferred[ done | fail | progress ] for forwarding actions to newDefer
							deferred[ tuple[1] ](function() {
								var returned = fn && fn.apply( this, arguments );
								if ( returned && jQuery.isFunction( returned.promise ) ) {
									returned.promise()
										.done( newDefer.resolve )
										.fail( newDefer.reject )
										.progress( newDefer.notify );
								} else {
									newDefer[ tuple[ 0 ] + "With" ]( this === promise ? newDefer.promise() : this, fn ? [ returned ] : arguments );
								}
							});
						});
						fns = null;
					}).promise();
				},
				// Get a promise for this deferred
				// If obj is provided, the promise aspect is added to the object
				promise: function( obj ) {
					return obj != null ? jQuery.extend( obj, promise ) : promise;
				}
			},
			deferred = {};

		// Keep pipe for back-compat
		promise.pipe = promise.then;

		// Add list-specific methods
		jQuery.each( tuples, function( i, tuple ) {
			var list = tuple[ 2 ],
				stateString = tuple[ 3 ];

			// promise[ done | fail | progress ] = list.add
			promise[ tuple[1] ] = list.add;

			// Handle state
			if ( stateString ) {
				list.add(function() {
					// state = [ resolved | rejected ]
					state = stateString;

				// [ reject_list | resolve_list ].disable; progress_list.lock
				}, tuples[ i ^ 1 ][ 2 ].disable, tuples[ 2 ][ 2 ].lock );
			}

			// deferred[ resolve | reject | notify ]
			deferred[ tuple[0] ] = function() {
				deferred[ tuple[0] + "With" ]( this === deferred ? promise : this, arguments );
				return this;
			};
			deferred[ tuple[0] + "With" ] = list.fireWith;
		});

		// Make the deferred a promise
		promise.promise( deferred );

		// Call given func if any
		if ( func ) {
			func.call( deferred, deferred );
		}

		// All done!
		return deferred;
	},

	// Deferred helper
	when: function( subordinate /* , ..., subordinateN */ ) {
		var i = 0,
			resolveValues = slice.call( arguments ),
			length = resolveValues.length,

			// the count of uncompleted subordinates
			remaining = length !== 1 || ( subordinate && jQuery.isFunction( subordinate.promise ) ) ? length : 0,

			// the master Deferred. If resolveValues consist of only a single Deferred, just use that.
			deferred = remaining === 1 ? subordinate : jQuery.Deferred(),

			// Update function for both resolve and progress values
			updateFunc = function( i, contexts, values ) {
				return function( value ) {
					contexts[ i ] = this;
					values[ i ] = arguments.length > 1 ? slice.call( arguments ) : value;
					if ( values === progressValues ) {
						deferred.notifyWith( contexts, values );
					} else if ( !( --remaining ) ) {
						deferred.resolveWith( contexts, values );
					}
				};
			},

			progressValues, progressContexts, resolveContexts;

		// add listeners to Deferred subordinates; treat others as resolved
		if ( length > 1 ) {
			progressValues = new Array( length );
			progressContexts = new Array( length );
			resolveContexts = new Array( length );
			for ( ; i < length; i++ ) {
				if ( resolveValues[ i ] && jQuery.isFunction( resolveValues[ i ].promise ) ) {
					resolveValues[ i ].promise()
						.done( updateFunc( i, resolveContexts, resolveValues ) )
						.fail( deferred.reject )
						.progress( updateFunc( i, progressContexts, progressValues ) );
				} else {
					--remaining;
				}
			}
		}

		// if we're not waiting on anything, resolve the master
		if ( !remaining ) {
			deferred.resolveWith( resolveContexts, resolveValues );
		}

		return deferred.promise();
	}
});


// The deferred used on DOM ready
var readyList;

jQuery.fn.ready = function( fn ) {
	// Add the callback
	jQuery.ready.promise().done( fn );

	return this;
};

jQuery.extend({
	// Is the DOM ready to be used? Set to true once it occurs.
	isReady: false,

	// A counter to track how many items to wait for before
	// the ready event fires. See #6781
	readyWait: 1,

	// Hold (or release) the ready event
	holdReady: function( hold ) {
		if ( hold ) {
			jQuery.readyWait++;
		} else {
			jQuery.ready( true );
		}
	},

	// Handle when the DOM is ready
	ready: function( wait ) {

		// Abort if there are pending holds or we're already ready
		if ( wait === true ? --jQuery.readyWait : jQuery.isReady ) {
			return;
		}

		// Remember that the DOM is ready
		jQuery.isReady = true;

		// If a normal DOM Ready event fired, decrement, and wait if need be
		if ( wait !== true && --jQuery.readyWait > 0 ) {
			return;
		}

		// If there are functions bound, to execute
		readyList.resolveWith( document, [ jQuery ] );

		// Trigger any bound ready events
		if ( jQuery.fn.triggerHandler ) {
			jQuery( document ).triggerHandler( "ready" );
			jQuery( document ).off( "ready" );
		}
	}
});

/**
 * The ready event handler and self cleanup method
 */
function completed() {
	document.removeEventListener( "DOMContentLoaded", completed, false );
	window.removeEventListener( "load", completed, false );
	jQuery.ready();
}

jQuery.ready.promise = function( obj ) {
	if ( !readyList ) {

		readyList = jQuery.Deferred();

		// Catch cases where $(document).ready() is called after the browser event has already occurred.
		// we once tried to use readyState "interactive" here, but it caused issues like the one
		// discovered by ChrisS here: http://bugs.jquery.com/ticket/12282#comment:15
		if ( document.readyState === "complete" ) {
			// Handle it asynchronously to allow scripts the opportunity to delay ready
			setTimeout( jQuery.ready );

		} else {

			// Use the handy event callback
			document.addEventListener( "DOMContentLoaded", completed, false );

			// A fallback to window.onload, that will always work
			window.addEventListener( "load", completed, false );
		}
	}
	return readyList.promise( obj );
};

// Kick off the DOM ready check even if the user does not
jQuery.ready.promise();




// Multifunctional method to get and set values of a collection
// The value/s can optionally be executed if it's a function
var access = jQuery.access = function( elems, fn, key, value, chainable, emptyGet, raw ) {
	var i = 0,
		len = elems.length,
		bulk = key == null;

	// Sets many values
	if ( jQuery.type( key ) === "object" ) {
		chainable = true;
		for ( i in key ) {
			jQuery.access( elems, fn, i, key[i], true, emptyGet, raw );
		}

	// Sets one value
	} else if ( value !== undefined ) {
		chainable = true;

		if ( !jQuery.isFunction( value ) ) {
			raw = true;
		}

		if ( bulk ) {
			// Bulk operations run against the entire set
			if ( raw ) {
				fn.call( elems, value );
				fn = null;

			// ...except when executing function values
			} else {
				bulk = fn;
				fn = function( elem, key, value ) {
					return bulk.call( jQuery( elem ), value );
				};
			}
		}

		if ( fn ) {
			for ( ; i < len; i++ ) {
				fn( elems[i], key, raw ? value : value.call( elems[i], i, fn( elems[i], key ) ) );
			}
		}
	}

	return chainable ?
		elems :

		// Gets
		bulk ?
			fn.call( elems ) :
			len ? fn( elems[0], key ) : emptyGet;
};


/**
 * Determines whether an object can have data
 */
jQuery.acceptData = function( owner ) {
	// Accepts only:
	//  - Node
	//    - Node.ELEMENT_NODE
	//    - Node.DOCUMENT_NODE
	//  - Object
	//    - Any
	/* jshint -W018 */
	return owner.nodeType === 1 || owner.nodeType === 9 || !( +owner.nodeType );
};


function Data() {
	// Support: Android < 4,
	// Old WebKit does not have Object.preventExtensions/freeze method,
	// return new empty object instead with no [[set]] accessor
	Object.defineProperty( this.cache = {}, 0, {
		get: function() {
			return {};
		}
	});

	this.expando = jQuery.expando + Math.random();
}

Data.uid = 1;
Data.accepts = jQuery.acceptData;

Data.prototype = {
	key: function( owner ) {
		// We can accept data for non-element nodes in modern browsers,
		// but we should not, see #8335.
		// Always return the key for a frozen object.
		if ( !Data.accepts( owner ) ) {
			return 0;
		}

		var descriptor = {},
			// Check if the owner object already has a cache key
			unlock = owner[ this.expando ];

		// If not, create one
		if ( !unlock ) {
			unlock = Data.uid++;

			// Secure it in a non-enumerable, non-writable property
			try {
				descriptor[ this.expando ] = { value: unlock };
				Object.defineProperties( owner, descriptor );

			// Support: Android < 4
			// Fallback to a less secure definition
			} catch ( e ) {
				descriptor[ this.expando ] = unlock;
				jQuery.extend( owner, descriptor );
			}
		}

		// Ensure the cache object
		if ( !this.cache[ unlock ] ) {
			this.cache[ unlock ] = {};
		}

		return unlock;
	},
	set: function( owner, data, value ) {
		var prop,
			// There may be an unlock assigned to this node,
			// if there is no entry for this "owner", create one inline
			// and set the unlock as though an owner entry had always existed
			unlock = this.key( owner ),
			cache = this.cache[ unlock ];

		// Handle: [ owner, key, value ] args
		if ( typeof data === "string" ) {
			cache[ data ] = value;

		// Handle: [ owner, { properties } ] args
		} else {
			// Fresh assignments by object are shallow copied
			if ( jQuery.isEmptyObject( cache ) ) {
				jQuery.extend( this.cache[ unlock ], data );
			// Otherwise, copy the properties one-by-one to the cache object
			} else {
				for ( prop in data ) {
					cache[ prop ] = data[ prop ];
				}
			}
		}
		return cache;
	},
	get: function( owner, key ) {
		// Either a valid cache is found, or will be created.
		// New caches will be created and the unlock returned,
		// allowing direct access to the newly created
		// empty data object. A valid owner object must be provided.
		var cache = this.cache[ this.key( owner ) ];

		return key === undefined ?
			cache : cache[ key ];
	},
	access: function( owner, key, value ) {
		var stored;
		// In cases where either:
		//
		//   1. No key was specified
		//   2. A string key was specified, but no value provided
		//
		// Take the "read" path and allow the get method to determine
		// which value to return, respectively either:
		//
		//   1. The entire cache object
		//   2. The data stored at the key
		//
		if ( key === undefined ||
				((key && typeof key === "string") && value === undefined) ) {

			stored = this.get( owner, key );

			return stored !== undefined ?
				stored : this.get( owner, jQuery.camelCase(key) );
		}

		// [*]When the key is not a string, or both a key and value
		// are specified, set or extend (existing objects) with either:
		//
		//   1. An object of properties
		//   2. A key and value
		//
		this.set( owner, key, value );

		// Since the "set" path can have two possible entry points
		// return the expected data based on which path was taken[*]
		return value !== undefined ? value : key;
	},
	remove: function( owner, key ) {
		var i, name, camel,
			unlock = this.key( owner ),
			cache = this.cache[ unlock ];

		if ( key === undefined ) {
			this.cache[ unlock ] = {};

		} else {
			// Support array or space separated string of keys
			if ( jQuery.isArray( key ) ) {
				// If "name" is an array of keys...
				// When data is initially created, via ("key", "val") signature,
				// keys will be converted to camelCase.
				// Since there is no way to tell _how_ a key was added, remove
				// both plain key and camelCase key. #12786
				// This will only penalize the array argument path.
				name = key.concat( key.map( jQuery.camelCase ) );
			} else {
				camel = jQuery.camelCase( key );
				// Try the string as a key before any manipulation
				if ( key in cache ) {
					name = [ key, camel ];
				} else {
					// If a key with the spaces exists, use it.
					// Otherwise, create an array by matching non-whitespace
					name = camel;
					name = name in cache ?
						[ name ] : ( name.match( rnotwhite ) || [] );
				}
			}

			i = name.length;
			while ( i-- ) {
				delete cache[ name[ i ] ];
			}
		}
	},
	hasData: function( owner ) {
		return !jQuery.isEmptyObject(
			this.cache[ owner[ this.expando ] ] || {}
		);
	},
	discard: function( owner ) {
		if ( owner[ this.expando ] ) {
			delete this.cache[ owner[ this.expando ] ];
		}
	}
};
var data_priv = new Data();

var data_user = new Data();



/*
	Implementation Summary

	1. Enforce API surface and semantic compatibility with 1.9.x branch
	2. Improve the module's maintainability by reducing the storage
		paths to a single mechanism.
	3. Use the same single mechanism to support "private" and "user" data.
	4. _Never_ expose "private" data to user code (TODO: Drop _data, _removeData)
	5. Avoid exposing implementation details on user objects (eg. expando properties)
	6. Provide a clear path for implementation upgrade to WeakMap in 2014
*/
var rbrace = /^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,
	rmultiDash = /([A-Z])/g;

function dataAttr( elem, key, data ) {
	var name;

	// If nothing was found internally, try to fetch any
	// data from the HTML5 data-* attribute
	if ( data === undefined && elem.nodeType === 1 ) {
		name = "data-" + key.replace( rmultiDash, "-$1" ).toLowerCase();
		data = elem.getAttribute( name );

		if ( typeof data === "string" ) {
			try {
				data = data === "true" ? true :
					data === "false" ? false :
					data === "null" ? null :
					// Only convert to a number if it doesn't change the string
					+data + "" === data ? +data :
					rbrace.test( data ) ? jQuery.parseJSON( data ) :
					data;
			} catch( e ) {}

			// Make sure we set the data so it isn't changed later
			data_user.set( elem, key, data );
		} else {
			data = undefined;
		}
	}
	return data;
}

jQuery.extend({
	hasData: function( elem ) {
		return data_user.hasData( elem ) || data_priv.hasData( elem );
	},

	data: function( elem, name, data ) {
		return data_user.access( elem, name, data );
	},

	removeData: function( elem, name ) {
		data_user.remove( elem, name );
	},

	// TODO: Now that all calls to _data and _removeData have been replaced
	// with direct calls to data_priv methods, these can be deprecated.
	_data: function( elem, name, data ) {
		return data_priv.access( elem, name, data );
	},

	_removeData: function( elem, name ) {
		data_priv.remove( elem, name );
	}
});

jQuery.fn.extend({
	data: function( key, value ) {
		var i, name, data,
			elem = this[ 0 ],
			attrs = elem && elem.attributes;

		// Gets all values
		if ( key === undefined ) {
			if ( this.length ) {
				data = data_user.get( elem );

				if ( elem.nodeType === 1 && !data_priv.get( elem, "hasDataAttrs" ) ) {
					i = attrs.length;
					while ( i-- ) {

						// Support: IE11+
						// The attrs elements can be null (#14894)
						if ( attrs[ i ] ) {
							name = attrs[ i ].name;
							if ( name.indexOf( "data-" ) === 0 ) {
								name = jQuery.camelCase( name.slice(5) );
								dataAttr( elem, name, data[ name ] );
							}
						}
					}
					data_priv.set( elem, "hasDataAttrs", true );
				}
			}

			return data;
		}

		// Sets multiple values
		if ( typeof key === "object" ) {
			return this.each(function() {
				data_user.set( this, key );
			});
		}

		return access( this, function( value ) {
			var data,
				camelKey = jQuery.camelCase( key );

			// The calling jQuery object (element matches) is not empty
			// (and therefore has an element appears at this[ 0 ]) and the
			// `value` parameter was not undefined. An empty jQuery object
			// will result in `undefined` for elem = this[ 0 ] which will
			// throw an exception if an attempt to read a data cache is made.
			if ( elem && value === undefined ) {
				// Attempt to get data from the cache
				// with the key as-is
				data = data_user.get( elem, key );
				if ( data !== undefined ) {
					return data;
				}

				// Attempt to get data from the cache
				// with the key camelized
				data = data_user.get( elem, camelKey );
				if ( data !== undefined ) {
					return data;
				}

				// Attempt to "discover" the data in
				// HTML5 custom data-* attrs
				data = dataAttr( elem, camelKey, undefined );
				if ( data !== undefined ) {
					return data;
				}

				// We tried really hard, but the data doesn't exist.
				return;
			}

			// Set the data...
			this.each(function() {
				// First, attempt to store a copy or reference of any
				// data that might've been store with a camelCased key.
				var data = data_user.get( this, camelKey );

				// For HTML5 data-* attribute interop, we have to
				// store property names with dashes in a camelCase form.
				// This might not apply to all properties...*
				data_user.set( this, camelKey, value );

				// *... In the case of properties that might _actually_
				// have dashes, we need to also store a copy of that
				// unchanged property.
				if ( key.indexOf("-") !== -1 && data !== undefined ) {
					data_user.set( this, key, value );
				}
			});
		}, null, value, arguments.length > 1, null, true );
	},

	removeData: function( key ) {
		return this.each(function() {
			data_user.remove( this, key );
		});
	}
});


jQuery.extend({
	queue: function( elem, type, data ) {
		var queue;

		if ( elem ) {
			type = ( type || "fx" ) + "queue";
			queue = data_priv.get( elem, type );

			// Speed up dequeue by getting out quickly if this is just a lookup
			if ( data ) {
				if ( !queue || jQuery.isArray( data ) ) {
					queue = data_priv.access( elem, type, jQuery.makeArray(data) );
				} else {
					queue.push( data );
				}
			}
			return queue || [];
		}
	},

	dequeue: function( elem, type ) {
		type = type || "fx";

		var queue = jQuery.queue( elem, type ),
			startLength = queue.length,
			fn = queue.shift(),
			hooks = jQuery._queueHooks( elem, type ),
			next = function() {
				jQuery.dequeue( elem, type );
			};

		// If the fx queue is dequeued, always remove the progress sentinel
		if ( fn === "inprogress" ) {
			fn = queue.shift();
			startLength--;
		}

		if ( fn ) {

			// Add a progress sentinel to prevent the fx queue from being
			// automatically dequeued
			if ( type === "fx" ) {
				queue.unshift( "inprogress" );
			}

			// clear up the last queue stop function
			delete hooks.stop;
			fn.call( elem, next, hooks );
		}

		if ( !startLength && hooks ) {
			hooks.empty.fire();
		}
	},

	// not intended for public consumption - generates a queueHooks object, or returns the current one
	_queueHooks: function( elem, type ) {
		var key = type + "queueHooks";
		return data_priv.get( elem, key ) || data_priv.access( elem, key, {
			empty: jQuery.Callbacks("once memory").add(function() {
				data_priv.remove( elem, [ type + "queue", key ] );
			})
		});
	}
});

jQuery.fn.extend({
	queue: function( type, data ) {
		var setter = 2;

		if ( typeof type !== "string" ) {
			data = type;
			type = "fx";
			setter--;
		}

		if ( arguments.length < setter ) {
			return jQuery.queue( this[0], type );
		}

		return data === undefined ?
			this :
			this.each(function() {
				var queue = jQuery.queue( this, type, data );

				// ensure a hooks for this queue
				jQuery._queueHooks( this, type );

				if ( type === "fx" && queue[0] !== "inprogress" ) {
					jQuery.dequeue( this, type );
				}
			});
	},
	dequeue: function( type ) {
		return this.each(function() {
			jQuery.dequeue( this, type );
		});
	},
	clearQueue: function( type ) {
		return this.queue( type || "fx", [] );
	},
	// Get a promise resolved when queues of a certain type
	// are emptied (fx is the type by default)
	promise: function( type, obj ) {
		var tmp,
			count = 1,
			defer = jQuery.Deferred(),
			elements = this,
			i = this.length,
			resolve = function() {
				if ( !( --count ) ) {
					defer.resolveWith( elements, [ elements ] );
				}
			};

		if ( typeof type !== "string" ) {
			obj = type;
			type = undefined;
		}
		type = type || "fx";

		while ( i-- ) {
			tmp = data_priv.get( elements[ i ], type + "queueHooks" );
			if ( tmp && tmp.empty ) {
				count++;
				tmp.empty.add( resolve );
			}
		}
		resolve();
		return defer.promise( obj );
	}
});
var pnum = (/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/).source;

var cssExpand = [ "Top", "Right", "Bottom", "Left" ];

var isHidden = function( elem, el ) {
		// isHidden might be called from jQuery#filter function;
		// in that case, element will be second argument
		elem = el || elem;
		return jQuery.css( elem, "display" ) === "none" || !jQuery.contains( elem.ownerDocument, elem );
	};

var rcheckableType = (/^(?:checkbox|radio)$/i);



(function() {
	var fragment = document.createDocumentFragment(),
		div = fragment.appendChild( document.createElement( "div" ) ),
		input = document.createElement( "input" );

	// #11217 - WebKit loses check when the name is after the checked attribute
	// Support: Windows Web Apps (WWA)
	// `name` and `type` need .setAttribute for WWA
	input.setAttribute( "type", "radio" );
	input.setAttribute( "checked", "checked" );
	input.setAttribute( "name", "t" );

	div.appendChild( input );

	// Support: Safari 5.1, iOS 5.1, Android 4.x, Android 2.3
	// old WebKit doesn't clone checked state correctly in fragments
	support.checkClone = div.cloneNode( true ).cloneNode( true ).lastChild.checked;

	// Make sure textarea (and checkbox) defaultValue is properly cloned
	// Support: IE9-IE11+
	div.innerHTML = "<textarea>x</textarea>";
	support.noCloneChecked = !!div.cloneNode( true ).lastChild.defaultValue;
})();
var strundefined = typeof undefined;



support.focusinBubbles = "onfocusin" in window;


var
	rkeyEvent = /^key/,
	rmouseEvent = /^(?:mouse|pointer|contextmenu)|click/,
	rfocusMorph = /^(?:focusinfocus|focusoutblur)$/,
	rtypenamespace = /^([^.]*)(?:\.(.+)|)$/;

function returnTrue() {
	return true;
}

function returnFalse() {
	return false;
}

function safeActiveElement() {
	try {
		return document.activeElement;
	} catch ( err ) { }
}

/*
 * Helper functions for managing events -- not part of the public interface.
 * Props to Dean Edwards' addEvent library for many of the ideas.
 */
jQuery.event = {

	global: {},

	add: function( elem, types, handler, data, selector ) {

		var handleObjIn, eventHandle, tmp,
			events, t, handleObj,
			special, handlers, type, namespaces, origType,
			elemData = data_priv.get( elem );

		// Don't attach events to noData or text/comment nodes (but allow plain objects)
		if ( !elemData ) {
			return;
		}

		// Caller can pass in an object of custom data in lieu of the handler
		if ( handler.handler ) {
			handleObjIn = handler;
			handler = handleObjIn.handler;
			selector = handleObjIn.selector;
		}

		// Make sure that the handler has a unique ID, used to find/remove it later
		if ( !handler.guid ) {
			handler.guid = jQuery.guid++;
		}

		// Init the element's event structure and main handler, if this is the first
		if ( !(events = elemData.events) ) {
			events = elemData.events = {};
		}
		if ( !(eventHandle = elemData.handle) ) {
			eventHandle = elemData.handle = function( e ) {
				// Discard the second event of a jQuery.event.trigger() and
				// when an event is called after a page has unloaded
				return typeof jQuery !== strundefined && jQuery.event.triggered !== e.type ?
					jQuery.event.dispatch.apply( elem, arguments ) : undefined;
			};
		}

		// Handle multiple events separated by a space
		types = ( types || "" ).match( rnotwhite ) || [ "" ];
		t = types.length;
		while ( t-- ) {
			tmp = rtypenamespace.exec( types[t] ) || [];
			type = origType = tmp[1];
			namespaces = ( tmp[2] || "" ).split( "." ).sort();

			// There *must* be a type, no attaching namespace-only handlers
			if ( !type ) {
				continue;
			}

			// If event changes its type, use the special event handlers for the changed type
			special = jQuery.event.special[ type ] || {};

			// If selector defined, determine special event api type, otherwise given type
			type = ( selector ? special.delegateType : special.bindType ) || type;

			// Update special based on newly reset type
			special = jQuery.event.special[ type ] || {};

			// handleObj is passed to all event handlers
			handleObj = jQuery.extend({
				type: type,
				origType: origType,
				data: data,
				handler: handler,
				guid: handler.guid,
				selector: selector,
				needsContext: selector && jQuery.expr.match.needsContext.test( selector ),
				namespace: namespaces.join(".")
			}, handleObjIn );

			// Init the event handler queue if we're the first
			if ( !(handlers = events[ type ]) ) {
				handlers = events[ type ] = [];
				handlers.delegateCount = 0;

				// Only use addEventListener if the special events handler returns false
				if ( !special.setup || special.setup.call( elem, data, namespaces, eventHandle ) === false ) {
					if ( elem.addEventListener ) {
						elem.addEventListener( type, eventHandle, false );
					}
				}
			}

			if ( special.add ) {
				special.add.call( elem, handleObj );

				if ( !handleObj.handler.guid ) {
					handleObj.handler.guid = handler.guid;
				}
			}

			// Add to the element's handler list, delegates in front
			if ( selector ) {
				handlers.splice( handlers.delegateCount++, 0, handleObj );
			} else {
				handlers.push( handleObj );
			}

			// Keep track of which events have ever been used, for event optimization
			jQuery.event.global[ type ] = true;
		}

	},

	// Detach an event or set of events from an element
	remove: function( elem, types, handler, selector, mappedTypes ) {

		var j, origCount, tmp,
			events, t, handleObj,
			special, handlers, type, namespaces, origType,
			elemData = data_priv.hasData( elem ) && data_priv.get( elem );

		if ( !elemData || !(events = elemData.events) ) {
			return;
		}

		// Once for each type.namespace in types; type may be omitted
		types = ( types || "" ).match( rnotwhite ) || [ "" ];
		t = types.length;
		while ( t-- ) {
			tmp = rtypenamespace.exec( types[t] ) || [];
			type = origType = tmp[1];
			namespaces = ( tmp[2] || "" ).split( "." ).sort();

			// Unbind all events (on this namespace, if provided) for the element
			if ( !type ) {
				for ( type in events ) {
					jQuery.event.remove( elem, type + types[ t ], handler, selector, true );
				}
				continue;
			}

			special = jQuery.event.special[ type ] || {};
			type = ( selector ? special.delegateType : special.bindType ) || type;
			handlers = events[ type ] || [];
			tmp = tmp[2] && new RegExp( "(^|\\.)" + namespaces.join("\\.(?:.*\\.|)") + "(\\.|$)" );

			// Remove matching events
			origCount = j = handlers.length;
			while ( j-- ) {
				handleObj = handlers[ j ];

				if ( ( mappedTypes || origType === handleObj.origType ) &&
					( !handler || handler.guid === handleObj.guid ) &&
					( !tmp || tmp.test( handleObj.namespace ) ) &&
					( !selector || selector === handleObj.selector || selector === "**" && handleObj.selector ) ) {
					handlers.splice( j, 1 );

					if ( handleObj.selector ) {
						handlers.delegateCount--;
					}
					if ( special.remove ) {
						special.remove.call( elem, handleObj );
					}
				}
			}

			// Remove generic event handler if we removed something and no more handlers exist
			// (avoids potential for endless recursion during removal of special event handlers)
			if ( origCount && !handlers.length ) {
				if ( !special.teardown || special.teardown.call( elem, namespaces, elemData.handle ) === false ) {
					jQuery.removeEvent( elem, type, elemData.handle );
				}

				delete events[ type ];
			}
		}

		// Remove the expando if it's no longer used
		if ( jQuery.isEmptyObject( events ) ) {
			delete elemData.handle;
			data_priv.remove( elem, "events" );
		}
	},

	trigger: function( event, data, elem, onlyHandlers ) {

		var i, cur, tmp, bubbleType, ontype, handle, special,
			eventPath = [ elem || document ],
			type = hasOwn.call( event, "type" ) ? event.type : event,
			namespaces = hasOwn.call( event, "namespace" ) ? event.namespace.split(".") : [];

		cur = tmp = elem = elem || document;

		// Don't do events on text and comment nodes
		if ( elem.nodeType === 3 || elem.nodeType === 8 ) {
			return;
		}

		// focus/blur morphs to focusin/out; ensure we're not firing them right now
		if ( rfocusMorph.test( type + jQuery.event.triggered ) ) {
			return;
		}

		if ( type.indexOf(".") >= 0 ) {
			// Namespaced trigger; create a regexp to match event type in handle()
			namespaces = type.split(".");
			type = namespaces.shift();
			namespaces.sort();
		}
		ontype = type.indexOf(":") < 0 && "on" + type;

		// Caller can pass in a jQuery.Event object, Object, or just an event type string
		event = event[ jQuery.expando ] ?
			event :
			new jQuery.Event( type, typeof event === "object" && event );

		// Trigger bitmask: & 1 for native handlers; & 2 for jQuery (always true)
		event.isTrigger = onlyHandlers ? 2 : 3;
		event.namespace = namespaces.join(".");
		event.namespace_re = event.namespace ?
			new RegExp( "(^|\\.)" + namespaces.join("\\.(?:.*\\.|)") + "(\\.|$)" ) :
			null;

		// Clean up the event in case it is being reused
		event.result = undefined;
		if ( !event.target ) {
			event.target = elem;
		}

		// Clone any incoming data and prepend the event, creating the handler arg list
		data = data == null ?
			[ event ] :
			jQuery.makeArray( data, [ event ] );

		// Allow special events to draw outside the lines
		special = jQuery.event.special[ type ] || {};
		if ( !onlyHandlers && special.trigger && special.trigger.apply( elem, data ) === false ) {
			return;
		}

		// Determine event propagation path in advance, per W3C events spec (#9951)
		// Bubble up to document, then to window; watch for a global ownerDocument var (#9724)
		if ( !onlyHandlers && !special.noBubble && !jQuery.isWindow( elem ) ) {

			bubbleType = special.delegateType || type;
			if ( !rfocusMorph.test( bubbleType + type ) ) {
				cur = cur.parentNode;
			}
			for ( ; cur; cur = cur.parentNode ) {
				eventPath.push( cur );
				tmp = cur;
			}

			// Only add window if we got to document (e.g., not plain obj or detached DOM)
			if ( tmp === (elem.ownerDocument || document) ) {
				eventPath.push( tmp.defaultView || tmp.parentWindow || window );
			}
		}

		// Fire handlers on the event path
		i = 0;
		while ( (cur = eventPath[i++]) && !event.isPropagationStopped() ) {

			event.type = i > 1 ?
				bubbleType :
				special.bindType || type;

			// jQuery handler
			handle = ( data_priv.get( cur, "events" ) || {} )[ event.type ] && data_priv.get( cur, "handle" );
			if ( handle ) {
				handle.apply( cur, data );
			}

			// Native handler
			handle = ontype && cur[ ontype ];
			if ( handle && handle.apply && jQuery.acceptData( cur ) ) {
				event.result = handle.apply( cur, data );
				if ( event.result === false ) {
					event.preventDefault();
				}
			}
		}
		event.type = type;

		// If nobody prevented the default action, do it now
		if ( !onlyHandlers && !event.isDefaultPrevented() ) {

			if ( (!special._default || special._default.apply( eventPath.pop(), data ) === false) &&
				jQuery.acceptData( elem ) ) {

				// Call a native DOM method on the target with the same name name as the event.
				// Don't do default actions on window, that's where global variables be (#6170)
				if ( ontype && jQuery.isFunction( elem[ type ] ) && !jQuery.isWindow( elem ) ) {

					// Don't re-trigger an onFOO event when we call its FOO() method
					tmp = elem[ ontype ];

					if ( tmp ) {
						elem[ ontype ] = null;
					}

					// Prevent re-triggering of the same event, since we already bubbled it above
					jQuery.event.triggered = type;
					elem[ type ]();
					jQuery.event.triggered = undefined;

					if ( tmp ) {
						elem[ ontype ] = tmp;
					}
				}
			}
		}

		return event.result;
	},

	dispatch: function( event ) {

		// Make a writable jQuery.Event from the native event object
		event = jQuery.event.fix( event );

		var i, j, ret, matched, handleObj,
			handlerQueue = [],
			args = slice.call( arguments ),
			handlers = ( data_priv.get( this, "events" ) || {} )[ event.type ] || [],
			special = jQuery.event.special[ event.type ] || {};

		// Use the fix-ed jQuery.Event rather than the (read-only) native event
		args[0] = event;
		event.delegateTarget = this;

		// Call the preDispatch hook for the mapped type, and let it bail if desired
		if ( special.preDispatch && special.preDispatch.call( this, event ) === false ) {
			return;
		}

		// Determine handlers
		handlerQueue = jQuery.event.handlers.call( this, event, handlers );

		// Run delegates first; they may want to stop propagation beneath us
		i = 0;
		while ( (matched = handlerQueue[ i++ ]) && !event.isPropagationStopped() ) {
			event.currentTarget = matched.elem;

			j = 0;
			while ( (handleObj = matched.handlers[ j++ ]) && !event.isImmediatePropagationStopped() ) {

				// Triggered event must either 1) have no namespace, or
				// 2) have namespace(s) a subset or equal to those in the bound event (both can have no namespace).
				if ( !event.namespace_re || event.namespace_re.test( handleObj.namespace ) ) {

					event.handleObj = handleObj;
					event.data = handleObj.data;

					ret = ( (jQuery.event.special[ handleObj.origType ] || {}).handle || handleObj.handler )
							.apply( matched.elem, args );

					if ( ret !== undefined ) {
						if ( (event.result = ret) === false ) {
							event.preventDefault();
							event.stopPropagation();
						}
					}
				}
			}
		}

		// Call the postDispatch hook for the mapped type
		if ( special.postDispatch ) {
			special.postDispatch.call( this, event );
		}

		return event.result;
	},

	handlers: function( event, handlers ) {
		var i, matches, sel, handleObj,
			handlerQueue = [],
			delegateCount = handlers.delegateCount,
			cur = event.target;

		// Find delegate handlers
		// Black-hole SVG <use> instance trees (#13180)
		// Avoid non-left-click bubbling in Firefox (#3861)
		if ( delegateCount && cur.nodeType && (!event.button || event.type !== "click") ) {

			for ( ; cur !== this; cur = cur.parentNode || this ) {

				// Don't process clicks on disabled elements (#6911, #8165, #11382, #11764)
				if ( cur.disabled !== true || event.type !== "click" ) {
					matches = [];
					for ( i = 0; i < delegateCount; i++ ) {
						handleObj = handlers[ i ];

						// Don't conflict with Object.prototype properties (#13203)
						sel = handleObj.selector + " ";

						if ( matches[ sel ] === undefined ) {
							matches[ sel ] = handleObj.needsContext ?
								jQuery( sel, this ).index( cur ) >= 0 :
								jQuery.find( sel, this, null, [ cur ] ).length;
						}
						if ( matches[ sel ] ) {
							matches.push( handleObj );
						}
					}
					if ( matches.length ) {
						handlerQueue.push({ elem: cur, handlers: matches });
					}
				}
			}
		}

		// Add the remaining (directly-bound) handlers
		if ( delegateCount < handlers.length ) {
			handlerQueue.push({ elem: this, handlers: handlers.slice( delegateCount ) });
		}

		return handlerQueue;
	},

	// Includes some event props shared by KeyEvent and MouseEvent
	props: "altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),

	fixHooks: {},

	keyHooks: {
		props: "char charCode key keyCode".split(" "),
		filter: function( event, original ) {

			// Add which for key events
			if ( event.which == null ) {
				event.which = original.charCode != null ? original.charCode : original.keyCode;
			}

			return event;
		}
	},

	mouseHooks: {
		props: "button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
		filter: function( event, original ) {
			var eventDoc, doc, body,
				button = original.button;

			// Calculate pageX/Y if missing and clientX/Y available
			if ( event.pageX == null && original.clientX != null ) {
				eventDoc = event.target.ownerDocument || document;
				doc = eventDoc.documentElement;
				body = eventDoc.body;

				event.pageX = original.clientX + ( doc && doc.scrollLeft || body && body.scrollLeft || 0 ) - ( doc && doc.clientLeft || body && body.clientLeft || 0 );
				event.pageY = original.clientY + ( doc && doc.scrollTop  || body && body.scrollTop  || 0 ) - ( doc && doc.clientTop  || body && body.clientTop  || 0 );
			}

			// Add which for click: 1 === left; 2 === middle; 3 === right
			// Note: button is not normalized, so don't use it
			if ( !event.which && button !== undefined ) {
				event.which = ( button & 1 ? 1 : ( button & 2 ? 3 : ( button & 4 ? 2 : 0 ) ) );
			}

			return event;
		}
	},

	fix: function( event ) {
		if ( event[ jQuery.expando ] ) {
			return event;
		}

		// Create a writable copy of the event object and normalize some properties
		var i, prop, copy,
			type = event.type,
			originalEvent = event,
			fixHook = this.fixHooks[ type ];

		if ( !fixHook ) {
			this.fixHooks[ type ] = fixHook =
				rmouseEvent.test( type ) ? this.mouseHooks :
				rkeyEvent.test( type ) ? this.keyHooks :
				{};
		}
		copy = fixHook.props ? this.props.concat( fixHook.props ) : this.props;

		event = new jQuery.Event( originalEvent );

		i = copy.length;
		while ( i-- ) {
			prop = copy[ i ];
			event[ prop ] = originalEvent[ prop ];
		}

		// Support: Cordova 2.5 (WebKit) (#13255)
		// All events should have a target; Cordova deviceready doesn't
		if ( !event.target ) {
			event.target = document;
		}

		// Support: Safari 6.0+, Chrome < 28
		// Target should not be a text node (#504, #13143)
		if ( event.target.nodeType === 3 ) {
			event.target = event.target.parentNode;
		}

		return fixHook.filter ? fixHook.filter( event, originalEvent ) : event;
	},

	special: {
		load: {
			// Prevent triggered image.load events from bubbling to window.load
			noBubble: true
		},
		focus: {
			// Fire native event if possible so blur/focus sequence is correct
			trigger: function() {
				if ( this !== safeActiveElement() && this.focus ) {
					this.focus();
					return false;
				}
			},
			delegateType: "focusin"
		},
		blur: {
			trigger: function() {
				if ( this === safeActiveElement() && this.blur ) {
					this.blur();
					return false;
				}
			},
			delegateType: "focusout"
		},
		click: {
			// For checkbox, fire native event so checked state will be right
			trigger: function() {
				if ( this.type === "checkbox" && this.click && jQuery.nodeName( this, "input" ) ) {
					this.click();
					return false;
				}
			},

			// For cross-browser consistency, don't fire native .click() on links
			_default: function( event ) {
				return jQuery.nodeName( event.target, "a" );
			}
		},

		beforeunload: {
			postDispatch: function( event ) {

				// Support: Firefox 20+
				// Firefox doesn't alert if the returnValue field is not set.
				if ( event.result !== undefined && event.originalEvent ) {
					event.originalEvent.returnValue = event.result;
				}
			}
		}
	},

	simulate: function( type, elem, event, bubble ) {
		// Piggyback on a donor event to simulate a different one.
		// Fake originalEvent to avoid donor's stopPropagation, but if the
		// simulated event prevents default then we do the same on the donor.
		var e = jQuery.extend(
			new jQuery.Event(),
			event,
			{
				type: type,
				isSimulated: true,
				originalEvent: {}
			}
		);
		if ( bubble ) {
			jQuery.event.trigger( e, null, elem );
		} else {
			jQuery.event.dispatch.call( elem, e );
		}
		if ( e.isDefaultPrevented() ) {
			event.preventDefault();
		}
	}
};

jQuery.removeEvent = function( elem, type, handle ) {
	if ( elem.removeEventListener ) {
		elem.removeEventListener( type, handle, false );
	}
};

jQuery.Event = function( src, props ) {
	// Allow instantiation without the 'new' keyword
	if ( !(this instanceof jQuery.Event) ) {
		return new jQuery.Event( src, props );
	}

	// Event object
	if ( src && src.type ) {
		this.originalEvent = src;
		this.type = src.type;

		// Events bubbling up the document may have been marked as prevented
		// by a handler lower down the tree; reflect the correct value.
		this.isDefaultPrevented = src.defaultPrevented ||
				src.defaultPrevented === undefined &&
				// Support: Android < 4.0
				src.returnValue === false ?
			returnTrue :
			returnFalse;

	// Event type
	} else {
		this.type = src;
	}

	// Put explicitly provided properties onto the event object
	if ( props ) {
		jQuery.extend( this, props );
	}

	// Create a timestamp if incoming event doesn't have one
	this.timeStamp = src && src.timeStamp || jQuery.now();

	// Mark it as fixed
	this[ jQuery.expando ] = true;
};

// jQuery.Event is based on DOM3 Events as specified by the ECMAScript Language Binding
// http://www.w3.org/TR/2003/WD-DOM-Level-3-Events-20030331/ecma-script-binding.html
jQuery.Event.prototype = {
	isDefaultPrevented: returnFalse,
	isPropagationStopped: returnFalse,
	isImmediatePropagationStopped: returnFalse,

	preventDefault: function() {
		var e = this.originalEvent;

		this.isDefaultPrevented = returnTrue;

		if ( e && e.preventDefault ) {
			e.preventDefault();
		}
	},
	stopPropagation: function() {
		var e = this.originalEvent;

		this.isPropagationStopped = returnTrue;

		if ( e && e.stopPropagation ) {
			e.stopPropagation();
		}
	},
	stopImmediatePropagation: function() {
		var e = this.originalEvent;

		this.isImmediatePropagationStopped = returnTrue;

		if ( e && e.stopImmediatePropagation ) {
			e.stopImmediatePropagation();
		}

		this.stopPropagation();
	}
};

// Create mouseenter/leave events using mouseover/out and event-time checks
// Support: Chrome 15+
jQuery.each({
	mouseenter: "mouseover",
	mouseleave: "mouseout",
	pointerenter: "pointerover",
	pointerleave: "pointerout"
}, function( orig, fix ) {
	jQuery.event.special[ orig ] = {
		delegateType: fix,
		bindType: fix,

		handle: function( event ) {
			var ret,
				target = this,
				related = event.relatedTarget,
				handleObj = event.handleObj;

			// For mousenter/leave call the handler if related is outside the target.
			// NB: No relatedTarget if the mouse left/entered the browser window
			if ( !related || (related !== target && !jQuery.contains( target, related )) ) {
				event.type = handleObj.origType;
				ret = handleObj.handler.apply( this, arguments );
				event.type = fix;
			}
			return ret;
		}
	};
});

// Create "bubbling" focus and blur events
// Support: Firefox, Chrome, Safari
if ( !support.focusinBubbles ) {
	jQuery.each({ focus: "focusin", blur: "focusout" }, function( orig, fix ) {

		// Attach a single capturing handler on the document while someone wants focusin/focusout
		var handler = function( event ) {
				jQuery.event.simulate( fix, event.target, jQuery.event.fix( event ), true );
			};

		jQuery.event.special[ fix ] = {
			setup: function() {
				var doc = this.ownerDocument || this,
					attaches = data_priv.access( doc, fix );

				if ( !attaches ) {
					doc.addEventListener( orig, handler, true );
				}
				data_priv.access( doc, fix, ( attaches || 0 ) + 1 );
			},
			teardown: function() {
				var doc = this.ownerDocument || this,
					attaches = data_priv.access( doc, fix ) - 1;

				if ( !attaches ) {
					doc.removeEventListener( orig, handler, true );
					data_priv.remove( doc, fix );

				} else {
					data_priv.access( doc, fix, attaches );
				}
			}
		};
	});
}

jQuery.fn.extend({

	on: function( types, selector, data, fn, /*INTERNAL*/ one ) {
		var origFn, type;

		// Types can be a map of types/handlers
		if ( typeof types === "object" ) {
			// ( types-Object, selector, data )
			if ( typeof selector !== "string" ) {
				// ( types-Object, data )
				data = data || selector;
				selector = undefined;
			}
			for ( type in types ) {
				this.on( type, selector, data, types[ type ], one );
			}
			return this;
		}

		if ( data == null && fn == null ) {
			// ( types, fn )
			fn = selector;
			data = selector = undefined;
		} else if ( fn == null ) {
			if ( typeof selector === "string" ) {
				// ( types, selector, fn )
				fn = data;
				data = undefined;
			} else {
				// ( types, data, fn )
				fn = data;
				data = selector;
				selector = undefined;
			}
		}
		if ( fn === false ) {
			fn = returnFalse;
		} else if ( !fn ) {
			return this;
		}

		if ( one === 1 ) {
			origFn = fn;
			fn = function( event ) {
				// Can use an empty set, since event contains the info
				jQuery().off( event );
				return origFn.apply( this, arguments );
			};
			// Use same guid so caller can remove using origFn
			fn.guid = origFn.guid || ( origFn.guid = jQuery.guid++ );
		}
		return this.each( function() {
			jQuery.event.add( this, types, fn, data, selector );
		});
	},
	one: function( types, selector, data, fn ) {
		return this.on( types, selector, data, fn, 1 );
	},
	off: function( types, selector, fn ) {
		var handleObj, type;
		if ( types && types.preventDefault && types.handleObj ) {
			// ( event )  dispatched jQuery.Event
			handleObj = types.handleObj;
			jQuery( types.delegateTarget ).off(
				handleObj.namespace ? handleObj.origType + "." + handleObj.namespace : handleObj.origType,
				handleObj.selector,
				handleObj.handler
			);
			return this;
		}
		if ( typeof types === "object" ) {
			// ( types-object [, selector] )
			for ( type in types ) {
				this.off( type, selector, types[ type ] );
			}
			return this;
		}
		if ( selector === false || typeof selector === "function" ) {
			// ( types [, fn] )
			fn = selector;
			selector = undefined;
		}
		if ( fn === false ) {
			fn = returnFalse;
		}
		return this.each(function() {
			jQuery.event.remove( this, types, fn, selector );
		});
	},

	trigger: function( type, data ) {
		return this.each(function() {
			jQuery.event.trigger( type, data, this );
		});
	},
	triggerHandler: function( type, data ) {
		var elem = this[0];
		if ( elem ) {
			return jQuery.event.trigger( type, data, elem, true );
		}
	}
});


var
	rxhtmlTag = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,
	rtagName = /<([\w:]+)/,
	rhtml = /<|&#?\w+;/,
	rnoInnerhtml = /<(?:script|style|link)/i,
	// checked="checked" or checked
	rchecked = /checked\s*(?:[^=]|=\s*.checked.)/i,
	rscriptType = /^$|\/(?:java|ecma)script/i,
	rscriptTypeMasked = /^true\/(.*)/,
	rcleanScript = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,

	// We have to close these tags to support XHTML (#13200)
	wrapMap = {

		// Support: IE 9
		option: [ 1, "<select multiple='multiple'>", "</select>" ],

		thead: [ 1, "<table>", "</table>" ],
		col: [ 2, "<table><colgroup>", "</colgroup></table>" ],
		tr: [ 2, "<table><tbody>", "</tbody></table>" ],
		td: [ 3, "<table><tbody><tr>", "</tr></tbody></table>" ],

		_default: [ 0, "", "" ]
	};

// Support: IE 9
wrapMap.optgroup = wrapMap.option;

wrapMap.tbody = wrapMap.tfoot = wrapMap.colgroup = wrapMap.caption = wrapMap.thead;
wrapMap.th = wrapMap.td;

// Support: 1.x compatibility
// Manipulating tables requires a tbody
function manipulationTarget( elem, content ) {
	return jQuery.nodeName( elem, "table" ) &&
		jQuery.nodeName( content.nodeType !== 11 ? content : content.firstChild, "tr" ) ?

		elem.getElementsByTagName("tbody")[0] ||
			elem.appendChild( elem.ownerDocument.createElement("tbody") ) :
		elem;
}

// Replace/restore the type attribute of script elements for safe DOM manipulation
function disableScript( elem ) {
	elem.type = (elem.getAttribute("type") !== null) + "/" + elem.type;
	return elem;
}
function restoreScript( elem ) {
	var match = rscriptTypeMasked.exec( elem.type );

	if ( match ) {
		elem.type = match[ 1 ];
	} else {
		elem.removeAttribute("type");
	}

	return elem;
}

// Mark scripts as having already been evaluated
function setGlobalEval( elems, refElements ) {
	var i = 0,
		l = elems.length;

	for ( ; i < l; i++ ) {
		data_priv.set(
			elems[ i ], "globalEval", !refElements || data_priv.get( refElements[ i ], "globalEval" )
		);
	}
}

function cloneCopyEvent( src, dest ) {
	var i, l, type, pdataOld, pdataCur, udataOld, udataCur, events;

	if ( dest.nodeType !== 1 ) {
		return;
	}

	// 1. Copy private data: events, handlers, etc.
	if ( data_priv.hasData( src ) ) {
		pdataOld = data_priv.access( src );
		pdataCur = data_priv.set( dest, pdataOld );
		events = pdataOld.events;

		if ( events ) {
			delete pdataCur.handle;
			pdataCur.events = {};

			for ( type in events ) {
				for ( i = 0, l = events[ type ].length; i < l; i++ ) {
					jQuery.event.add( dest, type, events[ type ][ i ] );
				}
			}
		}
	}

	// 2. Copy user data
	if ( data_user.hasData( src ) ) {
		udataOld = data_user.access( src );
		udataCur = jQuery.extend( {}, udataOld );

		data_user.set( dest, udataCur );
	}
}

function getAll( context, tag ) {
	var ret = context.getElementsByTagName ? context.getElementsByTagName( tag || "*" ) :
			context.querySelectorAll ? context.querySelectorAll( tag || "*" ) :
			[];

	return tag === undefined || tag && jQuery.nodeName( context, tag ) ?
		jQuery.merge( [ context ], ret ) :
		ret;
}

// Support: IE >= 9
function fixInput( src, dest ) {
	var nodeName = dest.nodeName.toLowerCase();

	// Fails to persist the checked state of a cloned checkbox or radio button.
	if ( nodeName === "input" && rcheckableType.test( src.type ) ) {
		dest.checked = src.checked;

	// Fails to return the selected option to the default selected state when cloning options
	} else if ( nodeName === "input" || nodeName === "textarea" ) {
		dest.defaultValue = src.defaultValue;
	}
}

jQuery.extend({
	clone: function( elem, dataAndEvents, deepDataAndEvents ) {
		var i, l, srcElements, destElements,
			clone = elem.cloneNode( true ),
			inPage = jQuery.contains( elem.ownerDocument, elem );

		// Support: IE >= 9
		// Fix Cloning issues
		if ( !support.noCloneChecked && ( elem.nodeType === 1 || elem.nodeType === 11 ) &&
				!jQuery.isXMLDoc( elem ) ) {

			// We eschew Sizzle here for performance reasons: http://jsperf.com/getall-vs-sizzle/2
			destElements = getAll( clone );
			srcElements = getAll( elem );

			for ( i = 0, l = srcElements.length; i < l; i++ ) {
				fixInput( srcElements[ i ], destElements[ i ] );
			}
		}

		// Copy the events from the original to the clone
		if ( dataAndEvents ) {
			if ( deepDataAndEvents ) {
				srcElements = srcElements || getAll( elem );
				destElements = destElements || getAll( clone );

				for ( i = 0, l = srcElements.length; i < l; i++ ) {
					cloneCopyEvent( srcElements[ i ], destElements[ i ] );
				}
			} else {
				cloneCopyEvent( elem, clone );
			}
		}

		// Preserve script evaluation history
		destElements = getAll( clone, "script" );
		if ( destElements.length > 0 ) {
			setGlobalEval( destElements, !inPage && getAll( elem, "script" ) );
		}

		// Return the cloned set
		return clone;
	},

	buildFragment: function( elems, context, scripts, selection ) {
		var elem, tmp, tag, wrap, contains, j,
			fragment = context.createDocumentFragment(),
			nodes = [],
			i = 0,
			l = elems.length;

		for ( ; i < l; i++ ) {
			elem = elems[ i ];

			if ( elem || elem === 0 ) {

				// Add nodes directly
				if ( jQuery.type( elem ) === "object" ) {
					// Support: QtWebKit
					// jQuery.merge because push.apply(_, arraylike) throws
					jQuery.merge( nodes, elem.nodeType ? [ elem ] : elem );

				// Convert non-html into a text node
				} else if ( !rhtml.test( elem ) ) {
					nodes.push( context.createTextNode( elem ) );

				// Convert html into DOM nodes
				} else {
					tmp = tmp || fragment.appendChild( context.createElement("div") );

					// Deserialize a standard representation
					tag = ( rtagName.exec( elem ) || [ "", "" ] )[ 1 ].toLowerCase();
					wrap = wrapMap[ tag ] || wrapMap._default;
					tmp.innerHTML = wrap[ 1 ] + elem.replace( rxhtmlTag, "<$1></$2>" ) + wrap[ 2 ];

					// Descend through wrappers to the right content
					j = wrap[ 0 ];
					while ( j-- ) {
						tmp = tmp.lastChild;
					}

					// Support: QtWebKit
					// jQuery.merge because push.apply(_, arraylike) throws
					jQuery.merge( nodes, tmp.childNodes );

					// Remember the top-level container
					tmp = fragment.firstChild;

					// Fixes #12346
					// Support: Webkit, IE
					tmp.textContent = "";
				}
			}
		}

		// Remove wrapper from fragment
		fragment.textContent = "";

		i = 0;
		while ( (elem = nodes[ i++ ]) ) {

			// #4087 - If origin and destination elements are the same, and this is
			// that element, do not do anything
			if ( selection && jQuery.inArray( elem, selection ) !== -1 ) {
				continue;
			}

			contains = jQuery.contains( elem.ownerDocument, elem );

			// Append to fragment
			tmp = getAll( fragment.appendChild( elem ), "script" );

			// Preserve script evaluation history
			if ( contains ) {
				setGlobalEval( tmp );
			}

			// Capture executables
			if ( scripts ) {
				j = 0;
				while ( (elem = tmp[ j++ ]) ) {
					if ( rscriptType.test( elem.type || "" ) ) {
						scripts.push( elem );
					}
				}
			}
		}

		return fragment;
	},

	cleanData: function( elems ) {
		var data, elem, type, key,
			special = jQuery.event.special,
			i = 0;

		for ( ; (elem = elems[ i ]) !== undefined; i++ ) {
			if ( jQuery.acceptData( elem ) ) {
				key = elem[ data_priv.expando ];

				if ( key && (data = data_priv.cache[ key ]) ) {
					if ( data.events ) {
						for ( type in data.events ) {
							if ( special[ type ] ) {
								jQuery.event.remove( elem, type );

							// This is a shortcut to avoid jQuery.event.remove's overhead
							} else {
								jQuery.removeEvent( elem, type, data.handle );
							}
						}
					}
					if ( data_priv.cache[ key ] ) {
						// Discard any remaining `private` data
						delete data_priv.cache[ key ];
					}
				}
			}
			// Discard any remaining `user` data
			delete data_user.cache[ elem[ data_user.expando ] ];
		}
	}
});

jQuery.fn.extend({
	text: function( value ) {
		return access( this, function( value ) {
			return value === undefined ?
				jQuery.text( this ) :
				this.empty().each(function() {
					if ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {
						this.textContent = value;
					}
				});
		}, null, value, arguments.length );
	},

	append: function() {
		return this.domManip( arguments, function( elem ) {
			if ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {
				var target = manipulationTarget( this, elem );
				target.appendChild( elem );
			}
		});
	},

	prepend: function() {
		return this.domManip( arguments, function( elem ) {
			if ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {
				var target = manipulationTarget( this, elem );
				target.insertBefore( elem, target.firstChild );
			}
		});
	},

	before: function() {
		return this.domManip( arguments, function( elem ) {
			if ( this.parentNode ) {
				this.parentNode.insertBefore( elem, this );
			}
		});
	},

	after: function() {
		return this.domManip( arguments, function( elem ) {
			if ( this.parentNode ) {
				this.parentNode.insertBefore( elem, this.nextSibling );
			}
		});
	},

	remove: function( selector, keepData /* Internal Use Only */ ) {
		var elem,
			elems = selector ? jQuery.filter( selector, this ) : this,
			i = 0;

		for ( ; (elem = elems[i]) != null; i++ ) {
			if ( !keepData && elem.nodeType === 1 ) {
				jQuery.cleanData( getAll( elem ) );
			}

			if ( elem.parentNode ) {
				if ( keepData && jQuery.contains( elem.ownerDocument, elem ) ) {
					setGlobalEval( getAll( elem, "script" ) );
				}
				elem.parentNode.removeChild( elem );
			}
		}

		return this;
	},

	empty: function() {
		var elem,
			i = 0;

		for ( ; (elem = this[i]) != null; i++ ) {
			if ( elem.nodeType === 1 ) {

				// Prevent memory leaks
				jQuery.cleanData( getAll( elem, false ) );

				// Remove any remaining nodes
				elem.textContent = "";
			}
		}

		return this;
	},

	clone: function( dataAndEvents, deepDataAndEvents ) {
		dataAndEvents = dataAndEvents == null ? false : dataAndEvents;
		deepDataAndEvents = deepDataAndEvents == null ? dataAndEvents : deepDataAndEvents;

		return this.map(function() {
			return jQuery.clone( this, dataAndEvents, deepDataAndEvents );
		});
	},

	html: function( value ) {
		return access( this, function( value ) {
			var elem = this[ 0 ] || {},
				i = 0,
				l = this.length;

			if ( value === undefined && elem.nodeType === 1 ) {
				return elem.innerHTML;
			}

			// See if we can take a shortcut and just use innerHTML
			if ( typeof value === "string" && !rnoInnerhtml.test( value ) &&
				!wrapMap[ ( rtagName.exec( value ) || [ "", "" ] )[ 1 ].toLowerCase() ] ) {

				value = value.replace( rxhtmlTag, "<$1></$2>" );

				try {
					for ( ; i < l; i++ ) {
						elem = this[ i ] || {};

						// Remove element nodes and prevent memory leaks
						if ( elem.nodeType === 1 ) {
							jQuery.cleanData( getAll( elem, false ) );
							elem.innerHTML = value;
						}
					}

					elem = 0;

				// If using innerHTML throws an exception, use the fallback method
				} catch( e ) {}
			}

			if ( elem ) {
				this.empty().append( value );
			}
		}, null, value, arguments.length );
	},

	replaceWith: function() {
		var arg = arguments[ 0 ];

		// Make the changes, replacing each context element with the new content
		this.domManip( arguments, function( elem ) {
			arg = this.parentNode;

			jQuery.cleanData( getAll( this ) );

			if ( arg ) {
				arg.replaceChild( elem, this );
			}
		});

		// Force removal if there was no new content (e.g., from empty arguments)
		return arg && (arg.length || arg.nodeType) ? this : this.remove();
	},

	detach: function( selector ) {
		return this.remove( selector, true );
	},

	domManip: function( args, callback ) {

		// Flatten any nested arrays
		args = concat.apply( [], args );

		var fragment, first, scripts, hasScripts, node, doc,
			i = 0,
			l = this.length,
			set = this,
			iNoClone = l - 1,
			value = args[ 0 ],
			isFunction = jQuery.isFunction( value );

		// We can't cloneNode fragments that contain checked, in WebKit
		if ( isFunction ||
				( l > 1 && typeof value === "string" &&
					!support.checkClone && rchecked.test( value ) ) ) {
			return this.each(function( index ) {
				var self = set.eq( index );
				if ( isFunction ) {
					args[ 0 ] = value.call( this, index, self.html() );
				}
				self.domManip( args, callback );
			});
		}

		if ( l ) {
			fragment = jQuery.buildFragment( args, this[ 0 ].ownerDocument, false, this );
			first = fragment.firstChild;

			if ( fragment.childNodes.length === 1 ) {
				fragment = first;
			}

			if ( first ) {
				scripts = jQuery.map( getAll( fragment, "script" ), disableScript );
				hasScripts = scripts.length;

				// Use the original fragment for the last item instead of the first because it can end up
				// being emptied incorrectly in certain situations (#8070).
				for ( ; i < l; i++ ) {
					node = fragment;

					if ( i !== iNoClone ) {
						node = jQuery.clone( node, true, true );

						// Keep references to cloned scripts for later restoration
						if ( hasScripts ) {
							// Support: QtWebKit
							// jQuery.merge because push.apply(_, arraylike) throws
							jQuery.merge( scripts, getAll( node, "script" ) );
						}
					}

					callback.call( this[ i ], node, i );
				}

				if ( hasScripts ) {
					doc = scripts[ scripts.length - 1 ].ownerDocument;

					// Reenable scripts
					jQuery.map( scripts, restoreScript );

					// Evaluate executable scripts on first document insertion
					for ( i = 0; i < hasScripts; i++ ) {
						node = scripts[ i ];
						if ( rscriptType.test( node.type || "" ) &&
							!data_priv.access( node, "globalEval" ) && jQuery.contains( doc, node ) ) {

							if ( node.src ) {
								// Optional AJAX dependency, but won't run scripts if not present
								if ( jQuery._evalUrl ) {
									jQuery._evalUrl( node.src );
								}
							} else {
								jQuery.globalEval( node.textContent.replace( rcleanScript, "" ) );
							}
						}
					}
				}
			}
		}

		return this;
	}
});

jQuery.each({
	appendTo: "append",
	prependTo: "prepend",
	insertBefore: "before",
	insertAfter: "after",
	replaceAll: "replaceWith"
}, function( name, original ) {
	jQuery.fn[ name ] = function( selector ) {
		var elems,
			ret = [],
			insert = jQuery( selector ),
			last = insert.length - 1,
			i = 0;

		for ( ; i <= last; i++ ) {
			elems = i === last ? this : this.clone( true );
			jQuery( insert[ i ] )[ original ]( elems );

			// Support: QtWebKit
			// .get() because push.apply(_, arraylike) throws
			push.apply( ret, elems.get() );
		}

		return this.pushStack( ret );
	};
});


var iframe,
	elemdisplay = {};

/**
 * Retrieve the actual display of a element
 * @param {String} name nodeName of the element
 * @param {Object} doc Document object
 */
// Called only from within defaultDisplay
function actualDisplay( name, doc ) {
	var style,
		elem = jQuery( doc.createElement( name ) ).appendTo( doc.body ),

		// getDefaultComputedStyle might be reliably used only on attached element
		display = window.getDefaultComputedStyle && ( style = window.getDefaultComputedStyle( elem[ 0 ] ) ) ?

			// Use of this method is a temporary fix (more like optmization) until something better comes along,
			// since it was removed from specification and supported only in FF
			style.display : jQuery.css( elem[ 0 ], "display" );

	// We don't have any data stored on the element,
	// so use "detach" method as fast way to get rid of the element
	elem.detach();

	return display;
}

/**
 * Try to determine the default display value of an element
 * @param {String} nodeName
 */
function defaultDisplay( nodeName ) {
	var doc = document,
		display = elemdisplay[ nodeName ];

	if ( !display ) {
		display = actualDisplay( nodeName, doc );

		// If the simple way fails, read from inside an iframe
		if ( display === "none" || !display ) {

			// Use the already-created iframe if possible
			iframe = (iframe || jQuery( "<iframe frameborder='0' width='0' height='0'/>" )).appendTo( doc.documentElement );

			// Always write a new HTML skeleton so Webkit and Firefox don't choke on reuse
			doc = iframe[ 0 ].contentDocument;

			// Support: IE
			doc.write();
			doc.close();

			display = actualDisplay( nodeName, doc );
			iframe.detach();
		}

		// Store the correct default display
		elemdisplay[ nodeName ] = display;
	}

	return display;
}
var rmargin = (/^margin/);

var rnumnonpx = new RegExp( "^(" + pnum + ")(?!px)[a-z%]+$", "i" );

var getStyles = function( elem ) {
		return elem.ownerDocument.defaultView.getComputedStyle( elem, null );
	};



function curCSS( elem, name, computed ) {
	var width, minWidth, maxWidth, ret,
		style = elem.style;

	computed = computed || getStyles( elem );

	// Support: IE9
	// getPropertyValue is only needed for .css('filter') in IE9, see #12537
	if ( computed ) {
		ret = computed.getPropertyValue( name ) || computed[ name ];
	}

	if ( computed ) {

		if ( ret === "" && !jQuery.contains( elem.ownerDocument, elem ) ) {
			ret = jQuery.style( elem, name );
		}

		// Support: iOS < 6
		// A tribute to the "awesome hack by Dean Edwards"
		// iOS < 6 (at least) returns percentage for a larger set of values, but width seems to be reliably pixels
		// this is against the CSSOM draft spec: http://dev.w3.org/csswg/cssom/#resolved-values
		if ( rnumnonpx.test( ret ) && rmargin.test( name ) ) {

			// Remember the original values
			width = style.width;
			minWidth = style.minWidth;
			maxWidth = style.maxWidth;

			// Put in the new values to get a computed value out
			style.minWidth = style.maxWidth = style.width = ret;
			ret = computed.width;

			// Revert the changed values
			style.width = width;
			style.minWidth = minWidth;
			style.maxWidth = maxWidth;
		}
	}

	return ret !== undefined ?
		// Support: IE
		// IE returns zIndex value as an integer.
		ret + "" :
		ret;
}


function addGetHookIf( conditionFn, hookFn ) {
	// Define the hook, we'll check on the first run if it's really needed.
	return {
		get: function() {
			if ( conditionFn() ) {
				// Hook not needed (or it's not possible to use it due to missing dependency),
				// remove it.
				// Since there are no other hooks for marginRight, remove the whole object.
				delete this.get;
				return;
			}

			// Hook needed; redefine it so that the support test is not executed again.

			return (this.get = hookFn).apply( this, arguments );
		}
	};
}


(function() {
	var pixelPositionVal, boxSizingReliableVal,
		docElem = document.documentElement,
		container = document.createElement( "div" ),
		div = document.createElement( "div" );

	if ( !div.style ) {
		return;
	}

	div.style.backgroundClip = "content-box";
	div.cloneNode( true ).style.backgroundClip = "";
	support.clearCloneStyle = div.style.backgroundClip === "content-box";

	container.style.cssText = "border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;" +
		"position:absolute";
	container.appendChild( div );

	// Executing both pixelPosition & boxSizingReliable tests require only one layout
	// so they're executed at the same time to save the second computation.
	function computePixelPositionAndBoxSizingReliable() {
		div.style.cssText =
			// Support: Firefox<29, Android 2.3
			// Vendor-prefix box-sizing
			"-webkit-box-sizing:border-box;-moz-box-sizing:border-box;" +
			"box-sizing:border-box;display:block;margin-top:1%;top:1%;" +
			"border:1px;padding:1px;width:4px;position:absolute";
		div.innerHTML = "";
		docElem.appendChild( container );

		var divStyle = window.getComputedStyle( div, null );
		pixelPositionVal = divStyle.top !== "1%";
		boxSizingReliableVal = divStyle.width === "4px";

		docElem.removeChild( container );
	}

	// Support: node.js jsdom
	// Don't assume that getComputedStyle is a property of the global object
	if ( window.getComputedStyle ) {
		jQuery.extend( support, {
			pixelPosition: function() {
				// This test is executed only once but we still do memoizing
				// since we can use the boxSizingReliable pre-computing.
				// No need to check if the test was already performed, though.
				computePixelPositionAndBoxSizingReliable();
				return pixelPositionVal;
			},
			boxSizingReliable: function() {
				if ( boxSizingReliableVal == null ) {
					computePixelPositionAndBoxSizingReliable();
				}
				return boxSizingReliableVal;
			},
			reliableMarginRight: function() {
				// Support: Android 2.3
				// Check if div with explicit width and no margin-right incorrectly
				// gets computed margin-right based on width of container. (#3333)
				// WebKit Bug 13343 - getComputedStyle returns wrong value for margin-right
				// This support function is only executed once so no memoizing is needed.
				var ret,
					marginDiv = div.appendChild( document.createElement( "div" ) );

				// Reset CSS: box-sizing; display; margin; border; padding
				marginDiv.style.cssText = div.style.cssText =
					// Support: Firefox<29, Android 2.3
					// Vendor-prefix box-sizing
					"-webkit-box-sizing:content-box;-moz-box-sizing:content-box;" +
					"box-sizing:content-box;display:block;margin:0;border:0;padding:0";
				marginDiv.style.marginRight = marginDiv.style.width = "0";
				div.style.width = "1px";
				docElem.appendChild( container );

				ret = !parseFloat( window.getComputedStyle( marginDiv, null ).marginRight );

				docElem.removeChild( container );

				return ret;
			}
		});
	}
})();


// A method for quickly swapping in/out CSS properties to get correct calculations.
jQuery.swap = function( elem, options, callback, args ) {
	var ret, name,
		old = {};

	// Remember the old values, and insert the new ones
	for ( name in options ) {
		old[ name ] = elem.style[ name ];
		elem.style[ name ] = options[ name ];
	}

	ret = callback.apply( elem, args || [] );

	// Revert the old values
	for ( name in options ) {
		elem.style[ name ] = old[ name ];
	}

	return ret;
};


var
	// swappable if display is none or starts with table except "table", "table-cell", or "table-caption"
	// see here for display values: https://developer.mozilla.org/en-US/docs/CSS/display
	rdisplayswap = /^(none|table(?!-c[ea]).+)/,
	rnumsplit = new RegExp( "^(" + pnum + ")(.*)$", "i" ),
	rrelNum = new RegExp( "^([+-])=(" + pnum + ")", "i" ),

	cssShow = { position: "absolute", visibility: "hidden", display: "block" },
	cssNormalTransform = {
		letterSpacing: "0",
		fontWeight: "400"
	},

	cssPrefixes = [ "Webkit", "O", "Moz", "ms" ];

// return a css property mapped to a potentially vendor prefixed property
function vendorPropName( style, name ) {

	// shortcut for names that are not vendor prefixed
	if ( name in style ) {
		return name;
	}

	// check for vendor prefixed names
	var capName = name[0].toUpperCase() + name.slice(1),
		origName = name,
		i = cssPrefixes.length;

	while ( i-- ) {
		name = cssPrefixes[ i ] + capName;
		if ( name in style ) {
			return name;
		}
	}

	return origName;
}

function setPositiveNumber( elem, value, subtract ) {
	var matches = rnumsplit.exec( value );
	return matches ?
		// Guard against undefined "subtract", e.g., when used as in cssHooks
		Math.max( 0, matches[ 1 ] - ( subtract || 0 ) ) + ( matches[ 2 ] || "px" ) :
		value;
}

function augmentWidthOrHeight( elem, name, extra, isBorderBox, styles ) {
	var i = extra === ( isBorderBox ? "border" : "content" ) ?
		// If we already have the right measurement, avoid augmentation
		4 :
		// Otherwise initialize for horizontal or vertical properties
		name === "width" ? 1 : 0,

		val = 0;

	for ( ; i < 4; i += 2 ) {
		// both box models exclude margin, so add it if we want it
		if ( extra === "margin" ) {
			val += jQuery.css( elem, extra + cssExpand[ i ], true, styles );
		}

		if ( isBorderBox ) {
			// border-box includes padding, so remove it if we want content
			if ( extra === "content" ) {
				val -= jQuery.css( elem, "padding" + cssExpand[ i ], true, styles );
			}

			// at this point, extra isn't border nor margin, so remove border
			if ( extra !== "margin" ) {
				val -= jQuery.css( elem, "border" + cssExpand[ i ] + "Width", true, styles );
			}
		} else {
			// at this point, extra isn't content, so add padding
			val += jQuery.css( elem, "padding" + cssExpand[ i ], true, styles );

			// at this point, extra isn't content nor padding, so add border
			if ( extra !== "padding" ) {
				val += jQuery.css( elem, "border" + cssExpand[ i ] + "Width", true, styles );
			}
		}
	}

	return val;
}

function getWidthOrHeight( elem, name, extra ) {

	// Start with offset property, which is equivalent to the border-box value
	var valueIsBorderBox = true,
		val = name === "width" ? elem.offsetWidth : elem.offsetHeight,
		styles = getStyles( elem ),
		isBorderBox = jQuery.css( elem, "boxSizing", false, styles ) === "border-box";

	// some non-html elements return undefined for offsetWidth, so check for null/undefined
	// svg - https://bugzilla.mozilla.org/show_bug.cgi?id=649285
	// MathML - https://bugzilla.mozilla.org/show_bug.cgi?id=491668
	if ( val <= 0 || val == null ) {
		// Fall back to computed then uncomputed css if necessary
		val = curCSS( elem, name, styles );
		if ( val < 0 || val == null ) {
			val = elem.style[ name ];
		}

		// Computed unit is not pixels. Stop here and return.
		if ( rnumnonpx.test(val) ) {
			return val;
		}

		// we need the check for style in case a browser which returns unreliable values
		// for getComputedStyle silently falls back to the reliable elem.style
		valueIsBorderBox = isBorderBox &&
			( support.boxSizingReliable() || val === elem.style[ name ] );

		// Normalize "", auto, and prepare for extra
		val = parseFloat( val ) || 0;
	}

	// use the active box-sizing model to add/subtract irrelevant styles
	return ( val +
		augmentWidthOrHeight(
			elem,
			name,
			extra || ( isBorderBox ? "border" : "content" ),
			valueIsBorderBox,
			styles
		)
	) + "px";
}

function showHide( elements, show ) {
	var display, elem, hidden,
		values = [],
		index = 0,
		length = elements.length;

	for ( ; index < length; index++ ) {
		elem = elements[ index ];
		if ( !elem.style ) {
			continue;
		}

		values[ index ] = data_priv.get( elem, "olddisplay" );
		display = elem.style.display;
		if ( show ) {
			// Reset the inline display of this element to learn if it is
			// being hidden by cascaded rules or not
			if ( !values[ index ] && display === "none" ) {
				elem.style.display = "";
			}

			// Set elements which have been overridden with display: none
			// in a stylesheet to whatever the default browser style is
			// for such an element
			if ( elem.style.display === "" && isHidden( elem ) ) {
				values[ index ] = data_priv.access( elem, "olddisplay", defaultDisplay(elem.nodeName) );
			}
		} else {
			hidden = isHidden( elem );

			if ( display !== "none" || !hidden ) {
				data_priv.set( elem, "olddisplay", hidden ? display : jQuery.css( elem, "display" ) );
			}
		}
	}

	// Set the display of most of the elements in a second loop
	// to avoid the constant reflow
	for ( index = 0; index < length; index++ ) {
		elem = elements[ index ];
		if ( !elem.style ) {
			continue;
		}
		if ( !show || elem.style.display === "none" || elem.style.display === "" ) {
			elem.style.display = show ? values[ index ] || "" : "none";
		}
	}

	return elements;
}

jQuery.extend({
	// Add in style property hooks for overriding the default
	// behavior of getting and setting a style property
	cssHooks: {
		opacity: {
			get: function( elem, computed ) {
				if ( computed ) {
					// We should always get a number back from opacity
					var ret = curCSS( elem, "opacity" );
					return ret === "" ? "1" : ret;
				}
			}
		}
	},

	// Don't automatically add "px" to these possibly-unitless properties
	cssNumber: {
		"columnCount": true,
		"fillOpacity": true,
		"flexGrow": true,
		"flexShrink": true,
		"fontWeight": true,
		"lineHeight": true,
		"opacity": true,
		"order": true,
		"orphans": true,
		"widows": true,
		"zIndex": true,
		"zoom": true
	},

	// Add in properties whose names you wish to fix before
	// setting or getting the value
	cssProps: {
		// normalize float css property
		"float": "cssFloat"
	},

	// Get and set the style property on a DOM Node
	style: function( elem, name, value, extra ) {
		// Don't set styles on text and comment nodes
		if ( !elem || elem.nodeType === 3 || elem.nodeType === 8 || !elem.style ) {
			return;
		}

		// Make sure that we're working with the right name
		var ret, type, hooks,
			origName = jQuery.camelCase( name ),
			style = elem.style;

		name = jQuery.cssProps[ origName ] || ( jQuery.cssProps[ origName ] = vendorPropName( style, origName ) );

		// gets hook for the prefixed version
		// followed by the unprefixed version
		hooks = jQuery.cssHooks[ name ] || jQuery.cssHooks[ origName ];

		// Check if we're setting a value
		if ( value !== undefined ) {
			type = typeof value;

			// convert relative number strings (+= or -=) to relative numbers. #7345
			if ( type === "string" && (ret = rrelNum.exec( value )) ) {
				value = ( ret[1] + 1 ) * ret[2] + parseFloat( jQuery.css( elem, name ) );
				// Fixes bug #9237
				type = "number";
			}

			// Make sure that null and NaN values aren't set. See: #7116
			if ( value == null || value !== value ) {
				return;
			}

			// If a number was passed in, add 'px' to the (except for certain CSS properties)
			if ( type === "number" && !jQuery.cssNumber[ origName ] ) {
				value += "px";
			}

			// Fixes #8908, it can be done more correctly by specifying setters in cssHooks,
			// but it would mean to define eight (for every problematic property) identical functions
			if ( !support.clearCloneStyle && value === "" && name.indexOf( "background" ) === 0 ) {
				style[ name ] = "inherit";
			}

			// If a hook was provided, use that value, otherwise just set the specified value
			if ( !hooks || !("set" in hooks) || (value = hooks.set( elem, value, extra )) !== undefined ) {
				style[ name ] = value;
			}

		} else {
			// If a hook was provided get the non-computed value from there
			if ( hooks && "get" in hooks && (ret = hooks.get( elem, false, extra )) !== undefined ) {
				return ret;
			}

			// Otherwise just get the value from the style object
			return style[ name ];
		}
	},

	css: function( elem, name, extra, styles ) {
		var val, num, hooks,
			origName = jQuery.camelCase( name );

		// Make sure that we're working with the right name
		name = jQuery.cssProps[ origName ] || ( jQuery.cssProps[ origName ] = vendorPropName( elem.style, origName ) );

		// gets hook for the prefixed version
		// followed by the unprefixed version
		hooks = jQuery.cssHooks[ name ] || jQuery.cssHooks[ origName ];

		// If a hook was provided get the computed value from there
		if ( hooks && "get" in hooks ) {
			val = hooks.get( elem, true, extra );
		}

		// Otherwise, if a way to get the computed value exists, use that
		if ( val === undefined ) {
			val = curCSS( elem, name, styles );
		}

		//convert "normal" to computed value
		if ( val === "normal" && name in cssNormalTransform ) {
			val = cssNormalTransform[ name ];
		}

		// Return, converting to number if forced or a qualifier was provided and val looks numeric
		if ( extra === "" || extra ) {
			num = parseFloat( val );
			return extra === true || jQuery.isNumeric( num ) ? num || 0 : val;
		}
		return val;
	}
});

jQuery.each([ "height", "width" ], function( i, name ) {
	jQuery.cssHooks[ name ] = {
		get: function( elem, computed, extra ) {
			if ( computed ) {
				// certain elements can have dimension info if we invisibly show them
				// however, it must have a current display style that would benefit from this
				return rdisplayswap.test( jQuery.css( elem, "display" ) ) && elem.offsetWidth === 0 ?
					jQuery.swap( elem, cssShow, function() {
						return getWidthOrHeight( elem, name, extra );
					}) :
					getWidthOrHeight( elem, name, extra );
			}
		},

		set: function( elem, value, extra ) {
			var styles = extra && getStyles( elem );
			return setPositiveNumber( elem, value, extra ?
				augmentWidthOrHeight(
					elem,
					name,
					extra,
					jQuery.css( elem, "boxSizing", false, styles ) === "border-box",
					styles
				) : 0
			);
		}
	};
});

// Support: Android 2.3
jQuery.cssHooks.marginRight = addGetHookIf( support.reliableMarginRight,
	function( elem, computed ) {
		if ( computed ) {
			// WebKit Bug 13343 - getComputedStyle returns wrong value for margin-right
			// Work around by temporarily setting element display to inline-block
			return jQuery.swap( elem, { "display": "inline-block" },
				curCSS, [ elem, "marginRight" ] );
		}
	}
);

// These hooks are used by animate to expand properties
jQuery.each({
	margin: "",
	padding: "",
	border: "Width"
}, function( prefix, suffix ) {
	jQuery.cssHooks[ prefix + suffix ] = {
		expand: function( value ) {
			var i = 0,
				expanded = {},

				// assumes a single number if not a string
				parts = typeof value === "string" ? value.split(" ") : [ value ];

			for ( ; i < 4; i++ ) {
				expanded[ prefix + cssExpand[ i ] + suffix ] =
					parts[ i ] || parts[ i - 2 ] || parts[ 0 ];
			}

			return expanded;
		}
	};

	if ( !rmargin.test( prefix ) ) {
		jQuery.cssHooks[ prefix + suffix ].set = setPositiveNumber;
	}
});

jQuery.fn.extend({
	css: function( name, value ) {
		return access( this, function( elem, name, value ) {
			var styles, len,
				map = {},
				i = 0;

			if ( jQuery.isArray( name ) ) {
				styles = getStyles( elem );
				len = name.length;

				for ( ; i < len; i++ ) {
					map[ name[ i ] ] = jQuery.css( elem, name[ i ], false, styles );
				}

				return map;
			}

			return value !== undefined ?
				jQuery.style( elem, name, value ) :
				jQuery.css( elem, name );
		}, name, value, arguments.length > 1 );
	},
	show: function() {
		return showHide( this, true );
	},
	hide: function() {
		return showHide( this );
	},
	toggle: function( state ) {
		if ( typeof state === "boolean" ) {
			return state ? this.show() : this.hide();
		}

		return this.each(function() {
			if ( isHidden( this ) ) {
				jQuery( this ).show();
			} else {
				jQuery( this ).hide();
			}
		});
	}
});


function Tween( elem, options, prop, end, easing ) {
	return new Tween.prototype.init( elem, options, prop, end, easing );
}
jQuery.Tween = Tween;

Tween.prototype = {
	constructor: Tween,
	init: function( elem, options, prop, end, easing, unit ) {
		this.elem = elem;
		this.prop = prop;
		this.easing = easing || "swing";
		this.options = options;
		this.start = this.now = this.cur();
		this.end = end;
		this.unit = unit || ( jQuery.cssNumber[ prop ] ? "" : "px" );
	},
	cur: function() {
		var hooks = Tween.propHooks[ this.prop ];

		return hooks && hooks.get ?
			hooks.get( this ) :
			Tween.propHooks._default.get( this );
	},
	run: function( percent ) {
		var eased,
			hooks = Tween.propHooks[ this.prop ];

		if ( this.options.duration ) {
			this.pos = eased = jQuery.easing[ this.easing ](
				percent, this.options.duration * percent, 0, 1, this.options.duration
			);
		} else {
			this.pos = eased = percent;
		}
		this.now = ( this.end - this.start ) * eased + this.start;

		if ( this.options.step ) {
			this.options.step.call( this.elem, this.now, this );
		}

		if ( hooks && hooks.set ) {
			hooks.set( this );
		} else {
			Tween.propHooks._default.set( this );
		}
		return this;
	}
};

Tween.prototype.init.prototype = Tween.prototype;

Tween.propHooks = {
	_default: {
		get: function( tween ) {
			var result;

			if ( tween.elem[ tween.prop ] != null &&
				(!tween.elem.style || tween.elem.style[ tween.prop ] == null) ) {
				return tween.elem[ tween.prop ];
			}

			// passing an empty string as a 3rd parameter to .css will automatically
			// attempt a parseFloat and fallback to a string if the parse fails
			// so, simple values such as "10px" are parsed to Float.
			// complex values such as "rotate(1rad)" are returned as is.
			result = jQuery.css( tween.elem, tween.prop, "" );
			// Empty strings, null, undefined and "auto" are converted to 0.
			return !result || result === "auto" ? 0 : result;
		},
		set: function( tween ) {
			// use step hook for back compat - use cssHook if its there - use .style if its
			// available and use plain properties where available
			if ( jQuery.fx.step[ tween.prop ] ) {
				jQuery.fx.step[ tween.prop ]( tween );
			} else if ( tween.elem.style && ( tween.elem.style[ jQuery.cssProps[ tween.prop ] ] != null || jQuery.cssHooks[ tween.prop ] ) ) {
				jQuery.style( tween.elem, tween.prop, tween.now + tween.unit );
			} else {
				tween.elem[ tween.prop ] = tween.now;
			}
		}
	}
};

// Support: IE9
// Panic based approach to setting things on disconnected nodes

Tween.propHooks.scrollTop = Tween.propHooks.scrollLeft = {
	set: function( tween ) {
		if ( tween.elem.nodeType && tween.elem.parentNode ) {
			tween.elem[ tween.prop ] = tween.now;
		}
	}
};

jQuery.easing = {
	linear: function( p ) {
		return p;
	},
	swing: function( p ) {
		return 0.5 - Math.cos( p * Math.PI ) / 2;
	}
};

jQuery.fx = Tween.prototype.init;

// Back Compat <1.8 extension point
jQuery.fx.step = {};




var
	fxNow, timerId,
	rfxtypes = /^(?:toggle|show|hide)$/,
	rfxnum = new RegExp( "^(?:([+-])=|)(" + pnum + ")([a-z%]*)$", "i" ),
	rrun = /queueHooks$/,
	animationPrefilters = [ defaultPrefilter ],
	tweeners = {
		"*": [ function( prop, value ) {
			var tween = this.createTween( prop, value ),
				target = tween.cur(),
				parts = rfxnum.exec( value ),
				unit = parts && parts[ 3 ] || ( jQuery.cssNumber[ prop ] ? "" : "px" ),

				// Starting value computation is required for potential unit mismatches
				start = ( jQuery.cssNumber[ prop ] || unit !== "px" && +target ) &&
					rfxnum.exec( jQuery.css( tween.elem, prop ) ),
				scale = 1,
				maxIterations = 20;

			if ( start && start[ 3 ] !== unit ) {
				// Trust units reported by jQuery.css
				unit = unit || start[ 3 ];

				// Make sure we update the tween properties later on
				parts = parts || [];

				// Iteratively approximate from a nonzero starting point
				start = +target || 1;

				do {
					// If previous iteration zeroed out, double until we get *something*
					// Use a string for doubling factor so we don't accidentally see scale as unchanged below
					scale = scale || ".5";

					// Adjust and apply
					start = start / scale;
					jQuery.style( tween.elem, prop, start + unit );

				// Update scale, tolerating zero or NaN from tween.cur()
				// And breaking the loop if scale is unchanged or perfect, or if we've just had enough
				} while ( scale !== (scale = tween.cur() / target) && scale !== 1 && --maxIterations );
			}

			// Update tween properties
			if ( parts ) {
				start = tween.start = +start || +target || 0;
				tween.unit = unit;
				// If a +=/-= token was provided, we're doing a relative animation
				tween.end = parts[ 1 ] ?
					start + ( parts[ 1 ] + 1 ) * parts[ 2 ] :
					+parts[ 2 ];
			}

			return tween;
		} ]
	};

// Animations created synchronously will run synchronously
function createFxNow() {
	setTimeout(function() {
		fxNow = undefined;
	});
	return ( fxNow = jQuery.now() );
}

// Generate parameters to create a standard animation
function genFx( type, includeWidth ) {
	var which,
		i = 0,
		attrs = { height: type };

	// if we include width, step value is 1 to do all cssExpand values,
	// if we don't include width, step value is 2 to skip over Left and Right
	includeWidth = includeWidth ? 1 : 0;
	for ( ; i < 4 ; i += 2 - includeWidth ) {
		which = cssExpand[ i ];
		attrs[ "margin" + which ] = attrs[ "padding" + which ] = type;
	}

	if ( includeWidth ) {
		attrs.opacity = attrs.width = type;
	}

	return attrs;
}

function createTween( value, prop, animation ) {
	var tween,
		collection = ( tweeners[ prop ] || [] ).concat( tweeners[ "*" ] ),
		index = 0,
		length = collection.length;
	for ( ; index < length; index++ ) {
		if ( (tween = collection[ index ].call( animation, prop, value )) ) {

			// we're done with this property
			return tween;
		}
	}
}

function defaultPrefilter( elem, props, opts ) {
	/* jshint validthis: true */
	var prop, value, toggle, tween, hooks, oldfire, display, checkDisplay,
		anim = this,
		orig = {},
		style = elem.style,
		hidden = elem.nodeType && isHidden( elem ),
		dataShow = data_priv.get( elem, "fxshow" );

	// handle queue: false promises
	if ( !opts.queue ) {
		hooks = jQuery._queueHooks( elem, "fx" );
		if ( hooks.unqueued == null ) {
			hooks.unqueued = 0;
			oldfire = hooks.empty.fire;
			hooks.empty.fire = function() {
				if ( !hooks.unqueued ) {
					oldfire();
				}
			};
		}
		hooks.unqueued++;

		anim.always(function() {
			// doing this makes sure that the complete handler will be called
			// before this completes
			anim.always(function() {
				hooks.unqueued--;
				if ( !jQuery.queue( elem, "fx" ).length ) {
					hooks.empty.fire();
				}
			});
		});
	}

	// height/width overflow pass
	if ( elem.nodeType === 1 && ( "height" in props || "width" in props ) ) {
		// Make sure that nothing sneaks out
		// Record all 3 overflow attributes because IE9-10 do not
		// change the overflow attribute when overflowX and
		// overflowY are set to the same value
		opts.overflow = [ style.overflow, style.overflowX, style.overflowY ];

		// Set display property to inline-block for height/width
		// animations on inline elements that are having width/height animated
		display = jQuery.css( elem, "display" );

		// Test default display if display is currently "none"
		checkDisplay = display === "none" ?
			data_priv.get( elem, "olddisplay" ) || defaultDisplay( elem.nodeName ) : display;

		if ( checkDisplay === "inline" && jQuery.css( elem, "float" ) === "none" ) {
			style.display = "inline-block";
		}
	}

	if ( opts.overflow ) {
		style.overflow = "hidden";
		anim.always(function() {
			style.overflow = opts.overflow[ 0 ];
			style.overflowX = opts.overflow[ 1 ];
			style.overflowY = opts.overflow[ 2 ];
		});
	}

	// show/hide pass
	for ( prop in props ) {
		value = props[ prop ];
		if ( rfxtypes.exec( value ) ) {
			delete props[ prop ];
			toggle = toggle || value === "toggle";
			if ( value === ( hidden ? "hide" : "show" ) ) {

				// If there is dataShow left over from a stopped hide or show and we are going to proceed with show, we should pretend to be hidden
				if ( value === "show" && dataShow && dataShow[ prop ] !== undefined ) {
					hidden = true;
				} else {
					continue;
				}
			}
			orig[ prop ] = dataShow && dataShow[ prop ] || jQuery.style( elem, prop );

		// Any non-fx value stops us from restoring the original display value
		} else {
			display = undefined;
		}
	}

	if ( !jQuery.isEmptyObject( orig ) ) {
		if ( dataShow ) {
			if ( "hidden" in dataShow ) {
				hidden = dataShow.hidden;
			}
		} else {
			dataShow = data_priv.access( elem, "fxshow", {} );
		}

		// store state if its toggle - enables .stop().toggle() to "reverse"
		if ( toggle ) {
			dataShow.hidden = !hidden;
		}
		if ( hidden ) {
			jQuery( elem ).show();
		} else {
			anim.done(function() {
				jQuery( elem ).hide();
			});
		}
		anim.done(function() {
			var prop;

			data_priv.remove( elem, "fxshow" );
			for ( prop in orig ) {
				jQuery.style( elem, prop, orig[ prop ] );
			}
		});
		for ( prop in orig ) {
			tween = createTween( hidden ? dataShow[ prop ] : 0, prop, anim );

			if ( !( prop in dataShow ) ) {
				dataShow[ prop ] = tween.start;
				if ( hidden ) {
					tween.end = tween.start;
					tween.start = prop === "width" || prop === "height" ? 1 : 0;
				}
			}
		}

	// If this is a noop like .hide().hide(), restore an overwritten display value
	} else if ( (display === "none" ? defaultDisplay( elem.nodeName ) : display) === "inline" ) {
		style.display = display;
	}
}

function propFilter( props, specialEasing ) {
	var index, name, easing, value, hooks;

	// camelCase, specialEasing and expand cssHook pass
	for ( index in props ) {
		name = jQuery.camelCase( index );
		easing = specialEasing[ name ];
		value = props[ index ];
		if ( jQuery.isArray( value ) ) {
			easing = value[ 1 ];
			value = props[ index ] = value[ 0 ];
		}

		if ( index !== name ) {
			props[ name ] = value;
			delete props[ index ];
		}

		hooks = jQuery.cssHooks[ name ];
		if ( hooks && "expand" in hooks ) {
			value = hooks.expand( value );
			delete props[ name ];

			// not quite $.extend, this wont overwrite keys already present.
			// also - reusing 'index' from above because we have the correct "name"
			for ( index in value ) {
				if ( !( index in props ) ) {
					props[ index ] = value[ index ];
					specialEasing[ index ] = easing;
				}
			}
		} else {
			specialEasing[ name ] = easing;
		}
	}
}

function Animation( elem, properties, options ) {
	var result,
		stopped,
		index = 0,
		length = animationPrefilters.length,
		deferred = jQuery.Deferred().always( function() {
			// don't match elem in the :animated selector
			delete tick.elem;
		}),
		tick = function() {
			if ( stopped ) {
				return false;
			}
			var currentTime = fxNow || createFxNow(),
				remaining = Math.max( 0, animation.startTime + animation.duration - currentTime ),
				// archaic crash bug won't allow us to use 1 - ( 0.5 || 0 ) (#12497)
				temp = remaining / animation.duration || 0,
				percent = 1 - temp,
				index = 0,
				length = animation.tweens.length;

			for ( ; index < length ; index++ ) {
				animation.tweens[ index ].run( percent );
			}

			deferred.notifyWith( elem, [ animation, percent, remaining ]);

			if ( percent < 1 && length ) {
				return remaining;
			} else {
				deferred.resolveWith( elem, [ animation ] );
				return false;
			}
		},
		animation = deferred.promise({
			elem: elem,
			props: jQuery.extend( {}, properties ),
			opts: jQuery.extend( true, { specialEasing: {} }, options ),
			originalProperties: properties,
			originalOptions: options,
			startTime: fxNow || createFxNow(),
			duration: options.duration,
			tweens: [],
			createTween: function( prop, end ) {
				var tween = jQuery.Tween( elem, animation.opts, prop, end,
						animation.opts.specialEasing[ prop ] || animation.opts.easing );
				animation.tweens.push( tween );
				return tween;
			},
			stop: function( gotoEnd ) {
				var index = 0,
					// if we are going to the end, we want to run all the tweens
					// otherwise we skip this part
					length = gotoEnd ? animation.tweens.length : 0;
				if ( stopped ) {
					return this;
				}
				stopped = true;
				for ( ; index < length ; index++ ) {
					animation.tweens[ index ].run( 1 );
				}

				// resolve when we played the last frame
				// otherwise, reject
				if ( gotoEnd ) {
					deferred.resolveWith( elem, [ animation, gotoEnd ] );
				} else {
					deferred.rejectWith( elem, [ animation, gotoEnd ] );
				}
				return this;
			}
		}),
		props = animation.props;

	propFilter( props, animation.opts.specialEasing );

	for ( ; index < length ; index++ ) {
		result = animationPrefilters[ index ].call( animation, elem, props, animation.opts );
		if ( result ) {
			return result;
		}
	}

	jQuery.map( props, createTween, animation );

	if ( jQuery.isFunction( animation.opts.start ) ) {
		animation.opts.start.call( elem, animation );
	}

	jQuery.fx.timer(
		jQuery.extend( tick, {
			elem: elem,
			anim: animation,
			queue: animation.opts.queue
		})
	);

	// attach callbacks from options
	return animation.progress( animation.opts.progress )
		.done( animation.opts.done, animation.opts.complete )
		.fail( animation.opts.fail )
		.always( animation.opts.always );
}

jQuery.Animation = jQuery.extend( Animation, {

	tweener: function( props, callback ) {
		if ( jQuery.isFunction( props ) ) {
			callback = props;
			props = [ "*" ];
		} else {
			props = props.split(" ");
		}

		var prop,
			index = 0,
			length = props.length;

		for ( ; index < length ; index++ ) {
			prop = props[ index ];
			tweeners[ prop ] = tweeners[ prop ] || [];
			tweeners[ prop ].unshift( callback );
		}
	},

	prefilter: function( callback, prepend ) {
		if ( prepend ) {
			animationPrefilters.unshift( callback );
		} else {
			animationPrefilters.push( callback );
		}
	}
});

jQuery.speed = function( speed, easing, fn ) {
	var opt = speed && typeof speed === "object" ? jQuery.extend( {}, speed ) : {
		complete: fn || !fn && easing ||
			jQuery.isFunction( speed ) && speed,
		duration: speed,
		easing: fn && easing || easing && !jQuery.isFunction( easing ) && easing
	};

	opt.duration = jQuery.fx.off ? 0 : typeof opt.duration === "number" ? opt.duration :
		opt.duration in jQuery.fx.speeds ? jQuery.fx.speeds[ opt.duration ] : jQuery.fx.speeds._default;

	// normalize opt.queue - true/undefined/null -> "fx"
	if ( opt.queue == null || opt.queue === true ) {
		opt.queue = "fx";
	}

	// Queueing
	opt.old = opt.complete;

	opt.complete = function() {
		if ( jQuery.isFunction( opt.old ) ) {
			opt.old.call( this );
		}

		if ( opt.queue ) {
			jQuery.dequeue( this, opt.queue );
		}
	};

	return opt;
};

jQuery.fn.extend({
	fadeTo: function( speed, to, easing, callback ) {

		// show any hidden elements after setting opacity to 0
		return this.filter( isHidden ).css( "opacity", 0 ).show()

			// animate to the value specified
			.end().animate({ opacity: to }, speed, easing, callback );
	},
	animate: function( prop, speed, easing, callback ) {
		var empty = jQuery.isEmptyObject( prop ),
			optall = jQuery.speed( speed, easing, callback ),
			doAnimation = function() {
				// Operate on a copy of prop so per-property easing won't be lost
				var anim = Animation( this, jQuery.extend( {}, prop ), optall );

				// Empty animations, or finishing resolves immediately
				if ( empty || data_priv.get( this, "finish" ) ) {
					anim.stop( true );
				}
			};
			doAnimation.finish = doAnimation;

		return empty || optall.queue === false ?
			this.each( doAnimation ) :
			this.queue( optall.queue, doAnimation );
	},
	stop: function( type, clearQueue, gotoEnd ) {
		var stopQueue = function( hooks ) {
			var stop = hooks.stop;
			delete hooks.stop;
			stop( gotoEnd );
		};

		if ( typeof type !== "string" ) {
			gotoEnd = clearQueue;
			clearQueue = type;
			type = undefined;
		}
		if ( clearQueue && type !== false ) {
			this.queue( type || "fx", [] );
		}

		return this.each(function() {
			var dequeue = true,
				index = type != null && type + "queueHooks",
				timers = jQuery.timers,
				data = data_priv.get( this );

			if ( index ) {
				if ( data[ index ] && data[ index ].stop ) {
					stopQueue( data[ index ] );
				}
			} else {
				for ( index in data ) {
					if ( data[ index ] && data[ index ].stop && rrun.test( index ) ) {
						stopQueue( data[ index ] );
					}
				}
			}

			for ( index = timers.length; index--; ) {
				if ( timers[ index ].elem === this && (type == null || timers[ index ].queue === type) ) {
					timers[ index ].anim.stop( gotoEnd );
					dequeue = false;
					timers.splice( index, 1 );
				}
			}

			// start the next in the queue if the last step wasn't forced
			// timers currently will call their complete callbacks, which will dequeue
			// but only if they were gotoEnd
			if ( dequeue || !gotoEnd ) {
				jQuery.dequeue( this, type );
			}
		});
	},
	finish: function( type ) {
		if ( type !== false ) {
			type = type || "fx";
		}
		return this.each(function() {
			var index,
				data = data_priv.get( this ),
				queue = data[ type + "queue" ],
				hooks = data[ type + "queueHooks" ],
				timers = jQuery.timers,
				length = queue ? queue.length : 0;

			// enable finishing flag on private data
			data.finish = true;

			// empty the queue first
			jQuery.queue( this, type, [] );

			if ( hooks && hooks.stop ) {
				hooks.stop.call( this, true );
			}

			// look for any active animations, and finish them
			for ( index = timers.length; index--; ) {
				if ( timers[ index ].elem === this && timers[ index ].queue === type ) {
					timers[ index ].anim.stop( true );
					timers.splice( index, 1 );
				}
			}

			// look for any animations in the old queue and finish them
			for ( index = 0; index < length; index++ ) {
				if ( queue[ index ] && queue[ index ].finish ) {
					queue[ index ].finish.call( this );
				}
			}

			// turn off finishing flag
			delete data.finish;
		});
	}
});

jQuery.each([ "toggle", "show", "hide" ], function( i, name ) {
	var cssFn = jQuery.fn[ name ];
	jQuery.fn[ name ] = function( speed, easing, callback ) {
		return speed == null || typeof speed === "boolean" ?
			cssFn.apply( this, arguments ) :
			this.animate( genFx( name, true ), speed, easing, callback );
	};
});

// Generate shortcuts for custom animations
jQuery.each({
	slideDown: genFx("show"),
	slideUp: genFx("hide"),
	slideToggle: genFx("toggle"),
	fadeIn: { opacity: "show" },
	fadeOut: { opacity: "hide" },
	fadeToggle: { opacity: "toggle" }
}, function( name, props ) {
	jQuery.fn[ name ] = function( speed, easing, callback ) {
		return this.animate( props, speed, easing, callback );
	};
});

jQuery.timers = [];
jQuery.fx.tick = function() {
	var timer,
		i = 0,
		timers = jQuery.timers;

	fxNow = jQuery.now();

	for ( ; i < timers.length; i++ ) {
		timer = timers[ i ];
		// Checks the timer has not already been removed
		if ( !timer() && timers[ i ] === timer ) {
			timers.splice( i--, 1 );
		}
	}

	if ( !timers.length ) {
		jQuery.fx.stop();
	}
	fxNow = undefined;
};

jQuery.fx.timer = function( timer ) {
	jQuery.timers.push( timer );
	if ( timer() ) {
		jQuery.fx.start();
	} else {
		jQuery.timers.pop();
	}
};

jQuery.fx.interval = 13;

jQuery.fx.start = function() {
	if ( !timerId ) {
		timerId = setInterval( jQuery.fx.tick, jQuery.fx.interval );
	}
};

jQuery.fx.stop = function() {
	clearInterval( timerId );
	timerId = null;
};

jQuery.fx.speeds = {
	slow: 600,
	fast: 200,
	// Default speed
	_default: 400
};


// Based off of the plugin by Clint Helfers, with permission.
// http://blindsignals.com/index.php/2009/07/jquery-delay/
jQuery.fn.delay = function( time, type ) {
	time = jQuery.fx ? jQuery.fx.speeds[ time ] || time : time;
	type = type || "fx";

	return this.queue( type, function( next, hooks ) {
		var timeout = setTimeout( next, time );
		hooks.stop = function() {
			clearTimeout( timeout );
		};
	});
};


(function() {
	var input = document.createElement( "input" ),
		select = document.createElement( "select" ),
		opt = select.appendChild( document.createElement( "option" ) );

	input.type = "checkbox";

	// Support: iOS 5.1, Android 4.x, Android 2.3
	// Check the default checkbox/radio value ("" on old WebKit; "on" elsewhere)
	support.checkOn = input.value !== "";

	// Must access the parent to make an option select properly
	// Support: IE9, IE10
	support.optSelected = opt.selected;

	// Make sure that the options inside disabled selects aren't marked as disabled
	// (WebKit marks them as disabled)
	select.disabled = true;
	support.optDisabled = !opt.disabled;

	// Check if an input maintains its value after becoming a radio
	// Support: IE9, IE10
	input = document.createElement( "input" );
	input.value = "t";
	input.type = "radio";
	support.radioValue = input.value === "t";
})();


var nodeHook, boolHook,
	attrHandle = jQuery.expr.attrHandle;

jQuery.fn.extend({
	attr: function( name, value ) {
		return access( this, jQuery.attr, name, value, arguments.length > 1 );
	},

	removeAttr: function( name ) {
		return this.each(function() {
			jQuery.removeAttr( this, name );
		});
	}
});

jQuery.extend({
	attr: function( elem, name, value ) {
		var hooks, ret,
			nType = elem.nodeType;

		// don't get/set attributes on text, comment and attribute nodes
		if ( !elem || nType === 3 || nType === 8 || nType === 2 ) {
			return;
		}

		// Fallback to prop when attributes are not supported
		if ( typeof elem.getAttribute === strundefined ) {
			return jQuery.prop( elem, name, value );
		}

		// All attributes are lowercase
		// Grab necessary hook if one is defined
		if ( nType !== 1 || !jQuery.isXMLDoc( elem ) ) {
			name = name.toLowerCase();
			hooks = jQuery.attrHooks[ name ] ||
				( jQuery.expr.match.bool.test( name ) ? boolHook : nodeHook );
		}

		if ( value !== undefined ) {

			if ( value === null ) {
				jQuery.removeAttr( elem, name );

			} else if ( hooks && "set" in hooks && (ret = hooks.set( elem, value, name )) !== undefined ) {
				return ret;

			} else {
				elem.setAttribute( name, value + "" );
				return value;
			}

		} else if ( hooks && "get" in hooks && (ret = hooks.get( elem, name )) !== null ) {
			return ret;

		} else {
			ret = jQuery.find.attr( elem, name );

			// Non-existent attributes return null, we normalize to undefined
			return ret == null ?
				undefined :
				ret;
		}
	},

	removeAttr: function( elem, value ) {
		var name, propName,
			i = 0,
			attrNames = value && value.match( rnotwhite );

		if ( attrNames && elem.nodeType === 1 ) {
			while ( (name = attrNames[i++]) ) {
				propName = jQuery.propFix[ name ] || name;

				// Boolean attributes get special treatment (#10870)
				if ( jQuery.expr.match.bool.test( name ) ) {
					// Set corresponding property to false
					elem[ propName ] = false;
				}

				elem.removeAttribute( name );
			}
		}
	},

	attrHooks: {
		type: {
			set: function( elem, value ) {
				if ( !support.radioValue && value === "radio" &&
					jQuery.nodeName( elem, "input" ) ) {
					// Setting the type on a radio button after the value resets the value in IE6-9
					// Reset value to default in case type is set after value during creation
					var val = elem.value;
					elem.setAttribute( "type", value );
					if ( val ) {
						elem.value = val;
					}
					return value;
				}
			}
		}
	}
});

// Hooks for boolean attributes
boolHook = {
	set: function( elem, value, name ) {
		if ( value === false ) {
			// Remove boolean attributes when set to false
			jQuery.removeAttr( elem, name );
		} else {
			elem.setAttribute( name, name );
		}
		return name;
	}
};
jQuery.each( jQuery.expr.match.bool.source.match( /\w+/g ), function( i, name ) {
	var getter = attrHandle[ name ] || jQuery.find.attr;

	attrHandle[ name ] = function( elem, name, isXML ) {
		var ret, handle;
		if ( !isXML ) {
			// Avoid an infinite loop by temporarily removing this function from the getter
			handle = attrHandle[ name ];
			attrHandle[ name ] = ret;
			ret = getter( elem, name, isXML ) != null ?
				name.toLowerCase() :
				null;
			attrHandle[ name ] = handle;
		}
		return ret;
	};
});




var rfocusable = /^(?:input|select|textarea|button)$/i;

jQuery.fn.extend({
	prop: function( name, value ) {
		return access( this, jQuery.prop, name, value, arguments.length > 1 );
	},

	removeProp: function( name ) {
		return this.each(function() {
			delete this[ jQuery.propFix[ name ] || name ];
		});
	}
});

jQuery.extend({
	propFix: {
		"for": "htmlFor",
		"class": "className"
	},

	prop: function( elem, name, value ) {
		var ret, hooks, notxml,
			nType = elem.nodeType;

		// don't get/set properties on text, comment and attribute nodes
		if ( !elem || nType === 3 || nType === 8 || nType === 2 ) {
			return;
		}

		notxml = nType !== 1 || !jQuery.isXMLDoc( elem );

		if ( notxml ) {
			// Fix name and attach hooks
			name = jQuery.propFix[ name ] || name;
			hooks = jQuery.propHooks[ name ];
		}

		if ( value !== undefined ) {
			return hooks && "set" in hooks && (ret = hooks.set( elem, value, name )) !== undefined ?
				ret :
				( elem[ name ] = value );

		} else {
			return hooks && "get" in hooks && (ret = hooks.get( elem, name )) !== null ?
				ret :
				elem[ name ];
		}
	},

	propHooks: {
		tabIndex: {
			get: function( elem ) {
				return elem.hasAttribute( "tabindex" ) || rfocusable.test( elem.nodeName ) || elem.href ?
					elem.tabIndex :
					-1;
			}
		}
	}
});

// Support: IE9+
// Selectedness for an option in an optgroup can be inaccurate
if ( !support.optSelected ) {
	jQuery.propHooks.selected = {
		get: function( elem ) {
			var parent = elem.parentNode;
			if ( parent && parent.parentNode ) {
				parent.parentNode.selectedIndex;
			}
			return null;
		}
	};
}

jQuery.each([
	"tabIndex",
	"readOnly",
	"maxLength",
	"cellSpacing",
	"cellPadding",
	"rowSpan",
	"colSpan",
	"useMap",
	"frameBorder",
	"contentEditable"
], function() {
	jQuery.propFix[ this.toLowerCase() ] = this;
});




var rclass = /[\t\r\n\f]/g;

jQuery.fn.extend({
	addClass: function( value ) {
		var classes, elem, cur, clazz, j, finalValue,
			proceed = typeof value === "string" && value,
			i = 0,
			len = this.length;

		if ( jQuery.isFunction( value ) ) {
			return this.each(function( j ) {
				jQuery( this ).addClass( value.call( this, j, this.className ) );
			});
		}

		if ( proceed ) {
			// The disjunction here is for better compressibility (see removeClass)
			classes = ( value || "" ).match( rnotwhite ) || [];

			for ( ; i < len; i++ ) {
				elem = this[ i ];
				cur = elem.nodeType === 1 && ( elem.className ?
					( " " + elem.className + " " ).replace( rclass, " " ) :
					" "
				);

				if ( cur ) {
					j = 0;
					while ( (clazz = classes[j++]) ) {
						if ( cur.indexOf( " " + clazz + " " ) < 0 ) {
							cur += clazz + " ";
						}
					}

					// only assign if different to avoid unneeded rendering.
					finalValue = jQuery.trim( cur );
					if ( elem.className !== finalValue ) {
						elem.className = finalValue;
					}
				}
			}
		}

		return this;
	},

	removeClass: function( value ) {
		var classes, elem, cur, clazz, j, finalValue,
			proceed = arguments.length === 0 || typeof value === "string" && value,
			i = 0,
			len = this.length;

		if ( jQuery.isFunction( value ) ) {
			return this.each(function( j ) {
				jQuery( this ).removeClass( value.call( this, j, this.className ) );
			});
		}
		if ( proceed ) {
			classes = ( value || "" ).match( rnotwhite ) || [];

			for ( ; i < len; i++ ) {
				elem = this[ i ];
				// This expression is here for better compressibility (see addClass)
				cur = elem.nodeType === 1 && ( elem.className ?
					( " " + elem.className + " " ).replace( rclass, " " ) :
					""
				);

				if ( cur ) {
					j = 0;
					while ( (clazz = classes[j++]) ) {
						// Remove *all* instances
						while ( cur.indexOf( " " + clazz + " " ) >= 0 ) {
							cur = cur.replace( " " + clazz + " ", " " );
						}
					}

					// only assign if different to avoid unneeded rendering.
					finalValue = value ? jQuery.trim( cur ) : "";
					if ( elem.className !== finalValue ) {
						elem.className = finalValue;
					}
				}
			}
		}

		return this;
	},

	toggleClass: function( value, stateVal ) {
		var type = typeof value;

		if ( typeof stateVal === "boolean" && type === "string" ) {
			return stateVal ? this.addClass( value ) : this.removeClass( value );
		}

		if ( jQuery.isFunction( value ) ) {
			return this.each(function( i ) {
				jQuery( this ).toggleClass( value.call(this, i, this.className, stateVal), stateVal );
			});
		}

		return this.each(function() {
			if ( type === "string" ) {
				// toggle individual class names
				var className,
					i = 0,
					self = jQuery( this ),
					classNames = value.match( rnotwhite ) || [];

				while ( (className = classNames[ i++ ]) ) {
					// check each className given, space separated list
					if ( self.hasClass( className ) ) {
						self.removeClass( className );
					} else {
						self.addClass( className );
					}
				}

			// Toggle whole class name
			} else if ( type === strundefined || type === "boolean" ) {
				if ( this.className ) {
					// store className if set
					data_priv.set( this, "__className__", this.className );
				}

				// If the element has a class name or if we're passed "false",
				// then remove the whole classname (if there was one, the above saved it).
				// Otherwise bring back whatever was previously saved (if anything),
				// falling back to the empty string if nothing was stored.
				this.className = this.className || value === false ? "" : data_priv.get( this, "__className__" ) || "";
			}
		});
	},

	hasClass: function( selector ) {
		var className = " " + selector + " ",
			i = 0,
			l = this.length;
		for ( ; i < l; i++ ) {
			if ( this[i].nodeType === 1 && (" " + this[i].className + " ").replace(rclass, " ").indexOf( className ) >= 0 ) {
				return true;
			}
		}

		return false;
	}
});




var rreturn = /\r/g;

jQuery.fn.extend({
	val: function( value ) {
		var hooks, ret, isFunction,
			elem = this[0];

		if ( !arguments.length ) {
			if ( elem ) {
				hooks = jQuery.valHooks[ elem.type ] || jQuery.valHooks[ elem.nodeName.toLowerCase() ];

				if ( hooks && "get" in hooks && (ret = hooks.get( elem, "value" )) !== undefined ) {
					return ret;
				}

				ret = elem.value;

				return typeof ret === "string" ?
					// handle most common string cases
					ret.replace(rreturn, "") :
					// handle cases where value is null/undef or number
					ret == null ? "" : ret;
			}

			return;
		}

		isFunction = jQuery.isFunction( value );

		return this.each(function( i ) {
			var val;

			if ( this.nodeType !== 1 ) {
				return;
			}

			if ( isFunction ) {
				val = value.call( this, i, jQuery( this ).val() );
			} else {
				val = value;
			}

			// Treat null/undefined as ""; convert numbers to string
			if ( val == null ) {
				val = "";

			} else if ( typeof val === "number" ) {
				val += "";

			} else if ( jQuery.isArray( val ) ) {
				val = jQuery.map( val, function( value ) {
					return value == null ? "" : value + "";
				});
			}

			hooks = jQuery.valHooks[ this.type ] || jQuery.valHooks[ this.nodeName.toLowerCase() ];

			// If set returns undefined, fall back to normal setting
			if ( !hooks || !("set" in hooks) || hooks.set( this, val, "value" ) === undefined ) {
				this.value = val;
			}
		});
	}
});

jQuery.extend({
	valHooks: {
		option: {
			get: function( elem ) {
				var val = jQuery.find.attr( elem, "value" );
				return val != null ?
					val :
					// Support: IE10-11+
					// option.text throws exceptions (#14686, #14858)
					jQuery.trim( jQuery.text( elem ) );
			}
		},
		select: {
			get: function( elem ) {
				var value, option,
					options = elem.options,
					index = elem.selectedIndex,
					one = elem.type === "select-one" || index < 0,
					values = one ? null : [],
					max = one ? index + 1 : options.length,
					i = index < 0 ?
						max :
						one ? index : 0;

				// Loop through all the selected options
				for ( ; i < max; i++ ) {
					option = options[ i ];

					// IE6-9 doesn't update selected after form reset (#2551)
					if ( ( option.selected || i === index ) &&
							// Don't return options that are disabled or in a disabled optgroup
							( support.optDisabled ? !option.disabled : option.getAttribute( "disabled" ) === null ) &&
							( !option.parentNode.disabled || !jQuery.nodeName( option.parentNode, "optgroup" ) ) ) {

						// Get the specific value for the option
						value = jQuery( option ).val();

						// We don't need an array for one selects
						if ( one ) {
							return value;
						}

						// Multi-Selects return an array
						values.push( value );
					}
				}

				return values;
			},

			set: function( elem, value ) {
				var optionSet, option,
					options = elem.options,
					values = jQuery.makeArray( value ),
					i = options.length;

				while ( i-- ) {
					option = options[ i ];
					if ( (option.selected = jQuery.inArray( option.value, values ) >= 0) ) {
						optionSet = true;
					}
				}

				// force browsers to behave consistently when non-matching value is set
				if ( !optionSet ) {
					elem.selectedIndex = -1;
				}
				return values;
			}
		}
	}
});

// Radios and checkboxes getter/setter
jQuery.each([ "radio", "checkbox" ], function() {
	jQuery.valHooks[ this ] = {
		set: function( elem, value ) {
			if ( jQuery.isArray( value ) ) {
				return ( elem.checked = jQuery.inArray( jQuery(elem).val(), value ) >= 0 );
			}
		}
	};
	if ( !support.checkOn ) {
		jQuery.valHooks[ this ].get = function( elem ) {
			// Support: Webkit
			// "" is returned instead of "on" if a value isn't specified
			return elem.getAttribute("value") === null ? "on" : elem.value;
		};
	}
});




// Return jQuery for attributes-only inclusion


jQuery.each( ("blur focus focusin focusout load resize scroll unload click dblclick " +
	"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave " +
	"change select submit keydown keypress keyup error contextmenu").split(" "), function( i, name ) {

	// Handle event binding
	jQuery.fn[ name ] = function( data, fn ) {
		return arguments.length > 0 ?
			this.on( name, null, data, fn ) :
			this.trigger( name );
	};
});

jQuery.fn.extend({
	hover: function( fnOver, fnOut ) {
		return this.mouseenter( fnOver ).mouseleave( fnOut || fnOver );
	},

	bind: function( types, data, fn ) {
		return this.on( types, null, data, fn );
	},
	unbind: function( types, fn ) {
		return this.off( types, null, fn );
	},

	delegate: function( selector, types, data, fn ) {
		return this.on( types, selector, data, fn );
	},
	undelegate: function( selector, types, fn ) {
		// ( namespace ) or ( selector, types [, fn] )
		return arguments.length === 1 ? this.off( selector, "**" ) : this.off( types, selector || "**", fn );
	}
});


var nonce = jQuery.now();

var rquery = (/\?/);



// Support: Android 2.3
// Workaround failure to string-cast null input
jQuery.parseJSON = function( data ) {
	return JSON.parse( data + "" );
};


// Cross-browser xml parsing
jQuery.parseXML = function( data ) {
	var xml, tmp;
	if ( !data || typeof data !== "string" ) {
		return null;
	}

	// Support: IE9
	try {
		tmp = new DOMParser();
		xml = tmp.parseFromString( data, "text/xml" );
	} catch ( e ) {
		xml = undefined;
	}

	if ( !xml || xml.getElementsByTagName( "parsererror" ).length ) {
		jQuery.error( "Invalid XML: " + data );
	}
	return xml;
};


var
	// Document location
	ajaxLocParts,
	ajaxLocation,

	rhash = /#.*$/,
	rts = /([?&])_=[^&]*/,
	rheaders = /^(.*?):[ \t]*([^\r\n]*)$/mg,
	// #7653, #8125, #8152: local protocol detection
	rlocalProtocol = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/,
	rnoContent = /^(?:GET|HEAD)$/,
	rprotocol = /^\/\//,
	rurl = /^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,

	/* Prefilters
	 * 1) They are useful to introduce custom dataTypes (see ajax/jsonp.js for an example)
	 * 2) These are called:
	 *    - BEFORE asking for a transport
	 *    - AFTER param serialization (s.data is a string if s.processData is true)
	 * 3) key is the dataType
	 * 4) the catchall symbol "*" can be used
	 * 5) execution will start with transport dataType and THEN continue down to "*" if needed
	 */
	prefilters = {},

	/* Transports bindings
	 * 1) key is the dataType
	 * 2) the catchall symbol "*" can be used
	 * 3) selection will start with transport dataType and THEN go to "*" if needed
	 */
	transports = {},

	// Avoid comment-prolog char sequence (#10098); must appease lint and evade compression
	allTypes = "*/".concat("*");

// #8138, IE may throw an exception when accessing
// a field from window.location if document.domain has been set
try {
	ajaxLocation = location.href;
} catch( e ) {
	// Use the href attribute of an A element
	// since IE will modify it given document.location
	ajaxLocation = document.createElement( "a" );
	ajaxLocation.href = "";
	ajaxLocation = ajaxLocation.href;
}

// Segment location into parts
ajaxLocParts = rurl.exec( ajaxLocation.toLowerCase() ) || [];

// Base "constructor" for jQuery.ajaxPrefilter and jQuery.ajaxTransport
function addToPrefiltersOrTransports( structure ) {

	// dataTypeExpression is optional and defaults to "*"
	return function( dataTypeExpression, func ) {

		if ( typeof dataTypeExpression !== "string" ) {
			func = dataTypeExpression;
			dataTypeExpression = "*";
		}

		var dataType,
			i = 0,
			dataTypes = dataTypeExpression.toLowerCase().match( rnotwhite ) || [];

		if ( jQuery.isFunction( func ) ) {
			// For each dataType in the dataTypeExpression
			while ( (dataType = dataTypes[i++]) ) {
				// Prepend if requested
				if ( dataType[0] === "+" ) {
					dataType = dataType.slice( 1 ) || "*";
					(structure[ dataType ] = structure[ dataType ] || []).unshift( func );

				// Otherwise append
				} else {
					(structure[ dataType ] = structure[ dataType ] || []).push( func );
				}
			}
		}
	};
}

// Base inspection function for prefilters and transports
function inspectPrefiltersOrTransports( structure, options, originalOptions, jqXHR ) {

	var inspected = {},
		seekingTransport = ( structure === transports );

	function inspect( dataType ) {
		var selected;
		inspected[ dataType ] = true;
		jQuery.each( structure[ dataType ] || [], function( _, prefilterOrFactory ) {
			var dataTypeOrTransport = prefilterOrFactory( options, originalOptions, jqXHR );
			if ( typeof dataTypeOrTransport === "string" && !seekingTransport && !inspected[ dataTypeOrTransport ] ) {
				options.dataTypes.unshift( dataTypeOrTransport );
				inspect( dataTypeOrTransport );
				return false;
			} else if ( seekingTransport ) {
				return !( selected = dataTypeOrTransport );
			}
		});
		return selected;
	}

	return inspect( options.dataTypes[ 0 ] ) || !inspected[ "*" ] && inspect( "*" );
}

// A special extend for ajax options
// that takes "flat" options (not to be deep extended)
// Fixes #9887
function ajaxExtend( target, src ) {
	var key, deep,
		flatOptions = jQuery.ajaxSettings.flatOptions || {};

	for ( key in src ) {
		if ( src[ key ] !== undefined ) {
			( flatOptions[ key ] ? target : ( deep || (deep = {}) ) )[ key ] = src[ key ];
		}
	}
	if ( deep ) {
		jQuery.extend( true, target, deep );
	}

	return target;
}

/* Handles responses to an ajax request:
 * - finds the right dataType (mediates between content-type and expected dataType)
 * - returns the corresponding response
 */
function ajaxHandleResponses( s, jqXHR, responses ) {

	var ct, type, finalDataType, firstDataType,
		contents = s.contents,
		dataTypes = s.dataTypes;

	// Remove auto dataType and get content-type in the process
	while ( dataTypes[ 0 ] === "*" ) {
		dataTypes.shift();
		if ( ct === undefined ) {
			ct = s.mimeType || jqXHR.getResponseHeader("Content-Type");
		}
	}

	// Check if we're dealing with a known content-type
	if ( ct ) {
		for ( type in contents ) {
			if ( contents[ type ] && contents[ type ].test( ct ) ) {
				dataTypes.unshift( type );
				break;
			}
		}
	}

	// Check to see if we have a response for the expected dataType
	if ( dataTypes[ 0 ] in responses ) {
		finalDataType = dataTypes[ 0 ];
	} else {
		// Try convertible dataTypes
		for ( type in responses ) {
			if ( !dataTypes[ 0 ] || s.converters[ type + " " + dataTypes[0] ] ) {
				finalDataType = type;
				break;
			}
			if ( !firstDataType ) {
				firstDataType = type;
			}
		}
		// Or just use first one
		finalDataType = finalDataType || firstDataType;
	}

	// If we found a dataType
	// We add the dataType to the list if needed
	// and return the corresponding response
	if ( finalDataType ) {
		if ( finalDataType !== dataTypes[ 0 ] ) {
			dataTypes.unshift( finalDataType );
		}
		return responses[ finalDataType ];
	}
}

/* Chain conversions given the request and the original response
 * Also sets the responseXXX fields on the jqXHR instance
 */
function ajaxConvert( s, response, jqXHR, isSuccess ) {
	var conv2, current, conv, tmp, prev,
		converters = {},
		// Work with a copy of dataTypes in case we need to modify it for conversion
		dataTypes = s.dataTypes.slice();

	// Create converters map with lowercased keys
	if ( dataTypes[ 1 ] ) {
		for ( conv in s.converters ) {
			converters[ conv.toLowerCase() ] = s.converters[ conv ];
		}
	}

	current = dataTypes.shift();

	// Convert to each sequential dataType
	while ( current ) {

		if ( s.responseFields[ current ] ) {
			jqXHR[ s.responseFields[ current ] ] = response;
		}

		// Apply the dataFilter if provided
		if ( !prev && isSuccess && s.dataFilter ) {
			response = s.dataFilter( response, s.dataType );
		}

		prev = current;
		current = dataTypes.shift();

		if ( current ) {

		// There's only work to do if current dataType is non-auto
			if ( current === "*" ) {

				current = prev;

			// Convert response if prev dataType is non-auto and differs from current
			} else if ( prev !== "*" && prev !== current ) {

				// Seek a direct converter
				conv = converters[ prev + " " + current ] || converters[ "* " + current ];

				// If none found, seek a pair
				if ( !conv ) {
					for ( conv2 in converters ) {

						// If conv2 outputs current
						tmp = conv2.split( " " );
						if ( tmp[ 1 ] === current ) {

							// If prev can be converted to accepted input
							conv = converters[ prev + " " + tmp[ 0 ] ] ||
								converters[ "* " + tmp[ 0 ] ];
							if ( conv ) {
								// Condense equivalence converters
								if ( conv === true ) {
									conv = converters[ conv2 ];

								// Otherwise, insert the intermediate dataType
								} else if ( converters[ conv2 ] !== true ) {
									current = tmp[ 0 ];
									dataTypes.unshift( tmp[ 1 ] );
								}
								break;
							}
						}
					}
				}

				// Apply converter (if not an equivalence)
				if ( conv !== true ) {

					// Unless errors are allowed to bubble, catch and return them
					if ( conv && s[ "throws" ] ) {
						response = conv( response );
					} else {
						try {
							response = conv( response );
						} catch ( e ) {
							return { state: "parsererror", error: conv ? e : "No conversion from " + prev + " to " + current };
						}
					}
				}
			}
		}
	}

	return { state: "success", data: response };
}

jQuery.extend({

	// Counter for holding the number of active queries
	active: 0,

	// Last-Modified header cache for next request
	lastModified: {},
	etag: {},

	ajaxSettings: {
		url: ajaxLocation,
		type: "GET",
		isLocal: rlocalProtocol.test( ajaxLocParts[ 1 ] ),
		global: true,
		processData: true,
		async: true,
		contentType: "application/x-www-form-urlencoded; charset=UTF-8",
		/*
		timeout: 0,
		data: null,
		dataType: null,
		username: null,
		password: null,
		cache: null,
		throws: false,
		traditional: false,
		headers: {},
		*/

		accepts: {
			"*": allTypes,
			text: "text/plain",
			html: "text/html",
			xml: "application/xml, text/xml",
			json: "application/json, text/javascript"
		},

		contents: {
			xml: /xml/,
			html: /html/,
			json: /json/
		},

		responseFields: {
			xml: "responseXML",
			text: "responseText",
			json: "responseJSON"
		},

		// Data converters
		// Keys separate source (or catchall "*") and destination types with a single space
		converters: {

			// Convert anything to text
			"* text": String,

			// Text to html (true = no transformation)
			"text html": true,

			// Evaluate text as a json expression
			"text json": jQuery.parseJSON,

			// Parse text as xml
			"text xml": jQuery.parseXML
		},

		// For options that shouldn't be deep extended:
		// you can add your own custom options here if
		// and when you create one that shouldn't be
		// deep extended (see ajaxExtend)
		flatOptions: {
			url: true,
			context: true
		}
	},

	// Creates a full fledged settings object into target
	// with both ajaxSettings and settings fields.
	// If target is omitted, writes into ajaxSettings.
	ajaxSetup: function( target, settings ) {
		return settings ?

			// Building a settings object
			ajaxExtend( ajaxExtend( target, jQuery.ajaxSettings ), settings ) :

			// Extending ajaxSettings
			ajaxExtend( jQuery.ajaxSettings, target );
	},

	ajaxPrefilter: addToPrefiltersOrTransports( prefilters ),
	ajaxTransport: addToPrefiltersOrTransports( transports ),

	// Main method
	ajax: function( url, options ) {

		// If url is an object, simulate pre-1.5 signature
		if ( typeof url === "object" ) {
			options = url;
			url = undefined;
		}

		// Force options to be an object
		options = options || {};

		var transport,
			// URL without anti-cache param
			cacheURL,
			// Response headers
			responseHeadersString,
			responseHeaders,
			// timeout handle
			timeoutTimer,
			// Cross-domain detection vars
			parts,
			// To know if global events are to be dispatched
			fireGlobals,
			// Loop variable
			i,
			// Create the final options object
			s = jQuery.ajaxSetup( {}, options ),
			// Callbacks context
			callbackContext = s.context || s,
			// Context for global events is callbackContext if it is a DOM node or jQuery collection
			globalEventContext = s.context && ( callbackContext.nodeType || callbackContext.jquery ) ?
				jQuery( callbackContext ) :
				jQuery.event,
			// Deferreds
			deferred = jQuery.Deferred(),
			completeDeferred = jQuery.Callbacks("once memory"),
			// Status-dependent callbacks
			statusCode = s.statusCode || {},
			// Headers (they are sent all at once)
			requestHeaders = {},
			requestHeadersNames = {},
			// The jqXHR state
			state = 0,
			// Default abort message
			strAbort = "canceled",
			// Fake xhr
			jqXHR = {
				readyState: 0,

				// Builds headers hashtable if needed
				getResponseHeader: function( key ) {
					var match;
					if ( state === 2 ) {
						if ( !responseHeaders ) {
							responseHeaders = {};
							while ( (match = rheaders.exec( responseHeadersString )) ) {
								responseHeaders[ match[1].toLowerCase() ] = match[ 2 ];
							}
						}
						match = responseHeaders[ key.toLowerCase() ];
					}
					return match == null ? null : match;
				},

				// Raw string
				getAllResponseHeaders: function() {
					return state === 2 ? responseHeadersString : null;
				},

				// Caches the header
				setRequestHeader: function( name, value ) {
					var lname = name.toLowerCase();
					if ( !state ) {
						name = requestHeadersNames[ lname ] = requestHeadersNames[ lname ] || name;
						requestHeaders[ name ] = value;
					}
					return this;
				},

				// Overrides response content-type header
				overrideMimeType: function( type ) {
					if ( !state ) {
						s.mimeType = type;
					}
					return this;
				},

				// Status-dependent callbacks
				statusCode: function( map ) {
					var code;
					if ( map ) {
						if ( state < 2 ) {
							for ( code in map ) {
								// Lazy-add the new callback in a way that preserves old ones
								statusCode[ code ] = [ statusCode[ code ], map[ code ] ];
							}
						} else {
							// Execute the appropriate callbacks
							jqXHR.always( map[ jqXHR.status ] );
						}
					}
					return this;
				},

				// Cancel the request
				abort: function( statusText ) {
					var finalText = statusText || strAbort;
					if ( transport ) {
						transport.abort( finalText );
					}
					done( 0, finalText );
					return this;
				}
			};

		// Attach deferreds
		deferred.promise( jqXHR ).complete = completeDeferred.add;
		jqXHR.success = jqXHR.done;
		jqXHR.error = jqXHR.fail;

		// Remove hash character (#7531: and string promotion)
		// Add protocol if not provided (prefilters might expect it)
		// Handle falsy url in the settings object (#10093: consistency with old signature)
		// We also use the url parameter if available
		s.url = ( ( url || s.url || ajaxLocation ) + "" ).replace( rhash, "" )
			.replace( rprotocol, ajaxLocParts[ 1 ] + "//" );

		// Alias method option to type as per ticket #12004
		s.type = options.method || options.type || s.method || s.type;

		// Extract dataTypes list
		s.dataTypes = jQuery.trim( s.dataType || "*" ).toLowerCase().match( rnotwhite ) || [ "" ];

		// A cross-domain request is in order when we have a protocol:host:port mismatch
		if ( s.crossDomain == null ) {
			parts = rurl.exec( s.url.toLowerCase() );
			s.crossDomain = !!( parts &&
				( parts[ 1 ] !== ajaxLocParts[ 1 ] || parts[ 2 ] !== ajaxLocParts[ 2 ] ||
					( parts[ 3 ] || ( parts[ 1 ] === "http:" ? "80" : "443" ) ) !==
						( ajaxLocParts[ 3 ] || ( ajaxLocParts[ 1 ] === "http:" ? "80" : "443" ) ) )
			);
		}

		// Convert data if not already a string
		if ( s.data && s.processData && typeof s.data !== "string" ) {
			s.data = jQuery.param( s.data, s.traditional );
		}

		// Apply prefilters
		inspectPrefiltersOrTransports( prefilters, s, options, jqXHR );

		// If request was aborted inside a prefilter, stop there
		if ( state === 2 ) {
			return jqXHR;
		}

		// We can fire global events as of now if asked to
		fireGlobals = s.global;

		// Watch for a new set of requests
		if ( fireGlobals && jQuery.active++ === 0 ) {
			jQuery.event.trigger("ajaxStart");
		}

		// Uppercase the type
		s.type = s.type.toUpperCase();

		// Determine if request has content
		s.hasContent = !rnoContent.test( s.type );

		// Save the URL in case we're toying with the If-Modified-Since
		// and/or If-None-Match header later on
		cacheURL = s.url;

		// More options handling for requests with no content
		if ( !s.hasContent ) {

			// If data is available, append data to url
			if ( s.data ) {
				cacheURL = ( s.url += ( rquery.test( cacheURL ) ? "&" : "?" ) + s.data );
				// #9682: remove data so that it's not used in an eventual retry
				delete s.data;
			}

			// Add anti-cache in url if needed
			if ( s.cache === false ) {
				s.url = rts.test( cacheURL ) ?

					// If there is already a '_' parameter, set its value
					cacheURL.replace( rts, "$1_=" + nonce++ ) :

					// Otherwise add one to the end
					cacheURL + ( rquery.test( cacheURL ) ? "&" : "?" ) + "_=" + nonce++;
			}
		}

		// Set the If-Modified-Since and/or If-None-Match header, if in ifModified mode.
		if ( s.ifModified ) {
			if ( jQuery.lastModified[ cacheURL ] ) {
				jqXHR.setRequestHeader( "If-Modified-Since", jQuery.lastModified[ cacheURL ] );
			}
			if ( jQuery.etag[ cacheURL ] ) {
				jqXHR.setRequestHeader( "If-None-Match", jQuery.etag[ cacheURL ] );
			}
		}

		// Set the correct header, if data is being sent
		if ( s.data && s.hasContent && s.contentType !== false || options.contentType ) {
			jqXHR.setRequestHeader( "Content-Type", s.contentType );
		}

		// Set the Accepts header for the server, depending on the dataType
		jqXHR.setRequestHeader(
			"Accept",
			s.dataTypes[ 0 ] && s.accepts[ s.dataTypes[0] ] ?
				s.accepts[ s.dataTypes[0] ] + ( s.dataTypes[ 0 ] !== "*" ? ", " + allTypes + "; q=0.01" : "" ) :
				s.accepts[ "*" ]
		);

		// Check for headers option
		for ( i in s.headers ) {
			jqXHR.setRequestHeader( i, s.headers[ i ] );
		}

		// Allow custom headers/mimetypes and early abort
		if ( s.beforeSend && ( s.beforeSend.call( callbackContext, jqXHR, s ) === false || state === 2 ) ) {
			// Abort if not done already and return
			return jqXHR.abort();
		}

		// aborting is no longer a cancellation
		strAbort = "abort";

		// Install callbacks on deferreds
		for ( i in { success: 1, error: 1, complete: 1 } ) {
			jqXHR[ i ]( s[ i ] );
		}

		// Get transport
		transport = inspectPrefiltersOrTransports( transports, s, options, jqXHR );

		// If no transport, we auto-abort
		if ( !transport ) {
			done( -1, "No Transport" );
		} else {
			jqXHR.readyState = 1;

			// Send global event
			if ( fireGlobals ) {
				globalEventContext.trigger( "ajaxSend", [ jqXHR, s ] );
			}
			// Timeout
			if ( s.async && s.timeout > 0 ) {
				timeoutTimer = setTimeout(function() {
					jqXHR.abort("timeout");
				}, s.timeout );
			}

			try {
				state = 1;
				transport.send( requestHeaders, done );
			} catch ( e ) {
				// Propagate exception as error if not done
				if ( state < 2 ) {
					done( -1, e );
				// Simply rethrow otherwise
				} else {
					throw e;
				}
			}
		}

		// Callback for when everything is done
		function done( status, nativeStatusText, responses, headers ) {
			var isSuccess, success, error, response, modified,
				statusText = nativeStatusText;

			// Called once
			if ( state === 2 ) {
				return;
			}

			// State is "done" now
			state = 2;

			// Clear timeout if it exists
			if ( timeoutTimer ) {
				clearTimeout( timeoutTimer );
			}

			// Dereference transport for early garbage collection
			// (no matter how long the jqXHR object will be used)
			transport = undefined;

			// Cache response headers
			responseHeadersString = headers || "";

			// Set readyState
			jqXHR.readyState = status > 0 ? 4 : 0;

			// Determine if successful
			isSuccess = status >= 200 && status < 300 || status === 304;

			// Get response data
			if ( responses ) {
				response = ajaxHandleResponses( s, jqXHR, responses );
			}

			// Convert no matter what (that way responseXXX fields are always set)
			response = ajaxConvert( s, response, jqXHR, isSuccess );

			// If successful, handle type chaining
			if ( isSuccess ) {

				// Set the If-Modified-Since and/or If-None-Match header, if in ifModified mode.
				if ( s.ifModified ) {
					modified = jqXHR.getResponseHeader("Last-Modified");
					if ( modified ) {
						jQuery.lastModified[ cacheURL ] = modified;
					}
					modified = jqXHR.getResponseHeader("etag");
					if ( modified ) {
						jQuery.etag[ cacheURL ] = modified;
					}
				}

				// if no content
				if ( status === 204 || s.type === "HEAD" ) {
					statusText = "nocontent";

				// if not modified
				} else if ( status === 304 ) {
					statusText = "notmodified";

				// If we have data, let's convert it
				} else {
					statusText = response.state;
					success = response.data;
					error = response.error;
					isSuccess = !error;
				}
			} else {
				// We extract error from statusText
				// then normalize statusText and status for non-aborts
				error = statusText;
				if ( status || !statusText ) {
					statusText = "error";
					if ( status < 0 ) {
						status = 0;
					}
				}
			}

			// Set data for the fake xhr object
			jqXHR.status = status;
			jqXHR.statusText = ( nativeStatusText || statusText ) + "";

			// Success/Error
			if ( isSuccess ) {
				deferred.resolveWith( callbackContext, [ success, statusText, jqXHR ] );
			} else {
				deferred.rejectWith( callbackContext, [ jqXHR, statusText, error ] );
			}

			// Status-dependent callbacks
			jqXHR.statusCode( statusCode );
			statusCode = undefined;

			if ( fireGlobals ) {
				globalEventContext.trigger( isSuccess ? "ajaxSuccess" : "ajaxError",
					[ jqXHR, s, isSuccess ? success : error ] );
			}

			// Complete
			completeDeferred.fireWith( callbackContext, [ jqXHR, statusText ] );

			if ( fireGlobals ) {
				globalEventContext.trigger( "ajaxComplete", [ jqXHR, s ] );
				// Handle the global AJAX counter
				if ( !( --jQuery.active ) ) {
					jQuery.event.trigger("ajaxStop");
				}
			}
		}

		return jqXHR;
	},

	getJSON: function( url, data, callback ) {
		return jQuery.get( url, data, callback, "json" );
	},

	getScript: function( url, callback ) {
		return jQuery.get( url, undefined, callback, "script" );
	}
});

jQuery.each( [ "get", "post" ], function( i, method ) {
	jQuery[ method ] = function( url, data, callback, type ) {
		// shift arguments if data argument was omitted
		if ( jQuery.isFunction( data ) ) {
			type = type || callback;
			callback = data;
			data = undefined;
		}

		return jQuery.ajax({
			url: url,
			type: method,
			dataType: type,
			data: data,
			success: callback
		});
	};
});

// Attach a bunch of functions for handling common AJAX events
jQuery.each( [ "ajaxStart", "ajaxStop", "ajaxComplete", "ajaxError", "ajaxSuccess", "ajaxSend" ], function( i, type ) {
	jQuery.fn[ type ] = function( fn ) {
		return this.on( type, fn );
	};
});


jQuery._evalUrl = function( url ) {
	return jQuery.ajax({
		url: url,
		type: "GET",
		dataType: "script",
		async: false,
		global: false,
		"throws": true
	});
};


jQuery.fn.extend({
	wrapAll: function( html ) {
		var wrap;

		if ( jQuery.isFunction( html ) ) {
			return this.each(function( i ) {
				jQuery( this ).wrapAll( html.call(this, i) );
			});
		}

		if ( this[ 0 ] ) {

			// The elements to wrap the target around
			wrap = jQuery( html, this[ 0 ].ownerDocument ).eq( 0 ).clone( true );

			if ( this[ 0 ].parentNode ) {
				wrap.insertBefore( this[ 0 ] );
			}

			wrap.map(function() {
				var elem = this;

				while ( elem.firstElementChild ) {
					elem = elem.firstElementChild;
				}

				return elem;
			}).append( this );
		}

		return this;
	},

	wrapInner: function( html ) {
		if ( jQuery.isFunction( html ) ) {
			return this.each(function( i ) {
				jQuery( this ).wrapInner( html.call(this, i) );
			});
		}

		return this.each(function() {
			var self = jQuery( this ),
				contents = self.contents();

			if ( contents.length ) {
				contents.wrapAll( html );

			} else {
				self.append( html );
			}
		});
	},

	wrap: function( html ) {
		var isFunction = jQuery.isFunction( html );

		return this.each(function( i ) {
			jQuery( this ).wrapAll( isFunction ? html.call(this, i) : html );
		});
	},

	unwrap: function() {
		return this.parent().each(function() {
			if ( !jQuery.nodeName( this, "body" ) ) {
				jQuery( this ).replaceWith( this.childNodes );
			}
		}).end();
	}
});


jQuery.expr.filters.hidden = function( elem ) {
	// Support: Opera <= 12.12
	// Opera reports offsetWidths and offsetHeights less than zero on some elements
	return elem.offsetWidth <= 0 && elem.offsetHeight <= 0;
};
jQuery.expr.filters.visible = function( elem ) {
	return !jQuery.expr.filters.hidden( elem );
};




var r20 = /%20/g,
	rbracket = /\[\]$/,
	rCRLF = /\r?\n/g,
	rsubmitterTypes = /^(?:submit|button|image|reset|file)$/i,
	rsubmittable = /^(?:input|select|textarea|keygen)/i;

function buildParams( prefix, obj, traditional, add ) {
	var name;

	if ( jQuery.isArray( obj ) ) {
		// Serialize array item.
		jQuery.each( obj, function( i, v ) {
			if ( traditional || rbracket.test( prefix ) ) {
				// Treat each array item as a scalar.
				add( prefix, v );

			} else {
				// Item is non-scalar (array or object), encode its numeric index.
				buildParams( prefix + "[" + ( typeof v === "object" ? i : "" ) + "]", v, traditional, add );
			}
		});

	} else if ( !traditional && jQuery.type( obj ) === "object" ) {
		// Serialize object item.
		for ( name in obj ) {
			buildParams( prefix + "[" + name + "]", obj[ name ], traditional, add );
		}

	} else {
		// Serialize scalar item.
		add( prefix, obj );
	}
}

// Serialize an array of form elements or a set of
// key/values into a query string
jQuery.param = function( a, traditional ) {
	var prefix,
		s = [],
		add = function( key, value ) {
			// If value is a function, invoke it and return its value
			value = jQuery.isFunction( value ) ? value() : ( value == null ? "" : value );
			s[ s.length ] = encodeURIComponent( key ) + "=" + encodeURIComponent( value );
		};

	// Set traditional to true for jQuery <= 1.3.2 behavior.
	if ( traditional === undefined ) {
		traditional = jQuery.ajaxSettings && jQuery.ajaxSettings.traditional;
	}

	// If an array was passed in, assume that it is an array of form elements.
	if ( jQuery.isArray( a ) || ( a.jquery && !jQuery.isPlainObject( a ) ) ) {
		// Serialize the form elements
		jQuery.each( a, function() {
			add( this.name, this.value );
		});

	} else {
		// If traditional, encode the "old" way (the way 1.3.2 or older
		// did it), otherwise encode params recursively.
		for ( prefix in a ) {
			buildParams( prefix, a[ prefix ], traditional, add );
		}
	}

	// Return the resulting serialization
	return s.join( "&" ).replace( r20, "+" );
};

jQuery.fn.extend({
	serialize: function() {
		return jQuery.param( this.serializeArray() );
	},
	serializeArray: function() {
		return this.map(function() {
			// Can add propHook for "elements" to filter or add form elements
			var elements = jQuery.prop( this, "elements" );
			return elements ? jQuery.makeArray( elements ) : this;
		})
		.filter(function() {
			var type = this.type;

			// Use .is( ":disabled" ) so that fieldset[disabled] works
			return this.name && !jQuery( this ).is( ":disabled" ) &&
				rsubmittable.test( this.nodeName ) && !rsubmitterTypes.test( type ) &&
				( this.checked || !rcheckableType.test( type ) );
		})
		.map(function( i, elem ) {
			var val = jQuery( this ).val();

			return val == null ?
				null :
				jQuery.isArray( val ) ?
					jQuery.map( val, function( val ) {
						return { name: elem.name, value: val.replace( rCRLF, "\r\n" ) };
					}) :
					{ name: elem.name, value: val.replace( rCRLF, "\r\n" ) };
		}).get();
	}
});


jQuery.ajaxSettings.xhr = function() {
	try {
		return new XMLHttpRequest();
	} catch( e ) {}
};

var xhrId = 0,
	xhrCallbacks = {},
	xhrSuccessStatus = {
		// file protocol always yields status code 0, assume 200
		0: 200,
		// Support: IE9
		// #1450: sometimes IE returns 1223 when it should be 204
		1223: 204
	},
	xhrSupported = jQuery.ajaxSettings.xhr();

// Support: IE9
// Open requests must be manually aborted on unload (#5280)
if ( window.ActiveXObject ) {
	jQuery( window ).on( "unload", function() {
		for ( var key in xhrCallbacks ) {
			xhrCallbacks[ key ]();
		}
	});
}

support.cors = !!xhrSupported && ( "withCredentials" in xhrSupported );
support.ajax = xhrSupported = !!xhrSupported;

jQuery.ajaxTransport(function( options ) {
	var callback;

	// Cross domain only allowed if supported through XMLHttpRequest
	if ( support.cors || xhrSupported && !options.crossDomain ) {
		return {
			send: function( headers, complete ) {
				var i,
					xhr = options.xhr(),
					id = ++xhrId;

				xhr.open( options.type, options.url, options.async, options.username, options.password );

				// Apply custom fields if provided
				if ( options.xhrFields ) {
					for ( i in options.xhrFields ) {
						xhr[ i ] = options.xhrFields[ i ];
					}
				}

				// Override mime type if needed
				if ( options.mimeType && xhr.overrideMimeType ) {
					xhr.overrideMimeType( options.mimeType );
				}

				// X-Requested-With header
				// For cross-domain requests, seeing as conditions for a preflight are
				// akin to a jigsaw puzzle, we simply never set it to be sure.
				// (it can always be set on a per-request basis or even using ajaxSetup)
				// For same-domain requests, won't change header if already provided.
				if ( !options.crossDomain && !headers["X-Requested-With"] ) {
					headers["X-Requested-With"] = "XMLHttpRequest";
				}

				// Set headers
				for ( i in headers ) {
					xhr.setRequestHeader( i, headers[ i ] );
				}

				// Callback
				callback = function( type ) {
					return function() {
						if ( callback ) {
							delete xhrCallbacks[ id ];
							callback = xhr.onload = xhr.onerror = null;

							if ( type === "abort" ) {
								xhr.abort();
							} else if ( type === "error" ) {
								complete(
									// file: protocol always yields status 0; see #8605, #14207
									xhr.status,
									xhr.statusText
								);
							} else {
								complete(
									xhrSuccessStatus[ xhr.status ] || xhr.status,
									xhr.statusText,
									// Support: IE9
									// Accessing binary-data responseText throws an exception
									// (#11426)
									typeof xhr.responseText === "string" ? {
										text: xhr.responseText
									} : undefined,
									xhr.getAllResponseHeaders()
								);
							}
						}
					};
				};

				// Listen to events
				xhr.onload = callback();
				xhr.onerror = callback("error");

				// Create the abort callback
				callback = xhrCallbacks[ id ] = callback("abort");

				try {
					// Do send the request (this may raise an exception)
					xhr.send( options.hasContent && options.data || null );
				} catch ( e ) {
					// #14683: Only rethrow if this hasn't been notified as an error yet
					if ( callback ) {
						throw e;
					}
				}
			},

			abort: function() {
				if ( callback ) {
					callback();
				}
			}
		};
	}
});




// Install script dataType
jQuery.ajaxSetup({
	accepts: {
		script: "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"
	},
	contents: {
		script: /(?:java|ecma)script/
	},
	converters: {
		"text script": function( text ) {
			jQuery.globalEval( text );
			return text;
		}
	}
});

// Handle cache's special case and crossDomain
jQuery.ajaxPrefilter( "script", function( s ) {
	if ( s.cache === undefined ) {
		s.cache = false;
	}
	if ( s.crossDomain ) {
		s.type = "GET";
	}
});

// Bind script tag hack transport
jQuery.ajaxTransport( "script", function( s ) {
	// This transport only deals with cross domain requests
	if ( s.crossDomain ) {
		var script, callback;
		return {
			send: function( _, complete ) {
				script = jQuery("<script>").prop({
					async: true,
					charset: s.scriptCharset,
					src: s.url
				}).on(
					"load error",
					callback = function( evt ) {
						script.remove();
						callback = null;
						if ( evt ) {
							complete( evt.type === "error" ? 404 : 200, evt.type );
						}
					}
				);
				document.head.appendChild( script[ 0 ] );
			},
			abort: function() {
				if ( callback ) {
					callback();
				}
			}
		};
	}
});




var oldCallbacks = [],
	rjsonp = /(=)\?(?=&|$)|\?\?/;

// Default jsonp settings
jQuery.ajaxSetup({
	jsonp: "callback",
	jsonpCallback: function() {
		var callback = oldCallbacks.pop() || ( jQuery.expando + "_" + ( nonce++ ) );
		this[ callback ] = true;
		return callback;
	}
});

// Detect, normalize options and install callbacks for jsonp requests
jQuery.ajaxPrefilter( "json jsonp", function( s, originalSettings, jqXHR ) {

	var callbackName, overwritten, responseContainer,
		jsonProp = s.jsonp !== false && ( rjsonp.test( s.url ) ?
			"url" :
			typeof s.data === "string" && !( s.contentType || "" ).indexOf("application/x-www-form-urlencoded") && rjsonp.test( s.data ) && "data"
		);

	// Handle iff the expected data type is "jsonp" or we have a parameter to set
	if ( jsonProp || s.dataTypes[ 0 ] === "jsonp" ) {

		// Get callback name, remembering preexisting value associated with it
		callbackName = s.jsonpCallback = jQuery.isFunction( s.jsonpCallback ) ?
			s.jsonpCallback() :
			s.jsonpCallback;

		// Insert callback into url or form data
		if ( jsonProp ) {
			s[ jsonProp ] = s[ jsonProp ].replace( rjsonp, "$1" + callbackName );
		} else if ( s.jsonp !== false ) {
			s.url += ( rquery.test( s.url ) ? "&" : "?" ) + s.jsonp + "=" + callbackName;
		}

		// Use data converter to retrieve json after script execution
		s.converters["script json"] = function() {
			if ( !responseContainer ) {
				jQuery.error( callbackName + " was not called" );
			}
			return responseContainer[ 0 ];
		};

		// force json dataType
		s.dataTypes[ 0 ] = "json";

		// Install callback
		overwritten = window[ callbackName ];
		window[ callbackName ] = function() {
			responseContainer = arguments;
		};

		// Clean-up function (fires after converters)
		jqXHR.always(function() {
			// Restore preexisting value
			window[ callbackName ] = overwritten;

			// Save back as free
			if ( s[ callbackName ] ) {
				// make sure that re-using the options doesn't screw things around
				s.jsonpCallback = originalSettings.jsonpCallback;

				// save the callback name for future use
				oldCallbacks.push( callbackName );
			}

			// Call if it was a function and we have a response
			if ( responseContainer && jQuery.isFunction( overwritten ) ) {
				overwritten( responseContainer[ 0 ] );
			}

			responseContainer = overwritten = undefined;
		});

		// Delegate to script
		return "script";
	}
});




// data: string of html
// context (optional): If specified, the fragment will be created in this context, defaults to document
// keepScripts (optional): If true, will include scripts passed in the html string
jQuery.parseHTML = function( data, context, keepScripts ) {
	if ( !data || typeof data !== "string" ) {
		return null;
	}
	if ( typeof context === "boolean" ) {
		keepScripts = context;
		context = false;
	}
	context = context || document;

	var parsed = rsingleTag.exec( data ),
		scripts = !keepScripts && [];

	// Single tag
	if ( parsed ) {
		return [ context.createElement( parsed[1] ) ];
	}

	parsed = jQuery.buildFragment( [ data ], context, scripts );

	if ( scripts && scripts.length ) {
		jQuery( scripts ).remove();
	}

	return jQuery.merge( [], parsed.childNodes );
};


// Keep a copy of the old load method
var _load = jQuery.fn.load;

/**
 * Load a url into a page
 */
jQuery.fn.load = function( url, params, callback ) {
	if ( typeof url !== "string" && _load ) {
		return _load.apply( this, arguments );
	}

	var selector, type, response,
		self = this,
		off = url.indexOf(" ");

	if ( off >= 0 ) {
		selector = jQuery.trim( url.slice( off ) );
		url = url.slice( 0, off );
	}

	// If it's a function
	if ( jQuery.isFunction( params ) ) {

		// We assume that it's the callback
		callback = params;
		params = undefined;

	// Otherwise, build a param string
	} else if ( params && typeof params === "object" ) {
		type = "POST";
	}

	// If we have elements to modify, make the request
	if ( self.length > 0 ) {
		jQuery.ajax({
			url: url,

			// if "type" variable is undefined, then "GET" method will be used
			type: type,
			dataType: "html",
			data: params
		}).done(function( responseText ) {

			// Save response for use in complete callback
			response = arguments;

			self.html( selector ?

				// If a selector was specified, locate the right elements in a dummy div
				// Exclude scripts to avoid IE 'Permission Denied' errors
				jQuery("<div>").append( jQuery.parseHTML( responseText ) ).find( selector ) :

				// Otherwise use the full result
				responseText );

		}).complete( callback && function( jqXHR, status ) {
			self.each( callback, response || [ jqXHR.responseText, status, jqXHR ] );
		});
	}

	return this;
};




jQuery.expr.filters.animated = function( elem ) {
	return jQuery.grep(jQuery.timers, function( fn ) {
		return elem === fn.elem;
	}).length;
};




var docElem = window.document.documentElement;

/**
 * Gets a window from an element
 */
function getWindow( elem ) {
	return jQuery.isWindow( elem ) ? elem : elem.nodeType === 9 && elem.defaultView;
}

jQuery.offset = {
	setOffset: function( elem, options, i ) {
		var curPosition, curLeft, curCSSTop, curTop, curOffset, curCSSLeft, calculatePosition,
			position = jQuery.css( elem, "position" ),
			curElem = jQuery( elem ),
			props = {};

		// Set position first, in-case top/left are set even on static elem
		if ( position === "static" ) {
			elem.style.position = "relative";
		}

		curOffset = curElem.offset();
		curCSSTop = jQuery.css( elem, "top" );
		curCSSLeft = jQuery.css( elem, "left" );
		calculatePosition = ( position === "absolute" || position === "fixed" ) &&
			( curCSSTop + curCSSLeft ).indexOf("auto") > -1;

		// Need to be able to calculate position if either top or left is auto and position is either absolute or fixed
		if ( calculatePosition ) {
			curPosition = curElem.position();
			curTop = curPosition.top;
			curLeft = curPosition.left;

		} else {
			curTop = parseFloat( curCSSTop ) || 0;
			curLeft = parseFloat( curCSSLeft ) || 0;
		}

		if ( jQuery.isFunction( options ) ) {
			options = options.call( elem, i, curOffset );
		}

		if ( options.top != null ) {
			props.top = ( options.top - curOffset.top ) + curTop;
		}
		if ( options.left != null ) {
			props.left = ( options.left - curOffset.left ) + curLeft;
		}

		if ( "using" in options ) {
			options.using.call( elem, props );

		} else {
			curElem.css( props );
		}
	}
};

jQuery.fn.extend({
	offset: function( options ) {
		if ( arguments.length ) {
			return options === undefined ?
				this :
				this.each(function( i ) {
					jQuery.offset.setOffset( this, options, i );
				});
		}

		var docElem, win,
			elem = this[ 0 ],
			box = { top: 0, left: 0 },
			doc = elem && elem.ownerDocument;

		if ( !doc ) {
			return;
		}

		docElem = doc.documentElement;

		// Make sure it's not a disconnected DOM node
		if ( !jQuery.contains( docElem, elem ) ) {
			return box;
		}

		// If we don't have gBCR, just use 0,0 rather than error
		// BlackBerry 5, iOS 3 (original iPhone)
		if ( typeof elem.getBoundingClientRect !== strundefined ) {
			box = elem.getBoundingClientRect();
		}
		win = getWindow( doc );
		return {
			top: box.top + win.pageYOffset - docElem.clientTop,
			left: box.left + win.pageXOffset - docElem.clientLeft
		};
	},

	position: function() {
		if ( !this[ 0 ] ) {
			return;
		}

		var offsetParent, offset,
			elem = this[ 0 ],
			parentOffset = { top: 0, left: 0 };

		// Fixed elements are offset from window (parentOffset = {top:0, left: 0}, because it is its only offset parent
		if ( jQuery.css( elem, "position" ) === "fixed" ) {
			// We assume that getBoundingClientRect is available when computed position is fixed
			offset = elem.getBoundingClientRect();

		} else {
			// Get *real* offsetParent
			offsetParent = this.offsetParent();

			// Get correct offsets
			offset = this.offset();
			if ( !jQuery.nodeName( offsetParent[ 0 ], "html" ) ) {
				parentOffset = offsetParent.offset();
			}

			// Add offsetParent borders
			parentOffset.top += jQuery.css( offsetParent[ 0 ], "borderTopWidth", true );
			parentOffset.left += jQuery.css( offsetParent[ 0 ], "borderLeftWidth", true );
		}

		// Subtract parent offsets and element margins
		return {
			top: offset.top - parentOffset.top - jQuery.css( elem, "marginTop", true ),
			left: offset.left - parentOffset.left - jQuery.css( elem, "marginLeft", true )
		};
	},

	offsetParent: function() {
		return this.map(function() {
			var offsetParent = this.offsetParent || docElem;

			while ( offsetParent && ( !jQuery.nodeName( offsetParent, "html" ) && jQuery.css( offsetParent, "position" ) === "static" ) ) {
				offsetParent = offsetParent.offsetParent;
			}

			return offsetParent || docElem;
		});
	}
});

// Create scrollLeft and scrollTop methods
jQuery.each( { scrollLeft: "pageXOffset", scrollTop: "pageYOffset" }, function( method, prop ) {
	var top = "pageYOffset" === prop;

	jQuery.fn[ method ] = function( val ) {
		return access( this, function( elem, method, val ) {
			var win = getWindow( elem );

			if ( val === undefined ) {
				return win ? win[ prop ] : elem[ method ];
			}

			if ( win ) {
				win.scrollTo(
					!top ? val : window.pageXOffset,
					top ? val : window.pageYOffset
				);

			} else {
				elem[ method ] = val;
			}
		}, method, val, arguments.length, null );
	};
});

// Add the top/left cssHooks using jQuery.fn.position
// Webkit bug: https://bugs.webkit.org/show_bug.cgi?id=29084
// getComputedStyle returns percent when specified for top/left/bottom/right
// rather than make the css module depend on the offset module, we just check for it here
jQuery.each( [ "top", "left" ], function( i, prop ) {
	jQuery.cssHooks[ prop ] = addGetHookIf( support.pixelPosition,
		function( elem, computed ) {
			if ( computed ) {
				computed = curCSS( elem, prop );
				// if curCSS returns percentage, fallback to offset
				return rnumnonpx.test( computed ) ?
					jQuery( elem ).position()[ prop ] + "px" :
					computed;
			}
		}
	);
});


// Create innerHeight, innerWidth, height, width, outerHeight and outerWidth methods
jQuery.each( { Height: "height", Width: "width" }, function( name, type ) {
	jQuery.each( { padding: "inner" + name, content: type, "": "outer" + name }, function( defaultExtra, funcName ) {
		// margin is only for outerHeight, outerWidth
		jQuery.fn[ funcName ] = function( margin, value ) {
			var chainable = arguments.length && ( defaultExtra || typeof margin !== "boolean" ),
				extra = defaultExtra || ( margin === true || value === true ? "margin" : "border" );

			return access( this, function( elem, type, value ) {
				var doc;

				if ( jQuery.isWindow( elem ) ) {
					// As of 5/8/2012 this will yield incorrect results for Mobile Safari, but there
					// isn't a whole lot we can do. See pull request at this URL for discussion:
					// https://github.com/jquery/jquery/pull/764
					return elem.document.documentElement[ "client" + name ];
				}

				// Get document width or height
				if ( elem.nodeType === 9 ) {
					doc = elem.documentElement;

					// Either scroll[Width/Height] or offset[Width/Height] or client[Width/Height],
					// whichever is greatest
					return Math.max(
						elem.body[ "scroll" + name ], doc[ "scroll" + name ],
						elem.body[ "offset" + name ], doc[ "offset" + name ],
						doc[ "client" + name ]
					);
				}

				return value === undefined ?
					// Get width or height on the element, requesting but not forcing parseFloat
					jQuery.css( elem, type, extra ) :

					// Set width or height on the element
					jQuery.style( elem, type, value, extra );
			}, type, chainable ? margin : undefined, chainable, null );
		};
	});
});


// The number of elements contained in the matched element set
jQuery.fn.size = function() {
	return this.length;
};

jQuery.fn.andSelf = jQuery.fn.addBack;




// Register as a named AMD module, since jQuery can be concatenated with other
// files that may use define, but not via a proper concatenation script that
// understands anonymous AMD modules. A named AMD is safest and most robust
// way to register. Lowercase jquery is used because AMD module names are
// derived from file names, and jQuery is normally delivered in a lowercase
// file name. Do this after creating the global so that if an AMD module wants
// to call noConflict to hide this version of jQuery, it will work.

// Note that for maximum portability, libraries that are not jQuery should
// declare themselves as anonymous modules, and avoid setting a global if an
// AMD loader is present. jQuery is a special case. For more information, see
// https://github.com/jrburke/requirejs/wiki/Updating-existing-libraries#wiki-anon

if ( typeof define === "function" && define.amd ) {
	define( "jquery", [], function() {
		return jQuery;
	});
}




var
	// Map over jQuery in case of overwrite
	_jQuery = window.jQuery,

	// Map over the $ in case of overwrite
	_$ = window.$;

jQuery.noConflict = function( deep ) {
	if ( window.$ === jQuery ) {
		window.$ = _$;
	}

	if ( deep && window.jQuery === jQuery ) {
		window.jQuery = _jQuery;
	}

	return jQuery;
};

// Expose jQuery and $ identifiers, even in
// AMD (#7102#comment:10, https://github.com/jquery/jquery/pull/557)
// and CommonJS for browser emulators (#13566)
if ( typeof noGlobal === strundefined ) {
	window.jQuery = window.$ = jQuery;
}




return jQuery;

}));

},{}],3:[function(require,module,exports){
(function (global){
/**
 * @license
 * Lo-Dash 2.4.1 (Custom Build) <http://lodash.com/>
 * Build: `lodash modern -o ./dist/lodash.js`
 * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>
 * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>
 * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 * Available under MIT license <http://lodash.com/license>
 */
;(function() {

  /** Used as a safe reference for `undefined` in pre ES5 environments */
  var undefined;

  /** Used to pool arrays and objects used internally */
  var arrayPool = [],
      objectPool = [];

  /** Used to generate unique IDs */
  var idCounter = 0;

  /** Used to prefix keys to avoid issues with `__proto__` and properties on `Object.prototype` */
  var keyPrefix = +new Date + '';

  /** Used as the size when optimizations are enabled for large arrays */
  var largeArraySize = 75;

  /** Used as the max size of the `arrayPool` and `objectPool` */
  var maxPoolSize = 40;

  /** Used to detect and test whitespace */
  var whitespace = (
    // whitespace
    ' \t\x0B\f\xA0\ufeff' +

    // line terminators
    '\n\r\u2028\u2029' +

    // unicode category "Zs" space separators
    '\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000'
  );

  /** Used to match empty string literals in compiled template source */
  var reEmptyStringLeading = /\b__p \+= '';/g,
      reEmptyStringMiddle = /\b(__p \+=) '' \+/g,
      reEmptyStringTrailing = /(__e\(.*?\)|\b__t\)) \+\n'';/g;

  /**
   * Used to match ES6 template delimiters
   * http://people.mozilla.org/~jorendorff/es6-draft.html#sec-literals-string-literals
   */
  var reEsTemplate = /\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g;

  /** Used to match regexp flags from their coerced string values */
  var reFlags = /\w*$/;

  /** Used to detected named functions */
  var reFuncName = /^\s*function[ \n\r\t]+\w/;

  /** Used to match "interpolate" template delimiters */
  var reInterpolate = /<%=([\s\S]+?)%>/g;

  /** Used to match leading whitespace and zeros to be removed */
  var reLeadingSpacesAndZeros = RegExp('^[' + whitespace + ']*0+(?=.$)');

  /** Used to ensure capturing order of template delimiters */
  var reNoMatch = /($^)/;

  /** Used to detect functions containing a `this` reference */
  var reThis = /\bthis\b/;

  /** Used to match unescaped characters in compiled string literals */
  var reUnescapedString = /['\n\r\t\u2028\u2029\\]/g;

  /** Used to assign default `context` object properties */
  var contextProps = [
    'Array', 'Boolean', 'Date', 'Function', 'Math', 'Number', 'Object',
    'RegExp', 'String', '_', 'attachEvent', 'clearTimeout', 'isFinite', 'isNaN',
    'parseInt', 'setTimeout'
  ];

  /** Used to make template sourceURLs easier to identify */
  var templateCounter = 0;

  /** `Object#toString` result shortcuts */
  var argsClass = '[object Arguments]',
      arrayClass = '[object Array]',
      boolClass = '[object Boolean]',
      dateClass = '[object Date]',
      funcClass = '[object Function]',
      numberClass = '[object Number]',
      objectClass = '[object Object]',
      regexpClass = '[object RegExp]',
      stringClass = '[object String]';

  /** Used to identify object classifications that `_.clone` supports */
  var cloneableClasses = {};
  cloneableClasses[funcClass] = false;
  cloneableClasses[argsClass] = cloneableClasses[arrayClass] =
  cloneableClasses[boolClass] = cloneableClasses[dateClass] =
  cloneableClasses[numberClass] = cloneableClasses[objectClass] =
  cloneableClasses[regexpClass] = cloneableClasses[stringClass] = true;

  /** Used as an internal `_.debounce` options object */
  var debounceOptions = {
    'leading': false,
    'maxWait': 0,
    'trailing': false
  };

  /** Used as the property descriptor for `__bindData__` */
  var descriptor = {
    'configurable': false,
    'enumerable': false,
    'value': null,
    'writable': false
  };

  /** Used to determine if values are of the language type Object */
  var objectTypes = {
    'boolean': false,
    'function': true,
    'object': true,
    'number': false,
    'string': false,
    'undefined': false
  };

  /** Used to escape characters for inclusion in compiled string literals */
  var stringEscapes = {
    '\\': '\\',
    "'": "'",
    '\n': 'n',
    '\r': 'r',
    '\t': 't',
    '\u2028': 'u2028',
    '\u2029': 'u2029'
  };

  /** Used as a reference to the global object */
  var root = (objectTypes[typeof window] && window) || this;

  /** Detect free variable `exports` */
  var freeExports = objectTypes[typeof exports] && exports && !exports.nodeType && exports;

  /** Detect free variable `module` */
  var freeModule = objectTypes[typeof module] && module && !module.nodeType && module;

  /** Detect the popular CommonJS extension `module.exports` */
  var moduleExports = freeModule && freeModule.exports === freeExports && freeExports;

  /** Detect free variable `global` from Node.js or Browserified code and use it as `root` */
  var freeGlobal = objectTypes[typeof global] && global;
  if (freeGlobal && (freeGlobal.global === freeGlobal || freeGlobal.window === freeGlobal)) {
    root = freeGlobal;
  }

  /*--------------------------------------------------------------------------*/

  /**
   * The base implementation of `_.indexOf` without support for binary searches
   * or `fromIndex` constraints.
   *
   * @private
   * @param {Array} array The array to search.
   * @param {*} value The value to search for.
   * @param {number} [fromIndex=0] The index to search from.
   * @returns {number} Returns the index of the matched value or `-1`.
   */
  function baseIndexOf(array, value, fromIndex) {
    var index = (fromIndex || 0) - 1,
        length = array ? array.length : 0;

    while (++index < length) {
      if (array[index] === value) {
        return index;
      }
    }
    return -1;
  }

  /**
   * An implementation of `_.contains` for cache objects that mimics the return
   * signature of `_.indexOf` by returning `0` if the value is found, else `-1`.
   *
   * @private
   * @param {Object} cache The cache object to inspect.
   * @param {*} value The value to search for.
   * @returns {number} Returns `0` if `value` is found, else `-1`.
   */
  function cacheIndexOf(cache, value) {
    var type = typeof value;
    cache = cache.cache;

    if (type == 'boolean' || value == null) {
      return cache[value] ? 0 : -1;
    }
    if (type != 'number' && type != 'string') {
      type = 'object';
    }
    var key = type == 'number' ? value : keyPrefix + value;
    cache = (cache = cache[type]) && cache[key];

    return type == 'object'
      ? (cache && baseIndexOf(cache, value) > -1 ? 0 : -1)
      : (cache ? 0 : -1);
  }

  /**
   * Adds a given value to the corresponding cache object.
   *
   * @private
   * @param {*} value The value to add to the cache.
   */
  function cachePush(value) {
    var cache = this.cache,
        type = typeof value;

    if (type == 'boolean' || value == null) {
      cache[value] = true;
    } else {
      if (type != 'number' && type != 'string') {
        type = 'object';
      }
      var key = type == 'number' ? value : keyPrefix + value,
          typeCache = cache[type] || (cache[type] = {});

      if (type == 'object') {
        (typeCache[key] || (typeCache[key] = [])).push(value);
      } else {
        typeCache[key] = true;
      }
    }
  }

  /**
   * Used by `_.max` and `_.min` as the default callback when a given
   * collection is a string value.
   *
   * @private
   * @param {string} value The character to inspect.
   * @returns {number} Returns the code unit of given character.
   */
  function charAtCallback(value) {
    return value.charCodeAt(0);
  }

  /**
   * Used by `sortBy` to compare transformed `collection` elements, stable sorting
   * them in ascending order.
   *
   * @private
   * @param {Object} a The object to compare to `b`.
   * @param {Object} b The object to compare to `a`.
   * @returns {number} Returns the sort order indicator of `1` or `-1`.
   */
  function compareAscending(a, b) {
    var ac = a.criteria,
        bc = b.criteria,
        index = -1,
        length = ac.length;

    while (++index < length) {
      var value = ac[index],
          other = bc[index];

      if (value !== other) {
        if (value > other || typeof value == 'undefined') {
          return 1;
        }
        if (value < other || typeof other == 'undefined') {
          return -1;
        }
      }
    }
    // Fixes an `Array#sort` bug in the JS engine embedded in Adobe applications
    // that causes it, under certain circumstances, to return the same value for
    // `a` and `b`. See https://github.com/jashkenas/underscore/pull/1247
    //
    // This also ensures a stable sort in V8 and other engines.
    // See http://code.google.com/p/v8/issues/detail?id=90
    return a.index - b.index;
  }

  /**
   * Creates a cache object to optimize linear searches of large arrays.
   *
   * @private
   * @param {Array} [array=[]] The array to search.
   * @returns {null|Object} Returns the cache object or `null` if caching should not be used.
   */
  function createCache(array) {
    var index = -1,
        length = array.length,
        first = array[0],
        mid = array[(length / 2) | 0],
        last = array[length - 1];

    if (first && typeof first == 'object' &&
        mid && typeof mid == 'object' && last && typeof last == 'object') {
      return false;
    }
    var cache = getObject();
    cache['false'] = cache['null'] = cache['true'] = cache['undefined'] = false;

    var result = getObject();
    result.array = array;
    result.cache = cache;
    result.push = cachePush;

    while (++index < length) {
      result.push(array[index]);
    }
    return result;
  }

  /**
   * Used by `template` to escape characters for inclusion in compiled
   * string literals.
   *
   * @private
   * @param {string} match The matched character to escape.
   * @returns {string} Returns the escaped character.
   */
  function escapeStringChar(match) {
    return '\\' + stringEscapes[match];
  }

  /**
   * Gets an array from the array pool or creates a new one if the pool is empty.
   *
   * @private
   * @returns {Array} The array from the pool.
   */
  function getArray() {
    return arrayPool.pop() || [];
  }

  /**
   * Gets an object from the object pool or creates a new one if the pool is empty.
   *
   * @private
   * @returns {Object} The object from the pool.
   */
  function getObject() {
    return objectPool.pop() || {
      'array': null,
      'cache': null,
      'criteria': null,
      'false': false,
      'index': 0,
      'null': false,
      'number': null,
      'object': null,
      'push': null,
      'string': null,
      'true': false,
      'undefined': false,
      'value': null
    };
  }

  /**
   * Releases the given array back to the array pool.
   *
   * @private
   * @param {Array} [array] The array to release.
   */
  function releaseArray(array) {
    array.length = 0;
    if (arrayPool.length < maxPoolSize) {
      arrayPool.push(array);
    }
  }

  /**
   * Releases the given object back to the object pool.
   *
   * @private
   * @param {Object} [object] The object to release.
   */
  function releaseObject(object) {
    var cache = object.cache;
    if (cache) {
      releaseObject(cache);
    }
    object.array = object.cache = object.criteria = object.object = object.number = object.string = object.value = null;
    if (objectPool.length < maxPoolSize) {
      objectPool.push(object);
    }
  }

  /**
   * Slices the `collection` from the `start` index up to, but not including,
   * the `end` index.
   *
   * Note: This function is used instead of `Array#slice` to support node lists
   * in IE < 9 and to ensure dense arrays are returned.
   *
   * @private
   * @param {Array|Object|string} collection The collection to slice.
   * @param {number} start The start index.
   * @param {number} end The end index.
   * @returns {Array} Returns the new array.
   */
  function slice(array, start, end) {
    start || (start = 0);
    if (typeof end == 'undefined') {
      end = array ? array.length : 0;
    }
    var index = -1,
        length = end - start || 0,
        result = Array(length < 0 ? 0 : length);

    while (++index < length) {
      result[index] = array[start + index];
    }
    return result;
  }

  /*--------------------------------------------------------------------------*/

  /**
   * Create a new `lodash` function using the given context object.
   *
   * @static
   * @memberOf _
   * @category Utilities
   * @param {Object} [context=root] The context object.
   * @returns {Function} Returns the `lodash` function.
   */
  function runInContext(context) {
    // Avoid issues with some ES3 environments that attempt to use values, named
    // after built-in constructors like `Object`, for the creation of literals.
    // ES5 clears this up by stating that literals must use built-in constructors.
    // See http://es5.github.io/#x11.1.5.
    context = context ? _.defaults(root.Object(), context, _.pick(root, contextProps)) : root;

    /** Native constructor references */
    var Array = context.Array,
        Boolean = context.Boolean,
        Date = context.Date,
        Function = context.Function,
        Math = context.Math,
        Number = context.Number,
        Object = context.Object,
        RegExp = context.RegExp,
        String = context.String,
        TypeError = context.TypeError;

    /**
     * Used for `Array` method references.
     *
     * Normally `Array.prototype` would suffice, however, using an array literal
     * avoids issues in Narwhal.
     */
    var arrayRef = [];

    /** Used for native method references */
    var objectProto = Object.prototype;

    /** Used to restore the original `_` reference in `noConflict` */
    var oldDash = context._;

    /** Used to resolve the internal [[Class]] of values */
    var toString = objectProto.toString;

    /** Used to detect if a method is native */
    var reNative = RegExp('^' +
      String(toString)
        .replace(/[.*+?^${}()|[\]\\]/g, '\\$&')
        .replace(/toString| for [^\]]+/g, '.*?') + '$'
    );

    /** Native method shortcuts */
    var ceil = Math.ceil,
        clearTimeout = context.clearTimeout,
        floor = Math.floor,
        fnToString = Function.prototype.toString,
        getPrototypeOf = isNative(getPrototypeOf = Object.getPrototypeOf) && getPrototypeOf,
        hasOwnProperty = objectProto.hasOwnProperty,
        push = arrayRef.push,
        setTimeout = context.setTimeout,
        splice = arrayRef.splice,
        unshift = arrayRef.unshift;

    /** Used to set meta data on functions */
    var defineProperty = (function() {
      // IE 8 only accepts DOM elements
      try {
        var o = {},
            func = isNative(func = Object.defineProperty) && func,
            result = func(o, o, o) && func;
      } catch(e) { }
      return result;
    }());

    /* Native method shortcuts for methods with the same name as other `lodash` methods */
    var nativeCreate = isNative(nativeCreate = Object.create) && nativeCreate,
        nativeIsArray = isNative(nativeIsArray = Array.isArray) && nativeIsArray,
        nativeIsFinite = context.isFinite,
        nativeIsNaN = context.isNaN,
        nativeKeys = isNative(nativeKeys = Object.keys) && nativeKeys,
        nativeMax = Math.max,
        nativeMin = Math.min,
        nativeParseInt = context.parseInt,
        nativeRandom = Math.random;

    /** Used to lookup a built-in constructor by [[Class]] */
    var ctorByClass = {};
    ctorByClass[arrayClass] = Array;
    ctorByClass[boolClass] = Boolean;
    ctorByClass[dateClass] = Date;
    ctorByClass[funcClass] = Function;
    ctorByClass[objectClass] = Object;
    ctorByClass[numberClass] = Number;
    ctorByClass[regexpClass] = RegExp;
    ctorByClass[stringClass] = String;

    /*--------------------------------------------------------------------------*/

    /**
     * Creates a `lodash` object which wraps the given value to enable intuitive
     * method chaining.
     *
     * In addition to Lo-Dash methods, wrappers also have the following `Array` methods:
     * `concat`, `join`, `pop`, `push`, `reverse`, `shift`, `slice`, `sort`, `splice`,
     * and `unshift`
     *
     * Chaining is supported in custom builds as long as the `value` method is
     * implicitly or explicitly included in the build.
     *
     * The chainable wrapper functions are:
     * `after`, `assign`, `bind`, `bindAll`, `bindKey`, `chain`, `compact`,
     * `compose`, `concat`, `countBy`, `create`, `createCallback`, `curry`,
     * `debounce`, `defaults`, `defer`, `delay`, `difference`, `filter`, `flatten`,
     * `forEach`, `forEachRight`, `forIn`, `forInRight`, `forOwn`, `forOwnRight`,
     * `functions`, `groupBy`, `indexBy`, `initial`, `intersection`, `invert`,
     * `invoke`, `keys`, `map`, `max`, `memoize`, `merge`, `min`, `object`, `omit`,
     * `once`, `pairs`, `partial`, `partialRight`, `pick`, `pluck`, `pull`, `push`,
     * `range`, `reject`, `remove`, `rest`, `reverse`, `shuffle`, `slice`, `sort`,
     * `sortBy`, `splice`, `tap`, `throttle`, `times`, `toArray`, `transform`,
     * `union`, `uniq`, `unshift`, `unzip`, `values`, `where`, `without`, `wrap`,
     * and `zip`
     *
     * The non-chainable wrapper functions are:
     * `clone`, `cloneDeep`, `contains`, `escape`, `every`, `find`, `findIndex`,
     * `findKey`, `findLast`, `findLastIndex`, `findLastKey`, `has`, `identity`,
     * `indexOf`, `isArguments`, `isArray`, `isBoolean`, `isDate`, `isElement`,
     * `isEmpty`, `isEqual`, `isFinite`, `isFunction`, `isNaN`, `isNull`, `isNumber`,
     * `isObject`, `isPlainObject`, `isRegExp`, `isString`, `isUndefined`, `join`,
     * `lastIndexOf`, `mixin`, `noConflict`, `parseInt`, `pop`, `random`, `reduce`,
     * `reduceRight`, `result`, `shift`, `size`, `some`, `sortedIndex`, `runInContext`,
     * `template`, `unescape`, `uniqueId`, and `value`
     *
     * The wrapper functions `first` and `last` return wrapped values when `n` is
     * provided, otherwise they return unwrapped values.
     *
     * Explicit chaining can be enabled by using the `_.chain` method.
     *
     * @name _
     * @constructor
     * @category Chaining
     * @param {*} value The value to wrap in a `lodash` instance.
     * @returns {Object} Returns a `lodash` instance.
     * @example
     *
     * var wrapped = _([1, 2, 3]);
     *
     * // returns an unwrapped value
     * wrapped.reduce(function(sum, num) {
     *   return sum + num;
     * });
     * // => 6
     *
     * // returns a wrapped value
     * var squares = wrapped.map(function(num) {
     *   return num * num;
     * });
     *
     * _.isArray(squares);
     * // => false
     *
     * _.isArray(squares.value());
     * // => true
     */
    function lodash(value) {
      // don't wrap if already wrapped, even if wrapped by a different `lodash` constructor
      return (value && typeof value == 'object' && !isArray(value) && hasOwnProperty.call(value, '__wrapped__'))
       ? value
       : new lodashWrapper(value);
    }

    /**
     * A fast path for creating `lodash` wrapper objects.
     *
     * @private
     * @param {*} value The value to wrap in a `lodash` instance.
     * @param {boolean} chainAll A flag to enable chaining for all methods
     * @returns {Object} Returns a `lodash` instance.
     */
    function lodashWrapper(value, chainAll) {
      this.__chain__ = !!chainAll;
      this.__wrapped__ = value;
    }
    // ensure `new lodashWrapper` is an instance of `lodash`
    lodashWrapper.prototype = lodash.prototype;

    /**
     * An object used to flag environments features.
     *
     * @static
     * @memberOf _
     * @type Object
     */
    var support = lodash.support = {};

    /**
     * Detect if functions can be decompiled by `Function#toString`
     * (all but PS3 and older Opera mobile browsers & avoided in Windows 8 apps).
     *
     * @memberOf _.support
     * @type boolean
     */
    support.funcDecomp = !isNative(context.WinRTError) && reThis.test(runInContext);

    /**
     * Detect if `Function#name` is supported (all but IE).
     *
     * @memberOf _.support
     * @type boolean
     */
    support.funcNames = typeof Function.name == 'string';

    /**
     * By default, the template delimiters used by Lo-Dash are similar to those in
     * embedded Ruby (ERB). Change the following template settings to use alternative
     * delimiters.
     *
     * @static
     * @memberOf _
     * @type Object
     */
    lodash.templateSettings = {

      /**
       * Used to detect `data` property values to be HTML-escaped.
       *
       * @memberOf _.templateSettings
       * @type RegExp
       */
      'escape': /<%-([\s\S]+?)%>/g,

      /**
       * Used to detect code to be evaluated.
       *
       * @memberOf _.templateSettings
       * @type RegExp
       */
      'evaluate': /<%([\s\S]+?)%>/g,

      /**
       * Used to detect `data` property values to inject.
       *
       * @memberOf _.templateSettings
       * @type RegExp
       */
      'interpolate': reInterpolate,

      /**
       * Used to reference the data object in the template text.
       *
       * @memberOf _.templateSettings
       * @type string
       */
      'variable': '',

      /**
       * Used to import variables into the compiled template.
       *
       * @memberOf _.templateSettings
       * @type Object
       */
      'imports': {

        /**
         * A reference to the `lodash` function.
         *
         * @memberOf _.templateSettings.imports
         * @type Function
         */
        '_': lodash
      }
    };

    /*--------------------------------------------------------------------------*/

    /**
     * The base implementation of `_.bind` that creates the bound function and
     * sets its meta data.
     *
     * @private
     * @param {Array} bindData The bind data array.
     * @returns {Function} Returns the new bound function.
     */
    function baseBind(bindData) {
      var func = bindData[0],
          partialArgs = bindData[2],
          thisArg = bindData[4];

      function bound() {
        // `Function#bind` spec
        // http://es5.github.io/#x15.3.4.5
        if (partialArgs) {
          // avoid `arguments` object deoptimizations by using `slice` instead
          // of `Array.prototype.slice.call` and not assigning `arguments` to a
          // variable as a ternary expression
          var args = slice(partialArgs);
          push.apply(args, arguments);
        }
        // mimic the constructor's `return` behavior
        // http://es5.github.io/#x13.2.2
        if (this instanceof bound) {
          // ensure `new bound` is an instance of `func`
          var thisBinding = baseCreate(func.prototype),
              result = func.apply(thisBinding, args || arguments);
          return isObject(result) ? result : thisBinding;
        }
        return func.apply(thisArg, args || arguments);
      }
      setBindData(bound, bindData);
      return bound;
    }

    /**
     * The base implementation of `_.clone` without argument juggling or support
     * for `thisArg` binding.
     *
     * @private
     * @param {*} value The value to clone.
     * @param {boolean} [isDeep=false] Specify a deep clone.
     * @param {Function} [callback] The function to customize cloning values.
     * @param {Array} [stackA=[]] Tracks traversed source objects.
     * @param {Array} [stackB=[]] Associates clones with source counterparts.
     * @returns {*} Returns the cloned value.
     */
    function baseClone(value, isDeep, callback, stackA, stackB) {
      if (callback) {
        var result = callback(value);
        if (typeof result != 'undefined') {
          return result;
        }
      }
      // inspect [[Class]]
      var isObj = isObject(value);
      if (isObj) {
        var className = toString.call(value);
        if (!cloneableClasses[className]) {
          return value;
        }
        var ctor = ctorByClass[className];
        switch (className) {
          case boolClass:
          case dateClass:
            return new ctor(+value);

          case numberClass:
          case stringClass:
            return new ctor(value);

          case regexpClass:
            result = ctor(value.source, reFlags.exec(value));
            result.lastIndex = value.lastIndex;
            return result;
        }
      } else {
        return value;
      }
      var isArr = isArray(value);
      if (isDeep) {
        // check for circular references and return corresponding clone
        var initedStack = !stackA;
        stackA || (stackA = getArray());
        stackB || (stackB = getArray());

        var length = stackA.length;
        while (length--) {
          if (stackA[length] == value) {
            return stackB[length];
          }
        }
        result = isArr ? ctor(value.length) : {};
      }
      else {
        result = isArr ? slice(value) : assign({}, value);
      }
      // add array properties assigned by `RegExp#exec`
      if (isArr) {
        if (hasOwnProperty.call(value, 'index')) {
          result.index = value.index;
        }
        if (hasOwnProperty.call(value, 'input')) {
          result.input = value.input;
        }
      }
      // exit for shallow clone
      if (!isDeep) {
        return result;
      }
      // add the source value to the stack of traversed objects
      // and associate it with its clone
      stackA.push(value);
      stackB.push(result);

      // recursively populate clone (susceptible to call stack limits)
      (isArr ? forEach : forOwn)(value, function(objValue, key) {
        result[key] = baseClone(objValue, isDeep, callback, stackA, stackB);
      });

      if (initedStack) {
        releaseArray(stackA);
        releaseArray(stackB);
      }
      return result;
    }

    /**
     * The base implementation of `_.create` without support for assigning
     * properties to the created object.
     *
     * @private
     * @param {Object} prototype The object to inherit from.
     * @returns {Object} Returns the new object.
     */
    function baseCreate(prototype, properties) {
      return isObject(prototype) ? nativeCreate(prototype) : {};
    }
    // fallback for browsers without `Object.create`
    if (!nativeCreate) {
      baseCreate = (function() {
        function Object() {}
        return function(prototype) {
          if (isObject(prototype)) {
            Object.prototype = prototype;
            var result = new Object;
            Object.prototype = null;
          }
          return result || context.Object();
        };
      }());
    }

    /**
     * The base implementation of `_.createCallback` without support for creating
     * "_.pluck" or "_.where" style callbacks.
     *
     * @private
     * @param {*} [func=identity] The value to convert to a callback.
     * @param {*} [thisArg] The `this` binding of the created callback.
     * @param {number} [argCount] The number of arguments the callback accepts.
     * @returns {Function} Returns a callback function.
     */
    function baseCreateCallback(func, thisArg, argCount) {
      if (typeof func != 'function') {
        return identity;
      }
      // exit early for no `thisArg` or already bound by `Function#bind`
      if (typeof thisArg == 'undefined' || !('prototype' in func)) {
        return func;
      }
      var bindData = func.__bindData__;
      if (typeof bindData == 'undefined') {
        if (support.funcNames) {
          bindData = !func.name;
        }
        bindData = bindData || !support.funcDecomp;
        if (!bindData) {
          var source = fnToString.call(func);
          if (!support.funcNames) {
            bindData = !reFuncName.test(source);
          }
          if (!bindData) {
            // checks if `func` references the `this` keyword and stores the result
            bindData = reThis.test(source);
            setBindData(func, bindData);
          }
        }
      }
      // exit early if there are no `this` references or `func` is bound
      if (bindData === false || (bindData !== true && bindData[1] & 1)) {
        return func;
      }
      switch (argCount) {
        case 1: return function(value) {
          return func.call(thisArg, value);
        };
        case 2: return function(a, b) {
          return func.call(thisArg, a, b);
        };
        case 3: return function(value, index, collection) {
          return func.call(thisArg, value, index, collection);
        };
        case 4: return function(accumulator, value, index, collection) {
          return func.call(thisArg, accumulator, value, index, collection);
        };
      }
      return bind(func, thisArg);
    }

    /**
     * The base implementation of `createWrapper` that creates the wrapper and
     * sets its meta data.
     *
     * @private
     * @param {Array} bindData The bind data array.
     * @returns {Function} Returns the new function.
     */
    function baseCreateWrapper(bindData) {
      var func = bindData[0],
          bitmask = bindData[1],
          partialArgs = bindData[2],
          partialRightArgs = bindData[3],
          thisArg = bindData[4],
          arity = bindData[5];

      var isBind = bitmask & 1,
          isBindKey = bitmask & 2,
          isCurry = bitmask & 4,
          isCurryBound = bitmask & 8,
          key = func;

      function bound() {
        var thisBinding = isBind ? thisArg : this;
        if (partialArgs) {
          var args = slice(partialArgs);
          push.apply(args, arguments);
        }
        if (partialRightArgs || isCurry) {
          args || (args = slice(arguments));
          if (partialRightArgs) {
            push.apply(args, partialRightArgs);
          }
          if (isCurry && args.length < arity) {
            bitmask |= 16 & ~32;
            return baseCreateWrapper([func, (isCurryBound ? bitmask : bitmask & ~3), args, null, thisArg, arity]);
          }
        }
        args || (args = arguments);
        if (isBindKey) {
          func = thisBinding[key];
        }
        if (this instanceof bound) {
          thisBinding = baseCreate(func.prototype);
          var result = func.apply(thisBinding, args);
          return isObject(result) ? result : thisBinding;
        }
        return func.apply(thisBinding, args);
      }
      setBindData(bound, bindData);
      return bound;
    }

    /**
     * The base implementation of `_.difference` that accepts a single array
     * of values to exclude.
     *
     * @private
     * @param {Array} array The array to process.
     * @param {Array} [values] The array of values to exclude.
     * @returns {Array} Returns a new array of filtered values.
     */
    function baseDifference(array, values) {
      var index = -1,
          indexOf = getIndexOf(),
          length = array ? array.length : 0,
          isLarge = length >= largeArraySize && indexOf === baseIndexOf,
          result = [];

      if (isLarge) {
        var cache = createCache(values);
        if (cache) {
          indexOf = cacheIndexOf;
          values = cache;
        } else {
          isLarge = false;
        }
      }
      while (++index < length) {
        var value = array[index];
        if (indexOf(values, value) < 0) {
          result.push(value);
        }
      }
      if (isLarge) {
        releaseObject(values);
      }
      return result;
    }

    /**
     * The base implementation of `_.flatten` without support for callback
     * shorthands or `thisArg` binding.
     *
     * @private
     * @param {Array} array The array to flatten.
     * @param {boolean} [isShallow=false] A flag to restrict flattening to a single level.
     * @param {boolean} [isStrict=false] A flag to restrict flattening to arrays and `arguments` objects.
     * @param {number} [fromIndex=0] The index to start from.
     * @returns {Array} Returns a new flattened array.
     */
    function baseFlatten(array, isShallow, isStrict, fromIndex) {
      var index = (fromIndex || 0) - 1,
          length = array ? array.length : 0,
          result = [];

      while (++index < length) {
        var value = array[index];

        if (value && typeof value == 'object' && typeof value.length == 'number'
            && (isArray(value) || isArguments(value))) {
          // recursively flatten arrays (susceptible to call stack limits)
          if (!isShallow) {
            value = baseFlatten(value, isShallow, isStrict);
          }
          var valIndex = -1,
              valLength = value.length,
              resIndex = result.length;

          result.length += valLength;
          while (++valIndex < valLength) {
            result[resIndex++] = value[valIndex];
          }
        } else if (!isStrict) {
          result.push(value);
        }
      }
      return result;
    }

    /**
     * The base implementation of `_.isEqual`, without support for `thisArg` binding,
     * that allows partial "_.where" style comparisons.
     *
     * @private
     * @param {*} a The value to compare.
     * @param {*} b The other value to compare.
     * @param {Function} [callback] The function to customize comparing values.
     * @param {Function} [isWhere=false] A flag to indicate performing partial comparisons.
     * @param {Array} [stackA=[]] Tracks traversed `a` objects.
     * @param {Array} [stackB=[]] Tracks traversed `b` objects.
     * @returns {boolean} Returns `true` if the values are equivalent, else `false`.
     */
    function baseIsEqual(a, b, callback, isWhere, stackA, stackB) {
      // used to indicate that when comparing objects, `a` has at least the properties of `b`
      if (callback) {
        var result = callback(a, b);
        if (typeof result != 'undefined') {
          return !!result;
        }
      }
      // exit early for identical values
      if (a === b) {
        // treat `+0` vs. `-0` as not equal
        return a !== 0 || (1 / a == 1 / b);
      }
      var type = typeof a,
          otherType = typeof b;

      // exit early for unlike primitive values
      if (a === a &&
          !(a && objectTypes[type]) &&
          !(b && objectTypes[otherType])) {
        return false;
      }
      // exit early for `null` and `undefined` avoiding ES3's Function#call behavior
      // http://es5.github.io/#x15.3.4.4
      if (a == null || b == null) {
        return a === b;
      }
      // compare [[Class]] names
      var className = toString.call(a),
          otherClass = toString.call(b);

      if (className == argsClass) {
        className = objectClass;
      }
      if (otherClass == argsClass) {
        otherClass = objectClass;
      }
      if (className != otherClass) {
        return false;
      }
      switch (className) {
        case boolClass:
        case dateClass:
          // coerce dates and booleans to numbers, dates to milliseconds and booleans
          // to `1` or `0` treating invalid dates coerced to `NaN` as not equal
          return +a == +b;

        case numberClass:
          // treat `NaN` vs. `NaN` as equal
          return (a != +a)
            ? b != +b
            // but treat `+0` vs. `-0` as not equal
            : (a == 0 ? (1 / a == 1 / b) : a == +b);

        case regexpClass:
        case stringClass:
          // coerce regexes to strings (http://es5.github.io/#x15.10.6.4)
          // treat string primitives and their corresponding object instances as equal
          return a == String(b);
      }
      var isArr = className == arrayClass;
      if (!isArr) {
        // unwrap any `lodash` wrapped values
        var aWrapped = hasOwnProperty.call(a, '__wrapped__'),
            bWrapped = hasOwnProperty.call(b, '__wrapped__');

        if (aWrapped || bWrapped) {
          return baseIsEqual(aWrapped ? a.__wrapped__ : a, bWrapped ? b.__wrapped__ : b, callback, isWhere, stackA, stackB);
        }
        // exit for functions and DOM nodes
        if (className != objectClass) {
          return false;
        }
        // in older versions of Opera, `arguments` objects have `Array` constructors
        var ctorA = a.constructor,
            ctorB = b.constructor;

        // non `Object` object instances with different constructors are not equal
        if (ctorA != ctorB &&
              !(isFunction(ctorA) && ctorA instanceof ctorA && isFunction(ctorB) && ctorB instanceof ctorB) &&
              ('constructor' in a && 'constructor' in b)
            ) {
          return false;
        }
      }
      // assume cyclic structures are equal
      // the algorithm for detecting cyclic structures is adapted from ES 5.1
      // section 15.12.3, abstract operation `JO` (http://es5.github.io/#x15.12.3)
      var initedStack = !stackA;
      stackA || (stackA = getArray());
      stackB || (stackB = getArray());

      var length = stackA.length;
      while (length--) {
        if (stackA[length] == a) {
          return stackB[length] == b;
        }
      }
      var size = 0;
      result = true;

      // add `a` and `b` to the stack of traversed objects
      stackA.push(a);
      stackB.push(b);

      // recursively compare objects and arrays (susceptible to call stack limits)
      if (isArr) {
        // compare lengths to determine if a deep comparison is necessary
        length = a.length;
        size = b.length;
        result = size == length;

        if (result || isWhere) {
          // deep compare the contents, ignoring non-numeric properties
          while (size--) {
            var index = length,
                value = b[size];

            if (isWhere) {
              while (index--) {
                if ((result = baseIsEqual(a[index], value, callback, isWhere, stackA, stackB))) {
                  break;
                }
              }
            } else if (!(result = baseIsEqual(a[size], value, callback, isWhere, stackA, stackB))) {
              break;
            }
          }
        }
      }
      else {
        // deep compare objects using `forIn`, instead of `forOwn`, to avoid `Object.keys`
        // which, in this case, is more costly
        forIn(b, function(value, key, b) {
          if (hasOwnProperty.call(b, key)) {
            // count the number of properties.
            size++;
            // deep compare each property value.
            return (result = hasOwnProperty.call(a, key) && baseIsEqual(a[key], value, callback, isWhere, stackA, stackB));
          }
        });

        if (result && !isWhere) {
          // ensure both objects have the same number of properties
          forIn(a, function(value, key, a) {
            if (hasOwnProperty.call(a, key)) {
              // `size` will be `-1` if `a` has more properties than `b`
              return (result = --size > -1);
            }
          });
        }
      }
      stackA.pop();
      stackB.pop();

      if (initedStack) {
        releaseArray(stackA);
        releaseArray(stackB);
      }
      return result;
    }

    /**
     * The base implementation of `_.merge` without argument juggling or support
     * for `thisArg` binding.
     *
     * @private
     * @param {Object} object The destination object.
     * @param {Object} source The source object.
     * @param {Function} [callback] The function to customize merging properties.
     * @param {Array} [stackA=[]] Tracks traversed source objects.
     * @param {Array} [stackB=[]] Associates values with source counterparts.
     */
    function baseMerge(object, source, callback, stackA, stackB) {
      (isArray(source) ? forEach : forOwn)(source, function(source, key) {
        var found,
            isArr,
            result = source,
            value = object[key];

        if (source && ((isArr = isArray(source)) || isPlainObject(source))) {
          // avoid merging previously merged cyclic sources
          var stackLength = stackA.length;
          while (stackLength--) {
            if ((found = stackA[stackLength] == source)) {
              value = stackB[stackLength];
              break;
            }
          }
          if (!found) {
            var isShallow;
            if (callback) {
              result = callback(value, source);
              if ((isShallow = typeof result != 'undefined')) {
                value = result;
              }
            }
            if (!isShallow) {
              value = isArr
                ? (isArray(value) ? value : [])
                : (isPlainObject(value) ? value : {});
            }
            // add `source` and associated `value` to the stack of traversed objects
            stackA.push(source);
            stackB.push(value);

            // recursively merge objects and arrays (susceptible to call stack limits)
            if (!isShallow) {
              baseMerge(value, source, callback, stackA, stackB);
            }
          }
        }
        else {
          if (callback) {
            result = callback(value, source);
            if (typeof result == 'undefined') {
              result = source;
            }
          }
          if (typeof result != 'undefined') {
            value = result;
          }
        }
        object[key] = value;
      });
    }

    /**
     * The base implementation of `_.random` without argument juggling or support
     * for returning floating-point numbers.
     *
     * @private
     * @param {number} min The minimum possible value.
     * @param {number} max The maximum possible value.
     * @returns {number} Returns a random number.
     */
    function baseRandom(min, max) {
      return min + floor(nativeRandom() * (max - min + 1));
    }

    /**
     * The base implementation of `_.uniq` without support for callback shorthands
     * or `thisArg` binding.
     *
     * @private
     * @param {Array} array The array to process.
     * @param {boolean} [isSorted=false] A flag to indicate that `array` is sorted.
     * @param {Function} [callback] The function called per iteration.
     * @returns {Array} Returns a duplicate-value-free array.
     */
    function baseUniq(array, isSorted, callback) {
      var index = -1,
          indexOf = getIndexOf(),
          length = array ? array.length : 0,
          result = [];

      var isLarge = !isSorted && length >= largeArraySize && indexOf === baseIndexOf,
          seen = (callback || isLarge) ? getArray() : result;

      if (isLarge) {
        var cache = createCache(seen);
        indexOf = cacheIndexOf;
        seen = cache;
      }
      while (++index < length) {
        var value = array[index],
            computed = callback ? callback(value, index, array) : value;

        if (isSorted
              ? !index || seen[seen.length - 1] !== computed
              : indexOf(seen, computed) < 0
            ) {
          if (callback || isLarge) {
            seen.push(computed);
          }
          result.push(value);
        }
      }
      if (isLarge) {
        releaseArray(seen.array);
        releaseObject(seen);
      } else if (callback) {
        releaseArray(seen);
      }
      return result;
    }

    /**
     * Creates a function that aggregates a collection, creating an object composed
     * of keys generated from the results of running each element of the collection
     * through a callback. The given `setter` function sets the keys and values
     * of the composed object.
     *
     * @private
     * @param {Function} setter The setter function.
     * @returns {Function} Returns the new aggregator function.
     */
    function createAggregator(setter) {
      return function(collection, callback, thisArg) {
        var result = {};
        callback = lodash.createCallback(callback, thisArg, 3);

        var index = -1,
            length = collection ? collection.length : 0;

        if (typeof length == 'number') {
          while (++index < length) {
            var value = collection[index];
            setter(result, value, callback(value, index, collection), collection);
          }
        } else {
          forOwn(collection, function(value, key, collection) {
            setter(result, value, callback(value, key, collection), collection);
          });
        }
        return result;
      };
    }

    /**
     * Creates a function that, when called, either curries or invokes `func`
     * with an optional `this` binding and partially applied arguments.
     *
     * @private
     * @param {Function|string} func The function or method name to reference.
     * @param {number} bitmask The bitmask of method flags to compose.
     *  The bitmask may be composed of the following flags:
     *  1 - `_.bind`
     *  2 - `_.bindKey`
     *  4 - `_.curry`
     *  8 - `_.curry` (bound)
     *  16 - `_.partial`
     *  32 - `_.partialRight`
     * @param {Array} [partialArgs] An array of arguments to prepend to those
     *  provided to the new function.
     * @param {Array} [partialRightArgs] An array of arguments to append to those
     *  provided to the new function.
     * @param {*} [thisArg] The `this` binding of `func`.
     * @param {number} [arity] The arity of `func`.
     * @returns {Function} Returns the new function.
     */
    function createWrapper(func, bitmask, partialArgs, partialRightArgs, thisArg, arity) {
      var isBind = bitmask & 1,
          isBindKey = bitmask & 2,
          isCurry = bitmask & 4,
          isCurryBound = bitmask & 8,
          isPartial = bitmask & 16,
          isPartialRight = bitmask & 32;

      if (!isBindKey && !isFunction(func)) {
        throw new TypeError;
      }
      if (isPartial && !partialArgs.length) {
        bitmask &= ~16;
        isPartial = partialArgs = false;
      }
      if (isPartialRight && !partialRightArgs.length) {
        bitmask &= ~32;
        isPartialRight = partialRightArgs = false;
      }
      var bindData = func && func.__bindData__;
      if (bindData && bindData !== true) {
        // clone `bindData`
        bindData = slice(bindData);
        if (bindData[2]) {
          bindData[2] = slice(bindData[2]);
        }
        if (bindData[3]) {
          bindData[3] = slice(bindData[3]);
        }
        // set `thisBinding` is not previously bound
        if (isBind && !(bindData[1] & 1)) {
          bindData[4] = thisArg;
        }
        // set if previously bound but not currently (subsequent curried functions)
        if (!isBind && bindData[1] & 1) {
          bitmask |= 8;
        }
        // set curried arity if not yet set
        if (isCurry && !(bindData[1] & 4)) {
          bindData[5] = arity;
        }
        // append partial left arguments
        if (isPartial) {
          push.apply(bindData[2] || (bindData[2] = []), partialArgs);
        }
        // append partial right arguments
        if (isPartialRight) {
          unshift.apply(bindData[3] || (bindData[3] = []), partialRightArgs);
        }
        // merge flags
        bindData[1] |= bitmask;
        return createWrapper.apply(null, bindData);
      }
      // fast path for `_.bind`
      var creater = (bitmask == 1 || bitmask === 17) ? baseBind : baseCreateWrapper;
      return creater([func, bitmask, partialArgs, partialRightArgs, thisArg, arity]);
    }

    /**
     * Used by `escape` to convert characters to HTML entities.
     *
     * @private
     * @param {string} match The matched character to escape.
     * @returns {string} Returns the escaped character.
     */
    function escapeHtmlChar(match) {
      return htmlEscapes[match];
    }

    /**
     * Gets the appropriate "indexOf" function. If the `_.indexOf` method is
     * customized, this method returns the custom method, otherwise it returns
     * the `baseIndexOf` function.
     *
     * @private
     * @returns {Function} Returns the "indexOf" function.
     */
    function getIndexOf() {
      var result = (result = lodash.indexOf) === indexOf ? baseIndexOf : result;
      return result;
    }

    /**
     * Checks if `value` is a native function.
     *
     * @private
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if the `value` is a native function, else `false`.
     */
    function isNative(value) {
      return typeof value == 'function' && reNative.test(value);
    }

    /**
     * Sets `this` binding data on a given function.
     *
     * @private
     * @param {Function} func The function to set data on.
     * @param {Array} value The data array to set.
     */
    var setBindData = !defineProperty ? noop : function(func, value) {
      descriptor.value = value;
      defineProperty(func, '__bindData__', descriptor);
    };

    /**
     * A fallback implementation of `isPlainObject` which checks if a given value
     * is an object created by the `Object` constructor, assuming objects created
     * by the `Object` constructor have no inherited enumerable properties and that
     * there are no `Object.prototype` extensions.
     *
     * @private
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.
     */
    function shimIsPlainObject(value) {
      var ctor,
          result;

      // avoid non Object objects, `arguments` objects, and DOM elements
      if (!(value && toString.call(value) == objectClass) ||
          (ctor = value.constructor, isFunction(ctor) && !(ctor instanceof ctor))) {
        return false;
      }
      // In most environments an object's own properties are iterated before
      // its inherited properties. If the last iterated property is an object's
      // own property then there are no inherited enumerable properties.
      forIn(value, function(value, key) {
        result = key;
      });
      return typeof result == 'undefined' || hasOwnProperty.call(value, result);
    }

    /**
     * Used by `unescape` to convert HTML entities to characters.
     *
     * @private
     * @param {string} match The matched character to unescape.
     * @returns {string} Returns the unescaped character.
     */
    function unescapeHtmlChar(match) {
      return htmlUnescapes[match];
    }

    /*--------------------------------------------------------------------------*/

    /**
     * Checks if `value` is an `arguments` object.
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if the `value` is an `arguments` object, else `false`.
     * @example
     *
     * (function() { return _.isArguments(arguments); })(1, 2, 3);
     * // => true
     *
     * _.isArguments([1, 2, 3]);
     * // => false
     */
    function isArguments(value) {
      return value && typeof value == 'object' && typeof value.length == 'number' &&
        toString.call(value) == argsClass || false;
    }

    /**
     * Checks if `value` is an array.
     *
     * @static
     * @memberOf _
     * @type Function
     * @category Objects
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if the `value` is an array, else `false`.
     * @example
     *
     * (function() { return _.isArray(arguments); })();
     * // => false
     *
     * _.isArray([1, 2, 3]);
     * // => true
     */
    var isArray = nativeIsArray || function(value) {
      return value && typeof value == 'object' && typeof value.length == 'number' &&
        toString.call(value) == arrayClass || false;
    };

    /**
     * A fallback implementation of `Object.keys` which produces an array of the
     * given object's own enumerable property names.
     *
     * @private
     * @type Function
     * @param {Object} object The object to inspect.
     * @returns {Array} Returns an array of property names.
     */
    var shimKeys = function(object) {
      var index, iterable = object, result = [];
      if (!iterable) return result;
      if (!(objectTypes[typeof object])) return result;
        for (index in iterable) {
          if (hasOwnProperty.call(iterable, index)) {
            result.push(index);
          }
        }
      return result
    };

    /**
     * Creates an array composed of the own enumerable property names of an object.
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {Object} object The object to inspect.
     * @returns {Array} Returns an array of property names.
     * @example
     *
     * _.keys({ 'one': 1, 'two': 2, 'three': 3 });
     * // => ['one', 'two', 'three'] (property order is not guaranteed across environments)
     */
    var keys = !nativeKeys ? shimKeys : function(object) {
      if (!isObject(object)) {
        return [];
      }
      return nativeKeys(object);
    };

    /**
     * Used to convert characters to HTML entities:
     *
     * Though the `>` character is escaped for symmetry, characters like `>` and `/`
     * don't require escaping in HTML and have no special meaning unless they're part
     * of a tag or an unquoted attribute value.
     * http://mathiasbynens.be/notes/ambiguous-ampersands (under "semi-related fun fact")
     */
    var htmlEscapes = {
      '&': '&amp;',
      '<': '&lt;',
      '>': '&gt;',
      '"': '&quot;',
      "'": '&#39;'
    };

    /** Used to convert HTML entities to characters */
    var htmlUnescapes = invert(htmlEscapes);

    /** Used to match HTML entities and HTML characters */
    var reEscapedHtml = RegExp('(' + keys(htmlUnescapes).join('|') + ')', 'g'),
        reUnescapedHtml = RegExp('[' + keys(htmlEscapes).join('') + ']', 'g');

    /*--------------------------------------------------------------------------*/

    /**
     * Assigns own enumerable properties of source object(s) to the destination
     * object. Subsequent sources will overwrite property assignments of previous
     * sources. If a callback is provided it will be executed to produce the
     * assigned values. The callback is bound to `thisArg` and invoked with two
     * arguments; (objectValue, sourceValue).
     *
     * @static
     * @memberOf _
     * @type Function
     * @alias extend
     * @category Objects
     * @param {Object} object The destination object.
     * @param {...Object} [source] The source objects.
     * @param {Function} [callback] The function to customize assigning values.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {Object} Returns the destination object.
     * @example
     *
     * _.assign({ 'name': 'fred' }, { 'employer': 'slate' });
     * // => { 'name': 'fred', 'employer': 'slate' }
     *
     * var defaults = _.partialRight(_.assign, function(a, b) {
     *   return typeof a == 'undefined' ? b : a;
     * });
     *
     * var object = { 'name': 'barney' };
     * defaults(object, { 'name': 'fred', 'employer': 'slate' });
     * // => { 'name': 'barney', 'employer': 'slate' }
     */
    var assign = function(object, source, guard) {
      var index, iterable = object, result = iterable;
      if (!iterable) return result;
      var args = arguments,
          argsIndex = 0,
          argsLength = typeof guard == 'number' ? 2 : args.length;
      if (argsLength > 3 && typeof args[argsLength - 2] == 'function') {
        var callback = baseCreateCallback(args[--argsLength - 1], args[argsLength--], 2);
      } else if (argsLength > 2 && typeof args[argsLength - 1] == 'function') {
        callback = args[--argsLength];
      }
      while (++argsIndex < argsLength) {
        iterable = args[argsIndex];
        if (iterable && objectTypes[typeof iterable]) {
        var ownIndex = -1,
            ownProps = objectTypes[typeof iterable] && keys(iterable),
            length = ownProps ? ownProps.length : 0;

        while (++ownIndex < length) {
          index = ownProps[ownIndex];
          result[index] = callback ? callback(result[index], iterable[index]) : iterable[index];
        }
        }
      }
      return result
    };

    /**
     * Creates a clone of `value`. If `isDeep` is `true` nested objects will also
     * be cloned, otherwise they will be assigned by reference. If a callback
     * is provided it will be executed to produce the cloned values. If the
     * callback returns `undefined` cloning will be handled by the method instead.
     * The callback is bound to `thisArg` and invoked with one argument; (value).
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {*} value The value to clone.
     * @param {boolean} [isDeep=false] Specify a deep clone.
     * @param {Function} [callback] The function to customize cloning values.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {*} Returns the cloned value.
     * @example
     *
     * var characters = [
     *   { 'name': 'barney', 'age': 36 },
     *   { 'name': 'fred',   'age': 40 }
     * ];
     *
     * var shallow = _.clone(characters);
     * shallow[0] === characters[0];
     * // => true
     *
     * var deep = _.clone(characters, true);
     * deep[0] === characters[0];
     * // => false
     *
     * _.mixin({
     *   'clone': _.partialRight(_.clone, function(value) {
     *     return _.isElement(value) ? value.cloneNode(false) : undefined;
     *   })
     * });
     *
     * var clone = _.clone(document.body);
     * clone.childNodes.length;
     * // => 0
     */
    function clone(value, isDeep, callback, thisArg) {
      // allows working with "Collections" methods without using their `index`
      // and `collection` arguments for `isDeep` and `callback`
      if (typeof isDeep != 'boolean' && isDeep != null) {
        thisArg = callback;
        callback = isDeep;
        isDeep = false;
      }
      return baseClone(value, isDeep, typeof callback == 'function' && baseCreateCallback(callback, thisArg, 1));
    }

    /**
     * Creates a deep clone of `value`. If a callback is provided it will be
     * executed to produce the cloned values. If the callback returns `undefined`
     * cloning will be handled by the method instead. The callback is bound to
     * `thisArg` and invoked with one argument; (value).
     *
     * Note: This method is loosely based on the structured clone algorithm. Functions
     * and DOM nodes are **not** cloned. The enumerable properties of `arguments` objects and
     * objects created by constructors other than `Object` are cloned to plain `Object` objects.
     * See http://www.w3.org/TR/html5/infrastructure.html#internal-structured-cloning-algorithm.
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {*} value The value to deep clone.
     * @param {Function} [callback] The function to customize cloning values.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {*} Returns the deep cloned value.
     * @example
     *
     * var characters = [
     *   { 'name': 'barney', 'age': 36 },
     *   { 'name': 'fred',   'age': 40 }
     * ];
     *
     * var deep = _.cloneDeep(characters);
     * deep[0] === characters[0];
     * // => false
     *
     * var view = {
     *   'label': 'docs',
     *   'node': element
     * };
     *
     * var clone = _.cloneDeep(view, function(value) {
     *   return _.isElement(value) ? value.cloneNode(true) : undefined;
     * });
     *
     * clone.node == view.node;
     * // => false
     */
    function cloneDeep(value, callback, thisArg) {
      return baseClone(value, true, typeof callback == 'function' && baseCreateCallback(callback, thisArg, 1));
    }

    /**
     * Creates an object that inherits from the given `prototype` object. If a
     * `properties` object is provided its own enumerable properties are assigned
     * to the created object.
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {Object} prototype The object to inherit from.
     * @param {Object} [properties] The properties to assign to the object.
     * @returns {Object} Returns the new object.
     * @example
     *
     * function Shape() {
     *   this.x = 0;
     *   this.y = 0;
     * }
     *
     * function Circle() {
     *   Shape.call(this);
     * }
     *
     * Circle.prototype = _.create(Shape.prototype, { 'constructor': Circle });
     *
     * var circle = new Circle;
     * circle instanceof Circle;
     * // => true
     *
     * circle instanceof Shape;
     * // => true
     */
    function create(prototype, properties) {
      var result = baseCreate(prototype);
      return properties ? assign(result, properties) : result;
    }

    /**
     * Assigns own enumerable properties of source object(s) to the destination
     * object for all destination properties that resolve to `undefined`. Once a
     * property is set, additional defaults of the same property will be ignored.
     *
     * @static
     * @memberOf _
     * @type Function
     * @category Objects
     * @param {Object} object The destination object.
     * @param {...Object} [source] The source objects.
     * @param- {Object} [guard] Allows working with `_.reduce` without using its
     *  `key` and `object` arguments as sources.
     * @returns {Object} Returns the destination object.
     * @example
     *
     * var object = { 'name': 'barney' };
     * _.defaults(object, { 'name': 'fred', 'employer': 'slate' });
     * // => { 'name': 'barney', 'employer': 'slate' }
     */
    var defaults = function(object, source, guard) {
      var index, iterable = object, result = iterable;
      if (!iterable) return result;
      var args = arguments,
          argsIndex = 0,
          argsLength = typeof guard == 'number' ? 2 : args.length;
      while (++argsIndex < argsLength) {
        iterable = args[argsIndex];
        if (iterable && objectTypes[typeof iterable]) {
        var ownIndex = -1,
            ownProps = objectTypes[typeof iterable] && keys(iterable),
            length = ownProps ? ownProps.length : 0;

        while (++ownIndex < length) {
          index = ownProps[ownIndex];
          if (typeof result[index] == 'undefined') result[index] = iterable[index];
        }
        }
      }
      return result
    };

    /**
     * This method is like `_.findIndex` except that it returns the key of the
     * first element that passes the callback check, instead of the element itself.
     *
     * If a property name is provided for `callback` the created "_.pluck" style
     * callback will return the property value of the given element.
     *
     * If an object is provided for `callback` the created "_.where" style callback
     * will return `true` for elements that have the properties of the given object,
     * else `false`.
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {Object} object The object to search.
     * @param {Function|Object|string} [callback=identity] The function called per
     *  iteration. If a property name or object is provided it will be used to
     *  create a "_.pluck" or "_.where" style callback, respectively.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {string|undefined} Returns the key of the found element, else `undefined`.
     * @example
     *
     * var characters = {
     *   'barney': {  'age': 36, 'blocked': false },
     *   'fred': {    'age': 40, 'blocked': true },
     *   'pebbles': { 'age': 1,  'blocked': false }
     * };
     *
     * _.findKey(characters, function(chr) {
     *   return chr.age < 40;
     * });
     * // => 'barney' (property order is not guaranteed across environments)
     *
     * // using "_.where" callback shorthand
     * _.findKey(characters, { 'age': 1 });
     * // => 'pebbles'
     *
     * // using "_.pluck" callback shorthand
     * _.findKey(characters, 'blocked');
     * // => 'fred'
     */
    function findKey(object, callback, thisArg) {
      var result;
      callback = lodash.createCallback(callback, thisArg, 3);
      forOwn(object, function(value, key, object) {
        if (callback(value, key, object)) {
          result = key;
          return false;
        }
      });
      return result;
    }

    /**
     * This method is like `_.findKey` except that it iterates over elements
     * of a `collection` in the opposite order.
     *
     * If a property name is provided for `callback` the created "_.pluck" style
     * callback will return the property value of the given element.
     *
     * If an object is provided for `callback` the created "_.where" style callback
     * will return `true` for elements that have the properties of the given object,
     * else `false`.
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {Object} object The object to search.
     * @param {Function|Object|string} [callback=identity] The function called per
     *  iteration. If a property name or object is provided it will be used to
     *  create a "_.pluck" or "_.where" style callback, respectively.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {string|undefined} Returns the key of the found element, else `undefined`.
     * @example
     *
     * var characters = {
     *   'barney': {  'age': 36, 'blocked': true },
     *   'fred': {    'age': 40, 'blocked': false },
     *   'pebbles': { 'age': 1,  'blocked': true }
     * };
     *
     * _.findLastKey(characters, function(chr) {
     *   return chr.age < 40;
     * });
     * // => returns `pebbles`, assuming `_.findKey` returns `barney`
     *
     * // using "_.where" callback shorthand
     * _.findLastKey(characters, { 'age': 40 });
     * // => 'fred'
     *
     * // using "_.pluck" callback shorthand
     * _.findLastKey(characters, 'blocked');
     * // => 'pebbles'
     */
    function findLastKey(object, callback, thisArg) {
      var result;
      callback = lodash.createCallback(callback, thisArg, 3);
      forOwnRight(object, function(value, key, object) {
        if (callback(value, key, object)) {
          result = key;
          return false;
        }
      });
      return result;
    }

    /**
     * Iterates over own and inherited enumerable properties of an object,
     * executing the callback for each property. The callback is bound to `thisArg`
     * and invoked with three arguments; (value, key, object). Callbacks may exit
     * iteration early by explicitly returning `false`.
     *
     * @static
     * @memberOf _
     * @type Function
     * @category Objects
     * @param {Object} object The object to iterate over.
     * @param {Function} [callback=identity] The function called per iteration.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {Object} Returns `object`.
     * @example
     *
     * function Shape() {
     *   this.x = 0;
     *   this.y = 0;
     * }
     *
     * Shape.prototype.move = function(x, y) {
     *   this.x += x;
     *   this.y += y;
     * };
     *
     * _.forIn(new Shape, function(value, key) {
     *   console.log(key);
     * });
     * // => logs 'x', 'y', and 'move' (property order is not guaranteed across environments)
     */
    var forIn = function(collection, callback, thisArg) {
      var index, iterable = collection, result = iterable;
      if (!iterable) return result;
      if (!objectTypes[typeof iterable]) return result;
      callback = callback && typeof thisArg == 'undefined' ? callback : baseCreateCallback(callback, thisArg, 3);
        for (index in iterable) {
          if (callback(iterable[index], index, collection) === false) return result;
        }
      return result
    };

    /**
     * This method is like `_.forIn` except that it iterates over elements
     * of a `collection` in the opposite order.
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {Object} object The object to iterate over.
     * @param {Function} [callback=identity] The function called per iteration.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {Object} Returns `object`.
     * @example
     *
     * function Shape() {
     *   this.x = 0;
     *   this.y = 0;
     * }
     *
     * Shape.prototype.move = function(x, y) {
     *   this.x += x;
     *   this.y += y;
     * };
     *
     * _.forInRight(new Shape, function(value, key) {
     *   console.log(key);
     * });
     * // => logs 'move', 'y', and 'x' assuming `_.forIn ` logs 'x', 'y', and 'move'
     */
    function forInRight(object, callback, thisArg) {
      var pairs = [];

      forIn(object, function(value, key) {
        pairs.push(key, value);
      });

      var length = pairs.length;
      callback = baseCreateCallback(callback, thisArg, 3);
      while (length--) {
        if (callback(pairs[length--], pairs[length], object) === false) {
          break;
        }
      }
      return object;
    }

    /**
     * Iterates over own enumerable properties of an object, executing the callback
     * for each property. The callback is bound to `thisArg` and invoked with three
     * arguments; (value, key, object). Callbacks may exit iteration early by
     * explicitly returning `false`.
     *
     * @static
     * @memberOf _
     * @type Function
     * @category Objects
     * @param {Object} object The object to iterate over.
     * @param {Function} [callback=identity] The function called per iteration.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {Object} Returns `object`.
     * @example
     *
     * _.forOwn({ '0': 'zero', '1': 'one', 'length': 2 }, function(num, key) {
     *   console.log(key);
     * });
     * // => logs '0', '1', and 'length' (property order is not guaranteed across environments)
     */
    var forOwn = function(collection, callback, thisArg) {
      var index, iterable = collection, result = iterable;
      if (!iterable) return result;
      if (!objectTypes[typeof iterable]) return result;
      callback = callback && typeof thisArg == 'undefined' ? callback : baseCreateCallback(callback, thisArg, 3);
        var ownIndex = -1,
            ownProps = objectTypes[typeof iterable] && keys(iterable),
            length = ownProps ? ownProps.length : 0;

        while (++ownIndex < length) {
          index = ownProps[ownIndex];
          if (callback(iterable[index], index, collection) === false) return result;
        }
      return result
    };

    /**
     * This method is like `_.forOwn` except that it iterates over elements
     * of a `collection` in the opposite order.
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {Object} object The object to iterate over.
     * @param {Function} [callback=identity] The function called per iteration.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {Object} Returns `object`.
     * @example
     *
     * _.forOwnRight({ '0': 'zero', '1': 'one', 'length': 2 }, function(num, key) {
     *   console.log(key);
     * });
     * // => logs 'length', '1', and '0' assuming `_.forOwn` logs '0', '1', and 'length'
     */
    function forOwnRight(object, callback, thisArg) {
      var props = keys(object),
          length = props.length;

      callback = baseCreateCallback(callback, thisArg, 3);
      while (length--) {
        var key = props[length];
        if (callback(object[key], key, object) === false) {
          break;
        }
      }
      return object;
    }

    /**
     * Creates a sorted array of property names of all enumerable properties,
     * own and inherited, of `object` that have function values.
     *
     * @static
     * @memberOf _
     * @alias methods
     * @category Objects
     * @param {Object} object The object to inspect.
     * @returns {Array} Returns an array of property names that have function values.
     * @example
     *
     * _.functions(_);
     * // => ['all', 'any', 'bind', 'bindAll', 'clone', 'compact', 'compose', ...]
     */
    function functions(object) {
      var result = [];
      forIn(object, function(value, key) {
        if (isFunction(value)) {
          result.push(key);
        }
      });
      return result.sort();
    }

    /**
     * Checks if the specified property name exists as a direct property of `object`,
     * instead of an inherited property.
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {Object} object The object to inspect.
     * @param {string} key The name of the property to check.
     * @returns {boolean} Returns `true` if key is a direct property, else `false`.
     * @example
     *
     * _.has({ 'a': 1, 'b': 2, 'c': 3 }, 'b');
     * // => true
     */
    function has(object, key) {
      return object ? hasOwnProperty.call(object, key) : false;
    }

    /**
     * Creates an object composed of the inverted keys and values of the given object.
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {Object} object The object to invert.
     * @returns {Object} Returns the created inverted object.
     * @example
     *
     * _.invert({ 'first': 'fred', 'second': 'barney' });
     * // => { 'fred': 'first', 'barney': 'second' }
     */
    function invert(object) {
      var index = -1,
          props = keys(object),
          length = props.length,
          result = {};

      while (++index < length) {
        var key = props[index];
        result[object[key]] = key;
      }
      return result;
    }

    /**
     * Checks if `value` is a boolean value.
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if the `value` is a boolean value, else `false`.
     * @example
     *
     * _.isBoolean(null);
     * // => false
     */
    function isBoolean(value) {
      return value === true || value === false ||
        value && typeof value == 'object' && toString.call(value) == boolClass || false;
    }

    /**
     * Checks if `value` is a date.
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if the `value` is a date, else `false`.
     * @example
     *
     * _.isDate(new Date);
     * // => true
     */
    function isDate(value) {
      return value && typeof value == 'object' && toString.call(value) == dateClass || false;
    }

    /**
     * Checks if `value` is a DOM element.
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if the `value` is a DOM element, else `false`.
     * @example
     *
     * _.isElement(document.body);
     * // => true
     */
    function isElement(value) {
      return value && value.nodeType === 1 || false;
    }

    /**
     * Checks if `value` is empty. Arrays, strings, or `arguments` objects with a
     * length of `0` and objects with no own enumerable properties are considered
     * "empty".
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {Array|Object|string} value The value to inspect.
     * @returns {boolean} Returns `true` if the `value` is empty, else `false`.
     * @example
     *
     * _.isEmpty([1, 2, 3]);
     * // => false
     *
     * _.isEmpty({});
     * // => true
     *
     * _.isEmpty('');
     * // => true
     */
    function isEmpty(value) {
      var result = true;
      if (!value) {
        return result;
      }
      var className = toString.call(value),
          length = value.length;

      if ((className == arrayClass || className == stringClass || className == argsClass ) ||
          (className == objectClass && typeof length == 'number' && isFunction(value.splice))) {
        return !length;
      }
      forOwn(value, function() {
        return (result = false);
      });
      return result;
    }

    /**
     * Performs a deep comparison between two values to determine if they are
     * equivalent to each other. If a callback is provided it will be executed
     * to compare values. If the callback returns `undefined` comparisons will
     * be handled by the method instead. The callback is bound to `thisArg` and
     * invoked with two arguments; (a, b).
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {*} a The value to compare.
     * @param {*} b The other value to compare.
     * @param {Function} [callback] The function to customize comparing values.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {boolean} Returns `true` if the values are equivalent, else `false`.
     * @example
     *
     * var object = { 'name': 'fred' };
     * var copy = { 'name': 'fred' };
     *
     * object == copy;
     * // => false
     *
     * _.isEqual(object, copy);
     * // => true
     *
     * var words = ['hello', 'goodbye'];
     * var otherWords = ['hi', 'goodbye'];
     *
     * _.isEqual(words, otherWords, function(a, b) {
     *   var reGreet = /^(?:hello|hi)$/i,
     *       aGreet = _.isString(a) && reGreet.test(a),
     *       bGreet = _.isString(b) && reGreet.test(b);
     *
     *   return (aGreet || bGreet) ? (aGreet == bGreet) : undefined;
     * });
     * // => true
     */
    function isEqual(a, b, callback, thisArg) {
      return baseIsEqual(a, b, typeof callback == 'function' && baseCreateCallback(callback, thisArg, 2));
    }

    /**
     * Checks if `value` is, or can be coerced to, a finite number.
     *
     * Note: This is not the same as native `isFinite` which will return true for
     * booleans and empty strings. See http://es5.github.io/#x15.1.2.5.
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if the `value` is finite, else `false`.
     * @example
     *
     * _.isFinite(-101);
     * // => true
     *
     * _.isFinite('10');
     * // => true
     *
     * _.isFinite(true);
     * // => false
     *
     * _.isFinite('');
     * // => false
     *
     * _.isFinite(Infinity);
     * // => false
     */
    function isFinite(value) {
      return nativeIsFinite(value) && !nativeIsNaN(parseFloat(value));
    }

    /**
     * Checks if `value` is a function.
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if the `value` is a function, else `false`.
     * @example
     *
     * _.isFunction(_);
     * // => true
     */
    function isFunction(value) {
      return typeof value == 'function';
    }

    /**
     * Checks if `value` is the language type of Object.
     * (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if the `value` is an object, else `false`.
     * @example
     *
     * _.isObject({});
     * // => true
     *
     * _.isObject([1, 2, 3]);
     * // => true
     *
     * _.isObject(1);
     * // => false
     */
    function isObject(value) {
      // check if the value is the ECMAScript language type of Object
      // http://es5.github.io/#x8
      // and avoid a V8 bug
      // http://code.google.com/p/v8/issues/detail?id=2291
      return !!(value && objectTypes[typeof value]);
    }

    /**
     * Checks if `value` is `NaN`.
     *
     * Note: This is not the same as native `isNaN` which will return `true` for
     * `undefined` and other non-numeric values. See http://es5.github.io/#x15.1.2.4.
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if the `value` is `NaN`, else `false`.
     * @example
     *
     * _.isNaN(NaN);
     * // => true
     *
     * _.isNaN(new Number(NaN));
     * // => true
     *
     * isNaN(undefined);
     * // => true
     *
     * _.isNaN(undefined);
     * // => false
     */
    function isNaN(value) {
      // `NaN` as a primitive is the only value that is not equal to itself
      // (perform the [[Class]] check first to avoid errors with some host objects in IE)
      return isNumber(value) && value != +value;
    }

    /**
     * Checks if `value` is `null`.
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if the `value` is `null`, else `false`.
     * @example
     *
     * _.isNull(null);
     * // => true
     *
     * _.isNull(undefined);
     * // => false
     */
    function isNull(value) {
      return value === null;
    }

    /**
     * Checks if `value` is a number.
     *
     * Note: `NaN` is considered a number. See http://es5.github.io/#x8.5.
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if the `value` is a number, else `false`.
     * @example
     *
     * _.isNumber(8.4 * 5);
     * // => true
     */
    function isNumber(value) {
      return typeof value == 'number' ||
        value && typeof value == 'object' && toString.call(value) == numberClass || false;
    }

    /**
     * Checks if `value` is an object created by the `Object` constructor.
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.
     * @example
     *
     * function Shape() {
     *   this.x = 0;
     *   this.y = 0;
     * }
     *
     * _.isPlainObject(new Shape);
     * // => false
     *
     * _.isPlainObject([1, 2, 3]);
     * // => false
     *
     * _.isPlainObject({ 'x': 0, 'y': 0 });
     * // => true
     */
    var isPlainObject = !getPrototypeOf ? shimIsPlainObject : function(value) {
      if (!(value && toString.call(value) == objectClass)) {
        return false;
      }
      var valueOf = value.valueOf,
          objProto = isNative(valueOf) && (objProto = getPrototypeOf(valueOf)) && getPrototypeOf(objProto);

      return objProto
        ? (value == objProto || getPrototypeOf(value) == objProto)
        : shimIsPlainObject(value);
    };

    /**
     * Checks if `value` is a regular expression.
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if the `value` is a regular expression, else `false`.
     * @example
     *
     * _.isRegExp(/fred/);
     * // => true
     */
    function isRegExp(value) {
      return value && typeof value == 'object' && toString.call(value) == regexpClass || false;
    }

    /**
     * Checks if `value` is a string.
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if the `value` is a string, else `false`.
     * @example
     *
     * _.isString('fred');
     * // => true
     */
    function isString(value) {
      return typeof value == 'string' ||
        value && typeof value == 'object' && toString.call(value) == stringClass || false;
    }

    /**
     * Checks if `value` is `undefined`.
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if the `value` is `undefined`, else `false`.
     * @example
     *
     * _.isUndefined(void 0);
     * // => true
     */
    function isUndefined(value) {
      return typeof value == 'undefined';
    }

    /**
     * Creates an object with the same keys as `object` and values generated by
     * running each own enumerable property of `object` through the callback.
     * The callback is bound to `thisArg` and invoked with three arguments;
     * (value, key, object).
     *
     * If a property name is provided for `callback` the created "_.pluck" style
     * callback will return the property value of the given element.
     *
     * If an object is provided for `callback` the created "_.where" style callback
     * will return `true` for elements that have the properties of the given object,
     * else `false`.
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {Object} object The object to iterate over.
     * @param {Function|Object|string} [callback=identity] The function called
     *  per iteration. If a property name or object is provided it will be used
     *  to create a "_.pluck" or "_.where" style callback, respectively.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {Array} Returns a new object with values of the results of each `callback` execution.
     * @example
     *
     * _.mapValues({ 'a': 1, 'b': 2, 'c': 3} , function(num) { return num * 3; });
     * // => { 'a': 3, 'b': 6, 'c': 9 }
     *
     * var characters = {
     *   'fred': { 'name': 'fred', 'age': 40 },
     *   'pebbles': { 'name': 'pebbles', 'age': 1 }
     * };
     *
     * // using "_.pluck" callback shorthand
     * _.mapValues(characters, 'age');
     * // => { 'fred': 40, 'pebbles': 1 }
     */
    function mapValues(object, callback, thisArg) {
      var result = {};
      callback = lodash.createCallback(callback, thisArg, 3);

      forOwn(object, function(value, key, object) {
        result[key] = callback(value, key, object);
      });
      return result;
    }

    /**
     * Recursively merges own enumerable properties of the source object(s), that
     * don't resolve to `undefined` into the destination object. Subsequent sources
     * will overwrite property assignments of previous sources. If a callback is
     * provided it will be executed to produce the merged values of the destination
     * and source properties. If the callback returns `undefined` merging will
     * be handled by the method instead. The callback is bound to `thisArg` and
     * invoked with two arguments; (objectValue, sourceValue).
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {Object} object The destination object.
     * @param {...Object} [source] The source objects.
     * @param {Function} [callback] The function to customize merging properties.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {Object} Returns the destination object.
     * @example
     *
     * var names = {
     *   'characters': [
     *     { 'name': 'barney' },
     *     { 'name': 'fred' }
     *   ]
     * };
     *
     * var ages = {
     *   'characters': [
     *     { 'age': 36 },
     *     { 'age': 40 }
     *   ]
     * };
     *
     * _.merge(names, ages);
     * // => { 'characters': [{ 'name': 'barney', 'age': 36 }, { 'name': 'fred', 'age': 40 }] }
     *
     * var food = {
     *   'fruits': ['apple'],
     *   'vegetables': ['beet']
     * };
     *
     * var otherFood = {
     *   'fruits': ['banana'],
     *   'vegetables': ['carrot']
     * };
     *
     * _.merge(food, otherFood, function(a, b) {
     *   return _.isArray(a) ? a.concat(b) : undefined;
     * });
     * // => { 'fruits': ['apple', 'banana'], 'vegetables': ['beet', 'carrot] }
     */
    function merge(object) {
      var args = arguments,
          length = 2;

      if (!isObject(object)) {
        return object;
      }
      // allows working with `_.reduce` and `_.reduceRight` without using
      // their `index` and `collection` arguments
      if (typeof args[2] != 'number') {
        length = args.length;
      }
      if (length > 3 && typeof args[length - 2] == 'function') {
        var callback = baseCreateCallback(args[--length - 1], args[length--], 2);
      } else if (length > 2 && typeof args[length - 1] == 'function') {
        callback = args[--length];
      }
      var sources = slice(arguments, 1, length),
          index = -1,
          stackA = getArray(),
          stackB = getArray();

      while (++index < length) {
        baseMerge(object, sources[index], callback, stackA, stackB);
      }
      releaseArray(stackA);
      releaseArray(stackB);
      return object;
    }

    /**
     * Creates a shallow clone of `object` excluding the specified properties.
     * Property names may be specified as individual arguments or as arrays of
     * property names. If a callback is provided it will be executed for each
     * property of `object` omitting the properties the callback returns truey
     * for. The callback is bound to `thisArg` and invoked with three arguments;
     * (value, key, object).
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {Object} object The source object.
     * @param {Function|...string|string[]} [callback] The properties to omit or the
     *  function called per iteration.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {Object} Returns an object without the omitted properties.
     * @example
     *
     * _.omit({ 'name': 'fred', 'age': 40 }, 'age');
     * // => { 'name': 'fred' }
     *
     * _.omit({ 'name': 'fred', 'age': 40 }, function(value) {
     *   return typeof value == 'number';
     * });
     * // => { 'name': 'fred' }
     */
    function omit(object, callback, thisArg) {
      var result = {};
      if (typeof callback != 'function') {
        var props = [];
        forIn(object, function(value, key) {
          props.push(key);
        });
        props = baseDifference(props, baseFlatten(arguments, true, false, 1));

        var index = -1,
            length = props.length;

        while (++index < length) {
          var key = props[index];
          result[key] = object[key];
        }
      } else {
        callback = lodash.createCallback(callback, thisArg, 3);
        forIn(object, function(value, key, object) {
          if (!callback(value, key, object)) {
            result[key] = value;
          }
        });
      }
      return result;
    }

    /**
     * Creates a two dimensional array of an object's key-value pairs,
     * i.e. `[[key1, value1], [key2, value2]]`.
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {Object} object The object to inspect.
     * @returns {Array} Returns new array of key-value pairs.
     * @example
     *
     * _.pairs({ 'barney': 36, 'fred': 40 });
     * // => [['barney', 36], ['fred', 40]] (property order is not guaranteed across environments)
     */
    function pairs(object) {
      var index = -1,
          props = keys(object),
          length = props.length,
          result = Array(length);

      while (++index < length) {
        var key = props[index];
        result[index] = [key, object[key]];
      }
      return result;
    }

    /**
     * Creates a shallow clone of `object` composed of the specified properties.
     * Property names may be specified as individual arguments or as arrays of
     * property names. If a callback is provided it will be executed for each
     * property of `object` picking the properties the callback returns truey
     * for. The callback is bound to `thisArg` and invoked with three arguments;
     * (value, key, object).
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {Object} object The source object.
     * @param {Function|...string|string[]} [callback] The function called per
     *  iteration or property names to pick, specified as individual property
     *  names or arrays of property names.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {Object} Returns an object composed of the picked properties.
     * @example
     *
     * _.pick({ 'name': 'fred', '_userid': 'fred1' }, 'name');
     * // => { 'name': 'fred' }
     *
     * _.pick({ 'name': 'fred', '_userid': 'fred1' }, function(value, key) {
     *   return key.charAt(0) != '_';
     * });
     * // => { 'name': 'fred' }
     */
    function pick(object, callback, thisArg) {
      var result = {};
      if (typeof callback != 'function') {
        var index = -1,
            props = baseFlatten(arguments, true, false, 1),
            length = isObject(object) ? props.length : 0;

        while (++index < length) {
          var key = props[index];
          if (key in object) {
            result[key] = object[key];
          }
        }
      } else {
        callback = lodash.createCallback(callback, thisArg, 3);
        forIn(object, function(value, key, object) {
          if (callback(value, key, object)) {
            result[key] = value;
          }
        });
      }
      return result;
    }

    /**
     * An alternative to `_.reduce` this method transforms `object` to a new
     * `accumulator` object which is the result of running each of its own
     * enumerable properties through a callback, with each callback execution
     * potentially mutating the `accumulator` object. The callback is bound to
     * `thisArg` and invoked with four arguments; (accumulator, value, key, object).
     * Callbacks may exit iteration early by explicitly returning `false`.
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {Array|Object} object The object to iterate over.
     * @param {Function} [callback=identity] The function called per iteration.
     * @param {*} [accumulator] The custom accumulator value.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {*} Returns the accumulated value.
     * @example
     *
     * var squares = _.transform([1, 2, 3, 4, 5, 6, 7, 8, 9, 10], function(result, num) {
     *   num *= num;
     *   if (num % 2) {
     *     return result.push(num) < 3;
     *   }
     * });
     * // => [1, 9, 25]
     *
     * var mapped = _.transform({ 'a': 1, 'b': 2, 'c': 3 }, function(result, num, key) {
     *   result[key] = num * 3;
     * });
     * // => { 'a': 3, 'b': 6, 'c': 9 }
     */
    function transform(object, callback, accumulator, thisArg) {
      var isArr = isArray(object);
      if (accumulator == null) {
        if (isArr) {
          accumulator = [];
        } else {
          var ctor = object && object.constructor,
              proto = ctor && ctor.prototype;

          accumulator = baseCreate(proto);
        }
      }
      if (callback) {
        callback = lodash.createCallback(callback, thisArg, 4);
        (isArr ? forEach : forOwn)(object, function(value, index, object) {
          return callback(accumulator, value, index, object);
        });
      }
      return accumulator;
    }

    /**
     * Creates an array composed of the own enumerable property values of `object`.
     *
     * @static
     * @memberOf _
     * @category Objects
     * @param {Object} object The object to inspect.
     * @returns {Array} Returns an array of property values.
     * @example
     *
     * _.values({ 'one': 1, 'two': 2, 'three': 3 });
     * // => [1, 2, 3] (property order is not guaranteed across environments)
     */
    function values(object) {
      var index = -1,
          props = keys(object),
          length = props.length,
          result = Array(length);

      while (++index < length) {
        result[index] = object[props[index]];
      }
      return result;
    }

    /*--------------------------------------------------------------------------*/

    /**
     * Creates an array of elements from the specified indexes, or keys, of the
     * `collection`. Indexes may be specified as individual arguments or as arrays
     * of indexes.
     *
     * @static
     * @memberOf _
     * @category Collections
     * @param {Array|Object|string} collection The collection to iterate over.
     * @param {...(number|number[]|string|string[])} [index] The indexes of `collection`
     *   to retrieve, specified as individual indexes or arrays of indexes.
     * @returns {Array} Returns a new array of elements corresponding to the
     *  provided indexes.
     * @example
     *
     * _.at(['a', 'b', 'c', 'd', 'e'], [0, 2, 4]);
     * // => ['a', 'c', 'e']
     *
     * _.at(['fred', 'barney', 'pebbles'], 0, 2);
     * // => ['fred', 'pebbles']
     */
    function at(collection) {
      var args = arguments,
          index = -1,
          props = baseFlatten(args, true, false, 1),
          length = (args[2] && args[2][args[1]] === collection) ? 1 : props.length,
          result = Array(length);

      while(++index < length) {
        result[index] = collection[props[index]];
      }
      return result;
    }

    /**
     * Checks if a given value is present in a collection using strict equality
     * for comparisons, i.e. `===`. If `fromIndex` is negative, it is used as the
     * offset from the end of the collection.
     *
     * @static
     * @memberOf _
     * @alias include
     * @category Collections
     * @param {Array|Object|string} collection The collection to iterate over.
     * @param {*} target The value to check for.
     * @param {number} [fromIndex=0] The index to search from.
     * @returns {boolean} Returns `true` if the `target` element is found, else `false`.
     * @example
     *
     * _.contains([1, 2, 3], 1);
     * // => true
     *
     * _.contains([1, 2, 3], 1, 2);
     * // => false
     *
     * _.contains({ 'name': 'fred', 'age': 40 }, 'fred');
     * // => true
     *
     * _.contains('pebbles', 'eb');
     * // => true
     */
    function contains(collection, target, fromIndex) {
      var index = -1,
          indexOf = getIndexOf(),
          length = collection ? collection.length : 0,
          result = false;

      fromIndex = (fromIndex < 0 ? nativeMax(0, length + fromIndex) : fromIndex) || 0;
      if (isArray(collection)) {
        result = indexOf(collection, target, fromIndex) > -1;
      } else if (typeof length == 'number') {
        result = (isString(collection) ? collection.indexOf(target, fromIndex) : indexOf(collection, target, fromIndex)) > -1;
      } else {
        forOwn(collection, function(value) {
          if (++index >= fromIndex) {
            return !(result = value === target);
          }
        });
      }
      return result;
    }

    /**
     * Creates an object composed of keys generated from the results of running
     * each element of `collection` through the callback. The corresponding value
     * of each key is the number of times the key was returned by the callback.
     * The callback is bound to `thisArg` and invoked with three arguments;
     * (value, index|key, collection).
     *
     * If a property name is provided for `callback` the created "_.pluck" style
     * callback will return the property value of the given element.
     *
     * If an object is provided for `callback` the created "_.where" style callback
     * will return `true` for elements that have the properties of the given object,
     * else `false`.
     *
     * @static
     * @memberOf _
     * @category Collections
     * @param {Array|Object|string} collection The collection to iterate over.
     * @param {Function|Object|string} [callback=identity] The function called
     *  per iteration. If a property name or object is provided it will be used
     *  to create a "_.pluck" or "_.where" style callback, respectively.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {Object} Returns the composed aggregate object.
     * @example
     *
     * _.countBy([4.3, 6.1, 6.4], function(num) { return Math.floor(num); });
     * // => { '4': 1, '6': 2 }
     *
     * _.countBy([4.3, 6.1, 6.4], function(num) { return this.floor(num); }, Math);
     * // => { '4': 1, '6': 2 }
     *
     * _.countBy(['one', 'two', 'three'], 'length');
     * // => { '3': 2, '5': 1 }
     */
    var countBy = createAggregator(function(result, value, key) {
      (hasOwnProperty.call(result, key) ? result[key]++ : result[key] = 1);
    });

    /**
     * Checks if the given callback returns truey value for **all** elements of
     * a collection. The callback is bound to `thisArg` and invoked with three
     * arguments; (value, index|key, collection).
     *
     * If a property name is provided for `callback` the created "_.pluck" style
     * callback will return the property value of the given element.
     *
     * If an object is provided for `callback` the created "_.where" style callback
     * will return `true` for elements that have the properties of the given object,
     * else `false`.
     *
     * @static
     * @memberOf _
     * @alias all
     * @category Collections
     * @param {Array|Object|string} collection The collection to iterate over.
     * @param {Function|Object|string} [callback=identity] The function called
     *  per iteration. If a property name or object is provided it will be used
     *  to create a "_.pluck" or "_.where" style callback, respectively.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {boolean} Returns `true` if all elements passed the callback check,
     *  else `false`.
     * @example
     *
     * _.every([true, 1, null, 'yes']);
     * // => false
     *
     * var characters = [
     *   { 'name': 'barney', 'age': 36 },
     *   { 'name': 'fred',   'age': 40 }
     * ];
     *
     * // using "_.pluck" callback shorthand
     * _.every(characters, 'age');
     * // => true
     *
     * // using "_.where" callback shorthand
     * _.every(characters, { 'age': 36 });
     * // => false
     */
    function every(collection, callback, thisArg) {
      var result = true;
      callback = lodash.createCallback(callback, thisArg, 3);

      var index = -1,
          length = collection ? collection.length : 0;

      if (typeof length == 'number') {
        while (++index < length) {
          if (!(result = !!callback(collection[index], index, collection))) {
            break;
          }
        }
      } else {
        forOwn(collection, function(value, index, collection) {
          return (result = !!callback(value, index, collection));
        });
      }
      return result;
    }

    /**
     * Iterates over elements of a collection, returning an array of all elements
     * the callback returns truey for. The callback is bound to `thisArg` and
     * invoked with three arguments; (value, index|key, collection).
     *
     * If a property name is provided for `callback` the created "_.pluck" style
     * callback will return the property value of the given element.
     *
     * If an object is provided for `callback` the created "_.where" style callback
     * will return `true` for elements that have the properties of the given object,
     * else `false`.
     *
     * @static
     * @memberOf _
     * @alias select
     * @category Collections
     * @param {Array|Object|string} collection The collection to iterate over.
     * @param {Function|Object|string} [callback=identity] The function called
     *  per iteration. If a property name or object is provided it will be used
     *  to create a "_.pluck" or "_.where" style callback, respectively.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {Array} Returns a new array of elements that passed the callback check.
     * @example
     *
     * var evens = _.filter([1, 2, 3, 4, 5, 6], function(num) { return num % 2 == 0; });
     * // => [2, 4, 6]
     *
     * var characters = [
     *   { 'name': 'barney', 'age': 36, 'blocked': false },
     *   { 'name': 'fred',   'age': 40, 'blocked': true }
     * ];
     *
     * // using "_.pluck" callback shorthand
     * _.filter(characters, 'blocked');
     * // => [{ 'name': 'fred', 'age': 40, 'blocked': true }]
     *
     * // using "_.where" callback shorthand
     * _.filter(characters, { 'age': 36 });
     * // => [{ 'name': 'barney', 'age': 36, 'blocked': false }]
     */
    function filter(collection, callback, thisArg) {
      var result = [];
      callback = lodash.createCallback(callback, thisArg, 3);

      var index = -1,
          length = collection ? collection.length : 0;

      if (typeof length == 'number') {
        while (++index < length) {
          var value = collection[index];
          if (callback(value, index, collection)) {
            result.push(value);
          }
        }
      } else {
        forOwn(collection, function(value, index, collection) {
          if (callback(value, index, collection)) {
            result.push(value);
          }
        });
      }
      return result;
    }

    /**
     * Iterates over elements of a collection, returning the first element that
     * the callback returns truey for. The callback is bound to `thisArg` and
     * invoked with three arguments; (value, index|key, collection).
     *
     * If a property name is provided for `callback` the created "_.pluck" style
     * callback will return the property value of the given element.
     *
     * If an object is provided for `callback` the created "_.where" style callback
     * will return `true` for elements that have the properties of the given object,
     * else `false`.
     *
     * @static
     * @memberOf _
     * @alias detect, findWhere
     * @category Collections
     * @param {Array|Object|string} collection The collection to iterate over.
     * @param {Function|Object|string} [callback=identity] The function called
     *  per iteration. If a property name or object is provided it will be used
     *  to create a "_.pluck" or "_.where" style callback, respectively.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {*} Returns the found element, else `undefined`.
     * @example
     *
     * var characters = [
     *   { 'name': 'barney',  'age': 36, 'blocked': false },
     *   { 'name': 'fred',    'age': 40, 'blocked': true },
     *   { 'name': 'pebbles', 'age': 1,  'blocked': false }
     * ];
     *
     * _.find(characters, function(chr) {
     *   return chr.age < 40;
     * });
     * // => { 'name': 'barney', 'age': 36, 'blocked': false }
     *
     * // using "_.where" callback shorthand
     * _.find(characters, { 'age': 1 });
     * // =>  { 'name': 'pebbles', 'age': 1, 'blocked': false }
     *
     * // using "_.pluck" callback shorthand
     * _.find(characters, 'blocked');
     * // => { 'name': 'fred', 'age': 40, 'blocked': true }
     */
    function find(collection, callback, thisArg) {
      callback = lodash.createCallback(callback, thisArg, 3);

      var index = -1,
          length = collection ? collection.length : 0;

      if (typeof length == 'number') {
        while (++index < length) {
          var value = collection[index];
          if (callback(value, index, collection)) {
            return value;
          }
        }
      } else {
        var result;
        forOwn(collection, function(value, index, collection) {
          if (callback(value, index, collection)) {
            result = value;
            return false;
          }
        });
        return result;
      }
    }

    /**
     * This method is like `_.find` except that it iterates over elements
     * of a `collection` from right to left.
     *
     * @static
     * @memberOf _
     * @category Collections
     * @param {Array|Object|string} collection The collection to iterate over.
     * @param {Function|Object|string} [callback=identity] The function called
     *  per iteration. If a property name or object is provided it will be used
     *  to create a "_.pluck" or "_.where" style callback, respectively.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {*} Returns the found element, else `undefined`.
     * @example
     *
     * _.findLast([1, 2, 3, 4], function(num) {
     *   return num % 2 == 1;
     * });
     * // => 3
     */
    function findLast(collection, callback, thisArg) {
      var result;
      callback = lodash.createCallback(callback, thisArg, 3);
      forEachRight(collection, function(value, index, collection) {
        if (callback(value, index, collection)) {
          result = value;
          return false;
        }
      });
      return result;
    }

    /**
     * Iterates over elements of a collection, executing the callback for each
     * element. The callback is bound to `thisArg` and invoked with three arguments;
     * (value, index|key, collection). Callbacks may exit iteration early by
     * explicitly returning `false`.
     *
     * Note: As with other "Collections" methods, objects with a `length` property
     * are iterated like arrays. To avoid this behavior `_.forIn` or `_.forOwn`
     * may be used for object iteration.
     *
     * @static
     * @memberOf _
     * @alias each
     * @category Collections
     * @param {Array|Object|string} collection The collection to iterate over.
     * @param {Function} [callback=identity] The function called per iteration.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {Array|Object|string} Returns `collection`.
     * @example
     *
     * _([1, 2, 3]).forEach(function(num) { console.log(num); }).join(',');
     * // => logs each number and returns '1,2,3'
     *
     * _.forEach({ 'one': 1, 'two': 2, 'three': 3 }, function(num) { console.log(num); });
     * // => logs each number and returns the object (property order is not guaranteed across environments)
     */
    function forEach(collection, callback, thisArg) {
      var index = -1,
          length = collection ? collection.length : 0;

      callback = callback && typeof thisArg == 'undefined' ? callback : baseCreateCallback(callback, thisArg, 3);
      if (typeof length == 'number') {
        while (++index < length) {
          if (callback(collection[index], index, collection) === false) {
            break;
          }
        }
      } else {
        forOwn(collection, callback);
      }
      return collection;
    }

    /**
     * This method is like `_.forEach` except that it iterates over elements
     * of a `collection` from right to left.
     *
     * @static
     * @memberOf _
     * @alias eachRight
     * @category Collections
     * @param {Array|Object|string} collection The collection to iterate over.
     * @param {Function} [callback=identity] The function called per iteration.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {Array|Object|string} Returns `collection`.
     * @example
     *
     * _([1, 2, 3]).forEachRight(function(num) { console.log(num); }).join(',');
     * // => logs each number from right to left and returns '3,2,1'
     */
    function forEachRight(collection, callback, thisArg) {
      var length = collection ? collection.length : 0;
      callback = callback && typeof thisArg == 'undefined' ? callback : baseCreateCallback(callback, thisArg, 3);
      if (typeof length == 'number') {
        while (length--) {
          if (callback(collection[length], length, collection) === false) {
            break;
          }
        }
      } else {
        var props = keys(collection);
        length = props.length;
        forOwn(collection, function(value, key, collection) {
          key = props ? props[--length] : --length;
          return callback(collection[key], key, collection);
        });
      }
      return collection;
    }

    /**
     * Creates an object composed of keys generated from the results of running
     * each element of a collection through the callback. The corresponding value
     * of each key is an array of the elements responsible for generating the key.
     * The callback is bound to `thisArg` and invoked with three arguments;
     * (value, index|key, collection).
     *
     * If a property name is provided for `callback` the created "_.pluck" style
     * callback will return the property value of the given element.
     *
     * If an object is provided for `callback` the created "_.where" style callback
     * will return `true` for elements that have the properties of the given object,
     * else `false`
     *
     * @static
     * @memberOf _
     * @category Collections
     * @param {Array|Object|string} collection The collection to iterate over.
     * @param {Function|Object|string} [callback=identity] The function called
     *  per iteration. If a property name or object is provided it will be used
     *  to create a "_.pluck" or "_.where" style callback, respectively.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {Object} Returns the composed aggregate object.
     * @example
     *
     * _.groupBy([4.2, 6.1, 6.4], function(num) { return Math.floor(num); });
     * // => { '4': [4.2], '6': [6.1, 6.4] }
     *
     * _.groupBy([4.2, 6.1, 6.4], function(num) { return this.floor(num); }, Math);
     * // => { '4': [4.2], '6': [6.1, 6.4] }
     *
     * // using "_.pluck" callback shorthand
     * _.groupBy(['one', 'two', 'three'], 'length');
     * // => { '3': ['one', 'two'], '5': ['three'] }
     */
    var groupBy = createAggregator(function(result, value, key) {
      (hasOwnProperty.call(result, key) ? result[key] : result[key] = []).push(value);
    });

    /**
     * Creates an object composed of keys generated from the results of running
     * each element of the collection through the given callback. The corresponding
     * value of each key is the last element responsible for generating the key.
     * The callback is bound to `thisArg` and invoked with three arguments;
     * (value, index|key, collection).
     *
     * If a property name is provided for `callback` the created "_.pluck" style
     * callback will return the property value of the given element.
     *
     * If an object is provided for `callback` the created "_.where" style callback
     * will return `true` for elements that have the properties of the given object,
     * else `false`.
     *
     * @static
     * @memberOf _
     * @category Collections
     * @param {Array|Object|string} collection The collection to iterate over.
     * @param {Function|Object|string} [callback=identity] The function called
     *  per iteration. If a property name or object is provided it will be used
     *  to create a "_.pluck" or "_.where" style callback, respectively.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {Object} Returns the composed aggregate object.
     * @example
     *
     * var keys = [
     *   { 'dir': 'left', 'code': 97 },
     *   { 'dir': 'right', 'code': 100 }
     * ];
     *
     * _.indexBy(keys, 'dir');
     * // => { 'left': { 'dir': 'left', 'code': 97 }, 'right': { 'dir': 'right', 'code': 100 } }
     *
     * _.indexBy(keys, function(key) { return String.fromCharCode(key.code); });
     * // => { 'a': { 'dir': 'left', 'code': 97 }, 'd': { 'dir': 'right', 'code': 100 } }
     *
     * _.indexBy(characters, function(key) { this.fromCharCode(key.code); }, String);
     * // => { 'a': { 'dir': 'left', 'code': 97 }, 'd': { 'dir': 'right', 'code': 100 } }
     */
    var indexBy = createAggregator(function(result, value, key) {
      result[key] = value;
    });

    /**
     * Invokes the method named by `methodName` on each element in the `collection`
     * returning an array of the results of each invoked method. Additional arguments
     * will be provided to each invoked method. If `methodName` is a function it
     * will be invoked for, and `this` bound to, each element in the `collection`.
     *
     * @static
     * @memberOf _
     * @category Collections
     * @param {Array|Object|string} collection The collection to iterate over.
     * @param {Function|string} methodName The name of the method to invoke or
     *  the function invoked per iteration.
     * @param {...*} [arg] Arguments to invoke the method with.
     * @returns {Array} Returns a new array of the results of each invoked method.
     * @example
     *
     * _.invoke([[5, 1, 7], [3, 2, 1]], 'sort');
     * // => [[1, 5, 7], [1, 2, 3]]
     *
     * _.invoke([123, 456], String.prototype.split, '');
     * // => [['1', '2', '3'], ['4', '5', '6']]
     */
    function invoke(collection, methodName) {
      var args = slice(arguments, 2),
          index = -1,
          isFunc = typeof methodName == 'function',
          length = collection ? collection.length : 0,
          result = Array(typeof length == 'number' ? length : 0);

      forEach(collection, function(value) {
        result[++index] = (isFunc ? methodName : value[methodName]).apply(value, args);
      });
      return result;
    }

    /**
     * Creates an array of values by running each element in the collection
     * through the callback. The callback is bound to `thisArg` and invoked with
     * three arguments; (value, index|key, collection).
     *
     * If a property name is provided for `callback` the created "_.pluck" style
     * callback will return the property value of the given element.
     *
     * If an object is provided for `callback` the created "_.where" style callback
     * will return `true` for elements that have the properties of the given object,
     * else `false`.
     *
     * @static
     * @memberOf _
     * @alias collect
     * @category Collections
     * @param {Array|Object|string} collection The collection to iterate over.
     * @param {Function|Object|string} [callback=identity] The function called
     *  per iteration. If a property name or object is provided it will be used
     *  to create a "_.pluck" or "_.where" style callback, respectively.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {Array} Returns a new array of the results of each `callback` execution.
     * @example
     *
     * _.map([1, 2, 3], function(num) { return num * 3; });
     * // => [3, 6, 9]
     *
     * _.map({ 'one': 1, 'two': 2, 'three': 3 }, function(num) { return num * 3; });
     * // => [3, 6, 9] (property order is not guaranteed across environments)
     *
     * var characters = [
     *   { 'name': 'barney', 'age': 36 },
     *   { 'name': 'fred',   'age': 40 }
     * ];
     *
     * // using "_.pluck" callback shorthand
     * _.map(characters, 'name');
     * // => ['barney', 'fred']
     */
    function map(collection, callback, thisArg) {
      var index = -1,
          length = collection ? collection.length : 0;

      callback = lodash.createCallback(callback, thisArg, 3);
      if (typeof length == 'number') {
        var result = Array(length);
        while (++index < length) {
          result[index] = callback(collection[index], index, collection);
        }
      } else {
        result = [];
        forOwn(collection, function(value, key, collection) {
          result[++index] = callback(value, key, collection);
        });
      }
      return result;
    }

    /**
     * Retrieves the maximum value of a collection. If the collection is empty or
     * falsey `-Infinity` is returned. If a callback is provided it will be executed
     * for each value in the collection to generate the criterion by which the value
     * is ranked. The callback is bound to `thisArg` and invoked with three
     * arguments; (value, index, collection).
     *
     * If a property name is provided for `callback` the created "_.pluck" style
     * callback will return the property value of the given element.
     *
     * If an object is provided for `callback` the created "_.where" style callback
     * will return `true` for elements that have the properties of the given object,
     * else `false`.
     *
     * @static
     * @memberOf _
     * @category Collections
     * @param {Array|Object|string} collection The collection to iterate over.
     * @param {Function|Object|string} [callback=identity] The function called
     *  per iteration. If a property name or object is provided it will be used
     *  to create a "_.pluck" or "_.where" style callback, respectively.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {*} Returns the maximum value.
     * @example
     *
     * _.max([4, 2, 8, 6]);
     * // => 8
     *
     * var characters = [
     *   { 'name': 'barney', 'age': 36 },
     *   { 'name': 'fred',   'age': 40 }
     * ];
     *
     * _.max(characters, function(chr) { return chr.age; });
     * // => { 'name': 'fred', 'age': 40 };
     *
     * // using "_.pluck" callback shorthand
     * _.max(characters, 'age');
     * // => { 'name': 'fred', 'age': 40 };
     */
    function max(collection, callback, thisArg) {
      var computed = -Infinity,
          result = computed;

      // allows working with functions like `_.map` without using
      // their `index` argument as a callback
      if (typeof callback != 'function' && thisArg && thisArg[callback] === collection) {
        callback = null;
      }
      if (callback == null && isArray(collection)) {
        var index = -1,
            length = collection.length;

        while (++index < length) {
          var value = collection[index];
          if (value > result) {
            result = value;
          }
        }
      } else {
        callback = (callback == null && isString(collection))
          ? charAtCallback
          : lodash.createCallback(callback, thisArg, 3);

        forEach(collection, function(value, index, collection) {
          var current = callback(value, index, collection);
          if (current > computed) {
            computed = current;
            result = value;
          }
        });
      }
      return result;
    }

    /**
     * Retrieves the minimum value of a collection. If the collection is empty or
     * falsey `Infinity` is returned. If a callback is provided it will be executed
     * for each value in the collection to generate the criterion by which the value
     * is ranked. The callback is bound to `thisArg` and invoked with three
     * arguments; (value, index, collection).
     *
     * If a property name is provided for `callback` the created "_.pluck" style
     * callback will return the property value of the given element.
     *
     * If an object is provided for `callback` the created "_.where" style callback
     * will return `true` for elements that have the properties of the given object,
     * else `false`.
     *
     * @static
     * @memberOf _
     * @category Collections
     * @param {Array|Object|string} collection The collection to iterate over.
     * @param {Function|Object|string} [callback=identity] The function called
     *  per iteration. If a property name or object is provided it will be used
     *  to create a "_.pluck" or "_.where" style callback, respectively.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {*} Returns the minimum value.
     * @example
     *
     * _.min([4, 2, 8, 6]);
     * // => 2
     *
     * var characters = [
     *   { 'name': 'barney', 'age': 36 },
     *   { 'name': 'fred',   'age': 40 }
     * ];
     *
     * _.min(characters, function(chr) { return chr.age; });
     * // => { 'name': 'barney', 'age': 36 };
     *
     * // using "_.pluck" callback shorthand
     * _.min(characters, 'age');
     * // => { 'name': 'barney', 'age': 36 };
     */
    function min(collection, callback, thisArg) {
      var computed = Infinity,
          result = computed;

      // allows working with functions like `_.map` without using
      // their `index` argument as a callback
      if (typeof callback != 'function' && thisArg && thisArg[callback] === collection) {
        callback = null;
      }
      if (callback == null && isArray(collection)) {
        var index = -1,
            length = collection.length;

        while (++index < length) {
          var value = collection[index];
          if (value < result) {
            result = value;
          }
        }
      } else {
        callback = (callback == null && isString(collection))
          ? charAtCallback
          : lodash.createCallback(callback, thisArg, 3);

        forEach(collection, function(value, index, collection) {
          var current = callback(value, index, collection);
          if (current < computed) {
            computed = current;
            result = value;
          }
        });
      }
      return result;
    }

    /**
     * Retrieves the value of a specified property from all elements in the collection.
     *
     * @static
     * @memberOf _
     * @type Function
     * @category Collections
     * @param {Array|Object|string} collection The collection to iterate over.
     * @param {string} property The name of the property to pluck.
     * @returns {Array} Returns a new array of property values.
     * @example
     *
     * var characters = [
     *   { 'name': 'barney', 'age': 36 },
     *   { 'name': 'fred',   'age': 40 }
     * ];
     *
     * _.pluck(characters, 'name');
     * // => ['barney', 'fred']
     */
    var pluck = map;

    /**
     * Reduces a collection to a value which is the accumulated result of running
     * each element in the collection through the callback, where each successive
     * callback execution consumes the return value of the previous execution. If
     * `accumulator` is not provided the first element of the collection will be
     * used as the initial `accumulator` value. The callback is bound to `thisArg`
     * and invoked with four arguments; (accumulator, value, index|key, collection).
     *
     * @static
     * @memberOf _
     * @alias foldl, inject
     * @category Collections
     * @param {Array|Object|string} collection The collection to iterate over.
     * @param {Function} [callback=identity] The function called per iteration.
     * @param {*} [accumulator] Initial value of the accumulator.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {*} Returns the accumulated value.
     * @example
     *
     * var sum = _.reduce([1, 2, 3], function(sum, num) {
     *   return sum + num;
     * });
     * // => 6
     *
     * var mapped = _.reduce({ 'a': 1, 'b': 2, 'c': 3 }, function(result, num, key) {
     *   result[key] = num * 3;
     *   return result;
     * }, {});
     * // => { 'a': 3, 'b': 6, 'c': 9 }
     */
    function reduce(collection, callback, accumulator, thisArg) {
      if (!collection) return accumulator;
      var noaccum = arguments.length < 3;
      callback = lodash.createCallback(callback, thisArg, 4);

      var index = -1,
          length = collection.length;

      if (typeof length == 'number') {
        if (noaccum) {
          accumulator = collection[++index];
        }
        while (++index < length) {
          accumulator = callback(accumulator, collection[index], index, collection);
        }
      } else {
        forOwn(collection, function(value, index, collection) {
          accumulator = noaccum
            ? (noaccum = false, value)
            : callback(accumulator, value, index, collection)
        });
      }
      return accumulator;
    }

    /**
     * This method is like `_.reduce` except that it iterates over elements
     * of a `collection` from right to left.
     *
     * @static
     * @memberOf _
     * @alias foldr
     * @category Collections
     * @param {Array|Object|string} collection The collection to iterate over.
     * @param {Function} [callback=identity] The function called per iteration.
     * @param {*} [accumulator] Initial value of the accumulator.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {*} Returns the accumulated value.
     * @example
     *
     * var list = [[0, 1], [2, 3], [4, 5]];
     * var flat = _.reduceRight(list, function(a, b) { return a.concat(b); }, []);
     * // => [4, 5, 2, 3, 0, 1]
     */
    function reduceRight(collection, callback, accumulator, thisArg) {
      var noaccum = arguments.length < 3;
      callback = lodash.createCallback(callback, thisArg, 4);
      forEachRight(collection, function(value, index, collection) {
        accumulator = noaccum
          ? (noaccum = false, value)
          : callback(accumulator, value, index, collection);
      });
      return accumulator;
    }

    /**
     * The opposite of `_.filter` this method returns the elements of a
     * collection that the callback does **not** return truey for.
     *
     * If a property name is provided for `callback` the created "_.pluck" style
     * callback will return the property value of the given element.
     *
     * If an object is provided for `callback` the created "_.where" style callback
     * will return `true` for elements that have the properties of the given object,
     * else `false`.
     *
     * @static
     * @memberOf _
     * @category Collections
     * @param {Array|Object|string} collection The collection to iterate over.
     * @param {Function|Object|string} [callback=identity] The function called
     *  per iteration. If a property name or object is provided it will be used
     *  to create a "_.pluck" or "_.where" style callback, respectively.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {Array} Returns a new array of elements that failed the callback check.
     * @example
     *
     * var odds = _.reject([1, 2, 3, 4, 5, 6], function(num) { return num % 2 == 0; });
     * // => [1, 3, 5]
     *
     * var characters = [
     *   { 'name': 'barney', 'age': 36, 'blocked': false },
     *   { 'name': 'fred',   'age': 40, 'blocked': true }
     * ];
     *
     * // using "_.pluck" callback shorthand
     * _.reject(characters, 'blocked');
     * // => [{ 'name': 'barney', 'age': 36, 'blocked': false }]
     *
     * // using "_.where" callback shorthand
     * _.reject(characters, { 'age': 36 });
     * // => [{ 'name': 'fred', 'age': 40, 'blocked': true }]
     */
    function reject(collection, callback, thisArg) {
      callback = lodash.createCallback(callback, thisArg, 3);
      return filter(collection, function(value, index, collection) {
        return !callback(value, index, collection);
      });
    }

    /**
     * Retrieves a random element or `n` random elements from a collection.
     *
     * @static
     * @memberOf _
     * @category Collections
     * @param {Array|Object|string} collection The collection to sample.
     * @param {number} [n] The number of elements to sample.
     * @param- {Object} [guard] Allows working with functions like `_.map`
     *  without using their `index` arguments as `n`.
     * @returns {Array} Returns the random sample(s) of `collection`.
     * @example
     *
     * _.sample([1, 2, 3, 4]);
     * // => 2
     *
     * _.sample([1, 2, 3, 4], 2);
     * // => [3, 1]
     */
    function sample(collection, n, guard) {
      if (collection && typeof collection.length != 'number') {
        collection = values(collection);
      }
      if (n == null || guard) {
        return collection ? collection[baseRandom(0, collection.length - 1)] : undefined;
      }
      var result = shuffle(collection);
      result.length = nativeMin(nativeMax(0, n), result.length);
      return result;
    }

    /**
     * Creates an array of shuffled values, using a version of the Fisher-Yates
     * shuffle. See http://en.wikipedia.org/wiki/Fisher-Yates_shuffle.
     *
     * @static
     * @memberOf _
     * @category Collections
     * @param {Array|Object|string} collection The collection to shuffle.
     * @returns {Array} Returns a new shuffled collection.
     * @example
     *
     * _.shuffle([1, 2, 3, 4, 5, 6]);
     * // => [4, 1, 6, 3, 5, 2]
     */
    function shuffle(collection) {
      var index = -1,
          length = collection ? collection.length : 0,
          result = Array(typeof length == 'number' ? length : 0);

      forEach(collection, function(value) {
        var rand = baseRandom(0, ++index);
        result[index] = result[rand];
        result[rand] = value;
      });
      return result;
    }

    /**
     * Gets the size of the `collection` by returning `collection.length` for arrays
     * and array-like objects or the number of own enumerable properties for objects.
     *
     * @static
     * @memberOf _
     * @category Collections
     * @param {Array|Object|string} collection The collection to inspect.
     * @returns {number} Returns `collection.length` or number of own enumerable properties.
     * @example
     *
     * _.size([1, 2]);
     * // => 2
     *
     * _.size({ 'one': 1, 'two': 2, 'three': 3 });
     * // => 3
     *
     * _.size('pebbles');
     * // => 7
     */
    function size(collection) {
      var length = collection ? collection.length : 0;
      return typeof length == 'number' ? length : keys(collection).length;
    }

    /**
     * Checks if the callback returns a truey value for **any** element of a
     * collection. The function returns as soon as it finds a passing value and
     * does not iterate over the entire collection. The callback is bound to
     * `thisArg` and invoked with three arguments; (value, index|key, collection).
     *
     * If a property name is provided for `callback` the created "_.pluck" style
     * callback will return the property value of the given element.
     *
     * If an object is provided for `callback` the created "_.where" style callback
     * will return `true` for elements that have the properties of the given object,
     * else `false`.
     *
     * @static
     * @memberOf _
     * @alias any
     * @category Collections
     * @param {Array|Object|string} collection The collection to iterate over.
     * @param {Function|Object|string} [callback=identity] The function called
     *  per iteration. If a property name or object is provided it will be used
     *  to create a "_.pluck" or "_.where" style callback, respectively.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {boolean} Returns `true` if any element passed the callback check,
     *  else `false`.
     * @example
     *
     * _.some([null, 0, 'yes', false], Boolean);
     * // => true
     *
     * var characters = [
     *   { 'name': 'barney', 'age': 36, 'blocked': false },
     *   { 'name': 'fred',   'age': 40, 'blocked': true }
     * ];
     *
     * // using "_.pluck" callback shorthand
     * _.some(characters, 'blocked');
     * // => true
     *
     * // using "_.where" callback shorthand
     * _.some(characters, { 'age': 1 });
     * // => false
     */
    function some(collection, callback, thisArg) {
      var result;
      callback = lodash.createCallback(callback, thisArg, 3);

      var index = -1,
          length = collection ? collection.length : 0;

      if (typeof length == 'number') {
        while (++index < length) {
          if ((result = callback(collection[index], index, collection))) {
            break;
          }
        }
      } else {
        forOwn(collection, function(value, index, collection) {
          return !(result = callback(value, index, collection));
        });
      }
      return !!result;
    }

    /**
     * Creates an array of elements, sorted in ascending order by the results of
     * running each element in a collection through the callback. This method
     * performs a stable sort, that is, it will preserve the original sort order
     * of equal elements. The callback is bound to `thisArg` and invoked with
     * three arguments; (value, index|key, collection).
     *
     * If a property name is provided for `callback` the created "_.pluck" style
     * callback will return the property value of the given element.
     *
     * If an array of property names is provided for `callback` the collection
     * will be sorted by each property value.
     *
     * If an object is provided for `callback` the created "_.where" style callback
     * will return `true` for elements that have the properties of the given object,
     * else `false`.
     *
     * @static
     * @memberOf _
     * @category Collections
     * @param {Array|Object|string} collection The collection to iterate over.
     * @param {Array|Function|Object|string} [callback=identity] The function called
     *  per iteration. If a property name or object is provided it will be used
     *  to create a "_.pluck" or "_.where" style callback, respectively.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {Array} Returns a new array of sorted elements.
     * @example
     *
     * _.sortBy([1, 2, 3], function(num) { return Math.sin(num); });
     * // => [3, 1, 2]
     *
     * _.sortBy([1, 2, 3], function(num) { return this.sin(num); }, Math);
     * // => [3, 1, 2]
     *
     * var characters = [
     *   { 'name': 'barney',  'age': 36 },
     *   { 'name': 'fred',    'age': 40 },
     *   { 'name': 'barney',  'age': 26 },
     *   { 'name': 'fred',    'age': 30 }
     * ];
     *
     * // using "_.pluck" callback shorthand
     * _.map(_.sortBy(characters, 'age'), _.values);
     * // => [['barney', 26], ['fred', 30], ['barney', 36], ['fred', 40]]
     *
     * // sorting by multiple properties
     * _.map(_.sortBy(characters, ['name', 'age']), _.values);
     * // = > [['barney', 26], ['barney', 36], ['fred', 30], ['fred', 40]]
     */
    function sortBy(collection, callback, thisArg) {
      var index = -1,
          isArr = isArray(callback),
          length = collection ? collection.length : 0,
          result = Array(typeof length == 'number' ? length : 0);

      if (!isArr) {
        callback = lodash.createCallback(callback, thisArg, 3);
      }
      forEach(collection, function(value, key, collection) {
        var object = result[++index] = getObject();
        if (isArr) {
          object.criteria = map(callback, function(key) { return value[key]; });
        } else {
          (object.criteria = getArray())[0] = callback(value, key, collection);
        }
        object.index = index;
        object.value = value;
      });

      length = result.length;
      result.sort(compareAscending);
      while (length--) {
        var object = result[length];
        result[length] = object.value;
        if (!isArr) {
          releaseArray(object.criteria);
        }
        releaseObject(object);
      }
      return result;
    }

    /**
     * Converts the `collection` to an array.
     *
     * @static
     * @memberOf _
     * @category Collections
     * @param {Array|Object|string} collection The collection to convert.
     * @returns {Array} Returns the new converted array.
     * @example
     *
     * (function() { return _.toArray(arguments).slice(1); })(1, 2, 3, 4);
     * // => [2, 3, 4]
     */
    function toArray(collection) {
      if (collection && typeof collection.length == 'number') {
        return slice(collection);
      }
      return values(collection);
    }

    /**
     * Performs a deep comparison of each element in a `collection` to the given
     * `properties` object, returning an array of all elements that have equivalent
     * property values.
     *
     * @static
     * @memberOf _
     * @type Function
     * @category Collections
     * @param {Array|Object|string} collection The collection to iterate over.
     * @param {Object} props The object of property values to filter by.
     * @returns {Array} Returns a new array of elements that have the given properties.
     * @example
     *
     * var characters = [
     *   { 'name': 'barney', 'age': 36, 'pets': ['hoppy'] },
     *   { 'name': 'fred',   'age': 40, 'pets': ['baby puss', 'dino'] }
     * ];
     *
     * _.where(characters, { 'age': 36 });
     * // => [{ 'name': 'barney', 'age': 36, 'pets': ['hoppy'] }]
     *
     * _.where(characters, { 'pets': ['dino'] });
     * // => [{ 'name': 'fred', 'age': 40, 'pets': ['baby puss', 'dino'] }]
     */
    var where = filter;

    /*--------------------------------------------------------------------------*/

    /**
     * Creates an array with all falsey values removed. The values `false`, `null`,
     * `0`, `""`, `undefined`, and `NaN` are all falsey.
     *
     * @static
     * @memberOf _
     * @category Arrays
     * @param {Array} array The array to compact.
     * @returns {Array} Returns a new array of filtered values.
     * @example
     *
     * _.compact([0, 1, false, 2, '', 3]);
     * // => [1, 2, 3]
     */
    function compact(array) {
      var index = -1,
          length = array ? array.length : 0,
          result = [];

      while (++index < length) {
        var value = array[index];
        if (value) {
          result.push(value);
        }
      }
      return result;
    }

    /**
     * Creates an array excluding all values of the provided arrays using strict
     * equality for comparisons, i.e. `===`.
     *
     * @static
     * @memberOf _
     * @category Arrays
     * @param {Array} array The array to process.
     * @param {...Array} [values] The arrays of values to exclude.
     * @returns {Array} Returns a new array of filtered values.
     * @example
     *
     * _.difference([1, 2, 3, 4, 5], [5, 2, 10]);
     * // => [1, 3, 4]
     */
    function difference(array) {
      return baseDifference(array, baseFlatten(arguments, true, true, 1));
    }

    /**
     * This method is like `_.find` except that it returns the index of the first
     * element that passes the callback check, instead of the element itself.
     *
     * If a property name is provided for `callback` the created "_.pluck" style
     * callback will return the property value of the given element.
     *
     * If an object is provided for `callback` the created "_.where" style callback
     * will return `true` for elements that have the properties of the given object,
     * else `false`.
     *
     * @static
     * @memberOf _
     * @category Arrays
     * @param {Array} array The array to search.
     * @param {Function|Object|string} [callback=identity] The function called
     *  per iteration. If a property name or object is provided it will be used
     *  to create a "_.pluck" or "_.where" style callback, respectively.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {number} Returns the index of the found element, else `-1`.
     * @example
     *
     * var characters = [
     *   { 'name': 'barney',  'age': 36, 'blocked': false },
     *   { 'name': 'fred',    'age': 40, 'blocked': true },
     *   { 'name': 'pebbles', 'age': 1,  'blocked': false }
     * ];
     *
     * _.findIndex(characters, function(chr) {
     *   return chr.age < 20;
     * });
     * // => 2
     *
     * // using "_.where" callback shorthand
     * _.findIndex(characters, { 'age': 36 });
     * // => 0
     *
     * // using "_.pluck" callback shorthand
     * _.findIndex(characters, 'blocked');
     * // => 1
     */
    function findIndex(array, callback, thisArg) {
      var index = -1,
          length = array ? array.length : 0;

      callback = lodash.createCallback(callback, thisArg, 3);
      while (++index < length) {
        if (callback(array[index], index, array)) {
          return index;
        }
      }
      return -1;
    }

    /**
     * This method is like `_.findIndex` except that it iterates over elements
     * of a `collection` from right to left.
     *
     * If a property name is provided for `callback` the created "_.pluck" style
     * callback will return the property value of the given element.
     *
     * If an object is provided for `callback` the created "_.where" style callback
     * will return `true` for elements that have the properties of the given object,
     * else `false`.
     *
     * @static
     * @memberOf _
     * @category Arrays
     * @param {Array} array The array to search.
     * @param {Function|Object|string} [callback=identity] The function called
     *  per iteration. If a property name or object is provided it will be used
     *  to create a "_.pluck" or "_.where" style callback, respectively.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {number} Returns the index of the found element, else `-1`.
     * @example
     *
     * var characters = [
     *   { 'name': 'barney',  'age': 36, 'blocked': true },
     *   { 'name': 'fred',    'age': 40, 'blocked': false },
     *   { 'name': 'pebbles', 'age': 1,  'blocked': true }
     * ];
     *
     * _.findLastIndex(characters, function(chr) {
     *   return chr.age > 30;
     * });
     * // => 1
     *
     * // using "_.where" callback shorthand
     * _.findLastIndex(characters, { 'age': 36 });
     * // => 0
     *
     * // using "_.pluck" callback shorthand
     * _.findLastIndex(characters, 'blocked');
     * // => 2
     */
    function findLastIndex(array, callback, thisArg) {
      var length = array ? array.length : 0;
      callback = lodash.createCallback(callback, thisArg, 3);
      while (length--) {
        if (callback(array[length], length, array)) {
          return length;
        }
      }
      return -1;
    }

    /**
     * Gets the first element or first `n` elements of an array. If a callback
     * is provided elements at the beginning of the array are returned as long
     * as the callback returns truey. The callback is bound to `thisArg` and
     * invoked with three arguments; (value, index, array).
     *
     * If a property name is provided for `callback` the created "_.pluck" style
     * callback will return the property value of the given element.
     *
     * If an object is provided for `callback` the created "_.where" style callback
     * will return `true` for elements that have the properties of the given object,
     * else `false`.
     *
     * @static
     * @memberOf _
     * @alias head, take
     * @category Arrays
     * @param {Array} array The array to query.
     * @param {Function|Object|number|string} [callback] The function called
     *  per element or the number of elements to return. If a property name or
     *  object is provided it will be used to create a "_.pluck" or "_.where"
     *  style callback, respectively.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {*} Returns the first element(s) of `array`.
     * @example
     *
     * _.first([1, 2, 3]);
     * // => 1
     *
     * _.first([1, 2, 3], 2);
     * // => [1, 2]
     *
     * _.first([1, 2, 3], function(num) {
     *   return num < 3;
     * });
     * // => [1, 2]
     *
     * var characters = [
     *   { 'name': 'barney',  'blocked': true,  'employer': 'slate' },
     *   { 'name': 'fred',    'blocked': false, 'employer': 'slate' },
     *   { 'name': 'pebbles', 'blocked': true,  'employer': 'na' }
     * ];
     *
     * // using "_.pluck" callback shorthand
     * _.first(characters, 'blocked');
     * // => [{ 'name': 'barney', 'blocked': true, 'employer': 'slate' }]
     *
     * // using "_.where" callback shorthand
     * _.pluck(_.first(characters, { 'employer': 'slate' }), 'name');
     * // => ['barney', 'fred']
     */
    function first(array, callback, thisArg) {
      var n = 0,
          length = array ? array.length : 0;

      if (typeof callback != 'number' && callback != null) {
        var index = -1;
        callback = lodash.createCallback(callback, thisArg, 3);
        while (++index < length && callback(array[index], index, array)) {
          n++;
        }
      } else {
        n = callback;
        if (n == null || thisArg) {
          return array ? array[0] : undefined;
        }
      }
      return slice(array, 0, nativeMin(nativeMax(0, n), length));
    }

    /**
     * Flattens a nested array (the nesting can be to any depth). If `isShallow`
     * is truey, the array will only be flattened a single level. If a callback
     * is provided each element of the array is passed through the callback before
     * flattening. The callback is bound to `thisArg` and invoked with three
     * arguments; (value, index, array).
     *
     * If a property name is provided for `callback` the created "_.pluck" style
     * callback will return the property value of the given element.
     *
     * If an object is provided for `callback` the created "_.where" style callback
     * will return `true` for elements that have the properties of the given object,
     * else `false`.
     *
     * @static
     * @memberOf _
     * @category Arrays
     * @param {Array} array The array to flatten.
     * @param {boolean} [isShallow=false] A flag to restrict flattening to a single level.
     * @param {Function|Object|string} [callback=identity] The function called
     *  per iteration. If a property name or object is provided it will be used
     *  to create a "_.pluck" or "_.where" style callback, respectively.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {Array} Returns a new flattened array.
     * @example
     *
     * _.flatten([1, [2], [3, [[4]]]]);
     * // => [1, 2, 3, 4];
     *
     * _.flatten([1, [2], [3, [[4]]]], true);
     * // => [1, 2, 3, [[4]]];
     *
     * var characters = [
     *   { 'name': 'barney', 'age': 30, 'pets': ['hoppy'] },
     *   { 'name': 'fred',   'age': 40, 'pets': ['baby puss', 'dino'] }
     * ];
     *
     * // using "_.pluck" callback shorthand
     * _.flatten(characters, 'pets');
     * // => ['hoppy', 'baby puss', 'dino']
     */
    function flatten(array, isShallow, callback, thisArg) {
      // juggle arguments
      if (typeof isShallow != 'boolean' && isShallow != null) {
        thisArg = callback;
        callback = (typeof isShallow != 'function' && thisArg && thisArg[isShallow] === array) ? null : isShallow;
        isShallow = false;
      }
      if (callback != null) {
        array = map(array, callback, thisArg);
      }
      return baseFlatten(array, isShallow);
    }

    /**
     * Gets the index at which the first occurrence of `value` is found using
     * strict equality for comparisons, i.e. `===`. If the array is already sorted
     * providing `true` for `fromIndex` will run a faster binary search.
     *
     * @static
     * @memberOf _
     * @category Arrays
     * @param {Array} array The array to search.
     * @param {*} value The value to search for.
     * @param {boolean|number} [fromIndex=0] The index to search from or `true`
     *  to perform a binary search on a sorted array.
     * @returns {number} Returns the index of the matched value or `-1`.
     * @example
     *
     * _.indexOf([1, 2, 3, 1, 2, 3], 2);
     * // => 1
     *
     * _.indexOf([1, 2, 3, 1, 2, 3], 2, 3);
     * // => 4
     *
     * _.indexOf([1, 1, 2, 2, 3, 3], 2, true);
     * // => 2
     */
    function indexOf(array, value, fromIndex) {
      if (typeof fromIndex == 'number') {
        var length = array ? array.length : 0;
        fromIndex = (fromIndex < 0 ? nativeMax(0, length + fromIndex) : fromIndex || 0);
      } else if (fromIndex) {
        var index = sortedIndex(array, value);
        return array[index] === value ? index : -1;
      }
      return baseIndexOf(array, value, fromIndex);
    }

    /**
     * Gets all but the last element or last `n` elements of an array. If a
     * callback is provided elements at the end of the array are excluded from
     * the result as long as the callback returns truey. The callback is bound
     * to `thisArg` and invoked with three arguments; (value, index, array).
     *
     * If a property name is provided for `callback` the created "_.pluck" style
     * callback will return the property value of the given element.
     *
     * If an object is provided for `callback` the created "_.where" style callback
     * will return `true` for elements that have the properties of the given object,
     * else `false`.
     *
     * @static
     * @memberOf _
     * @category Arrays
     * @param {Array} array The array to query.
     * @param {Function|Object|number|string} [callback=1] The function called
     *  per element or the number of elements to exclude. If a property name or
     *  object is provided it will be used to create a "_.pluck" or "_.where"
     *  style callback, respectively.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {Array} Returns a slice of `array`.
     * @example
     *
     * _.initial([1, 2, 3]);
     * // => [1, 2]
     *
     * _.initial([1, 2, 3], 2);
     * // => [1]
     *
     * _.initial([1, 2, 3], function(num) {
     *   return num > 1;
     * });
     * // => [1]
     *
     * var characters = [
     *   { 'name': 'barney',  'blocked': false, 'employer': 'slate' },
     *   { 'name': 'fred',    'blocked': true,  'employer': 'slate' },
     *   { 'name': 'pebbles', 'blocked': true,  'employer': 'na' }
     * ];
     *
     * // using "_.pluck" callback shorthand
     * _.initial(characters, 'blocked');
     * // => [{ 'name': 'barney',  'blocked': false, 'employer': 'slate' }]
     *
     * // using "_.where" callback shorthand
     * _.pluck(_.initial(characters, { 'employer': 'na' }), 'name');
     * // => ['barney', 'fred']
     */
    function initial(array, callback, thisArg) {
      var n = 0,
          length = array ? array.length : 0;

      if (typeof callback != 'number' && callback != null) {
        var index = length;
        callback = lodash.createCallback(callback, thisArg, 3);
        while (index-- && callback(array[index], index, array)) {
          n++;
        }
      } else {
        n = (callback == null || thisArg) ? 1 : callback || n;
      }
      return slice(array, 0, nativeMin(nativeMax(0, length - n), length));
    }

    /**
     * Creates an array of unique values present in all provided arrays using
     * strict equality for comparisons, i.e. `===`.
     *
     * @static
     * @memberOf _
     * @category Arrays
     * @param {...Array} [array] The arrays to inspect.
     * @returns {Array} Returns an array of shared values.
     * @example
     *
     * _.intersection([1, 2, 3], [5, 2, 1, 4], [2, 1]);
     * // => [1, 2]
     */
    function intersection() {
      var args = [],
          argsIndex = -1,
          argsLength = arguments.length,
          caches = getArray(),
          indexOf = getIndexOf(),
          trustIndexOf = indexOf === baseIndexOf,
          seen = getArray();

      while (++argsIndex < argsLength) {
        var value = arguments[argsIndex];
        if (isArray(value) || isArguments(value)) {
          args.push(value);
          caches.push(trustIndexOf && value.length >= largeArraySize &&
            createCache(argsIndex ? args[argsIndex] : seen));
        }
      }
      var array = args[0],
          index = -1,
          length = array ? array.length : 0,
          result = [];

      outer:
      while (++index < length) {
        var cache = caches[0];
        value = array[index];

        if ((cache ? cacheIndexOf(cache, value) : indexOf(seen, value)) < 0) {
          argsIndex = argsLength;
          (cache || seen).push(value);
          while (--argsIndex) {
            cache = caches[argsIndex];
            if ((cache ? cacheIndexOf(cache, value) : indexOf(args[argsIndex], value)) < 0) {
              continue outer;
            }
          }
          result.push(value);
        }
      }
      while (argsLength--) {
        cache = caches[argsLength];
        if (cache) {
          releaseObject(cache);
        }
      }
      releaseArray(caches);
      releaseArray(seen);
      return result;
    }

    /**
     * Gets the last element or last `n` elements of an array. If a callback is
     * provided elements at the end of the array are returned as long as the
     * callback returns truey. The callback is bound to `thisArg` and invoked
     * with three arguments; (value, index, array).
     *
     * If a property name is provided for `callback` the created "_.pluck" style
     * callback will return the property value of the given element.
     *
     * If an object is provided for `callback` the created "_.where" style callback
     * will return `true` for elements that have the properties of the given object,
     * else `false`.
     *
     * @static
     * @memberOf _
     * @category Arrays
     * @param {Array} array The array to query.
     * @param {Function|Object|number|string} [callback] The function called
     *  per element or the number of elements to return. If a property name or
     *  object is provided it will be used to create a "_.pluck" or "_.where"
     *  style callback, respectively.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {*} Returns the last element(s) of `array`.
     * @example
     *
     * _.last([1, 2, 3]);
     * // => 3
     *
     * _.last([1, 2, 3], 2);
     * // => [2, 3]
     *
     * _.last([1, 2, 3], function(num) {
     *   return num > 1;
     * });
     * // => [2, 3]
     *
     * var characters = [
     *   { 'name': 'barney',  'blocked': false, 'employer': 'slate' },
     *   { 'name': 'fred',    'blocked': true,  'employer': 'slate' },
     *   { 'name': 'pebbles', 'blocked': true,  'employer': 'na' }
     * ];
     *
     * // using "_.pluck" callback shorthand
     * _.pluck(_.last(characters, 'blocked'), 'name');
     * // => ['fred', 'pebbles']
     *
     * // using "_.where" callback shorthand
     * _.last(characters, { 'employer': 'na' });
     * // => [{ 'name': 'pebbles', 'blocked': true, 'employer': 'na' }]
     */
    function last(array, callback, thisArg) {
      var n = 0,
          length = array ? array.length : 0;

      if (typeof callback != 'number' && callback != null) {
        var index = length;
        callback = lodash.createCallback(callback, thisArg, 3);
        while (index-- && callback(array[index], index, array)) {
          n++;
        }
      } else {
        n = callback;
        if (n == null || thisArg) {
          return array ? array[length - 1] : undefined;
        }
      }
      return slice(array, nativeMax(0, length - n));
    }

    /**
     * Gets the index at which the last occurrence of `value` is found using strict
     * equality for comparisons, i.e. `===`. If `fromIndex` is negative, it is used
     * as the offset from the end of the collection.
     *
     * If a property name is provided for `callback` the created "_.pluck" style
     * callback will return the property value of the given element.
     *
     * If an object is provided for `callback` the created "_.where" style callback
     * will return `true` for elements that have the properties of the given object,
     * else `false`.
     *
     * @static
     * @memberOf _
     * @category Arrays
     * @param {Array} array The array to search.
     * @param {*} value The value to search for.
     * @param {number} [fromIndex=array.length-1] The index to search from.
     * @returns {number} Returns the index of the matched value or `-1`.
     * @example
     *
     * _.lastIndexOf([1, 2, 3, 1, 2, 3], 2);
     * // => 4
     *
     * _.lastIndexOf([1, 2, 3, 1, 2, 3], 2, 3);
     * // => 1
     */
    function lastIndexOf(array, value, fromIndex) {
      var index = array ? array.length : 0;
      if (typeof fromIndex == 'number') {
        index = (fromIndex < 0 ? nativeMax(0, index + fromIndex) : nativeMin(fromIndex, index - 1)) + 1;
      }
      while (index--) {
        if (array[index] === value) {
          return index;
        }
      }
      return -1;
    }

    /**
     * Removes all provided values from the given array using strict equality for
     * comparisons, i.e. `===`.
     *
     * @static
     * @memberOf _
     * @category Arrays
     * @param {Array} array The array to modify.
     * @param {...*} [value] The values to remove.
     * @returns {Array} Returns `array`.
     * @example
     *
     * var array = [1, 2, 3, 1, 2, 3];
     * _.pull(array, 2, 3);
     * console.log(array);
     * // => [1, 1]
     */
    function pull(array) {
      var args = arguments,
          argsIndex = 0,
          argsLength = args.length,
          length = array ? array.length : 0;

      while (++argsIndex < argsLength) {
        var index = -1,
            value = args[argsIndex];
        while (++index < length) {
          if (array[index] === value) {
            splice.call(array, index--, 1);
            length--;
          }
        }
      }
      return array;
    }

    /**
     * Creates an array of numbers (positive and/or negative) progressing from
     * `start` up to but not including `end`. If `start` is less than `stop` a
     * zero-length range is created unless a negative `step` is specified.
     *
     * @static
     * @memberOf _
     * @category Arrays
     * @param {number} [start=0] The start of the range.
     * @param {number} end The end of the range.
     * @param {number} [step=1] The value to increment or decrement by.
     * @returns {Array} Returns a new range array.
     * @example
     *
     * _.range(4);
     * // => [0, 1, 2, 3]
     *
     * _.range(1, 5);
     * // => [1, 2, 3, 4]
     *
     * _.range(0, 20, 5);
     * // => [0, 5, 10, 15]
     *
     * _.range(0, -4, -1);
     * // => [0, -1, -2, -3]
     *
     * _.range(1, 4, 0);
     * // => [1, 1, 1]
     *
     * _.range(0);
     * // => []
     */
    function range(start, end, step) {
      start = +start || 0;
      step = typeof step == 'number' ? step : (+step || 1);

      if (end == null) {
        end = start;
        start = 0;
      }
      // use `Array(length)` so engines like Chakra and V8 avoid slower modes
      // http://youtu.be/XAqIpGU8ZZk#t=17m25s
      var index = -1,
          length = nativeMax(0, ceil((end - start) / (step || 1))),
          result = Array(length);

      while (++index < length) {
        result[index] = start;
        start += step;
      }
      return result;
    }

    /**
     * Removes all elements from an array that the callback returns truey for
     * and returns an array of removed elements. The callback is bound to `thisArg`
     * and invoked with three arguments; (value, index, array).
     *
     * If a property name is provided for `callback` the created "_.pluck" style
     * callback will return the property value of the given element.
     *
     * If an object is provided for `callback` the created "_.where" style callback
     * will return `true` for elements that have the properties of the given object,
     * else `false`.
     *
     * @static
     * @memberOf _
     * @category Arrays
     * @param {Array} array The array to modify.
     * @param {Function|Object|string} [callback=identity] The function called
     *  per iteration. If a property name or object is provided it will be used
     *  to create a "_.pluck" or "_.where" style callback, respectively.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {Array} Returns a new array of removed elements.
     * @example
     *
     * var array = [1, 2, 3, 4, 5, 6];
     * var evens = _.remove(array, function(num) { return num % 2 == 0; });
     *
     * console.log(array);
     * // => [1, 3, 5]
     *
     * console.log(evens);
     * // => [2, 4, 6]
     */
    function remove(array, callback, thisArg) {
      var index = -1,
          length = array ? array.length : 0,
          result = [];

      callback = lodash.createCallback(callback, thisArg, 3);
      while (++index < length) {
        var value = array[index];
        if (callback(value, index, array)) {
          result.push(value);
          splice.call(array, index--, 1);
          length--;
        }
      }
      return result;
    }

    /**
     * The opposite of `_.initial` this method gets all but the first element or
     * first `n` elements of an array. If a callback function is provided elements
     * at the beginning of the array are excluded from the result as long as the
     * callback returns truey. The callback is bound to `thisArg` and invoked
     * with three arguments; (value, index, array).
     *
     * If a property name is provided for `callback` the created "_.pluck" style
     * callback will return the property value of the given element.
     *
     * If an object is provided for `callback` the created "_.where" style callback
     * will return `true` for elements that have the properties of the given object,
     * else `false`.
     *
     * @static
     * @memberOf _
     * @alias drop, tail
     * @category Arrays
     * @param {Array} array The array to query.
     * @param {Function|Object|number|string} [callback=1] The function called
     *  per element or the number of elements to exclude. If a property name or
     *  object is provided it will be used to create a "_.pluck" or "_.where"
     *  style callback, respectively.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {Array} Returns a slice of `array`.
     * @example
     *
     * _.rest([1, 2, 3]);
     * // => [2, 3]
     *
     * _.rest([1, 2, 3], 2);
     * // => [3]
     *
     * _.rest([1, 2, 3], function(num) {
     *   return num < 3;
     * });
     * // => [3]
     *
     * var characters = [
     *   { 'name': 'barney',  'blocked': true,  'employer': 'slate' },
     *   { 'name': 'fred',    'blocked': false,  'employer': 'slate' },
     *   { 'name': 'pebbles', 'blocked': true, 'employer': 'na' }
     * ];
     *
     * // using "_.pluck" callback shorthand
     * _.pluck(_.rest(characters, 'blocked'), 'name');
     * // => ['fred', 'pebbles']
     *
     * // using "_.where" callback shorthand
     * _.rest(characters, { 'employer': 'slate' });
     * // => [{ 'name': 'pebbles', 'blocked': true, 'employer': 'na' }]
     */
    function rest(array, callback, thisArg) {
      if (typeof callback != 'number' && callback != null) {
        var n = 0,
            index = -1,
            length = array ? array.length : 0;

        callback = lodash.createCallback(callback, thisArg, 3);
        while (++index < length && callback(array[index], index, array)) {
          n++;
        }
      } else {
        n = (callback == null || thisArg) ? 1 : nativeMax(0, callback);
      }
      return slice(array, n);
    }

    /**
     * Uses a binary search to determine the smallest index at which a value
     * should be inserted into a given sorted array in order to maintain the sort
     * order of the array. If a callback is provided it will be executed for
     * `value` and each element of `array` to compute their sort ranking. The
     * callback is bound to `thisArg` and invoked with one argument; (value).
     *
     * If a property name is provided for `callback` the created "_.pluck" style
     * callback will return the property value of the given element.
     *
     * If an object is provided for `callback` the created "_.where" style callback
     * will return `true` for elements that have the properties of the given object,
     * else `false`.
     *
     * @static
     * @memberOf _
     * @category Arrays
     * @param {Array} array The array to inspect.
     * @param {*} value The value to evaluate.
     * @param {Function|Object|string} [callback=identity] The function called
     *  per iteration. If a property name or object is provided it will be used
     *  to create a "_.pluck" or "_.where" style callback, respectively.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {number} Returns the index at which `value` should be inserted
     *  into `array`.
     * @example
     *
     * _.sortedIndex([20, 30, 50], 40);
     * // => 2
     *
     * // using "_.pluck" callback shorthand
     * _.sortedIndex([{ 'x': 20 }, { 'x': 30 }, { 'x': 50 }], { 'x': 40 }, 'x');
     * // => 2
     *
     * var dict = {
     *   'wordToNumber': { 'twenty': 20, 'thirty': 30, 'fourty': 40, 'fifty': 50 }
     * };
     *
     * _.sortedIndex(['twenty', 'thirty', 'fifty'], 'fourty', function(word) {
     *   return dict.wordToNumber[word];
     * });
     * // => 2
     *
     * _.sortedIndex(['twenty', 'thirty', 'fifty'], 'fourty', function(word) {
     *   return this.wordToNumber[word];
     * }, dict);
     * // => 2
     */
    function sortedIndex(array, value, callback, thisArg) {
      var low = 0,
          high = array ? array.length : low;

      // explicitly reference `identity` for better inlining in Firefox
      callback = callback ? lodash.createCallback(callback, thisArg, 1) : identity;
      value = callback(value);

      while (low < high) {
        var mid = (low + high) >>> 1;
        (callback(array[mid]) < value)
          ? low = mid + 1
          : high = mid;
      }
      return low;
    }

    /**
     * Creates an array of unique values, in order, of the provided arrays using
     * strict equality for comparisons, i.e. `===`.
     *
     * @static
     * @memberOf _
     * @category Arrays
     * @param {...Array} [array] The arrays to inspect.
     * @returns {Array} Returns an array of combined values.
     * @example
     *
     * _.union([1, 2, 3], [5, 2, 1, 4], [2, 1]);
     * // => [1, 2, 3, 5, 4]
     */
    function union() {
      return baseUniq(baseFlatten(arguments, true, true));
    }

    /**
     * Creates a duplicate-value-free version of an array using strict equality
     * for comparisons, i.e. `===`. If the array is sorted, providing
     * `true` for `isSorted` will use a faster algorithm. If a callback is provided
     * each element of `array` is passed through the callback before uniqueness
     * is computed. The callback is bound to `thisArg` and invoked with three
     * arguments; (value, index, array).
     *
     * If a property name is provided for `callback` the created "_.pluck" style
     * callback will return the property value of the given element.
     *
     * If an object is provided for `callback` the created "_.where" style callback
     * will return `true` for elements that have the properties of the given object,
     * else `false`.
     *
     * @static
     * @memberOf _
     * @alias unique
     * @category Arrays
     * @param {Array} array The array to process.
     * @param {boolean} [isSorted=false] A flag to indicate that `array` is sorted.
     * @param {Function|Object|string} [callback=identity] The function called
     *  per iteration. If a property name or object is provided it will be used
     *  to create a "_.pluck" or "_.where" style callback, respectively.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {Array} Returns a duplicate-value-free array.
     * @example
     *
     * _.uniq([1, 2, 1, 3, 1]);
     * // => [1, 2, 3]
     *
     * _.uniq([1, 1, 2, 2, 3], true);
     * // => [1, 2, 3]
     *
     * _.uniq(['A', 'b', 'C', 'a', 'B', 'c'], function(letter) { return letter.toLowerCase(); });
     * // => ['A', 'b', 'C']
     *
     * _.uniq([1, 2.5, 3, 1.5, 2, 3.5], function(num) { return this.floor(num); }, Math);
     * // => [1, 2.5, 3]
     *
     * // using "_.pluck" callback shorthand
     * _.uniq([{ 'x': 1 }, { 'x': 2 }, { 'x': 1 }], 'x');
     * // => [{ 'x': 1 }, { 'x': 2 }]
     */
    function uniq(array, isSorted, callback, thisArg) {
      // juggle arguments
      if (typeof isSorted != 'boolean' && isSorted != null) {
        thisArg = callback;
        callback = (typeof isSorted != 'function' && thisArg && thisArg[isSorted] === array) ? null : isSorted;
        isSorted = false;
      }
      if (callback != null) {
        callback = lodash.createCallback(callback, thisArg, 3);
      }
      return baseUniq(array, isSorted, callback);
    }

    /**
     * Creates an array excluding all provided values using strict equality for
     * comparisons, i.e. `===`.
     *
     * @static
     * @memberOf _
     * @category Arrays
     * @param {Array} array The array to filter.
     * @param {...*} [value] The values to exclude.
     * @returns {Array} Returns a new array of filtered values.
     * @example
     *
     * _.without([1, 2, 1, 0, 3, 1, 4], 0, 1);
     * // => [2, 3, 4]
     */
    function without(array) {
      return baseDifference(array, slice(arguments, 1));
    }

    /**
     * Creates an array that is the symmetric difference of the provided arrays.
     * See http://en.wikipedia.org/wiki/Symmetric_difference.
     *
     * @static
     * @memberOf _
     * @category Arrays
     * @param {...Array} [array] The arrays to inspect.
     * @returns {Array} Returns an array of values.
     * @example
     *
     * _.xor([1, 2, 3], [5, 2, 1, 4]);
     * // => [3, 5, 4]
     *
     * _.xor([1, 2, 5], [2, 3, 5], [3, 4, 5]);
     * // => [1, 4, 5]
     */
    function xor() {
      var index = -1,
          length = arguments.length;

      while (++index < length) {
        var array = arguments[index];
        if (isArray(array) || isArguments(array)) {
          var result = result
            ? baseUniq(baseDifference(result, array).concat(baseDifference(array, result)))
            : array;
        }
      }
      return result || [];
    }

    /**
     * Creates an array of grouped elements, the first of which contains the first
     * elements of the given arrays, the second of which contains the second
     * elements of the given arrays, and so on.
     *
     * @static
     * @memberOf _
     * @alias unzip
     * @category Arrays
     * @param {...Array} [array] Arrays to process.
     * @returns {Array} Returns a new array of grouped elements.
     * @example
     *
     * _.zip(['fred', 'barney'], [30, 40], [true, false]);
     * // => [['fred', 30, true], ['barney', 40, false]]
     */
    function zip() {
      var array = arguments.length > 1 ? arguments : arguments[0],
          index = -1,
          length = array ? max(pluck(array, 'length')) : 0,
          result = Array(length < 0 ? 0 : length);

      while (++index < length) {
        result[index] = pluck(array, index);
      }
      return result;
    }

    /**
     * Creates an object composed from arrays of `keys` and `values`. Provide
     * either a single two dimensional array, i.e. `[[key1, value1], [key2, value2]]`
     * or two arrays, one of `keys` and one of corresponding `values`.
     *
     * @static
     * @memberOf _
     * @alias object
     * @category Arrays
     * @param {Array} keys The array of keys.
     * @param {Array} [values=[]] The array of values.
     * @returns {Object} Returns an object composed of the given keys and
     *  corresponding values.
     * @example
     *
     * _.zipObject(['fred', 'barney'], [30, 40]);
     * // => { 'fred': 30, 'barney': 40 }
     */
    function zipObject(keys, values) {
      var index = -1,
          length = keys ? keys.length : 0,
          result = {};

      if (!values && length && !isArray(keys[0])) {
        values = [];
      }
      while (++index < length) {
        var key = keys[index];
        if (values) {
          result[key] = values[index];
        } else if (key) {
          result[key[0]] = key[1];
        }
      }
      return result;
    }

    /*--------------------------------------------------------------------------*/

    /**
     * Creates a function that executes `func`, with  the `this` binding and
     * arguments of the created function, only after being called `n` times.
     *
     * @static
     * @memberOf _
     * @category Functions
     * @param {number} n The number of times the function must be called before
     *  `func` is executed.
     * @param {Function} func The function to restrict.
     * @returns {Function} Returns the new restricted function.
     * @example
     *
     * var saves = ['profile', 'settings'];
     *
     * var done = _.after(saves.length, function() {
     *   console.log('Done saving!');
     * });
     *
     * _.forEach(saves, function(type) {
     *   asyncSave({ 'type': type, 'complete': done });
     * });
     * // => logs 'Done saving!', after all saves have completed
     */
    function after(n, func) {
      if (!isFunction(func)) {
        throw new TypeError;
      }
      return function() {
        if (--n < 1) {
          return func.apply(this, arguments);
        }
      };
    }

    /**
     * Creates a function that, when called, invokes `func` with the `this`
     * binding of `thisArg` and prepends any additional `bind` arguments to those
     * provided to the bound function.
     *
     * @static
     * @memberOf _
     * @category Functions
     * @param {Function} func The function to bind.
     * @param {*} [thisArg] The `this` binding of `func`.
     * @param {...*} [arg] Arguments to be partially applied.
     * @returns {Function} Returns the new bound function.
     * @example
     *
     * var func = function(greeting) {
     *   return greeting + ' ' + this.name;
     * };
     *
     * func = _.bind(func, { 'name': 'fred' }, 'hi');
     * func();
     * // => 'hi fred'
     */
    function bind(func, thisArg) {
      return arguments.length > 2
        ? createWrapper(func, 17, slice(arguments, 2), null, thisArg)
        : createWrapper(func, 1, null, null, thisArg);
    }

    /**
     * Binds methods of an object to the object itself, overwriting the existing
     * method. Method names may be specified as individual arguments or as arrays
     * of method names. If no method names are provided all the function properties
     * of `object` will be bound.
     *
     * @static
     * @memberOf _
     * @category Functions
     * @param {Object} object The object to bind and assign the bound methods to.
     * @param {...string} [methodName] The object method names to
     *  bind, specified as individual method names or arrays of method names.
     * @returns {Object} Returns `object`.
     * @example
     *
     * var view = {
     *   'label': 'docs',
     *   'onClick': function() { console.log('clicked ' + this.label); }
     * };
     *
     * _.bindAll(view);
     * jQuery('#docs').on('click', view.onClick);
     * // => logs 'clicked docs', when the button is clicked
     */
    function bindAll(object) {
      var funcs = arguments.length > 1 ? baseFlatten(arguments, true, false, 1) : functions(object),
          index = -1,
          length = funcs.length;

      while (++index < length) {
        var key = funcs[index];
        object[key] = createWrapper(object[key], 1, null, null, object);
      }
      return object;
    }

    /**
     * Creates a function that, when called, invokes the method at `object[key]`
     * and prepends any additional `bindKey` arguments to those provided to the bound
     * function. This method differs from `_.bind` by allowing bound functions to
     * reference methods that will be redefined or don't yet exist.
     * See http://michaux.ca/articles/lazy-function-definition-pattern.
     *
     * @static
     * @memberOf _
     * @category Functions
     * @param {Object} object The object the method belongs to.
     * @param {string} key The key of the method.
     * @param {...*} [arg] Arguments to be partially applied.
     * @returns {Function} Returns the new bound function.
     * @example
     *
     * var object = {
     *   'name': 'fred',
     *   'greet': function(greeting) {
     *     return greeting + ' ' + this.name;
     *   }
     * };
     *
     * var func = _.bindKey(object, 'greet', 'hi');
     * func();
     * // => 'hi fred'
     *
     * object.greet = function(greeting) {
     *   return greeting + 'ya ' + this.name + '!';
     * };
     *
     * func();
     * // => 'hiya fred!'
     */
    function bindKey(object, key) {
      return arguments.length > 2
        ? createWrapper(key, 19, slice(arguments, 2), null, object)
        : createWrapper(key, 3, null, null, object);
    }

    /**
     * Creates a function that is the composition of the provided functions,
     * where each function consumes the return value of the function that follows.
     * For example, composing the functions `f()`, `g()`, and `h()` produces `f(g(h()))`.
     * Each function is executed with the `this` binding of the composed function.
     *
     * @static
     * @memberOf _
     * @category Functions
     * @param {...Function} [func] Functions to compose.
     * @returns {Function} Returns the new composed function.
     * @example
     *
     * var realNameMap = {
     *   'pebbles': 'penelope'
     * };
     *
     * var format = function(name) {
     *   name = realNameMap[name.toLowerCase()] || name;
     *   return name.charAt(0).toUpperCase() + name.slice(1).toLowerCase();
     * };
     *
     * var greet = function(formatted) {
     *   return 'Hiya ' + formatted + '!';
     * };
     *
     * var welcome = _.compose(greet, format);
     * welcome('pebbles');
     * // => 'Hiya Penelope!'
     */
    function compose() {
      var funcs = arguments,
          length = funcs.length;

      while (length--) {
        if (!isFunction(funcs[length])) {
          throw new TypeError;
        }
      }
      return function() {
        var args = arguments,
            length = funcs.length;

        while (length--) {
          args = [funcs[length].apply(this, args)];
        }
        return args[0];
      };
    }

    /**
     * Creates a function which accepts one or more arguments of `func` that when
     * invoked either executes `func` returning its result, if all `func` arguments
     * have been provided, or returns a function that accepts one or more of the
     * remaining `func` arguments, and so on. The arity of `func` can be specified
     * if `func.length` is not sufficient.
     *
     * @static
     * @memberOf _
     * @category Functions
     * @param {Function} func The function to curry.
     * @param {number} [arity=func.length] The arity of `func`.
     * @returns {Function} Returns the new curried function.
     * @example
     *
     * var curried = _.curry(function(a, b, c) {
     *   console.log(a + b + c);
     * });
     *
     * curried(1)(2)(3);
     * // => 6
     *
     * curried(1, 2)(3);
     * // => 6
     *
     * curried(1, 2, 3);
     * // => 6
     */
    function curry(func, arity) {
      arity = typeof arity == 'number' ? arity : (+arity || func.length);
      return createWrapper(func, 4, null, null, null, arity);
    }

    /**
     * Creates a function that will delay the execution of `func` until after
     * `wait` milliseconds have elapsed since the last time it was invoked.
     * Provide an options object to indicate that `func` should be invoked on
     * the leading and/or trailing edge of the `wait` timeout. Subsequent calls
     * to the debounced function will return the result of the last `func` call.
     *
     * Note: If `leading` and `trailing` options are `true` `func` will be called
     * on the trailing edge of the timeout only if the the debounced function is
     * invoked more than once during the `wait` timeout.
     *
     * @static
     * @memberOf _
     * @category Functions
     * @param {Function} func The function to debounce.
     * @param {number} wait The number of milliseconds to delay.
     * @param {Object} [options] The options object.
     * @param {boolean} [options.leading=false] Specify execution on the leading edge of the timeout.
     * @param {number} [options.maxWait] The maximum time `func` is allowed to be delayed before it's called.
     * @param {boolean} [options.trailing=true] Specify execution on the trailing edge of the timeout.
     * @returns {Function} Returns the new debounced function.
     * @example
     *
     * // avoid costly calculations while the window size is in flux
     * var lazyLayout = _.debounce(calculateLayout, 150);
     * jQuery(window).on('resize', lazyLayout);
     *
     * // execute `sendMail` when the click event is fired, debouncing subsequent calls
     * jQuery('#postbox').on('click', _.debounce(sendMail, 300, {
     *   'leading': true,
     *   'trailing': false
     * });
     *
     * // ensure `batchLog` is executed once after 1 second of debounced calls
     * var source = new EventSource('/stream');
     * source.addEventListener('message', _.debounce(batchLog, 250, {
     *   'maxWait': 1000
     * }, false);
     */
    function debounce(func, wait, options) {
      var args,
          maxTimeoutId,
          result,
          stamp,
          thisArg,
          timeoutId,
          trailingCall,
          lastCalled = 0,
          maxWait = false,
          trailing = true;

      if (!isFunction(func)) {
        throw new TypeError;
      }
      wait = nativeMax(0, wait) || 0;
      if (options === true) {
        var leading = true;
        trailing = false;
      } else if (isObject(options)) {
        leading = options.leading;
        maxWait = 'maxWait' in options && (nativeMax(wait, options.maxWait) || 0);
        trailing = 'trailing' in options ? options.trailing : trailing;
      }
      var delayed = function() {
        var remaining = wait - (now() - stamp);
        if (remaining <= 0) {
          if (maxTimeoutId) {
            clearTimeout(maxTimeoutId);
          }
          var isCalled = trailingCall;
          maxTimeoutId = timeoutId = trailingCall = undefined;
          if (isCalled) {
            lastCalled = now();
            result = func.apply(thisArg, args);
            if (!timeoutId && !maxTimeoutId) {
              args = thisArg = null;
            }
          }
        } else {
          timeoutId = setTimeout(delayed, remaining);
        }
      };

      var maxDelayed = function() {
        if (timeoutId) {
          clearTimeout(timeoutId);
        }
        maxTimeoutId = timeoutId = trailingCall = undefined;
        if (trailing || (maxWait !== wait)) {
          lastCalled = now();
          result = func.apply(thisArg, args);
          if (!timeoutId && !maxTimeoutId) {
            args = thisArg = null;
          }
        }
      };

      return function() {
        args = arguments;
        stamp = now();
        thisArg = this;
        trailingCall = trailing && (timeoutId || !leading);

        if (maxWait === false) {
          var leadingCall = leading && !timeoutId;
        } else {
          if (!maxTimeoutId && !leading) {
            lastCalled = stamp;
          }
          var remaining = maxWait - (stamp - lastCalled),
              isCalled = remaining <= 0;

          if (isCalled) {
            if (maxTimeoutId) {
              maxTimeoutId = clearTimeout(maxTimeoutId);
            }
            lastCalled = stamp;
            result = func.apply(thisArg, args);
          }
          else if (!maxTimeoutId) {
            maxTimeoutId = setTimeout(maxDelayed, remaining);
          }
        }
        if (isCalled && timeoutId) {
          timeoutId = clearTimeout(timeoutId);
        }
        else if (!timeoutId && wait !== maxWait) {
          timeoutId = setTimeout(delayed, wait);
        }
        if (leadingCall) {
          isCalled = true;
          result = func.apply(thisArg, args);
        }
        if (isCalled && !timeoutId && !maxTimeoutId) {
          args = thisArg = null;
        }
        return result;
      };
    }

    /**
     * Defers executing the `func` function until the current call stack has cleared.
     * Additional arguments will be provided to `func` when it is invoked.
     *
     * @static
     * @memberOf _
     * @category Functions
     * @param {Function} func The function to defer.
     * @param {...*} [arg] Arguments to invoke the function with.
     * @returns {number} Returns the timer id.
     * @example
     *
     * _.defer(function(text) { console.log(text); }, 'deferred');
     * // logs 'deferred' after one or more milliseconds
     */
    function defer(func) {
      if (!isFunction(func)) {
        throw new TypeError;
      }
      var args = slice(arguments, 1);
      return setTimeout(function() { func.apply(undefined, args); }, 1);
    }

    /**
     * Executes the `func` function after `wait` milliseconds. Additional arguments
     * will be provided to `func` when it is invoked.
     *
     * @static
     * @memberOf _
     * @category Functions
     * @param {Function} func The function to delay.
     * @param {number} wait The number of milliseconds to delay execution.
     * @param {...*} [arg] Arguments to invoke the function with.
     * @returns {number} Returns the timer id.
     * @example
     *
     * _.delay(function(text) { console.log(text); }, 1000, 'later');
     * // => logs 'later' after one second
     */
    function delay(func, wait) {
      if (!isFunction(func)) {
        throw new TypeError;
      }
      var args = slice(arguments, 2);
      return setTimeout(function() { func.apply(undefined, args); }, wait);
    }

    /**
     * Creates a function that memoizes the result of `func`. If `resolver` is
     * provided it will be used to determine the cache key for storing the result
     * based on the arguments provided to the memoized function. By default, the
     * first argument provided to the memoized function is used as the cache key.
     * The `func` is executed with the `this` binding of the memoized function.
     * The result cache is exposed as the `cache` property on the memoized function.
     *
     * @static
     * @memberOf _
     * @category Functions
     * @param {Function} func The function to have its output memoized.
     * @param {Function} [resolver] A function used to resolve the cache key.
     * @returns {Function} Returns the new memoizing function.
     * @example
     *
     * var fibonacci = _.memoize(function(n) {
     *   return n < 2 ? n : fibonacci(n - 1) + fibonacci(n - 2);
     * });
     *
     * fibonacci(9)
     * // => 34
     *
     * var data = {
     *   'fred': { 'name': 'fred', 'age': 40 },
     *   'pebbles': { 'name': 'pebbles', 'age': 1 }
     * };
     *
     * // modifying the result cache
     * var get = _.memoize(function(name) { return data[name]; }, _.identity);
     * get('pebbles');
     * // => { 'name': 'pebbles', 'age': 1 }
     *
     * get.cache.pebbles.name = 'penelope';
     * get('pebbles');
     * // => { 'name': 'penelope', 'age': 1 }
     */
    function memoize(func, resolver) {
      if (!isFunction(func)) {
        throw new TypeError;
      }
      var memoized = function() {
        var cache = memoized.cache,
            key = resolver ? resolver.apply(this, arguments) : keyPrefix + arguments[0];

        return hasOwnProperty.call(cache, key)
          ? cache[key]
          : (cache[key] = func.apply(this, arguments));
      }
      memoized.cache = {};
      return memoized;
    }

    /**
     * Creates a function that is restricted to execute `func` once. Repeat calls to
     * the function will return the value of the first call. The `func` is executed
     * with the `this` binding of the created function.
     *
     * @static
     * @memberOf _
     * @category Functions
     * @param {Function} func The function to restrict.
     * @returns {Function} Returns the new restricted function.
     * @example
     *
     * var initialize = _.once(createApplication);
     * initialize();
     * initialize();
     * // `initialize` executes `createApplication` once
     */
    function once(func) {
      var ran,
          result;

      if (!isFunction(func)) {
        throw new TypeError;
      }
      return function() {
        if (ran) {
          return result;
        }
        ran = true;
        result = func.apply(this, arguments);

        // clear the `func` variable so the function may be garbage collected
        func = null;
        return result;
      };
    }

    /**
     * Creates a function that, when called, invokes `func` with any additional
     * `partial` arguments prepended to those provided to the new function. This
     * method is similar to `_.bind` except it does **not** alter the `this` binding.
     *
     * @static
     * @memberOf _
     * @category Functions
     * @param {Function} func The function to partially apply arguments to.
     * @param {...*} [arg] Arguments to be partially applied.
     * @returns {Function} Returns the new partially applied function.
     * @example
     *
     * var greet = function(greeting, name) { return greeting + ' ' + name; };
     * var hi = _.partial(greet, 'hi');
     * hi('fred');
     * // => 'hi fred'
     */
    function partial(func) {
      return createWrapper(func, 16, slice(arguments, 1));
    }

    /**
     * This method is like `_.partial` except that `partial` arguments are
     * appended to those provided to the new function.
     *
     * @static
     * @memberOf _
     * @category Functions
     * @param {Function} func The function to partially apply arguments to.
     * @param {...*} [arg] Arguments to be partially applied.
     * @returns {Function} Returns the new partially applied function.
     * @example
     *
     * var defaultsDeep = _.partialRight(_.merge, _.defaults);
     *
     * var options = {
     *   'variable': 'data',
     *   'imports': { 'jq': $ }
     * };
     *
     * defaultsDeep(options, _.templateSettings);
     *
     * options.variable
     * // => 'data'
     *
     * options.imports
     * // => { '_': _, 'jq': $ }
     */
    function partialRight(func) {
      return createWrapper(func, 32, null, slice(arguments, 1));
    }

    /**
     * Creates a function that, when executed, will only call the `func` function
     * at most once per every `wait` milliseconds. Provide an options object to
     * indicate that `func` should be invoked on the leading and/or trailing edge
     * of the `wait` timeout. Subsequent calls to the throttled function will
     * return the result of the last `func` call.
     *
     * Note: If `leading` and `trailing` options are `true` `func` will be called
     * on the trailing edge of the timeout only if the the throttled function is
     * invoked more than once during the `wait` timeout.
     *
     * @static
     * @memberOf _
     * @category Functions
     * @param {Function} func The function to throttle.
     * @param {number} wait The number of milliseconds to throttle executions to.
     * @param {Object} [options] The options object.
     * @param {boolean} [options.leading=true] Specify execution on the leading edge of the timeout.
     * @param {boolean} [options.trailing=true] Specify execution on the trailing edge of the timeout.
     * @returns {Function} Returns the new throttled function.
     * @example
     *
     * // avoid excessively updating the position while scrolling
     * var throttled = _.throttle(updatePosition, 100);
     * jQuery(window).on('scroll', throttled);
     *
     * // execute `renewToken` when the click event is fired, but not more than once every 5 minutes
     * jQuery('.interactive').on('click', _.throttle(renewToken, 300000, {
     *   'trailing': false
     * }));
     */
    function throttle(func, wait, options) {
      var leading = true,
          trailing = true;

      if (!isFunction(func)) {
        throw new TypeError;
      }
      if (options === false) {
        leading = false;
      } else if (isObject(options)) {
        leading = 'leading' in options ? options.leading : leading;
        trailing = 'trailing' in options ? options.trailing : trailing;
      }
      debounceOptions.leading = leading;
      debounceOptions.maxWait = wait;
      debounceOptions.trailing = trailing;

      return debounce(func, wait, debounceOptions);
    }

    /**
     * Creates a function that provides `value` to the wrapper function as its
     * first argument. Additional arguments provided to the function are appended
     * to those provided to the wrapper function. The wrapper is executed with
     * the `this` binding of the created function.
     *
     * @static
     * @memberOf _
     * @category Functions
     * @param {*} value The value to wrap.
     * @param {Function} wrapper The wrapper function.
     * @returns {Function} Returns the new function.
     * @example
     *
     * var p = _.wrap(_.escape, function(func, text) {
     *   return '<p>' + func(text) + '</p>';
     * });
     *
     * p('Fred, Wilma, & Pebbles');
     * // => '<p>Fred, Wilma, &amp; Pebbles</p>'
     */
    function wrap(value, wrapper) {
      return createWrapper(wrapper, 16, [value]);
    }

    /*--------------------------------------------------------------------------*/

    /**
     * Creates a function that returns `value`.
     *
     * @static
     * @memberOf _
     * @category Utilities
     * @param {*} value The value to return from the new function.
     * @returns {Function} Returns the new function.
     * @example
     *
     * var object = { 'name': 'fred' };
     * var getter = _.constant(object);
     * getter() === object;
     * // => true
     */
    function constant(value) {
      return function() {
        return value;
      };
    }

    /**
     * Produces a callback bound to an optional `thisArg`. If `func` is a property
     * name the created callback will return the property value for a given element.
     * If `func` is an object the created callback will return `true` for elements
     * that contain the equivalent object properties, otherwise it will return `false`.
     *
     * @static
     * @memberOf _
     * @category Utilities
     * @param {*} [func=identity] The value to convert to a callback.
     * @param {*} [thisArg] The `this` binding of the created callback.
     * @param {number} [argCount] The number of arguments the callback accepts.
     * @returns {Function} Returns a callback function.
     * @example
     *
     * var characters = [
     *   { 'name': 'barney', 'age': 36 },
     *   { 'name': 'fred',   'age': 40 }
     * ];
     *
     * // wrap to create custom callback shorthands
     * _.createCallback = _.wrap(_.createCallback, function(func, callback, thisArg) {
     *   var match = /^(.+?)__([gl]t)(.+)$/.exec(callback);
     *   return !match ? func(callback, thisArg) : function(object) {
     *     return match[2] == 'gt' ? object[match[1]] > match[3] : object[match[1]] < match[3];
     *   };
     * });
     *
     * _.filter(characters, 'age__gt38');
     * // => [{ 'name': 'fred', 'age': 40 }]
     */
    function createCallback(func, thisArg, argCount) {
      var type = typeof func;
      if (func == null || type == 'function') {
        return baseCreateCallback(func, thisArg, argCount);
      }
      // handle "_.pluck" style callback shorthands
      if (type != 'object') {
        return property(func);
      }
      var props = keys(func),
          key = props[0],
          a = func[key];

      // handle "_.where" style callback shorthands
      if (props.length == 1 && a === a && !isObject(a)) {
        // fast path the common case of providing an object with a single
        // property containing a primitive value
        return function(object) {
          var b = object[key];
          return a === b && (a !== 0 || (1 / a == 1 / b));
        };
      }
      return function(object) {
        var length = props.length,
            result = false;

        while (length--) {
          if (!(result = baseIsEqual(object[props[length]], func[props[length]], null, true))) {
            break;
          }
        }
        return result;
      };
    }

    /**
     * Converts the characters `&`, `<`, `>`, `"`, and `'` in `string` to their
     * corresponding HTML entities.
     *
     * @static
     * @memberOf _
     * @category Utilities
     * @param {string} string The string to escape.
     * @returns {string} Returns the escaped string.
     * @example
     *
     * _.escape('Fred, Wilma, & Pebbles');
     * // => 'Fred, Wilma, &amp; Pebbles'
     */
    function escape(string) {
      return string == null ? '' : String(string).replace(reUnescapedHtml, escapeHtmlChar);
    }

    /**
     * This method returns the first argument provided to it.
     *
     * @static
     * @memberOf _
     * @category Utilities
     * @param {*} value Any value.
     * @returns {*} Returns `value`.
     * @example
     *
     * var object = { 'name': 'fred' };
     * _.identity(object) === object;
     * // => true
     */
    function identity(value) {
      return value;
    }

    /**
     * Adds function properties of a source object to the destination object.
     * If `object` is a function methods will be added to its prototype as well.
     *
     * @static
     * @memberOf _
     * @category Utilities
     * @param {Function|Object} [object=lodash] object The destination object.
     * @param {Object} source The object of functions to add.
     * @param {Object} [options] The options object.
     * @param {boolean} [options.chain=true] Specify whether the functions added are chainable.
     * @example
     *
     * function capitalize(string) {
     *   return string.charAt(0).toUpperCase() + string.slice(1).toLowerCase();
     * }
     *
     * _.mixin({ 'capitalize': capitalize });
     * _.capitalize('fred');
     * // => 'Fred'
     *
     * _('fred').capitalize().value();
     * // => 'Fred'
     *
     * _.mixin({ 'capitalize': capitalize }, { 'chain': false });
     * _('fred').capitalize();
     * // => 'Fred'
     */
    function mixin(object, source, options) {
      var chain = true,
          methodNames = source && functions(source);

      if (!source || (!options && !methodNames.length)) {
        if (options == null) {
          options = source;
        }
        ctor = lodashWrapper;
        source = object;
        object = lodash;
        methodNames = functions(source);
      }
      if (options === false) {
        chain = false;
      } else if (isObject(options) && 'chain' in options) {
        chain = options.chain;
      }
      var ctor = object,
          isFunc = isFunction(ctor);

      forEach(methodNames, function(methodName) {
        var func = object[methodName] = source[methodName];
        if (isFunc) {
          ctor.prototype[methodName] = function() {
            var chainAll = this.__chain__,
                value = this.__wrapped__,
                args = [value];

            push.apply(args, arguments);
            var result = func.apply(object, args);
            if (chain || chainAll) {
              if (value === result && isObject(result)) {
                return this;
              }
              result = new ctor(result);
              result.__chain__ = chainAll;
            }
            return result;
          };
        }
      });
    }

    /**
     * Reverts the '_' variable to its previous value and returns a reference to
     * the `lodash` function.
     *
     * @static
     * @memberOf _
     * @category Utilities
     * @returns {Function} Returns the `lodash` function.
     * @example
     *
     * var lodash = _.noConflict();
     */
    function noConflict() {
      context._ = oldDash;
      return this;
    }

    /**
     * A no-operation function.
     *
     * @static
     * @memberOf _
     * @category Utilities
     * @example
     *
     * var object = { 'name': 'fred' };
     * _.noop(object) === undefined;
     * // => true
     */
    function noop() {
      // no operation performed
    }

    /**
     * Gets the number of milliseconds that have elapsed since the Unix epoch
     * (1 January 1970 00:00:00 UTC).
     *
     * @static
     * @memberOf _
     * @category Utilities
     * @example
     *
     * var stamp = _.now();
     * _.defer(function() { console.log(_.now() - stamp); });
     * // => logs the number of milliseconds it took for the deferred function to be called
     */
    var now = isNative(now = Date.now) && now || function() {
      return new Date().getTime();
    };

    /**
     * Converts the given value into an integer of the specified radix.
     * If `radix` is `undefined` or `0` a `radix` of `10` is used unless the
     * `value` is a hexadecimal, in which case a `radix` of `16` is used.
     *
     * Note: This method avoids differences in native ES3 and ES5 `parseInt`
     * implementations. See http://es5.github.io/#E.
     *
     * @static
     * @memberOf _
     * @category Utilities
     * @param {string} value The value to parse.
     * @param {number} [radix] The radix used to interpret the value to parse.
     * @returns {number} Returns the new integer value.
     * @example
     *
     * _.parseInt('08');
     * // => 8
     */
    var parseInt = nativeParseInt(whitespace + '08') == 8 ? nativeParseInt : function(value, radix) {
      // Firefox < 21 and Opera < 15 follow the ES3 specified implementation of `parseInt`
      return nativeParseInt(isString(value) ? value.replace(reLeadingSpacesAndZeros, '') : value, radix || 0);
    };

    /**
     * Creates a "_.pluck" style function, which returns the `key` value of a
     * given object.
     *
     * @static
     * @memberOf _
     * @category Utilities
     * @param {string} key The name of the property to retrieve.
     * @returns {Function} Returns the new function.
     * @example
     *
     * var characters = [
     *   { 'name': 'fred',   'age': 40 },
     *   { 'name': 'barney', 'age': 36 }
     * ];
     *
     * var getName = _.property('name');
     *
     * _.map(characters, getName);
     * // => ['barney', 'fred']
     *
     * _.sortBy(characters, getName);
     * // => [{ 'name': 'barney', 'age': 36 }, { 'name': 'fred',   'age': 40 }]
     */
    function property(key) {
      return function(object) {
        return object[key];
      };
    }

    /**
     * Produces a random number between `min` and `max` (inclusive). If only one
     * argument is provided a number between `0` and the given number will be
     * returned. If `floating` is truey or either `min` or `max` are floats a
     * floating-point number will be returned instead of an integer.
     *
     * @static
     * @memberOf _
     * @category Utilities
     * @param {number} [min=0] The minimum possible value.
     * @param {number} [max=1] The maximum possible value.
     * @param {boolean} [floating=false] Specify returning a floating-point number.
     * @returns {number} Returns a random number.
     * @example
     *
     * _.random(0, 5);
     * // => an integer between 0 and 5
     *
     * _.random(5);
     * // => also an integer between 0 and 5
     *
     * _.random(5, true);
     * // => a floating-point number between 0 and 5
     *
     * _.random(1.2, 5.2);
     * // => a floating-point number between 1.2 and 5.2
     */
    function random(min, max, floating) {
      var noMin = min == null,
          noMax = max == null;

      if (floating == null) {
        if (typeof min == 'boolean' && noMax) {
          floating = min;
          min = 1;
        }
        else if (!noMax && typeof max == 'boolean') {
          floating = max;
          noMax = true;
        }
      }
      if (noMin && noMax) {
        max = 1;
      }
      min = +min || 0;
      if (noMax) {
        max = min;
        min = 0;
      } else {
        max = +max || 0;
      }
      if (floating || min % 1 || max % 1) {
        var rand = nativeRandom();
        return nativeMin(min + (rand * (max - min + parseFloat('1e-' + ((rand +'').length - 1)))), max);
      }
      return baseRandom(min, max);
    }

    /**
     * Resolves the value of property `key` on `object`. If `key` is a function
     * it will be invoked with the `this` binding of `object` and its result returned,
     * else the property value is returned. If `object` is falsey then `undefined`
     * is returned.
     *
     * @static
     * @memberOf _
     * @category Utilities
     * @param {Object} object The object to inspect.
     * @param {string} key The name of the property to resolve.
     * @returns {*} Returns the resolved value.
     * @example
     *
     * var object = {
     *   'cheese': 'crumpets',
     *   'stuff': function() {
     *     return 'nonsense';
     *   }
     * };
     *
     * _.result(object, 'cheese');
     * // => 'crumpets'
     *
     * _.result(object, 'stuff');
     * // => 'nonsense'
     */
    function result(object, key) {
      if (object) {
        var value = object[key];
        return isFunction(value) ? object[key]() : value;
      }
    }

    /**
     * A micro-templating method that handles arbitrary delimiters, preserves
     * whitespace, and correctly escapes quotes within interpolated code.
     *
     * Note: In the development build, `_.template` utilizes sourceURLs for easier
     * debugging. See http://www.html5rocks.com/en/tutorials/developertools/sourcemaps/#toc-sourceurl
     *
     * For more information on precompiling templates see:
     * http://lodash.com/custom-builds
     *
     * For more information on Chrome extension sandboxes see:
     * http://developer.chrome.com/stable/extensions/sandboxingEval.html
     *
     * @static
     * @memberOf _
     * @category Utilities
     * @param {string} text The template text.
     * @param {Object} data The data object used to populate the text.
     * @param {Object} [options] The options object.
     * @param {RegExp} [options.escape] The "escape" delimiter.
     * @param {RegExp} [options.evaluate] The "evaluate" delimiter.
     * @param {Object} [options.imports] An object to import into the template as local variables.
     * @param {RegExp} [options.interpolate] The "interpolate" delimiter.
     * @param {string} [sourceURL] The sourceURL of the template's compiled source.
     * @param {string} [variable] The data object variable name.
     * @returns {Function|string} Returns a compiled function when no `data` object
     *  is given, else it returns the interpolated text.
     * @example
     *
     * // using the "interpolate" delimiter to create a compiled template
     * var compiled = _.template('hello <%= name %>');
     * compiled({ 'name': 'fred' });
     * // => 'hello fred'
     *
     * // using the "escape" delimiter to escape HTML in data property values
     * _.template('<b><%- value %></b>', { 'value': '<script>' });
     * // => '<b>&lt;script&gt;</b>'
     *
     * // using the "evaluate" delimiter to generate HTML
     * var list = '<% _.forEach(people, function(name) { %><li><%- name %></li><% }); %>';
     * _.template(list, { 'people': ['fred', 'barney'] });
     * // => '<li>fred</li><li>barney</li>'
     *
     * // using the ES6 delimiter as an alternative to the default "interpolate" delimiter
     * _.template('hello ${ name }', { 'name': 'pebbles' });
     * // => 'hello pebbles'
     *
     * // using the internal `print` function in "evaluate" delimiters
     * _.template('<% print("hello " + name); %>!', { 'name': 'barney' });
     * // => 'hello barney!'
     *
     * // using a custom template delimiters
     * _.templateSettings = {
     *   'interpolate': /{{([\s\S]+?)}}/g
     * };
     *
     * _.template('hello {{ name }}!', { 'name': 'mustache' });
     * // => 'hello mustache!'
     *
     * // using the `imports` option to import jQuery
     * var list = '<% jq.each(people, function(name) { %><li><%- name %></li><% }); %>';
     * _.template(list, { 'people': ['fred', 'barney'] }, { 'imports': { 'jq': jQuery } });
     * // => '<li>fred</li><li>barney</li>'
     *
     * // using the `sourceURL` option to specify a custom sourceURL for the template
     * var compiled = _.template('hello <%= name %>', null, { 'sourceURL': '/basic/greeting.jst' });
     * compiled(data);
     * // => find the source of "greeting.jst" under the Sources tab or Resources panel of the web inspector
     *
     * // using the `variable` option to ensure a with-statement isn't used in the compiled template
     * var compiled = _.template('hi <%= data.name %>!', null, { 'variable': 'data' });
     * compiled.source;
     * // => function(data) {
     *   var __t, __p = '', __e = _.escape;
     *   __p += 'hi ' + ((__t = ( data.name )) == null ? '' : __t) + '!';
     *   return __p;
     * }
     *
     * // using the `source` property to inline compiled templates for meaningful
     * // line numbers in error messages and a stack trace
     * fs.writeFileSync(path.join(cwd, 'jst.js'), '\
     *   var JST = {\
     *     "main": ' + _.template(mainText).source + '\
     *   };\
     * ');
     */
    function template(text, data, options) {
      // based on John Resig's `tmpl` implementation
      // http://ejohn.org/blog/javascript-micro-templating/
      // and Laura Doktorova's doT.js
      // https://github.com/olado/doT
      var settings = lodash.templateSettings;
      text = String(text || '');

      // avoid missing dependencies when `iteratorTemplate` is not defined
      options = defaults({}, options, settings);

      var imports = defaults({}, options.imports, settings.imports),
          importsKeys = keys(imports),
          importsValues = values(imports);

      var isEvaluating,
          index = 0,
          interpolate = options.interpolate || reNoMatch,
          source = "__p += '";

      // compile the regexp to match each delimiter
      var reDelimiters = RegExp(
        (options.escape || reNoMatch).source + '|' +
        interpolate.source + '|' +
        (interpolate === reInterpolate ? reEsTemplate : reNoMatch).source + '|' +
        (options.evaluate || reNoMatch).source + '|$'
      , 'g');

      text.replace(reDelimiters, function(match, escapeValue, interpolateValue, esTemplateValue, evaluateValue, offset) {
        interpolateValue || (interpolateValue = esTemplateValue);

        // escape characters that cannot be included in string literals
        source += text.slice(index, offset).replace(reUnescapedString, escapeStringChar);

        // replace delimiters with snippets
        if (escapeValue) {
          source += "' +\n__e(" + escapeValue + ") +\n'";
        }
        if (evaluateValue) {
          isEvaluating = true;
          source += "';\n" + evaluateValue + ";\n__p += '";
        }
        if (interpolateValue) {
          source += "' +\n((__t = (" + interpolateValue + ")) == null ? '' : __t) +\n'";
        }
        index = offset + match.length;

        // the JS engine embedded in Adobe products requires returning the `match`
        // string in order to produce the correct `offset` value
        return match;
      });

      source += "';\n";

      // if `variable` is not specified, wrap a with-statement around the generated
      // code to add the data object to the top of the scope chain
      var variable = options.variable,
          hasVariable = variable;

      if (!hasVariable) {
        variable = 'obj';
        source = 'with (' + variable + ') {\n' + source + '\n}\n';
      }
      // cleanup code by stripping empty strings
      source = (isEvaluating ? source.replace(reEmptyStringLeading, '') : source)
        .replace(reEmptyStringMiddle, '$1')
        .replace(reEmptyStringTrailing, '$1;');

      // frame code as the function body
      source = 'function(' + variable + ') {\n' +
        (hasVariable ? '' : variable + ' || (' + variable + ' = {});\n') +
        "var __t, __p = '', __e = _.escape" +
        (isEvaluating
          ? ', __j = Array.prototype.join;\n' +
            "function print() { __p += __j.call(arguments, '') }\n"
          : ';\n'
        ) +
        source +
        'return __p\n}';

      // Use a sourceURL for easier debugging.
      // http://www.html5rocks.com/en/tutorials/developertools/sourcemaps/#toc-sourceurl
      var sourceURL = '\n/*\n//# sourceURL=' + (options.sourceURL || '/lodash/template/source[' + (templateCounter++) + ']') + '\n*/';

      try {
        var result = Function(importsKeys, 'return ' + source + sourceURL).apply(undefined, importsValues);
      } catch(e) {
        e.source = source;
        throw e;
      }
      if (data) {
        return result(data);
      }
      // provide the compiled function's source by its `toString` method, in
      // supported environments, or the `source` property as a convenience for
      // inlining compiled templates during the build process
      result.source = source;
      return result;
    }

    /**
     * Executes the callback `n` times, returning an array of the results
     * of each callback execution. The callback is bound to `thisArg` and invoked
     * with one argument; (index).
     *
     * @static
     * @memberOf _
     * @category Utilities
     * @param {number} n The number of times to execute the callback.
     * @param {Function} callback The function called per iteration.
     * @param {*} [thisArg] The `this` binding of `callback`.
     * @returns {Array} Returns an array of the results of each `callback` execution.
     * @example
     *
     * var diceRolls = _.times(3, _.partial(_.random, 1, 6));
     * // => [3, 6, 4]
     *
     * _.times(3, function(n) { mage.castSpell(n); });
     * // => calls `mage.castSpell(n)` three times, passing `n` of `0`, `1`, and `2` respectively
     *
     * _.times(3, function(n) { this.cast(n); }, mage);
     * // => also calls `mage.castSpell(n)` three times
     */
    function times(n, callback, thisArg) {
      n = (n = +n) > -1 ? n : 0;
      var index = -1,
          result = Array(n);

      callback = baseCreateCallback(callback, thisArg, 1);
      while (++index < n) {
        result[index] = callback(index);
      }
      return result;
    }

    /**
     * The inverse of `_.escape` this method converts the HTML entities
     * `&amp;`, `&lt;`, `&gt;`, `&quot;`, and `&#39;` in `string` to their
     * corresponding characters.
     *
     * @static
     * @memberOf _
     * @category Utilities
     * @param {string} string The string to unescape.
     * @returns {string} Returns the unescaped string.
     * @example
     *
     * _.unescape('Fred, Barney &amp; Pebbles');
     * // => 'Fred, Barney & Pebbles'
     */
    function unescape(string) {
      return string == null ? '' : String(string).replace(reEscapedHtml, unescapeHtmlChar);
    }

    /**
     * Generates a unique ID. If `prefix` is provided the ID will be appended to it.
     *
     * @static
     * @memberOf _
     * @category Utilities
     * @param {string} [prefix] The value to prefix the ID with.
     * @returns {string} Returns the unique ID.
     * @example
     *
     * _.uniqueId('contact_');
     * // => 'contact_104'
     *
     * _.uniqueId();
     * // => '105'
     */
    function uniqueId(prefix) {
      var id = ++idCounter;
      return String(prefix == null ? '' : prefix) + id;
    }

    /*--------------------------------------------------------------------------*/

    /**
     * Creates a `lodash` object that wraps the given value with explicit
     * method chaining enabled.
     *
     * @static
     * @memberOf _
     * @category Chaining
     * @param {*} value The value to wrap.
     * @returns {Object} Returns the wrapper object.
     * @example
     *
     * var characters = [
     *   { 'name': 'barney',  'age': 36 },
     *   { 'name': 'fred',    'age': 40 },
     *   { 'name': 'pebbles', 'age': 1 }
     * ];
     *
     * var youngest = _.chain(characters)
     *     .sortBy('age')
     *     .map(function(chr) { return chr.name + ' is ' + chr.age; })
     *     .first()
     *     .value();
     * // => 'pebbles is 1'
     */
    function chain(value) {
      value = new lodashWrapper(value);
      value.__chain__ = true;
      return value;
    }

    /**
     * Invokes `interceptor` with the `value` as the first argument and then
     * returns `value`. The purpose of this method is to "tap into" a method
     * chain in order to perform operations on intermediate results within
     * the chain.
     *
     * @static
     * @memberOf _
     * @category Chaining
     * @param {*} value The value to provide to `interceptor`.
     * @param {Function} interceptor The function to invoke.
     * @returns {*} Returns `value`.
     * @example
     *
     * _([1, 2, 3, 4])
     *  .tap(function(array) { array.pop(); })
     *  .reverse()
     *  .value();
     * // => [3, 2, 1]
     */
    function tap(value, interceptor) {
      interceptor(value);
      return value;
    }

    /**
     * Enables explicit method chaining on the wrapper object.
     *
     * @name chain
     * @memberOf _
     * @category Chaining
     * @returns {*} Returns the wrapper object.
     * @example
     *
     * var characters = [
     *   { 'name': 'barney', 'age': 36 },
     *   { 'name': 'fred',   'age': 40 }
     * ];
     *
     * // without explicit chaining
     * _(characters).first();
     * // => { 'name': 'barney', 'age': 36 }
     *
     * // with explicit chaining
     * _(characters).chain()
     *   .first()
     *   .pick('age')
     *   .value();
     * // => { 'age': 36 }
     */
    function wrapperChain() {
      this.__chain__ = true;
      return this;
    }

    /**
     * Produces the `toString` result of the wrapped value.
     *
     * @name toString
     * @memberOf _
     * @category Chaining
     * @returns {string} Returns the string result.
     * @example
     *
     * _([1, 2, 3]).toString();
     * // => '1,2,3'
     */
    function wrapperToString() {
      return String(this.__wrapped__);
    }

    /**
     * Extracts the wrapped value.
     *
     * @name valueOf
     * @memberOf _
     * @alias value
     * @category Chaining
     * @returns {*} Returns the wrapped value.
     * @example
     *
     * _([1, 2, 3]).valueOf();
     * // => [1, 2, 3]
     */
    function wrapperValueOf() {
      return this.__wrapped__;
    }

    /*--------------------------------------------------------------------------*/

    // add functions that return wrapped values when chaining
    lodash.after = after;
    lodash.assign = assign;
    lodash.at = at;
    lodash.bind = bind;
    lodash.bindAll = bindAll;
    lodash.bindKey = bindKey;
    lodash.chain = chain;
    lodash.compact = compact;
    lodash.compose = compose;
    lodash.constant = constant;
    lodash.countBy = countBy;
    lodash.create = create;
    lodash.createCallback = createCallback;
    lodash.curry = curry;
    lodash.debounce = debounce;
    lodash.defaults = defaults;
    lodash.defer = defer;
    lodash.delay = delay;
    lodash.difference = difference;
    lodash.filter = filter;
    lodash.flatten = flatten;
    lodash.forEach = forEach;
    lodash.forEachRight = forEachRight;
    lodash.forIn = forIn;
    lodash.forInRight = forInRight;
    lodash.forOwn = forOwn;
    lodash.forOwnRight = forOwnRight;
    lodash.functions = functions;
    lodash.groupBy = groupBy;
    lodash.indexBy = indexBy;
    lodash.initial = initial;
    lodash.intersection = intersection;
    lodash.invert = invert;
    lodash.invoke = invoke;
    lodash.keys = keys;
    lodash.map = map;
    lodash.mapValues = mapValues;
    lodash.max = max;
    lodash.memoize = memoize;
    lodash.merge = merge;
    lodash.min = min;
    lodash.omit = omit;
    lodash.once = once;
    lodash.pairs = pairs;
    lodash.partial = partial;
    lodash.partialRight = partialRight;
    lodash.pick = pick;
    lodash.pluck = pluck;
    lodash.property = property;
    lodash.pull = pull;
    lodash.range = range;
    lodash.reject = reject;
    lodash.remove = remove;
    lodash.rest = rest;
    lodash.shuffle = shuffle;
    lodash.sortBy = sortBy;
    lodash.tap = tap;
    lodash.throttle = throttle;
    lodash.times = times;
    lodash.toArray = toArray;
    lodash.transform = transform;
    lodash.union = union;
    lodash.uniq = uniq;
    lodash.values = values;
    lodash.where = where;
    lodash.without = without;
    lodash.wrap = wrap;
    lodash.xor = xor;
    lodash.zip = zip;
    lodash.zipObject = zipObject;

    // add aliases
    lodash.collect = map;
    lodash.drop = rest;
    lodash.each = forEach;
    lodash.eachRight = forEachRight;
    lodash.extend = assign;
    lodash.methods = functions;
    lodash.object = zipObject;
    lodash.select = filter;
    lodash.tail = rest;
    lodash.unique = uniq;
    lodash.unzip = zip;

    // add functions to `lodash.prototype`
    mixin(lodash);

    /*--------------------------------------------------------------------------*/

    // add functions that return unwrapped values when chaining
    lodash.clone = clone;
    lodash.cloneDeep = cloneDeep;
    lodash.contains = contains;
    lodash.escape = escape;
    lodash.every = every;
    lodash.find = find;
    lodash.findIndex = findIndex;
    lodash.findKey = findKey;
    lodash.findLast = findLast;
    lodash.findLastIndex = findLastIndex;
    lodash.findLastKey = findLastKey;
    lodash.has = has;
    lodash.identity = identity;
    lodash.indexOf = indexOf;
    lodash.isArguments = isArguments;
    lodash.isArray = isArray;
    lodash.isBoolean = isBoolean;
    lodash.isDate = isDate;
    lodash.isElement = isElement;
    lodash.isEmpty = isEmpty;
    lodash.isEqual = isEqual;
    lodash.isFinite = isFinite;
    lodash.isFunction = isFunction;
    lodash.isNaN = isNaN;
    lodash.isNull = isNull;
    lodash.isNumber = isNumber;
    lodash.isObject = isObject;
    lodash.isPlainObject = isPlainObject;
    lodash.isRegExp = isRegExp;
    lodash.isString = isString;
    lodash.isUndefined = isUndefined;
    lodash.lastIndexOf = lastIndexOf;
    lodash.mixin = mixin;
    lodash.noConflict = noConflict;
    lodash.noop = noop;
    lodash.now = now;
    lodash.parseInt = parseInt;
    lodash.random = random;
    lodash.reduce = reduce;
    lodash.reduceRight = reduceRight;
    lodash.result = result;
    lodash.runInContext = runInContext;
    lodash.size = size;
    lodash.some = some;
    lodash.sortedIndex = sortedIndex;
    lodash.template = template;
    lodash.unescape = unescape;
    lodash.uniqueId = uniqueId;

    // add aliases
    lodash.all = every;
    lodash.any = some;
    lodash.detect = find;
    lodash.findWhere = find;
    lodash.foldl = reduce;
    lodash.foldr = reduceRight;
    lodash.include = contains;
    lodash.inject = reduce;

    mixin(function() {
      var source = {}
      forOwn(lodash, function(func, methodName) {
        if (!lodash.prototype[methodName]) {
          source[methodName] = func;
        }
      });
      return source;
    }(), false);

    /*--------------------------------------------------------------------------*/

    // add functions capable of returning wrapped and unwrapped values when chaining
    lodash.first = first;
    lodash.last = last;
    lodash.sample = sample;

    // add aliases
    lodash.take = first;
    lodash.head = first;

    forOwn(lodash, function(func, methodName) {
      var callbackable = methodName !== 'sample';
      if (!lodash.prototype[methodName]) {
        lodash.prototype[methodName]= function(n, guard) {
          var chainAll = this.__chain__,
              result = func(this.__wrapped__, n, guard);

          return !chainAll && (n == null || (guard && !(callbackable && typeof n == 'function')))
            ? result
            : new lodashWrapper(result, chainAll);
        };
      }
    });

    /*--------------------------------------------------------------------------*/

    /**
     * The semantic version number.
     *
     * @static
     * @memberOf _
     * @type string
     */
    lodash.VERSION = '2.4.1';

    // add "Chaining" functions to the wrapper
    lodash.prototype.chain = wrapperChain;
    lodash.prototype.toString = wrapperToString;
    lodash.prototype.value = wrapperValueOf;
    lodash.prototype.valueOf = wrapperValueOf;

    // add `Array` functions that return unwrapped values
    forEach(['join', 'pop', 'shift'], function(methodName) {
      var func = arrayRef[methodName];
      lodash.prototype[methodName] = function() {
        var chainAll = this.__chain__,
            result = func.apply(this.__wrapped__, arguments);

        return chainAll
          ? new lodashWrapper(result, chainAll)
          : result;
      };
    });

    // add `Array` functions that return the existing wrapped value
    forEach(['push', 'reverse', 'sort', 'unshift'], function(methodName) {
      var func = arrayRef[methodName];
      lodash.prototype[methodName] = function() {
        func.apply(this.__wrapped__, arguments);
        return this;
      };
    });

    // add `Array` functions that return new wrapped values
    forEach(['concat', 'slice', 'splice'], function(methodName) {
      var func = arrayRef[methodName];
      lodash.prototype[methodName] = function() {
        return new lodashWrapper(func.apply(this.__wrapped__, arguments), this.__chain__);
      };
    });

    return lodash;
  }

  /*--------------------------------------------------------------------------*/

  // expose Lo-Dash
  var _ = runInContext();

  // some AMD build optimizers like r.js check for condition patterns like the following:
  if (typeof define == 'function' && typeof define.amd == 'object' && define.amd) {
    // Expose Lo-Dash to the global object even when an AMD loader is present in
    // case Lo-Dash is loaded with a RequireJS shim config.
    // See http://requirejs.org/docs/api.html#config-shim
    root._ = _;

    // define as an anonymous module so, through path mapping, it can be
    // referenced as the "underscore" module
    define(function() {
      return _;
    });
  }
  // check for `exports` after `define` in case a build optimizer adds an `exports` object
  else if (freeExports && freeModule) {
    // in Node.js or RingoJS
    if (moduleExports) {
      (freeModule.exports = _)._ = _;
    }
    // in Narwhal or Rhino -require
    else {
      freeExports._ = _;
    }
  }
  else {
    // in a browser or Rhino
    root._ = _;
  }
}.call(this));

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],4:[function(require,module,exports){
/*
 * Copyright (c) 2014 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

/**
 * This module defines a TilePyramid class, the equivalent of AOITilePyramid in
 * binning-utilities.
 */
( function() {
    
	"use strict";

	function AreaOfInterestTilePyramid( spec ) {
        this.minX = spec.minX;
        this.minY = spec.minY;
        this.maxX = spec.maxX;
        this.maxY = spec.maxY;
    }

    AreaOfInterestTilePyramid.prototype.getProjection = function() {
        return "EPSG:4326";
    };

	AreaOfInterestTilePyramid.prototype.getTileScheme = function() {
        return "TMS";
    };

	AreaOfInterestTilePyramid.prototype.rootToFractionalTile = function( root ) {
        var numDivs, tileX, tileY;
        numDivs = 1 << root.level;
        tileX = numDivs * (root.xIndex - this.minX) / (this.maxX - this.minX);
        tileY = numDivs * (root.yIndex - this.minY) / (this.maxY - this.minY);
        return {
            'level': root.level,
            'xIndex': tileX,
            'yIndex': tileY
        };
    };

    AreaOfInterestTilePyramid.prototype.fractionalTileToRoot = function( tile ) {
        var pow2, tileXSize, tileYSize;
        pow2 = 1 << tile.level;
        tileXSize = (this.maxX - this.minX) / pow2;
        tileYSize = (this.maxY - this.minY) / pow2;
        return {
            level: tile.level,
            xIndex: this.minX + tileXSize * tile.xIndex,
            yIndex: this.minY + tileYSize * tile.yIndex
        };
    };

    AreaOfInterestTilePyramid.prototype.rootToTile = function (x, y, level, bins) {
        var numDivs, tileX, tileY;
        numDivs = 1 << level;
        tileX = Math.floor(numDivs * (x - this.minX) / (this.maxX - this.minX));
        tileY = Math.floor(numDivs * (y - this.minY) / (this.maxY - this.minY));
        if (!bins) {
            bins = 256;
        }
        return {level:     level,
                xIndex:    tileX,
                yIndex:    tileY,
                xBinCount: bins,
                yBinCount: bins};
    };

    AreaOfInterestTilePyramid.prototype.rootToBin = function (x, y, tile) {
        var pow2, tileXSize, tileYSize, xInTile, yInTile, binX, binY;
        pow2 = 1 << tile.level;
        tileXSize = (this.maxX - this.minX) / pow2;
        tileYSize = (this.maxY - this.minY) / pow2;
        xInTile = x - this.minX - tile.xIndex * tileXSize;
        yInTile = y - this.minY - tile.yIndex * tileYSize;
        binX = Math.floor(xInTile * tile.xBinCount / tileXSize);
        binY = Math.floor(yInTile * tile.yBinCount / tileYSize);
        return {x: binX,
                y: tile.yBinCount - 1 - binY};
    };

    AreaOfInterestTilePyramid.prototype.getTileBounds = function (tile) {
        var pow2, tileXSize, tileYSize;
        pow2 = 1 << tile.level;
        tileXSize = (this.maxX - this.minX) / pow2;
        tileYSize = (this.maxY - this.minY) / pow2;
        return {minX: this.minX + tileXSize * tile.xIndex,
                minY: this.minY + tileYSize * tile.yIndex,
                maxX: this.minX + tileXSize * (tile.xIndex + 1),
                maxY: this.minY + tileYSize * (tile.yIndex + 1),
                centerX: this.minX + tileXSize * (tile.xIndex + 0.5),
                centerY: this.minY + tileYSize * (tile.yIndex + 0.5),
                width: tileXSize,
                height: tileYSize};
    };

    AreaOfInterestTilePyramid.prototype.getBinBounds = function (tile, bin) {
        var pow2, tileXSize, tileYSize, binXSize, binYSize, adjustedY,
            left, bottom;
        pow2 = 1 << tile.level;
        tileXSize = (this.maxX - this.minX) / pow2;
        tileYSize = (this.maxY - this.minY) / pow2;
        binXSize = tileXSize / tile.xBinCount;
        binYSize = tileYSize / tile.yBinCount;
        adjustedY = tile.yBinCount - 1 - bin.y;
        left = this.minX + tileXSize * tile.xIndex;
        bottom = this.minY + tileYSize * tile.yIndex;
        return {minX: left + binXSize * bin.x,
                minY: bottom + binYSize * adjustedY,
                maxX: left + binXSize * (bin.x + 1),
                maxY: bottom + binYSize * (adjustedY + 1),
                centerX: left + binXSize * (bin.x + 0.5),
                centerY: bottom + binYSize * (adjustedY + 0.5),
                width: binXSize,
                height: binYSize};
    };

    AreaOfInterestTilePyramid.prototype.toJSON = function () {
        return {
            "type": "AreaOfInterest",
            "minX": this.minX,
            "maxX": this.maxX,
            "minY": this.minY,
            "maxY": this.maxY
        };
    };

	module.exports = AreaOfInterestTilePyramid;

}());

},{}],5:[function(require,module,exports){
/*
 * Copyright (c) 2014 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

/**
 * This module defines a TileIterator class, the equivalent of TileIterator in
 * binning-utilities.
 */
( function() {

    "use strict";

    function TileIterator( spec ) {
        this.pyramid = spec.pyramid;
        this.level = spec.level;
        this.minTile = spec.pyramid.rootToTile( spec.minX, spec.minY, spec.level );
        this.maxTile = spec.pyramid.rootToTile( spec.maxX, spec.maxY, spec.level );
        this.curX = this.minTile.xIndex;
        this.curY = this.minTile.yIndex;
    }

    TileIterator.prototype.hasNext = function () {
        return (this.curX <= this.maxTile.xIndex &&
                this.curY <= this.maxTile.yIndex);
    };

    TileIterator.prototype.next = function () {
        var tile = {
            xIndex:    this.curX,
            yIndex:    this.curY,
            level:     this.level,
            xBinCount: 256,
            yBinCount: 256
        };
        this.curX = this.curX + 1;
        if (this.curX > this.maxTile.xIndex) {
            this.curX = this.minTile.xIndex;
            this.curY = this.curY + 1;
        }
        return tile;
    };

    TileIterator.prototype.getRest = function () {
        var all = [];
        while (this.hasNext()) {
            all[all.length] = this.next();
        }
        return all;
    };

    TileIterator.prototype.toString = function () {
        var srep = "", index;
        while (this.hasNext()) {
            if (srep.length > 0) {
                srep = srep + "|";
            }
            index = this.next();
            srep = srep + "["+index.xIndex+"/"+index.xBinCount+","+index.yIndex+"/"+index.yBinCount+", lvl "+index.level+"]";
        }
        return srep;
    };

    TileIterator.prototype.toTileBounds = function () {
        return {
            'minX': this.minTile.xIndex,
            'maxX': this.maxTile.xIndex,
            'minY': this.minTile.yIndex,
            'maxY': this.maxTile.yIndex,
            'minZ': this.level,
            'maxZ': this.level
        };
    };

    module.exports = TileIterator;
}());


},{}],6:[function(require,module,exports){
/*
 * Copyright (c) 2014 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

/**
 * This module defines a TilePyramid class, the equivalent of 
 * WebMercatorTilePyramid in binning-utilities.
 */
( function() {

	"use strict";

	var EPSG_900913_SCALE_FACTOR = 20037508.342789244,
	    EPSG_900913_LATITUDE = 85.05112878,
	    DEGREES_TO_RADIANS = Math.PI / 180.0,	// Factor for changing degrees to radians
	    RADIANS_TO_DEGREES = 180.0 / Math.PI,	// Factor for changing radians to degrees
	    rootToTileMercator, sinh, tileToLon, tileToLat,
	    linearToGudermannian,
	    gudermannianToLinear;

	rootToTileMercator = function (lon, lat, level) {
		var latR = lat * DEGREES_TO_RADIANS,
		    pow2 = 1 << level,
		    x    = (lon + 180.0) / 360.0 * pow2,
		    y    = (pow2 * (1 - Math.log(Math.tan(latR) + 1 / Math.cos(latR)) / Math.PI) / 2);
		return {x: x, y: pow2-y};
	};

	tileToLon = function (x, level) {
		var pow2 = 1 << level;
		return x / pow2 * 360.0 - 180.0;
	};

	sinh = function (arg) {
		return (Math.exp(arg) - Math.exp(-arg)) / 2.0;
	};

	tileToLat = function (y, level) {
		var pow2 = 1 << level,
		    n    = -Math.PI + (2.0 * Math.PI * y) / pow2;
		return Math.atan(sinh(n)) * RADIANS_TO_DEGREES;
	};

	linearToGudermannian = function(value) {
		var gudermannian = function(y) {
			// converts a y value from -PI(bottom) to PI(top) into the
			// mercator projection latitude
			var sinh = function (arg) {
				return (Math.exp(arg) - Math.exp(-arg)) / 2.0;
			};
			return Math.atan(sinh(y)) * RADIANS_TO_DEGREES;
		};
		return gudermannian( (value / EPSG_900913_LATITUDE) * Math.PI );
	};

	gudermannianToLinear = function(value) {
		var gudermannianInv = function( latitude ) {
			// converts a latitude value from -EPSG_900913_LATITUDE to EPSG_900913_LATITUDE into
			// a y value from -PI(bottom) to PI(top)
			var sign = ( latitude !== 0 ) ? latitude / Math.abs(latitude) : 0,
			    sin = Math.sin(latitude * DEGREES_TO_RADIANS * sign);

			return sign * (Math.log((1.0 + sin) / (1.0 - sin)) / 2.0);
		};
		return (gudermannianInv( value ) / Math.PI) * EPSG_900913_LATITUDE;
	};

	function WebMercatorTilePyramid() {
        this.minX = -180.0;
        this.minY = -85.05;
        this.maxX = 180.0;
        this.maxY = 85.05;
        return this;
    }

    WebMercatorTilePyramid.prototype.getProjection = function(){
        return "EPSG:900913";
    };

    WebMercatorTilePyramid.prototype.getTileScheme = function() {
        return "TMS";
    };

    WebMercatorTilePyramid.prototype.getEPSG900913Bounds = function( tile, bin ) {
        var pow2          = 1 << tile.level,
            tileIncrement = 1.0/pow2,
            minX          = tile.xIndex * tileIncrement - 0.5,
            minY          = tile.yIndex * tileIncrement - 0.5,
            maxX, maxY, binXInc, binYInc;

        if (bin) {
            maxX = minX + tileIncrement;
            maxY = minY + tileIncrement;
        } else {
            binXInc = tileIncrement / tile.xBinCount;
            binYInc = tileIncrement / tile.yBinCount;
            minX = minX + bin.x * binXInc;
            minY = minY + (tile.yBinCount - bin.y - 1) * binYInc;
            maxX = minX + binXInc;
            maxY = minY + binYInc;
        }

        return {
            minX:    minX * 2.0 * EPSG_900913_SCALE_FACTOR,
            minY:    minY * 2.0 * EPSG_900913_SCALE_FACTOR,
            maxX:    maxX * 2.0 * EPSG_900913_SCALE_FACTOR,
            maxY:    maxY * 2.0 * EPSG_900913_SCALE_FACTOR,
            centerX: (minX + maxX) * EPSG_900913_SCALE_FACTOR,
            centerY: (minY + maxY) * EPSG_900913_SCALE_FACTOR,
            width:   (maxX - minX) * 2.0 * EPSG_900913_SCALE_FACTOR,
            height:  (maxY - minY) * 2.0 * EPSG_900913_SCALE_FACTOR
        };
    };

    WebMercatorTilePyramid.prototype.rootToFractionalTile = function( root ) {
        var tileMercator = rootToTileMercator(root.xIndex, root.yIndex, root.level);
        return {
            'level': root.level,
            'xIndex': tileMercator.x,
            'yIndex': tileMercator.y
        };
    };

    WebMercatorTilePyramid.prototype.fractionalTileToRoot = function( tile ) {
        return {
            level: tile.level,
            xIndex: tileToLon(tile.xIndex, tile.level),
            yIndex: tileToLat(tile.yIndex, tile.level)
        };
    };

    WebMercatorTilePyramid.prototype.rootToTile = function (lon, lat, level, bins) {
        if (!bins) {
            bins = 256;
        }
        var tileMercator = rootToTileMercator(lon, lat, level);
        return {
            level:     level,
            xIndex:    Math.floor(tileMercator.x),
            yIndex:    Math.floor(tileMercator.y),
            xBinCount: bins,
            yBinCount: bins
        };
    };

    WebMercatorTilePyramid.prototype.rootToBin = function( x, y, tile ) {
        var tileMercator = rootToTileMercator(x, y, tile.level);
        return {
            x: Math.floor((tileMercator.x - tile.xIndex) * tile.xBinCount),
            y: tile.yBinCount - 1 - Math.floor((tileMercator.y - tile.yIndex)
                                               * tile.yBinCount)
        };
    };

    WebMercatorTilePyramid.prototype.getTileBounds = function( tile ) {
        var level = tile.level,
            north = tileToLat(tile.yIndex+1, level),
            south = tileToLat(tile.yIndex, level),
            east  = tileToLon(tile.xIndex+1, level),
            west  = tileToLon(tile.xIndex, level),
            // as mercator latitude cannot be linearly interpolated, convert the gudermannian
            // coordinates back into their equivalent linear counterparts. Interpolate these,
            // then convert to the equivalent gudermannian coordinate.
            linNorth = gudermannianToLinear(north),
            linSouth = gudermannianToLinear(south),
            centerY = linearToGudermannian( (linNorth+linSouth)/2.0 );
        return {
            minX:    west,
            minY:    south,
            maxX:    east,
            maxY:    north,
            centerX: (east+west)/2.0,
            centerY: centerY,
            width:   (east-west),
            height:  (north-south)
        };
    };

    WebMercatorTilePyramid.prototype.getBinBounds = function( tile, bin ) {
        var level   = tile.level,
            binXInc = 1.0 / tile.xBinCount,
            baseX   = tile.xIndex + bin.x * binXInc,
            binYInc = 1.0 / tile.yBinCount,
            baseY   = tile.yIndex + (tile.yBinCount - 1 - bin.y) * binYInc,
            north   = tileToLat(baseY + binYInc, level),
            south   = tileToLat(baseY, level),
            east    = tileToLon(baseX + binXInc, level),
            west    = tileToLon(baseX, level),
            // as mercator latitude cannot be linearly interpolated, convert the gudermannian
            // coordinates back into their equivalent linear counterparts. Interpolate these,
            // then convert to the equivalent gudermannian coordinate.
            linNorth = gudermannianToLinear(north),
            linSouth = gudermannianToLinear(south),
            centerY = linearToGudermannian( (linNorth+linSouth)/2.0 );
        return {
            minX:    west,
            minY:    south,
            maxX:    east,
            maxY:    north,
            centerX: (east+west)/2.0,
            centerY: centerY,
            width:   (east-west),
            height:  (north-south)
        };
    };

    WebMercatorTilePyramid.prototype.toJSON = function () {
        return {
            "type": "WebMercator"
        };
    };

	module.exports = WebMercatorTilePyramid;
}());


},{}],7:[function(require,module,exports){
/*
 * Copyright (c) 2014 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

( function() {

    "use strict";

    var OpenLayers = require('../openlayers/OpenLayers.min'),
        $ = require('jquery'),
        Layer = require('./Layer'),
        LayerUtil = require('./LayerUtil'),
        AnnotationService = require('../rest/AnnotationService'),
        HtmlTileLayer = require('./HtmlTileLayer'),
        PubSub = require('../util/PubSub');

    function AnnotationLayer( spec ) {
        // set reasonable defaults
        spec.enabled = ( spec.enabled !== undefined ) ? spec.enabled : true;
        spec.opacity = ( spec.opacity !== undefined ) ? spec.opacity : 1.0;
        spec.zIndex = ( spec.zIndex !== undefined ) ? spec.zIndex : 500;
        spec.domain = "annotation";
        // call base constructor    
        Layer.call( this, spec );
    }

    AnnotationLayer.prototype = Object.create( Layer.prototype );

    AnnotationLayer.prototype.activate = function() {

        // add the new layer
        this.olLayer = new HtmlTileLayer(
            'Annotation Tile Layer',
            this.spec.source.tms,
            {
                layername: this.spec.source.id,
                type: 'json',
                maxExtent: new OpenLayers.Bounds(-20037500, -20037500,
                    20037500,  20037500),
                isBaseLayer: false,
                getURL: LayerUtil.getURL,
                html: this.spec.html,
                renderer: this.spec.renderer,
                entry: this.spec.entry
            });

        this.map.olMap.addLayer( this.olLayer );

        this.setZIndex( this.spec.zIndex );
        this.setOpacity( this.spec.opacity );
        this.setVisibility( this.spec.enabled );
        this.setTheme( this.map.getTheme() );

        if ( this.spec.renderer ) {
            this.spec.renderer.meta = this.spec.source.meta.meta;
            this.spec.renderer.map = this.map;
            this.spec.renderer.parent = this;
        }
    };

    AnnotationLayer.prototype.deactivate = function() {
        if ( this.olLayer ) {
            this.map.olMap.removeLayer( this.olLayer );
            this.olLayer.destroy();
        }
    };

    /**
     * Updates the theme associated with the layer
     */
    AnnotationLayer.prototype.setTheme = function( theme ) {
        this.spec.theme = theme;
    };

    /**
     * Get the current theme for the layer
     */
    AnnotationLayer.prototype.getTheme = function() {
        return this.spec.theme;
    };

    /**
     * @param {number} zIndex - The new z-order value of the layer, where 0 is front.
     */
    AnnotationLayer.prototype.setZIndex = function ( zIndex ) {
        // we by-pass the OpenLayers.Map.setLayerIndex() method and manually
        // set the z-index of the layer dev. setLayerIndex sets a relative
        // index based on current map layers, which then sets a z-index. This
        // caused issues with async layer loading.
        this.spec.zIndex = zIndex;
        $( this.olLayer.div ).css( 'z-index', zIndex );
        PubSub.publish( this.getChannel(), { field: 'zIndex', value: zIndex });
    };

    /**
     * Get the layers zIndex
     */
    AnnotationLayer.prototype.getZIndex = function () {
        return this.spec.zIndex;
    };

    /**
     * Create the a new annotation
     */
    AnnotationLayer.prototype.write = function( position ) {

        var that = this,
            coord;

        // temp for debug writing
        function DEBUG_ANNOTATION( coord ) {
            var randomGroupIndex = Math.floor( that.spec.groups.length*Math.random() );
            return {
                x: coord.x,
                y: coord.y,
                group: that.spec.groups[ randomGroupIndex ],
                range: {
                    min: 0,
                    max: that.map.getZoom()
                },
                level: that.map.getZoom(),
                data: {}
            };
        }

        // get position and tilekey for annotation
        coord = this.map.getCoordFromViewportPixel( position.x, position.y );

        // write annotation
        AnnotationService.writeAnnotation(
            this.spec.source.id,
            DEBUG_ANNOTATION( coord ),
            function() {
               // TODO: refresh tile
                return true;
            });
    };

    /**
     * Modify an existing annotation
     */
    AnnotationLayer.prototype.modify = function( annotation ) {
        AnnotationService.modifyAnnotation(
            this.spec.source.id,
            annotation,
            function() {
               // TODO: refresh tile
                return true;
            });
    };

    /**
     * Remove an existing annotation.
     */
    AnnotationLayer.prototype.remove = function( annotation ) {
        AnnotationService.removeAnnotation(
            this.spec.source.id,
            annotation.certificate,
            function() {
               // TODO: refresh tile
                return true;
            });
    };

    module.exports = AnnotationLayer;
}());

},{"../openlayers/OpenLayers.min":29,"../rest/AnnotationService":30,"../util/PubSub":35,"./HtmlTileLayer":11,"./Layer":12,"./LayerUtil":13,"jquery":2}],8:[function(require,module,exports){
/*
 * Copyright (c) 2014 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

/*global google */
( function() {

	"use strict";

	var OpenLayers = require('../openlayers/OpenLayers.min'),
        Layer = require('./Layer');
        
	function BaseLayer( spec ) {
        // set defaults
        spec = spec || {};
        spec.opacity = ( spec.opacity !== undefined ) ? spec.opacity : 1.0;
        spec.enabled = ( spec.enabled !== undefined ) ? spec.enabled : true;
        spec.type = spec.type || "Blank";
        spec.options = spec.options || {
            name : "black",
            color : "rgb(0,0,0)"
        };
        spec.domain = "base";
        // call base constructor
        Layer.call( this, spec );
    }

    BaseLayer.prototype = Object.create( Layer.prototype );

    BaseLayer.prototype.activate = function() {

        var spec = this.spec,
            styledMapType;

        switch ( this.spec.type ) {

            case "Blank":

                this.olLayer = new OpenLayers.Layer.Vector( "BaseLayer", {} );
                this.map.getElement().style['background-color'] = spec.options.color;
                break;

            case "Google":

                this.olLayer = new OpenLayers.Layer.Google( "BaseLayer", spec.options );
                break;

            case "TMS":

                this.olLayer = new OpenLayers.Layer.TMS( "BaseLayer", spec.url, spec.options );
                break;
        }

        this.map.olMap.addLayer( this.olLayer );
        this.map.olMap.setBaseLayer( this.olLayer );

        if ( spec.options.type === 'styled' ) {
            styledMapType = new google.maps.StyledMapType( spec.options.style, {name: 'Styled Map'} );
            this.olLayer.mapObject.mapTypes.set( 'styled', styledMapType );
        }

        // ensure baselayer remains bottom layer
        this.map.olMap.setLayerIndex( this.olLayer, -1 );

        this.setOpacity( this.getOpacity() );
        this.setVisibility( this.getVisibility() );
    };

    BaseLayer.prototype.deactivate = function() {
        if ( this.olLayer ) {
            this.map.olMap.removeLayer( this.olLayer );
            this.olLayer.destroy();
        }
        this.map.getElement().style['background-color'] = '';
    };

	module.exports = BaseLayer;
}());

},{"../openlayers/OpenLayers.min":29,"./Layer":12}],9:[function(require,module,exports){
/*
 * Copyright (c) 2014 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

( function() {

    "use strict";

    var OpenLayers = require('../openlayers/OpenLayers.min'),
        $ = require('jquery'),
        Layer = require('./Layer'),
        LayerUtil = require('./LayerUtil'),
        HtmlTileLayer = require('./HtmlTileLayer'),
        PubSub = require('../util/PubSub');

    function ClientLayer( spec ) {
        // set reasonable defaults
        spec.enabled = ( spec.enabled !== undefined ) ? spec.enabled : true;
        spec.opacity = ( spec.opacity !== undefined ) ? spec.opacity : 1.0;
        spec.zIndex = ( spec.zIndex !== undefined ) ? spec.zIndex : 1000;
        spec.domain = "client";
        // call base constructor    
        Layer.call( this, spec );
    }

    ClientLayer.prototype = Object.create( Layer.prototype );

    ClientLayer.prototype.activate = function() {

        // add the new layer
        this.olLayer = new HtmlTileLayer(
            'Client Rendered Tile Layer',
            this.spec.source.tms,
            {
                layername: this.spec.source.id,
                type: 'json',
                maxExtent: new OpenLayers.Bounds(-20037500, -20037500,
                    20037500,  20037500),
                isBaseLayer: false,
                getURL: LayerUtil.getURL,
                html: this.spec.html,
                renderer: this.spec.renderer,
                entry: this.spec.entry
            });

        this.map.olMap.addLayer( this.olLayer );

        this.setZIndex( this.spec.zIndex );
        this.setOpacity( this.spec.opacity );
        this.setVisibility( this.spec.enabled );
        this.setTheme( this.map.getTheme() );

        if ( this.spec.renderer ) {
            this.spec.renderer.meta = this.spec.source.meta.meta;
            this.spec.renderer.map = this.map;
            this.spec.renderer.parent = this;
        }
    };

    ClientLayer.prototype.deactivate = function() {
        if ( this.olLayer ) {
            this.map.olMap.removeLayer( this.olLayer );
            this.olLayer.destroy();
        }
    };

    /**
     * Updates the theme associated with the layer
     */
    ClientLayer.prototype.setTheme = function( theme ) {
        this.spec.theme = theme;
    };

    /**
     * Get the current theme for the layer
     */
    ClientLayer.prototype.getTheme = function() {
        return this.spec.theme;
    };

    /**
     * @param zIndex {number} The new z-order value of the layer, where 0 is front.
     */
    ClientLayer.prototype.setZIndex = function ( zIndex ) {
        // we by-pass the OpenLayers.Map.setLayerIndex() method and manually
        // set the z-index of the layer dev. setLayerIndex sets a relative
        // index based on current map layers, which then sets a z-index. This
        // caused issues with async layer loading.
        this.spec.zIndex = zIndex;
        $( this.olLayer.div ).css( 'z-index', zIndex );
        PubSub.publish( this.getChannel(), { field: 'zIndex', value: zIndex });
    };

    /**
     * Get the layers zIndex
     */
    ClientLayer.prototype.getZIndex = function () {
        return this.spec.zIndex;
    };

    module.exports = ClientLayer;
}());

},{"../openlayers/OpenLayers.min":29,"../util/PubSub":35,"./HtmlTileLayer":11,"./Layer":12,"./LayerUtil":13,"jquery":2}],10:[function(require,module,exports){
/*
 * Copyright (c) 2014 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

/*global HTMLElement */
( function() {

    "use strict";

    var OpenLayers = require('../openlayers/OpenLayers.min'),
        $ = require('jquery');

    OpenLayers.Tile.HTML = function() {
        OpenLayers.Tile.apply( this, arguments );
    };

    OpenLayers.Tile.HTML.prototype = Object.create( OpenLayers.Tile.prototype );

    OpenLayers.Tile.HTML.prototype.draw = function() {
        var that = this,
            shouldDraw = OpenLayers.Tile.prototype.draw.apply( this, arguments),
            dataUrl;
        if ( shouldDraw ) {
            this.positionTile();
            dataUrl = this.layer.getURL( this.bounds );
            if ( dataUrl !== this.url ) {

                this.url = dataUrl;
                this.tileData = null;

                // new url to render
                if (this.isLoading) {
                    this.dataRequest.abort();
                    this.dataRequest = null;
                    this.isLoading = false;
                }

                if (!this.url) {
                    this.unload();
                    return;
                }

                // hide tile contents until have data
                this.div.style.visibility = 'hidden';

                this.dataRequest = $.ajax({
                    url: this.url
                }).then(
                    function( data ) {
                        that.tileData = data;
                        that.renderTile( that.div, that.tileData );
                    },
                    function( xhr, status, error ) {
                        // TODO handle error
                        return true;
                    }
                ).always( function() {
                    that.isLoading = false;
                    that.dataRequest = null;
                });

            } else {
                // already have right data, just render
                this.renderTile( this.div, this.tileData );
            }

        } else if ( shouldDraw === false ) {
            this.unload();
        }
        return shouldDraw;
    };

    OpenLayers.Tile.HTML.prototype.positionTile = function() {

        if ( !this.div ) {
            this.div = document.createElement( 'div' );
            this.div.style.position = 'absolute';
            this.div.className = 'olTileHtml';
            this.layer.div.appendChild( this.div );
        }

        var style = this.div.style,
            size = this.layer.getImageSize( this.bounds ),
            ratio = 1;

        if ( this.layer instanceof OpenLayers.Layer.Grid ) {
            ratio = this.layer.getServerResolution() / this.layer.map.getResolution();
        }

        style.left = this.position.x + 'px';
        style.top = this.position.y + 'px';
        style.width = Math.round( ratio * size.w ) + 'px';
        style.height = Math.round( ratio * size.h ) + 'px';
    };

    OpenLayers.Tile.HTML.prototype.clear = function() {
        OpenLayers.Tile.prototype.clear.apply( this, arguments );
        this.tileData = null;
        this.url = null;
        if ( this.div ) {
            this.layer.div.removeChild( this.div );
            this.div = null;
        }
    };

    OpenLayers.Tile.HTML.prototype.renderTile = function(container, data) {

        if ( !this.layer || !this.div || !data.tile ) {
            return;
        }

        var renderer = this.layer.renderer,
            html = this.layer.html,
            render,
            entries,
            elements,
            i;

        if ( renderer ) {
            // if renderer is attached, use it
            render = renderer.render( data );
            html = render.html;
            entries = render.entries;
        } else {
            // else execute html
            if ( typeof html === "function" ) {
                html = html( data );
            }
        }

        if ( html instanceof $ ) {
            // if generated a jquery object, append it
            $( this.div ).append( html );
        } else if ( html instanceof HTMLElement ) {
            // if generated an HTMLElement, get html text
            this.div.appendChild( html );
        } else {
            // if generated string, set inner html
            this.div.innerHTML = html;
        }

        this.div.style.visibility = 'inherit';
        this.div.style.opacity = 'inherit';
        this.div.style['pointer-events'] = 'none';

        // set pointer-events on tile elements to 'all'
        elements = this.div.children;
        for ( i=0; i<elements.length; i++ ) {
            elements[i].style['pointer-events'] = 'all';
        }

        if ( renderer ) {
            // if renderer is attached, call hook function
            renderer.hook( elements, entries, data );
        }
    };

    module.exports = OpenLayers.Tile.HTML;
}());

},{"../openlayers/OpenLayers.min":29,"jquery":2}],11:[function(require,module,exports){
/*
 * Copyright (c) 2014 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

( function() {

    "use strict";

    var OpenLayers = require('../openlayers/OpenLayers.min'),
        HtmlTile = require('./HtmlTile');

    OpenLayers.Layer.HTML = function( name, url, options ) {
        OpenLayers.Layer.Grid.call( this, name, url, options );
        this.getURL = options.getURL;
        this.layername = options.layername;
        this.type = options.type;
        this.tileClass = HtmlTile;
        this.html = options.html;
        this.renderer = options.renderer;
        this.CLASS_NAME = 'OpenLayers.Layer.HTML';
    };

    OpenLayers.Layer.HTML.prototype = Object.create( OpenLayers.Layer.Grid.prototype );

    module.exports = OpenLayers.Layer.HTML;
}());

},{"../openlayers/OpenLayers.min":29,"./HtmlTile":10}],12:[function(require,module,exports){
/*
 * Copyright (c) 2014 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

( function() {

    "use strict";

    var Util = require('../util/Util'),
        PubSub = require('../util/PubSub');

    function Layer( spec ) {
        this.uuid = Util.generateUuid();
        this.name = spec.name || "Unnamed Layer";
        this.domain = spec.domain;
        this.map = spec.map;
        spec.opacity = ( spec.opacity !== undefined ) ? spec.opacity : 1.0;
        spec.enabled = ( spec.enabled !== undefined ) ? spec.enabled : true;
        this.spec = spec;
    }

    Layer.prototype = {

        /**
         * Set the opacity of the layer
         *
         * @param opacity {float} opacity value from 0 to 1
         */
        setOpacity: function( opacity ) {
            this.spec.opacity = opacity;
            if ( this.olLayer ) {
                this.olLayer.setOpacity ( opacity );
                PubSub.publish( this.getChannel(), { field: 'opacity', value: opacity } );
            }
        },

        /**
         * Returns the opacity of the layer.
         */
        getOpacity: function() {
            return this.spec.opacity;
        },

        /**
         * Set the visibility of the layer.
         *
         * @param visibility {boolean} whether the layer is visible or not
         */
        setVisibility: function( visibility ) {
            this.spec.enabled = visibility;
            if ( this.olLayer ) {
                this.olLayer.setVisibility(visibility);
                PubSub.publish( this.getChannel(), { field: 'enabled', value: visibility } );
            }
        },

        /**
         * Returns the visibility of the layer.
         */
        getVisibility: function() {
            return this.spec.enabled;
        },

        /**
         * Returns the UUID that uniquely identifies this layer.
         */
        getUUID: function() {
            return this.uuid;
        },

        /**
         * Returns the publish/subscribe channel id of this specific layer.
         */
        getChannel: function () {
            return 'layer.' + this.domain + '.' + this.uuid;
        }
    };
    module.exports = Layer;
}());

},{"../util/PubSub":35,"../util/Util":36}],13:[function(require,module,exports){
/*
 * Copyright (c) 2014 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

( function() {

    "use strict";

    var $ = require('jquery');

    /**
     * Private: Parses a malformed JSON string into a usable object.
     *
     * @param jsonString {String} the malformed JSON string
     */
     function parseMalformedJson( jsonString ) {
        // replace ( and ) with [ and ]
        var squared = jsonString.replace( /\(/g, '[' ).replace( /\)/g, ']'),
            // ensure all attributes are quoted in ""
            quoted = squared.replace(/([a-zA-Z0-9]+)(:)/g,'"$1"$2');
        return JSON.parse( quoted );
     }

    /**
     * Private: Parse a given layers meta data min and max json strings,
     * they are currently stored as malformed json, so they require some
     * massaging.
     *
     * @param meta {Object} the layers meta data object
     */
    function parseMetaMinMaxJson( meta ) {
        var min = {}, max = {};
        if ( meta && ( ( meta.max && meta.max.maximum ) || meta.maximum ) ) {
            max = parseMalformedJson( meta.maximum || meta.max.maximum );
        }
        if ( meta && ( ( meta.min && meta.min.minimum ) || meta.minimum ) ) {
            min = parseMalformedJson( meta.minimum || meta.min.minimum );
        }
        return {
            min: $.isArray( min ) ? min[0] : min,
            max: $.isArray( max ) ? max[0] : max
        };
    }

    /**
     * Private: Meta data minimum and maximums are stored as malformed json
     * strings, but are usually accessed at a high frequency ( multiple
     * times per tile render ). This parses them all and stores them
     * as actual objects.
     *
     * @param layerMeta {Object} the .meta node of the data returned for a layer
     *                           service call
     */
    function parseLevelsMinMax( layerMeta ) {
        var meta = layerMeta.meta,
            key;
        for ( key in meta ) {
            if ( meta.hasOwnProperty( key ) ) {
                meta[ key ].minMax = parseMetaMinMaxJson( meta[key] );
            }
        }
        return meta;
    }

    module.exports = {

        /**
         * Parses a layer or an array of layer data objects, formats meta data
         * min and max and returns either the single layer, or a map of layers
         * keyed by layerId.
         *
         * @param layerData {Object|Array} layer data object or array of layer data objects
         */
        parse: function( layerData ) {
            var layerMap,
                i;
            if ( !(layerData instanceof Array) ) {
                layerData.meta.minMax = parseLevelsMinMax( layerData.meta );
                return layerData;
            }
            // if given an array, convert it into a map keyed by layerId
            layerMap = {};
            for ( i=0; i<layerData.length; i++ ) {
                layerData[i].meta.minMax = parseLevelsMinMax( layerData[i].meta );
                layerMap[ layerData[i].id ] = layerData[i];
            }
            return layerMap;
        },

        /**
         * The getURL function passed to a OpenLayers TMS / Grid Layer to generate the
         * tile urls. Can be passed as is, or appended by using 'call'. The 'this'
         * context is set to the context of the OpenLayers layer.
         *
         * @param bounds {Object} the bounds object for the current tile
         */
        getURL: function( bounds ) {
            var res = this.map.getResolution(),
                maxBounds = this.maxExtent,
                tileSize = this.tileSize,
                x = Math.round( (bounds.left-maxBounds.left) / (res*tileSize.w) ),
                y = Math.round( (bounds.bottom-maxBounds.bottom) / (res*tileSize.h) ),
                z = this.map.getZoom();
            if ( x >= 0 && y >= 0 ) {
                return this.url + this.layername
                    + "/" + z + "/" + x + "/" + y + "."
                    + this.type;
            }
        }
    };
}());

},{"jquery":2}],14:[function(require,module,exports){
/*
 * Copyright (c) 2014 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

( function() {

    "use strict";

    var OpenLayers = require('../openlayers/OpenLayers.min'),
        $ = require('jquery'),
        _ = require('lodash'),
        Layer = require('./Layer'),
        LayerUtil = require('./LayerUtil'),
        PubSub = require('../util/PubSub'),
        LegendService = require('../rest/LegendService'),
        requestRampImage,
        getLevelMinMax,
        zoomCallback;

    /**
     * Private: Request colour ramp image from server.
     *
     * @param layer {Object} the layer object
     */
    requestRampImage = function( layer ) {
        LegendService.getEncodedImage( layer.spec.source.id, {
                renderer: layer.spec.renderer
            }, function ( legendString ) {
                 layer.setRampImageUrl( legendString );
            });
    };

    /**
     * Private: Returns the layers min and max values for the given zoom level.
     *
     * @param layer {Object} the layer object.
     */
    getLevelMinMax = function( layer ) {
        var zoomLevel = layer.map.getZoom(),
            coarseness = layer.spec.renderer.coarseness,
            adjustedZoom = zoomLevel - ( coarseness-1 ),
            meta =  layer.spec.source.meta,
            levelMinMax = meta.minMax[ adjustedZoom ],
            minMax = levelMinMax ? levelMinMax.minMax : {
                min: null,
                max: null
            };
        return [ minMax.min, minMax.max ];
    };

    /**
     * Private: Returns the zoom callback function to update level min and maxes.
     *
     * @param layer {ServerLayer} The layer object.
     */
    zoomCallback = function( layer ) {
        return function() {
            if ( layer.olLayer ) {
                layer.setLevelMinMax( getLevelMinMax( layer ) );
            }
        };
    };

    function ServerLayer( spec ) {
        // set reasonable defaults
        spec.zIndex = ( spec.zIndex !== undefined ) ? spec.zIndex : 1;
        spec.renderer = spec.renderer || {};
        spec.renderer.coarseness = ( spec.renderer.coarseness !== undefined ) ?  spec.renderer.coarseness : 1;
        spec.renderer.ramp = spec.renderer.ramp || "spectral";
        spec.renderer.rangeMin = ( spec.renderer.rangeMin !== undefined ) ? spec.renderer.rangeMin : 0;
        spec.renderer.rangeMax = ( spec.renderer.rangeMax !== undefined ) ? spec.renderer.rangeMax : 100;
        spec.valueTransform = spec.valueTransform || { type: 'linear' };
        spec.tileTransform = spec.tileTransform || { type: 'identity' };
        spec.domain = "server";
        // call base constructor
        Layer.call( this, spec );
    }

    ServerLayer.prototype = Object.create( Layer.prototype );

    ServerLayer.prototype.activate = function() {

        var that = this;
        // set callback here so it can be removed later
        this.zoomCallback = zoomCallback( this );
        // set callback to update ramp min/max on zoom
        this.map.on( "zoomend", this.zoomCallback );

        function getURL( bounds ) {
            return LayerUtil.getURL.call( this, bounds ) + that.getQueryParamString();
        }

        // add the new layer
        this.olLayer = new OpenLayers.Layer.TMS(
            'Server Rendered Tile Layer',
            this.spec.source.tms,
            {
                layername: this.spec.source.id,
                type: 'png',
                maxExtent: new OpenLayers.Bounds(-20037500, -20037500,
                    20037500,  20037500),
                transparent: true,
                isBaseLayer: false,
                getURL: getURL
            });
        this.map.olMap.addLayer( this.olLayer );

        requestRampImage( this );
        this.setZIndex( this.spec.zIndex );
        this.setOpacity( this.spec.opacity );
        this.setVisibility( this.spec.enabled );
        this.setTheme( this.map.getTheme() );
        this.setLevelMinMax( getLevelMinMax( that ) );
    };

    ServerLayer.prototype.deactivate = function() {
        if ( this.olLayer ) {
            this.map.olMap.removeLayer( this.olLayer );
            this.olLayer.destroy();
        }
        this.map.off( "zoomend", this.zoomCallback );
        this.zoomCallback = null;
    };

    /**
     * Valid ramp type strings.
     */
    ServerLayer.prototype.RAMP_TYPES = [
         {id: "spectral", name: "Spectral"},
         {id: "hot", name: "Hot"},
         {id: "polar", name: "Polar"},
         {id: "neutral", name: "Neutral"},
         {id: "cool", name: "Cool"},
         {id: "valence", name: "Valence"},
         {id: "flat", name: "Flat"}
    ];

    /**
     * Valid ramp function strings.
     */
    ServerLayer.prototype.RAMP_FUNCTIONS = [
        {id: "linear", name: "Linear"},
        {id: "log10", name: "Log 10"}
    ];

    /**
     * @param {number} zIndex - The new z-order value of the layer, where 0 is front.
     */
    ServerLayer.prototype.setZIndex = function ( zIndex ) {
        // we by-pass the OpenLayers.Map.setLayerIndex() method and manually
        // set the z-index of the layer dev. setLayerIndex sets a relative
        // index based on current map layers, which then sets a z-index. This
        // caused issues with async layer loading.
        this.spec.zIndex = zIndex;
        if ( this.olLayer ) {
            $( this.olLayer.div ).css( 'z-index', zIndex );
            PubSub.publish( this.getChannel(), { field: 'zIndex', value: zIndex });
        }
    };

    /**
     * Get the layers zIndex
     */
    ServerLayer.prototype.getZIndex = function () {
        return this.spec.zIndex;
    };

    /**
     * Updates the ramp type associated with the layer
     */
    ServerLayer.prototype.setRampType = function ( rampType ) {
        var that = this;
        this.spec.renderer.ramp = rampType;
        requestRampImage( that );
        this.olLayer.redraw();
    };

    /**
     *  Get ramp type for layer
     */
    ServerLayer.prototype.getRampType = function() {
        return this.spec.renderer.ramp;
    };

    /**
     * Updates the theme associated with the layer
     */
    ServerLayer.prototype.setTheme = function( theme ) {
        var that = this;
        this.spec.renderer.theme = theme;
        requestRampImage( that );
        this.olLayer.redraw();
        this.setZIndex( this.getZIndex() ); // update z index, since changing baselayer resets them
    };

    /**
     * Get the current theme for the layer
     */
    ServerLayer.prototype.getTheme = function() {
        return this.spec.renderer.theme;
    };

    /**
     * Sets the ramps current min and max
     */
    ServerLayer.prototype.setLevelMinMax = function( minMax ) {
        this.levelMinMax = minMax;
        PubSub.publish( this.getChannel(), { field: 'levelMinMax', value: minMax });
    };

    /**
     * Get the ramps current min and max for the zoom level
     */
    ServerLayer.prototype.getLevelMinMax = function() {
        return this.levelMinMax;
    };

    /**
     * Update the ramps URL string
     */
    ServerLayer.prototype.setRampImageUrl = function ( url ) {
        this.rampImageUrl = url;
        PubSub.publish( this.getChannel(), { field: 'rampImageUrl', value: url });
    };

    /**
     * Get the current ramps URL string
     */
    ServerLayer.prototype.getRampImageUrl = function() {
        return this.rampImageUrl;
    };

    /**
     * Updates the ramp function associated with the layer.  Results in a POST
     * to the server.
     *
     * @param {string} rampFunction - The new new ramp function.
     */
    ServerLayer.prototype.setRampFunction = function ( rampFunction ) {
        this.spec.valueTransform = { type: rampFunction };
        this.olLayer.redraw();
        PubSub.publish( this.getChannel(), { field: 'rampFunction', value: rampFunction });
    };

    /**
     * Get the current ramps function
     */
    ServerLayer.prototype.getRampFunction = function() {
        return this.spec.valueTransform.type;
    };

    /**
     * Set the layers transformer type
     */
    ServerLayer.prototype.setTransformerType = function ( transformerType ) {
        this.spec.tileTransform.type = transformerType;
        this.olLayer.redraw();
        PubSub.publish( this.getChannel(), { field: 'transformerType', value: transformerType });
    };

    /**
     * Get the layers transformer type
     */
    ServerLayer.prototype.getTransformerType = function () {
        return this.spec.tileTransform.type;
    };

    /**
     * Set the transformer data arguments
     */
    ServerLayer.prototype.setTransformerData = function ( transformerData ) {
        this.spec.tileTransform.data = transformerData;
        this.olLayer.redraw();
        PubSub.publish( this.getChannel(), { field: 'transformerData', value: transformerData });
    };

    /**
     * Get the transformer data arguments
     */
    ServerLayer.prototype.getTransformerData = function () {
        return this.spec.tileTransform.data;
    };

    /**
     * Set the layer coarseness
     */
    ServerLayer.prototype.setCoarseness = function( coarseness ) {
        this.spec.renderer.coarseness = coarseness;
        this.setLevelMinMax( getLevelMinMax( this ) );
        this.olLayer.redraw();
        PubSub.publish( this.getChannel(), { field: 'coarseness', value: coarseness });
    };

    /**
     * Get the layer coarseness
     */
    ServerLayer.prototype.getCoarseness = function() {
        return this.spec.renderer.coarseness;
    };

    /**
     * Generate query parameters based on state of layer
     */
    ServerLayer.prototype.getQueryParamString = function() {
        function encodeQueryParams( params ) {
            var query;
            function traverseParams( params, query ) {
                var result = "";
                _.forIn( params, function( value, key ) {
                    if ( typeof value !== "object" ) {
                        result += query + key + '=' + value + "&";
                    } else {
                        result += traverseParams( params[ key ], query + key + "." );
                    }
                });
                return result;
            }
            query = "?" + traverseParams( params, '' );
            return query.slice( 0, query.length - 1 );
        }
        var query = {
                renderer: this.spec.renderer,
                tileTransform: this.spec.tileTransform,
                valueTransform: this.spec.valueTransform
            };

        return encodeQueryParams( query );
    };

    module.exports = ServerLayer;
}());

},{"../openlayers/OpenLayers.min":29,"../rest/LegendService":32,"../util/PubSub":35,"./Layer":12,"./LayerUtil":13,"jquery":2,"lodash":3}],15:[function(require,module,exports){
/*
 * Copyright (c) 2013 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

( function() {

    "use strict";

    var Renderer = require('./Renderer'),
        RendererUtil = require('./RendererUtil'),
        injectCss;

    injectCss = function( spec ) {
        var i;
        if ( spec.text.themes ) {
            for ( i=0; i<spec.text.themes.length; i++ ) {
                spec.text.themes[i].injectTheme({
                    selector: ".node-label"
                });
            }
        }
    };

    function GraphLabelRenderer( spec ) {
        Renderer.call( this, spec );
        injectCss( this.spec );
    }

    GraphLabelRenderer.prototype = Object.create( Renderer.prototype );

    GraphLabelRenderer.prototype.render = function( data ) {

        var GRAPH_COORD_RANGE = 256,
            text = this.spec.text,
            meta = this.meta[ this.map.getZoom() ],
            communities = data.tile.values[0].value[0].communities,
            scale = Math.pow( 2, this.map.getZoom() ),
            range =  GRAPH_COORD_RANGE / scale,
            labelIndex = ( text.labelIndex !== undefined ) ? text.labelIndex : 0,
            metaCommunities = meta.minMax.max.communities[0],
            sizeMultiplier,
            community,
            html = "",
            fontScale,
            fontSize,
            split,
            label,
            countNorm,
            percent,
            hierLevel,
            parentIDarray = [],
            entries = [],
            x, y, i;

        function capitalize( str ) {
            return str.replace(/(?:^|,|\s)\S/g, function( a ) {
                return a.toUpperCase();
            });
        }
        // get labelSizeMultiplier value -- value between 0.001 and 1 that controls label font size scaling.
        // (Lower value caps font size for very large communities, and is better for graphs with many small communities and a few very large ones)
        sizeMultiplier = ( text.sizeMultiplier )
            ? Math.min( Math.max( text.sizeMultiplier, 0.001 ), 1.0 )
            : 0.5;

        // get graph hierarchy level for this zoom level
        // assumes same hierarchy level for all tiles at a given zoom level
        hierLevel = metaCommunities.hierLevel;

        // if hierLevel = 0, normalize label attributes by community degree
        // else normalize label attributes by num internal nodes
        countNorm = ( hierLevel === 0 )
            ? metaCommunities.degree * sizeMultiplier
            : metaCommunities.numNodes * sizeMultiplier;

        for ( i=0; i<communities.length; i++ ) {

            community = communities[i];
            entries.push( community );

            // capitalize label array, split by comma
            split = community.metadata.split(",");
            // don't draw labels for isolated communities
            // and don't render if label string is empty
            // only draw one label per parent community per tile
            // only draw up to 5 labels per tile
            if ( community.degree === 0 ||
                 split[ labelIndex ] === "" ||
                 parentIDarray.length >= 5 ||
                 parentIDarray.indexOf( community.parentID ) !== -1 ) {
                // Skip this label entry
                continue;
            }
            else {
                // add this parent ID to the list, and draw the label (below
                parentIDarray.push( community.parentID );
            }

            // get label position
            x = ( community[ text.x ] % range ) * scale;
            y = ( community[ text.y ] % range ) * scale;

            // capitalize label
            label = capitalize( split[ labelIndex ].toLowerCase() );

            // get font scale based on hierarchy level
            fontScale = ( hierLevel === 0 ) ? community.degree : community.numNodes;
            fontSize = RendererUtil.getFontSize( fontScale, countNorm );

            //
            percent = Math.min( 1, fontScale / countNorm ) + 0.5;

            html += '<div class="node-label" style="'
                  + 'left:'+x+'px;'
                  + 'bottom:'+y+'px;'
                  + 'font-size:' + fontSize + 'px;'
                  + 'line-height:' + fontSize + 'px;'
                  + 'margin-top:' + (-fontSize/2) + 'px;'
                  + 'height:' + fontSize + 'px;'
                  + 'opacity:' + percent + ';'
                  + 'z-index:' + Math.floor( fontSize ) + ';'
                  + '">'+label+'</div>';
        }
        return {
            html: html,
            entries: entries
        };
    };

    module.exports = GraphLabelRenderer;
}());
},{"./Renderer":20,"./RendererUtil":21}],16:[function(require,module,exports){
/*
 * Copyright (c) 2013 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

( function() {

    "use strict";

    var Renderer = require('./Renderer'),
        injectCss;

    injectCss = function( spec ) {
        var i;
        if ( spec.node.themes ) {
            for (i = 0; i < spec.node.themes.length; i++) {
                spec.node.themes[i].injectTheme({
                    selector: ".community-node"
                });
            }
        }
        if ( spec.criticalNode.themes ) {
            for (i = 0; i < spec.criticalNode.themes.length; i++) {
                spec.criticalNode.themes[i].injectTheme({
                    selector: ".community-node.community-critical-node"
                });
            }
        }
        if ( spec.parentNode.themes ) {
            for (i = 0; i < spec.parentNode.themes.length; i++) {
                spec.parentNode.themes[i].injectTheme({
                    selector: ".community-parent-node"
                });
            }
        }
    };

    function GraphNodeRenderer( spec ) {
        Renderer.call( this, spec );
        injectCss( this.spec );
    }

    GraphNodeRenderer.prototype = Object.create( Renderer.prototype );

    GraphNodeRenderer.prototype.render = function( data ) {

        var GRAPH_COORD_RANGE = 256,
            BORDER_WIDTH = 2,
            spec = this.spec,
            communities = data.tile.values[0].value[0].communities,
            scale = Math.pow( 2, this.map.getZoom() ),
            range =  GRAPH_COORD_RANGE / scale,
            className,
            community,
            radius,
            diameter,
            parentRadius,
            parentDiameter,
            html = '',
            entries = [],
            i, x, y, px, py;

        for ( i=0; i<communities.length; i++ ) {

            community = communities[i];
            entries.push( community );

            // get node position, radius, and diameter
            x = ( community[ spec.node.x ] % range ) * scale;
            y = ( community[ spec.node.y ] % range ) * scale;
            radius = community[ spec.node.radius ] * scale;
            diameter = radius*2;

            // don't draw node if radius < 1
            // or if it is an isolated community
            if ( radius < 1 || community.degree === 0 ) {
                continue;
            }

            if ( community[ spec.criticalNode.flag ] ) {
                className = 'community-node community-critical-node';
            } else {
                className = 'community-node';
            }

            // draw node
            html += '<div class="'+className+'" style="'
                  + 'height:'+diameter+'px;'
                  + 'width:'+diameter+'px;'
                  + 'border-radius:'+diameter+'px;'
                  + 'left:'+(x - radius - BORDER_WIDTH)+'px;'
                  + 'bottom:'+(y - radius - BORDER_WIDTH)+'px;'
                  + 'border-width:' + BORDER_WIDTH + 'px;'
                  + '"></div>';

            // only have the critical node draw the parent
            // assumes there is a critical node present in all communities
            if ( community[ spec.criticalNode.flag ] ) {

                // get parent node position, radius, and diameter
                px = ( community[ spec.parentNode.x ] % range ) * scale;
                py = ( community[ spec.parentNode.y ] % range ) * scale;
                parentRadius = community[ spec.parentNode.radius ] * scale;
                parentDiameter = parentRadius * 2;

                // draw parent node
                html += '<div class="community-parent-node" style="'
                      + 'height:'+parentDiameter+'px;'
                      + 'width:'+parentDiameter+'px;'
                      + 'border-radius:'+parentDiameter+'px;'
                      + 'left:'+(px - parentRadius - BORDER_WIDTH)+'px;'
                      + 'bottom:'+(py - parentRadius - BORDER_WIDTH)+'px;'
                      + 'border-width:' + BORDER_WIDTH + 'px;'
                      + '"></div>';
            }
        }
        return {
            html: html,
            entries: entries
        };
    };

    module.exports = GraphNodeRenderer;
}());
},{"./Renderer":20}],17:[function(require,module,exports){
/*
 * Copyright (c) 2013 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

( function() {

    "use strict";

    var Renderer = require('./Renderer'),
        MapUtil = require('../../map/MapUtil'),
        injectCss;

    injectCss = function( spec ) {
        var i;
        if ( spec.point.themes ) {
            for ( i = 0; i < spec.point.themes.length; i++ ) {
                spec.point.themes[i].injectTheme({
                    selector: ".point-annotation-fill",
                    parentSelector: ".point-annotation-aggregate"
                });
            }
        }
        if ( spec.aggregate.themes ) {
            for ( i = 0; i < spec.aggregate.themes.length; i++ ) {
                spec.aggregate.themes[i].injectTheme({
                    selector: ".point-annotation-border",
                    parentSelector: ".point-annotation-aggregate"
                });
            }
        }
    };

    function PointAggregateRenderer( spec ) {
        Renderer.call( this, spec );
        injectCss( this.spec );
    }

    PointAggregateRenderer.prototype = Object.create( Renderer.prototype );

    PointAggregateRenderer.prototype.render = function( data ) {

        var //spec = this.spec,
            //meta = this.meta[ this.map.getZoom() ],
            values = data.tile.values,
            entries = [],
            positionMap = {},
            positionKey,
            tilekey,
            tilePos,
            html = '',
            position,
            offset,
            value,
            i, j;

        // for each bin
        for ( i=0; i<values.length; i++ ) {

            value = values[i].value;

            if ( value.length === 0 ) {
                continue;
            }
            entries.push( value );

            html += '<div class="point-annotation-aggregate">';

            for ( j=0; j<value.length; j++ ) {

                // get annotations position in viewport space
                tilekey = data.index.level + "," + data.index.xIndex + "," + data.index.yIndex;
                tilePos = MapUtil.getTopLeftViewportPixelForTile( this.map, tilekey );
                position = MapUtil.getViewportPixelFromCoord( this.map, value[j].x, value[j].y );
                // get relative position from tile top left
                offset = {
                    x: position.x - tilePos.x,
                    y: position.y - tilePos.y
                };
                // prevent creating two annotations on the exact same pixel
                positionKey = Math.floor( offset.x ) + "," + Math.floor( offset.y );
                if ( !positionMap[ positionKey ] ) {
                    positionMap[ positionKey ] = true;
                    html += '<div class="point-annotation point-annotation-fill" style="'
                          + 'left:' + offset.x + 'px;'
                          + 'top:' + offset.y + 'px;'
                          + 'border-width: 2px;"></div>'
                          + '<div class="point-annotation point-annotation-border" style="'
                          + 'left:' + offset.x + 'px;'
                          + 'top:' + offset.y + 'px;'
                          + 'border-width: 2px"></div>';
                }
            }

            html += '</div>';
        }
        return {
            html: html,
            entries: entries
        };
    };

    module.exports = PointAggregateRenderer;
}());
},{"../../map/MapUtil":28,"./Renderer":20}],18:[function(require,module,exports){
/*
 * Copyright (c) 2013 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

( function() {

    "use strict";

    var Renderer = require('./Renderer'),
        MapUtil = require('../../map/MapUtil'),
        injectCss;

    injectCss = function( spec ) {
        var i;
        if ( spec.point.themes ) {
            for (i = 0; i < spec.point.themes.length; i++) {
                spec.point.themes[i].injectTheme({
                    selector: ".point-annotation"
                });
            }
        }
    };

    function PointRenderer( spec ) {
        Renderer.call( this, spec );
        injectCss( this.spec );
    }

    PointRenderer.prototype = Object.create( Renderer.prototype );

    PointRenderer.prototype.render = function( data ) {

        var //spec = this.spec,
            //meta = this.meta[ this.map.getZoom() ],
            values = data.tile.values,
            entries = [],
            positionMap = {},
            positionKey,
            tilekey,
            tilePos,
            html = '',
            position,
            offset,
            value,
            i, j;

        // for each bin
        for ( i=0; i<values.length; i++ ) {

            value = values[i].value;

            if ( value.length === 0 ) {
                continue;
            }

            for ( j=0; j<value.length; j++ ) {

                entries.push( value[j] );

                // get annotations position in viewport space
                tilekey = data.index.level + "," + data.index.xIndex + "," + data.index.yIndex;
                tilePos = MapUtil.getTopLeftViewportPixelForTile( this.map, tilekey );
                position = MapUtil.getViewportPixelFromCoord( this.map, value[j].x, value[j].y );
                // get relative position from tile top left
                offset = {
                    x: position.x - tilePos.x,
                    y: position.y - tilePos.y
                };
                // prevent creating two annotations on the exact same pixel
                positionKey = Math.floor( offset.x ) + "," + Math.floor( offset.y );
                if ( !positionMap[ positionKey ] ) {
                    positionMap[ positionKey ] = true;
                    html += '<div class="point-annotation point-annotation-single" style="'
                          + 'left:' + offset.x + 'px;'
                          + 'top:' + offset.y + 'px;'
                          + 'border-width: 2px"></div>';
                }
            }
        }
        return {
            html: html,
            entries: entries
        };
    };

    module.exports = PointRenderer;
}());
},{"../../map/MapUtil":28,"./Renderer":20}],19:[function(require,module,exports){
/*
 * Copyright (c) 2013 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

( function() {

    "use strict";

    var $ = require('jquery'),
        getOutlineCss;

    getOutlineCss = function( type, value ) {
        function isColor( val ) {
            var split = val.replace(/\s+/g, '').split(/[\(\)]/);
            if ( split[0] === "rgb" || split[0] === "rgba" ) {
                return val;
            }
            return val[0] === "#" && ( val.length === 4 || val.length === 7 );
        }

        if ( !value ) {
            return "";
        }

        if ( type === "text-shadow" ) {
            if ( isColor( value ) ) {
                return "text-shadow:"
                    + "-1px -1px 0 " + value + ","
                    + " 1px -1px 0 " + value + ","
                    + "-1px  1px 0 " + value + ","
                    + " 1px  1px 0 " + value + ","
                    + " 1px  0   0 " + value + ","
                    + "-1px  0   0 " + value + ","
                    + " 0    1px 0 " + value + ","
                    + " 0   -1px 0 " + value;
            }
            return "text-shadow:" + value + ";";
        }
        if ( type === "border" ) {
            if ( isColor( value ) ) {
                return "border: 1px solid " + value;
            }
            return "border:" + value + ";";
        }
        return "";
    };

    function RenderTheme( selector, spec ) {
        spec = spec || {};
        this.selector = selector;
        this.spec = spec;
    }

    RenderTheme.prototype.injectTheme = function( options ) {
        var theme = this.selector,
            spec = this.spec,
            selector = options.selector,
            parentSelector = options.parentSelector,
            css;
        css = '<style class="render-theme" type="text/css">';

        // set color
        if ( spec['background-color'] ) {
            css += theme + ' ' + selector + '{background-color:'+spec['background-color']+';}';
        }
        if ( spec.color ) {
            css += theme + ' ' + selector + '{color:' + spec.color + ';}';
        }

        // set :hover color
        if ( parentSelector ) {
            if ( spec['background-color:hover'] ) {
                css += theme + ' '+parentSelector+':hover '+selector+' {background-color:'+spec['background-color:hover']+';}';
            }
            if ( spec['color:hover'] ) {
                css += theme + ' '+parentSelector+':hover '+selector+' {color:'+spec['color:hover']+';}';
            }
        } else {
            if ( spec['background-color:hover'] ) {
                css += theme + ' '+selector+':hover {background-color:'+spec['background-color:hover']+';}';
            }
            if ( spec['color:hover'] ) {
                css += theme + ' '+selector+':hover {color:'+spec['color:hover']+';}';
            }
        }

        // set borders
        if ( spec['text-shadow'] ) {
            css += theme + ' ' + selector + '{' + getOutlineCss( 'text-shadow', spec['text-shadow'] ) + ';}';
        }

        if ( spec.border ) {
            css += theme + ' ' + selector + '{' + getOutlineCss( 'border', spec.border ) + ';}';
        }
        css += '</style>';
        $( document.body ).prepend( css );
    };

    module.exports = RenderTheme;
}());
},{"jquery":2}],20:[function(require,module,exports){
/*
 * Copyright (c) 2013 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

( function() {

    "use strict";

    var $ = require('jquery');

    /**
     * Base constructor for Renderer. Renderers are designed to provide generic rendering
     * capabilities that can be reused across applications.
     * @param spec {Object} The specification object.
     */
    function Renderer( spec ) {
        this.spec = spec || {};
    }

    /**
     * When rendering a tile, the renderer will by default assume each immediate sibling
     * corresponds to a data entry. This function allows a renderer implementation to
     * provide a selector in situations where this is not the case. This is only relevant
     * if the hook callback is set.
     * @returns {boolean || string}
     */
    Renderer.prototype.getEntrySelector = function() {
        return false;
    };

    /**
     * The central rendering function. This function is called for every tile containing data.
     * Returns an object containing the tiles html, along with an array of each data entry. The
     * implementation of this function is unique to each renderer.
     * @returns {{html: string, entries: Array}}
     */
    Renderer.prototype.render = function() {
        return {
            html: "",
            entries: []
        };
    };

    /**
     * The hook callback executor function. If a hook function is provided to the renderer, this
     * will execute it passing the respective element and data entry along with all entries and
     * the raw tile data.
     * @param elements {HTMLCollection} A collection of html elements.
     * @param entries  {Array} The array of all data entries.
     * @param data     {Object} The raw tile data object.
     */
    Renderer.prototype.hook = function( elements, entries, data ) {
        var hook = this.spec.hook,
            $elements;
        if ( hook && typeof hook === "function" ) {
            // get the entries
            $elements = $( elements );
            // if entry selector is set, use it to select entries
            if ( this.getEntrySelector() ) {
                $elements = $elements.find( this.getEntrySelector() );
            }
            // call entry function on each entry
            $elements.each( function( index, elem ) {
                hook( elem, entries[ index ], entries, data );
            });
        }
    };

    module.exports = Renderer;
}());
},{"jquery":2}],21:[function(require,module,exports){
/*
 * Copyright (c) 2013 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

( function() {

    "use strict";

    module.exports = {

        /**
         * Returns a y offset required to vertical centre a number of entries based
         * on spacing and offset
         *
         * @param numEntries {int} number of entries to render
         * @param spacing    {int} the spacing between entries in pixels
         * @param offset     {int} the offset from the top of the tile to centre on in pixels
         */
        getYOffset: function( numEntries, spacing, offset ) {
            return offset - ( ( ( numEntries - 1) / 2 ) ) * spacing;
        },

        /**
         * Returns a font size based on the percentage of tweets relative to the total count
         *
         * @param count      {int} local count
         * @param totalCount {int} global count
         * @param [options]    {Object} options object to set min and max font size and bias (optional)
         */
        getFontSize: function( count, totalCount, options ) {
            options = options || {};
            var MAX_FONT_SIZE = options.maxFontSize || 22,
                MIN_FONT_SIZE = options.minFontSize || 12,
                BIAS = options.bias || 0,
                FONT_RANGE = MAX_FONT_SIZE - MIN_FONT_SIZE,
                percentage = ( count / totalCount ) || 0,
                size = ( percentage * FONT_RANGE ) + MIN_FONT_SIZE;
            size = Math.min( Math.max( size, MIN_FONT_SIZE), MAX_FONT_SIZE );
            return Math.min( Math.max( size+BIAS, MIN_FONT_SIZE), MAX_FONT_SIZE );
        },

        /**
         * Traverses an object to return a nested attribute
         *
         * @param obj        {Object} the object to traverse
         * @param attribPath {String} period delimited attribute path
         */
        getAttributeValue: function( obj, attribPath ) {
            var attribs = attribPath.split('.'),
                attrib,
                i;
            attrib = obj;
            for (i=0; i<attribs.length; i++) {
                attrib = attrib[ attribs[i] ];
            }
            return attrib;
        },

        /**
         * Converts a hexcode color to its RGB counter part.
         *
         * @param hex {String} hex code color
         */
        hexToRgb: function(hex) {
            var bigint;
            // remove #
            hex = hex.replace(/#/, '');
            // if only 3 hex values are provided, expand into 6 digit hex code
            if ( hex.length === 3 ) {
                hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];
            }
            bigint = parseInt(hex, 16);
            return {
                r: (bigint >> 16) & 255,
                g: (bigint >> 8) & 255,
                b: bigint & 255
            };
        },

        /**
         * Converts an RGB color to its hexcode counter part.
         *
         * @param rgb {Object} RGB color
         */
        rgbToHex: function( rgb ) {
            var r = rgb.r,
                g = rgb.g,
                b = rgb.b;
            function componentToHex(c) {
                var hex = c.toString(16);
                return (hex.length === 1) ? "0" + hex : hex;
            }
            return "#" + componentToHex( Math.floor(r)) +
                         componentToHex( Math.floor(g)) +
                         componentToHex( Math.floor(b));
        },

        /**
         * Increases the brightness of a hexcode color by a percentage factor
         *
         * @param hex    {String} hex code color
         * @param factor {float}  percentage factor of increase
         */
        hexBrightness: function( hex, factor ) {
            var rgb = this.hexToRgb( hex );
            return this.rgbToHex( { r: Math.min( Math.max( 0, rgb.r * factor ), 255 ),
                                    g: Math.min( Math.max( 0, rgb.g * factor ), 255 ),
                                    b: Math.min( Math.max( 0, rgb.b * factor ), 255 ) } );
        },

        /**
         * Converts a hexcode color to greyscale using aluminosity based model
         *
         * @param hex {String} hex code color
         */
        hexGreyscale: function( hex ) {
            var rgb = this.hexToRgb( hex ),
                avg = ( rgb.r * 0.21 + rgb.g * 0.72 + rgb.b * 0.07 );
            return this.rgbToHex({
                r: avg,
                g: avg,
                b: avg
            });
        },

        /**
         * Blends two hexcode colors together, defaults to 50/50 blend
         *
         * @param hexA {String} hex code color A
         * @param hexB {String} hex code color B
         * @param [aIntoBPercentage] {float} percentage to blend hexA into hexB (optional)
         */
        hexBlend: function( hexA, hexB, aIntoBPercentage ) {
            var aPerc = Math.min( 1, aIntoBPercentage ) || 0.5,
                bPerc = 1 - aPerc,
                rgb1 = this.hexToRgb( hexA ),
                rgb2 = this.hexToRgb( hexB );

            return this.rgbToHex({
                r : ( rgb1.r*aPerc + rgb2.r*bPerc ),
                g : ( rgb1.g*aPerc + rgb2.g*bPerc ),
                b : ( rgb1.b*aPerc + rgb2.b*bPerc )
            });
        }

    };

}());
},{}],22:[function(require,module,exports){
/*
 * Copyright (c) 2013 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

( function() {

    "use strict";

    var Renderer = require('./Renderer'),
        RendererUtil = require('./RendererUtil'),
        MAX_WORDS_DISPLAYED = 8,
        injectCss;

    injectCss = function( spec ) {
        var i;
        if ( spec.text.themes ) {
            for (i = 0; i < spec.text.themes.length; i++) {
                spec.text.themes[i].injectTheme({
                    selector: ".text-by-frequency-label",
                    parentSelector: ".text-by-frequency-entry"
                });
            }
        }
        if ( spec.frequency.themes ) {
            for (i = 0; i < spec.frequency.themes.length; i++) {
                spec.frequency.themes[i].injectTheme({
                    selector: ".text-by-frequency-bar",
                    parentSelector: ".text-by-frequency-entry"
                });
            }
        }
    };

    function TextByFrequencyRenderer( spec ) {
        Renderer.call( this, spec );
        injectCss( this.spec );
    }

    TextByFrequencyRenderer.prototype = Object.create( Renderer.prototype );

    TextByFrequencyRenderer.prototype.render = function( data ) {

        var textKey = this.spec.text.textKey,
            countKey = this.spec.frequency.countKey,
            values = data.tile.values[0].value,
            numEntries = Math.min( values.length, MAX_WORDS_DISPLAYED ),
            html = '',
            entries = [],
            value,
            entryText,
            maxPercentage,
            relativePercent,
            visibility,
            chartSize,
            i, j;

        /*
            Utility function for positioning the labels
        */
        function getYOffset( index, numEntries ) {
            var SPACING = 20;
            return 118 - ( (( numEntries - 1) / 2 ) - index ) * SPACING;
        }

        function getChartSize( value, countKey ) {
            return value[ countKey ].length;
        }

        /*
            Returns the total count for single value
        */
        function getCount( value, index, countKey ) {
            return RendererUtil.getAttributeValue( value, countKey )[index];
        }

        /*
            Returns the total sum count
        */
        function getCountArraySum( value, countKey ) {
            var sum = 0, i;
            for ( i=0; i<value[ countKey ].length; i++ ) {
                sum += value[ countKey ][i];
            }
            return sum;
        }

        /*
            Returns the percentage count
        */
        function getPercentage( value, index, countKey ) {
            return ( getCount( value, index, countKey ) / getCountArraySum( value, countKey ) ) || 0;
        }

        /*
            Returns the maximum percentage count
        */
        function getMaxPercentage( value, countKey ) {
            var i,
                percent,
                chartSize = getChartSize( value, countKey ),
                maxPercent = 0,
                count = getCountArraySum( value, countKey );

            if (count === 0) {
                return 0;
            }

            for (i=0; i<chartSize; i++) {
                // get maximum percent
                percent = getCount( value, i, countKey ) / count;
                if (percent > maxPercent) {
                    maxPercent = percent;
                }
            }
            return maxPercent;
        }

        for (i=0; i<numEntries; i++) {

            value = values[i];
            entries.push( value );
            entryText = RendererUtil.getAttributeValue( value, textKey );
            chartSize = getChartSize( value, countKey );
            maxPercentage = getMaxPercentage( value, countKey );

            html += '<div class="text-by-frequency-entry" style="'
                  + 'top:' +  getYOffset( i, numEntries ) + 'px;">';

            // create chart
            html += '<div class="text-by-frequency-left">';
            for (j=0; j<chartSize; j++) {
                relativePercent = ( getPercentage( value, j, countKey ) / maxPercentage ) * 100;
                visibility = (relativePercent > 0) ? '' : 'hidden';
                relativePercent = Math.max( relativePercent, 20 );
                // create bar
                html += '<div class="text-by-frequency-bar" style="'
                      + 'visibility:'+visibility+';'
                      + 'height:'+relativePercent+'%;'
                      + 'width:'+ Math.floor( (105+chartSize)/chartSize ) +'px;'
                      + 'top:'+(100-relativePercent)+'%;"></div>';
            }
            html += '</div>';

            // create tag label
            html += '<div class="text-by-frequency-right">';
            html += '<div class="text-by-frequency-label">'+entryText+'</div>';
            html += '</div>';
            html += '</div>';
        }

        return {
            html: html,
            entries: entries
        };
    };

    module.exports = TextByFrequencyRenderer;
}());
},{"./Renderer":20,"./RendererUtil":21}],23:[function(require,module,exports){
/*
 * Copyright (c) 2013 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

( function() {

    "use strict";

    var Renderer = require('./Renderer'),
        RendererUtil = require('./RendererUtil'),
        MAX_WORDS_DISPLAYED = 5,
        injectCss;

    injectCss = function( spec ) {
        var i;
        if ( spec.text.themes ) {
            for ( i=0; i<spec.text.themes.length; i++ ) {
                spec.text.themes[i].injectTheme({
                    selector: ".text-score-label",
                    parentSelector: ".text-score-entry"
                });
            }
        }
    };

    function TextScoreRenderer( spec ) {
        Renderer.call( this, spec );
        injectCss( this.spec );
    }

    TextScoreRenderer.prototype = Object.create( Renderer.prototype );

    TextScoreRenderer.prototype.getEntrySelector = function() {
        return ".text-score-entry";
    };

    TextScoreRenderer.prototype.render = function( data ) {

        var text = this.spec.text,
            textKey = text.textKey,
            countKey = text.countKey,
            meta = this.meta[ this.map.getZoom() ],
            values = data.tile.values[0].value,
            numEntries = Math.min( values.length, MAX_WORDS_DISPLAYED ),
            entries = [],
            totalCount,
            yOffset,
            html = '',
            value,
            textEntry,
            fontSize,
            textCount,
            i;

         // get maximum count for layer if it exists in meta data
        totalCount = meta.minMax.max[ countKey ];
        yOffset = RendererUtil.getYOffset( numEntries, 36, 122 );

        for (i=0; i<numEntries; i++) {

            value = values[i];
            entries.push( value );
            textEntry = RendererUtil.getAttributeValue( value, textKey );
            textCount = RendererUtil.getAttributeValue( value, countKey );
            fontSize = RendererUtil.getFontSize( textCount, totalCount );

            // parent
            html += '<div class="text-score-entry-parent" style="top:' + yOffset + 'px;">';

            // create entry
            html += '<div class="text-score-entry">';
            // create label
            html += '<div class="text-score-label" style="'
                  + 'font-size:'+ fontSize +'px;'
                  + 'line-height:'+ fontSize +'px;">'+textEntry+'</div>';
            html += '</div>';
            html += '</div>';

            html += '<div class="clear"></div>';
        }

        return {
            html: html,
            entries: entries
        };
    };

    module.exports = TextScoreRenderer;
}());
},{"./Renderer":20,"./RendererUtil":21}],24:[function(require,module,exports){
/*
 * Copyright (c) 2013 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

( function() {

    "use strict";

    var $ = require('jquery'),
        Renderer = require('./Renderer'),
        RendererUtil = require('./RendererUtil'),
        MAX_WORDS_DISPLAYED = 10,
        HORIZONTAL_OFFSET = 10,
        VERTICAL_OFFSET = 24,
        spiralPosition,
        intersectTest,
        overlapTest,
        intersectWord,
        getWordDimensions,
        createWordCloud,
        injectCss;

    injectCss = function( spec ) {
        var i;
        if ( spec.text.themes ) {
            for ( i = 0; i < spec.text.themes.length; i++ ) {
                spec.text.themes[i].injectTheme({
                    selector: ".word-cloud-label"
                });
            }
        }
    };

    /**
     * Given an initial position, return a new position, incrementally spiralled
     * outwards.
     */
    spiralPosition = function( pos ) {
        var pi2 = 2 * Math.PI,
            circ = pi2 * pos.radius,
            inc = ( pos.arcLength > circ/10) ? circ/10 : pos.arcLength,
            da = inc / pos.radius,
            nt = (pos.t+da);
        if (nt > pi2) {
            nt = nt % pi2;
            pos.radius = pos.radius + pos.radiusInc;
        }
        pos.t = nt;
        pos.x = pos.radius * Math.cos(nt);
        pos.y = pos.radius * Math.sin(nt);
        return pos;
    };

    /**
     *  Returns true if bounding box a intersects bounding box b
     */
    intersectTest = function( a, b ) {
        return (Math.abs(a.x - b.x) * 2 < (a.width + b.width)) &&
               (Math.abs(a.y - b.y) * 2 < (a.height + b.height));
    };

    /**
     *  Returns true if bounding box a is not fully contained inside bounding box b
     */
    overlapTest = function( a, b ) {
        return ( a.x + a.width/2 > b.x+b.width/2 ||
                 a.x - a.width/2 < b.x-b.width/2 ||
                 a.y + a.height/2 > b.y+b.height/2 ||
                 a.y - a.height/2 < b.y-b.height/2 );
    };

    /**
     * Check if a word intersects another word, or is not fully contained in the
     * tile bounding box
     */
    intersectWord = function( position, dimensions, cloud, bb ) {
        var box = {
                x: position.x,
                y: position.y,
                height: dimensions.height,
                width: dimensions.width
            },
            i;
        for ( i=0; i<cloud.length; i++ ) {
            if ( intersectTest( box, cloud[i] ) ) {
                return true;
            }
        }
        // make sure it doesn't intersect the border;
        if ( overlapTest( box, bb ) ) {
            // if it hits a border, increment collision count
            // and extend arc length
            position.collisions++;
            position.arcLength = position.radius;
            return true;
        }
        return false;
    };

    /**
     * Returns the pixel dimensions of the label
     */
    getWordDimensions = function( str, fontSize ) {
        var $temp,
            dimension = {};
        $temp = $('<div class="word-cloud-label-temp" style="font-size:'+fontSize+'px;">'+str+'</div>');
        $('body').append( $temp );
        dimension.width = $temp.outerWidth();
        dimension.height = $temp.outerHeight();
        $temp.remove();
        return dimension;
    };

    /**
     * Returns the word cloud words containing font size and x and y coordinates
     */
    createWordCloud = function( wordCounts, maxCount ) {
        var boundingBox = {
                width: 256 - HORIZONTAL_OFFSET*2,
                height: 256 - VERTICAL_OFFSET*2,
                x: 0,
                y: 0
            },
            cloud = [],
            i, word, count, dim,
            fontSize, pos;
        // sort words by frequency
        wordCounts.sort( function( a, b ) {
            return b.count - a.count;
        });
        // assemble word cloud
        for ( i=0; i<wordCounts.length; i++ ) {
            word = wordCounts[i].word;
            count = wordCounts[i].count;
            // get font size based on font size function
            fontSize = RendererUtil.getFontSize( count, maxCount, {
                maxFontSize: 30,
                minFontSize: 12,
                bias: -i/2
            });
            // get dimensions of word
            dim = getWordDimensions( word, fontSize );
            // starting spiral position
            pos = {
                radius : 1,
                radiusInc : 5,
                arcLength : 5,
                x : 0,
                y : 0,
                t : 0,
                collisions : 0
            };

            while( pos.collisions < 10 ) {
                // increment position in a spiral
                pos = spiralPosition( pos );
                // test for intersection
                if ( !intersectWord( pos, dim, cloud, boundingBox ) ) {
                    cloud.push({
                        word: word,
                        fontSize: fontSize,
                        x:pos.x,
                        y:pos.y,
                        width: dim.width,
                        height: dim.height
                    });
                    break;
                }
            }
        }
        return cloud;
    };

    function WordCloudRenderer( spec ) {
        Renderer.call( this, spec );
        injectCss( this.spec );
    }

    WordCloudRenderer.prototype = Object.create( Renderer.prototype );

    WordCloudRenderer.prototype.render = function( data ) {

        var text = this.spec.text,
            textKey = text.textKey,
            countKey = text.countKey,
            meta = this.meta[ this.map.getZoom() ],
            values = data.tile.values[0].value,
            numEntries = Math.min( values.length, MAX_WORDS_DISPLAYED),
            html = '',
            wordCounts = [],
            entries = [],
            maxCount,
            value,
            word,
            i,
            cloud;

         // get maximum count for layer if it exists in meta data
        maxCount = meta.minMax.max[ countKey ];

        for (i=0; i<numEntries; i++) {
            value = values[i];
            entries.push( value );
            wordCounts.push({
                word: RendererUtil.getAttributeValue( value, textKey ),
                count: RendererUtil.getAttributeValue( value, countKey )
            });
        }

        cloud = createWordCloud( wordCounts, maxCount );

        for ( i=0; i<cloud.length; i++ ) {

            word = cloud[i];
            value = values[i];

            html += '<div class="word-cloud-label" style="'
                    + 'font-size:'+word.fontSize+'px;'
                    + 'left:'+(128+word.x-(word.width/2))+'px;'
                    + 'top:'+(128+word.y-(word.height/2))+'px;'
                    + 'width:'+word.width+'px;'
                    + 'height:'+word.height+'px;">'+word.word+'</div>';
        }

        return {
            html: html,
            entries: entries
        };
    };

    module.exports = WordCloudRenderer;
}());
},{"./Renderer":20,"./RendererUtil":21,"jquery":2}],25:[function(require,module,exports){
/*
 * Copyright (c) 2014 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

( function() {

    "use strict";

    var $ = require('jquery'),
        _ = require('lodash'),
        Util = require('../util/Util'),
        AxisUtil = require('./AxisUtil'),
        AXIS_TITLE_CLASS = "axis-title-label",
        AXIS_DIV_CLASS_SUFFIX = "-axis",
        AXIS_HEADER_CLASS = "axis-header",
        AXIS_HEADER_CLASS_SUFFIX = "-axis-header",
        AXIS_CONTENT_CLASS = "axis-content",
        AXIS_CONTENT_CLASS_SUFFIX = "-axis-content",
        AXIS_LABEL_CLASS = "axis-marker-label",
        AXIS_POSITIONED_LABEL_CLASS_SUFFIX = "-axis-marker-label" ,
        AXIS_MARKER_CLASS = "axis-marker",
        AXIS_MARKER_SUFFIX = "-axis-marker",
        AXIS_POSITION_SUFFIX = "-axis",
        SPACING_BETWEEN_MARKER_AND_LABEL = 5,
        Z_INDEX = 2001;

    /**
     * Private: Creates and returns a dummy marker label element to measure. This function
     * is used for measuring, as the real label func sizes the labels to the current
     * max measurements
     *
     * @param axis   {Axis}     the axis object.
     * @param marker {Object} the marker object.
     */
    function createDummyMarkerLabelHTML( axis, marker ) {
        return '<div class="' + AXIS_LABEL_CLASS
            + ' ' + axis.horizontalOrVertical + AXIS_POSITIONED_LABEL_CLASS_SUFFIX + '"'
            + 'style="position:absolute;">'
            + AxisUtil.formatText( marker.label, axis.units )
            + '</div>';
    }

    /**
     * Private: Creates and returns a marker label element with proper CSS
     *
     * @param axis   {Axis}     the axis object.
     * @param marker {Object} the marker object.
     */
    function createMarkerLabelHTML( axis, marker ) {
        var primaryPosition,
            secondaryPosition;
        if ( axis.isXAxis ) {
            // if x axis, add half of label length as text is anchored from bottom
            primaryPosition = marker.pixel - axis.MAX_LABEL_UNROTATED_WIDTH*0.5;
            secondaryPosition =  axis.LARGE_MARKER_LENGTH
                + SPACING_BETWEEN_MARKER_AND_LABEL;
        } else {
            primaryPosition = marker.pixel - axis.MAX_LABEL_HEIGHT*0.5;
            secondaryPosition =  axis.LARGE_MARKER_LENGTH
                + SPACING_BETWEEN_MARKER_AND_LABEL;
        }
        return '<div class="' + AXIS_LABEL_CLASS + ' '
            + axis.horizontalOrVertical + AXIS_POSITIONED_LABEL_CLASS_SUFFIX + '"'
            + 'style="position:absolute;'
            + 'text-align: center; '    // center text horizontally
            + 'width: ' + axis.MAX_LABEL_WIDTH + 'px;'
            + 'height: ' + axis.MAX_LABEL_HEIGHT + 'px;'
            + 'line-height: ' + axis.MAX_LABEL_HEIGHT + 'px;'   // center text vertically
            + axis.leftOrTop + ":" + primaryPosition + 'px;'
            + axis.oppositePosition + ":" + secondaryPosition + 'px;">'
            + AxisUtil.formatText( marker.label, axis.units )
            +'</div>';
    }

    /**
     * Private: Creates and returns a large marker element with proper CSS
     *
     * @param axis   {Axis}     the axis object.
     * @param marker {Object} the marker object.
     */
    function createLargeMarkerHTML( axis, marker ) {
        return '<div class="' + AXIS_MARKER_CLASS
            + ' large-' + axis.horizontalOrVertical + AXIS_MARKER_SUFFIX
            + ' ' + axis.position + AXIS_POSITION_SUFFIX + '"'
            + 'style="position:absolute;'
            + axis.leftOrTop + ":" + (marker.pixel - axis.LARGE_MARKER_HALF_WIDTH) + 'px;">'
            + '</div>';
    }

    /**
     * Private: Creates and returns a major marker element with proper CSS
     *
     * @param axis   {Axis}     the axis object.
     * @param marker {Object} the marker object.
     */
    function createMediumMarkerHTML( axis, marker ) {
        return '<div class="' + AXIS_MARKER_CLASS
            + ' medium-' + axis.horizontalOrVertical + AXIS_MARKER_SUFFIX
            + ' ' + axis.position + AXIS_POSITION_SUFFIX + '"'
            + 'style="position:absolute;'
            + axis.leftOrTop + ":" + (marker.pixel - axis.MEDIUM_MARKER_HALF_WIDTH) + 'px;">'
            + '</div>';
    }

    /**
     * Private: Creates and returns a major marker element with proper CSS
     *
     * @param axis   {Axis}     the axis object.
     * @param marker {Object} the marker object.
     */
    function createSmallMarkerHTML( axis, marker ) {
        return '<div class="' + AXIS_MARKER_CLASS
            + ' small-' + axis.horizontalOrVertical + AXIS_MARKER_SUFFIX
            + ' ' + axis.position + AXIS_POSITION_SUFFIX + '"'
            + 'style="position:absolute;'
            + axis.leftOrTop + ":" + (marker.pixel - axis.SMALL_MARKER_HALF_WIDTH) + 'px;">'
            + '</div>';
    }

    /**
     * Private: This function is used to create temporary elements to determine the required run-time
     * dimensions. This is only be called once per axis as these dimensions will never change.
     *
     * @param axis{Axis} the axis object.
     */
    function calcElementDimensions( axis ) {
        var $temp;
        function measureLabelRotation( $label ) {
            var matrix, values, angle;
            matrix = $label.css("-webkit-transform") ||
                     $label.css("-moz-transform")    ||
                     $label.css("-ms-transform")     ||
                     $label.css("-o-transform")      ||
                     $label.css("transform") || 'none';
            if(matrix !== 'none') {
                values = matrix.split('(')[1].split(')')[0].split(',');
                angle = Math.atan2(values[1], values[0]);
            } else {
                angle = 0;
            }
            axis.ROTATION_RADIANS = Math.abs(angle);
        }
        function measureLabelMaxDimensions( $label ) {
            var sinW = $label.width() * Math.sin(axis.ROTATION_RADIANS),
                sinH = $label.height() * Math.sin(axis.ROTATION_RADIANS),
                cosW = $label.width() * Math.cos(axis.ROTATION_RADIANS),
                cosH = $label.height() * Math.cos(axis.ROTATION_RADIANS);
            axis.MAX_LABEL_WIDTH = Math.max( sinH + cosW, axis.MAX_LABEL_WIDTH );
            axis.MAX_LABEL_HEIGHT = Math.max( cosH + sinW, axis.MAX_LABEL_HEIGHT );
            axis.MAX_LABEL_UNROTATED_WIDTH = Math.max( $label.width(), axis.MAX_LABEL_UNROTATED_WIDTH );
        }
        // initialized all measurements to zero
        axis.LARGE_MARKER_LENGTH = 0;
        axis.LARGE_MARKER_HALF_WIDTH = 0;
        axis.MEDIUM_MARKER_HALF_WIDTH = 0;
        axis.SMALL_MARKER_HALF_WIDTH = 0;
        axis.MAX_LABEL_WIDTH = 0;
        axis.MAX_LABEL_HEIGHT = 0;
        axis.MAX_LABEL_UNROTATED_WIDTH = 0;
        axis.ROTATION_RADIANS = 0;
        axis.HEADER_WIDTH = axis.isXAxis ? axis.$header.height() : axis.$header.width();
        // measure large markers
        $temp = $(createLargeMarkerHTML( axis, {pixel:0} )).hide().appendTo(axis.$content);
        axis.LARGE_MARKER_LENGTH = $temp[axis.markerWidthOrHeight]();
        axis.LARGE_MARKER_HALF_WIDTH = Math.floor( $temp[axis.axisWidthOrHeight]()*0.5 );
        $temp.remove();
        // measure medium markers
        $temp = $(createMediumMarkerHTML( axis, {pixel:0} )).hide().appendTo(axis.$content);
        axis.MEDIUM_MARKER_HALF_WIDTH = Math.floor( $temp[axis.axisWidthOrHeight]() * 0.5);
        $temp.remove();
        // measure small markers
        $temp = $(createSmallMarkerHTML( axis, {pixel:0} )).hide().appendTo(axis.$content);
        axis.SMALL_MARKER_HALF_WIDTH = Math.floor( $temp[axis.axisWidthOrHeight]() * 0.5);
        $temp.remove();
        // label measurements
        $temp = $(createDummyMarkerLabelHTML( axis, {pixel:0, label:axis.max } )).appendTo(axis.$content);
        // get angle first, it is used in label measurements
        measureLabelRotation( $temp );
        // measure max label
        measureLabelMaxDimensions( $temp );
        $temp.remove();
        // measure min label
        $temp = $(createDummyMarkerLabelHTML( axis, {pixel:0, label:axis.min} )).appendTo(axis.$content);
        measureLabelMaxDimensions( $temp );
        $temp.remove();
    }

    /**
     * Private: Creates and returns the axis label element with proper CSS.
     *
     * @param axis {Axis} the axis object.
     */
    function createTitle( axis ) {
        var rotation = "",
            transformOrigin ="";
        if ( !axis.isXAxis ) {
            if (axis.position === "left") {
                rotation = "rotate(" + (-90) + "deg)";
                transformOrigin = "top left";
            } else {
                rotation = "rotate(" + 90 + "deg)";
                transformOrigin = "bottom left";
            }
        }
        return $('<span class="'+AXIS_TITLE_CLASS+'"'
            + 'style="position:absolute;'
            + '-webkit-transform: ' + rotation + ";"
            + '-moz-transform: ' + rotation + ";"
            + '-ms-transform: ' + rotation + ";"
            + '-o-transform: ' + rotation + ";"
            + 'transform: ' + rotation + ";"
            + '-webkit-transform-origin: ' + transformOrigin + ";"
            + '-moz-transform-origin: ' + transformOrigin + ";"
            + '-ms-transform-origin: ' + transformOrigin + ";"
            + '-o-transform-origin: ' + transformOrigin + ";"
            + 'transform-origin: ' + transformOrigin + ";"
            + '">' + axis.title + '</div>');
    }

    /**
     * Private: Creates and returns the axis header jquery object.
     *
     * @param axis {Axis} the axis object.
     */
    function createHeader( axis ) {
        var marginLeft = 0,
            marginRight = 0,
            marginTop = 0,
            marginBottom = 0;
        // add margins in case other axis exist, this prevents an ugly border overlap
        if ( axis.isXAxis ) {
            marginLeft = axis.$map.find('.left' + AXIS_HEADER_CLASS_SUFFIX ).width() || 0;
            marginRight = axis.$map.find('.right' + AXIS_HEADER_CLASS_SUFFIX ).width() || 0;
        } else {
            marginTop = axis.$map.find('.top' + AXIS_HEADER_CLASS_SUFFIX ).height() || 0;
            marginBottom = axis.$map.find('.bottom' + AXIS_HEADER_CLASS_SUFFIX ).height() || 0;
        }
        return $('<div class="'+ AXIS_HEADER_CLASS + " " + axis.position + AXIS_HEADER_CLASS_SUFFIX + '"'
               + 'style="z-index:'+(Z_INDEX+2)+';'
               + 'margin:'+marginTop+'px '+marginRight+'px '+marginBottom+'px '+marginLeft+'px;"></div>');
    }


    /**
     * Private: Creates and returns the axis header background jquery object. This is used
     * to apply a box-shadow css without ugly overlap.
     *
     * @param axis {Axis} the axis object.
     */
    function createHeaderBack( axis ) {
        return $('<div class="'+ AXIS_HEADER_CLASS + " " + AXIS_HEADER_CLASS + "-back " + axis.position + AXIS_HEADER_CLASS_SUFFIX + '"'
               + 'style="z-index:'+(Z_INDEX+1)+';"></div>' );
    }


    /**
     * Private: Creates and returns the empty axis content jquery object.
     *
     * @param axis {Axis} the axis object.
     */
    function createContent( axis ) {
        return $('<div class="'+ AXIS_CONTENT_CLASS
               + " " + axis.position + AXIS_CONTENT_CLASS_SUFFIX
               + '"  style="z-index:'+Z_INDEX+';"></div>');
    }


    /**
     * Private: Creates and returns the axis parent div jquery object.
     *
     * @param axis {Axis} the axis object.
     */
    function createAxis( axis ) {
        var $axis,
            enableSlide,
            disableSlide,
            horizontalSlide,
            verticalSlide;
        enableSlide = function() {
            // set enable / disable callbacks
            if (axis.isXAxis) {
                axis.$header.click(verticalSlide);
                axis.$content.click(verticalSlide);
            } else {
                axis.$header.click(horizontalSlide);
                axis.$content.click(horizontalSlide);
            }
        };
        disableSlide = function() {
            axis.$header.off('click');
            axis.$content.off('click');
        };
        horizontalSlide = function() {
            axis.setEnabled( !axis.isEnabled() );
            axis.setContentDimension();
            disableSlide();
            axis.$content.animate({width: 'toggle'}, {duration: 300, complete: function(){ enableSlide();} });
        };
        verticalSlide = function() {
            axis.setEnabled( !axis.isEnabled() );
            axis.setContentDimension();
            disableSlide();
            axis.$content.animate({height: 'toggle'}, {duration: 300, complete: function(){ enableSlide();} });
        };
        // create axis title, header, and container and append them to root
        axis.$title = createTitle( axis );
        axis.$header = createHeader( axis ).append( axis.$title );
        axis.$content = createContent( axis );
        $axis = $('<div class="'+ axis.position + AXIS_DIV_CLASS_SUFFIX + '"></div>')
                    .append( axis.$content )
                        .append( axis.$header )
                            .append( createHeaderBack( axis ) );
        // enable callbacks
        enableSlide();
        // return root
        return $axis;
    }

    /**
     * Private: Updates the positon of the axis title of its size changes.
     *
     * @param axis {Axis} the axis object.
     */
    function updateAxisTitle( axis ) {
        // update axis length
        var $title = axis.$title,
            axisLength = axis.$map.css( axis.axisWidthOrHeight ).replace('px', ''), // strip px suffix
            padding;
        // add position offset for vertical axes
        if ( !axis.isXAxis ) {
            if (axis.position === 'left') {
                $title.css( axis.leftOrTop, axisLength + "px" );
            } else {
                $title.css( axis.leftOrTop, -$title.width()*0.5 + "px" );
            }
        }
        // calc padding
        padding = (axisLength*0.5 - $title.width()*0.5);
        // add padding for hover hit box
        $title.css('padding-left', padding + "px");
        $title.css('padding-right', padding + "px" );
    }

    /**
     * Private: Creates the axis marker elements and appends them to the content div.
     *
     * @param axis {Axis} the axis object.
     */
    function updateAxisContent( axis ) {
        var markers,
            markersHTML = "",
            markersBySize,
            i;
        // generate array of marker labels and pixel locations
        markersBySize = AxisUtil.getMarkers( axis );
        // large markers
        markers = markersBySize.large;
        for (i = 0; i < markers.length; i++) {
            markersHTML += createLargeMarkerHTML( axis, markers[i] );
            markersHTML += createMarkerLabelHTML( axis, markers[i] );
        }
        // medium markers
        markers = markersBySize.medium;
        for (i = 0; i < markers.length; i++) {
            markersHTML += createMediumMarkerHTML( axis, markers[i] );
        }
        // small markers
        markers = markersBySize.small;
        for (i = 0; i < markers.length; i++) {
            markersHTML += createSmallMarkerHTML( axis, markers[i] );
        }
        // append all markers and labels at once
        axis.$content[0].innerHTML = markersHTML;
    }

    /**
     * Private: Returns the draw callback function on map 'move' event.
     *
     * @param axis {Axis} The axis object.
     */
    function redrawCallback( axis ) {
        return function() {
            axis.redraw();
        };
    }

    /**
     * Private: Returns the mouse marker callback function on 'mousemove' event.
     *
     * @param axis {Axis} The axis object.
     */
    function mouseMoveCallback( axis ) {
        return function( event ) {
            if ( !axis.enabled ) {
                return;
            }
            var marker = AxisUtil.getMarker( axis, event.xy.x, event.xy.y );
            axis.$content.find( '.mouse-marker' ).remove();
            axis.$content.append( $( createLargeMarkerHTML( axis, marker ) ).addClass( 'mouse-marker' ) );
        };
    }

    function Axis( spec ) {

        this.position = ( spec.position !== undefined ) ? spec.position.toLowerCase() : 'bottom';
        this.repeat = ( spec.repeat !== undefined ) ? spec.repeat : false;
        this.title = spec.title || 'Axis';
        this.isOpen = ( spec.isOpen !== undefined ) ? spec.isOpen : true;

        spec.intervals = spec.intervals || {};
        this.intervals = {};
        this.intervals.type = ( spec.intervals.type !== undefined ) ? spec.intervals.type.toLowerCase() : 'percentage';
        this.intervals.increment = spec.intervals.increment || 10;
        this.intervals.pivot = ( spec.intervals.pivot !== undefined ) ? spec.intervals.pivot : 0;
        this.intervals.scaleByZoom = ( spec.intervals.scaleByZoom !== undefined ) ? spec.intervals.scaleByZoom : true;

        spec.units = spec.units || {};
        this.units = {};
        this.units.type = ( spec.units.type !== undefined ) ? spec.units.type.toLowerCase() : 'decimal';
        this.units.divisor = spec.units.divisor || 1000;
        this.units.decimals = spec.units.decimals || 2;
        this.units.stepDown = ( spec.units.stepDown !== undefined ) ? spec.units.stepDown : true;

        // generate more attributes
        this.isXAxis = ( this.position === 'top' || this.position === 'bottom' );
        this.axisWidthOrHeight = this.isXAxis ? "width" : "height";
        this.markerWidthOrHeight = this.isXAxis ? "height" : "width";
        this.leftOrTop = this.isXAxis ? "left" : "top";
        this.horizontalOrVertical = (this.isXAxis) ? 'horizontal' : 'vertical';
        this.oppositePosition = (this.position === 'left') ? 'right' :
                                    (this.position === 'right') ? 'left' :
                                        (this.position === 'top') ? 'bottom' : 'top';
    }

    Axis.prototype.activate = function() {
        // create unique callbacks so they can be removed later
        this.redrawCallback = redrawCallback( this );
        this.mouseMoveCallback = mouseMoveCallback( this );
        // attach callbacks
        this.map.on( 'move', this.redrawCallback );
        this.map.on( 'mousemove', this.mouseMoveCallback );
        // generate the core html elements
        this.$map = $( this.map.getElement() );
        this.$axis = createAxis( this );
        this.$map.append( this.$axis );
        // always set enabled to true, as isOpen attr will trigger a click, which toggles the enabled flag
        this.enabled = true;
        // calculate the dimensions of the individual elements once
        calcElementDimensions( this );
        // check if axis starts open or closed
        if ( !this.isOpen ) {
            // trigger close and skip animation;
            this.$header.click();
            this.$content.finish();
        }
        // allow events to propagate below to map except 'click'
        Util.enableEventPropagation( this.$axis );
        Util.disableEventPropagation( this.$axis, ['onclick', 'ondblclick'] );
    };

    Axis.prototype.deactivate = function() {
        this.map.off( 'move', this.redrawCallback );
        this.map.off( 'mousemove', this.mouseMoveCallback );
        this.$axis.remove();
        this.$axis = null;
        this.$title = null;
        this.$header = null;
        this.$content = null;
        this.redrawCallback = null;
        this.mouseMoveCallback = null;
    };

    /**
     *  Returns true if the axis is currently enabled, false if not
     */
    Axis.prototype.isEnabled = function() {
        return this.enabled;
    };

    /**
     *  Enable or disable the axis
     */
    Axis.prototype.setEnabled = function( enabled ) {
        this.enabled = enabled;
    };

    /**
     *  Returns the dimension of the content div of the axis
     */
    Axis.prototype.getContentDimension = function() {
        var dim = this.isXAxis ? this.MAX_LABEL_HEIGHT : this.MAX_LABEL_WIDTH;
        return dim + SPACING_BETWEEN_MARKER_AND_LABEL*2 + this.LARGE_MARKER_LENGTH + this.HEADER_WIDTH;
    };

    /**
     * Iterates over all axes on the map, determines the max content size, and sets the content dimension
     * to that size.
     */
    Axis.prototype.setContentDimension = function() {
        var dim = this.isXAxis ? 'height' : 'width',
            maxAxisLabelDim = 0;
        _.forIn( this.map.axes, function( value ) {
            maxAxisLabelDim = Math.max( value.getContentDimension() || 0, maxAxisLabelDim );
        });
        this.$content[ dim ]( maxAxisLabelDim );
    };

    /**
     * Checks if the mutable spec attributes have changed, if so, redraws
     * that.
     */
    Axis.prototype.redraw = function() {
        // always update title position (in case of window resize)
        updateAxisTitle( this );
        // exit early if no markers are visible
        if ( !this.isEnabled() ) {
            return;
        }
        // add each marker to correct pixel location in axis DOM elements
        updateAxisContent( this );
    };

    module.exports = Axis;
}());

},{"../util/Util":36,"./AxisUtil":26,"jquery":2,"lodash":3}],26:[function(require,module,exports){
/*
 * Copyright (c) 2014 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

( function() {

    "use strict";

    var Util = require('../util/Util'),
        MapUtil = require('./MapUtil'),
        MARKER_TYPE_ORDER = ['large', 'small', 'medium', 'small'];

    /**
     * Private: Given a value that is outside of the min and max of axis,
     * ensure the values rollover properly
     *
     * @param axis  {Axis}   the axis object.
     * @param value {number} original value.
     */
    function getMarkerRollover( axis, value ) {
        var rollover;
        if ( axis.repeat ) {
            // if repeat enabled ensure label value wraps past min/max properly
            if ( value > axis.max ) {
                rollover = value - axis.max + axis.min;
            } else if ( value < axis.min ) {
                rollover = value + axis.max - axis.min;
            } else {
                rollover = value;
            }
        } else {
            // non-repeat label is always value as there is no wrap around
            rollover = value;
        }
        return rollover;
    }

    /**
     * Private: Returns the pixel position for the value in viewport coordinates.
     *
     * @param axis  {Axis}   axis object.
     * @param value {number} the coordinate value.
     * @returns {int} pixel position
     */
    function getPixelPosition( axis, value ) {
        // given an axis value, get the pixel position on the page
        if ( axis.isXAxis ) {
            return MapUtil.getViewportPixelFromCoord( axis.map, value, 0 ).x;
        }
        return MapUtil.getViewportPixelFromCoord( axis.map, 0, value ).y;
    }

    /**
     * Private: Fills an array of markers by sub increments.
     *
     * @param axis      {Axis}   axis object.
     * @param start     {number} start increment.
     * @param end       {number} end increment
     * @param intervals {Object} intervals specification object.
     * @returns {{large: Array, medium: Array, small: Array}}
     */
    function fillArrayByIncrement( axis, start, end, intervals ) {
        var EPSILON = 0.000001,
            subIncrement = intervals.subIncrement,
            startingMarkerTypeIndex = intervals.startingMarkerTypeIndex,
            markers = {
                large: [],
                medium: [],
                small: []
            },
            i = Util.mod( startingMarkerTypeIndex, MARKER_TYPE_ORDER.length ),
            value;
        // reduce sub increment by epsilon to prevent precision errors culling max point
        subIncrement = ( subIncrement > 0 ) ? subIncrement - EPSILON : subIncrement + EPSILON;

        for ( value = start; value <= end; value += subIncrement ) {
            markers[ MARKER_TYPE_ORDER[i] ].push({
                label: getMarkerRollover( axis, value ),
                pixel: getPixelPosition( axis, value )
            });
            i = (i + 1) % MARKER_TYPE_ORDER.length;
        }
        return markers;
    }

    /**
     * Private: Returns the minimum visible increment on the axis. Also sets the
     * 'startingMarkerTypeIndex' attribute on the intervals object to distinguish
     * which type of marker to start on.
     *
     * @param axis      {Axis}   axis object.
     * @param intervals {Object} intervals specification object.
     * @returns {number} minimum increment.
     */
    function getMinIncrement( axis, intervals ) {
        var minCull, // exact value of cull point, any value less will be culled from view
            incrementCount; // number of sub increments from the pivot
        if ( axis.isXAxis ) {
            minCull = MapUtil.getCoordFromViewportPixel( axis.map, 0, 0 ).x;
        } else {
            minCull = MapUtil.getCoordFromViewportPixel( axis.map, 0, axis.map.getViewportHeight() ).y;
        }
        if ( !axis.repeat && minCull < axis.min ) {
            // prevent roll-over
            minCull = axis.min;
        }
        // determine how many sub increments from the pivot to the minimum culling point
        incrementCount = Math.floor( ( minCull - intervals.pivot ) / intervals.subIncrement );
        intervals.startingMarkerTypeIndex = incrementCount;
        // return the minimum increment that is still in view
        return intervals.pivot + intervals.subIncrement * incrementCount;
    }

    /**
     * Private: Returns the maximum visible increment on the axis.
     *
     * @param axis      {Axis}   axis object.
     * @param intervals {Object} intervals specification object.
     * @returns {number} maximum increment.
     */
    function getMaxIncrement( axis, intervals ) {
        var maxCull, // exact value of cull point, any value greater will be culled from view
            incrementCount; // number of sub increments from the pivot
        if ( axis.isXAxis ) {
            maxCull = MapUtil.getCoordFromViewportPixel( axis.map, axis.map.getViewportWidth(), 0 ).x;
        } else {
            maxCull = MapUtil.getCoordFromViewportPixel( axis.map, 0, 0 ).y;
        }
        if ( !axis.repeat && maxCull > axis.max ) {
            // prevent roll-over
            maxCull = axis.max;
        }
        // determine how many sub increments from the pivot to the maximum culling point
        incrementCount = Math.floor( ( maxCull - intervals.pivot ) / intervals.subIncrement );
        // return the maximum increment that is still in view
        return intervals.pivot + intervals.subIncrement * incrementCount;
    }

    /**
     * Private: Rounds a value to an integer representation.
     *
     * @param value {number} the value.
     * @returns {int}
     */
    function formatInteger( value ) {
        return Math.round( value );
    }

    /**
     * Private: Rounds a value to an floating point representation with specific decimal places.
     *
     * @param value    {number} the value.
     * @param decimals {int}    the number of decimal places.
     * @returns {string}
     */
    function formatNumber( value, decimals ) {
        return Util.roundToDecimals( value, decimals );
    }

    /**
     * Private: Rounds a value to an floating point representation of thousands with a 'K' appended
     * onto the end.
     *
     * @param value         {number}  the value.
     * @param decimals      {int}     the number of decimal places.
     * @param allowStepDown {boolean} whether or not to step down units if < 1
     * @returns {string}
     */
    function formatThousand( value, decimals, allowStepDown ) {
        var truncValue = value / 1e3;
        if ( allowStepDown && Math.abs( truncValue ) < 1 && value !== 0 ) {
            return formatNumber( value, 0 );
        }
        return Util.roundToDecimals( truncValue, decimals ) + 'K';
    }

    /**
     * Private: Rounds a value to an floating point representation of millions with an 'M' appended
     * onto the end.
     *
     * @param value         {number}  the value.
     * @param decimals      {int}     the number of decimal places.
     * @param allowStepDown {boolean} whether or not to step down units if < 1
     * @returns {string}
     */
    function formatMillion( value, decimals, allowStepDown ) {
        var truncValue = value / 1e6;
        if ( allowStepDown && Math.abs( truncValue ) < 1 && value !== 0 ) {
            return formatThousand( value, 0 );
        }
        return Util.roundToDecimals( truncValue, decimals ) + 'M';
    }

    /**
     * Private: Rounds a value to an floating point representation of billions with a 'B' appended
     * onto the end.
     *
     * @param value         {number}  the value.
     * @param decimals      {int}     the number of decimal places.
     * @param allowStepDown {boolean} whether or not to step down units if < 1
     * @returns {string}
     */
    function formatBillion( value, decimals, allowStepDown ) {
        var truncValue = value / 1e9;
        if ( allowStepDown && Math.abs( truncValue ) < 1 && value !== 0 ) {
            return formatMillion( value, 0 );
        }
        return Util.roundToDecimals( truncValue, decimals ) + 'B';
    }

    /**
     * Private: Formats a timestamp into a date.
     *
     * @param value {int} unix timestamp.
     * @returns {string}
     */
    function formatTime( value ) {
        var d = new Date( 0 ); // The 0 there is the key, which sets the date to the epoch
        d.setUTCSeconds( value / 1000 ); // Assume default of milliseconds
        return ( d.getMonth() + 1 ) + '/' + d.getDate() + '/' + ( d.getFullYear() );
    }

    /**
     * Private: Formats a floating point number and appends a 'degrees' symbol.
     *
     * @param value    {float} degrees value.
     * @param decimals {int}   the number of decimal places.
     * @returns {string}
     */
    function formatDegrees( value, decimals ) {
        return formatNumber( value, decimals ) + "\u00b0";
    }

    module.exports = {

        /**
         * Formats axis marker label text.
         *
         * @param value {number} value of the label
         * @param units {Object} unit specification of the axis.
         */
        formatText: function( value, units ) {

            if ( !units ) {
                return formatNumber( value, 2 );
            }

            switch ( units.type ) {

                case 'degrees':
                case 'degree':
                case 'deg':

                    return formatDegrees( value, units.decimals );

                case 'time':
                case 'date':

                    return formatTime( value );

                case 'k':
                case 'thousand':
                case 'thousands':

                    return formatThousand( value, units.decimals, units.stepDown );

                case 'm':
                case 'million':
                case 'millions':

                    return formatMillion( value, units.decimals, units.stepDown );

                case 'b':
                case 'billion':
                case 'billions':

                    return formatBillion( value, units.decimals, units.stepDown );

                case 'i':
                case 'int':
                case 'integer':

                    return formatInteger(value);

                default:

                    return formatNumber( value, units.decimals );
            }
        },

        /**
         * Generates a marker value for the given viewport pixel coords.
         *
         * @param axis {Axis} the axis object.
         * @param vx   {int}  x viewport pixel coordinate
         * @param vy   {int}  y viewport pixel coordinate
         */
        getMarker: function( axis, vx, vy ) {
            var xOrY = axis.isXAxis ? 'x' : 'y',
                pixel = ( axis.isXAxis ) ? vx : vy,
                value = MapUtil.getCoordFromViewportPixel( axis.map, vx, vy )[ xOrY ];
            return {
                label: getMarkerRollover(axis, value),
                pixel: pixel
            };
        },

        /**
         * Generates all visible marker values, returns array of objects, containing
         * labels and pixel locations
         *
         * @param axis {Axis} the axis object.
         */
        getMarkers: function( axis ) {
            var intervals = {},
                increment,
                minIncrement,
                maxIncrement;

            switch ( axis.intervals.type ) {

                case "value":
                case "fixed":
                case "#":
                    // use fixed interval
                    increment = axis.intervals.increment;
                    break;

                default:
                    // use percentage
                    increment = axis.intervals.increment;
                    increment = ( increment > 1 ) ? increment * 0.01 : increment;
                    increment = ( axis.max - axis.min ) * increment;
                    break;
            }

            // set pivot
            intervals.pivot = axis.intervals.pivot;

            // scale increment if specified
            if ( axis.intervals.scaleByZoom ) {
                // scale increment by zoom
                increment = increment / Math.pow(2, Math.max( axis.map.getZoom() - 1, 0) );
            }

            // get sub increment for small / medium label-less ticks
            intervals.subIncrement = increment / MARKER_TYPE_ORDER.length;

            // get minimum and maximum visible increments on the axis
            minIncrement = getMinIncrement( axis, intervals );
            maxIncrement = getMaxIncrement( axis, intervals );

            // add all points between minimum visible value and maximum visible value
            return fillArrayByIncrement( axis, minIncrement, maxIncrement, intervals );
        }
    };
}());

},{"../util/Util":36,"./MapUtil":28}],27:[function(require,module,exports){
/*
 * Copyright (c) 2014 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

( function() {

	"use strict";

	var OpenLayers = require('../openlayers/OpenLayers.min'),
        $ = require('jquery'),
        _ = require('lodash'),
        Axis = require('./Axis'),
        MapUtil = require('./MapUtil'),
        Layer = require('../layer/Layer'),
        BaseLayer = require('../layer/BaseLayer'),
        PubSub = require('../util/PubSub'),
	    AreaOfInterestTilePyramid = require('../binning/AreaOfInterestTilePyramid'),
	    WebMercatorTilePyramid = require('../binning/WebMercatorTilePyramid'),
	    TileIterator = require('../binning/TileIterator'),
	    TILESIZE = 256,
        setMapCallbacks,
        activateComponent,
        deactivateComponent,
        activateDeferredComponents,
        addBaseLayer,
        addLayer,
        addAxis,
        removeBaseLayer,
        removeLayer,
        removeAxis;

    /**
     * Private: Set callbacks to update the maps tile focus, identifying which tile
     * the user is currently hovering over.
     *
     * @param map {Map} The map object.
     */
    setMapCallbacks = function( map ) {
        var previousMouse = {};
        function updateTileFocus( x, y ) {
            var tileAndBin = MapUtil.getTileAndBinFromViewportPixel( map, x, y, 1, 1 ),
			    tilekey = tileAndBin.tile.level + ","
                    + tileAndBin.tile.xIndex + ","
                    + tileAndBin.tile.yIndex;
            if ( tilekey !== map.tileFocus ) {
                // only update tilefocus if it actually changes
                map.previousTileFocus = map.tileFocus;
                map.tileFocus = tilekey;
                PubSub.publish( 'layer', { field: 'tileFocus', value: tilekey });
            }
        }
        // set tile focus callbacks
        map.on('mousemove', function( event ) {
            updateTileFocus( event.xy.x, event.xy.y );
            previousMouse.x = event.xy.x;
            previousMouse.y = event.xy.y;
        });
        map.on('zoomend', function( event ) {
            updateTileFocus( previousMouse.x, previousMouse.y );
        });
        // if mousedown while map is panning, interrupt pan
        $( map.getElement() ).mousedown( function(){
            if ( map.olMap.panTween ) {
                 map.olMap.panTween.callbacks = null;
                 map.olMap.panTween.stop();
            }
        });
        // set resize callback
        $( window ).resize( function() {
            map.olMap.updateSize();
        });
    };

    /**
     * Private: Activates a component.
     *
     * @param map       {Map} The map object.
     * @param component {*}   The component to activate.
     */
    activateComponent = function( map, component ) {
        if ( component instanceof Layer ) {
            addLayer( map, component );
        } else if ( component instanceof Axis ) {
            addAxis( map, component );
        }
    };

    /**
     * Private: Deactivates a component.
     *
     * @param map       {Map} The map object.
     * @param component {*}   The component to deactivate.
     */
    deactivateComponent = function( map, component ) {
        if ( component instanceof BaseLayer ) {
            removeBaseLayer( map, component );
        } else if ( component instanceof Layer ) {
            removeLayer( map, component );
        } else if ( component instanceof Axis ) {
            removeAxis( map, component );
        }
    };

    /**
     * Private: Activates deferred components when the map is ready.
     *
     * @param map {Map} The map object.
     */
    activateDeferredComponents = function( map ) {
        var i;
        for ( i=0; i<map.deferreds.length; i++ ) {
            activateComponent( map, map.deferreds[i] );
        }
        delete map.deferreds;
    };

    /**
     * Private: Adds a base layer to the map. If no baselayer is attached, it
     * will also activate it, along with any deferred components that were attached
     * first.
     *
     * @param map       {Map}       The map object.
     * @param baselayer {BaseLayer} The baselayer object.
     */
    addBaseLayer = function( map, baselayer ) {
        // add map to baselayer
        baselayer.map = map;
        // add to baselayer array
        map.baselayers = map.baselayers || [];
        map.baselayers.push( baselayer );
        // if first baselayer, activate the map
        if ( map.baseLayerIndex < 0 ) {
            // openlayers maps require a baselayer to operate, once
            // this baselayer is set, activate the map
            map.setBaseLayerIndex( 0 );
            // set initial viewpoint, required by openlayers
            map.olMap.zoomToMaxExtent();
            // set mouse callbacks
            setMapCallbacks( map );
            if ( map.deferreds ) {
                activateDeferredComponents( map );
            }
        }
    };

    /**
     * Private: Adds a layer object to the map and activates it.
     *
     * @param map       {Map}   The map object.
     * @param layer {Layer} The layer object.
     */
    addLayer = function( map, layer ) {
        // add map to layer
        layer.map = map;
        // activate the layer
        layer.activate();
        // add it to layer map
        map.layers = map.layers || {};
        map.layers[ layer.getUUID() ] = layer;
    };

    /**
     * Private: Adds an Axis object to the map and activates it.
     *
     * @param map  {Map}   The map object.
     * @param axis {Axis} The layer object.
     */
    addAxis = function( map, axis ) {
        // set min/max based on pyramid
        if ( axis.position === 'top' || axis.position === 'bottom' ) {
            axis.min = map.pyramid.minX;
            axis.max = map.pyramid.maxX;
        } else {
            axis.min = map.pyramid.minY;
            axis.max = map.pyramid.maxY;
        }

        // activate and attach to map
        axis.map = map;
        axis.activate();
        map.axes = map.axes || {};
        map.axes[ axis.position ] = axis;

        // update dimensions
        _.forIn( map.axes, function( value ) {
            value.setContentDimension();
        });

        // redraw
        _.forIn( map.axes, function( value ) {
            value.redraw();
        });
    };

    /**
     * Private: Removes a base layer from the map. If no other baselayer is attached, it
     * will refuse to do so.
     *
     * @param map       {Map}       The map object.
     * @param baselayer {BaseLayer} The baselayer object.
     */
    removeBaseLayer = function( map, baselayer ) {
        var index;
        // if only 1 baselayer available, ignore
        if ( map.baselayers.length === 1 ) {
            console.error( 'Error: attempting to remove only baselayer from map, this destroys the map, use destroy() instead' );
            return;
        }
        // get index of baselayer
        index = map.baselayers.indexOf( baselayer );
        // remove baselayer from array
        map.baselayers.splice( index, 1 );
        // get replacement index
        index = ( map.baselayers[ index ] ) ? index : index-1;
        // replace baselayer
        map.setBaseLayerIndex( index );
        baselayer.map = null;
    };

    /**
     * Private: Removes a layer object from the map and deactivates it.
     *
     * @param map       {Map}   The map object.
     * @param layer {Layer} The layer object.
     */
    removeLayer = function( map, layer ) {
        // remove it from layer map
        delete map.layers[ layer.getUUID() ];
        // deactivate it
        layer.deactivate();
        layer.map = null;
    };

    /**
     * Private: Removes an Axis object from the map and deactivates it.
     *
     * @param map  {Map}   The map object.
     * @param axis {Axis} The layer object.
     */
    removeAxis = function( map, axis ) {
        // remove it from axes map
        delete map.axes[ axis.position ];
        // deactivate it
        axis.deactivate();
        axis.map = null;
    };

	function Map( id, spec ) {

        spec = spec || {};
        spec.options = spec.options || {};
        spec.pyramid = spec.pyramid || {};

        // element id
        this.id = id;
        // set map tile pyramid
        if ( spec.pyramid.type === "AreaOfInterest" ) {
            this.pyramid = new AreaOfInterestTilePyramid( spec.pyramid );
        } else {
            this.pyramid = new WebMercatorTilePyramid();
        }
        // initialize base layer index to -1 for no baselayer
        this.baseLayerIndex = -1;

        // create map object
        this.olMap = new OpenLayers.Map( this.id, {
            projection: new OpenLayers.Projection( spec.options.projection || "EPSG:900913" ),
            displayProjection: new OpenLayers.Projection( spec.options.displayProjection || "EPSG:4326" ),
            maxExtent: OpenLayers.Bounds.fromArray( spec.options.maxExtent || [
                -20037508.342789244,
				-20037508.342789244,
				20037508.342789244,
				20037508.342789244
            ]),
            units: spec.options.units || "m",
            numZoomLevels: spec.options.numZoomLevels || 18,
            controls: [
                new OpenLayers.Control.Navigation({ documentDrag: true }),
                new OpenLayers.Control.Zoom()
            ]
        });
    }

    Map.prototype = {

        /**
         * Adds a component to the map.
         *
         * @param component {*} The component object.
         */
        add: function( component ) {
            if ( component instanceof BaseLayer ) {
                // if a baselayer, add it
                addBaseLayer( this, component );
                return;
            }
            if ( this.baseLayerIndex < 0 ) {
                // if no baselayer is attached yet, we cannot activate the component
                // add it to list of deferred activations
                this.deferreds = this.deferreds || [];
                this.deferreds.push( component );
                return;
            }
            // activate the component
            activateComponent( this, component );
        },

        /**
         * Removes a component from the map.
         *
         * @param component {*} The component object.
         */
        remove: function( component ) {
            if ( this.baseLayerIndex < 0 ) {
                // if no baselayer is attached yet, we cannot deactivate the component
                // remove it from the list of deferred activations
                this.deferreds = this.deferreds || [];
                this.deferreds.splice( this.deferreds.indexOf( component ), 1 );
                return;
            }
            // activate the component
            deactivateComponent( this, component );
        },

        /**
         * Returns the tilekey for the tile currently under the mouse.
         */
        getTileFocus: function() {
            return this.tileFocus;
        },

        /**
         * If multiple baselayers are attached to the map, this function is
         * used to change the index.
         *
         * @param index {int} The index of the baselayer to switch to.
         */
        setBaseLayerIndex: function( index ) {
            var oldBaseLayer = this.baselayers[ this.baseLayerIndex ],
                newBaseLayer = this.baselayers[ index ];
            if ( !newBaseLayer ) {
                console.error("Error, no baselayer for supplied index: " + index );
                return;
            }
            if ( oldBaseLayer ) {
                oldBaseLayer.deactivate();
            }
            newBaseLayer.activate();
            this.baseLayerIndex = index;
            PubSub.publish( newBaseLayer.getChannel(), { field: 'baseLayerIndex', value: index });
        },

        /**
         * Returns the currently active baselayer index.
         *
         * @returns {number|*}
         */
        getBaseLayerIndex: function() {
            return this.baseLayerIndex;
        },

        /**
         * Returns the current theme of the map. Currently restricted to "dark"
         * and "light".
         *
         * @returns {string} The theme of the map.
         */
        getTheme: function() {
        	return $( this.olMap.div ).hasClass( "light-theme" ) ? 'light' : 'dark';
        },

        /**
         * Returns the map DOM element. This is the element to which
         * the map object is 'attached'.
         *
         * @returns {HTMLElement} The map div element.
         */
        getElement:  function() {
            return this.olMap.div;
        },

        /**
         * Returns the map viewport DOM element. This the element that matches
         * the viewable portion of the map.
         *
         * @returns {HTMLElement} The map viewport div element.
         */
        getViewportElement:  function() {
            return this.olMap.viewPortDiv;
        },

        /**
         * Returns the map container DOM element. This is the element to which all
         * 'pannable' layers are attached to.
         *
         * @returns {HTMLElement} The map container div element.
         */
        getContainerElement:  function() {
            return this.olMap.layerContainerDiv;
        },

        /**
         * Returns the tile pyramid used for the map.
         *
         * @returns { AreaOfInterestTilePyramid | WebMercatorTilePyramid } TilePyramid Object.
         */
		getPyramid: function() {
			return this.pyramid;
		},

        /**
         * Returns a TileIterator object. This TileIterator contains all viewable
         * tiles currently in the map.
         *
         * @returns {TileIterator} TileIterator object.
         */
		getTileIterator: function() {
			var level = this.olMap.getZoom(),
			    // Current map bounds, in meters
			    bounds = this.olMap.getExtent(),
			    // Total map bounds, in meters
			    extents = this.olMap.getMaxExtent(),
			    // Pyramid for the total map bounds
			    pyramid = new AreaOfInterestTilePyramid({
                    minX: extents.left,
                    minY: extents.bottom,
                    maxX: extents.right,
                    maxY: extents.top
                });
			// determine all tiles in view
			return new TileIterator({
                pyramid: pyramid,
                level: level,
                minX: bounds.left,
                minY: bounds.bottom,
                maxX: bounds.right,
                maxY: bounds.top
            });
		},

        /**
         * Returns an array of all tilekeys currently in view.
         *
         * @returns {Array} An array of tilekey strings.
         */
		getTilesInView: function() {
            var tiles = this.getTileIterator().getRest(),
                culledTiles = [],
                maxTileIndex = Math.pow(2, this.getZoom() ),
                tile,
                i;
            for (i=0; i<tiles.length; i++) {
                tile = tiles[i];
                if ( tile.xIndex >= 0 && tile.yIndex >= 0 &&
                     tile.xIndex < maxTileIndex && tile.yIndex < maxTileIndex ) {
                     culledTiles.push( tile.level + "," + tile.xIndex + "," + tile.yIndex );
                }
            }
            return culledTiles;
		},

        /**
         * Zooms the map to a particular coordinate, and zoom level. This
         * transition is instantaneous.
         *
         * @param x    {float} x coordinate (longitude for geospatial)
         * @param y    {float} y coordinate (latitude for geospatial)
         * @param zoom {int}   zoom level
         */
        zoomTo: function( x, y, zoom ) {
            var projection,
                viewportPx,
                lonlat;
            if ( this.pyramid instanceof WebMercatorTilePyramid ) {
                // geo-spatial map
                projection = new OpenLayers.Projection('EPSG:4326');
                lonlat = new OpenLayers.LonLat( x, y );
                if( this.olMap.getProjection() !== projection.projCode ) {
                    lonlat.transform( projection, this.olMap.projection );
                }
                this.olMap.setCenter( lonlat, zoom );
            } else {
                // linear bi-variate map
                viewportPx = this.getViewportPixelFromCoord( x, y );
                lonlat = this.olMap.getLonLatFromViewPortPx( viewportPx );
                this.olMap.setCenter( lonlat, zoom );
            }
        },

        /**
         * Pans the map to a particular coordniate. This
         * transition is gradual.
         *
         * @param x    {float} x coordinate (longitude for geospatial)
         * @param y    {float} y coordinate (latitude for geospatial)
         */
        panTo: function( x, y ) {
            var projection,
                viewportPx,
                lonlat;
            if ( this.pyramid instanceof WebMercatorTilePyramid ) {
                // geo-spatial map
                projection = new OpenLayers.Projection('EPSG:4326');
                lonlat = new OpenLayers.LonLat( x, y );
                if( this.olMap.getProjection() !== projection.projCode ) {
                    lonlat.transform( projection, this.olMap.projection );
                }
                this.olMap.panTo( lonlat );
            } else {
                // linear bi-variate map
                viewportPx = this.getViewportPixelFromCoord( x, y );
                lonlat = this.olMap.getLonLatFromViewPortPx( viewportPx );
                this.olMap.panTo( lonlat );
            }
        },

        /**
         * Returns the width of the entire map in pixels.
         *
         * @returns {number}
         */
        getWidth: function() {
            return TILESIZE * Math.pow( 2, this.getZoom() );
        },

        /**
         * Returns the height of the entire map in pixels.
         *
         * @returns {number}
         */
        getHeight: function() {
            return TILESIZE * Math.pow( 2, this.getZoom() );
        },

        /**
         * Returns the width of the viewport in pixels.
         *
         * @returns {number}
         */
		getViewportWidth: function() {
			return this.olMap.viewPortDiv.clientWidth;
		},

        /**
         * Returns the height of the viewport in pixels.
         *
         * @returns {number}
         */
		getViewportHeight: function() {
			return this.olMap.viewPortDiv.clientHeight;
        },

        /**
         * Returns the maps current zoom level. Level 0 is the highest point of aggregation.
         *
         * @returns {int} The zoom level.
         */
		getZoom: function () {
			return this.olMap.getZoom();
		},

        /**
         * Set a map event callback.
         *
         * @param eventType {string}   The event type.
         * @param callback  {Function} The callback.
         */
		on: function( eventType, callback ) {
            this.olMap.events.register( eventType, this.olMap, callback );
		},

        /**
         * Remove a map event callback.
         *
         * @param eventType {string}   The event type.
         * @param callback  {Function} The callback.
         */
		off: function( eventType, callback ) {
			this.olMap.events.unregister( eventType, this.olMap, callback );
		},

        /**
         * Trigger a map event.
         *
         * @param eventType {string} The event type.
         * @param event     {Object} The event object to be passed to the event.
         */
		trigger: function( eventType, event ) {
            this.olMap.events.triggerEvent( eventType, event );
		}
	};

	module.exports = Map;
}());

},{"../binning/AreaOfInterestTilePyramid":4,"../binning/TileIterator":5,"../binning/WebMercatorTilePyramid":6,"../layer/BaseLayer":8,"../layer/Layer":12,"../openlayers/OpenLayers.min":29,"../util/PubSub":35,"./Axis":25,"./MapUtil":28,"jquery":2,"lodash":3}],28:[function(require,module,exports){
/*
 * Copyright (c) 2014 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

( function() {

	"use strict";

	var Util = require('../util/Util'),
        getMapMinAndMaxInViewportPixels,
        TILESIZE = 256;

    /**
     * Private: Returns the maps min and max pixels in viewport pixels.
     *
     * @param map {Map} The map object.
     * NOTE:    viewport [0,0] is TOP-LEFT
     *          map [0,0] is BOTTOM-LEFT
     */
    getMapMinAndMaxInViewportPixels = function( map ) {
        var olMap = map.olMap;
        return {
            min : {
                x: Math.round( olMap.minPx.x ),
                y: Math.round( olMap.maxPx.y )
            },
            max : {
                x: Math.round( olMap.maxPx.x ),
                y: Math.round( olMap.minPx.y )
            }
        };
    };

    module.exports = {

        /**
		 * Transforms a point from data coordinates to viewport pixel coordinates
         *
         * @param map {Map}    The map object.
         * @param x   {number} The x coordinate of the data.
         * @param y   {number} The y coordinate of the data.
		 * NOTE:    viewport [0,0] is TOP-LEFT
		 *          data [0,0] is BOTTOM-LEFT
		 */
		getViewportPixelFromCoord: function( map, x, y ) {
			var mapPixel = this.getMapPixelFromCoord( map, x, y );
			return this.getViewportPixelFromMapPixel( map, mapPixel.x, mapPixel.y );
		},

		/**
		 * Transforms a point from map pixel coordinates to viewport pixel coordinates
         *
         * @param map {Map}    The map object.
         * @param mx  {number} The x pixel coordinate of the map.
         * @param my  {number} The y pixel coordinate of the map.
		 * NOTE:    viewport [0,0] is TOP-LEFT
		 *          map [0,0] is BOTTOM-LEFT
		 */
		getViewportPixelFromMapPixel: function( map, mx, my ) {
			var viewportMinMax = getMapMinAndMaxInViewportPixels( map );
			return {
				x: mx + viewportMinMax.min.x,
				y: map.getWidth() - my + viewportMinMax.max.y
			};
		},

		/**
		 * Transforms a point from data coordinates to map pixel coordinates
         *
         * @param map {Map} The map object.
         * @param x   {int} The x coordinate of the data.
         * @param y   {int} The y coordinate of the data.
		 * NOTE:    data and map [0,0] are both BOTTOM-LEFT
		 */
		getMapPixelFromCoord: function( map, x, y ) {
			var tile = map.pyramid.rootToTile( x, y, map.getZoom(), TILESIZE ),
			    bin = map.pyramid.rootToBin( x, y, tile);
			return {
				x: tile.xIndex * TILESIZE + bin.x,
				y: tile.yIndex * TILESIZE + TILESIZE - 1 - bin.y
			};
		},

		/**
		 * Transforms a point from viewport pixel coordinates to map pixel coordinates
         *
         * @param map {Map} The map object.
         * @param vx  {int} The x pixel coordinate of the viewport.
         * @param vy  {int} The y pixel coordinate of the viewport.
		 * NOTE:    viewport [0,0] is TOP-LEFT
		 *          map [0,0] is BOTTOM-LEFT
		 */
		getMapPixelFromViewportPixel: function( map, vx, vy ) {
            var viewportMinMax = getMapMinAndMaxInViewportPixels( map ),
			    totalPixelSpan = map.getWidth();
            return {
				x: totalPixelSpan + vx - viewportMinMax.max.x,
				y: totalPixelSpan - vy + viewportMinMax.max.y
			};
		},

		/**
		 * Transforms a point from map pixel coordinates to data coordinates
         *
         * @param map {Map}    The map object.
         * @param mx  {number} The x pixel coordinate of the map.
         * @param my  {number} The y pixel coordinate of the map.
		 * NOTE:    data and map [0,0] are both BOTTOM-LEFT
		 */
		getCoordFromMapPixel: function( map, mx, my ) {
            var tileAndBin = this.getTileAndBinFromMapPixel( map, mx, my, TILESIZE, TILESIZE ),
			    bounds = map.pyramid.getBinBounds( tileAndBin.tile, tileAndBin.bin );
			return {
				x: bounds.minX,
				y: bounds.minY
			};
		},

		/**
		 * Transforms a point from viewport pixel coordinates to data coordinates
         *
         * @param map {Map} The map object.
         * @param vx  {int} The x pixel coordinate of the viewport.
         * @param vy  {int} The y pixel coordinate of the viewport.
		 * NOTE:    viewport [0,0] is TOP-LEFT
		 *          data [0,0] is BOTTOM-LEFT
		 */
		getCoordFromViewportPixel: function( map, vx, vy ) {
			var mapPixel = this.getMapPixelFromViewportPixel( map, vx, vy );
			return this.getCoordFromMapPixel( map, mapPixel.x, mapPixel.y );
		},

		/**
		 * Returns the tile and bin index corresponding to the given viewport pixel coordinate
         *
         * @param map {Map} The map object.
         * @param vx  {int} The x pixel coordinate of the viewport.
         * @param vy  {int} The y pixel coordinate of the viewport.
         * @param xBinCount {int} The number of bins in the x dimension of the tile.
         * @param yBinCount {int} The number of bins in the y dimension of the tile.
		 */
		getTileAndBinFromViewportPixel: function( map, vx, vy, xBinCount, yBinCount ) {
			var mapPixel = this.getMapPixelFromViewportPixel( map, vx, vy );
			return this.getTileAndBinFromMapPixel( map, mapPixel.x, mapPixel.y, xBinCount, yBinCount );
		},

		/**
         * Returns the tile and bin index corresponding to the given map pixel coordinate
         *
         * @param map {Map}    The map object.
         * @param mx  {number} The x pixel coordinate of the map.
         * @param my  {number} The y pixel coordinate of the map.
         * @param xBinCount {int} The number of bins in the x dimension of the tile.
         * @param yBinCount {int} The number of bins in the y dimension of the tile.
         */
        getTileAndBinFromMapPixel: function( map, mx, my, xBinCount, yBinCount ) {
            var tileIndexX = Math.floor( mx / TILESIZE ),
                tileIndexY = Math.floor( my / TILESIZE ),
                tilePixelX = Util.mod( mx , TILESIZE ),
                tilePixelY = Util.mod( my, TILESIZE );
            return {
                tile: {
                    level : map.getZoom(),
                    xIndex : tileIndexX,
                    yIndex : tileIndexY,
                    xBinCount : xBinCount,
                    yBinCount : yBinCount
                },
                bin: {
                    x : Math.floor( tilePixelX / (TILESIZE / xBinCount ) ),
                    y : (yBinCount - 1) - Math.floor( tilePixelY / (TILESIZE / yBinCount) ) // bin [0,0] is top left
                }
            };
        },

        /**
		 * Returns the tile and bin index corresponding to the given data coordinate
         *
         * @param map {Map} The map object.
         * @param x   {int} The x coordinate of the data.
         * @param y   {int} The y coordinate of the data.
         * @param xBinCount {int} The number of bins in the x dimension of the tile.
         * @param yBinCount {int} The number of bins in the y dimension of the tile.
		 */
		getTileAndBinFromCoord: function( map, x, y, xBinCount, yBinCount ) {
			var mapPixel = this.getMapPixelFromCoord( map, x, y );
			return this.getTileAndBinFromMapPixel( map, mapPixel.x, mapPixel.y, xBinCount, yBinCount );
		},

        /**
         * Returns the top left pixel location in viewport coordinates from a tilekey..
         *
         * @param map     {Map}    The map object.
         * @param tilekey {string} The tilekey.
         */
        getTopLeftViewportPixelForTile: function( map, tilekey ) {
            var mapPixel = this.getTopLeftMapPixelForTile( map, tilekey );
            return this.getViewportPixelFromMapPixel( map, mapPixel.x, mapPixel.y );
        },

        /**
         * Returns the top left pixel location in viewport coord from a tile index.
         *
         * @param map     {Map}    The map object.
         * @param tilekey {string} The tilekey.
         */
        getTopLeftMapPixelForTile: function( map, tilekey ) {
            var parsedValues = tilekey.split( ',' ),
                x = parseInt( parsedValues[1], 10 ),
                y = parseInt( parsedValues[2], 10 ),
                mx = x * TILESIZE,
                my = y * TILESIZE + TILESIZE;
            return {
                x : mx,
                y : my
            };
        },

        /**
         * Returns the data coordinate value corresponding to the top left pixel of the tile
         *
         * @param map     {Map}    The map object.
         * @param tilekey {string} The tilekey.
         */
        getTopLeftCoordForTile: function( map, tilekey ) {
            var mapPixel = this.getTopLeftMapPixelForTile( map, tilekey );
            return this.getCoordFromMapPixel( map, mapPixel.x, mapPixel.y );
        }

	};
}());

},{"../util/Util":36}],29:[function(require,module,exports){
/*

  OpenLayers.js -- OpenLayers Map Viewer Library

  Copyright (c) 2006-2012 by OpenLayers Contributors
  Published under the 2-clause BSD license.
  See http://openlayers.org/dev/license.txt for the full text of the license, and http://openlayers.org/dev/authors.txt for full list of contributors.

  Includes compressed code under the following licenses:

  (For uncompressed versions of the code used, please see the
  OpenLayers Github repository: <https://github.com/openlayers/openlayers>)

*/

/**
 * Contains XMLHttpRequest.js <http://code.google.com/p/xmlhttprequest/>
 * Copyright 2007 Sergey Ilinsky (http://www.ilinsky.com)
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 */

/**
 * OpenLayers.Util.pagePosition is based on Yahoo's getXY method, which is
 * Copyright (c) 2006, Yahoo! Inc.
 * All rights reserved.
 * 
 * Redistribution and use of this software in source and binary forms, with or
 * without modification, are permitted provided that the following conditions
 * are met:
 * 
 * * Redistributions of source code must retain the above copyright notice,
 *   this list of conditions and the following disclaimer.
 * 
 * * Redistributions in binary form must reproduce the above copyright notice,
 *   this list of conditions and the following disclaimer in the documentation
 *   and/or other materials provided with the distribution.
 * 
 * * Neither the name of Yahoo! Inc. nor the names of its contributors may be
 *   used to endorse or promote products derived from this software without
 *   specific prior written permission of Yahoo! Inc.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE 
 * POSSIBILITY OF SUCH DAMAGE.
 */
(function(){var OpenLayers={VERSION_NUMBER:"Release 2.12",singleFile:!0,_getScriptLocation:function(){for(var a=/(^|(.*?\/))(OpenLayers[^\/]*?\.js)(\?|$)/,b=document.getElementsByTagName("script"),c,d="",e=0,f=b.length;e<f;e++)if(c=b[e].getAttribute("src"))if(c=c.match(a)){d=c[1];break}return function(){return d}}(),ImgPath:""};OpenLayers.Class=function(){var a=arguments.length,b=arguments[0],c=arguments[a-1],d="function"==typeof c.initialize?c.initialize:function(){b.prototype.initialize.apply(this,arguments)};1<a?(a=[d,b].concat(Array.prototype.slice.call(arguments).slice(1,a-1),c),OpenLayers.inherit.apply(null,a)):d.prototype=c;return d};
OpenLayers.inherit=function(a,b){var c=function(){};c.prototype=b.prototype;a.prototype=new c;var d,e,c=2;for(d=arguments.length;c<d;c++)e=arguments[c],"function"===typeof e&&(e=e.prototype),OpenLayers.Util.extend(a.prototype,e)};OpenLayers.Util=OpenLayers.Util||{};OpenLayers.Util.extend=function(a,b){a=a||{};if(b){for(var c in b){var d=b[c];void 0!==d&&(a[c]=d)}!("function"==typeof window.Event&&b instanceof window.Event)&&(b.hasOwnProperty&&b.hasOwnProperty("toString"))&&(a.toString=b.toString)}return a};OpenLayers.String={startsWith:function(a,b){return 0==a.indexOf(b)},contains:function(a,b){return-1!=a.indexOf(b)},trim:function(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},camelize:function(a){for(var a=a.split("-"),b=a[0],c=1,d=a.length;c<d;c++)var e=a[c],b=b+(e.charAt(0).toUpperCase()+e.substring(1));return b},format:function(a,b,c){b||(b=window);return a.replace(OpenLayers.String.tokenRegEx,function(a,e){for(var f,g=e.split(/\.+/),h=0;h<g.length;h++)0==h&&(f=b),f=f[g[h]];"function"==
typeof f&&(f=c?f.apply(null,c):f());return"undefined"==typeof f?"undefined":f})},tokenRegEx:/\$\{([\w.]+?)\}/g,numberRegEx:/^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/,isNumeric:function(a){return OpenLayers.String.numberRegEx.test(a)},numericIf:function(a){return OpenLayers.String.isNumeric(a)?parseFloat(a):a}};
OpenLayers.Number={decimalSeparator:".",thousandsSeparator:",",limitSigDigs:function(a,b){var c=0;0<b&&(c=parseFloat(a.toPrecision(b)));return c},format:function(a,b,c,d){b="undefined"!=typeof b?b:0;c="undefined"!=typeof c?c:OpenLayers.Number.thousandsSeparator;d="undefined"!=typeof d?d:OpenLayers.Number.decimalSeparator;null!=b&&(a=parseFloat(a.toFixed(b)));var e=a.toString().split(".");1==e.length&&null==b&&(b=0);a=e[0];if(c)for(var f=/(-?[0-9]+)([0-9]{3})/;f.test(a);)a=a.replace(f,"$1"+c+"$2");
0==b?b=a:(c=1<e.length?e[1]:"0",null!=b&&(c+=Array(b-c.length+1).join("0")),b=a+d+c);return b}};OpenLayers.Function={bind:function(a,b){var c=Array.prototype.slice.apply(arguments,[2]);return function(){var d=c.concat(Array.prototype.slice.apply(arguments,[0]));return a.apply(b,d)}},bindAsEventListener:function(a,b){return function(c){return a.call(b,c||window.event)}},False:function(){return!1},True:function(){return!0},Void:function(){}};
OpenLayers.Array={filter:function(a,b,c){var d=[];if(Array.prototype.filter)d=a.filter(b,c);else{var e=a.length;if("function"!=typeof b)throw new TypeError;for(var f=0;f<e;f++)if(f in a){var g=a[f];b.call(c,g,f,a)&&d.push(g)}}return d}};OpenLayers.Bounds=OpenLayers.Class({left:null,bottom:null,right:null,top:null,centerLonLat:null,initialize:function(a,b,c,d){OpenLayers.Util.isArray(a)&&(d=a[3],c=a[2],b=a[1],a=a[0]);null!=a&&(this.left=OpenLayers.Util.toFloat(a));null!=b&&(this.bottom=OpenLayers.Util.toFloat(b));null!=c&&(this.right=OpenLayers.Util.toFloat(c));null!=d&&(this.top=OpenLayers.Util.toFloat(d))},clone:function(){return new OpenLayers.Bounds(this.left,this.bottom,this.right,this.top)},equals:function(a){var b=!1;null!=
a&&(b=this.left==a.left&&this.right==a.right&&this.top==a.top&&this.bottom==a.bottom);return b},toString:function(){return[this.left,this.bottom,this.right,this.top].join()},toArray:function(a){return!0===a?[this.bottom,this.left,this.top,this.right]:[this.left,this.bottom,this.right,this.top]},toBBOX:function(a,b){null==a&&(a=6);var c=Math.pow(10,a),d=Math.round(this.left*c)/c,e=Math.round(this.bottom*c)/c,f=Math.round(this.right*c)/c,c=Math.round(this.top*c)/c;return!0===b?e+","+d+","+c+","+f:d+
","+e+","+f+","+c},toGeometry:function(){return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(this.left,this.bottom),new OpenLayers.Geometry.Point(this.right,this.bottom),new OpenLayers.Geometry.Point(this.right,this.top),new OpenLayers.Geometry.Point(this.left,this.top)])])},getWidth:function(){return this.right-this.left},getHeight:function(){return this.top-this.bottom},getSize:function(){return new OpenLayers.Size(this.getWidth(),this.getHeight())},
getCenterPixel:function(){return new OpenLayers.Pixel((this.left+this.right)/2,(this.bottom+this.top)/2)},getCenterLonLat:function(){this.centerLonLat||(this.centerLonLat=new OpenLayers.LonLat((this.left+this.right)/2,(this.bottom+this.top)/2));return this.centerLonLat},scale:function(a,b){null==b&&(b=this.getCenterLonLat());var c,d;"OpenLayers.LonLat"==b.CLASS_NAME?(c=b.lon,d=b.lat):(c=b.x,d=b.y);return new OpenLayers.Bounds((this.left-c)*a+c,(this.bottom-d)*a+d,(this.right-c)*a+c,(this.top-d)*a+
d)},add:function(a,b){if(null==a||null==b)throw new TypeError("Bounds.add cannot receive null values");return new OpenLayers.Bounds(this.left+a,this.bottom+b,this.right+a,this.top+b)},extend:function(a){var b=null;if(a){switch(a.CLASS_NAME){case "OpenLayers.LonLat":b=new OpenLayers.Bounds(a.lon,a.lat,a.lon,a.lat);break;case "OpenLayers.Geometry.Point":b=new OpenLayers.Bounds(a.x,a.y,a.x,a.y);break;case "OpenLayers.Bounds":b=a}if(b){this.centerLonLat=null;if(null==this.left||b.left<this.left)this.left=
b.left;if(null==this.bottom||b.bottom<this.bottom)this.bottom=b.bottom;if(null==this.right||b.right>this.right)this.right=b.right;if(null==this.top||b.top>this.top)this.top=b.top}}},containsLonLat:function(a,b){"boolean"===typeof b&&(b={inclusive:b});var b=b||{},c=this.contains(a.lon,a.lat,b.inclusive),d=b.worldBounds;d&&!c&&(c=d.getWidth(),d=Math.round((a.lon-(d.left+d.right)/2)/c),c=this.containsLonLat({lon:a.lon-d*c,lat:a.lat},{inclusive:b.inclusive}));return c},containsPixel:function(a,b){return this.contains(a.x,
a.y,b)},contains:function(a,b,c){null==c&&(c=!0);if(null==a||null==b)return!1;var a=OpenLayers.Util.toFloat(a),b=OpenLayers.Util.toFloat(b),d=!1;return d=c?a>=this.left&&a<=this.right&&b>=this.bottom&&b<=this.top:a>this.left&&a<this.right&&b>this.bottom&&b<this.top},intersectsBounds:function(a,b){"boolean"===typeof b&&(b={inclusive:b});b=b||{};if(b.worldBounds)var c=this.wrapDateLine(b.worldBounds),a=a.wrapDateLine(b.worldBounds);else c=this;null==b.inclusive&&(b.inclusive=!0);var d=!1,e=c.left==
a.right||c.right==a.left||c.top==a.bottom||c.bottom==a.top;if(b.inclusive||!e)var d=a.top>=c.bottom&&a.top<=c.top||c.top>a.bottom&&c.top<a.top,e=a.left>=c.left&&a.left<=c.right||c.left>=a.left&&c.left<=a.right,f=a.right>=c.left&&a.right<=c.right||c.right>=a.left&&c.right<=a.right,d=(a.bottom>=c.bottom&&a.bottom<=c.top||c.bottom>=a.bottom&&c.bottom<=a.top||d)&&(e||f);if(b.worldBounds&&!d){var g=b.worldBounds,e=g.getWidth(),f=!g.containsBounds(c),g=!g.containsBounds(a);f&&!g?(a=a.add(-e,0),d=c.intersectsBounds(a,
{inclusive:b.inclusive})):g&&!f&&(c=c.add(-e,0),d=a.intersectsBounds(c,{inclusive:b.inclusive}))}return d},containsBounds:function(a,b,c){null==b&&(b=!1);null==c&&(c=!0);var d=this.contains(a.left,a.bottom,c),e=this.contains(a.right,a.bottom,c),f=this.contains(a.left,a.top,c),a=this.contains(a.right,a.top,c);return b?d||e||f||a:d&&e&&f&&a},determineQuadrant:function(a){var b="",c=this.getCenterLonLat(),b=b+(a.lat<c.lat?"b":"t");return b+=a.lon<c.lon?"l":"r"},transform:function(a,b){this.centerLonLat=
null;var c=OpenLayers.Projection.transform({x:this.left,y:this.bottom},a,b),d=OpenLayers.Projection.transform({x:this.right,y:this.bottom},a,b),e=OpenLayers.Projection.transform({x:this.left,y:this.top},a,b),f=OpenLayers.Projection.transform({x:this.right,y:this.top},a,b);this.left=Math.min(c.x,e.x);this.bottom=Math.min(c.y,d.y);this.right=Math.max(d.x,f.x);this.top=Math.max(e.y,f.y);return this},wrapDateLine:function(a,b){var b=b||{},c=b.leftTolerance||0,d=b.rightTolerance||0,e=this.clone();if(a){for(var f=
a.getWidth();e.left<a.left&&e.right-d<=a.left;)e=e.add(f,0);for(;e.left+c>=a.right&&e.right>a.right;)e=e.add(-f,0);c=e.left+c;c<a.right&&(c>a.left&&e.right-d>a.right)&&(e=e.add(-f,0))}return e},CLASS_NAME:"OpenLayers.Bounds"});OpenLayers.Bounds.fromString=function(a,b){var c=a.split(",");return OpenLayers.Bounds.fromArray(c,b)};OpenLayers.Bounds.fromArray=function(a,b){return!0===b?new OpenLayers.Bounds(a[1],a[0],a[3],a[2]):new OpenLayers.Bounds(a[0],a[1],a[2],a[3])};
OpenLayers.Bounds.fromSize=function(a){return new OpenLayers.Bounds(0,a.h,a.w,0)};OpenLayers.Bounds.oppositeQuadrant=function(a){var b;b=""+("t"==a.charAt(0)?"b":"t");return b+="l"==a.charAt(1)?"r":"l"};OpenLayers.Element={visible:function(a){return"none"!=OpenLayers.Util.getElement(a).style.display},toggle:function(){for(var a=0,b=arguments.length;a<b;a++){var c=OpenLayers.Util.getElement(arguments[a]),d=OpenLayers.Element.visible(c)?"none":"";c.style.display=d}},remove:function(a){a=OpenLayers.Util.getElement(a);a.parentNode.removeChild(a)},getHeight:function(a){a=OpenLayers.Util.getElement(a);return a.offsetHeight},hasClass:function(a,b){var c=a.className;return!!c&&RegExp("(^|\\s)"+b+"(\\s|$)").test(c)},
addClass:function(a,b){OpenLayers.Element.hasClass(a,b)||(a.className+=(a.className?" ":"")+b);return a},removeClass:function(a,b){var c=a.className;c&&(a.className=OpenLayers.String.trim(c.replace(RegExp("(^|\\s+)"+b+"(\\s+|$)")," ")));return a},toggleClass:function(a,b){OpenLayers.Element.hasClass(a,b)?OpenLayers.Element.removeClass(a,b):OpenLayers.Element.addClass(a,b);return a},getStyle:function(a,b){var a=OpenLayers.Util.getElement(a),c=null;if(a&&a.style){c=a.style[OpenLayers.String.camelize(b)];
c||(document.defaultView&&document.defaultView.getComputedStyle?c=(c=document.defaultView.getComputedStyle(a,null))?c.getPropertyValue(b):null:a.currentStyle&&(c=a.currentStyle[OpenLayers.String.camelize(b)]));var d=["left","top","right","bottom"];window.opera&&(-1!=OpenLayers.Util.indexOf(d,b)&&"static"==OpenLayers.Element.getStyle(a,"position"))&&(c="auto")}return"auto"==c?null:c}};OpenLayers.LonLat=OpenLayers.Class({lon:0,lat:0,initialize:function(a,b){OpenLayers.Util.isArray(a)&&(b=a[1],a=a[0]);this.lon=OpenLayers.Util.toFloat(a);this.lat=OpenLayers.Util.toFloat(b)},toString:function(){return"lon="+this.lon+",lat="+this.lat},toShortString:function(){return this.lon+", "+this.lat},clone:function(){return new OpenLayers.LonLat(this.lon,this.lat)},add:function(a,b){if(null==a||null==b)throw new TypeError("LonLat.add cannot receive null values");return new OpenLayers.LonLat(this.lon+
OpenLayers.Util.toFloat(a),this.lat+OpenLayers.Util.toFloat(b))},equals:function(a){var b=!1;null!=a&&(b=this.lon==a.lon&&this.lat==a.lat||isNaN(this.lon)&&isNaN(this.lat)&&isNaN(a.lon)&&isNaN(a.lat));return b},transform:function(a,b){var c=OpenLayers.Projection.transform({x:this.lon,y:this.lat},a,b);this.lon=c.x;this.lat=c.y;return this},wrapDateLine:function(a){var b=this.clone();if(a){for(;b.lon<a.left;)b.lon+=a.getWidth();for(;b.lon>a.right;)b.lon-=a.getWidth()}return b},CLASS_NAME:"OpenLayers.LonLat"});
OpenLayers.LonLat.fromString=function(a){a=a.split(",");return new OpenLayers.LonLat(a[0],a[1])};OpenLayers.LonLat.fromArray=function(a){var b=OpenLayers.Util.isArray(a);return new OpenLayers.LonLat(b&&a[0],b&&a[1])};OpenLayers.Pixel=OpenLayers.Class({x:0,y:0,initialize:function(a,b){this.x=parseFloat(a);this.y=parseFloat(b)},toString:function(){return"x="+this.x+",y="+this.y},clone:function(){return new OpenLayers.Pixel(this.x,this.y)},equals:function(a){var b=!1;null!=a&&(b=this.x==a.x&&this.y==a.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(a.x)&&isNaN(a.y));return b},distanceTo:function(a){return Math.sqrt(Math.pow(this.x-a.x,2)+Math.pow(this.y-a.y,2))},add:function(a,b){if(null==a||null==b)throw new TypeError("Pixel.add cannot receive null values");
return new OpenLayers.Pixel(this.x+a,this.y+b)},offset:function(a){var b=this.clone();a&&(b=this.add(a.x,a.y));return b},CLASS_NAME:"OpenLayers.Pixel"});OpenLayers.Size=OpenLayers.Class({w:0,h:0,initialize:function(a,b){this.w=parseFloat(a);this.h=parseFloat(b)},toString:function(){return"w="+this.w+",h="+this.h},clone:function(){return new OpenLayers.Size(this.w,this.h)},equals:function(a){var b=!1;null!=a&&(b=this.w==a.w&&this.h==a.h||isNaN(this.w)&&isNaN(this.h)&&isNaN(a.w)&&isNaN(a.h));return b},CLASS_NAME:"OpenLayers.Size"});OpenLayers.Console={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){},userError:function(a){alert(a)},assert:function(){},dir:function(){},dirxml:function(){},trace:function(){},group:function(){},groupEnd:function(){},time:function(){},timeEnd:function(){},profile:function(){},profileEnd:function(){},count:function(){},CLASS_NAME:"OpenLayers.Console"};
(function(){for(var a=document.getElementsByTagName("script"),b=0,c=a.length;b<c;++b)if(-1!=a[b].src.indexOf("firebug.js")&&console){OpenLayers.Util.extend(OpenLayers.Console,console);break}})();OpenLayers.Lang={code:null,defaultCode:"en",getCode:function(){OpenLayers.Lang.code||OpenLayers.Lang.setCode();return OpenLayers.Lang.code},setCode:function(a){var b;a||(a="msie"==OpenLayers.BROWSER_NAME?navigator.userLanguage:navigator.language);a=a.split("-");a[0]=a[0].toLowerCase();"object"==typeof OpenLayers.Lang[a[0]]&&(b=a[0]);if(a[1]){var c=a[0]+"-"+a[1].toUpperCase();"object"==typeof OpenLayers.Lang[c]&&(b=c)}b||(OpenLayers.Console.warn("Failed to find OpenLayers.Lang."+a.join("-")+" dictionary, falling back to default language"),
b=OpenLayers.Lang.defaultCode);OpenLayers.Lang.code=b},translate:function(a,b){var c=OpenLayers.Lang[OpenLayers.Lang.getCode()];(c=c&&c[a])||(c=a);b&&(c=OpenLayers.String.format(c,b));return c}};OpenLayers.i18n=OpenLayers.Lang.translate;OpenLayers.Util=OpenLayers.Util||{};OpenLayers.Util.getElement=function(){for(var a=[],b=0,c=arguments.length;b<c;b++){var d=arguments[b];"string"==typeof d&&(d=document.getElementById(d));if(1==arguments.length)return d;a.push(d)}return a};OpenLayers.Util.isElement=function(a){return!!(a&&1===a.nodeType)};OpenLayers.Util.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)};"undefined"===typeof window.$&&(window.$=OpenLayers.Util.getElement);
OpenLayers.Util.removeItem=function(a,b){for(var c=a.length-1;c>=0;c--)a[c]==b&&a.splice(c,1);return a};OpenLayers.Util.indexOf=function(a,b){if(typeof a.indexOf=="function")return a.indexOf(b);for(var c=0,d=a.length;c<d;c++)if(a[c]==b)return c;return-1};
OpenLayers.Util.modifyDOMElement=function(a,b,c,d,e,f,g,h){if(b)a.id=b;if(c){a.style.left=c.x+"px";a.style.top=c.y+"px"}if(d){a.style.width=d.w+"px";a.style.height=d.h+"px"}if(e)a.style.position=e;if(f)a.style.border=f;if(g)a.style.overflow=g;if(parseFloat(h)>=0&&parseFloat(h)<1){a.style.filter="alpha(opacity="+h*100+")";a.style.opacity=h}else if(parseFloat(h)==1){a.style.filter="";a.style.opacity=""}};
OpenLayers.Util.createDiv=function(a,b,c,d,e,f,g,h){var i=document.createElement("div");if(d)i.style.backgroundImage="url("+d+")";a||(a=OpenLayers.Util.createUniqueID("OpenLayersDiv"));e||(e="absolute");OpenLayers.Util.modifyDOMElement(i,a,b,c,e,f,g,h);return i};
OpenLayers.Util.createImage=function(a,b,c,d,e,f,g,h){var i=document.createElement("img");a||(a=OpenLayers.Util.createUniqueID("OpenLayersDiv"));e||(e="relative");OpenLayers.Util.modifyDOMElement(i,a,b,c,e,f,null,g);if(h){i.style.display="none";b=function(){i.style.display="";OpenLayers.Event.stopObservingElement(i)};OpenLayers.Event.observe(i,"load",b);OpenLayers.Event.observe(i,"error",b)}i.style.alt=a;i.galleryImg="no";if(d)i.src=d;return i};OpenLayers.IMAGE_RELOAD_ATTEMPTS=0;
OpenLayers.Util.alphaHackNeeded=null;OpenLayers.Util.alphaHack=function(){if(OpenLayers.Util.alphaHackNeeded==null){var a=navigator.appVersion.split("MSIE"),a=parseFloat(a[1]),b=false;try{b=!!document.body.filters}catch(c){}OpenLayers.Util.alphaHackNeeded=b&&a>=5.5&&a<7}return OpenLayers.Util.alphaHackNeeded};
OpenLayers.Util.modifyAlphaImageDiv=function(a,b,c,d,e,f,g,h,i){OpenLayers.Util.modifyDOMElement(a,b,c,d,f,null,null,i);b=a.childNodes[0];if(e)b.src=e;OpenLayers.Util.modifyDOMElement(b,a.id+"_innerImage",null,d,"relative",g);if(OpenLayers.Util.alphaHack()){if(a.style.display!="none")a.style.display="inline-block";h==null&&(h="scale");a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+b.src+"', sizingMethod='"+h+"')";if(parseFloat(a.style.opacity)>=0&&parseFloat(a.style.opacity)<
1)a.style.filter=a.style.filter+(" alpha(opacity="+a.style.opacity*100+")");b.style.filter="alpha(opacity=0)"}};OpenLayers.Util.createAlphaImageDiv=function(a,b,c,d,e,f,g,h,i){var j=OpenLayers.Util.createDiv(),i=OpenLayers.Util.createImage(null,null,null,null,null,null,null,i);i.className="olAlphaImg";j.appendChild(i);OpenLayers.Util.modifyAlphaImageDiv(j,a,b,c,d,e,f,g,h);return j};OpenLayers.Util.upperCaseObject=function(a){var b={},c;for(c in a)b[c.toUpperCase()]=a[c];return b};
OpenLayers.Util.applyDefaults=function(a,b){var a=a||{},c=typeof window.Event=="function"&&b instanceof window.Event,d;for(d in b)if(a[d]===void 0||!c&&b.hasOwnProperty&&b.hasOwnProperty(d)&&!a.hasOwnProperty(d))a[d]=b[d];if(!c&&b&&b.hasOwnProperty&&b.hasOwnProperty("toString")&&!a.hasOwnProperty("toString"))a.toString=b.toString;return a};
OpenLayers.Util.getParameterString=function(a){var b=[],c;for(c in a){var d=a[c];if(d!=null&&typeof d!="function"){if(typeof d=="object"&&d.constructor==Array){for(var e=[],f,g=0,h=d.length;g<h;g++){f=d[g];e.push(encodeURIComponent(f===null||f===void 0?"":f))}d=e.join(",")}else d=encodeURIComponent(d);b.push(encodeURIComponent(c)+"="+d)}}return b.join("&")};OpenLayers.Util.urlAppend=function(a,b){var c=a;if(b)var d=(a+" ").split(/[?&]/),c=c+(d.pop()===" "?b:d.length?"&"+b:"?"+b);return c};
OpenLayers.Util.getImagesLocation=function(){return OpenLayers.ImgPath||OpenLayers._getScriptLocation()+"img/"};OpenLayers.Util.getImageLocation=function(a){return OpenLayers.Util.getImagesLocation()+a};OpenLayers.Util.Try=function(){for(var a=null,b=0,c=arguments.length;b<c;b++){var d=arguments[b];try{a=d();break}catch(e){}}return a};
OpenLayers.Util.getXmlNodeValue=function(a){var b=null;OpenLayers.Util.Try(function(){b=a.text;if(!b)b=a.textContent;if(!b)b=a.firstChild.nodeValue},function(){b=a.textContent});return b};OpenLayers.Util.mouseLeft=function(a,b){for(var c=a.relatedTarget?a.relatedTarget:a.toElement;c!=b&&c!=null;)c=c.parentNode;return c!=b};OpenLayers.Util.DEFAULT_PRECISION=14;
OpenLayers.Util.toFloat=function(a,b){if(b==null)b=OpenLayers.Util.DEFAULT_PRECISION;typeof a!=="number"&&(a=parseFloat(a));return b===0?a:parseFloat(a.toPrecision(b))};OpenLayers.Util.rad=function(a){return a*Math.PI/180};OpenLayers.Util.deg=function(a){return a*180/Math.PI};OpenLayers.Util.VincentyConstants={a:6378137,b:6356752.3142,f:1/298.257223563};
OpenLayers.Util.distVincenty=function(a,b){for(var c=OpenLayers.Util.VincentyConstants,d=c.a,e=c.b,c=c.f,f=OpenLayers.Util.rad(b.lon-a.lon),g=Math.atan((1-c)*Math.tan(OpenLayers.Util.rad(a.lat))),h=Math.atan((1-c)*Math.tan(OpenLayers.Util.rad(b.lat))),i=Math.sin(g),g=Math.cos(g),j=Math.sin(h),h=Math.cos(h),k=f,l=2*Math.PI,m=20;Math.abs(k-l)>1.0E-12&&--m>0;){var n=Math.sin(k),o=Math.cos(k),p=Math.sqrt(h*n*h*n+(g*j-i*h*o)*(g*j-i*h*o));if(p==0)return 0;var o=i*j+g*h*o,q=Math.atan2(p,o),r=Math.asin(g*
h*n/p),s=Math.cos(r)*Math.cos(r),n=o-2*i*j/s,t=c/16*s*(4+c*(4-3*s)),l=k,k=f+(1-t)*c*Math.sin(r)*(q+t*p*(n+t*o*(-1+2*n*n)))}if(m==0)return NaN;d=s*(d*d-e*e)/(e*e);c=d/1024*(256+d*(-128+d*(74-47*d)));return(e*(1+d/16384*(4096+d*(-768+d*(320-175*d))))*(q-c*p*(n+c/4*(o*(-1+2*n*n)-c/6*n*(-3+4*p*p)*(-3+4*n*n))))).toFixed(3)/1E3};
OpenLayers.Util.destinationVincenty=function(a,b,c){for(var d=OpenLayers.Util,e=d.VincentyConstants,f=e.a,g=e.b,h=e.f,e=a.lon,a=a.lat,i=d.rad(b),b=Math.sin(i),i=Math.cos(i),a=(1-h)*Math.tan(d.rad(a)),j=1/Math.sqrt(1+a*a),k=a*j,l=Math.atan2(a,i),a=j*b,m=1-a*a,f=m*(f*f-g*g)/(g*g),n=1+f/16384*(4096+f*(-768+f*(320-175*f))),o=f/1024*(256+f*(-128+f*(74-47*f))),f=c/(g*n),p=2*Math.PI;Math.abs(f-p)>1.0E-12;)var q=Math.cos(2*l+f),r=Math.sin(f),s=Math.cos(f),t=o*r*(q+o/4*(s*(-1+2*q*q)-o/6*q*(-3+4*r*r)*(-3+4*
q*q))),p=f,f=c/(g*n)+t;c=k*r-j*s*i;g=Math.atan2(k*s+j*r*i,(1-h)*Math.sqrt(a*a+c*c));b=Math.atan2(r*b,j*s-k*r*i);i=h/16*m*(4+h*(4-3*m));q=b-(1-i)*h*a*(f+i*r*(q+i*s*(-1+2*q*q)));Math.atan2(a,-c);return new OpenLayers.LonLat(e+d.deg(q),d.deg(g))};
OpenLayers.Util.getParameters=function(a){var a=a===null||a===void 0?window.location.href:a,b="";if(OpenLayers.String.contains(a,"?"))var b=a.indexOf("?")+1,c=OpenLayers.String.contains(a,"#")?a.indexOf("#"):a.length,b=a.substring(b,c);for(var a={},b=b.split(/[&;]/),c=0,d=b.length;c<d;++c){var e=b[c].split("=");if(e[0]){var f=e[0];try{f=decodeURIComponent(f)}catch(g){f=unescape(f)}e=(e[1]||"").replace(/\+/g," ");try{e=decodeURIComponent(e)}catch(h){e=unescape(e)}e=e.split(",");e.length==1&&(e=e[0]);
a[f]=e}}return a};OpenLayers.Util.lastSeqID=0;OpenLayers.Util.createUniqueID=function(a){a==null&&(a="id_");OpenLayers.Util.lastSeqID=OpenLayers.Util.lastSeqID+1;return a+OpenLayers.Util.lastSeqID};OpenLayers.INCHES_PER_UNIT={inches:1,ft:12,mi:63360,m:39.3701,km:39370.1,dd:4374754,yd:36};OpenLayers.INCHES_PER_UNIT["in"]=OpenLayers.INCHES_PER_UNIT.inches;OpenLayers.INCHES_PER_UNIT.degrees=OpenLayers.INCHES_PER_UNIT.dd;OpenLayers.INCHES_PER_UNIT.nmi=1852*OpenLayers.INCHES_PER_UNIT.m;
OpenLayers.METERS_PER_INCH=0.0254000508001016;
OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{Inch:OpenLayers.INCHES_PER_UNIT.inches,Meter:1/OpenLayers.METERS_PER_INCH,Foot:0.3048006096012192/OpenLayers.METERS_PER_INCH,IFoot:0.3048/OpenLayers.METERS_PER_INCH,ClarkeFoot:0.3047972651151/OpenLayers.METERS_PER_INCH,SearsFoot:0.30479947153867626/OpenLayers.METERS_PER_INCH,GoldCoastFoot:0.3047997101815088/OpenLayers.METERS_PER_INCH,IInch:0.0254/OpenLayers.METERS_PER_INCH,MicroInch:2.54E-5/OpenLayers.METERS_PER_INCH,Mil:2.54E-8/OpenLayers.METERS_PER_INCH,
Centimeter:0.01/OpenLayers.METERS_PER_INCH,Kilometer:1E3/OpenLayers.METERS_PER_INCH,Yard:0.9144018288036576/OpenLayers.METERS_PER_INCH,SearsYard:0.914398414616029/OpenLayers.METERS_PER_INCH,IndianYard:0.9143985307444408/OpenLayers.METERS_PER_INCH,IndianYd37:0.91439523/OpenLayers.METERS_PER_INCH,IndianYd62:0.9143988/OpenLayers.METERS_PER_INCH,IndianYd75:0.9143985/OpenLayers.METERS_PER_INCH,IndianFoot:0.30479951/OpenLayers.METERS_PER_INCH,IndianFt37:0.30479841/OpenLayers.METERS_PER_INCH,IndianFt62:0.3047996/
OpenLayers.METERS_PER_INCH,IndianFt75:0.3047995/OpenLayers.METERS_PER_INCH,Mile:1609.3472186944373/OpenLayers.METERS_PER_INCH,IYard:0.9144/OpenLayers.METERS_PER_INCH,IMile:1609.344/OpenLayers.METERS_PER_INCH,NautM:1852/OpenLayers.METERS_PER_INCH,"Lat-66":110943.31648893273/OpenLayers.METERS_PER_INCH,"Lat-83":110946.25736872235/OpenLayers.METERS_PER_INCH,Decimeter:0.1/OpenLayers.METERS_PER_INCH,Millimeter:0.001/OpenLayers.METERS_PER_INCH,Dekameter:10/OpenLayers.METERS_PER_INCH,Decameter:10/OpenLayers.METERS_PER_INCH,
Hectometer:100/OpenLayers.METERS_PER_INCH,GermanMeter:1.0000135965/OpenLayers.METERS_PER_INCH,CaGrid:0.999738/OpenLayers.METERS_PER_INCH,ClarkeChain:20.1166194976/OpenLayers.METERS_PER_INCH,GunterChain:20.11684023368047/OpenLayers.METERS_PER_INCH,BenoitChain:20.116782494375872/OpenLayers.METERS_PER_INCH,SearsChain:20.11676512155/OpenLayers.METERS_PER_INCH,ClarkeLink:0.201166194976/OpenLayers.METERS_PER_INCH,GunterLink:0.2011684023368047/OpenLayers.METERS_PER_INCH,BenoitLink:0.20116782494375873/OpenLayers.METERS_PER_INCH,
SearsLink:0.2011676512155/OpenLayers.METERS_PER_INCH,Rod:5.02921005842012/OpenLayers.METERS_PER_INCH,IntnlChain:20.1168/OpenLayers.METERS_PER_INCH,IntnlLink:0.201168/OpenLayers.METERS_PER_INCH,Perch:5.02921005842012/OpenLayers.METERS_PER_INCH,Pole:5.02921005842012/OpenLayers.METERS_PER_INCH,Furlong:201.1684023368046/OpenLayers.METERS_PER_INCH,Rood:3.778266898/OpenLayers.METERS_PER_INCH,CapeFoot:0.3047972615/OpenLayers.METERS_PER_INCH,Brealey:375/OpenLayers.METERS_PER_INCH,ModAmFt:0.304812252984506/
OpenLayers.METERS_PER_INCH,Fathom:1.8288/OpenLayers.METERS_PER_INCH,"NautM-UK":1853.184/OpenLayers.METERS_PER_INCH,"50kilometers":5E4/OpenLayers.METERS_PER_INCH,"150kilometers":15E4/OpenLayers.METERS_PER_INCH});
OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{mm:OpenLayers.INCHES_PER_UNIT.Meter/1E3,cm:OpenLayers.INCHES_PER_UNIT.Meter/100,dm:100*OpenLayers.INCHES_PER_UNIT.Meter,km:1E3*OpenLayers.INCHES_PER_UNIT.Meter,kmi:OpenLayers.INCHES_PER_UNIT.nmi,fath:OpenLayers.INCHES_PER_UNIT.Fathom,ch:OpenLayers.INCHES_PER_UNIT.IntnlChain,link:OpenLayers.INCHES_PER_UNIT.IntnlLink,"us-in":OpenLayers.INCHES_PER_UNIT.inches,"us-ft":OpenLayers.INCHES_PER_UNIT.Foot,"us-yd":OpenLayers.INCHES_PER_UNIT.Yard,"us-ch":OpenLayers.INCHES_PER_UNIT.GunterChain,
"us-mi":OpenLayers.INCHES_PER_UNIT.Mile,"ind-yd":OpenLayers.INCHES_PER_UNIT.IndianYd37,"ind-ft":OpenLayers.INCHES_PER_UNIT.IndianFt37,"ind-ch":20.11669506/OpenLayers.METERS_PER_INCH});OpenLayers.DOTS_PER_INCH=72;OpenLayers.Util.normalizeScale=function(a){return a>1?1/a:a};OpenLayers.Util.getResolutionFromScale=function(a,b){var c;if(a){b==null&&(b="degrees");c=1/(OpenLayers.Util.normalizeScale(a)*OpenLayers.INCHES_PER_UNIT[b]*OpenLayers.DOTS_PER_INCH)}return c};
OpenLayers.Util.getScaleFromResolution=function(a,b){b==null&&(b="degrees");return a*OpenLayers.INCHES_PER_UNIT[b]*OpenLayers.DOTS_PER_INCH};
OpenLayers.Util.pagePosition=function(a){var b=[0,0],c=OpenLayers.Util.getViewportElement();if(!a||a==window||a==c)return b;var d=OpenLayers.IS_GECKO&&document.getBoxObjectFor&&OpenLayers.Element.getStyle(a,"position")=="absolute"&&(a.style.top==""||a.style.left==""),e=null;if(a.getBoundingClientRect){a=a.getBoundingClientRect();e=c.scrollTop;b[0]=a.left+c.scrollLeft;b[1]=a.top+e}else if(document.getBoxObjectFor&&!d){a=document.getBoxObjectFor(a);c=document.getBoxObjectFor(c);b[0]=a.screenX-c.screenX;
b[1]=a.screenY-c.screenY}else{b[0]=a.offsetLeft;b[1]=a.offsetTop;e=a.offsetParent;if(e!=a)for(;e;){b[0]=b[0]+e.offsetLeft;b[1]=b[1]+e.offsetTop;e=e.offsetParent}c=OpenLayers.BROWSER_NAME;if(c=="opera"||c=="safari"&&OpenLayers.Element.getStyle(a,"position")=="absolute")b[1]=b[1]-document.body.offsetTop;for(e=a.offsetParent;e&&e!=document.body;){b[0]=b[0]-e.scrollLeft;if(c!="opera"||e.tagName!="TR")b[1]=b[1]-e.scrollTop;e=e.offsetParent}}return b};
OpenLayers.Util.getViewportElement=function(){var a=arguments.callee.viewportElement;if(a==void 0){a=OpenLayers.BROWSER_NAME=="msie"&&document.compatMode!="CSS1Compat"?document.body:document.documentElement;arguments.callee.viewportElement=a}return a};
OpenLayers.Util.isEquivalentUrl=function(a,b,c){c=c||{};OpenLayers.Util.applyDefaults(c,{ignoreCase:true,ignorePort80:true,ignoreHash:true});var a=OpenLayers.Util.createUrlObject(a,c),b=OpenLayers.Util.createUrlObject(b,c),d;for(d in a)if(d!=="args"&&a[d]!=b[d])return false;for(d in a.args){if(a.args[d]!=b.args[d])return false;delete b.args[d]}for(d in b.args)return false;return true};
OpenLayers.Util.createUrlObject=function(a,b){b=b||{};if(!/^\w+:\/\//.test(a)){var c=window.location,d=c.port?":"+c.port:"",d=c.protocol+"//"+c.host.split(":").shift()+d;if(a.indexOf("/")===0)a=d+a;else{c=c.pathname.split("/");c.pop();a=d+c.join("/")+"/"+a}}b.ignoreCase&&(a=a.toLowerCase());c=document.createElement("a");c.href=a;d={};d.host=c.host.split(":").shift();d.protocol=c.protocol;d.port=b.ignorePort80?c.port=="80"||c.port=="0"?"":c.port:c.port==""||c.port=="0"?"80":c.port;d.hash=b.ignoreHash||
c.hash==="#"?"":c.hash;var e=c.search;if(!e){e=a.indexOf("?");e=e!=-1?a.substr(e):""}d.args=OpenLayers.Util.getParameters(e);d.pathname=c.pathname.charAt(0)=="/"?c.pathname:"/"+c.pathname;return d};OpenLayers.Util.removeTail=function(a){var b=null,b=a.indexOf("?"),c=a.indexOf("#");return b=b==-1?c!=-1?a.substr(0,c):a:c!=-1?a.substr(0,Math.min(b,c)):a.substr(0,b)};OpenLayers.IS_GECKO=function(){var a=navigator.userAgent.toLowerCase();return a.indexOf("webkit")==-1&&a.indexOf("gecko")!=-1}();
OpenLayers.CANVAS_SUPPORTED=function(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}();OpenLayers.BROWSER_NAME=function(){var a="",b=navigator.userAgent.toLowerCase();b.indexOf("opera")!=-1?a="opera":b.indexOf("msie")!=-1?a="msie":b.indexOf("safari")!=-1?a="safari":b.indexOf("mozilla")!=-1&&(a=b.indexOf("firefox")!=-1?"firefox":"mozilla");return a}();OpenLayers.Util.getBrowserName=function(){return OpenLayers.BROWSER_NAME};
OpenLayers.Util.getRenderedDimensions=function(a,b,c){var d,e,f=document.createElement("div");f.style.visibility="hidden";for(var g=c&&c.containerElement?c.containerElement:document.body,h=false,i=null,j=g;j&&j.tagName.toLowerCase()!="body";){var k=OpenLayers.Element.getStyle(j,"position");if(k=="absolute"){h=true;break}else if(k&&k!="static")break;j=j.parentNode}if(h&&(g.clientHeight===0||g.clientWidth===0)){i=document.createElement("div");i.style.visibility="hidden";i.style.position="absolute";
i.style.overflow="visible";i.style.width=document.body.clientWidth+"px";i.style.height=document.body.clientHeight+"px";i.appendChild(f)}f.style.position="absolute";if(b)if(b.w){d=b.w;f.style.width=d+"px"}else if(b.h){e=b.h;f.style.height=e+"px"}if(c&&c.displayClass)f.className=c.displayClass;b=document.createElement("div");b.innerHTML=a;b.style.overflow="visible";if(b.childNodes){a=0;for(c=b.childNodes.length;a<c;a++)if(b.childNodes[a].style)b.childNodes[a].style.overflow="visible"}f.appendChild(b);
i?g.appendChild(i):g.appendChild(f);if(!d){d=parseInt(b.scrollWidth);f.style.width=d+"px"}e||(e=parseInt(b.scrollHeight));f.removeChild(b);if(i){i.removeChild(f);g.removeChild(i)}else g.removeChild(f);return new OpenLayers.Size(d,e)};
OpenLayers.Util.getScrollbarWidth=function(){var a=OpenLayers.Util._scrollbarWidth;if(a==null){var b=null,c=null,b=a=0,b=document.createElement("div");b.style.position="absolute";b.style.top="-1000px";b.style.left="-1000px";b.style.width="100px";b.style.height="50px";b.style.overflow="hidden";c=document.createElement("div");c.style.width="100%";c.style.height="200px";b.appendChild(c);document.body.appendChild(b);a=c.offsetWidth;b.style.overflow="scroll";b=c.offsetWidth;document.body.removeChild(document.body.lastChild);
OpenLayers.Util._scrollbarWidth=a-b;a=OpenLayers.Util._scrollbarWidth}return a};
OpenLayers.Util.getFormattedLonLat=function(a,b,c){c||(c="dms");var a=(a+540)%360-180,d=Math.abs(a),e=Math.floor(d),f=d=(d-e)/(1/60),d=Math.floor(d),f=Math.round((f-d)/(1/60)*10),f=f/10;if(f>=60){f=f-60;d=d+1;if(d>=60){d=d-60;e=e+1}}e<10&&(e="0"+e);e=e+"\u00b0";if(c.indexOf("dm")>=0){d<10&&(d="0"+d);e=e+(d+"'");if(c.indexOf("dms")>=0){f<10&&(f="0"+f);e=e+(f+'"')}}return e=b=="lon"?e+(a<0?OpenLayers.i18n("W"):OpenLayers.i18n("E")):e+(a<0?OpenLayers.i18n("S"):OpenLayers.i18n("N"))};OpenLayers.Format=OpenLayers.Class({options:null,externalProjection:null,internalProjection:null,data:null,keepData:!1,initialize:function(a){OpenLayers.Util.extend(this,a);this.options=a},destroy:function(){},read:function(){throw Error("Read not implemented.");},write:function(){throw Error("Write not implemented.");},CLASS_NAME:"OpenLayers.Format"});OpenLayers.Format.CSWGetRecords=function(a){var a=OpenLayers.Util.applyDefaults(a,OpenLayers.Format.CSWGetRecords.DEFAULTS),b=OpenLayers.Format.CSWGetRecords["v"+a.version.replace(/\./g,"_")];if(!b)throw"Unsupported CSWGetRecords version: "+a.version;return new b(a)};OpenLayers.Format.CSWGetRecords.DEFAULTS={version:"2.0.2"};OpenLayers.Control=OpenLayers.Class({id:null,map:null,div:null,type:null,allowSelection:!1,displayClass:"",title:"",autoActivate:!1,active:null,handler:null,eventListeners:null,events:null,initialize:function(a){this.displayClass=this.CLASS_NAME.replace("OpenLayers.","ol").replace(/\./g,"");OpenLayers.Util.extend(this,a);this.events=new OpenLayers.Events(this);if(this.eventListeners instanceof Object)this.events.on(this.eventListeners);null==this.id&&(this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+
"_"))},destroy:function(){this.events&&(this.eventListeners&&this.events.un(this.eventListeners),this.events.destroy(),this.events=null);this.eventListeners=null;this.handler&&(this.handler.destroy(),this.handler=null);if(this.handlers){for(var a in this.handlers)this.handlers.hasOwnProperty(a)&&"function"==typeof this.handlers[a].destroy&&this.handlers[a].destroy();this.handlers=null}this.map&&(this.map.removeControl(this),this.map=null);this.div=null},setMap:function(a){this.map=a;this.handler&&
this.handler.setMap(a)},draw:function(a){if(null==this.div&&(this.div=OpenLayers.Util.createDiv(this.id),this.div.className=this.displayClass,this.allowSelection||(this.div.className+=" olControlNoSelect",this.div.setAttribute("unselectable","on",0),this.div.onselectstart=OpenLayers.Function.False),""!=this.title))this.div.title=this.title;null!=a&&(this.position=a.clone());this.moveTo(this.position);return this.div},moveTo:function(a){null!=a&&null!=this.div&&(this.div.style.left=a.x+"px",this.div.style.top=
a.y+"px")},activate:function(){if(this.active)return!1;this.handler&&this.handler.activate();this.active=!0;this.map&&OpenLayers.Element.addClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active");this.events.triggerEvent("activate");return!0},deactivate:function(){return this.active?(this.handler&&this.handler.deactivate(),this.active=!1,this.map&&OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active"),this.events.triggerEvent("deactivate"),
!0):!1},CLASS_NAME:"OpenLayers.Control"});OpenLayers.Control.TYPE_BUTTON=1;OpenLayers.Control.TYPE_TOGGLE=2;OpenLayers.Control.TYPE_TOOL=3;OpenLayers.Event={observers:!1,KEY_SPACE:32,KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,element:function(a){return a.target||a.srcElement},isSingleTouch:function(a){return a.touches&&1==a.touches.length},isMultiTouch:function(a){return a.touches&&1<a.touches.length},isLeftClick:function(a){return a.which&&1==a.which||a.button&&1==a.button},isRightClick:function(a){return a.which&&3==a.which||a.button&&2==a.button},stop:function(a,
b){b||(a.preventDefault?a.preventDefault():a.returnValue=!1);a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},findElement:function(a,b){for(var c=OpenLayers.Event.element(a);c.parentNode&&(!c.tagName||c.tagName.toUpperCase()!=b.toUpperCase());)c=c.parentNode;return c},observe:function(a,b,c,d){a=OpenLayers.Util.getElement(a);d=d||!1;if("keypress"==b&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||a.attachEvent))b="keydown";this.observers||(this.observers={});if(!a._eventCacheID){var e=
"eventCacheID_";a.id&&(e=a.id+"_"+e);a._eventCacheID=OpenLayers.Util.createUniqueID(e)}e=a._eventCacheID;this.observers[e]||(this.observers[e]=[]);this.observers[e].push({element:a,name:b,observer:c,useCapture:d});a.addEventListener?a.addEventListener(b,c,d):a.attachEvent&&a.attachEvent("on"+b,c)},stopObservingElement:function(a){a=OpenLayers.Util.getElement(a)._eventCacheID;this._removeElementObservers(OpenLayers.Event.observers[a])},_removeElementObservers:function(a){if(a)for(var b=a.length-1;0<=
b;b--){var c=a[b];OpenLayers.Event.stopObserving.apply(this,[c.element,c.name,c.observer,c.useCapture])}},stopObserving:function(a,b,c,d){var d=d||!1,a=OpenLayers.Util.getElement(a),e=a._eventCacheID;if("keypress"==b&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||a.detachEvent))b="keydown";var f=!1,g=OpenLayers.Event.observers[e];if(g)for(var h=0;!f&&h<g.length;){var i=g[h];if(i.name==b&&i.observer==c&&i.useCapture==d){g.splice(h,1);0==g.length&&delete OpenLayers.Event.observers[e];f=!0;
break}h++}f&&(a.removeEventListener?a.removeEventListener(b,c,d):a&&a.detachEvent&&a.detachEvent("on"+b,c));return f},unloadCache:function(){if(OpenLayers.Event&&OpenLayers.Event.observers){for(var a in OpenLayers.Event.observers)OpenLayers.Event._removeElementObservers.apply(this,[OpenLayers.Event.observers[a]]);OpenLayers.Event.observers=!1}},CLASS_NAME:"OpenLayers.Event"};OpenLayers.Event.observe(window,"unload",OpenLayers.Event.unloadCache,!1);
OpenLayers.Events=OpenLayers.Class({BROWSER_EVENTS:"mouseover mouseout mousedown mouseup mousemove click dblclick rightclick dblrightclick resize focus blur touchstart touchmove touchend keydown".split(" "),listeners:null,object:null,element:null,eventHandler:null,fallThrough:null,includeXY:!1,extensions:null,extensionCount:null,clearMouseListener:null,initialize:function(a,b,c,d,e){OpenLayers.Util.extend(this,e);this.object=a;this.fallThrough=d;this.listeners={};this.extensions={};this.extensionCount=
{};null!=b&&this.attachToElement(b)},destroy:function(){for(var a in this.extensions)"boolean"!==typeof this.extensions[a]&&this.extensions[a].destroy();this.extensions=null;this.element&&(OpenLayers.Event.stopObservingElement(this.element),this.element.hasScrollEvent&&OpenLayers.Event.stopObserving(window,"scroll",this.clearMouseListener));this.eventHandler=this.fallThrough=this.object=this.listeners=this.element=null},addEventType:function(){},attachToElement:function(a){this.element?OpenLayers.Event.stopObservingElement(this.element):
(this.eventHandler=OpenLayers.Function.bindAsEventListener(this.handleBrowserEvent,this),this.clearMouseListener=OpenLayers.Function.bind(this.clearMouseCache,this));this.element=a;for(var b=0,c=this.BROWSER_EVENTS.length;b<c;b++)OpenLayers.Event.observe(a,this.BROWSER_EVENTS[b],this.eventHandler);OpenLayers.Event.observe(a,"dragstart",OpenLayers.Event.stop)},on:function(a){for(var b in a)"scope"!=b&&a.hasOwnProperty(b)&&this.register(b,a.scope,a[b])},register:function(a,b,c,d){a in OpenLayers.Events&&
!this.extensions[a]&&(this.extensions[a]=new OpenLayers.Events[a](this));if(null!=c){null==b&&(b=this.object);var e=this.listeners[a];e||(e=[],this.listeners[a]=e,this.extensionCount[a]=0);b={obj:b,func:c};d?(e.splice(this.extensionCount[a],0,b),"object"===typeof d&&d.extension&&this.extensionCount[a]++):e.push(b)}},registerPriority:function(a,b,c){this.register(a,b,c,!0)},un:function(a){for(var b in a)"scope"!=b&&a.hasOwnProperty(b)&&this.unregister(b,a.scope,a[b])},unregister:function(a,b,c){null==
b&&(b=this.object);a=this.listeners[a];if(null!=a)for(var d=0,e=a.length;d<e;d++)if(a[d].obj==b&&a[d].func==c){a.splice(d,1);break}},remove:function(a){null!=this.listeners[a]&&(this.listeners[a]=[])},triggerEvent:function(a,b){var c=this.listeners[a];if(c&&0!=c.length){null==b&&(b={});b.object=this.object;b.element=this.element;b.type||(b.type=a);for(var c=c.slice(),d,e=0,f=c.length;e<f&&!(d=c[e],d=d.func.apply(d.obj,[b]),void 0!=d&&!1==d);e++);this.fallThrough||OpenLayers.Event.stop(b,!0);return d}},
handleBrowserEvent:function(a){var b=a.type,c=this.listeners[b];if(c&&0!=c.length){if((c=a.touches)&&c[0]){for(var d=0,e=0,f=c.length,g,h=0;h<f;++h)g=c[h],d+=g.clientX,e+=g.clientY;a.clientX=d/f;a.clientY=e/f}this.includeXY&&(a.xy=this.getMousePosition(a));this.triggerEvent(b,a)}},clearMouseCache:function(){this.element.scrolls=null;this.element.lefttop=null;var a=document.body;if(a&&(!(0!=a.scrollTop||0!=a.scrollLeft)||!navigator.userAgent.match(/iPhone/i)))this.element.offsets=null},getMousePosition:function(a){this.includeXY?
this.element.hasScrollEvent||(OpenLayers.Event.observe(window,"scroll",this.clearMouseListener),this.element.hasScrollEvent=!0):this.clearMouseCache();if(!this.element.scrolls){var b=OpenLayers.Util.getViewportElement();this.element.scrolls=[b.scrollLeft,b.scrollTop]}this.element.lefttop||(this.element.lefttop=[document.documentElement.clientLeft||0,document.documentElement.clientTop||0]);this.element.offsets||(this.element.offsets=OpenLayers.Util.pagePosition(this.element));return new OpenLayers.Pixel(a.clientX+
this.element.scrolls[0]-this.element.offsets[0]-this.element.lefttop[0],a.clientY+this.element.scrolls[1]-this.element.offsets[1]-this.element.lefttop[1])},CLASS_NAME:"OpenLayers.Events"});OpenLayers.Events.buttonclick=OpenLayers.Class({target:null,events:"mousedown mouseup click dblclick touchstart touchmove touchend keydown".split(" "),startRegEx:/^mousedown|touchstart$/,cancelRegEx:/^touchmove$/,completeRegEx:/^mouseup|touchend$/,initialize:function(a){this.target=a;for(a=this.events.length-1;0<=a;--a)this.target.register(this.events[a],this,this.buttonClick,{extension:!0})},destroy:function(){for(var a=this.events.length-1;0<=a;--a)this.target.unregister(this.events[a],this,this.buttonClick);
delete this.target},getPressedButton:function(a){var b=3,c;do{if(OpenLayers.Element.hasClass(a,"olButton")){c=a;break}a=a.parentNode}while(0<--b&&a);return c},buttonClick:function(a){var b=!0,c=OpenLayers.Event.element(a);if(c&&(OpenLayers.Event.isLeftClick(a)||!~a.type.indexOf("mouse")))if(c=this.getPressedButton(c)){if("keydown"===a.type)switch(a.keyCode){case OpenLayers.Event.KEY_RETURN:case OpenLayers.Event.KEY_SPACE:this.target.triggerEvent("buttonclick",{buttonElement:c}),OpenLayers.Event.stop(a),
b=!1}else this.startEvt&&(this.completeRegEx.test(a.type)&&(b=OpenLayers.Util.pagePosition(c),this.target.triggerEvent("buttonclick",{buttonElement:c,buttonXY:{x:this.startEvt.clientX-b[0],y:this.startEvt.clientY-b[1]}})),this.cancelRegEx.test(a.type)&&delete this.startEvt,OpenLayers.Event.stop(a),b=!1);this.startRegEx.test(a.type)&&(this.startEvt=a,OpenLayers.Event.stop(a),b=!1)}else delete this.startEvt;return b}});OpenLayers.Control.OverviewMap=OpenLayers.Class(OpenLayers.Control,{element:null,ovmap:null,size:{w:180,h:90},layers:null,minRectSize:15,minRectDisplayClass:"RectReplacement",minRatio:8,maxRatio:32,mapOptions:null,autoPan:!1,handlers:null,resolutionFactor:1,maximized:!1,initialize:function(a){this.layers=[];this.handlers={};OpenLayers.Control.prototype.initialize.apply(this,[a])},destroy:function(){this.mapDiv&&(this.handlers.click&&this.handlers.click.destroy(),this.handlers.drag&&this.handlers.drag.destroy(),
this.ovmap&&this.ovmap.viewPortDiv.removeChild(this.extentRectangle),this.extentRectangle=null,this.rectEvents&&(this.rectEvents.destroy(),this.rectEvents=null),this.ovmap&&(this.ovmap.destroy(),this.ovmap=null),this.element.removeChild(this.mapDiv),this.mapDiv=null,this.div.removeChild(this.element),this.element=null,this.maximizeDiv&&(this.div.removeChild(this.maximizeDiv),this.maximizeDiv=null),this.minimizeDiv&&(this.div.removeChild(this.minimizeDiv),this.minimizeDiv=null),this.map.events.un({buttonclick:this.onButtonClick,
moveend:this.update,changebaselayer:this.baseLayerDraw,scope:this}),OpenLayers.Control.prototype.destroy.apply(this,arguments))},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(0===this.layers.length)if(this.map.baseLayer)this.layers=[this.map.baseLayer.clone()];else return this.map.events.register("changebaselayer",this,this.baseLayerDraw),this.div;this.element=document.createElement("div");this.element.className=this.displayClass+"Element";this.element.style.display="none";
this.mapDiv=document.createElement("div");this.mapDiv.style.width=this.size.w+"px";this.mapDiv.style.height=this.size.h+"px";this.mapDiv.style.position="relative";this.mapDiv.style.overflow="hidden";this.mapDiv.id=OpenLayers.Util.createUniqueID("overviewMap");this.extentRectangle=document.createElement("div");this.extentRectangle.style.position="absolute";this.extentRectangle.style.zIndex=1E3;this.extentRectangle.className=this.displayClass+"ExtentRectangle";this.element.appendChild(this.mapDiv);
this.div.appendChild(this.element);if(this.outsideViewport)this.element.style.display="";else{this.div.className+=" "+this.displayClass+"Container";var a=OpenLayers.Util.getImageLocation("layer-switcher-maximize.png");this.maximizeDiv=OpenLayers.Util.createAlphaImageDiv(this.displayClass+"MaximizeButton",null,null,a,"absolute");this.maximizeDiv.style.display="none";this.maximizeDiv.className=this.displayClass+"MaximizeButton olButton";this.div.appendChild(this.maximizeDiv);a=OpenLayers.Util.getImageLocation("layer-switcher-minimize.png");
this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_minimizeDiv",null,null,a,"absolute");this.minimizeDiv.style.display="none";this.minimizeDiv.className=this.displayClass+"MinimizeButton olButton";this.div.appendChild(this.minimizeDiv);this.minimizeControl()}this.map.getExtent()&&this.update();this.map.events.on({buttonclick:this.onButtonClick,moveend:this.update,scope:this});this.maximized&&this.maximizeControl();return this.div},baseLayerDraw:function(){this.draw();this.map.events.unregister("changebaselayer",
this,this.baseLayerDraw)},rectDrag:function(a){var b=this.handlers.drag.last.x-a.x,c=this.handlers.drag.last.y-a.y;if(0!=b||0!=c){var d=this.rectPxBounds.top,e=this.rectPxBounds.left,a=Math.abs(this.rectPxBounds.getHeight()),f=this.rectPxBounds.getWidth(),c=Math.max(0,d-c),c=Math.min(c,this.ovmap.size.h-this.hComp-a),b=Math.max(0,e-b),b=Math.min(b,this.ovmap.size.w-this.wComp-f);this.setRectPxBounds(new OpenLayers.Bounds(b,c+a,b+f,c))}},mapDivClick:function(a){var b=this.rectPxBounds.getCenterPixel(),
c=a.xy.x-b.x,d=a.xy.y-b.y,e=this.rectPxBounds.top,f=this.rectPxBounds.left,a=Math.abs(this.rectPxBounds.getHeight()),b=this.rectPxBounds.getWidth(),d=Math.max(0,e+d),d=Math.min(d,this.ovmap.size.h-a),c=Math.max(0,f+c),c=Math.min(c,this.ovmap.size.w-b);this.setRectPxBounds(new OpenLayers.Bounds(c,d+a,c+b,d));this.updateMapToRect()},onButtonClick:function(a){a.buttonElement===this.minimizeDiv?this.minimizeControl():a.buttonElement===this.maximizeDiv&&this.maximizeControl()},maximizeControl:function(a){this.element.style.display=
"";this.showToggle(!1);null!=a&&OpenLayers.Event.stop(a)},minimizeControl:function(a){this.element.style.display="none";this.showToggle(!0);null!=a&&OpenLayers.Event.stop(a)},showToggle:function(a){this.maximizeDiv.style.display=a?"":"none";this.minimizeDiv.style.display=a?"none":""},update:function(){null==this.ovmap&&this.createMap();(this.autoPan||!this.isSuitableOverview())&&this.updateOverview();this.updateRectToMap()},isSuitableOverview:function(){var a=this.map.getExtent(),b=this.map.maxExtent,
a=new OpenLayers.Bounds(Math.max(a.left,b.left),Math.max(a.bottom,b.bottom),Math.min(a.right,b.right),Math.min(a.top,b.top));this.ovmap.getProjection()!=this.map.getProjection()&&(a=a.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject()));b=this.ovmap.getResolution()/this.map.getResolution();return b>this.minRatio&&b<=this.maxRatio&&this.ovmap.getExtent().containsBounds(a)},updateOverview:function(){var a=this.map.getResolution(),b=this.ovmap.getResolution(),c=b/a;c>this.maxRatio?
b=this.minRatio*a:c<=this.minRatio&&(b=this.maxRatio*a);this.ovmap.getProjection()!=this.map.getProjection()?(a=this.map.center.clone(),a.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject())):a=this.map.center;this.ovmap.setCenter(a,this.ovmap.getZoomForResolution(b*this.resolutionFactor));this.updateRectToMap()},createMap:function(){var a=OpenLayers.Util.extend({controls:[],maxResolution:"auto",fallThrough:!1},this.mapOptions);this.ovmap=new OpenLayers.Map(this.mapDiv,a);this.ovmap.viewPortDiv.appendChild(this.extentRectangle);
OpenLayers.Event.stopObserving(window,"unload",this.ovmap.unloadDestroy);this.ovmap.addLayers(this.layers);this.ovmap.zoomToMaxExtent();this.wComp=(this.wComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-left-width"))+parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-right-width")))?this.wComp:2;this.hComp=(this.hComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-top-width"))+parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-bottom-width")))?
this.hComp:2;this.handlers.drag=new OpenLayers.Handler.Drag(this,{move:this.rectDrag,done:this.updateMapToRect},{map:this.ovmap});this.handlers.click=new OpenLayers.Handler.Click(this,{click:this.mapDivClick},{single:!0,"double":!1,stopSingle:!0,stopDouble:!0,pixelTolerance:1,map:this.ovmap});this.handlers.click.activate();this.rectEvents=new OpenLayers.Events(this,this.extentRectangle,null,!0);this.rectEvents.register("mouseover",this,function(){!this.handlers.drag.active&&!this.map.dragging&&this.handlers.drag.activate()});
this.rectEvents.register("mouseout",this,function(){this.handlers.drag.dragging||this.handlers.drag.deactivate()});if(this.ovmap.getProjection()!=this.map.getProjection()){var a=this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units,b=this.ovmap.getProjectionObject().getUnits()||this.ovmap.units||this.ovmap.baseLayer.units;this.resolutionFactor=a&&b?OpenLayers.INCHES_PER_UNIT[a]/OpenLayers.INCHES_PER_UNIT[b]:1}},updateRectToMap:function(){var a=this.getRectBoundsFromMapBounds(this.ovmap.getProjection()!=
this.map.getProjection()?this.map.getExtent().transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject()):this.map.getExtent());a&&this.setRectPxBounds(a)},updateMapToRect:function(){var a=this.getMapBoundsFromRectBounds(this.rectPxBounds);this.ovmap.getProjection()!=this.map.getProjection()&&(a=a.transform(this.ovmap.getProjectionObject(),this.map.getProjectionObject()));this.map.panTo(a.getCenterLonLat())},setRectPxBounds:function(a){var b=Math.max(a.top,0),c=Math.max(a.left,0),d=
Math.min(a.top+Math.abs(a.getHeight()),this.ovmap.size.h-this.hComp),a=Math.min(a.left+a.getWidth(),this.ovmap.size.w-this.wComp),e=Math.max(a-c,0),f=Math.max(d-b,0);e<this.minRectSize||f<this.minRectSize?(this.extentRectangle.className=this.displayClass+this.minRectDisplayClass,e=c+e/2-this.minRectSize/2,this.extentRectangle.style.top=Math.round(b+f/2-this.minRectSize/2)+"px",this.extentRectangle.style.left=Math.round(e)+"px",this.extentRectangle.style.height=this.minRectSize+"px",this.extentRectangle.style.width=
this.minRectSize+"px"):(this.extentRectangle.className=this.displayClass+"ExtentRectangle",this.extentRectangle.style.top=Math.round(b)+"px",this.extentRectangle.style.left=Math.round(c)+"px",this.extentRectangle.style.height=Math.round(f)+"px",this.extentRectangle.style.width=Math.round(e)+"px");this.rectPxBounds=new OpenLayers.Bounds(Math.round(c),Math.round(d),Math.round(a),Math.round(b))},getRectBoundsFromMapBounds:function(a){var b=this.getOverviewPxFromLonLat({lon:a.left,lat:a.bottom}),a=this.getOverviewPxFromLonLat({lon:a.right,
lat:a.top}),c=null;b&&a&&(c=new OpenLayers.Bounds(b.x,b.y,a.x,a.y));return c},getMapBoundsFromRectBounds:function(a){var b=this.getLonLatFromOverviewPx({x:a.left,y:a.bottom}),a=this.getLonLatFromOverviewPx({x:a.right,y:a.top});return new OpenLayers.Bounds(b.lon,b.lat,a.lon,a.lat)},getLonLatFromOverviewPx:function(a){var b=this.ovmap.size,c=this.ovmap.getResolution(),d=this.ovmap.getExtent().getCenterLonLat();return{lon:d.lon+(a.x-b.w/2)*c,lat:d.lat-(a.y-b.h/2)*c}},getOverviewPxFromLonLat:function(a){var b=
this.ovmap.getResolution(),c=this.ovmap.getExtent();if(c)return{x:Math.round(1/b*(a.lon-c.left)),y:Math.round(1/b*(c.top-a.lat))}},CLASS_NAME:"OpenLayers.Control.OverviewMap"});OpenLayers.Animation=function(a){var b=!(!a.requestAnimationFrame&&!a.webkitRequestAnimationFrame&&!a.mozRequestAnimationFrame&&!a.oRequestAnimationFrame&&!a.msRequestAnimationFrame),c=function(){var b=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||function(b){a.setTimeout(b,16)};return function(c,d){b.apply(a,[c,d])}}(),d=0,e={};return{isNative:b,requestFrame:c,start:function(a,b,h){var b=0<b?b:Number.POSITIVE_INFINITY,
i=++d,j=+new Date;e[i]=function(){e[i]&&+new Date-j<=b?(a(),e[i]&&c(e[i],h)):delete e[i]};c(e[i],h);return i},stop:function(a){delete e[a]}}}(window);OpenLayers.Tween=OpenLayers.Class({easing:null,begin:null,finish:null,duration:null,callbacks:null,time:null,animationId:null,playing:!1,initialize:function(a){this.easing=a?a:OpenLayers.Easing.Expo.easeOut},start:function(a,b,c,d){this.playing=!0;this.begin=a;this.finish=b;this.duration=c;this.callbacks=d.callbacks;this.time=0;OpenLayers.Animation.stop(this.animationId);this.animationId=null;this.callbacks&&this.callbacks.start&&this.callbacks.start.call(this,this.begin);this.animationId=OpenLayers.Animation.start(OpenLayers.Function.bind(this.play,
this))},stop:function(){this.playing&&(this.callbacks&&this.callbacks.done&&this.callbacks.done.call(this,this.finish),OpenLayers.Animation.stop(this.animationId),this.animationId=null,this.playing=!1)},play:function(){var a={},b;for(b in this.begin){var c=this.begin[b],d=this.finish[b];if(null==c||null==d||isNaN(c)||isNaN(d))throw new TypeError("invalid value for Tween");a[b]=this.easing.apply(this,[this.time,c,d-c,this.duration])}this.time++;this.callbacks&&this.callbacks.eachStep&&this.callbacks.eachStep.call(this,
a);this.time>this.duration&&this.stop()},CLASS_NAME:"OpenLayers.Tween"});OpenLayers.Easing={CLASS_NAME:"OpenLayers.Easing"};OpenLayers.Easing.Linear={easeIn:function(a,b,c,d){return c*a/d+b},easeOut:function(a,b,c,d){return c*a/d+b},easeInOut:function(a,b,c,d){return c*a/d+b},CLASS_NAME:"OpenLayers.Easing.Linear"};
OpenLayers.Easing.Expo={easeIn:function(a,b,c,d){return 0==a?b:c*Math.pow(2,10*(a/d-1))+b},easeOut:function(a,b,c,d){return a==d?b+c:c*(-Math.pow(2,-10*a/d)+1)+b},easeInOut:function(a,b,c,d){return 0==a?b:a==d?b+c:1>(a/=d/2)?c/2*Math.pow(2,10*(a-1))+b:c/2*(-Math.pow(2,-10*--a)+2)+b},CLASS_NAME:"OpenLayers.Easing.Expo"};
OpenLayers.Easing.Quad={easeIn:function(a,b,c,d){return c*(a/=d)*a+b},easeOut:function(a,b,c,d){return-c*(a/=d)*(a-2)+b},easeInOut:function(a,b,c,d){return 1>(a/=d/2)?c/2*a*a+b:-c/2*(--a*(a-2)-1)+b},CLASS_NAME:"OpenLayers.Easing.Quad"};OpenLayers.Projection=OpenLayers.Class({proj:null,projCode:null,titleRegEx:/\+title=[^\+]*/,initialize:function(a,b){OpenLayers.Util.extend(this,b);this.projCode=a;window.Proj4js&&(this.proj=new Proj4js.Proj(a))},getCode:function(){return this.proj?this.proj.srsCode:this.projCode},getUnits:function(){return this.proj?this.proj.units:null},toString:function(){return this.getCode()},equals:function(a){var b=!1;a&&(a instanceof OpenLayers.Projection||(a=new OpenLayers.Projection(a)),window.Proj4js&&
this.proj.defData&&a.proj.defData?b=this.proj.defData.replace(this.titleRegEx,"")==a.proj.defData.replace(this.titleRegEx,""):a.getCode&&(b=this.getCode(),a=a.getCode(),b=b==a||!!OpenLayers.Projection.transforms[b]&&OpenLayers.Projection.transforms[b][a]===OpenLayers.Projection.nullTransform));return b},destroy:function(){delete this.proj;delete this.projCode},CLASS_NAME:"OpenLayers.Projection"});OpenLayers.Projection.transforms={};
OpenLayers.Projection.defaults={"EPSG:4326":{units:"degrees",maxExtent:[-180,-90,180,90],yx:!0},"CRS:84":{units:"degrees",maxExtent:[-180,-90,180,90]},"EPSG:900913":{units:"m",maxExtent:[-2.003750834E7,-2.003750834E7,2.003750834E7,2.003750834E7]}};
OpenLayers.Projection.addTransform=function(a,b,c){if(c===OpenLayers.Projection.nullTransform){var d=OpenLayers.Projection.defaults[a];d&&!OpenLayers.Projection.defaults[b]&&(OpenLayers.Projection.defaults[b]=d)}OpenLayers.Projection.transforms[a]||(OpenLayers.Projection.transforms[a]={});OpenLayers.Projection.transforms[a][b]=c};
OpenLayers.Projection.transform=function(a,b,c){if(b&&c)if(b instanceof OpenLayers.Projection||(b=new OpenLayers.Projection(b)),c instanceof OpenLayers.Projection||(c=new OpenLayers.Projection(c)),b.proj&&c.proj)a=Proj4js.transform(b.proj,c.proj,a);else{var b=b.getCode(),c=c.getCode(),d=OpenLayers.Projection.transforms;if(d[b]&&d[b][c])d[b][c](a)}return a};OpenLayers.Projection.nullTransform=function(a){return a};
(function(){function a(a){a.x=180*a.x/d;a.y=180/Math.PI*(2*Math.atan(Math.exp(a.y/d*Math.PI))-Math.PI/2);return a}function b(a){a.x=a.x*d/180;a.y=Math.log(Math.tan((90+a.y)*Math.PI/360))/Math.PI*d;return a}function c(c,d){var e=OpenLayers.Projection.addTransform,f=OpenLayers.Projection.nullTransform,g,m,n,o,p;g=0;for(m=d.length;g<m;++g){n=d[g];e(c,n,b);e(n,c,a);for(p=g+1;p<m;++p)o=d[p],e(n,o,f),e(o,n,f)}}var d=2.003750834E7,e=["EPSG:900913","EPSG:3857","EPSG:102113","EPSG:102100"],f=["CRS:84","urn:ogc:def:crs:EPSG:6.6:4326",
"EPSG:4326"],g;for(g=e.length-1;0<=g;--g)c(e[g],f);for(g=f.length-1;0<=g;--g)c(f[g],e)})();OpenLayers.Map=OpenLayers.Class({Z_INDEX_BASE:{BaseLayer:100,Overlay:325,Feature:725,Popup:750,Control:1E3},id:null,fractionalZoom:!1,events:null,allOverlays:!1,div:null,dragging:!1,size:null,viewPortDiv:null,layerContainerOrigin:null,layerContainerDiv:null,layers:null,controls:null,popups:null,baseLayer:null,center:null,resolution:null,zoom:0,panRatio:1.5,options:null,tileSize:null,projection:"EPSG:4326",units:null,resolutions:null,maxResolution:null,minResolution:null,maxScale:null,minScale:null,
maxExtent:null,minExtent:null,restrictedExtent:null,numZoomLevels:16,theme:null,displayProjection:null,fallThrough:!0,panTween:null,eventListeners:null,panMethod:OpenLayers.Easing.Expo.easeOut,panDuration:50,paddingForPopups:null,minPx:null,maxPx:null,initialize:function(a,b){1===arguments.length&&"object"===typeof a&&(a=(b=a)&&b.div);this.tileSize=new OpenLayers.Size(OpenLayers.Map.TILE_WIDTH,OpenLayers.Map.TILE_HEIGHT);this.paddingForPopups=new OpenLayers.Bounds(15,15,15,15);this.theme=undefined;this.options=OpenLayers.Util.extend({},b);OpenLayers.Util.extend(this,b);OpenLayers.Util.applyDefaults(this,OpenLayers.Projection.defaults[this.projection instanceof OpenLayers.Projection?this.projection.projCode:this.projection]);this.maxExtent&&!(this.maxExtent instanceof OpenLayers.Bounds)&&(this.maxExtent=new OpenLayers.Bounds(this.maxExtent));this.minExtent&&!(this.minExtent instanceof OpenLayers.Bounds)&&(this.minExtent=new OpenLayers.Bounds(this.minExtent));this.restrictedExtent&&
!(this.restrictedExtent instanceof OpenLayers.Bounds)&&(this.restrictedExtent=new OpenLayers.Bounds(this.restrictedExtent));this.center&&!(this.center instanceof OpenLayers.LonLat)&&(this.center=new OpenLayers.LonLat(this.center));this.layers=[];this.id=OpenLayers.Util.createUniqueID("OpenLayers.Map_");this.div=OpenLayers.Util.getElement(a);this.div||(this.div=document.createElement("div"),this.div.style.height="1px",this.div.style.width="1px");OpenLayers.Element.addClass(this.div,"olMap");var c=
this.id+"_OpenLayers_ViewPort";this.viewPortDiv=OpenLayers.Util.createDiv(c,null,null,null,"relative",null,"hidden");this.viewPortDiv.style.width="100%";this.viewPortDiv.style.height="100%";this.viewPortDiv.className="olMapViewport";this.div.appendChild(this.viewPortDiv);this.events=new OpenLayers.Events(this,this.viewPortDiv,null,this.fallThrough,{includeXY:!0});c=this.id+"_OpenLayers_Container";this.layerContainerDiv=OpenLayers.Util.createDiv(c);this.layerContainerDiv.style.width="100px";this.layerContainerDiv.style.height=
"100px";this.layerContainerDiv.style.zIndex=this.Z_INDEX_BASE.Popup-1;this.viewPortDiv.appendChild(this.layerContainerDiv);this.updateSize();if(this.eventListeners instanceof Object)this.events.on(this.eventListeners);9>parseFloat(navigator.appVersion.split("MSIE")[1])?this.events.register("resize",this,this.updateSize):(this.updateSizeDestroy=OpenLayers.Function.bind(this.updateSize,this),OpenLayers.Event.observe(window,"resize",this.updateSizeDestroy));if(this.theme){for(var c=!0,d=document.getElementsByTagName("link"),
e=0,f=d.length;e<f;++e)if(OpenLayers.Util.isEquivalentUrl(d.item(e).href,this.theme)){c=!1;break}c&&(c=document.createElement("link"),c.setAttribute("rel","stylesheet"),c.setAttribute("type","text/css"),c.setAttribute("href",this.theme),document.getElementsByTagName("head")[0].appendChild(c))}null==this.controls&&(this.controls=[],null!=OpenLayers.Control&&(OpenLayers.Control.Navigation?this.controls.push(new OpenLayers.Control.Navigation):OpenLayers.Control.TouchNavigation&&this.controls.push(new OpenLayers.Control.TouchNavigation),
OpenLayers.Control.Zoom?this.controls.push(new OpenLayers.Control.Zoom):OpenLayers.Control.PanZoom&&this.controls.push(new OpenLayers.Control.PanZoom),OpenLayers.Control.ArgParser&&this.controls.push(new OpenLayers.Control.ArgParser),OpenLayers.Control.Attribution&&this.controls.push(new OpenLayers.Control.Attribution)));e=0;for(f=this.controls.length;e<f;e++)this.addControlToMap(this.controls[e]);this.popups=[];this.unloadDestroy=OpenLayers.Function.bind(this.destroy,this);OpenLayers.Event.observe(window,
"unload",this.unloadDestroy);b&&b.layers&&(delete this.center,this.addLayers(b.layers),b.center&&!this.getCenter()&&this.setCenter(b.center,b.zoom))},getViewport:function(){return this.viewPortDiv},render:function(a){this.div=OpenLayers.Util.getElement(a);OpenLayers.Element.addClass(this.div,"olMap");this.viewPortDiv.parentNode.removeChild(this.viewPortDiv);this.div.appendChild(this.viewPortDiv);this.updateSize()},unloadDestroy:null,updateSizeDestroy:null,destroy:function(){if(!this.unloadDestroy)return!1;
this.panTween&&(this.panTween.stop(),this.panTween=null);OpenLayers.Event.stopObserving(window,"unload",this.unloadDestroy);this.unloadDestroy=null;this.updateSizeDestroy?OpenLayers.Event.stopObserving(window,"resize",this.updateSizeDestroy):this.events.unregister("resize",this,this.updateSize);this.paddingForPopups=null;if(null!=this.controls){for(var a=this.controls.length-1;0<=a;--a)this.controls[a].destroy();this.controls=null}if(null!=this.layers){for(a=this.layers.length-1;0<=a;--a)this.layers[a].destroy(!1);
this.layers=null}this.viewPortDiv&&this.div.removeChild(this.viewPortDiv);this.viewPortDiv=null;this.eventListeners&&(this.events.un(this.eventListeners),this.eventListeners=null);this.events.destroy();this.options=this.events=null},setOptions:function(a){var b=this.minPx&&a.restrictedExtent!=this.restrictedExtent;OpenLayers.Util.extend(this,a);b&&this.moveTo(this.getCachedCenter(),this.zoom,{forceZoomChange:!0})},getTileSize:function(){return this.tileSize},getBy:function(a,b,c){var d="function"==
typeof c.test;return OpenLayers.Array.filter(this[a],function(a){return a[b]==c||d&&c.test(a[b])})},getLayersBy:function(a,b){return this.getBy("layers",a,b)},getLayersByName:function(a){return this.getLayersBy("name",a)},getLayersByClass:function(a){return this.getLayersBy("CLASS_NAME",a)},getControlsBy:function(a,b){return this.getBy("controls",a,b)},getControlsByClass:function(a){return this.getControlsBy("CLASS_NAME",a)},getLayer:function(a){for(var b=null,c=0,d=this.layers.length;c<d;c++){var e=
this.layers[c];if(e.id==a){b=e;break}}return b},setLayerZIndex:function(a,b){a.setZIndex(this.Z_INDEX_BASE[a.isBaseLayer?"BaseLayer":"Overlay"]+5*b)},resetLayersZIndex:function(){for(var a=0,b=this.layers.length;a<b;a++)this.setLayerZIndex(this.layers[a],a)},addLayer:function(a){for(var b=0,c=this.layers.length;b<c;b++)if(this.layers[b]==a)return!1;if(!1===this.events.triggerEvent("preaddlayer",{layer:a}))return!1;this.allOverlays&&(a.isBaseLayer=!1);a.div.className="olLayerDiv";a.div.style.overflow=
"";this.setLayerZIndex(a,this.layers.length);a.isFixed?this.viewPortDiv.appendChild(a.div):this.layerContainerDiv.appendChild(a.div);this.layers.push(a);a.setMap(this);a.isBaseLayer||this.allOverlays&&!this.baseLayer?null==this.baseLayer?this.setBaseLayer(a):a.setVisibility(!1):a.redraw();this.events.triggerEvent("addlayer",{layer:a});a.events.triggerEvent("added",{map:this,layer:a});a.afterAdd();return!0},addLayers:function(a){for(var b=0,c=a.length;b<c;b++)this.addLayer(a[b])},removeLayer:function(a,
b){if(!1!==this.events.triggerEvent("preremovelayer",{layer:a})){null==b&&(b=!0);a.isFixed?this.viewPortDiv.removeChild(a.div):this.layerContainerDiv.removeChild(a.div);OpenLayers.Util.removeItem(this.layers,a);a.removeMap(this);a.map=null;if(this.baseLayer==a&&(this.baseLayer=null,b))for(var c=0,d=this.layers.length;c<d;c++){var e=this.layers[c];if(e.isBaseLayer||this.allOverlays){this.setBaseLayer(e);break}}this.resetLayersZIndex();this.events.triggerEvent("removelayer",{layer:a});a.events.triggerEvent("removed",
{map:this,layer:a})}},getNumLayers:function(){return this.layers.length},getLayerIndex:function(a){return OpenLayers.Util.indexOf(this.layers,a)},setLayerIndex:function(a,b){var c=this.getLayerIndex(a);0>b?b=0:b>this.layers.length&&(b=this.layers.length);if(c!=b){this.layers.splice(c,1);this.layers.splice(b,0,a);for(var c=0,d=this.layers.length;c<d;c++)this.setLayerZIndex(this.layers[c],c);this.events.triggerEvent("changelayer",{layer:a,property:"order"});this.allOverlays&&(0===b?this.setBaseLayer(a):
this.baseLayer!==this.layers[0]&&this.setBaseLayer(this.layers[0]))}},raiseLayer:function(a,b){var c=this.getLayerIndex(a)+b;this.setLayerIndex(a,c)},setBaseLayer:function(a){if(a!=this.baseLayer&&-1!=OpenLayers.Util.indexOf(this.layers,a)){var b=this.getCachedCenter(),c=OpenLayers.Util.getResolutionFromScale(this.getScale(),a.units);null!=this.baseLayer&&!this.allOverlays&&this.baseLayer.setVisibility(!1);this.baseLayer=a;if(!this.allOverlays||this.baseLayer.visibility)this.baseLayer.setVisibility(!0),
!1===this.baseLayer.inRange&&this.baseLayer.redraw();null!=b&&(a=this.getZoomForResolution(c||this.resolution,!0),this.setCenter(b,a,!1,!0));this.events.triggerEvent("changebaselayer",{layer:this.baseLayer})}},addControl:function(a,b){this.controls.push(a);this.addControlToMap(a,b)},addControls:function(a,b){for(var c=1===arguments.length?[]:b,d=0,e=a.length;d<e;d++)this.addControl(a[d],c[d]?c[d]:null)},addControlToMap:function(a,b){a.outsideViewport=null!=a.div;this.displayProjection&&!a.displayProjection&&
(a.displayProjection=this.displayProjection);a.setMap(this);var c=a.draw(b);c&&!a.outsideViewport&&(c.style.zIndex=this.Z_INDEX_BASE.Control+this.controls.length,this.viewPortDiv.appendChild(c));a.autoActivate&&a.activate()},getControl:function(a){for(var b=null,c=0,d=this.controls.length;c<d;c++){var e=this.controls[c];if(e.id==a){b=e;break}}return b},removeControl:function(a){a&&a==this.getControl(a.id)&&(a.div&&a.div.parentNode==this.viewPortDiv&&this.viewPortDiv.removeChild(a.div),OpenLayers.Util.removeItem(this.controls,
a))},addPopup:function(a,b){if(b)for(var c=this.popups.length-1;0<=c;--c)this.removePopup(this.popups[c]);a.map=this;this.popups.push(a);if(c=a.draw())c.style.zIndex=this.Z_INDEX_BASE.Popup+this.popups.length,this.layerContainerDiv.appendChild(c)},removePopup:function(a){OpenLayers.Util.removeItem(this.popups,a);if(a.div)try{this.layerContainerDiv.removeChild(a.div)}catch(b){}a.map=null},getSize:function(){var a=null;null!=this.size&&(a=this.size.clone());return a},updateSize:function(){var a=this.getCurrentSize();
if(a&&!isNaN(a.h)&&!isNaN(a.w)){this.events.clearMouseCache();var b=this.getSize();null==b&&(this.size=b=a);if(!a.equals(b)){this.size=a;a=0;for(b=this.layers.length;a<b;a++)this.layers[a].onMapResize();a=this.getCachedCenter();null!=this.baseLayer&&null!=a&&(b=this.getZoom(),this.zoom=null,this.setCenter(a,b))}}},getCurrentSize:function(){var a=new OpenLayers.Size(this.div.clientWidth,this.div.clientHeight);if(0==a.w&&0==a.h||isNaN(a.w)&&isNaN(a.h))a.w=this.div.offsetWidth,a.h=this.div.offsetHeight;
if(0==a.w&&0==a.h||isNaN(a.w)&&isNaN(a.h))a.w=parseInt(this.div.style.width),a.h=parseInt(this.div.style.height);return a},calculateBounds:function(a,b){var c=null;null==a&&(a=this.getCachedCenter());null==b&&(b=this.getResolution());if(null!=a&&null!=b)var c=this.size.w*b/2,d=this.size.h*b/2,c=new OpenLayers.Bounds(a.lon-c,a.lat-d,a.lon+c,a.lat+d);return c},getCenter:function(){var a=null,b=this.getCachedCenter();b&&(a=b.clone());return a},getCachedCenter:function(){!this.center&&this.size&&(this.center=
this.getLonLatFromViewPortPx({x:this.size.w/2,y:this.size.h/2}));return this.center},getZoom:function(){return this.zoom},pan:function(a,b,c){c=OpenLayers.Util.applyDefaults(c,{animate:!0,dragging:!1});if(c.dragging)(0!=a||0!=b)&&this.moveByPx(a,b);else{var d=this.getViewPortPxFromLonLat(this.getCachedCenter()),a=d.add(a,b);if(this.dragging||!a.equals(d))d=this.getLonLatFromViewPortPx(a),c.animate?this.panTo(d):(this.moveTo(d),this.dragging&&(this.dragging=!1,this.events.triggerEvent("moveend")))}},
panTo:function(a){if(this.panMethod&&this.getExtent().scale(this.panRatio).containsLonLat(a)){this.panTween||(this.panTween=new OpenLayers.Tween(this.panMethod));var b=this.getCachedCenter();if(!a.equals(b)){var b=this.getPixelFromLonLat(b),c=this.getPixelFromLonLat(a),d=0,e=0;this.panTween.start({x:0,y:0},{x:c.x-b.x,y:c.y-b.y},this.panDuration,{callbacks:{eachStep:OpenLayers.Function.bind(function(a){this.moveByPx(a.x-d,a.y-e);d=Math.round(a.x);e=Math.round(a.y)},this),done:OpenLayers.Function.bind(function(){this.moveTo(a);
this.dragging=false;this.events.triggerEvent("moveend")},this)}})}}else this.setCenter(a)},setCenter:function(a,b,c,d){this.panTween&&this.panTween.stop();this.moveTo(a,b,{dragging:c,forceZoomChange:d})},moveByPx:function(a,b){var c=this.size.w/2,d=this.size.h/2,e=c+a,f=d+b,g=this.baseLayer.wrapDateLine,h=0,i=0;this.restrictedExtent&&(h=c,i=d,g=!1);a=g||e<=this.maxPx.x-h&&e>=this.minPx.x+h?Math.round(a):0;b=f<=this.maxPx.y-i&&f>=this.minPx.y+i?Math.round(b):0;if(a||b){this.dragging||(this.dragging=
!0,this.events.triggerEvent("movestart"));this.center=null;a&&(this.layerContainerDiv.style.left=parseInt(this.layerContainerDiv.style.left)-a+"px",this.minPx.x-=a,this.maxPx.x-=a);b&&(this.layerContainerDiv.style.top=parseInt(this.layerContainerDiv.style.top)-b+"px",this.minPx.y-=b,this.maxPx.y-=b);d=0;for(e=this.layers.length;d<e;++d)if(c=this.layers[d],c.visibility&&(c===this.baseLayer||c.inRange))c.moveByPx(a,b),c.events.triggerEvent("move");this.events.triggerEvent("move")}},adjustZoom:function(a){var b=
this.baseLayer.resolutions,c=this.getMaxExtent().getWidth()/this.size.w;if(this.getResolutionForZoom(a)>c)for(var d=a|0,e=b.length;d<e;++d)if(b[d]<=c){a=d;break}return a},moveTo:function(a,b,c){null!=a&&!(a instanceof OpenLayers.LonLat)&&(a=new OpenLayers.LonLat(a));c||(c={});null!=b&&(b=parseFloat(b),this.fractionalZoom||(b=Math.round(b)));if(this.baseLayer.wrapDateLine){var d=b,b=this.adjustZoom(b);b!==d&&(a=this.getCenter())}var d=c.dragging||this.dragging,e=c.forceZoomChange;!this.getCachedCenter()&&
!this.isValidLonLat(a)&&(a=this.maxExtent.getCenterLonLat(),this.center=a.clone());if(null!=this.restrictedExtent){null==a&&(a=this.center);null==b&&(b=this.getZoom());var f=this.getResolutionForZoom(b),f=this.calculateBounds(a,f);if(!this.restrictedExtent.containsBounds(f)){var g=this.restrictedExtent.getCenterLonLat();f.getWidth()>this.restrictedExtent.getWidth()?a=new OpenLayers.LonLat(g.lon,a.lat):f.left<this.restrictedExtent.left?a=a.add(this.restrictedExtent.left-f.left,0):f.right>this.restrictedExtent.right&&
(a=a.add(this.restrictedExtent.right-f.right,0));f.getHeight()>this.restrictedExtent.getHeight()?a=new OpenLayers.LonLat(a.lon,g.lat):f.bottom<this.restrictedExtent.bottom?a=a.add(0,this.restrictedExtent.bottom-f.bottom):f.top>this.restrictedExtent.top&&(a=a.add(0,this.restrictedExtent.top-f.top))}}e=e||this.isValidZoomLevel(b)&&b!=this.getZoom();f=this.isValidLonLat(a)&&!a.equals(this.center);if(e||f||d){d||this.events.triggerEvent("movestart");f&&(!e&&this.center&&this.centerLayerContainer(a),this.center=
a.clone());a=e?this.getResolutionForZoom(b):this.getResolution();if(e||null==this.layerContainerOrigin){this.layerContainerOrigin=this.getCachedCenter();this.layerContainerDiv.style.left="0px";this.layerContainerDiv.style.top="0px";var f=this.getMaxExtent({restricted:!0}),h=f.getCenterLonLat(),g=this.center.lon-h.lon,h=h.lat-this.center.lat,i=Math.round(f.getWidth()/a),j=Math.round(f.getHeight()/a);this.minPx={x:(this.size.w-i)/2-g/a,y:(this.size.h-j)/2-h/a};this.maxPx={x:this.minPx.x+Math.round(f.getWidth()/
a),y:this.minPx.y+Math.round(f.getHeight()/a)}}e&&(this.zoom=b,this.resolution=a);a=this.getExtent();this.baseLayer.visibility&&(this.baseLayer.moveTo(a,e,c.dragging),c.dragging||this.baseLayer.events.triggerEvent("moveend",{zoomChanged:e}));a=this.baseLayer.getExtent();for(b=this.layers.length-1;0<=b;--b)if(f=this.layers[b],f!==this.baseLayer&&!f.isBaseLayer&&(g=f.calculateInRange(),f.inRange!=g&&((f.inRange=g)||f.display(!1),this.events.triggerEvent("changelayer",{layer:f,property:"visibility"})),
g&&f.visibility))f.moveTo(a,e,c.dragging),c.dragging||f.events.triggerEvent("moveend",{zoomChanged:e});this.events.triggerEvent("move");d||this.events.triggerEvent("moveend");if(e){b=0;for(c=this.popups.length;b<c;b++)this.popups[b].updatePosition();this.events.triggerEvent("zoomend")}}},centerLayerContainer:function(a){var b=this.getViewPortPxFromLonLat(this.layerContainerOrigin),c=this.getViewPortPxFromLonLat(a);if(null!=b&&null!=c){var d=parseInt(this.layerContainerDiv.style.left),a=parseInt(this.layerContainerDiv.style.top),
e=Math.round(b.x-c.x),b=Math.round(b.y-c.y);this.layerContainerDiv.style.left=e+"px";this.layerContainerDiv.style.top=b+"px";d-=e;a-=b;this.minPx.x-=d;this.maxPx.x-=d;this.minPx.y-=a;this.maxPx.y-=a}},isValidZoomLevel:function(a){return null!=a&&0<=a&&a<this.getNumZoomLevels()},isValidLonLat:function(a){var b=!1;null!=a&&(b=this.getMaxExtent(),b=b.containsLonLat(a,{worldBounds:this.baseLayer.wrapDateLine&&b}));return b},getProjection:function(){var a=this.getProjectionObject();return a?a.getCode():
null},getProjectionObject:function(){var a=null;null!=this.baseLayer&&(a=this.baseLayer.projection);return a},getMaxResolution:function(){var a=null;null!=this.baseLayer&&(a=this.baseLayer.maxResolution);return a},getMaxExtent:function(a){var b=null;a&&a.restricted&&this.restrictedExtent?b=this.restrictedExtent:null!=this.baseLayer&&(b=this.baseLayer.maxExtent);return b},getNumZoomLevels:function(){var a=null;null!=this.baseLayer&&(a=this.baseLayer.numZoomLevels);return a},getExtent:function(){var a=
null;null!=this.baseLayer&&(a=this.baseLayer.getExtent());return a},getResolution:function(){var a=null;null!=this.baseLayer?a=this.baseLayer.getResolution():!0===this.allOverlays&&0<this.layers.length&&(a=this.layers[0].getResolution());return a},getUnits:function(){var a=null;null!=this.baseLayer&&(a=this.baseLayer.units);return a},getScale:function(){var a=null;null!=this.baseLayer&&(a=this.getResolution(),a=OpenLayers.Util.getScaleFromResolution(a,this.baseLayer.units));return a},getZoomForExtent:function(a,
b){var c=null;null!=this.baseLayer&&(c=this.baseLayer.getZoomForExtent(a,b));return c},getResolutionForZoom:function(a){var b=null;this.baseLayer&&(b=this.baseLayer.getResolutionForZoom(a));return b},getZoomForResolution:function(a,b){var c=null;null!=this.baseLayer&&(c=this.baseLayer.getZoomForResolution(a,b));return c},zoomTo:function(a){this.isValidZoomLevel(a)&&this.setCenter(null,a)},zoomIn:function(){this.zoomTo(this.getZoom()+1)},zoomOut:function(){this.zoomTo(this.getZoom()-1)},zoomToExtent:function(a,
b){a instanceof OpenLayers.Bounds||(a=new OpenLayers.Bounds(a));var c=a.getCenterLonLat();if(this.baseLayer.wrapDateLine){c=this.getMaxExtent();for(a=a.clone();a.right<a.left;)a.right+=c.getWidth();c=a.getCenterLonLat().wrapDateLine(c)}this.setCenter(c,this.getZoomForExtent(a,b))},zoomToMaxExtent:function(a){this.zoomToExtent(this.getMaxExtent({restricted:a?a.restricted:!0}))},zoomToScale:function(a,b){var c=OpenLayers.Util.getResolutionFromScale(a,this.baseLayer.units),d=this.size.w*c/2,c=this.size.h*
c/2,e=this.getCachedCenter();this.zoomToExtent(new OpenLayers.Bounds(e.lon-d,e.lat-c,e.lon+d,e.lat+c),b)},getLonLatFromViewPortPx:function(a){var b=null;null!=this.baseLayer&&(b=this.baseLayer.getLonLatFromViewPortPx(a));return b},getViewPortPxFromLonLat:function(a){var b=null;null!=this.baseLayer&&(b=this.baseLayer.getViewPortPxFromLonLat(a));return b},getLonLatFromPixel:function(a){return this.getLonLatFromViewPortPx(a)},getPixelFromLonLat:function(a){a=this.getViewPortPxFromLonLat(a);a.x=Math.round(a.x);
a.y=Math.round(a.y);return a},getGeodesicPixelSize:function(a){var b=a?this.getLonLatFromPixel(a):this.getCachedCenter()||new OpenLayers.LonLat(0,0),c=this.getResolution(),a=b.add(-c/2,0),d=b.add(c/2,0),e=b.add(0,-c/2),b=b.add(0,c/2),c=new OpenLayers.Projection("EPSG:4326"),f=this.getProjectionObject()||c;f.equals(c)||(a.transform(f,c),d.transform(f,c),e.transform(f,c),b.transform(f,c));return new OpenLayers.Size(OpenLayers.Util.distVincenty(a,d),OpenLayers.Util.distVincenty(e,b))},getViewPortPxFromLayerPx:function(a){var b=
null;if(null!=a)var b=parseInt(this.layerContainerDiv.style.left),c=parseInt(this.layerContainerDiv.style.top),b=a.add(b,c);return b},getLayerPxFromViewPortPx:function(a){var b=null;if(null!=a){var b=-parseInt(this.layerContainerDiv.style.left),c=-parseInt(this.layerContainerDiv.style.top),b=a.add(b,c);if(isNaN(b.x)||isNaN(b.y))b=null}return b},getLonLatFromLayerPx:function(a){a=this.getViewPortPxFromLayerPx(a);return this.getLonLatFromViewPortPx(a)},getLayerPxFromLonLat:function(a){return this.getLayerPxFromViewPortPx(this.getPixelFromLonLat(a))},
CLASS_NAME:"OpenLayers.Map"});OpenLayers.Map.TILE_WIDTH=256;OpenLayers.Map.TILE_HEIGHT=256;OpenLayers.Layer=OpenLayers.Class({id:null,name:null,div:null,opacity:1,alwaysInRange:null,RESOLUTION_PROPERTIES:"scales resolutions maxScale minScale maxResolution minResolution numZoomLevels maxZoomLevel".split(" "),events:null,map:null,isBaseLayer:!1,alpha:!1,displayInLayerSwitcher:!0,visibility:!0,attribution:null,inRange:!1,imageSize:null,options:null,eventListeners:null,gutter:0,projection:null,units:null,scales:null,resolutions:null,maxExtent:null,minExtent:null,maxResolution:null,minResolution:null,
numZoomLevels:null,minScale:null,maxScale:null,displayOutsideMaxExtent:!1,wrapDateLine:!1,metadata:null,initialize:function(a,b){this.metadata={};this.addOptions(b);this.name=a;if(null==this.id&&(this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_"),this.div=OpenLayers.Util.createDiv(this.id),this.div.style.width="100%",this.div.style.height="100%",this.div.dir="ltr",this.events=new OpenLayers.Events(this,this.div),this.eventListeners instanceof Object))this.events.on(this.eventListeners)},
destroy:function(a){null==a&&(a=!0);null!=this.map&&this.map.removeLayer(this,a);this.options=this.div=this.name=this.map=this.projection=null;this.events&&(this.eventListeners&&this.events.un(this.eventListeners),this.events.destroy());this.events=this.eventListeners=null},clone:function(a){null==a&&(a=new OpenLayers.Layer(this.name,this.getOptions()));OpenLayers.Util.applyDefaults(a,this);a.map=null;return a},getOptions:function(){var a={},b;for(b in this.options)a[b]=this[b];return a},setName:function(a){a!=
this.name&&(this.name=a,null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"name"}))},addOptions:function(a,b){null==this.options&&(this.options={});if(a&&("string"==typeof a.projection&&(a.projection=new OpenLayers.Projection(a.projection)),a.projection&&OpenLayers.Util.applyDefaults(a,OpenLayers.Projection.defaults[a.projection.getCode()]),a.maxExtent&&!(a.maxExtent instanceof OpenLayers.Bounds)&&(a.maxExtent=new OpenLayers.Bounds(a.maxExtent)),a.minExtent&&!(a.minExtent instanceof
OpenLayers.Bounds)))a.minExtent=new OpenLayers.Bounds(a.minExtent);OpenLayers.Util.extend(this.options,a);OpenLayers.Util.extend(this,a);this.projection&&this.projection.getUnits()&&(this.units=this.projection.getUnits());if(this.map){var c=this.map.getResolution(),d=this.RESOLUTION_PROPERTIES.concat(["projection","units","minExtent","maxExtent"]),e;for(e in a)if(a.hasOwnProperty(e)&&0<=OpenLayers.Util.indexOf(d,e)){this.initResolutions();b&&this.map.baseLayer===this&&(this.map.setCenter(this.map.getCenter(),
this.map.getZoomForResolution(c),!1,!0),this.map.events.triggerEvent("changebaselayer",{layer:this}));break}}},onMapResize:function(){},redraw:function(){var a=!1;if(this.map){this.inRange=this.calculateInRange();var b=this.getExtent();b&&(this.inRange&&this.visibility)&&(this.moveTo(b,!0,!1),this.events.triggerEvent("moveend",{zoomChanged:!0}),a=!0)}return a},moveTo:function(){var a=this.visibility;this.isBaseLayer||(a=a&&this.inRange);this.display(a)},moveByPx:function(){},setMap:function(a){null==
this.map&&(this.map=a,this.maxExtent=this.maxExtent||this.map.maxExtent,this.minExtent=this.minExtent||this.map.minExtent,this.projection=this.projection||this.map.projection,"string"==typeof this.projection&&(this.projection=new OpenLayers.Projection(this.projection)),this.units=this.projection.getUnits()||this.units||this.map.units,this.initResolutions(),this.isBaseLayer||(this.inRange=this.calculateInRange(),this.div.style.display=this.visibility&&this.inRange?"":"none"),this.setTileSize())},afterAdd:function(){},
removeMap:function(){},getImageSize:function(){return this.imageSize||this.tileSize},setTileSize:function(a){this.tileSize=a=a?a:this.tileSize?this.tileSize:this.map.getTileSize();this.gutter&&(this.imageSize=new OpenLayers.Size(a.w+2*this.gutter,a.h+2*this.gutter))},getVisibility:function(){return this.visibility},setVisibility:function(a){a!=this.visibility&&(this.visibility=a,this.display(a),this.redraw(),null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"visibility"}),
this.events.triggerEvent("visibilitychanged"))},display:function(a){a!=("none"!=this.div.style.display)&&(this.div.style.display=a&&this.calculateInRange()?"block":"none")},calculateInRange:function(){var a=!1;this.alwaysInRange?a=!0:this.map&&(a=this.map.getResolution(),a=a>=this.minResolution&&a<=this.maxResolution);return a},setIsBaseLayer:function(a){a!=this.isBaseLayer&&(this.isBaseLayer=a,null!=this.map&&this.map.events.triggerEvent("changebaselayer",{layer:this}))},initResolutions:function(){var a,
b,c,d={},e=!0;a=0;for(b=this.RESOLUTION_PROPERTIES.length;a<b;a++)c=this.RESOLUTION_PROPERTIES[a],d[c]=this.options[c],e&&this.options[c]&&(e=!1);null==this.alwaysInRange&&(this.alwaysInRange=e);null==d.resolutions&&(d.resolutions=this.resolutionsFromScales(d.scales));null==d.resolutions&&(d.resolutions=this.calculateResolutions(d));if(null==d.resolutions){a=0;for(b=this.RESOLUTION_PROPERTIES.length;a<b;a++)c=this.RESOLUTION_PROPERTIES[a],d[c]=null!=this.options[c]?this.options[c]:this.map[c];null==
d.resolutions&&(d.resolutions=this.resolutionsFromScales(d.scales));null==d.resolutions&&(d.resolutions=this.calculateResolutions(d))}var f;this.options.maxResolution&&"auto"!==this.options.maxResolution&&(f=this.options.maxResolution);this.options.minScale&&(f=OpenLayers.Util.getResolutionFromScale(this.options.minScale,this.units));var g;this.options.minResolution&&"auto"!==this.options.minResolution&&(g=this.options.minResolution);this.options.maxScale&&(g=OpenLayers.Util.getResolutionFromScale(this.options.maxScale,
this.units));d.resolutions&&(d.resolutions.sort(function(a,b){return b-a}),f||(f=d.resolutions[0]),g||(g=d.resolutions[d.resolutions.length-1]));if(this.resolutions=d.resolutions){b=this.resolutions.length;this.scales=Array(b);for(a=0;a<b;a++)this.scales[a]=OpenLayers.Util.getScaleFromResolution(this.resolutions[a],this.units);this.numZoomLevels=b}if(this.minResolution=g)this.maxScale=OpenLayers.Util.getScaleFromResolution(g,this.units);if(this.maxResolution=f)this.minScale=OpenLayers.Util.getScaleFromResolution(f,
this.units)},resolutionsFromScales:function(a){if(null!=a){var b,c,d;d=a.length;b=Array(d);for(c=0;c<d;c++)b[c]=OpenLayers.Util.getResolutionFromScale(a[c],this.units);return b}},calculateResolutions:function(a){var b,c,d=a.maxResolution;null!=a.minScale?d=OpenLayers.Util.getResolutionFromScale(a.minScale,this.units):"auto"==d&&null!=this.maxExtent&&(b=this.map.getSize(),c=this.maxExtent.getWidth()/b.w,b=this.maxExtent.getHeight()/b.h,d=Math.max(c,b));c=a.minResolution;null!=a.maxScale?c=OpenLayers.Util.getResolutionFromScale(a.maxScale,
this.units):"auto"==a.minResolution&&null!=this.minExtent&&(b=this.map.getSize(),c=this.minExtent.getWidth()/b.w,b=this.minExtent.getHeight()/b.h,c=Math.max(c,b));"number"!==typeof d&&("number"!==typeof c&&null!=this.maxExtent)&&(d=this.map.getTileSize(),d=Math.max(this.maxExtent.getWidth()/d.w,this.maxExtent.getHeight()/d.h));b=a.maxZoomLevel;a=a.numZoomLevels;"number"===typeof c&&"number"===typeof d&&void 0===a?a=Math.floor(Math.log(d/c)/Math.log(2))+1:void 0===a&&null!=b&&(a=b+1);if(!("number"!==
typeof a||0>=a||"number"!==typeof d&&"number"!==typeof c)){b=Array(a);var e=2;"number"==typeof c&&"number"==typeof d&&(e=Math.pow(d/c,1/(a-1)));var f;if("number"===typeof d)for(f=0;f<a;f++)b[f]=d/Math.pow(e,f);else for(f=0;f<a;f++)b[a-1-f]=c*Math.pow(e,f);return b}},getResolution:function(){return this.getResolutionForZoom(this.map.getZoom())},getExtent:function(){return this.map.calculateBounds()},getZoomForExtent:function(a,b){var c=this.map.getSize();return this.getZoomForResolution(Math.max(a.getWidth()/
c.w,a.getHeight()/c.h),b)},getDataExtent:function(){},getResolutionForZoom:function(a){a=Math.max(0,Math.min(a,this.resolutions.length-1));if(this.map.fractionalZoom)var b=Math.floor(a),c=Math.ceil(a),a=this.resolutions[b]-(a-b)*(this.resolutions[b]-this.resolutions[c]);else a=this.resolutions[Math.round(a)];return a},getZoomForResolution:function(a,b){var c,d;if(this.map.fractionalZoom){var e=0,f=this.resolutions[e],g=this.resolutions[this.resolutions.length-1],h;c=0;for(d=this.resolutions.length;c<
d;++c)if(h=this.resolutions[c],h>=a&&(f=h,e=c),h<=a){g=h;break}c=f-g;c=0<c?e+(f-a)/c:e}else{f=Number.POSITIVE_INFINITY;c=0;for(d=this.resolutions.length;c<d;c++)if(b){e=Math.abs(this.resolutions[c]-a);if(e>f)break;f=e}else if(this.resolutions[c]<a)break;c=Math.max(0,c-1)}return c},getLonLatFromViewPortPx:function(a){var b=null,c=this.map;if(null!=a&&c.minPx){var b=c.getResolution(),d=c.getMaxExtent({restricted:!0}),b=new OpenLayers.LonLat((a.x-c.minPx.x)*b+d.left,(c.minPx.y-a.y)*b+d.top);this.wrapDateLine&&
(b=b.wrapDateLine(this.maxExtent))}return b},getViewPortPxFromLonLat:function(a,b){var c=null;null!=a&&(b=b||this.map.getResolution(),c=this.map.calculateBounds(null,b),c=new OpenLayers.Pixel(1/b*(a.lon-c.left),1/b*(c.top-a.lat)));return c},setOpacity:function(a){if(a!=this.opacity){this.opacity=a;for(var b=this.div.childNodes,c=0,d=b.length;c<d;++c){var e=b[c].firstChild||b[c],f=b[c].lastChild;f&&"iframe"===f.nodeName.toLowerCase()&&(e=f.parentNode);OpenLayers.Util.modifyDOMElement(e,null,null,null,
null,null,null,a)}null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"})}},getZIndex:function(){return this.div.style.zIndex},setZIndex:function(a){this.div.style.zIndex=a},adjustBounds:function(a){if(this.gutter)var b=this.gutter*this.map.getResolution(),a=new OpenLayers.Bounds(a.left-b,a.bottom-b,a.right+b,a.top+b);this.wrapDateLine&&(b={rightTolerance:this.getResolution(),leftTolerance:this.getResolution()},a=a.wrapDateLine(this.maxExtent,b));return a},CLASS_NAME:"OpenLayers.Layer"});OpenLayers.Layer.SphericalMercator={getExtent:function(){var a=null;return a=this.sphericalMercator?this.map.calculateBounds():OpenLayers.Layer.FixedZoomLevels.prototype.getExtent.apply(this)},getLonLatFromViewPortPx:function(a){return OpenLayers.Layer.prototype.getLonLatFromViewPortPx.apply(this,arguments)},getViewPortPxFromLonLat:function(a){return OpenLayers.Layer.prototype.getViewPortPxFromLonLat.apply(this,arguments)},initMercatorParameters:function(){this.RESOLUTIONS=[];for(var a=0;a<=this.MAX_ZOOM_LEVEL;++a)this.RESOLUTIONS[a]=
156543.03390625/Math.pow(2,a);this.units="m";this.projection=this.projection||"EPSG:900913"},forwardMercator:function(){var a=new OpenLayers.Projection("EPSG:4326"),b=new OpenLayers.Projection("EPSG:900913");return function(c,d){var e=OpenLayers.Projection.transform({x:c,y:d},a,b);return new OpenLayers.LonLat(e.x,e.y)}}(),inverseMercator:function(){var a=new OpenLayers.Projection("EPSG:4326"),b=new OpenLayers.Projection("EPSG:900913");return function(c,d){var e=OpenLayers.Projection.transform({x:c,
y:d},b,a);return new OpenLayers.LonLat(e.x,e.y)}}()};OpenLayers.Layer.EventPane=OpenLayers.Class(OpenLayers.Layer,{smoothDragPan:!0,isBaseLayer:!0,isFixed:!0,pane:null,mapObject:null,initialize:function(a,b){OpenLayers.Layer.prototype.initialize.apply(this,arguments);null==this.pane&&(this.pane=OpenLayers.Util.createDiv(this.div.id+"_EventPane"))},destroy:function(){this.pane=this.mapObject=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},setMap:function(a){OpenLayers.Layer.prototype.setMap.apply(this,arguments);this.pane.style.zIndex=
parseInt(this.div.style.zIndex)+1;this.pane.style.display=this.div.style.display;this.pane.style.width="100%";this.pane.style.height="100%";"msie"==OpenLayers.BROWSER_NAME&&(this.pane.style.background="url("+OpenLayers.Util.getImageLocation("blank.gif")+")");this.isFixed?this.map.viewPortDiv.appendChild(this.pane):this.map.layerContainerDiv.appendChild(this.pane);this.loadMapObject();null==this.mapObject&&this.loadWarningMessage()},removeMap:function(a){this.pane&&this.pane.parentNode&&this.pane.parentNode.removeChild(this.pane);
OpenLayers.Layer.prototype.removeMap.apply(this,arguments)},loadWarningMessage:function(){this.div.style.backgroundColor="darkblue";var a=this.map.getSize(),b=Math.min(a.w,300),c=Math.min(a.h,200),b=new OpenLayers.Size(b,c),a=(new OpenLayers.Pixel(a.w/2,a.h/2)).add(-b.w/2,-b.h/2),a=OpenLayers.Util.createDiv(this.name+"_warning",a,b,null,null,null,"auto");a.style.padding="7px";a.style.backgroundColor="yellow";a.innerHTML=this.getWarningHTML();this.div.appendChild(a)},getWarningHTML:function(){return""},
display:function(a){OpenLayers.Layer.prototype.display.apply(this,arguments);this.pane.style.display=this.div.style.display},setZIndex:function(a){OpenLayers.Layer.prototype.setZIndex.apply(this,arguments);this.pane.style.zIndex=parseInt(this.div.style.zIndex)+1},moveByPx:function(a,b){OpenLayers.Layer.prototype.moveByPx.apply(this,arguments);this.dragPanMapObject?this.dragPanMapObject(a,-b):this.moveTo(this.map.getCachedCenter())},moveTo:function(a,b,c){OpenLayers.Layer.prototype.moveTo.apply(this,
arguments);if(null!=this.mapObject){var d=this.map.getCenter(),e=this.map.getZoom();if(null!=d){var f=this.getOLLonLatFromMapObjectLonLat(this.getMapObjectCenter()),g=this.getOLZoomFromMapObjectZoom(this.getMapObjectZoom());if(!d.equals(f)||e!=g)!b&&f&&this.dragPanMapObject&&this.smoothDragPan?(e=this.map.getViewPortPxFromLonLat(f),d=this.map.getViewPortPxFromLonLat(d),this.dragPanMapObject(d.x-e.x,e.y-d.y)):(d=this.getMapObjectLonLatFromOLLonLat(d),e=this.getMapObjectZoomFromOLZoom(e),this.setMapObjectCenter(d,
e,c))}}},getLonLatFromViewPortPx:function(a){var b=null;null!=this.mapObject&&null!=this.getMapObjectCenter()&&(b=this.getOLLonLatFromMapObjectLonLat(this.getMapObjectLonLatFromMapObjectPixel(this.getMapObjectPixelFromOLPixel(a))));return b},getViewPortPxFromLonLat:function(a){var b=null;null!=this.mapObject&&null!=this.getMapObjectCenter()&&(b=this.getOLPixelFromMapObjectPixel(this.getMapObjectPixelFromMapObjectLonLat(this.getMapObjectLonLatFromOLLonLat(a))));return b},getOLLonLatFromMapObjectLonLat:function(a){var b=
null;null!=a&&(b=this.getLongitudeFromMapObjectLonLat(a),a=this.getLatitudeFromMapObjectLonLat(a),b=new OpenLayers.LonLat(b,a));return b},getMapObjectLonLatFromOLLonLat:function(a){var b=null;null!=a&&(b=this.getMapObjectLonLatFromLonLat(a.lon,a.lat));return b},getOLPixelFromMapObjectPixel:function(a){var b=null;null!=a&&(b=this.getXFromMapObjectPixel(a),a=this.getYFromMapObjectPixel(a),b=new OpenLayers.Pixel(b,a));return b},getMapObjectPixelFromOLPixel:function(a){var b=null;null!=a&&(b=this.getMapObjectPixelFromXY(a.x,
a.y));return b},CLASS_NAME:"OpenLayers.Layer.EventPane"});OpenLayers.Layer.FixedZoomLevels=OpenLayers.Class({initialize:function(){},initResolutions:function(){for(var a=["minZoomLevel","maxZoomLevel","numZoomLevels"],b=0,c=a.length;b<c;b++){var d=a[b];this[d]=null!=this.options[d]?this.options[d]:this.map[d]}if(null==this.minZoomLevel||this.minZoomLevel<this.MIN_ZOOM_LEVEL)this.minZoomLevel=this.MIN_ZOOM_LEVEL;a=this.MAX_ZOOM_LEVEL-this.minZoomLevel+1;b=null==this.options.numZoomLevels&&null!=this.options.maxZoomLevel||null==this.numZoomLevels&&null!=this.maxZoomLevel?
this.maxZoomLevel-this.minZoomLevel+1:this.numZoomLevels;this.numZoomLevels=null!=b?Math.min(b,a):a;this.maxZoomLevel=this.minZoomLevel+this.numZoomLevels-1;if(null!=this.RESOLUTIONS){a=0;this.resolutions=[];for(b=this.minZoomLevel;b<=this.maxZoomLevel;b++)this.resolutions[a++]=this.RESOLUTIONS[b];this.maxResolution=this.resolutions[0];this.minResolution=this.resolutions[this.resolutions.length-1]}},getResolution:function(){if(null!=this.resolutions)return OpenLayers.Layer.prototype.getResolution.apply(this,
arguments);var a=null,b=this.map.getSize(),c=this.getExtent();null!=b&&null!=c&&(a=Math.max(c.getWidth()/b.w,c.getHeight()/b.h));return a},getExtent:function(){var a=this.map.getSize(),b=this.getLonLatFromViewPortPx({x:0,y:0}),a=this.getLonLatFromViewPortPx({x:a.w,y:a.h});return null!=b&&null!=a?new OpenLayers.Bounds(b.lon,a.lat,a.lon,b.lat):null},getZoomForResolution:function(a){return null!=this.resolutions?OpenLayers.Layer.prototype.getZoomForResolution.apply(this,arguments):this.getZoomForExtent(OpenLayers.Layer.prototype.getExtent.apply(this,
[]))},getOLZoomFromMapObjectZoom:function(a){var b=null;null!=a&&(b=a-this.minZoomLevel,this.map.baseLayer!==this&&(b=this.map.baseLayer.getZoomForResolution(this.getResolutionForZoom(b))));return b},getMapObjectZoomFromOLZoom:function(a){var b=null;null!=a&&(b=a+this.minZoomLevel,this.map.baseLayer!==this&&(b=this.getZoomForResolution(this.map.baseLayer.getResolutionForZoom(b))));return b},CLASS_NAME:"OpenLayers.Layer.FixedZoomLevels"});OpenLayers.Layer.Google=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:0,MAX_ZOOM_LEVEL:21,RESOLUTIONS:[1.40625,0.703125,0.3515625,0.17578125,0.087890625,0.0439453125,0.02197265625,0.010986328125,0.0054931640625,0.00274658203125,0.001373291015625,6.866455078125E-4,3.4332275390625E-4,1.71661376953125E-4,8.58306884765625E-5,4.291534423828125E-5,2.145767211914062E-5,1.072883605957031E-5,5.36441802978515E-6,2.68220901489257E-6,1.341104507446289E-6,6.705522537231445E-7],
type:null,wrapDateLine:!0,sphericalMercator:!1,version:null,initialize:function(a,b){b=b||{};b.version||(b.version="function"===typeof GMap2?"2":"3");var c=OpenLayers.Layer.Google["v"+b.version.replace(/\./g,"_")];if(c)OpenLayers.Util.applyDefaults(b,c);else throw"Unsupported Google Maps API version: "+b.version;OpenLayers.Util.applyDefaults(b,c.DEFAULTS);b.maxExtent&&(b.maxExtent=b.maxExtent.clone());OpenLayers.Layer.EventPane.prototype.initialize.apply(this,[a,b]);OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,
[a,b]);this.sphericalMercator&&(OpenLayers.Util.extend(this,OpenLayers.Layer.SphericalMercator),this.initMercatorParameters())},clone:function(){return new OpenLayers.Layer.Google(this.name,this.getOptions())},setVisibility:function(a){var b=null==this.opacity?1:this.opacity;OpenLayers.Layer.EventPane.prototype.setVisibility.apply(this,arguments);this.setOpacity(b)},display:function(a){this._dragging||this.setGMapVisibility(a);OpenLayers.Layer.EventPane.prototype.display.apply(this,arguments)},moveTo:function(a,
b,c){this._dragging=c;OpenLayers.Layer.EventPane.prototype.moveTo.apply(this,arguments);delete this._dragging},setOpacity:function(a){a!==this.opacity&&(null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"}),this.opacity=a);if(this.getVisibility()){var b=this.getMapContainer();OpenLayers.Util.modifyDOMElement(b,null,null,null,null,null,null,a)}},destroy:function(){if(this.map){this.setGMapVisibility(!1);var a=OpenLayers.Layer.Google.cache[this.map.id];a&&1>=a.count&&
this.removeGMapElements()}OpenLayers.Layer.EventPane.prototype.destroy.apply(this,arguments)},removeGMapElements:function(){var a=OpenLayers.Layer.Google.cache[this.map.id];if(a){var b=this.mapObject&&this.getMapContainer();b&&b.parentNode&&b.parentNode.removeChild(b);(b=a.termsOfUse)&&b.parentNode&&b.parentNode.removeChild(b);(a=a.poweredBy)&&a.parentNode&&a.parentNode.removeChild(a)}},removeMap:function(a){this.visibility&&this.mapObject&&this.setGMapVisibility(!1);var b=OpenLayers.Layer.Google.cache[a.id];
b&&(1>=b.count?(this.removeGMapElements(),delete OpenLayers.Layer.Google.cache[a.id]):--b.count);delete this.termsOfUse;delete this.poweredBy;delete this.mapObject;delete this.dragObject;OpenLayers.Layer.EventPane.prototype.removeMap.apply(this,arguments)},getOLBoundsFromMapObjectBounds:function(a){var b=null;null!=a&&(b=a.getSouthWest(),a=a.getNorthEast(),this.sphericalMercator?(b=this.forwardMercator(b.lng(),b.lat()),a=this.forwardMercator(a.lng(),a.lat())):(b=new OpenLayers.LonLat(b.lng(),b.lat()),
a=new OpenLayers.LonLat(a.lng(),a.lat())),b=new OpenLayers.Bounds(b.lon,b.lat,a.lon,a.lat));return b},getWarningHTML:function(){return OpenLayers.i18n("googleWarning")},getMapObjectCenter:function(){return this.mapObject.getCenter()},getMapObjectZoom:function(){return this.mapObject.getZoom()},getLongitudeFromMapObjectLonLat:function(a){return this.sphericalMercator?this.forwardMercator(a.lng(),a.lat()).lon:a.lng()},getLatitudeFromMapObjectLonLat:function(a){return this.sphericalMercator?this.forwardMercator(a.lng(),
a.lat()).lat:a.lat()},getXFromMapObjectPixel:function(a){return a.x},getYFromMapObjectPixel:function(a){return a.y},CLASS_NAME:"OpenLayers.Layer.Google"});OpenLayers.Layer.Google.cache={};
OpenLayers.Layer.Google.v2={termsOfUse:null,poweredBy:null,dragObject:null,loadMapObject:function(){this.type||(this.type=G_NORMAL_MAP);var a,b,c,d=OpenLayers.Layer.Google.cache[this.map.id];if(d)a=d.mapObject,b=d.termsOfUse,c=d.poweredBy,++d.count;else{var d=this.map.viewPortDiv,e=document.createElement("div");e.id=this.map.id+"_GMap2Container";e.style.position="absolute";e.style.width="100%";e.style.height="100%";d.appendChild(e);try{a=new GMap2(e),b=e.lastChild,d.appendChild(b),b.style.zIndex=
"1100",b.style.right="",b.style.bottom="",b.className="olLayerGoogleCopyright",c=e.lastChild,d.appendChild(c),c.style.zIndex="1100",c.style.right="",c.style.bottom="",c.className="olLayerGooglePoweredBy gmnoprint"}catch(f){throw f;}OpenLayers.Layer.Google.cache[this.map.id]={mapObject:a,termsOfUse:b,poweredBy:c,count:1}}this.mapObject=a;this.termsOfUse=b;this.poweredBy=c;-1===OpenLayers.Util.indexOf(this.mapObject.getMapTypes(),this.type)&&this.mapObject.addMapType(this.type);"function"==typeof a.getDragObject?
this.dragObject=a.getDragObject():this.dragPanMapObject=null;!1===this.isBaseLayer&&this.setGMapVisibility("none"!==this.div.style.display)},onMapResize:function(){if(this.visibility&&this.mapObject.isLoaded())this.mapObject.checkResize();else{if(!this._resized)var a=this,b=GEvent.addListener(this.mapObject,"load",function(){GEvent.removeListener(b);delete a._resized;a.mapObject.checkResize();a.moveTo(a.map.getCenter(),a.map.getZoom())});this._resized=!0}},setGMapVisibility:function(a){var b=OpenLayers.Layer.Google.cache[this.map.id];
if(b){var c=this.mapObject.getContainer();!0===a?(this.mapObject.setMapType(this.type),c.style.display="",this.termsOfUse.style.left="",this.termsOfUse.style.display="",this.poweredBy.style.display="",b.displayed=this.id):(b.displayed===this.id&&delete b.displayed,b.displayed||(c.style.display="none",this.termsOfUse.style.display="none",this.termsOfUse.style.left="-9999px",this.poweredBy.style.display="none"))}},getMapContainer:function(){return this.mapObject.getContainer()},getMapObjectBoundsFromOLBounds:function(a){var b=
null;null!=a&&(b=this.sphericalMercator?this.inverseMercator(a.bottom,a.left):new OpenLayers.LonLat(a.bottom,a.left),a=this.sphericalMercator?this.inverseMercator(a.top,a.right):new OpenLayers.LonLat(a.top,a.right),b=new GLatLngBounds(new GLatLng(b.lat,b.lon),new GLatLng(a.lat,a.lon)));return b},setMapObjectCenter:function(a,b){this.mapObject.setCenter(a,b)},dragPanMapObject:function(a,b){this.dragObject.moveBy(new GSize(-a,b))},getMapObjectLonLatFromMapObjectPixel:function(a){return this.mapObject.fromContainerPixelToLatLng(a)},
getMapObjectPixelFromMapObjectLonLat:function(a){return this.mapObject.fromLatLngToContainerPixel(a)},getMapObjectZoomFromMapObjectBounds:function(a){return this.mapObject.getBoundsZoomLevel(a)},getMapObjectLonLatFromLonLat:function(a,b){var c;this.sphericalMercator?(c=this.inverseMercator(a,b),c=new GLatLng(c.lat,c.lon)):c=new GLatLng(b,a);return c},getMapObjectPixelFromXY:function(a,b){return new GPoint(a,b)}};OpenLayers.Format.XML=OpenLayers.Class(OpenLayers.Format,{namespaces:null,namespaceAlias:null,defaultPrefix:null,readers:{},writers:{},xmldom:null,initialize:function(a){window.ActiveXObject&&(this.xmldom=new ActiveXObject("Microsoft.XMLDOM"));OpenLayers.Format.prototype.initialize.apply(this,[a]);this.namespaces=OpenLayers.Util.extend({},this.namespaces);this.namespaceAlias={};for(var b in this.namespaces)this.namespaceAlias[this.namespaces[b]]=b},destroy:function(){this.xmldom=null;OpenLayers.Format.prototype.destroy.apply(this,
arguments)},setNamespace:function(a,b){this.namespaces[a]=b;this.namespaceAlias[b]=a},read:function(a){var b=a.indexOf("<");0<b&&(a=a.substring(b));b=OpenLayers.Util.Try(OpenLayers.Function.bind(function(){var b;b=window.ActiveXObject&&!this.xmldom?new ActiveXObject("Microsoft.XMLDOM"):this.xmldom;b.loadXML(a);return b},this),function(){return(new DOMParser).parseFromString(a,"text/xml")},function(){var b=new XMLHttpRequest;b.open("GET","data:text/xml;charset=utf-8,"+encodeURIComponent(a),!1);b.overrideMimeType&&
b.overrideMimeType("text/xml");b.send(null);return b.responseXML});this.keepData&&(this.data=b);return b},write:function(a){if(this.xmldom)a=a.xml;else{var b=new XMLSerializer;if(1==a.nodeType){var c=document.implementation.createDocument("","",null);c.importNode&&(a=c.importNode(a,!0));c.appendChild(a);a=b.serializeToString(c)}else a=b.serializeToString(a)}return a},createElementNS:function(a,b){return this.xmldom?"string"==typeof a?this.xmldom.createNode(1,b,a):this.xmldom.createNode(1,b,""):document.createElementNS(a,
b)},createTextNode:function(a){"string"!==typeof a&&(a=""+a);return this.xmldom?this.xmldom.createTextNode(a):document.createTextNode(a)},getElementsByTagNameNS:function(a,b,c){var d=[];if(a.getElementsByTagNameNS)d=a.getElementsByTagNameNS(b,c);else for(var a=a.getElementsByTagName("*"),e,f,g=0,h=a.length;g<h;++g)if(e=a[g],f=e.prefix?e.prefix+":"+c:c,"*"==c||f==e.nodeName)("*"==b||b==e.namespaceURI)&&d.push(e);return d},getAttributeNodeNS:function(a,b,c){var d=null;if(a.getAttributeNodeNS)d=a.getAttributeNodeNS(b,
c);else for(var a=a.attributes,e,f,g=0,h=a.length;g<h;++g)if(e=a[g],e.namespaceURI==b&&(f=e.prefix?e.prefix+":"+c:c,f==e.nodeName)){d=e;break}return d},getAttributeNS:function(a,b,c){var d="";if(a.getAttributeNS)d=a.getAttributeNS(b,c)||"";else if(a=this.getAttributeNodeNS(a,b,c))d=a.nodeValue;return d},getChildValue:function(a,b){var c=b||"";if(a)for(var d=a.firstChild;d;d=d.nextSibling)switch(d.nodeType){case 3:case 4:c+=d.nodeValue}return c},isSimpleContent:function(a){for(var b=!0,a=a.firstChild;a;a=
a.nextSibling)if(1===a.nodeType){b=!1;break}return b},contentType:function(a){for(var b=!1,c=!1,d=OpenLayers.Format.XML.CONTENT_TYPE.EMPTY,a=a.firstChild;a;a=a.nextSibling){switch(a.nodeType){case 1:c=!0;break;case 8:break;default:b=!0}if(c&&b)break}if(c&&b)d=OpenLayers.Format.XML.CONTENT_TYPE.MIXED;else{if(c)return OpenLayers.Format.XML.CONTENT_TYPE.COMPLEX;if(b)return OpenLayers.Format.XML.CONTENT_TYPE.SIMPLE}return d},hasAttributeNS:function(a,b,c){var d=!1;return d=a.hasAttributeNS?a.hasAttributeNS(b,
c):!!this.getAttributeNodeNS(a,b,c)},setAttributeNS:function(a,b,c,d){if(a.setAttributeNS)a.setAttributeNS(b,c,d);else if(this.xmldom)b?(b=a.ownerDocument.createNode(2,c,b),b.nodeValue=d,a.setAttributeNode(b)):a.setAttribute(c,d);else throw"setAttributeNS not implemented";},createElementNSPlus:function(a,b){var b=b||{},c=b.uri||this.namespaces[b.prefix];c||(c=a.indexOf(":"),c=this.namespaces[a.substring(0,c)]);c||(c=this.namespaces[this.defaultPrefix]);c=this.createElementNS(c,a);b.attributes&&this.setAttributes(c,
b.attributes);var d=b.value;null!=d&&c.appendChild(this.createTextNode(d));return c},setAttributes:function(a,b){var c,d,e;for(e in b)null!=b[e]&&b[e].toString&&(c=b[e].toString(),d=this.namespaces[e.substring(0,e.indexOf(":"))]||null,this.setAttributeNS(a,d,e,c))},readNode:function(a,b){b||(b={});var c=this.readers[a.namespaceURI?this.namespaceAlias[a.namespaceURI]:this.defaultPrefix];if(c){var d=a.localName||a.nodeName.split(":").pop();(c=c[d]||c["*"])&&c.apply(this,[a,b])}return b},readChildNodes:function(a,
b){b||(b={});for(var c=a.childNodes,d,e=0,f=c.length;e<f;++e)d=c[e],1==d.nodeType&&this.readNode(d,b);return b},writeNode:function(a,b,c){var d,e=a.indexOf(":");0<e?(d=a.substring(0,e),a=a.substring(e+1)):d=c?this.namespaceAlias[c.namespaceURI]:this.defaultPrefix;b=this.writers[d][a].apply(this,[b]);c&&c.appendChild(b);return b},getChildEl:function(a,b,c){return a&&this.getThisOrNextEl(a.firstChild,b,c)},getNextEl:function(a,b,c){return a&&this.getThisOrNextEl(a.nextSibling,b,c)},getThisOrNextEl:function(a,
b,c){a:for(;a;a=a.nextSibling)switch(a.nodeType){case 1:if((!b||b===(a.localName||a.nodeName.split(":").pop()))&&(!c||c===a.namespaceURI))break a;a=null;break a;case 3:if(/^\s*$/.test(a.nodeValue))break;case 4:case 6:case 12:case 10:case 11:a=null;break a}return a||null},lookupNamespaceURI:function(a,b){var c=null;if(a)if(a.lookupNamespaceURI)c=a.lookupNamespaceURI(b);else a:switch(a.nodeType){case 1:if(null!==a.namespaceURI&&a.prefix===b){c=a.namespaceURI;break a}if(c=a.attributes.length)for(var d,
e=0;e<c;++e)if(d=a.attributes[e],"xmlns"===d.prefix&&d.name==="xmlns:"+b){c=d.value||null;break a}else if("xmlns"===d.name&&null===b){c=d.value||null;break a}c=this.lookupNamespaceURI(a.parentNode,b);break a;case 2:c=this.lookupNamespaceURI(a.ownerElement,b);break a;case 9:c=this.lookupNamespaceURI(a.documentElement,b);break a;case 6:case 12:case 10:case 11:break a;default:c=this.lookupNamespaceURI(a.parentNode,b)}return c},getXMLDoc:function(){!OpenLayers.Format.XML.document&&!this.xmldom&&(document.implementation&&
document.implementation.createDocument?OpenLayers.Format.XML.document=document.implementation.createDocument("","",null):!this.xmldom&&window.ActiveXObject&&(this.xmldom=new ActiveXObject("Microsoft.XMLDOM")));return OpenLayers.Format.XML.document||this.xmldom},CLASS_NAME:"OpenLayers.Format.XML"});OpenLayers.Format.XML.CONTENT_TYPE={EMPTY:0,SIMPLE:1,COMPLEX:2,MIXED:3};OpenLayers.Format.XML.lookupNamespaceURI=OpenLayers.Function.bind(OpenLayers.Format.XML.prototype.lookupNamespaceURI,OpenLayers.Format.XML.prototype);
OpenLayers.Format.XML.document=null;OpenLayers.Format.WFST=function(a){var a=OpenLayers.Util.applyDefaults(a,OpenLayers.Format.WFST.DEFAULTS),b=OpenLayers.Format.WFST["v"+a.version.replace(/\./g,"_")];if(!b)throw"Unsupported WFST version: "+a.version;return new b(a)};OpenLayers.Format.WFST.DEFAULTS={version:"1.0.0"};OpenLayers.Format.WFST.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",wfs:"http://www.opengis.net/wfs",gml:"http://www.opengis.net/gml",ogc:"http://www.opengis.net/ogc",ows:"http://www.opengis.net/ows"},defaultPrefix:"wfs",version:null,schemaLocations:null,srsName:null,extractAttributes:!0,xy:!0,stateName:null,initialize:function(a){this.stateName={};this.stateName[OpenLayers.State.INSERT]="wfs:Insert";this.stateName[OpenLayers.State.UPDATE]=
"wfs:Update";this.stateName[OpenLayers.State.DELETE]="wfs:Delete";OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},getSrsName:function(a,b){var c=b&&b.srsName;c||(c=a&&a.layer?a.layer.projection.getCode():this.srsName);return c},read:function(a,b){b=b||{};OpenLayers.Util.applyDefaults(b,{output:"features"});"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&&9==a.nodeType&&(a=a.documentElement);var c={};a&&this.readNode(a,c,!0);c.features&&"features"===b.output&&
(c=c.features);return c},readers:{wfs:{FeatureCollection:function(a,b){b.features=[];this.readChildNodes(a,b)}}},write:function(a,b){var c=this.writeNode("wfs:Transaction",{features:a,options:b}),d=this.schemaLocationAttr();d&&this.setAttributeNS(c,this.namespaces.xsi,"xsi:schemaLocation",d);return OpenLayers.Format.XML.prototype.write.apply(this,[c])},writers:{wfs:{GetFeature:function(a){var b=this.createElementNSPlus("wfs:GetFeature",{attributes:{service:"WFS",version:this.version,handle:a&&a.handle,
outputFormat:a&&a.outputFormat,maxFeatures:a&&a.maxFeatures,"xsi:schemaLocation":this.schemaLocationAttr(a)}});if("string"==typeof this.featureType)this.writeNode("Query",a,b);else for(var c=0,d=this.featureType.length;c<d;c++)a.featureType=this.featureType[c],this.writeNode("Query",a,b);return b},Transaction:function(a){var a=a||{},b=a.options||{},c=this.createElementNSPlus("wfs:Transaction",{attributes:{service:"WFS",version:this.version,handle:b.handle}}),d,e=a.features;if(e){!0===b.multi&&OpenLayers.Util.extend(this.geometryTypes,
{"OpenLayers.Geometry.Point":"MultiPoint","OpenLayers.Geometry.LineString":!0===this.multiCurve?"MultiCurve":"MultiLineString","OpenLayers.Geometry.Polygon":!0===this.multiSurface?"MultiSurface":"MultiPolygon"});var f,g,a=0;for(d=e.length;a<d;++a)g=e[a],(f=this.stateName[g.state])&&this.writeNode(f,{feature:g,options:b},c);!0===b.multi&&this.setGeometryTypes()}if(b.nativeElements){a=0;for(d=b.nativeElements.length;a<d;++a)this.writeNode("wfs:Native",b.nativeElements[a],c)}return c},Native:function(a){return this.createElementNSPlus("wfs:Native",
{attributes:{vendorId:a.vendorId,safeToIgnore:a.safeToIgnore},value:a.value})},Insert:function(a){var b=a.feature,a=a.options,a=this.createElementNSPlus("wfs:Insert",{attributes:{handle:a&&a.handle}});this.srsName=this.getSrsName(b);this.writeNode("feature:_typeName",b,a);return a},Update:function(a){var b=a.feature,a=a.options,a=this.createElementNSPlus("wfs:Update",{attributes:{handle:a&&a.handle,typeName:(this.featureNS?this.featurePrefix+":":"")+this.featureType}});this.featureNS&&a.setAttribute("xmlns:"+
this.featurePrefix,this.featureNS);var c=b.modified;if(null!==this.geometryName&&(!c||void 0!==c.geometry))this.srsName=this.getSrsName(b),this.writeNode("Property",{name:this.geometryName,value:b.geometry},a);for(var d in b.attributes)void 0!==b.attributes[d]&&(!c||!c.attributes||c.attributes&&void 0!==c.attributes[d])&&this.writeNode("Property",{name:d,value:b.attributes[d]},a);this.writeNode("ogc:Filter",new OpenLayers.Filter.FeatureId({fids:[b.fid]}),a);return a},Property:function(a){var b=this.createElementNSPlus("wfs:Property");
this.writeNode("Name",a.name,b);null!==a.value&&this.writeNode("Value",a.value,b);return b},Name:function(a){return this.createElementNSPlus("wfs:Name",{value:a})},Value:function(a){var b;a instanceof OpenLayers.Geometry?(b=this.createElementNSPlus("wfs:Value"),a=this.writeNode("feature:_geometry",a).firstChild,b.appendChild(a)):b=this.createElementNSPlus("wfs:Value",{value:a});return b},Delete:function(a){var b=a.feature,a=a.options,a=this.createElementNSPlus("wfs:Delete",{attributes:{handle:a&&
a.handle,typeName:(this.featureNS?this.featurePrefix+":":"")+this.featureType}});this.featureNS&&a.setAttribute("xmlns:"+this.featurePrefix,this.featureNS);this.writeNode("ogc:Filter",new OpenLayers.Filter.FeatureId({fids:[b.fid]}),a);return a}}},schemaLocationAttr:function(a){var a=OpenLayers.Util.extend({featurePrefix:this.featurePrefix,schema:this.schema},a),b=OpenLayers.Util.extend({},this.schemaLocations);a.schema&&(b[a.featurePrefix]=a.schema);var a=[],c,d;for(d in b)(c=this.namespaces[d])&&
a.push(c+" "+b[d]);return a.join(" ")||void 0},setFilterProperty:function(a){if(a.filters)for(var b=0,c=a.filters.length;b<c;++b)OpenLayers.Format.WFST.v1.prototype.setFilterProperty.call(this,a.filters[b]);else a instanceof OpenLayers.Filter.Spatial&&!a.property&&(a.property=this.geometryName)},CLASS_NAME:"OpenLayers.Format.WFST.v1"});OpenLayers.Format.OGCExceptionReport=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ogc:"http://www.opengis.net/ogc"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},defaultPrefix:"ogc",read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b={exceptionReport:null};a.documentElement&&(this.readChildNodes(a,b),null===b.exceptionReport&&(b=(new OpenLayers.Format.OWSCommon).read(a)));return b},readers:{ogc:{ServiceExceptionReport:function(a,
b){b.exceptionReport={exceptions:[]};this.readChildNodes(a,b.exceptionReport)},ServiceException:function(a,b){var c={code:a.getAttribute("code"),locator:a.getAttribute("locator"),text:this.getChildValue(a)};b.exceptions.push(c)}}},CLASS_NAME:"OpenLayers.Format.OGCExceptionReport"});OpenLayers.Format.XML.VersionedOGC=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:null,version:null,profile:null,errorProperty:null,name:null,stringifyOutput:!1,parser:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);a=this.CLASS_NAME;this.name=a.substring(a.lastIndexOf(".")+1)},getVersion:function(a,b){var c;a?(c=this.version,c||(c=a.getAttribute("version"),c||(c=this.defaultVersion))):c=b&&b.version||this.version||this.defaultVersion;return c},getParser:function(a){var a=
a||this.defaultVersion,b=this.profile?"_"+this.profile:"";if(!this.parser||this.parser.VERSION!=a){var c=OpenLayers.Format[this.name]["v"+a.replace(/\./g,"_")+b];if(!c)throw"Can't find a "+this.name+" parser for version "+a+b;this.parser=new c(this.options)}return this.parser},write:function(a,b){this.parser=this.getParser(this.getVersion(null,b));var c=this.parser.write(a,b);return!1===this.stringifyOutput?c:OpenLayers.Format.XML.prototype.write.apply(this,[c])},read:function(a,b){"string"==typeof a&&
(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var c=this.getVersion(a.documentElement);this.parser=this.getParser(c);var d=this.parser.read(a,b);if(null!==this.errorProperty&&void 0===d[this.errorProperty]){var e=new OpenLayers.Format.OGCExceptionReport;d.error=e.read(a)}d.version=c;return d},CLASS_NAME:"OpenLayers.Format.XML.VersionedOGC"});OpenLayers.Feature=OpenLayers.Class({layer:null,id:null,lonlat:null,data:null,marker:null,popupClass:null,popup:null,initialize:function(a,b,c){this.layer=a;this.lonlat=b;this.data=null!=c?c:{};this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){null!=this.layer&&null!=this.layer.map&&null!=this.popup&&this.layer.map.removePopup(this.popup);null!=this.layer&&null!=this.marker&&this.layer.removeMarker(this.marker);this.data=this.lonlat=this.id=this.layer=null;null!=this.marker&&
(this.destroyMarker(this.marker),this.marker=null);null!=this.popup&&(this.destroyPopup(this.popup),this.popup=null)},onScreen:function(){var a=!1;null!=this.layer&&null!=this.layer.map&&(a=this.layer.map.getExtent().containsLonLat(this.lonlat));return a},createMarker:function(){null!=this.lonlat&&(this.marker=new OpenLayers.Marker(this.lonlat,this.data.icon));return this.marker},destroyMarker:function(){this.marker.destroy()},createPopup:function(a){null!=this.lonlat&&(this.popup||(this.popup=new (this.popupClass?
this.popupClass:OpenLayers.Popup.Anchored)(this.id+"_popup",this.lonlat,this.data.popupSize,this.data.popupContentHTML,this.marker?this.marker.icon:null,a)),null!=this.data.overflow&&(this.popup.contentDiv.style.overflow=this.data.overflow),this.popup.feature=this);return this.popup},destroyPopup:function(){this.popup&&(this.popup.feature=null,this.popup.destroy(),this.popup=null)},CLASS_NAME:"OpenLayers.Feature"});OpenLayers.State={UNKNOWN:"Unknown",INSERT:"Insert",UPDATE:"Update",DELETE:"Delete"};
OpenLayers.Feature.Vector=OpenLayers.Class(OpenLayers.Feature,{fid:null,geometry:null,attributes:null,bounds:null,state:null,style:null,url:null,renderIntent:"default",modified:null,initialize:function(a,b,c){OpenLayers.Feature.prototype.initialize.apply(this,[null,null,b]);this.lonlat=null;this.geometry=a?a:null;this.state=null;this.attributes={};b&&(this.attributes=OpenLayers.Util.extend(this.attributes,b));this.style=c?c:null},destroy:function(){this.layer&&(this.layer.removeFeatures(this),this.layer=
null);this.modified=this.geometry=null;OpenLayers.Feature.prototype.destroy.apply(this,arguments)},clone:function(){return new OpenLayers.Feature.Vector(this.geometry?this.geometry.clone():null,this.attributes,this.style)},onScreen:function(a){var b=!1;this.layer&&this.layer.map&&(b=this.layer.map.getExtent(),a?(a=this.geometry.getBounds(),b=b.intersectsBounds(a)):b=b.toGeometry().intersects(this.geometry));return b},getVisibility:function(){return!(this.style&&"none"==this.style.display||!this.layer||
this.layer&&this.layer.styleMap&&"none"==this.layer.styleMap.createSymbolizer(this,this.renderIntent).display||this.layer&&!this.layer.getVisibility())},createMarker:function(){return null},destroyMarker:function(){},createPopup:function(){return null},atPoint:function(a,b,c){var d=!1;this.geometry&&(d=this.geometry.atPoint(a,b,c));return d},destroyPopup:function(){},move:function(a){if(this.layer&&this.geometry.move){var a="OpenLayers.LonLat"==a.CLASS_NAME?this.layer.getViewPortPxFromLonLat(a):a,
b=this.layer.getViewPortPxFromLonLat(this.geometry.getBounds().getCenterLonLat()),c=this.layer.map.getResolution();this.geometry.move(c*(a.x-b.x),c*(b.y-a.y));this.layer.drawFeature(this);return b}},toState:function(a){if(a==OpenLayers.State.UPDATE)switch(this.state){case OpenLayers.State.UNKNOWN:case OpenLayers.State.DELETE:this.state=a}else if(a==OpenLayers.State.INSERT)switch(this.state){case OpenLayers.State.UNKNOWN:break;default:this.state=a}else if(a==OpenLayers.State.DELETE)switch(this.state){case OpenLayers.State.UNKNOWN:case OpenLayers.State.UPDATE:this.state=
a}else a==OpenLayers.State.UNKNOWN&&(this.state=a)},CLASS_NAME:"OpenLayers.Feature.Vector"});
OpenLayers.Feature.Vector.style={"default":{fillColor:"#ee9900",fillOpacity:0.4,hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"#ee9900",strokeOpacity:1,strokeWidth:1,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},select:{fillColor:"blue",fillOpacity:0.4,
hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"blue",strokeOpacity:1,strokeWidth:2,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"pointer",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},temporary:{fillColor:"#66cccc",fillOpacity:0.2,hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"#66cccc",strokeOpacity:1,
strokeLinecap:"round",strokeWidth:2,strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},"delete":{display:"none"}};OpenLayers.Style=OpenLayers.Class({id:null,name:null,title:null,description:null,layerName:null,isDefault:!1,rules:null,context:null,defaultStyle:null,defaultsPerSymbolizer:!1,propertyStyles:null,initialize:function(a,b){OpenLayers.Util.extend(this,b);this.rules=[];b&&b.rules&&this.addRules(b.rules);this.setDefaultStyle(a||OpenLayers.Feature.Vector.style["default"]);this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var a=0,b=this.rules.length;a<b;a++)this.rules[a].destroy(),
this.rules[a]=null;this.defaultStyle=this.rules=null},createSymbolizer:function(a){for(var b=this.defaultsPerSymbolizer?{}:this.createLiterals(OpenLayers.Util.extend({},this.defaultStyle),a),c=this.rules,d,e=[],f=!1,g=0,h=c.length;g<h;g++)d=c[g],d.evaluate(a)&&(d instanceof OpenLayers.Rule&&d.elseFilter?e.push(d):(f=!0,this.applySymbolizer(d,b,a)));if(!1==f&&0<e.length){f=!0;g=0;for(h=e.length;g<h;g++)this.applySymbolizer(e[g],b,a)}0<c.length&&!1==f&&(b.display="none");null!=b.label&&"string"!==typeof b.label&&
(b.label=""+b.label);return b},applySymbolizer:function(a,b,c){var d=c.geometry?this.getSymbolizerPrefix(c.geometry):OpenLayers.Style.SYMBOLIZER_PREFIXES[0],a=a.symbolizer[d]||a.symbolizer;!0===this.defaultsPerSymbolizer&&(d=this.defaultStyle,OpenLayers.Util.applyDefaults(a,{pointRadius:d.pointRadius}),(!0===a.stroke||!0===a.graphic)&&OpenLayers.Util.applyDefaults(a,{strokeWidth:d.strokeWidth,strokeColor:d.strokeColor,strokeOpacity:d.strokeOpacity,strokeDashstyle:d.strokeDashstyle,strokeLinecap:d.strokeLinecap}),
(!0===a.fill||!0===a.graphic)&&OpenLayers.Util.applyDefaults(a,{fillColor:d.fillColor,fillOpacity:d.fillOpacity}),!0===a.graphic&&OpenLayers.Util.applyDefaults(a,{pointRadius:this.defaultStyle.pointRadius,externalGraphic:this.defaultStyle.externalGraphic,graphicName:this.defaultStyle.graphicName,graphicOpacity:this.defaultStyle.graphicOpacity,graphicWidth:this.defaultStyle.graphicWidth,graphicHeight:this.defaultStyle.graphicHeight,graphicXOffset:this.defaultStyle.graphicXOffset,graphicYOffset:this.defaultStyle.graphicYOffset}));
return this.createLiterals(OpenLayers.Util.extend(b,a),c)},createLiterals:function(a,b){var c=OpenLayers.Util.extend({},b.attributes||b.data);OpenLayers.Util.extend(c,this.context);for(var d in this.propertyStyles)a[d]=OpenLayers.Style.createLiteral(a[d],c,b,d);return a},findPropertyStyles:function(){var a={};this.addPropertyStyles(a,this.defaultStyle);for(var b=this.rules,c,d,e=0,f=b.length;e<f;e++){c=b[e].symbolizer;for(var g in c)if(d=c[g],"object"==typeof d)this.addPropertyStyles(a,d);else{this.addPropertyStyles(a,
c);break}}return a},addPropertyStyles:function(a,b){var c,d;for(d in b)c=b[d],"string"==typeof c&&c.match(/\$\{\w+\}/)&&(a[d]=!0);return a},addRules:function(a){Array.prototype.push.apply(this.rules,a);this.propertyStyles=this.findPropertyStyles()},setDefaultStyle:function(a){this.defaultStyle=a;this.propertyStyles=this.findPropertyStyles()},getSymbolizerPrefix:function(a){for(var b=OpenLayers.Style.SYMBOLIZER_PREFIXES,c=0,d=b.length;c<d;c++)if(-1!=a.CLASS_NAME.indexOf(b[c]))return b[c]},clone:function(){var a=
OpenLayers.Util.extend({},this);if(this.rules){a.rules=[];for(var b=0,c=this.rules.length;b<c;++b)a.rules.push(this.rules[b].clone())}a.context=this.context&&OpenLayers.Util.extend({},this.context);b=OpenLayers.Util.extend({},this.defaultStyle);return new OpenLayers.Style(b,a)},CLASS_NAME:"OpenLayers.Style"});OpenLayers.Style.createLiteral=function(a,b,c,d){"string"==typeof a&&-1!=a.indexOf("${")&&(a=OpenLayers.String.format(a,b,[c,d]),a=isNaN(a)||!a?a:parseFloat(a));return a};
OpenLayers.Style.SYMBOLIZER_PREFIXES=["Point","Line","Polygon","Text","Raster"];OpenLayers.Filter=OpenLayers.Class({initialize:function(a){OpenLayers.Util.extend(this,a)},destroy:function(){},evaluate:function(){return!0},clone:function(){return null},toString:function(){return OpenLayers.Format&&OpenLayers.Format.CQL?OpenLayers.Format.CQL.prototype.write(this):Object.prototype.toString.call(this)},CLASS_NAME:"OpenLayers.Filter"});OpenLayers.Filter.FeatureId=OpenLayers.Class(OpenLayers.Filter,{fids:null,type:"FID",initialize:function(a){this.fids=[];OpenLayers.Filter.prototype.initialize.apply(this,[a])},evaluate:function(a){for(var b=0,c=this.fids.length;b<c;b++)if((a.fid||a.id)==this.fids[b])return!0;return!1},clone:function(){var a=new OpenLayers.Filter.FeatureId;OpenLayers.Util.extend(a,this);a.fids=this.fids.slice();return a},CLASS_NAME:"OpenLayers.Filter.FeatureId"});OpenLayers.Filter.Logical=OpenLayers.Class(OpenLayers.Filter,{filters:null,type:null,initialize:function(a){this.filters=[];OpenLayers.Filter.prototype.initialize.apply(this,[a])},destroy:function(){this.filters=null;OpenLayers.Filter.prototype.destroy.apply(this)},evaluate:function(a){var b,c;switch(this.type){case OpenLayers.Filter.Logical.AND:b=0;for(c=this.filters.length;b<c;b++)if(!1==this.filters[b].evaluate(a))return!1;return!0;case OpenLayers.Filter.Logical.OR:b=0;for(c=this.filters.length;b<
c;b++)if(!0==this.filters[b].evaluate(a))return!0;return!1;case OpenLayers.Filter.Logical.NOT:return!this.filters[0].evaluate(a)}},clone:function(){for(var a=[],b=0,c=this.filters.length;b<c;++b)a.push(this.filters[b].clone());return new OpenLayers.Filter.Logical({type:this.type,filters:a})},CLASS_NAME:"OpenLayers.Filter.Logical"});OpenLayers.Filter.Logical.AND="&&";OpenLayers.Filter.Logical.OR="||";OpenLayers.Filter.Logical.NOT="!";OpenLayers.Filter.Comparison=OpenLayers.Class(OpenLayers.Filter,{type:null,property:null,value:null,matchCase:!0,lowerBoundary:null,upperBoundary:null,initialize:function(a){OpenLayers.Filter.prototype.initialize.apply(this,[a]);this.type===OpenLayers.Filter.Comparison.LIKE&&void 0===a.matchCase&&(this.matchCase=null)},evaluate:function(a){a instanceof OpenLayers.Feature.Vector&&(a=a.attributes);var b=!1,a=a[this.property];switch(this.type){case OpenLayers.Filter.Comparison.EQUAL_TO:b=this.value;
b=!this.matchCase&&"string"==typeof a&&"string"==typeof b?a.toUpperCase()==b.toUpperCase():a==b;break;case OpenLayers.Filter.Comparison.NOT_EQUAL_TO:b=this.value;b=!this.matchCase&&"string"==typeof a&&"string"==typeof b?a.toUpperCase()!=b.toUpperCase():a!=b;break;case OpenLayers.Filter.Comparison.LESS_THAN:b=a<this.value;break;case OpenLayers.Filter.Comparison.GREATER_THAN:b=a>this.value;break;case OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO:b=a<=this.value;break;case OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO:b=
a>=this.value;break;case OpenLayers.Filter.Comparison.BETWEEN:b=a>=this.lowerBoundary&&a<=this.upperBoundary;break;case OpenLayers.Filter.Comparison.LIKE:b=RegExp(this.value,"gi").test(a)}return b},value2regex:function(a,b,c){if("."==a)throw Error("'.' is an unsupported wildCard character for OpenLayers.Filter.Comparison");a=a?a:"*";b=b?b:".";this.value=this.value.replace(RegExp("\\"+(c?c:"!")+"(.|$)","g"),"\\$1");this.value=this.value.replace(RegExp("\\"+b,"g"),".");this.value=this.value.replace(RegExp("\\"+
a,"g"),".*");this.value=this.value.replace(RegExp("\\\\.\\*","g"),"\\"+a);return this.value=this.value.replace(RegExp("\\\\\\.","g"),"\\"+b)},regex2value:function(){var a=this.value,a=a.replace(/!/g,"!!"),a=a.replace(/(\\)?\\\./g,function(a,c){return c?a:"!."}),a=a.replace(/(\\)?\\\*/g,function(a,c){return c?a:"!*"}),a=a.replace(/\\\\/g,"\\");return a=a.replace(/\.\*/g,"*")},clone:function(){return OpenLayers.Util.extend(new OpenLayers.Filter.Comparison,this)},CLASS_NAME:"OpenLayers.Filter.Comparison"});
OpenLayers.Filter.Comparison.EQUAL_TO="==";OpenLayers.Filter.Comparison.NOT_EQUAL_TO="!=";OpenLayers.Filter.Comparison.LESS_THAN="<";OpenLayers.Filter.Comparison.GREATER_THAN=">";OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO="<=";OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO=">=";OpenLayers.Filter.Comparison.BETWEEN="..";OpenLayers.Filter.Comparison.LIKE="~";OpenLayers.Format.Filter=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",CLASS_NAME:"OpenLayers.Format.Filter"});OpenLayers.Filter.Function=OpenLayers.Class(OpenLayers.Filter,{name:null,params:null,CLASS_NAME:"OpenLayers.Filter.Function"});OpenLayers.Format.Filter.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ogc:"http://www.opengis.net/ogc",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"ogc",schemaLocation:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){var b={};this.readers.ogc.Filter.apply(this,[a,b]);return b.filter},readers:{ogc:{_expression:function(a){for(var b="",c=a.firstChild;c;c=
c.nextSibling)switch(c.nodeType){case 1:a=this.readNode(c);a.property?b+="${"+a.property+"}":void 0!==a.value&&(b+=a.value);break;case 3:case 4:b+=c.nodeValue}return b},Filter:function(a,b){var c={fids:[],filters:[]};this.readChildNodes(a,c);0<c.fids.length?b.filter=new OpenLayers.Filter.FeatureId({fids:c.fids}):0<c.filters.length&&(b.filter=c.filters[0])},FeatureId:function(a,b){var c=a.getAttribute("fid");c&&b.fids.push(c)},And:function(a,b){var c=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND});
this.readChildNodes(a,c);b.filters.push(c)},Or:function(a,b){var c=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.OR});this.readChildNodes(a,c);b.filters.push(c)},Not:function(a,b){var c=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.NOT});this.readChildNodes(a,c);b.filters.push(c)},PropertyIsLessThan:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LESS_THAN});this.readChildNodes(a,c);b.filters.push(c)},PropertyIsGreaterThan:function(a,
b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.GREATER_THAN});this.readChildNodes(a,c);b.filters.push(c)},PropertyIsLessThanOrEqualTo:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO});this.readChildNodes(a,c);b.filters.push(c)},PropertyIsGreaterThanOrEqualTo:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO});this.readChildNodes(a,c);b.filters.push(c)},
PropertyIsBetween:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.BETWEEN});this.readChildNodes(a,c);b.filters.push(c)},Literal:function(a,b){b.value=OpenLayers.String.numericIf(this.getChildValue(a))},PropertyName:function(a,b){b.property=this.getChildValue(a)},LowerBoundary:function(a,b){b.lowerBoundary=OpenLayers.String.numericIf(this.readers.ogc._expression.call(this,a))},UpperBoundary:function(a,b){b.upperBoundary=OpenLayers.String.numericIf(this.readers.ogc._expression.call(this,
a))},Intersects:function(a,b){this.readSpatial(a,b,OpenLayers.Filter.Spatial.INTERSECTS)},Within:function(a,b){this.readSpatial(a,b,OpenLayers.Filter.Spatial.WITHIN)},Contains:function(a,b){this.readSpatial(a,b,OpenLayers.Filter.Spatial.CONTAINS)},DWithin:function(a,b){this.readSpatial(a,b,OpenLayers.Filter.Spatial.DWITHIN)},Distance:function(a,b){b.distance=parseInt(this.getChildValue(a));b.distanceUnits=a.getAttribute("units")},Function:function(){}}},readSpatial:function(a,b,c){c=new OpenLayers.Filter.Spatial({type:c});
this.readChildNodes(a,c);c.value=c.components[0];delete c.components;b.filters.push(c)},writeOgcExpression:function(a,b){if(a instanceof OpenLayers.Filter.Function){var c=this.writeNode("Function",a,b);b.appendChild(c)}else this.writeNode("Literal",a,b);return b},write:function(a){return this.writers.ogc.Filter.apply(this,[a])},writeFeatureIdNodes:function(a,b){for(var c=0,d=a.fids.length;c<d;++c)this.writeNode("FeatureId",a.fids[c],b)},writers:{ogc:{Filter:function(a){var b=this.createElementNSPlus("ogc:Filter");
"FID"===a.type?OpenLayers.Format.Filter.v1.prototype.writeFeatureIdNodes.call(this,a,b):this.writeNode(this.getFilterType(a),a,b);return b},FeatureId:function(a){return this.createElementNSPlus("ogc:FeatureId",{attributes:{fid:a}})},And:function(a){for(var b=this.createElementNSPlus("ogc:And"),c,d=0,e=a.filters.length;d<e;++d)c=a.filters[d],"FID"===c.type?OpenLayers.Format.Filter.v1.prototype.writeFeatureIdNodes.call(this,c,b):this.writeNode(this.getFilterType(c),c,b);return b},Or:function(a){for(var b=
this.createElementNSPlus("ogc:Or"),c,d=0,e=a.filters.length;d<e;++d)c=a.filters[d],"FID"===c.type?OpenLayers.Format.Filter.v1.prototype.writeFeatureIdNodes.call(this,c,b):this.writeNode(this.getFilterType(c),c,b);return b},Not:function(a){var b=this.createElementNSPlus("ogc:Not"),a=a.filters[0];"FID"===a.type?OpenLayers.Format.Filter.v1.prototype.writeFeatureIdNodes.call(this,a,b):this.writeNode(this.getFilterType(a),a,b);return b},PropertyIsLessThan:function(a){var b=this.createElementNSPlus("ogc:PropertyIsLessThan");
this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);return b},PropertyIsGreaterThan:function(a){var b=this.createElementNSPlus("ogc:PropertyIsGreaterThan");this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);return b},PropertyIsLessThanOrEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsLessThanOrEqualTo");this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);return b},PropertyIsGreaterThanOrEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsGreaterThanOrEqualTo");
this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);return b},PropertyIsBetween:function(a){var b=this.createElementNSPlus("ogc:PropertyIsBetween");this.writeNode("PropertyName",a,b);this.writeNode("LowerBoundary",a,b);this.writeNode("UpperBoundary",a,b);return b},PropertyName:function(a){return this.createElementNSPlus("ogc:PropertyName",{value:a.property})},Literal:function(a){return this.createElementNSPlus("ogc:Literal",{value:a})},LowerBoundary:function(a){var b=this.createElementNSPlus("ogc:LowerBoundary");
this.writeOgcExpression(a.lowerBoundary,b);return b},UpperBoundary:function(a){var b=this.createElementNSPlus("ogc:UpperBoundary");this.writeNode("Literal",a.upperBoundary,b);return b},INTERSECTS:function(a){return this.writeSpatial(a,"Intersects")},WITHIN:function(a){return this.writeSpatial(a,"Within")},CONTAINS:function(a){return this.writeSpatial(a,"Contains")},DWITHIN:function(a){var b=this.writeSpatial(a,"DWithin");this.writeNode("Distance",a,b);return b},Distance:function(a){return this.createElementNSPlus("ogc:Distance",
{attributes:{units:a.distanceUnits},value:a.distance})},Function:function(a){for(var b=this.createElementNSPlus("ogc:Function",{attributes:{name:a.name}}),a=a.params,c=0,d=a.length;c<d;c++)this.writeOgcExpression(a[c],b);return b}}},getFilterType:function(a){var b=this.filterMap[a.type];if(!b)throw"Filter writing not supported for rule type: "+a.type;return b},filterMap:{"&&":"And","||":"Or","!":"Not","==":"PropertyIsEqualTo","!=":"PropertyIsNotEqualTo","<":"PropertyIsLessThan",">":"PropertyIsGreaterThan",
"<=":"PropertyIsLessThanOrEqualTo",">=":"PropertyIsGreaterThanOrEqualTo","..":"PropertyIsBetween","~":"PropertyIsLike",BBOX:"BBOX",DWITHIN:"DWITHIN",WITHIN:"WITHIN",CONTAINS:"CONTAINS",INTERSECTS:"INTERSECTS",FID:"FeatureId"},CLASS_NAME:"OpenLayers.Format.Filter.v1"});OpenLayers.Geometry=OpenLayers.Class({id:null,parent:null,bounds:null,initialize:function(){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){this.bounds=this.id=null},clone:function(){return new OpenLayers.Geometry},setBounds:function(a){a&&(this.bounds=a.clone())},clearBounds:function(){this.bounds=null;this.parent&&this.parent.clearBounds()},extendBounds:function(a){this.getBounds()?this.bounds.extend(a):this.setBounds(a)},getBounds:function(){null==this.bounds&&this.calculateBounds();
return this.bounds},calculateBounds:function(){},distanceTo:function(){},getVertices:function(){},atPoint:function(a,b,c){var d=!1;null!=this.getBounds()&&null!=a&&(b=null!=b?b:0,c=null!=c?c:0,d=(new OpenLayers.Bounds(this.bounds.left-b,this.bounds.bottom-c,this.bounds.right+b,this.bounds.top+c)).containsLonLat(a));return d},getLength:function(){return 0},getArea:function(){return 0},getCentroid:function(){return null},toString:function(){return OpenLayers.Format&&OpenLayers.Format.WKT?OpenLayers.Format.WKT.prototype.write(new OpenLayers.Feature.Vector(this)):
Object.prototype.toString.call(this)},CLASS_NAME:"OpenLayers.Geometry"});OpenLayers.Geometry.fromWKT=function(a){var b;if(OpenLayers.Format&&OpenLayers.Format.WKT){var c=OpenLayers.Geometry.fromWKT.format;c||(c=new OpenLayers.Format.WKT,OpenLayers.Geometry.fromWKT.format=c);a=c.read(a);if(a instanceof OpenLayers.Feature.Vector)b=a.geometry;else if(OpenLayers.Util.isArray(a)){b=a.length;for(var c=Array(b),d=0;d<b;++d)c[d]=a[d].geometry;b=new OpenLayers.Geometry.Collection(c)}}return b};
OpenLayers.Geometry.segmentsIntersect=function(a,b,c){var d=c&&c.point,c=c&&c.tolerance,e=!1,f=a.x1-b.x1,g=a.y1-b.y1,h=a.x2-a.x1,i=a.y2-a.y1,j=b.y2-b.y1,k=b.x2-b.x1,l=j*h-k*i,j=k*g-j*f,g=h*g-i*f;0==l?0==j&&0==g&&(e=!0):(f=j/l,l=g/l,0<=f&&(1>=f&&0<=l&&1>=l)&&(d?(h=a.x1+f*h,l=a.y1+f*i,e=new OpenLayers.Geometry.Point(h,l)):e=!0));if(c)if(e){if(d){a=[a,b];b=0;a:for(;2>b;++b){f=a[b];for(i=1;3>i;++i)if(h=f["x"+i],l=f["y"+i],d=Math.sqrt(Math.pow(h-e.x,2)+Math.pow(l-e.y,2)),d<c){e.x=h;e.y=l;break a}}}}else{a=
[a,b];b=0;a:for(;2>b;++b){h=a[b];l=a[(b+1)%2];for(i=1;3>i;++i)if(f={x:h["x"+i],y:h["y"+i]},g=OpenLayers.Geometry.distanceToSegment(f,l),g.distance<c){e=d?new OpenLayers.Geometry.Point(f.x,f.y):!0;break a}}}return e};OpenLayers.Geometry.distanceToSegment=function(a,b){var c=a.x,d=a.y,e=b.x1,f=b.y1,g=b.x2,h=b.y2,i=g-e,j=h-f,k=(i*(c-e)+j*(d-f))/(Math.pow(i,2)+Math.pow(j,2));0>=k||(1<=k?(e=g,f=h):(e+=k*i,f+=k*j));return{distance:Math.sqrt(Math.pow(e-c,2)+Math.pow(f-d,2)),x:e,y:f}};OpenLayers.Geometry.Point=OpenLayers.Class(OpenLayers.Geometry,{x:null,y:null,initialize:function(a,b){OpenLayers.Geometry.prototype.initialize.apply(this,arguments);this.x=parseFloat(a);this.y=parseFloat(b)},clone:function(a){null==a&&(a=new OpenLayers.Geometry.Point(this.x,this.y));OpenLayers.Util.applyDefaults(a,this);return a},calculateBounds:function(){this.bounds=new OpenLayers.Bounds(this.x,this.y,this.x,this.y)},distanceTo:function(a,b){var c=!(b&&!1===b.edge)&&b&&b.details,d,e,f,g,h;a instanceof
OpenLayers.Geometry.Point?(e=this.x,f=this.y,g=a.x,h=a.y,d=Math.sqrt(Math.pow(e-g,2)+Math.pow(f-h,2)),d=!c?d:{x0:e,y0:f,x1:g,y1:h,distance:d}):(d=a.distanceTo(this,b),c&&(d={x0:d.x1,y0:d.y1,x1:d.x0,y1:d.y0,distance:d.distance}));return d},equals:function(a){var b=!1;null!=a&&(b=this.x==a.x&&this.y==a.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(a.x)&&isNaN(a.y));return b},toShortString:function(){return this.x+", "+this.y},move:function(a,b){this.x+=a;this.y+=b;this.clearBounds()},rotate:function(a,b){var a=
a*(Math.PI/180),c=this.distanceTo(b),d=a+Math.atan2(this.y-b.y,this.x-b.x);this.x=b.x+c*Math.cos(d);this.y=b.y+c*Math.sin(d);this.clearBounds()},getCentroid:function(){return new OpenLayers.Geometry.Point(this.x,this.y)},resize:function(a,b,c){this.x=b.x+a*(void 0==c?1:c)*(this.x-b.x);this.y=b.y+a*(this.y-b.y);this.clearBounds();return this},intersects:function(a){var b=!1;return b="OpenLayers.Geometry.Point"==a.CLASS_NAME?this.equals(a):a.intersects(this)},transform:function(a,b){a&&b&&(OpenLayers.Projection.transform(this,
a,b),this.bounds=null);return this},getVertices:function(){return[this]},CLASS_NAME:"OpenLayers.Geometry.Point"});OpenLayers.Geometry.Collection=OpenLayers.Class(OpenLayers.Geometry,{components:null,componentTypes:null,initialize:function(a){OpenLayers.Geometry.prototype.initialize.apply(this,arguments);this.components=[];null!=a&&this.addComponents(a)},destroy:function(){this.components.length=0;this.components=null;OpenLayers.Geometry.prototype.destroy.apply(this,arguments)},clone:function(){for(var a=eval("new "+this.CLASS_NAME+"()"),b=0,c=this.components.length;b<c;b++)a.addComponent(this.components[b].clone());
OpenLayers.Util.applyDefaults(a,this);return a},getComponentsString:function(){for(var a=[],b=0,c=this.components.length;b<c;b++)a.push(this.components[b].toShortString());return a.join(",")},calculateBounds:function(){this.bounds=null;var a=new OpenLayers.Bounds,b=this.components;if(b)for(var c=0,d=b.length;c<d;c++)a.extend(b[c].getBounds());null!=a.left&&(null!=a.bottom&&null!=a.right&&null!=a.top)&&this.setBounds(a)},addComponents:function(a){OpenLayers.Util.isArray(a)||(a=[a]);for(var b=0,c=a.length;b<
c;b++)this.addComponent(a[b])},addComponent:function(a,b){var c=!1;if(a&&(null==this.componentTypes||-1<OpenLayers.Util.indexOf(this.componentTypes,a.CLASS_NAME))){if(null!=b&&b<this.components.length){var c=this.components.slice(0,b),d=this.components.slice(b,this.components.length);c.push(a);this.components=c.concat(d)}else this.components.push(a);a.parent=this;this.clearBounds();c=!0}return c},removeComponents:function(a){var b=!1;OpenLayers.Util.isArray(a)||(a=[a]);for(var c=a.length-1;0<=c;--c)b=
this.removeComponent(a[c])||b;return b},removeComponent:function(a){OpenLayers.Util.removeItem(this.components,a);this.clearBounds();return!0},getLength:function(){for(var a=0,b=0,c=this.components.length;b<c;b++)a+=this.components[b].getLength();return a},getArea:function(){for(var a=0,b=0,c=this.components.length;b<c;b++)a+=this.components[b].getArea();return a},getGeodesicArea:function(a){for(var b=0,c=0,d=this.components.length;c<d;c++)b+=this.components[c].getGeodesicArea(a);return b},getCentroid:function(a){if(!a)return this.components.length&&
this.components[0].getCentroid();a=this.components.length;if(!a)return!1;for(var b=[],c=[],d=0,e=Number.MAX_VALUE,f,g=0;g<a;++g){f=this.components[g];var h=f.getArea();f=f.getCentroid(!0);!isNaN(h)&&(!isNaN(f.x)&&!isNaN(f.y))&&(b.push(h),d+=h,e=h<e&&0<h?h:e,c.push(f))}a=b.length;if(0===d){for(g=0;g<a;++g)b[g]=1;d=b.length}else{for(g=0;g<a;++g)b[g]/=e;d/=e}for(var i=e=0,g=0;g<a;++g)f=c[g],h=b[g],e+=f.x*h,i+=f.y*h;return new OpenLayers.Geometry.Point(e/d,i/d)},getGeodesicLength:function(a){for(var b=
0,c=0,d=this.components.length;c<d;c++)b+=this.components[c].getGeodesicLength(a);return b},move:function(a,b){for(var c=0,d=this.components.length;c<d;c++)this.components[c].move(a,b)},rotate:function(a,b){for(var c=0,d=this.components.length;c<d;++c)this.components[c].rotate(a,b)},resize:function(a,b,c){for(var d=0;d<this.components.length;++d)this.components[d].resize(a,b,c);return this},distanceTo:function(a,b){for(var c=!(b&&!1===b.edge)&&b&&b.details,d,e,f,g=Number.POSITIVE_INFINITY,h=0,i=this.components.length;h<
i&&!(d=this.components[h].distanceTo(a,b),f=c?d.distance:d,f<g&&(g=f,e=d,0==g));++h);return e},equals:function(a){var b=!0;if(!a||!a.CLASS_NAME||this.CLASS_NAME!=a.CLASS_NAME)b=!1;else if(!OpenLayers.Util.isArray(a.components)||a.components.length!=this.components.length)b=!1;else for(var c=0,d=this.components.length;c<d;++c)if(!this.components[c].equals(a.components[c])){b=!1;break}return b},transform:function(a,b){if(a&&b){for(var c=0,d=this.components.length;c<d;c++)this.components[c].transform(a,
b);this.bounds=null}return this},intersects:function(a){for(var b=!1,c=0,d=this.components.length;c<d&&!(b=a.intersects(this.components[c]));++c);return b},getVertices:function(a){for(var b=[],c=0,d=this.components.length;c<d;++c)Array.prototype.push.apply(b,this.components[c].getVertices(a));return b},CLASS_NAME:"OpenLayers.Geometry.Collection"});OpenLayers.Geometry.MultiPoint=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Point"],addPoint:function(a,b){this.addComponent(a,b)},removePoint:function(a){this.removeComponent(a)},CLASS_NAME:"OpenLayers.Geometry.MultiPoint"});OpenLayers.Geometry.Curve=OpenLayers.Class(OpenLayers.Geometry.MultiPoint,{componentTypes:["OpenLayers.Geometry.Point"],getLength:function(){var a=0;if(this.components&&1<this.components.length)for(var b=1,c=this.components.length;b<c;b++)a+=this.components[b-1].distanceTo(this.components[b]);return a},getGeodesicLength:function(a){var b=this;if(a){var c=new OpenLayers.Projection("EPSG:4326");c.equals(a)||(b=this.clone().transform(a,c))}a=0;if(b.components&&1<b.components.length)for(var d,e=1,f=b.components.length;e<
f;e++)c=b.components[e-1],d=b.components[e],a+=OpenLayers.Util.distVincenty({lon:c.x,lat:c.y},{lon:d.x,lat:d.y});return 1E3*a},CLASS_NAME:"OpenLayers.Geometry.Curve"});OpenLayers.Geometry.LineString=OpenLayers.Class(OpenLayers.Geometry.Curve,{removeComponent:function(a){var b=this.components&&2<this.components.length;b&&OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,arguments);return b},intersects:function(a){var b=!1,c=a.CLASS_NAME;if("OpenLayers.Geometry.LineString"==c||"OpenLayers.Geometry.LinearRing"==c||"OpenLayers.Geometry.Point"==c){var d=this.getSortedSegments(),a="OpenLayers.Geometry.Point"==c?[{x1:a.x,y1:a.y,x2:a.x,y2:a.y}]:a.getSortedSegments(),
e,f,g,h,i,j,k,l=0,m=d.length;a:for(;l<m;++l){c=d[l];e=c.x1;f=c.x2;g=c.y1;h=c.y2;var n=0,o=a.length;for(;n<o;++n){i=a[n];if(i.x1>f)break;if(!(i.x2<e)&&(j=i.y1,k=i.y2,!(Math.min(j,k)>Math.max(g,h))&&!(Math.max(j,k)<Math.min(g,h))&&OpenLayers.Geometry.segmentsIntersect(c,i))){b=!0;break a}}}}else b=a.intersects(this);return b},getSortedSegments:function(){for(var a=this.components.length-1,b=Array(a),c,d,e=0;e<a;++e)c=this.components[e],d=this.components[e+1],b[e]=c.x<d.x?{x1:c.x,y1:c.y,x2:d.x,y2:d.y}:
{x1:d.x,y1:d.y,x2:c.x,y2:c.y};return b.sort(function(a,b){return a.x1-b.x1})},splitWithSegment:function(a,b){for(var c=!(b&&!1===b.edge),d=b&&b.tolerance,e=[],f=this.getVertices(),g=[],h=[],i=!1,j,k,l,m={point:!0,tolerance:d},n=null,o=0,p=f.length-2;o<=p;++o)if(d=f[o],g.push(d.clone()),j=f[o+1],k={x1:d.x,y1:d.y,x2:j.x,y2:j.y},k=OpenLayers.Geometry.segmentsIntersect(a,k,m),k instanceof OpenLayers.Geometry.Point&&((l=k.x===a.x1&&k.y===a.y1||k.x===a.x2&&k.y===a.y2||k.equals(d)||k.equals(j)?!0:!1)||c))k.equals(h[h.length-
1])||h.push(k.clone()),!(0===o&&k.equals(d))&&!k.equals(j)&&(i=!0,k.equals(d)||g.push(k),e.push(new OpenLayers.Geometry.LineString(g)),g=[k.clone()]);i&&(g.push(j.clone()),e.push(new OpenLayers.Geometry.LineString(g)));if(0<h.length)var q=a.x1<a.x2?1:-1,r=a.y1<a.y2?1:-1,n={lines:e,points:h.sort(function(a,b){return q*a.x-q*b.x||r*a.y-r*b.y})};return n},split:function(a,b){var c=null,d=b&&b.mutual,e,f,g,h;if(a instanceof OpenLayers.Geometry.LineString){var i=this.getVertices(),j,k,l,m,n,o=[];g=[];
for(var p=0,q=i.length-2;p<=q;++p){j=i[p];k=i[p+1];l={x1:j.x,y1:j.y,x2:k.x,y2:k.y};h=h||[a];d&&o.push(j.clone());for(var r=0;r<h.length;++r)if(m=h[r].splitWithSegment(l,b))if(n=m.lines,0<n.length&&(n.unshift(r,1),Array.prototype.splice.apply(h,n),r+=n.length-2),d)for(var s=0,t=m.points.length;s<t;++s)n=m.points[s],n.equals(j)||(o.push(n),g.push(new OpenLayers.Geometry.LineString(o)),o=n.equals(k)?[]:[n.clone()])}d&&(0<g.length&&0<o.length)&&(o.push(k.clone()),g.push(new OpenLayers.Geometry.LineString(o)))}else c=
a.splitWith(this,b);h&&1<h.length?f=!0:h=[];g&&1<g.length?e=!0:g=[];if(f||e)c=d?[g,h]:h;return c},splitWith:function(a,b){return a.split(this,b)},getVertices:function(a){return!0===a?[this.components[0],this.components[this.components.length-1]]:!1===a?this.components.slice(1,this.components.length-1):this.components.slice()},distanceTo:function(a,b){var c=!(b&&!1===b.edge)&&b&&b.details,d,e={},f=Number.POSITIVE_INFINITY;if(a instanceof OpenLayers.Geometry.Point){for(var g=this.getSortedSegments(),
h=a.x,i=a.y,j,k=0,l=g.length;k<l;++k)if(j=g[k],d=OpenLayers.Geometry.distanceToSegment(a,j),d.distance<f){if(f=d.distance,e=d,0===f)break}else if(j.x2>h&&(i>j.y1&&i<j.y2||i<j.y1&&i>j.y2))break;e=c?{distance:e.distance,x0:e.x,y0:e.y,x1:h,y1:i}:e.distance}else if(a instanceof OpenLayers.Geometry.LineString){var g=this.getSortedSegments(),h=a.getSortedSegments(),m,n,o=h.length,p={point:!0},k=0,l=g.length;a:for(;k<l;++k){i=g[k];j=i.x1;n=i.y1;for(var q=0;q<o;++q)if(d=h[q],m=OpenLayers.Geometry.segmentsIntersect(i,
d,p)){f=0;e={distance:0,x0:m.x,y0:m.y,x1:m.x,y1:m.y};break a}else d=OpenLayers.Geometry.distanceToSegment({x:j,y:n},d),d.distance<f&&(f=d.distance,e={distance:f,x0:j,y0:n,x1:d.x,y1:d.y})}c||(e=e.distance);0!==f&&i&&(d=a.distanceTo(new OpenLayers.Geometry.Point(i.x2,i.y2),b),k=c?d.distance:d,k<f&&(e=c?{distance:f,x0:d.x1,y0:d.y1,x1:d.x0,y1:d.y0}:k))}else e=a.distanceTo(this,b),c&&(e={distance:e.distance,x0:e.x1,y0:e.y1,x1:e.x0,y1:e.y0});return e},simplify:function(a){if(this&&null!==this){var b=this.getVertices();
if(3>b.length)return this;var c=function(a,b,d,i){for(var j=0,k=0,l=b,m;l<d;l++){m=a[b];var n=a[d],o=a[l],o=Math.abs(0.5*(m.x*n.y+n.x*o.y+o.x*m.y-n.x*m.y-o.x*n.y-m.x*o.y));m=Math.sqrt(Math.pow(m.x-n.x,2)+Math.pow(m.y-n.y,2));m=2*(o/m);m>j&&(j=m,k=l)}j>i&&k!=b&&(e.push(k),c(a,b,k,i),c(a,k,d,i))},d=b.length-1,e=[];e.push(0);for(e.push(d);b[0].equals(b[d]);)d--,e.push(d);c(b,0,d,a);a=[];e.sort(function(a,b){return a-b});for(d=0;d<e.length;d++)a.push(b[e[d]]);return new OpenLayers.Geometry.LineString(a)}return this},
CLASS_NAME:"OpenLayers.Geometry.LineString"});OpenLayers.Geometry.MultiLineString=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LineString"],split:function(a,b){for(var c=null,d=b&&b.mutual,e,f,g,h,i=[],j=[a],k=0,l=this.components.length;k<l;++k){f=this.components[k];g=!1;for(var m=0;m<j.length;++m)if(e=f.split(j[m],b)){if(d){g=e[0];for(var n=0,o=g.length;n<o;++n)0===n&&i.length?i[i.length-1].addComponent(g[n]):i.push(new OpenLayers.Geometry.MultiLineString([g[n]]));g=!0;e=e[1]}if(e.length){e.unshift(m,
1);Array.prototype.splice.apply(j,e);break}}g||(i.length?i[i.length-1].addComponent(f.clone()):i=[new OpenLayers.Geometry.MultiLineString(f.clone())])}i&&1<i.length?g=!0:i=[];j&&1<j.length?h=!0:j=[];if(g||h)c=d?[i,j]:j;return c},splitWith:function(a,b){var c=null,d=b&&b.mutual,e,f,g,h,i,j;if(a instanceof OpenLayers.Geometry.LineString){j=[];i=[a];for(var k=0,l=this.components.length;k<l;++k){g=!1;f=this.components[k];for(var m=0;m<i.length;++m)if(e=i[m].split(f,b)){d&&(g=e[0],g.length&&(g.unshift(m,
1),Array.prototype.splice.apply(i,g),m+=g.length-2),e=e[1],0===e.length&&(e=[f.clone()]));g=0;for(var n=e.length;g<n;++g)0===g&&j.length?j[j.length-1].addComponent(e[g]):j.push(new OpenLayers.Geometry.MultiLineString([e[g]]));g=!0}g||(j.length?j[j.length-1].addComponent(f.clone()):j=[new OpenLayers.Geometry.MultiLineString([f.clone()])])}}else c=a.split(this);i&&1<i.length?h=!0:i=[];j&&1<j.length?g=!0:j=[];if(h||g)c=d?[i,j]:j;return c},CLASS_NAME:"OpenLayers.Geometry.MultiLineString"});OpenLayers.Geometry.LinearRing=OpenLayers.Class(OpenLayers.Geometry.LineString,{componentTypes:["OpenLayers.Geometry.Point"],addComponent:function(a,b){var c=!1,d=this.components.pop();if(null!=b||!a.equals(d))c=OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,arguments);OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[this.components[0]]);return c},removeComponent:function(a){var b=this.components&&3<this.components.length;b&&(this.components.pop(),OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,
arguments),OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[this.components[0]]));return b},move:function(a,b){for(var c=0,d=this.components.length;c<d-1;c++)this.components[c].move(a,b)},rotate:function(a,b){for(var c=0,d=this.components.length;c<d-1;++c)this.components[c].rotate(a,b)},resize:function(a,b,c){for(var d=0,e=this.components.length;d<e-1;++d)this.components[d].resize(a,b,c);return this},transform:function(a,b){if(a&&b){for(var c=0,d=this.components.length;c<d-1;c++)this.components[c].transform(a,
b);this.bounds=null}return this},getCentroid:function(){if(this.components&&2<this.components.length){for(var a=0,b=0,c=0;c<this.components.length-1;c++)var d=this.components[c],e=this.components[c+1],a=a+(d.x+e.x)*(d.x*e.y-e.x*d.y),b=b+(d.y+e.y)*(d.x*e.y-e.x*d.y);c=-1*this.getArea();return new OpenLayers.Geometry.Point(a/(6*c),b/(6*c))}return null},getArea:function(){var a=0;if(this.components&&2<this.components.length){for(var b=a=0,c=this.components.length;b<c-1;b++)var d=this.components[b],e=
this.components[b+1],a=a+(d.x+e.x)*(e.y-d.y);a=-a/2}return a},getGeodesicArea:function(a){var b=this;if(a){var c=new OpenLayers.Projection("EPSG:4326");c.equals(a)||(b=this.clone().transform(a,c))}a=0;c=b.components&&b.components.length;if(2<c){for(var d,e,f=0;f<c-1;f++)d=b.components[f],e=b.components[f+1],a+=OpenLayers.Util.rad(e.x-d.x)*(2+Math.sin(OpenLayers.Util.rad(d.y))+Math.sin(OpenLayers.Util.rad(e.y)));a=40680631590769*a/2}return a},containsPoint:function(a){for(var b=OpenLayers.Number.limitSigDigs,
c=b(a.x,14),a=b(a.y,14),d=this.components.length-1,e,f,g,h,i,j=0,k=0;k<d;++k)if(e=this.components[k],g=b(e.x,14),e=b(e.y,14),f=this.components[k+1],h=b(f.x,14),f=b(f.y,14),e==f){if(a==e&&(g<=h&&c>=g&&c<=h||g>=h&&c<=g&&c>=h)){j=-1;break}}else{i=b((a-f)*((h-g)/(f-e))+h,14);if(i==c&&(e<f&&a>=e&&a<=f||e>f&&a<=e&&a>=f)){j=-1;break}i<=c||g!=h&&(i<Math.min(g,h)||i>Math.max(g,h))||(e<f&&a>=e&&a<f||e>f&&a<e&&a>=f)&&++j}return-1==j?1:!!(j&1)},intersects:function(a){var b=!1;if("OpenLayers.Geometry.Point"==
a.CLASS_NAME)b=this.containsPoint(a);else if("OpenLayers.Geometry.LineString"==a.CLASS_NAME)b=a.intersects(this);else if("OpenLayers.Geometry.LinearRing"==a.CLASS_NAME)b=OpenLayers.Geometry.LineString.prototype.intersects.apply(this,[a]);else for(var c=0,d=a.components.length;c<d&&!(b=a.components[c].intersects(this));++c);return b},getVertices:function(a){return!0===a?[]:this.components.slice(0,this.components.length-1)},CLASS_NAME:"OpenLayers.Geometry.LinearRing"});OpenLayers.Geometry.Polygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LinearRing"],getArea:function(){var a=0;if(this.components&&0<this.components.length)for(var a=a+Math.abs(this.components[0].getArea()),b=1,c=this.components.length;b<c;b++)a-=Math.abs(this.components[b].getArea());return a},getGeodesicArea:function(a){var b=0;if(this.components&&0<this.components.length)for(var b=b+Math.abs(this.components[0].getGeodesicArea(a)),c=1,d=this.components.length;c<
d;c++)b-=Math.abs(this.components[c].getGeodesicArea(a));return b},containsPoint:function(a){var b=this.components.length,c=!1;if(0<b&&(c=this.components[0].containsPoint(a),1!==c&&c&&1<b))for(var d,e=1;e<b;++e)if(d=this.components[e].containsPoint(a)){c=1===d?1:!1;break}return c},intersects:function(a){var b=!1,c,d;if("OpenLayers.Geometry.Point"==a.CLASS_NAME)b=this.containsPoint(a);else if("OpenLayers.Geometry.LineString"==a.CLASS_NAME||"OpenLayers.Geometry.LinearRing"==a.CLASS_NAME){c=0;for(d=
this.components.length;c<d&&!(b=a.intersects(this.components[c]));++c);if(!b){c=0;for(d=a.components.length;c<d&&!(b=this.containsPoint(a.components[c]));++c);}}else{c=0;for(d=a.components.length;c<d&&!(b=this.intersects(a.components[c]));++c);}if(!b&&"OpenLayers.Geometry.Polygon"==a.CLASS_NAME){var e=this.components[0];c=0;for(d=e.components.length;c<d&&!(b=a.containsPoint(e.components[c]));++c);}return b},distanceTo:function(a,b){return b&&!1===b.edge&&this.intersects(a)?0:OpenLayers.Geometry.Collection.prototype.distanceTo.apply(this,
[a,b])},CLASS_NAME:"OpenLayers.Geometry.Polygon"});OpenLayers.Geometry.Polygon.createRegularPolygon=function(a,b,c,d){var e=Math.PI*(1/c-0.5);d&&(e+=d/180*Math.PI);for(var f,g=[],h=0;h<c;++h)f=e+2*h*Math.PI/c,d=a.x+b*Math.cos(f),f=a.y+b*Math.sin(f),g.push(new OpenLayers.Geometry.Point(d,f));a=new OpenLayers.Geometry.LinearRing(g);return new OpenLayers.Geometry.Polygon([a])};OpenLayers.Geometry.MultiPolygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Polygon"],CLASS_NAME:"OpenLayers.Geometry.MultiPolygon"});OpenLayers.Format.GML=OpenLayers.Class(OpenLayers.Format.XML,{featureNS:"http://mapserver.gis.umn.edu/mapserver",featurePrefix:"feature",featureName:"featureMember",layerName:"features",geometryName:"geometry",collectionName:"FeatureCollection",gmlns:"http://www.opengis.net/gml",extractAttributes:!0,xy:!0,initialize:function(a){this.regExes={trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g};OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){"string"==
typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));for(var a=this.getElementsByTagNameNS(a.documentElement,this.gmlns,this.featureName),b=[],c=0;c<a.length;c++){var d=this.parseFeature(a[c]);d&&b.push(d)}return b},parseFeature:function(a){for(var b="MultiPolygon Polygon MultiLineString LineString MultiPoint Point Envelope".split(" "),c,d,e,f=0;f<b.length;++f)if(c=b[f],d=this.getElementsByTagNameNS(a,this.gmlns,c),0<d.length){if(e=this.parseGeometry[c.toLowerCase()])e=e.apply(this,
[d[0]]),this.internalProjection&&this.externalProjection&&e.transform(this.externalProjection,this.internalProjection);else throw new TypeError("Unsupported geometry type: "+c);break}var g;c=this.getElementsByTagNameNS(a,this.gmlns,"Box");for(f=0;f<c.length;++f)b=c[f],d=this.parseGeometry.box.apply(this,[b]),b=b.parentNode,"boundedBy"===(b.localName||b.nodeName.split(":").pop())?g=d:e=d.toGeometry();var h;this.extractAttributes&&(h=this.parseAttributes(a));h=new OpenLayers.Feature.Vector(e,h);h.bounds=
g;h.gml={featureType:a.firstChild.nodeName.split(":")[1],featureNS:a.firstChild.namespaceURI,featureNSPrefix:a.firstChild.prefix};for(var a=a.firstChild,i;a&&!(1==a.nodeType&&(i=a.getAttribute("fid")||a.getAttribute("id")));)a=a.nextSibling;h.fid=i;return h},parseGeometry:{point:function(a){var b,c;c=[];b=this.getElementsByTagNameNS(a,this.gmlns,"pos");0<b.length&&(c=b[0].firstChild.nodeValue,c=c.replace(this.regExes.trimSpace,""),c=c.split(this.regExes.splitSpace));0==c.length&&(b=this.getElementsByTagNameNS(a,
this.gmlns,"coordinates"),0<b.length&&(c=b[0].firstChild.nodeValue,c=c.replace(this.regExes.removeSpace,""),c=c.split(",")));0==c.length&&(b=this.getElementsByTagNameNS(a,this.gmlns,"coord"),0<b.length&&(a=this.getElementsByTagNameNS(b[0],this.gmlns,"X"),b=this.getElementsByTagNameNS(b[0],this.gmlns,"Y"),0<a.length&&0<b.length&&(c=[a[0].firstChild.nodeValue,b[0].firstChild.nodeValue])));2==c.length&&(c[2]=null);return this.xy?new OpenLayers.Geometry.Point(c[0],c[1],c[2]):new OpenLayers.Geometry.Point(c[1],
c[0],c[2])},multipoint:function(a){var a=this.getElementsByTagNameNS(a,this.gmlns,"Point"),b=[];if(0<a.length)for(var c,d=0;d<a.length;++d)(c=this.parseGeometry.point.apply(this,[a[d]]))&&b.push(c);return new OpenLayers.Geometry.MultiPoint(b)},linestring:function(a,b){var c,d;d=[];var e=[];c=this.getElementsByTagNameNS(a,this.gmlns,"posList");if(0<c.length){d=this.getChildValue(c[0]);d=d.replace(this.regExes.trimSpace,"");d=d.split(this.regExes.splitSpace);var f=parseInt(c[0].getAttribute("dimension")),
g,h,i;for(c=0;c<d.length/f;++c)g=c*f,h=d[g],i=d[g+1],g=2==f?null:d[g+2],this.xy?e.push(new OpenLayers.Geometry.Point(h,i,g)):e.push(new OpenLayers.Geometry.Point(i,h,g))}if(0==d.length&&(c=this.getElementsByTagNameNS(a,this.gmlns,"coordinates"),0<c.length)){d=this.getChildValue(c[0]);d=d.replace(this.regExes.trimSpace,"");d=d.replace(this.regExes.trimComma,",");f=d.split(this.regExes.splitSpace);for(c=0;c<f.length;++c)d=f[c].split(","),2==d.length&&(d[2]=null),this.xy?e.push(new OpenLayers.Geometry.Point(d[0],
d[1],d[2])):e.push(new OpenLayers.Geometry.Point(d[1],d[0],d[2]))}d=null;0!=e.length&&(d=b?new OpenLayers.Geometry.LinearRing(e):new OpenLayers.Geometry.LineString(e));return d},multilinestring:function(a){var a=this.getElementsByTagNameNS(a,this.gmlns,"LineString"),b=[];if(0<a.length)for(var c,d=0;d<a.length;++d)(c=this.parseGeometry.linestring.apply(this,[a[d]]))&&b.push(c);return new OpenLayers.Geometry.MultiLineString(b)},polygon:function(a){var a=this.getElementsByTagNameNS(a,this.gmlns,"LinearRing"),
b=[];if(0<a.length)for(var c,d=0;d<a.length;++d)(c=this.parseGeometry.linestring.apply(this,[a[d],!0]))&&b.push(c);return new OpenLayers.Geometry.Polygon(b)},multipolygon:function(a){var a=this.getElementsByTagNameNS(a,this.gmlns,"Polygon"),b=[];if(0<a.length)for(var c,d=0;d<a.length;++d)(c=this.parseGeometry.polygon.apply(this,[a[d]]))&&b.push(c);return new OpenLayers.Geometry.MultiPolygon(b)},envelope:function(a){var b=[],c,d,e=this.getElementsByTagNameNS(a,this.gmlns,"lowerCorner");if(0<e.length){c=
[];0<e.length&&(c=e[0].firstChild.nodeValue,c=c.replace(this.regExes.trimSpace,""),c=c.split(this.regExes.splitSpace));2==c.length&&(c[2]=null);var f=this.xy?new OpenLayers.Geometry.Point(c[0],c[1],c[2]):new OpenLayers.Geometry.Point(c[1],c[0],c[2])}a=this.getElementsByTagNameNS(a,this.gmlns,"upperCorner");if(0<a.length){c=[];0<a.length&&(c=a[0].firstChild.nodeValue,c=c.replace(this.regExes.trimSpace,""),c=c.split(this.regExes.splitSpace));2==c.length&&(c[2]=null);var g=this.xy?new OpenLayers.Geometry.Point(c[0],
c[1],c[2]):new OpenLayers.Geometry.Point(c[1],c[0],c[2])}f&&g&&(b.push(new OpenLayers.Geometry.Point(f.x,f.y)),b.push(new OpenLayers.Geometry.Point(g.x,f.y)),b.push(new OpenLayers.Geometry.Point(g.x,g.y)),b.push(new OpenLayers.Geometry.Point(f.x,g.y)),b.push(new OpenLayers.Geometry.Point(f.x,f.y)),b=new OpenLayers.Geometry.LinearRing(b),d=new OpenLayers.Geometry.Polygon([b]));return d},box:function(a){var b=this.getElementsByTagNameNS(a,this.gmlns,"coordinates"),c=a=null;0<b.length&&(b=b[0].firstChild.nodeValue,
b=b.split(" "),2==b.length&&(a=b[0].split(","),c=b[1].split(",")));if(null!==a&&null!==c)return new OpenLayers.Bounds(parseFloat(a[0]),parseFloat(a[1]),parseFloat(c[0]),parseFloat(c[1]))}},parseAttributes:function(a){for(var b={},a=a.firstChild,c,d,e;a;){if(1==a.nodeType){a=a.childNodes;for(c=0;c<a.length;++c)if(d=a[c],1==d.nodeType)if(e=d.childNodes,1==e.length){if(e=e[0],3==e.nodeType||4==e.nodeType)d=d.prefix?d.nodeName.split(":")[1]:d.nodeName,e=e.nodeValue.replace(this.regExes.trimSpace,""),
b[d]=e}else b[d.nodeName.split(":").pop()]=null;break}a=a.nextSibling}return b},write:function(a){OpenLayers.Util.isArray(a)||(a=[a]);for(var b=this.createElementNS("http://www.opengis.net/wfs","wfs:"+this.collectionName),c=0;c<a.length;c++)b.appendChild(this.createFeatureXML(a[c]));return OpenLayers.Format.XML.prototype.write.apply(this,[b])},createFeatureXML:function(a){var b=this.buildGeometryNode(a.geometry),c=this.createElementNS(this.featureNS,this.featurePrefix+":"+this.geometryName);c.appendChild(b);
var b=this.createElementNS(this.gmlns,"gml:"+this.featureName),d=this.createElementNS(this.featureNS,this.featurePrefix+":"+this.layerName);d.setAttribute("fid",a.fid||a.id);d.appendChild(c);for(var e in a.attributes){var c=this.createTextNode(a.attributes[e]),f=this.createElementNS(this.featureNS,this.featurePrefix+":"+e.substring(e.lastIndexOf(":")+1));f.appendChild(c);d.appendChild(f)}b.appendChild(d);return b},buildGeometryNode:function(a){this.externalProjection&&this.internalProjection&&(a=
a.clone(),a.transform(this.internalProjection,this.externalProjection));var b=a.CLASS_NAME;return this.buildGeometry[b.substring(b.lastIndexOf(".")+1).toLowerCase()].apply(this,[a])},buildGeometry:{point:function(a){var b=this.createElementNS(this.gmlns,"gml:Point");b.appendChild(this.buildCoordinatesNode(a));return b},multipoint:function(a){for(var b=this.createElementNS(this.gmlns,"gml:MultiPoint"),a=a.components,c,d,e=0;e<a.length;e++)c=this.createElementNS(this.gmlns,"gml:pointMember"),d=this.buildGeometry.point.apply(this,
[a[e]]),c.appendChild(d),b.appendChild(c);return b},linestring:function(a){var b=this.createElementNS(this.gmlns,"gml:LineString");b.appendChild(this.buildCoordinatesNode(a));return b},multilinestring:function(a){for(var b=this.createElementNS(this.gmlns,"gml:MultiLineString"),a=a.components,c,d,e=0;e<a.length;++e)c=this.createElementNS(this.gmlns,"gml:lineStringMember"),d=this.buildGeometry.linestring.apply(this,[a[e]]),c.appendChild(d),b.appendChild(c);return b},linearring:function(a){var b=this.createElementNS(this.gmlns,
"gml:LinearRing");b.appendChild(this.buildCoordinatesNode(a));return b},polygon:function(a){for(var b=this.createElementNS(this.gmlns,"gml:Polygon"),a=a.components,c,d,e=0;e<a.length;++e)c=0==e?"outerBoundaryIs":"innerBoundaryIs",c=this.createElementNS(this.gmlns,"gml:"+c),d=this.buildGeometry.linearring.apply(this,[a[e]]),c.appendChild(d),b.appendChild(c);return b},multipolygon:function(a){for(var b=this.createElementNS(this.gmlns,"gml:MultiPolygon"),a=a.components,c,d,e=0;e<a.length;++e)c=this.createElementNS(this.gmlns,
"gml:polygonMember"),d=this.buildGeometry.polygon.apply(this,[a[e]]),c.appendChild(d),b.appendChild(c);return b},bounds:function(a){var b=this.createElementNS(this.gmlns,"gml:Box");b.appendChild(this.buildCoordinatesNode(a));return b}},buildCoordinatesNode:function(a){var b=this.createElementNS(this.gmlns,"gml:coordinates");b.setAttribute("decimal",".");b.setAttribute("cs",",");b.setAttribute("ts"," ");var c=[];if(a instanceof OpenLayers.Bounds)c.push(a.left+","+a.bottom),c.push(a.right+","+a.top);
else for(var a=a.components?a.components:[a],d=0;d<a.length;d++)c.push(a[d].x+","+a[d].y);c=this.createTextNode(c.join(" "));b.appendChild(c);return b},CLASS_NAME:"OpenLayers.Format.GML"});OpenLayers.Format.GML||(OpenLayers.Format.GML={});
OpenLayers.Format.GML.Base=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",wfs:"http://www.opengis.net/wfs"},defaultPrefix:"gml",schemaLocation:null,featureType:null,featureNS:null,geometryName:"geometry",extractAttributes:!0,srsName:null,xy:!0,geometryTypes:null,singleFeatureType:null,regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g,featureMember:/^(.*:)?featureMembers?$/},
initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);this.setGeometryTypes();a&&a.featureNS&&this.setNamespace("feature",a.featureNS);this.singleFeatureType=!a||typeof a.featureType==="string"},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));if(a&&a.nodeType==9)a=a.documentElement;var b=[];this.readNode(a,{features:b},true);if(b.length==0){var c=this.getElementsByTagNameNS(a,this.namespaces.gml,"featureMember");if(c.length)for(var a=
0,d=c.length;a<d;++a)this.readNode(c[a],{features:b},true);else{c=this.getElementsByTagNameNS(a,this.namespaces.gml,"featureMembers");c.length&&this.readNode(c[0],{features:b},true)}}return b},readNode:function(a,b,c){if(c===true&&this.autoConfig===true){this.featureType=null;delete this.namespaceAlias[this.featureNS];delete this.namespaces.feature;this.featureNS=null}if(!this.featureNS&&!(a.prefix in this.namespaces)&&a.parentNode.namespaceURI==this.namespaces.gml&&this.regExes.featureMember.test(a.parentNode.nodeName)){this.featureType=
a.nodeName.split(":").pop();this.setNamespace("feature",a.namespaceURI);this.featureNS=a.namespaceURI;this.autoConfig=true}return OpenLayers.Format.XML.prototype.readNode.apply(this,[a,b])},readers:{gml:{featureMember:function(a,b){this.readChildNodes(a,b)},featureMembers:function(a,b){this.readChildNodes(a,b)},name:function(a,b){b.name=this.getChildValue(a)},boundedBy:function(a,b){var c={};this.readChildNodes(a,c);if(c.components&&c.components.length>0)b.bounds=c.components[0]},Point:function(a,
b){var c={points:[]};this.readChildNodes(a,c);if(!b.components)b.components=[];b.components.push(c.points[0])},coordinates:function(a,b){for(var c=this.getChildValue(a).replace(this.regExes.trimSpace,""),c=c.replace(this.regExes.trimComma,","),c=c.split(this.regExes.splitSpace),d,e=c.length,f=Array(e),g=0;g<e;++g){d=c[g].split(",");f[g]=this.xy?new OpenLayers.Geometry.Point(d[0],d[1],d[2]):new OpenLayers.Geometry.Point(d[1],d[0],d[2])}b.points=f},coord:function(a,b){var c={};this.readChildNodes(a,
c);if(!b.points)b.points=[];b.points.push(new OpenLayers.Geometry.Point(c.x,c.y,c.z))},X:function(a,b){b.x=this.getChildValue(a)},Y:function(a,b){b.y=this.getChildValue(a)},Z:function(a,b){b.z=this.getChildValue(a)},MultiPoint:function(a,b){var c={components:[]};this.readChildNodes(a,c);b.components=[new OpenLayers.Geometry.MultiPoint(c.components)]},pointMember:function(a,b){this.readChildNodes(a,b)},LineString:function(a,b){var c={};this.readChildNodes(a,c);if(!b.components)b.components=[];b.components.push(new OpenLayers.Geometry.LineString(c.points))},
MultiLineString:function(a,b){var c={components:[]};this.readChildNodes(a,c);b.components=[new OpenLayers.Geometry.MultiLineString(c.components)]},lineStringMember:function(a,b){this.readChildNodes(a,b)},Polygon:function(a,b){var c={outer:null,inner:[]};this.readChildNodes(a,c);c.inner.unshift(c.outer);if(!b.components)b.components=[];b.components.push(new OpenLayers.Geometry.Polygon(c.inner))},LinearRing:function(a,b){var c={};this.readChildNodes(a,c);b.components=[new OpenLayers.Geometry.LinearRing(c.points)]},
MultiPolygon:function(a,b){var c={components:[]};this.readChildNodes(a,c);b.components=[new OpenLayers.Geometry.MultiPolygon(c.components)]},polygonMember:function(a,b){this.readChildNodes(a,b)},GeometryCollection:function(a,b){var c={components:[]};this.readChildNodes(a,c);b.components=[new OpenLayers.Geometry.Collection(c.components)]},geometryMember:function(a,b){this.readChildNodes(a,b)}},feature:{"*":function(a,b){var c,d=a.localName||a.nodeName.split(":").pop();b.features?!this.singleFeatureType&&
OpenLayers.Util.indexOf(this.featureType,d)!==-1?c="_typeName":d===this.featureType&&(c="_typeName"):a.childNodes.length==0||a.childNodes.length==1&&a.firstChild.nodeType==3?this.extractAttributes&&(c="_attribute"):c="_geometry";c&&this.readers.feature[c].apply(this,[a,b])},_typeName:function(a,b){var c={components:[],attributes:{}};this.readChildNodes(a,c);if(c.name)c.attributes.name=c.name;var d=new OpenLayers.Feature.Vector(c.components[0],c.attributes);if(!this.singleFeatureType){d.type=a.nodeName.split(":").pop();
d.namespace=a.namespaceURI}var e=a.getAttribute("fid")||this.getAttributeNS(a,this.namespaces.gml,"id");if(e)d.fid=e;this.internalProjection&&(this.externalProjection&&d.geometry)&&d.geometry.transform(this.externalProjection,this.internalProjection);if(c.bounds)d.bounds=c.bounds;b.features.push(d)},_geometry:function(a,b){if(!this.geometryName)this.geometryName=a.nodeName.split(":").pop();this.readChildNodes(a,b)},_attribute:function(a,b){var c=a.localName||a.nodeName.split(":").pop(),d=this.getChildValue(a);
b.attributes[c]=d}},wfs:{FeatureCollection:function(a,b){this.readChildNodes(a,b)}}},write:function(a){a=this.writeNode("gml:"+(OpenLayers.Util.isArray(a)?"featureMembers":"featureMember"),a);this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[a])},writers:{gml:{featureMember:function(a){var b=this.createElementNSPlus("gml:featureMember");this.writeNode("feature:_typeName",a,b);return b},MultiPoint:function(a){for(var b=
this.createElementNSPlus("gml:MultiPoint"),a=a.components||[a],c=0,d=a.length;c<d;++c)this.writeNode("pointMember",a[c],b);return b},pointMember:function(a){var b=this.createElementNSPlus("gml:pointMember");this.writeNode("Point",a,b);return b},MultiLineString:function(a){for(var b=this.createElementNSPlus("gml:MultiLineString"),a=a.components||[a],c=0,d=a.length;c<d;++c)this.writeNode("lineStringMember",a[c],b);return b},lineStringMember:function(a){var b=this.createElementNSPlus("gml:lineStringMember");
this.writeNode("LineString",a,b);return b},MultiPolygon:function(a){for(var b=this.createElementNSPlus("gml:MultiPolygon"),a=a.components||[a],c=0,d=a.length;c<d;++c)this.writeNode("polygonMember",a[c],b);return b},polygonMember:function(a){var b=this.createElementNSPlus("gml:polygonMember");this.writeNode("Polygon",a,b);return b},GeometryCollection:function(a){for(var b=this.createElementNSPlus("gml:GeometryCollection"),c=0,d=a.components.length;c<d;++c)this.writeNode("geometryMember",a.components[c],
b);return b},geometryMember:function(a){var b=this.createElementNSPlus("gml:geometryMember"),a=this.writeNode("feature:_geometry",a);b.appendChild(a.firstChild);return b}},feature:{_typeName:function(a){var b=this.createElementNSPlus("feature:"+this.featureType,{attributes:{fid:a.fid}});a.geometry&&this.writeNode("feature:_geometry",a.geometry,b);for(var c in a.attributes){var d=a.attributes[c];d!=null&&this.writeNode("feature:_attribute",{name:c,value:d},b)}return b},_geometry:function(a){this.externalProjection&&
this.internalProjection&&(a=a.clone().transform(this.internalProjection,this.externalProjection));var b=this.createElementNSPlus("feature:"+this.geometryName),a=this.writeNode("gml:"+this.geometryTypes[a.CLASS_NAME],a,b);this.srsName&&a.setAttribute("srsName",this.srsName);return b},_attribute:function(a){return this.createElementNSPlus("feature:"+a.name,{value:a.value})}},wfs:{FeatureCollection:function(a){for(var b=this.createElementNSPlus("wfs:FeatureCollection"),c=0,d=a.length;c<d;++c)this.writeNode("gml:featureMember",
a[c],b);return b}}},setGeometryTypes:function(){this.geometryTypes={"OpenLayers.Geometry.Point":"Point","OpenLayers.Geometry.MultiPoint":"MultiPoint","OpenLayers.Geometry.LineString":"LineString","OpenLayers.Geometry.MultiLineString":"MultiLineString","OpenLayers.Geometry.Polygon":"Polygon","OpenLayers.Geometry.MultiPolygon":"MultiPolygon","OpenLayers.Geometry.Collection":"GeometryCollection"}},CLASS_NAME:"OpenLayers.Format.GML.Base"});OpenLayers.Format.GML.v3=OpenLayers.Class(OpenLayers.Format.GML.Base,{schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",curve:!1,multiCurve:!0,surface:!1,multiSurface:!0,initialize:function(a){OpenLayers.Format.GML.Base.prototype.initialize.apply(this,[a])},readers:{gml:OpenLayers.Util.applyDefaults({featureMembers:function(a,b){this.readChildNodes(a,b)},Curve:function(a,b){var c={points:[]};this.readChildNodes(a,c);b.components||
(b.components=[]);b.components.push(new OpenLayers.Geometry.LineString(c.points))},segments:function(a,b){this.readChildNodes(a,b)},LineStringSegment:function(a,b){var c={};this.readChildNodes(a,c);c.points&&Array.prototype.push.apply(b.points,c.points)},pos:function(a,b){var c=this.getChildValue(a).replace(this.regExes.trimSpace,"").split(this.regExes.splitSpace),c=this.xy?new OpenLayers.Geometry.Point(c[0],c[1],c[2]):new OpenLayers.Geometry.Point(c[1],c[0],c[2]);b.points=[c]},posList:function(a,
b){for(var c=this.getChildValue(a).replace(this.regExes.trimSpace,"").split(this.regExes.splitSpace),d=parseInt(a.getAttribute("dimension"))||2,e,f,g,h=Array(c.length/d),i=0,j=c.length;i<j;i+=d)e=c[i],f=c[i+1],g=2==d?void 0:c[i+2],h[i/d]=this.xy?new OpenLayers.Geometry.Point(e,f,g):new OpenLayers.Geometry.Point(f,e,g);b.points=h},Surface:function(a,b){this.readChildNodes(a,b)},patches:function(a,b){this.readChildNodes(a,b)},PolygonPatch:function(a,b){this.readers.gml.Polygon.apply(this,[a,b])},exterior:function(a,
b){var c={};this.readChildNodes(a,c);b.outer=c.components[0]},interior:function(a,b){var c={};this.readChildNodes(a,c);b.inner.push(c.components[0])},MultiCurve:function(a,b){var c={components:[]};this.readChildNodes(a,c);0<c.components.length&&(b.components=[new OpenLayers.Geometry.MultiLineString(c.components)])},curveMember:function(a,b){this.readChildNodes(a,b)},MultiSurface:function(a,b){var c={components:[]};this.readChildNodes(a,c);0<c.components.length&&(b.components=[new OpenLayers.Geometry.MultiPolygon(c.components)])},
surfaceMember:function(a,b){this.readChildNodes(a,b)},surfaceMembers:function(a,b){this.readChildNodes(a,b)},pointMembers:function(a,b){this.readChildNodes(a,b)},lineStringMembers:function(a,b){this.readChildNodes(a,b)},polygonMembers:function(a,b){this.readChildNodes(a,b)},geometryMembers:function(a,b){this.readChildNodes(a,b)},Envelope:function(a,b){var c={points:Array(2)};this.readChildNodes(a,c);b.components||(b.components=[]);var d=c.points[0],c=c.points[1];b.components.push(new OpenLayers.Bounds(d.x,
d.y,c.x,c.y))},lowerCorner:function(a,b){var c={};this.readers.gml.pos.apply(this,[a,c]);b.points[0]=c.points[0]},upperCorner:function(a,b){var c={};this.readers.gml.pos.apply(this,[a,c]);b.points[1]=c.points[0]}},OpenLayers.Format.GML.Base.prototype.readers.gml),feature:OpenLayers.Format.GML.Base.prototype.readers.feature,wfs:OpenLayers.Format.GML.Base.prototype.readers.wfs},write:function(a){a=this.writeNode("gml:"+(OpenLayers.Util.isArray(a)?"featureMembers":"featureMember"),a);this.setAttributeNS(a,
this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[a])},writers:{gml:OpenLayers.Util.applyDefaults({featureMembers:function(a){for(var b=this.createElementNSPlus("gml:featureMembers"),c=0,d=a.length;c<d;++c)this.writeNode("feature:_typeName",a[c],b);return b},Point:function(a){var b=this.createElementNSPlus("gml:Point");this.writeNode("pos",a,b);return b},pos:function(a){return this.createElementNSPlus("gml:pos",{value:this.xy?a.x+
" "+a.y:a.y+" "+a.x})},LineString:function(a){var b=this.createElementNSPlus("gml:LineString");this.writeNode("posList",a.components,b);return b},Curve:function(a){var b=this.createElementNSPlus("gml:Curve");this.writeNode("segments",a,b);return b},segments:function(a){var b=this.createElementNSPlus("gml:segments");this.writeNode("LineStringSegment",a,b);return b},LineStringSegment:function(a){var b=this.createElementNSPlus("gml:LineStringSegment");this.writeNode("posList",a.components,b);return b},
posList:function(a){for(var b=a.length,c=Array(b),d,e=0;e<b;++e)d=a[e],c[e]=this.xy?d.x+" "+d.y:d.y+" "+d.x;return this.createElementNSPlus("gml:posList",{value:c.join(" ")})},Surface:function(a){var b=this.createElementNSPlus("gml:Surface");this.writeNode("patches",a,b);return b},patches:function(a){var b=this.createElementNSPlus("gml:patches");this.writeNode("PolygonPatch",a,b);return b},PolygonPatch:function(a){var b=this.createElementNSPlus("gml:PolygonPatch",{attributes:{interpolation:"planar"}});
this.writeNode("exterior",a.components[0],b);for(var c=1,d=a.components.length;c<d;++c)this.writeNode("interior",a.components[c],b);return b},Polygon:function(a){var b=this.createElementNSPlus("gml:Polygon");this.writeNode("exterior",a.components[0],b);for(var c=1,d=a.components.length;c<d;++c)this.writeNode("interior",a.components[c],b);return b},exterior:function(a){var b=this.createElementNSPlus("gml:exterior");this.writeNode("LinearRing",a,b);return b},interior:function(a){var b=this.createElementNSPlus("gml:interior");
this.writeNode("LinearRing",a,b);return b},LinearRing:function(a){var b=this.createElementNSPlus("gml:LinearRing");this.writeNode("posList",a.components,b);return b},MultiCurve:function(a){for(var b=this.createElementNSPlus("gml:MultiCurve"),a=a.components||[a],c=0,d=a.length;c<d;++c)this.writeNode("curveMember",a[c],b);return b},curveMember:function(a){var b=this.createElementNSPlus("gml:curveMember");this.curve?this.writeNode("Curve",a,b):this.writeNode("LineString",a,b);return b},MultiSurface:function(a){for(var b=
this.createElementNSPlus("gml:MultiSurface"),a=a.components||[a],c=0,d=a.length;c<d;++c)this.writeNode("surfaceMember",a[c],b);return b},surfaceMember:function(a){var b=this.createElementNSPlus("gml:surfaceMember");this.surface?this.writeNode("Surface",a,b):this.writeNode("Polygon",a,b);return b},Envelope:function(a){var b=this.createElementNSPlus("gml:Envelope");this.writeNode("lowerCorner",a,b);this.writeNode("upperCorner",a,b);this.srsName&&b.setAttribute("srsName",this.srsName);return b},lowerCorner:function(a){return this.createElementNSPlus("gml:lowerCorner",
{value:this.xy?a.left+" "+a.bottom:a.bottom+" "+a.left})},upperCorner:function(a){return this.createElementNSPlus("gml:upperCorner",{value:this.xy?a.right+" "+a.top:a.top+" "+a.right})}},OpenLayers.Format.GML.Base.prototype.writers.gml),feature:OpenLayers.Format.GML.Base.prototype.writers.feature,wfs:OpenLayers.Format.GML.Base.prototype.writers.wfs},setGeometryTypes:function(){this.geometryTypes={"OpenLayers.Geometry.Point":"Point","OpenLayers.Geometry.MultiPoint":"MultiPoint","OpenLayers.Geometry.LineString":!0===
this.curve?"Curve":"LineString","OpenLayers.Geometry.MultiLineString":!1===this.multiCurve?"MultiLineString":"MultiCurve","OpenLayers.Geometry.Polygon":!0===this.surface?"Surface":"Polygon","OpenLayers.Geometry.MultiPolygon":!1===this.multiSurface?"MultiPolygon":"MultiSurface","OpenLayers.Geometry.Collection":"GeometryCollection"}},CLASS_NAME:"OpenLayers.Format.GML.v3"});OpenLayers.Format.Filter.v1_1_0=OpenLayers.Class(OpenLayers.Format.GML.v3,OpenLayers.Format.Filter.v1,{VERSION:"1.1.0",schemaLocation:"http://www.opengis.net/ogc/filter/1.1.0/filter.xsd",initialize:function(a){OpenLayers.Format.GML.v3.prototype.initialize.apply(this,[a])},readers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(a,b){var c=a.getAttribute("matchCase"),c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,matchCase:!("false"===c||"0"===c)});this.readChildNodes(a,
c);b.filters.push(c)},PropertyIsNotEqualTo:function(a,b){var c=a.getAttribute("matchCase"),c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.NOT_EQUAL_TO,matchCase:!("false"===c||"0"===c)});this.readChildNodes(a,c);b.filters.push(c)},PropertyIsLike:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LIKE});this.readChildNodes(a,c);var d=a.getAttribute("wildCard"),e=a.getAttribute("singleChar"),f=a.getAttribute("escapeChar");c.value2regex(d,e,
f);b.filters.push(c)}},OpenLayers.Format.Filter.v1.prototype.readers.ogc),gml:OpenLayers.Format.GML.v3.prototype.readers.gml,feature:OpenLayers.Format.GML.v3.prototype.readers.feature},writers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsEqualTo",{attributes:{matchCase:a.matchCase}});this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);return b},PropertyIsNotEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsNotEqualTo",
{attributes:{matchCase:a.matchCase}});this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);return b},PropertyIsLike:function(a){var b=this.createElementNSPlus("ogc:PropertyIsLike",{attributes:{matchCase:a.matchCase,wildCard:"*",singleChar:".",escapeChar:"!"}});this.writeNode("PropertyName",a,b);this.writeNode("Literal",a.regex2value(),b);return b},BBOX:function(a){var b=this.createElementNSPlus("ogc:BBOX");a.property&&this.writeNode("PropertyName",a,b);var c=this.writeNode("gml:Envelope",
a.value);a.projection&&c.setAttribute("srsName",a.projection);b.appendChild(c);return b},SortBy:function(a){for(var b=this.createElementNSPlus("ogc:SortBy"),c=0,d=a.length;c<d;c++)this.writeNode("ogc:SortProperty",a[c],b);return b},SortProperty:function(a){var b=this.createElementNSPlus("ogc:SortProperty");this.writeNode("ogc:PropertyName",a,b);this.writeNode("ogc:SortOrder","DESC"==a.order?"DESC":"ASC",b);return b},SortOrder:function(a){return this.createElementNSPlus("ogc:SortOrder",{value:a})}},
OpenLayers.Format.Filter.v1.prototype.writers.ogc),gml:OpenLayers.Format.GML.v3.prototype.writers.gml,feature:OpenLayers.Format.GML.v3.prototype.writers.feature},writeSpatial:function(a,b){var c=this.createElementNSPlus("ogc:"+b);this.writeNode("PropertyName",a,c);if(a.value instanceof OpenLayers.Filter.Function)this.writeNode("Function",a.value,c);else{var d;d=a.value instanceof OpenLayers.Geometry?this.writeNode("feature:_geometry",a.value).firstChild:this.writeNode("gml:Envelope",a.value);a.projection&&
d.setAttribute("srsName",a.projection);c.appendChild(d)}return c},CLASS_NAME:"OpenLayers.Format.Filter.v1_1_0"});OpenLayers.Format.OWSCommon=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",getVersion:function(a){var b=this.version;b||((a=a.getAttribute("xmlns:ows"))&&"1.1"===a.substring(a.lastIndexOf("/")+1)&&(b="1.1.0"),b||(b=this.defaultVersion));return b},CLASS_NAME:"OpenLayers.Format.OWSCommon"});OpenLayers.Format.OWSCommon.v1=OpenLayers.Class(OpenLayers.Format.XML,{regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},read:function(a,b){OpenLayers.Util.applyDefaults(b,this.options);var c={};this.readChildNodes(a,c);return c},readers:{ows:{Exception:function(a,b){var c={code:a.getAttribute("exceptionCode"),locator:a.getAttribute("locator"),texts:[]};b.exceptions.push(c);this.readChildNodes(a,c)},ExceptionText:function(a,b){var c=this.getChildValue(a);b.texts.push(c)},
ServiceIdentification:function(a,b){b.serviceIdentification={};this.readChildNodes(a,b.serviceIdentification)},Title:function(a,b){b.title=this.getChildValue(a)},Abstract:function(a,b){b["abstract"]=this.getChildValue(a)},Keywords:function(a,b){b.keywords={};this.readChildNodes(a,b.keywords)},Keyword:function(a,b){b[this.getChildValue(a)]=!0},ServiceType:function(a,b){b.serviceType={codeSpace:a.getAttribute("codeSpace"),value:this.getChildValue(a)}},ServiceTypeVersion:function(a,b){b.serviceTypeVersion=
this.getChildValue(a)},Fees:function(a,b){b.fees=this.getChildValue(a)},AccessConstraints:function(a,b){b.accessConstraints=this.getChildValue(a)},ServiceProvider:function(a,b){b.serviceProvider={};this.readChildNodes(a,b.serviceProvider)},ProviderName:function(a,b){b.providerName=this.getChildValue(a)},ProviderSite:function(a,b){b.providerSite=this.getAttributeNS(a,this.namespaces.xlink,"href")},ServiceContact:function(a,b){b.serviceContact={};this.readChildNodes(a,b.serviceContact)},IndividualName:function(a,
b){b.individualName=this.getChildValue(a)},PositionName:function(a,b){b.positionName=this.getChildValue(a)},ContactInfo:function(a,b){b.contactInfo={};this.readChildNodes(a,b.contactInfo)},Phone:function(a,b){b.phone={};this.readChildNodes(a,b.phone)},Voice:function(a,b){b.voice=this.getChildValue(a)},Address:function(a,b){b.address={};this.readChildNodes(a,b.address)},DeliveryPoint:function(a,b){b.deliveryPoint=this.getChildValue(a)},City:function(a,b){b.city=this.getChildValue(a)},AdministrativeArea:function(a,
b){b.administrativeArea=this.getChildValue(a)},PostalCode:function(a,b){b.postalCode=this.getChildValue(a)},Country:function(a,b){b.country=this.getChildValue(a)},ElectronicMailAddress:function(a,b){b.electronicMailAddress=this.getChildValue(a)},Role:function(a,b){b.role=this.getChildValue(a)},OperationsMetadata:function(a,b){b.operationsMetadata={};this.readChildNodes(a,b.operationsMetadata)},Operation:function(a,b){var c=a.getAttribute("name");b[c]={};this.readChildNodes(a,b[c])},DCP:function(a,
b){b.dcp={};this.readChildNodes(a,b.dcp)},HTTP:function(a,b){b.http={};this.readChildNodes(a,b.http)},Get:function(a,b){b.get||(b.get=[]);var c={url:this.getAttributeNS(a,this.namespaces.xlink,"href")};this.readChildNodes(a,c);b.get.push(c)},Post:function(a,b){b.post||(b.post=[]);var c={url:this.getAttributeNS(a,this.namespaces.xlink,"href")};this.readChildNodes(a,c);b.post.push(c)},Parameter:function(a,b){b.parameters||(b.parameters={});var c=a.getAttribute("name");b.parameters[c]={};this.readChildNodes(a,
b.parameters[c])},Constraint:function(a,b){b.constraints||(b.constraints={});var c=a.getAttribute("name");b.constraints[c]={};this.readChildNodes(a,b.constraints[c])},Value:function(a,b){b[this.getChildValue(a)]=!0},OutputFormat:function(a,b){b.formats.push({value:this.getChildValue(a)});this.readChildNodes(a,b)},WGS84BoundingBox:function(a,b){var c={};c.crs=a.getAttribute("crs");b.BoundingBox?b.BoundingBox.push(c):(b.projection=c.crs,c=b);this.readChildNodes(a,c)},BoundingBox:function(a,b){this.readers.ows.WGS84BoundingBox.apply(this,
[a,b])},LowerCorner:function(a,b){var c=this.getChildValue(a).replace(this.regExes.trimSpace,""),c=c.replace(this.regExes.trimComma,","),c=c.split(this.regExes.splitSpace);b.left=c[0];b.bottom=c[1]},UpperCorner:function(a,b){var c=this.getChildValue(a).replace(this.regExes.trimSpace,""),c=c.replace(this.regExes.trimComma,","),c=c.split(this.regExes.splitSpace);b.right=c[0];b.top=c[1];b.bounds=new OpenLayers.Bounds(b.left,b.bottom,b.right,b.top);delete b.left;delete b.bottom;delete b.right;delete b.top},
Language:function(a,b){b.language=this.getChildValue(a)}}},writers:{ows:{BoundingBox:function(a){var b=this.createElementNSPlus("ows:BoundingBox",{attributes:{crs:a.projection}});this.writeNode("ows:LowerCorner",a,b);this.writeNode("ows:UpperCorner",a,b);return b},LowerCorner:function(a){return this.createElementNSPlus("ows:LowerCorner",{value:a.bounds.left+" "+a.bounds.bottom})},UpperCorner:function(a){return this.createElementNSPlus("ows:UpperCorner",{value:a.bounds.right+" "+a.bounds.top})},Identifier:function(a){return this.createElementNSPlus("ows:Identifier",
{value:a})},Title:function(a){return this.createElementNSPlus("ows:Title",{value:a})},Abstract:function(a){return this.createElementNSPlus("ows:Abstract",{value:a})},OutputFormat:function(a){return this.createElementNSPlus("ows:OutputFormat",{value:a})}}},CLASS_NAME:"OpenLayers.Format.OWSCommon.v1"});OpenLayers.Format.OWSCommon.v1_0_0=OpenLayers.Class(OpenLayers.Format.OWSCommon.v1,{namespaces:{ows:"http://www.opengis.net/ows",xlink:"http://www.w3.org/1999/xlink"},readers:{ows:OpenLayers.Util.applyDefaults({ExceptionReport:function(a,b){b.success=!1;b.exceptionReport={version:a.getAttribute("version"),language:a.getAttribute("language"),exceptions:[]};this.readChildNodes(a,b.exceptionReport)}},OpenLayers.Format.OWSCommon.v1.prototype.readers.ows)},writers:{ows:OpenLayers.Format.OWSCommon.v1.prototype.writers.ows},
CLASS_NAME:"OpenLayers.Format.OWSCommon.v1_0_0"});OpenLayers.Format.WFST.v1_1_0=OpenLayers.Class(OpenLayers.Format.Filter.v1_1_0,OpenLayers.Format.WFST.v1,{version:"1.1.0",schemaLocations:{wfs:"http://schemas.opengis.net/wfs/1.1.0/wfs.xsd"},initialize:function(a){OpenLayers.Format.Filter.v1_1_0.prototype.initialize.apply(this,[a]);OpenLayers.Format.WFST.v1.prototype.initialize.apply(this,[a])},readNode:function(a,b){return OpenLayers.Format.GML.v3.prototype.readNode.apply(this,[a,b])},readers:{wfs:OpenLayers.Util.applyDefaults({FeatureCollection:function(a,
b){b.numberOfFeatures=parseInt(a.getAttribute("numberOfFeatures"));OpenLayers.Format.WFST.v1.prototype.readers.wfs.FeatureCollection.apply(this,arguments)},TransactionResponse:function(a,b){b.insertIds=[];b.success=!1;this.readChildNodes(a,b)},TransactionSummary:function(a,b){b.success=!0},InsertResults:function(a,b){this.readChildNodes(a,b)},Feature:function(a,b){var c={fids:[]};this.readChildNodes(a,c);b.insertIds.push(c.fids[0])}},OpenLayers.Format.WFST.v1.prototype.readers.wfs),gml:OpenLayers.Format.GML.v3.prototype.readers.gml,
feature:OpenLayers.Format.GML.v3.prototype.readers.feature,ogc:OpenLayers.Format.Filter.v1_1_0.prototype.readers.ogc,ows:OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows},writers:{wfs:OpenLayers.Util.applyDefaults({GetFeature:function(a){var b=OpenLayers.Format.WFST.v1.prototype.writers.wfs.GetFeature.apply(this,arguments);a&&this.setAttributes(b,{resultType:a.resultType,startIndex:a.startIndex,count:a.count});return b},Query:function(a){var a=OpenLayers.Util.extend({featureNS:this.featureNS,
featurePrefix:this.featurePrefix,featureType:this.featureType,srsName:this.srsName},a),b=a.featurePrefix,c=this.createElementNSPlus("wfs:Query",{attributes:{typeName:(b?b+":":"")+a.featureType,srsName:a.srsName}});a.featureNS&&c.setAttribute("xmlns:"+b,a.featureNS);if(a.propertyNames)for(var b=0,d=a.propertyNames.length;b<d;b++)this.writeNode("wfs:PropertyName",{property:a.propertyNames[b]},c);a.filter&&(OpenLayers.Format.WFST.v1_1_0.prototype.setFilterProperty.call(this,a.filter),this.writeNode("ogc:Filter",
a.filter,c));return c},PropertyName:function(a){return this.createElementNSPlus("wfs:PropertyName",{value:a.property})}},OpenLayers.Format.WFST.v1.prototype.writers.wfs),gml:OpenLayers.Format.GML.v3.prototype.writers.gml,feature:OpenLayers.Format.GML.v3.prototype.writers.feature,ogc:OpenLayers.Format.Filter.v1_1_0.prototype.writers.ogc},CLASS_NAME:"OpenLayers.Format.WFST.v1_1_0"});OpenLayers.Protocol=OpenLayers.Class({format:null,options:null,autoDestroy:!0,defaultFilter:null,initialize:function(a){a=a||{};OpenLayers.Util.extend(this,a);this.options=a},mergeWithDefaultFilter:function(a){return a&&this.defaultFilter?new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND,filters:[this.defaultFilter,a]}):a||this.defaultFilter||void 0},destroy:function(){this.format=this.options=null},read:function(a){a=a||{};a.filter=this.mergeWithDefaultFilter(a.filter)},create:function(){},
update:function(){},"delete":function(){},commit:function(){},abort:function(){},createCallback:function(a,b,c){return OpenLayers.Function.bind(function(){a.apply(this,[b,c])},this)},CLASS_NAME:"OpenLayers.Protocol"});OpenLayers.Protocol.Response=OpenLayers.Class({code:null,requestType:null,last:!0,features:null,data:null,reqFeatures:null,priv:null,error:null,initialize:function(a){OpenLayers.Util.extend(this,a)},success:function(){return 0<this.code},CLASS_NAME:"OpenLayers.Protocol.Response"});
OpenLayers.Protocol.Response.SUCCESS=1;OpenLayers.Protocol.Response.FAILURE=0;OpenLayers.Format.JSON=OpenLayers.Class(OpenLayers.Format,{indent:"    ",space:" ",newline:"\n",level:0,pretty:!1,nativeJSON:function(){return!(!window.JSON||!("function"==typeof JSON.parse&&"function"==typeof JSON.stringify))}(),read:function(a,b){var c;if(this.nativeJSON)c=JSON.parse(a,b);else try{if(/^[\],:{}\s]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))&&(c=eval("("+a+")"),"function"===
typeof b)){var d=function(a,c){if(c&&"object"===typeof c)for(var e in c)c.hasOwnProperty(e)&&(c[e]=d(e,c[e]));return b(a,c)};c=d("",c)}}catch(e){}this.keepData&&(this.data=c);return c},write:function(a,b){this.pretty=!!b;var c=null,d=typeof a;if(this.serialize[d])try{c=!this.pretty&&this.nativeJSON?JSON.stringify(a):this.serialize[d].apply(this,[a])}catch(e){OpenLayers.Console.error("Trouble serializing: "+e)}return c},writeIndent:function(){var a=[];if(this.pretty)for(var b=0;b<this.level;++b)a.push(this.indent);
return a.join("")},writeNewline:function(){return this.pretty?this.newline:""},writeSpace:function(){return this.pretty?this.space:""},serialize:{object:function(a){if(null==a)return"null";if(a.constructor==Date)return this.serialize.date.apply(this,[a]);if(a.constructor==Array)return this.serialize.array.apply(this,[a]);var b=["{"];this.level+=1;var c,d,e,f=!1;for(c in a)a.hasOwnProperty(c)&&(d=OpenLayers.Format.JSON.prototype.write.apply(this,[c,this.pretty]),e=OpenLayers.Format.JSON.prototype.write.apply(this,
[a[c],this.pretty]),null!=d&&null!=e&&(f&&b.push(","),b.push(this.writeNewline(),this.writeIndent(),d,":",this.writeSpace(),e),f=!0));this.level-=1;b.push(this.writeNewline(),this.writeIndent(),"}");return b.join("")},array:function(a){var b,c=["["];this.level+=1;for(var d=0,e=a.length;d<e;++d)b=OpenLayers.Format.JSON.prototype.write.apply(this,[a[d],this.pretty]),null!=b&&(0<d&&c.push(","),c.push(this.writeNewline(),this.writeIndent(),b));this.level-=1;c.push(this.writeNewline(),this.writeIndent(),
"]");return c.join("")},string:function(a){var b={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return/["\\\x00-\x1f]/.test(a)?'"'+a.replace(/([\x00-\x1f\\"])/g,function(a,d){var e=b[d];if(e)return e;e=d.charCodeAt();return"\\u00"+Math.floor(e/16).toString(16)+(e%16).toString(16)})+'"':'"'+a+'"'},number:function(a){return isFinite(a)?""+a:"null"},"boolean":function(a){return""+a},date:function(a){function b(a){return 10>a?"0"+a:a}return'"'+a.getFullYear()+"-"+
b(a.getMonth()+1)+"-"+b(a.getDate())+"T"+b(a.getHours())+":"+b(a.getMinutes())+":"+b(a.getSeconds())+'"'}},CLASS_NAME:"OpenLayers.Format.JSON"});OpenLayers.Format.GeoJSON=OpenLayers.Class(OpenLayers.Format.JSON,{ignoreExtraDims:!1,read:function(a,b,c){var b=b?b:"FeatureCollection",d=null,e=null;if(e="string"==typeof a?OpenLayers.Format.JSON.prototype.read.apply(this,[a,c]):a)if("string"!=typeof e.type)OpenLayers.Console.error("Bad GeoJSON - no type: "+a);else{if(this.isValidType(e,b))switch(b){case "Geometry":try{d=this.parseGeometry(e)}catch(f){OpenLayers.Console.error(f)}break;case "Feature":try{d=this.parseFeature(e),d.type="Feature"}catch(g){OpenLayers.Console.error(g)}break;
case "FeatureCollection":switch(d=[],e.type){case "Feature":try{d.push(this.parseFeature(e))}catch(h){d=null,OpenLayers.Console.error(h)}break;case "FeatureCollection":a=0;for(b=e.features.length;a<b;++a)try{d.push(this.parseFeature(e.features[a]))}catch(i){d=null,OpenLayers.Console.error(i)}break;default:try{var j=this.parseGeometry(e);d.push(new OpenLayers.Feature.Vector(j))}catch(k){d=null,OpenLayers.Console.error(k)}}}}else OpenLayers.Console.error("Bad JSON: "+a);return d},isValidType:function(a,
b){var c=!1;switch(b){case "Geometry":-1==OpenLayers.Util.indexOf("Point MultiPoint LineString MultiLineString Polygon MultiPolygon Box GeometryCollection".split(" "),a.type)?OpenLayers.Console.error("Unsupported geometry type: "+a.type):c=!0;break;case "FeatureCollection":c=!0;break;default:a.type==b?c=!0:OpenLayers.Console.error("Cannot convert types from "+a.type+" to "+b)}return c},parseFeature:function(a){var b,c,d;c=a.properties?a.properties:{};d=a.geometry&&a.geometry.bbox||a.bbox;try{b=this.parseGeometry(a.geometry)}catch(e){throw e;
}b=new OpenLayers.Feature.Vector(b,c);d&&(b.bounds=OpenLayers.Bounds.fromArray(d));a.id&&(b.fid=a.id);return b},parseGeometry:function(a){if(null==a)return null;var b,c=!1;if("GeometryCollection"==a.type){if(!OpenLayers.Util.isArray(a.geometries))throw"GeometryCollection must have geometries array: "+a;b=a.geometries.length;for(var c=Array(b),d=0;d<b;++d)c[d]=this.parseGeometry.apply(this,[a.geometries[d]]);b=new OpenLayers.Geometry.Collection(c);c=!0}else{if(!OpenLayers.Util.isArray(a.coordinates))throw"Geometry must have coordinates array: "+
a;if(!this.parseCoords[a.type.toLowerCase()])throw"Unsupported geometry type: "+a.type;try{b=this.parseCoords[a.type.toLowerCase()].apply(this,[a.coordinates])}catch(e){throw e;}}this.internalProjection&&(this.externalProjection&&!c)&&b.transform(this.externalProjection,this.internalProjection);return b},parseCoords:{point:function(a){if(!1==this.ignoreExtraDims&&2!=a.length)throw"Only 2D points are supported: "+a;return new OpenLayers.Geometry.Point(a[0],a[1])},multipoint:function(a){for(var b=[],
c=null,d=0,e=a.length;d<e;++d){try{c=this.parseCoords.point.apply(this,[a[d]])}catch(f){throw f;}b.push(c)}return new OpenLayers.Geometry.MultiPoint(b)},linestring:function(a){for(var b=[],c=null,d=0,e=a.length;d<e;++d){try{c=this.parseCoords.point.apply(this,[a[d]])}catch(f){throw f;}b.push(c)}return new OpenLayers.Geometry.LineString(b)},multilinestring:function(a){for(var b=[],c=null,d=0,e=a.length;d<e;++d){try{c=this.parseCoords.linestring.apply(this,[a[d]])}catch(f){throw f;}b.push(c)}return new OpenLayers.Geometry.MultiLineString(b)},
polygon:function(a){for(var b=[],c,d,e=0,f=a.length;e<f;++e){try{d=this.parseCoords.linestring.apply(this,[a[e]])}catch(g){throw g;}c=new OpenLayers.Geometry.LinearRing(d.components);b.push(c)}return new OpenLayers.Geometry.Polygon(b)},multipolygon:function(a){for(var b=[],c=null,d=0,e=a.length;d<e;++d){try{c=this.parseCoords.polygon.apply(this,[a[d]])}catch(f){throw f;}b.push(c)}return new OpenLayers.Geometry.MultiPolygon(b)},box:function(a){if(2!=a.length)throw"GeoJSON box coordinates must have 2 elements";
return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(a[0][0],a[0][1]),new OpenLayers.Geometry.Point(a[1][0],a[0][1]),new OpenLayers.Geometry.Point(a[1][0],a[1][1]),new OpenLayers.Geometry.Point(a[0][0],a[1][1]),new OpenLayers.Geometry.Point(a[0][0],a[0][1])])])}},write:function(a,b){var c={type:null};if(OpenLayers.Util.isArray(a)){c.type="FeatureCollection";var d=a.length;c.features=Array(d);for(var e=0;e<d;++e){var f=a[e];if(!f instanceof OpenLayers.Feature.Vector)throw"FeatureCollection only supports collections of features: "+
f;c.features[e]=this.extract.feature.apply(this,[f])}}else 0==a.CLASS_NAME.indexOf("OpenLayers.Geometry")?c=this.extract.geometry.apply(this,[a]):a instanceof OpenLayers.Feature.Vector&&(c=this.extract.feature.apply(this,[a]),a.layer&&a.layer.projection&&(c.crs=this.createCRSObject(a)));return OpenLayers.Format.JSON.prototype.write.apply(this,[c,b])},createCRSObject:function(a){var a=a.layer.projection.toString(),b={};a.match(/epsg:/i)&&(a=parseInt(a.substring(a.indexOf(":")+1)),b=4326==a?{type:"name",
properties:{name:"urn:ogc:def:crs:OGC:1.3:CRS84"}}:{type:"name",properties:{name:"EPSG:"+a}});return b},extract:{feature:function(a){var b=this.extract.geometry.apply(this,[a.geometry]),b={type:"Feature",properties:a.attributes,geometry:b};null!=a.fid&&(b.id=a.fid);return b},geometry:function(a){if(null==a)return null;this.internalProjection&&this.externalProjection&&(a=a.clone(),a.transform(this.internalProjection,this.externalProjection));var b=a.CLASS_NAME.split(".")[2],a=this.extract[b.toLowerCase()].apply(this,
[a]);return"Collection"==b?{type:"GeometryCollection",geometries:a}:{type:b,coordinates:a}},point:function(a){return[a.x,a.y]},multipoint:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push(this.extract.point.apply(this,[a.components[c]]));return b},linestring:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push(this.extract.point.apply(this,[a.components[c]]));return b},multilinestring:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push(this.extract.linestring.apply(this,
[a.components[c]]));return b},polygon:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push(this.extract.linestring.apply(this,[a.components[c]]));return b},multipolygon:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push(this.extract.polygon.apply(this,[a.components[c]]));return b},collection:function(a){for(var b=a.components.length,c=Array(b),d=0;d<b;++d)c[d]=this.extract.geometry.apply(this,[a.components[d]]);return c}},CLASS_NAME:"OpenLayers.Format.GeoJSON"});OpenLayers.Protocol.Script=OpenLayers.Class(OpenLayers.Protocol,{url:null,params:null,callback:null,callbackTemplate:"OpenLayers.Protocol.Script.registry.${id}",callbackKey:"callback",callbackPrefix:"",scope:null,format:null,pendingRequests:null,srsInBBOX:!1,initialize:function(a){a=a||{};this.params={};this.pendingRequests={};OpenLayers.Protocol.prototype.initialize.apply(this,arguments);this.format||(this.format=new OpenLayers.Format.GeoJSON);if(!this.filterToParams&&OpenLayers.Format.QueryStringFilter){var b=
new OpenLayers.Format.QueryStringFilter({srsInBBOX:this.srsInBBOX});this.filterToParams=function(a,d){return b.write(a,d)}}},read:function(a){OpenLayers.Protocol.prototype.read.apply(this,arguments);a=OpenLayers.Util.applyDefaults(a,this.options);a.params=OpenLayers.Util.applyDefaults(a.params,this.options.params);a.filter&&this.filterToParams&&(a.params=this.filterToParams(a.filter,a.params));var b=new OpenLayers.Protocol.Response({requestType:"read"}),c=this.createRequest(a.url,a.params,OpenLayers.Function.bind(function(c){b.data=
c;this.handleRead(b,a)},this));b.priv=c;return b},createRequest:function(a,b,c){var c=OpenLayers.Protocol.Script.register(c),d=OpenLayers.String.format(this.callbackTemplate,{id:c}),b=OpenLayers.Util.extend({},b);b[this.callbackKey]=this.callbackPrefix+d;a=OpenLayers.Util.urlAppend(a,OpenLayers.Util.getParameterString(b));b=document.createElement("script");b.type="text/javascript";b.src=a;b.id="OpenLayers_Protocol_Script_"+c;this.pendingRequests[b.id]=b;document.getElementsByTagName("head")[0].appendChild(b);
return b},destroyRequest:function(a){OpenLayers.Protocol.Script.unregister(a.id.split("_").pop());delete this.pendingRequests[a.id];a.parentNode&&a.parentNode.removeChild(a)},handleRead:function(a,b){this.handleResponse(a,b)},handleResponse:function(a,b){b.callback&&(a.data?(a.features=this.parseFeatures(a.data),a.code=OpenLayers.Protocol.Response.SUCCESS):a.code=OpenLayers.Protocol.Response.FAILURE,this.destroyRequest(a.priv),b.callback.call(b.scope,a))},parseFeatures:function(a){return this.format.read(a)},
abort:function(a){if(a)this.destroyRequest(a.priv);else for(var b in this.pendingRequests)this.destroyRequest(this.pendingRequests[b])},destroy:function(){this.abort();delete this.params;delete this.format;OpenLayers.Protocol.prototype.destroy.apply(this)},CLASS_NAME:"OpenLayers.Protocol.Script"});(function(){var a=OpenLayers.Protocol.Script,b=0;a.registry={};a.register=function(c){var d="c"+ ++b;a.registry[d]=function(){c.apply(this,arguments)};return d};a.unregister=function(b){delete a.registry[b]}})();OpenLayers.Control.Panel=OpenLayers.Class(OpenLayers.Control,{controls:null,autoActivate:!0,defaultControl:null,saveState:!1,allowDepress:!1,activeState:null,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,[a]);this.controls=[];this.activeState={}},destroy:function(){this.map&&this.map.events.unregister("buttonclick",this,this.onButtonClick);OpenLayers.Control.prototype.destroy.apply(this,arguments);for(var a,b=this.controls.length-1;0<=b;b--)a=this.controls[b],a.events&&
a.events.un({activate:this.iconOn,deactivate:this.iconOff}),a.panel_div=null;this.activeState=null},activate:function(){if(OpenLayers.Control.prototype.activate.apply(this,arguments)){for(var a,b=0,c=this.controls.length;b<c;b++)a=this.controls[b],(a===this.defaultControl||this.saveState&&this.activeState[a.id])&&a.activate();!0===this.saveState&&(this.defaultControl=null);this.redraw();return!0}return!1},deactivate:function(){if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){for(var a,
b=0,c=this.controls.length;b<c;b++)a=this.controls[b],this.activeState[a.id]=a.deactivate();this.redraw();return!0}return!1},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.outsideViewport?(this.events.attachToElement(this.div),this.events.register("buttonclick",this,this.onButtonClick)):this.map.events.register("buttonclick",this,this.onButtonClick);this.addControlsToMap(this.controls);return this.div},redraw:function(){for(var a=this.div.childNodes.length-1;0<=a;a--)this.div.removeChild(this.div.childNodes[a]);
this.div.innerHTML="";if(this.active)for(var a=0,b=this.controls.length;a<b;a++)this.div.appendChild(this.controls[a].panel_div)},activateControl:function(a){if(!this.active)return!1;if(a.type==OpenLayers.Control.TYPE_BUTTON)a.trigger();else if(a.type==OpenLayers.Control.TYPE_TOGGLE)a.active?a.deactivate():a.activate();else if(this.allowDepress&&a.active)a.deactivate();else{for(var b,c=0,d=this.controls.length;c<d;c++)b=this.controls[c],b!=a&&(b.type===OpenLayers.Control.TYPE_TOOL||null==b.type)&&
b.deactivate();a.activate()}},addControls:function(a){OpenLayers.Util.isArray(a)||(a=[a]);this.controls=this.controls.concat(a);for(var b=0,c=a.length;b<c;b++){var d=a[b],e=this.createControlMarkup(d);OpenLayers.Element.addClass(e,d.displayClass+"ItemInactive");OpenLayers.Element.addClass(e,"olButton");""!=d.title&&!e.title&&(e.title=d.title);d.panel_div=e}this.map&&(this.addControlsToMap(a),this.redraw())},createControlMarkup:function(){return document.createElement("div")},addControlsToMap:function(a){for(var b,
c=0,d=a.length;c<d;c++)b=a[c],!0===b.autoActivate?(b.autoActivate=!1,this.map.addControl(b),b.autoActivate=!0):(this.map.addControl(b),b.deactivate()),b.events.on({activate:this.iconOn,deactivate:this.iconOff})},iconOn:function(){var a=this.panel_div;a.className=a.className.replace(RegExp("\\b("+this.displayClass+"Item)Inactive\\b"),"$1Active")},iconOff:function(){var a=this.panel_div;a.className=a.className.replace(RegExp("\\b("+this.displayClass+"Item)Active\\b"),"$1Inactive")},onButtonClick:function(a){for(var b=
this.controls,a=a.buttonElement,c=b.length-1;0<=c;--c)if(b[c].panel_div===a){this.activateControl(b[c]);break}},getControlsBy:function(a,b){var c="function"==typeof b.test;return OpenLayers.Array.filter(this.controls,function(d){return d[a]==b||c&&b.test(d[a])})},getControlsByName:function(a){return this.getControlsBy("name",a)},getControlsByClass:function(a){return this.getControlsBy("CLASS_NAME",a)},CLASS_NAME:"OpenLayers.Control.Panel"});OpenLayers.Control.ZoomIn=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){this.map.zoomIn()},CLASS_NAME:"OpenLayers.Control.ZoomIn"});OpenLayers.Control.ZoomOut=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){this.map.zoomOut()},CLASS_NAME:"OpenLayers.Control.ZoomOut"});OpenLayers.Control.ZoomToMaxExtent=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){this.map&&this.map.zoomToMaxExtent()},CLASS_NAME:"OpenLayers.Control.ZoomToMaxExtent"});OpenLayers.Control.ZoomPanel=OpenLayers.Class(OpenLayers.Control.Panel,{initialize:function(a){OpenLayers.Control.Panel.prototype.initialize.apply(this,[a]);this.addControls([new OpenLayers.Control.ZoomIn,new OpenLayers.Control.ZoomToMaxExtent,new OpenLayers.Control.ZoomOut])},CLASS_NAME:"OpenLayers.Control.ZoomPanel"});OpenLayers.Layer.HTTPRequest=OpenLayers.Class(OpenLayers.Layer,{URL_HASH_FACTOR:(Math.sqrt(5)-1)/2,url:null,params:null,reproject:!1,initialize:function(a,b,c,d){OpenLayers.Layer.prototype.initialize.apply(this,[a,d]);this.url=b;this.params||(this.params=OpenLayers.Util.extend({},c))},destroy:function(){this.params=this.url=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(a){null==a&&(a=new OpenLayers.Layer.HTTPRequest(this.name,this.url,this.params,this.getOptions()));
return a=OpenLayers.Layer.prototype.clone.apply(this,[a])},setUrl:function(a){this.url=a},mergeNewParams:function(a){this.params=OpenLayers.Util.extend(this.params,a);a=this.redraw();null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"params"});return a},redraw:function(a){return a?this.mergeNewParams({_olSalt:Math.random()}):OpenLayers.Layer.prototype.redraw.apply(this,[])},selectUrl:function(a,b){for(var c=1,d=0,e=a.length;d<e;d++)c*=a.charCodeAt(d)*this.URL_HASH_FACTOR,
c-=Math.floor(c);return b[Math.floor(c*b.length)]},getFullRequestString:function(a,b){var c=b||this.url,d=OpenLayers.Util.extend({},this.params),d=OpenLayers.Util.extend(d,a),e=OpenLayers.Util.getParameterString(d);OpenLayers.Util.isArray(c)&&(c=this.selectUrl(e,c));var e=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(c)),f;for(f in d)f.toUpperCase()in e&&delete d[f];e=OpenLayers.Util.getParameterString(d);return OpenLayers.Util.urlAppend(c,e)},CLASS_NAME:"OpenLayers.Layer.HTTPRequest"});OpenLayers.Tile=OpenLayers.Class({events:null,eventListeners:null,id:null,layer:null,url:null,bounds:null,size:null,position:null,isLoading:!1,initialize:function(a,b,c,d,e,f){this.layer=a;this.position=b.clone();this.setBounds(c);this.url=d;e&&(this.size=e.clone());this.id=OpenLayers.Util.createUniqueID("Tile_");OpenLayers.Util.extend(this,f);this.events=new OpenLayers.Events(this);if(this.eventListeners instanceof Object)this.events.on(this.eventListeners)},unload:function(){this.isLoading&&(this.isLoading=
!1,this.events.triggerEvent("unload"))},destroy:function(){this.position=this.size=this.bounds=this.layer=null;this.eventListeners&&this.events.un(this.eventListeners);this.events.destroy();this.events=this.eventListeners=null},draw:function(a){a||this.clear();var b=this.shouldDraw();b&&!a&&(b=!1!==this.events.triggerEvent("beforedraw"));return b},shouldDraw:function(){var a=!1,b=this.layer.maxExtent;if(b){var c=this.layer.map,c=c.baseLayer.wrapDateLine&&c.getMaxExtent();this.bounds.intersectsBounds(b,
{inclusive:!1,worldBounds:c})&&(a=!0)}return a||this.layer.displayOutsideMaxExtent},setBounds:function(a){a=a.clone();if(this.layer.map.baseLayer.wrapDateLine)var b=this.layer.map.getMaxExtent(),c=this.layer.map.getResolution(),a=a.wrapDateLine(b,{leftTolerance:c,rightTolerance:c});this.bounds=a},moveTo:function(a,b,c){null==c&&(c=!0);this.setBounds(a);this.position=b.clone();c&&this.draw()},clear:function(){},CLASS_NAME:"OpenLayers.Tile"});OpenLayers.Tile.Image=OpenLayers.Class(OpenLayers.Tile,{url:null,imgDiv:null,frame:null,imageReloadAttempts:null,layerAlphaHack:null,asyncRequestId:null,blankImageUrl:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAQAIBRAA7",maxGetUrlLength:null,canvasContext:null,crossOriginKeyword:null,initialize:function(a,b,c,d,e,f){OpenLayers.Tile.prototype.initialize.apply(this,arguments);this.url=d;this.layerAlphaHack=this.layer.alpha&&OpenLayers.Util.alphaHack();if(null!=this.maxGetUrlLength||
this.layer.gutter||this.layerAlphaHack)this.frame=document.createElement("div"),this.frame.style.position="absolute",this.frame.style.overflow="hidden";null!=this.maxGetUrlLength&&OpenLayers.Util.extend(this,OpenLayers.Tile.Image.IFrame)},destroy:function(){this.imgDiv&&(this.clear(),this.frame=this.imgDiv=null);this.asyncRequestId=null;OpenLayers.Tile.prototype.destroy.apply(this,arguments)},draw:function(){var a=OpenLayers.Tile.prototype.draw.apply(this,arguments);a?(this.layer!=this.layer.map.baseLayer&&
this.layer.reproject&&(this.bounds=this.getBoundsFromBaseLayer(this.position)),this.isLoading?this._loadEvent="reload":(this.isLoading=!0,this._loadEvent="loadstart"),this.positionTile(),this.renderTile()):this.unload();return a},renderTile:function(){this.layer.div.appendChild(this.getTile());if(this.layer.async){var a=this.asyncRequestId=(this.asyncRequestId||0)+1;this.layer.getURLasync(this.bounds,function(b){a==this.asyncRequestId&&(this.url=b,this.initImage())},this)}else this.url=this.layer.getURL(this.bounds),
this.initImage()},positionTile:function(){var a=this.getTile().style,b=this.frame?this.size:this.layer.getImageSize(this.bounds);a.left=this.position.x+"%";a.top=this.position.y+"%";a.width=b.w+"%";a.height=b.h+"%"},clear:function(){OpenLayers.Tile.prototype.clear.apply(this,arguments);var a=this.imgDiv;if(a){OpenLayers.Event.stopObservingElement(a);var b=this.getTile();b.parentNode===this.layer.div&&this.layer.div.removeChild(b);this.setImgSrc();!0===this.layerAlphaHack&&(a.style.filter="");OpenLayers.Element.removeClass(a,
"olImageLoadError")}this.canvasContext=null},getImage:function(){if(!this.imgDiv){this.imgDiv=document.createElement("img");this.imgDiv.className="olTileImage";this.imgDiv.galleryImg="no";var a=this.imgDiv.style;if(this.frame){var b=0,c=0;this.layer.gutter&&(b=100*(this.layer.gutter/this.layer.tileSize.w),c=100*(this.layer.gutter/this.layer.tileSize.h));a.left=-b+"%";a.top=-c+"%";a.width=2*b+100+"%";a.height=2*c+100+"%"}a.visibility="hidden";a.opacity=0;1>this.layer.opacity&&(a.filter="alpha(opacity="+
100*this.layer.opacity+")");a.position="absolute";this.layerAlphaHack&&(a.paddingTop=a.height,a.height="0",a.width="100%");this.frame&&this.frame.appendChild(this.imgDiv)}return this.imgDiv},initImage:function(){this.events.triggerEvent(this._loadEvent);var a=this.getImage();if(this.url&&a.getAttribute("src")==this.url)this.onImageLoad();else{var b=OpenLayers.Function.bind(function(){OpenLayers.Event.stopObservingElement(a);OpenLayers.Event.observe(a,"load",OpenLayers.Function.bind(this.onImageLoad,
this));OpenLayers.Event.observe(a,"error",OpenLayers.Function.bind(this.onImageError,this));this.imageReloadAttempts=0;this.setImgSrc(this.url)},this);a.getAttribute("src")==this.blankImageUrl?b():(OpenLayers.Event.observe(a,"load",b),OpenLayers.Event.observe(a,"error",b),this.crossOriginKeyword&&a.removeAttribute("crossorigin"),a.src=this.blankImageUrl)}},setImgSrc:function(a){var b=this.imgDiv;b.style.visibility="hidden";b.style.opacity=0;a&&(this.crossOriginKeyword&&("data:"!==a.substr(0,5)?b.setAttribute("crossorigin",
this.crossOriginKeyword):b.removeAttribute("crossorigin")),b.src=a)},getTile:function(){return this.frame?this.frame:this.getImage()},createBackBuffer:function(){if(this.imgDiv&&!this.isLoading){var a;this.frame?(a=this.frame.cloneNode(!1),a.appendChild(this.imgDiv)):a=this.imgDiv;this.imgDiv=null;return a}},onImageLoad:function(){var a=this.imgDiv;OpenLayers.Event.stopObservingElement(a);a.style.visibility="inherit";a.style.opacity=this.layer.opacity;this.isLoading=!1;this.canvasContext=null;this.events.triggerEvent("loadend");
if(7>parseFloat(navigator.appVersion.split("MSIE")[1])&&this.layer&&this.layer.div){var b=document.createElement("span");b.style.display="none";var c=this.layer.div;c.appendChild(b);window.setTimeout(function(){b.parentNode===c&&b.parentNode.removeChild(b)},0)}!0===this.layerAlphaHack&&(a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+a.src+"', sizingMethod='scale')")},onImageError:function(){var a=this.imgDiv;null!=a.src&&(this.imageReloadAttempts++,this.imageReloadAttempts<=
OpenLayers.IMAGE_RELOAD_ATTEMPTS?this.setImgSrc(this.layer.getURL(this.bounds)):(OpenLayers.Element.addClass(a,"olImageLoadError"),this.events.triggerEvent("loaderror"),this.onImageLoad()))},getCanvasContext:function(){if(OpenLayers.CANVAS_SUPPORTED&&this.imgDiv&&!this.isLoading){if(!this.canvasContext){var a=document.createElement("canvas");a.width=this.size.w;a.height=this.size.h;this.canvasContext=a.getContext("2d");this.canvasContext.drawImage(this.imgDiv,0,0)}return this.canvasContext}},CLASS_NAME:"OpenLayers.Tile.Image"});OpenLayers.Layer.Grid=OpenLayers.Class(OpenLayers.Layer.HTTPRequest,{tileSize:null,tileOriginCorner:"bl",tileOrigin:null,tileOptions:null,tileClass:OpenLayers.Tile.Image,grid:null,singleTile:!1,ratio:1.5,buffer:0,transitionEffect:null,numLoadingTiles:0,tileLoadingDelay:85,serverResolutions:null,moveTimerId:null,deferMoveGriddedTiles:null,tileQueueId:null,tileQueue:null,loading:!1,backBuffer:null,gridResolution:null,backBufferResolution:null,backBufferLonLat:null,backBufferTimerId:null,removeBackBufferDelay:null,
className:null,initialize:function(a,b,c,d){OpenLayers.Layer.HTTPRequest.prototype.initialize.apply(this,arguments);this.grid=[];this.tileQueue=[];null===this.removeBackBufferDelay&&(this.removeBackBufferDelay=this.singleTile?0:2500);null===this.className&&(this.className=this.singleTile?"olLayerGridSingleTile":"olLayerGrid");OpenLayers.Animation.isNative||(this.deferMoveGriddedTiles=OpenLayers.Function.bind(function(){this.moveGriddedTiles(true);this.moveTimerId=null},this))},setMap:function(a){OpenLayers.Layer.HTTPRequest.prototype.setMap.call(this,
a);OpenLayers.Element.addClass(this.div,this.className)},removeMap:function(){null!==this.moveTimerId&&(window.clearTimeout(this.moveTimerId),this.moveTimerId=null);this.clearTileQueue();null!==this.backBufferTimerId&&(window.clearTimeout(this.backBufferTimerId),this.backBufferTimerId=null)},destroy:function(){this.removeBackBuffer();this.clearGrid();this.tileSize=this.grid=null;OpenLayers.Layer.HTTPRequest.prototype.destroy.apply(this,arguments)},clearGrid:function(){this.clearTileQueue();if(this.grid){for(var a=
0,b=this.grid.length;a<b;a++)for(var c=this.grid[a],d=0,e=c.length;d<e;d++)this.destroyTile(c[d]);this.grid=[];this.gridResolution=null}},clone:function(a){null==a&&(a=new OpenLayers.Layer.Grid(this.name,this.url,this.params,this.getOptions()));a=OpenLayers.Layer.HTTPRequest.prototype.clone.apply(this,[a]);null!=this.tileSize&&(a.tileSize=this.tileSize.clone());a.grid=[];a.gridResolution=null;a.backBuffer=null;a.backBufferTimerId=null;a.tileQueue=[];a.tileQueueId=null;a.loading=!1;a.moveTimerId=null;
return a},moveTo:function(a,b,c){OpenLayers.Layer.HTTPRequest.prototype.moveTo.apply(this,arguments);a=a||this.map.getExtent();if(null!=a){var d=!this.grid.length||b,e=this.getTilesBounds(),f=this.map.getResolution(),g=this.getServerResolution(f);if(this.singleTile){if(d||!c&&!e.containsBounds(a))b&&"resize"!==this.transitionEffect&&this.removeBackBuffer(),(!b||"resize"===this.transitionEffect)&&this.applyBackBuffer(g),this.initSingleTile(a)}else(d=d||!e.intersectsBounds(a,{worldBounds:this.map.baseLayer.wrapDateLine&&
this.map.getMaxExtent()}),f!==g?(a=this.map.calculateBounds(null,g),d&&this.transformDiv(g/f)):(this.div.style.width="100%",this.div.style.height="100%",this.div.style.left="0%",this.div.style.top="0%"),d)?(b&&"resize"===this.transitionEffect&&this.applyBackBuffer(g),this.initGriddedTiles(a)):this.moveGriddedTiles()}},getTileData:function(a){var b=null,c=a.lon,d=a.lat,e=this.grid.length;if(this.map&&e){var f=this.map.getResolution(),a=this.tileSize.w,g=this.tileSize.h,h=this.grid[0][0].bounds,i=h.left,
h=h.top;if(c<i&&this.map.baseLayer.wrapDateLine)var j=this.map.getMaxExtent().getWidth(),k=Math.ceil((i-c)/j),c=c+j*k;c=(c-i)/(f*a);d=(h-d)/(f*g);f=Math.floor(c);i=Math.floor(d);0<=i&&i<e&&(e=this.grid[i][f])&&(b={tile:e,i:Math.floor((c-f)*a),j:Math.floor((d-i)*g)})}return b},queueTileDraw:function(a){a=a.object;~OpenLayers.Util.indexOf(this.tileQueue,a)||this.tileQueue.push(a);this.tileQueueId||(this.tileQueueId=OpenLayers.Animation.start(OpenLayers.Function.bind(this.drawTileFromQueue,this),null,
this.div));return!1},drawTileFromQueue:function(){0===this.tileQueue.length?this.clearTileQueue():this.tileQueue.shift().draw(!0)},clearTileQueue:function(){OpenLayers.Animation.stop(this.tileQueueId);this.tileQueueId=null;this.tileQueue=[]},destroyTile:function(a){this.removeTileMonitoringHooks(a);a.destroy()},getServerResolution:function(a){a=a||this.map.getResolution();if(this.serverResolutions&&-1===OpenLayers.Util.indexOf(this.serverResolutions,a)){var b,c;for(b=this.serverResolutions.length-
1;0<=b;b--)if(c=this.serverResolutions[b],c>a){a=c;break}if(-1===b)throw"no appropriate resolution in serverResolutions";}return a},getServerZoom:function(){var a=this.getServerResolution();return this.serverResolutions?OpenLayers.Util.indexOf(this.serverResolutions,a):this.map.getZoomForResolution(a)+(this.zoomOffset||0)},transformDiv:function(a){this.div.style.width=100*a+"%";this.div.style.height=100*a+"%";var b=this.map.getSize(),c=parseInt(this.map.layerContainerDiv.style.left,10),d=(parseInt(this.map.layerContainerDiv.style.top,
10)-b.h/2)*(a-1);this.div.style.left=(c-b.w/2)*(a-1)+"%";this.div.style.top=d+"%"},getResolutionScale:function(){return parseInt(this.div.style.width,10)/100},applyBackBuffer:function(a){null!==this.backBufferTimerId&&this.removeBackBuffer();var b=this.backBuffer;if(!b){b=this.createBackBuffer();if(!b)return;this.div.insertBefore(b,this.div.firstChild);this.backBuffer=b;var c=this.grid[0][0].bounds;this.backBufferLonLat={lon:c.left,lat:c.top};this.backBufferResolution=this.gridResolution}var c=b.style,
d=this.backBufferResolution/a;c.width=100*d+"%";c.height=100*d+"%";a=this.getViewPortPxFromLonLat(this.backBufferLonLat,a);c=parseInt(this.map.layerContainerDiv.style.left,10);d=parseInt(this.map.layerContainerDiv.style.top,10);b.style.left=Math.round(a.x-c)+"%";b.style.top=Math.round(a.y-d)+"%"},createBackBuffer:function(){var a;if(0<this.grid.length){a=document.createElement("div");a.id=this.div.id+"_bb";a.className="olBackBuffer";a.style.position="absolute";a.style.width="100%";a.style.height=
"100%";for(var b=0,c=this.grid.length;b<c;b++)for(var d=0,e=this.grid[b].length;d<e;d++){var f=this.grid[b][d].createBackBuffer();f&&(f.style.top=b*this.tileSize.h+"%",f.style.left=d*this.tileSize.w+"%",a.appendChild(f))}}return a},removeBackBuffer:function(){this.backBuffer&&(this.div.removeChild(this.backBuffer),this.backBufferResolution=this.backBuffer=null,null!==this.backBufferTimerId&&(window.clearTimeout(this.backBufferTimerId),this.backBufferTimerId=null))},moveByPx:function(){this.singleTile||
this.moveGriddedTiles()},setTileSize:function(a){this.singleTile&&(a=this.map.getSize(),a.h=parseInt(a.h*this.ratio),a.w=parseInt(a.w*this.ratio));OpenLayers.Layer.HTTPRequest.prototype.setTileSize.apply(this,[a])},getTilesBounds:function(){var a=null,b=this.grid.length;if(b)var a=this.grid[b-1][0].bounds,b=this.grid[0].length*a.getWidth(),c=this.grid.length*a.getHeight(),a=new OpenLayers.Bounds(a.left,a.bottom,a.left+b,a.bottom+c);return a},initSingleTile:function(a){this.clearTileQueue();var b=
a.getCenterLonLat(),c=a.getWidth()*this.ratio,a=a.getHeight()*this.ratio,b=new OpenLayers.Bounds(b.lon-c/2,b.lat-a/2,b.lon+c/2,b.lat+a/2),c=this.map.getLayerPxFromLonLat({lon:b.left,lat:b.top});this.grid.length||(this.grid[0]=[]);(a=this.grid[0][0])?a.moveTo(b,c):(a=this.addTile(b,c),this.addTileMonitoringHooks(a),a.draw(),this.grid[0][0]=a);this.removeExcessTiles(1,1);this.gridResolution=this.getServerResolution()},calculateGridLayout:function(a,b,c){var d=c*this.tileSize.w,c=c*this.tileSize.h,e=
a.left-b.lon,f=Math.floor(e/d)-this.buffer,e=-(e/d-f)*this.tileSize.w,f=b.lon+f*d,a=a.top-(b.lat+c),g=Math.ceil(a/c)+this.buffer;return{tilelon:d,tilelat:c,tileoffsetlon:f,tileoffsetlat:b.lat+g*c,tileoffsetx:e,tileoffsety:-(g-a/c)*this.tileSize.h}},getTileOrigin:function(){var a=this.tileOrigin;if(!a)var a=this.getMaxExtent(),b={tl:["left","top"],tr:["right","top"],bl:["left","bottom"],br:["right","bottom"]}[this.tileOriginCorner],a=new OpenLayers.LonLat(a[b[0]],a[b[1]]);return a},initGriddedTiles:function(a){this.clearTileQueue();
var b=this.map.getSize(),c=Math.ceil(b.h/this.tileSize.h)+Math.max(1,2*this.buffer),b=Math.ceil(b.w/this.tileSize.w)+Math.max(1,2*this.buffer),d=this.getTileOrigin(),e=this.getServerResolution(),d=this.calculateGridLayout(a,d,e),e=Math.round(d.tileoffsetx),f=Math.round(d.tileoffsety),g=d.tileoffsetlon,h=d.tileoffsetlat,i=d.tilelon,j=d.tilelat,k=e,l=g,m=0,n=parseInt(this.map.layerContainerDiv.style.left),o=parseInt(this.map.layerContainerDiv.style.top),d=[],p=this.map.getCenter();do{var q=this.grid[m++];
q||(q=[],this.grid.push(q));var g=l,e=k,r=0;do{var s=new OpenLayers.Bounds(g,h,g+i,h+j),t=e,t=t-n,u=f,u=u-o,u=new OpenLayers.Pixel(t,u);(t=q[r++])?t.moveTo(s,u,!1):(t=this.addTile(s,u),this.addTileMonitoringHooks(t),q.push(t));s=s.getCenterLonLat();d.push({tile:t,distance:Math.pow(s.lon-p.lon,2)+Math.pow(s.lat-p.lat,2)});g+=i;e+=this.tileSize.w}while(g<=a.right+i*this.buffer||r<b);h-=j;f+=this.tileSize.h}while(h>=a.bottom-j*this.buffer||m<c);this.removeExcessTiles(m,r);this.gridResolution=this.getServerResolution();
d.sort(function(a,b){return a.distance-b.distance});a=0;for(c=d.length;a<c;++a)d[a].tile.draw()},getMaxExtent:function(){return this.maxExtent},addTile:function(a,b){var c=new this.tileClass(this,b,a,null,this.tileSize,this.tileOptions);c.events.register("beforedraw",this,this.queueTileDraw);return c},addTileMonitoringHooks:function(a){a.onLoadStart=function(){!1===this.loading&&(this.loading=!0,this.events.triggerEvent("loadstart"));this.events.triggerEvent("tileloadstart",{tile:a});this.numLoadingTiles++};
a.onLoadEnd=function(){this.numLoadingTiles--;this.events.triggerEvent("tileloaded",{tile:a});0===this.tileQueue.length&&0===this.numLoadingTiles&&(this.loading=!1,this.events.triggerEvent("loadend"),this.backBuffer&&(this.backBufferTimerId=window.setTimeout(OpenLayers.Function.bind(this.removeBackBuffer,this),this.removeBackBufferDelay)))};a.onLoadError=function(){this.events.triggerEvent("tileerror",{tile:a})};a.events.on({loadstart:a.onLoadStart,loadend:a.onLoadEnd,unload:a.onLoadEnd,loaderror:a.onLoadError,
scope:this})},removeTileMonitoringHooks:function(a){a.unload();a.events.un({loadstart:a.onLoadStart,loadend:a.onLoadEnd,unload:a.onLoadEnd,loaderror:a.onLoadError,scope:this})},moveGriddedTiles:function(a){if(!a&&!OpenLayers.Animation.isNative)null!=this.moveTimerId&&window.clearTimeout(this.moveTimerId),this.moveTimerId=window.setTimeout(this.deferMoveGriddedTiles,this.tileLoadingDelay);else for(var a=this.buffer||1,b=this.getResolutionScale();;){var c=this.grid[0][0].position.x*b+parseInt(this.div.style.left,
10)+parseInt(this.map.layerContainerDiv.style.left),d=this.grid[0][0].position.y*b+parseInt(this.div.style.top,10)+parseInt(this.map.layerContainerDiv.style.top),e=this.tileSize.w*b,f=this.tileSize.h*b;if(c>-e*(a-1))this.shiftColumn(!0);else if(c<-e*a)this.shiftColumn(!1);else if(d>-f*(a-1))this.shiftRow(!0);else if(d<-f*a)this.shiftRow(!1);else break}},shiftRow:function(a){for(var b=this.grid,c=b[a?0:this.grid.length-1],d=this.getServerResolution(),e=a?-this.tileSize.h:this.tileSize.h,d=d*-e,f=a?
b.pop():b.shift(),g=0,h=c.length;g<h;g++){var i=c[g],j=i.bounds.clone(),i=i.position.clone();j.bottom+=d;j.top+=d;i.y+=e;f[g].moveTo(j,i)}a?b.unshift(f):b.push(f)},shiftColumn:function(a){for(var b=a?-this.tileSize.w:this.tileSize.w,c=this.getServerResolution()*b,d=0,e=this.grid.length;d<e;d++){var f=this.grid[d],g=f[a?0:f.length-1],h=g.bounds.clone(),g=g.position.clone();h.left+=c;h.right+=c;g.x+=b;var i=a?this.grid[d].pop():this.grid[d].shift();i.moveTo(h,g);a?f.unshift(i):f.push(i)}},removeExcessTiles:function(a,
b){for(var c,d;this.grid.length>a;){var e=this.grid.pop();c=0;for(d=e.length;c<d;c++){var f=e[c];this.destroyTile(f)}}c=0;for(d=this.grid.length;c<d;c++)for(;this.grid[c].length>b;)e=this.grid[c],f=e.pop(),this.destroyTile(f)},onMapResize:function(){this.singleTile&&(this.clearGrid(),this.setTileSize())},getTileBounds:function(a){var b=this.maxExtent,c=this.getResolution(),d=c*this.tileSize.w,c=c*this.tileSize.h,e=this.getLonLatFromViewPortPx(a),a=b.left+d*Math.floor((e.lon-b.left)/d),b=b.bottom+
c*Math.floor((e.lat-b.bottom)/c);return new OpenLayers.Bounds(a,b,a+d,b+c)},CLASS_NAME:"OpenLayers.Layer.Grid"});OpenLayers.Format.ArcXML=OpenLayers.Class(OpenLayers.Format.XML,{fontStyleKeys:"antialiasing blockout font fontcolor fontsize fontstyle glowing interval outline printmode shadow transparency".split(" "),request:null,response:null,initialize:function(a){this.request=new OpenLayers.Format.ArcXML.Request;this.response=new OpenLayers.Format.ArcXML.Response;if(a)if("feature"==a.requesttype){this.request.get_image=null;var b=this.request.get_feature.query;this.addCoordSys(b.featurecoordsys,a.featureCoordSys);
this.addCoordSys(b.filtercoordsys,a.filterCoordSys);a.polygon?(b.isspatial=!0,b.spatialfilter.polygon=a.polygon):a.envelope&&(b.isspatial=!0,b.spatialfilter.envelope={minx:0,miny:0,maxx:0,maxy:0},this.parseEnvelope(b.spatialfilter.envelope,a.envelope))}else"image"==a.requesttype?(this.request.get_feature=null,b=this.request.get_image.properties,this.parseEnvelope(b.envelope,a.envelope),this.addLayers(b.layerlist,a.layers),this.addImageSize(b.imagesize,a.tileSize),this.addCoordSys(b.featurecoordsys,
a.featureCoordSys),this.addCoordSys(b.filtercoordsys,a.filterCoordSys)):this.request=null;OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},parseEnvelope:function(a,b){b&&4==b.length&&(a.minx=b[0],a.miny=b[1],a.maxx=b[2],a.maxy=b[3])},addLayers:function(a,b){for(var c=0,d=b.length;c<d;c++)a.push(b[c])},addImageSize:function(a,b){null!==b&&(a.width=b.w,a.height=b.h,a.printwidth=b.w,a.printheight=b.h)},addCoordSys:function(a,b){"string"==typeof b?(a.id=parseInt(b),a.string=b):"object"==typeof b&&
null!==b.proj&&(a.id=b.proj.srsProjNumber,a.string=b.proj.srsCode)},iserror:function(a){var b=null;a?(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]),a=a.documentElement.getElementsByTagName("ERROR"),b=null!==a&&0<a.length):b=""!==this.response.error;return b},read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=null;a&&a.documentElement&&(b="ARCXML"==a.documentElement.nodeName?a.documentElement:a.documentElement.getElementsByTagName("ARCXML")[0]);
if(!b||"parsererror"===b.firstChild.nodeName){var c,d;try{c=a.firstChild.nodeValue,d=a.firstChild.childNodes[1].firstChild.nodeValue}catch(e){}throw{message:"Error parsing the ArcXML request",error:c,source:d};}return this.parseResponse(b)},write:function(a){a||(a=this.request);var b=this.createElementNS("","ARCXML");b.setAttribute("version","1.1");var c=this.createElementNS("","REQUEST");if(null!=a.get_image){var d=this.createElementNS("","GET_IMAGE");c.appendChild(d);var e=this.createElementNS("",
"PROPERTIES");d.appendChild(e);a=a.get_image.properties;null!=a.featurecoordsys&&(d=this.createElementNS("","FEATURECOORDSYS"),e.appendChild(d),0===a.featurecoordsys.id?d.setAttribute("string",a.featurecoordsys.string):d.setAttribute("id",a.featurecoordsys.id));null!=a.filtercoordsys&&(d=this.createElementNS("","FILTERCOORDSYS"),e.appendChild(d),0===a.filtercoordsys.id?d.setAttribute("string",a.filtercoordsys.string):d.setAttribute("id",a.filtercoordsys.id));null!=a.envelope&&(d=this.createElementNS("",
"ENVELOPE"),e.appendChild(d),d.setAttribute("minx",a.envelope.minx),d.setAttribute("miny",a.envelope.miny),d.setAttribute("maxx",a.envelope.maxx),d.setAttribute("maxy",a.envelope.maxy));d=this.createElementNS("","IMAGESIZE");e.appendChild(d);d.setAttribute("height",a.imagesize.height);d.setAttribute("width",a.imagesize.width);if(a.imagesize.height!=a.imagesize.printheight||a.imagesize.width!=a.imagesize.printwidth)d.setAttribute("printheight",a.imagesize.printheight),d.setArrtibute("printwidth",a.imagesize.printwidth);
null!=a.background&&(d=this.createElementNS("","BACKGROUND"),e.appendChild(d),d.setAttribute("color",a.background.color.r+","+a.background.color.g+","+a.background.color.b),null!==a.background.transcolor&&d.setAttribute("transcolor",a.background.transcolor.r+","+a.background.transcolor.g+","+a.background.transcolor.b));if(null!=a.layerlist&&0<a.layerlist.length){d=this.createElementNS("","LAYERLIST");e.appendChild(d);for(e=0;e<a.layerlist.length;e++){var f=this.createElementNS("","LAYERDEF");d.appendChild(f);
f.setAttribute("id",a.layerlist[e].id);f.setAttribute("visible",a.layerlist[e].visible);if("object"==typeof a.layerlist[e].query){var g=a.layerlist[e].query;if(0>g.where.length)continue;var h=null,h="boolean"==typeof g.spatialfilter&&g.spatialfilter?this.createElementNS("","SPATIALQUERY"):this.createElementNS("","QUERY");h.setAttribute("where",g.where);"number"==typeof g.accuracy&&0<g.accuracy&&h.setAttribute("accuracy",g.accuracy);"number"==typeof g.featurelimit&&2E3>g.featurelimit&&h.setAttribute("featurelimit",
g.featurelimit);"string"==typeof g.subfields&&"#ALL#"!=g.subfields&&h.setAttribute("subfields",g.subfields);"string"==typeof g.joinexpression&&0<g.joinexpression.length&&h.setAttribute("joinexpression",g.joinexpression);"string"==typeof g.jointables&&0<g.jointables.length&&h.setAttribute("jointables",g.jointables);f.appendChild(h)}"object"==typeof a.layerlist[e].renderer&&this.addRenderer(f,a.layerlist[e].renderer)}}}else if(null!=a.get_feature&&(d=this.createElementNS("","GET_FEATURES"),d.setAttribute("outputmode",
"newxml"),d.setAttribute("checkesc","true"),a.get_feature.geometry?d.setAttribute("geometry",a.get_feature.geometry):d.setAttribute("geometry","false"),a.get_feature.compact&&d.setAttribute("compact",a.get_feature.compact),"number"==a.get_feature.featurelimit&&d.setAttribute("featurelimit",a.get_feature.featurelimit),d.setAttribute("globalenvelope","true"),c.appendChild(d),null!=a.get_feature.layer&&0<a.get_feature.layer.length&&(e=this.createElementNS("","LAYER"),e.setAttribute("id",a.get_feature.layer),
d.appendChild(e)),a=a.get_feature.query,null!=a))e=null,e=a.isspatial?this.createElementNS("","SPATIALQUERY"):this.createElementNS("","QUERY"),d.appendChild(e),"number"==typeof a.accuracy&&e.setAttribute("accuracy",a.accuracy),null!=a.featurecoordsys&&(d=this.createElementNS("","FEATURECOORDSYS"),0==a.featurecoordsys.id?d.setAttribute("string",a.featurecoordsys.string):d.setAttribute("id",a.featurecoordsys.id),e.appendChild(d)),null!=a.filtercoordsys&&(d=this.createElementNS("","FILTERCOORDSYS"),
0===a.filtercoordsys.id?d.setAttribute("string",a.filtercoordsys.string):d.setAttribute("id",a.filtercoordsys.id),e.appendChild(d)),0<a.buffer&&(d=this.createElementNS("","BUFFER"),d.setAttribute("distance",a.buffer),e.appendChild(d)),a.isspatial&&(d=this.createElementNS("","SPATIALFILTER"),d.setAttribute("relation",a.spatialfilter.relation),e.appendChild(d),a.spatialfilter.envelope?(f=this.createElementNS("","ENVELOPE"),f.setAttribute("minx",a.spatialfilter.envelope.minx),f.setAttribute("miny",a.spatialfilter.envelope.miny),
f.setAttribute("maxx",a.spatialfilter.envelope.maxx),f.setAttribute("maxy",a.spatialfilter.envelope.maxy),d.appendChild(f)):"object"==typeof a.spatialfilter.polygon&&d.appendChild(this.writePolygonGeometry(a.spatialfilter.polygon))),null!=a.where&&0<a.where.length&&e.setAttribute("where",a.where);b.appendChild(c);return OpenLayers.Format.XML.prototype.write.apply(this,[b])},addGroupRenderer:function(a,b){var c=this.createElementNS("","GROUPRENDERER");a.appendChild(c);for(var d=0;d<b.length;d++)this.addRenderer(c,
b[d])},addRenderer:function(a,b){if(OpenLayers.Util.isArray(b))this.addGroupRenderer(a,b);else{var c=this.createElementNS("",b.type.toUpperCase()+"RENDERER");a.appendChild(c);"VALUEMAPRENDERER"==c.tagName?this.addValueMapRenderer(c,b):"VALUEMAPLABELRENDERER"==c.tagName?this.addValueMapLabelRenderer(c,b):"SIMPLELABELRENDERER"==c.tagName?this.addSimpleLabelRenderer(c,b):"SCALEDEPENDENTRENDERER"==c.tagName&&this.addScaleDependentRenderer(c,b)}},addScaleDependentRenderer:function(a,b){("string"==typeof b.lower||
"number"==typeof b.lower)&&a.setAttribute("lower",b.lower);("string"==typeof b.upper||"number"==typeof b.upper)&&a.setAttribute("upper",b.upper);this.addRenderer(a,b.renderer)},addValueMapLabelRenderer:function(a,b){a.setAttribute("lookupfield",b.lookupfield);a.setAttribute("labelfield",b.labelfield);if("object"==typeof b.exacts)for(var c=0,d=b.exacts.length;c<d;c++){var e=b.exacts[c],f=this.createElementNS("","EXACT");"string"==typeof e.value&&f.setAttribute("value",e.value);"string"==typeof e.label&&
f.setAttribute("label",e.label);"string"==typeof e.method&&f.setAttribute("method",e.method);a.appendChild(f);if("object"==typeof e.symbol){var g=null;"text"==e.symbol.type&&(g=this.createElementNS("","TEXTSYMBOL"));if(null!=g){for(var h=this.fontStyleKeys,i=0,j=h.length;i<j;i++){var k=h[i];e.symbol[k]&&g.setAttribute(k,e.symbol[k])}f.appendChild(g)}}}},addValueMapRenderer:function(a,b){a.setAttribute("lookupfield",b.lookupfield);if("object"==typeof b.ranges)for(var c=0,d=b.ranges.length;c<d;c++){var e=
b.ranges[c],f=this.createElementNS("","RANGE");f.setAttribute("lower",e.lower);f.setAttribute("upper",e.upper);a.appendChild(f);if("object"==typeof e.symbol){var g=null;"simplepolygon"==e.symbol.type&&(g=this.createElementNS("","SIMPLEPOLYGONSYMBOL"));null!=g&&("string"==typeof e.symbol.boundarycolor&&g.setAttribute("boundarycolor",e.symbol.boundarycolor),"string"==typeof e.symbol.fillcolor&&g.setAttribute("fillcolor",e.symbol.fillcolor),"number"==typeof e.symbol.filltransparency&&g.setAttribute("filltransparency",
e.symbol.filltransparency),f.appendChild(g))}}else if("object"==typeof b.exacts){c=0;for(d=b.exacts.length;c<d;c++)e=b.exacts[c],f=this.createElementNS("","EXACT"),"string"==typeof e.value&&f.setAttribute("value",e.value),"string"==typeof e.label&&f.setAttribute("label",e.label),"string"==typeof e.method&&f.setAttribute("method",e.method),a.appendChild(f),"object"==typeof e.symbol&&(g=null,"simplemarker"==e.symbol.type&&(g=this.createElementNS("","SIMPLEMARKERSYMBOL")),null!=g&&("string"==typeof e.symbol.antialiasing&&
g.setAttribute("antialiasing",e.symbol.antialiasing),"string"==typeof e.symbol.color&&g.setAttribute("color",e.symbol.color),"string"==typeof e.symbol.outline&&g.setAttribute("outline",e.symbol.outline),"string"==typeof e.symbol.overlap&&g.setAttribute("overlap",e.symbol.overlap),"string"==typeof e.symbol.shadow&&g.setAttribute("shadow",e.symbol.shadow),"number"==typeof e.symbol.transparency&&g.setAttribute("transparency",e.symbol.transparency),"string"==typeof e.symbol.usecentroid&&g.setAttribute("usecentroid",
e.symbol.usecentroid),"number"==typeof e.symbol.width&&g.setAttribute("width",e.symbol.width),f.appendChild(g)))}},addSimpleLabelRenderer:function(a,b){a.setAttribute("field",b.field);for(var c="featureweight howmanylabels labelbufferratio labelpriorities labelweight linelabelposition rotationalangles".split(" "),d=0,e=c.length;d<e;d++){var f=c[d];b[f]&&a.setAttribute(f,b[f])}if("text"==b.symbol.type){var g=b.symbol,h=this.createElementNS("","TEXTSYMBOL");a.appendChild(h);c=this.fontStyleKeys;d=0;
for(e=c.length;d<e;d++)f=c[d],g[f]&&h.setAttribute(f,b[f])}},writePolygonGeometry:function(a){if(!(a instanceof OpenLayers.Geometry.Polygon))throw{message:"Cannot write polygon geometry to ArcXML with an "+a.CLASS_NAME+" object.",geometry:a};for(var b=this.createElementNS("","POLYGON"),c=0,d=a.components.length;c<d;c++){for(var e=a.components[c],f=this.createElementNS("","RING"),g=0,h=e.components.length;g<h;g++){var i=e.components[g],j=this.createElementNS("","POINT");j.setAttribute("x",i.x);j.setAttribute("y",
i.y);f.appendChild(j)}b.appendChild(f)}return b},parseResponse:function(a){"string"==typeof a&&(a=(new OpenLayers.Format.XML).read(a));var b=new OpenLayers.Format.ArcXML.Response,c=a.getElementsByTagName("ERROR");if(null!=c&&0<c.length)b.error=this.getChildValue(c,"Unknown error.");else{c=a.getElementsByTagName("RESPONSE");if(null==c||0==c.length)return b.error="No RESPONSE tag found in ArcXML response.",b;var d=c[0].firstChild.nodeName;"#text"==d&&(d=c[0].firstChild.nextSibling.nodeName);if("IMAGE"==
d)c=a.getElementsByTagName("ENVELOPE"),a=a.getElementsByTagName("OUTPUT"),null==c||0==c.length?b.error="No ENVELOPE tag found in ArcXML response.":null==a||0==a.length?b.error="No OUTPUT tag found in ArcXML response.":(c=this.parseAttributes(c[0]),d=this.parseAttributes(a[0]),b.image="string"==typeof d.type?{envelope:c,output:{type:d.type,data:this.getChildValue(a[0])}}:{envelope:c,output:d});else if("FEATURES"==d){if(a=c[0].getElementsByTagName("FEATURES"),c=a[0].getElementsByTagName("FEATURECOUNT"),
b.features.featurecount=c[0].getAttribute("count"),0<b.features.featurecount){c=a[0].getElementsByTagName("ENVELOPE");b.features.envelope=this.parseAttributes(c[0],"number");a=a[0].getElementsByTagName("FEATURE");for(c=0;c<a.length;c++){for(var d=new OpenLayers.Feature.Vector,e=a[c].getElementsByTagName("FIELD"),f=0;f<e.length;f++){var g=e[f].getAttribute("name"),h=e[f].getAttribute("value");d.attributes[g]=h}e=a[c].getElementsByTagName("POLYGON");if(0<e.length){e=e[0].getElementsByTagName("RING");
f=[];for(g=0;g<e.length;g++){h=[];h.push(this.parsePointGeometry(e[g]));for(var i=e[g].getElementsByTagName("HOLE"),j=0;j<i.length;j++)h.push(this.parsePointGeometry(i[j]));f.push(new OpenLayers.Geometry.Polygon(h))}d.geometry=1==f.length?f[0]:new OpenLayers.Geometry.MultiPolygon(f)}b.features.feature.push(d)}}}else b.error="Unidentified response type."}return b},parseAttributes:function(a,b){for(var c={},d=0;d<a.attributes.length;d++)c[a.attributes[d].nodeName]="number"==b?parseFloat(a.attributes[d].nodeValue):
a.attributes[d].nodeValue;return c},parsePointGeometry:function(a){var b=[],c=a.getElementsByTagName("COORDS");if(0<c.length){a=this.getChildValue(c[0]);a=a.split(/;/);for(c=0;c<a.length;c++){var d=a[c].split(/ /);b.push(new OpenLayers.Geometry.Point(d[0],d[1]))}}else if(a=a.getElementsByTagName("POINT"),0<a.length)for(c=0;c<a.length;c++)b.push(new OpenLayers.Geometry.Point(parseFloat(a[c].getAttribute("x")),parseFloat(a[c].getAttribute("y"))));return new OpenLayers.Geometry.LinearRing(b)},CLASS_NAME:"OpenLayers.Format.ArcXML"});
OpenLayers.Format.ArcXML.Request=OpenLayers.Class({initialize:function(){return OpenLayers.Util.extend(this,{get_image:{properties:{background:null,draw:!0,envelope:{minx:0,miny:0,maxx:0,maxy:0},featurecoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},filtercoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},imagesize:{height:0,width:0,dpi:96,printheight:0,printwidth:0,scalesymbols:!1},layerlist:[],output:{baseurl:"",legendbaseurl:"",legendname:"",legendpath:"",
legendurl:"",name:"",path:"",type:"jpg",url:""}}},get_feature:{layer:"",query:{isspatial:!1,featurecoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},filtercoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},buffer:0,where:"",spatialfilter:{relation:"envelope_intersection",envelope:null}}},environment:{separators:{cs:" ",ts:";"}},layer:[],workspaces:[]})},CLASS_NAME:"OpenLayers.Format.ArcXML.Request"});
OpenLayers.Format.ArcXML.Response=OpenLayers.Class({initialize:function(){return OpenLayers.Util.extend(this,{image:{envelope:null,output:""},features:{featurecount:0,envelope:null,feature:[]},error:""})},CLASS_NAME:"OpenLayers.Format.ArcXML.Response"});OpenLayers.ProxyHost="";
OpenLayers.Request={DEFAULT_CONFIG:{method:"GET",url:window.location.href,async:!0,user:void 0,password:void 0,params:null,proxy:OpenLayers.ProxyHost,headers:{},data:null,callback:function(){},success:null,failure:null,scope:null},URL_SPLIT_REGEX:/([^:]*:)\/\/([^:]*:?[^@]*@)?([^:\/\?]*):?([^\/\?]*)/,events:new OpenLayers.Events(this),makeSameOrigin:function(a,b){var c=0!==a.indexOf("http"),d=!c&&a.match(this.URL_SPLIT_REGEX);if(d){var e=window.location,c=d[1]==e.protocol&&d[3]==e.hostname,d=d[4],
e=e.port;if(80!=d&&""!=d||"80"!=e&&""!=e)c=c&&d==e}c||(b?a="function"==typeof b?b(a):b+encodeURIComponent(a):OpenLayers.Console.warn(OpenLayers.i18n("proxyNeeded"),{url:a}));return a},issue:function(a){var b=OpenLayers.Util.extend(this.DEFAULT_CONFIG,{proxy:OpenLayers.ProxyHost}),a=OpenLayers.Util.applyDefaults(a,b),b=!1,c;for(c in a.headers)a.headers.hasOwnProperty(c)&&"x-requested-with"===c.toLowerCase()&&(b=!0);!1===b&&(a.headers["X-Requested-With"]="XMLHttpRequest");var d=new OpenLayers.Request.XMLHttpRequest,
e=OpenLayers.Util.urlAppend(a.url,OpenLayers.Util.getParameterString(a.params||{})),e=OpenLayers.Request.makeSameOrigin(e,a.proxy);d.open(a.method,e,a.async,a.user,a.password);for(var f in a.headers)d.setRequestHeader(f,a.headers[f]);var g=this.events,h=this;d.onreadystatechange=function(){d.readyState==OpenLayers.Request.XMLHttpRequest.DONE&&!1!==g.triggerEvent("complete",{request:d,config:a,requestUrl:e})&&h.runCallbacks({request:d,config:a,requestUrl:e})};!1===a.async?d.send(a.data):window.setTimeout(function(){0!==
d.readyState&&d.send(a.data)},0);return d},runCallbacks:function(a){var b=a.request,c=a.config,d=c.scope?OpenLayers.Function.bind(c.callback,c.scope):c.callback,e;c.success&&(e=c.scope?OpenLayers.Function.bind(c.success,c.scope):c.success);var f;c.failure&&(f=c.scope?OpenLayers.Function.bind(c.failure,c.scope):c.failure);"file:"==OpenLayers.Util.createUrlObject(c.url).protocol&&b.responseText&&(b.status=200);d(b);if(!b.status||200<=b.status&&300>b.status)this.events.triggerEvent("success",a),e&&e(b);
if(b.status&&(200>b.status||300<=b.status))this.events.triggerEvent("failure",a),f&&f(b)},GET:function(a){a=OpenLayers.Util.extend(a,{method:"GET"});return OpenLayers.Request.issue(a)},POST:function(a){a=OpenLayers.Util.extend(a,{method:"POST"});a.headers=a.headers?a.headers:{};"CONTENT-TYPE"in OpenLayers.Util.upperCaseObject(a.headers)||(a.headers["Content-Type"]="application/xml");return OpenLayers.Request.issue(a)},PUT:function(a){a=OpenLayers.Util.extend(a,{method:"PUT"});a.headers=a.headers?
a.headers:{};"CONTENT-TYPE"in OpenLayers.Util.upperCaseObject(a.headers)||(a.headers["Content-Type"]="application/xml");return OpenLayers.Request.issue(a)},DELETE:function(a){a=OpenLayers.Util.extend(a,{method:"DELETE"});return OpenLayers.Request.issue(a)},HEAD:function(a){a=OpenLayers.Util.extend(a,{method:"HEAD"});return OpenLayers.Request.issue(a)},OPTIONS:function(a){a=OpenLayers.Util.extend(a,{method:"OPTIONS"});return OpenLayers.Request.issue(a)}};OpenLayers.Layer.ArcIMS=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{ClientVersion:"9.2",ServiceName:""},featureCoordSys:"4326",filterCoordSys:"4326",layers:null,async:!0,name:"ArcIMS",isBaseLayer:!0,DEFAULT_OPTIONS:{tileSize:new OpenLayers.Size(512,512),featureCoordSys:"4326",filterCoordSys:"4326",layers:null,isBaseLayer:!0,async:!0,name:"ArcIMS"},initialize:function(a,b,c){this.tileSize=new OpenLayers.Size(512,512);this.params=OpenLayers.Util.applyDefaults({ServiceName:c.serviceName},
this.DEFAULT_PARAMS);this.options=OpenLayers.Util.applyDefaults(c,this.DEFAULT_OPTIONS);OpenLayers.Layer.Grid.prototype.initialize.apply(this,[a,b,this.params,c]);if(this.transparent&&(this.isBaseLayer||(this.isBaseLayer=!1),"image/jpeg"==this.format))this.format=OpenLayers.Util.alphaHack()?"image/gif":"image/png";null===this.options.layers&&(this.options.layers=[])},getURL:function(a){var b="",a=this.adjustBounds(a),a=new OpenLayers.Format.ArcXML(OpenLayers.Util.extend(this.options,{requesttype:"image",
envelope:a.toArray(),tileSize:this.tileSize})),a=new OpenLayers.Request.POST({url:this.getFullRequestString(),data:a.write(),async:!1});if(null!=a){b=a.responseXML;if(!b||!b.documentElement)b=a.responseText;b=this.getUrlOrImage((new OpenLayers.Format.ArcXML).read(b).image.output)}return b},getURLasync:function(a,b,c){a=this.adjustBounds(a);a=new OpenLayers.Format.ArcXML(OpenLayers.Util.extend(this.options,{requesttype:"image",envelope:a.toArray(),tileSize:this.tileSize}));OpenLayers.Request.POST({url:this.getFullRequestString(),
async:!0,data:a.write(),callback:function(a){var e=a.responseXML;if(!e||!e.documentElement)e=a.responseText;a=(new OpenLayers.Format.ArcXML).read(e);b.call(c,this.getUrlOrImage(a.image.output))},scope:this})},getUrlOrImage:function(a){var b="";a.url?b=a.url:a.data&&(b="data:image/"+a.type+";base64,"+a.data);return b},setLayerQuery:function(a,b){for(var c=0;c<this.options.layers.length;c++)if(a==this.options.layers[c].id){this.options.layers[c].query=b;return}this.options.layers.push({id:a,visible:!0,
query:b})},getFeatureInfo:function(a,b,c){var d=c.buffer||1,e=c.callback||function(){},f=c.scope||window,g={};OpenLayers.Util.extend(g,this.options);g.requesttype="feature";a instanceof OpenLayers.LonLat?(g.polygon=null,g.envelope=[a.lon-d,a.lat-d,a.lon+d,a.lat+d]):a instanceof OpenLayers.Geometry.Polygon&&(g.envelope=null,g.polygon=a);var h=new OpenLayers.Format.ArcXML(g);OpenLayers.Util.extend(h.request.get_feature,c);h.request.get_feature.layer=b.id;"number"==typeof b.query.accuracy?h.request.get_feature.query.accuracy=
b.query.accuracy:(a=this.map.getCenter(),c=this.map.getViewPortPxFromLonLat(a),c.x++,c=this.map.getLonLatFromPixel(c),h.request.get_feature.query.accuracy=c.lon-a.lon);h.request.get_feature.query.where=b.query.where;h.request.get_feature.query.spatialfilter.relation="area_intersection";OpenLayers.Request.POST({url:this.getFullRequestString({CustomService:"Query"}),data:h.write(),callback:function(a){a=h.parseResponse(a.responseText);h.iserror()?e.call(f,null):e.call(f,a.features)}})},clone:function(a){null==
a&&(a=new OpenLayers.Layer.ArcIMS(this.name,this.url,this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},CLASS_NAME:"OpenLayers.Layer.ArcIMS"});OpenLayers.Format.OWSCommon.v1_1_0=OpenLayers.Class(OpenLayers.Format.OWSCommon.v1,{namespaces:{ows:"http://www.opengis.net/ows/1.1",xlink:"http://www.w3.org/1999/xlink"},readers:{ows:OpenLayers.Util.applyDefaults({ExceptionReport:function(a,b){b.exceptionReport={version:a.getAttribute("version"),language:a.getAttribute("xml:lang"),exceptions:[]};this.readChildNodes(a,b.exceptionReport)},AllowedValues:function(a,b){b.allowedValues={};this.readChildNodes(a,b.allowedValues)},AnyValue:function(a,b){b.anyValue=
!0},DataType:function(a,b){b.dataType=this.getChildValue(a)},Range:function(a,b){b.range={};this.readChildNodes(a,b.range)},MinimumValue:function(a,b){b.minValue=this.getChildValue(a)},MaximumValue:function(a,b){b.maxValue=this.getChildValue(a)},Identifier:function(a,b){b.identifier=this.getChildValue(a)},SupportedCRS:function(a,b){b.supportedCRS=this.getChildValue(a)}},OpenLayers.Format.OWSCommon.v1.prototype.readers.ows)},writers:{ows:OpenLayers.Util.applyDefaults({Range:function(a){var b=this.createElementNSPlus("ows:Range",
{attributes:{"ows:rangeClosure":a.closure}});this.writeNode("ows:MinimumValue",a.minValue,b);this.writeNode("ows:MaximumValue",a.maxValue,b);return b},MinimumValue:function(a){return this.createElementNSPlus("ows:MinimumValue",{value:a})},MaximumValue:function(a){return this.createElementNSPlus("ows:MaximumValue",{value:a})},Value:function(a){return this.createElementNSPlus("ows:Value",{value:a})}},OpenLayers.Format.OWSCommon.v1.prototype.writers.ows)},CLASS_NAME:"OpenLayers.Format.OWSCommon.v1_1_0"});OpenLayers.Format.WCSGetCoverage=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ows:"http://www.opengis.net/ows/1.1",wcs:"http://www.opengis.net/wcs/1.1",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},VERSION:"1.1.2",schemaLocation:"http://www.opengis.net/wcs/1.1 http://schemas.opengis.net/wcs/1.1/wcsGetCoverage.xsd",write:function(a){a=this.writeNode("wcs:GetCoverage",
a);this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[a])},writers:{wcs:{GetCoverage:function(a){var b=this.createElementNSPlus("wcs:GetCoverage",{attributes:{version:a.version||this.VERSION,service:"WCS"}});this.writeNode("ows:Identifier",a.identifier,b);this.writeNode("wcs:DomainSubset",a.domainSubset,b);this.writeNode("wcs:Output",a.output,b);return b},DomainSubset:function(a){var b=this.createElementNSPlus("wcs:DomainSubset",
{});this.writeNode("ows:BoundingBox",a.boundingBox,b);a.temporalSubset&&this.writeNode("wcs:TemporalSubset",a.temporalSubset,b);return b},TemporalSubset:function(a){for(var b=this.createElementNSPlus("wcs:TemporalSubset",{}),c=0,d=a.timePeriods.length;c<d;++c)this.writeNode("wcs:TimePeriod",a.timePeriods[c],b);return b},TimePeriod:function(a){var b=this.createElementNSPlus("wcs:TimePeriod",{});this.writeNode("wcs:BeginPosition",a.begin,b);this.writeNode("wcs:EndPosition",a.end,b);a.resolution&&this.writeNode("wcs:TimeResolution",
a.resolution,b);return b},BeginPosition:function(a){return this.createElementNSPlus("wcs:BeginPosition",{value:a})},EndPosition:function(a){return this.createElementNSPlus("wcs:EndPosition",{value:a})},TimeResolution:function(a){return this.createElementNSPlus("wcs:TimeResolution",{value:a})},Output:function(a){var b=this.createElementNSPlus("wcs:Output",{attributes:{format:a.format,store:a.store}});a.gridCRS&&this.writeNode("wcs:GridCRS",a.gridCRS,b);return b},GridCRS:function(a){var b=this.createElementNSPlus("wcs:GridCRS",
{});this.writeNode("wcs:GridBaseCRS",a.baseCRS,b);a.type&&this.writeNode("wcs:GridType",a.type,b);a.origin&&this.writeNode("wcs:GridOrigin",a.origin,b);this.writeNode("wcs:GridOffsets",a.offsets,b);a.CS&&this.writeNode("wcs:GridCS",a.CS,b);return b},GridBaseCRS:function(a){return this.createElementNSPlus("wcs:GridBaseCRS",{value:a})},GridOrigin:function(a){return this.createElementNSPlus("wcs:GridOrigin",{value:a})},GridType:function(a){return this.createElementNSPlus("wcs:GridType",{value:a})},GridOffsets:function(a){return this.createElementNSPlus("wcs:GridOffsets",
{value:a})},GridCS:function(a){return this.createElementNSPlus("wcs:GridCS",{value:a})}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.writers.ows},CLASS_NAME:"OpenLayers.Format.WCSGetCoverage"});OpenLayers.Format.WPSExecute=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ows:"http://www.opengis.net/ows/1.1",gml:"http://www.opengis.net/gml",wps:"http://www.opengis.net/wps/1.0.0",wfs:"http://www.opengis.net/wfs",ogc:"http://www.opengis.net/ogc",wcs:"http://www.opengis.net/wcs",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/wps/1.0.0 http://schemas.opengis.net/wps/1.0.0/wpsAll.xsd",
schemaLocationAttr:function(){},write:function(a){var b;window.ActiveXObject?this.xmldom=b=new ActiveXObject("Microsoft.XMLDOM"):b=document.implementation.createDocument("","",null);a=this.writeNode("wps:Execute",a,b);this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[a])},writers:{wps:{Execute:function(a){var b=this.createElementNSPlus("wps:Execute",{attributes:{version:this.VERSION,service:"WPS"}});this.writeNode("ows:Identifier",
a.identifier,b);this.writeNode("wps:DataInputs",a.dataInputs,b);this.writeNode("wps:ResponseForm",a.responseForm,b);return b},ResponseForm:function(a){var b=this.createElementNSPlus("wps:ResponseForm",{});a.rawDataOutput&&this.writeNode("wps:RawDataOutput",a.rawDataOutput,b);a.responseDocument&&this.writeNode("wps:ResponseDocument",a.responseDocument,b);return b},ResponseDocument:function(a){var b=this.createElementNSPlus("wps:ResponseDocument",{attributes:{storeExecuteResponse:a.storeExecuteResponse,
lineage:a.lineage,status:a.status}});a.output&&this.writeNode("wps:Output",a.output,b);return b},Output:function(a){var b=this.createElementNSPlus("wps:Output",{attributes:{asReference:a.asReference}});this.writeNode("ows:Identifier",a.identifier,b);this.writeNode("ows:Title",a.title,b);this.writeNode("ows:Abstract",a["abstract"],b);return b},RawDataOutput:function(a){var b=this.createElementNSPlus("wps:RawDataOutput",{attributes:{mimeType:a.mimeType}});this.writeNode("ows:Identifier",a.identifier,
b);return b},DataInputs:function(a){for(var b=this.createElementNSPlus("wps:DataInputs",{}),c=0,d=a.length;c<d;++c)this.writeNode("wps:Input",a[c],b);return b},Input:function(a){var b=this.createElementNSPlus("wps:Input",{});this.writeNode("ows:Identifier",a.identifier,b);a.title&&this.writeNode("ows:Title",a.title,b);a.data&&this.writeNode("wps:Data",a.data,b);a.reference&&this.writeNode("wps:Reference",a.reference,b);return b},Data:function(a){var b=this.createElementNSPlus("wps:Data",{});a.literalData?
this.writeNode("wps:LiteralData",a.literalData,b):a.complexData&&this.writeNode("wps:ComplexData",a.complexData,b);return b},LiteralData:function(a){return this.createElementNSPlus("wps:LiteralData",{attributes:{uom:a.uom},value:a.value})},ComplexData:function(a){var b=this.createElementNSPlus("wps:ComplexData",{attributes:{mimeType:a.mimeType,encoding:a.encoding,schema:a.schema}}),c=a.value;"string"===typeof c?b.appendChild(this.getXMLDoc().createCDATASection(a.value)):b.appendChild(c);return b},
Reference:function(a){var b=this.createElementNSPlus("wps:Reference",{attributes:{mimeType:a.mimeType,"xlink:href":a.href,method:a.method,encoding:a.encoding,schema:a.schema}});a.body&&this.writeNode("wps:Body",a.body,b);return b},Body:function(a){var b=this.createElementNSPlus("wps:Body",{});a.wcs?this.writeNode("wcs:GetCoverage",a.wcs,b):a.wfs?(this.featureType=a.wfs.featureType,this.version=a.wfs.version,this.writeNode("wfs:GetFeature",a.wfs,b)):this.writeNode("wps:Execute",a,b);return b}},wcs:OpenLayers.Format.WCSGetCoverage.prototype.writers.wcs,
wfs:OpenLayers.Format.WFST.v1_1_0.prototype.writers.wfs,ogc:OpenLayers.Format.Filter.v1_1_0.prototype.writers.ogc,ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.writers.ows},CLASS_NAME:"OpenLayers.Format.WPSExecute"});OpenLayers.Control.PanZoom=OpenLayers.Class(OpenLayers.Control,{slideFactor:50,slideRatio:null,buttons:null,position:null,initialize:function(a){this.position=new OpenLayers.Pixel(OpenLayers.Control.PanZoom.X,OpenLayers.Control.PanZoom.Y);OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.map&&this.map.events.unregister("buttonclick",this,this.onButtonClick);this.removeButtons();this.position=this.buttons=null;OpenLayers.Control.prototype.destroy.apply(this,arguments)},
setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments);this.map.events.register("buttonclick",this,this.onButtonClick)},draw:function(a){OpenLayers.Control.prototype.draw.apply(this,arguments);a=this.position;this.buttons=[];var b={w:18,h:18},c=new OpenLayers.Pixel(a.x+b.w/2,a.y);this._addButton("panup","north-mini.png",c,b);a.y=c.y+b.h;this._addButton("panleft","west-mini.png",a,b);this._addButton("panright","east-mini.png",a.add(b.w,0),b);this._addButton("pandown","south-mini.png",
c.add(0,2*b.h),b);this._addButton("zoomin","zoom-plus-mini.png",c.add(0,3*b.h+5),b);this._addButton("zoomworld","zoom-world-mini.png",c.add(0,4*b.h+5),b);this._addButton("zoomout","zoom-minus-mini.png",c.add(0,5*b.h+5),b);return this.div},_addButton:function(a,b,c,d){b=OpenLayers.Util.getImageLocation(b);c=OpenLayers.Util.createAlphaImageDiv(this.id+"_"+a,c,d,b,"absolute");c.style.cursor="pointer";this.div.appendChild(c);c.action=a;c.className="olButton";this.buttons.push(c);return c},_removeButton:function(a){this.div.removeChild(a);
OpenLayers.Util.removeItem(this.buttons,a)},removeButtons:function(){for(var a=this.buttons.length-1;0<=a;--a)this._removeButton(this.buttons[a])},onButtonClick:function(a){switch(a.buttonElement.action){case "panup":this.map.pan(0,-this.getSlideFactor("h"));break;case "pandown":this.map.pan(0,this.getSlideFactor("h"));break;case "panleft":this.map.pan(-this.getSlideFactor("w"),0);break;case "panright":this.map.pan(this.getSlideFactor("w"),0);break;case "zoomin":this.map.zoomIn();break;case "zoomout":this.map.zoomOut();
break;case "zoomworld":this.map.zoomToMaxExtent()}},getSlideFactor:function(a){return this.slideRatio?this.map.getSize()[a]*this.slideRatio:this.slideFactor},CLASS_NAME:"OpenLayers.Control.PanZoom"});OpenLayers.Control.PanZoom.X=4;OpenLayers.Control.PanZoom.Y=4;OpenLayers.Control.PanZoomBar=OpenLayers.Class(OpenLayers.Control.PanZoom,{zoomStopWidth:18,zoomStopHeight:11,slider:null,sliderEvents:null,zoombarDiv:null,zoomWorldIcon:!1,panIcons:!0,forceFixedZoomLevel:!1,mouseDragStart:null,deltaY:null,zoomStart:null,destroy:function(){this._removeZoomBar();this.map.events.un({changebaselayer:this.redraw,scope:this});OpenLayers.Control.PanZoom.prototype.destroy.apply(this,arguments);delete this.mouseDragStart;delete this.zoomStart},setMap:function(a){OpenLayers.Control.PanZoom.prototype.setMap.apply(this,
arguments);this.map.events.register("changebaselayer",this,this.redraw)},redraw:function(){null!=this.div&&(this.removeButtons(),this._removeZoomBar());this.draw()},draw:function(a){OpenLayers.Control.prototype.draw.apply(this,arguments);a=this.position.clone();this.buttons=[];var b={w:18,h:18};if(this.panIcons){var c=new OpenLayers.Pixel(a.x+b.w/2,a.y),d=b.w;this.zoomWorldIcon&&(c=new OpenLayers.Pixel(a.x+b.w,a.y));this._addButton("panup","north-mini.png",c,b);a.y=c.y+b.h;this._addButton("panleft",
"west-mini.png",a,b);this.zoomWorldIcon&&(this._addButton("zoomworld","zoom-world-mini.png",a.add(b.w,0),b),d*=2);this._addButton("panright","east-mini.png",a.add(d,0),b);this._addButton("pandown","south-mini.png",c.add(0,2*b.h),b);this._addButton("zoomin","zoom-plus-mini.png",c.add(0,3*b.h+5),b);c=this._addZoomBar(c.add(0,4*b.h+5));this._addButton("zoomout","zoom-minus-mini.png",c,b)}else this._addButton("zoomin","zoom-plus-mini.png",a,b),c=this._addZoomBar(a.add(0,b.h)),this._addButton("zoomout",
"zoom-minus-mini.png",c,b),this.zoomWorldIcon&&(c=c.add(0,b.h+3),this._addButton("zoomworld","zoom-world-mini.png",c,b));return this.div},_addZoomBar:function(a){var b=OpenLayers.Util.getImageLocation("slider.png"),c=this.id+"_"+this.map.id,d=this.map.getNumZoomLevels()-1-this.map.getZoom(),d=OpenLayers.Util.createAlphaImageDiv(c,a.add(-1,d*this.zoomStopHeight),{w:20,h:9},b,"absolute");d.style.cursor="move";this.slider=d;this.sliderEvents=new OpenLayers.Events(this,d,null,!0,{includeXY:!0});this.sliderEvents.on({touchstart:this.zoomBarDown,
touchmove:this.zoomBarDrag,touchend:this.zoomBarUp,mousedown:this.zoomBarDown,mousemove:this.zoomBarDrag,mouseup:this.zoomBarUp});var e={w:this.zoomStopWidth,h:this.zoomStopHeight*this.map.getNumZoomLevels()},b=OpenLayers.Util.getImageLocation("zoombar.png"),c=null;OpenLayers.Util.alphaHack()?(c=this.id+"_"+this.map.id,c=OpenLayers.Util.createAlphaImageDiv(c,a,{w:e.w,h:this.zoomStopHeight},b,"absolute",null,"crop"),c.style.height=e.h+"px"):c=OpenLayers.Util.createDiv("OpenLayers_Control_PanZoomBar_Zoombar"+
this.map.id,a,e,b);c.style.cursor="pointer";c.className="olButton";this.zoombarDiv=c;this.div.appendChild(c);this.startTop=parseInt(c.style.top);this.div.appendChild(d);this.map.events.register("zoomend",this,this.moveZoomBar);return a=a.add(0,this.zoomStopHeight*this.map.getNumZoomLevels())},_removeZoomBar:function(){this.sliderEvents.un({touchstart:this.zoomBarDown,touchmove:this.zoomBarDrag,touchend:this.zoomBarUp,mousedown:this.zoomBarDown,mousemove:this.zoomBarDrag,mouseup:this.zoomBarUp});this.sliderEvents.destroy();
this.div.removeChild(this.zoombarDiv);this.zoombarDiv=null;this.div.removeChild(this.slider);this.slider=null;this.map.events.unregister("zoomend",this,this.moveZoomBar)},onButtonClick:function(a){OpenLayers.Control.PanZoom.prototype.onButtonClick.apply(this,arguments);if(a.buttonElement===this.zoombarDiv){var b=a.buttonXY.y/this.zoomStopHeight;if(this.forceFixedZoomLevel||!this.map.fractionalZoom)b=Math.floor(b);b=this.map.getNumZoomLevels()-1-b;b=Math.min(Math.max(b,0),this.map.getNumZoomLevels()-
1);this.map.zoomTo(b)}},passEventToSlider:function(a){this.sliderEvents.handleBrowserEvent(a)},zoomBarDown:function(a){if(OpenLayers.Event.isLeftClick(a)||OpenLayers.Event.isSingleTouch(a))this.map.events.on({touchmove:this.passEventToSlider,mousemove:this.passEventToSlider,mouseup:this.passEventToSlider,scope:this}),this.mouseDragStart=a.xy.clone(),this.zoomStart=a.xy.clone(),this.div.style.cursor="move",this.zoombarDiv.offsets=null,OpenLayers.Event.stop(a)},zoomBarDrag:function(a){if(null!=this.mouseDragStart){var b=
this.mouseDragStart.y-a.xy.y,c=OpenLayers.Util.pagePosition(this.zoombarDiv);0<a.clientY-c[1]&&a.clientY-c[1]<parseInt(this.zoombarDiv.style.height)-2&&(this.slider.style.top=parseInt(this.slider.style.top)-b+"px",this.mouseDragStart=a.xy.clone());this.deltaY=this.zoomStart.y-a.xy.y;OpenLayers.Event.stop(a)}},zoomBarUp:function(a){if((OpenLayers.Event.isLeftClick(a)||"touchend"===a.type)&&this.mouseDragStart){this.div.style.cursor="";this.map.events.un({touchmove:this.passEventToSlider,mouseup:this.passEventToSlider,
mousemove:this.passEventToSlider,scope:this});var b=this.map.zoom;!this.forceFixedZoomLevel&&this.map.fractionalZoom?(b+=this.deltaY/this.zoomStopHeight,b=Math.min(Math.max(b,0),this.map.getNumZoomLevels()-1)):(b+=this.deltaY/this.zoomStopHeight,b=Math.max(Math.round(b),0));this.map.zoomTo(b);this.zoomStart=this.mouseDragStart=null;this.deltaY=0;OpenLayers.Event.stop(a)}},moveZoomBar:function(){this.slider.style.top=(this.map.getNumZoomLevels()-1-this.map.getZoom())*this.zoomStopHeight+this.startTop+
1+"px"},CLASS_NAME:"OpenLayers.Control.PanZoomBar"});OpenLayers.Format.WFSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.0",errorProperty:"service",CLASS_NAME:"OpenLayers.Format.WFSCapabilities"});OpenLayers.Format.WFSCapabilities.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{wfs:"http://www.opengis.net/wfs",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",ows:"http://www.opengis.net/ows"},defaultPrefix:"wfs",read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&&9==a.nodeType&&(a=a.documentElement);var b={};this.readNode(a,b);return b},readers:{wfs:{WFS_Capabilities:function(a,b){this.readChildNodes(a,b)},
FeatureTypeList:function(a,b){b.featureTypeList={featureTypes:[]};this.readChildNodes(a,b.featureTypeList)},FeatureType:function(a,b){var c={};this.readChildNodes(a,c);b.featureTypes.push(c)},Name:function(a,b){var c=this.getChildValue(a);c&&(c=c.split(":"),b.name=c.pop(),0<c.length&&(b.featureNS=this.lookupNamespaceURI(a,c[0])))},Title:function(a,b){var c=this.getChildValue(a);c&&(b.title=c)},Abstract:function(a,b){var c=this.getChildValue(a);c&&(b["abstract"]=c)}}},CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1"});OpenLayers.Format.WFSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WFSCapabilities.v1,{regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},readers:{wfs:OpenLayers.Util.applyDefaults({DefaultSRS:function(a,b){var c=this.getChildValue(a);c&&(b.srs=c)}},OpenLayers.Format.WFSCapabilities.v1.prototype.readers.wfs),ows:OpenLayers.Format.OWSCommon.v1.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1_1_0"});OpenLayers.Layer.Image=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:!0,url:null,extent:null,size:null,tile:null,aspectRatio:null,initialize:function(a,b,c,d,e){this.url=b;this.maxExtent=this.extent=c;this.size=d;OpenLayers.Layer.prototype.initialize.apply(this,[a,e]);this.aspectRatio=this.extent.getHeight()/this.size.h/(this.extent.getWidth()/this.size.w)},destroy:function(){this.tile&&(this.removeTileMonitoringHooks(this.tile),this.tile.destroy(),this.tile=null);OpenLayers.Layer.prototype.destroy.apply(this,
arguments)},clone:function(a){null==a&&(a=new OpenLayers.Layer.Image(this.name,this.url,this.extent,this.size,this.getOptions()));return a=OpenLayers.Layer.prototype.clone.apply(this,[a])},setMap:function(a){null==this.options.maxResolution&&(this.options.maxResolution=this.aspectRatio*this.extent.getWidth()/this.size.w);OpenLayers.Layer.prototype.setMap.apply(this,arguments)},moveTo:function(a,b,c){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var d=null==this.tile;if(b||d){this.setTileSize();
var e=this.map.getLayerPxFromLonLat({lon:this.extent.left,lat:this.extent.top});d?(this.tile=new OpenLayers.Tile.Image(this,e,this.extent,null,this.tileSize),this.addTileMonitoringHooks(this.tile)):(this.tile.size=this.tileSize.clone(),this.tile.position=e.clone());this.tile.draw()}},setTileSize:function(){var a=this.extent.getWidth()/this.map.getResolution(),b=this.extent.getHeight()/this.map.getResolution();this.tileSize=new OpenLayers.Size(a,b)},addTileMonitoringHooks:function(a){a.onLoadStart=
function(){this.events.triggerEvent("loadstart")};a.events.register("loadstart",this,a.onLoadStart);a.onLoadEnd=function(){this.events.triggerEvent("loadend")};a.events.register("loadend",this,a.onLoadEnd);a.events.register("unload",this,a.onLoadEnd)},removeTileMonitoringHooks:function(a){a.unload();a.events.un({loadstart:a.onLoadStart,loadend:a.onLoadEnd,unload:a.onLoadEnd,scope:this})},setUrl:function(a){this.url=a;this.tile.draw()},getURL:function(){return this.url},CLASS_NAME:"OpenLayers.Layer.Image"});OpenLayers.Strategy=OpenLayers.Class({layer:null,options:null,active:null,autoActivate:!0,autoDestroy:!0,initialize:function(a){OpenLayers.Util.extend(this,a);this.options=a;this.active=!1},destroy:function(){this.deactivate();this.options=this.layer=null},setLayer:function(a){this.layer=a},activate:function(){return!this.active?this.active=!0:!1},deactivate:function(){return this.active?(this.active=!1,!0):!1},CLASS_NAME:"OpenLayers.Strategy"});OpenLayers.Strategy.Save=OpenLayers.Class(OpenLayers.Strategy,{events:null,auto:!1,timer:null,initialize:function(a){OpenLayers.Strategy.prototype.initialize.apply(this,[a]);this.events=new OpenLayers.Events(this)},activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);if(a&&this.auto)if("number"===typeof this.auto)this.timer=window.setInterval(OpenLayers.Function.bind(this.save,this),1E3*this.auto);else this.layer.events.on({featureadded:this.triggerSave,afterfeaturemodified:this.triggerSave,
scope:this});return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&&this.auto&&("number"===typeof this.auto?window.clearInterval(this.timer):this.layer.events.un({featureadded:this.triggerSave,afterfeaturemodified:this.triggerSave,scope:this}));return a},triggerSave:function(a){var b=a.feature;(b.state===OpenLayers.State.INSERT||b.state===OpenLayers.State.UPDATE||b.state===OpenLayers.State.DELETE)&&this.save([a.feature])},save:function(a){a||(a=this.layer.features);
this.events.triggerEvent("start",{features:a});var b=this.layer.projection,c=this.layer.map.getProjectionObject();if(!c.equals(b)){for(var d=a.length,e=Array(d),f,g,h=0;h<d;++h)f=a[h],g=f.clone(),g.fid=f.fid,g.state=f.state,f.url&&(g.url=f.url),g._original=f,g.geometry.transform(c,b),e[h]=g;a=e}this.layer.protocol.commit(a,{callback:this.onCommit,scope:this})},onCommit:function(a){var b={response:a};if(a.success()){for(var c=a.reqFeatures,d,e=[],f=a.insertIds||[],g=0,h=0,i=c.length;h<i;++h)if(d=c[h],
d=d._original||d,a=d.state)a==OpenLayers.State.DELETE?e.push(d):a==OpenLayers.State.INSERT&&(d.fid=f[g],++g),d.state=null;0<e.length&&this.layer.destroyFeatures(e);this.events.triggerEvent("success",b)}else this.events.triggerEvent("fail",b)},CLASS_NAME:"OpenLayers.Strategy.Save"});OpenLayers.Format.GPX=OpenLayers.Class(OpenLayers.Format.XML,{defaultDesc:"No description available",extractWaypoints:!0,extractTracks:!0,extractRoutes:!0,extractAttributes:!0,namespaces:{gpx:"http://www.topografix.com/GPX/1/1",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",creator:"OpenLayers",initialize:function(a){this.externalProjection=new OpenLayers.Projection("EPSG:4326");OpenLayers.Format.XML.prototype.initialize.apply(this,
[a])},read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=[];if(this.extractTracks)for(var c=a.getElementsByTagName("trk"),d=0,e=c.length;d<e;d++){var f={};this.extractAttributes&&(f=this.parseAttributes(c[d]));for(var g=this.getElementsByTagNameNS(c[d],c[d].namespaceURI,"trkseg"),h=0,i=g.length;h<i;h++){var j=this.extractSegment(g[h],"trkpt");b.push(new OpenLayers.Feature.Vector(j,f))}}if(this.extractRoutes){e=a.getElementsByTagName("rte");c=0;for(d=
e.length;c<d;c++)f={},this.extractAttributes&&(f=this.parseAttributes(e[c])),g=this.extractSegment(e[c],"rtept"),b.push(new OpenLayers.Feature.Vector(g,f))}if(this.extractWaypoints){a=a.getElementsByTagName("wpt");c=0;for(e=a.length;c<e;c++)f={},this.extractAttributes&&(f=this.parseAttributes(a[c])),d=new OpenLayers.Geometry.Point(a[c].getAttribute("lon"),a[c].getAttribute("lat")),b.push(new OpenLayers.Feature.Vector(d,f))}if(this.internalProjection&&this.externalProjection){f=0;for(a=b.length;f<
a;f++)b[f].geometry.transform(this.externalProjection,this.internalProjection)}return b},extractSegment:function(a,b){for(var c=this.getElementsByTagNameNS(a,a.namespaceURI,b),d=[],e=0,f=c.length;e<f;e++)d.push(new OpenLayers.Geometry.Point(c[e].getAttribute("lon"),c[e].getAttribute("lat")));return new OpenLayers.Geometry.LineString(d)},parseAttributes:function(a){for(var b={},a=a.firstChild,c,d;a;){if(1==a.nodeType&&a.firstChild&&(c=a.firstChild,3==c.nodeType||4==c.nodeType))d=a.prefix?a.nodeName.split(":")[1]:
a.nodeName,"trkseg"!=d&&"rtept"!=d&&(b[d]=c.nodeValue);a=a.nextSibling}return b},write:function(a,b){var a=OpenLayers.Util.isArray(a)?a:[a],c=this.createElementNS(this.namespaces.gpx,"gpx");c.setAttribute("version","1.1");c.setAttribute("creator",this.creator);this.setAttributes(c,{"xsi:schemaLocation":this.schemaLocation});b&&"object"==typeof b&&c.appendChild(this.buildMetadataNode(b));for(var d=0,e=a.length;d<e;d++)c.appendChild(this.buildFeatureNode(a[d]));return OpenLayers.Format.XML.prototype.write.apply(this,
[c])},buildMetadataNode:function(a){for(var b=["name","desc","author"],c=this.createElementNSPlus("gpx:metadata"),d=0;d<b.length;d++){var e=b[d];if(a[e]){var f=this.createElementNSPlus("gpx:"+e);f.appendChild(this.createTextNode(a[e]));c.appendChild(f)}}return c},buildFeatureNode:function(a){var b=a.geometry,b=b.clone();this.internalProjection&&this.externalProjection&&b.transform(this.internalProjection,this.externalProjection);if("OpenLayers.Geometry.Point"==b.CLASS_NAME){var c=this.buildWptNode(b);
this.appendAttributesNode(c,a);return c}c=this.createElementNSPlus("gpx:trk");this.appendAttributesNode(c,a);for(var a=this.buildTrkSegNode(b),a=OpenLayers.Util.isArray(a)?a:[a],b=0,d=a.length;b<d;b++)c.appendChild(a[b]);return c},buildTrkSegNode:function(a){var b,c,d,e;if("OpenLayers.Geometry.LineString"==a.CLASS_NAME||"OpenLayers.Geometry.LinearRing"==a.CLASS_NAME){b=this.createElementNSPlus("gpx:trkseg");c=0;for(d=a.components.length;c<d;c++)e=a.components[c],b.appendChild(this.buildTrkPtNode(e));
return b}b=[];c=0;for(d=a.components.length;c<d;c++)b.push(this.buildTrkSegNode(a.components[c]));return b},buildTrkPtNode:function(a){var b=this.createElementNSPlus("gpx:trkpt");b.setAttribute("lon",a.x);b.setAttribute("lat",a.y);return b},buildWptNode:function(a){var b=this.createElementNSPlus("gpx:wpt");b.setAttribute("lon",a.x);b.setAttribute("lat",a.y);return b},appendAttributesNode:function(a,b){var c=this.createElementNSPlus("gpx:name");c.appendChild(this.createTextNode(b.attributes.name||
b.id));a.appendChild(c);c=this.createElementNSPlus("gpx:desc");c.appendChild(this.createTextNode(b.attributes.description||this.defaultDesc));a.appendChild(c)},CLASS_NAME:"OpenLayers.Format.GPX"});OpenLayers.Format.WMSDescribeLayer=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.1",getVersion:function(a,b){var c=OpenLayers.Format.XML.VersionedOGC.prototype.getVersion.apply(this,arguments);if("1.1.1"==c||"1.1.0"==c)c="1.1";return c},CLASS_NAME:"OpenLayers.Format.WMSDescribeLayer"});OpenLayers.Format.WMSDescribeLayer.v1_1=OpenLayers.Class(OpenLayers.Format.WMSDescribeLayer,{initialize:function(a){OpenLayers.Format.WMSDescribeLayer.prototype.initialize.apply(this,[a])},read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));for(var a=a.documentElement.childNodes,b=[],c,d,e=0;e<a.length;++e)if(c=a[e],d=c.nodeName,"LayerDescription"==d){d=c.getAttribute("name");var f="",g="",h="";c.getAttribute("owsType")?(f=c.getAttribute("owsType"),g=c.getAttribute("owsURL")):
""!=c.getAttribute("wfs")?(f="WFS",g=c.getAttribute("wfs")):""!=c.getAttribute("wcs")&&(f="WCS",g=c.getAttribute("wcs"));c=c.getElementsByTagName("Query");0<c.length&&((h=c[0].getAttribute("typeName"))||(h=c[0].getAttribute("typename")));b.push({layerName:d,owsType:f,owsURL:g,typeName:h})}return b},CLASS_NAME:"OpenLayers.Format.WMSDescribeLayer.v1_1"});OpenLayers.Layer.XYZ=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,sphericalMercator:!1,zoomOffset:0,serverResolutions:null,initialize:function(a,b,c){if(c&&c.sphericalMercator||this.sphericalMercator)c=OpenLayers.Util.extend({projection:"EPSG:900913",numZoomLevels:19},c);OpenLayers.Layer.Grid.prototype.initialize.apply(this,[a||this.name,b||this.url,{},c])},clone:function(a){null==a&&(a=new OpenLayers.Layer.XYZ(this.name,this.url,this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,
[a])},getURL:function(a){var a=this.getXYZ(a),b=this.url;OpenLayers.Util.isArray(b)&&(b=this.selectUrl(""+a.x+a.y+a.z,b));return OpenLayers.String.format(b,a)},getXYZ:function(a){var b=this.getServerResolution(),c=Math.round((a.left-this.maxExtent.left)/(b*this.tileSize.w)),a=Math.round((this.maxExtent.top-a.top)/(b*this.tileSize.h)),b=this.getServerZoom();if(this.wrapDateLine)var d=Math.pow(2,b),c=(c%d+d)%d;return{x:c,y:a,z:b}},setMap:function(a){OpenLayers.Layer.Grid.prototype.setMap.apply(this,
arguments);this.tileOrigin||(this.tileOrigin=new OpenLayers.LonLat(this.maxExtent.left,this.maxExtent.bottom))},CLASS_NAME:"OpenLayers.Layer.XYZ"});OpenLayers.Layer.OSM=OpenLayers.Class(OpenLayers.Layer.XYZ,{name:"OpenStreetMap",url:["http://a.tile.openstreetmap.org/${z}/${x}/${y}.png","http://b.tile.openstreetmap.org/${z}/${x}/${y}.png","http://c.tile.openstreetmap.org/${z}/${x}/${y}.png"],attribution:"Data CC-By-SA by <a href='http://openstreetmap.org/'>OpenStreetMap</a>",sphericalMercator:!0,wrapDateLine:!0,tileOptions:null,initialize:function(a,b,c){OpenLayers.Layer.XYZ.prototype.initialize.apply(this,arguments);this.tileOptions=OpenLayers.Util.extend({crossOriginKeyword:"anonymous"},
this.options&&this.options.tileOptions)},clone:function(a){null==a&&(a=new OpenLayers.Layer.OSM(this.name,this.url,this.getOptions()));return a=OpenLayers.Layer.XYZ.prototype.clone.apply(this,[a])},CLASS_NAME:"OpenLayers.Layer.OSM"});OpenLayers.Renderer=OpenLayers.Class({container:null,root:null,extent:null,locked:!1,size:null,resolution:null,map:null,featureDx:0,initialize:function(a,b){this.container=OpenLayers.Util.getElement(a);OpenLayers.Util.extend(this,b)},destroy:function(){this.map=this.resolution=this.size=this.extent=this.container=null},supported:function(){return!1},setExtent:function(a,b){this.extent=a.clone();if(this.map.baseLayer&&this.map.baseLayer.wrapDateLine){var c=a.getWidth()/this.map.getExtent().getWidth(),
a=a.scale(1/c);this.extent=a.wrapDateLine(this.map.getMaxExtent()).scale(c)}b&&(this.resolution=null);return!0},setSize:function(a){this.size=a.clone();this.resolution=null},getResolution:function(){return this.resolution=this.resolution||this.map.getResolution()},drawFeature:function(a,b){null==b&&(b=a.style);if(a.geometry){var c=a.geometry.getBounds();if(c){var d;this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&(d=this.map.getMaxExtent());c.intersectsBounds(this.extent,{worldBounds:d})?this.calculateFeatureDx(c,
d):b={display:"none"};c=this.drawGeometry(a.geometry,b,a.id);if("none"!=b.display&&b.label&&!1!==c){d=a.geometry.getCentroid();if(b.labelXOffset||b.labelYOffset){var e=isNaN(b.labelXOffset)?0:b.labelXOffset,f=isNaN(b.labelYOffset)?0:b.labelYOffset,g=this.getResolution();d.move(e*g,f*g)}this.drawText(a.id,b,d)}else this.removeText(a.id);return c}}},calculateFeatureDx:function(a,b){this.featureDx=0;if(b){var c=b.getWidth();this.featureDx=Math.round(((a.left+a.right)/2-(this.extent.left+this.extent.right)/
2)/c)*c}},drawGeometry:function(){},drawText:function(){},removeText:function(){},clear:function(){},getFeatureIdFromEvent:function(){},eraseFeatures:function(a){OpenLayers.Util.isArray(a)||(a=[a]);for(var b=0,c=a.length;b<c;++b){var d=a[b];this.eraseGeometry(d.geometry,d.id);this.removeText(d.id)}},eraseGeometry:function(){},moveRoot:function(){},getRenderLayerId:function(){return this.container.id},applyDefaultSymbolizer:function(a){var b=OpenLayers.Util.extend({},OpenLayers.Renderer.defaultSymbolizer);
!1===a.stroke&&(delete b.strokeWidth,delete b.strokeColor);!1===a.fill&&delete b.fillColor;OpenLayers.Util.extend(b,a);return b},CLASS_NAME:"OpenLayers.Renderer"});OpenLayers.Renderer.defaultSymbolizer={fillColor:"#000000",strokeColor:"#000000",strokeWidth:2,fillOpacity:1,strokeOpacity:1,pointRadius:0,labelAlign:"cm"};
OpenLayers.Renderer.symbol={star:[350,75,379,161,469,161,397,215,423,301,350,250,277,301,303,215,231,161,321,161,350,75],cross:[4,0,6,0,6,4,10,4,10,6,6,6,6,10,4,10,4,6,0,6,0,4,4,4,4,0],x:[0,0,25,0,50,35,75,0,100,0,65,50,100,100,75,100,50,65,25,100,0,100,35,50,0,0],square:[0,0,0,1,1,1,1,0,0,0],triangle:[0,10,10,10,5,0,0,10]};OpenLayers.Renderer.Canvas=OpenLayers.Class(OpenLayers.Renderer,{hitDetection:!0,hitOverflow:0,canvas:null,features:null,pendingRedraw:!1,cachedSymbolBounds:{},initialize:function(a,b){OpenLayers.Renderer.prototype.initialize.apply(this,arguments);this.root=document.createElement("canvas");this.container.appendChild(this.root);this.canvas=this.root.getContext("2d");this.features={};this.hitDetection&&(this.hitCanvas=document.createElement("canvas"),this.hitContext=this.hitCanvas.getContext("2d"))},
setExtent:function(){OpenLayers.Renderer.prototype.setExtent.apply(this,arguments);return!1},eraseGeometry:function(a,b){this.eraseFeatures(this.features[b][0])},supported:function(){return OpenLayers.CANVAS_SUPPORTED},setSize:function(a){this.size=a.clone();var b=this.root;b.style.width=a.w+"px";b.style.height=a.h+"px";b.width=a.w;b.height=a.h;this.resolution=null;this.hitDetection&&(b=this.hitCanvas,b.style.width=a.w+"px",b.style.height=a.h+"px",b.width=a.w,b.height=a.h)},drawFeature:function(a,
b){var c;if(a.geometry){b=this.applyDefaultSymbolizer(b||a.style);c=a.geometry.getBounds();var d;this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&(d=this.map.getMaxExtent());d=c&&c.intersectsBounds(this.extent,{worldBounds:d});(c="none"!==b.display&&!!c&&d)?this.features[a.id]=[a,b]:delete this.features[a.id];this.pendingRedraw=!0}this.pendingRedraw&&!this.locked&&(this.redraw(),this.pendingRedraw=!1);return c},drawGeometry:function(a,b,c){var d=a.CLASS_NAME;if("OpenLayers.Geometry.Collection"==
d||"OpenLayers.Geometry.MultiPoint"==d||"OpenLayers.Geometry.MultiLineString"==d||"OpenLayers.Geometry.MultiPolygon"==d)for(d=0;d<a.components.length;d++)this.drawGeometry(a.components[d],b,c);else switch(a.CLASS_NAME){case "OpenLayers.Geometry.Point":this.drawPoint(a,b,c);break;case "OpenLayers.Geometry.LineString":this.drawLineString(a,b,c);break;case "OpenLayers.Geometry.LinearRing":this.drawLinearRing(a,b,c);break;case "OpenLayers.Geometry.Polygon":this.drawPolygon(a,b,c)}},drawExternalGraphic:function(a,
b,c){var d=new Image;b.graphicTitle&&(d.title=b.graphicTitle);var e=b.graphicWidth||b.graphicHeight,f=b.graphicHeight||b.graphicWidth,e=e?e:2*b.pointRadius,f=f?f:2*b.pointRadius,g=void 0!=b.graphicXOffset?b.graphicXOffset:-(0.5*e),h=void 0!=b.graphicYOffset?b.graphicYOffset:-(0.5*f),i=b.graphicOpacity||b.fillOpacity;d.onload=OpenLayers.Function.bind(function(){if(this.features[c]){var b=this.getLocalXY(a),k=b[0],b=b[1];if(!isNaN(k)&&!isNaN(b)){var k=k+g|0,b=b+h|0,l=this.canvas;l.globalAlpha=i;var m=
OpenLayers.Renderer.Canvas.drawImageScaleFactor||(OpenLayers.Renderer.Canvas.drawImageScaleFactor=/android 2.1/.test(navigator.userAgent.toLowerCase())?320/window.screen.width:1);l.drawImage(d,k*m,b*m,e*m,f*m);if(this.hitDetection){this.setHitContextStyle("fill",c);this.hitContext.fillRect(k,b,e,f)}}}},this);d.src=b.externalGraphic},drawNamedSymbol:function(a,b,c){var d,e,f,g;f=Math.PI/180;var h=OpenLayers.Renderer.symbol[b.graphicName];if(!h)throw Error(b.graphicName+" is not a valid symbol name");
if(h.length&&!(2>h.length)&&(a=this.getLocalXY(a),e=a[0],g=a[1],!isNaN(e)&&!isNaN(g))){this.canvas.lineCap="round";this.canvas.lineJoin="round";this.hitDetection&&(this.hitContext.lineCap="round",this.hitContext.lineJoin="round");if(b.graphicName in this.cachedSymbolBounds)d=this.cachedSymbolBounds[b.graphicName];else{d=new OpenLayers.Bounds;for(a=0;a<h.length;a+=2)d.extend(new OpenLayers.LonLat(h[a],h[a+1]));this.cachedSymbolBounds[b.graphicName]=d}this.canvas.save();this.hitDetection&&this.hitContext.save();
this.canvas.translate(e,g);this.hitDetection&&this.hitContext.translate(e,g);a=f*b.rotation;isNaN(a)||(this.canvas.rotate(a),this.hitDetection&&this.hitContext.rotate(a));f=2*b.pointRadius/Math.max(d.getWidth(),d.getHeight());this.canvas.scale(f,f);this.hitDetection&&this.hitContext.scale(f,f);a=d.getCenterLonLat().lon;d=d.getCenterLonLat().lat;this.canvas.translate(-a,-d);this.hitDetection&&this.hitContext.translate(-a,-d);g=b.strokeWidth;b.strokeWidth=g/f;if(!1!==b.fill){this.setCanvasStyle("fill",
b);this.canvas.beginPath();for(a=0;a<h.length;a+=2)d=h[a],e=h[a+1],0==a&&this.canvas.moveTo(d,e),this.canvas.lineTo(d,e);this.canvas.closePath();this.canvas.fill();if(this.hitDetection){this.setHitContextStyle("fill",c,b);this.hitContext.beginPath();for(a=0;a<h.length;a+=2)d=h[a],e=h[a+1],0==a&&this.canvas.moveTo(d,e),this.hitContext.lineTo(d,e);this.hitContext.closePath();this.hitContext.fill()}}if(!1!==b.stroke){this.setCanvasStyle("stroke",b);this.canvas.beginPath();for(a=0;a<h.length;a+=2)d=h[a],
e=h[a+1],0==a&&this.canvas.moveTo(d,e),this.canvas.lineTo(d,e);this.canvas.closePath();this.canvas.stroke();if(this.hitDetection){this.setHitContextStyle("stroke",c,b,f);this.hitContext.beginPath();for(a=0;a<h.length;a+=2)d=h[a],e=h[a+1],0==a&&this.hitContext.moveTo(d,e),this.hitContext.lineTo(d,e);this.hitContext.closePath();this.hitContext.stroke()}}b.strokeWidth=g;this.canvas.restore();this.hitDetection&&this.hitContext.restore();this.setCanvasStyle("reset")}},setCanvasStyle:function(a,b){"fill"===
a?(this.canvas.globalAlpha=b.fillOpacity,this.canvas.fillStyle=b.fillColor):"stroke"===a?(this.canvas.globalAlpha=b.strokeOpacity,this.canvas.strokeStyle=b.strokeColor,this.canvas.lineWidth=b.strokeWidth):(this.canvas.globalAlpha=0,this.canvas.lineWidth=1)},featureIdToHex:function(a){a=Number(a.split("_").pop())+1;16777216<=a&&(this.hitOverflow=a-16777215,a=a%16777216+1);var a="000000"+a.toString(16),b=a.length;return a="#"+a.substring(b-6,b)},setHitContextStyle:function(a,b,c,d){b=this.featureIdToHex(b);
"fill"==a?(this.hitContext.globalAlpha=1,this.hitContext.fillStyle=b):"stroke"==a?(this.hitContext.globalAlpha=1,this.hitContext.strokeStyle=b,"undefined"===typeof d?this.hitContext.lineWidth=c.strokeWidth+2:isNaN(d)||(this.hitContext.lineWidth=c.strokeWidth+2/d)):(this.hitContext.globalAlpha=0,this.hitContext.lineWidth=1)},drawPoint:function(a,b,c){if(!1!==b.graphic)if(b.externalGraphic)this.drawExternalGraphic(a,b,c);else if(b.graphicName&&"circle"!=b.graphicName)this.drawNamedSymbol(a,b,c);else{var d=
this.getLocalXY(a),a=d[0],d=d[1];if(!isNaN(a)&&!isNaN(d)){var e=2*Math.PI,f=b.pointRadius;!1!==b.fill&&(this.setCanvasStyle("fill",b),this.canvas.beginPath(),this.canvas.arc(a,d,f,0,e,!0),this.canvas.fill(),this.hitDetection&&(this.setHitContextStyle("fill",c,b),this.hitContext.beginPath(),this.hitContext.arc(a,d,f,0,e,!0),this.hitContext.fill()));!1!==b.stroke&&(this.setCanvasStyle("stroke",b),this.canvas.beginPath(),this.canvas.arc(a,d,f,0,e,!0),this.canvas.stroke(),this.hitDetection&&(this.setHitContextStyle("stroke",
c,b),this.hitContext.beginPath(),this.hitContext.arc(a,d,f,0,e,!0),this.hitContext.stroke()),this.setCanvasStyle("reset"))}}},drawLineString:function(a,b,c){b=OpenLayers.Util.applyDefaults({fill:!1},b);this.drawLinearRing(a,b,c)},drawLinearRing:function(a,b,c){!1!==b.fill&&(this.setCanvasStyle("fill",b),this.renderPath(this.canvas,a,b,c,"fill"),this.hitDetection&&(this.setHitContextStyle("fill",c,b),this.renderPath(this.hitContext,a,b,c,"fill")));!1!==b.stroke&&(this.setCanvasStyle("stroke",b),this.renderPath(this.canvas,
a,b,c,"stroke"),this.hitDetection&&(this.setHitContextStyle("stroke",c,b),this.renderPath(this.hitContext,a,b,c,"stroke")));this.setCanvasStyle("reset")},renderPath:function(a,b,c,d,e){b=b.components;c=b.length;a.beginPath();var d=this.getLocalXY(b[0]),f=d[1];if(!isNaN(d[0])&&!isNaN(f)){a.moveTo(d[0],d[1]);for(d=1;d<c;++d)f=this.getLocalXY(b[d]),a.lineTo(f[0],f[1]);"fill"===e?a.fill():a.stroke()}},drawPolygon:function(a,b,c){var a=a.components,d=a.length;this.drawLinearRing(a[0],b,c);for(var e=1;e<
d;++e)this.canvas.globalCompositeOperation="destination-out",this.hitDetection&&(this.hitContext.globalCompositeOperation="destination-out"),this.drawLinearRing(a[e],OpenLayers.Util.applyDefaults({stroke:!1,fillOpacity:1},b),c),this.canvas.globalCompositeOperation="source-over",this.hitDetection&&(this.hitContext.globalCompositeOperation="source-over"),this.drawLinearRing(a[e],OpenLayers.Util.applyDefaults({fill:!1},b),c)},drawText:function(a,b){var c=this.getLocalXY(a);this.setCanvasStyle("reset");
this.canvas.fillStyle=b.fontColor;this.canvas.globalAlpha=b.fontOpacity||1;var d=[b.fontStyle?b.fontStyle:"normal","normal",b.fontWeight?b.fontWeight:"normal",b.fontSize?b.fontSize:"1em",b.fontFamily?b.fontFamily:"sans-serif"].join(" "),e=b.label.split("\n"),f=e.length;if(this.canvas.fillText){this.canvas.font=d;this.canvas.textAlign=OpenLayers.Renderer.Canvas.LABEL_ALIGN[b.labelAlign[0]]||"center";this.canvas.textBaseline=OpenLayers.Renderer.Canvas.LABEL_ALIGN[b.labelAlign[1]]||"middle";var g=OpenLayers.Renderer.Canvas.LABEL_FACTOR[b.labelAlign[1]];
null==g&&(g=-0.5);d=this.canvas.measureText("Mg").height||this.canvas.measureText("xx").width;c[1]+=d*g*(f-1);for(g=0;g<f;g++)b.labelOutlineWidth&&(this.canvas.save(),this.canvas.strokeStyle=b.labelOutlineColor,this.canvas.lineWidth=b.labelOutlineWidth,this.canvas.strokeText(e[g],c[0],c[1]+d*g+1),this.canvas.restore()),this.canvas.fillText(e[g],c[0],c[1]+d*g)}else if(this.canvas.mozDrawText){this.canvas.mozTextStyle=d;var h=OpenLayers.Renderer.Canvas.LABEL_FACTOR[b.labelAlign[0]];null==h&&(h=-0.5);
g=OpenLayers.Renderer.Canvas.LABEL_FACTOR[b.labelAlign[1]];null==g&&(g=-0.5);d=this.canvas.mozMeasureText("xx");c[1]+=d*(1+g*f);for(g=0;g<f;g++){var i=c[0]+h*this.canvas.mozMeasureText(e[g]),j=c[1]+g*d;this.canvas.translate(i,j);this.canvas.mozDrawText(e[g]);this.canvas.translate(-i,-j)}}this.setCanvasStyle("reset")},getLocalXY:function(a){var b=this.getResolution(),c=this.extent;return[(a.x-this.featureDx)/b+-c.left/b,c.top/b-a.y/b]},clear:function(){var a=this.root.height,b=this.root.width;this.canvas.clearRect(0,
0,b,a);this.features={};this.hitDetection&&this.hitContext.clearRect(0,0,b,a)},getFeatureIdFromEvent:function(a){var b;if(this.hitDetection&&"none"!==this.root.style.display&&!this.map.dragging&&(a=a.xy,a=this.hitContext.getImageData(a.x|0,a.y|0,1,1).data,255===a[3]&&(a=a[2]+256*(a[1]+256*a[0])))){a="OpenLayers.Feature.Vector_"+(a-1+this.hitOverflow);try{b=this.features[a][0]}catch(c){}}return b},eraseFeatures:function(a){OpenLayers.Util.isArray(a)||(a=[a]);for(var b=0;b<a.length;++b)delete this.features[a[b].id];
this.redraw()},redraw:function(){if(!this.locked){var a=this.root.height,b=this.root.width;this.canvas.clearRect(0,0,b,a);this.hitDetection&&this.hitContext.clearRect(0,0,b,a);var a=[],c,d,e=this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&this.map.getMaxExtent(),f;for(f in this.features)this.features.hasOwnProperty(f)&&(b=this.features[f][0],c=b.geometry,this.calculateFeatureDx(c.getBounds(),e),d=this.features[f][1],this.drawGeometry(c,d,b.id),d.label&&a.push([b,d]));b=0;for(c=a.length;b<c;++b)f=
a[b],this.drawText(f[0].geometry.getCentroid(),f[1])}},CLASS_NAME:"OpenLayers.Renderer.Canvas"});OpenLayers.Renderer.Canvas.LABEL_ALIGN={l:"left",r:"right",t:"top",b:"bottom"};OpenLayers.Renderer.Canvas.LABEL_FACTOR={l:0,r:-1,t:0,b:-1};OpenLayers.Renderer.Canvas.drawImageScaleFactor=null;OpenLayers.Format.OSM=OpenLayers.Class(OpenLayers.Format.XML,{checkTags:!1,interestingTagsExclude:null,areaTags:null,initialize:function(a){for(var b={interestingTagsExclude:"source source_ref source:ref history attribution created_by".split(" "),areaTags:"area building leisure tourism ruins historic landuse military natural sport".split(" ")},b=OpenLayers.Util.extend(b,a),c={},a=0;a<b.interestingTagsExclude.length;a++)c[b.interestingTagsExclude[a]]=!0;b.interestingTagsExclude=c;c={};for(a=0;a<b.areaTags.length;a++)c[b.areaTags[a]]=
!0;b.areaTags=c;this.externalProjection=new OpenLayers.Projection("EPSG:4326");OpenLayers.Format.XML.prototype.initialize.apply(this,[b])},read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));for(var b=this.getNodes(a),c=this.getWays(a),a=Array(c.length),d=0;d<c.length;d++){for(var e=Array(c[d].nodes.length),f=this.isWayArea(c[d])?1:0,g=0;g<c[d].nodes.length;g++){var h=b[c[d].nodes[g]],i=new OpenLayers.Geometry.Point(h.lon,h.lat);i.osm_id=parseInt(c[d].nodes[g]);
e[g]=i;h.used=!0}h=null;h=f?new OpenLayers.Geometry.Polygon(new OpenLayers.Geometry.LinearRing(e)):new OpenLayers.Geometry.LineString(e);this.internalProjection&&this.externalProjection&&h.transform(this.externalProjection,this.internalProjection);e=new OpenLayers.Feature.Vector(h,c[d].tags);e.osm_id=parseInt(c[d].id);e.fid="way."+e.osm_id;a[d]=e}for(var j in b){h=b[j];if(!h.used||this.checkTags){c=null;if(this.checkTags){c=this.getTags(h.node,!0);if(h.used&&!c[1])continue;c=c[0]}else c=this.getTags(h.node);
e=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(h.lon,h.lat),c);this.internalProjection&&this.externalProjection&&e.geometry.transform(this.externalProjection,this.internalProjection);e.osm_id=parseInt(j);e.fid="node."+e.osm_id;a.push(e)}h.node=null}return a},getNodes:function(a){for(var a=a.getElementsByTagName("node"),b={},c=0;c<a.length;c++){var d=a[c],e=d.getAttribute("id");b[e]={lat:d.getAttribute("lat"),lon:d.getAttribute("lon"),node:d}}return b},getWays:function(a){for(var a=
a.getElementsByTagName("way"),b=[],c=0;c<a.length;c++){var d=a[c],e={id:d.getAttribute("id")};e.tags=this.getTags(d);d=d.getElementsByTagName("nd");e.nodes=Array(d.length);for(var f=0;f<d.length;f++)e.nodes[f]=d[f].getAttribute("ref");b.push(e)}return b},getTags:function(a,b){for(var c=a.getElementsByTagName("tag"),d={},e=!1,f=0;f<c.length;f++){var g=c[f].getAttribute("k");d[g]=c[f].getAttribute("v");b&&(this.interestingTagsExclude[g]||(e=!0))}return b?[d,e]:d},isWayArea:function(a){var b=!1,c=!1;
a.nodes[0]==a.nodes[a.nodes.length-1]&&(b=!0);if(this.checkTags)for(var d in a.tags)if(this.areaTags[d]){c=!0;break}return b&&(this.checkTags?c:!0)},write:function(a){OpenLayers.Util.isArray(a)||(a=[a]);this.osm_id=1;this.created_nodes={};var b=this.createElementNS(null,"osm");b.setAttribute("version","0.5");b.setAttribute("generator","OpenLayers "+OpenLayers.VERSION_NUMBER);for(var c=a.length-1;0<=c;c--)for(var d=this.createFeatureNodes(a[c]),e=0;e<d.length;e++)b.appendChild(d[e]);return OpenLayers.Format.XML.prototype.write.apply(this,
[b])},createFeatureNodes:function(a){var b=[],c=a.geometry.CLASS_NAME,c=c.substring(c.lastIndexOf(".")+1),c=c.toLowerCase();(c=this.createXML[c])&&(b=c.apply(this,[a]));return b},createXML:{point:function(a){var b=null,c=a.geometry?a.geometry:a;this.internalProjection&&this.externalProjection&&(c=c.clone(),c.transform(this.internalProjection,this.externalProjection));var d=!1;a.osm_id?(b=a.osm_id,this.created_nodes[b]&&(d=!0)):(b=-this.osm_id,this.osm_id++);var e=d?this.created_nodes[b]:this.createElementNS(null,
"node");this.created_nodes[b]=e;e.setAttribute("id",b);e.setAttribute("lon",c.x);e.setAttribute("lat",c.y);a.attributes&&this.serializeTags(a,e);this.setState(a,e);return d?[]:[e]},linestring:function(a){var b,c=[],d=a.geometry;a.osm_id?b=a.osm_id:(b=-this.osm_id,this.osm_id++);var e=this.createElementNS(null,"way");e.setAttribute("id",b);for(b=0;b<d.components.length;b++){var f=this.createXML.point.apply(this,[d.components[b]]);if(f.length){var f=f[0],g=f.getAttribute("id");c.push(f)}else g=d.components[b].osm_id,
f=this.created_nodes[g];this.setState(a,f);f=this.createElementNS(null,"nd");f.setAttribute("ref",g);e.appendChild(f)}this.serializeTags(a,e);c.push(e);return c},polygon:function(a){var b=OpenLayers.Util.extend({area:"yes"},a.attributes),b=new OpenLayers.Feature.Vector(a.geometry.components[0],b);b.osm_id=a.osm_id;return this.createXML.linestring.apply(this,[b])}},serializeTags:function(a,b){for(var c in a.attributes){var d=this.createElementNS(null,"tag");d.setAttribute("k",c);d.setAttribute("v",
a.attributes[c]);b.appendChild(d)}},setState:function(a,b){if(a.state){var c=null;switch(a.state){case OpenLayers.State.UPDATE:case OpenLayers.State.DELETE:c="delete"}c&&b.setAttribute("action",c)}},CLASS_NAME:"OpenLayers.Format.OSM"});OpenLayers.Handler=OpenLayers.Class({id:null,control:null,map:null,keyMask:null,active:!1,evt:null,initialize:function(a,b,c){OpenLayers.Util.extend(this,c);this.control=a;this.callbacks=b;(a=this.map||a.map)&&this.setMap(a);this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},setMap:function(a){this.map=a},checkModifiers:function(a){return null==this.keyMask?!0:((a.shiftKey?OpenLayers.Handler.MOD_SHIFT:0)|(a.ctrlKey?OpenLayers.Handler.MOD_CTRL:0)|(a.altKey?OpenLayers.Handler.MOD_ALT:0))==
this.keyMask},activate:function(){if(this.active)return!1;for(var a=OpenLayers.Events.prototype.BROWSER_EVENTS,b=0,c=a.length;b<c;b++)this[a[b]]&&this.register(a[b],this[a[b]]);return this.active=!0},deactivate:function(){if(!this.active)return!1;for(var a=OpenLayers.Events.prototype.BROWSER_EVENTS,b=0,c=a.length;b<c;b++)this[a[b]]&&this.unregister(a[b],this[a[b]]);this.active=!1;return!0},callback:function(a,b){a&&this.callbacks[a]&&this.callbacks[a].apply(this.control,b)},register:function(a,b){this.map.events.registerPriority(a,
this,b);this.map.events.registerPriority(a,this,this.setEvent)},unregister:function(a,b){this.map.events.unregister(a,this,b);this.map.events.unregister(a,this,this.setEvent)},setEvent:function(a){this.evt=a;return!0},destroy:function(){this.deactivate();this.control=this.map=null},CLASS_NAME:"OpenLayers.Handler"});OpenLayers.Handler.MOD_NONE=0;OpenLayers.Handler.MOD_SHIFT=1;OpenLayers.Handler.MOD_CTRL=2;OpenLayers.Handler.MOD_ALT=4;OpenLayers.Handler.Drag=OpenLayers.Class(OpenLayers.Handler,{started:!1,stopDown:!0,dragging:!1,touch:!1,last:null,start:null,lastMoveEvt:null,oldOnselectstart:null,interval:0,timeoutId:null,documentDrag:!1,documentEvents:null,initialize:function(a,b,c){OpenLayers.Handler.prototype.initialize.apply(this,arguments);if(!0===this.documentDrag){var d=this;this._docMove=function(a){d.mousemove({xy:{x:a.clientX,y:a.clientY},element:document})};this._docUp=function(a){d.mouseup({xy:{x:a.clientX,y:a.clientY}})}}},
dragstart:function(a){var b=!0;this.dragging=!1;this.checkModifiers(a)&&(OpenLayers.Event.isLeftClick(a)||OpenLayers.Event.isSingleTouch(a))?(this.started=!0,this.last=this.start=a.xy,OpenLayers.Element.addClass(this.map.viewPortDiv,"olDragDown"),this.down(a),this.callback("down",[a.xy]),OpenLayers.Event.stop(a),this.oldOnselectstart||(this.oldOnselectstart=document.onselectstart?document.onselectstart:OpenLayers.Function.True),document.onselectstart=OpenLayers.Function.False,b=!this.stopDown):(this.started=
!1,this.last=this.start=null);return b},dragmove:function(a){this.lastMoveEvt=a;if(this.started&&!this.timeoutId&&(a.xy.x!=this.last.x||a.xy.y!=this.last.y))!0===this.documentDrag&&this.documentEvents&&(a.element===document?(this.adjustXY(a),this.setEvent(a)):this.removeDocumentEvents()),0<this.interval&&(this.timeoutId=setTimeout(OpenLayers.Function.bind(this.removeTimeout,this),this.interval)),this.dragging=!0,this.move(a),this.callback("move",[a.xy]),this.oldOnselectstart||(this.oldOnselectstart=
document.onselectstart,document.onselectstart=OpenLayers.Function.False),this.last=a.xy;return!0},dragend:function(a){if(this.started){!0===this.documentDrag&&this.documentEvents&&(this.adjustXY(a),this.removeDocumentEvents());var b=this.start!=this.last;this.dragging=this.started=!1;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown");this.up(a);this.callback("up",[a.xy]);b&&this.callback("done",[a.xy]);document.onselectstart=this.oldOnselectstart}return!0},down:function(){},move:function(){},
up:function(){},out:function(){},mousedown:function(a){return this.dragstart(a)},touchstart:function(a){this.touch||(this.touch=!0,this.map.events.un({mousedown:this.mousedown,mouseup:this.mouseup,mousemove:this.mousemove,click:this.click,scope:this}));return this.dragstart(a)},mousemove:function(a){return this.dragmove(a)},touchmove:function(a){return this.dragmove(a)},removeTimeout:function(){this.timeoutId=null;this.dragging&&this.mousemove(this.lastMoveEvt)},mouseup:function(a){return this.dragend(a)},
touchend:function(a){a.xy=this.last;return this.dragend(a)},mouseout:function(a){if(this.started&&OpenLayers.Util.mouseLeft(a,this.map.viewPortDiv))if(!0===this.documentDrag)this.addDocumentEvents();else{var b=this.start!=this.last;this.dragging=this.started=!1;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown");this.out(a);this.callback("out",[]);b&&this.callback("done",[a.xy]);document.onselectstart&&(document.onselectstart=this.oldOnselectstart)}return!0},click:function(){return this.start==
this.last},activate:function(){var a=!1;OpenLayers.Handler.prototype.activate.apply(this,arguments)&&(this.dragging=!1,a=!0);return a},deactivate:function(){var a=!1;OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.dragging=this.started=this.touch=!1,this.last=this.start=null,a=!0,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown"));return a},adjustXY:function(a){var b=OpenLayers.Util.pagePosition(this.map.viewPortDiv);a.xy.x-=b[0];a.xy.y-=b[1]},addDocumentEvents:function(){OpenLayers.Element.addClass(document.body,
"olDragDown");this.documentEvents=!0;OpenLayers.Event.observe(document,"mousemove",this._docMove);OpenLayers.Event.observe(document,"mouseup",this._docUp)},removeDocumentEvents:function(){OpenLayers.Element.removeClass(document.body,"olDragDown");this.documentEvents=!1;OpenLayers.Event.stopObserving(document,"mousemove",this._docMove);OpenLayers.Event.stopObserving(document,"mouseup",this._docUp)},CLASS_NAME:"OpenLayers.Handler.Drag"});OpenLayers.Handler.Feature=OpenLayers.Class(OpenLayers.Handler,{EVENTMAP:{click:{"in":"click",out:"clickout"},mousemove:{"in":"over",out:"out"},dblclick:{"in":"dblclick",out:null},mousedown:{"in":null,out:null},mouseup:{"in":null,out:null},touchstart:{"in":"click",out:"clickout"}},feature:null,lastFeature:null,down:null,up:null,touch:!1,clickTolerance:4,geometryTypes:null,stopClick:!0,stopDown:!0,stopUp:!1,initialize:function(a,b,c,d){OpenLayers.Handler.prototype.initialize.apply(this,[a,c,d]);this.layer=
b},touchstart:function(a){this.touch||(this.touch=!0,this.map.events.un({mousedown:this.mousedown,mouseup:this.mouseup,mousemove:this.mousemove,click:this.click,dblclick:this.dblclick,scope:this}));return OpenLayers.Event.isMultiTouch(a)?!0:this.mousedown(a)},touchmove:function(a){OpenLayers.Event.stop(a)},mousedown:function(a){if(OpenLayers.Event.isLeftClick(a)||OpenLayers.Event.isSingleTouch(a))this.down=a.xy;return this.handle(a)?!this.stopDown:!0},mouseup:function(a){this.up=a.xy;return this.handle(a)?
!this.stopUp:!0},click:function(a){return this.handle(a)?!this.stopClick:!0},mousemove:function(a){if(!this.callbacks.over&&!this.callbacks.out)return!0;this.handle(a);return!0},dblclick:function(a){return!this.handle(a)},geometryTypeMatches:function(a){return null==this.geometryTypes||-1<OpenLayers.Util.indexOf(this.geometryTypes,a.geometry.CLASS_NAME)},handle:function(a){this.feature&&!this.feature.layer&&(this.feature=null);var b=a.type,c=!1,d=!!this.feature,e="click"==b||"dblclick"==b||"touchstart"==
b;if((this.feature=this.layer.getFeatureFromEvent(a))&&!this.feature.layer)this.feature=null;this.lastFeature&&!this.lastFeature.layer&&(this.lastFeature=null);this.feature?("touchstart"===b&&OpenLayers.Event.stop(a),a=this.feature!=this.lastFeature,this.geometryTypeMatches(this.feature)?(d&&a?(this.lastFeature&&this.triggerCallback(b,"out",[this.lastFeature]),this.triggerCallback(b,"in",[this.feature])):(!d||e)&&this.triggerCallback(b,"in",[this.feature]),this.lastFeature=this.feature,c=!0):(this.lastFeature&&
(d&&a||e)&&this.triggerCallback(b,"out",[this.lastFeature]),this.feature=null)):this.lastFeature&&(d||e)&&this.triggerCallback(b,"out",[this.lastFeature]);return c},triggerCallback:function(a,b,c){(b=this.EVENTMAP[a][b])&&("click"==a&&this.up&&this.down?Math.sqrt(Math.pow(this.up.x-this.down.x,2)+Math.pow(this.up.y-this.down.y,2))<=this.clickTolerance&&this.callback(b,c):this.callback(b,c))},activate:function(){var a=!1;OpenLayers.Handler.prototype.activate.apply(this,arguments)&&(this.moveLayerToTop(),
this.map.events.on({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this}),a=!0);return a},deactivate:function(){var a=!1;OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.moveLayerBack(),this.up=this.down=this.lastFeature=this.feature=null,this.touch=!1,this.map.events.un({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this}),a=!0);return a},handleMapEvents:function(a){("removelayer"==a.type||"order"==a.property)&&this.moveLayerToTop()},
moveLayerToTop:function(){this.layer.setZIndex(Math.max(this.map.Z_INDEX_BASE.Feature-1,this.layer.getZIndex())+1)},moveLayerBack:function(){var a=this.layer.getZIndex()-1;a>=this.map.Z_INDEX_BASE.Feature?this.layer.setZIndex(a):this.map.setLayerZIndex(this.layer,this.map.getLayerIndex(this.layer))},CLASS_NAME:"OpenLayers.Handler.Feature"});OpenLayers.Control.DragFeature=OpenLayers.Class(OpenLayers.Control,{geometryTypes:null,onStart:function(){},onDrag:function(){},onComplete:function(){},onEnter:function(){},onLeave:function(){},documentDrag:!1,layer:null,feature:null,dragCallbacks:{},featureCallbacks:{},lastPixel:null,initialize:function(a,b){OpenLayers.Control.prototype.initialize.apply(this,[b]);this.layer=a;this.handlers={drag:new OpenLayers.Handler.Drag(this,OpenLayers.Util.extend({down:this.downFeature,move:this.moveFeature,
up:this.upFeature,out:this.cancel,done:this.doneDragging},this.dragCallbacks),{documentDrag:this.documentDrag}),feature:new OpenLayers.Handler.Feature(this,this.layer,OpenLayers.Util.extend({click:this.clickFeature,clickout:this.clickoutFeature,over:this.overFeature,out:this.outFeature},this.featureCallbacks),{geometryTypes:this.geometryTypes})}},clickFeature:function(a){this.handlers.feature.touch&&(!this.over&&this.overFeature(a))&&(this.handlers.drag.dragstart(this.handlers.feature.evt),this.handlers.drag.stopDown=
!1)},clickoutFeature:function(a){this.handlers.feature.touch&&this.over&&(this.outFeature(a),this.handlers.drag.stopDown=!0)},destroy:function(){this.layer=null;OpenLayers.Control.prototype.destroy.apply(this,[])},activate:function(){return this.handlers.feature.activate()&&OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){this.handlers.drag.deactivate();this.handlers.feature.deactivate();this.feature=null;this.dragging=!1;this.lastPixel=null;OpenLayers.Element.removeClass(this.map.viewPortDiv,
this.displayClass+"Over");return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},overFeature:function(a){var b=!1;this.handlers.drag.dragging?this.over=this.feature.id==a.id?!0:!1:(this.feature=a,this.handlers.drag.activate(),this.over=b=!0,OpenLayers.Element.addClass(this.map.viewPortDiv,this.displayClass+"Over"),this.onEnter(a));return b},downFeature:function(a){this.lastPixel=a;this.onStart(this.feature,a)},moveFeature:function(a){var b=this.map.getResolution();this.feature.geometry.move(b*
(a.x-this.lastPixel.x),b*(this.lastPixel.y-a.y));this.layer.drawFeature(this.feature);this.lastPixel=a;this.onDrag(this.feature,a)},upFeature:function(){this.over||this.handlers.drag.deactivate()},doneDragging:function(a){this.onComplete(this.feature,a)},outFeature:function(a){this.handlers.drag.dragging?this.feature.id==a.id&&(this.over=!1):(this.over=!1,this.handlers.drag.deactivate(),OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass+"Over"),this.onLeave(a),this.feature=null)},
cancel:function(){this.handlers.drag.deactivate();this.over=!1},setMap:function(a){this.handlers.drag.setMap(a);this.handlers.feature.setMap(a);OpenLayers.Control.prototype.setMap.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.DragFeature"});OpenLayers.StyleMap=OpenLayers.Class({styles:null,extendDefault:!0,initialize:function(a,b){this.styles={"default":new OpenLayers.Style(OpenLayers.Feature.Vector.style["default"]),select:new OpenLayers.Style(OpenLayers.Feature.Vector.style.select),temporary:new OpenLayers.Style(OpenLayers.Feature.Vector.style.temporary),"delete":new OpenLayers.Style(OpenLayers.Feature.Vector.style["delete"])};if(a instanceof OpenLayers.Style)this.styles["default"]=a,this.styles.select=a,this.styles.temporary=a,this.styles["delete"]=
a;else if("object"==typeof a)for(var c in a)if(a[c]instanceof OpenLayers.Style)this.styles[c]=a[c];else if("object"==typeof a[c])this.styles[c]=new OpenLayers.Style(a[c]);else{this.styles["default"]=new OpenLayers.Style(a);this.styles.select=new OpenLayers.Style(a);this.styles.temporary=new OpenLayers.Style(a);this.styles["delete"]=new OpenLayers.Style(a);break}OpenLayers.Util.extend(this,b)},destroy:function(){for(var a in this.styles)this.styles[a].destroy();this.styles=null},createSymbolizer:function(a,
b){a||(a=new OpenLayers.Feature.Vector);this.styles[b]||(b="default");a.renderIntent=b;var c={};this.extendDefault&&"default"!=b&&(c=this.styles["default"].createSymbolizer(a));return OpenLayers.Util.extend(c,this.styles[b].createSymbolizer(a))},addUniqueValueRules:function(a,b,c,d){var e=[],f;for(f in c)e.push(new OpenLayers.Rule({symbolizer:c[f],context:d,filter:new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,property:b,value:f})}));this.styles[a].addRules(e)},CLASS_NAME:"OpenLayers.StyleMap"});OpenLayers.Layer.Vector=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:!1,isFixed:!1,features:null,filter:null,selectedFeatures:null,unrenderedFeatures:null,reportError:!0,style:null,styleMap:null,strategies:null,protocol:null,renderers:["SVG","VML","Canvas"],renderer:null,rendererOptions:null,geometryType:null,drawn:!1,ratio:1,initialize:function(a,b){OpenLayers.Layer.prototype.initialize.apply(this,arguments);(!this.renderer||!this.renderer.supported())&&this.assignRenderer();if(!this.renderer||
!this.renderer.supported())this.renderer=null,this.displayError();this.styleMap||(this.styleMap=new OpenLayers.StyleMap);this.features=[];this.selectedFeatures=[];this.unrenderedFeatures={};if(this.strategies)for(var c=0,d=this.strategies.length;c<d;c++)this.strategies[c].setLayer(this)},destroy:function(){if(this.strategies){var a,b,c;b=0;for(c=this.strategies.length;b<c;b++)a=this.strategies[b],a.autoDestroy&&a.destroy();this.strategies=null}this.protocol&&(this.protocol.autoDestroy&&this.protocol.destroy(),
this.protocol=null);this.destroyFeatures();this.unrenderedFeatures=this.selectedFeatures=this.features=null;this.renderer&&this.renderer.destroy();this.drawn=this.geometryType=this.renderer=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(a){null==a&&(a=new OpenLayers.Layer.Vector(this.name,this.getOptions()));for(var a=OpenLayers.Layer.prototype.clone.apply(this,[a]),b=this.features,c=b.length,d=Array(c),e=0;e<c;++e)d[e]=b[e].clone();a.features=d;return a},refresh:function(a){this.calculateInRange()&&
this.visibility&&this.events.triggerEvent("refresh",a)},assignRenderer:function(){for(var a=0,b=this.renderers.length;a<b;a++){var c=this.renderers[a];if((c="function"==typeof c?c:OpenLayers.Renderer[c])&&c.prototype.supported()){this.renderer=new c(this.div,this.rendererOptions);break}}},displayError:function(){this.reportError&&OpenLayers.Console.userError(OpenLayers.i18n("browserNotSupported",{renderers:this.renderers.join("\n")}))},setMap:function(a){OpenLayers.Layer.prototype.setMap.apply(this,
arguments);if(this.renderer){this.renderer.map=this.map;var b=this.map.getSize();b.w*=this.ratio;b.h*=this.ratio;this.renderer.setSize(b)}else this.map.removeLayer(this)},afterAdd:function(){if(this.strategies){var a,b,c;b=0;for(c=this.strategies.length;b<c;b++)a=this.strategies[b],a.autoActivate&&a.activate()}},removeMap:function(){this.drawn=!1;if(this.strategies){var a,b,c;b=0;for(c=this.strategies.length;b<c;b++)a=this.strategies[b],a.autoActivate&&a.deactivate()}},onMapResize:function(){OpenLayers.Layer.prototype.onMapResize.apply(this,
arguments);var a=this.map.getSize();a.w*=this.ratio;a.h*=this.ratio;this.renderer.setSize(a)},moveTo:function(a,b,c){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var d=!0;if(!c){this.renderer.root.style.visibility="hidden";var d=this.map.getSize(),e=d.w,d=d.h,e=e/2*this.ratio-e/2,d=d/2*this.ratio-d/2,e=e+parseInt(this.map.layerContainerDiv.style.left,10),e=-Math.round(e),d=d+parseInt(this.map.layerContainerDiv.style.top,10),d=-Math.round(d);this.div.style.left=e+"px";this.div.style.top=
d+"px";d=this.renderer.setExtent(this.map.getExtent().scale(this.ratio),b);this.renderer.root.style.visibility="visible";!0===OpenLayers.IS_GECKO&&(this.div.scrollLeft=this.div.scrollLeft);if(!b&&d)for(var f in this.unrenderedFeatures)e=this.unrenderedFeatures[f],this.drawFeature(e)}if(!this.drawn||b||!d){this.drawn=!0;f=0;for(d=this.features.length;f<d;f++)this.renderer.locked=f!==d-1,e=this.features[f],this.drawFeature(e)}},display:function(a){OpenLayers.Layer.prototype.display.apply(this,arguments);
var b=this.div.style.display;b!=this.renderer.root.style.display&&(this.renderer.root.style.display=b)},addFeatures:function(a,b){OpenLayers.Util.isArray(a)||(a=[a]);var c=!b||!b.silent;if(c){var d={features:a};if(!1===this.events.triggerEvent("beforefeaturesadded",d))return;a=d.features}for(var d=[],e=0,f=a.length;e<f;e++){this.renderer.locked=e!=a.length-1?!0:!1;var g=a[e];if(this.geometryType&&!(g.geometry instanceof this.geometryType))throw new TypeError("addFeatures: component should be an "+
this.geometryType.prototype.CLASS_NAME);g.layer=this;!g.style&&this.style&&(g.style=OpenLayers.Util.extend({},this.style));if(c){if(!1===this.events.triggerEvent("beforefeatureadded",{feature:g}))continue;this.preFeatureInsert(g)}d.push(g);this.features.push(g);this.drawFeature(g);c&&(this.events.triggerEvent("featureadded",{feature:g}),this.onFeatureInsert(g))}c&&this.events.triggerEvent("featuresadded",{features:d})},removeFeatures:function(a,b){if(a&&0!==a.length){if(a===this.features)return this.removeAllFeatures(b);
OpenLayers.Util.isArray(a)||(a=[a]);a===this.selectedFeatures&&(a=a.slice());var c=!b||!b.silent;c&&this.events.triggerEvent("beforefeaturesremoved",{features:a});for(var d=a.length-1;0<=d;d--){this.renderer.locked=0!=d&&a[d-1].geometry?!0:!1;var e=a[d];delete this.unrenderedFeatures[e.id];c&&this.events.triggerEvent("beforefeatureremoved",{feature:e});this.features=OpenLayers.Util.removeItem(this.features,e);e.layer=null;e.geometry&&this.renderer.eraseFeatures(e);-1!=OpenLayers.Util.indexOf(this.selectedFeatures,
e)&&OpenLayers.Util.removeItem(this.selectedFeatures,e);c&&this.events.triggerEvent("featureremoved",{feature:e})}c&&this.events.triggerEvent("featuresremoved",{features:a})}},removeAllFeatures:function(a){var a=!a||!a.silent,b=this.features;a&&this.events.triggerEvent("beforefeaturesremoved",{features:b});for(var c,d=b.length-1;0<=d;d--)c=b[d],a&&this.events.triggerEvent("beforefeatureremoved",{feature:c}),c.layer=null,a&&this.events.triggerEvent("featureremoved",{feature:c});this.renderer.clear();
this.features=[];this.unrenderedFeatures={};this.selectedFeatures=[];a&&this.events.triggerEvent("featuresremoved",{features:b})},destroyFeatures:function(a,b){void 0==a&&(a=this.features);if(a){this.removeFeatures(a,b);for(var c=a.length-1;0<=c;c--)a[c].destroy()}},drawFeature:function(a,b){if(this.drawn){if("object"!=typeof b){!b&&a.state===OpenLayers.State.DELETE&&(b="delete");var c=b||a.renderIntent;(b=a.style||this.style)||(b=this.styleMap.createSymbolizer(a,c))}c=this.renderer.drawFeature(a,
b);!1===c||null===c?this.unrenderedFeatures[a.id]=a:delete this.unrenderedFeatures[a.id]}},eraseFeatures:function(a){this.renderer.eraseFeatures(a)},getFeatureFromEvent:function(a){if(!this.renderer)throw Error("getFeatureFromEvent called on layer with no renderer. This usually means you destroyed a layer, but not some handler which is associated with it.");var b=null;(a=this.renderer.getFeatureIdFromEvent(a))&&(b="string"===typeof a?this.getFeatureById(a):a);return b},getFeatureBy:function(a,b){for(var c=
null,d=0,e=this.features.length;d<e;++d)if(this.features[d][a]==b){c=this.features[d];break}return c},getFeatureById:function(a){return this.getFeatureBy("id",a)},getFeatureByFid:function(a){return this.getFeatureBy("fid",a)},getFeaturesByAttribute:function(a,b){var c,d,e=this.features.length,f=[];for(c=0;c<e;c++)(d=this.features[c])&&d.attributes&&d.attributes[a]===b&&f.push(d);return f},onFeatureInsert:function(){},preFeatureInsert:function(){},getDataExtent:function(){var a=null,b=this.features;
if(b&&0<b.length)for(var c=null,d=0,e=b.length;d<e;d++)if(c=b[d].geometry)null===a&&(a=new OpenLayers.Bounds),a.extend(c.getBounds());return a},CLASS_NAME:"OpenLayers.Layer.Vector"});OpenLayers.Layer.Vector.RootContainer=OpenLayers.Class(OpenLayers.Layer.Vector,{displayInLayerSwitcher:!1,layers:null,display:function(){},getFeatureFromEvent:function(a){for(var b=this.layers,c,d=0;d<b.length;d++)if(c=b[d].getFeatureFromEvent(a))return c},setMap:function(a){OpenLayers.Layer.Vector.prototype.setMap.apply(this,arguments);this.collectRoots();a.events.register("changelayer",this,this.handleChangeLayer)},removeMap:function(a){a.events.unregister("changelayer",this,this.handleChangeLayer);
this.resetRoots();OpenLayers.Layer.Vector.prototype.removeMap.apply(this,arguments)},collectRoots:function(){for(var a,b=0;b<this.map.layers.length;++b)a=this.map.layers[b],-1!=OpenLayers.Util.indexOf(this.layers,a)&&a.renderer.moveRoot(this.renderer)},resetRoots:function(){for(var a,b=0;b<this.layers.length;++b)a=this.layers[b],this.renderer&&a.renderer.getRenderLayerId()==this.id&&this.renderer.moveRoot(a.renderer)},handleChangeLayer:function(a){var b=a.layer;"order"==a.property&&-1!=OpenLayers.Util.indexOf(this.layers,
b)&&(this.resetRoots(),this.collectRoots())},CLASS_NAME:"OpenLayers.Layer.Vector.RootContainer"});OpenLayers.Control.SelectFeature=OpenLayers.Class(OpenLayers.Control,{multipleKey:null,toggleKey:null,multiple:!1,clickout:!0,toggle:!1,hover:!1,highlightOnly:!1,box:!1,onBeforeSelect:function(){},onSelect:function(){},onUnselect:function(){},scope:null,geometryTypes:null,layer:null,layers:null,callbacks:null,selectStyle:null,renderIntent:"select",handlers:null,initialize:function(a,b){OpenLayers.Control.prototype.initialize.apply(this,[b]);null===this.scope&&(this.scope=this);this.initLayer(a);var c=
{click:this.clickFeature,clickout:this.clickoutFeature};this.hover&&(c.over=this.overFeature,c.out=this.outFeature);this.callbacks=OpenLayers.Util.extend(c,this.callbacks);this.handlers={feature:new OpenLayers.Handler.Feature(this,this.layer,this.callbacks,{geometryTypes:this.geometryTypes})};this.box&&(this.handlers.box=new OpenLayers.Handler.Box(this,{done:this.selectBox},{boxDivClassName:"olHandlerBoxSelectFeature"}))},initLayer:function(a){OpenLayers.Util.isArray(a)?(this.layers=a,this.layer=
new OpenLayers.Layer.Vector.RootContainer(this.id+"_container",{layers:a})):this.layer=a},destroy:function(){this.active&&this.layers&&this.map.removeLayer(this.layer);OpenLayers.Control.prototype.destroy.apply(this,arguments);this.layers&&this.layer.destroy()},activate:function(){this.active||(this.layers&&this.map.addLayer(this.layer),this.handlers.feature.activate(),this.box&&this.handlers.box&&this.handlers.box.activate());return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){this.active&&
(this.handlers.feature.deactivate(),this.handlers.box&&this.handlers.box.deactivate(),this.layers&&this.map.removeLayer(this.layer));return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},unselectAll:function(a){for(var b=this.layers||[this.layer],c,d,e=0;e<b.length;++e){c=b[e];for(var f=c.selectedFeatures.length-1;0<=f;--f)d=c.selectedFeatures[f],(!a||a.except!=d)&&this.unselect(d)}},clickFeature:function(a){this.hover||(-1<OpenLayers.Util.indexOf(a.layer.selectedFeatures,a)?this.toggleSelect()?
this.unselect(a):this.multipleSelect()||this.unselectAll({except:a}):(this.multipleSelect()||this.unselectAll({except:a}),this.select(a)))},multipleSelect:function(){return this.multiple||this.handlers.feature.evt&&this.handlers.feature.evt[this.multipleKey]},toggleSelect:function(){return this.toggle||this.handlers.feature.evt&&this.handlers.feature.evt[this.toggleKey]},clickoutFeature:function(){!this.hover&&this.clickout&&this.unselectAll()},overFeature:function(a){var b=a.layer;this.hover&&(this.highlightOnly?
this.highlight(a):-1==OpenLayers.Util.indexOf(b.selectedFeatures,a)&&this.select(a))},outFeature:function(a){if(this.hover)if(this.highlightOnly){if(a._lastHighlighter==this.id)if(a._prevHighlighter&&a._prevHighlighter!=this.id){delete a._lastHighlighter;var b=this.map.getControl(a._prevHighlighter);b&&b.highlight(a)}else this.unhighlight(a)}else this.unselect(a)},highlight:function(a){var b=a.layer;!1!==this.events.triggerEvent("beforefeaturehighlighted",{feature:a})&&(a._prevHighlighter=a._lastHighlighter,
a._lastHighlighter=this.id,b.drawFeature(a,this.selectStyle||this.renderIntent),this.events.triggerEvent("featurehighlighted",{feature:a}))},unhighlight:function(a){var b=a.layer;void 0==a._prevHighlighter?delete a._lastHighlighter:(a._prevHighlighter!=this.id&&(a._lastHighlighter=a._prevHighlighter),delete a._prevHighlighter);b.drawFeature(a,a.style||a.layer.style||"default");this.events.triggerEvent("featureunhighlighted",{feature:a})},select:function(a){var b=this.onBeforeSelect.call(this.scope,
a),c=a.layer;!1!==b&&(b=c.events.triggerEvent("beforefeatureselected",{feature:a}),!1!==b&&(c.selectedFeatures.push(a),this.highlight(a),this.handlers.feature.lastFeature||(this.handlers.feature.lastFeature=c.selectedFeatures[0]),c.events.triggerEvent("featureselected",{feature:a}),this.onSelect.call(this.scope,a)))},unselect:function(a){var b=a.layer;this.unhighlight(a);OpenLayers.Util.removeItem(b.selectedFeatures,a);b.events.triggerEvent("featureunselected",{feature:a});this.onUnselect.call(this.scope,
a)},selectBox:function(a){if(a instanceof OpenLayers.Bounds){var b=this.map.getLonLatFromPixel({x:a.left,y:a.bottom}),a=this.map.getLonLatFromPixel({x:a.right,y:a.top}),b=new OpenLayers.Bounds(b.lon,b.lat,a.lon,a.lat);this.multipleSelect()||this.unselectAll();a=this.multiple;this.multiple=!0;var c=this.layers||[this.layer];this.events.triggerEvent("boxselectionstart",{layers:c});for(var d,e=0;e<c.length;++e){d=c[e];for(var f=0,g=d.features.length;f<g;++f){var h=d.features[f];h.getVisibility()&&(null==
this.geometryTypes||-1<OpenLayers.Util.indexOf(this.geometryTypes,h.geometry.CLASS_NAME))&&b.toGeometry().intersects(h.geometry)&&-1==OpenLayers.Util.indexOf(d.selectedFeatures,h)&&this.select(h)}}this.multiple=a;this.events.triggerEvent("boxselectionend",{layers:c})}},setMap:function(a){this.handlers.feature.setMap(a);this.box&&this.handlers.box.setMap(a);OpenLayers.Control.prototype.setMap.apply(this,arguments)},setLayer:function(a){var b=this.active;this.unselectAll();this.deactivate();this.layers&&
(this.layer.destroy(),this.layers=null);this.initLayer(a);this.handlers.feature.layer=this.layer;b&&this.activate()},CLASS_NAME:"OpenLayers.Control.SelectFeature"});OpenLayers.Handler.Keyboard=OpenLayers.Class(OpenLayers.Handler,{KEY_EVENTS:["keydown","keyup"],eventListener:null,observeElement:null,initialize:function(a,b,c){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.eventListener=OpenLayers.Function.bindAsEventListener(this.handleKeyEvent,this)},destroy:function(){this.deactivate();this.eventListener=null;OpenLayers.Handler.prototype.destroy.apply(this,arguments)},activate:function(){if(OpenLayers.Handler.prototype.activate.apply(this,
arguments)){this.observeElement=this.observeElement||document;for(var a=0,b=this.KEY_EVENTS.length;a<b;a++)OpenLayers.Event.observe(this.observeElement,this.KEY_EVENTS[a],this.eventListener);return!0}return!1},deactivate:function(){var a=!1;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){for(var a=0,b=this.KEY_EVENTS.length;a<b;a++)OpenLayers.Event.stopObserving(this.observeElement,this.KEY_EVENTS[a],this.eventListener);a=!0}return a},handleKeyEvent:function(a){this.checkModifiers(a)&&
this.callback(a.type,[a])},CLASS_NAME:"OpenLayers.Handler.Keyboard"});OpenLayers.Control.ModifyFeature=OpenLayers.Class(OpenLayers.Control,{geometryTypes:null,clickout:!0,toggle:!0,standalone:!1,layer:null,feature:null,vertices:null,virtualVertices:null,selectControl:null,dragControl:null,handlers:null,deleteCodes:null,virtualStyle:null,vertexRenderIntent:null,mode:null,createVertices:!0,modified:!1,radiusHandle:null,dragHandle:null,onModificationStart:function(){},onModification:function(){},onModificationEnd:function(){},initialize:function(a,b){b=b||{};this.layer=
a;this.vertices=[];this.virtualVertices=[];this.virtualStyle=OpenLayers.Util.extend({},this.layer.style||this.layer.styleMap.createSymbolizer(null,b.vertexRenderIntent));this.virtualStyle.fillOpacity=0.3;this.virtualStyle.strokeOpacity=0.3;this.deleteCodes=[46,68];this.mode=OpenLayers.Control.ModifyFeature.RESHAPE;OpenLayers.Control.prototype.initialize.apply(this,[b]);OpenLayers.Util.isArray(this.deleteCodes)||(this.deleteCodes=[this.deleteCodes]);var c=this,d={geometryTypes:this.geometryTypes,clickout:this.clickout,
toggle:this.toggle,onBeforeSelect:this.beforeSelectFeature,onSelect:this.selectFeature,onUnselect:this.unselectFeature,scope:this};!1===this.standalone&&(this.selectControl=new OpenLayers.Control.SelectFeature(a,d));this.dragControl=new OpenLayers.Control.DragFeature(a,{geometryTypes:["OpenLayers.Geometry.Point"],onStart:function(a,b){c.dragStart.apply(c,[a,b])},onDrag:function(a,b){c.dragVertex.apply(c,[a,b])},onComplete:function(a){c.dragComplete.apply(c,[a])},featureCallbacks:{over:function(a){(c.standalone!==
true||a._sketch||c.feature===a)&&c.dragControl.overFeature.apply(c.dragControl,[a])}}});this.handlers={keyboard:new OpenLayers.Handler.Keyboard(this,{keydown:this.handleKeypress})}},destroy:function(){this.layer=null;this.standalone||this.selectControl.destroy();this.dragControl.destroy();OpenLayers.Control.prototype.destroy.apply(this,[])},activate:function(){return(this.standalone||this.selectControl.activate())&&this.handlers.keyboard.activate()&&OpenLayers.Control.prototype.activate.apply(this,
arguments)},deactivate:function(){var a=!1;if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){this.layer.removeFeatures(this.vertices,{silent:!0});this.layer.removeFeatures(this.virtualVertices,{silent:!0});this.vertices=[];this.dragControl.deactivate();var b=(a=this.feature)&&a.geometry&&a.layer;!1===this.standalone?(b&&this.selectControl.unselect.apply(this.selectControl,[a]),this.selectControl.deactivate()):b&&this.unselectFeature(a);this.handlers.keyboard.deactivate();a=!0}return a},
beforeSelectFeature:function(a){return this.layer.events.triggerEvent("beforefeaturemodified",{feature:a})},selectFeature:function(a){if(!this.standalone||!1!==this.beforeSelectFeature(a))this.feature=a,this.modified=!1,this.resetVertices(),this.dragControl.activate(),this.onModificationStart(this.feature);var b=a.modified;if(a.geometry&&(!b||!b.geometry))this._originalGeometry=a.geometry.clone()},unselectFeature:function(a){this.layer.removeFeatures(this.vertices,{silent:!0});this.vertices=[];this.layer.destroyFeatures(this.virtualVertices,
{silent:!0});this.virtualVertices=[];this.dragHandle&&(this.layer.destroyFeatures([this.dragHandle],{silent:!0}),delete this.dragHandle);this.radiusHandle&&(this.layer.destroyFeatures([this.radiusHandle],{silent:!0}),delete this.radiusHandle);this.feature=null;this.dragControl.deactivate();this.onModificationEnd(a);this.layer.events.triggerEvent("afterfeaturemodified",{feature:a,modified:this.modified});this.modified=!1},dragStart:function(a,b){if(a!=this.feature&&(!a.geometry.parent&&a!=this.dragHandle&&
a!=this.radiusHandle)&&(!1===this.standalone&&this.feature&&this.selectControl.clickFeature.apply(this.selectControl,[this.feature]),null==this.geometryTypes||-1!=OpenLayers.Util.indexOf(this.geometryTypes,a.geometry.CLASS_NAME)))this.standalone||this.selectControl.clickFeature.apply(this.selectControl,[a]),this.dragControl.overFeature.apply(this.dragControl,[a]),this.dragControl.lastPixel=b,this.dragControl.handlers.drag.started=!0,this.dragControl.handlers.drag.start=b,this.dragControl.handlers.drag.last=
b},dragVertex:function(a,b){this.modified=!0;"OpenLayers.Geometry.Point"==this.feature.geometry.CLASS_NAME?(this.feature!=a&&(this.feature=a),this.layer.events.triggerEvent("vertexmodified",{vertex:a.geometry,feature:this.feature,pixel:b})):(a._index?(a.geometry.parent.addComponent(a.geometry,a._index),delete a._index,OpenLayers.Util.removeItem(this.virtualVertices,a),this.vertices.push(a)):a==this.dragHandle?(this.layer.removeFeatures(this.vertices,{silent:!0}),this.vertices=[],this.radiusHandle&&
(this.layer.destroyFeatures([this.radiusHandle],{silent:!0}),this.radiusHandle=null)):a!==this.radiusHandle&&this.layer.events.triggerEvent("vertexmodified",{vertex:a.geometry,feature:this.feature,pixel:b}),0<this.virtualVertices.length&&(this.layer.destroyFeatures(this.virtualVertices,{silent:!0}),this.virtualVertices=[]),this.layer.drawFeature(this.feature,this.standalone?void 0:this.selectControl.renderIntent));this.layer.drawFeature(a)},dragComplete:function(){this.resetVertices();this.setFeatureState();
this.onModification(this.feature);this.layer.events.triggerEvent("featuremodified",{feature:this.feature})},setFeatureState:function(){if(this.feature.state!=OpenLayers.State.INSERT&&this.feature.state!=OpenLayers.State.DELETE&&(this.feature.state=OpenLayers.State.UPDATE,this.modified&&this._originalGeometry)){var a=this.feature;a.modified=OpenLayers.Util.extend(a.modified,{geometry:this._originalGeometry});delete this._originalGeometry}},resetVertices:function(){this.dragControl.feature&&this.dragControl.outFeature(this.dragControl.feature);
0<this.vertices.length&&(this.layer.removeFeatures(this.vertices,{silent:!0}),this.vertices=[]);0<this.virtualVertices.length&&(this.layer.removeFeatures(this.virtualVertices,{silent:!0}),this.virtualVertices=[]);this.dragHandle&&(this.layer.destroyFeatures([this.dragHandle],{silent:!0}),this.dragHandle=null);this.radiusHandle&&(this.layer.destroyFeatures([this.radiusHandle],{silent:!0}),this.radiusHandle=null);this.feature&&"OpenLayers.Geometry.Point"!=this.feature.geometry.CLASS_NAME&&(this.mode&
OpenLayers.Control.ModifyFeature.DRAG&&this.collectDragHandle(),this.mode&(OpenLayers.Control.ModifyFeature.ROTATE|OpenLayers.Control.ModifyFeature.RESIZE)&&this.collectRadiusHandle(),this.mode&OpenLayers.Control.ModifyFeature.RESHAPE&&(this.mode&OpenLayers.Control.ModifyFeature.RESIZE||this.collectVertices()))},handleKeypress:function(a){var b=a.keyCode;if(this.feature&&-1!=OpenLayers.Util.indexOf(this.deleteCodes,b)&&(b=this.dragControl.feature)&&-1!=OpenLayers.Util.indexOf(this.vertices,b)&&!this.dragControl.handlers.drag.dragging&&
b.geometry.parent)b.geometry.parent.removeComponent(b.geometry),this.layer.events.triggerEvent("vertexremoved",{vertex:b.geometry,feature:this.feature,pixel:a.xy}),this.layer.drawFeature(this.feature,this.standalone?void 0:this.selectControl.renderIntent),this.modified=!0,this.resetVertices(),this.setFeatureState(),this.onModification(this.feature),this.layer.events.triggerEvent("featuremodified",{feature:this.feature})},collectVertices:function(){function a(c){var d,e,f;if("OpenLayers.Geometry.Point"==
c.CLASS_NAME)e=new OpenLayers.Feature.Vector(c),e._sketch=!0,e.renderIntent=b.vertexRenderIntent,b.vertices.push(e);else{f=c.components.length;"OpenLayers.Geometry.LinearRing"==c.CLASS_NAME&&(f-=1);for(d=0;d<f;++d)e=c.components[d],"OpenLayers.Geometry.Point"==e.CLASS_NAME?(e=new OpenLayers.Feature.Vector(e),e._sketch=!0,e.renderIntent=b.vertexRenderIntent,b.vertices.push(e)):a(e);if(b.createVertices&&"OpenLayers.Geometry.MultiPoint"!=c.CLASS_NAME){d=0;for(f=c.components.length;d<f-1;++d){e=c.components[d];
var g=c.components[d+1];"OpenLayers.Geometry.Point"==e.CLASS_NAME&&"OpenLayers.Geometry.Point"==g.CLASS_NAME&&(e=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point((e.x+g.x)/2,(e.y+g.y)/2),null,b.virtualStyle),e.geometry.parent=c,e._index=d+1,e._sketch=!0,b.virtualVertices.push(e))}}}}this.vertices=[];this.virtualVertices=[];var b=this;a.call(this,this.feature.geometry);this.layer.addFeatures(this.virtualVertices,{silent:!0});this.layer.addFeatures(this.vertices,{silent:!0})},collectDragHandle:function(){var a=
this.feature.geometry,b=a.getBounds().getCenterLonLat(),b=new OpenLayers.Geometry.Point(b.lon,b.lat),c=new OpenLayers.Feature.Vector(b);b.move=function(b,c){OpenLayers.Geometry.Point.prototype.move.call(this,b,c);a.move(b,c)};c._sketch=!0;this.dragHandle=c;this.dragHandle.renderIntent=this.vertexRenderIntent;this.layer.addFeatures([this.dragHandle],{silent:!0})},collectRadiusHandle:function(){var a=this.feature.geometry,b=a.getBounds(),c=b.getCenterLonLat(),d=new OpenLayers.Geometry.Point(c.lon,c.lat),
b=new OpenLayers.Geometry.Point(b.right,b.bottom),c=new OpenLayers.Feature.Vector(b),e=this.mode&OpenLayers.Control.ModifyFeature.RESIZE,f=this.mode&OpenLayers.Control.ModifyFeature.RESHAPE,g=this.mode&OpenLayers.Control.ModifyFeature.ROTATE;b.move=function(b,c){OpenLayers.Geometry.Point.prototype.move.call(this,b,c);var j=this.x-d.x,k=this.y-d.y,l=j-b,m=k-c;if(g){var n=Math.atan2(m,l),n=Math.atan2(k,j)-n,n=n*(180/Math.PI);a.rotate(n,d)}if(e){var o;f?(k/=m,o=j/l/k):(l=Math.sqrt(l*l+m*m),k=Math.sqrt(j*
j+k*k)/l);a.resize(k,d,o)}};c._sketch=!0;this.radiusHandle=c;this.radiusHandle.renderIntent=this.vertexRenderIntent;this.layer.addFeatures([this.radiusHandle],{silent:!0})},setMap:function(a){this.standalone||this.selectControl.setMap(a);this.dragControl.setMap(a);OpenLayers.Control.prototype.setMap.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.ModifyFeature"});OpenLayers.Control.ModifyFeature.RESHAPE=1;OpenLayers.Control.ModifyFeature.RESIZE=2;OpenLayers.Control.ModifyFeature.ROTATE=4;
OpenLayers.Control.ModifyFeature.DRAG=8;OpenLayers.Layer.Bing=OpenLayers.Class(OpenLayers.Layer.XYZ,{key:null,serverResolutions:[156543.03390625,78271.516953125,39135.7584765625,19567.87923828125,9783.939619140625,4891.9698095703125,2445.9849047851562,1222.9924523925781,611.4962261962891,305.74811309814453,152.87405654907226,76.43702827453613,38.218514137268066,19.109257068634033,9.554628534317017,4.777314267158508,2.388657133579254,1.194328566789627,0.5971642833948135,0.29858214169740677,0.14929107084870338,0.07464553542435169],attributionTemplate:'<span class="olBingAttribution ${type}"><div><a target="_blank" href="http://www.bing.com/maps/"><img src="${logo}" /></a></div>${copyrights}<a style="white-space: nowrap" target="_blank" href="http://www.microsoft.com/maps/product/terms.html">Terms of Use</a></span>',
metadata:null,type:"Road",culture:"en-US",metadataParams:null,tileOptions:null,initialize:function(a){a=OpenLayers.Util.applyDefaults({sphericalMercator:!0},a);OpenLayers.Layer.XYZ.prototype.initialize.apply(this,[a.name||"Bing "+(a.type||this.type),null,a]);this.tileOptions=OpenLayers.Util.extend({crossOriginKeyword:"anonymous"},this.options.tileOptions);this.loadMetadata()},loadMetadata:function(){this._callbackId="_callback_"+this.id.replace(/\./g,"_");window[this._callbackId]=OpenLayers.Function.bind(OpenLayers.Layer.Bing.processMetadata,
this);var a=OpenLayers.Util.applyDefaults({key:this.key,jsonp:this._callbackId,include:"ImageryProviders"},this.metadataParams),a="http://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.type+"?"+OpenLayers.Util.getParameterString(a),b=document.createElement("script");b.type="text/javascript";b.src=a;b.id=this._callbackId;document.getElementsByTagName("head")[0].appendChild(b)},initLayer:function(){var a=this.metadata.resourceSets[0].resources[0],b=a.imageUrl.replace("{quadkey}","${quadkey}"),
b=b.replace("{culture}",this.culture);this.url=[];for(var c=0;c<a.imageUrlSubdomains.length;++c)this.url.push(b.replace("{subdomain}",a.imageUrlSubdomains[c]));this.addOptions({maxResolution:Math.min(this.serverResolutions[a.zoomMin],this.maxResolution||Number.POSITIVE_INFINITY),numZoomLevels:Math.min(a.zoomMax+1-a.zoomMin,this.numZoomLevels)},!0)},getURL:function(a){if(this.url){for(var b=this.getXYZ(a),a=b.x,c=b.y,b=b.z,d=[],e=b;0<e;--e){var f="0",g=1<<e-1;0!=(a&g)&&f++;0!=(c&g)&&(f++,f++);d.push(f)}d=
d.join("");a=this.selectUrl(""+a+c+b,this.url);return OpenLayers.String.format(a,{quadkey:d})}},updateAttribution:function(){var a=this.metadata;if(a.resourceSets&&this.map&&this.map.center){var b=a.resourceSets[0].resources[0],c=this.map.getExtent().transform(this.map.getProjectionObject(),new OpenLayers.Projection("EPSG:4326")),b=b.imageryProviders,d=OpenLayers.Util.indexOf(this.serverResolutions,this.getServerResolution()),e="",f,g,h,i,j,k,l;g=0;for(h=b.length;g<h;++g){f=b[g];i=0;for(j=f.coverageAreas.length;i<
j;++i)l=f.coverageAreas[i],k=OpenLayers.Bounds.fromArray(l.bbox,!0),c.intersectsBounds(k)&&(d<=l.zoomMax&&d>=l.zoomMin)&&(e+=f.attribution+" ")}this.attribution=OpenLayers.String.format(this.attributionTemplate,{type:this.type.toLowerCase(),logo:a.brandLogoUri,copyrights:e});this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"attribution"})}},setMap:function(){OpenLayers.Layer.XYZ.prototype.setMap.apply(this,arguments);this.updateAttribution();this.map.events.register("moveend",
this,this.updateAttribution)},clone:function(a){null==a&&(a=new OpenLayers.Layer.Bing(this.options));return a=OpenLayers.Layer.XYZ.prototype.clone.apply(this,[a])},destroy:function(){this.map&&this.map.events.unregister("moveend",this,this.updateAttribution);OpenLayers.Layer.XYZ.prototype.destroy.apply(this,arguments)},CLASS_NAME:"OpenLayers.Layer.Bing"});
OpenLayers.Layer.Bing.processMetadata=function(a){this.metadata=a;this.initLayer();a=document.getElementById(this._callbackId);a.parentNode.removeChild(a);window[this._callbackId]=void 0;delete this._callbackId};OpenLayers.Layer.PointGrid=OpenLayers.Class(OpenLayers.Layer.Vector,{dx:null,dy:null,ratio:1.5,maxFeatures:250,rotation:0,origin:null,gridBounds:null,initialize:function(a){a=a||{};OpenLayers.Layer.Vector.prototype.initialize.apply(this,[a.name,a])},setMap:function(a){OpenLayers.Layer.Vector.prototype.setMap.apply(this,arguments);a.events.register("moveend",this,this.onMoveEnd)},removeMap:function(a){a.events.unregister("moveend",this,this.onMoveEnd);OpenLayers.Layer.Vector.prototype.removeMap.apply(this,
arguments)},setRatio:function(a){this.ratio=a;this.updateGrid(!0)},setMaxFeatures:function(a){this.maxFeatures=a;this.updateGrid(!0)},setSpacing:function(a,b){this.dx=a;this.dy=b||a;this.updateGrid(!0)},setOrigin:function(a){this.origin=a;this.updateGrid(!0)},getOrigin:function(){this.origin||(this.origin=this.map.getExtent().getCenterLonLat());return this.origin},setRotation:function(a){this.rotation=a;this.updateGrid(!0)},onMoveEnd:function(){this.updateGrid()},getViewBounds:function(){var a=this.map.getExtent();
if(this.rotation){var b=this.getOrigin(),b=new OpenLayers.Geometry.Point(b.lon,b.lat),a=a.toGeometry();a.rotate(-this.rotation,b);a=a.getBounds()}return a},updateGrid:function(a){if(a||this.invalidBounds()){var b=this.getViewBounds(),c=this.getOrigin(),a=new OpenLayers.Geometry.Point(c.lon,c.lat),d=b.getWidth(),e=b.getHeight(),f=d/e,g=Math.sqrt(this.dx*this.dy*this.maxFeatures/f),d=Math.min(d*this.ratio,g*f),e=Math.min(e*this.ratio,g),b=b.getCenterLonLat();this.gridBounds=new OpenLayers.Bounds(b.lon-
d/2,b.lat-e/2,b.lon+d/2,b.lat+e/2);for(var b=Math.floor(e/this.dy),d=Math.floor(d/this.dx),e=c.lon+this.dx*Math.ceil((this.gridBounds.left-c.lon)/this.dx),c=c.lat+this.dy*Math.ceil((this.gridBounds.bottom-c.lat)/this.dy),g=Array(b*d),h,i=0;i<d;++i)for(var f=e+i*this.dx,j=0;j<b;++j)h=c+j*this.dy,h=new OpenLayers.Geometry.Point(f,h),this.rotation&&h.rotate(this.rotation,a),g[i*b+j]=new OpenLayers.Feature.Vector(h);this.destroyFeatures(this.features,{silent:!0});this.addFeatures(g,{silent:!0})}},invalidBounds:function(){return!this.gridBounds||
!this.gridBounds.containsBounds(this.getViewBounds())},CLASS_NAME:"OpenLayers.Layer.PointGrid"});OpenLayers.Handler.MouseWheel=OpenLayers.Class(OpenLayers.Handler,{wheelListener:null,mousePosition:null,interval:0,delta:0,cumulative:!0,initialize:function(a,b,c){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.wheelListener=OpenLayers.Function.bindAsEventListener(this.onWheelEvent,this)},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments);this.wheelListener=null},onWheelEvent:function(a){if(this.map&&this.checkModifiers(a)){for(var b=!1,c=!1,d=!1,e=
OpenLayers.Event.element(a);null!=e&&!d&&!b;){if(!b)try{var f=e.currentStyle?e.currentStyle.overflow:document.defaultView.getComputedStyle(e,null).getPropertyValue("overflow"),b=f&&"auto"==f||"scroll"==f}catch(g){}if(!c)for(var d=0,h=this.map.layers.length;d<h;d++)if(e==this.map.layers[d].div||e==this.map.layers[d].pane){c=!0;break}d=e==this.map.div;e=e.parentNode}!b&&d&&(c&&((b=0,a||(a=window.event),a.wheelDelta?(b=a.wheelDelta/120,window.opera&&9.2>window.opera.version()&&(b=-b)):a.detail&&(b=-a.detail/
3),this.delta+=b,this.interval)?(window.clearTimeout(this._timeoutId),this._timeoutId=window.setTimeout(OpenLayers.Function.bind(function(){this.wheelZoom(a)},this),this.interval)):this.wheelZoom(a)),OpenLayers.Event.stop(a))}},wheelZoom:function(a){var b=this.delta;this.delta=0;b&&(this.mousePosition&&(a.xy=this.mousePosition),a.xy||(a.xy=this.map.getPixelFromLonLat(this.map.getCenter())),0>b?this.callback("down",[a,this.cumulative?b:-1]):this.callback("up",[a,this.cumulative?b:1]))},mousemove:function(a){this.mousePosition=
a.xy},activate:function(a){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){var b=this.wheelListener;OpenLayers.Event.observe(window,"DOMMouseScroll",b);OpenLayers.Event.observe(window,"mousewheel",b);OpenLayers.Event.observe(document,"mousewheel",b);return!0}return!1},deactivate:function(a){if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){var b=this.wheelListener;OpenLayers.Event.stopObserving(window,"DOMMouseScroll",b);OpenLayers.Event.stopObserving(window,"mousewheel",
b);OpenLayers.Event.stopObserving(document,"mousewheel",b);return!0}return!1},CLASS_NAME:"OpenLayers.Handler.MouseWheel"});OpenLayers.Symbolizer=OpenLayers.Class({zIndex:0,initialize:function(a){OpenLayers.Util.extend(this,a)},clone:function(){return new (eval(this.CLASS_NAME))(OpenLayers.Util.extend({},this))},CLASS_NAME:"OpenLayers.Symbolizer"});OpenLayers.Symbolizer.Raster=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(a){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Raster"});OpenLayers.Rule=OpenLayers.Class({id:null,name:null,title:null,description:null,context:null,filter:null,elseFilter:!1,symbolizer:null,symbolizers:null,minScaleDenominator:null,maxScaleDenominator:null,initialize:function(a){this.symbolizer={};OpenLayers.Util.extend(this,a);this.symbolizers&&delete this.symbolizer;this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var a in this.symbolizer)this.symbolizer[a]=null;this.symbolizer=null;delete this.symbolizers},evaluate:function(a){var b=
this.getContext(a),c=!0;if(this.minScaleDenominator||this.maxScaleDenominator)var d=a.layer.map.getScale();this.minScaleDenominator&&(c=d>=OpenLayers.Style.createLiteral(this.minScaleDenominator,b));c&&this.maxScaleDenominator&&(c=d<OpenLayers.Style.createLiteral(this.maxScaleDenominator,b));c&&this.filter&&(c="OpenLayers.Filter.FeatureId"==this.filter.CLASS_NAME?this.filter.evaluate(a):this.filter.evaluate(b));return c},getContext:function(a){var b=this.context;b||(b=a.attributes||a.data);"function"==
typeof this.context&&(b=this.context(a));return b},clone:function(){var a=OpenLayers.Util.extend({},this);if(this.symbolizers){var b=this.symbolizers.length;a.symbolizers=Array(b);for(var c=0;c<b;++c)a.symbolizers[c]=this.symbolizers[c].clone()}else{a.symbolizer={};for(var d in this.symbolizer)b=this.symbolizer[d],c=typeof b,"object"===c?a.symbolizer[d]=OpenLayers.Util.extend({},b):"string"===c&&(a.symbolizer[d]=b)}a.filter=this.filter&&this.filter.clone();a.context=this.context&&OpenLayers.Util.extend({},
this.context);return new OpenLayers.Rule(a)},CLASS_NAME:"OpenLayers.Rule"});OpenLayers.Filter.Spatial=OpenLayers.Class(OpenLayers.Filter,{type:null,property:null,value:null,distance:null,distanceUnits:null,evaluate:function(a){var b=!1;switch(this.type){case OpenLayers.Filter.Spatial.BBOX:case OpenLayers.Filter.Spatial.INTERSECTS:if(a.geometry){var c=this.value;"OpenLayers.Bounds"==this.value.CLASS_NAME&&(c=this.value.toGeometry());a.geometry.intersects(c)&&(b=!0)}break;default:throw Error("evaluate is not implemented for this filter type.");}return b},clone:function(){var a=
OpenLayers.Util.applyDefaults({value:this.value&&this.value.clone&&this.value.clone()},this);return new OpenLayers.Filter.Spatial(a)},CLASS_NAME:"OpenLayers.Filter.Spatial"});OpenLayers.Filter.Spatial.BBOX="BBOX";OpenLayers.Filter.Spatial.INTERSECTS="INTERSECTS";OpenLayers.Filter.Spatial.DWITHIN="DWITHIN";OpenLayers.Filter.Spatial.WITHIN="WITHIN";OpenLayers.Filter.Spatial.CONTAINS="CONTAINS";OpenLayers.Format.SLD=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{profile:null,defaultVersion:"1.0.0",stringifyOutput:!0,namedLayersAsArray:!1,CLASS_NAME:"OpenLayers.Format.SLD"});OpenLayers.Symbolizer.Polygon=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(a){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Polygon"});OpenLayers.Format.GML.v2=OpenLayers.Class(OpenLayers.Format.GML.Base,{schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/2.1.2/feature.xsd",initialize:function(a){OpenLayers.Format.GML.Base.prototype.initialize.apply(this,[a])},readers:{gml:OpenLayers.Util.applyDefaults({outerBoundaryIs:function(a,b){var c={};this.readChildNodes(a,c);b.outer=c.components[0]},innerBoundaryIs:function(a,b){var c={};this.readChildNodes(a,c);b.inner.push(c.components[0])},Box:function(a,b){var c=
{};this.readChildNodes(a,c);b.components||(b.components=[]);var d=c.points[0],c=c.points[1];b.components.push(new OpenLayers.Bounds(d.x,d.y,c.x,c.y))}},OpenLayers.Format.GML.Base.prototype.readers.gml),feature:OpenLayers.Format.GML.Base.prototype.readers.feature,wfs:OpenLayers.Format.GML.Base.prototype.readers.wfs},write:function(a){a=this.writeNode(OpenLayers.Util.isArray(a)?"wfs:FeatureCollection":"gml:featureMember",a);this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);
return OpenLayers.Format.XML.prototype.write.apply(this,[a])},writers:{gml:OpenLayers.Util.applyDefaults({Point:function(a){var b=this.createElementNSPlus("gml:Point");this.writeNode("coordinates",[a],b);return b},coordinates:function(a){for(var b=a.length,c=Array(b),d,e=0;e<b;++e)d=a[e],c[e]=this.xy?d.x+","+d.y:d.y+","+d.x,void 0!=d.z&&(c[e]+=","+d.z);return this.createElementNSPlus("gml:coordinates",{attributes:{decimal:".",cs:",",ts:" "},value:1==b?c[0]:c.join(" ")})},LineString:function(a){var b=
this.createElementNSPlus("gml:LineString");this.writeNode("coordinates",a.components,b);return b},Polygon:function(a){var b=this.createElementNSPlus("gml:Polygon");this.writeNode("outerBoundaryIs",a.components[0],b);for(var c=1;c<a.components.length;++c)this.writeNode("innerBoundaryIs",a.components[c],b);return b},outerBoundaryIs:function(a){var b=this.createElementNSPlus("gml:outerBoundaryIs");this.writeNode("LinearRing",a,b);return b},innerBoundaryIs:function(a){var b=this.createElementNSPlus("gml:innerBoundaryIs");
this.writeNode("LinearRing",a,b);return b},LinearRing:function(a){var b=this.createElementNSPlus("gml:LinearRing");this.writeNode("coordinates",a.components,b);return b},Box:function(a){var b=this.createElementNSPlus("gml:Box");this.writeNode("coordinates",[{x:a.left,y:a.bottom},{x:a.right,y:a.top}],b);this.srsName&&b.setAttribute("srsName",this.srsName);return b}},OpenLayers.Format.GML.Base.prototype.writers.gml),feature:OpenLayers.Format.GML.Base.prototype.writers.feature,wfs:OpenLayers.Format.GML.Base.prototype.writers.wfs},
CLASS_NAME:"OpenLayers.Format.GML.v2"});OpenLayers.Format.Filter.v1_0_0=OpenLayers.Class(OpenLayers.Format.GML.v2,OpenLayers.Format.Filter.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/ogc/filter/1.0.0/filter.xsd",initialize:function(a){OpenLayers.Format.GML.v2.prototype.initialize.apply(this,[a])},readers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO});this.readChildNodes(a,c);b.filters.push(c)},PropertyIsNotEqualTo:function(a,
b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.NOT_EQUAL_TO});this.readChildNodes(a,c);b.filters.push(c)},PropertyIsLike:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LIKE});this.readChildNodes(a,c);var d=a.getAttribute("wildCard"),e=a.getAttribute("singleChar"),f=a.getAttribute("escape");c.value2regex(d,e,f);b.filters.push(c)}},OpenLayers.Format.Filter.v1.prototype.readers.ogc),gml:OpenLayers.Format.GML.v2.prototype.readers.gml,
feature:OpenLayers.Format.GML.v2.prototype.readers.feature},writers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsEqualTo");this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);return b},PropertyIsNotEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsNotEqualTo");this.writeNode("PropertyName",a,b);this.writeOgcExpression(a.value,b);return b},PropertyIsLike:function(a){var b=this.createElementNSPlus("ogc:PropertyIsLike",
{attributes:{wildCard:"*",singleChar:".",escape:"!"}});this.writeNode("PropertyName",a,b);this.writeNode("Literal",a.regex2value(),b);return b},BBOX:function(a){var b=this.createElementNSPlus("ogc:BBOX");a.property&&this.writeNode("PropertyName",a,b);var c=this.writeNode("gml:Box",a.value,b);a.projection&&c.setAttribute("srsName",a.projection);return b}},OpenLayers.Format.Filter.v1.prototype.writers.ogc),gml:OpenLayers.Format.GML.v2.prototype.writers.gml,feature:OpenLayers.Format.GML.v2.prototype.writers.feature},
writeSpatial:function(a,b){var c=this.createElementNSPlus("ogc:"+b);this.writeNode("PropertyName",a,c);if(a.value instanceof OpenLayers.Filter.Function)this.writeNode("Function",a.value,c);else{var d;d=a.value instanceof OpenLayers.Geometry?this.writeNode("feature:_geometry",a.value).firstChild:this.writeNode("gml:Box",a.value);a.projection&&d.setAttribute("srsName",a.projection);c.appendChild(d)}return c},CLASS_NAME:"OpenLayers.Format.Filter.v1_0_0"});OpenLayers.Format.WFST.v1_0_0=OpenLayers.Class(OpenLayers.Format.Filter.v1_0_0,OpenLayers.Format.WFST.v1,{version:"1.0.0",srsNameInQuery:!1,schemaLocations:{wfs:"http://schemas.opengis.net/wfs/1.0.0/WFS-transaction.xsd"},initialize:function(a){OpenLayers.Format.Filter.v1_0_0.prototype.initialize.apply(this,[a]);OpenLayers.Format.WFST.v1.prototype.initialize.apply(this,[a])},readNode:function(a,b){return OpenLayers.Format.GML.v2.prototype.readNode.apply(this,[a,b])},readers:{wfs:OpenLayers.Util.applyDefaults({WFS_TransactionResponse:function(a,
b){b.insertIds=[];b.success=!1;this.readChildNodes(a,b)},InsertResult:function(a,b){var c={fids:[]};this.readChildNodes(a,c);b.insertIds.push(c.fids[0])},TransactionResult:function(a,b){this.readChildNodes(a,b)},Status:function(a,b){this.readChildNodes(a,b)},SUCCESS:function(a,b){b.success=!0}},OpenLayers.Format.WFST.v1.prototype.readers.wfs),gml:OpenLayers.Format.GML.v2.prototype.readers.gml,feature:OpenLayers.Format.GML.v2.prototype.readers.feature,ogc:OpenLayers.Format.Filter.v1_0_0.prototype.readers.ogc},
writers:{wfs:OpenLayers.Util.applyDefaults({Query:function(a){var a=OpenLayers.Util.extend({featureNS:this.featureNS,featurePrefix:this.featurePrefix,featureType:this.featureType,srsName:this.srsName,srsNameInQuery:this.srsNameInQuery},a),b=a.featurePrefix,c=this.createElementNSPlus("wfs:Query",{attributes:{typeName:(b?b+":":"")+a.featureType}});a.srsNameInQuery&&a.srsName&&c.setAttribute("srsName",a.srsName);a.featureNS&&c.setAttribute("xmlns:"+b,a.featureNS);if(a.propertyNames)for(var b=0,d=a.propertyNames.length;b<
d;b++)this.writeNode("ogc:PropertyName",{property:a.propertyNames[b]},c);a.filter&&(this.setFilterProperty(a.filter),this.writeNode("ogc:Filter",a.filter,c));return c}},OpenLayers.Format.WFST.v1.prototype.writers.wfs),gml:OpenLayers.Format.GML.v2.prototype.writers.gml,feature:OpenLayers.Format.GML.v2.prototype.writers.feature,ogc:OpenLayers.Format.Filter.v1_0_0.prototype.writers.ogc},CLASS_NAME:"OpenLayers.Format.WFST.v1_0_0"});OpenLayers.ElementsIndexer=OpenLayers.Class({maxZIndex:null,order:null,indices:null,compare:null,initialize:function(a){this.compare=a?OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_Y_ORDER:OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_DRAWING_ORDER;this.clear()},insert:function(a){this.exists(a)&&this.remove(a);var b=a.id;this.determineZIndex(a);for(var c=-1,d=this.order.length,e;1<d-c;)e=parseInt((c+d)/2),0<this.compare(this,a,OpenLayers.Util.getElement(this.order[e]))?c=e:d=e;this.order.splice(d,
0,b);this.indices[b]=this.getZIndex(a);return this.getNextElement(d)},remove:function(a){var a=a.id,b=OpenLayers.Util.indexOf(this.order,a);0<=b&&(this.order.splice(b,1),delete this.indices[a],this.maxZIndex=0<this.order.length?this.indices[this.order[this.order.length-1]]:0)},clear:function(){this.order=[];this.indices={};this.maxZIndex=0},exists:function(a){return null!=this.indices[a.id]},getZIndex:function(a){return a._style.graphicZIndex},determineZIndex:function(a){var b=a._style.graphicZIndex;
null==b?(b=this.maxZIndex,a._style.graphicZIndex=b):b>this.maxZIndex&&(this.maxZIndex=b)},getNextElement:function(a){a+=1;if(a<this.order.length){var b=OpenLayers.Util.getElement(this.order[a]);void 0==b&&(b=this.getNextElement(a));return b}return null},CLASS_NAME:"OpenLayers.ElementsIndexer"});
OpenLayers.ElementsIndexer.IndexingMethods={Z_ORDER:function(a,b,c){var b=a.getZIndex(b),d=0;c&&(a=a.getZIndex(c),d=b-a);return d},Z_ORDER_DRAWING_ORDER:function(a,b,c){a=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(a,b,c);c&&0==a&&(a=1);return a},Z_ORDER_Y_ORDER:function(a,b,c){a=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(a,b,c);c&&0===a&&(b=c._boundsBottom-b._boundsBottom,a=0===b?1:b);return a}};
OpenLayers.Renderer.Elements=OpenLayers.Class(OpenLayers.Renderer,{rendererRoot:null,root:null,vectorRoot:null,textRoot:null,xmlns:null,xOffset:0,indexer:null,BACKGROUND_ID_SUFFIX:"_background",LABEL_ID_SUFFIX:"_label",LABEL_OUTLINE_SUFFIX:"_outline",initialize:function(a,b){OpenLayers.Renderer.prototype.initialize.apply(this,arguments);this.rendererRoot=this.createRenderRoot();this.root=this.createRoot("_root");this.vectorRoot=this.createRoot("_vroot");this.textRoot=this.createRoot("_troot");this.root.appendChild(this.vectorRoot);
this.root.appendChild(this.textRoot);this.rendererRoot.appendChild(this.root);this.container.appendChild(this.rendererRoot);if(b&&(b.zIndexing||b.yOrdering))this.indexer=new OpenLayers.ElementsIndexer(b.yOrdering)},destroy:function(){this.clear();this.xmlns=this.root=this.rendererRoot=null;OpenLayers.Renderer.prototype.destroy.apply(this,arguments)},clear:function(){var a,b=this.vectorRoot;if(b)for(;a=b.firstChild;)b.removeChild(a);if(b=this.textRoot)for(;a=b.firstChild;)b.removeChild(a);this.indexer&&
this.indexer.clear()},setExtent:function(a,b){var c=OpenLayers.Renderer.prototype.setExtent.apply(this,arguments),d=this.getResolution();if(this.map.baseLayer&&this.map.baseLayer.wrapDateLine){var e,f=a.getWidth()/this.map.getExtent().getWidth(),a=a.scale(1/f),f=this.map.getMaxExtent();f.right>a.left&&f.right<a.right?e=!0:f.left>a.left&&f.left<a.right&&(e=!1);if(e!==this.rightOfDateLine||b)c=!1,this.xOffset=!0===e?f.getWidth()/d:0;this.rightOfDateLine=e}return c},getNodeType:function(){},drawGeometry:function(a,
b,c){var d=a.CLASS_NAME,e=!0;if("OpenLayers.Geometry.Collection"==d||"OpenLayers.Geometry.MultiPoint"==d||"OpenLayers.Geometry.MultiLineString"==d||"OpenLayers.Geometry.MultiPolygon"==d){for(var d=0,f=a.components.length;d<f;d++)e=this.drawGeometry(a.components[d],b,c)&&e;return e}d=e=!1;"none"!=b.display&&(b.backgroundGraphic?this.redrawBackgroundNode(a.id,a,b,c):d=!0,e=this.redrawNode(a.id,a,b,c));if(!1==e&&(b=document.getElementById(a.id)))b._style.backgroundGraphic&&(d=!0),b.parentNode.removeChild(b);
d&&(b=document.getElementById(a.id+this.BACKGROUND_ID_SUFFIX))&&b.parentNode.removeChild(b);return e},redrawNode:function(a,b,c,d){c=this.applyDefaultSymbolizer(c);a=this.nodeFactory(a,this.getNodeType(b,c));a._featureId=d;a._boundsBottom=b.getBounds().bottom;a._geometryClass=b.CLASS_NAME;a._style=c;b=this.drawGeometryNode(a,b,c);if(!1===b)return!1;a=b.node;this.indexer?(c=this.indexer.insert(a))?this.vectorRoot.insertBefore(a,c):this.vectorRoot.appendChild(a):a.parentNode!==this.vectorRoot&&this.vectorRoot.appendChild(a);
this.postDraw(a);return b.complete},redrawBackgroundNode:function(a,b,c){c=OpenLayers.Util.extend({},c);c.externalGraphic=c.backgroundGraphic;c.graphicXOffset=c.backgroundXOffset;c.graphicYOffset=c.backgroundYOffset;c.graphicZIndex=c.backgroundGraphicZIndex;c.graphicWidth=c.backgroundWidth||c.graphicWidth;c.graphicHeight=c.backgroundHeight||c.graphicHeight;c.backgroundGraphic=null;c.backgroundXOffset=null;c.backgroundYOffset=null;c.backgroundGraphicZIndex=null;return this.redrawNode(a+this.BACKGROUND_ID_SUFFIX,
b,c,null)},drawGeometryNode:function(a,b,c){var c=c||a._style,d={isFilled:void 0===c.fill?!0:c.fill,isStroked:void 0===c.stroke?!!c.strokeWidth:c.stroke},e;switch(b.CLASS_NAME){case "OpenLayers.Geometry.Point":!1===c.graphic&&(d.isFilled=!1,d.isStroked=!1);e=this.drawPoint(a,b);break;case "OpenLayers.Geometry.LineString":d.isFilled=!1;e=this.drawLineString(a,b);break;case "OpenLayers.Geometry.LinearRing":e=this.drawLinearRing(a,b);break;case "OpenLayers.Geometry.Polygon":e=this.drawPolygon(a,b);break;
case "OpenLayers.Geometry.Rectangle":e=this.drawRectangle(a,b)}a._options=d;return!1!=e?{node:this.setStyle(a,c,d,b),complete:e}:!1},postDraw:function(){},drawPoint:function(){},drawLineString:function(){},drawLinearRing:function(){},drawPolygon:function(){},drawRectangle:function(){},drawCircle:function(){},removeText:function(a){var b=document.getElementById(a+this.LABEL_ID_SUFFIX);b&&this.textRoot.removeChild(b);(a=document.getElementById(a+this.LABEL_OUTLINE_SUFFIX))&&this.textRoot.removeChild(a)},
getFeatureIdFromEvent:function(a){var b=a.target,c=b&&b.correspondingUseElement;return(c?c:b||a.srcElement)._featureId},eraseGeometry:function(a,b){if("OpenLayers.Geometry.MultiPoint"==a.CLASS_NAME||"OpenLayers.Geometry.MultiLineString"==a.CLASS_NAME||"OpenLayers.Geometry.MultiPolygon"==a.CLASS_NAME||"OpenLayers.Geometry.Collection"==a.CLASS_NAME)for(var c=0,d=a.components.length;c<d;c++)this.eraseGeometry(a.components[c],b);else if((c=OpenLayers.Util.getElement(a.id))&&c.parentNode)if(c.geometry&&
(c.geometry.destroy(),c.geometry=null),c.parentNode.removeChild(c),this.indexer&&this.indexer.remove(c),c._style.backgroundGraphic)(c=OpenLayers.Util.getElement(a.id+this.BACKGROUND_ID_SUFFIX))&&c.parentNode&&c.parentNode.removeChild(c)},nodeFactory:function(a,b){var c=OpenLayers.Util.getElement(a);c?this.nodeTypeCompare(c,b)||(c.parentNode.removeChild(c),c=this.nodeFactory(a,b)):c=this.createNode(b,a);return c},nodeTypeCompare:function(){},createNode:function(){},moveRoot:function(a){var b=this.root;
a.root.parentNode==this.rendererRoot&&(b=a.root);b.parentNode.removeChild(b);a.rendererRoot.appendChild(b)},getRenderLayerId:function(){return this.root.parentNode.parentNode.id},isComplexSymbol:function(a){return"circle"!=a&&!!a},CLASS_NAME:"OpenLayers.Renderer.Elements"});OpenLayers.Control.ArgParser=OpenLayers.Class(OpenLayers.Control,{center:null,zoom:null,layers:null,displayProjection:null,getParameters:function(a){var a=a||window.location.href,b=OpenLayers.Util.getParameters(a),c=a.indexOf("#");0<c&&(a="?"+a.substring(c+1,a.length),OpenLayers.Util.extend(b,OpenLayers.Util.getParameters(a)));return b},setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments);for(var b=0,c=this.map.controls.length;b<c;b++){var d=this.map.controls[b];if(d!=this&&
"OpenLayers.Control.ArgParser"==d.CLASS_NAME){d.displayProjection!=this.displayProjection&&(this.displayProjection=d.displayProjection);break}}if(b==this.map.controls.length&&(b=this.getParameters(),b.layers&&(this.layers=b.layers,this.map.events.register("addlayer",this,this.configureLayers),this.configureLayers()),b.lat&&b.lon))this.center=new OpenLayers.LonLat(parseFloat(b.lon),parseFloat(b.lat)),b.zoom&&(this.zoom=parseFloat(b.zoom)),this.map.events.register("changebaselayer",this,this.setCenter),
this.setCenter()},setCenter:function(){this.map.baseLayer&&(this.map.events.unregister("changebaselayer",this,this.setCenter),this.displayProjection&&this.center.transform(this.displayProjection,this.map.getProjectionObject()),this.map.setCenter(this.center,this.zoom))},configureLayers:function(){if(this.layers.length==this.map.layers.length){this.map.events.unregister("addlayer",this,this.configureLayers);for(var a=0,b=this.layers.length;a<b;a++){var c=this.map.layers[a],d=this.layers.charAt(a);
"B"==d?this.map.setBaseLayer(c):("T"==d||"F"==d)&&c.setVisibility("T"==d)}}},CLASS_NAME:"OpenLayers.Control.ArgParser"});OpenLayers.Control.Permalink=OpenLayers.Class(OpenLayers.Control,{argParserClass:OpenLayers.Control.ArgParser,element:null,anchor:!1,base:"",displayProjection:null,initialize:function(a,b,c){null!==a&&"object"==typeof a&&!OpenLayers.Util.isElement(a)?(this.base=document.location.href,OpenLayers.Control.prototype.initialize.apply(this,[a]),null!=this.element&&(this.element=OpenLayers.Util.getElement(this.element))):(OpenLayers.Control.prototype.initialize.apply(this,[c]),this.element=OpenLayers.Util.getElement(a),
this.base=b||document.location.href)},destroy:function(){this.element&&this.element.parentNode==this.div&&(this.div.removeChild(this.element),this.element=null);this.map&&this.map.events.unregister("moveend",this,this.updateLink);OpenLayers.Control.prototype.destroy.apply(this,arguments)},setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments);for(var b=0,c=this.map.controls.length;b<c;b++){var d=this.map.controls[b];if(d.CLASS_NAME==this.argParserClass.CLASS_NAME){d.displayProjection!=
this.displayProjection&&(this.displayProjection=d.displayProjection);break}}b==this.map.controls.length&&this.map.addControl(new this.argParserClass({displayProjection:this.displayProjection}))},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);!this.element&&!this.anchor&&(this.element=document.createElement("a"),this.element.innerHTML=OpenLayers.i18n("Permalink"),this.element.href="",this.div.appendChild(this.element));this.map.events.on({moveend:this.updateLink,changelayer:this.updateLink,
changebaselayer:this.updateLink,scope:this});this.updateLink();return this.div},updateLink:function(){var a=this.anchor?"#":"?",b=this.base;-1!=b.indexOf(a)&&(b=b.substring(0,b.indexOf(a)));b+=a+OpenLayers.Util.getParameterString(this.createParams());this.anchor&&!this.element?window.location.href=b:this.element.href=b},createParams:function(a,b,c){var a=a||this.map.getCenter(),d=OpenLayers.Util.getParameters(this.base);if(a){d.zoom=b||this.map.getZoom();b=a.lat;a=a.lon;this.displayProjection&&(b=
OpenLayers.Projection.transform({x:a,y:b},this.map.getProjectionObject(),this.displayProjection),a=b.x,b=b.y);d.lat=Math.round(1E5*b)/1E5;d.lon=Math.round(1E5*a)/1E5;c=c||this.map.layers;d.layers="";a=0;for(b=c.length;a<b;a++){var e=c[a];d.layers=e.isBaseLayer?d.layers+(e==this.map.baseLayer?"B":"0"):d.layers+(e.getVisibility()?"T":"F")}}return d},CLASS_NAME:"OpenLayers.Control.Permalink"});OpenLayers.Layer.TMS=OpenLayers.Class(OpenLayers.Layer.Grid,{serviceVersion:"1.0.0",layername:null,type:null,isBaseLayer:!0,tileOrigin:null,serverResolutions:null,zoomOffset:0,initialize:function(a,b,c){var d=[];d.push(a,b,{},c);OpenLayers.Layer.Grid.prototype.initialize.apply(this,d)},clone:function(a){null==a&&(a=new OpenLayers.Layer.TMS(this.name,this.url,this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},getURL:function(a){var a=this.adjustBounds(a),b=this.getServerResolution(),
c=Math.round((a.left-this.tileOrigin.lon)/(b*this.tileSize.w)),a=Math.round((a.bottom-this.tileOrigin.lat)/(b*this.tileSize.h)),c=this.serviceVersion+"/"+this.layername+"/"+this.getServerZoom()+"/"+c+"/"+a+"."+this.type,a=this.url;OpenLayers.Util.isArray(a)&&(a=this.selectUrl(c,a));return a+c},setMap:function(a){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments);this.tileOrigin||(this.tileOrigin=new OpenLayers.LonLat(this.map.maxExtent.left,this.map.maxExtent.bottom))},CLASS_NAME:"OpenLayers.Layer.TMS"});OpenLayers.Strategy.Fixed=OpenLayers.Class(OpenLayers.Strategy,{preload:!1,activate:function(){if(OpenLayers.Strategy.prototype.activate.apply(this,arguments)){this.layer.events.on({refresh:this.load,scope:this});if(!0==this.layer.visibility||this.preload)this.load();else this.layer.events.on({visibilitychanged:this.load,scope:this});return!0}return!1},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&&this.layer.events.un({refresh:this.load,visibilitychanged:this.load,
scope:this});return a},load:function(a){var b=this.layer;b.events.triggerEvent("loadstart");b.protocol.read(OpenLayers.Util.applyDefaults({callback:OpenLayers.Function.bind(this.merge,this,b.map.getProjectionObject()),filter:b.filter},a));b.events.un({visibilitychanged:this.load,scope:this})},merge:function(a,b){var c=this.layer;c.destroyFeatures();var d=b.features;if(d&&0<d.length){if(!a.equals(c.projection))for(var e,f=0,g=d.length;f<g;++f)(e=d[f].geometry)&&e.transform(c.projection,a);c.addFeatures(d)}c.events.triggerEvent("loadend")},
CLASS_NAME:"OpenLayers.Strategy.Fixed"});OpenLayers.Control.Zoom=OpenLayers.Class(OpenLayers.Control,{zoomInText:"+",zoomInId:"olZoomInLink",zoomOutText:"-",zoomOutId:"olZoomOutLink",draw:function(){var a=OpenLayers.Control.prototype.draw.apply(this),b=this.getOrCreateLinks(a),c=b.zoomIn,b=b.zoomOut,d=this.map.events;b.parentNode!==a&&(d=this.events,d.attachToElement(b.parentNode));d.register("buttonclick",this,this.onZoomClick);this.zoomInLink=c;this.zoomOutLink=b;return a},getOrCreateLinks:function(a){var b=document.getElementById(this.zoomInId),
c=document.getElementById(this.zoomOutId);b||(b=document.createElement("a"),b.href="#zoomIn",b.appendChild(document.createTextNode(this.zoomInText)),b.className="olControlZoomIn",a.appendChild(b));OpenLayers.Element.addClass(b,"olButton");c||(c=document.createElement("a"),c.href="#zoomOut",c.appendChild(document.createTextNode(this.zoomOutText)),c.className="olControlZoomOut",a.appendChild(c));OpenLayers.Element.addClass(c,"olButton");return{zoomIn:b,zoomOut:c}},onZoomClick:function(a){a=a.buttonElement;
a===this.zoomInLink?this.map.zoomIn():a===this.zoomOutLink&&this.map.zoomOut()},destroy:function(){this.map&&this.map.events.unregister("buttonclick",this,this.onZoomClick);delete this.zoomInLink;delete this.zoomOutLink;OpenLayers.Control.prototype.destroy.apply(this)},CLASS_NAME:"OpenLayers.Control.Zoom"});OpenLayers.Layer.PointTrack=OpenLayers.Class(OpenLayers.Layer.Vector,{dataFrom:null,styleFrom:null,addNodes:function(a,b){if(2>a.length)throw Error("At least two point features have to be added to create a line from");for(var c=Array(a.length-1),d,e,f,g=0,h=a.length;g<h;g++){d=a[g];if(f=d.geometry){if("OpenLayers.Geometry.Point"!=f.CLASS_NAME)throw new TypeError("Only features with point geometries are supported.");}else f=d.lonlat,f=new OpenLayers.Geometry.Point(f.lon,f.lat);if(0<g){d=null!=this.dataFrom?
a[g+this.dataFrom].data||a[g+this.dataFrom].attributes:null;var i=null!=this.styleFrom?a[g+this.styleFrom].style:null;e=new OpenLayers.Geometry.LineString([e,f]);c[g-1]=new OpenLayers.Feature.Vector(e,d,i)}e=f}this.addFeatures(c,b)},CLASS_NAME:"OpenLayers.Layer.PointTrack"});OpenLayers.Layer.PointTrack.SOURCE_NODE=-1;OpenLayers.Layer.PointTrack.TARGET_NODE=0;OpenLayers.Layer.PointTrack.dataFrom={SOURCE_NODE:-1,TARGET_NODE:0};OpenLayers.Protocol.WFS=function(a){var a=OpenLayers.Util.applyDefaults(a,OpenLayers.Protocol.WFS.DEFAULTS),b=OpenLayers.Protocol.WFS["v"+a.version.replace(/\./g,"_")];if(!b)throw"Unsupported WFS version: "+a.version;return new b(a)};
OpenLayers.Protocol.WFS.fromWMSLayer=function(a,b){var c,d;c=a.params.LAYERS;c=(OpenLayers.Util.isArray(c)?c[0]:c).split(":");1<c.length&&(d=c[0]);c=c.pop();d={url:a.url,featureType:c,featurePrefix:d,srsName:a.projection&&a.projection.getCode()||a.map&&a.map.getProjectionObject().getCode(),version:"1.1.0"};return new OpenLayers.Protocol.WFS(OpenLayers.Util.applyDefaults(b,d))};OpenLayers.Protocol.WFS.DEFAULTS={version:"1.0.0"};OpenLayers.Layer.Markers=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:!1,markers:null,drawn:!1,initialize:function(a,b){OpenLayers.Layer.prototype.initialize.apply(this,arguments);this.markers=[]},destroy:function(){this.clearMarkers();this.markers=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},setOpacity:function(a){if(a!=this.opacity){this.opacity=a;for(var a=0,b=this.markers.length;a<b;a++)this.markers[a].setOpacity(this.opacity)}},moveTo:function(a,b,c){OpenLayers.Layer.prototype.moveTo.apply(this,
arguments);if(b||!this.drawn){for(var d=0,e=this.markers.length;d<e;d++)this.drawMarker(this.markers[d]);this.drawn=!0}},addMarker:function(a){this.markers.push(a);1>this.opacity&&a.setOpacity(this.opacity);this.map&&this.map.getExtent()&&(a.map=this.map,this.drawMarker(a))},removeMarker:function(a){this.markers&&this.markers.length&&(OpenLayers.Util.removeItem(this.markers,a),a.erase())},clearMarkers:function(){if(null!=this.markers)for(;0<this.markers.length;)this.removeMarker(this.markers[0])},
drawMarker:function(a){var b=this.map.getLayerPxFromLonLat(a.lonlat);null==b?a.display(!1):a.isDrawn()?a.icon&&a.icon.moveTo(b):this.div.appendChild(a.draw(b))},getDataExtent:function(){var a=null;if(this.markers&&0<this.markers.length)for(var a=new OpenLayers.Bounds,b=0,c=this.markers.length;b<c;b++)a.extend(this.markers[b].lonlat);return a},CLASS_NAME:"OpenLayers.Layer.Markers"});OpenLayers.Control.Pan=OpenLayers.Class(OpenLayers.Control,{slideFactor:50,slideRatio:null,direction:null,type:OpenLayers.Control.TYPE_BUTTON,initialize:function(a,b){this.direction=a;this.CLASS_NAME+=this.direction;OpenLayers.Control.prototype.initialize.apply(this,[b])},trigger:function(){var a=OpenLayers.Function.bind(function(a){return this.slideRatio?this.map.getSize()[a]*this.slideRatio:this.slideFactor},this);switch(this.direction){case OpenLayers.Control.Pan.NORTH:this.map.pan(0,-a("h"));
break;case OpenLayers.Control.Pan.SOUTH:this.map.pan(0,a("h"));break;case OpenLayers.Control.Pan.WEST:this.map.pan(-a("w"),0);break;case OpenLayers.Control.Pan.EAST:this.map.pan(a("w"),0)}},CLASS_NAME:"OpenLayers.Control.Pan"});OpenLayers.Control.Pan.NORTH="North";OpenLayers.Control.Pan.SOUTH="South";OpenLayers.Control.Pan.EAST="East";OpenLayers.Control.Pan.WEST="West";OpenLayers.Format.CSWGetDomain=function(a){var a=OpenLayers.Util.applyDefaults(a,OpenLayers.Format.CSWGetDomain.DEFAULTS),b=OpenLayers.Format.CSWGetDomain["v"+a.version.replace(/\./g,"_")];if(!b)throw"Unsupported CSWGetDomain version: "+a.version;return new b(a)};OpenLayers.Format.CSWGetDomain.DEFAULTS={version:"2.0.2"};OpenLayers.Format.CSWGetDomain.v2_0_2=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",csw:"http://www.opengis.net/cat/csw/2.0.2"},defaultPrefix:"csw",version:"2.0.2",schemaLocation:"http://www.opengis.net/cat/csw/2.0.2 http://schemas.opengis.net/csw/2.0.2/CSW-discovery.xsd",PropertyName:null,ParameterName:null,read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&&9==
a.nodeType&&(a=a.documentElement);var b={};this.readNode(a,b);return b},readers:{csw:{GetDomainResponse:function(a,b){this.readChildNodes(a,b)},DomainValues:function(a,b){OpenLayers.Util.isArray(b.DomainValues)||(b.DomainValues=[]);for(var c=a.attributes,d={},e=0,f=c.length;e<f;++e)d[c[e].name]=c[e].nodeValue;this.readChildNodes(a,d);b.DomainValues.push(d)},PropertyName:function(a,b){b.PropertyName=this.getChildValue(a)},ParameterName:function(a,b){b.ParameterName=this.getChildValue(a)},ListOfValues:function(a,
b){OpenLayers.Util.isArray(b.ListOfValues)||(b.ListOfValues=[]);this.readChildNodes(a,b.ListOfValues)},Value:function(a,b){for(var c=a.attributes,d={},e=0,f=c.length;e<f;++e)d[c[e].name]=c[e].nodeValue;d.value=this.getChildValue(a);b.push({Value:d})},ConceptualScheme:function(a,b){b.ConceptualScheme={};this.readChildNodes(a,b.ConceptualScheme)},Name:function(a,b){b.Name=this.getChildValue(a)},Document:function(a,b){b.Document=this.getChildValue(a)},Authority:function(a,b){b.Authority=this.getChildValue(a)},
RangeOfValues:function(a,b){b.RangeOfValues={};this.readChildNodes(a,b.RangeOfValues)},MinValue:function(a,b){for(var c=a.attributes,d={},e=0,f=c.length;e<f;++e)d[c[e].name]=c[e].nodeValue;d.value=this.getChildValue(a);b.MinValue=d},MaxValue:function(a,b){for(var c=a.attributes,d={},e=0,f=c.length;e<f;++e)d[c[e].name]=c[e].nodeValue;d.value=this.getChildValue(a);b.MaxValue=d}}},write:function(a){a=this.writeNode("csw:GetDomain",a);return OpenLayers.Format.XML.prototype.write.apply(this,[a])},writers:{csw:{GetDomain:function(a){var b=
this.createElementNSPlus("csw:GetDomain",{attributes:{service:"CSW",version:this.version}});if(a.PropertyName||this.PropertyName)this.writeNode("csw:PropertyName",a.PropertyName||this.PropertyName,b);else if(a.ParameterName||this.ParameterName)this.writeNode("csw:ParameterName",a.ParameterName||this.ParameterName,b);this.readChildNodes(b,a);return b},PropertyName:function(a){return this.createElementNSPlus("csw:PropertyName",{value:a})},ParameterName:function(a){return this.createElementNSPlus("csw:ParameterName",
{value:a})}}},CLASS_NAME:"OpenLayers.Format.CSWGetDomain.v2_0_2"});OpenLayers.Format.ArcXML.Features=OpenLayers.Class(OpenLayers.Format.XML,{read:function(a){return(new OpenLayers.Format.ArcXML).read(a).features.feature}});OpenLayers.Control.Snapping=OpenLayers.Class(OpenLayers.Control,{DEFAULTS:{tolerance:10,node:!0,edge:!0,vertex:!0},greedy:!0,precedence:["node","vertex","edge"],resolution:null,geoToleranceCache:null,layer:null,feature:null,point:null,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,[a]);this.options=a||{};this.options.layer&&this.setLayer(this.options.layer);a=OpenLayers.Util.extend({},this.options.defaults);this.defaults=OpenLayers.Util.applyDefaults(a,this.DEFAULTS);this.setTargets(this.options.targets);
0===this.targets.length&&this.layer&&this.addTargetLayer(this.layer);this.geoToleranceCache={}},setLayer:function(a){this.active?(this.deactivate(),this.layer=a,this.activate()):this.layer=a},setTargets:function(a){this.targets=[];if(a&&a.length)for(var b,c=0,d=a.length;c<d;++c)b=a[c],b instanceof OpenLayers.Layer.Vector?this.addTargetLayer(b):this.addTarget(b)},addTargetLayer:function(a){this.addTarget({layer:a})},addTarget:function(a){a=OpenLayers.Util.applyDefaults(a,this.defaults);a.nodeTolerance=
a.nodeTolerance||a.tolerance;a.vertexTolerance=a.vertexTolerance||a.tolerance;a.edgeTolerance=a.edgeTolerance||a.tolerance;this.targets.push(a)},removeTargetLayer:function(a){for(var b,c=this.targets.length-1;0<=c;--c)b=this.targets[c],b.layer===a&&this.removeTarget(b)},removeTarget:function(a){return OpenLayers.Util.removeItem(this.targets,a)},activate:function(){var a=OpenLayers.Control.prototype.activate.call(this);if(a&&this.layer&&this.layer.events)this.layer.events.on({sketchstarted:this.onSketchModified,
sketchmodified:this.onSketchModified,vertexmodified:this.onVertexModified,scope:this});return a},deactivate:function(){var a=OpenLayers.Control.prototype.deactivate.call(this);a&&this.layer&&this.layer.events&&this.layer.events.un({sketchstarted:this.onSketchModified,sketchmodified:this.onSketchModified,vertexmodified:this.onVertexModified,scope:this});this.point=this.feature=null;return a},onSketchModified:function(a){this.feature=a.feature;this.considerSnapping(a.vertex,a.vertex)},onVertexModified:function(a){this.feature=
a.feature;var b=this.layer.map.getLonLatFromViewPortPx(a.pixel);this.considerSnapping(a.vertex,new OpenLayers.Geometry.Point(b.lon,b.lat))},considerSnapping:function(a,b){for(var c={rank:Number.POSITIVE_INFINITY,dist:Number.POSITIVE_INFINITY,x:null,y:null},d=!1,e,f,g=0,h=this.targets.length;g<h;++g)if(f=this.targets[g],e=this.testTarget(f,b))if(this.greedy){c=e;c.target=f;d=!0;break}else if(e.rank<c.rank||e.rank===c.rank&&e.dist<c.dist)c=e,c.target=f,d=!0;d&&(!1!==this.events.triggerEvent("beforesnap",
{point:a,x:c.x,y:c.y,distance:c.dist,layer:c.target.layer,snapType:this.precedence[c.rank]})?(a.x=c.x,a.y=c.y,this.point=a,this.events.triggerEvent("snap",{point:a,snapType:this.precedence[c.rank],layer:c.target.layer,distance:c.dist})):d=!1);this.point&&!d&&(a.x=b.x,a.y=b.y,this.point=null,this.events.triggerEvent("unsnap",{point:a}))},testTarget:function(a,b){var c=this.layer.map.getResolution();if("minResolution"in a&&c<a.minResolution||"maxResolution"in a&&c>=a.maxResolution)return null;for(var c=
{node:this.getGeoTolerance(a.nodeTolerance,c),vertex:this.getGeoTolerance(a.vertexTolerance,c),edge:this.getGeoTolerance(a.edgeTolerance,c)},d=Math.max(c.node,c.vertex,c.edge),e={rank:Number.POSITIVE_INFINITY,dist:Number.POSITIVE_INFINITY},f=!1,g=a.layer.features,h,i,j,k,l,m,n=this.precedence.length,o=new OpenLayers.LonLat(b.x,b.y),p=0,q=g.length;p<q;++p)if(h=g[p],h!==this.feature&&(!h._sketch&&h.state!==OpenLayers.State.DELETE&&(!a.filter||a.filter.evaluate(h)))&&h.atPoint(o,d,d))for(var r=0,s=Math.min(e.rank+
1,n);r<s;++r)if(i=this.precedence[r],a[i])if("edge"===i){if(j=h.geometry.distanceTo(b,{details:!0}),l=j.distance,l<=c[i]&&l<e.dist){e={rank:r,dist:l,x:j.x0,y:j.y0};f=!0;break}}else{j=h.geometry.getVertices("node"===i);m=!1;for(var t=0,u=j.length;t<u;++t)if(k=j[t],l=k.distanceTo(b),l<=c[i]&&(r<e.rank||r===e.rank&&l<e.dist))e={rank:r,dist:l,x:k.x,y:k.y},m=f=!0;if(m)break}return f?e:null},getGeoTolerance:function(a,b){b!==this.resolution&&(this.resolution=b,this.geoToleranceCache={});var c=this.geoToleranceCache[a];
void 0===c&&(c=a*b,this.geoToleranceCache[a]=c);return c},destroy:function(){this.active&&this.deactivate();delete this.layer;delete this.targets;OpenLayers.Control.prototype.destroy.call(this)},CLASS_NAME:"OpenLayers.Control.Snapping"});OpenLayers.Date={toISOString:function(){if("toISOString"in Date.prototype)return function(a){return a.toISOString()};var a=function(a,c){for(var d=a+"";d.length<c;)d="0"+d;return d};return function(b){return isNaN(b.getTime())?"Invalid Date":b.getUTCFullYear()+"-"+a(b.getUTCMonth()+1,2)+"-"+a(b.getUTCDate(),2)+"T"+a(b.getUTCHours(),2)+":"+a(b.getUTCMinutes(),2)+":"+a(b.getUTCSeconds(),2)+"."+a(b.getUTCMilliseconds(),3)+"Z"}}(),parse:function(a){var b;if((a=a.match(/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:(?:T(\d{1,2}):(\d{2}):(\d{2}(?:\.\d+)?)(Z|(?:[+-]\d{1,2}(?::(\d{2}))?)))|Z)?$/))&&
(a[1]||a[7])){b=parseInt(a[1],10)||0;var c=parseInt(a[2],10)-1||0,d=parseInt(a[3],10)||1;b=new Date(Date.UTC(b,c,d));if(c=a[7]){var d=parseInt(a[4],10),e=parseInt(a[5],10),f=parseFloat(a[6]),g=f|0,f=Math.round(1E3*(f-g));b.setUTCHours(d,e,g,f);"Z"!==c&&(c=parseInt(c,10),a=parseInt(a[8],10)||0,b=new Date(b.getTime()+-1E3*(60*60*c+60*a)))}}else b=new Date("invalid");return b}};(function(){function a(){this._object=f&&!i?new f:new window.ActiveXObject("Microsoft.XMLHTTP");this._listeners=[]}function b(){return new a}function c(a){b.onreadystatechange&&b.onreadystatechange.apply(a);a.dispatchEvent({type:"readystatechange",bubbles:!1,cancelable:!1,timeStamp:new Date+0})}function d(a){try{a.responseText=a._object.responseText}catch(b){}try{var c;var d=a._object,e=d.responseXML,f=d.responseText;h&&(f&&e&&!e.documentElement&&d.getResponseHeader("Content-Type").match(/[^\/]+\/[^\+]+\+xml/))&&
(e=new window.ActiveXObject("Microsoft.XMLDOM"),e.async=!1,e.validateOnParse=!1,e.loadXML(f));c=e&&(h&&0!=e.parseError||!e.documentElement||e.documentElement&&"parsererror"==e.documentElement.tagName)?null:e;a.responseXML=c}catch(g){}try{a.status=a._object.status}catch(i){}try{a.statusText=a._object.statusText}catch(r){}}function e(a){a._object.onreadystatechange=new window.Function}var f=window.XMLHttpRequest,g=!!window.controllers,h=window.document.all&&!window.opera,i=h&&window.navigator.userAgent.match(/MSIE 7.0/);
b.prototype=a.prototype;g&&f.wrapped&&(b.wrapped=f.wrapped);b.UNSENT=0;b.OPENED=1;b.HEADERS_RECEIVED=2;b.LOADING=3;b.DONE=4;b.prototype.readyState=b.UNSENT;b.prototype.responseText="";b.prototype.responseXML=null;b.prototype.status=0;b.prototype.statusText="";b.prototype.priority="NORMAL";b.prototype.onreadystatechange=null;b.onreadystatechange=null;b.onopen=null;b.onsend=null;b.onabort=null;b.prototype.open=function(a,f,i,m,n){delete this._headers;arguments.length<3&&(i=true);this._async=i;var o=
this,p=this.readyState,q;if(h&&i){q=function(){if(p!=b.DONE){e(o);o.abort()}};window.attachEvent("onunload",q)}b.onopen&&b.onopen.apply(this,arguments);arguments.length>4?this._object.open(a,f,i,m,n):arguments.length>3?this._object.open(a,f,i,m):this._object.open(a,f,i);this.readyState=b.OPENED;c(this);this._object.onreadystatechange=function(){if(!g||i){o.readyState=o._object.readyState;d(o);if(o._aborted)o.readyState=b.UNSENT;else{if(o.readyState==b.DONE){delete o._data;e(o);h&&i&&window.detachEvent("onunload",
q)}p!=o.readyState&&c(o);p=o.readyState}}}};b.prototype.send=function(a){b.onsend&&b.onsend.apply(this,arguments);arguments.length||(a=null);if(a&&a.nodeType){a=window.XMLSerializer?(new window.XMLSerializer).serializeToString(a):a.xml;this._headers["Content-Type"]||this._object.setRequestHeader("Content-Type","application/xml")}this._data=a;a:{this._object.send(this._data);if(g&&!this._async){this.readyState=b.OPENED;for(d(this);this.readyState<b.DONE;){this.readyState++;c(this);if(this._aborted)break a}}}};
b.prototype.abort=function(){b.onabort&&b.onabort.apply(this,arguments);if(this.readyState>b.UNSENT)this._aborted=true;this._object.abort();e(this);this.readyState=b.UNSENT;delete this._data};b.prototype.getAllResponseHeaders=function(){return this._object.getAllResponseHeaders()};b.prototype.getResponseHeader=function(a){return this._object.getResponseHeader(a)};b.prototype.setRequestHeader=function(a,b){if(!this._headers)this._headers={};this._headers[a]=b;return this._object.setRequestHeader(a,
b)};b.prototype.addEventListener=function(a,b,c){for(var d=0,e;e=this._listeners[d];d++)if(e[0]==a&&e[1]==b&&e[2]==c)return;this._listeners.push([a,b,c])};b.prototype.removeEventListener=function(a,b,c){for(var d=0,e;e=this._listeners[d];d++)if(e[0]==a&&e[1]==b&&e[2]==c)break;e&&this._listeners.splice(d,1)};b.prototype.dispatchEvent=function(a){a={type:a.type,target:this,currentTarget:this,eventPhase:2,bubbles:a.bubbles,cancelable:a.cancelable,timeStamp:a.timeStamp,stopPropagation:function(){},preventDefault:function(){},
initEvent:function(){}};a.type=="readystatechange"&&this.onreadystatechange&&(this.onreadystatechange.handleEvent||this.onreadystatechange).apply(this,[a]);for(var b=0,c;c=this._listeners[b];b++)c[0]==a.type&&!c[2]&&(c[1].handleEvent||c[1]).apply(this,[a])};b.prototype.toString=function(){return"[object XMLHttpRequest]"};b.toString=function(){return"[XMLHttpRequest]"};window.Function.prototype.apply||(window.Function.prototype.apply=function(a,b){b||(b=[]);a.__func=this;a.__func(b[0],b[1],b[2],b[3],
b[4]);delete a.__func});OpenLayers.Request.XMLHttpRequest=b})();OpenLayers.Format.KML=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{kml:"http://www.opengis.net/kml/2.2",gx:"http://www.google.com/kml/ext/2.2"},kmlns:"http://earth.google.com/kml/2.0",placemarksDesc:"No description available",foldersName:"OpenLayers export",foldersDesc:"Exported on "+new Date,extractAttributes:!0,kvpAttributes:!1,extractStyles:!1,extractTracks:!1,trackAttributes:null,internalns:null,features:null,styles:null,styleBaseUrl:"",fetched:null,maxDepth:0,initialize:function(a){this.regExes=
{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g,kmlColor:/(\w{2})(\w{2})(\w{2})(\w{2})/,kmlIconPalette:/root:\/\/icons\/palette-(\d+)(\.\w+)/,straightBracket:/\$\[(.*?)\]/g};this.externalProjection=new OpenLayers.Projection("EPSG:4326");OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){this.features=[];this.styles={};this.fetched={};return this.parseData(a,{depth:0,styleBaseUrl:this.styleBaseUrl})},parseData:function(a,b){"string"==typeof a&&
(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));for(var c=["Link","NetworkLink","Style","StyleMap","Placemark"],d=0,e=c.length;d<e;++d){var f=c[d],g=this.getElementsByTagNameNS(a,"*",f);if(0!=g.length)switch(f.toLowerCase()){case "link":case "networklink":this.parseLinks(g,b);break;case "style":this.extractStyles&&this.parseStyles(g,b);break;case "stylemap":this.extractStyles&&this.parseStyleMaps(g,b);break;case "placemark":this.parseFeatures(g,b)}}return this.features},parseLinks:function(a,
b){if(b.depth>=this.maxDepth)return!1;var c=OpenLayers.Util.extend({},b);c.depth++;for(var d=0,e=a.length;d<e;d++){var f=this.parseProperty(a[d],"*","href");f&&!this.fetched[f]&&(this.fetched[f]=!0,(f=this.fetchLink(f))&&this.parseData(f,c))}},fetchLink:function(a){if(a=OpenLayers.Request.GET({url:a,async:!1}))return a.responseText},parseStyles:function(a,b){for(var c=0,d=a.length;c<d;c++){var e=this.parseStyle(a[c]);e&&(this.styles[(b.styleBaseUrl||"")+"#"+e.id]=e)}},parseKmlColor:function(a){var b=
null;a&&(a=a.match(this.regExes.kmlColor))&&(b={color:"#"+a[4]+a[3]+a[2],opacity:parseInt(a[1],16)/255});return b},parseStyle:function(a){for(var b={},c=["LineStyle","PolyStyle","IconStyle","BalloonStyle","LabelStyle"],d,e,f=0,g=c.length;f<g;++f)if(d=c[f],e=this.getElementsByTagNameNS(a,"*",d)[0])switch(d.toLowerCase()){case "linestyle":d=this.parseProperty(e,"*","color");if(d=this.parseKmlColor(d))b.strokeColor=d.color,b.strokeOpacity=d.opacity;(d=this.parseProperty(e,"*","width"))&&(b.strokeWidth=
d);break;case "polystyle":d=this.parseProperty(e,"*","color");if(d=this.parseKmlColor(d))b.fillOpacity=d.opacity,b.fillColor=d.color;"0"==this.parseProperty(e,"*","fill")&&(b.fillColor="none");"0"==this.parseProperty(e,"*","outline")&&(b.strokeWidth="0");break;case "iconstyle":var h=parseFloat(this.parseProperty(e,"*","scale")||1);d=32*h;var i=32*h,j=this.getElementsByTagNameNS(e,"*","Icon")[0];if(j){var k=this.parseProperty(j,"*","href");if(k){var l=this.parseProperty(j,"*","w"),m=this.parseProperty(j,
"*","h");OpenLayers.String.startsWith(k,"http://maps.google.com/mapfiles/kml")&&(!l&&!m)&&(m=l=64,h/=2);l=l||m;m=m||l;l&&(d=parseInt(l)*h);m&&(i=parseInt(m)*h);if(m=k.match(this.regExes.kmlIconPalette))l=m[1],m=m[2],k=this.parseProperty(j,"*","x"),j=this.parseProperty(j,"*","y"),k="http://maps.google.com/mapfiles/kml/pal"+l+"/icon"+(8*(j?7-j/32:7)+(k?k/32:0))+m;b.graphicOpacity=1;b.externalGraphic=k}}if(e=this.getElementsByTagNameNS(e,"*","hotSpot")[0])k=parseFloat(e.getAttribute("x")),j=parseFloat(e.getAttribute("y")),
l=e.getAttribute("xunits"),"pixels"==l?b.graphicXOffset=-k*h:"insetPixels"==l?b.graphicXOffset=-d+k*h:"fraction"==l&&(b.graphicXOffset=-d*k),e=e.getAttribute("yunits"),"pixels"==e?b.graphicYOffset=-i+j*h+1:"insetPixels"==e?b.graphicYOffset=-(j*h)+1:"fraction"==e&&(b.graphicYOffset=-i*(1-j)+1);b.graphicWidth=d;b.graphicHeight=i;break;case "balloonstyle":(e=OpenLayers.Util.getXmlNodeValue(e))&&(b.balloonStyle=e.replace(this.regExes.straightBracket,"${$1}"));break;case "labelstyle":if(d=this.parseProperty(e,
"*","color"),d=this.parseKmlColor(d))b.fontColor=d.color,b.fontOpacity=d.opacity}!b.strokeColor&&b.fillColor&&(b.strokeColor=b.fillColor);if((a=a.getAttribute("id"))&&b)b.id=a;return b},parseStyleMaps:function(a,b){for(var c=0,d=a.length;c<d;c++)for(var e=a[c],f=this.getElementsByTagNameNS(e,"*","Pair"),e=e.getAttribute("id"),g=0,h=f.length;g<h;g++){var i=f[g],j=this.parseProperty(i,"*","key");(i=this.parseProperty(i,"*","styleUrl"))&&"normal"==j&&(this.styles[(b.styleBaseUrl||"")+"#"+e]=this.styles[(b.styleBaseUrl||
"")+i])}},parseFeatures:function(a,b){for(var c=[],d=0,e=a.length;d<e;d++){var f=a[d],g=this.parseFeature.apply(this,[f]);if(g){this.extractStyles&&(g.attributes&&g.attributes.styleUrl)&&(g.style=this.getStyle(g.attributes.styleUrl,b));if(this.extractStyles){var h=this.getElementsByTagNameNS(f,"*","Style")[0];if(h&&(h=this.parseStyle(h)))g.style=OpenLayers.Util.extend(g.style,h)}if(this.extractTracks){if((f=this.getElementsByTagNameNS(f,this.namespaces.gx,"Track"))&&0<f.length)g={features:[],feature:g},
this.readNode(f[0],g),0<g.features.length&&c.push.apply(c,g.features)}else c.push(g)}else throw"Bad Placemark: "+d;}this.features=this.features.concat(c)},readers:{kml:{when:function(a,b){b.whens.push(OpenLayers.Date.parse(this.getChildValue(a)))},_trackPointAttribute:function(a,b){var c=a.nodeName.split(":").pop();b.attributes[c].push(this.getChildValue(a))}},gx:{Track:function(a,b){var c={whens:[],points:[],angles:[]};if(this.trackAttributes){var d;c.attributes={};for(var e=0,f=this.trackAttributes.length;e<
f;++e)d=this.trackAttributes[e],c.attributes[d]=[],d in this.readers.kml||(this.readers.kml[d]=this.readers.kml._trackPointAttribute)}this.readChildNodes(a,c);if(c.whens.length!==c.points.length)throw Error("gx:Track with unequal number of when ("+c.whens.length+") and gx:coord ("+c.points.length+") elements.");var g=0<c.angles.length;if(g&&c.whens.length!==c.angles.length)throw Error("gx:Track with unequal number of when ("+c.whens.length+") and gx:angles ("+c.angles.length+") elements.");for(var h,
i,e=0,f=c.whens.length;e<f;++e){h=b.feature.clone();h.fid=b.feature.fid||b.feature.id;i=c.points[e];h.geometry=i;"z"in i&&(h.attributes.altitude=i.z);this.internalProjection&&this.externalProjection&&h.geometry.transform(this.externalProjection,this.internalProjection);if(this.trackAttributes){i=0;for(var j=this.trackAttributes.length;i<j;++i)h.attributes[d]=c.attributes[this.trackAttributes[i]][e]}h.attributes.when=c.whens[e];h.attributes.trackId=b.feature.id;g&&(i=c.angles[e],h.attributes.heading=
parseFloat(i[0]),h.attributes.tilt=parseFloat(i[1]),h.attributes.roll=parseFloat(i[2]));b.features.push(h)}},coord:function(a,b){var c=this.getChildValue(a).replace(this.regExes.trimSpace,"").split(/\s+/),d=new OpenLayers.Geometry.Point(c[0],c[1]);2<c.length&&(d.z=parseFloat(c[2]));b.points.push(d)},angles:function(a,b){var c=this.getChildValue(a).replace(this.regExes.trimSpace,"").split(/\s+/);b.angles.push(c)}}},parseFeature:function(a){for(var b=["MultiGeometry","Polygon","LineString","Point"],
c,d,e,f=0,g=b.length;f<g;++f)if(c=b[f],this.internalns=a.namespaceURI?a.namespaceURI:this.kmlns,d=this.getElementsByTagNameNS(a,this.internalns,c),0<d.length){if(b=this.parseGeometry[c.toLowerCase()])e=b.apply(this,[d[0]]),this.internalProjection&&this.externalProjection&&e.transform(this.externalProjection,this.internalProjection);else throw new TypeError("Unsupported geometry type: "+c);break}var h;this.extractAttributes&&(h=this.parseAttributes(a));c=new OpenLayers.Feature.Vector(e,h);a=a.getAttribute("id")||
a.getAttribute("name");null!=a&&(c.fid=a);return c},getStyle:function(a,b){var c=OpenLayers.Util.removeTail(a),d=OpenLayers.Util.extend({},b);d.depth++;d.styleBaseUrl=c;!this.styles[a]&&!OpenLayers.String.startsWith(a,"#")&&d.depth<=this.maxDepth&&!this.fetched[c]&&(c=this.fetchLink(c))&&this.parseData(c,d);return OpenLayers.Util.extend({},this.styles[a])},parseGeometry:{point:function(a){var b=this.getElementsByTagNameNS(a,this.internalns,"coordinates"),a=[];if(0<b.length)var c=b[0].firstChild.nodeValue,
c=c.replace(this.regExes.removeSpace,""),a=c.split(",");b=null;if(1<a.length)2==a.length&&(a[2]=null),b=new OpenLayers.Geometry.Point(a[0],a[1],a[2]);else throw"Bad coordinate string: "+c;return b},linestring:function(a,b){var c=this.getElementsByTagNameNS(a,this.internalns,"coordinates"),d=null;if(0<c.length){for(var c=this.getChildValue(c[0]),c=c.replace(this.regExes.trimSpace,""),c=c.replace(this.regExes.trimComma,","),d=c.split(this.regExes.splitSpace),e=d.length,f=Array(e),g,h,i=0;i<e;++i)if(g=
d[i].split(","),h=g.length,1<h)2==g.length&&(g[2]=null),f[i]=new OpenLayers.Geometry.Point(g[0],g[1],g[2]);else throw"Bad LineString point coordinates: "+d[i];if(e)d=b?new OpenLayers.Geometry.LinearRing(f):new OpenLayers.Geometry.LineString(f);else throw"Bad LineString coordinates: "+c;}return d},polygon:function(a){var a=this.getElementsByTagNameNS(a,this.internalns,"LinearRing"),b=a.length,c=Array(b);if(0<b)for(var d=0,e=a.length;d<e;++d)if(b=this.parseGeometry.linestring.apply(this,[a[d],!0]))c[d]=
b;else throw"Bad LinearRing geometry: "+d;return new OpenLayers.Geometry.Polygon(c)},multigeometry:function(a){for(var b,c=[],d=a.childNodes,e=0,f=d.length;e<f;++e)a=d[e],1==a.nodeType&&(b=this.parseGeometry[(a.prefix?a.nodeName.split(":")[1]:a.nodeName).toLowerCase()])&&c.push(b.apply(this,[a]));return new OpenLayers.Geometry.Collection(c)}},parseAttributes:function(a){var b={},c=a.getElementsByTagName("ExtendedData");c.length&&(b=this.parseExtendedData(c[0]));for(var d,e,f,a=a.childNodes,c=0,g=
a.length;c<g;++c)if(d=a[c],1==d.nodeType&&(e=d.childNodes,1<=e.length&&3>=e.length)){switch(e.length){case 1:f=e[0];break;case 2:f=e[0];e=e[1];f=3==f.nodeType||4==f.nodeType?f:e;break;default:f=e[1]}if(3==f.nodeType||4==f.nodeType)if(d=d.prefix?d.nodeName.split(":")[1]:d.nodeName,f=OpenLayers.Util.getXmlNodeValue(f))f=f.replace(this.regExes.trimSpace,""),b[d]=f}return b},parseExtendedData:function(a){var b={},c,d,e,f,g=a.getElementsByTagName("Data");c=0;for(d=g.length;c<d;c++){e=g[c];f=e.getAttribute("name");
var h={},i=e.getElementsByTagName("value");i.length&&(h.value=this.getChildValue(i[0]));this.kvpAttributes?b[f]=h.value:(e=e.getElementsByTagName("displayName"),e.length&&(h.displayName=this.getChildValue(e[0])),b[f]=h)}a=a.getElementsByTagName("SimpleData");c=0;for(d=a.length;c<d;c++)h={},e=a[c],f=e.getAttribute("name"),h.value=this.getChildValue(e),this.kvpAttributes?b[f]=h.value:(h.displayName=f,b[f]=h);return b},parseProperty:function(a,b,c){var d,a=this.getElementsByTagNameNS(a,b,c);try{d=OpenLayers.Util.getXmlNodeValue(a[0])}catch(e){d=
null}return d},write:function(a){OpenLayers.Util.isArray(a)||(a=[a]);for(var b=this.createElementNS(this.kmlns,"kml"),c=this.createFolderXML(),d=0,e=a.length;d<e;++d)c.appendChild(this.createPlacemarkXML(a[d]));b.appendChild(c);return OpenLayers.Format.XML.prototype.write.apply(this,[b])},createFolderXML:function(){var a=this.createElementNS(this.kmlns,"Folder");if(this.foldersName){var b=this.createElementNS(this.kmlns,"name"),c=this.createTextNode(this.foldersName);b.appendChild(c);a.appendChild(b)}this.foldersDesc&&
(b=this.createElementNS(this.kmlns,"description"),c=this.createTextNode(this.foldersDesc),b.appendChild(c),a.appendChild(b));return a},createPlacemarkXML:function(a){var b=this.createElementNS(this.kmlns,"name");b.appendChild(this.createTextNode(a.style&&a.style.label?a.style.label:a.attributes.name||a.id));var c=this.createElementNS(this.kmlns,"description");c.appendChild(this.createTextNode(a.attributes.description||this.placemarksDesc));var d=this.createElementNS(this.kmlns,"Placemark");null!=
a.fid&&d.setAttribute("id",a.fid);d.appendChild(b);d.appendChild(c);b=this.buildGeometryNode(a.geometry);d.appendChild(b);a.attributes&&(a=this.buildExtendedData(a.attributes))&&d.appendChild(a);return d},buildGeometryNode:function(a){var b=a.CLASS_NAME,b=this.buildGeometry[b.substring(b.lastIndexOf(".")+1).toLowerCase()],c=null;b&&(c=b.apply(this,[a]));return c},buildGeometry:{point:function(a){var b=this.createElementNS(this.kmlns,"Point");b.appendChild(this.buildCoordinatesNode(a));return b},multipoint:function(a){return this.buildGeometry.collection.apply(this,
[a])},linestring:function(a){var b=this.createElementNS(this.kmlns,"LineString");b.appendChild(this.buildCoordinatesNode(a));return b},multilinestring:function(a){return this.buildGeometry.collection.apply(this,[a])},linearring:function(a){var b=this.createElementNS(this.kmlns,"LinearRing");b.appendChild(this.buildCoordinatesNode(a));return b},polygon:function(a){for(var b=this.createElementNS(this.kmlns,"Polygon"),a=a.components,c,d,e=0,f=a.length;e<f;++e)c=0==e?"outerBoundaryIs":"innerBoundaryIs",
c=this.createElementNS(this.kmlns,c),d=this.buildGeometry.linearring.apply(this,[a[e]]),c.appendChild(d),b.appendChild(c);return b},multipolygon:function(a){return this.buildGeometry.collection.apply(this,[a])},collection:function(a){for(var b=this.createElementNS(this.kmlns,"MultiGeometry"),c,d=0,e=a.components.length;d<e;++d)(c=this.buildGeometryNode.apply(this,[a.components[d]]))&&b.appendChild(c);return b}},buildCoordinatesNode:function(a){var b=this.createElementNS(this.kmlns,"coordinates"),
c;if(c=a.components){for(var d=c.length,e=Array(d),f=0;f<d;++f)a=c[f],e[f]=this.buildCoordinates(a);c=e.join(" ")}else c=this.buildCoordinates(a);c=this.createTextNode(c);b.appendChild(c);return b},buildCoordinates:function(a){this.internalProjection&&this.externalProjection&&(a=a.clone(),a.transform(this.internalProjection,this.externalProjection));return a.x+","+a.y},buildExtendedData:function(a){var b=this.createElementNS(this.kmlns,"ExtendedData"),c;for(c in a)if(a[c]&&"name"!=c&&"description"!=
c&&"styleUrl"!=c){var d=this.createElementNS(this.kmlns,"Data");d.setAttribute("name",c);var e=this.createElementNS(this.kmlns,"value");if("object"==typeof a[c]){if(a[c].value&&e.appendChild(this.createTextNode(a[c].value)),a[c].displayName){var f=this.createElementNS(this.kmlns,"displayName");f.appendChild(this.getXMLDoc().createCDATASection(a[c].displayName));d.appendChild(f)}}else e.appendChild(this.createTextNode(a[c]));d.appendChild(e);b.appendChild(d)}return this.isSimpleContent(b)?null:b},
CLASS_NAME:"OpenLayers.Format.KML"});OpenLayers.Popup=OpenLayers.Class({events:null,id:"",lonlat:null,div:null,contentSize:null,size:null,contentHTML:null,backgroundColor:"",opacity:"",border:"",contentDiv:null,groupDiv:null,closeDiv:null,autoSize:!1,minSize:null,maxSize:null,displayClass:"olPopup",contentDisplayClass:"olPopupContent",padding:0,disableFirefoxOverflowHack:!1,fixPadding:function(){"number"==typeof this.padding&&(this.padding=new OpenLayers.Bounds(this.padding,this.padding,this.padding,this.padding))},panMapIfOutOfView:!1,
keepInMap:!1,closeOnMove:!1,map:null,initialize:function(a,b,c,d,e,f){null==a&&(a=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_"));this.id=a;this.lonlat=b;this.contentSize=null!=c?c:new OpenLayers.Size(OpenLayers.Popup.WIDTH,OpenLayers.Popup.HEIGHT);null!=d&&(this.contentHTML=d);this.backgroundColor=OpenLayers.Popup.COLOR;this.opacity=OpenLayers.Popup.OPACITY;this.border=OpenLayers.Popup.BORDER;this.div=OpenLayers.Util.createDiv(this.id,null,null,null,null,null,"hidden");this.div.className=this.displayClass;
this.groupDiv=OpenLayers.Util.createDiv(this.id+"_GroupDiv",null,null,null,"relative",null,"hidden");a=this.div.id+"_contentDiv";this.contentDiv=OpenLayers.Util.createDiv(a,null,this.contentSize.clone(),null,"relative");this.contentDiv.className=this.contentDisplayClass;this.groupDiv.appendChild(this.contentDiv);this.div.appendChild(this.groupDiv);e&&this.addCloseBox(f);this.registerEvents()},destroy:function(){this.border=this.opacity=this.backgroundColor=this.contentHTML=this.size=this.lonlat=this.id=
null;this.closeOnMove&&this.map&&this.map.events.unregister("movestart",this,this.hide);this.events.destroy();this.events=null;this.closeDiv&&(OpenLayers.Event.stopObservingElement(this.closeDiv),this.groupDiv.removeChild(this.closeDiv));this.closeDiv=null;this.div.removeChild(this.groupDiv);this.groupDiv=null;null!=this.map&&this.map.removePopup(this);this.panMapIfOutOfView=this.padding=this.maxSize=this.minSize=this.autoSize=this.div=this.map=null},draw:function(a){null==a&&null!=this.lonlat&&null!=
this.map&&(a=this.map.getLayerPxFromLonLat(this.lonlat));this.closeOnMove&&this.map.events.register("movestart",this,this.hide);!this.disableFirefoxOverflowHack&&"firefox"==OpenLayers.BROWSER_NAME&&(this.map.events.register("movestart",this,function(){var a=document.defaultView.getComputedStyle(this.contentDiv,null).getPropertyValue("overflow");"hidden"!=a&&(this.contentDiv._oldOverflow=a,this.contentDiv.style.overflow="hidden")}),this.map.events.register("moveend",this,function(){var a=this.contentDiv._oldOverflow;
a&&(this.contentDiv.style.overflow=a,this.contentDiv._oldOverflow=null)}));this.moveTo(a);!this.autoSize&&!this.size&&this.setSize(this.contentSize);this.setBackgroundColor();this.setOpacity();this.setBorder();this.setContentHTML();this.panMapIfOutOfView&&this.panIntoView();return this.div},updatePosition:function(){if(this.lonlat&&this.map){var a=this.map.getLayerPxFromLonLat(this.lonlat);a&&this.moveTo(a)}},moveTo:function(a){null!=a&&null!=this.div&&(this.div.style.left=a.x+"px",this.div.style.top=
a.y+"px")},visible:function(){return OpenLayers.Element.visible(this.div)},toggle:function(){this.visible()?this.hide():this.show()},show:function(){this.div.style.display="";this.panMapIfOutOfView&&this.panIntoView()},hide:function(){this.div.style.display="none"},setSize:function(a){this.size=a.clone();var b=this.getContentDivPadding(),c=b.left+b.right,d=b.top+b.bottom;this.fixPadding();c+=this.padding.left+this.padding.right;d+=this.padding.top+this.padding.bottom;if(this.closeDiv)var e=parseInt(this.closeDiv.style.width),
c=c+(e+b.right);this.size.w+=c;this.size.h+=d;"msie"==OpenLayers.BROWSER_NAME&&(this.contentSize.w+=b.left+b.right,this.contentSize.h+=b.bottom+b.top);null!=this.div&&(this.div.style.width=this.size.w+"px",this.div.style.height=this.size.h+"px");null!=this.contentDiv&&(this.contentDiv.style.width=a.w+"px",this.contentDiv.style.height=a.h+"px")},updateSize:function(){var a="<div class='"+this.contentDisplayClass+"'>"+this.contentDiv.innerHTML+"</div>",b=this.map?this.map.div:document.body,c=OpenLayers.Util.getRenderedDimensions(a,
null,{displayClass:this.displayClass,containerElement:b}),d=this.getSafeContentSize(c),e=null;d.equals(c)?e=c:(c={w:d.w<c.w?d.w:null,h:d.h<c.h?d.h:null},c.w&&c.h?e=d:(a=OpenLayers.Util.getRenderedDimensions(a,c,{displayClass:this.contentDisplayClass,containerElement:b}),"hidden"!=OpenLayers.Element.getStyle(this.contentDiv,"overflow")&&a.equals(d)&&(d=OpenLayers.Util.getScrollbarWidth(),c.w?a.h+=d:a.w+=d),e=this.getSafeContentSize(a)));this.setSize(e)},setBackgroundColor:function(a){void 0!=a&&(this.backgroundColor=
a);null!=this.div&&(this.div.style.backgroundColor=this.backgroundColor)},setOpacity:function(a){void 0!=a&&(this.opacity=a);null!=this.div&&(this.div.style.opacity=this.opacity,this.div.style.filter="alpha(opacity="+100*this.opacity+")")},setBorder:function(a){void 0!=a&&(this.border=a);null!=this.div&&(this.div.style.border=this.border)},setContentHTML:function(a){null!=a&&(this.contentHTML=a);null!=this.contentDiv&&(null!=this.contentHTML&&this.contentHTML!=this.contentDiv.innerHTML)&&(this.contentDiv.innerHTML=
this.contentHTML,this.autoSize&&(this.registerImageListeners(),this.updateSize()))},registerImageListeners:function(){for(var a=function(){null!==this.popup.id&&(this.popup.updateSize(),this.popup.visible()&&this.popup.panMapIfOutOfView&&this.popup.panIntoView(),OpenLayers.Event.stopObserving(this.img,"load",this.img._onImageLoad))},b=this.contentDiv.getElementsByTagName("img"),c=0,d=b.length;c<d;c++){var e=b[c];if(0==e.width||0==e.height)e._onImgLoad=OpenLayers.Function.bind(a,{popup:this,img:e}),
OpenLayers.Event.observe(e,"load",e._onImgLoad)}},getSafeContentSize:function(a){var a=a.clone(),b=this.getContentDivPadding(),c=b.left+b.right,d=b.top+b.bottom;this.fixPadding();c+=this.padding.left+this.padding.right;d+=this.padding.top+this.padding.bottom;if(this.closeDiv)var e=parseInt(this.closeDiv.style.width),c=c+(e+b.right);this.minSize&&(a.w=Math.max(a.w,this.minSize.w-c),a.h=Math.max(a.h,this.minSize.h-d));this.maxSize&&(a.w=Math.min(a.w,this.maxSize.w-c),a.h=Math.min(a.h,this.maxSize.h-
d));if(this.map&&this.map.size){e=b=0;if(this.keepInMap&&!this.panMapIfOutOfView)switch(e=this.map.getPixelFromLonLat(this.lonlat),this.relativePosition){case "tr":b=e.x;e=this.map.size.h-e.y;break;case "tl":b=this.map.size.w-e.x;e=this.map.size.h-e.y;break;case "bl":b=this.map.size.w-e.x;e=e.y;break;case "br":b=e.x;e=e.y;break;default:b=e.x,e=this.map.size.h-e.y}d=this.map.size.h-this.map.paddingForPopups.top-this.map.paddingForPopups.bottom-d-e;a.w=Math.min(a.w,this.map.size.w-this.map.paddingForPopups.left-
this.map.paddingForPopups.right-c-b);a.h=Math.min(a.h,d)}return a},getContentDivPadding:function(){var a=this._contentDivPadding;if(!a&&(null==this.div.parentNode&&(this.div.style.display="none",document.body.appendChild(this.div)),this._contentDivPadding=a=new OpenLayers.Bounds(OpenLayers.Element.getStyle(this.contentDiv,"padding-left"),OpenLayers.Element.getStyle(this.contentDiv,"padding-bottom"),OpenLayers.Element.getStyle(this.contentDiv,"padding-right"),OpenLayers.Element.getStyle(this.contentDiv,
"padding-top")),this.div.parentNode==document.body))document.body.removeChild(this.div),this.div.style.display="";return a},addCloseBox:function(a){this.closeDiv=OpenLayers.Util.createDiv(this.id+"_close",null,{w:17,h:17});this.closeDiv.className="olPopupCloseBox";var b=this.getContentDivPadding();this.closeDiv.style.right=b.right+"px";this.closeDiv.style.top=b.top+"px";this.groupDiv.appendChild(this.closeDiv);a=a||function(a){this.hide();OpenLayers.Event.stop(a)};OpenLayers.Event.observe(this.closeDiv,
"touchend",OpenLayers.Function.bindAsEventListener(a,this));OpenLayers.Event.observe(this.closeDiv,"click",OpenLayers.Function.bindAsEventListener(a,this))},panIntoView:function(){var a=this.map.getSize(),b=this.map.getViewPortPxFromLayerPx(new OpenLayers.Pixel(parseInt(this.div.style.left),parseInt(this.div.style.top))),c=b.clone();b.x<this.map.paddingForPopups.left?c.x=this.map.paddingForPopups.left:b.x+this.size.w>a.w-this.map.paddingForPopups.right&&(c.x=a.w-this.map.paddingForPopups.right-this.size.w);
b.y<this.map.paddingForPopups.top?c.y=this.map.paddingForPopups.top:b.y+this.size.h>a.h-this.map.paddingForPopups.bottom&&(c.y=a.h-this.map.paddingForPopups.bottom-this.size.h);this.map.pan(b.x-c.x,b.y-c.y)},registerEvents:function(){this.events=new OpenLayers.Events(this,this.div,null,!0);this.events.on({mousedown:this.onmousedown,mousemove:this.onmousemove,mouseup:this.onmouseup,click:this.onclick,mouseout:this.onmouseout,dblclick:this.ondblclick,touchstart:function(a){OpenLayers.Event.stop(a,!0)},
scope:this})},onmousedown:function(a){this.mousedown=!0;OpenLayers.Event.stop(a,!0)},onmousemove:function(a){this.mousedown&&OpenLayers.Event.stop(a,!0)},onmouseup:function(a){this.mousedown&&(this.mousedown=!1,OpenLayers.Event.stop(a,!0))},onclick:function(a){OpenLayers.Event.stop(a,!0)},onmouseout:function(){this.mousedown=!1},ondblclick:function(a){OpenLayers.Event.stop(a,!0)},CLASS_NAME:"OpenLayers.Popup"});OpenLayers.Popup.WIDTH=200;OpenLayers.Popup.HEIGHT=200;OpenLayers.Popup.COLOR="white";
OpenLayers.Popup.OPACITY=1;OpenLayers.Popup.BORDER="0px";OpenLayers.Popup.Anchored=OpenLayers.Class(OpenLayers.Popup,{relativePosition:null,keepInMap:!0,anchor:null,initialize:function(a,b,c,d,e,f,g){OpenLayers.Popup.prototype.initialize.apply(this,[a,b,c,d,f,g]);this.anchor=null!=e?e:{size:new OpenLayers.Size(0,0),offset:new OpenLayers.Pixel(0,0)}},destroy:function(){this.relativePosition=this.anchor=null;OpenLayers.Popup.prototype.destroy.apply(this,arguments)},show:function(){this.updatePosition();OpenLayers.Popup.prototype.show.apply(this,arguments)},
moveTo:function(a){var b=this.relativePosition;this.relativePosition=this.calculateRelativePosition(a);a=this.calculateNewPx(a);OpenLayers.Popup.prototype.moveTo.apply(this,Array(a));this.relativePosition!=b&&this.updateRelativePosition()},setSize:function(a){OpenLayers.Popup.prototype.setSize.apply(this,arguments);this.lonlat&&this.map&&this.moveTo(this.map.getLayerPxFromLonLat(this.lonlat))},calculateRelativePosition:function(a){a=this.map.getLonLatFromLayerPx(a);a=this.map.getExtent().determineQuadrant(a);
return OpenLayers.Bounds.oppositeQuadrant(a)},updateRelativePosition:function(){},calculateNewPx:function(a){var a=a.offset(this.anchor.offset),b=this.size||this.contentSize,c="t"==this.relativePosition.charAt(0);a.y+=c?-b.h:this.anchor.size.h;c="l"==this.relativePosition.charAt(1);a.x+=c?-b.w:this.anchor.size.w;return a},CLASS_NAME:"OpenLayers.Popup.Anchored"});/*
 Apache 2 

 Contains portions of Rico <http://openrico.org/>

 Copyright 2005 Sabre Airline Solutions  

 Licensed under the Apache License, Version 2.0 (the "License"); you
 may not use this file except in compliance with the License. You
 may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0  

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
 implied. See the License for the specific language governing
 permissions and limitations under the License. 
*/
OpenLayers.Console.warn("OpenLayers.Rico is deprecated");OpenLayers.Rico=OpenLayers.Rico||{};
OpenLayers.Rico.Color=OpenLayers.Class({initialize:function(a,b,c){this.rgb={r:a,g:b,b:c}},setRed:function(a){this.rgb.r=a},setGreen:function(a){this.rgb.g=a},setBlue:function(a){this.rgb.b=a},setHue:function(a){var b=this.asHSB();b.h=a;this.rgb=OpenLayers.Rico.Color.HSBtoRGB(b.h,b.s,b.b)},setSaturation:function(a){var b=this.asHSB();b.s=a;this.rgb=OpenLayers.Rico.Color.HSBtoRGB(b.h,b.s,b.b)},setBrightness:function(a){var b=this.asHSB();b.b=a;this.rgb=OpenLayers.Rico.Color.HSBtoRGB(b.h,b.s,b.b)},
darken:function(a){var b=this.asHSB();this.rgb=OpenLayers.Rico.Color.HSBtoRGB(b.h,b.s,Math.max(b.b-a,0))},brighten:function(a){var b=this.asHSB();this.rgb=OpenLayers.Rico.Color.HSBtoRGB(b.h,b.s,Math.min(b.b+a,1))},blend:function(a){this.rgb.r=Math.floor((this.rgb.r+a.rgb.r)/2);this.rgb.g=Math.floor((this.rgb.g+a.rgb.g)/2);this.rgb.b=Math.floor((this.rgb.b+a.rgb.b)/2)},isBright:function(){this.asHSB();return 0.5<this.asHSB().b},isDark:function(){return!this.isBright()},asRGB:function(){return"rgb("+
this.rgb.r+","+this.rgb.g+","+this.rgb.b+")"},asHex:function(){return"#"+this.rgb.r.toColorPart()+this.rgb.g.toColorPart()+this.rgb.b.toColorPart()},asHSB:function(){return OpenLayers.Rico.Color.RGBtoHSB(this.rgb.r,this.rgb.g,this.rgb.b)},toString:function(){return this.asHex()}});
OpenLayers.Rico.Color.createFromHex=function(a){if(4==a.length)for(var b=a,a="#",c=1;4>c;c++)a+=b.charAt(c)+b.charAt(c);0==a.indexOf("#")&&(a=a.substring(1));b=a.substring(0,2);c=a.substring(2,4);a=a.substring(4,6);return new OpenLayers.Rico.Color(parseInt(b,16),parseInt(c,16),parseInt(a,16))};
OpenLayers.Rico.Color.createColorFromBackground=function(a){var b=OpenLayers.Element.getStyle(OpenLayers.Util.getElement(a),"backgroundColor");return"transparent"==b&&a.parentNode?OpenLayers.Rico.Color.createColorFromBackground(a.parentNode):null==b?new OpenLayers.Rico.Color(255,255,255):0==b.indexOf("rgb(")?(a=b.substring(4,b.length-1).split(","),new OpenLayers.Rico.Color(parseInt(a[0]),parseInt(a[1]),parseInt(a[2]))):0==b.indexOf("#")?OpenLayers.Rico.Color.createFromHex(b):new OpenLayers.Rico.Color(255,
255,255)};
OpenLayers.Rico.Color.HSBtoRGB=function(a,b,c){var d=0,e=0,f=0;if(0==b)f=e=d=parseInt(255*c+0.5);else{var a=6*(a-Math.floor(a)),g=a-Math.floor(a),h=c*(1-b),i=c*(1-b*g),b=c*(1-b*(1-g));switch(parseInt(a)){case 0:d=255*c+0.5;e=255*b+0.5;f=255*h+0.5;break;case 1:d=255*i+0.5;e=255*c+0.5;f=255*h+0.5;break;case 2:d=255*h+0.5;e=255*c+0.5;f=255*b+0.5;break;case 3:d=255*h+0.5;e=255*i+0.5;f=255*c+0.5;break;case 4:d=255*b+0.5;e=255*h+0.5;f=255*c+0.5;break;case 5:d=255*c+0.5,e=255*h+0.5,f=255*i+0.5}}return{r:parseInt(d),g:parseInt(e),
b:parseInt(f)}};OpenLayers.Rico.Color.RGBtoHSB=function(a,b,c){var d,e=a>b?a:b;c>e&&(e=c);var f=a<b?a:b;c<f&&(f=c);d=0!=e?(e-f)/e:0;if(0==d)a=0;else{var g=(e-a)/(e-f),h=(e-b)/(e-f),c=(e-c)/(e-f),a=(a==e?c-h:b==e?2+g-c:4+h-g)/6;0>a&&(a+=1)}return{h:a,s:d,b:e/255}};OpenLayers.Console.warn("OpenLayers.Rico is deprecated");OpenLayers.Rico=OpenLayers.Rico||{};
OpenLayers.Rico.Corner={round:function(a,b){a=OpenLayers.Util.getElement(a);this._setOptions(b);var c=this.options.color;"fromElement"==this.options.color&&(c=this._background(a));var d=this.options.bgColor;"fromParent"==this.options.bgColor&&(d=this._background(a.offsetParent));this._roundCornersImpl(a,c,d)},changeColor:function(a,b){a.style.backgroundColor=b;for(var c=a.parentNode.getElementsByTagName("span"),d=0;d<c.length;d++)c[d].style.backgroundColor=b},changeOpacity:function(a,b){var c="alpha(opacity="+
100*b+")";a.style.opacity=b;a.style.filter=c;for(var d=a.parentNode.getElementsByTagName("span"),e=0;e<d.length;e++)d[e].style.opacity=b,d[e].style.filter=c},reRound:function(a,b){var c=a.parentNode.childNodes[2];a.parentNode.removeChild(a.parentNode.childNodes[0]);a.parentNode.removeChild(c);this.round(a.parentNode,b)},_roundCornersImpl:function(a,b,c){this.options.border&&this._renderBorder(a,c);this._isTopRounded()&&this._roundTopCorners(a,b,c);this._isBottomRounded()&&this._roundBottomCorners(a,
b,c)},_renderBorder:function(a,b){var c="1px solid "+this._borderColor(b);a.innerHTML="<div "+("style='border-left: "+c+";"+("border-right: "+c)+"'")+">"+a.innerHTML+"</div>"},_roundTopCorners:function(a,b,c){for(var d=this._createCorner(c),e=0;e<this.options.numSlices;e++)d.appendChild(this._createCornerSlice(b,c,e,"top"));a.style.paddingTop=0;a.insertBefore(d,a.firstChild)},_roundBottomCorners:function(a,b,c){for(var d=this._createCorner(c),e=this.options.numSlices-1;0<=e;e--)d.appendChild(this._createCornerSlice(b,
c,e,"bottom"));a.style.paddingBottom=0;a.appendChild(d)},_createCorner:function(a){var b=document.createElement("div");b.style.backgroundColor=this._isTransparent()?"transparent":a;return b},_createCornerSlice:function(a,b,c,d){var e=document.createElement("span"),f=e.style;f.backgroundColor=a;f.display="block";f.height="1px";f.overflow="hidden";f.fontSize="1px";a=this._borderColor(a,b);this.options.border&&0==c?(f.borderTopStyle="solid",f.borderTopWidth="1px",f.borderLeftWidth="0px",f.borderRightWidth=
"0px",f.borderBottomWidth="0px",f.height="0px",f.borderColor=a):a&&(f.borderColor=a,f.borderStyle="solid",f.borderWidth="0px 1px");!this.options.compact&&c==this.options.numSlices-1&&(f.height="2px");this._setMargin(e,c,d);this._setBorder(e,c,d);return e},_setOptions:function(a){this.options={corners:"all",color:"fromElement",bgColor:"fromParent",blend:!0,border:!1,compact:!1};OpenLayers.Util.extend(this.options,a||{});this.options.numSlices=this.options.compact?2:4;this._isTransparent()&&(this.options.blend=
!1)},_whichSideTop:function(){return this._hasString(this.options.corners,"all","top")||0<=this.options.corners.indexOf("tl")&&0<=this.options.corners.indexOf("tr")?"":0<=this.options.corners.indexOf("tl")?"left":0<=this.options.corners.indexOf("tr")?"right":""},_whichSideBottom:function(){return this._hasString(this.options.corners,"all","bottom")||0<=this.options.corners.indexOf("bl")&&0<=this.options.corners.indexOf("br")?"":0<=this.options.corners.indexOf("bl")?"left":0<=this.options.corners.indexOf("br")?
"right":""},_borderColor:function(a,b){return"transparent"==a?b:this.options.border?this.options.border:this.options.blend?this._blend(b,a):""},_setMargin:function(a,b,c){b=this._marginSize(b);c="top"==c?this._whichSideTop():this._whichSideBottom();"left"==c?(a.style.marginLeft=b+"px",a.style.marginRight="0px"):"right"==c?(a.style.marginRight=b+"px",a.style.marginLeft="0px"):(a.style.marginLeft=b+"px",a.style.marginRight=b+"px")},_setBorder:function(a,b,c){b=this._borderSize(b);c="top"==c?this._whichSideTop():
this._whichSideBottom();"left"==c?(a.style.borderLeftWidth=b+"px",a.style.borderRightWidth="0px"):"right"==c?(a.style.borderRightWidth=b+"px",a.style.borderLeftWidth="0px"):(a.style.borderLeftWidth=b+"px",a.style.borderRightWidth=b+"px");!1!=this.options.border&&(a.style.borderLeftWidth=b+"px",a.style.borderRightWidth=b+"px")},_marginSize:function(a){if(this._isTransparent())return 0;var b=[5,3,2,1],c=[3,2,1,0],d=[2,1],e=[1,0];return this.options.compact&&this.options.blend?e[a]:this.options.compact?
d[a]:this.options.blend?c[a]:b[a]},_borderSize:function(a){var b=[5,3,2,1],c=[2,1,1,1],d=[1,0],e=[0,2,0,0];return this.options.compact&&(this.options.blend||this._isTransparent())?1:this.options.compact?d[a]:this.options.blend?c[a]:this.options.border?e[a]:this._isTransparent()?b[a]:0},_hasString:function(a){for(var b=1;b<arguments.length;b++)if(0<=a.indexOf(arguments[b]))return!0;return!1},_blend:function(a,b){var c=OpenLayers.Rico.Color.createFromHex(a);c.blend(OpenLayers.Rico.Color.createFromHex(b));
return c},_background:function(a){try{return OpenLayers.Rico.Color.createColorFromBackground(a).asHex()}catch(b){return"#ffffff"}},_isTransparent:function(){return"transparent"==this.options.color},_isTopRounded:function(){return this._hasString(this.options.corners,"all","top","tl","tr")},_isBottomRounded:function(){return this._hasString(this.options.corners,"all","bottom","bl","br")},_hasSingleTextChild:function(a){return 1==a.childNodes.length&&3==a.childNodes[0].nodeType}};OpenLayers.Popup.AnchoredBubble=OpenLayers.Class(OpenLayers.Popup.Anchored,{rounded:!1,initialize:function(a,b,c,d,e,f,g){OpenLayers.Console.warn("AnchoredBubble is deprecated");this.padding=new OpenLayers.Bounds(0,OpenLayers.Popup.AnchoredBubble.CORNER_SIZE,0,OpenLayers.Popup.AnchoredBubble.CORNER_SIZE);OpenLayers.Popup.Anchored.prototype.initialize.apply(this,arguments)},draw:function(a){OpenLayers.Popup.Anchored.prototype.draw.apply(this,arguments);this.setContentHTML();this.setBackgroundColor();
this.setOpacity();return this.div},updateRelativePosition:function(){this.setRicoCorners()},setSize:function(a){OpenLayers.Popup.Anchored.prototype.setSize.apply(this,arguments);this.setRicoCorners()},setBackgroundColor:function(a){void 0!=a&&(this.backgroundColor=a);null!=this.div&&null!=this.contentDiv&&(this.div.style.background="transparent",OpenLayers.Rico.Corner.changeColor(this.groupDiv,this.backgroundColor))},setOpacity:function(a){OpenLayers.Popup.Anchored.prototype.setOpacity.call(this,
a);null!=this.div&&null!=this.groupDiv&&OpenLayers.Rico.Corner.changeOpacity(this.groupDiv,this.opacity)},setBorder:function(){this.border=0},setRicoCorners:function(){var a={corners:this.getCornersToRound(this.relativePosition),color:this.backgroundColor,bgColor:"transparent",blend:!1};this.rounded?(OpenLayers.Rico.Corner.reRound(this.groupDiv,a),this.setBackgroundColor(),this.setOpacity()):(OpenLayers.Rico.Corner.round(this.div,a),this.rounded=!0)},getCornersToRound:function(){var a=["tl","tr",
"bl","br"],b=OpenLayers.Bounds.oppositeQuadrant(this.relativePosition);OpenLayers.Util.removeItem(a,b);return a.join(" ")},CLASS_NAME:"OpenLayers.Popup.AnchoredBubble"});OpenLayers.Popup.AnchoredBubble.CORNER_SIZE=5;OpenLayers.Protocol.WFS.v1=OpenLayers.Class(OpenLayers.Protocol,{version:null,srsName:"EPSG:4326",featureType:null,featureNS:null,geometryName:"the_geom",schema:null,featurePrefix:"feature",formatOptions:null,readFormat:null,readOptions:null,initialize:function(a){OpenLayers.Protocol.prototype.initialize.apply(this,[a]);a.format||(this.format=OpenLayers.Format.WFST(OpenLayers.Util.extend({version:this.version,featureType:this.featureType,featureNS:this.featureNS,featurePrefix:this.featurePrefix,geometryName:this.geometryName,
srsName:this.srsName,schema:this.schema},this.formatOptions)));!a.geometryName&&1<parseFloat(this.format.version)&&this.setGeometryName(null)},destroy:function(){this.options&&!this.options.format&&this.format.destroy();this.format=null;OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(a){OpenLayers.Protocol.prototype.read.apply(this,arguments);a=OpenLayers.Util.extend({},a);OpenLayers.Util.applyDefaults(a,this.options||{});var b=new OpenLayers.Protocol.Response({requestType:"read"}),
c=OpenLayers.Format.XML.prototype.write.apply(this.format,[this.format.writeNode("wfs:GetFeature",a)]);b.priv=OpenLayers.Request.POST({url:a.url,callback:this.createCallback(this.handleRead,b,a),params:a.params,headers:a.headers,data:c});return b},setFeatureType:function(a){this.featureType=a;this.format.featureType=a},setGeometryName:function(a){this.geometryName=a;this.format.geometryName=a},handleRead:function(a,b){b=OpenLayers.Util.extend({},b);OpenLayers.Util.applyDefaults(b,this.options);if(b.callback){var c=
a.priv;200<=c.status&&300>c.status?(c=this.parseResponse(c,b.readOptions))&&!1!==c.success?(b.readOptions&&"object"==b.readOptions.output?OpenLayers.Util.extend(a,c):a.features=c,a.code=OpenLayers.Protocol.Response.SUCCESS):(a.code=OpenLayers.Protocol.Response.FAILURE,a.error=c):a.code=OpenLayers.Protocol.Response.FAILURE;b.callback.call(b.scope,a)}},parseResponse:function(a,b){var c=a.responseXML;if(!c||!c.documentElement)c=a.responseText;if(!c||0>=c.length)return null;c=null!==this.readFormat?this.readFormat.read(c):
this.format.read(c,b);if(!this.featureNS){var d=this.readFormat||this.format;this.featureNS=d.featureNS;d.autoConfig=!1;this.geometryName||this.setGeometryName(d.geometryName)}return c},commit:function(a,b){b=OpenLayers.Util.extend({},b);OpenLayers.Util.applyDefaults(b,this.options);var c=new OpenLayers.Protocol.Response({requestType:"commit",reqFeatures:a});c.priv=OpenLayers.Request.POST({url:b.url,headers:b.headers,data:this.format.write(a,b),callback:this.createCallback(this.handleCommit,c,b)});
return c},handleCommit:function(a,b){if(b.callback){var c=a.priv,d=c.responseXML;if(!d||!d.documentElement)d=c.responseText;c=this.format.read(d)||{};a.insertIds=c.insertIds||[];c.success?a.code=OpenLayers.Protocol.Response.SUCCESS:(a.code=OpenLayers.Protocol.Response.FAILURE,a.error=c);b.callback.call(b.scope,a)}},filterDelete:function(a,b){b=OpenLayers.Util.extend({},b);OpenLayers.Util.applyDefaults(b,this.options);new OpenLayers.Protocol.Response({requestType:"commit"});var c=this.format.createElementNSPlus("wfs:Transaction",
{attributes:{service:"WFS",version:this.version}}),d=this.format.createElementNSPlus("wfs:Delete",{attributes:{typeName:(b.featureNS?this.featurePrefix+":":"")+b.featureType}});b.featureNS&&d.setAttribute("xmlns:"+this.featurePrefix,b.featureNS);var e=this.format.writeNode("ogc:Filter",a);d.appendChild(e);c.appendChild(d);c=OpenLayers.Format.XML.prototype.write.apply(this.format,[c]);return OpenLayers.Request.POST({url:this.url,callback:b.callback||function(){},data:c})},abort:function(a){a&&a.priv.abort()},
CLASS_NAME:"OpenLayers.Protocol.WFS.v1"});OpenLayers.Handler.Point=OpenLayers.Class(OpenLayers.Handler,{point:null,layer:null,multi:!1,citeCompliant:!1,mouseDown:!1,stoppedDown:null,lastDown:null,lastUp:null,persist:!1,stopDown:!1,stopUp:!1,layerOptions:null,pixelTolerance:5,touch:!1,lastTouchPx:null,initialize:function(a,b,c){if(!c||!c.layerOptions||!c.layerOptions.styleMap)this.style=OpenLayers.Util.extend(OpenLayers.Feature.Vector.style["default"],{});OpenLayers.Handler.prototype.initialize.apply(this,arguments)},activate:function(){if(!OpenLayers.Handler.prototype.activate.apply(this,
arguments))return!1;var a=OpenLayers.Util.extend({displayInLayerSwitcher:!1,calculateInRange:OpenLayers.Function.True,wrapDateLine:this.citeCompliant},this.layerOptions);this.layer=new OpenLayers.Layer.Vector(this.CLASS_NAME,a);this.map.addLayer(this.layer);return!0},createFeature:function(a){a=this.layer.getLonLatFromViewPortPx(a);a=new OpenLayers.Geometry.Point(a.lon,a.lat);this.point=new OpenLayers.Feature.Vector(a);this.callback("create",[this.point.geometry,this.point]);this.point.geometry.clearBounds();
this.layer.addFeatures([this.point],{silent:!0})},deactivate:function(){if(!OpenLayers.Handler.prototype.deactivate.apply(this,arguments))return!1;this.cancel();null!=this.layer.map&&(this.destroyFeature(!0),this.layer.destroy(!1));this.layer=null;this.touch=!1;return!0},destroyFeature:function(a){this.layer&&(a||!this.persist)&&this.layer.destroyFeatures();this.point=null},destroyPersistedFeature:function(){var a=this.layer;a&&1<a.features.length&&this.layer.features[0].destroy()},finalize:function(a){this.mouseDown=
!1;this.lastTouchPx=this.lastUp=this.lastDown=null;this.callback(a?"cancel":"done",[this.geometryClone()]);this.destroyFeature(a)},cancel:function(){this.finalize(!0)},click:function(a){OpenLayers.Event.stop(a);return!1},dblclick:function(a){OpenLayers.Event.stop(a);return!1},modifyFeature:function(a){this.point||this.createFeature(a);a=this.layer.getLonLatFromViewPortPx(a);this.point.geometry.x=a.lon;this.point.geometry.y=a.lat;this.callback("modify",[this.point.geometry,this.point,!1]);this.point.geometry.clearBounds();
this.drawFeature()},drawFeature:function(){this.layer.drawFeature(this.point,this.style)},getGeometry:function(){var a=this.point&&this.point.geometry;a&&this.multi&&(a=new OpenLayers.Geometry.MultiPoint([a]));return a},geometryClone:function(){var a=this.getGeometry();return a&&a.clone()},mousedown:function(a){return this.down(a)},touchstart:function(a){this.touch||(this.touch=!0,this.map.events.un({mousedown:this.mousedown,mouseup:this.mouseup,mousemove:this.mousemove,click:this.click,dblclick:this.dblclick,
scope:this}));this.lastTouchPx=a.xy;return this.down(a)},mousemove:function(a){return this.move(a)},touchmove:function(a){this.lastTouchPx=a.xy;return this.move(a)},mouseup:function(a){return this.up(a)},touchend:function(a){a.xy=this.lastTouchPx;return this.up(a)},down:function(a){this.mouseDown=!0;this.lastDown=a.xy;this.touch||this.modifyFeature(a.xy);this.stoppedDown=this.stopDown;return!this.stopDown},move:function(a){!this.touch&&(!this.mouseDown||this.stoppedDown)&&this.modifyFeature(a.xy);
return!0},up:function(a){this.mouseDown=!1;this.stoppedDown=this.stopDown;return this.checkModifiers(a)&&(!this.lastUp||!this.lastUp.equals(a.xy))&&this.lastDown&&this.passesTolerance(this.lastDown,a.xy,this.pixelTolerance)?(this.touch&&this.modifyFeature(a.xy),this.persist&&this.destroyPersistedFeature(),this.lastUp=a.xy,this.finalize(),!this.stopUp):!0},mouseout:function(a){OpenLayers.Util.mouseLeft(a,this.map.viewPortDiv)&&(this.stoppedDown=this.stopDown,this.mouseDown=!1)},passesTolerance:function(a,
b,c){var d=!0;null!=c&&a&&b&&a.distanceTo(b)>c&&(d=!1);return d},CLASS_NAME:"OpenLayers.Handler.Point"});OpenLayers.Handler.Path=OpenLayers.Class(OpenLayers.Handler.Point,{line:null,maxVertices:null,doubleTouchTolerance:20,freehand:!1,freehandToggle:"shiftKey",timerId:null,redoStack:null,createFeature:function(a){a=this.layer.getLonLatFromViewPortPx(a);a=new OpenLayers.Geometry.Point(a.lon,a.lat);this.point=new OpenLayers.Feature.Vector(a);this.line=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([this.point.geometry]));this.callback("create",[this.point.geometry,this.getSketch()]);
this.point.geometry.clearBounds();this.layer.addFeatures([this.line,this.point],{silent:!0})},destroyFeature:function(a){OpenLayers.Handler.Point.prototype.destroyFeature.call(this,a);this.line=null},destroyPersistedFeature:function(){var a=this.layer;a&&2<a.features.length&&this.layer.features[0].destroy()},removePoint:function(){this.point&&this.layer.removeFeatures([this.point])},addPoint:function(a){this.layer.removeFeatures([this.point]);a=this.layer.getLonLatFromViewPortPx(a);this.point=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(a.lon,
a.lat));this.line.geometry.addComponent(this.point.geometry,this.line.geometry.components.length);this.layer.addFeatures([this.point]);this.callback("point",[this.point.geometry,this.getGeometry()]);this.callback("modify",[this.point.geometry,this.getSketch()]);this.drawFeature();delete this.redoStack},insertXY:function(a,b){this.line.geometry.addComponent(new OpenLayers.Geometry.Point(a,b),this.getCurrentPointIndex());this.drawFeature();delete this.redoStack},insertDeltaXY:function(a,b){var c=this.line.geometry.components[this.getCurrentPointIndex()-
1];c&&(!isNaN(c.x)&&!isNaN(c.y))&&this.insertXY(c.x+a,c.y+b)},insertDirectionLength:function(a,b){var a=a*(Math.PI/180),c=b*Math.cos(a),d=b*Math.sin(a);this.insertDeltaXY(c,d)},insertDeflectionLength:function(a,b){var c=this.getCurrentPointIndex()-1;if(0<c){var d=this.line.geometry.components[c],c=this.line.geometry.components[c-1];this.insertDirectionLength(180*Math.atan2(d.y-c.y,d.x-c.x)/Math.PI+a,b)}},getCurrentPointIndex:function(){return this.line.geometry.components.length-1},undo:function(){var a=
this.line.geometry,b=a.components,c=this.getCurrentPointIndex()-1,b=b[c];if(a=a.removeComponent(b))this.redoStack||(this.redoStack=[]),this.redoStack.push(b),this.drawFeature();return a},redo:function(){var a=this.redoStack&&this.redoStack.pop();a&&(this.line.geometry.addComponent(a,this.getCurrentPointIndex()),this.drawFeature());return!!a},freehandMode:function(a){return this.freehandToggle&&a[this.freehandToggle]?!this.freehand:this.freehand},modifyFeature:function(a,b){this.line||this.createFeature(a);
var c=this.layer.getLonLatFromViewPortPx(a);this.point.geometry.x=c.lon;this.point.geometry.y=c.lat;this.callback("modify",[this.point.geometry,this.getSketch(),b]);this.point.geometry.clearBounds();this.drawFeature()},drawFeature:function(){this.layer.drawFeature(this.line,this.style);this.layer.drawFeature(this.point,this.style)},getSketch:function(){return this.line},getGeometry:function(){var a=this.line&&this.line.geometry;a&&this.multi&&(a=new OpenLayers.Geometry.MultiLineString([a]));return a},
touchstart:function(a){if(this.timerId&&this.passesTolerance(this.lastTouchPx,a.xy,this.doubleTouchTolerance))return this.finishGeometry(),window.clearTimeout(this.timerId),this.timerId=null,!1;this.timerId&&(window.clearTimeout(this.timerId),this.timerId=null);this.timerId=window.setTimeout(OpenLayers.Function.bind(function(){this.timerId=null},this),300);return OpenLayers.Handler.Point.prototype.touchstart.call(this,a)},down:function(a){var b=this.stopDown;this.freehandMode(a)&&(b=!0,this.touch&&
(this.modifyFeature(a.xy,!!this.lastUp),OpenLayers.Event.stop(a)));!this.touch&&(!this.lastDown||!this.passesTolerance(this.lastDown,a.xy,this.pixelTolerance))&&this.modifyFeature(a.xy,!!this.lastUp);this.mouseDown=!0;this.lastDown=a.xy;this.stoppedDown=b;return!b},move:function(a){if(this.stoppedDown&&this.freehandMode(a))return this.persist&&this.destroyPersistedFeature(),this.maxVertices&&this.line&&this.line.geometry.components.length===this.maxVertices?(this.removePoint(),this.finalize()):this.addPoint(a.xy),
!1;!this.touch&&(!this.mouseDown||this.stoppedDown)&&this.modifyFeature(a.xy,!!this.lastUp);return!0},up:function(a){if(this.mouseDown&&(!this.lastUp||!this.lastUp.equals(a.xy)))this.stoppedDown&&this.freehandMode(a)?(this.persist&&this.destroyPersistedFeature(),this.removePoint(),this.finalize()):this.passesTolerance(this.lastDown,a.xy,this.pixelTolerance)&&(this.touch&&this.modifyFeature(a.xy),null==this.lastUp&&this.persist&&this.destroyPersistedFeature(),this.addPoint(a.xy),this.lastUp=a.xy,this.line.geometry.components.length===
this.maxVertices+1&&this.finishGeometry());this.stoppedDown=this.stopDown;this.mouseDown=!1;return!this.stopUp},finishGeometry:function(){this.line.geometry.removeComponent(this.line.geometry.components[this.line.geometry.components.length-1]);this.removePoint();this.finalize()},dblclick:function(a){this.freehandMode(a)||this.finishGeometry();return!1},CLASS_NAME:"OpenLayers.Handler.Path"});OpenLayers.Spherical=OpenLayers.Spherical||{};OpenLayers.Spherical.DEFAULT_RADIUS=6378137;OpenLayers.Spherical.computeDistanceBetween=function(a,b,c){var c=c||OpenLayers.Spherical.DEFAULT_RADIUS,d=Math.sin(Math.PI*(b.lon-a.lon)/360),e=Math.sin(Math.PI*(b.lat-a.lat)/360),a=e*e+d*d*Math.cos(Math.PI*a.lat/180)*Math.cos(Math.PI*b.lat/180);return 2*c*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))};
OpenLayers.Spherical.computeHeading=function(a,b){var c=Math.sin(Math.PI*(a.lon-b.lon)/180)*Math.cos(Math.PI*b.lat/180),d=Math.cos(Math.PI*a.lat/180)*Math.sin(Math.PI*b.lat/180)-Math.sin(Math.PI*a.lat/180)*Math.cos(Math.PI*b.lat/180)*Math.cos(Math.PI*(a.lon-b.lon)/180);return 180*Math.atan2(c,d)/Math.PI};OpenLayers.Control.CacheWrite=OpenLayers.Class(OpenLayers.Control,{layers:null,imageFormat:"image/png",quotaRegEx:/quota/i,setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments);var b,c=this.layers||a.layers;for(b=c.length-1;0<=b;--b)this.addLayer({layer:c[b]});if(!this.layers)a.events.on({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this})},addLayer:function(a){a.layer.events.on({tileloadstart:this.makeSameOrigin,tileloaded:this.cache,scope:this})},removeLayer:function(a){a.layer.events.un({tileloadstart:this.makeSameOrigin,
tileloaded:this.cache,scope:this})},makeSameOrigin:function(a){if(this.active&&(a=a.tile,a instanceof OpenLayers.Tile.Image&&!a.crossOriginKeyword&&"data:"!==a.url.substr(0,5))){var b=OpenLayers.Request.makeSameOrigin(a.url,OpenLayers.ProxyHost);OpenLayers.Control.CacheWrite.urlMap[b]=a.url;a.url=b}},cache:function(a){if(this.active&&window.localStorage&&(a=a.tile,a instanceof OpenLayers.Tile.Image&&"data:"!==a.url.substr(0,5)))try{var b=a.getCanvasContext();if(b){var c=OpenLayers.Control.CacheWrite.urlMap;
window.localStorage.setItem("olCache_"+(c[a.url]||a.url),b.canvas.toDataURL(this.imageFormat));delete c[a.url]}}catch(d){(b=d.name||d.message)&&this.quotaRegEx.test(b)?this.events.triggerEvent("cachefull",{tile:a}):OpenLayers.Console.error(d.toString())}},destroy:function(){if(this.layers||this.map){var a,b=this.layers||this.map.layers;for(a=b.length-1;0<=a;--a)this.removeLayer({layer:b[a]})}this.map&&this.map.events.un({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this});OpenLayers.Control.prototype.destroy.apply(this,
arguments)},CLASS_NAME:"OpenLayers.Control.CacheWrite"});OpenLayers.Control.CacheWrite.clearCache=function(){if(window.localStorage){var a,b;for(a=window.localStorage.length-1;0<=a;--a)b=window.localStorage.key(a),"olCache_"===b.substr(0,8)&&window.localStorage.removeItem(b)}};OpenLayers.Control.CacheWrite.urlMap={};OpenLayers.Format.Context=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{layerOptions:null,layerParams:null,read:function(a,b){var c=OpenLayers.Format.XML.VersionedOGC.prototype.read.apply(this,arguments);if(b&&b.map)if(this.context=c,b.map instanceof OpenLayers.Map)c=this.mergeContextToMap(c,b.map);else{var d=b.map;if(OpenLayers.Util.isElement(d)||"string"==typeof d)d={div:d};c=this.contextToMap(c,d)}return c},getLayerFromContext:function(a){var b,c,d={queryable:a.queryable,visibility:a.visibility,
maxExtent:a.maxExtent,metadata:OpenLayers.Util.applyDefaults(a.metadata,{styles:a.styles,formats:a.formats,"abstract":a["abstract"],dataURL:a.dataURL}),numZoomLevels:a.numZoomLevels,units:a.units,isBaseLayer:a.isBaseLayer,opacity:a.opacity,displayInLayerSwitcher:a.displayInLayerSwitcher,singleTile:a.singleTile,tileSize:a.tileSize?new OpenLayers.Size(a.tileSize.width,a.tileSize.height):void 0,minScale:a.minScale||a.maxScaleDenominator,maxScale:a.maxScale||a.minScaleDenominator,srs:a.srs,dimensions:a.dimensions,
metadataURL:a.metadataURL};this.layerOptions&&OpenLayers.Util.applyDefaults(d,this.layerOptions);var e={layers:a.name,transparent:a.transparent,version:a.version};if(a.formats&&0<a.formats.length){e.format=a.formats[0].value;b=0;for(c=a.formats.length;b<c;b++){var f=a.formats[b];if(!0==f.current){e.format=f.value;break}}}if(a.styles&&0<a.styles.length){b=0;for(c=a.styles.length;b<c;b++)if(f=a.styles[b],!0==f.current){f.href?e.sld=f.href:f.body?e.sld_body=f.body:e.styles=f.name;break}}this.layerParams&&
OpenLayers.Util.applyDefaults(e,this.layerParams);b=null;c=a.service;c==OpenLayers.Format.Context.serviceTypes.WFS?(d.strategies=[new OpenLayers.Strategy.BBOX],d.protocol=new OpenLayers.Protocol.WFS({url:a.url,featurePrefix:a.name.split(":")[0],featureType:a.name.split(":").pop()}),b=new OpenLayers.Layer.Vector(a.title||a.name,d)):c==OpenLayers.Format.Context.serviceTypes.KML?(d.strategies=[new OpenLayers.Strategy.Fixed],d.protocol=new OpenLayers.Protocol.HTTP({url:a.url,format:new OpenLayers.Format.KML}),
b=new OpenLayers.Layer.Vector(a.title||a.name,d)):c==OpenLayers.Format.Context.serviceTypes.GML?(d.strategies=[new OpenLayers.Strategy.Fixed],d.protocol=new OpenLayers.Protocol.HTTP({url:a.url,format:new OpenLayers.Format.GML}),b=new OpenLayers.Layer.Vector(a.title||a.name,d)):a.features?(b=new OpenLayers.Layer.Vector(a.title||a.name,d),b.addFeatures(a.features)):!0!==a.categoryLayer&&(b=new OpenLayers.Layer.WMS(a.title||a.name,a.url,e,d));return b},getLayersFromContext:function(a){for(var b=[],c=
0,d=a.length;c<d;c++){var e=this.getLayerFromContext(a[c]);null!==e&&b.push(e)}return b},contextToMap:function(a,b){b=OpenLayers.Util.applyDefaults({maxExtent:a.maxExtent,projection:a.projection,units:a.units},b);b.maxExtent&&(b.maxResolution=b.maxExtent.getWidth()/OpenLayers.Map.TILE_WIDTH);b.metadata={contactInformation:a.contactInformation,"abstract":a["abstract"],keywords:a.keywords,logo:a.logo,descriptionURL:a.descriptionURL};var c=new OpenLayers.Map(b);c.addLayers(this.getLayersFromContext(a.layersContext));
c.setCenter(a.bounds.getCenterLonLat(),c.getZoomForExtent(a.bounds,!0));return c},mergeContextToMap:function(a,b){b.addLayers(this.getLayersFromContext(a.layersContext));return b},write:function(a,b){a=this.toContext(a);return OpenLayers.Format.XML.VersionedOGC.prototype.write.apply(this,arguments)},CLASS_NAME:"OpenLayers.Format.Context"});
OpenLayers.Format.Context.serviceTypes={WMS:"urn:ogc:serviceType:WMS",WFS:"urn:ogc:serviceType:WFS",WCS:"urn:ogc:serviceType:WCS",GML:"urn:ogc:serviceType:GML",SLD:"urn:ogc:serviceType:SLD",FES:"urn:ogc:serviceType:FES",KML:"urn:ogc:serviceType:KML"};OpenLayers.Format.WMC=OpenLayers.Class(OpenLayers.Format.Context,{defaultVersion:"1.1.0",layerToContext:function(a){var b=this.getParser(),c={queryable:a.queryable,visibility:a.visibility,name:a.params.LAYERS,title:a.name,"abstract":a.metadata["abstract"],dataURL:a.metadata.dataURL,metadataURL:a.metadataURL,server:{version:a.params.VERSION,url:a.url},maxExtent:a.maxExtent,transparent:a.params.TRANSPARENT,numZoomLevels:a.numZoomLevels,units:a.units,isBaseLayer:a.isBaseLayer,opacity:1==a.opacity?void 0:
a.opacity,displayInLayerSwitcher:a.displayInLayerSwitcher,singleTile:a.singleTile,tileSize:a.singleTile||!a.tileSize?void 0:{width:a.tileSize.w,height:a.tileSize.h},minScale:a.options.resolutions||a.options.scales||a.options.maxResolution||a.options.minScale?a.minScale:void 0,maxScale:a.options.resolutions||a.options.scales||a.options.minResolution||a.options.maxScale?a.maxScale:void 0,formats:[],styles:[],srs:a.srs,dimensions:a.dimensions};a.metadata.servertitle&&(c.server.title=a.metadata.servertitle);
if(a.metadata.formats&&0<a.metadata.formats.length)for(var d=0,e=a.metadata.formats.length;d<e;d++){var f=a.metadata.formats[d];c.formats.push({value:f.value,current:f.value==a.params.FORMAT})}else c.formats.push({value:a.params.FORMAT,current:!0});if(a.metadata.styles&&0<a.metadata.styles.length){d=0;for(e=a.metadata.styles.length;d<e;d++)b=a.metadata.styles[d],b.current=b.href==a.params.SLD||b.body==a.params.SLD_BODY||b.name==a.params.STYLES?!0:!1,c.styles.push(b)}else c.styles.push({href:a.params.SLD,
body:a.params.SLD_BODY,name:a.params.STYLES||b.defaultStyleName,title:b.defaultStyleTitle,current:!0});return c},toContext:function(a){var b={},c=a.layers;if("OpenLayers.Map"==a.CLASS_NAME){var d=a.metadata||{};b.size=a.getSize();b.bounds=a.getExtent();b.projection=a.projection;b.title=a.title;b.keywords=d.keywords;b["abstract"]=d["abstract"];b.logo=d.logo;b.descriptionURL=d.descriptionURL;b.contactInformation=d.contactInformation;b.maxExtent=a.maxExtent}else OpenLayers.Util.applyDefaults(b,a),void 0!=
b.layers&&delete b.layers;void 0==b.layersContext&&(b.layersContext=[]);if(void 0!=c&&OpenLayers.Util.isArray(c)){a=0;for(d=c.length;a<d;a++){var e=c[a];e instanceof OpenLayers.Layer.WMS&&b.layersContext.push(this.layerToContext(e))}}return b},CLASS_NAME:"OpenLayers.Format.WMC"});OpenLayers.Format.WMC.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ol:"http://openlayers.org/context",wmc:"http://www.opengis.net/context",sld:"http://www.opengis.net/sld",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"",getNamespacePrefix:function(a){var b=null;if(null==a)b=this.namespaces[this.defaultPrefix];else for(b in this.namespaces)if(this.namespaces[b]==a)break;return b},defaultPrefix:"wmc",rootPrefix:null,defaultStyleName:"",
defaultStyleTitle:"Default",initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a=a.documentElement;this.rootPrefix=a.prefix;var b={version:a.getAttribute("version")};this.runChildNodes(b,a);return b},runChildNodes:function(a,b){for(var c=b.childNodes,d,e,f,g=0,h=c.length;g<h;++g)d=c[g],1==d.nodeType&&(e=this.getNamespacePrefix(d.namespaceURI),f=d.nodeName.split(":").pop(),
(e=this["read_"+e+"_"+f])&&e.apply(this,[a,d]))},read_wmc_General:function(a,b){this.runChildNodes(a,b)},read_wmc_BoundingBox:function(a,b){a.projection=b.getAttribute("SRS");a.bounds=new OpenLayers.Bounds(b.getAttribute("minx"),b.getAttribute("miny"),b.getAttribute("maxx"),b.getAttribute("maxy"))},read_wmc_LayerList:function(a,b){a.layersContext=[];this.runChildNodes(a,b)},read_wmc_Layer:function(a,b){var c={visibility:"1"!=b.getAttribute("hidden"),queryable:"1"==b.getAttribute("queryable"),formats:[],
styles:[],metadata:{}};this.runChildNodes(c,b);a.layersContext.push(c)},read_wmc_Extension:function(a,b){this.runChildNodes(a,b)},read_ol_units:function(a,b){a.units=this.getChildValue(b)},read_ol_maxExtent:function(a,b){var c=new OpenLayers.Bounds(b.getAttribute("minx"),b.getAttribute("miny"),b.getAttribute("maxx"),b.getAttribute("maxy"));a.maxExtent=c},read_ol_transparent:function(a,b){a.transparent=this.getChildValue(b)},read_ol_numZoomLevels:function(a,b){a.numZoomLevels=parseInt(this.getChildValue(b))},
read_ol_opacity:function(a,b){a.opacity=parseFloat(this.getChildValue(b))},read_ol_singleTile:function(a,b){a.singleTile="true"==this.getChildValue(b)},read_ol_tileSize:function(a,b){var c={width:b.getAttribute("width"),height:b.getAttribute("height")};a.tileSize=c},read_ol_isBaseLayer:function(a,b){a.isBaseLayer="true"==this.getChildValue(b)},read_ol_displayInLayerSwitcher:function(a,b){a.displayInLayerSwitcher="true"==this.getChildValue(b)},read_wmc_Server:function(a,b){a.version=b.getAttribute("version");
a.url=this.getOnlineResource_href(b);a.metadata.servertitle=b.getAttribute("title")},read_wmc_FormatList:function(a,b){this.runChildNodes(a,b)},read_wmc_Format:function(a,b){var c={value:this.getChildValue(b)};"1"==b.getAttribute("current")&&(c.current=!0);a.formats.push(c)},read_wmc_StyleList:function(a,b){this.runChildNodes(a,b)},read_wmc_Style:function(a,b){var c={};this.runChildNodes(c,b);"1"==b.getAttribute("current")&&(c.current=!0);a.styles.push(c)},read_wmc_SLD:function(a,b){this.runChildNodes(a,
b)},read_sld_StyledLayerDescriptor:function(a,b){var c=OpenLayers.Format.XML.prototype.write.apply(this,[b]);a.body=c},read_sld_FeatureTypeStyle:function(a,b){var c=OpenLayers.Format.XML.prototype.write.apply(this,[b]);a.body=c},read_wmc_OnlineResource:function(a,b){a.href=this.getAttributeNS(b,this.namespaces.xlink,"href")},read_wmc_Name:function(a,b){var c=this.getChildValue(b);c&&(a.name=c)},read_wmc_Title:function(a,b){var c=this.getChildValue(b);c&&(a.title=c)},read_wmc_MetadataURL:function(a,
b){a.metadataURL=this.getOnlineResource_href(b)},read_wmc_KeywordList:function(a,b){a.keywords=[];this.runChildNodes(a.keywords,b)},read_wmc_Keyword:function(a,b){a.push(this.getChildValue(b))},read_wmc_Abstract:function(a,b){var c=this.getChildValue(b);c&&(a["abstract"]=c)},read_wmc_LogoURL:function(a,b){a.logo={width:b.getAttribute("width"),height:b.getAttribute("height"),format:b.getAttribute("format"),href:this.getOnlineResource_href(b)}},read_wmc_DescriptionURL:function(a,b){a.descriptionURL=
this.getOnlineResource_href(b)},read_wmc_ContactInformation:function(a,b){var c={};this.runChildNodes(c,b);a.contactInformation=c},read_wmc_ContactPersonPrimary:function(a,b){var c={};this.runChildNodes(c,b);a.personPrimary=c},read_wmc_ContactPerson:function(a,b){var c=this.getChildValue(b);c&&(a.person=c)},read_wmc_ContactOrganization:function(a,b){var c=this.getChildValue(b);c&&(a.organization=c)},read_wmc_ContactPosition:function(a,b){var c=this.getChildValue(b);c&&(a.position=c)},read_wmc_ContactAddress:function(a,
b){var c={};this.runChildNodes(c,b);a.contactAddress=c},read_wmc_AddressType:function(a,b){var c=this.getChildValue(b);c&&(a.type=c)},read_wmc_Address:function(a,b){var c=this.getChildValue(b);c&&(a.address=c)},read_wmc_City:function(a,b){var c=this.getChildValue(b);c&&(a.city=c)},read_wmc_StateOrProvince:function(a,b){var c=this.getChildValue(b);c&&(a.stateOrProvince=c)},read_wmc_PostCode:function(a,b){var c=this.getChildValue(b);c&&(a.postcode=c)},read_wmc_Country:function(a,b){var c=this.getChildValue(b);
c&&(a.country=c)},read_wmc_ContactVoiceTelephone:function(a,b){var c=this.getChildValue(b);c&&(a.phone=c)},read_wmc_ContactFacsimileTelephone:function(a,b){var c=this.getChildValue(b);c&&(a.fax=c)},read_wmc_ContactElectronicMailAddress:function(a,b){var c=this.getChildValue(b);c&&(a.email=c)},read_wmc_DataURL:function(a,b){a.dataURL=this.getOnlineResource_href(b)},read_wmc_LegendURL:function(a,b){var c={width:b.getAttribute("width"),height:b.getAttribute("height"),format:b.getAttribute("format"),
href:this.getOnlineResource_href(b)};a.legend=c},read_wmc_DimensionList:function(a,b){a.dimensions={};this.runChildNodes(a.dimensions,b)},read_wmc_Dimension:function(a,b){var c={name:b.getAttribute("name").toLowerCase(),units:b.getAttribute("units")||"",unitSymbol:b.getAttribute("unitSymbol")||"",userValue:b.getAttribute("userValue")||"",nearestValue:"1"===b.getAttribute("nearestValue"),multipleValues:"1"===b.getAttribute("multipleValues"),current:"1"===b.getAttribute("current"),"default":b.getAttribute("default")||
""},d=this.getChildValue(b);c.values=d.split(",");a[c.name]=c},write:function(a,b){var c=this.createElementDefaultNS("ViewContext");this.setAttributes(c,{version:this.VERSION,id:b&&"string"==typeof b.id?b.id:OpenLayers.Util.createUniqueID("OpenLayers_Context_")});this.setAttributeNS(c,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);c.appendChild(this.write_wmc_General(a));c.appendChild(this.write_wmc_LayerList(a));return OpenLayers.Format.XML.prototype.write.apply(this,[c])},createElementDefaultNS:function(a,
b,c){a=this.createElementNS(this.namespaces[this.defaultPrefix],a);b&&a.appendChild(this.createTextNode(b));c&&this.setAttributes(a,c);return a},setAttributes:function(a,b){var c,d;for(d in b)c=b[d].toString(),c.match(/[A-Z]/)?this.setAttributeNS(a,null,d,c):a.setAttribute(d,c)},write_wmc_General:function(a){var b=this.createElementDefaultNS("General");a.size&&b.appendChild(this.createElementDefaultNS("Window",null,{width:a.size.w,height:a.size.h}));var c=a.bounds;b.appendChild(this.createElementDefaultNS("BoundingBox",
null,{minx:c.left.toPrecision(18),miny:c.bottom.toPrecision(18),maxx:c.right.toPrecision(18),maxy:c.top.toPrecision(18),SRS:a.projection}));b.appendChild(this.createElementDefaultNS("Title",a.title));a.keywords&&b.appendChild(this.write_wmc_KeywordList(a.keywords));a["abstract"]&&b.appendChild(this.createElementDefaultNS("Abstract",a["abstract"]));a.logo&&b.appendChild(this.write_wmc_URLType("LogoURL",a.logo.href,a.logo));a.descriptionURL&&b.appendChild(this.write_wmc_URLType("DescriptionURL",a.descriptionURL));
a.contactInformation&&b.appendChild(this.write_wmc_ContactInformation(a.contactInformation));b.appendChild(this.write_ol_MapExtension(a));return b},write_wmc_KeywordList:function(a){for(var b=this.createElementDefaultNS("KeywordList"),c=0,d=a.length;c<d;c++)b.appendChild(this.createElementDefaultNS("Keyword",a[c]));return b},write_wmc_ContactInformation:function(a){var b=this.createElementDefaultNS("ContactInformation");a.personPrimary&&b.appendChild(this.write_wmc_ContactPersonPrimary(a.personPrimary));
a.position&&b.appendChild(this.createElementDefaultNS("ContactPosition",a.position));a.contactAddress&&b.appendChild(this.write_wmc_ContactAddress(a.contactAddress));a.phone&&b.appendChild(this.createElementDefaultNS("ContactVoiceTelephone",a.phone));a.fax&&b.appendChild(this.createElementDefaultNS("ContactFacsimileTelephone",a.fax));a.email&&b.appendChild(this.createElementDefaultNS("ContactElectronicMailAddress",a.email));return b},write_wmc_ContactPersonPrimary:function(a){var b=this.createElementDefaultNS("ContactPersonPrimary");
a.person&&b.appendChild(this.createElementDefaultNS("ContactPerson",a.person));a.organization&&b.appendChild(this.createElementDefaultNS("ContactOrganization",a.organization));return b},write_wmc_ContactAddress:function(a){var b=this.createElementDefaultNS("ContactAddress");a.type&&b.appendChild(this.createElementDefaultNS("AddressType",a.type));a.address&&b.appendChild(this.createElementDefaultNS("Address",a.address));a.city&&b.appendChild(this.createElementDefaultNS("City",a.city));a.stateOrProvince&&
b.appendChild(this.createElementDefaultNS("StateOrProvince",a.stateOrProvince));a.postcode&&b.appendChild(this.createElementDefaultNS("PostCode",a.postcode));a.country&&b.appendChild(this.createElementDefaultNS("Country",a.country));return b},write_ol_MapExtension:function(a){var b=this.createElementDefaultNS("Extension");if(a=a.maxExtent){var c=this.createElementNS(this.namespaces.ol,"ol:maxExtent");this.setAttributes(c,{minx:a.left.toPrecision(18),miny:a.bottom.toPrecision(18),maxx:a.right.toPrecision(18),
maxy:a.top.toPrecision(18)});b.appendChild(c)}return b},write_wmc_LayerList:function(a){for(var b=this.createElementDefaultNS("LayerList"),c=0,d=a.layersContext.length;c<d;++c)b.appendChild(this.write_wmc_Layer(a.layersContext[c]));return b},write_wmc_Layer:function(a){var b=this.createElementDefaultNS("Layer",null,{queryable:a.queryable?"1":"0",hidden:a.visibility?"0":"1"});b.appendChild(this.write_wmc_Server(a));b.appendChild(this.createElementDefaultNS("Name",a.name));b.appendChild(this.createElementDefaultNS("Title",
a.title));a["abstract"]&&b.appendChild(this.createElementDefaultNS("Abstract",a["abstract"]));a.dataURL&&b.appendChild(this.write_wmc_URLType("DataURL",a.dataURL));a.metadataURL&&b.appendChild(this.write_wmc_URLType("MetadataURL",a.metadataURL));return b},write_wmc_LayerExtension:function(a){var b=this.createElementDefaultNS("Extension"),c=a.maxExtent,d=this.createElementNS(this.namespaces.ol,"ol:maxExtent");this.setAttributes(d,{minx:c.left.toPrecision(18),miny:c.bottom.toPrecision(18),maxx:c.right.toPrecision(18),
maxy:c.top.toPrecision(18)});b.appendChild(d);a.tileSize&&!a.singleTile&&(c=this.createElementNS(this.namespaces.ol,"ol:tileSize"),this.setAttributes(c,a.tileSize),b.appendChild(c));for(var c="transparent numZoomLevels units isBaseLayer opacity displayInLayerSwitcher singleTile".split(" "),e=0,f=c.length;e<f;++e)(d=this.createOLPropertyNode(a,c[e]))&&b.appendChild(d);return b},createOLPropertyNode:function(a,b){var c=null;null!=a[b]&&(c=this.createElementNS(this.namespaces.ol,"ol:"+b),c.appendChild(this.createTextNode(a[b].toString())));
return c},write_wmc_Server:function(a){var a=a.server,b=this.createElementDefaultNS("Server"),c={service:"OGC:WMS",version:a.version};a.title&&(c.title=a.title);this.setAttributes(b,c);b.appendChild(this.write_wmc_OnlineResource(a.url));return b},write_wmc_URLType:function(a,b,c){a=this.createElementDefaultNS(a);a.appendChild(this.write_wmc_OnlineResource(b));if(c)for(var b=["width","height","format"],d=0;d<b.length;d++)b[d]in c&&a.setAttribute(b[d],c[b[d]]);return a},write_wmc_DimensionList:function(a){var b=
this.createElementDefaultNS("DimensionList"),c;for(c in a.dimensions){var d={},e=a.dimensions[c],f;for(f in e)d[f]="boolean"==typeof e[f]?Number(e[f]):e[f];e="";d.values&&(e=d.values.join(","),delete d.values);b.appendChild(this.createElementDefaultNS("Dimension",e,d))}return b},write_wmc_FormatList:function(a){for(var b=this.createElementDefaultNS("FormatList"),c=0,d=a.formats.length;c<d;c++){var e=a.formats[c];b.appendChild(this.createElementDefaultNS("Format",e.value,e.current&&!0==e.current?{current:"1"}:
null))}return b},write_wmc_StyleList:function(a){var b=this.createElementDefaultNS("StyleList");if((a=a.styles)&&OpenLayers.Util.isArray(a))for(var c,d=0,e=a.length;d<e;d++){var f=a[d],g=this.createElementDefaultNS("Style",null,f.current&&!0==f.current?{current:"1"}:null);f.href?(c=this.createElementDefaultNS("SLD"),f.name&&c.appendChild(this.createElementDefaultNS("Name",f.name)),f.title&&c.appendChild(this.createElementDefaultNS("Title",f.title)),f.legend&&c.appendChild(this.write_wmc_URLType("LegendURL",
f.legend.href,f.legend)),f=this.write_wmc_OnlineResource(f.href),c.appendChild(f),g.appendChild(c)):f.body?(c=this.createElementDefaultNS("SLD"),f.name&&c.appendChild(this.createElementDefaultNS("Name",f.name)),f.title&&c.appendChild(this.createElementDefaultNS("Title",f.title)),f.legend&&c.appendChild(this.write_wmc_URLType("LegendURL",f.legend.href,f.legend)),f=OpenLayers.Format.XML.prototype.read.apply(this,[f.body]).documentElement,c.ownerDocument&&c.ownerDocument.importNode&&(f=c.ownerDocument.importNode(f,
!0)),c.appendChild(f),g.appendChild(c)):(g.appendChild(this.createElementDefaultNS("Name",f.name)),g.appendChild(this.createElementDefaultNS("Title",f.title)),f["abstract"]&&g.appendChild(this.createElementDefaultNS("Abstract",f["abstract"])),f.legend&&g.appendChild(this.write_wmc_URLType("LegendURL",f.legend.href,f.legend)));b.appendChild(g)}return b},write_wmc_OnlineResource:function(a){var b=this.createElementDefaultNS("OnlineResource");this.setAttributeNS(b,this.namespaces.xlink,"xlink:type",
"simple");this.setAttributeNS(b,this.namespaces.xlink,"xlink:href",a);return b},getOnlineResource_href:function(a){var b={},a=a.getElementsByTagName("OnlineResource");0<a.length&&this.read_wmc_OnlineResource(b,a[0]);return b.href},CLASS_NAME:"OpenLayers.Format.WMC.v1"});OpenLayers.Control.PanPanel=OpenLayers.Class(OpenLayers.Control.Panel,{slideFactor:50,slideRatio:null,initialize:function(a){OpenLayers.Control.Panel.prototype.initialize.apply(this,[a]);a={slideFactor:this.slideFactor,slideRatio:this.slideRatio};this.addControls([new OpenLayers.Control.Pan(OpenLayers.Control.Pan.NORTH,a),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.SOUTH,a),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.EAST,a),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.WEST,a)])},
CLASS_NAME:"OpenLayers.Control.PanPanel"});OpenLayers.Control.Attribution=OpenLayers.Class(OpenLayers.Control,{separator:", ",template:"${layers}",destroy:function(){this.map.events.un({removelayer:this.updateAttribution,addlayer:this.updateAttribution,changelayer:this.updateAttribution,changebaselayer:this.updateAttribution,scope:this});OpenLayers.Control.prototype.destroy.apply(this,arguments)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.map.events.on({changebaselayer:this.updateAttribution,changelayer:this.updateAttribution,
addlayer:this.updateAttribution,removelayer:this.updateAttribution,scope:this});this.updateAttribution();return this.div},updateAttribution:function(){var a=[];if(this.map&&this.map.layers){for(var b=0,c=this.map.layers.length;b<c;b++){var d=this.map.layers[b];d.attribution&&d.getVisibility()&&-1===OpenLayers.Util.indexOf(a,d.attribution)&&a.push(d.attribution)}this.div.innerHTML=OpenLayers.String.format(this.template,{layers:a.join(this.separator)})}},CLASS_NAME:"OpenLayers.Control.Attribution"});OpenLayers.Kinetic=OpenLayers.Class({threshold:0,deceleration:0.0035,nbPoints:100,delay:200,points:void 0,timerId:void 0,initialize:function(a){OpenLayers.Util.extend(this,a)},begin:function(){OpenLayers.Animation.stop(this.timerId);this.timerId=void 0;this.points=[]},update:function(a){this.points.unshift({xy:a,tick:(new Date).getTime()});this.points.length>this.nbPoints&&this.points.pop()},end:function(a){for(var b,c=(new Date).getTime(),d=0,e=this.points.length,f;d<e;d++){f=this.points[d];if(c-
f.tick>this.delay)break;b=f}if(b&&(d=(new Date).getTime()-b.tick,c=Math.sqrt(Math.pow(a.x-b.xy.x,2)+Math.pow(a.y-b.xy.y,2)),d=c/d,!(0==d||d<this.threshold)))return c=Math.asin((a.y-b.xy.y)/c),b.xy.x<=a.x&&(c=Math.PI-c),{speed:d,theta:c}},move:function(a,b){var c=a.speed,d=Math.cos(a.theta),e=-Math.sin(a.theta),f=(new Date).getTime(),g=0,h=0;this.timerId=OpenLayers.Animation.start(OpenLayers.Function.bind(function(){if(null!=this.timerId){var a=(new Date).getTime()-f,j=-this.deceleration*Math.pow(a,
2)/2+c*a,k=j*d,j=j*e,l,m;l=!1;0>=-this.deceleration*a+c&&(OpenLayers.Animation.stop(this.timerId),this.timerId=null,l=!0);a=k-g;m=j-h;g=k;h=j;b(a,m,l)}},this))},CLASS_NAME:"OpenLayers.Kinetic"});OpenLayers.Layer.GeoRSS=OpenLayers.Class(OpenLayers.Layer.Markers,{location:null,features:null,formatOptions:null,selectedFeature:null,icon:null,popupSize:null,useFeedTitle:!0,initialize:function(a,b,c){OpenLayers.Layer.Markers.prototype.initialize.apply(this,[a,c]);this.location=b;this.features=[]},destroy:function(){OpenLayers.Layer.Markers.prototype.destroy.apply(this,arguments);this.clearFeatures();this.features=null},loadRSS:function(){this.loaded||(this.events.triggerEvent("loadstart"),OpenLayers.Request.GET({url:this.location,
success:this.parseData,scope:this}),this.loaded=!0)},moveTo:function(a,b,c){OpenLayers.Layer.Markers.prototype.moveTo.apply(this,arguments);this.visibility&&!this.loaded&&this.loadRSS()},parseData:function(a){var b=a.responseXML;if(!b||!b.documentElement)b=OpenLayers.Format.XML.prototype.read(a.responseText);if(this.useFeedTitle){a=null;try{a=b.getElementsByTagNameNS("*","title")[0].firstChild.nodeValue}catch(c){a=b.getElementsByTagName("title")[0].firstChild.nodeValue}a&&this.setName(a)}a={};OpenLayers.Util.extend(a,
this.formatOptions);this.map&&!this.projection.equals(this.map.getProjectionObject())&&(a.externalProjection=this.projection,a.internalProjection=this.map.getProjectionObject());for(var b=(new OpenLayers.Format.GeoRSS(a)).read(b),a=0,d=b.length;a<d;a++){var e={},f=b[a];if(f.geometry){var g=f.attributes.title?f.attributes.title:"Untitled",h=f.attributes.description?f.attributes.description:"No description.",i=f.attributes.link?f.attributes.link:"",f=f.geometry.getBounds().getCenterLonLat();e.icon=
null==this.icon?OpenLayers.Marker.defaultIcon():this.icon.clone();e.popupSize=this.popupSize?this.popupSize.clone():new OpenLayers.Size(250,120);if(g||h){e.title=g;e.description=h;var j='<div class="olLayerGeoRSSClose">[x]</div>',j=j+'<div class="olLayerGeoRSSTitle">';i&&(j+='<a class="link" href="'+i+'" target="_blank">');j+=g;i&&(j+="</a>");j+="</div>";j+='<div style="" class="olLayerGeoRSSDescription">';j+=h;j+="</div>";e.popupContentHTML=j}f=new OpenLayers.Feature(this,f,e);this.features.push(f);
e=f.createMarker();e.events.register("click",f,this.markerClick);this.addMarker(e)}}this.events.triggerEvent("loadend")},markerClick:function(a){var b=this==this.layer.selectedFeature;this.layer.selectedFeature=!b?this:null;for(var c=0,d=this.layer.map.popups.length;c<d;c++)this.layer.map.removePopup(this.layer.map.popups[c]);b||(b=this.createPopup(),OpenLayers.Event.observe(b.div,"click",OpenLayers.Function.bind(function(){for(var a=0,b=this.layer.map.popups.length;a<b;a++)this.layer.map.removePopup(this.layer.map.popups[a])},
this)),this.layer.map.addPopup(b));OpenLayers.Event.stop(a)},clearFeatures:function(){if(null!=this.features)for(;0<this.features.length;){var a=this.features[0];OpenLayers.Util.removeItem(this.features,a);a.destroy()}},CLASS_NAME:"OpenLayers.Layer.GeoRSS"});OpenLayers.Symbolizer.Point=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(a){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Point"});OpenLayers.Symbolizer.Line=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(a){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Line"});OpenLayers.Symbolizer.Text=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(a){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Text"});OpenLayers.Format.SLD.v1=OpenLayers.Class(OpenLayers.Format.Filter.v1_0_0,{namespaces:{sld:"http://www.opengis.net/sld",ogc:"http://www.opengis.net/ogc",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"sld",schemaLocation:null,multipleSymbolizers:!1,featureTypeCounter:null,defaultSymbolizer:{fillColor:"#808080",fillOpacity:1,strokeColor:"#000000",strokeOpacity:1,strokeWidth:1,strokeDashstyle:"solid",pointRadius:3,
graphicName:"square"},read:function(a,b){var b=OpenLayers.Util.applyDefaults(b,this.options),c={namedLayers:!0===b.namedLayersAsArray?[]:{}};this.readChildNodes(a,c);return c},readers:OpenLayers.Util.applyDefaults({sld:{StyledLayerDescriptor:function(a,b){b.version=a.getAttribute("version");this.readChildNodes(a,b)},Name:function(a,b){b.name=this.getChildValue(a)},Title:function(a,b){b.title=this.getChildValue(a)},Abstract:function(a,b){b.description=this.getChildValue(a)},NamedLayer:function(a,b){var c=
{userStyles:[],namedStyles:[]};this.readChildNodes(a,c);for(var d=0,e=c.userStyles.length;d<e;++d)c.userStyles[d].layerName=c.name;OpenLayers.Util.isArray(b.namedLayers)?b.namedLayers.push(c):b.namedLayers[c.name]=c},NamedStyle:function(a,b){b.namedStyles.push(this.getChildName(a.firstChild))},UserStyle:function(a,b){var c={defaultsPerSymbolizer:!0,rules:[]};this.featureTypeCounter=-1;this.readChildNodes(a,c);this.multipleSymbolizers?(delete c.defaultsPerSymbolizer,c=new OpenLayers.Style2(c)):c=new OpenLayers.Style(this.defaultSymbolizer,
c);b.userStyles.push(c)},IsDefault:function(a,b){"1"==this.getChildValue(a)&&(b.isDefault=!0)},FeatureTypeStyle:function(a,b){++this.featureTypeCounter;var c={rules:this.multipleSymbolizers?b.rules:[]};this.readChildNodes(a,c);this.multipleSymbolizers||(b.rules=c.rules)},Rule:function(a,b){var c;this.multipleSymbolizers&&(c={symbolizers:[]});c=new OpenLayers.Rule(c);this.readChildNodes(a,c);b.rules.push(c)},ElseFilter:function(a,b){b.elseFilter=!0},MinScaleDenominator:function(a,b){b.minScaleDenominator=
parseFloat(this.getChildValue(a))},MaxScaleDenominator:function(a,b){b.maxScaleDenominator=parseFloat(this.getChildValue(a))},TextSymbolizer:function(a,b){var c={};this.readChildNodes(a,c);this.multipleSymbolizers?(c.zIndex=this.featureTypeCounter,b.symbolizers.push(new OpenLayers.Symbolizer.Text(c))):b.symbolizer.Text=OpenLayers.Util.applyDefaults(c,b.symbolizer.Text)},LabelPlacement:function(a,b){this.readChildNodes(a,b)},PointPlacement:function(a,b){var c={};this.readChildNodes(a,c);c.labelRotation=
c.rotation;delete c.rotation;var d,e=b.labelAnchorPointX,f=b.labelAnchorPointY;e<=1/3?d="l":e>1/3&&e<2/3?d="c":e>=2/3&&(d="r");f<=1/3?d+="b":f>1/3&&f<2/3?d+="m":f>=2/3&&(d+="t");c.labelAlign=d;OpenLayers.Util.applyDefaults(b,c)},AnchorPoint:function(a,b){this.readChildNodes(a,b)},AnchorPointX:function(a,b){var c=this.readers.ogc._expression.call(this,a);c&&(b.labelAnchorPointX=c)},AnchorPointY:function(a,b){var c=this.readers.ogc._expression.call(this,a);c&&(b.labelAnchorPointY=c)},Displacement:function(a,
b){this.readChildNodes(a,b)},DisplacementX:function(a,b){var c=this.readers.ogc._expression.call(this,a);c&&(b.labelXOffset=c)},DisplacementY:function(a,b){var c=this.readers.ogc._expression.call(this,a);c&&(b.labelYOffset=c)},LinePlacement:function(a,b){this.readChildNodes(a,b)},PerpendicularOffset:function(a,b){var c=this.readers.ogc._expression.call(this,a);c&&(b.labelPerpendicularOffset=c)},Label:function(a,b){var c=this.readers.ogc._expression.call(this,a);c&&(b.label=c)},Font:function(a,b){this.readChildNodes(a,
b)},Halo:function(a,b){var c={};this.readChildNodes(a,c);b.haloRadius=c.haloRadius;b.haloColor=c.fillColor;b.haloOpacity=c.fillOpacity},Radius:function(a,b){var c=this.readers.ogc._expression.call(this,a);null!=c&&(b.haloRadius=c)},RasterSymbolizer:function(a,b){var c={};this.readChildNodes(a,c);this.multipleSymbolizers?(c.zIndex=this.featureTypeCounter,b.symbolizers.push(new OpenLayers.Symbolizer.Raster(c))):b.symbolizer.Raster=OpenLayers.Util.applyDefaults(c,b.symbolizer.Raster)},Geometry:function(a,
b){b.geometry={};this.readChildNodes(a,b.geometry)},ColorMap:function(a,b){b.colorMap=[];this.readChildNodes(a,b.colorMap)},ColorMapEntry:function(a,b){var c=a.getAttribute("quantity"),d=a.getAttribute("opacity");b.push({color:a.getAttribute("color"),quantity:null!==c?parseFloat(c):void 0,label:a.getAttribute("label")||void 0,opacity:null!==d?parseFloat(d):void 0})},LineSymbolizer:function(a,b){var c={};this.readChildNodes(a,c);this.multipleSymbolizers?(c.zIndex=this.featureTypeCounter,b.symbolizers.push(new OpenLayers.Symbolizer.Line(c))):
b.symbolizer.Line=OpenLayers.Util.applyDefaults(c,b.symbolizer.Line)},PolygonSymbolizer:function(a,b){var c={fill:!1,stroke:!1};this.multipleSymbolizers||(c=b.symbolizer.Polygon||c);this.readChildNodes(a,c);this.multipleSymbolizers?(c.zIndex=this.featureTypeCounter,b.symbolizers.push(new OpenLayers.Symbolizer.Polygon(c))):b.symbolizer.Polygon=c},PointSymbolizer:function(a,b){var c={fill:!1,stroke:!1,graphic:!1};this.multipleSymbolizers||(c=b.symbolizer.Point||c);this.readChildNodes(a,c);this.multipleSymbolizers?
(c.zIndex=this.featureTypeCounter,b.symbolizers.push(new OpenLayers.Symbolizer.Point(c))):b.symbolizer.Point=c},Stroke:function(a,b){b.stroke=!0;this.readChildNodes(a,b)},Fill:function(a,b){b.fill=!0;this.readChildNodes(a,b)},CssParameter:function(a,b){var c=a.getAttribute("name"),d=this.cssMap[c];b.label&&("fill"===c?d="fontColor":"fill-opacity"===c&&(d="fontOpacity"));d&&(c=this.readers.ogc._expression.call(this,a))&&(b[d]=c)},Graphic:function(a,b){b.graphic=!0;var c={};this.readChildNodes(a,c);
for(var d="stroke strokeColor strokeWidth strokeOpacity strokeLinecap fill fillColor fillOpacity graphicName rotation graphicFormat".split(" "),e,f,g=0,h=d.length;g<h;++g)e=d[g],f=c[e],void 0!=f&&(b[e]=f);void 0!=c.opacity&&(b.graphicOpacity=c.opacity);void 0!=c.size&&(isNaN(c.size/2)?b.graphicWidth=c.size:b.pointRadius=c.size/2);void 0!=c.href&&(b.externalGraphic=c.href);void 0!=c.rotation&&(b.rotation=c.rotation)},ExternalGraphic:function(a,b){this.readChildNodes(a,b)},Mark:function(a,b){this.readChildNodes(a,
b)},WellKnownName:function(a,b){b.graphicName=this.getChildValue(a)},Opacity:function(a,b){var c=this.readers.ogc._expression.call(this,a);c&&(b.opacity=c)},Size:function(a,b){var c=this.readers.ogc._expression.call(this,a);c&&(b.size=c)},Rotation:function(a,b){var c=this.readers.ogc._expression.call(this,a);c&&(b.rotation=c)},OnlineResource:function(a,b){b.href=this.getAttributeNS(a,this.namespaces.xlink,"href")},Format:function(a,b){b.graphicFormat=this.getChildValue(a)}}},OpenLayers.Format.Filter.v1_0_0.prototype.readers),
cssMap:{stroke:"strokeColor","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","stroke-linecap":"strokeLinecap","stroke-dasharray":"strokeDashstyle",fill:"fillColor","fill-opacity":"fillOpacity","font-family":"fontFamily","font-size":"fontSize","font-weight":"fontWeight","font-style":"fontStyle"},getCssProperty:function(a){var b=null,c;for(c in this.cssMap)if(this.cssMap[c]==a){b=c;break}return b},getGraphicFormat:function(a){var b,c;for(c in this.graphicFormats)if(this.graphicFormats[c].test(a)){b=
c;break}return b||this.defaultGraphicFormat},defaultGraphicFormat:"image/png",graphicFormats:{"image/jpeg":/\.jpe?g$/i,"image/gif":/\.gif$/i,"image/png":/\.png$/i},write:function(a){return this.writers.sld.StyledLayerDescriptor.apply(this,[a])},writers:OpenLayers.Util.applyDefaults({sld:{_OGCExpression:function(a,b){var c=this.createElementNSPlus(a),d="string"==typeof b?b.split("${"):[b];c.appendChild(this.createTextNode(d[0]));for(var e,f,g=1,h=d.length;g<h;g++)e=d[g],f=e.indexOf("}"),0<f?(this.writeNode("ogc:PropertyName",
{property:e.substring(0,f)},c),c.appendChild(this.createTextNode(e.substring(++f)))):c.appendChild(this.createTextNode("${"+e));return c},StyledLayerDescriptor:function(a){var b=this.createElementNSPlus("sld:StyledLayerDescriptor",{attributes:{version:this.VERSION,"xsi:schemaLocation":this.schemaLocation}});b.setAttribute("xmlns:ogc",this.namespaces.ogc);b.setAttribute("xmlns:gml",this.namespaces.gml);a.name&&this.writeNode("Name",a.name,b);a.title&&this.writeNode("Title",a.title,b);a.description&&
this.writeNode("Abstract",a.description,b);if(OpenLayers.Util.isArray(a.namedLayers))for(var c=0,d=a.namedLayers.length;c<d;++c)this.writeNode("NamedLayer",a.namedLayers[c],b);else for(c in a.namedLayers)this.writeNode("NamedLayer",a.namedLayers[c],b);return b},Name:function(a){return this.createElementNSPlus("sld:Name",{value:a})},Title:function(a){return this.createElementNSPlus("sld:Title",{value:a})},Abstract:function(a){return this.createElementNSPlus("sld:Abstract",{value:a})},NamedLayer:function(a){var b=
this.createElementNSPlus("sld:NamedLayer");this.writeNode("Name",a.name,b);if(a.namedStyles)for(var c=0,d=a.namedStyles.length;c<d;++c)this.writeNode("NamedStyle",a.namedStyles[c],b);if(a.userStyles){c=0;for(d=a.userStyles.length;c<d;++c)this.writeNode("UserStyle",a.userStyles[c],b)}return b},NamedStyle:function(a){var b=this.createElementNSPlus("sld:NamedStyle");this.writeNode("Name",a,b);return b},UserStyle:function(a){var b=this.createElementNSPlus("sld:UserStyle");a.name&&this.writeNode("Name",
a.name,b);a.title&&this.writeNode("Title",a.title,b);a.description&&this.writeNode("Abstract",a.description,b);a.isDefault&&this.writeNode("IsDefault",a.isDefault,b);if(this.multipleSymbolizers&&a.rules){for(var c={"0":[]},d=[0],e,f,g,h,i,j=0,k=a.rules.length;j<k;++j)if(e=a.rules[j],e.symbolizers){f={};for(var l=0,m=e.symbolizers.length;l<m;++l)g=e.symbolizers[l],h=g.zIndex,h in f||(i=e.clone(),i.symbolizers=[],f[h]=i),f[h].symbolizers.push(g.clone());for(h in f)h in c||(d.push(h),c[h]=[]),c[h].push(f[h])}else c[0].push(e.clone());
d.sort();j=0;for(k=d.length;j<k;++j)e=c[d[j]],0<e.length&&(i=a.clone(),i.rules=c[d[j]],this.writeNode("FeatureTypeStyle",i,b))}else this.writeNode("FeatureTypeStyle",a,b);return b},IsDefault:function(a){return this.createElementNSPlus("sld:IsDefault",{value:a?"1":"0"})},FeatureTypeStyle:function(a){for(var b=this.createElementNSPlus("sld:FeatureTypeStyle"),c=0,d=a.rules.length;c<d;++c)this.writeNode("Rule",a.rules[c],b);return b},Rule:function(a){var b=this.createElementNSPlus("sld:Rule");a.name&&
this.writeNode("Name",a.name,b);a.title&&this.writeNode("Title",a.title,b);a.description&&this.writeNode("Abstract",a.description,b);a.elseFilter?this.writeNode("ElseFilter",null,b):a.filter&&this.writeNode("ogc:Filter",a.filter,b);void 0!=a.minScaleDenominator&&this.writeNode("MinScaleDenominator",a.minScaleDenominator,b);void 0!=a.maxScaleDenominator&&this.writeNode("MaxScaleDenominator",a.maxScaleDenominator,b);var c,d;if(this.multipleSymbolizers&&a.symbolizers)for(var e=0,f=a.symbolizers.length;e<
f;++e)d=a.symbolizers[e],c=d.CLASS_NAME.split(".").pop(),this.writeNode(c+"Symbolizer",d,b);else for(var f=OpenLayers.Style.SYMBOLIZER_PREFIXES,e=0,g=f.length;e<g;++e)c=f[e],(d=a.symbolizer[c])&&this.writeNode(c+"Symbolizer",d,b);return b},ElseFilter:function(){return this.createElementNSPlus("sld:ElseFilter")},MinScaleDenominator:function(a){return this.createElementNSPlus("sld:MinScaleDenominator",{value:a})},MaxScaleDenominator:function(a){return this.createElementNSPlus("sld:MaxScaleDenominator",
{value:a})},LineSymbolizer:function(a){var b=this.createElementNSPlus("sld:LineSymbolizer");this.writeNode("Stroke",a,b);return b},Stroke:function(a){var b=this.createElementNSPlus("sld:Stroke");void 0!=a.strokeColor&&this.writeNode("CssParameter",{symbolizer:a,key:"strokeColor"},b);void 0!=a.strokeOpacity&&this.writeNode("CssParameter",{symbolizer:a,key:"strokeOpacity"},b);void 0!=a.strokeWidth&&this.writeNode("CssParameter",{symbolizer:a,key:"strokeWidth"},b);void 0!=a.strokeDashstyle&&"solid"!==
a.strokeDashstyle&&this.writeNode("CssParameter",{symbolizer:a,key:"strokeDashstyle"},b);void 0!=a.strokeLinecap&&this.writeNode("CssParameter",{symbolizer:a,key:"strokeLinecap"},b);return b},CssParameter:function(a){return this.createElementNSPlus("sld:CssParameter",{attributes:{name:this.getCssProperty(a.key)},value:a.symbolizer[a.key]})},TextSymbolizer:function(a){var b=this.createElementNSPlus("sld:TextSymbolizer");null!=a.label&&this.writeNode("Label",a.label,b);(null!=a.fontFamily||null!=a.fontSize||
null!=a.fontWeight||null!=a.fontStyle)&&this.writeNode("Font",a,b);(null!=a.labelAnchorPointX||null!=a.labelAnchorPointY||null!=a.labelAlign||null!=a.labelXOffset||null!=a.labelYOffset||null!=a.labelRotation||null!=a.labelPerpendicularOffset)&&this.writeNode("LabelPlacement",a,b);(null!=a.haloRadius||null!=a.haloColor||null!=a.haloOpacity)&&this.writeNode("Halo",a,b);(null!=a.fontColor||null!=a.fontOpacity)&&this.writeNode("Fill",{fillColor:a.fontColor,fillOpacity:a.fontOpacity},b);return b},LabelPlacement:function(a){var b=
this.createElementNSPlus("sld:LabelPlacement");(null!=a.labelAnchorPointX||null!=a.labelAnchorPointY||null!=a.labelAlign||null!=a.labelXOffset||null!=a.labelYOffset||null!=a.labelRotation)&&null==a.labelPerpendicularOffset&&this.writeNode("PointPlacement",a,b);null!=a.labelPerpendicularOffset&&this.writeNode("LinePlacement",a,b);return b},LinePlacement:function(a){var b=this.createElementNSPlus("sld:LinePlacement");this.writeNode("PerpendicularOffset",a.labelPerpendicularOffset,b);return b},PerpendicularOffset:function(a){return this.createElementNSPlus("sld:PerpendicularOffset",
{value:a})},PointPlacement:function(a){var b=this.createElementNSPlus("sld:PointPlacement");(null!=a.labelAnchorPointX||null!=a.labelAnchorPointY||null!=a.labelAlign)&&this.writeNode("AnchorPoint",a,b);(null!=a.labelXOffset||null!=a.labelYOffset)&&this.writeNode("Displacement",a,b);null!=a.labelRotation&&this.writeNode("Rotation",a.labelRotation,b);return b},AnchorPoint:function(a){var b=this.createElementNSPlus("sld:AnchorPoint"),c=a.labelAnchorPointX,d=a.labelAnchorPointY;null!=c&&this.writeNode("AnchorPointX",
c,b);null!=d&&this.writeNode("AnchorPointY",d,b);if(null==c&&null==d){var e=a.labelAlign.substr(0,1),a=a.labelAlign.substr(1,1);"l"===e?c=0:"c"===e?c=0.5:"r"===e&&(c=1);"b"===a?d=0:"m"===a?d=0.5:"t"===a&&(d=1);this.writeNode("AnchorPointX",c,b);this.writeNode("AnchorPointY",d,b)}return b},AnchorPointX:function(a){return this.createElementNSPlus("sld:AnchorPointX",{value:a})},AnchorPointY:function(a){return this.createElementNSPlus("sld:AnchorPointY",{value:a})},Displacement:function(a){var b=this.createElementNSPlus("sld:Displacement");
null!=a.labelXOffset&&this.writeNode("DisplacementX",a.labelXOffset,b);null!=a.labelYOffset&&this.writeNode("DisplacementY",a.labelYOffset,b);return b},DisplacementX:function(a){return this.createElementNSPlus("sld:DisplacementX",{value:a})},DisplacementY:function(a){return this.createElementNSPlus("sld:DisplacementY",{value:a})},Font:function(a){var b=this.createElementNSPlus("sld:Font");a.fontFamily&&this.writeNode("CssParameter",{symbolizer:a,key:"fontFamily"},b);a.fontSize&&this.writeNode("CssParameter",
{symbolizer:a,key:"fontSize"},b);a.fontWeight&&this.writeNode("CssParameter",{symbolizer:a,key:"fontWeight"},b);a.fontStyle&&this.writeNode("CssParameter",{symbolizer:a,key:"fontStyle"},b);return b},Label:function(a){return this.writers.sld._OGCExpression.call(this,"sld:Label",a)},Halo:function(a){var b=this.createElementNSPlus("sld:Halo");a.haloRadius&&this.writeNode("Radius",a.haloRadius,b);(a.haloColor||a.haloOpacity)&&this.writeNode("Fill",{fillColor:a.haloColor,fillOpacity:a.haloOpacity},b);
return b},Radius:function(a){return this.createElementNSPlus("sld:Radius",{value:a})},RasterSymbolizer:function(a){var b=this.createElementNSPlus("sld:RasterSymbolizer");a.geometry&&this.writeNode("Geometry",a.geometry,b);a.opacity&&this.writeNode("Opacity",a.opacity,b);a.colorMap&&this.writeNode("ColorMap",a.colorMap,b);return b},Geometry:function(a){var b=this.createElementNSPlus("sld:Geometry");a.property&&this.writeNode("ogc:PropertyName",a,b);return b},ColorMap:function(a){for(var b=this.createElementNSPlus("sld:ColorMap"),
c=0,d=a.length;c<d;++c)this.writeNode("ColorMapEntry",a[c],b);return b},ColorMapEntry:function(a){var b=this.createElementNSPlus("sld:ColorMapEntry");b.setAttribute("color",a.color);void 0!==a.opacity&&b.setAttribute("opacity",parseFloat(a.opacity));void 0!==a.quantity&&b.setAttribute("quantity",parseFloat(a.quantity));void 0!==a.label&&b.setAttribute("label",a.label);return b},PolygonSymbolizer:function(a){var b=this.createElementNSPlus("sld:PolygonSymbolizer");!1!==a.fill&&this.writeNode("Fill",
a,b);!1!==a.stroke&&this.writeNode("Stroke",a,b);return b},Fill:function(a){var b=this.createElementNSPlus("sld:Fill");a.fillColor&&this.writeNode("CssParameter",{symbolizer:a,key:"fillColor"},b);null!=a.fillOpacity&&this.writeNode("CssParameter",{symbolizer:a,key:"fillOpacity"},b);return b},PointSymbolizer:function(a){var b=this.createElementNSPlus("sld:PointSymbolizer");this.writeNode("Graphic",a,b);return b},Graphic:function(a){var b=this.createElementNSPlus("sld:Graphic");void 0!=a.externalGraphic?
this.writeNode("ExternalGraphic",a,b):this.writeNode("Mark",a,b);void 0!=a.graphicOpacity&&this.writeNode("Opacity",a.graphicOpacity,b);void 0!=a.pointRadius?this.writeNode("Size",2*a.pointRadius,b):void 0!=a.graphicWidth&&this.writeNode("Size",a.graphicWidth,b);void 0!=a.rotation&&this.writeNode("Rotation",a.rotation,b);return b},ExternalGraphic:function(a){var b=this.createElementNSPlus("sld:ExternalGraphic");this.writeNode("OnlineResource",a.externalGraphic,b);this.writeNode("Format",a.graphicFormat||
this.getGraphicFormat(a.externalGraphic),b);return b},Mark:function(a){var b=this.createElementNSPlus("sld:Mark");a.graphicName&&this.writeNode("WellKnownName",a.graphicName,b);!1!==a.fill&&this.writeNode("Fill",a,b);!1!==a.stroke&&this.writeNode("Stroke",a,b);return b},WellKnownName:function(a){return this.createElementNSPlus("sld:WellKnownName",{value:a})},Opacity:function(a){return this.createElementNSPlus("sld:Opacity",{value:a})},Size:function(a){return this.writers.sld._OGCExpression.call(this,
"sld:Size",a)},Rotation:function(a){return this.createElementNSPlus("sld:Rotation",{value:a})},OnlineResource:function(a){return this.createElementNSPlus("sld:OnlineResource",{attributes:{"xlink:type":"simple","xlink:href":a}})},Format:function(a){return this.createElementNSPlus("sld:Format",{value:a})}}},OpenLayers.Format.Filter.v1_0_0.prototype.writers),CLASS_NAME:"OpenLayers.Format.SLD.v1"});OpenLayers.Layer.WMS=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{service:"WMS",version:"1.1.1",request:"GetMap",styles:"",format:"image/jpeg"},isBaseLayer:!0,encodeBBOX:!1,noMagic:!1,yx:{},initialize:function(a,b,c,d){var e=[],c=OpenLayers.Util.upperCaseObject(c);1.3<=parseFloat(c.VERSION)&&!c.EXCEPTIONS&&(c.EXCEPTIONS="INIMAGE");e.push(a,b,c,d);OpenLayers.Layer.Grid.prototype.initialize.apply(this,e);OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS));
if(!this.noMagic&&this.params.TRANSPARENT&&"true"==this.params.TRANSPARENT.toString().toLowerCase()){if(null==d||!d.isBaseLayer)this.isBaseLayer=!1;"image/jpeg"==this.params.FORMAT&&(this.params.FORMAT=OpenLayers.Util.alphaHack()?"image/gif":"image/png")}},clone:function(a){null==a&&(a=new OpenLayers.Layer.WMS(this.name,this.url,this.params,this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},reverseAxisOrder:function(){var a=this.projection.getCode();return 1.3<=parseFloat(this.params.VERSION)&&
!(!this.yx[a]&&!OpenLayers.Projection.defaults[a].yx)},getURL:function(a){var a=this.adjustBounds(a),b=this.getImageSize(),c={},d=this.reverseAxisOrder();c.BBOX=this.encodeBBOX?a.toBBOX(null,d):a.toArray(d);c.WIDTH=b.w;c.HEIGHT=b.h;return this.getFullRequestString(c)},mergeNewParams:function(a){a=[OpenLayers.Util.upperCaseObject(a)];return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,a)},getFullRequestString:function(a,b){var c=this.map.getProjectionObject(),c=this.projection&&this.projection.equals(c)?
this.projection.getCode():c.getCode(),c="none"==c?null:c;1.3<=parseFloat(this.params.VERSION)?this.params.CRS=c:this.params.SRS=c;"boolean"==typeof this.params.TRANSPARENT&&(a.TRANSPARENT=this.params.TRANSPARENT?"TRUE":"FALSE");return OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)},CLASS_NAME:"OpenLayers.Layer.WMS"});OpenLayers.Format.WMC.v1_1_0=OpenLayers.Class(OpenLayers.Format.WMC.v1,{VERSION:"1.1.0",schemaLocation:"http://www.opengis.net/context http://schemas.opengis.net/context/1.1.0/context.xsd",initialize:function(a){OpenLayers.Format.WMC.v1.prototype.initialize.apply(this,[a])},read_sld_MinScaleDenominator:function(a,b){var c=parseFloat(this.getChildValue(b));0<c&&(a.maxScale=c)},read_sld_MaxScaleDenominator:function(a,b){a.minScale=parseFloat(this.getChildValue(b))},read_wmc_SRS:function(a,b){"srs"in
a||(a.srs={});a.srs[this.getChildValue(b)]=!0},write_wmc_Layer:function(a){var b=OpenLayers.Format.WMC.v1.prototype.write_wmc_Layer.apply(this,[a]);if(a.maxScale){var c=this.createElementNS(this.namespaces.sld,"sld:MinScaleDenominator");c.appendChild(this.createTextNode(a.maxScale.toPrecision(16)));b.appendChild(c)}a.minScale&&(c=this.createElementNS(this.namespaces.sld,"sld:MaxScaleDenominator"),c.appendChild(this.createTextNode(a.minScale.toPrecision(16))),b.appendChild(c));if(a.srs)for(var d in a.srs)b.appendChild(this.createElementDefaultNS("SRS",
d));b.appendChild(this.write_wmc_FormatList(a));b.appendChild(this.write_wmc_StyleList(a));a.dimensions&&b.appendChild(this.write_wmc_DimensionList(a));b.appendChild(this.write_wmc_LayerExtension(a));return b},CLASS_NAME:"OpenLayers.Format.WMC.v1_1_0"});OpenLayers.Format.XLS=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.0",stringifyOutput:!0,CLASS_NAME:"OpenLayers.Format.XLS"});OpenLayers.Format.XLS.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xls:"http://www.opengis.net/xls",gml:"http://www.opengis.net/gml",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},xy:!0,defaultPrefix:"xls",schemaLocation:null,read:function(a,b){OpenLayers.Util.applyDefaults(b,this.options);var c={};this.readChildNodes(a,c);return c},readers:{xls:{XLS:function(a,b){b.version=a.getAttribute("version");
this.readChildNodes(a,b)},Response:function(a,b){this.readChildNodes(a,b)},GeocodeResponse:function(a,b){b.responseLists=[];this.readChildNodes(a,b)},GeocodeResponseList:function(a,b){var c={features:[],numberOfGeocodedAddresses:parseInt(a.getAttribute("numberOfGeocodedAddresses"))};b.responseLists.push(c);this.readChildNodes(a,c)},GeocodedAddress:function(a,b){var c=new OpenLayers.Feature.Vector;b.features.push(c);this.readChildNodes(a,c);c.geometry=c.components[0]},GeocodeMatchCode:function(a,b){b.attributes.matchCode=
{accuracy:parseFloat(a.getAttribute("accuracy")),matchType:a.getAttribute("matchType")}},Address:function(a,b){var c={countryCode:a.getAttribute("countryCode"),addressee:a.getAttribute("addressee"),street:[],place:[]};b.attributes.address=c;this.readChildNodes(a,c)},freeFormAddress:function(a,b){b.freeFormAddress=this.getChildValue(a)},StreetAddress:function(a,b){this.readChildNodes(a,b)},Building:function(a,b){b.building={number:a.getAttribute("number"),subdivision:a.getAttribute("subdivision"),
buildingName:a.getAttribute("buildingName")}},Street:function(a,b){b.street.push(this.getChildValue(a))},Place:function(a,b){b.place[a.getAttribute("type")]=this.getChildValue(a)},PostalCode:function(a,b){b.postalCode=this.getChildValue(a)}},gml:OpenLayers.Format.GML.v3.prototype.readers.gml},write:function(a){return this.writers.xls.XLS.apply(this,[a])},writers:{xls:{XLS:function(a){var b=this.createElementNSPlus("xls:XLS",{attributes:{version:this.VERSION,"xsi:schemaLocation":this.schemaLocation}});
this.writeNode("RequestHeader",a.header,b);this.writeNode("Request",a,b);return b},RequestHeader:function(){return this.createElementNSPlus("xls:RequestHeader")},Request:function(a){var b=this.createElementNSPlus("xls:Request",{attributes:{methodName:"GeocodeRequest",requestID:a.requestID||"",version:this.VERSION}});this.writeNode("GeocodeRequest",a.addresses,b);return b},GeocodeRequest:function(a){for(var b=this.createElementNSPlus("xls:GeocodeRequest"),c=0,d=a.length;c<d;c++)this.writeNode("Address",
a[c],b);return b},Address:function(a){var b=this.createElementNSPlus("xls:Address",{attributes:{countryCode:a.countryCode}});a.freeFormAddress?this.writeNode("freeFormAddress",a.freeFormAddress,b):(a.street&&this.writeNode("StreetAddress",a,b),a.municipality&&this.writeNode("Municipality",a.municipality,b),a.countrySubdivision&&this.writeNode("CountrySubdivision",a.countrySubdivision,b),a.postalCode&&this.writeNode("PostalCode",a.postalCode,b));return b},freeFormAddress:function(a){return this.createElementNSPlus("freeFormAddress",
{value:a})},StreetAddress:function(a){var b=this.createElementNSPlus("xls:StreetAddress");a.building&&this.writeNode(b,"Building",a.building);a=a.street;OpenLayers.Util.isArray(a)||(a=[a]);for(var c=0,d=a.length;c<d;c++)this.writeNode("Street",a[c],b);return b},Building:function(a){return this.createElementNSPlus("xls:Building",{attributes:{number:a.number,subdivision:a.subdivision,buildingName:a.buildingName}})},Street:function(a){return this.createElementNSPlus("xls:Street",{value:a})},Municipality:function(a){return this.createElementNSPlus("xls:Place",
{attributes:{type:"Municipality"},value:a})},CountrySubdivision:function(a){return this.createElementNSPlus("xls:Place",{attributes:{type:"CountrySubdivision"},value:a})},PostalCode:function(a){return this.createElementNSPlus("xls:PostalCode",{value:a})}}},CLASS_NAME:"OpenLayers.Format.XLS.v1"});OpenLayers.Format.XLS.v1_1_0=OpenLayers.Class(OpenLayers.Format.XLS.v1,{VERSION:"1.1",schemaLocation:"http://www.opengis.net/xls http://schemas.opengis.net/ols/1.1.0/LocationUtilityService.xsd",CLASS_NAME:"OpenLayers.Format.XLS.v1_1_0"});OpenLayers.Format.XLS.v1_1=OpenLayers.Format.XLS.v1_1_0;OpenLayers.Renderer.SVG=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"http://www.w3.org/2000/svg",xlinkns:"http://www.w3.org/1999/xlink",MAX_PIXEL:15E3,translationParameters:null,symbolMetrics:null,initialize:function(a){this.supported()&&(OpenLayers.Renderer.Elements.prototype.initialize.apply(this,arguments),this.translationParameters={x:0,y:0},this.symbolMetrics={})},supported:function(){return document.implementation&&(document.implementation.hasFeature("org.w3c.svg","1.0")||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#SVG",
"1.1")||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"))},inValidRange:function(a,b,c){a+=c?0:this.translationParameters.x;b+=c?0:this.translationParameters.y;return a>=-this.MAX_PIXEL&&a<=this.MAX_PIXEL&&b>=-this.MAX_PIXEL&&b<=this.MAX_PIXEL},setExtent:function(a,b){var c=OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments),d=this.getResolution(),e=-a.left/d,d=a.top/d;if(b)return this.left=e,this.top=d,this.rendererRoot.setAttributeNS(null,
"viewBox","0 0 "+this.size.w+" "+this.size.h),this.translate(this.xOffset,0),!0;(e=this.translate(e-this.left+this.xOffset,d-this.top))||this.setExtent(a,!0);return c&&e},translate:function(a,b){if(this.inValidRange(a,b,!0)){var c="";if(a||b)c="translate("+a+","+b+")";this.root.setAttributeNS(null,"transform",c);this.translationParameters={x:a,y:b};return!0}return!1},setSize:function(a){OpenLayers.Renderer.prototype.setSize.apply(this,arguments);this.rendererRoot.setAttributeNS(null,"width",this.size.w);
this.rendererRoot.setAttributeNS(null,"height",this.size.h)},getNodeType:function(a,b){var c=null;switch(a.CLASS_NAME){case "OpenLayers.Geometry.Point":c=b.externalGraphic?"image":this.isComplexSymbol(b.graphicName)?"svg":"circle";break;case "OpenLayers.Geometry.Rectangle":c="rect";break;case "OpenLayers.Geometry.LineString":c="polyline";break;case "OpenLayers.Geometry.LinearRing":c="polygon";break;case "OpenLayers.Geometry.Polygon":case "OpenLayers.Geometry.Curve":c="path"}return c},setStyle:function(a,
b,c){var b=b||a._style,c=c||a._options,d=parseFloat(a.getAttributeNS(null,"r")),e=1,f;if("OpenLayers.Geometry.Point"==a._geometryClass&&d){a.style.visibility="";if(!1===b.graphic)a.style.visibility="hidden";else if(b.externalGraphic){f=this.getPosition(a);b.graphicTitle&&(a.setAttributeNS(null,"title",b.graphicTitle),d=a.getElementsByTagName("title"),0<d.length?d[0].firstChild.textContent=b.graphicTitle:(d=this.nodeFactory(null,"title"),d.textContent=b.graphicTitle,a.appendChild(d)));b.graphicWidth&&
b.graphicHeight&&a.setAttributeNS(null,"preserveAspectRatio","none");var d=b.graphicWidth||b.graphicHeight,g=b.graphicHeight||b.graphicWidth,d=d?d:2*b.pointRadius,g=g?g:2*b.pointRadius,h=void 0!=b.graphicYOffset?b.graphicYOffset:-(0.5*g),i=b.graphicOpacity||b.fillOpacity;a.setAttributeNS(null,"x",(f.x+(void 0!=b.graphicXOffset?b.graphicXOffset:-(0.5*d))).toFixed());a.setAttributeNS(null,"y",(f.y+h).toFixed());a.setAttributeNS(null,"width",d);a.setAttributeNS(null,"height",g);a.setAttributeNS(this.xlinkns,
"href",b.externalGraphic);a.setAttributeNS(null,"style","opacity: "+i);a.onclick=OpenLayers.Renderer.SVG.preventDefault}else if(this.isComplexSymbol(b.graphicName)){var d=3*b.pointRadius,g=2*d,j=this.importSymbol(b.graphicName);f=this.getPosition(a);e=3*this.symbolMetrics[j.id][0]/g;h=a.parentNode;i=a.nextSibling;h&&h.removeChild(a);a.firstChild&&a.removeChild(a.firstChild);a.appendChild(j.firstChild.cloneNode(!0));a.setAttributeNS(null,"viewBox",j.getAttributeNS(null,"viewBox"));a.setAttributeNS(null,
"width",g);a.setAttributeNS(null,"height",g);a.setAttributeNS(null,"x",f.x-d);a.setAttributeNS(null,"y",f.y-d);i?h.insertBefore(a,i):h&&h.appendChild(a)}else a.setAttributeNS(null,"r",b.pointRadius);d=b.rotation;if((void 0!==d||void 0!==a._rotation)&&f)a._rotation=d,d|=0,"svg"!==a.nodeName?a.setAttributeNS(null,"transform","rotate("+d+" "+f.x+" "+f.y+")"):(f=this.symbolMetrics[j.id],a.firstChild.setAttributeNS(null,"transform","rotate("+d+" "+f[1]+" "+f[2]+")"))}c.isFilled?(a.setAttributeNS(null,
"fill",b.fillColor),a.setAttributeNS(null,"fill-opacity",b.fillOpacity)):a.setAttributeNS(null,"fill","none");c.isStroked?(a.setAttributeNS(null,"stroke",b.strokeColor),a.setAttributeNS(null,"stroke-opacity",b.strokeOpacity),a.setAttributeNS(null,"stroke-width",b.strokeWidth*e),a.setAttributeNS(null,"stroke-linecap",b.strokeLinecap||"round"),a.setAttributeNS(null,"stroke-linejoin","round"),b.strokeDashstyle&&a.setAttributeNS(null,"stroke-dasharray",this.dashStyle(b,e))):a.setAttributeNS(null,"stroke",
"none");b.pointerEvents&&a.setAttributeNS(null,"pointer-events",b.pointerEvents);null!=b.cursor&&a.setAttributeNS(null,"cursor",b.cursor);return a},dashStyle:function(a,b){var c=a.strokeWidth*b,d=a.strokeDashstyle;switch(d){case "solid":return"none";case "dot":return[1,4*c].join();case "dash":return[4*c,4*c].join();case "dashdot":return[4*c,4*c,1,4*c].join();case "longdash":return[8*c,4*c].join();case "longdashdot":return[8*c,4*c,1,4*c].join();default:return OpenLayers.String.trim(d).replace(/\s+/g,
",")}},createNode:function(a,b){var c=document.createElementNS(this.xmlns,a);b&&c.setAttributeNS(null,"id",b);return c},nodeTypeCompare:function(a,b){return b==a.nodeName},createRenderRoot:function(){var a=this.nodeFactory(this.container.id+"_svgRoot","svg");a.style.display="block";return a},createRoot:function(a){return this.nodeFactory(this.container.id+a,"g")},createDefs:function(){var a=this.nodeFactory(this.container.id+"_defs","defs");this.rendererRoot.appendChild(a);return a},drawPoint:function(a,
b){return this.drawCircle(a,b,1)},drawCircle:function(a,b,c){var d=this.getResolution(),e=(b.x-this.featureDx)/d+this.left,b=this.top-b.y/d;return this.inValidRange(e,b)?(a.setAttributeNS(null,"cx",e),a.setAttributeNS(null,"cy",b),a.setAttributeNS(null,"r",c),a):!1},drawLineString:function(a,b){var c=this.getComponentsString(b.components);return c.path?(a.setAttributeNS(null,"points",c.path),c.complete?a:null):!1},drawLinearRing:function(a,b){var c=this.getComponentsString(b.components);return c.path?
(a.setAttributeNS(null,"points",c.path),c.complete?a:null):!1},drawPolygon:function(a,b){for(var c="",d=!0,e=!0,f,g,h=0,i=b.components.length;h<i;h++)c+=" M",f=this.getComponentsString(b.components[h].components," "),(g=f.path)?(c+=" "+g,e=f.complete&&e):d=!1;return d?(a.setAttributeNS(null,"d",c+" z"),a.setAttributeNS(null,"fill-rule","evenodd"),e?a:null):!1},drawRectangle:function(a,b){var c=this.getResolution(),d=(b.x-this.featureDx)/c+this.left,e=this.top-b.y/c;return this.inValidRange(d,e)?(a.setAttributeNS(null,
"x",d),a.setAttributeNS(null,"y",e),a.setAttributeNS(null,"width",b.width/c),a.setAttributeNS(null,"height",b.height/c),a):!1},drawText:function(a,b,c){var d=!!b.labelOutlineWidth;if(d){var e=OpenLayers.Util.extend({},b);e.fontColor=e.labelOutlineColor;e.fontStrokeColor=e.labelOutlineColor;e.fontStrokeWidth=b.labelOutlineWidth;delete e.labelOutlineWidth;this.drawText(a,e,c)}var f=this.getResolution(),e=(c.x-this.featureDx)/f+this.left,g=c.y/f-this.top,d=d?this.LABEL_OUTLINE_SUFFIX:this.LABEL_ID_SUFFIX,
f=this.nodeFactory(a+d,"text");f.setAttributeNS(null,"x",e);f.setAttributeNS(null,"y",-g);b.fontColor&&f.setAttributeNS(null,"fill",b.fontColor);b.fontStrokeColor&&f.setAttributeNS(null,"stroke",b.fontStrokeColor);b.fontStrokeWidth&&f.setAttributeNS(null,"stroke-width",b.fontStrokeWidth);b.fontOpacity&&f.setAttributeNS(null,"opacity",b.fontOpacity);b.fontFamily&&f.setAttributeNS(null,"font-family",b.fontFamily);b.fontSize&&f.setAttributeNS(null,"font-size",b.fontSize);b.fontWeight&&f.setAttributeNS(null,
"font-weight",b.fontWeight);b.fontStyle&&f.setAttributeNS(null,"font-style",b.fontStyle);!0===b.labelSelect?(f.setAttributeNS(null,"pointer-events","visible"),f._featureId=a):f.setAttributeNS(null,"pointer-events","none");g=b.labelAlign||OpenLayers.Renderer.defaultSymbolizer.labelAlign;f.setAttributeNS(null,"text-anchor",OpenLayers.Renderer.SVG.LABEL_ALIGN[g[0]]||"middle");!0===OpenLayers.IS_GECKO&&f.setAttributeNS(null,"dominant-baseline",OpenLayers.Renderer.SVG.LABEL_ALIGN[g[1]]||"central");for(var h=
b.label.split("\n"),i=h.length;f.childNodes.length>i;)f.removeChild(f.lastChild);for(var j=0;j<i;j++){var k=this.nodeFactory(a+d+"_tspan_"+j,"tspan");!0===b.labelSelect&&(k._featureId=a,k._geometry=c,k._geometryClass=c.CLASS_NAME);!1===OpenLayers.IS_GECKO&&k.setAttributeNS(null,"baseline-shift",OpenLayers.Renderer.SVG.LABEL_VSHIFT[g[1]]||"-35%");k.setAttribute("x",e);if(0==j){var l=OpenLayers.Renderer.SVG.LABEL_VFACTOR[g[1]];null==l&&(l=-0.5);k.setAttribute("dy",l*(i-1)+"em")}else k.setAttribute("dy",
"1em");k.textContent=""===h[j]?" ":h[j];k.parentNode||f.appendChild(k)}f.parentNode||this.textRoot.appendChild(f)},getComponentsString:function(a,b){for(var c=[],d=!0,e=a.length,f=[],g,h=0;h<e;h++)g=a[h],c.push(g),(g=this.getShortString(g))?f.push(g):(0<h&&this.getShortString(a[h-1])&&f.push(this.clipLine(a[h],a[h-1])),h<e-1&&this.getShortString(a[h+1])&&f.push(this.clipLine(a[h],a[h+1])),d=!1);return{path:f.join(b||","),complete:d}},clipLine:function(a,b){if(b.equals(a))return"";var c=this.getResolution(),
d=this.MAX_PIXEL-this.translationParameters.x,e=this.MAX_PIXEL-this.translationParameters.y,f=(b.x-this.featureDx)/c+this.left,g=this.top-b.y/c,h=(a.x-this.featureDx)/c+this.left,c=this.top-a.y/c,i;if(h<-d||h>d)i=(c-g)/(h-f),h=0>h?-d:d,c=g+(h-f)*i;if(c<-e||c>e)i=(h-f)/(c-g),c=0>c?-e:e,h=f+(c-g)*i;return h+","+c},getShortString:function(a){var b=this.getResolution(),c=(a.x-this.featureDx)/b+this.left,a=this.top-a.y/b;return this.inValidRange(c,a)?c+","+a:!1},getPosition:function(a){return{x:parseFloat(a.getAttributeNS(null,
"cx")),y:parseFloat(a.getAttributeNS(null,"cy"))}},importSymbol:function(a){this.defs||(this.defs=this.createDefs());var b=this.container.id+"-"+a,c=document.getElementById(b);if(null!=c)return c;var d=OpenLayers.Renderer.symbol[a];if(!d)throw Error(a+" is not a valid symbol name");var a=this.nodeFactory(b,"symbol"),e=this.nodeFactory(null,"polygon");a.appendChild(e);for(var c=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0),f=[],g,h,i=0;i<d.length;i+=2)g=d[i],h=d[i+1],c.left=Math.min(c.left,
g),c.bottom=Math.min(c.bottom,h),c.right=Math.max(c.right,g),c.top=Math.max(c.top,h),f.push(g,",",h);e.setAttributeNS(null,"points",f.join(" "));d=c.getWidth();e=c.getHeight();a.setAttributeNS(null,"viewBox",[c.left-d,c.bottom-e,3*d,3*e].join(" "));this.symbolMetrics[b]=[Math.max(d,e),c.getCenterLonLat().lon,c.getCenterLonLat().lat];this.defs.appendChild(a);return a},getFeatureIdFromEvent:function(a){var b=OpenLayers.Renderer.Elements.prototype.getFeatureIdFromEvent.apply(this,arguments);b||(b=a.target,
b=b.parentNode&&b!=this.rendererRoot?b.parentNode._featureId:void 0);return b},CLASS_NAME:"OpenLayers.Renderer.SVG"});OpenLayers.Renderer.SVG.LABEL_ALIGN={l:"start",r:"end",b:"bottom",t:"hanging"};OpenLayers.Renderer.SVG.LABEL_VSHIFT={t:"-70%",b:"0"};OpenLayers.Renderer.SVG.LABEL_VFACTOR={t:0,b:-1};OpenLayers.Renderer.SVG.preventDefault=function(a){a.preventDefault&&a.preventDefault()};OpenLayers.Format.SLD.v1_0_0=OpenLayers.Class(OpenLayers.Format.SLD.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/sld http://schemas.opengis.net/sld/1.0.0/StyledLayerDescriptor.xsd",CLASS_NAME:"OpenLayers.Format.SLD.v1_0_0"});OpenLayers.Format.OWSContext=OpenLayers.Class(OpenLayers.Format.Context,{defaultVersion:"0.3.1",getVersion:function(a,b){var c=OpenLayers.Format.XML.VersionedOGC.prototype.getVersion.apply(this,arguments);"0.3.0"===c&&(c=this.defaultVersion);return c},toContext:function(a){var b={};"OpenLayers.Map"==a.CLASS_NAME&&(b.bounds=a.getExtent(),b.maxExtent=a.maxExtent,b.projection=a.projection,b.size=a.getSize(),b.layers=a.layers);return b},CLASS_NAME:"OpenLayers.Format.OWSContext"});OpenLayers.Format.OWSContext.v0_3_1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{owc:"http://www.opengis.net/ows-context",gml:"http://www.opengis.net/gml",kml:"http://www.opengis.net/kml/2.2",ogc:"http://www.opengis.net/ogc",ows:"http://www.opengis.net/ows",sld:"http://www.opengis.net/sld",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},VERSION:"0.3.1",schemaLocation:"http://www.opengis.net/ows-context http://www.ogcnetwork.net/schemas/owc/0.3.1/owsContext.xsd",
defaultPrefix:"owc",extractAttributes:!0,xy:!0,regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},featureNS:"http://mapserver.gis.umn.edu/mapserver",featureType:"vector",geometryName:"geometry",nestingLayerLookup:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);OpenLayers.Format.GML.v2.prototype.setGeometryTypes.call(this)},setNestingPath:function(a){if(a.layersContext)for(var b=0,c=a.layersContext.length;b<c;b++){var d=
a.layersContext[b],e=[],f=a.title||"";a.metadata&&a.metadata.nestingPath&&(e=a.metadata.nestingPath.slice());""!=f&&e.push(f);d.metadata.nestingPath=e;d.layersContext&&this.setNestingPath(d)}},decomposeNestingPath:function(a){var b=[];if(OpenLayers.Util.isArray(a)){for(a=a.slice();0<a.length;)b.push(a.slice()),a.pop();b.reverse()}return b},read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&&9==a.nodeType&&(a=a.documentElement);var b={};this.readNode(a,
b);this.setNestingPath({layersContext:b.layersContext});a=[];this.processLayer(a,b);delete b.layersContext;b.layersContext=a;return b},processLayer:function(a,b){if(b.layersContext)for(var c=0,d=b.layersContext.length;c<d;c++){var e=b.layersContext[c];a.push(e);e.layersContext&&this.processLayer(a,e)}},write:function(a,b){this.nestingLayerLookup={};b=b||{};OpenLayers.Util.applyDefaults(b,a);var c=this.writeNode("OWSContext",b);this.nestingLayerLookup=null;this.setAttributeNS(c,this.namespaces.xsi,
"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[c])},readers:{kml:{Document:function(a,b){b.features=(new OpenLayers.Format.KML({kmlns:this.namespaces.kml,extractStyles:!0})).read(a)}},owc:{OWSContext:function(a,b){this.readChildNodes(a,b)},General:function(a,b){this.readChildNodes(a,b)},ResourceList:function(a,b){this.readChildNodes(a,b)},Layer:function(a,b){var c={metadata:{},visibility:"1"!=a.getAttribute("hidden"),queryable:"1"==a.getAttribute("queryable"),
opacity:null!=a.getAttribute("opacity")?parseFloat(a.getAttribute("opacity")):null,name:a.getAttribute("name"),categoryLayer:null==a.getAttribute("name"),formats:[],styles:[]};b.layersContext||(b.layersContext=[]);b.layersContext.push(c);this.readChildNodes(a,c)},InlineGeometry:function(a,b){b.features=[];var c=this.getElementsByTagNameNS(a,this.namespaces.gml,"featureMember"),d;1<=c.length&&(d=c[0]);d&&d.firstChild&&(c=d.firstChild.nextSibling?d.firstChild.nextSibling:d.firstChild,this.setNamespace("feature",
c.namespaceURI),this.featureType=c.localName||c.nodeName.split(":").pop(),this.readChildNodes(a,b))},Server:function(a,b){if(!b.service&&!b.version||b.service!=OpenLayers.Format.Context.serviceTypes.WMS)b.service=a.getAttribute("service"),b.version=a.getAttribute("version"),this.readChildNodes(a,b)},Name:function(a,b){b.name=this.getChildValue(a);this.readChildNodes(a,b)},Title:function(a,b){b.title=this.getChildValue(a);this.readChildNodes(a,b)},StyleList:function(a,b){this.readChildNodes(a,b.styles)},
Style:function(a,b){var c={};b.push(c);this.readChildNodes(a,c)},LegendURL:function(a,b){var c={};b.legend=c;this.readChildNodes(a,c)},OnlineResource:function(a,b){b.url=this.getAttributeNS(a,this.namespaces.xlink,"href");this.readChildNodes(a,b)}},ows:OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows,gml:OpenLayers.Format.GML.v2.prototype.readers.gml,sld:OpenLayers.Format.SLD.v1_0_0.prototype.readers.sld,feature:OpenLayers.Format.GML.v2.prototype.readers.feature},writers:{owc:{OWSContext:function(a){var b=
this.createElementNSPlus("OWSContext",{attributes:{version:this.VERSION,id:a.id||OpenLayers.Util.createUniqueID("OpenLayers_OWSContext_")}});this.writeNode("General",a,b);this.writeNode("ResourceList",a,b);return b},General:function(a){var b=this.createElementNSPlus("General");this.writeNode("ows:BoundingBox",a,b);this.writeNode("ows:Title",a.title||"OpenLayers OWSContext",b);return b},ResourceList:function(a){for(var b=this.createElementNSPlus("ResourceList"),c=0,d=a.layers.length;c<d;c++){var e=
a.layers[c],f=this.decomposeNestingPath(e.metadata.nestingPath);this.writeNode("_Layer",{layer:e,subPaths:f},b)}return b},Server:function(a){var b=this.createElementNSPlus("Server",{attributes:{version:a.version,service:a.service}});this.writeNode("OnlineResource",a,b);return b},OnlineResource:function(a){return this.createElementNSPlus("OnlineResource",{attributes:{"xlink:href":a.url}})},InlineGeometry:function(a){var b=this.createElementNSPlus("InlineGeometry");this.writeNode("gml:boundedBy",a.getDataExtent(),
b);for(var c=0,d=a.features.length;c<d;c++)this.writeNode("gml:featureMember",a.features[c],b);return b},StyleList:function(a){for(var b=this.createElementNSPlus("StyleList"),c=0,d=a.length;c<d;c++)this.writeNode("Style",a[c],b);return b},Style:function(a){var b=this.createElementNSPlus("Style");this.writeNode("Name",a,b);this.writeNode("Title",a,b);a.legend&&this.writeNode("LegendURL",a,b);return b},Name:function(a){return this.createElementNSPlus("Name",{value:a.name})},Title:function(a){return this.createElementNSPlus("Title",
{value:a.title})},LegendURL:function(a){var b=this.createElementNSPlus("LegendURL");this.writeNode("OnlineResource",a.legend,b);return b},_WMS:function(a){var b=this.createElementNSPlus("Layer",{attributes:{name:a.params.LAYERS,queryable:a.queryable?"1":"0",hidden:a.visibility?"0":"1",opacity:a.hasOwnProperty("opacity")?a.opacity:null}});this.writeNode("ows:Title",a.name,b);this.writeNode("ows:OutputFormat",a.params.FORMAT,b);this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.WMS,
version:a.params.VERSION,url:a.url},b);a.metadata.styles&&0<a.metadata.styles.length&&this.writeNode("StyleList",a.metadata.styles,b);return b},_Layer:function(a){var b,c,d;b=a.layer;c=a.subPaths;d=null;0<c.length?(b=c[0].join("/"),c=b.lastIndexOf("/"),d=this.nestingLayerLookup[b],c=0<c?b.substring(c+1,b.length):b,d||(d=this.createElementNSPlus("Layer"),this.writeNode("ows:Title",c,d),this.nestingLayerLookup[b]=d),a.subPaths.shift(),this.writeNode("_Layer",a,d)):(b instanceof OpenLayers.Layer.WMS?
d=this.writeNode("_WMS",b):b instanceof OpenLayers.Layer.Vector&&(b.protocol instanceof OpenLayers.Protocol.WFS.v1?d=this.writeNode("_WFS",b):b.protocol instanceof OpenLayers.Protocol.HTTP?b.protocol.format instanceof OpenLayers.Format.GML?(b.protocol.format.version="2.1.2",d=this.writeNode("_GML",b)):b.protocol.format instanceof OpenLayers.Format.KML&&(b.protocol.format.version="2.2",d=this.writeNode("_KML",b)):(this.setNamespace("feature",this.featureNS),d=this.writeNode("_InlineGeometry",b))),
b.options.maxScale&&this.writeNode("sld:MinScaleDenominator",b.options.maxScale,d),b.options.minScale&&this.writeNode("sld:MaxScaleDenominator",b.options.minScale,d),this.nestingLayerLookup[b.name]=d);return d},_WFS:function(a){var b=this.createElementNSPlus("Layer",{attributes:{name:a.protocol.featurePrefix+":"+a.protocol.featureType,hidden:a.visibility?"0":"1"}});this.writeNode("ows:Title",a.name,b);this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.WFS,version:a.protocol.version,
url:a.protocol.url},b);return b},_InlineGeometry:function(a){var b=this.createElementNSPlus("Layer",{attributes:{name:this.featureType,hidden:a.visibility?"0":"1"}});this.writeNode("ows:Title",a.name,b);this.writeNode("InlineGeometry",a,b);return b},_GML:function(a){var b=this.createElementNSPlus("Layer");this.writeNode("ows:Title",a.name,b);this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.GML,url:a.protocol.url,version:a.protocol.format.version},b);return b},_KML:function(a){var b=
this.createElementNSPlus("Layer");this.writeNode("ows:Title",a.name,b);this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.KML,version:a.protocol.format.version,url:a.protocol.url},b);return b}},gml:OpenLayers.Util.applyDefaults({boundedBy:function(a){var b=this.createElementNSPlus("gml:boundedBy");this.writeNode("gml:Box",a,b);return b}},OpenLayers.Format.GML.v2.prototype.writers.gml),ows:OpenLayers.Format.OWSCommon.v1_0_0.prototype.writers.ows,sld:OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld,
feature:OpenLayers.Format.GML.v2.prototype.writers.feature},CLASS_NAME:"OpenLayers.Format.OWSContext.v0_3_1"});OpenLayers.Control.ScaleLine=OpenLayers.Class(OpenLayers.Control,{maxWidth:100,topOutUnits:"km",topInUnits:"m",bottomOutUnits:"mi",bottomInUnits:"ft",eTop:null,eBottom:null,geodesic:!1,draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.eTop||(this.eTop=document.createElement("div"),this.eTop.className=this.displayClass+"Top",this.div.appendChild(this.eTop),this.eTop.style.visibility=""==this.topOutUnits||""==this.topInUnits?"hidden":"visible",this.eBottom=document.createElement("div"),
this.eBottom.className=this.displayClass+"Bottom",this.div.appendChild(this.eBottom),this.eBottom.style.visibility=""==this.bottomOutUnits||""==this.bottomInUnits?"hidden":"visible");this.map.events.register("moveend",this,this.update);this.update();return this.div},getBarLen:function(a){var b=parseInt(Math.log(a)/Math.log(10)),b=Math.pow(10,b),a=parseInt(a/b);return(5<a?5:2<a?2:1)*b},update:function(){var a=this.map.getResolution();if(a){var b=this.map.getUnits(),c=OpenLayers.INCHES_PER_UNIT,d=this.maxWidth*
a*c[b],e=1;!0===this.geodesic&&(e=(this.map.getGeodesicPixelSize().w||1.0E-6)*this.maxWidth/(d/c.km),d*=e);var f,g;1E5<d?(f=this.topOutUnits,g=this.bottomOutUnits):(f=this.topInUnits,g=this.bottomInUnits);var h=d/c[f],i=d/c[g],d=this.getBarLen(h),j=this.getBarLen(i),h=d/c[b]*c[f],i=j/c[b]*c[g],b=h/a/e,a=i/a/e;"visible"==this.eBottom.style.visibility&&(this.eBottom.style.width=Math.round(a)+"px",this.eBottom.innerHTML=j+" "+g);"visible"==this.eTop.style.visibility&&(this.eTop.style.width=Math.round(b)+
"px",this.eTop.innerHTML=d+" "+f)}},CLASS_NAME:"OpenLayers.Control.ScaleLine"});OpenLayers.Icon=OpenLayers.Class({url:null,size:null,offset:null,calculateOffset:null,imageDiv:null,px:null,initialize:function(a,b,c,d){this.url=a;this.size=b||{w:20,h:20};this.offset=c||{x:-(this.size.w/2),y:-(this.size.h/2)};this.calculateOffset=d;a=OpenLayers.Util.createUniqueID("OL_Icon_");this.imageDiv=OpenLayers.Util.createAlphaImageDiv(a)},destroy:function(){this.erase();OpenLayers.Event.stopObservingElement(this.imageDiv.firstChild);this.imageDiv.innerHTML="";this.imageDiv=null},clone:function(){return new OpenLayers.Icon(this.url,
this.size,this.offset,this.calculateOffset)},setSize:function(a){null!=a&&(this.size=a);this.draw()},setUrl:function(a){null!=a&&(this.url=a);this.draw()},draw:function(a){OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,null,this.size,this.url,"absolute");this.moveTo(a);return this.imageDiv},erase:function(){null!=this.imageDiv&&null!=this.imageDiv.parentNode&&OpenLayers.Element.remove(this.imageDiv)},setOpacity:function(a){OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,null,null,null,
null,null,null,a)},moveTo:function(a){null!=a&&(this.px=a);null!=this.imageDiv&&(null==this.px?this.display(!1):(this.calculateOffset&&(this.offset=this.calculateOffset(this.size)),OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,{x:this.px.x+this.offset.x,y:this.px.y+this.offset.y})))},display:function(a){this.imageDiv.style.display=a?"":"none"},isDrawn:function(){return this.imageDiv&&this.imageDiv.parentNode&&11!=this.imageDiv.parentNode.nodeType},CLASS_NAME:"OpenLayers.Icon"});OpenLayers.Marker=OpenLayers.Class({icon:null,lonlat:null,events:null,map:null,initialize:function(a,b){this.lonlat=a;var c=b?b:OpenLayers.Marker.defaultIcon();null==this.icon?this.icon=c:(this.icon.url=c.url,this.icon.size=c.size,this.icon.offset=c.offset,this.icon.calculateOffset=c.calculateOffset);this.events=new OpenLayers.Events(this,this.icon.imageDiv)},destroy:function(){this.erase();this.map=null;this.events.destroy();this.events=null;null!=this.icon&&(this.icon.destroy(),this.icon=null)},
draw:function(a){return this.icon.draw(a)},erase:function(){null!=this.icon&&this.icon.erase()},moveTo:function(a){null!=a&&null!=this.icon&&this.icon.moveTo(a);this.lonlat=this.map.getLonLatFromLayerPx(a)},isDrawn:function(){return this.icon&&this.icon.isDrawn()},onScreen:function(){var a=!1;this.map&&(a=this.map.getExtent().containsLonLat(this.lonlat));return a},inflate:function(a){this.icon&&this.icon.setSize({w:this.icon.size.w*a,h:this.icon.size.h*a})},setOpacity:function(a){this.icon.setOpacity(a)},
setUrl:function(a){this.icon.setUrl(a)},display:function(a){this.icon.display(a)},CLASS_NAME:"OpenLayers.Marker"});OpenLayers.Marker.defaultIcon=function(){return new OpenLayers.Icon(OpenLayers.Util.getImageLocation("marker.png"),{w:21,h:25},{x:-10.5,y:-25})};OpenLayers.Layer.TileCache=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,format:"image/png",serverResolutions:null,initialize:function(a,b,c,d){this.layername=c;OpenLayers.Layer.Grid.prototype.initialize.apply(this,[a,b,{},d]);this.extension=this.format.split("/")[1].toLowerCase();this.extension="jpg"==this.extension?"jpeg":this.extension},clone:function(a){null==a&&(a=new OpenLayers.Layer.TileCache(this.name,this.url,this.layername,this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,
[a])},getURL:function(a){function b(a,b){for(var a=""+a,c=[],d=0;d<b;++d)c.push("0");return c.join("").substring(0,b-a.length)+a}var c=this.getServerResolution(),d=this.maxExtent,e=this.tileSize,f=Math.round((a.left-d.left)/(c*e.w)),a=Math.round((a.bottom-d.bottom)/(c*e.h)),c=null!=this.serverResolutions?OpenLayers.Util.indexOf(this.serverResolutions,c):this.map.getZoom(),f=[this.layername,b(c,2),b(parseInt(f/1E6),3),b(parseInt(f/1E3)%1E3,3),b(parseInt(f)%1E3,3),b(parseInt(a/1E6),3),b(parseInt(a/
1E3)%1E3,3),b(parseInt(a)%1E3,3)+"."+this.extension].join("/"),c=this.url;OpenLayers.Util.isArray(c)&&(c=this.selectUrl(f,c));c="/"==c.charAt(c.length-1)?c:c+"/";return c+f},CLASS_NAME:"OpenLayers.Layer.TileCache"});OpenLayers.Layer.KaMap=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,DEFAULT_PARAMS:{i:"jpeg",map:""},initialize:function(a,b,c,d){OpenLayers.Layer.Grid.prototype.initialize.apply(this,arguments);this.params=OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS)},getURL:function(a){var a=this.adjustBounds(a),b=this.map.getResolution(),c=Math.round(1E4*this.map.getScale())/1E4,d=Math.round(a.left/b);return this.getFullRequestString({t:-Math.round(a.top/b),l:d,s:c})},calculateGridLayout:function(a,
b,c){var b=c*this.tileSize.w,c=c*this.tileSize.h,d=a.left,e=Math.floor(d/b)-this.buffer,d=-(d/b-e)*this.tileSize.w,e=e*b,a=a.top,f=Math.ceil(a/c)+this.buffer;return{tilelon:b,tilelat:c,tileoffsetlon:e,tileoffsetlat:f*c,tileoffsetx:d,tileoffsety:-(f-a/c+1)*this.tileSize.h}},clone:function(a){null==a&&(a=new OpenLayers.Layer.KaMap(this.name,this.url,this.params,this.getOptions()));a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a]);null!=this.tileSize&&(a.tileSize=this.tileSize.clone());a.grid=
[];return a},getTileBounds:function(a){var b=this.getResolution(),c=b*this.tileSize.w,b=b*this.tileSize.h,d=this.getLonLatFromViewPortPx(a),a=c*Math.floor(d.lon/c),d=b*Math.floor(d.lat/b);return new OpenLayers.Bounds(a,d,a+c,d+b)},CLASS_NAME:"OpenLayers.Layer.KaMap"});OpenLayers.Control.TransformFeature=OpenLayers.Class(OpenLayers.Control,{geometryTypes:null,layer:null,preserveAspectRatio:!1,rotate:!0,feature:null,renderIntent:"temporary",rotationHandleSymbolizer:null,box:null,center:null,scale:1,ratio:1,rotation:0,handles:null,rotationHandles:null,dragControl:null,irregular:!1,initialize:function(a,b){OpenLayers.Control.prototype.initialize.apply(this,[b]);this.layer=a;this.rotationHandleSymbolizer||(this.rotationHandleSymbolizer={stroke:!1,pointRadius:10,fillOpacity:0,
cursor:"pointer"});this.createBox();this.createControl()},activate:function(){var a=!1;OpenLayers.Control.prototype.activate.apply(this,arguments)&&(this.dragControl.activate(),this.layer.addFeatures([this.box]),this.rotate&&this.layer.addFeatures(this.rotationHandles),this.layer.addFeatures(this.handles),a=!0);return a},deactivate:function(){var a=!1;OpenLayers.Control.prototype.deactivate.apply(this,arguments)&&(this.layer.removeFeatures(this.handles),this.rotate&&this.layer.removeFeatures(this.rotationHandles),
this.layer.removeFeatures([this.box]),this.dragControl.deactivate(),a=!0);return a},setMap:function(a){this.dragControl.setMap(a);OpenLayers.Control.prototype.setMap.apply(this,arguments)},setFeature:function(a,b){var b=OpenLayers.Util.applyDefaults(b,{rotation:0,scale:1,ratio:1}),c=this.rotation,d=this.center;OpenLayers.Util.extend(this,b);if(!1!==this.events.triggerEvent("beforesetfeature",{feature:a})){this.feature=a;this.activate();this._setfeature=!0;var e=this.feature.geometry.getBounds();this.box.move(e.getCenterLonLat());
this.box.geometry.rotate(-c,d);this._angle=0;this.rotation?(c=a.geometry.clone(),c.rotate(-this.rotation,this.center),c=new OpenLayers.Feature.Vector(c.getBounds().toGeometry()),c.geometry.rotate(this.rotation,this.center),this.box.geometry.rotate(this.rotation,this.center),this.box.move(c.geometry.getBounds().getCenterLonLat()),c=c.geometry.components[0].components[0].getBounds().getCenterLonLat()):c=new OpenLayers.LonLat(e.left,e.bottom);this.handles[0].move(c);delete this._setfeature;this.events.triggerEvent("setfeature",
{feature:a})}},unsetFeature:function(){this.active?this.deactivate():(this.feature=null,this.rotation=0,this.ratio=this.scale=1)},createBox:function(){var a=this;this.center=new OpenLayers.Geometry.Point(0,0);this.box=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([new OpenLayers.Geometry.Point(-1,-1),new OpenLayers.Geometry.Point(0,-1),new OpenLayers.Geometry.Point(1,-1),new OpenLayers.Geometry.Point(1,0),new OpenLayers.Geometry.Point(1,1),new OpenLayers.Geometry.Point(0,1),new OpenLayers.Geometry.Point(-1,
1),new OpenLayers.Geometry.Point(-1,0),new OpenLayers.Geometry.Point(-1,-1)]),null,"string"==typeof this.renderIntent?null:this.renderIntent);this.box.geometry.move=function(b,c){a._moving=!0;OpenLayers.Geometry.LineString.prototype.move.apply(this,arguments);a.center.move(b,c);delete a._moving};for(var b=function(a,b){OpenLayers.Geometry.Point.prototype.move.apply(this,arguments);this._rotationHandle&&this._rotationHandle.geometry.move(a,b);this._handle.geometry.move(a,b)},c=function(a,b,c){OpenLayers.Geometry.Point.prototype.resize.apply(this,
arguments);this._rotationHandle&&this._rotationHandle.geometry.resize(a,b,c);this._handle.geometry.resize(a,b,c)},d=function(a,b){OpenLayers.Geometry.Point.prototype.rotate.apply(this,arguments);this._rotationHandle&&this._rotationHandle.geometry.rotate(a,b);this._handle.geometry.rotate(a,b)},e=function(b,c){var d=this.x,e=this.y;OpenLayers.Geometry.Point.prototype.move.call(this,b,c);if(!a._moving){var f=a.dragControl.handlers.drag.evt,g=!(!a._setfeature&&a.preserveAspectRatio)&&!(f&&f.shiftKey),
h=new OpenLayers.Geometry.Point(d,e),f=a.center;this.rotate(-a.rotation,f);h.rotate(-a.rotation,f);var i=this.x-f.x,j=this.y-f.y,k=i-(this.x-h.x),l=j-(this.y-h.y);a.irregular&&!a._setfeature&&(i-=(this.x-h.x)/2,j-=(this.y-h.y)/2);this.x=d;this.y=e;h=1;g?(j=1.0E-5>Math.abs(l)?1:j/l,h=(1.0E-5>Math.abs(k)?1:i/k)/j):(k=Math.sqrt(k*k+l*l),j=Math.sqrt(i*i+j*j)/k);a._moving=!0;a.box.geometry.rotate(-a.rotation,f);delete a._moving;a.box.geometry.resize(j,f,h);a.box.geometry.rotate(a.rotation,f);a.transformFeature({scale:j,
ratio:h});a.irregular&&!a._setfeature&&(i=f.clone(),i.x+=1.0E-5>Math.abs(d-f.x)?0:this.x-d,i.y+=1.0E-5>Math.abs(e-f.y)?0:this.y-e,a.box.geometry.move(this.x-d,this.y-e),a.transformFeature({center:i}))}},f=function(b,c){var d=this.x,e=this.y;OpenLayers.Geometry.Point.prototype.move.call(this,b,c);if(!a._moving){var f=a.dragControl.handlers.drag.evt,f=f&&f.shiftKey?45:1,g=a.center,h=this.x-g.x,i=this.y-g.y;this.x=d;this.y=e;d=Math.atan2(i-c,h-b);d=Math.atan2(i,h)-d;d*=180/Math.PI;a._angle=(a._angle+
d)%360;d=a.rotation%f;if(Math.abs(a._angle)>=f||0!==d)d=Math.round(a._angle/f)*f-d,a._angle=0,a.box.geometry.rotate(d,g),a.transformFeature({rotation:d})}},g=Array(8),h=Array(4),i,j,k,l="sw s se e ne n nw w".split(" "),m=0;8>m;++m)i=this.box.geometry.components[m],j=new OpenLayers.Feature.Vector(i.clone(),{role:l[m]+"-resize"},"string"==typeof this.renderIntent?null:this.renderIntent),0==m%2&&(k=new OpenLayers.Feature.Vector(i.clone(),{role:l[m]+"-rotate"},"string"==typeof this.rotationHandleSymbolizer?
null:this.rotationHandleSymbolizer),k.geometry.move=f,i._rotationHandle=k,h[m/2]=k),i.move=b,i.resize=c,i.rotate=d,j.geometry.move=e,i._handle=j,g[m]=j;this.rotationHandles=h;this.handles=g},createControl:function(){var a=this;this.dragControl=new OpenLayers.Control.DragFeature(this.layer,{documentDrag:!0,moveFeature:function(b){this.feature===a.feature&&(this.feature=a.box);OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},onDrag:function(b){b===a.box&&a.transformFeature({center:a.center})},
onStart:function(b){var c=!a.geometryTypes||-1!==OpenLayers.Util.indexOf(a.geometryTypes,b.geometry.CLASS_NAME),d=OpenLayers.Util.indexOf(a.handles,b),d=d+OpenLayers.Util.indexOf(a.rotationHandles,b);b!==a.feature&&(b!==a.box&&-2==d&&c)&&a.setFeature(b)},onComplete:function(){a.events.triggerEvent("transformcomplete",{feature:a.feature})}})},drawHandles:function(){for(var a=this.layer,b=0;8>b;++b)this.rotate&&0===b%2&&a.drawFeature(this.rotationHandles[b/2],this.rotationHandleSymbolizer),a.drawFeature(this.handles[b],
this.renderIntent)},transformFeature:function(a){if(!this._setfeature){this.scale*=a.scale||1;this.ratio*=a.ratio||1;var b=this.rotation;this.rotation=(this.rotation+(a.rotation||0))%360;if(!1!==this.events.triggerEvent("beforetransform",a)){var c=this.feature,d=c.geometry,e=this.center;d.rotate(-b,e);a.scale||a.ratio?d.resize(a.scale,e,a.ratio):a.center&&c.move(a.center.getBounds().getCenterLonLat());d.rotate(this.rotation,e);this.layer.drawFeature(c);c.toState(OpenLayers.State.UPDATE);this.events.triggerEvent("transform",
a)}}this.layer.drawFeature(this.box,this.renderIntent);this.drawHandles()},destroy:function(){for(var a,b=0;8>b;++b)a=this.box.geometry.components[b],a._handle.destroy(),a._handle=null,a._rotationHandle&&a._rotationHandle.destroy(),a._rotationHandle=null;this.rotationHandles=this.rotationHandleSymbolizer=this.handles=this.feature=this.center=null;this.box.destroy();this.layer=this.box=null;this.dragControl.destroy();this.dragControl=null;OpenLayers.Control.prototype.destroy.apply(this,arguments)},
CLASS_NAME:"OpenLayers.Control.TransformFeature"});OpenLayers.Handler.Box=OpenLayers.Class(OpenLayers.Handler,{dragHandler:null,boxDivClassName:"olHandlerBoxZoomBox",boxOffsets:null,initialize:function(a,b,c){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.dragHandler=new OpenLayers.Handler.Drag(this,{down:this.startBox,move:this.moveBox,out:this.removeBox,up:this.endBox},{keyMask:this.keyMask})},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments);this.dragHandler&&(this.dragHandler.destroy(),this.dragHandler=
null)},setMap:function(a){OpenLayers.Handler.prototype.setMap.apply(this,arguments);this.dragHandler&&this.dragHandler.setMap(a)},startBox:function(){this.callback("start",[]);this.zoomBox=OpenLayers.Util.createDiv("zoomBox",{x:-9999,y:-9999});this.zoomBox.className=this.boxDivClassName;this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1;this.map.viewPortDiv.appendChild(this.zoomBox);OpenLayers.Element.addClass(this.map.viewPortDiv,"olDrawBox")},moveBox:function(a){var b=this.dragHandler.start.x,
c=this.dragHandler.start.y,d=Math.abs(b-a.x),e=Math.abs(c-a.y),f=this.getBoxOffsets();this.zoomBox.style.width=d+f.width+1+"px";this.zoomBox.style.height=e+f.height+1+"px";this.zoomBox.style.left=(a.x<b?b-d-f.left:b-f.left)+"px";this.zoomBox.style.top=(a.y<c?c-e-f.top:c-f.top)+"px"},endBox:function(a){var b;if(5<Math.abs(this.dragHandler.start.x-a.x)||5<Math.abs(this.dragHandler.start.y-a.y)){var c=this.dragHandler.start;b=Math.min(c.y,a.y);var d=Math.max(c.y,a.y),e=Math.min(c.x,a.x),a=Math.max(c.x,
a.x);b=new OpenLayers.Bounds(e,d,a,b)}else b=this.dragHandler.start.clone();this.removeBox();this.callback("done",[b])},removeBox:function(){this.map.viewPortDiv.removeChild(this.zoomBox);this.boxOffsets=this.zoomBox=null;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDrawBox")},activate:function(){return OpenLayers.Handler.prototype.activate.apply(this,arguments)?(this.dragHandler.activate(),!0):!1},deactivate:function(){return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)?
(this.dragHandler.deactivate()&&this.zoomBox&&this.removeBox(),!0):!1},getBoxOffsets:function(){if(!this.boxOffsets){var a=document.createElement("div");a.style.position="absolute";a.style.border="1px solid black";a.style.width="3px";document.body.appendChild(a);var b=3==a.clientWidth;document.body.removeChild(a);var a=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-left-width")),c=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-right-width")),d=parseInt(OpenLayers.Element.getStyle(this.zoomBox,
"border-top-width")),e=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-bottom-width"));this.boxOffsets={left:a,right:c,top:d,bottom:e,width:!1===b?a+c:0,height:!1===b?d+e:0}}return this.boxOffsets},CLASS_NAME:"OpenLayers.Handler.Box"});OpenLayers.Control.ZoomBox=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,out:!1,keyMask:null,alwaysZoom:!1,draw:function(){this.handler=new OpenLayers.Handler.Box(this,{done:this.zoomBox},{keyMask:this.keyMask})},zoomBox:function(a){if(a instanceof OpenLayers.Bounds){var b;if(this.out){b=Math.abs(a.right-a.left);var c=Math.abs(a.top-a.bottom);b=Math.min(this.map.size.h/c,this.map.size.w/b);var c=this.map.getExtent(),d=this.map.getLonLatFromPixel(a.getCenterPixel()),a=d.lon-
c.getWidth()/2*b,e=d.lon+c.getWidth()/2*b,f=d.lat-c.getHeight()/2*b;b=d.lat+c.getHeight()/2*b;b=new OpenLayers.Bounds(a,f,e,b)}else b=this.map.getLonLatFromPixel({x:a.left,y:a.bottom}),c=this.map.getLonLatFromPixel({x:a.right,y:a.top}),b=new OpenLayers.Bounds(b.lon,b.lat,c.lon,c.lat);c=this.map.getZoom();this.map.zoomToExtent(b);c==this.map.getZoom()&&!0==this.alwaysZoom&&this.map.zoomTo(c+(this.out?-1:1))}else this.out?this.map.setCenter(this.map.getLonLatFromPixel(a),this.map.getZoom()-1):this.map.setCenter(this.map.getLonLatFromPixel(a),
this.map.getZoom()+1)},CLASS_NAME:"OpenLayers.Control.ZoomBox"});OpenLayers.Control.DragPan=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,panned:!1,interval:1,documentDrag:!1,kinetic:null,enableKinetic:!1,kineticInterval:10,draw:function(){if(this.enableKinetic){var a={interval:this.kineticInterval};"object"===typeof this.enableKinetic&&(a=OpenLayers.Util.extend(a,this.enableKinetic));this.kinetic=new OpenLayers.Kinetic(a)}this.handler=new OpenLayers.Handler.Drag(this,{move:this.panMap,done:this.panMapDone,down:this.panMapStart},{interval:this.interval,
documentDrag:this.documentDrag})},panMapStart:function(){this.kinetic&&this.kinetic.begin()},panMap:function(a){this.kinetic&&this.kinetic.update(a);this.panned=!0;this.map.pan(this.handler.last.x-a.x,this.handler.last.y-a.y,{dragging:!0,animate:!1})},panMapDone:function(a){if(this.panned){var b=null;this.kinetic&&(b=this.kinetic.end(a));this.map.pan(this.handler.last.x-a.x,this.handler.last.y-a.y,{dragging:!!b,animate:!1});if(b){var c=this;this.kinetic.move(b,function(a,b,f){c.map.pan(a,b,{dragging:!f,
animate:!1})})}this.panned=!1}},CLASS_NAME:"OpenLayers.Control.DragPan"});OpenLayers.Handler.Click=OpenLayers.Class(OpenLayers.Handler,{delay:300,single:!0,"double":!1,pixelTolerance:0,dblclickTolerance:13,stopSingle:!1,stopDouble:!1,timerId:null,touch:!1,down:null,last:null,first:null,rightclickTimerId:null,touchstart:function(a){this.touch||(this.unregisterMouseListeners(),this.touch=!0);this.down=this.getEventInfo(a);this.last=this.getEventInfo(a);return!0},touchmove:function(a){this.last=this.getEventInfo(a);return!0},touchend:function(a){this.down&&(a.xy=this.last.xy,
a.lastTouches=this.last.touches,this.handleSingle(a),this.down=null);return!0},unregisterMouseListeners:function(){this.map.events.un({mousedown:this.mousedown,mouseup:this.mouseup,click:this.click,dblclick:this.dblclick,scope:this})},mousedown:function(a){this.down=this.getEventInfo(a);this.last=this.getEventInfo(a);return!0},mouseup:function(a){var b=!0;this.checkModifiers(a)&&(this.control.handleRightClicks&&OpenLayers.Event.isRightClick(a))&&(b=this.rightclick(a));return b},rightclick:function(a){if(this.passesTolerance(a)){if(null!=
this.rightclickTimerId)return this.clearTimer(),this.callback("dblrightclick",[a]),!this.stopDouble;a=this["double"]?OpenLayers.Util.extend({},a):this.callback("rightclick",[a]);a=OpenLayers.Function.bind(this.delayedRightCall,this,a);this.rightclickTimerId=window.setTimeout(a,this.delay)}return!this.stopSingle},delayedRightCall:function(a){this.rightclickTimerId=null;a&&this.callback("rightclick",[a])},click:function(a){this.last||(this.last=this.getEventInfo(a));this.handleSingle(a);return!this.stopSingle},
dblclick:function(a){this.handleDouble(a);return!this.stopDouble},handleDouble:function(a){this.passesDblclickTolerance(a)&&(this["double"]&&this.callback("dblclick",[a]),this.clearTimer())},handleSingle:function(a){this.passesTolerance(a)&&(null!=this.timerId?(this.last.touches&&1===this.last.touches.length&&(this["double"]&&OpenLayers.Event.stop(a),this.handleDouble(a)),(!this.last.touches||2!==this.last.touches.length)&&this.clearTimer()):(this.first=this.getEventInfo(a),this.queuePotentialClick(this.single?
OpenLayers.Util.extend({},a):null)))},queuePotentialClick:function(a){this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall,this,a),this.delay)},passesTolerance:function(a){var b=!0;if(null!=this.pixelTolerance&&this.down&&this.down.xy&&(b=this.pixelTolerance>=this.down.xy.distanceTo(a.xy))&&this.touch&&this.down.touches.length===this.last.touches.length)for(var a=0,c=this.down.touches.length;a<c;++a)if(this.getTouchDistance(this.down.touches[a],this.last.touches[a])>this.pixelTolerance){b=
!1;break}return b},getTouchDistance:function(a,b){return Math.sqrt(Math.pow(a.clientX-b.clientX,2)+Math.pow(a.clientY-b.clientY,2))},passesDblclickTolerance:function(){var a=!0;this.down&&this.first&&(a=this.down.xy.distanceTo(this.first.xy)<=this.dblclickTolerance);return a},clearTimer:function(){null!=this.timerId&&(window.clearTimeout(this.timerId),this.timerId=null);null!=this.rightclickTimerId&&(window.clearTimeout(this.rightclickTimerId),this.rightclickTimerId=null)},delayedCall:function(a){this.timerId=
null;a&&this.callback("click",[a])},getEventInfo:function(a){var b;if(a.touches){var c=a.touches.length;b=Array(c);for(var d,e=0;e<c;e++)d=a.touches[e],b[e]={clientX:d.clientX,clientY:d.clientY}}return{xy:a.xy,touches:b}},deactivate:function(){var a=!1;OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.clearTimer(),this.last=this.first=this.down=null,this.touch=!1,a=!0);return a},CLASS_NAME:"OpenLayers.Handler.Click"});OpenLayers.Control.Navigation=OpenLayers.Class(OpenLayers.Control,{dragPan:null,dragPanOptions:null,pinchZoom:null,pinchZoomOptions:null,documentDrag:!1,zoomBox:null,zoomBoxEnabled:!0,zoomWheelEnabled:!0,mouseWheelOptions:null,handleRightClicks:!1,zoomBoxKeyMask:OpenLayers.Handler.MOD_SHIFT,autoActivate:!0,initialize:function(a){this.handlers={};OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.deactivate();this.dragPan&&this.dragPan.destroy();this.dragPan=null;
this.zoomBox&&this.zoomBox.destroy();this.zoomBox=null;this.pinchZoom&&this.pinchZoom.destroy();this.pinchZoom=null;OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){this.dragPan.activate();this.zoomWheelEnabled&&this.handlers.wheel.activate();this.handlers.click.activate();this.zoomBoxEnabled&&this.zoomBox.activate();this.pinchZoom&&this.pinchZoom.activate();return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){this.pinchZoom&&this.pinchZoom.deactivate();
this.zoomBox.deactivate();this.dragPan.deactivate();this.handlers.click.deactivate();this.handlers.wheel.deactivate();return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},draw:function(){this.handleRightClicks&&(this.map.viewPortDiv.oncontextmenu=OpenLayers.Function.False);this.handlers.click=new OpenLayers.Handler.Click(this,{click:this.defaultClick,dblclick:this.defaultDblClick,dblrightclick:this.defaultDblRightClick},{"double":!0,stopDouble:!0});this.dragPan=new OpenLayers.Control.DragPan(OpenLayers.Util.extend({map:this.map,
documentDrag:this.documentDrag},this.dragPanOptions));this.zoomBox=new OpenLayers.Control.ZoomBox({map:this.map,keyMask:this.zoomBoxKeyMask});this.dragPan.draw();this.zoomBox.draw();this.handlers.wheel=new OpenLayers.Handler.MouseWheel(this,{up:this.wheelUp,down:this.wheelDown},this.mouseWheelOptions);OpenLayers.Control.PinchZoom&&(this.pinchZoom=new OpenLayers.Control.PinchZoom(OpenLayers.Util.extend({map:this.map},this.pinchZoomOptions)))},defaultClick:function(a){a.lastTouches&&2==a.lastTouches.length&&
this.map.zoomOut()},defaultDblClick:function(a){this.map.setCenter(this.map.getLonLatFromViewPortPx(a.xy),this.map.zoom+1)},defaultDblRightClick:function(a){this.map.setCenter(this.map.getLonLatFromViewPortPx(a.xy),this.map.zoom-1)},wheelChange:function(a,b){var c=this.map.getZoom(),d=this.map.getZoom()+Math.round(b),d=Math.max(d,0),d=Math.min(d,this.map.getNumZoomLevels());if(d!==c){var e=this.map.getSize(),c=e.w/2-a.xy.x,e=a.xy.y-e.h/2,f=this.map.baseLayer.getResolutionForZoom(d),g=this.map.getLonLatFromPixel(a.xy);
this.map.setCenter(new OpenLayers.LonLat(g.lon+c*f,g.lat+e*f),d)}},wheelUp:function(a,b){this.wheelChange(a,b||1)},wheelDown:function(a,b){this.wheelChange(a,b||-1)},disableZoomBox:function(){this.zoomBoxEnabled=!1;this.zoomBox.deactivate()},enableZoomBox:function(){this.zoomBoxEnabled=!0;this.active&&this.zoomBox.activate()},disableZoomWheel:function(){this.zoomWheelEnabled=!1;this.handlers.wheel.deactivate()},enableZoomWheel:function(){this.zoomWheelEnabled=!0;this.active&&this.handlers.wheel.activate()},
CLASS_NAME:"OpenLayers.Control.Navigation"});OpenLayers.Control.DrawFeature=OpenLayers.Class(OpenLayers.Control,{layer:null,callbacks:null,multi:!1,featureAdded:function(){},handlerOptions:null,initialize:function(a,b,c){OpenLayers.Control.prototype.initialize.apply(this,[c]);this.callbacks=OpenLayers.Util.extend({done:this.drawFeature,modify:function(a,b){this.layer.events.triggerEvent("sketchmodified",{vertex:a,feature:b})},create:function(a,b){this.layer.events.triggerEvent("sketchstarted",{vertex:a,feature:b})}},this.callbacks);this.layer=
a;this.handlerOptions=this.handlerOptions||{};this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{renderers:a.renderers,rendererOptions:a.rendererOptions});"multi"in this.handlerOptions||(this.handlerOptions.multi=this.multi);if(a=this.layer.styleMap&&this.layer.styleMap.styles.temporary)this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{styleMap:new OpenLayers.StyleMap({"default":a})});this.handler=new b(this,
this.callbacks,this.handlerOptions)},drawFeature:function(a){a=new OpenLayers.Feature.Vector(a);!1!==this.layer.events.triggerEvent("sketchcomplete",{feature:a})&&(a.state=OpenLayers.State.INSERT,this.layer.addFeatures([a]),this.featureAdded(a),this.events.triggerEvent("featureadded",{feature:a}))},insertXY:function(a,b){this.handler&&this.handler.line&&this.handler.insertXY(a,b)},insertDeltaXY:function(a,b){this.handler&&this.handler.line&&this.handler.insertDeltaXY(a,b)},insertDirectionLength:function(a,
b){this.handler&&this.handler.line&&this.handler.insertDirectionLength(a,b)},insertDeflectionLength:function(a,b){this.handler&&this.handler.line&&this.handler.insertDeflectionLength(a,b)},undo:function(){return this.handler.undo&&this.handler.undo()},redo:function(){return this.handler.redo&&this.handler.redo()},finishSketch:function(){this.handler.finishGeometry()},cancel:function(){this.handler.cancel()},CLASS_NAME:"OpenLayers.Control.DrawFeature"});OpenLayers.Handler.Polygon=OpenLayers.Class(OpenLayers.Handler.Path,{holeModifier:null,drawingHole:!1,polygon:null,createFeature:function(a){a=this.layer.getLonLatFromViewPortPx(a);a=new OpenLayers.Geometry.Point(a.lon,a.lat);this.point=new OpenLayers.Feature.Vector(a);this.line=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LinearRing([this.point.geometry]));this.polygon=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon([this.line.geometry]));this.callback("create",[this.point.geometry,
this.getSketch()]);this.point.geometry.clearBounds();this.layer.addFeatures([this.polygon,this.point],{silent:!0})},addPoint:function(a){if(!this.drawingHole&&this.holeModifier&&this.evt&&this.evt[this.holeModifier])for(var b=this.point.geometry,c=this.control.layer.features,d,e=c.length-1;0<=e;--e)if(d=c[e].geometry,(d instanceof OpenLayers.Geometry.Polygon||d instanceof OpenLayers.Geometry.MultiPolygon)&&d.intersects(b)){b=c[e];this.control.layer.removeFeatures([b],{silent:!0});this.control.layer.events.registerPriority("sketchcomplete",
this,this.finalizeInteriorRing);this.control.layer.events.registerPriority("sketchmodified",this,this.enforceTopology);b.geometry.addComponent(this.line.geometry);this.polygon=b;this.drawingHole=!0;break}OpenLayers.Handler.Path.prototype.addPoint.apply(this,arguments)},getCurrentPointIndex:function(){return this.line.geometry.components.length-2},enforceTopology:function(a){var a=a.vertex,b=this.line.geometry.components;this.polygon.geometry.intersects(a)||(b=b[b.length-3],a.x=b.x,a.y=b.y)},finishGeometry:function(){this.line.geometry.removeComponent(this.line.geometry.components[this.line.geometry.components.length-
2]);this.removePoint();this.finalize()},finalizeInteriorRing:function(){var a=this.line.geometry,b=0!==a.getArea();if(b){for(var c=this.polygon.geometry.components,d=c.length-2;0<=d;--d)if(a.intersects(c[d])){b=!1;break}if(b){d=c.length-2;a:for(;0<d;--d)for(var e=c[d].components,f=0,g=e.length;f<g;++f)if(a.containsPoint(e[f])){b=!1;break a}}}b?this.polygon.state!==OpenLayers.State.INSERT&&(this.polygon.state=OpenLayers.State.UPDATE):this.polygon.geometry.removeComponent(a);this.restoreFeature();return!1},
cancel:function(){this.drawingHole&&(this.polygon.geometry.removeComponent(this.line.geometry),this.restoreFeature(!0));return OpenLayers.Handler.Path.prototype.cancel.apply(this,arguments)},restoreFeature:function(a){this.control.layer.events.unregister("sketchcomplete",this,this.finalizeInteriorRing);this.control.layer.events.unregister("sketchmodified",this,this.enforceTopology);this.layer.removeFeatures([this.polygon],{silent:!0});this.control.layer.addFeatures([this.polygon],{silent:!0});this.drawingHole=
!1;a||this.control.layer.events.triggerEvent("sketchcomplete",{feature:this.polygon})},destroyFeature:function(a){OpenLayers.Handler.Path.prototype.destroyFeature.call(this,a);this.polygon=null},drawFeature:function(){this.layer.drawFeature(this.polygon,this.style);this.layer.drawFeature(this.point,this.style)},getSketch:function(){return this.polygon},getGeometry:function(){var a=this.polygon&&this.polygon.geometry;a&&this.multi&&(a=new OpenLayers.Geometry.MultiPolygon([a]));return a},CLASS_NAME:"OpenLayers.Handler.Polygon"});OpenLayers.Control.EditingToolbar=OpenLayers.Class(OpenLayers.Control.Panel,{citeCompliant:!1,initialize:function(a,b){OpenLayers.Control.Panel.prototype.initialize.apply(this,[b]);this.addControls([new OpenLayers.Control.Navigation]);this.addControls([new OpenLayers.Control.DrawFeature(a,OpenLayers.Handler.Point,{displayClass:"olControlDrawFeaturePoint",handlerOptions:{citeCompliant:this.citeCompliant}}),new OpenLayers.Control.DrawFeature(a,OpenLayers.Handler.Path,{displayClass:"olControlDrawFeaturePath",
handlerOptions:{citeCompliant:this.citeCompliant}}),new OpenLayers.Control.DrawFeature(a,OpenLayers.Handler.Polygon,{displayClass:"olControlDrawFeaturePolygon",handlerOptions:{citeCompliant:this.citeCompliant}})])},draw:function(){var a=OpenLayers.Control.Panel.prototype.draw.apply(this,arguments);null===this.defaultControl&&(this.defaultControl=this.controls[0]);return a},CLASS_NAME:"OpenLayers.Control.EditingToolbar"});OpenLayers.Strategy.BBOX=OpenLayers.Class(OpenLayers.Strategy,{bounds:null,resolution:null,ratio:2,resFactor:null,response:null,activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);a&&(this.layer.events.on({moveend:this.update,refresh:this.update,visibilitychanged:this.update,scope:this}),this.update());return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&&this.layer.events.un({moveend:this.update,refresh:this.update,visibilitychanged:this.update,
scope:this});return a},update:function(a){var b=this.getMapBounds();if(null!==b&&(a&&a.force||this.layer.visibility&&this.layer.calculateInRange()&&this.invalidBounds(b)))this.calculateBounds(b),this.resolution=this.layer.map.getResolution(),this.triggerRead(a)},getMapBounds:function(){if(null===this.layer.map)return null;var a=this.layer.map.getExtent();a&&!this.layer.projection.equals(this.layer.map.getProjectionObject())&&(a=a.clone().transform(this.layer.map.getProjectionObject(),this.layer.projection));
return a},invalidBounds:function(a){a||(a=this.getMapBounds());a=!this.bounds||!this.bounds.containsBounds(a);!a&&this.resFactor&&(a=this.resolution/this.layer.map.getResolution(),a=a>=this.resFactor||a<=1/this.resFactor);return a},calculateBounds:function(a){a||(a=this.getMapBounds());var b=a.getCenterLonLat(),c=a.getWidth()*this.ratio,a=a.getHeight()*this.ratio;this.bounds=new OpenLayers.Bounds(b.lon-c/2,b.lat-a/2,b.lon+c/2,b.lat+a/2)},triggerRead:function(a){this.response&&!(a&&!0===a.noAbort)&&
(this.layer.protocol.abort(this.response),this.layer.events.triggerEvent("loadend"));this.layer.events.triggerEvent("loadstart");this.response=this.layer.protocol.read(OpenLayers.Util.applyDefaults({filter:this.createFilter(),callback:this.merge,scope:this},a))},createFilter:function(){var a=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.BBOX,value:this.bounds,projection:this.layer.projection});this.layer.filter&&(a=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND,
filters:[this.layer.filter,a]}));return a},merge:function(a){this.layer.destroyFeatures();if((a=a.features)&&0<a.length){var b=this.layer.projection,c=this.layer.map.getProjectionObject();if(!c.equals(b))for(var d,e=0,f=a.length;e<f;++e)(d=a[e].geometry)&&d.transform(b,c);this.layer.addFeatures(a)}this.response=null;this.layer.events.triggerEvent("loadend")},CLASS_NAME:"OpenLayers.Strategy.BBOX"});OpenLayers.Layer.WorldWind=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{},isBaseLayer:!0,lzd:null,zoomLevels:null,initialize:function(a,b,c,d,e,f){this.lzd=c;this.zoomLevels=d;c=[];c.push(a,b,e,f);OpenLayers.Layer.Grid.prototype.initialize.apply(this,c);this.params=OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS)},getZoom:function(){var a=this.map.getZoom();this.map.getMaxExtent();return a-=Math.log(this.maxResolution/(this.lzd/512))/Math.log(2)},getURL:function(a){var a=
this.adjustBounds(a),b=this.getZoom(),c=this.map.getMaxExtent(),d=this.lzd/Math.pow(2,this.getZoom()),e=Math.floor((a.left-c.left)/d),a=Math.floor((a.bottom-c.bottom)/d);return this.map.getResolution()<=this.lzd/512&&this.getZoom()<=this.zoomLevels?this.getFullRequestString({L:b,X:e,Y:a}):OpenLayers.Util.getImageLocation("blank.gif")},CLASS_NAME:"OpenLayers.Layer.WorldWind"});OpenLayers.Protocol.CSW=function(a){var a=OpenLayers.Util.applyDefaults(a,OpenLayers.Protocol.CSW.DEFAULTS),b=OpenLayers.Protocol.CSW["v"+a.version.replace(/\./g,"_")];if(!b)throw"Unsupported CSW version: "+a.version;return new b(a)};OpenLayers.Protocol.CSW.DEFAULTS={version:"2.0.2"};OpenLayers.Format.WMTSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",yx:{"urn:ogc:def:crs:EPSG::4326":!0},createLayer:function(a,b){var c,d={layer:!0,matrixSet:!0},e;for(e in d)if(!(e in b))throw Error("Missing property '"+e+"' in layer configuration.");d=a.contents;e=d.tileMatrixSets[b.matrixSet];for(var f,g=0,h=d.layers.length;g<h;++g)if(d.layers[g].identifier===b.layer){f=d.layers[g];break}if(f&&e){for(var i,g=0,h=f.styles.length;g<h&&!(i=f.styles[g],i.isDefault);++g);
c=new OpenLayers.Layer.WMTS(OpenLayers.Util.applyDefaults(b,{url:"REST"===b.requestEncoding&&f.resourceUrl?f.resourceUrl.tile.template:a.operationsMetadata.GetTile.dcp.http.get[0].url,name:f.title,style:i.identifier,matrixIds:e.matrixIds,tileFullExtent:e.bounds}))}return c},CLASS_NAME:"OpenLayers.Format.WMTSCapabilities"});OpenLayers.Layer.Google.v3={DEFAULTS:{sphericalMercator:!0,projection:"EPSG:900913"},animationEnabled:!0,loadMapObject:function(){this.type||(this.type=google.maps.MapTypeId.ROADMAP);var a,b=OpenLayers.Layer.Google.cache[this.map.id];b?(a=b.mapObject,++b.count):(b=this.map.viewPortDiv,a=document.createElement("div"),a.id=this.map.id+"_GMapContainer",a.style.position="absolute",a.style.width="100%",a.style.height="100%",b.appendChild(a),b=this.map.getCenter(),a=new google.maps.Map(a,{center:b?new google.maps.LatLng(b.lat,
b.lon):new google.maps.LatLng(0,0),zoom:this.map.getZoom()||0,mapTypeId:this.type,disableDefaultUI:!0,keyboardShortcuts:!1,draggable:!1,disableDoubleClickZoom:!0,scrollwheel:!1,streetViewControl:!1}),b={mapObject:a,count:1},OpenLayers.Layer.Google.cache[this.map.id]=b,this.repositionListener=google.maps.event.addListenerOnce(a,"center_changed",OpenLayers.Function.bind(this.repositionMapElements,this)));this.mapObject=a;this.setGMapVisibility(this.visibility)},repositionMapElements:function(){google.maps.event.trigger(this.mapObject,
"resize");var a=this.mapObject.getDiv().firstChild;if(!a||3>a.childNodes.length)return this.repositionTimer=window.setTimeout(OpenLayers.Function.bind(this.repositionMapElements,this),250),!1;for(var b=OpenLayers.Layer.Google.cache[this.map.id],c=this.map.viewPortDiv,d=a.children.length-1;0<=d;--d){if(1000001==a.children[d].style.zIndex){var e=a.children[d];c.appendChild(e);e.style.zIndex="1100";e.style.bottom="";e.className="olLayerGoogleCopyright olLayerGoogleV3";e.style.display="";b.termsOfUse=
e}1E6==a.children[d].style.zIndex&&(e=a.children[d],c.appendChild(e),e.style.zIndex="1100",e.style.bottom="",e.className="olLayerGooglePoweredBy olLayerGoogleV3 gmnoprint",e.style.display="",b.poweredBy=e);10000002==a.children[d].style.zIndex&&c.appendChild(a.children[d])}this.setGMapVisibility(this.visibility)},onMapResize:function(){if(this.visibility)google.maps.event.trigger(this.mapObject,"resize");else{var a=OpenLayers.Layer.Google.cache[this.map.id];if(!a.resized){var b=this;google.maps.event.addListenerOnce(this.mapObject,
"tilesloaded",function(){google.maps.event.trigger(b.mapObject,"resize");b.moveTo(b.map.getCenter(),b.map.getZoom());delete a.resized})}a.resized=!0}},setGMapVisibility:function(a){var b=OpenLayers.Layer.Google.cache[this.map.id];if(b){for(var c=this.type,d=this.map.layers,e,f=d.length-1;0<=f;--f)if(e=d[f],e instanceof OpenLayers.Layer.Google&&!0===e.visibility&&!0===e.inRange){c=e.type;a=!0;break}d=this.mapObject.getDiv();!0===a?(this.mapObject.setMapTypeId(c),d.style.left="",b.termsOfUse&&b.termsOfUse.style&&
(b.termsOfUse.style.left="",b.termsOfUse.style.display="",b.poweredBy.style.display=""),b.displayed=this.id):(delete b.displayed,d.style.left="-9999px",b.termsOfUse&&b.termsOfUse.style&&(b.termsOfUse.style.display="none",b.termsOfUse.style.left="-9999px",b.poweredBy.style.display="none"))}},getMapContainer:function(){return this.mapObject.getDiv()},getMapObjectBoundsFromOLBounds:function(a){var b=null;null!=a&&(b=this.sphericalMercator?this.inverseMercator(a.bottom,a.left):new OpenLayers.LonLat(a.bottom,
a.left),a=this.sphericalMercator?this.inverseMercator(a.top,a.right):new OpenLayers.LonLat(a.top,a.right),b=new google.maps.LatLngBounds(new google.maps.LatLng(b.lat,b.lon),new google.maps.LatLng(a.lat,a.lon)));return b},getMapObjectLonLatFromMapObjectPixel:function(a){var b=this.map.getSize(),c=this.getLongitudeFromMapObjectLonLat(this.mapObject.center),d=this.getLatitudeFromMapObjectLonLat(this.mapObject.center),e=this.map.getResolution(),a=new OpenLayers.LonLat(c+(a.x-b.w/2)*e,d-(a.y-b.h/2)*e);
this.wrapDateLine&&(a=a.wrapDateLine(this.maxExtent));return this.getMapObjectLonLatFromLonLat(a.lon,a.lat)},getMapObjectPixelFromMapObjectLonLat:function(a){var b=this.getLongitudeFromMapObjectLonLat(a),a=this.getLatitudeFromMapObjectLonLat(a),c=this.map.getResolution(),d=this.map.getExtent();return this.getMapObjectPixelFromXY(1/c*(b-d.left),1/c*(d.top-a))},setMapObjectCenter:function(a,b){if(!1===this.animationEnabled&&b!=this.mapObject.zoom){var c=this.getMapContainer();google.maps.event.addListenerOnce(this.mapObject,
"idle",function(){c.style.visibility=""});c.style.visibility="hidden"}this.mapObject.setOptions({center:a,zoom:b})},getMapObjectZoomFromMapObjectBounds:function(a){return this.mapObject.getBoundsZoomLevel(a)},getMapObjectLonLatFromLonLat:function(a,b){var c;this.sphericalMercator?(c=this.inverseMercator(a,b),c=new google.maps.LatLng(c.lat,c.lon)):c=new google.maps.LatLng(b,a);return c},getMapObjectPixelFromXY:function(a,b){return new google.maps.Point(a,b)},destroy:function(){this.repositionListener&&
google.maps.event.removeListener(this.repositionListener);this.repositionTimer&&window.clearTimeout(this.repositionTimer);OpenLayers.Layer.Google.prototype.destroy.apply(this,arguments)}};OpenLayers.Format.WPSDescribeProcess=OpenLayers.Class(OpenLayers.Format.XML,{VERSION:"1.0.0",namespaces:{wps:"http://www.opengis.net/wps/1.0.0",ows:"http://www.opengis.net/ows/1.1",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"http://www.opengis.net/wps/1.0.0 http://schemas.opengis.net/wps/1.0.0/wpsAll.xsd",defaultPrefix:"wps",regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,
[a]));a&&9==a.nodeType&&(a=a.documentElement);var b={};this.readNode(a,b);return b},readers:{wps:{ProcessDescriptions:function(a,b){b.processDescriptions={};this.readChildNodes(a,b.processDescriptions)},ProcessDescription:function(a,b){var c={processVersion:this.getAttributeNS(a,this.namespaces.wps,"processVersion"),statusSupported:"true"===a.getAttribute("statusSupported"),storeSupported:"true"===a.getAttribute("storeSupported")};this.readChildNodes(a,c);b[c.identifier]=c},DataInputs:function(a,
b){b.dataInputs=[];this.readChildNodes(a,b.dataInputs)},ProcessOutputs:function(a,b){b.processOutputs=[];this.readChildNodes(a,b.processOutputs)},Output:function(a,b){var c={};this.readChildNodes(a,c);b.push(c)},ComplexOutput:function(a,b){b.complexOutput={};this.readChildNodes(a,b.complexOutput)},Input:function(a,b){var c={maxOccurs:parseInt(a.getAttribute("maxOccurs")),minOccurs:parseInt(a.getAttribute("minOccurs"))};this.readChildNodes(a,c);b.push(c)},BoundingBoxData:function(a,b){b.boundingBoxData=
{};this.readChildNodes(a,b.boundingBoxData)},CRS:function(a,b){b.CRSs||(b.CRSs={});b.CRSs[this.getChildValue(a)]=!0},LiteralData:function(a,b){b.literalData={};this.readChildNodes(a,b.literalData)},ComplexData:function(a,b){b.complexData={};this.readChildNodes(a,b.complexData)},Default:function(a,b){b["default"]={};this.readChildNodes(a,b["default"])},Supported:function(a,b){b.supported={};this.readChildNodes(a,b.supported)},Format:function(a,b){var c={};this.readChildNodes(a,c);b.formats||(b.formats=
{});b.formats[c.mimeType]=!0},MimeType:function(a,b){b.mimeType=this.getChildValue(a)}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WPSDescribeProcess"});OpenLayers.Format.CSWGetRecords.v2_0_2=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{csw:"http://www.opengis.net/cat/csw/2.0.2",dc:"http://purl.org/dc/elements/1.1/",dct:"http://purl.org/dc/terms/",gmd:"http://www.isotc211.org/2005/gmd",geonet:"http://www.fao.org/geonetwork",ogc:"http://www.opengis.net/ogc",ows:"http://www.opengis.net/ows",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"csw",version:"2.0.2",schemaLocation:"http://www.opengis.net/cat/csw/2.0.2 http://schemas.opengis.net/csw/2.0.2/CSW-discovery.xsd",
requestId:null,resultType:null,outputFormat:null,outputSchema:null,startPosition:null,maxRecords:null,DistributedSearch:null,ResponseHandler:null,Query:null,regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&&9==a.nodeType&&(a=a.documentElement);var b={};this.readNode(a,b);return b},
readers:{csw:{GetRecordsResponse:function(a,b){b.records=[];this.readChildNodes(a,b);var c=this.getAttributeNS(a,"","version");""!=c&&(b.version=c)},RequestId:function(a,b){b.RequestId=this.getChildValue(a)},SearchStatus:function(a,b){b.SearchStatus={};var c=this.getAttributeNS(a,"","timestamp");""!=c&&(b.SearchStatus.timestamp=c)},SearchResults:function(a,b){this.readChildNodes(a,b);for(var c=a.attributes,d={},e=0,f=c.length;e<f;++e)d[c[e].name]="numberOfRecordsMatched"==c[e].name||"numberOfRecordsReturned"==
c[e].name||"nextRecord"==c[e].name?parseInt(c[e].nodeValue):c[e].nodeValue;b.SearchResults=d},SummaryRecord:function(a,b){var c={type:"SummaryRecord"};this.readChildNodes(a,c);b.records.push(c)},BriefRecord:function(a,b){var c={type:"BriefRecord"};this.readChildNodes(a,c);b.records.push(c)},DCMIRecord:function(a,b){var c={type:"DCMIRecord"};this.readChildNodes(a,c);b.records.push(c)},Record:function(a,b){var c={type:"Record"};this.readChildNodes(a,c);b.records.push(c)},"*":function(a,b){var c=a.localName||
a.nodeName.split(":").pop();b[c]=this.getChildValue(a)}},geonet:{info:function(a,b){var c={};this.readChildNodes(a,c);b.gninfo=c}},dc:{"*":function(a,b){var c=a.localName||a.nodeName.split(":").pop();OpenLayers.Util.isArray(b[c])||(b[c]=[]);for(var d={},e=a.attributes,f=0,g=e.length;f<g;++f)d[e[f].name]=e[f].nodeValue;d.value=this.getChildValue(a);""!=d.value&&b[c].push(d)}},dct:{"*":function(a,b){var c=a.localName||a.nodeName.split(":").pop();OpenLayers.Util.isArray(b[c])||(b[c]=[]);b[c].push(this.getChildValue(a))}},
ows:OpenLayers.Util.applyDefaults({BoundingBox:function(a,b){b.bounds&&(b.BoundingBox=[{crs:b.projection,value:[b.bounds.left,b.bounds.bottom,b.bounds.right,b.bounds.top]}],delete b.projection,delete b.bounds);OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows.BoundingBox.apply(this,arguments)}},OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows)},write:function(a){a=this.writeNode("csw:GetRecords",a);a.setAttribute("xmlns:gmd",this.namespaces.gmd);return OpenLayers.Format.XML.prototype.write.apply(this,
[a])},writers:{csw:{GetRecords:function(a){a||(a={});var b=this.createElementNSPlus("csw:GetRecords",{attributes:{service:"CSW",version:this.version,requestId:a.requestId||this.requestId,resultType:a.resultType||this.resultType,outputFormat:a.outputFormat||this.outputFormat,outputSchema:a.outputSchema||this.outputSchema,startPosition:a.startPosition||this.startPosition,maxRecords:a.maxRecords||this.maxRecords}});if(a.DistributedSearch||this.DistributedSearch)this.writeNode("csw:DistributedSearch",
a.DistributedSearch||this.DistributedSearch,b);var c=a.ResponseHandler||this.ResponseHandler;if(OpenLayers.Util.isArray(c)&&0<c.length)for(var d=0,e=c.length;d<e;d++)this.writeNode("csw:ResponseHandler",c[d],b);this.writeNode("Query",a.Query||this.Query,b);return b},DistributedSearch:function(a){return this.createElementNSPlus("csw:DistributedSearch",{attributes:{hopCount:a.hopCount}})},ResponseHandler:function(a){return this.createElementNSPlus("csw:ResponseHandler",{value:a.value})},Query:function(a){a||
(a={});var b=this.createElementNSPlus("csw:Query",{attributes:{typeNames:a.typeNames||"csw:Record"}}),c=a.ElementName;if(OpenLayers.Util.isArray(c)&&0<c.length)for(var d=0,e=c.length;d<e;d++)this.writeNode("csw:ElementName",c[d],b);else this.writeNode("csw:ElementSetName",a.ElementSetName||{value:"summary"},b);a.Constraint&&this.writeNode("csw:Constraint",a.Constraint,b);a.SortBy&&this.writeNode("ogc:SortBy",a.SortBy,b);return b},ElementName:function(a){return this.createElementNSPlus("csw:ElementName",
{value:a.value})},ElementSetName:function(a){return this.createElementNSPlus("csw:ElementSetName",{attributes:{typeNames:a.typeNames},value:a.value})},Constraint:function(a){var b=this.createElementNSPlus("csw:Constraint",{attributes:{version:a.version}});if(a.Filter){var c=new OpenLayers.Format.Filter({version:a.version});b.appendChild(c.write(a.Filter))}else a.CqlText&&(a=this.createElementNSPlus("CqlText",{value:a.CqlText.value}),b.appendChild(a));return b}},ogc:OpenLayers.Format.Filter.v1_1_0.prototype.writers.ogc},
CLASS_NAME:"OpenLayers.Format.CSWGetRecords.v2_0_2"});OpenLayers.Marker.Box=OpenLayers.Class(OpenLayers.Marker,{bounds:null,div:null,initialize:function(a,b,c){this.bounds=a;this.div=OpenLayers.Util.createDiv();this.div.style.overflow="hidden";this.events=new OpenLayers.Events(this,this.div);this.setBorder(b,c)},destroy:function(){this.div=this.bounds=null;OpenLayers.Marker.prototype.destroy.apply(this,arguments)},setBorder:function(a,b){a||(a="red");b||(b=2);this.div.style.border=b+"px solid "+a},draw:function(a,b){OpenLayers.Util.modifyDOMElement(this.div,
null,a,b);return this.div},onScreen:function(){var a=!1;this.map&&(a=this.map.getExtent().containsBounds(this.bounds,!0,!0));return a},display:function(a){this.div.style.display=a?"":"none"},CLASS_NAME:"OpenLayers.Marker.Box"});OpenLayers.Format.Text=OpenLayers.Class(OpenLayers.Format,{defaultStyle:null,extractStyles:!0,initialize:function(a){a=a||{};!1!==a.extractStyles&&(a.defaultStyle={externalGraphic:OpenLayers.Util.getImageLocation("marker.png"),graphicWidth:21,graphicHeight:25,graphicXOffset:-10.5,graphicYOffset:-12.5});OpenLayers.Format.prototype.initialize.apply(this,[a])},read:function(a){for(var a=a.split("\n"),b,c=[],d=0;d<a.length-1;d++){var e=a[d].replace(/^\s*/,"").replace(/\s*$/,"");if("#"!=e.charAt(0))if(b){for(var e=
e.split("\t"),f=new OpenLayers.Geometry.Point(0,0),g={},h=this.defaultStyle?OpenLayers.Util.applyDefaults({},this.defaultStyle):null,i=!1,j=0;j<e.length;j++)if(e[j])if("point"==b[j])i=e[j].split(","),f.y=parseFloat(i[0]),f.x=parseFloat(i[1]),i=!0;else if("lat"==b[j])f.y=parseFloat(e[j]),i=!0;else if("lon"==b[j])f.x=parseFloat(e[j]),i=!0;else if("title"==b[j])g.title=e[j];else if("image"==b[j]||"icon"==b[j]&&h)h.externalGraphic=e[j];else if("iconSize"==b[j]&&h){var k=e[j].split(",");h.graphicWidth=
parseFloat(k[0]);h.graphicHeight=parseFloat(k[1])}else"iconOffset"==b[j]&&h?(k=e[j].split(","),h.graphicXOffset=parseFloat(k[0]),h.graphicYOffset=parseFloat(k[1])):"description"==b[j]?g.description=e[j]:"overflow"==b[j]?g.overflow=e[j]:g[b[j]]=e[j];i&&(this.internalProjection&&this.externalProjection&&f.transform(this.externalProjection,this.internalProjection),e=new OpenLayers.Feature.Vector(f,g,h),c.push(e))}else b=e.split("\t")}return c},CLASS_NAME:"OpenLayers.Format.Text"});OpenLayers.Layer.Text=OpenLayers.Class(OpenLayers.Layer.Markers,{location:null,features:null,formatOptions:null,selectedFeature:null,initialize:function(a,b){OpenLayers.Layer.Markers.prototype.initialize.apply(this,arguments);this.features=[]},destroy:function(){OpenLayers.Layer.Markers.prototype.destroy.apply(this,arguments);this.clearFeatures();this.features=null},loadText:function(){!this.loaded&&null!=this.location&&(this.events.triggerEvent("loadstart"),OpenLayers.Request.GET({url:this.location,
success:this.parseData,failure:function(){this.events.triggerEvent("loadend")},scope:this}),this.loaded=!0)},moveTo:function(a,b,c){OpenLayers.Layer.Markers.prototype.moveTo.apply(this,arguments);this.visibility&&!this.loaded&&this.loadText()},parseData:function(a){var a=a.responseText,b={};OpenLayers.Util.extend(b,this.formatOptions);this.map&&!this.projection.equals(this.map.getProjectionObject())&&(b.externalProjection=this.projection,b.internalProjection=this.map.getProjectionObject());for(var a=
(new OpenLayers.Format.Text(b)).read(a),b=0,c=a.length;b<c;b++){var d={},e=a[b],f,g,h;f=new OpenLayers.LonLat(e.geometry.x,e.geometry.y);e.style.graphicWidth&&e.style.graphicHeight&&(g=new OpenLayers.Size(e.style.graphicWidth,e.style.graphicHeight));void 0!==e.style.graphicXOffset&&void 0!==e.style.graphicYOffset&&(h=new OpenLayers.Pixel(e.style.graphicXOffset,e.style.graphicYOffset));null!=e.style.externalGraphic?d.icon=new OpenLayers.Icon(e.style.externalGraphic,g,h):(d.icon=OpenLayers.Marker.defaultIcon(),
null!=g&&d.icon.setSize(g));null!=e.attributes.title&&null!=e.attributes.description&&(d.popupContentHTML="<h2>"+e.attributes.title+"</h2><p>"+e.attributes.description+"</p>");d.overflow=e.attributes.overflow||"auto";d=new OpenLayers.Feature(this,f,d);this.features.push(d);f=d.createMarker();null!=e.attributes.title&&null!=e.attributes.description&&f.events.register("click",d,this.markerClick);this.addMarker(f)}this.events.triggerEvent("loadend")},markerClick:function(a){var b=this==this.layer.selectedFeature;
this.layer.selectedFeature=!b?this:null;for(var c=0,d=this.layer.map.popups.length;c<d;c++)this.layer.map.removePopup(this.layer.map.popups[c]);b||this.layer.map.addPopup(this.createPopup());OpenLayers.Event.stop(a)},clearFeatures:function(){if(null!=this.features)for(;0<this.features.length;){var a=this.features[0];OpenLayers.Util.removeItem(this.features,a);a.destroy()}},CLASS_NAME:"OpenLayers.Layer.Text"});OpenLayers.Handler.RegularPolygon=OpenLayers.Class(OpenLayers.Handler.Drag,{sides:4,radius:null,snapAngle:null,snapToggle:"shiftKey",layerOptions:null,persist:!1,irregular:!1,citeCompliant:!1,angle:null,fixedRadius:!1,feature:null,layer:null,origin:null,initialize:function(a,b,c){if(!c||!c.layerOptions||!c.layerOptions.styleMap)this.style=OpenLayers.Util.extend(OpenLayers.Feature.Vector.style["default"],{});OpenLayers.Handler.Drag.prototype.initialize.apply(this,[a,b,c]);this.options=c?c:{}},setOptions:function(a){OpenLayers.Util.extend(this.options,
a);OpenLayers.Util.extend(this,a)},activate:function(){var a=!1;OpenLayers.Handler.Drag.prototype.activate.apply(this,arguments)&&(a=OpenLayers.Util.extend({displayInLayerSwitcher:!1,calculateInRange:OpenLayers.Function.True,wrapDateLine:this.citeCompliant},this.layerOptions),this.layer=new OpenLayers.Layer.Vector(this.CLASS_NAME,a),this.map.addLayer(this.layer),a=!0);return a},deactivate:function(){var a=!1;OpenLayers.Handler.Drag.prototype.deactivate.apply(this,arguments)&&(this.dragging&&this.cancel(),
null!=this.layer.map&&(this.layer.destroy(!1),this.feature&&this.feature.destroy()),this.feature=this.layer=null,a=!0);return a},down:function(a){this.fixedRadius=!!this.radius;a=this.layer.getLonLatFromViewPortPx(a.xy);this.origin=new OpenLayers.Geometry.Point(a.lon,a.lat);if(!this.fixedRadius||this.irregular)this.radius=this.map.getResolution();this.persist&&this.clear();this.feature=new OpenLayers.Feature.Vector;this.createGeometry();this.callback("create",[this.origin,this.feature]);this.layer.addFeatures([this.feature],
{silent:!0});this.layer.drawFeature(this.feature,this.style)},move:function(a){var b=this.layer.getLonLatFromViewPortPx(a.xy),b=new OpenLayers.Geometry.Point(b.lon,b.lat);this.irregular?(a=Math.sqrt(2)*Math.abs(b.y-this.origin.y)/2,this.radius=Math.max(this.map.getResolution()/2,a)):this.fixedRadius?this.origin=b:(this.calculateAngle(b,a),this.radius=Math.max(this.map.getResolution()/2,b.distanceTo(this.origin)));this.modifyGeometry();this.irregular&&(a=b.x-this.origin.x,b=b.y-this.origin.y,this.feature.geometry.resize(1,
this.origin,0==b?a/(this.radius*Math.sqrt(2)):a/b),this.feature.geometry.move(a/2,b/2));this.layer.drawFeature(this.feature,this.style)},up:function(a){this.finalize();this.start==this.last&&this.callback("done",[a.xy])},out:function(){this.finalize()},createGeometry:function(){this.angle=Math.PI*(1/this.sides-0.5);this.snapAngle&&(this.angle+=this.snapAngle*(Math.PI/180));this.feature.geometry=OpenLayers.Geometry.Polygon.createRegularPolygon(this.origin,this.radius,this.sides,this.snapAngle)},modifyGeometry:function(){var a,
b,c=this.feature.geometry.components[0];c.components.length!=this.sides+1&&(this.createGeometry(),c=this.feature.geometry.components[0]);for(var d=0;d<this.sides;++d)b=c.components[d],a=this.angle+2*d*Math.PI/this.sides,b.x=this.origin.x+this.radius*Math.cos(a),b.y=this.origin.y+this.radius*Math.sin(a),b.clearBounds()},calculateAngle:function(a,b){var c=Math.atan2(a.y-this.origin.y,a.x-this.origin.x);if(this.snapAngle&&this.snapToggle&&!b[this.snapToggle]){var d=Math.PI/180*this.snapAngle;this.angle=
Math.round(c/d)*d}else this.angle=c},cancel:function(){this.callback("cancel",null);this.finalize()},finalize:function(){this.origin=null;this.radius=this.options.radius},clear:function(){this.layer&&(this.layer.renderer.clear(),this.layer.destroyFeatures())},callback:function(a){this.callbacks[a]&&this.callbacks[a].apply(this.control,[this.feature.geometry.clone()]);!this.persist&&("done"==a||"cancel"==a)&&this.clear()},CLASS_NAME:"OpenLayers.Handler.RegularPolygon"});OpenLayers.Control.SLDSelect=OpenLayers.Class(OpenLayers.Control,{clearOnDeactivate:!1,layers:null,callbacks:null,selectionSymbolizer:{Polygon:{fillColor:"#FF0000",stroke:!1},Line:{strokeColor:"#FF0000",strokeWidth:2},Point:{graphicName:"square",fillColor:"#FF0000",pointRadius:5}},layerOptions:null,handlerOptions:null,sketchStyle:null,wfsCache:{},layerCache:{},initialize:function(a,b){OpenLayers.Control.prototype.initialize.apply(this,[b]);this.callbacks=OpenLayers.Util.extend({done:this.select,click:this.select},
this.callbacks);this.handlerOptions=this.handlerOptions||{};this.layerOptions=OpenLayers.Util.applyDefaults(this.layerOptions,{displayInLayerSwitcher:!1,tileOptions:{maxGetUrlLength:2048}});this.sketchStyle&&(this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{styleMap:new OpenLayers.StyleMap({"default":this.sketchStyle})}));this.handler=new a(this,this.callbacks,this.handlerOptions)},destroy:function(){for(var a in this.layerCache)delete this.layerCache[a];
for(a in this.wfsCache)delete this.wfsCache[a];OpenLayers.Control.prototype.destroy.apply(this,arguments)},coupleLayerVisiblity:function(a){this.setVisibility(a.object.getVisibility())},createSelectionLayer:function(a){var b;if(this.layerCache[a.id])b=this.layerCache[a.id];else{b=new OpenLayers.Layer.WMS(a.name,a.url,a.params,OpenLayers.Util.applyDefaults(this.layerOptions,a.getOptions()));this.layerCache[a.id]=b;if(!1===this.layerOptions.displayInLayerSwitcher)a.events.on({visibilitychanged:this.coupleLayerVisiblity,
scope:b});this.map.addLayer(b)}return b},createSLD:function(a,b,c){for(var d={version:"1.0.0",namedLayers:{}},e=(""+a.params.LAYERS).split(","),f=0,g=e.length;f<g;f++){var h=e[f];d.namedLayers[h]={name:h,userStyles:[]};var i=this.selectionSymbolizer,j=c[f];0<=j.type.indexOf("Polygon")?i={Polygon:this.selectionSymbolizer.Polygon}:0<=j.type.indexOf("LineString")?i={Line:this.selectionSymbolizer.Line}:0<=j.type.indexOf("Point")&&(i={Point:this.selectionSymbolizer.Point});d.namedLayers[h].userStyles.push({name:"default",
rules:[new OpenLayers.Rule({symbolizer:i,filter:b[f],maxScaleDenominator:a.options.minScale})]})}return(new OpenLayers.Format.SLD({srsName:this.map.getProjection()})).write(d)},parseDescribeLayer:function(a){var b=new OpenLayers.Format.WMSDescribeLayer,c=a.responseXML;if(!c||!c.documentElement)c=a.responseText;for(var a=b.read(c),b=[],c=null,d=0,e=a.length;d<e;d++)"WFS"==a[d].owsType&&(b.push(a[d].typeName),c=a[d].owsURL);OpenLayers.Request.GET({url:c,params:{SERVICE:"WFS",TYPENAME:b.toString(),REQUEST:"DescribeFeatureType",
VERSION:"1.0.0"},callback:function(a){var b=new OpenLayers.Format.WFSDescribeFeatureType,c=a.responseXML;if(!c||!c.documentElement)c=a.responseText;this.control.wfsCache[this.layer.id]=b.read(c);this.control._queue&&this.control.applySelection()},scope:this})},getGeometryAttributes:function(a){for(var b=[],a=this.wfsCache[a.id],c=0,d=a.featureTypes.length;c<d;c++)for(var e=a.featureTypes[c].properties,f=0,g=e.length;f<g;f++){var h=e[f],i=h.type;(0<=i.indexOf("LineString")||0<=i.indexOf("GeometryAssociationType")||
0<=i.indexOf("GeometryPropertyType")||0<=i.indexOf("Point")||0<=i.indexOf("Polygon"))&&b.push(h)}return b},activate:function(){var a=OpenLayers.Control.prototype.activate.call(this);if(a)for(var b=0,c=this.layers.length;b<c;b++){var d=this.layers[b];d&&!this.wfsCache[d.id]&&OpenLayers.Request.GET({url:d.url,params:{SERVICE:"WMS",VERSION:d.params.VERSION,LAYERS:d.params.LAYERS,REQUEST:"DescribeLayer"},callback:this.parseDescribeLayer,scope:{layer:d,control:this}})}return a},deactivate:function(){var a=
OpenLayers.Control.prototype.deactivate.call(this);if(a)for(var b=0,c=this.layers.length;b<c;b++){var d=this.layers[b];if(d&&!0===this.clearOnDeactivate){var e=this.layerCache,f=e[d.id];f&&(d.events.un({visibilitychanged:this.coupleLayerVisiblity,scope:f}),f.destroy(),delete e[d.id])}}return a},setLayers:function(a){this.active?(this.deactivate(),this.layers=a,this.activate()):this.layers=a},createFilter:function(a,b){var c=null;this.handler instanceof OpenLayers.Handler.RegularPolygon?c=!0===this.handler.irregular?
new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.BBOX,property:a.name,value:b.getBounds()}):new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:a.name,value:b}):this.handler instanceof OpenLayers.Handler.Polygon?c=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:a.name,value:b}):this.handler instanceof OpenLayers.Handler.Path?c=0<=a.type.indexOf("Point")?new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.DWITHIN,
property:a.name,distance:0.01*this.map.getExtent().getWidth(),distanceUnits:this.map.getUnits(),value:b}):new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:a.name,value:b}):this.handler instanceof OpenLayers.Handler.Click&&(c=0<=a.type.indexOf("Polygon")?new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:a.name,value:b}):new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.DWITHIN,property:a.name,distance:0.01*this.map.getExtent().getWidth(),
distanceUnits:this.map.getUnits(),value:b}));return c},select:function(a){this._queue=function(){for(var b=0,c=this.layers.length;b<c;b++){for(var d=this.layers[b],e=this.getGeometryAttributes(d),f=[],g=0,h=e.length;g<h;g++){var i=e[g];if(null!==i){if(!(a instanceof OpenLayers.Geometry)){var j=this.map.getLonLatFromPixel(a.xy);a=new OpenLayers.Geometry.Point(j.lon,j.lat)}i=this.createFilter(i,a);null!==i&&f.push(i)}}g=this.createSelectionLayer(d);e=this.createSLD(d,f,e);this.events.triggerEvent("selected",
{layer:d,filters:f});g.mergeNewParams({SLD_BODY:e});delete this._queue}};this.applySelection()},applySelection:function(){for(var a=!0,b=0,c=this.layers.length;b<c;b++)if(!this.wfsCache[this.layers[b].id]){a=!1;break}a&&this._queue.call(this)},CLASS_NAME:"OpenLayers.Control.SLDSelect"});OpenLayers.Control.Scale=OpenLayers.Class(OpenLayers.Control,{element:null,geodesic:!1,initialize:function(a,b){OpenLayers.Control.prototype.initialize.apply(this,[b]);this.element=OpenLayers.Util.getElement(a)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.element||(this.element=document.createElement("div"),this.div.appendChild(this.element));this.map.events.register("moveend",this,this.updateScale);this.updateScale();return this.div},updateScale:function(){var a;
if(!0===this.geodesic){if(!this.map.getUnits())return;a=OpenLayers.INCHES_PER_UNIT;a=(this.map.getGeodesicPixelSize().w||1.0E-6)*a.km*OpenLayers.DOTS_PER_INCH}else a=this.map.getScale();a&&(a=9500<=a&&95E4>=a?Math.round(a/1E3)+"K":95E4<=a?Math.round(a/1E6)+"M":Math.round(a),this.element.innerHTML=OpenLayers.i18n("Scale = 1 : ${scaleDenom}",{scaleDenom:a}))},CLASS_NAME:"OpenLayers.Control.Scale"});OpenLayers.Control.Button=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){},CLASS_NAME:"OpenLayers.Control.Button"});OpenLayers.Layer.MapGuide=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,useHttpTile:!1,singleTile:!1,useOverlay:!1,useAsyncOverlay:!0,TILE_PARAMS:{operation:"GETTILEIMAGE",version:"1.2.0"},SINGLE_TILE_PARAMS:{operation:"GETMAPIMAGE",format:"PNG",locale:"en",clip:"1",version:"1.0.0"},OVERLAY_PARAMS:{operation:"GETDYNAMICMAPOVERLAYIMAGE",format:"PNG",locale:"en",clip:"1",version:"2.0.0"},FOLDER_PARAMS:{tileColumnsPerFolder:30,tileRowsPerFolder:30,format:"png",querystring:null},defaultSize:new OpenLayers.Size(300,
300),tileOriginCorner:"tl",initialize:function(a,b,c,d){OpenLayers.Layer.Grid.prototype.initialize.apply(this,arguments);if(null==d||null==d.isBaseLayer)this.isBaseLayer="true"!=this.transparent&&!0!=this.transparent;d&&null!=d.useOverlay&&(this.useOverlay=d.useOverlay);this.singleTile?this.useOverlay?(OpenLayers.Util.applyDefaults(this.params,this.OVERLAY_PARAMS),this.useAsyncOverlay||(this.params.version="1.0.0")):OpenLayers.Util.applyDefaults(this.params,this.SINGLE_TILE_PARAMS):(this.useHttpTile?
OpenLayers.Util.applyDefaults(this.params,this.FOLDER_PARAMS):OpenLayers.Util.applyDefaults(this.params,this.TILE_PARAMS),this.setTileSize(this.defaultSize))},clone:function(a){null==a&&(a=new OpenLayers.Layer.MapGuide(this.name,this.url,this.params,this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},getURL:function(a){var b;b=a.getCenterLonLat();var c=this.map.getSize();this.singleTile?(a={setdisplaydpi:OpenLayers.DOTS_PER_INCH,setdisplayheight:c.h*this.ratio,setdisplaywidth:c.w*
this.ratio,setviewcenterx:b.lon,setviewcentery:b.lat,setviewscale:this.map.getScale()},this.useOverlay&&!this.useAsyncOverlay&&(b={},b=OpenLayers.Util.extend(b,a),b.operation="GETVISIBLEMAPEXTENT",b.version="1.0.0",b.session=this.params.session,b.mapName=this.params.mapName,b.format="text/xml",b=this.getFullRequestString(b),OpenLayers.Request.GET({url:b,async:!1})),b=this.getFullRequestString(a)):(c=this.map.getResolution(),b=Math.floor((a.left-this.maxExtent.left)/c),b=Math.round(b/this.tileSize.w),
a=Math.floor((this.maxExtent.top-a.top)/c),a=Math.round(a/this.tileSize.h),b=this.useHttpTile?this.getImageFilePath({tilecol:b,tilerow:a,scaleindex:this.resolutions.length-this.map.zoom-1}):this.getFullRequestString({tilecol:b,tilerow:a,scaleindex:this.resolutions.length-this.map.zoom-1}));return b},getFullRequestString:function(a,b){var c=null==b?this.url:b;"object"==typeof c&&(c=c[Math.floor(Math.random()*c.length)]);var d=c,e=OpenLayers.Util.extend({},this.params),e=OpenLayers.Util.extend(e,a),
f=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(c)),g;for(g in e)g.toUpperCase()in f&&delete e[g];e=OpenLayers.Util.getParameterString(e);e=e.replace(/,/g,"+");""!=e&&(f=c.charAt(c.length-1),d="&"==f||"?"==f?d+e:-1==c.indexOf("?")?d+("?"+e):d+("&"+e));return d},getImageFilePath:function(a,b){var c=null==b?this.url:b;"object"==typeof c&&(c=c[Math.floor(Math.random()*c.length)]);var d="",e="";0>a.tilerow&&(d="-");d=0==a.tilerow?d+"0":d+Math.floor(Math.abs(a.tilerow/this.params.tileRowsPerFolder))*
this.params.tileRowsPerFolder;0>a.tilecol&&(e="-");e=0==a.tilecol?e+"0":e+Math.floor(Math.abs(a.tilecol/this.params.tileColumnsPerFolder))*this.params.tileColumnsPerFolder;d="/S"+Math.floor(a.scaleindex)+"/"+this.params.basemaplayergroupname+"/R"+d+"/C"+e+"/"+a.tilerow%this.params.tileRowsPerFolder+"_"+a.tilecol%this.params.tileColumnsPerFolder+"."+this.params.format;this.params.querystring&&(d+="?"+this.params.querystring);return c+d},calculateGridLayout:function(a,b,c){var d=c*this.tileSize.w,c=
c*this.tileSize.h,e=a.left-b.lon,f=Math.floor(e/d)-this.buffer,a=b.lat-a.top+c,g=Math.floor(a/c)-this.buffer;return{tilelon:d,tilelat:c,tileoffsetlon:b.lon+f*d,tileoffsetlat:b.lat-c*g,tileoffsetx:-(e/d-f)*this.tileSize.w,tileoffsety:(g-a/c)*this.tileSize.h}},CLASS_NAME:"OpenLayers.Layer.MapGuide"});OpenLayers.Control.Measure=OpenLayers.Class(OpenLayers.Control,{handlerOptions:null,callbacks:null,displaySystem:"metric",geodesic:!1,displaySystemUnits:{geographic:["dd"],english:["mi","ft","in"],metric:["km","m"]},partialDelay:300,delayedTrigger:null,persist:!1,immediate:!1,initialize:function(a,b){OpenLayers.Control.prototype.initialize.apply(this,[b]);var c={done:this.measureComplete,point:this.measurePartial};this.immediate&&(c.modify=this.measureImmediate);this.callbacks=OpenLayers.Util.extend(c,
this.callbacks);this.handlerOptions=OpenLayers.Util.extend({persist:this.persist},this.handlerOptions);this.handler=new a(this,this.callbacks,this.handlerOptions)},deactivate:function(){this.cancelDelay();return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},cancel:function(){this.cancelDelay();this.handler.cancel()},setImmediate:function(a){(this.immediate=a)?this.callbacks.modify=this.measureImmediate:delete this.callbacks.modify},updateHandler:function(a,b){var c=this.active;c&&
this.deactivate();this.handler=new a(this,this.callbacks,b);c&&this.activate()},measureComplete:function(a){this.cancelDelay();this.measure(a,"measure")},measurePartial:function(a,b){this.cancelDelay();b=b.clone();this.handler.freehandMode(this.handler.evt)?this.measure(b,"measurepartial"):this.delayedTrigger=window.setTimeout(OpenLayers.Function.bind(function(){this.delayedTrigger=null;this.measure(b,"measurepartial")},this),this.partialDelay)},measureImmediate:function(a,b,c){c&&!this.handler.freehandMode(this.handler.evt)&&
(this.cancelDelay(),this.measure(b.geometry,"measurepartial"))},cancelDelay:function(){null!==this.delayedTrigger&&(window.clearTimeout(this.delayedTrigger),this.delayedTrigger=null)},measure:function(a,b){var c,d;-1<a.CLASS_NAME.indexOf("LineString")?(c=this.getBestLength(a),d=1):(c=this.getBestArea(a),d=2);this.events.triggerEvent(b,{measure:c[0],units:c[1],order:d,geometry:a})},getBestArea:function(a){for(var b=this.displaySystemUnits[this.displaySystem],c,d,e=0,f=b.length;e<f&&!(c=b[e],d=this.getArea(a,
c),1<d);++e);return[d,c]},getArea:function(a,b){var c,d;this.geodesic?(c=a.getGeodesicArea(this.map.getProjectionObject()),d="m"):(c=a.getArea(),d=this.map.getUnits());var e=OpenLayers.INCHES_PER_UNIT[b];e&&(c*=Math.pow(OpenLayers.INCHES_PER_UNIT[d]/e,2));return c},getBestLength:function(a){for(var b=this.displaySystemUnits[this.displaySystem],c,d,e=0,f=b.length;e<f&&!(c=b[e],d=this.getLength(a,c),1<d);++e);return[d,c]},getLength:function(a,b){var c,d;this.geodesic?(c=a.getGeodesicLength(this.map.getProjectionObject()),
d="m"):(c=a.getLength(),d=this.map.getUnits());var e=OpenLayers.INCHES_PER_UNIT[b];e&&(c*=OpenLayers.INCHES_PER_UNIT[d]/e);return c},CLASS_NAME:"OpenLayers.Control.Measure"});OpenLayers.Format.WMC.v1_0_0=OpenLayers.Class(OpenLayers.Format.WMC.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/context http://schemas.opengis.net/context/1.0.0/context.xsd",initialize:function(a){OpenLayers.Format.WMC.v1.prototype.initialize.apply(this,[a])},read_wmc_SRS:function(a,b){var c=this.getChildValue(b);"object"!=typeof a.projections&&(a.projections={});for(var c=c.split(/ +/),d=0,e=c.length;d<e;d++)a.projections[c[d]]=!0},write_wmc_Layer:function(a){var b=OpenLayers.Format.WMC.v1.prototype.write_wmc_Layer.apply(this,
[a]);if(a.srs){var c=[],d;for(d in a.srs)c.push(d);b.appendChild(this.createElementDefaultNS("SRS",c.join(" ")))}b.appendChild(this.write_wmc_FormatList(a));b.appendChild(this.write_wmc_StyleList(a));a.dimensions&&b.appendChild(this.write_wmc_DimensionList(a));b.appendChild(this.write_wmc_LayerExtension(a))},CLASS_NAME:"OpenLayers.Format.WMC.v1_0_0"});OpenLayers.Popup.Framed=OpenLayers.Class(OpenLayers.Popup.Anchored,{imageSrc:null,imageSize:null,isAlphaImage:!1,positionBlocks:null,blocks:null,fixedRelativePosition:!1,initialize:function(a,b,c,d,e,f,g){OpenLayers.Popup.Anchored.prototype.initialize.apply(this,arguments);this.fixedRelativePosition&&(this.updateRelativePosition(),this.calculateRelativePosition=function(){return this.relativePosition});this.contentDiv.style.position="absolute";this.contentDiv.style.zIndex=1;f&&(this.closeDiv.style.zIndex=
1);this.groupDiv.style.position="absolute";this.groupDiv.style.top="0px";this.groupDiv.style.left="0px";this.groupDiv.style.height="100%";this.groupDiv.style.width="100%"},destroy:function(){this.isAlphaImage=this.imageSize=this.imageSrc=null;this.fixedRelativePosition=!1;this.positionBlocks=null;for(var a=0;a<this.blocks.length;a++){var b=this.blocks[a];b.image&&b.div.removeChild(b.image);b.image=null;b.div&&this.groupDiv.removeChild(b.div);b.div=null}this.blocks=null;OpenLayers.Popup.Anchored.prototype.destroy.apply(this,
arguments)},setBackgroundColor:function(){},setBorder:function(){},setOpacity:function(){},setSize:function(a){OpenLayers.Popup.Anchored.prototype.setSize.apply(this,arguments);this.updateBlocks()},updateRelativePosition:function(){this.padding=this.positionBlocks[this.relativePosition].padding;if(this.closeDiv){var a=this.getContentDivPadding();this.closeDiv.style.right=a.right+this.padding.right+"px";this.closeDiv.style.top=a.top+this.padding.top+"px"}this.updateBlocks()},calculateNewPx:function(a){var b=
OpenLayers.Popup.Anchored.prototype.calculateNewPx.apply(this,arguments);return b=b.offset(this.positionBlocks[this.relativePosition].offset)},createBlocks:function(){this.blocks=[];var a=null,b;for(b in this.positionBlocks){a=b;break}a=this.positionBlocks[a];for(b=0;b<a.blocks.length;b++){var c={};this.blocks.push(c);c.div=OpenLayers.Util.createDiv(this.id+"_FrameDecorationDiv_"+b,null,null,null,"absolute",null,"hidden",null);c.image=(this.isAlphaImage?OpenLayers.Util.createAlphaImageDiv:OpenLayers.Util.createImage)(this.id+
"_FrameDecorationImg_"+b,null,this.imageSize,this.imageSrc,"absolute",null,null,null);c.div.appendChild(c.image);this.groupDiv.appendChild(c.div)}},updateBlocks:function(){this.blocks||this.createBlocks();if(this.size&&this.relativePosition){for(var a=this.positionBlocks[this.relativePosition],b=0;b<a.blocks.length;b++){var c=a.blocks[b],d=this.blocks[b],e=c.anchor.left,f=c.anchor.bottom,g=c.anchor.right,h=c.anchor.top,i=isNaN(c.size.w)?this.size.w-(g+e):c.size.w,j=isNaN(c.size.h)?this.size.h-(f+
h):c.size.h;d.div.style.width=(0>i?0:i)+"px";d.div.style.height=(0>j?0:j)+"px";d.div.style.left=null!=e?e+"px":"";d.div.style.bottom=null!=f?f+"px":"";d.div.style.right=null!=g?g+"px":"";d.div.style.top=null!=h?h+"px":"";d.image.style.left=c.position.x+"px";d.image.style.top=c.position.y+"px"}this.contentDiv.style.left=this.padding.left+"px";this.contentDiv.style.top=this.padding.top+"px"}},CLASS_NAME:"OpenLayers.Popup.Framed"});OpenLayers.Popup.FramedCloud=OpenLayers.Class(OpenLayers.Popup.Framed,{contentDisplayClass:"olFramedCloudPopupContent",autoSize:!0,panMapIfOutOfView:!0,imageSize:new OpenLayers.Size(1276,736),isAlphaImage:!1,fixedRelativePosition:!1,positionBlocks:{tl:{offset:new OpenLayers.Pixel(44,0),padding:new OpenLayers.Bounds(8,40,8,9),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,51,22,0),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,
50,0,0),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",19),anchor:new OpenLayers.Bounds(0,32,22,null),position:new OpenLayers.Pixel(0,-631)},{size:new OpenLayers.Size(22,18),anchor:new OpenLayers.Bounds(null,32,0,null),position:new OpenLayers.Pixel(-1238,-632)},{size:new OpenLayers.Size(81,35),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(0,-688)}]},tr:{offset:new OpenLayers.Pixel(-45,0),padding:new OpenLayers.Bounds(8,40,8,9),blocks:[{size:new OpenLayers.Size("auto",
"auto"),anchor:new OpenLayers.Bounds(0,51,22,0),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,50,0,0),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",19),anchor:new OpenLayers.Bounds(0,32,22,null),position:new OpenLayers.Pixel(0,-631)},{size:new OpenLayers.Size(22,19),anchor:new OpenLayers.Bounds(null,32,0,null),position:new OpenLayers.Pixel(-1238,-631)},{size:new OpenLayers.Size(81,35),anchor:new OpenLayers.Bounds(0,
0,null,null),position:new OpenLayers.Pixel(-215,-687)}]},bl:{offset:new OpenLayers.Pixel(45,0),padding:new OpenLayers.Bounds(8,9,8,40),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,21,22,32),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,21,0,32),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",21),anchor:new OpenLayers.Bounds(0,0,22,null),position:new OpenLayers.Pixel(0,-629)},{size:new OpenLayers.Size(22,
21),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(-1238,-629)},{size:new OpenLayers.Size(81,33),anchor:new OpenLayers.Bounds(null,null,0,0),position:new OpenLayers.Pixel(-101,-674)}]},br:{offset:new OpenLayers.Pixel(-44,0),padding:new OpenLayers.Bounds(8,9,8,40),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,21,22,32),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,21,0,32),position:new OpenLayers.Pixel(-1238,
0)},{size:new OpenLayers.Size("auto",21),anchor:new OpenLayers.Bounds(0,0,22,null),position:new OpenLayers.Pixel(0,-629)},{size:new OpenLayers.Size(22,21),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(-1238,-629)},{size:new OpenLayers.Size(81,33),anchor:new OpenLayers.Bounds(0,null,null,0),position:new OpenLayers.Pixel(-311,-674)}]}},minSize:new OpenLayers.Size(105,10),maxSize:new OpenLayers.Size(1200,660),initialize:function(a,b,c,d,e,f,g){this.imageSrc=OpenLayers.Util.getImageLocation("cloud-popup-relative.png");
OpenLayers.Popup.Framed.prototype.initialize.apply(this,arguments);this.contentDiv.className=this.contentDisplayClass},CLASS_NAME:"OpenLayers.Popup.FramedCloud"});OpenLayers.Tile.Image.IFrame={useIFrame:null,draw:function(){if(OpenLayers.Tile.Image.prototype.shouldDraw.call(this)){var a=this.layer.getURL(this.bounds),b=this.useIFrame;this.useIFrame=null!==this.maxGetUrlLength&&!this.layer.async&&a.length>this.maxGetUrlLength;a=b&&!this.useIFrame;b=!b&&this.useIFrame;if(a||b)this.imgDiv&&this.imgDiv.parentNode===this.frame&&this.frame.removeChild(this.imgDiv),this.imgDiv=null,a?(this.blankImageUrl=this._blankImageUrl,this.frame.removeChild(this.frame.firstChild)):
(this._blankImageUrl=this.blankImageUrl,this.blankImageUrl="about:blank")}return OpenLayers.Tile.Image.prototype.draw.apply(this,arguments)},getImage:function(){if(!0===this.useIFrame){if(!this.frame.childNodes.length){var a=document.createElement("div"),b=a.style;b.position="absolute";b.width="100%";b.height="100%";b.zIndex=1;b.backgroundImage="url("+this._blankImageUrl+")";this.frame.appendChild(a)}a=this.id+"_iFrame";9>parseFloat(navigator.appVersion.split("MSIE")[1])?(b=document.createElement('<iframe name="'+
a+'">'),b.style.backgroundColor="#FFFFFF",b.style.filter="chroma(color=#FFFFFF)"):(b=document.createElement("iframe"),b.style.backgroundColor="transparent",b.name=a);b.scrolling="no";b.marginWidth="0px";b.marginHeight="0px";b.frameBorder="0";b.style.position="absolute";b.style.width="100%";b.style.height="100%";1>this.layer.opacity&&OpenLayers.Util.modifyDOMElement(b,null,null,null,null,null,null,this.layer.opacity);this.frame.appendChild(b);return this.imgDiv=b}return OpenLayers.Tile.Image.prototype.getImage.apply(this,
arguments)},createRequestForm:function(){var a=document.createElement("form");a.method="POST";var b=this.layer.params._OLSALT,b=(b?b+"_":"")+this.bounds.toBBOX();a.action=OpenLayers.Util.urlAppend(this.layer.url,b);a.target=this.id+"_iFrame";this.layer.getImageSize();var b=OpenLayers.Util.getParameters(this.url),c,d;for(d in b)c=document.createElement("input"),c.type="hidden",c.name=d,c.value=b[d],a.appendChild(c);return a},setImgSrc:function(a){if(!0===this.useIFrame)if(a){var b=this.createRequestForm();
this.frame.appendChild(b);b.submit();this.frame.removeChild(b)}else this.imgDiv.parentNode===this.frame&&(this.frame.removeChild(this.imgDiv),this.imgDiv=null);else OpenLayers.Tile.Image.prototype.setImgSrc.apply(this,arguments)},onImageLoad:function(){OpenLayers.Tile.Image.prototype.onImageLoad.apply(this,arguments);!0===this.useIFrame&&(this.imgDiv.style.opacity=1,this.frame.style.opacity=this.layer.opacity)},createBackBuffer:function(){var a;!1===this.useIFrame&&(a=OpenLayers.Tile.Image.prototype.createBackBuffer.call(this));
return a}};OpenLayers.Format.SOSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",CLASS_NAME:"OpenLayers.Format.SOSCapabilities"});OpenLayers.Format.SOSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.SOSCapabilities,{namespaces:{ows:"http://www.opengis.net/ows/1.1",sos:"http://www.opengis.net/sos/1.0",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);this.options=a},read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,
[a]));a&&9==a.nodeType&&(a=a.documentElement);var b={};this.readNode(a,b);return b},readers:{gml:OpenLayers.Util.applyDefaults({name:function(a,b){b.name=this.getChildValue(a)},TimePeriod:function(a,b){b.timePeriod={};this.readChildNodes(a,b.timePeriod)},beginPosition:function(a,b){b.beginPosition=this.getChildValue(a)},endPosition:function(a,b){b.endPosition=this.getChildValue(a)}},OpenLayers.Format.GML.v3.prototype.readers.gml),sos:{Capabilities:function(a,b){this.readChildNodes(a,b)},Contents:function(a,
b){b.contents={};this.readChildNodes(a,b.contents)},ObservationOfferingList:function(a,b){b.offeringList={};this.readChildNodes(a,b.offeringList)},ObservationOffering:function(a,b){var c=this.getAttributeNS(a,this.namespaces.gml,"id");b[c]={procedures:[],observedProperties:[],featureOfInterestIds:[],responseFormats:[],resultModels:[],responseModes:[]};this.readChildNodes(a,b[c])},time:function(a,b){b.time={};this.readChildNodes(a,b.time)},procedure:function(a,b){b.procedures.push(this.getAttributeNS(a,
this.namespaces.xlink,"href"))},observedProperty:function(a,b){b.observedProperties.push(this.getAttributeNS(a,this.namespaces.xlink,"href"))},featureOfInterest:function(a,b){b.featureOfInterestIds.push(this.getAttributeNS(a,this.namespaces.xlink,"href"))},responseFormat:function(a,b){b.responseFormats.push(this.getChildValue(a))},resultModel:function(a,b){b.resultModels.push(this.getChildValue(a))},responseMode:function(a,b){b.responseModes.push(this.getChildValue(a))}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},
CLASS_NAME:"OpenLayers.Format.SOSCapabilities.v1_0_0"});OpenLayers.Handler.Pinch=OpenLayers.Class(OpenLayers.Handler,{started:!1,stopDown:!1,pinching:!1,last:null,start:null,touchstart:function(a){var b=!0;this.pinching=!1;OpenLayers.Event.isMultiTouch(a)?(this.started=!0,this.last=this.start={distance:this.getDistance(a.touches),delta:0,scale:1},this.callback("start",[a,this.start]),b=!this.stopDown):(this.started=!1,this.last=this.start=null);OpenLayers.Event.stop(a);return b},touchmove:function(a){if(this.started&&OpenLayers.Event.isMultiTouch(a)){this.pinching=
!0;var b=this.getPinchData(a);this.callback("move",[a,b]);this.last=b;OpenLayers.Event.stop(a)}return!0},touchend:function(a){this.started&&(this.pinching=this.started=!1,this.callback("done",[a,this.start,this.last]),this.last=this.start=null);return!0},activate:function(){var a=!1;OpenLayers.Handler.prototype.activate.apply(this,arguments)&&(this.pinching=!1,a=!0);return a},deactivate:function(){var a=!1;OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.pinching=this.started=
!1,this.last=this.start=null,a=!0);return a},getDistance:function(a){var b=a[0],a=a[1];return Math.sqrt(Math.pow(b.clientX-a.clientX,2)+Math.pow(b.clientY-a.clientY,2))},getPinchData:function(a){a=this.getDistance(a.touches);return{distance:a,delta:this.last.distance-a,scale:a/this.start.distance}},CLASS_NAME:"OpenLayers.Handler.Pinch"});OpenLayers.Control.NavToolbar=OpenLayers.Class(OpenLayers.Control.Panel,{initialize:function(a){OpenLayers.Control.Panel.prototype.initialize.apply(this,[a]);this.addControls([new OpenLayers.Control.Navigation,new OpenLayers.Control.ZoomBox])},draw:function(){var a=OpenLayers.Control.Panel.prototype.draw.apply(this,arguments);null===this.defaultControl&&(this.defaultControl=this.controls[0]);return a},CLASS_NAME:"OpenLayers.Control.NavToolbar"});OpenLayers.Strategy.Refresh=OpenLayers.Class(OpenLayers.Strategy,{force:!1,interval:0,timer:null,activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);a&&(!0===this.layer.visibility&&this.start(),this.layer.events.on({visibilitychanged:this.reset,scope:this}));return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&&this.stop();return a},reset:function(){!0===this.layer.visibility?this.start():this.stop()},start:function(){this.interval&&("number"===
typeof this.interval&&0<this.interval)&&(this.timer=window.setInterval(OpenLayers.Function.bind(this.refresh,this),this.interval))},refresh:function(){this.layer&&(this.layer.refresh&&"function"==typeof this.layer.refresh)&&this.layer.refresh({force:this.force})},stop:function(){null!==this.timer&&(window.clearInterval(this.timer),this.timer=null)},CLASS_NAME:"OpenLayers.Strategy.Refresh"});OpenLayers.Layer.ArcGIS93Rest=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{format:"png"},isBaseLayer:!0,initialize:function(a,b,c,d){var e=[],c=OpenLayers.Util.upperCaseObject(c);e.push(a,b,c,d);OpenLayers.Layer.Grid.prototype.initialize.apply(this,e);OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS));if(this.params.TRANSPARENT&&"true"==this.params.TRANSPARENT.toString().toLowerCase()){if(null==d||!d.isBaseLayer)this.isBaseLayer=!1;"jpg"==this.params.FORMAT&&
(this.params.FORMAT=OpenLayers.Util.alphaHack()?"gif":"png")}},clone:function(a){null==a&&(a=new OpenLayers.Layer.ArcGIS93Rest(this.name,this.url,this.params,this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},getURL:function(a){var a=this.adjustBounds(a),b=this.projection.getCode().split(":"),b=b[b.length-1],c=this.getImageSize(),a={BBOX:a.toBBOX(),SIZE:c.w+","+c.h,F:"image",BBOXSR:b,IMAGESR:b};if(this.layerDefs){var b=[],d;for(d in this.layerDefs)this.layerDefs.hasOwnProperty(d)&&
this.layerDefs[d]&&(b.push(d),b.push(":"),b.push(this.layerDefs[d]),b.push(";"));0<b.length&&(a.LAYERDEFS=b.join(""))}return this.getFullRequestString(a)},setLayerFilter:function(a,b){this.layerDefs||(this.layerDefs={});b?this.layerDefs[a]=b:delete this.layerDefs[a]},clearLayerFilter:function(a){a?delete this.layerDefs[a]:delete this.layerDefs},mergeNewParams:function(a){a=[OpenLayers.Util.upperCaseObject(a)];return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,a)},CLASS_NAME:"OpenLayers.Layer.ArcGIS93Rest"});OpenLayers.Format.WKT=OpenLayers.Class(OpenLayers.Format,{initialize:function(a){this.regExes={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/};OpenLayers.Format.prototype.initialize.apply(this,[a])},read:function(a){var b,c,a=a.replace(/[\n\r]/g," ");if(c=this.regExes.typeStr.exec(a))if(a=c[1].toLowerCase(),c=c[2],this.parse[a]&&(b=this.parse[a].apply(this,[c])),this.internalProjection&&this.externalProjection)if(b&&
"OpenLayers.Feature.Vector"==b.CLASS_NAME)b.geometry.transform(this.externalProjection,this.internalProjection);else if(b&&"geometrycollection"!=a&&"object"==typeof b){a=0;for(c=b.length;a<c;a++)b[a].geometry.transform(this.externalProjection,this.internalProjection)}return b},write:function(a){var b,c;a.constructor==Array?c=!0:(a=[a],c=!1);var d=[];c&&d.push("GEOMETRYCOLLECTION(");for(var e=0,f=a.length;e<f;++e)c&&0<e&&d.push(","),b=a[e].geometry,d.push(this.extractGeometry(b));c&&d.push(")");return d.join("")},
extractGeometry:function(a){var b=a.CLASS_NAME.split(".")[2].toLowerCase();if(!this.extract[b])return null;this.internalProjection&&this.externalProjection&&(a=a.clone(),a.transform(this.internalProjection,this.externalProjection));return("collection"==b?"GEOMETRYCOLLECTION":b.toUpperCase())+"("+this.extract[b].apply(this,[a])+")"},extract:{point:function(a){return a.x+" "+a.y},multipoint:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push("("+this.extract.point.apply(this,[a.components[c]])+
")");return b.join(",")},linestring:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push(this.extract.point.apply(this,[a.components[c]]));return b.join(",")},multilinestring:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push("("+this.extract.linestring.apply(this,[a.components[c]])+")");return b.join(",")},polygon:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push("("+this.extract.linestring.apply(this,[a.components[c]])+")");return b.join(",")},multipolygon:function(a){for(var b=
[],c=0,d=a.components.length;c<d;++c)b.push("("+this.extract.polygon.apply(this,[a.components[c]])+")");return b.join(",")},collection:function(a){for(var b=[],c=0,d=a.components.length;c<d;++c)b.push(this.extractGeometry.apply(this,[a.components[c]]));return b.join(",")}},parse:{point:function(a){a=OpenLayers.String.trim(a).split(this.regExes.spaces);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(a[0],a[1]))},multipoint:function(a){for(var b=OpenLayers.String.trim(a).split(","),
c=[],d=0,e=b.length;d<e;++d)a=b[d].replace(this.regExes.trimParens,"$1"),c.push(this.parse.point.apply(this,[a]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiPoint(c))},linestring:function(a){for(var a=OpenLayers.String.trim(a).split(","),b=[],c=0,d=a.length;c<d;++c)b.push(this.parse.point.apply(this,[a[c]]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(b))},multilinestring:function(a){for(var b=OpenLayers.String.trim(a).split(this.regExes.parenComma),
c=[],d=0,e=b.length;d<e;++d)a=b[d].replace(this.regExes.trimParens,"$1"),c.push(this.parse.linestring.apply(this,[a]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiLineString(c))},polygon:function(a){for(var b,a=OpenLayers.String.trim(a).split(this.regExes.parenComma),c=[],d=0,e=a.length;d<e;++d)b=a[d].replace(this.regExes.trimParens,"$1"),b=this.parse.linestring.apply(this,[b]).geometry,b=new OpenLayers.Geometry.LinearRing(b.components),c.push(b);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon(c))},
multipolygon:function(a){for(var b=OpenLayers.String.trim(a).split(this.regExes.doubleParenComma),c=[],d=0,e=b.length;d<e;++d)a=b[d].replace(this.regExes.trimParens,"$1"),c.push(this.parse.polygon.apply(this,[a]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiPolygon(c))},geometrycollection:function(a){for(var a=a.replace(/,\s*([A-Za-z])/g,"|$1"),a=OpenLayers.String.trim(a).split("|"),b=[],c=0,d=a.length;c<d;++c)b.push(OpenLayers.Format.WKT.prototype.read.apply(this,[a[c]]));
return b}},CLASS_NAME:"OpenLayers.Format.WKT"});OpenLayers.Handler.Hover=OpenLayers.Class(OpenLayers.Handler,{delay:500,pixelTolerance:null,stopMove:!1,px:null,timerId:null,mousemove:function(a){this.passesTolerance(a.xy)&&(this.clearTimer(),this.callback("move",[a]),this.px=a.xy,a=OpenLayers.Util.extend({},a),this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall,this,a),this.delay));return!this.stopMove},mouseout:function(a){OpenLayers.Util.mouseLeft(a,this.map.viewPortDiv)&&(this.clearTimer(),this.callback("move",[a]));return!0},
passesTolerance:function(a){var b=!0;this.pixelTolerance&&this.px&&Math.sqrt(Math.pow(this.px.x-a.x,2)+Math.pow(this.px.y-a.y,2))<this.pixelTolerance&&(b=!1);return b},clearTimer:function(){null!=this.timerId&&(window.clearTimeout(this.timerId),this.timerId=null)},delayedCall:function(a){this.callback("pause",[a])},deactivate:function(){var a=!1;OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.clearTimer(),a=!0);return a},CLASS_NAME:"OpenLayers.Handler.Hover"});OpenLayers.Control.GetFeature=OpenLayers.Class(OpenLayers.Control,{protocol:null,multipleKey:null,toggleKey:null,modifiers:null,multiple:!1,click:!0,single:!0,clickout:!0,toggle:!1,clickTolerance:5,hover:!1,box:!1,maxFeatures:10,features:null,hoverFeature:null,handlerOptions:null,handlers:null,hoverResponse:null,filterType:OpenLayers.Filter.Spatial.BBOX,initialize:function(a){a.handlerOptions=a.handlerOptions||{};OpenLayers.Control.prototype.initialize.apply(this,[a]);this.features={};this.handlers=
{};this.click&&(this.handlers.click=new OpenLayers.Handler.Click(this,{click:this.selectClick},this.handlerOptions.click||{}));this.box&&(this.handlers.box=new OpenLayers.Handler.Box(this,{done:this.selectBox},OpenLayers.Util.extend(this.handlerOptions.box,{boxDivClassName:"olHandlerBoxSelectFeature"})));this.hover&&(this.handlers.hover=new OpenLayers.Handler.Hover(this,{move:this.cancelHover,pause:this.selectHover},OpenLayers.Util.extend(this.handlerOptions.hover,{delay:250,pixelTolerance:2})))},
activate:function(){if(!this.active)for(var a in this.handlers)this.handlers[a].activate();return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){if(this.active)for(var a in this.handlers)this.handlers[a].deactivate();return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},selectClick:function(a){var b=this.pixelToBounds(a.xy);this.setModifiers(a);this.request(b,{single:this.single})},selectBox:function(a){var b;if(a instanceof OpenLayers.Bounds)b=
this.map.getLonLatFromPixel({x:a.left,y:a.bottom}),a=this.map.getLonLatFromPixel({x:a.right,y:a.top}),b=new OpenLayers.Bounds(b.lon,b.lat,a.lon,a.lat);else{if(this.click)return;b=this.pixelToBounds(a)}this.setModifiers(this.handlers.box.dragHandler.evt);this.request(b)},selectHover:function(a){this.request(this.pixelToBounds(a.xy),{single:!0,hover:!0})},cancelHover:function(){this.hoverResponse&&(this.protocol.abort(this.hoverResponse),this.hoverResponse=null,OpenLayers.Element.removeClass(this.map.viewPortDiv,
"olCursorWait"))},request:function(a,b){var b=b||{},c=new OpenLayers.Filter.Spatial({type:this.filterType,value:a});OpenLayers.Element.addClass(this.map.viewPortDiv,"olCursorWait");c=this.protocol.read({maxFeatures:!0==b.single?this.maxFeatures:void 0,filter:c,callback:function(c){c.success()&&(c.features.length?!0==b.single?this.selectBestFeature(c.features,a.getCenterLonLat(),b):this.select(c.features):b.hover?this.hoverSelect():(this.events.triggerEvent("clickout"),this.clickout&&this.unselectAll()));
OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait")},scope:this});!0==b.hover&&(this.hoverResponse=c)},selectBestFeature:function(a,b,c){c=c||{};if(a.length){for(var b=new OpenLayers.Geometry.Point(b.lon,b.lat),d,e,f,g=Number.MAX_VALUE,h=0;h<a.length&&!(d=a[h],d.geometry&&(f=b.distanceTo(d.geometry,{edge:!1}),f<g&&(g=f,e=d,0==g)));++h);!0==c.hover?this.hoverSelect(e):this.select(e||a)}},setModifiers:function(a){this.modifiers={multiple:this.multiple||this.multipleKey&&a[this.multipleKey],
toggle:this.toggle||this.toggleKey&&a[this.toggleKey]}},select:function(a){!this.modifiers.multiple&&!this.modifiers.toggle&&this.unselectAll();OpenLayers.Util.isArray(a)||(a=[a]);var b=this.events.triggerEvent("beforefeaturesselected",{features:a});if(!1!==b){for(var c=[],d,e=0,f=a.length;e<f;++e)d=a[e],this.features[d.fid||d.id]?this.modifiers.toggle&&this.unselect(this.features[d.fid||d.id]):(b=this.events.triggerEvent("beforefeatureselected",{feature:d}),!1!==b&&(this.features[d.fid||d.id]=d,
c.push(d),this.events.triggerEvent("featureselected",{feature:d})));this.events.triggerEvent("featuresselected",{features:c})}},hoverSelect:function(a){var b=a?a.fid||a.id:null,c=this.hoverFeature?this.hoverFeature.fid||this.hoverFeature.id:null;c&&c!=b&&(this.events.triggerEvent("outfeature",{feature:this.hoverFeature}),this.hoverFeature=null);b&&b!=c&&(this.events.triggerEvent("hoverfeature",{feature:a}),this.hoverFeature=a)},unselect:function(a){delete this.features[a.fid||a.id];this.events.triggerEvent("featureunselected",
{feature:a})},unselectAll:function(){for(var a in this.features)this.unselect(this.features[a])},setMap:function(a){for(var b in this.handlers)this.handlers[b].setMap(a);OpenLayers.Control.prototype.setMap.apply(this,arguments)},pixelToBounds:function(a){var b=a.add(-this.clickTolerance/2,this.clickTolerance/2),a=a.add(this.clickTolerance/2,-this.clickTolerance/2),b=this.map.getLonLatFromPixel(b),a=this.map.getLonLatFromPixel(a);return new OpenLayers.Bounds(b.lon,b.lat,a.lon,a.lat)},CLASS_NAME:"OpenLayers.Control.GetFeature"});OpenLayers.Format.QueryStringFilter=function(){function a(a){a=a.replace(/%/g,"\\%");a=a.replace(/\\\\\.(\*)?/g,function(a,b){return b?a:"\\\\_"});a=a.replace(/\\\\\.\*/g,"\\\\%");a=a.replace(/(\\)?\.(\*)?/g,function(a,b,c){return b||c?a:"_"});a=a.replace(/(\\)?\.\*/g,function(a,b){return b?a:"%"});a=a.replace(/\\\./g,".");return a=a.replace(/(\\)?\\\*/g,function(a,b){return b?a:"*"})}var b={};b[OpenLayers.Filter.Comparison.EQUAL_TO]="eq";b[OpenLayers.Filter.Comparison.NOT_EQUAL_TO]="ne";b[OpenLayers.Filter.Comparison.LESS_THAN]=
"lt";b[OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO]="lte";b[OpenLayers.Filter.Comparison.GREATER_THAN]="gt";b[OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO]="gte";b[OpenLayers.Filter.Comparison.LIKE]="ilike";return OpenLayers.Class(OpenLayers.Format,{wildcarded:!1,srsInBBOX:!1,write:function(c,d){var d=d||{},e=c.CLASS_NAME,e=e.substring(e.lastIndexOf(".")+1);switch(e){case "Spatial":switch(c.type){case OpenLayers.Filter.Spatial.BBOX:d.bbox=c.value.toArray();this.srsInBBOX&&c.projection&&
d.bbox.push(c.projection.getCode());break;case OpenLayers.Filter.Spatial.DWITHIN:d.tolerance=c.distance;case OpenLayers.Filter.Spatial.WITHIN:d.lon=c.value.x;d.lat=c.value.y;break;default:OpenLayers.Console.warn("Unknown spatial filter type "+c.type)}break;case "Comparison":e=b[c.type];if(void 0!==e){var f=c.value;c.type==OpenLayers.Filter.Comparison.LIKE&&(f=a(f),this.wildcarded&&(f="%"+f+"%"));d[c.property+"__"+e]=f;d.queryable=d.queryable||[];d.queryable.push(c.property)}else OpenLayers.Console.warn("Unknown comparison filter type "+
c.type);break;case "Logical":if(c.type===OpenLayers.Filter.Logical.AND){e=0;for(f=c.filters.length;e<f;e++)d=this.write(c.filters[e],d)}else OpenLayers.Console.warn("Unsupported logical filter type "+c.type);break;default:OpenLayers.Console.warn("Unknown filter type "+e)}return d},CLASS_NAME:"OpenLayers.Format.QueryStringFilter"})}();OpenLayers.Control.MousePosition=OpenLayers.Class(OpenLayers.Control,{autoActivate:!0,element:null,prefix:"",separator:", ",suffix:"",numDigits:5,granularity:10,emptyString:null,lastXy:null,displayProjection:null,destroy:function(){this.deactivate();OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){return OpenLayers.Control.prototype.activate.apply(this,arguments)?(this.map.events.register("mousemove",this,this.redraw),this.map.events.register("mouseout",this,this.reset),
this.redraw(),!0):!1},deactivate:function(){return OpenLayers.Control.prototype.deactivate.apply(this,arguments)?(this.map.events.unregister("mousemove",this,this.redraw),this.map.events.unregister("mouseout",this,this.reset),this.element.innerHTML="",!0):!1},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.element||(this.div.left="",this.div.top="",this.element=this.div);return this.div},redraw:function(a){var b;if(null==a)this.reset();else if(null==this.lastXy||Math.abs(a.xy.x-
this.lastXy.x)>this.granularity||Math.abs(a.xy.y-this.lastXy.y)>this.granularity)this.lastXy=a.xy;else if(b=this.map.getLonLatFromPixel(a.xy))this.displayProjection&&b.transform(this.map.getProjectionObject(),this.displayProjection),this.lastXy=a.xy,a=this.formatOutput(b),a!=this.element.innerHTML&&(this.element.innerHTML=a)},reset:function(){null!=this.emptyString&&(this.element.innerHTML=this.emptyString)},formatOutput:function(a){var b=parseInt(this.numDigits);return this.prefix+a.lon.toFixed(b)+
this.separator+a.lat.toFixed(b)+this.suffix},CLASS_NAME:"OpenLayers.Control.MousePosition"});OpenLayers.Control.Geolocate=OpenLayers.Class(OpenLayers.Control,{geolocation:navigator.geolocation,bind:!0,watch:!1,geolocationOptions:null,destroy:function(){this.deactivate();OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){return!this.geolocation?(this.events.triggerEvent("locationuncapable"),!1):OpenLayers.Control.prototype.activate.apply(this,arguments)?(this.watch?this.watchId=this.geolocation.watchPosition(OpenLayers.Function.bind(this.geolocate,this),OpenLayers.Function.bind(this.failure,
this),this.geolocationOptions):this.getCurrentLocation(),!0):!1},deactivate:function(){this.active&&null!==this.watchId&&this.geolocation.clearWatch(this.watchId);return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},geolocate:function(a){var b=(new OpenLayers.LonLat(a.coords.longitude,a.coords.latitude)).transform(new OpenLayers.Projection("EPSG:4326"),this.map.getProjectionObject());this.bind&&this.map.setCenter(b);this.events.triggerEvent("locationupdated",{position:a,point:new OpenLayers.Geometry.Point(b.lon,
b.lat)})},getCurrentLocation:function(){if(!this.active||this.watch)return!1;this.geolocation.getCurrentPosition(OpenLayers.Function.bind(this.geolocate,this),OpenLayers.Function.bind(this.failure,this),this.geolocationOptions);return!0},failure:function(a){this.events.triggerEvent("locationfailed",{error:a})},CLASS_NAME:"OpenLayers.Control.Geolocate"});OpenLayers.Tile.UTFGrid=OpenLayers.Class(OpenLayers.Tile,{url:null,utfgridResolution:2,json:null,format:null,destroy:function(){this.clear();OpenLayers.Tile.prototype.destroy.apply(this,arguments)},draw:function(){var a=OpenLayers.Tile.prototype.draw.apply(this,arguments);if(a)if(this.isLoading?(this.abortLoading(),this.events.triggerEvent("reload")):(this.isLoading=!0,this.events.triggerEvent("loadstart")),this.url=this.layer.getURL(this.bounds),this.layer.useJSONP){var b=new OpenLayers.Protocol.Script({url:this.url,
callback:function(a){this.isLoading=false;this.events.triggerEvent("loadend");this.json=a.data},scope:this});b.read();this.request=b}else this.request=OpenLayers.Request.GET({url:this.url,callback:function(a){this.isLoading=false;this.events.triggerEvent("loadend");a.status===200&&this.parseData(a.responseText)},scope:this});else this.unload();return a},abortLoading:function(){this.request&&(this.request.abort(),delete this.request);this.isLoading=!1},getFeatureInfo:function(a,b){var c=null;if(this.json){var d=
this.getFeatureId(a,b);null!==d&&(c={id:d,data:this.json.data[d]})}return c},getFeatureId:function(a,b){var c=null;if(this.json){var d=this.utfgridResolution,d=this.indexFromCharCode(this.json.grid[Math.floor(b/d)].charCodeAt(Math.floor(a/d))),e=this.json.keys;!isNaN(d)&&d in e&&(c=e[d])}return c},indexFromCharCode:function(a){93<=a&&a--;35<=a&&a--;return a-32},parseData:function(a){this.format||(this.format=new OpenLayers.Format.JSON);this.json=this.format.read(a)},clear:function(){this.json=null},
CLASS_NAME:"OpenLayers.Tile.UTFGrid"});OpenLayers.Control.NavigationHistory=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOGGLE,previous:null,previousOptions:null,next:null,nextOptions:null,limit:50,autoActivate:!0,clearOnDeactivate:!1,registry:null,nextStack:null,previousStack:null,listeners:null,restoring:!1,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,[a]);this.registry=OpenLayers.Util.extend({moveend:this.getState},this.registry);a={trigger:OpenLayers.Function.bind(this.previousTrigger,
this),displayClass:this.displayClass+" "+this.displayClass+"Previous"};OpenLayers.Util.extend(a,this.previousOptions);this.previous=new OpenLayers.Control.Button(a);a={trigger:OpenLayers.Function.bind(this.nextTrigger,this),displayClass:this.displayClass+" "+this.displayClass+"Next"};OpenLayers.Util.extend(a,this.nextOptions);this.next=new OpenLayers.Control.Button(a);this.clear()},onPreviousChange:function(a){a&&!this.previous.active?this.previous.activate():!a&&this.previous.active&&this.previous.deactivate()},
onNextChange:function(a){a&&!this.next.active?this.next.activate():!a&&this.next.active&&this.next.deactivate()},destroy:function(){OpenLayers.Control.prototype.destroy.apply(this);this.previous.destroy();this.next.destroy();this.deactivate();for(var a in this)this[a]=null},setMap:function(a){this.map=a;this.next.setMap(a);this.previous.setMap(a)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.next.draw();this.previous.draw()},previousTrigger:function(){var a=this.previousStack.shift(),
b=this.previousStack.shift();void 0!=b?(this.nextStack.unshift(a),this.previousStack.unshift(b),this.restoring=!0,this.restore(b),this.restoring=!1,this.onNextChange(this.nextStack[0],this.nextStack.length),this.onPreviousChange(this.previousStack[1],this.previousStack.length-1)):this.previousStack.unshift(a);return b},nextTrigger:function(){var a=this.nextStack.shift();void 0!=a&&(this.previousStack.unshift(a),this.restoring=!0,this.restore(a),this.restoring=!1,this.onNextChange(this.nextStack[0],
this.nextStack.length),this.onPreviousChange(this.previousStack[1],this.previousStack.length-1));return a},clear:function(){this.previousStack=[];this.previous.deactivate();this.nextStack=[];this.next.deactivate()},getState:function(){return{center:this.map.getCenter(),resolution:this.map.getResolution(),projection:this.map.getProjectionObject(),units:this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units}},restore:function(a){var b,c;if(this.map.getProjectionObject()==
a.projection)c=this.map.getZoomForResolution(a.resolution),b=a.center;else{b=a.center.clone();b.transform(a.projection,this.map.getProjectionObject());c=a.units;var d=this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units;c=this.map.getZoomForResolution((c&&d?OpenLayers.INCHES_PER_UNIT[c]/OpenLayers.INCHES_PER_UNIT[d]:1)*a.resolution)}this.map.setCenter(b,c)},setListeners:function(){this.listeners={};for(var a in this.registry)this.listeners[a]=OpenLayers.Function.bind(function(){if(!this.restoring){this.previousStack.unshift(this.registry[a].apply(this,
arguments));if(1<this.previousStack.length)this.onPreviousChange(this.previousStack[1],this.previousStack.length-1);this.previousStack.length>this.limit+1&&this.previousStack.pop();0<this.nextStack.length&&(this.nextStack=[],this.onNextChange(null,0))}return!0},this)},activate:function(){var a=!1;if(this.map&&OpenLayers.Control.prototype.activate.apply(this)){null==this.listeners&&this.setListeners();for(var b in this.listeners)this.map.events.register(b,this,this.listeners[b]);a=!0;0==this.previousStack.length&&
this.initStack()}return a},initStack:function(){this.map.getCenter()&&this.listeners.moveend()},deactivate:function(){var a=!1;if(this.map&&OpenLayers.Control.prototype.deactivate.apply(this)){for(var b in this.listeners)this.map.events.unregister(b,this,this.listeners[b]);this.clearOnDeactivate&&this.clear();a=!0}return a},CLASS_NAME:"OpenLayers.Control.NavigationHistory"});OpenLayers.Protocol.HTTP=OpenLayers.Class(OpenLayers.Protocol,{url:null,headers:null,params:null,callback:null,scope:null,readWithPOST:!1,updateWithPOST:!1,deleteWithPOST:!1,wildcarded:!1,srsInBBOX:!1,initialize:function(a){a=a||{};this.params={};this.headers={};OpenLayers.Protocol.prototype.initialize.apply(this,arguments);if(!this.filterToParams&&OpenLayers.Format.QueryStringFilter){var b=new OpenLayers.Format.QueryStringFilter({wildcarded:this.wildcarded,srsInBBOX:this.srsInBBOX});this.filterToParams=
function(a,d){return b.write(a,d)}}},destroy:function(){this.headers=this.params=null;OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(a){OpenLayers.Protocol.prototype.read.apply(this,arguments);a=a||{};a.params=OpenLayers.Util.applyDefaults(a.params,this.options.params);a=OpenLayers.Util.applyDefaults(a,this.options);a.filter&&this.filterToParams&&(a.params=this.filterToParams(a.filter,a.params));var b=void 0!==a.readWithPOST?a.readWithPOST:this.readWithPOST,c=new OpenLayers.Protocol.Response({requestType:"read"});
b?(b=a.headers||{},b["Content-Type"]="application/x-www-form-urlencoded",c.priv=OpenLayers.Request.POST({url:a.url,callback:this.createCallback(this.handleRead,c,a),data:OpenLayers.Util.getParameterString(a.params),headers:b})):c.priv=OpenLayers.Request.GET({url:a.url,callback:this.createCallback(this.handleRead,c,a),params:a.params,headers:a.headers});return c},handleRead:function(a,b){this.handleResponse(a,b)},create:function(a,b){var b=OpenLayers.Util.applyDefaults(b,this.options),c=new OpenLayers.Protocol.Response({reqFeatures:a,
requestType:"create"});c.priv=OpenLayers.Request.POST({url:b.url,callback:this.createCallback(this.handleCreate,c,b),headers:b.headers,data:this.format.write(a)});return c},handleCreate:function(a,b){this.handleResponse(a,b)},update:function(a,b){var b=b||{},c=b.url||a.url||this.options.url+"/"+a.fid,b=OpenLayers.Util.applyDefaults(b,this.options),d=new OpenLayers.Protocol.Response({reqFeatures:a,requestType:"update"});d.priv=OpenLayers.Request[this.updateWithPOST?"POST":"PUT"]({url:c,callback:this.createCallback(this.handleUpdate,
d,b),headers:b.headers,data:this.format.write(a)});return d},handleUpdate:function(a,b){this.handleResponse(a,b)},"delete":function(a,b){var b=b||{},c=b.url||a.url||this.options.url+"/"+a.fid,b=OpenLayers.Util.applyDefaults(b,this.options),d=new OpenLayers.Protocol.Response({reqFeatures:a,requestType:"delete"}),e=this.deleteWithPOST?"POST":"DELETE",c={url:c,callback:this.createCallback(this.handleDelete,d,b),headers:b.headers};this.deleteWithPOST&&(c.data=this.format.write(a));d.priv=OpenLayers.Request[e](c);
return d},handleDelete:function(a,b){this.handleResponse(a,b)},handleResponse:function(a,b){var c=a.priv;b.callback&&(200<=c.status&&300>c.status?("delete"!=a.requestType&&(a.features=this.parseFeatures(c)),a.code=OpenLayers.Protocol.Response.SUCCESS):a.code=OpenLayers.Protocol.Response.FAILURE,b.callback.call(b.scope,a))},parseFeatures:function(a){var b=a.responseXML;if(!b||!b.documentElement)b=a.responseText;return!b||0>=b.length?null:this.format.read(b)},commit:function(a,b){function c(a){for(var b=
a.features?a.features.length:0,c=Array(b),e=0;e<b;++e)c[e]=a.features[e].fid;o.insertIds=c;d.apply(this,[a])}function d(a){this.callUserCallback(a,b);n=n&&a.success();f++;f>=m&&b.callback&&(o.code=n?OpenLayers.Protocol.Response.SUCCESS:OpenLayers.Protocol.Response.FAILURE,b.callback.apply(b.scope,[o]))}var b=OpenLayers.Util.applyDefaults(b,this.options),e=[],f=0,g={};g[OpenLayers.State.INSERT]=[];g[OpenLayers.State.UPDATE]=[];g[OpenLayers.State.DELETE]=[];for(var h,i,j=[],k=0,l=a.length;k<l;++k)if(h=
a[k],i=g[h.state])i.push(h),j.push(h);var m=(0<g[OpenLayers.State.INSERT].length?1:0)+g[OpenLayers.State.UPDATE].length+g[OpenLayers.State.DELETE].length,n=!0,o=new OpenLayers.Protocol.Response({reqFeatures:j});h=g[OpenLayers.State.INSERT];0<h.length&&e.push(this.create(h,OpenLayers.Util.applyDefaults({callback:c,scope:this},b.create)));h=g[OpenLayers.State.UPDATE];for(k=h.length-1;0<=k;--k)e.push(this.update(h[k],OpenLayers.Util.applyDefaults({callback:d,scope:this},b.update)));h=g[OpenLayers.State.DELETE];
for(k=h.length-1;0<=k;--k)e.push(this["delete"](h[k],OpenLayers.Util.applyDefaults({callback:d,scope:this},b["delete"])));return e},abort:function(a){a&&a.priv.abort()},callUserCallback:function(a,b){var c=b[a.requestType];c&&c.callback&&c.callback.call(c.scope,a)},CLASS_NAME:"OpenLayers.Protocol.HTTP"});OpenLayers.Strategy.Cluster=OpenLayers.Class(OpenLayers.Strategy,{distance:20,threshold:null,features:null,clusters:null,clustering:!1,resolution:null,activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);if(a)this.layer.events.on({beforefeaturesadded:this.cacheFeatures,moveend:this.cluster,scope:this});return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&&(this.clearCache(),this.layer.events.un({beforefeaturesadded:this.cacheFeatures,moveend:this.cluster,
scope:this}));return a},cacheFeatures:function(a){var b=!0;this.clustering||(this.clearCache(),this.features=a.features,this.cluster(),b=!1);return b},clearCache:function(){this.features=null},cluster:function(a){if((!a||a.zoomChanged)&&this.features)if(a=this.layer.map.getResolution(),a!=this.resolution||!this.clustersExist()){this.resolution=a;for(var a=[],b,c,d,e=0;e<this.features.length;++e)if(b=this.features[e],b.geometry){c=!1;for(var f=a.length-1;0<=f;--f)if(d=a[f],this.shouldCluster(d,b)){this.addToCluster(d,
b);c=!0;break}c||a.push(this.createCluster(this.features[e]))}this.layer.removeAllFeatures();if(0<a.length){if(1<this.threshold){b=a.slice();a=[];e=0;for(d=b.length;e<d;++e)c=b[e],c.attributes.count<this.threshold?Array.prototype.push.apply(a,c.cluster):a.push(c)}this.clustering=!0;this.layer.addFeatures(a);this.clustering=!1}this.clusters=a}},clustersExist:function(){var a=!1;if(this.clusters&&0<this.clusters.length&&this.clusters.length==this.layer.features.length)for(var a=!0,b=0;b<this.clusters.length;++b)if(this.clusters[b]!=
this.layer.features[b]){a=!1;break}return a},shouldCluster:function(a,b){var c=a.geometry.getBounds().getCenterLonLat(),d=b.geometry.getBounds().getCenterLonLat();return Math.sqrt(Math.pow(c.lon-d.lon,2)+Math.pow(c.lat-d.lat,2))/this.resolution<=this.distance},addToCluster:function(a,b){a.cluster.push(b);a.attributes.count+=1},createCluster:function(a){var b=a.geometry.getBounds().getCenterLonLat(),b=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(b.lon,b.lat),{count:1});b.cluster=[a];
return b},CLASS_NAME:"OpenLayers.Strategy.Cluster"});OpenLayers.Strategy.Filter=OpenLayers.Class(OpenLayers.Strategy,{filter:null,cache:null,caching:!1,activate:function(){var a=OpenLayers.Strategy.prototype.activate.apply(this,arguments);a&&(this.cache=[],this.layer.events.on({beforefeaturesadded:this.handleAdd,beforefeaturesremoved:this.handleRemove,scope:this}));return a},deactivate:function(){this.cache=null;this.layer&&this.layer.events&&this.layer.events.un({beforefeaturesadded:this.handleAdd,beforefeaturesremoved:this.handleRemove,scope:this});
return OpenLayers.Strategy.prototype.deactivate.apply(this,arguments)},handleAdd:function(a){if(!this.caching&&this.filter){var b=a.features;a.features=[];for(var c,d=0,e=b.length;d<e;++d)c=b[d],this.filter.evaluate(c)?a.features.push(c):this.cache.push(c)}},handleRemove:function(){this.caching||(this.cache=[])},setFilter:function(a){this.filter=a;a=this.cache;this.cache=[];this.handleAdd({features:this.layer.features});0<this.cache.length&&(this.caching=!0,this.layer.removeFeatures(this.cache.slice()),
this.caching=!1);0<a.length&&(a={features:a},this.handleAdd(a),0<a.features.length&&(this.caching=!0,this.layer.addFeatures(a.features),this.caching=!1))},CLASS_NAME:"OpenLayers.Strategy.Filter"});OpenLayers.Protocol.SOS=function(a){var a=OpenLayers.Util.applyDefaults(a,OpenLayers.Protocol.SOS.DEFAULTS),b=OpenLayers.Protocol.SOS["v"+a.version.replace(/\./g,"_")];if(!b)throw"Unsupported SOS version: "+a.version;return new b(a)};OpenLayers.Protocol.SOS.DEFAULTS={version:"1.0.0"};OpenLayers.Format.WFSDescribeFeatureType=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xsd:"http://www.w3.org/2001/XMLSchema"},readers:{xsd:{schema:function(a,b){var c=[],d={};this.readChildNodes(a,{complexTypes:c,customTypes:d});for(var e=a.attributes,f,g,h=0,i=e.length;h<i;++h)f=e[h],g=f.name,0==g.indexOf("xmlns")?this.setNamespace(g.split(":")[1]||"",f.value):b[g]=f.value;b.featureTypes=c;b.targetPrefix=this.namespaceAlias[b.targetNamespace];h=0;for(i=c.length;h<i;++h)e=c[h],f=d[e.typeName],
d[e.typeName]&&(e.typeName=f.name)},complexType:function(a,b){var c={typeName:a.getAttribute("name")};this.readChildNodes(a,c);b.complexTypes.push(c)},complexContent:function(a,b){this.readChildNodes(a,b)},extension:function(a,b){this.readChildNodes(a,b)},sequence:function(a,b){var c={elements:[]};this.readChildNodes(a,c);b.properties=c.elements},element:function(a,b){if(b.elements){for(var c={},d=a.attributes,e,f=0,g=d.length;f<g;++f)e=d[f],c[e.name]=e.value;d=c.type;d||(d={},this.readChildNodes(a,
d),c.restriction=d,c.type=d.base);c.localType=(d.base||d).split(":").pop();b.elements.push(c)}b.complexTypes&&(d=a.getAttribute("type"),c=d.split(":").pop(),b.customTypes[c]={name:a.getAttribute("name"),type:d})},simpleType:function(a,b){this.readChildNodes(a,b)},restriction:function(a,b){b.base=a.getAttribute("base");this.readRestriction(a,b)}}},readRestriction:function(a,b){for(var c=a.childNodes,d,e,f=0,g=c.length;f<g;++f)d=c[f],1==d.nodeType&&(e=d.nodeName.split(":").pop(),d=d.getAttribute("value"),
b[e]?("string"==typeof b[e]&&(b[e]=[b[e]]),b[e].push(d)):b[e]=d)},read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&&9==a.nodeType&&(a=a.documentElement);var b={};this.readNode(a,b);return b},CLASS_NAME:"OpenLayers.Format.WFSDescribeFeatureType"});OpenLayers.Format.GeoRSS=OpenLayers.Class(OpenLayers.Format.XML,{rssns:"http://backend.userland.com/rss2",featureNS:"http://mapserver.gis.umn.edu/mapserver",georssns:"http://www.georss.org/georss",geons:"http://www.w3.org/2003/01/geo/wgs84_pos#",featureTitle:"Untitled",featureDescription:"No Description",gmlParser:null,xy:!1,createGeometryFromItem:function(a){var b=this.getElementsByTagNameNS(a,this.georssns,"point"),c=this.getElementsByTagNameNS(a,this.geons,"lat"),d=this.getElementsByTagNameNS(a,
this.geons,"long"),e=this.getElementsByTagNameNS(a,this.georssns,"line"),f=this.getElementsByTagNameNS(a,this.georssns,"polygon"),g=this.getElementsByTagNameNS(a,this.georssns,"where"),a=this.getElementsByTagNameNS(a,this.georssns,"box");if(0<b.length||0<c.length&&0<d.length){0<b.length?(c=OpenLayers.String.trim(b[0].firstChild.nodeValue).split(/\s+/),2!=c.length&&(c=OpenLayers.String.trim(b[0].firstChild.nodeValue).split(/\s*,\s*/))):c=[parseFloat(c[0].firstChild.nodeValue),parseFloat(d[0].firstChild.nodeValue)];
var h=new OpenLayers.Geometry.Point(c[1],c[0])}else if(0<e.length){c=OpenLayers.String.trim(this.getChildValue(e[0])).split(/\s+/);d=[];e=0;for(f=c.length;e<f;e+=2)b=new OpenLayers.Geometry.Point(c[e+1],c[e]),d.push(b);h=new OpenLayers.Geometry.LineString(d)}else if(0<f.length){c=OpenLayers.String.trim(this.getChildValue(f[0])).split(/\s+/);d=[];e=0;for(f=c.length;e<f;e+=2)b=new OpenLayers.Geometry.Point(c[e+1],c[e]),d.push(b);h=new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(d)])}else 0<
g.length?(this.gmlParser||(this.gmlParser=new OpenLayers.Format.GML({xy:this.xy})),h=this.gmlParser.parseFeature(g[0]).geometry):0<a.length&&(c=OpenLayers.String.trim(a[0].firstChild.nodeValue).split(/\s+/),d=[],3<c.length&&(b=new OpenLayers.Geometry.Point(c[1],c[0]),d.push(b),b=new OpenLayers.Geometry.Point(c[1],c[2]),d.push(b),b=new OpenLayers.Geometry.Point(c[3],c[2]),d.push(b),b=new OpenLayers.Geometry.Point(c[3],c[0]),d.push(b),b=new OpenLayers.Geometry.Point(c[1],c[0]),d.push(b)),h=new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(d)]));
h&&(this.internalProjection&&this.externalProjection)&&h.transform(this.externalProjection,this.internalProjection);return h},createFeatureFromItem:function(a){var b=this.createGeometryFromItem(a),c=this._getChildValue(a,"*","title",this.featureTitle),d=this._getChildValue(a,"*","description",this._getChildValue(a,"*","content",this._getChildValue(a,"*","summary",this.featureDescription))),e=this._getChildValue(a,"*","link");if(!e)try{e=this.getElementsByTagNameNS(a,"*","link")[0].getAttribute("href")}catch(f){e=
null}a=this._getChildValue(a,"*","id",null);b=new OpenLayers.Feature.Vector(b,{title:c,description:d,link:e});b.fid=a;return b},_getChildValue:function(a,b,c,d){return(a=this.getElementsByTagNameNS(a,b,c))&&a[0]&&a[0].firstChild&&a[0].firstChild.nodeValue?this.getChildValue(a[0]):void 0==d?"":d},read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=null,b=this.getElementsByTagNameNS(a,"*","item");0==b.length&&(b=this.getElementsByTagNameNS(a,"*","entry"));
for(var a=b.length,c=Array(a),d=0;d<a;d++)c[d]=this.createFeatureFromItem(b[d]);return c},write:function(a){var b;if(OpenLayers.Util.isArray(a)){b=this.createElementNS(this.rssns,"rss");for(var c=0,d=a.length;c<d;c++)b.appendChild(this.createFeatureXML(a[c]))}else b=this.createFeatureXML(a);return OpenLayers.Format.XML.prototype.write.apply(this,[b])},createFeatureXML:function(a){var b=this.buildGeometryNode(a.geometry),c=this.createElementNS(this.rssns,"item"),d=this.createElementNS(this.rssns,"title");
d.appendChild(this.createTextNode(a.attributes.title?a.attributes.title:""));var e=this.createElementNS(this.rssns,"description");e.appendChild(this.createTextNode(a.attributes.description?a.attributes.description:""));c.appendChild(d);c.appendChild(e);a.attributes.link&&(d=this.createElementNS(this.rssns,"link"),d.appendChild(this.createTextNode(a.attributes.link)),c.appendChild(d));for(var f in a.attributes)"link"==f||("title"==f||"description"==f)||(d=this.createTextNode(a.attributes[f]),e=f,-1!=
f.search(":")&&(e=f.split(":")[1]),e=this.createElementNS(this.featureNS,"feature:"+e),e.appendChild(d),c.appendChild(e));c.appendChild(b);return c},buildGeometryNode:function(a){this.internalProjection&&this.externalProjection&&(a=a.clone(),a.transform(this.internalProjection,this.externalProjection));var b;if("OpenLayers.Geometry.Polygon"==a.CLASS_NAME)b=this.createElementNS(this.georssns,"georss:polygon"),b.appendChild(this.buildCoordinatesNode(a.components[0]));else if("OpenLayers.Geometry.LineString"==
a.CLASS_NAME)b=this.createElementNS(this.georssns,"georss:line"),b.appendChild(this.buildCoordinatesNode(a));else if("OpenLayers.Geometry.Point"==a.CLASS_NAME)b=this.createElementNS(this.georssns,"georss:point"),b.appendChild(this.buildCoordinatesNode(a));else throw"Couldn't parse "+a.CLASS_NAME;return b},buildCoordinatesNode:function(a){var b=null;a.components&&(b=a.components);if(b){for(var a=b.length,c=Array(a),d=0;d<a;d++)c[d]=b[d].y+" "+b[d].x;b=c.join(" ")}else b=a.y+" "+a.x;return this.createTextNode(b)},
CLASS_NAME:"OpenLayers.Format.GeoRSS"});OpenLayers.Format.WPSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",CLASS_NAME:"OpenLayers.Format.WPSCapabilities"});OpenLayers.Format.WPSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ows:"http://www.opengis.net/ows/1.1",wps:"http://www.opengis.net/wps/1.0.0",xlink:"http://www.w3.org/1999/xlink"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&&9==a.nodeType&&(a=a.documentElement);
var b={};this.readNode(a,b);return b},readers:{wps:{Capabilities:function(a,b){this.readChildNodes(a,b)},ProcessOfferings:function(a,b){b.processOfferings={};this.readChildNodes(a,b.processOfferings)},Process:function(a,b){var c={processVersion:this.getAttributeNS(a,this.namespaces.wps,"processVersion")};this.readChildNodes(a,c);b[c.identifier]=c},Languages:function(a,b){b.languages=[];this.readChildNodes(a,b.languages)},Default:function(a,b){var c={isDefault:!0};this.readChildNodes(a,c);b.push(c)},
Supported:function(a,b){var c={};this.readChildNodes(a,c);b.push(c)}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WPSCapabilities.v1_0_0"});OpenLayers.Control.PinchZoom=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,containerCenter:null,pinchOrigin:null,currentCenter:null,autoActivate:!0,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,arguments);this.handler=new OpenLayers.Handler.Pinch(this,{start:this.pinchStart,move:this.pinchMove,done:this.pinchDone},this.handlerOptions)},activate:function(){var a=OpenLayers.Control.prototype.activate.apply(this,arguments);a&&(this.map.events.on({moveend:this.updateContainerCenter,
scope:this}),this.updateContainerCenter());return a},deactivate:function(){var a=OpenLayers.Control.prototype.deactivate.apply(this,arguments);this.map&&this.map.events&&this.map.events.un({moveend:this.updateContainerCenter,scope:this});return a},updateContainerCenter:function(){var a=this.map.layerContainerDiv;this.containerCenter={x:parseInt(a.style.left,10)+50,y:parseInt(a.style.top,10)+50}},pinchStart:function(a){this.currentCenter=this.pinchOrigin=a.xy},pinchMove:function(a,b){var c=b.scale,
d=this.containerCenter,e=this.pinchOrigin,f=a.xy,g=Math.round(f.x-e.x+(c-1)*(d.x-e.x)),d=Math.round(f.y-e.y+(c-1)*(d.y-e.y));this.applyTransform("translate("+g+"px, "+d+"px) scale("+c+")");this.currentCenter=f},applyTransform:function(a){var b=this.map.layerContainerDiv.style;b["-webkit-transform"]=a;b["-moz-transform"]=a},pinchDone:function(a,b,c){this.applyTransform("");a=this.map.getZoomForResolution(this.map.getResolution()/c.scale,!0);if(a!==this.map.getZoom()||!this.currentCenter.equals(this.pinchOrigin)){var b=
this.map.getResolutionForZoom(a),c=this.map.getLonLatFromPixel(this.pinchOrigin),d=this.currentCenter,e=this.map.getSize();c.lon+=b*(e.w/2-d.x);c.lat-=b*(e.h/2-d.y);this.map.div.clientWidth=this.map.div.clientWidth;this.map.setCenter(c,a)}},CLASS_NAME:"OpenLayers.Control.PinchZoom"});OpenLayers.Control.TouchNavigation=OpenLayers.Class(OpenLayers.Control,{dragPan:null,dragPanOptions:null,pinchZoom:null,pinchZoomOptions:null,clickHandlerOptions:null,documentDrag:!1,autoActivate:!0,initialize:function(a){this.handlers={};OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.deactivate();this.dragPan&&this.dragPan.destroy();this.dragPan=null;this.pinchZoom&&(this.pinchZoom.destroy(),delete this.pinchZoom);OpenLayers.Control.prototype.destroy.apply(this,
arguments)},activate:function(){return OpenLayers.Control.prototype.activate.apply(this,arguments)?(this.dragPan.activate(),this.handlers.click.activate(),this.pinchZoom.activate(),!0):!1},deactivate:function(){return OpenLayers.Control.prototype.deactivate.apply(this,arguments)?(this.dragPan.deactivate(),this.handlers.click.deactivate(),this.pinchZoom.deactivate(),!0):!1},draw:function(){var a={click:this.defaultClick,dblclick:this.defaultDblClick},b=OpenLayers.Util.extend({"double":!0,stopDouble:!0,
pixelTolerance:2},this.clickHandlerOptions);this.handlers.click=new OpenLayers.Handler.Click(this,a,b);this.dragPan=new OpenLayers.Control.DragPan(OpenLayers.Util.extend({map:this.map,documentDrag:this.documentDrag},this.dragPanOptions));this.dragPan.draw();this.pinchZoom=new OpenLayers.Control.PinchZoom(OpenLayers.Util.extend({map:this.map},this.pinchZoomOptions))},defaultClick:function(a){a.lastTouches&&2==a.lastTouches.length&&this.map.zoomOut()},defaultDblClick:function(a){this.map.setCenter(this.map.getLonLatFromViewPortPx(a.xy),
this.map.zoom+1)},CLASS_NAME:"OpenLayers.Control.TouchNavigation"});OpenLayers.Style2=OpenLayers.Class({id:null,name:null,title:null,description:null,layerName:null,isDefault:!1,rules:null,initialize:function(a){OpenLayers.Util.extend(this,a);this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var a=0,b=this.rules.length;a<b;a++)this.rules[a].destroy();delete this.rules},clone:function(){var a=OpenLayers.Util.extend({},this);if(this.rules){a.rules=[];for(var b=0,c=this.rules.length;b<c;++b)a.rules.push(this.rules[b].clone())}return new OpenLayers.Style2(a)},
CLASS_NAME:"OpenLayers.Style2"});OpenLayers.Format.WFS=OpenLayers.Class(OpenLayers.Format.GML,{layer:null,wfsns:"http://www.opengis.net/wfs",ogcns:"http://www.opengis.net/ogc",initialize:function(a,b){OpenLayers.Format.GML.prototype.initialize.apply(this,[a]);this.layer=b;this.layer.featureNS&&(this.featureNS=this.layer.featureNS);this.layer.options.geometry_column&&(this.geometryName=this.layer.options.geometry_column);this.layer.options.typename&&(this.featureName=this.layer.options.typename)},write:function(a){var b=this.createElementNS(this.wfsns,
"wfs:Transaction");b.setAttribute("version","1.0.0");b.setAttribute("service","WFS");for(var c=0;c<a.length;c++)switch(a[c].state){case OpenLayers.State.INSERT:b.appendChild(this.insert(a[c]));break;case OpenLayers.State.UPDATE:b.appendChild(this.update(a[c]));break;case OpenLayers.State.DELETE:b.appendChild(this.remove(a[c]))}return OpenLayers.Format.XML.prototype.write.apply(this,[b])},createFeatureXML:function(a){var b=this.buildGeometryNode(a.geometry),c=this.createElementNS(this.featureNS,"feature:"+
this.geometryName);c.appendChild(b);b=this.createElementNS(this.featureNS,"feature:"+this.featureName);b.appendChild(c);for(var d in a.attributes){var c=this.createTextNode(a.attributes[d]),e=d;-1!=d.search(":")&&(e=d.split(":")[1]);e=this.createElementNS(this.featureNS,"feature:"+e);e.appendChild(c);b.appendChild(e)}return b},insert:function(a){var b=this.createElementNS(this.wfsns,"wfs:Insert");b.appendChild(this.createFeatureXML(a));return b},update:function(a){a.fid||OpenLayers.Console.userError(OpenLayers.i18n("noFID"));
var b=this.createElementNS(this.wfsns,"wfs:Update");b.setAttribute("typeName",this.featurePrefix+":"+this.featureName);b.setAttribute("xmlns:"+this.featurePrefix,this.featureNS);var c=this.createElementNS(this.wfsns,"wfs:Property"),d=this.createElementNS(this.wfsns,"wfs:Name"),e=this.createTextNode(this.geometryName);d.appendChild(e);c.appendChild(d);d=this.createElementNS(this.wfsns,"wfs:Value");e=this.buildGeometryNode(a.geometry);a.layer&&e.setAttribute("srsName",a.layer.projection.getCode());
d.appendChild(e);c.appendChild(d);b.appendChild(c);for(var f in a.attributes)c=this.createElementNS(this.wfsns,"wfs:Property"),d=this.createElementNS(this.wfsns,"wfs:Name"),d.appendChild(this.createTextNode(f)),c.appendChild(d),d=this.createElementNS(this.wfsns,"wfs:Value"),d.appendChild(this.createTextNode(a.attributes[f])),c.appendChild(d),b.appendChild(c);c=this.createElementNS(this.ogcns,"ogc:Filter");f=this.createElementNS(this.ogcns,"ogc:FeatureId");f.setAttribute("fid",a.fid);c.appendChild(f);
b.appendChild(c);return b},remove:function(a){if(!a.fid)return OpenLayers.Console.userError(OpenLayers.i18n("noFID")),!1;var b=this.createElementNS(this.wfsns,"wfs:Delete");b.setAttribute("typeName",this.featurePrefix+":"+this.featureName);b.setAttribute("xmlns:"+this.featurePrefix,this.featureNS);var c=this.createElementNS(this.ogcns,"ogc:Filter"),d=this.createElementNS(this.ogcns,"ogc:FeatureId");d.setAttribute("fid",a.fid);c.appendChild(d);b.appendChild(c);return b},destroy:function(){this.layer=
null},CLASS_NAME:"OpenLayers.Format.WFS"});OpenLayers.Format.SLD.v1_0_0_GeoServer=OpenLayers.Class(OpenLayers.Format.SLD.v1_0_0,{version:"1.0.0",profile:"GeoServer",readers:OpenLayers.Util.applyDefaults({sld:OpenLayers.Util.applyDefaults({Priority:function(a,b){var c=this.readers.ogc._expression.call(this,a);c&&(b.priority=c)},VendorOption:function(a,b){b.vendorOptions||(b.vendorOptions={});b.vendorOptions[a.getAttribute("name")]=this.getChildValue(a)}},OpenLayers.Format.SLD.v1_0_0.prototype.readers.sld)},OpenLayers.Format.SLD.v1_0_0.prototype.readers),
writers:OpenLayers.Util.applyDefaults({sld:OpenLayers.Util.applyDefaults({Priority:function(a){return this.writers.sld._OGCExpression.call(this,"sld:Priority",a)},VendorOption:function(a){return this.createElementNSPlus("sld:VendorOption",{attributes:{name:a.name},value:a.value})},TextSymbolizer:function(a){var b=OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld.TextSymbolizer.apply(this,arguments);!1!==a.graphic&&(a.externalGraphic||a.graphicName)&&this.writeNode("Graphic",a,b);"priority"in a&&
this.writeNode("Priority",a.priority,b);return this.addVendorOptions(b,a)},PointSymbolizer:function(a){return this.addVendorOptions(OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld.PointSymbolizer.apply(this,arguments),a)},LineSymbolizer:function(a){return this.addVendorOptions(OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld.LineSymbolizer.apply(this,arguments),a)},PolygonSymbolizer:function(a){return this.addVendorOptions(OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld.PolygonSymbolizer.apply(this,
arguments),a)}},OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld)},OpenLayers.Format.SLD.v1_0_0.prototype.writers),addVendorOptions:function(a,b){if(b.vendorOptions)for(var c in b.vendorOptions)this.writeNode("VendorOption",{name:c,value:b.vendorOptions[c]},a);return a},CLASS_NAME:"OpenLayers.Format.SLD.v1_0_0_GeoServer"});OpenLayers.Layer.Boxes=OpenLayers.Class(OpenLayers.Layer.Markers,{drawMarker:function(a){var b=this.map.getLayerPxFromLonLat({lon:a.bounds.left,lat:a.bounds.top}),c=this.map.getLayerPxFromLonLat({lon:a.bounds.right,lat:a.bounds.bottom});null==c||null==b?a.display(!1):(b=a.draw(b,{w:Math.max(1,c.x-b.x),h:Math.max(1,c.y-b.y)}),a.drawn||(this.div.appendChild(b),a.drawn=!0))},removeMarker:function(a){OpenLayers.Util.removeItem(this.markers,a);null!=a.div&&a.div.parentNode==this.div&&this.div.removeChild(a.div)},
CLASS_NAME:"OpenLayers.Layer.Boxes"});OpenLayers.Format.WFSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.WFSCapabilities.v1,{readers:{wfs:OpenLayers.Util.applyDefaults({Service:function(a,b){b.service={};this.readChildNodes(a,b.service)},Fees:function(a,b){var c=this.getChildValue(a);c&&"none"!=c.toLowerCase()&&(b.fees=c)},AccessConstraints:function(a,b){var c=this.getChildValue(a);c&&"none"!=c.toLowerCase()&&(b.accessConstraints=c)},OnlineResource:function(a,b){var c=this.getChildValue(a);c&&"none"!=c.toLowerCase()&&(b.onlineResource=
c)},Keywords:function(a,b){var c=this.getChildValue(a);c&&"none"!=c.toLowerCase()&&(b.keywords=c.split(", "))},Capability:function(a,b){b.capability={};this.readChildNodes(a,b.capability)},Request:function(a,b){b.request={};this.readChildNodes(a,b.request)},GetFeature:function(a,b){b.getfeature={href:{},formats:[]};this.readChildNodes(a,b.getfeature)},ResultFormat:function(a,b){for(var c=a.childNodes,d,e=0;e<c.length;e++)d=c[e],1==d.nodeType&&b.formats.push(d.nodeName)},DCPType:function(a,b){this.readChildNodes(a,
b)},HTTP:function(a,b){this.readChildNodes(a,b.href)},Get:function(a,b){b.get=a.getAttribute("onlineResource")},Post:function(a,b){b.post=a.getAttribute("onlineResource")},SRS:function(a,b){var c=this.getChildValue(a);c&&(b.srs=c)}},OpenLayers.Format.WFSCapabilities.v1.prototype.readers.wfs)},CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1_0_0"});OpenLayers.Format.WMSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.1",profile:null,CLASS_NAME:"OpenLayers.Format.WMSCapabilities"});OpenLayers.Format.WMSCapabilities.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{wms:"http://www.opengis.net/wms",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"wms",read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=a;a&&9==a.nodeType&&(a=a.documentElement);var c={};this.readNode(a,c);void 0===c.service&&(a=new OpenLayers.Format.OGCExceptionReport,c.error=a.read(b));return c},readers:{wms:{Service:function(a,
b){b.service={};this.readChildNodes(a,b.service)},Name:function(a,b){b.name=this.getChildValue(a)},Title:function(a,b){b.title=this.getChildValue(a)},Abstract:function(a,b){b["abstract"]=this.getChildValue(a)},BoundingBox:function(a){var b={};b.bbox=[parseFloat(a.getAttribute("minx")),parseFloat(a.getAttribute("miny")),parseFloat(a.getAttribute("maxx")),parseFloat(a.getAttribute("maxy"))];a={x:parseFloat(a.getAttribute("resx")),y:parseFloat(a.getAttribute("resy"))};if(!isNaN(a.x)||!isNaN(a.y))b.res=
a;return b},OnlineResource:function(a,b){b.href=this.getAttributeNS(a,this.namespaces.xlink,"href")},ContactInformation:function(a,b){b.contactInformation={};this.readChildNodes(a,b.contactInformation)},ContactPersonPrimary:function(a,b){b.personPrimary={};this.readChildNodes(a,b.personPrimary)},ContactPerson:function(a,b){b.person=this.getChildValue(a)},ContactOrganization:function(a,b){b.organization=this.getChildValue(a)},ContactPosition:function(a,b){b.position=this.getChildValue(a)},ContactAddress:function(a,
b){b.contactAddress={};this.readChildNodes(a,b.contactAddress)},AddressType:function(a,b){b.type=this.getChildValue(a)},Address:function(a,b){b.address=this.getChildValue(a)},City:function(a,b){b.city=this.getChildValue(a)},StateOrProvince:function(a,b){b.stateOrProvince=this.getChildValue(a)},PostCode:function(a,b){b.postcode=this.getChildValue(a)},Country:function(a,b){b.country=this.getChildValue(a)},ContactVoiceTelephone:function(a,b){b.phone=this.getChildValue(a)},ContactFacsimileTelephone:function(a,
b){b.fax=this.getChildValue(a)},ContactElectronicMailAddress:function(a,b){b.email=this.getChildValue(a)},Fees:function(a,b){var c=this.getChildValue(a);c&&"none"!=c.toLowerCase()&&(b.fees=c)},AccessConstraints:function(a,b){var c=this.getChildValue(a);c&&"none"!=c.toLowerCase()&&(b.accessConstraints=c)},Capability:function(a,b){b.capability={nestedLayers:[],layers:[]};this.readChildNodes(a,b.capability)},Request:function(a,b){b.request={};this.readChildNodes(a,b.request)},GetCapabilities:function(a,
b){b.getcapabilities={formats:[]};this.readChildNodes(a,b.getcapabilities)},Format:function(a,b){OpenLayers.Util.isArray(b.formats)?b.formats.push(this.getChildValue(a)):b.format=this.getChildValue(a)},DCPType:function(a,b){this.readChildNodes(a,b)},HTTP:function(a,b){this.readChildNodes(a,b)},Get:function(a,b){b.get={};this.readChildNodes(a,b.get);b.href||(b.href=b.get.href)},Post:function(a,b){b.post={};this.readChildNodes(a,b.post);b.href||(b.href=b.get.href)},GetMap:function(a,b){b.getmap={formats:[]};
this.readChildNodes(a,b.getmap)},GetFeatureInfo:function(a,b){b.getfeatureinfo={formats:[]};this.readChildNodes(a,b.getfeatureinfo)},Exception:function(a,b){b.exception={formats:[]};this.readChildNodes(a,b.exception)},Layer:function(a,b){var c,d;b.capability?(d=b.capability,c=b):d=b;var e=a.getAttributeNode("queryable"),f=e&&e.specified?a.getAttribute("queryable"):null,g=(e=a.getAttributeNode("cascaded"))&&e.specified?a.getAttribute("cascaded"):null,e=(e=a.getAttributeNode("opaque"))&&e.specified?
a.getAttribute("opaque"):null,h=a.getAttribute("noSubsets"),i=a.getAttribute("fixedWidth"),j=a.getAttribute("fixedHeight"),k=c||{},l=OpenLayers.Util.extend;c={nestedLayers:[],styles:c?[].concat(c.styles):[],srs:c?l({},k.srs):{},metadataURLs:[],bbox:c?l({},k.bbox):{},llbbox:k.llbbox,dimensions:c?l({},k.dimensions):{},authorityURLs:c?l({},k.authorityURLs):{},identifiers:{},keywords:[],queryable:f&&""!==f?"1"===f||"true"===f:k.queryable||!1,cascaded:null!==g?parseInt(g):k.cascaded||0,opaque:e?"1"===
e||"true"===e:k.opaque||!1,noSubsets:null!==h?"1"===h||"true"===h:k.noSubsets||!1,fixedWidth:null!=i?parseInt(i):k.fixedWidth||0,fixedHeight:null!=j?parseInt(j):k.fixedHeight||0,minScale:k.minScale,maxScale:k.maxScale,attribution:k.attribution};b.nestedLayers.push(c);c.capability=d;this.readChildNodes(a,c);delete c.capability;if(c.name&&(f=c.name.split(":"),g=d.request,e=g.getfeatureinfo,0<f.length&&(c.prefix=f[0]),d.layers.push(c),void 0===c.formats&&(c.formats=g.getmap.formats),void 0===c.infoFormats&&
e))c.infoFormats=e.formats},Attribution:function(a,b){b.attribution={};this.readChildNodes(a,b.attribution)},LogoURL:function(a,b){b.logo={width:a.getAttribute("width"),height:a.getAttribute("height")};this.readChildNodes(a,b.logo)},Style:function(a,b){var c={};b.styles.push(c);this.readChildNodes(a,c)},LegendURL:function(a,b){var c={width:a.getAttribute("width"),height:a.getAttribute("height")};b.legend=c;this.readChildNodes(a,c)},MetadataURL:function(a,b){var c={type:a.getAttribute("type")};b.metadataURLs.push(c);
this.readChildNodes(a,c)},DataURL:function(a,b){b.dataURL={};this.readChildNodes(a,b.dataURL)},FeatureListURL:function(a,b){b.featureListURL={};this.readChildNodes(a,b.featureListURL)},AuthorityURL:function(a,b){var c=a.getAttribute("name"),d={};this.readChildNodes(a,d);b.authorityURLs[c]=d.href},Identifier:function(a,b){var c=a.getAttribute("authority");b.identifiers[c]=this.getChildValue(a)},KeywordList:function(a,b){this.readChildNodes(a,b)},SRS:function(a,b){b.srs[this.getChildValue(a)]=!0}}},
CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1"});OpenLayers.Format.WMSCapabilities.v1_3=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1,{readers:{wms:OpenLayers.Util.applyDefaults({WMS_Capabilities:function(a,b){this.readChildNodes(a,b)},LayerLimit:function(a,b){b.layerLimit=parseInt(this.getChildValue(a))},MaxWidth:function(a,b){b.maxWidth=parseInt(this.getChildValue(a))},MaxHeight:function(a,b){b.maxHeight=parseInt(this.getChildValue(a))},BoundingBox:function(a,b){var c=OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms.BoundingBox.apply(this,
[a,b]);c.srs=a.getAttribute("CRS");b.bbox[c.srs]=c},CRS:function(a,b){this.readers.wms.SRS.apply(this,[a,b])},EX_GeographicBoundingBox:function(a,b){b.llbbox=[];this.readChildNodes(a,b.llbbox)},westBoundLongitude:function(a,b){b[0]=this.getChildValue(a)},eastBoundLongitude:function(a,b){b[2]=this.getChildValue(a)},southBoundLatitude:function(a,b){b[1]=this.getChildValue(a)},northBoundLatitude:function(a,b){b[3]=this.getChildValue(a)},MinScaleDenominator:function(a,b){b.maxScale=parseFloat(this.getChildValue(a)).toPrecision(16)},
MaxScaleDenominator:function(a,b){b.minScale=parseFloat(this.getChildValue(a)).toPrecision(16)},Dimension:function(a,b){var c={name:a.getAttribute("name").toLowerCase(),units:a.getAttribute("units"),unitsymbol:a.getAttribute("unitSymbol"),nearestVal:"1"===a.getAttribute("nearestValue"),multipleVal:"1"===a.getAttribute("multipleValues"),"default":a.getAttribute("default")||"",current:"1"===a.getAttribute("current"),values:this.getChildValue(a).split(",")};b.dimensions[c.name]=c},Keyword:function(a,
b){var c={value:this.getChildValue(a),vocabulary:a.getAttribute("vocabulary")};b.keywords&&b.keywords.push(c)}},OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms),sld:{UserDefinedSymbolization:function(a,b){this.readers.wms.UserDefinedSymbolization.apply(this,[a,b]);b.userSymbols.inlineFeature=1==parseInt(a.getAttribute("InlineFeature"));b.userSymbols.remoteWCS=1==parseInt(a.getAttribute("RemoteWCS"))},DescribeLayer:function(a,b){this.readers.wms.DescribeLayer.apply(this,[a,b])},GetLegendGraphic:function(a,
b){this.readers.wms.GetLegendGraphic.apply(this,[a,b])}}},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_3"});OpenLayers.Layer.Zoomify=OpenLayers.Class(OpenLayers.Layer.Grid,{size:null,isBaseLayer:!0,standardTileSize:256,tileOriginCorner:"tl",numberOfTiers:0,tileCountUpToTier:null,tierSizeInTiles:null,tierImageSize:null,initialize:function(a,b,c,d){this.initializeZoomify(c);OpenLayers.Layer.Grid.prototype.initialize.apply(this,[a,b,c,{},d])},initializeZoomify:function(a){var a=a.clone(),b=new OpenLayers.Size(Math.ceil(a.w/this.standardTileSize),Math.ceil(a.h/this.standardTileSize));this.tierSizeInTiles=[b];
for(this.tierImageSize=[a];a.w>this.standardTileSize||a.h>this.standardTileSize;)a=new OpenLayers.Size(Math.floor(a.w/2),Math.floor(a.h/2)),b=new OpenLayers.Size(Math.ceil(a.w/this.standardTileSize),Math.ceil(a.h/this.standardTileSize)),this.tierSizeInTiles.push(b),this.tierImageSize.push(a);this.tierSizeInTiles.reverse();this.tierImageSize.reverse();this.numberOfTiers=this.tierSizeInTiles.length;this.tileCountUpToTier=[0];for(a=1;a<this.numberOfTiers;a++)this.tileCountUpToTier.push(this.tierSizeInTiles[a-
1].w*this.tierSizeInTiles[a-1].h+this.tileCountUpToTier[a-1])},destroy:function(){OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments);this.tileCountUpToTier.length=0;this.tierSizeInTiles.length=0;this.tierImageSize.length=0},clone:function(a){null==a&&(a=new OpenLayers.Layer.Zoomify(this.name,this.url,this.size,this.options));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},getURL:function(a){var a=this.adjustBounds(a),b=this.map.getResolution(),c=Math.round((a.left-this.tileOrigin.lon)/
(b*this.tileSize.w)),a=Math.round((this.tileOrigin.lat-a.top)/(b*this.tileSize.h)),b=this.map.getZoom(),c="TileGroup"+Math.floor((c+a*this.tierSizeInTiles[b].w+this.tileCountUpToTier[b])/256)+"/"+b+"-"+c+"-"+a+".jpg",a=this.url;OpenLayers.Util.isArray(a)&&(a=this.selectUrl(c,a));return a+c},getImageSize:function(){if(0<arguments.length){var a=this.adjustBounds(arguments[0]),b=this.map.getResolution(),c=Math.round((a.left-this.tileOrigin.lon)/(b*this.tileSize.w)),a=Math.round((this.tileOrigin.lat-
a.top)/(b*this.tileSize.h)),b=this.map.getZoom(),d=this.standardTileSize,e=this.standardTileSize;c==this.tierSizeInTiles[b].w-1&&(d=this.tierImageSize[b].w%this.standardTileSize);a==this.tierSizeInTiles[b].h-1&&(e=this.tierImageSize[b].h%this.standardTileSize);return new OpenLayers.Size(d,e)}return this.tileSize},setMap:function(a){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments);this.tileOrigin=new OpenLayers.LonLat(this.map.maxExtent.left,this.map.maxExtent.top)},calculateGridLayout:function(a,
b,c){var d=c*this.tileSize.w,c=c*this.tileSize.h,e=a.left-b.lon,f=Math.floor(e/d)-this.buffer,a=b.lat-a.top+c,g=Math.floor(a/c)-this.buffer;return{tilelon:d,tilelat:c,tileoffsetlon:b.lon+f*d,tileoffsetlat:b.lat-c*g,tileoffsetx:-(e/d-f)*this.tileSize.w,tileoffsety:(g-a/c)*this.tileSize.h}},CLASS_NAME:"OpenLayers.Layer.Zoomify"});OpenLayers.Layer.MapServer=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{mode:"map",map_imagetype:"png"},initialize:function(a,b,c,d){OpenLayers.Layer.Grid.prototype.initialize.apply(this,arguments);this.params=OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS);if(null==d||null==d.isBaseLayer)this.isBaseLayer="true"!=this.params.transparent&&!0!=this.params.transparent},clone:function(a){null==a&&(a=new OpenLayers.Layer.MapServer(this.name,this.url,this.params,this.getOptions()));
return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},getURL:function(a){var a=this.adjustBounds(a),a=[a.left,a.bottom,a.right,a.top],b=this.getImageSize();return this.getFullRequestString({mapext:a,imgext:a,map_size:[b.w,b.h],imgx:b.w/2,imgy:b.h/2,imgxy:[b.w,b.h]})},getFullRequestString:function(a,b){var c=null==b?this.url:b,d=OpenLayers.Util.extend({},this.params),d=OpenLayers.Util.extend(d,a),e=OpenLayers.Util.getParameterString(d);OpenLayers.Util.isArray(c)&&(c=this.selectUrl(e,c));
var e=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(c)),f;for(f in d)f.toUpperCase()in e&&delete d[f];e=OpenLayers.Util.getParameterString(d);d=c;e=e.replace(/,/g,"+");""!=e&&(f=c.charAt(c.length-1),d="&"==f||"?"==f?d+e:-1==c.indexOf("?")?d+("?"+e):d+("&"+e));return d},CLASS_NAME:"OpenLayers.Layer.MapServer"});OpenLayers.Renderer.VML=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"urn:schemas-microsoft-com:vml",symbolCache:{},offset:null,initialize:function(a){if(this.supported()){if(!document.namespaces.olv){document.namespaces.add("olv",this.xmlns);for(var b=document.createStyleSheet(),c="shape rect oval fill stroke imagedata group textbox".split(" "),d=0,e=c.length;d<e;d++)b.addRule("olv\\:"+c[d],"behavior: url(#default#VML); position: absolute; display: inline-block;")}OpenLayers.Renderer.Elements.prototype.initialize.apply(this,
arguments)}},supported:function(){return!!document.namespaces},setExtent:function(a,b){var c=OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments),d=this.getResolution(),e=a.left/d|0,d=a.top/d-this.size.h|0;b||!this.offset?(this.offset={x:e,y:d},d=e=0):(e-=this.offset.x,d-=this.offset.y);this.root.coordorigin=e-this.xOffset+" "+d;for(var e=[this.root,this.vectorRoot,this.textRoot],f=0,g=e.length;f<g;++f)d=e[f],d.coordsize=this.size.w+" "+this.size.h;this.root.style.flip="y";return c},
setSize:function(a){OpenLayers.Renderer.prototype.setSize.apply(this,arguments);for(var b=[this.rendererRoot,this.root,this.vectorRoot,this.textRoot],c=this.size.w+"px",d=this.size.h+"px",e,f=0,g=b.length;f<g;++f)e=b[f],e.style.width=c,e.style.height=d},getNodeType:function(a,b){var c=null;switch(a.CLASS_NAME){case "OpenLayers.Geometry.Point":c=b.externalGraphic?"olv:rect":this.isComplexSymbol(b.graphicName)?"olv:shape":"olv:oval";break;case "OpenLayers.Geometry.Rectangle":c="olv:rect";break;case "OpenLayers.Geometry.LineString":case "OpenLayers.Geometry.LinearRing":case "OpenLayers.Geometry.Polygon":case "OpenLayers.Geometry.Curve":c=
"olv:shape"}return c},setStyle:function(a,b,c,d){var b=b||a._style,c=c||a._options,e=b.fillColor;if("OpenLayers.Geometry.Point"===a._geometryClass)if(b.externalGraphic){c.isFilled=!0;b.graphicTitle&&(a.title=b.graphicTitle);var e=b.graphicWidth||b.graphicHeight,f=b.graphicHeight||b.graphicWidth,e=e?e:2*b.pointRadius,f=f?f:2*b.pointRadius,g=this.getResolution(),h=void 0!=b.graphicXOffset?b.graphicXOffset:-(0.5*e),i=void 0!=b.graphicYOffset?b.graphicYOffset:-(0.5*f);a.style.left=((d.x-this.featureDx)/
g-this.offset.x+h|0)+"px";a.style.top=(d.y/g-this.offset.y-(i+f)|0)+"px";a.style.width=e+"px";a.style.height=f+"px";a.style.flip="y";e="none";c.isStroked=!1}else this.isComplexSymbol(b.graphicName)?(f=this.importSymbol(b.graphicName),a.path=f.path,a.coordorigin=f.left+","+f.bottom,f=f.size,a.coordsize=f+","+f,this.drawCircle(a,d,b.pointRadius),a.style.flip="y"):this.drawCircle(a,d,b.pointRadius);c.isFilled?a.fillcolor=e:a.filled="false";d=a.getElementsByTagName("fill");d=0==d.length?null:d[0];if(c.isFilled){d||
(d=this.createNode("olv:fill",a.id+"_fill"));d.opacity=b.fillOpacity;if("OpenLayers.Geometry.Point"===a._geometryClass&&b.externalGraphic&&(b.graphicOpacity&&(d.opacity=b.graphicOpacity),d.src=b.externalGraphic,d.type="frame",!b.graphicWidth||!b.graphicHeight))d.aspect="atmost";d.parentNode!=a&&a.appendChild(d)}else d&&a.removeChild(d);e=b.rotation;if(void 0!==e||void 0!==a._rotation)a._rotation=e,b.externalGraphic?(this.graphicRotate(a,h,i,b),d.opacity=0):"OpenLayers.Geometry.Point"===a._geometryClass&&
(a.style.rotation=e||0);h=a.getElementsByTagName("stroke");h=0==h.length?null:h[0];if(c.isStroked){if(h||(h=this.createNode("olv:stroke",a.id+"_stroke"),a.appendChild(h)),h.on=!0,h.color=b.strokeColor,h.weight=b.strokeWidth+"px",h.opacity=b.strokeOpacity,h.endcap="butt"==b.strokeLinecap?"flat":b.strokeLinecap||"round",b.strokeDashstyle)h.dashstyle=this.dashStyle(b)}else a.stroked=!1,h&&(h.on=!1);"inherit"!=b.cursor&&null!=b.cursor&&(a.style.cursor=b.cursor);return a},graphicRotate:function(a,b,c,
d){var d=d||a._style,e=d.rotation||0,f,g;if(!d.graphicWidth||!d.graphicHeight){var h=new Image;h.onreadystatechange=OpenLayers.Function.bind(function(){if("complete"==h.readyState||"interactive"==h.readyState)f=h.width/h.height,g=Math.max(2*d.pointRadius,d.graphicWidth||0,d.graphicHeight||0),b*=f,d.graphicWidth=g*f,d.graphicHeight=g,this.graphicRotate(a,b,c,d)},this);h.src=d.externalGraphic}else{g=Math.max(d.graphicWidth,d.graphicHeight);f=d.graphicWidth/d.graphicHeight;var i=Math.round(d.graphicWidth||
g*f),j=Math.round(d.graphicHeight||g);a.style.width=i+"px";a.style.height=j+"px";var k=document.getElementById(a.id+"_image");k||(k=this.createNode("olv:imagedata",a.id+"_image"),a.appendChild(k));k.style.width=i+"px";k.style.height=j+"px";k.src=d.externalGraphic;k.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='', sizingMethod='scale')";k=e*Math.PI/180;e=Math.sin(k);k=Math.cos(k);e="progid:DXImageTransform.Microsoft.Matrix(M11="+k+",M12="+-e+",M21="+e+",M22="+k+",SizingMethod='auto expand')\n";
(k=d.graphicOpacity||d.fillOpacity)&&1!=k&&(e+="progid:DXImageTransform.Microsoft.BasicImage(opacity="+k+")\n");a.style.filter=e;e=new OpenLayers.Geometry.Point(-b,-c);i=(new OpenLayers.Bounds(0,0,i,j)).toGeometry();i.rotate(d.rotation,e);i=i.getBounds();a.style.left=Math.round(parseInt(a.style.left)+i.left)+"px";a.style.top=Math.round(parseInt(a.style.top)-i.bottom)+"px"}},postDraw:function(a){a.style.visibility="visible";var b=a._style.fillColor,c=a._style.strokeColor;"none"==b&&a.fillcolor!=b&&
(a.fillcolor=b);"none"==c&&a.strokecolor!=c&&(a.strokecolor=c)},setNodeDimension:function(a,b){var c=b.getBounds();if(c){var d=this.getResolution(),c=new OpenLayers.Bounds((c.left-this.featureDx)/d-this.offset.x|0,c.bottom/d-this.offset.y|0,(c.right-this.featureDx)/d-this.offset.x|0,c.top/d-this.offset.y|0);a.style.left=c.left+"px";a.style.top=c.top+"px";a.style.width=c.getWidth()+"px";a.style.height=c.getHeight()+"px";a.coordorigin=c.left+" "+c.top;a.coordsize=c.getWidth()+" "+c.getHeight()}},dashStyle:function(a){a=
a.strokeDashstyle;switch(a){case "solid":case "dot":case "dash":case "dashdot":case "longdash":case "longdashdot":return a;default:return a=a.split(/[ ,]/),2==a.length?1*a[0]>=2*a[1]?"longdash":1==a[0]||1==a[1]?"dot":"dash":4==a.length?1*a[0]>=2*a[1]?"longdashdot":"dashdot":"solid"}},createNode:function(a,b){var c=document.createElement(a);b&&(c.id=b);c.unselectable="on";c.onselectstart=OpenLayers.Function.False;return c},nodeTypeCompare:function(a,b){var c=b,d=c.indexOf(":");-1!=d&&(c=c.substr(d+
1));var e=a.nodeName,d=e.indexOf(":");-1!=d&&(e=e.substr(d+1));return c==e},createRenderRoot:function(){return this.nodeFactory(this.container.id+"_vmlRoot","div")},createRoot:function(a){return this.nodeFactory(this.container.id+a,"olv:group")},drawPoint:function(a,b){return this.drawCircle(a,b,1)},drawCircle:function(a,b,c){if(!isNaN(b.x)&&!isNaN(b.y)){var d=this.getResolution();a.style.left=((b.x-this.featureDx)/d-this.offset.x|0)-c+"px";a.style.top=(b.y/d-this.offset.y|0)-c+"px";b=2*c;a.style.width=
b+"px";a.style.height=b+"px";return a}return!1},drawLineString:function(a,b){return this.drawLine(a,b,!1)},drawLinearRing:function(a,b){return this.drawLine(a,b,!0)},drawLine:function(a,b,c){this.setNodeDimension(a,b);for(var d=this.getResolution(),e=b.components.length,f=Array(e),g,h,i=0;i<e;i++)g=b.components[i],h=(g.x-this.featureDx)/d-this.offset.x|0,g=g.y/d-this.offset.y|0,f[i]=" "+h+","+g+" l ";a.path="m"+f.join("")+(c?" x e":" e");return a},drawPolygon:function(a,b){this.setNodeDimension(a,
b);var c=this.getResolution(),d=[],e,f,g,h,i,j,k,l,m,n;e=0;for(f=b.components.length;e<f;e++){d.push("m");g=b.components[e].components;h=0===e;j=i=null;k=0;for(l=g.length;k<l;k++)m=g[k],n=(m.x-this.featureDx)/c-this.offset.x|0,m=m.y/c-this.offset.y|0,n=" "+n+","+m,d.push(n),0==k&&d.push(" l"),h||(i?i!=n&&(j?j!=n&&(h=!0):j=n):i=n);d.push(h?" x ":" ")}d.push("e");a.path=d.join("");return a},drawRectangle:function(a,b){var c=this.getResolution();a.style.left=((b.x-this.featureDx)/c-this.offset.x|0)+
"px";a.style.top=(b.y/c-this.offset.y|0)+"px";a.style.width=(b.width/c|0)+"px";a.style.height=(b.height/c|0)+"px";return a},drawText:function(a,b,c){var d=this.nodeFactory(a+this.LABEL_ID_SUFFIX,"olv:rect"),e=this.nodeFactory(a+this.LABEL_ID_SUFFIX+"_textbox","olv:textbox"),f=this.getResolution();d.style.left=((c.x-this.featureDx)/f-this.offset.x|0)+"px";d.style.top=(c.y/f-this.offset.y|0)+"px";d.style.flip="y";e.innerText=b.label;"inherit"!=b.cursor&&null!=b.cursor&&(e.style.cursor=b.cursor);b.fontColor&&
(e.style.color=b.fontColor);b.fontOpacity&&(e.style.filter="alpha(opacity="+100*b.fontOpacity+")");b.fontFamily&&(e.style.fontFamily=b.fontFamily);b.fontSize&&(e.style.fontSize=b.fontSize);b.fontWeight&&(e.style.fontWeight=b.fontWeight);b.fontStyle&&(e.style.fontStyle=b.fontStyle);!0===b.labelSelect&&(d._featureId=a,e._featureId=a,e._geometry=c,e._geometryClass=c.CLASS_NAME);e.style.whiteSpace="nowrap";e.inset="1px,0px,0px,0px";d.parentNode||(d.appendChild(e),this.textRoot.appendChild(d));b=b.labelAlign||
"cm";1==b.length&&(b+="m");a=e.clientWidth*OpenLayers.Renderer.VML.LABEL_SHIFT[b.substr(0,1)];e=e.clientHeight*OpenLayers.Renderer.VML.LABEL_SHIFT[b.substr(1,1)];d.style.left=parseInt(d.style.left)-a-1+"px";d.style.top=parseInt(d.style.top)+e+"px"},moveRoot:function(a){var b=this.map.getLayer(a.container.id);b instanceof OpenLayers.Layer.Vector.RootContainer&&(b=this.map.getLayer(this.container.id));b&&b.renderer.clear();OpenLayers.Renderer.Elements.prototype.moveRoot.apply(this,arguments);b&&b.redraw()},
importSymbol:function(a){var b=this.container.id+"-"+a,c=this.symbolCache[b];if(c)return c;c=OpenLayers.Renderer.symbol[a];if(!c)throw Error(a+" is not a valid symbol name");for(var a=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0),d=["m"],e=0;e<c.length;e+=2){var f=c[e],g=c[e+1];a.left=Math.min(a.left,f);a.bottom=Math.min(a.bottom,g);a.right=Math.max(a.right,f);a.top=Math.max(a.top,g);d.push(f);d.push(g);0==e&&d.push("l")}d.push("x e");c=d.join(" ");d=(a.getWidth()-a.getHeight())/2;
0<d?(a.bottom-=d,a.top+=d):(a.left+=d,a.right-=d);c={path:c,size:a.getWidth(),left:a.left,bottom:a.bottom};return this.symbolCache[b]=c},CLASS_NAME:"OpenLayers.Renderer.VML"});OpenLayers.Renderer.VML.LABEL_SHIFT={l:0,c:0.5,r:1,t:0,m:0.5,b:1};OpenLayers.Control.CacheRead=OpenLayers.Class(OpenLayers.Control,{fetchEvent:"tileloadstart",layers:null,autoActivate:!0,setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments);var b,c=this.layers||a.layers;for(b=c.length-1;0<=b;--b)this.addLayer({layer:c[b]});if(!this.layers)a.events.on({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this})},addLayer:function(a){a.layer.events.register(this.fetchEvent,this,this.fetch)},removeLayer:function(a){a.layer.events.unregister(this.fetchEvent,
this,this.fetch)},fetch:function(a){if(this.active&&window.localStorage&&a.tile instanceof OpenLayers.Tile.Image){var b=a.tile,c=b.url;!b.layer.crossOriginKeyword&&(OpenLayers.ProxyHost&&0===c.indexOf(OpenLayers.ProxyHost))&&(c=OpenLayers.Control.CacheWrite.urlMap[c]);if(c=window.localStorage.getItem("olCache_"+c))b.url=c,"tileerror"===a.type&&b.setImgSrc(c)}},destroy:function(){if(this.layers||this.map){var a,b=this.layers||this.map.layers;for(a=b.length-1;0<=a;--a)this.removeLayer({layer:b[a]})}this.map&&
this.map.events.un({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this});OpenLayers.Control.prototype.destroy.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.CacheRead"});OpenLayers.Protocol.WFS.v1_0_0=OpenLayers.Class(OpenLayers.Protocol.WFS.v1,{version:"1.0.0",CLASS_NAME:"OpenLayers.Protocol.WFS.v1_0_0"});OpenLayers.Format.WMSGetFeatureInfo=OpenLayers.Class(OpenLayers.Format.XML,{layerIdentifier:"_layer",featureIdentifier:"_feature",regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},gmlFormat:null,read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=a.documentElement;if(b)var c=this["read_"+b.nodeName],a=c?c.call(this,b):(new OpenLayers.Format.GML(this.options?this.options:{})).read(a);return a},read_msGMLOutput:function(a){var b=
[];if(a=this.getSiblingNodesByTagCriteria(a,this.layerIdentifier))for(var c=0,d=a.length;c<d;++c){var e=a[c],f=e.nodeName;e.prefix&&(f=f.split(":")[1]);f=f.replace(this.layerIdentifier,"");if(e=this.getSiblingNodesByTagCriteria(e,this.featureIdentifier))for(var g=0;g<e.length;g++){var h=e[g],i=this.parseGeometry(h),h=this.parseAttributes(h),h=new OpenLayers.Feature.Vector(i.geometry,h,null);h.bounds=i.bounds;h.type=f;b.push(h)}}return b},read_FeatureInfoResponse:function(a){for(var b=[],a=this.getElementsByTagNameNS(a,
"*","FIELDS"),c=0,d=a.length;c<d;c++){var e=a[c],f={},g,h=e.attributes.length;if(0<h)for(g=0;g<h;g++){var i=e.attributes[g];f[i.nodeName]=i.nodeValue}else{e=e.childNodes;g=0;for(h=e.length;g<h;++g)i=e[g],3!=i.nodeType&&(f[i.getAttribute("name")]=i.getAttribute("value"))}b.push(new OpenLayers.Feature.Vector(null,f,null))}return b},getSiblingNodesByTagCriteria:function(a,b){var c=[],d,e,f,g;if(a&&a.hasChildNodes()){d=a.childNodes;f=d.length;for(var h=0;h<f;h++){for(g=d[h];g&&1!=g.nodeType;)g=g.nextSibling,
h++;e=g?g.nodeName:"";0<e.length&&-1<e.indexOf(b)?c.push(g):(e=this.getSiblingNodesByTagCriteria(g,b),0<e.length&&(0==c.length?c=e:c.push(e)))}}return c},parseAttributes:function(a){var b={};if(1==a.nodeType)for(var a=a.childNodes,c=a.length,d=0;d<c;++d){var e=a[d];if(1==e.nodeType){var f=e.childNodes,e=e.prefix?e.nodeName.split(":")[1]:e.nodeName;if(0==f.length)b[e]=null;else if(1==f.length&&(f=f[0],3==f.nodeType||4==f.nodeType))f=f.nodeValue.replace(this.regExes.trimSpace,""),b[e]=f}}return b},
parseGeometry:function(a){this.gmlFormat||(this.gmlFormat=new OpenLayers.Format.GML);var a=this.gmlFormat.parseFeature(a),b,c=null;a&&(b=a.geometry&&a.geometry.clone(),c=a.bounds&&a.bounds.clone(),a.destroy());return{geometry:b,bounds:c}},CLASS_NAME:"OpenLayers.Format.WMSGetFeatureInfo"});OpenLayers.Control.WMTSGetFeatureInfo=OpenLayers.Class(OpenLayers.Control,{hover:!1,requestEncoding:"KVP",drillDown:!1,maxFeatures:10,clickCallback:"click",layers:null,queryVisible:!0,infoFormat:"text/html",vendorParams:{},format:null,formatOptions:null,handlerOptions:null,handler:null,hoverRequest:null,pending:0,initialize:function(a){a=a||{};a.handlerOptions=a.handlerOptions||{};OpenLayers.Control.prototype.initialize.apply(this,[a]);this.format||(this.format=new OpenLayers.Format.WMSGetFeatureInfo(a.formatOptions));
!0===this.drillDown&&(this.hover=!1);this.hover?this.handler=new OpenLayers.Handler.Hover(this,{move:this.cancelHover,pause:this.getInfoForHover},OpenLayers.Util.extend(this.handlerOptions.hover||{},{delay:250})):(a={},a[this.clickCallback]=this.getInfoForClick,this.handler=new OpenLayers.Handler.Click(this,a,this.handlerOptions.click||{}))},getInfoForClick:function(a){this.request(a.xy,{})},getInfoForHover:function(a){this.request(a.xy,{hover:!0})},cancelHover:function(){this.hoverRequest&&(--this.pending,
0>=this.pending&&(OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait"),this.pending=0),this.hoverRequest.abort(),this.hoverRequest=null)},findLayers:function(){for(var a=this.layers||this.map.layers,b=[],c,d=a.length-1;0<=d;--d)if(c=a[d],c instanceof OpenLayers.Layer.WMTS&&c.requestEncoding===this.requestEncoding&&(!this.queryVisible||c.getVisibility()))if(b.push(c),!this.drillDown||this.hover)break;return b},buildRequestOptions:function(a,b){var c=this.map.getLonLatFromPixel(b),d=
a.getURL(new OpenLayers.Bounds(c.lon,c.lat,c.lon,c.lat)),d=OpenLayers.Util.getParameters(d),c=a.getTileInfo(c);OpenLayers.Util.extend(d,{service:"WMTS",version:a.version,request:"GetFeatureInfo",infoFormat:this.infoFormat,i:c.i,j:c.j});OpenLayers.Util.applyDefaults(d,this.vendorParams);return{url:OpenLayers.Util.isArray(a.url)?a.url[0]:a.url,params:OpenLayers.Util.upperCaseObject(d),callback:function(c){this.handleResponse(b,c,a)},scope:this}},request:function(a,b){var b=b||{},c=this.findLayers();
if(0<c.length){for(var d,e,f=0,g=c.length;f<g;f++)e=c[f],d=this.events.triggerEvent("beforegetfeatureinfo",{xy:a,layer:e}),!1!==d&&(++this.pending,d=this.buildRequestOptions(e,a),d=OpenLayers.Request.GET(d),!0===b.hover&&(this.hoverRequest=d));0<this.pending&&OpenLayers.Element.addClass(this.map.viewPortDiv,"olCursorWait")}},handleResponse:function(a,b,c){--this.pending;0>=this.pending&&(OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait"),this.pending=0);if(b.status&&(200>b.status||
300<=b.status))this.events.triggerEvent("exception",{xy:a,request:b,layer:c});else{var d=b.responseXML;if(!d||!d.documentElement)d=b.responseText;var e,f;try{e=this.format.read(d)}catch(g){f=!0,this.events.triggerEvent("exception",{xy:a,request:b,error:g,layer:c})}f||this.events.triggerEvent("getfeatureinfo",{text:b.responseText,features:e,request:b,xy:a,layer:c})}},CLASS_NAME:"OpenLayers.Control.WMTSGetFeatureInfo"});OpenLayers.Strategy.Paging=OpenLayers.Class(OpenLayers.Strategy,{features:null,length:10,num:null,paging:!1,activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);if(a)this.layer.events.on({beforefeaturesadded:this.cacheFeatures,scope:this});return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&&(this.clearCache(),this.layer.events.un({beforefeaturesadded:this.cacheFeatures,scope:this}));return a},cacheFeatures:function(a){this.paging||(this.clearCache(),
this.features=a.features,this.pageNext(a))},clearCache:function(){if(this.features)for(var a=0;a<this.features.length;++a)this.features[a].destroy();this.num=this.features=null},pageCount:function(){return Math.ceil((this.features?this.features.length:0)/this.length)},pageNum:function(){return this.num},pageLength:function(a){a&&0<a&&(this.length=a);return this.length},pageNext:function(a){var b=!1;this.features&&(null===this.num&&(this.num=-1),b=this.page((this.num+1)*this.length,a));return b},pagePrevious:function(){var a=
!1;this.features&&(null===this.num&&(this.num=this.pageCount()),a=this.page((this.num-1)*this.length));return a},page:function(a,b){var c=!1;if(this.features&&0<=a&&a<this.features.length){var d=Math.floor(a/this.length);d!=this.num&&(this.paging=!0,c=this.features.slice(a,a+this.length),this.layer.removeFeatures(this.layer.features),this.num=d,b&&b.features?b.features=c:this.layer.addFeatures(c),this.paging=!1,c=!0)}return c},CLASS_NAME:"OpenLayers.Strategy.Paging"});OpenLayers.Protocol.CSW.v2_0_2=OpenLayers.Class(OpenLayers.Protocol,{formatOptions:null,initialize:function(a){OpenLayers.Protocol.prototype.initialize.apply(this,[a]);a.format||(this.format=new OpenLayers.Format.CSWGetRecords.v2_0_2(OpenLayers.Util.extend({},this.formatOptions)))},destroy:function(){this.options&&!this.options.format&&this.format.destroy();this.format=null;OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(a){a=OpenLayers.Util.extend({},a);OpenLayers.Util.applyDefaults(a,
this.options||{});var b=new OpenLayers.Protocol.Response({requestType:"read"}),c=this.format.write(a.params);b.priv=OpenLayers.Request.POST({url:a.url,callback:this.createCallback(this.handleRead,b,a),params:a.params,headers:a.headers,data:c});return b},handleRead:function(a,b){if(b.callback){var c=a.priv;200<=c.status&&300>c.status?(a.data=this.parseData(c),a.code=OpenLayers.Protocol.Response.SUCCESS):a.code=OpenLayers.Protocol.Response.FAILURE;b.callback.call(b.scope,a)}},parseData:function(a){var b=
a.responseXML;if(!b||!b.documentElement)b=a.responseText;return!b||0>=b.length?null:this.format.read(b)},CLASS_NAME:"OpenLayers.Protocol.CSW.v2_0_2"});OpenLayers.Format.WMSCapabilities.v1_1=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1,{readers:{wms:OpenLayers.Util.applyDefaults({WMT_MS_Capabilities:function(a,b){this.readChildNodes(a,b)},Keyword:function(a,b){b.keywords&&b.keywords.push(this.getChildValue(a))},DescribeLayer:function(a,b){b.describelayer={formats:[]};this.readChildNodes(a,b.describelayer)},GetLegendGraphic:function(a,b){b.getlegendgraphic={formats:[]};this.readChildNodes(a,b.getlegendgraphic)},GetStyles:function(a,b){b.getstyles=
{formats:[]};this.readChildNodes(a,b.getstyles)},PutStyles:function(a,b){b.putstyles={formats:[]};this.readChildNodes(a,b.putstyles)},UserDefinedSymbolization:function(a,b){var c={supportSLD:1==parseInt(a.getAttribute("SupportSLD")),userLayer:1==parseInt(a.getAttribute("UserLayer")),userStyle:1==parseInt(a.getAttribute("UserStyle")),remoteWFS:1==parseInt(a.getAttribute("RemoteWFS"))};b.userSymbols=c},LatLonBoundingBox:function(a,b){b.llbbox=[parseFloat(a.getAttribute("minx")),parseFloat(a.getAttribute("miny")),
parseFloat(a.getAttribute("maxx")),parseFloat(a.getAttribute("maxy"))]},BoundingBox:function(a,b){var c=OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms.BoundingBox.apply(this,[a,b]);c.srs=a.getAttribute("SRS");b.bbox[c.srs]=c},ScaleHint:function(a,b){var c=a.getAttribute("min"),d=a.getAttribute("max"),e=Math.pow(2,0.5),f=OpenLayers.INCHES_PER_UNIT.m;b.maxScale=parseFloat((c/e*f*OpenLayers.DOTS_PER_INCH).toPrecision(13));b.minScale=parseFloat((d/e*f*OpenLayers.DOTS_PER_INCH).toPrecision(13))},
Dimension:function(a,b){var c={name:a.getAttribute("name").toLowerCase(),units:a.getAttribute("units"),unitsymbol:a.getAttribute("unitSymbol")};b.dimensions[c.name]=c},Extent:function(a,b){var c=a.getAttribute("name").toLowerCase();if(c in b.dimensions){c=b.dimensions[c];c.nearestVal="1"===a.getAttribute("nearestValue");c.multipleVal="1"===a.getAttribute("multipleValues");c.current="1"===a.getAttribute("current");c["default"]=a.getAttribute("default")||"";var d=this.getChildValue(a);c.values=d.split(",")}}},
OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1"});OpenLayers.Control.Graticule=OpenLayers.Class(OpenLayers.Control,{autoActivate:!0,intervals:[45,30,20,10,5,2,1,0.5,0.2,0.1,0.05,0.01,0.005,0.002,0.001],displayInLayerSwitcher:!0,visible:!0,numPoints:50,targetSize:200,layerName:null,labelled:!0,labelFormat:"dm",lineSymbolizer:{strokeColor:"#333",strokeWidth:1,strokeOpacity:0.5},labelSymbolizer:{},gratLayer:null,initialize:function(a){a=a||{};a.layerName=a.layerName||OpenLayers.i18n("Graticule");OpenLayers.Control.prototype.initialize.apply(this,[a]);
this.labelSymbolizer.stroke=!1;this.labelSymbolizer.fill=!1;this.labelSymbolizer.label="${label}";this.labelSymbolizer.labelAlign="${labelAlign}";this.labelSymbolizer.labelXOffset="${xOffset}";this.labelSymbolizer.labelYOffset="${yOffset}"},destroy:function(){this.deactivate();OpenLayers.Control.prototype.destroy.apply(this,arguments);this.gratLayer&&(this.gratLayer.destroy(),this.gratLayer=null)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.gratLayer){var a=new OpenLayers.Style({},
{rules:[new OpenLayers.Rule({symbolizer:{Point:this.labelSymbolizer,Line:this.lineSymbolizer}})]});this.gratLayer=new OpenLayers.Layer.Vector(this.layerName,{styleMap:new OpenLayers.StyleMap({"default":a}),visibility:this.visible,displayInLayerSwitcher:this.displayInLayerSwitcher})}return this.div},activate:function(){return OpenLayers.Control.prototype.activate.apply(this,arguments)?(this.map.addLayer(this.gratLayer),this.map.events.register("moveend",this,this.update),this.update(),!0):!1},deactivate:function(){return OpenLayers.Control.prototype.deactivate.apply(this,
arguments)?(this.map.events.unregister("moveend",this,this.update),this.map.removeLayer(this.gratLayer),!0):!1},update:function(){var a=this.map.getExtent();if(a){this.gratLayer.destroyFeatures();var b=new OpenLayers.Projection("EPSG:4326"),c=this.map.getProjectionObject(),d=this.map.getResolution();c.proj&&"longlat"==c.proj.projName&&(this.numPoints=1);var e=this.map.getCenter(),f=new OpenLayers.Pixel(e.lon,e.lat);OpenLayers.Projection.transform(f,c,b);for(var e=this.targetSize*d,e=e*e,g,d=0;d<this.intervals.length;++d){g=
this.intervals[d];var h=g/2,i=f.offset({x:-h,y:-h}),h=f.offset({x:h,y:h});OpenLayers.Projection.transform(i,b,c);OpenLayers.Projection.transform(h,b,c);if((i.x-h.x)*(i.x-h.x)+(i.y-h.y)*(i.y-h.y)<=e)break}f.x=Math.floor(f.x/g)*g;f.y=Math.floor(f.y/g)*g;var d=0,e=[f.clone()],h=f.clone(),j;do h=h.offset({x:0,y:g}),j=OpenLayers.Projection.transform(h.clone(),b,c),e.unshift(h);while(a.containsPixel(j)&&1E3>++d);h=f.clone();do h=h.offset({x:0,y:-g}),j=OpenLayers.Projection.transform(h.clone(),b,c),e.push(h);
while(a.containsPixel(j)&&1E3>++d);d=0;i=[f.clone()];h=f.clone();do h=h.offset({x:-g,y:0}),j=OpenLayers.Projection.transform(h.clone(),b,c),i.unshift(h);while(a.containsPixel(j)&&1E3>++d);h=f.clone();do h=h.offset({x:g,y:0}),j=OpenLayers.Projection.transform(h.clone(),b,c),i.push(h);while(a.containsPixel(j)&&1E3>++d);g=[];for(d=0;d<i.length;++d){j=i[d].x;for(var f=[],k=null,l=Math.min(e[0].y,90),h=Math.max(e[e.length-1].y,-90),m=(l-h)/this.numPoints,l=h,h=0;h<=this.numPoints;++h){var n=new OpenLayers.Geometry.Point(j,
l);n.transform(b,c);f.push(n);l+=m;n.y>=a.bottom&&!k&&(k=n)}this.labelled&&(k=new OpenLayers.Geometry.Point(k.x,a.bottom),j={value:j,label:this.labelled?OpenLayers.Util.getFormattedLonLat(j,"lon",this.labelFormat):"",labelAlign:"cb",xOffset:0,yOffset:2},this.gratLayer.addFeatures(new OpenLayers.Feature.Vector(k,j)));f=new OpenLayers.Geometry.LineString(f);g.push(new OpenLayers.Feature.Vector(f))}for(h=0;h<e.length;++h)if(l=e[h].y,!(-90>l||90<l)){f=[];d=i[0].x;m=(i[i.length-1].x-d)/this.numPoints;
j=d;k=null;for(d=0;d<=this.numPoints;++d)n=new OpenLayers.Geometry.Point(j,l),n.transform(b,c),f.push(n),j+=m,n.x<a.right&&(k=n);this.labelled&&(k=new OpenLayers.Geometry.Point(a.right,k.y),j={value:l,label:this.labelled?OpenLayers.Util.getFormattedLonLat(l,"lat",this.labelFormat):"",labelAlign:"rb",xOffset:-2,yOffset:2},this.gratLayer.addFeatures(new OpenLayers.Feature.Vector(k,j)));f=new OpenLayers.Geometry.LineString(f);g.push(new OpenLayers.Feature.Vector(f))}this.gratLayer.addFeatures(g)}},CLASS_NAME:"OpenLayers.Control.Graticule"});OpenLayers.Layer.UTFGrid=OpenLayers.Class(OpenLayers.Layer.XYZ,{isBaseLayer:!1,projection:new OpenLayers.Projection("EPSG:900913"),useJSONP:!1,tileClass:OpenLayers.Tile.UTFGrid,initialize:function(a){OpenLayers.Layer.Grid.prototype.initialize.apply(this,[a.name,a.url,{},a]);this.tileOptions=OpenLayers.Util.extend({utfgridResolution:this.utfgridResolution},this.tileOptions)},clone:function(a){null==a&&(a=new OpenLayers.Layer.UTFGrid(this.getOptions()));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,
[a])},getFeatureInfo:function(a){var b=null,a=this.getTileData(a);a.tile&&(b=a.tile.getFeatureInfo(a.i,a.j));return b},getFeatureId:function(a){var b=null,a=this.getTileData(a);a.tile&&(b=a.tile.getFeatureId(a.i,a.j));return b},CLASS_NAME:"OpenLayers.Layer.UTFGrid"});OpenLayers.Layer.ArcGISCache=OpenLayers.Class(OpenLayers.Layer.XYZ,{url:null,tileOrigin:null,tileSize:new OpenLayers.Size(256,256),useArcGISServer:!0,type:"png",useScales:!1,overrideDPI:!1,initialize:function(a,b,c){OpenLayers.Layer.XYZ.prototype.initialize.apply(this,arguments);this.resolutions&&(this.serverResolutions=this.resolutions,this.maxExtent=this.getMaxExtentForResolution(this.resolutions[0]));if(this.layerInfo){var d=this.layerInfo,e=new OpenLayers.Bounds(d.fullExtent.xmin,d.fullExtent.ymin,
d.fullExtent.xmax,d.fullExtent.ymax);this.projection="EPSG:"+d.spatialReference.wkid;this.sphericalMercator=102100==d.spatialReference.wkid;this.units="esriFeet"==d.units?"ft":"m";if(d.tileInfo){this.tileSize=new OpenLayers.Size(d.tileInfo.width||d.tileInfo.cols,d.tileInfo.height||d.tileInfo.rows);this.tileOrigin=new OpenLayers.LonLat(d.tileInfo.origin.x,d.tileInfo.origin.y);var f=new OpenLayers.Geometry.Point(e.left,e.top),e=new OpenLayers.Geometry.Point(e.right,e.bottom);this.useScales?this.scales=
[]:this.resolutions=[];this.lods=[];for(var g in d.tileInfo.lods)if(d.tileInfo.lods.hasOwnProperty(g)){var h=d.tileInfo.lods[g];this.useScales?this.scales.push(h.scale):this.resolutions.push(h.resolution);var i=this.getContainingTileCoords(f,h.resolution);h.startTileCol=i.x;h.startTileRow=i.y;i=this.getContainingTileCoords(e,h.resolution);h.endTileCol=i.x;h.endTileRow=i.y;this.lods.push(h)}this.maxExtent=this.calculateMaxExtentWithLOD(this.lods[0]);this.serverResolutions=this.resolutions;this.overrideDPI&&
d.tileInfo.dpi&&(OpenLayers.DOTS_PER_INCH=d.tileInfo.dpi)}}},getContainingTileCoords:function(a,b){return new OpenLayers.Pixel(Math.max(Math.floor((a.x-this.tileOrigin.lon)/(this.tileSize.w*b)),0),Math.max(Math.floor((this.tileOrigin.lat-a.y)/(this.tileSize.h*b)),0))},calculateMaxExtentWithLOD:function(a){var b=this.tileOrigin.lon+a.startTileCol*this.tileSize.w*a.resolution,c=this.tileOrigin.lat-a.startTileRow*this.tileSize.h*a.resolution;return new OpenLayers.Bounds(b,c-(a.endTileRow-a.startTileRow+
1)*this.tileSize.h*a.resolution,b+(a.endTileCol-a.startTileCol+1)*this.tileSize.w*a.resolution,c)},calculateMaxExtentWithExtent:function(a,b){var c=new OpenLayers.Geometry.Point(a.left,a.top),d=new OpenLayers.Geometry.Point(a.right,a.bottom),c=this.getContainingTileCoords(c,b),d=this.getContainingTileCoords(d,b);return this.calculateMaxExtentWithLOD({resolution:b,startTileCol:c.x,startTileRow:c.y,endTileCol:d.x,endTileRow:d.y})},getUpperLeftTileCoord:function(a){return this.getContainingTileCoords(new OpenLayers.Geometry.Point(this.maxExtent.left,
this.maxExtent.top),a)},getLowerRightTileCoord:function(a){return this.getContainingTileCoords(new OpenLayers.Geometry.Point(this.maxExtent.right,this.maxExtent.bottom),a)},getMaxExtentForResolution:function(a){var b=this.getUpperLeftTileCoord(a),c=this.getLowerRightTileCoord(a),d=this.tileOrigin.lon+b.x*this.tileSize.w*a,e=this.tileOrigin.lat-b.y*this.tileSize.h*a;return new OpenLayers.Bounds(d,e-(c.y-b.y+1)*this.tileSize.h*a,d+(c.x-b.x+1)*this.tileSize.w*a,e)},clone:function(a){null==a&&(a=new OpenLayers.Layer.ArcGISCache(this.name,
this.url,this.options));return OpenLayers.Layer.XYZ.prototype.clone.apply(this,[a])},getMaxExtent:function(){return this.maxExtent=this.getMaxExtentForResolution(this.map.getResolution())},getTileOrigin:function(){var a=this.getMaxExtent();return new OpenLayers.LonLat(a.left,a.bottom)},getURL:function(a){var b=this.getResolution(),c=this.tileOrigin.lon+b*this.tileSize.w/2,d=this.tileOrigin.lat-b*this.tileSize.h/2,a=a.getCenterLonLat(),c=Math.round(Math.abs((a.lon-c)/(b*this.tileSize.w))),d=Math.round(Math.abs((d-
a.lat)/(b*this.tileSize.h))),a=this.map.getZoom();if(this.lods){if(b=this.lods[this.map.getZoom()],c<b.startTileCol||c>b.endTileCol||d<b.startTileRow||d>b.endTileRow)return null}else{var e=this.getUpperLeftTileCoord(b),b=this.getLowerRightTileCoord(b);if(c<e.x||c>=b.x||d<e.y||d>=b.y)return null}b=this.url;e=""+c+d+a;OpenLayers.Util.isArray(b)&&(b=this.selectUrl(e,b));this.useArcGISServer?b+="/tile/${z}/${y}/${x}":(c="C"+this.zeroPad(c,8,16),d="R"+this.zeroPad(d,8,16),a="L"+this.zeroPad(a,2,16),b=
b+"/${z}/${y}/${x}."+this.type);b=OpenLayers.String.format(b,{x:c,y:d,z:a});return OpenLayers.Util.urlAppend(b,OpenLayers.Util.getParameterString(this.params))},zeroPad:function(a,b,c){for(a=a.toString(c||10);a.length<b;)a="0"+a;return a},CLASS_NAME:"OpenLayers.Layer.ArcGISCache"});OpenLayers.Control.WMSGetFeatureInfo=OpenLayers.Class(OpenLayers.Control,{hover:!1,drillDown:!1,maxFeatures:10,clickCallback:"click",output:"features",layers:null,queryVisible:!1,url:null,layerUrls:null,infoFormat:"text/html",vendorParams:{},format:null,formatOptions:null,handlerOptions:null,handler:null,hoverRequest:null,initialize:function(a){a=a||{};a.handlerOptions=a.handlerOptions||{};OpenLayers.Control.prototype.initialize.apply(this,[a]);this.format||(this.format=new OpenLayers.Format.WMSGetFeatureInfo(a.formatOptions));
!0===this.drillDown&&(this.hover=!1);this.hover?this.handler=new OpenLayers.Handler.Hover(this,{move:this.cancelHover,pause:this.getInfoForHover},OpenLayers.Util.extend(this.handlerOptions.hover||{},{delay:250})):(a={},a[this.clickCallback]=this.getInfoForClick,this.handler=new OpenLayers.Handler.Click(this,a,this.handlerOptions.click||{}))},getInfoForClick:function(a){this.events.triggerEvent("beforegetfeatureinfo",{xy:a.xy});OpenLayers.Element.addClass(this.map.viewPortDiv,"olCursorWait");this.request(a.xy,
{})},getInfoForHover:function(a){this.events.triggerEvent("beforegetfeatureinfo",{xy:a.xy});this.request(a.xy,{hover:!0})},cancelHover:function(){this.hoverRequest&&(this.hoverRequest.abort(),this.hoverRequest=null)},findLayers:function(){for(var a=this.layers||this.map.layers,b=[],c,d,e=a.length-1;0<=e;--e)if(c=a[e],c instanceof OpenLayers.Layer.WMS&&(!this.queryVisible||c.getVisibility()))d=OpenLayers.Util.isArray(c.url)?c.url[0]:c.url,!1===this.drillDown&&!this.url&&(this.url=d),(!0===this.drillDown||
this.urlMatches(d))&&b.push(c);return b},urlMatches:function(a){var b=OpenLayers.Util.isEquivalentUrl(this.url,a);if(!b&&this.layerUrls)for(var c=0,d=this.layerUrls.length;c<d;++c)if(OpenLayers.Util.isEquivalentUrl(this.layerUrls[c],a)){b=!0;break}return b},buildWMSOptions:function(a,b,c,d){for(var e=[],f=[],g=0,h=b.length;g<h;g++)null!=b[g].params.LAYERS&&(e=e.concat(b[g].params.LAYERS),f=f.concat(this.getStyleNames(b[g])));b=b[0];g=this.map.getProjection();(h=b.projection)&&h.equals(this.map.getProjectionObject())&&
(g=h.getCode());d=OpenLayers.Util.extend({service:"WMS",version:b.params.VERSION,request:"GetFeatureInfo",exceptions:b.params.EXCEPTIONS,bbox:this.map.getExtent().toBBOX(null,b.reverseAxisOrder()),feature_count:this.maxFeatures,height:this.map.getSize().h,width:this.map.getSize().w,format:d,info_format:b.params.INFO_FORMAT||this.infoFormat},1.3<=parseFloat(b.params.VERSION)?{crs:g,i:parseInt(c.x),j:parseInt(c.y)}:{srs:g,x:parseInt(c.x),y:parseInt(c.y)});0!=e.length&&(d=OpenLayers.Util.extend({layers:e,
query_layers:e,styles:f},d));OpenLayers.Util.applyDefaults(d,this.vendorParams);return{url:a,params:OpenLayers.Util.upperCaseObject(d),callback:function(b){this.handleResponse(c,b,a)},scope:this}},getStyleNames:function(a){return a.params.STYLES?a.params.STYLES:OpenLayers.Util.isArray(a.params.LAYERS)?Array(a.params.LAYERS.length):a.params.LAYERS.replace(/[^,]/g,"")},request:function(a,b){var c=this.findLayers();if(0==c.length)this.events.triggerEvent("nogetfeatureinfo"),OpenLayers.Element.removeClass(this.map.viewPortDiv,
"olCursorWait");else if(b=b||{},!1===this.drillDown){var c=this.buildWMSOptions(this.url,c,a,c[0].params.FORMAT),d=OpenLayers.Request.GET(c);!0===b.hover&&(this.hoverRequest=d)}else{this._numRequests=this._requestCount=0;this.features=[];for(var d={},e,f=0,g=c.length;f<g;f++){var h=c[f];e=OpenLayers.Util.isArray(h.url)?h.url[0]:h.url;e in d?d[e].push(h):(this._numRequests++,d[e]=[h])}for(e in d)c=d[e],c=this.buildWMSOptions(e,c,a,c[0].params.FORMAT),OpenLayers.Request.GET(c)}},triggerGetFeatureInfo:function(a,
b,c){this.events.triggerEvent("getfeatureinfo",{text:a.responseText,features:c,request:a,xy:b});OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait")},handleResponse:function(a,b,c){var d=b.responseXML;if(!d||!d.documentElement)d=b.responseText;d=this.format.read(d);!1===this.drillDown?this.triggerGetFeatureInfo(b,a,d):(this._requestCount++,this._features="object"===this.output?(this._features||[]).concat({url:c,features:d}):(this._features||[]).concat(d),this._requestCount===this._numRequests&&
(this.triggerGetFeatureInfo(b,a,this._features.concat()),delete this._features,delete this._requestCount,delete this._numRequests))},CLASS_NAME:"OpenLayers.Control.WMSGetFeatureInfo"});OpenLayers.Format.WMSCapabilities.v1_3_0=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_3,{version:"1.3.0",CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_3_0"});OpenLayers.Format.SOSGetFeatureOfInterest=OpenLayers.Class(OpenLayers.Format.XML,{VERSION:"1.0.0",namespaces:{sos:"http://www.opengis.net/sos/1.0",gml:"http://www.opengis.net/gml",sa:"http://www.opengis.net/sampling/1.0",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"http://www.opengis.net/sos/1.0 http://schemas.opengis.net/sos/1.0.0/sosAll.xsd",defaultPrefix:"sos",regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},read:function(a){"string"==
typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&&9==a.nodeType&&(a=a.documentElement);var b={features:[]};this.readNode(a,b);for(var a=[],c=0,d=b.features.length;c<d;c++){var e=b.features[c];this.internalProjection&&(this.externalProjection&&e.components[0])&&e.components[0].transform(this.externalProjection,this.internalProjection);e=new OpenLayers.Feature.Vector(e.components[0],e.attributes);a.push(e)}return a},readers:{sa:{SamplingPoint:function(a,b){if(!b.attributes){var c=
{attributes:{}};b.features.push(c);b=c}b.attributes.id=this.getAttributeNS(a,this.namespaces.gml,"id");this.readChildNodes(a,b)},position:function(a,b){this.readChildNodes(a,b)}},gml:OpenLayers.Util.applyDefaults({FeatureCollection:function(a,b){this.readChildNodes(a,b)},featureMember:function(a,b){var c={attributes:{}};b.features.push(c);this.readChildNodes(a,c)},name:function(a,b){b.attributes.name=this.getChildValue(a)},pos:function(a,b){this.externalProjection||(this.externalProjection=new OpenLayers.Projection(a.getAttribute("srsName")));
OpenLayers.Format.GML.v3.prototype.readers.gml.pos.apply(this,[a,b])}},OpenLayers.Format.GML.v3.prototype.readers.gml)},writers:{sos:{GetFeatureOfInterest:function(a){for(var b=this.createElementNSPlus("GetFeatureOfInterest",{attributes:{version:this.VERSION,service:"SOS","xsi:schemaLocation":this.schemaLocation}}),c=0,d=a.fois.length;c<d;c++)this.writeNode("FeatureOfInterestId",{foi:a.fois[c]},b);return b},FeatureOfInterestId:function(a){return this.createElementNSPlus("FeatureOfInterestId",{value:a.foi})}}},
CLASS_NAME:"OpenLayers.Format.SOSGetFeatureOfInterest"});OpenLayers.Format.SOSGetObservation=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ows:"http://www.opengis.net/ows",gml:"http://www.opengis.net/gml",sos:"http://www.opengis.net/sos/1.0",ogc:"http://www.opengis.net/ogc",om:"http://www.opengis.net/om/1.0",sa:"http://www.opengis.net/sampling/1.0",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/sos/1.0 http://schemas.opengis.net/sos/1.0.0/sosGetObservation.xsd",
defaultPrefix:"sos",read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&&9==a.nodeType&&(a=a.documentElement);var b={measurements:[],observations:[]};this.readNode(a,b);return b},write:function(a){a=this.writeNode("sos:GetObservation",a);a.setAttribute("xmlns:om",this.namespaces.om);a.setAttribute("xmlns:ogc",this.namespaces.ogc);this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,
[a])},readers:{om:{ObservationCollection:function(a,b){b.id=this.getAttributeNS(a,this.namespaces.gml,"id");this.readChildNodes(a,b)},member:function(a,b){this.readChildNodes(a,b)},Measurement:function(a,b){var c={};b.measurements.push(c);this.readChildNodes(a,c)},Observation:function(a,b){var c={};b.observations.push(c);this.readChildNodes(a,c)},samplingTime:function(a,b){var c={};b.samplingTime=c;this.readChildNodes(a,c)},observedProperty:function(a,b){b.observedProperty=this.getAttributeNS(a,this.namespaces.xlink,
"href");this.readChildNodes(a,b)},procedure:function(a,b){b.procedure=this.getAttributeNS(a,this.namespaces.xlink,"href");this.readChildNodes(a,b)},featureOfInterest:function(a,b){var c={features:[]};b.fois=[];b.fois.push(c);this.readChildNodes(a,c);for(var d=[],e=0,f=c.features.length;e<f;e++){var g=c.features[e];d.push(new OpenLayers.Feature.Vector(g.components[0],g.attributes))}c.features=d},result:function(a,b){var c={};b.result=c;""!==this.getChildValue(a)?(c.value=this.getChildValue(a),c.uom=
a.getAttribute("uom")):this.readChildNodes(a,c)}},sa:OpenLayers.Format.SOSGetFeatureOfInterest.prototype.readers.sa,gml:OpenLayers.Util.applyDefaults({TimeInstant:function(a,b){var c={};b.timeInstant=c;this.readChildNodes(a,c)},timePosition:function(a,b){b.timePosition=this.getChildValue(a)}},OpenLayers.Format.SOSGetFeatureOfInterest.prototype.readers.gml)},writers:{sos:{GetObservation:function(a){var b=this.createElementNSPlus("GetObservation",{attributes:{version:this.VERSION,service:"SOS"}});this.writeNode("offering",
a,b);a.eventTime&&this.writeNode("eventTime",a,b);for(var c in a.procedures)this.writeNode("procedure",a.procedures[c],b);for(var d in a.observedProperties)this.writeNode("observedProperty",a.observedProperties[d],b);a.foi&&this.writeNode("featureOfInterest",a.foi,b);this.writeNode("responseFormat",a,b);a.resultModel&&this.writeNode("resultModel",a,b);a.responseMode&&this.writeNode("responseMode",a,b);return b},featureOfInterest:function(a){var b=this.createElementNSPlus("featureOfInterest");this.writeNode("ObjectID",
a.objectId,b);return b},ObjectID:function(a){return this.createElementNSPlus("ObjectID",{value:a})},responseFormat:function(a){return this.createElementNSPlus("responseFormat",{value:a.responseFormat})},procedure:function(a){return this.createElementNSPlus("procedure",{value:a})},offering:function(a){return this.createElementNSPlus("offering",{value:a.offering})},observedProperty:function(a){return this.createElementNSPlus("observedProperty",{value:a})},eventTime:function(a){var b=this.createElementNSPlus("eventTime");
"latest"===a.eventTime&&this.writeNode("ogc:TM_Equals",a,b);return b},resultModel:function(a){return this.createElementNSPlus("resultModel",{value:a.resultModel})},responseMode:function(a){return this.createElementNSPlus("responseMode",{value:a.responseMode})}},ogc:{TM_Equals:function(a){var b=this.createElementNSPlus("ogc:TM_Equals");this.writeNode("ogc:PropertyName",{property:"urn:ogc:data:time:iso8601"},b);"latest"===a.eventTime&&this.writeNode("gml:TimeInstant",{value:"latest"},b);return b},PropertyName:function(a){return this.createElementNSPlus("ogc:PropertyName",
{value:a.property})}},gml:{TimeInstant:function(a){var b=this.createElementNSPlus("gml:TimeInstant");this.writeNode("gml:timePosition",a,b);return b},timePosition:function(a){return this.createElementNSPlus("gml:timePosition",{value:a.value})}}},CLASS_NAME:"OpenLayers.Format.SOSGetObservation"});OpenLayers.Control.UTFGrid=OpenLayers.Class(OpenLayers.Control,{autoActivate:!0,layers:null,defaultHandlerOptions:{delay:300,pixelTolerance:4,stopMove:!1,single:!0,"double":!1,stopSingle:!1,stopDouble:!1},handlerMode:"click",setHandler:function(a){this.handlerMode=a;this.resetHandler()},resetHandler:function(){this.handler&&(this.handler.deactivate(),this.handler.destroy(),this.handler=null);"hover"==this.handlerMode?this.handler=new OpenLayers.Handler.Hover(this,{pause:this.handleEvent,move:this.reset},
this.handlerOptions):"click"==this.handlerMode?this.handler=new OpenLayers.Handler.Click(this,{click:this.handleEvent},this.handlerOptions):"move"==this.handlerMode&&(this.handler=new OpenLayers.Handler.Hover(this,{pause:this.handleEvent,move:this.handleEvent},this.handlerOptions));return this.handler?!0:!1},initialize:function(a){a=a||{};a.handlerOptions=a.handlerOptions||this.defaultHandlerOptions;OpenLayers.Control.prototype.initialize.apply(this,[a]);this.resetHandler()},handleEvent:function(a){if(null==
a)this.reset();else{var b=this.map.getLonLatFromPixel(a.xy);if(b){var c=this.findLayers();if(0<c.length){for(var d={},e,f,g=0,h=c.length;g<h;g++)e=c[g],f=OpenLayers.Util.indexOf(this.map.layers,e),d[f]=e.getFeatureInfo(b);this.callback(d,b,a.xy)}}}},callback:function(){},reset:function(){this.callback(null)},findLayers:function(){for(var a=this.layers||this.map.layers,b=[],c,d=a.length-1;0<=d;--d)c=a[d],c instanceof OpenLayers.Layer.UTFGrid&&b.push(c);return b},CLASS_NAME:"OpenLayers.Control.UTFGrid"});OpenLayers.Format.CQL=function(){function a(a){function b(){var a=e.pop();switch(a.type){case "LOGICAL":var c=b(),g=b();return new OpenLayers.Filter.Logical({filters:[g,c],type:f[a.text.toUpperCase()]});case "NOT":return c=b(),new OpenLayers.Filter.Logical({filters:[c],type:OpenLayers.Filter.Logical.NOT});case "BETWEEN":return e.pop(),g=b(),a=b(),c=b(),new OpenLayers.Filter.Comparison({property:c,lowerBoundary:a,upperBoundary:g,type:OpenLayers.Filter.Comparison.BETWEEN});case "COMPARISON":return g=
b(),c=b(),new OpenLayers.Filter.Comparison({property:c,value:g,type:d[a.text.toUpperCase()]});case "VALUE":return/^'.*'$/.test(a.text)?a.text.substr(1,a.text.length-2):Number(a.text);case "SPATIAL":switch(a.text.toUpperCase()){case "BBOX":var c=b(),a=b(),g=b(),h=b(),i=b();return new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.BBOX,property:i,value:OpenLayers.Bounds.fromArray([h,g,a,c])});case "INTERSECTS":return g=b(),c=b(),new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,
property:c,value:g});case "WITHIN":return g=b(),c=b(),new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.WITHIN,property:c,value:g});case "CONTAINS":return g=b(),c=b(),new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.CONTAINS,property:c,value:g});case "DWITHIN":return a=b(),g=b(),c=b(),new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.DWITHIN,value:g,property:c,distance:Number(a)})}case "GEOMETRY":return OpenLayers.Geometry.fromWKT(a.text);default:return a.text}}
for(var c=[],e=[];a.length;){var g=a.shift();switch(g.type){case "PROPERTY":case "GEOMETRY":case "VALUE":e.push(g);break;case "COMPARISON":case "BETWEEN":case "LOGICAL":for(var i=h[g.type];0<c.length&&h[c[c.length-1].type]<=i;)e.push(c.pop());c.push(g);break;case "SPATIAL":case "NOT":case "LPAREN":c.push(g);break;case "RPAREN":for(;0<c.length&&"LPAREN"!=c[c.length-1].type;)e.push(c.pop());c.pop();0<c.length&&"SPATIAL"==c[c.length-1].type&&e.push(c.pop());case "COMMA":case "END":break;default:throw Error("Unknown token type "+
g.type);}}for(;0<c.length;)e.push(c.pop());a=b();if(0<e.length){a="Remaining tokens after building AST: \n";for(c=e.length-1;0<=c;c--)a+=e[c].type+": "+e[c].text+"\n";throw Error(a);}return a}var b={PROPERTY:/^[_a-zA-Z]\w*/,COMPARISON:/^(=|<>|<=|<|>=|>|LIKE)/i,COMMA:/^,/,LOGICAL:/^(AND|OR)/i,VALUE:/^('\w+'|\d+(\.\d*)?|\.\d+)/,LPAREN:/^\(/,RPAREN:/^\)/,SPATIAL:/^(BBOX|INTERSECTS|DWITHIN|WITHIN|CONTAINS)/i,NOT:/^NOT/i,BETWEEN:/^BETWEEN/i,GEOMETRY:function(a){var b=/^(POINT|LINESTRING|POLYGON|MULTIPOINT|MULTILINESTRING|MULTIPOLYGON|GEOMETRYCOLLECTION)/.exec(a);
if(b){var c=a.length,b=a.indexOf("(",b[0].length);if(-1<b)for(var d=1;b<c&&0<d;)switch(b++,a.charAt(b)){case "(":d++;break;case ")":d--}return[a.substr(0,b+1)]}},END:/^$/},c={LPAREN:["GEOMETRY","SPATIAL","PROPERTY","VALUE","LPAREN"],RPAREN:["NOT","LOGICAL","END","RPAREN"],PROPERTY:["COMPARISON","BETWEEN","COMMA"],BETWEEN:["VALUE"],COMPARISON:["VALUE"],COMMA:["GEOMETRY","VALUE","PROPERTY"],VALUE:["LOGICAL","COMMA","RPAREN","END"],SPATIAL:["LPAREN"],LOGICAL:["NOT","VALUE","SPATIAL","PROPERTY","LPAREN"],
NOT:["PROPERTY","LPAREN"],GEOMETRY:["COMMA","RPAREN"]},d={"=":OpenLayers.Filter.Comparison.EQUAL_TO,"<>":OpenLayers.Filter.Comparison.NOT_EQUAL_TO,"<":OpenLayers.Filter.Comparison.LESS_THAN,"<=":OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO,">":OpenLayers.Filter.Comparison.GREATER_THAN,">=":OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO,LIKE:OpenLayers.Filter.Comparison.LIKE,BETWEEN:OpenLayers.Filter.Comparison.BETWEEN},e={},f={AND:OpenLayers.Filter.Logical.AND,OR:OpenLayers.Filter.Logical.OR},
g={},h={RPAREN:3,LOGICAL:2,COMPARISON:1},i;for(i in d)d.hasOwnProperty(i)&&(e[d[i]]=i);for(i in f)f.hasOwnProperty(i)&&(g[f[i]]=i);return OpenLayers.Class(OpenLayers.Format,{read:function(d){var e=d,d=[],f,g=["NOT","GEOMETRY","SPATIAL","PROPERTY","LPAREN"];do{a:{f=g;for(var h=void 0,g=void 0,i=f.length,h=0;h<i;h++){var g=f[h],p=b[g]instanceof RegExp?b[g].exec(e):(0,b[g])(e);if(p){f=p[0];e=e.substr(f.length).replace(/^\s*/,"");f={type:g,text:f,remainder:e};break a}}d="ERROR: In parsing: ["+e+"], expected one of: ";
for(h=0;h<i;h++)g=f[h],d+="\n    "+g+": "+b[g];throw Error(d);}e=f.remainder;g=c[f.type];if("END"!=f.type&&!g)throw Error("No follows list for "+f.type);d.push(f)}while("END"!=f.type);d=a(d);this.keepData&&(this.data=d);return d},write:function(a){if(a instanceof OpenLayers.Geometry)return a.toString();switch(a.CLASS_NAME){case "OpenLayers.Filter.Spatial":switch(a.type){case OpenLayers.Filter.Spatial.BBOX:return"BBOX("+a.property+","+a.value.toBBOX()+")";case OpenLayers.Filter.Spatial.DWITHIN:return"DWITHIN("+
a.property+", "+this.write(a.value)+", "+a.distance+")";case OpenLayers.Filter.Spatial.WITHIN:return"WITHIN("+a.property+", "+this.write(a.value)+")";case OpenLayers.Filter.Spatial.INTERSECTS:return"INTERSECTS("+a.property+", "+this.write(a.value)+")";case OpenLayers.Filter.Spatial.CONTAINS:return"CONTAINS("+a.property+", "+this.write(a.value)+")";default:throw Error("Unknown spatial filter type: "+a.type);}case "OpenLayers.Filter.Logical":if(a.type==OpenLayers.Filter.Logical.NOT)return"NOT ("+this.write(a.filters[0])+
")";for(var b="(",c=!0,d=0;d<a.filters.length;d++)c?c=!1:b+=") "+g[a.type]+" (",b+=this.write(a.filters[d]);return b+")";case "OpenLayers.Filter.Comparison":return a.type==OpenLayers.Filter.Comparison.BETWEEN?a.property+" BETWEEN "+this.write(a.lowerBoundary)+" AND "+this.write(a.upperBoundary):a.property+" "+e[a.type]+" "+this.write(a.value);case void 0:if("string"===typeof a)return"'"+a+"'";if("number"===typeof a)return""+a;default:throw Error("Can't encode: "+a.CLASS_NAME+" "+a);}},CLASS_NAME:"OpenLayers.Format.CQL"})}();OpenLayers.Control.Split=OpenLayers.Class(OpenLayers.Control,{layer:null,source:null,sourceOptions:null,tolerance:null,edge:!0,deferDelete:!1,mutual:!0,targetFilter:null,sourceFilter:null,handler:null,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,[a]);this.options=a||{};this.options.source&&this.setSource(this.options.source)},setSource:function(a){this.active?(this.deactivate(),this.handler&&(this.handler.destroy(),delete this.handler),this.source=a,this.activate()):this.source=
a},activate:function(){var a=OpenLayers.Control.prototype.activate.call(this);if(a)if(this.source){if(this.source.events)this.source.events.on({sketchcomplete:this.onSketchComplete,afterfeaturemodified:this.afterFeatureModified,scope:this})}else this.handler||(this.handler=new OpenLayers.Handler.Path(this,{done:function(a){this.onSketchComplete({feature:new OpenLayers.Feature.Vector(a)})}},{layerOptions:this.sourceOptions})),this.handler.activate();return a},deactivate:function(){var a=OpenLayers.Control.prototype.deactivate.call(this);
a&&this.source&&this.source.events&&this.layer.events.un({sketchcomplete:this.onSketchComplete,afterfeaturemodified:this.afterFeatureModified,scope:this});return a},onSketchComplete:function(a){this.feature=null;return!this.considerSplit(a.feature)},afterFeatureModified:function(a){a.modified&&"function"===typeof a.feature.geometry.split&&(this.feature=a.feature,this.considerSplit(a.feature))},removeByGeometry:function(a,b){for(var c=0,d=a.length;c<d;++c)if(a[c].geometry===b){a.splice(c,1);break}},
isEligible:function(a){return a.geometry?a.state!==OpenLayers.State.DELETE&&"function"===typeof a.geometry.split&&this.feature!==a&&(!this.targetFilter||this.targetFilter.evaluate(a.attributes)):!1},considerSplit:function(a){var b=!1,c=!1;if(!this.sourceFilter||this.sourceFilter.evaluate(a.attributes)){for(var d=this.layer&&this.layer.features||[],e,f,g=[],h=[],i=this.layer===this.source&&this.mutual,j={edge:this.edge,tolerance:this.tolerance,mutual:i},k=[a.geometry],l,m,n,o=0,p=d.length;o<p;++o)if(l=
d[o],this.isEligible(l)){m=[l.geometry];for(var q=0;q<k.length;++q){n=k[q];for(var r=0;r<m.length;++r)if(e=m[r],n.getBounds().intersectsBounds(e.getBounds())&&(e=n.split(e,j)))if(f=this.events.triggerEvent("beforesplit",{source:a,target:l}),!1!==f&&(i&&(f=e[0],1<f.length&&(f.unshift(q,1),Array.prototype.splice.apply(k,f),q+=f.length-3),e=e[1]),1<e.length))e.unshift(r,1),Array.prototype.splice.apply(m,e),r+=e.length-3}m&&1<m.length&&(this.geomsToFeatures(l,m),this.events.triggerEvent("split",{original:l,
features:m}),Array.prototype.push.apply(g,m),h.push(l),c=!0)}k&&1<k.length&&(this.geomsToFeatures(a,k),this.events.triggerEvent("split",{original:a,features:k}),Array.prototype.push.apply(g,k),h.push(a),b=!0);if(b||c){if(this.deferDelete){d=[];o=0;for(p=h.length;o<p;++o)c=h[o],c.state===OpenLayers.State.INSERT?d.push(c):(c.state=OpenLayers.State.DELETE,this.layer.drawFeature(c));this.layer.destroyFeatures(d,{silent:!0});o=0;for(p=g.length;o<p;++o)g[o].state=OpenLayers.State.INSERT}else this.layer.destroyFeatures(h,
{silent:!0});this.layer.addFeatures(g,{silent:!0});this.events.triggerEvent("aftersplit",{source:a,features:g})}}return b},geomsToFeatures:function(a,b){var c=a.clone();delete c.geometry;for(var d,e=0,f=b.length;e<f;++e)d=c.clone(),d.geometry=b[e],d.state=OpenLayers.State.INSERT,b[e]=d},destroy:function(){this.active&&this.deactivate();OpenLayers.Control.prototype.destroy.call(this)},CLASS_NAME:"OpenLayers.Control.Split"});OpenLayers.Layer.WMTS=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,version:"1.0.0",requestEncoding:"KVP",url:null,layer:null,matrixSet:null,style:null,format:"image/jpeg",tileOrigin:null,tileFullExtent:null,formatSuffix:null,matrixIds:null,dimensions:null,params:null,zoomOffset:0,serverResolutions:null,formatSuffixMap:{"image/png":"png","image/png8":"png","image/png24":"png","image/png32":"png",png:"png","image/jpeg":"jpg","image/jpg":"jpg",jpeg:"jpg",jpg:"jpg"},matrix:null,initialize:function(a){var b=
{url:!0,layer:!0,style:!0,matrixSet:!0},c;for(c in b)if(!(c in a))throw Error("Missing property '"+c+"' in layer configuration.");a.params=OpenLayers.Util.upperCaseObject(a.params);OpenLayers.Layer.Grid.prototype.initialize.apply(this,[a.name,a.url,a.params,a]);this.formatSuffix||(this.formatSuffix=this.formatSuffixMap[this.format]||this.format.split("/").pop());if(this.matrixIds&&(a=this.matrixIds.length)&&"string"===typeof this.matrixIds[0]){b=this.matrixIds;this.matrixIds=Array(a);for(c=0;c<a;++c)this.matrixIds[c]=
{identifier:b[c]}}},setMap:function(){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments);this.updateMatrixProperties()},updateMatrixProperties:function(){if(this.matrix=this.getMatrix())if(this.matrix.topLeftCorner&&(this.tileOrigin=this.matrix.topLeftCorner),this.matrix.tileWidth&&this.matrix.tileHeight&&(this.tileSize=new OpenLayers.Size(this.matrix.tileWidth,this.matrix.tileHeight)),this.tileOrigin||(this.tileOrigin=new OpenLayers.LonLat(this.maxExtent.left,this.maxExtent.top)),!this.tileFullExtent)this.tileFullExtent=
this.maxExtent},moveTo:function(a,b,c){(b||!this.matrix)&&this.updateMatrixProperties();return OpenLayers.Layer.Grid.prototype.moveTo.apply(this,arguments)},clone:function(a){null==a&&(a=new OpenLayers.Layer.WMTS(this.options));return a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},getIdentifier:function(){return this.getServerZoom()},getMatrix:function(){var a;if(!this.matrixIds||0===this.matrixIds.length)a={identifier:this.getIdentifier()};else if("scaleDenominator"in this.matrixIds[0])for(var b=
OpenLayers.METERS_PER_INCH*OpenLayers.INCHES_PER_UNIT[this.units]*this.getServerResolution()/2.8E-4,c=Number.POSITIVE_INFINITY,d,e=0,f=this.matrixIds.length;e<f;++e)d=Math.abs(1-this.matrixIds[e].scaleDenominator/b),d<c&&(c=d,a=this.matrixIds[e]);else a=this.matrixIds[this.getIdentifier()];return a},getTileInfo:function(a){var b=this.getServerResolution(),c=(a.lon-this.tileOrigin.lon)/(b*this.tileSize.w),a=(this.tileOrigin.lat-a.lat)/(b*this.tileSize.h),b=Math.floor(c),d=Math.floor(a);return{col:b,
row:d,i:Math.floor((c-b)*this.tileSize.w),j:Math.floor((a-d)*this.tileSize.h)}},getURL:function(a){var a=this.adjustBounds(a),b="";if(!this.tileFullExtent||this.tileFullExtent.intersectsBounds(a)){var c=this.getTileInfo(a.getCenterLonLat()),a=this.dimensions;if("REST"===this.requestEncoding.toUpperCase())if(b=this.params,"string"===typeof this.url&&-1!==this.url.indexOf("{")){var d=this.url.replace(/\{/g,"${"),c={style:this.style,Style:this.style,TileMatrixSet:this.matrixSet,TileMatrix:this.matrix.identifier,
TileRow:c.row,TileCol:c.col};if(a){var e,f;for(f=a.length-1;0<=f;--f)e=a[f],c[e]=b[e.toUpperCase()]}b=OpenLayers.String.format(d,c)}else{d=this.version+"/"+this.layer+"/"+this.style+"/";if(a)for(f=0;f<a.length;f++)b[a[f]]&&(d=d+b[a[f]]+"/");d=d+this.matrixSet+"/"+this.matrix.identifier+"/"+c.row+"/"+c.col+"."+this.formatSuffix;b=OpenLayers.Util.isArray(this.url)?this.selectUrl(d,this.url):this.url;b.match(/\/$/)||(b+="/");b+=d}else"KVP"===this.requestEncoding.toUpperCase()&&(b={SERVICE:"WMTS",REQUEST:"GetTile",
VERSION:this.version,LAYER:this.layer,STYLE:this.style,TILEMATRIXSET:this.matrixSet,TILEMATRIX:this.matrix.identifier,TILEROW:c.row,TILECOL:c.col,FORMAT:this.format},b=OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,[b]))}return b},mergeNewParams:function(a){if("KVP"===this.requestEncoding.toUpperCase())return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,[OpenLayers.Util.upperCaseObject(a)])},CLASS_NAME:"OpenLayers.Layer.WMTS"});OpenLayers.Protocol.SOS.v1_0_0=OpenLayers.Class(OpenLayers.Protocol,{fois:null,formatOptions:null,initialize:function(a){OpenLayers.Protocol.prototype.initialize.apply(this,[a]);a.format||(this.format=new OpenLayers.Format.SOSGetFeatureOfInterest(this.formatOptions))},destroy:function(){this.options&&!this.options.format&&this.format.destroy();this.format=null;OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(a){a=OpenLayers.Util.extend({},a);OpenLayers.Util.applyDefaults(a,this.options||
{});var b=new OpenLayers.Protocol.Response({requestType:"read"}),c=this.format,c=OpenLayers.Format.XML.prototype.write.apply(c,[c.writeNode("sos:GetFeatureOfInterest",{fois:this.fois})]);b.priv=OpenLayers.Request.POST({url:a.url,callback:this.createCallback(this.handleRead,b,a),data:c});return b},handleRead:function(a,b){if(b.callback){var c=a.priv;200<=c.status&&300>c.status?(a.features=this.parseFeatures(c),a.code=OpenLayers.Protocol.Response.SUCCESS):a.code=OpenLayers.Protocol.Response.FAILURE;
b.callback.call(b.scope,a)}},parseFeatures:function(a){var b=a.responseXML;if(!b||!b.documentElement)b=a.responseText;return!b||0>=b.length?null:this.format.read(b)},CLASS_NAME:"OpenLayers.Protocol.SOS.v1_0_0"});OpenLayers.Layer.KaMapCache=OpenLayers.Class(OpenLayers.Layer.KaMap,{IMAGE_EXTENSIONS:{jpeg:"jpg",gif:"gif",png:"png",png8:"png",png24:"png",dithered:"png"},DEFAULT_FORMAT:"jpeg",initialize:function(a,b,c,d){OpenLayers.Layer.KaMap.prototype.initialize.apply(this,arguments);this.extension=this.IMAGE_EXTENSIONS[this.params.i.toLowerCase()||this.DEFAULT_FORMAT]},getURL:function(a){var a=this.adjustBounds(a),b=this.map.getResolution(),c=Math.round(1E4*this.map.getScale())/1E4,d=Math.round(a.left/b),a=
-Math.round(a.top/b),b=Math.floor(d/this.tileSize.w/this.params.metaTileSize.w)*this.tileSize.w*this.params.metaTileSize.w,e=Math.floor(a/this.tileSize.h/this.params.metaTileSize.h)*this.tileSize.h*this.params.metaTileSize.h,c=["/",this.params.map,"/",c,"/",this.params.g.replace(/\s/g,"_"),"/def/t",e,"/l",b,"/t",a,"l",d,".",this.extension],d=this.url;OpenLayers.Util.isArray(d)&&(d=this.selectUrl(c.join(""),d));return d+c.join("")},CLASS_NAME:"OpenLayers.Layer.KaMapCache"});OpenLayers.Protocol.WFS.v1_1_0=OpenLayers.Class(OpenLayers.Protocol.WFS.v1,{version:"1.1.0",initialize:function(a){OpenLayers.Protocol.WFS.v1.prototype.initialize.apply(this,arguments);this.outputFormat&&!this.readFormat&&("gml2"==this.outputFormat.toLowerCase()?this.readFormat=new OpenLayers.Format.GML.v2({featureType:this.featureType,featureNS:this.featureNS,geometryName:this.geometryName}):"json"==this.outputFormat.toLowerCase()&&(this.readFormat=new OpenLayers.Format.GeoJSON))},CLASS_NAME:"OpenLayers.Protocol.WFS.v1_1_0"});OpenLayers.Format.WMSCapabilities.v1_1_1=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1,{version:"1.1.1",readers:{wms:OpenLayers.Util.applyDefaults({SRS:function(a,b){b.srs[this.getChildValue(a)]=!0}},OpenLayers.Format.WMSCapabilities.v1_1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1_1"});OpenLayers.Format.WMSCapabilities.v1_1_1_WMSC=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1_1,{version:"1.1.1",profile:"WMSC",readers:{wms:OpenLayers.Util.applyDefaults({VendorSpecificCapabilities:function(a,b){b.vendorSpecific={tileSets:[]};this.readChildNodes(a,b.vendorSpecific)},TileSet:function(a,b){var c={srs:{},bbox:{},resolutions:[]};this.readChildNodes(a,c);b.tileSets.push(c)},Resolutions:function(a,b){for(var c=this.getChildValue(a).split(" "),d=0,e=c.length;d<e;d++)""!=c[d]&&b.resolutions.push(parseFloat(c[d]))},
Width:function(a,b){b.width=parseInt(this.getChildValue(a))},Height:function(a,b){b.height=parseInt(this.getChildValue(a))},Layers:function(a,b){b.layers=this.getChildValue(a)},Styles:function(a,b){b.styles=this.getChildValue(a)}},OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1_1_WMSC"});OpenLayers.Format.WMSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1,{version:"1.1.0",readers:{wms:OpenLayers.Util.applyDefaults({SRS:function(a,b){for(var c=this.getChildValue(a).split(/ +/),d=0,e=c.length;d<e;d++)b.srs[c[d]]=!0}},OpenLayers.Format.WMSCapabilities.v1_1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1_0"});OpenLayers.Control.LayerSwitcher=OpenLayers.Class(OpenLayers.Control,{roundedCorner:!1,roundedCornerColor:"darkblue",layerStates:null,layersDiv:null,baseLayersDiv:null,baseLayers:null,dataLbl:null,dataLayersDiv:null,dataLayers:null,minimizeDiv:null,maximizeDiv:null,ascending:!0,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,arguments);this.layerStates=[];this.roundedCorner&&OpenLayers.Console.warn("roundedCorner option is deprecated")},destroy:function(){this.clearLayersArray("base");
this.clearLayersArray("data");this.map.events.un({buttonclick:this.onButtonClick,addlayer:this.redraw,changelayer:this.redraw,removelayer:this.redraw,changebaselayer:this.redraw,scope:this});this.events.unregister("buttonclick",this,this.onButtonClick);OpenLayers.Control.prototype.destroy.apply(this,arguments)},setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments);this.map.events.on({addlayer:this.redraw,changelayer:this.redraw,removelayer:this.redraw,changebaselayer:this.redraw,
scope:this});this.outsideViewport?(this.events.attachToElement(this.div),this.events.register("buttonclick",this,this.onButtonClick)):this.map.events.register("buttonclick",this,this.onButtonClick)},draw:function(){OpenLayers.Control.prototype.draw.apply(this);this.loadContents();this.outsideViewport||this.minimizeControl();this.redraw();return this.div},onButtonClick:function(a){a=a.buttonElement;a===this.minimizeDiv?this.minimizeControl():a===this.maximizeDiv?this.maximizeControl():a._layerSwitcher===
this.id&&(a["for"]&&(a=document.getElementById(a["for"])),a.disabled||("radio"==a.type?(a.checked=!0,this.map.setBaseLayer(this.map.getLayer(a._layer))):(a.checked=!a.checked,this.updateMap())))},clearLayersArray:function(a){this[a+"LayersDiv"].innerHTML="";this[a+"Layers"]=[]},checkRedraw:function(){var a=!1;if(!this.layerStates.length||this.map.layers.length!=this.layerStates.length)a=!0;else for(var b=0,c=this.layerStates.length;b<c;b++){var d=this.layerStates[b],e=this.map.layers[b];if(d.name!=
e.name||d.inRange!=e.inRange||d.id!=e.id||d.visibility!=e.visibility){a=!0;break}}return a},redraw:function(){if(!this.checkRedraw())return this.div;this.clearLayersArray("base");this.clearLayersArray("data");var a=!1,b=!1,c=this.map.layers.length;this.layerStates=Array(c);for(var d=0;d<c;d++){var e=this.map.layers[d];this.layerStates[d]={name:e.name,visibility:e.visibility,inRange:e.inRange,id:e.id}}var f=this.map.layers.slice();this.ascending||f.reverse();d=0;for(c=f.length;d<c;d++){var e=f[d],
g=e.isBaseLayer;if(e.displayInLayerSwitcher){g?b=!0:a=!0;var h=g?e==this.map.baseLayer:e.getVisibility(),i=document.createElement("input");i.id=this.id+"_input_"+e.name;i.name=g?this.id+"_baseLayers":e.name;i.type=g?"radio":"checkbox";i.value=e.name;i.checked=h;i.defaultChecked=h;i.className="olButton";i._layer=e.id;i._layerSwitcher=this.id;!g&&!e.inRange&&(i.disabled=!0);h=document.createElement("label");h["for"]=i.id;OpenLayers.Element.addClass(h,"labelSpan olButton");h._layer=e.id;h._layerSwitcher=
this.id;!g&&!e.inRange&&(h.style.color="gray");h.innerHTML=e.name;h.style.verticalAlign=g?"bottom":"baseline";var j=document.createElement("br");(g?this.baseLayers:this.dataLayers).push({layer:e,inputElem:i,labelSpan:h});e=g?this.baseLayersDiv:this.dataLayersDiv;e.appendChild(i);e.appendChild(h);e.appendChild(j)}}this.dataLbl.style.display=a?"":"none";this.baseLbl.style.display=b?"":"none";return this.div},updateMap:function(){for(var a=0,b=this.baseLayers.length;a<b;a++){var c=this.baseLayers[a];
c.inputElem.checked&&this.map.setBaseLayer(c.layer,!1)}a=0;for(b=this.dataLayers.length;a<b;a++)c=this.dataLayers[a],c.layer.setVisibility(c.inputElem.checked)},maximizeControl:function(a){this.div.style.width="";this.div.style.height="";this.showControls(!1);null!=a&&OpenLayers.Event.stop(a)},minimizeControl:function(a){this.div.style.width="0px";this.div.style.height="0px";this.showControls(!0);null!=a&&OpenLayers.Event.stop(a)},showControls:function(a){this.maximizeDiv.style.display=a?"":"none";
this.minimizeDiv.style.display=a?"none":"";this.layersDiv.style.display=a?"none":""},loadContents:function(){this.layersDiv=document.createElement("div");this.layersDiv.id=this.id+"_layersDiv";OpenLayers.Element.addClass(this.layersDiv,"layersDiv");this.baseLbl=document.createElement("div");this.baseLbl.innerHTML=OpenLayers.i18n("Base Layer");OpenLayers.Element.addClass(this.baseLbl,"baseLbl");this.baseLayersDiv=document.createElement("div");OpenLayers.Element.addClass(this.baseLayersDiv,"baseLayersDiv");
this.dataLbl=document.createElement("div");this.dataLbl.innerHTML=OpenLayers.i18n("Overlays");OpenLayers.Element.addClass(this.dataLbl,"dataLbl");this.dataLayersDiv=document.createElement("div");OpenLayers.Element.addClass(this.dataLayersDiv,"dataLayersDiv");this.ascending?(this.layersDiv.appendChild(this.baseLbl),this.layersDiv.appendChild(this.baseLayersDiv),this.layersDiv.appendChild(this.dataLbl),this.layersDiv.appendChild(this.dataLayersDiv)):(this.layersDiv.appendChild(this.dataLbl),this.layersDiv.appendChild(this.dataLayersDiv),
this.layersDiv.appendChild(this.baseLbl),this.layersDiv.appendChild(this.baseLayersDiv));this.div.appendChild(this.layersDiv);this.roundedCorner&&(OpenLayers.Rico.Corner.round(this.div,{corners:"tl bl",bgColor:"transparent",color:this.roundedCornerColor,blend:!1}),OpenLayers.Rico.Corner.changeOpacity(this.layersDiv,0.75));var a=OpenLayers.Util.getImageLocation("layer-switcher-maximize.png");this.maximizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MaximizeDiv",null,null,a,"absolute");
OpenLayers.Element.addClass(this.maximizeDiv,"maximizeDiv olButton");this.maximizeDiv.style.display="none";this.div.appendChild(this.maximizeDiv);a=OpenLayers.Util.getImageLocation("layer-switcher-minimize.png");this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MinimizeDiv",null,null,a,"absolute");OpenLayers.Element.addClass(this.minimizeDiv,"minimizeDiv olButton");this.minimizeDiv.style.display="none";this.div.appendChild(this.minimizeDiv)},CLASS_NAME:"OpenLayers.Control.LayerSwitcher"});OpenLayers.Format.Atom=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{atom:"http://www.w3.org/2005/Atom",georss:"http://www.georss.org/georss"},feedTitle:"untitled",defaultEntryTitle:"untitled",gmlParser:null,xy:!1,read:function(a){"string"==typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));return this.parseFeatures(a)},write:function(a){var b;if(OpenLayers.Util.isArray(a)){b=this.createElementNSPlus("atom:feed");b.appendChild(this.createElementNSPlus("atom:title",{value:this.feedTitle}));
for(var c=0,d=a.length;c<d;c++)b.appendChild(this.buildEntryNode(a[c]))}else b=this.buildEntryNode(a);return OpenLayers.Format.XML.prototype.write.apply(this,[b])},buildContentNode:function(a){var b=this.createElementNSPlus("atom:content",{attributes:{type:a.type||null}});if(a.src)b.setAttribute("src",a.src);else if("text"==a.type||null==a.type)b.appendChild(this.createTextNode(a.value));else if("html"==a.type){if("string"!=typeof a.value)throw"HTML content must be in form of an escaped string";b.appendChild(this.createTextNode(a.value))}else"xhtml"==
a.type?b.appendChild(a.value):"xhtml"==a.type||a.type.match(/(\+|\/)xml$/)?b.appendChild(a.value):b.appendChild(this.createTextNode(a.value));return b},buildEntryNode:function(a){var b=a.attributes,c=b.atom||{},d=this.createElementNSPlus("atom:entry");if(c.authors)for(var e=OpenLayers.Util.isArray(c.authors)?c.authors:[c.authors],f=0,g=e.length;f<g;f++)d.appendChild(this.buildPersonConstructNode("author",e[f]));if(c.categories)for(var e=OpenLayers.Util.isArray(c.categories)?c.categories:[c.categories],
h,f=0,g=e.length;f<g;f++)h=e[f],d.appendChild(this.createElementNSPlus("atom:category",{attributes:{term:h.term,scheme:h.scheme||null,label:h.label||null}}));c.content&&d.appendChild(this.buildContentNode(c.content));if(c.contributors){e=OpenLayers.Util.isArray(c.contributors)?c.contributors:[c.contributors];f=0;for(g=e.length;f<g;f++)d.appendChild(this.buildPersonConstructNode("contributor",e[f]))}a.fid&&d.appendChild(this.createElementNSPlus("atom:id",{value:a.fid}));if(c.links){e=OpenLayers.Util.isArray(c.links)?
c.links:[c.links];f=0;for(g=e.length;f<g;f++)h=e[f],d.appendChild(this.createElementNSPlus("atom:link",{attributes:{href:h.href,rel:h.rel||null,type:h.type||null,hreflang:h.hreflang||null,title:h.title||null,length:h.length||null}}))}c.published&&d.appendChild(this.createElementNSPlus("atom:published",{value:c.published}));c.rights&&d.appendChild(this.createElementNSPlus("atom:rights",{value:c.rights}));if(c.summary||b.description)d.appendChild(this.createElementNSPlus("atom:summary",{value:c.summary||
b.description}));d.appendChild(this.createElementNSPlus("atom:title",{value:c.title||b.title||this.defaultEntryTitle}));c.updated&&d.appendChild(this.createElementNSPlus("atom:updated",{value:c.updated}));a.geometry&&(b=this.createElementNSPlus("georss:where"),b.appendChild(this.buildGeometryNode(a.geometry)),d.appendChild(b));return d},initGmlParser:function(){this.gmlParser=new OpenLayers.Format.GML.v3({xy:this.xy,featureNS:"http://example.com#feature",internalProjection:this.internalProjection,
externalProjection:this.externalProjection})},buildGeometryNode:function(a){this.gmlParser||this.initGmlParser();return this.gmlParser.writeNode("feature:_geometry",a).firstChild},buildPersonConstructNode:function(a,b){var c=["uri","email"],d=this.createElementNSPlus("atom:"+a);d.appendChild(this.createElementNSPlus("atom:name",{value:b.name}));for(var e=0,f=c.length;e<f;e++)b[c[e]]&&d.appendChild(this.createElementNSPlus("atom:"+c[e],{value:b[c[e]]}));return d},getFirstChildValue:function(a,b,c,
d){return(a=this.getElementsByTagNameNS(a,b,c))&&0<a.length?this.getChildValue(a[0],d):d},parseFeature:function(a){var b={},c=null,d=null,e=null,f=this.namespaces.atom;this.parsePersonConstructs(a,"author",b);d=this.getElementsByTagNameNS(a,f,"category");0<d.length&&(b.categories=[]);for(var g=0,h=d.length;g<h;g++){c={};c.term=d[g].getAttribute("term");if(e=d[g].getAttribute("scheme"))c.scheme=e;if(e=d[g].getAttribute("label"))c.label=e;b.categories.push(c)}d=this.getElementsByTagNameNS(a,f,"content");
if(0<d.length){c={};if(e=d[0].getAttribute("type"))c.type=e;(e=d[0].getAttribute("src"))?c.src=e:(c.value="text"==c.type||"html"==c.type||null==c.type?this.getFirstChildValue(a,f,"content",null):"xhtml"==c.type||c.type.match(/(\+|\/)xml$/)?this.getChildEl(d[0]):this.getFirstChildValue(a,f,"content",null),b.content=c)}this.parsePersonConstructs(a,"contributor",b);b.id=this.getFirstChildValue(a,f,"id",null);d=this.getElementsByTagNameNS(a,f,"link");0<d.length&&(b.links=Array(d.length));for(var i=["rel",
"type","hreflang","title","length"],g=0,h=d.length;g<h;g++){c={};c.href=d[g].getAttribute("href");for(var j=0,k=i.length;j<k;j++)(e=d[g].getAttribute(i[j]))&&(c[i[j]]=e);b.links[g]=c}if(c=this.getFirstChildValue(a,f,"published",null))b.published=c;if(c=this.getFirstChildValue(a,f,"rights",null))b.rights=c;if(c=this.getFirstChildValue(a,f,"summary",null))b.summary=c;b.title=this.getFirstChildValue(a,f,"title",null);b.updated=this.getFirstChildValue(a,f,"updated",null);c={title:b.title,description:b.summary,
atom:b};a=this.parseLocations(a)[0];a=new OpenLayers.Feature.Vector(a,c);a.fid=b.id;return a},parseFeatures:function(a){var b=[],c=this.getElementsByTagNameNS(a,this.namespaces.atom,"entry");0==c.length&&(c=[a]);for(var a=0,d=c.length;a<d;a++)b.push(this.parseFeature(c[a]));return b},parseLocations:function(a){var b=this.namespaces.georss,c={components:[]},d=this.getElementsByTagNameNS(a,b,"where");if(d&&0<d.length){this.gmlParser||this.initGmlParser();for(var e=0,f=d.length;e<f;e++)this.gmlParser.readChildNodes(d[e],
c)}c=c.components;if((d=this.getElementsByTagNameNS(a,b,"point"))&&0<d.length){e=0;for(f=d.length;e<f;e++){var g=OpenLayers.String.trim(d[e].firstChild.nodeValue).split(/\s+/);2!=g.length&&(g=OpenLayers.String.trim(d[e].firstChild.nodeValue).split(/\s*,\s*/));c.push(new OpenLayers.Geometry.Point(g[1],g[0]))}}var h=this.getElementsByTagNameNS(a,b,"line");if(h&&0<h.length)for(var i,e=0,f=h.length;e<f;e++){d=OpenLayers.String.trim(h[e].firstChild.nodeValue).split(/\s+/);i=[];for(var j=0,k=d.length;j<
k;j+=2)g=new OpenLayers.Geometry.Point(d[j+1],d[j]),i.push(g);c.push(new OpenLayers.Geometry.LineString(i))}if((a=this.getElementsByTagNameNS(a,b,"polygon"))&&0<a.length){e=0;for(f=a.length;e<f;e++){d=OpenLayers.String.trim(a[e].firstChild.nodeValue).split(/\s+/);i=[];j=0;for(k=d.length;j<k;j+=2)g=new OpenLayers.Geometry.Point(d[j+1],d[j]),i.push(g);c.push(new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(c)]))}}if(this.internalProjection&&this.externalProjection){e=0;for(f=c.length;e<
f;e++)c[e]&&c[e].transform(this.externalProjection,this.internalProjection)}return c},parsePersonConstructs:function(a,b,c){for(var d=[],e=this.namespaces.atom,a=this.getElementsByTagNameNS(a,e,b),f=["uri","email"],g=0,h=a.length;g<h;g++){var i={};i.name=this.getFirstChildValue(a[g],e,"name",null);for(var j=0,k=f.length;j<k;j++){var l=this.getFirstChildValue(a[g],e,f[j],null);l&&(i[f[j]]=l)}d.push(i)}0<d.length&&(c[b+"s"]=d)},CLASS_NAME:"OpenLayers.Format.Atom"});OpenLayers.Control.KeyboardDefaults=OpenLayers.Class(OpenLayers.Control,{autoActivate:!0,slideFactor:75,observeElement:null,draw:function(){this.handler=new OpenLayers.Handler.Keyboard(this,{keydown:this.defaultKeyPress},{observeElement:this.observeElement||document})},defaultKeyPress:function(a){var b,c=!0;switch(a.keyCode){case OpenLayers.Event.KEY_LEFT:this.map.pan(-this.slideFactor,0);break;case OpenLayers.Event.KEY_RIGHT:this.map.pan(this.slideFactor,0);break;case OpenLayers.Event.KEY_UP:this.map.pan(0,
-this.slideFactor);break;case OpenLayers.Event.KEY_DOWN:this.map.pan(0,this.slideFactor);break;case 33:b=this.map.getSize();this.map.pan(0,-0.75*b.h);break;case 34:b=this.map.getSize();this.map.pan(0,0.75*b.h);break;case 35:b=this.map.getSize();this.map.pan(0.75*b.w,0);break;case 36:b=this.map.getSize();this.map.pan(-0.75*b.w,0);break;case 43:case 61:case 187:case 107:this.map.zoomIn();break;case 45:case 109:case 189:case 95:this.map.zoomOut();break;default:c=!1}c&&OpenLayers.Event.stop(a)},CLASS_NAME:"OpenLayers.Control.KeyboardDefaults"});OpenLayers.Format.WMTSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.OWSCommon.v1_1_0,{version:"1.0.0",namespaces:{ows:"http://www.opengis.net/ows/1.1",wmts:"http://www.opengis.net/wmts/1.0",xlink:"http://www.w3.org/1999/xlink"},yx:null,defaultPrefix:"wmts",initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]);this.options=a;a=OpenLayers.Util.extend({},OpenLayers.Format.WMTSCapabilities.prototype.yx);this.yx=OpenLayers.Util.extend(a,this.yx)},read:function(a){"string"==
typeof a&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));a&&9==a.nodeType&&(a=a.documentElement);var b={};this.readNode(a,b);b.version=this.version;return b},readers:{wmts:{Capabilities:function(a,b){this.readChildNodes(a,b)},Contents:function(a,b){b.contents={};b.contents.layers=[];b.contents.tileMatrixSets={};this.readChildNodes(a,b.contents)},Layer:function(a,b){var c={styles:[],formats:[],dimensions:[],tileMatrixSetLinks:[],layers:[]};this.readChildNodes(a,c);b.layers.push(c)},Style:function(a,
b){var c={};c.isDefault="true"===a.getAttribute("isDefault");this.readChildNodes(a,c);b.styles.push(c)},Format:function(a,b){b.formats.push(this.getChildValue(a))},TileMatrixSetLink:function(a,b){var c={};this.readChildNodes(a,c);b.tileMatrixSetLinks.push(c)},TileMatrixSet:function(a,b){if(b.layers){var c={matrixIds:[]};this.readChildNodes(a,c);b.tileMatrixSets[c.identifier]=c}else b.tileMatrixSet=this.getChildValue(a)},TileMatrix:function(a,b){var c={supportedCRS:b.supportedCRS};this.readChildNodes(a,
c);b.matrixIds.push(c)},ScaleDenominator:function(a,b){b.scaleDenominator=parseFloat(this.getChildValue(a))},TopLeftCorner:function(a,b){var c=this.getChildValue(a).split(" "),d;b.supportedCRS&&(d=!!this.yx[b.supportedCRS.replace(/urn:ogc:def:crs:(\w+):.+:(\w+)$/,"urn:ogc:def:crs:$1::$2")]);b.topLeftCorner=d?new OpenLayers.LonLat(c[1],c[0]):new OpenLayers.LonLat(c[0],c[1])},TileWidth:function(a,b){b.tileWidth=parseInt(this.getChildValue(a))},TileHeight:function(a,b){b.tileHeight=parseInt(this.getChildValue(a))},
MatrixWidth:function(a,b){b.matrixWidth=parseInt(this.getChildValue(a))},MatrixHeight:function(a,b){b.matrixHeight=parseInt(this.getChildValue(a))},ResourceURL:function(a,b){b.resourceUrl=b.resourceUrl||{};b.resourceUrl[a.getAttribute("resourceType")]={format:a.getAttribute("format"),template:a.getAttribute("template")}},WSDL:function(a,b){b.wsdl={};b.wsdl.href=a.getAttribute("xlink:href")},ServiceMetadataURL:function(a,b){b.serviceMetadataUrl={};b.serviceMetadataUrl.href=a.getAttribute("xlink:href")},
LegendURL:function(a,b){b.legend={};b.legend.href=a.getAttribute("xlink:href");b.legend.format=a.getAttribute("format")},Dimension:function(a,b){var c={values:[]};this.readChildNodes(a,c);b.dimensions.push(c)},Default:function(a,b){b["default"]=this.getChildValue(a)},Value:function(a,b){b.values.push(this.getChildValue(a))}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WMTSCapabilities.v1_0_0"});
module.exports=OpenLayers;}());
},{}],30:[function(require,module,exports){
/*
 * Copyright (c) 2014 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

( function() {

    "use strict";

    var $ = require('jquery'),
        _ = require('lodash');

    /**
     * Private: encodes parameter object into a dot notation query
     * parameter string.
     *
     * @param params {Object} parameter object
     */
    function encodeQueryParams( params ) {
        var query;
        function traverseParams( params, query ) {
            var result = "";
            _.forIn( params, function( value, key ) {
                if ( value instanceof Array ) {
                    result += query + key + '=' + value.join(',') + "&";
                } else if ( typeof value !== "object" ) {
                    result += query + key + '=' + value + "&";
                } else {
                    result += traverseParams( params[ key ], query + key + "." );
                }
            });
            return result;
        }
        query = "?" + traverseParams( params, '' );
        return query.slice( 0, query.length - 1 );
    }

    /**
     * Private: encodes parameter object into query parameter string.
     *
     * @param xhr {XmlHttpRequest} XmlHttpRequest object
     */
    function handleError( xhr ) {
        console.error( xhr.responseText );
        console.error( xhr );
    }

    module.exports = {

        /**
         * Get a tiles worth of annotations from the server.
         *
         * @param layerId   {String}   annotation layer id
         * @param level     {int}      tile level
         * @param x         {int}      tile x index
         * @param y         {int}      tile y index
         * @param [params]  {Object}   query parameter configuration overrides (optional)
         * @param [success] {Function} function called after success received (optional)
         */
        getTileJSON: function( layerId, level, x, y, params, success ) {
            var _params = ( typeof params === "object" ) ? params : null,
                _success = ( typeof success === "function" ) ? success : null;
            $.get(
                'rest/v1.0/annotation/'
                + layerId + "/"
                + level + "/"
                + x + "/"
                + y + ".json" + encodeQueryParams( _params )
            ).then(
                _success,
                handleError
            );
        },

        /**
         * Write the annotation to the server.
         *
         * @param layerId    {String}   annotation layer id
         * @param annotation {Object}   annotation to be written
         * @param [success]  {Function} function called after success received (optional)
         */
        writeAnnotation: function( layerId, annotation, success ) {
            var _success = ( typeof success === "function" ) ? success : null;
            $.post(
                'rest/v1.0/annotation/',
                JSON.stringify({
                    type: "write",
                    annotation: annotation,
                    layer: layerId
                })
            ).then(
                _success,
                handleError
            );
        },

        /**
         * Modify an the annotation on the server.
         *
         * @param layerId    {String}   annotation layer id
         * @param annotation {Object}   annotation to be modified
         * @param [success]  {Function} function called after success received (optional)
         */
        modifyAnnotation: function( layerId, annotation, success ) {
            var _success = ( typeof success === "function" ) ? success : null;
            $.post(
                'rest/v1.0/annotation/',
                JSON.stringify({
                    type: "modify",
                    annotation: annotation,
                    layer: layerId
                })
            ).then(
                _success,
                handleError
            );
        },

        /**
         * Remove the annotation from the server.
         *
         * @param layerId     {String}   annotation layer id
         * @param certificate {Object}   certificate of annotation to be removed
         * @param [success]   {Function} function called after success received (optional)
         */
        removeAnnotation: function( layerId, certificate, success ) {
            var _success = ( typeof success === "function" ) ? success : null;
            $.post(
                'rest/v1.0/annotation/',
                JSON.stringify({
                    type: "remove",
                    certificate: certificate,
                    layer: layerId
                })
            ).then(
                _success,
                handleError
            );
        }

    };
}());

},{"jquery":2,"lodash":3}],31:[function(require,module,exports){
/*
 * Copyright (c) 2014 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

( function() {

    "use strict";

    var $ = require('jquery');

    /**
     * Private: encodes parameter object into query parameter string.
     *
     * @param xhr {XmlHttpRequest} XmlHttpRequest object
     */
    function handleError( xhr ) {
        console.error( xhr.responseText );
        console.error( xhr );
    }

    module.exports = {

        /**
         * Request all layers from the server.
         *
         * @param [success] {Function} function called after success received (optional)
         */
        getLayers: function( success ) {
            var _success = ( typeof success === "function" ) ? success : null;
            $.get(
                'rest/v1.0/layers'
            ).then(
                _success,
                handleError
            );
        },

        /**
         * Request a specific layer from the server, sending it to the listed callback
         * function when it is received.
         *
         * @param layerId   {String}   layer id
         * @param [success] {Function} function called after success received (optional)
         */
        getLayer: function( layerId, success ) {
            var _success = ( typeof success === "function" ) ? success : null;
            $.get(
                'rest/v1.0/layers/' + layerId
            ).then(
                _success,
                handleError
            );
        },

        /**
         * Store a configuration state on the server.
         *
         * @param layerId   {String}   layer id
         * @param params    {Object}   layer configuration parameters
         * @param [success] {Function} function called after success received (optional)
         */
        saveLayerState: function( layerId, params, success ) {
            var _success = ( typeof success === "function" ) ? success : null;
            $.post(
                'rest/v1.0/layers/' + layerId + '/states',
                JSON.stringify( params )
            ).then(
                _success,
                handleError
            );
        },

        /**
         * Get all configuration states for a layer on the server.
         *
         * @param layerId   {String}   layer id
         * @param [success] {Function} function called after success received (optional)
         */
        getLayerStates: function( layerId, success ) {
            var _success = ( typeof success === "function" ) ? success : null;
            $.get(
                'rest/v1.0/layers/' + layerId + '/states'
            ).then(
                _success,
                handleError
            );
        }
    };
}());

},{"jquery":2}],32:[function(require,module,exports){
/*
 * Copyright (c) 2014 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

( function() {

    "use strict";

    var $ = require('jquery'),
        _ = require('lodash');

    /**
     * Private: encodes parameter object into a dot notation query
     * parameter string.
     *
     * @param params {Object} parameter object
     */
    function encodeQueryParams( params ) {
        var query;
        function traverseParams( params, query ) {
            var result = "";
            _.forIn( params, function( value, key ) {
                if ( value instanceof Array ) {
                    result += query + key + '=' + value.join(',') + "&";
                } else if ( typeof value !== "object" ) {
                    result += query + key + '=' + value + "&";
                } else {
                    result += traverseParams( params[ key ], query + key + "." );
                }
            });
            return result;
        }
        query = "?" + traverseParams( params, '' );
        return query.slice( 0, query.length - 1 );
    }

    /**
     * Private: encodes parameter object into query parameter string.
     *
     * @param xhr {XmlHttpRequest} XmlHttpRequest object
     */
    function handleError( xhr ) {
        console.error( xhr.responseText );
        console.error( xhr );
    }

    module.exports = {

        /**
         * Get an encoded image string representing the rendering legend.
         *
         * @param layerId   {String}   layer id
         * @param [params]  {Object}   query parameter configuration overrides (optional)
         * @param [success] {Function} function called after success received (optional)
         */
        getEncodedImage: function( layerId, params, success ) {
            var _params = ( typeof params === "object" ) ? params : null,
                _success = ( typeof success === "function" ) ? success : null;
            $.get(
                'rest/v1.0/legend/' + layerId + encodeQueryParams( _params )
            ).then(
                _success,
                handleError
            );
        },

        /**
         * Get a png image representing the rendering legend.
         *
         * @param layerId   {String}   layer id
         * @param [params]  {Object}   query parameter configuration overrides (optional)
         * @param [success] {Function} function called after success received (optional)
         */
        getImage: function( layerId, params, success ) {
            var _params = ( typeof params === "object" ) ? params : null,
                _success = ( typeof success === "function" ) ? success : null;
            // explicitly set output type to png image
            _params.output = 'png';
            $.get(
                'rest/v1.0/legend/' + layerId + encodeQueryParams( _params )
            ).then(
                _success,
                handleError
            );
        }
    };
}());

},{"jquery":2,"lodash":3}],33:[function(require,module,exports){
/*
 * Copyright (c) 2014 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

( function() {
    
    "use strict";

    var $ = require('jquery'),
        _ = require('lodash');

    /**
     * Private: encodes parameter object into a dot notation query
     * parameter string.
     *
     * @param params {Object} parameter object
     */
    function encodeQueryParams( params ) {
        var query;
        function traverseParams( params, query ) {
            var result = "";
            _.forIn( params, function( value, key ) {
                if ( value instanceof Array ) {
                    result += query + key + '=' + value.join(',') + "&";
                } else if ( typeof value !== "object" ) {
                    result += query + key + '=' + value + "&";
                } else {
                    result += traverseParams( params[ key ], query + key + "." );
                }
            });
            return result;
        }
        query = "?" + traverseParams( params, '' );
        return query.slice( 0, query.length - 1 );
    }

    /**
     * Private: encodes parameter object into query parameter string.
     *
     * @param xhr {XmlHttpRequest} XmlHttpRequest object
     */
    function handleError( xhr ) {
        console.error( xhr.responseText );
        console.error( xhr );
    }

    module.exports = {

        /**
         * Get a tiles data in JSON format.
         *
         * @param layerId   {String}   layer id
         * @param level     {int}      tile level
         * @param x         {int}      tile x index
         * @param y         {int}      tile y index
         * @param [params]  {Object}   query parameter configuration overrides (optional)
         * @param [success] {Function} function called after success received (optional)
         */
        getTileJSON: function( layerId, level, x, y, params, success ) {
            var _params = ( typeof params === "object" ) ? params : null,
                _success = ( typeof success === "function" ) ? success : null;
            $.get(
                'rest/v1.0/tile/'
                + layerId + "/"
                + level + "/"
                + x + "/"
                + y + ".json" + encodeQueryParams( _params )
            ).then(
                _success,
                handleError
            );
        },

        /**
         * Get a tile rendered as an image.
         *
         * @param layerId   {String}   layer id
         * @param level     {int}      tile level
         * @param x         {int}      tile x index
         * @param y         {int}      tile y index
         * @param [params ] {Object}   query parameter configuration overrides (optional)
         * @param [success] {Function} function called after success received (optional)
         */
        getTileImage: function( layerId, level, x, y, params, success ) {
            var _params = ( typeof params === "object" ) ? params : null,
                _success = ( typeof success === "function" ) ? success : null;
            $.get(
                'rest/v1.0/tile/'
                + layerId + "/"
                + level + "/"
                + x + "/"
                + y + ".png" + encodeQueryParams( _params )
            ).then(
                _success,
                handleError
            );
        }
    };
}());

},{"jquery":2,"lodash":3}],34:[function(require,module,exports){
/*
 * Copyright (c) 2014 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

( function() {

    "use strict";

    var $ = require('jquery'),
        DURATION = 300,
        getMaxContentHeight;

    /**
     * Private: Function constant that caps the maximum height of the overlay element.
     *
     * @returns {int} The maximum height.
     */
    getMaxContentHeight = function() {
        return  Math.floor( $(window).height() / 2 );
    };

    /**
     * Construct an overlay button.
     *
     * @param spec {Object} the specification object.
     *     id : the element id,
     *     header: the header html,
     *     content: the content html,
     *     verticalPosition: the vertical position, "bottom" or "top"
     *     horizontalPosition: the horizontal position, "left" or "right"
     */
    function OverlayButton( spec ) {
        var that = this,
            openOverlay,
            closeOverlay,
            vertical = spec.verticalPosition.toLowerCase() || 'bottom',
            horizontal = spec.horizontalPosition.toLowerCase() || 'right',
            quadrantId,
            $quadrantContainer;

        // get quadrant id
        quadrantId = vertical +'-'+ horizontal +'-overlay-quadrant';

        // get quadrant element
        $quadrantContainer = $( '#'+quadrantId );

        // if doesn't exist, create it
        if ( $quadrantContainer.length === 0 ) {
            $quadrantContainer = $('<div id="'+quadrantId+'"></div>' );
            $('body').append( $quadrantContainer );
        }

        this.id = spec.id;
        this.$container = $('<div id="'+this.id+'" style="float:'+ horizontal+'; clear:'+horizontal+';"></div>' );

        if ( vertical === "bottom" ) {
            $quadrantContainer.prepend( this.$container );
        } else {
            $quadrantContainer.append( this.$container );
        }

        this.$container.addClass('overlay-container');

        this.$header = $('<div id="' + this.id + '-header" class="' +this.id+ '-header overlay-header">'+spec.header+'</div>');
        this.$content = $('<div id="' + this.id + '-content" class="' +this.id+ '-content overlay-content">'+spec.content+'</div>');

        this.$container.append(this.$header);
        this.$container.append(this.$content);

        openOverlay = function () {

            var deltaWidth,
                maxHeight = getMaxContentHeight();

            // measure elements and calc delta width to re-size header
            that.inactiveWidth = that.$header.outerWidth();
            that.activeWidth = that.$content.outerWidth();
            deltaWidth = that.activeWidth - that.inactiveWidth;
            // set opacity to 0, to fade in from
            that.$content.children().css('opacity', 0);
            // set a maximum height
            that.$content.css( 'max-height', maxHeight );
             // disable click until animation is complete
            that.$header.off('click');

            that.$header.animate({
                    // open header
                    width: "+="+deltaWidth
                },
                {
                    complete: function() {
                        // open content
                        var contentHeight = parseInt( that.$content.css('height'), 10 );

                        that.$content.children().animate({
                            opacity: 1
                        }, DURATION );

                        if ( contentHeight >= maxHeight ) {
                            // set timeout to override jquery setting overflow to hidden during
                            // animation. This allows the scrollbar to appear instantly
                            setTimeout( function() {
                                that.$content.css('overflow','');
                            }, 1 );
                        }

                        that.$content.animate({
                            height: 'toggle'
                        },
                        {
                            complete: function() {
                                // re-enable click, but switch to close callback
                                that.$header.click( closeOverlay );
                            },
                            duration: DURATION
                        });
                    },
                    duration: DURATION
                });
        };

        closeOverlay = function() {

            var deltaWidth = that.activeWidth - that.inactiveWidth,
                contentHeight = parseInt( that.$content.css('height'), 10 ),
                maxHeight = getMaxContentHeight();

            // disable click until animation is complete
            that.$header.off('click');
            that.$content.children().css('opacity', 1);
            that.$content.children().animate({
                opacity: 0
            }, DURATION );

            if ( contentHeight >= maxHeight ) {
                // set timeout to override jquery setting overflow to hidden during
                // animation. This allows the scrollbar to appear instantly
                setTimeout( function() {
                    that.$content.css('overflow','');
                }, 1 );
            }

            that.$content.animate({
                    height: 'toggle'
                },
                {
                    complete: function() {
                        that.$header.animate({
                             width: "-="+deltaWidth
                        },
                        {
                            complete: function() {
                                // re-enable click, but switch to open callback
                                that.$header.click( openOverlay );
                            },
                            duration: DURATION
                        });
                    },
                    duration: DURATION
                });
        };

        this.$header.click( openOverlay );

        // begin with content closed, skip animation;
        this.$content.animate({height: 'toggle'});
        this.$content.finish();
    }

    /**
     * Returns the header DOM element.
     *
     * @returns {jQuery|HTMLElement}
     */
    OverlayButton.prototype.getHeaderElement = function() {
        return this.$header;
    };

    /**
     * Returns the content DOM element.
     *
     * @returns {jQuery|HTMLElement}
     */
    OverlayButton.prototype.getContentElement = function() {
        return this.$content;
    };

    /**
     * Returns the container DOM element.
     *
     * @returns {jQuery|HTMLElement}
     */
    OverlayButton.prototypegetContainerElement = function() {
        return this.$container;
    };

    module.exports = OverlayButton;
}());

},{"jquery":2}],35:[function(require,module,exports){
/**
 * Copyright (c) 2014 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

/**
    A hierarchical publish and subscribe object. Channels consist of strings, sub-channels
    are separated with a period ('.'). Publishing to a target channel will propagate the message
    breadth first as follows:
        1) from the root of the hierarchy to the target channel,
        2) from the target channel to all existing sub-channels

    Ex.

        Hierarchy:

            a -> [ a.a, a.ab ] -> [ a.a.a, a.a.b, a.a.c ]

        Publishing to a.a will publish:

            1) from root to target

                [ a -> a.a )

            2) from target to all sub-channels

                [ a.a -> a.a.a -> a.a.b -> a.a.c )

        Publishing to a.a.c will publish:

            1) from root to target

                [ a -> a.a -> a.a.c )

            2) from target to all sub-channels

                [ a.a.c -> null )
*/

( function() {

    "use strict";

    module.exports = {

        /**
         * Subscribe a listener function to the specific channel path.
         *
         * @param channelPath {string}   A '.' delimited channel path.
         * @param subscriber  {Function} The subscriber function associated with the provided path.
         */
        subscribe: function( channelPath, subscriber ) {

            var paths = channelPath.split('.'),
                path,
                currentPath = '',
                channel;

            this.channels = this.channels || {
                subscribers : [],
                children : {}
            };

            channel = this.channels;

            while ( paths.length > 0 ) {
                path = paths.shift();
                currentPath += ( currentPath.length > 0 ) ? '.' + path : path;
                channel.children[ path ] = channel.children[ path ] || {
                    path : currentPath,
                    subscribers : [],
                    children : {}
                };
                channel = channel.children[ path ];
            }
            channel.subscribers.push( subscriber );
        },

        /**
         * Publish a message to a channel path. Publishing to a target channel will propagate the message
         *   breadth first as follows:
         *      1) from the root of the hierarchy to the target channel
         *      2) from the target channel to all existing sub-channels
         *
         * @param channelPath {string}   A '.' delimited channel path.
         * @param message  {*}       The messsage to be published.
         */
        publish: function( channelPath, message ) {

            var paths = channelPath.split('.'),
                children,
                subscribers,
                queue = [],
                path, i, sub,
                leafChannel,
                channel = this.channels || {
                    subscribers : [],
                    children : {}
                };

            // find channel
            while ( paths.length > 0 ) {
                path = paths.shift();
                if ( channel.children[ path ] === undefined ) {
                    return;
                }
                channel = channel.children[ path ];
                queue.push( channel );
            }

            leafChannel = queue.pop();

            // breadth first publishing from root to target
            while ( queue.length > 0 ) {
                channel = queue.shift();
                subscribers = channel.subscribers;
                // publish to current channel
                for ( i=0; i<subscribers.length; i++ ) {
                    subscribers[i]( message, channelPath );
                }
            }

            queue = [ leafChannel ];

            // breadth first publishing from target to all children
            while ( queue.length > 0 ) {
                channel = queue.shift();
                subscribers = channel.subscribers;
                children = channel.children;
                // publish to current channel
                for ( i=0; i<subscribers.length; i++ ) {
                    subscribers[i]( message, channelPath );
                }
                // queue up children for leaf channel
                for ( sub in children ) {
                    if ( children.hasOwnProperty( sub ) ) {
                        queue.push( children[ sub ] );
                    }
                }
            }
        }
    };
}());

},{}],36:[function(require,module,exports){
/*
 * Copyright (c) 2014 Oculus Info Inc.
 * http://www.oculusinfo.com/
 *
 * Released under the MIT License.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do
 * so, subject to the following conditions:

 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

( function() {

    "use strict";

    var $ = require('jquery'),
        propagateEvent;

    /**
     * Private: A propagation handler that will temporarily de-activate the
     * DOM element and propagate the event through to any underlying element.
     * @param event {Event} The event object.
     */
    propagateEvent = function( event ) {
        var newEvent = new event.constructor( event.type, event ),
            element,
            before,
            below;
        element = event.currentTarget;
        before = element.style['pointer-events'];
        element.style['pointer-events'] = 'none';
        below = document.elementFromPoint( event.clientX, event.clientY );
        if ( below ) {
            below.dispatchEvent( newEvent );
        }
        element.style['pointer-events'] = before;
    };

    module.exports = {

        /**
         * Generates an RFC4122 version 4 compliant UUID string.
         * @returns {string}
         */
        generateUuid: function() {
            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                var r = Math.random()*16|0, v = (c === 'x') ? r : (r&0x3|0x8);
                return v.toString(16);
            });
        },

        /**
         * Allows the given DOM element or jQuery object events to propagate through
         * and interact with underlying elements
         *
         * @param elem     {HTMLElement | jQuery} The DOM element.
         * @param [events] {Array}                 Array of events to propagate through (optional).
         */
        enableEventPropagation: function( elem, events ) {

            var domElement = ( elem instanceof $ ) ? elem[0] : elem,
                i;

            if ( !events ) {
                domElement.addEventListener( 'mousedown', propagateEvent );
                domElement.addEventListener( 'mouseup', propagateEvent );
                domElement.addEventListener( 'mousemove', propagateEvent );
                domElement.addEventListener( 'wheel', propagateEvent );
                domElement.addEventListener( 'scroll', propagateEvent );
                domElement.addEventListener( 'click', propagateEvent );
                domElement.addEventListener( 'dblclick', propagateEvent );
            } else {
                events = ( events instanceof Array ) ? events : [events];
                for ( i=0; i<events.length; i++ ) {
                    domElement.addEventListener( events[i], propagateEvent );
                }
            }
        },

        /**
         * Removes previously enabled event propagation.
         *
         * @param elem     {HTMLElement | jQuery} The DOM element.
         * @param [events] {Array}               Array of events to remove (optional).
         */
        disableEventPropagation: function( elem, events ) {

            var domElement = ( elem instanceof $ ) ? elem[0] : elem,
                i;
            if ( !events ) {
                domElement.removeEventListener( 'mousedown', propagateEvent );
                domElement.removeEventListener( 'mouseup', propagateEvent );
                domElement.removeEventListener( 'mousemove', propagateEvent );
                domElement.removeEventListener( 'wheel', propagateEvent );
                domElement.removeEventListener( 'scroll', propagateEvent );
                domElement.removeEventListener( 'click', propagateEvent );
                domElement.removeEventListener( 'dblclick', propagateEvent );
            } else {
                events = ( events instanceof Array ) ? events : [events];
                for ( i=0; i<events.length; i++ ) {
                    domElement.removeEventListener( events[i], propagateEvent );
                }
            }
        },

        /**
         * Returns a proper modulo as the % operator in javascript is the 'remainder' operator.
         * @param value {number} the value
         * @param n     {number} the divisor
         * @returns {number}
         */
        mod: function( value, n ) {
           return ( (value % n) + n) % n;
        },

        /**
         * Rounds a given value to a set number of decimals. Defaults to 2.
         *
         * @param value    {number} value to round
         * @param decimals {int}    number of decimals
         * @returns {string} rounded value
         */
        roundToDecimals: function( value, decimals ) {
            var numDec = decimals || 2,
                pow10 = Math.pow( 10, numDec );
            return parseFloat( Math.round( value * pow10 ) / pow10 ).toFixed( decimals );
        },

        /**
         * Registers a click handler that only fires if the click didn't
         * involve a map drag. Since the map is moving under the mouse cursor
         * the browser will still register a click despite mouse movement. This
         * guards against that.
         *
         * @param element     {HTMLElement} The DOM element to attach the event.
         * @param callback    {Function}    The callback function.
         * @param [threshold] {int}         The movement threshold (optional).
         */
        dragSensitiveClick : function( element, callback, threshold ) {
            var dragStart = {x: null, y: null};

            threshold = threshold || 10;

            element.onmousedown = function( evt ) {
                dragStart.x = evt.pageX;
                dragStart.y = evt.pageY;
            };

            element.onclick = function( evt ) {
                if (Math.abs( dragStart.x - evt.pageX ) < threshold &&
                    Math.abs( dragStart.y - evt.pageY ) < threshold ) {
                    callback.call( this, evt );
                }
            };
        },

        /**
         * Return an object containing all parameters and values in the current
         * URL.
         * @returns {Object}
         */
        getURLParameters: function() {
            var url = window.location.search.substring(1),
                urlVars = url.split('&'),
                result = {},
                keyValue,
                i;
            for  (i=0; i<urlVars.length; ++i ) {
                keyValue = urlVars[i].split('=');
                result[ keyValue[0] ] = keyValue[1];
            }
            return result;
        },

        /**
         * Return the value of a specific parameters in the current URL.
         *
         * @param key {string} The url parameter key.
         * @returns {string}
         */
        getURLParameter: function( key ) {
            return this.getURLParameters()[ key ];
        }

    };
}());

},{"jquery":2}]},{},[1])(1)
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlc1xcYnJvd3NlcmlmeVxcbm9kZV9tb2R1bGVzXFxicm93c2VyLXBhY2tcXF9wcmVsdWRlLmpzIiwic3JjXFxqc1xcYXBpLmpzIiwibm9kZV9tb2R1bGVzXFxqcXVlcnlcXGRpc3RcXGpxdWVyeS5qcyIsIm5vZGVfbW9kdWxlc1xcbG9kYXNoXFxkaXN0XFxsb2Rhc2guanMiLCJzcmNcXGpzXFxiaW5uaW5nXFxBcmVhT2ZJbnRlcmVzdFRpbGVQeXJhbWlkLmpzIiwic3JjXFxqc1xcYmlubmluZ1xcVGlsZUl0ZXJhdG9yLmpzIiwic3JjXFxqc1xcYmlubmluZ1xcV2ViTWVyY2F0b3JUaWxlUHlyYW1pZC5qcyIsInNyY1xcanNcXGxheWVyXFxBbm5vdGF0aW9uTGF5ZXIuanMiLCJzcmNcXGpzXFxsYXllclxcQmFzZUxheWVyLmpzIiwic3JjXFxqc1xcbGF5ZXJcXENsaWVudExheWVyLmpzIiwic3JjXFxqc1xcbGF5ZXJcXEh0bWxUaWxlLmpzIiwic3JjXFxqc1xcbGF5ZXJcXEh0bWxUaWxlTGF5ZXIuanMiLCJzcmNcXGpzXFxsYXllclxcTGF5ZXIuanMiLCJzcmNcXGpzXFxsYXllclxcTGF5ZXJVdGlsLmpzIiwic3JjXFxqc1xcbGF5ZXJcXFNlcnZlckxheWVyLmpzIiwic3JjXFxqc1xcbGF5ZXJcXHJlbmRlcmVyXFxHcmFwaExhYmVsUmVuZGVyZXIuanMiLCJzcmNcXGpzXFxsYXllclxccmVuZGVyZXJcXEdyYXBoTm9kZVJlbmRlcmVyLmpzIiwic3JjXFxqc1xcbGF5ZXJcXHJlbmRlcmVyXFxQb2ludEFnZ3JlZ2F0ZVJlbmRlcmVyLmpzIiwic3JjXFxqc1xcbGF5ZXJcXHJlbmRlcmVyXFxQb2ludFJlbmRlcmVyLmpzIiwic3JjXFxqc1xcbGF5ZXJcXHJlbmRlcmVyXFxSZW5kZXJUaGVtZS5qcyIsInNyY1xcanNcXGxheWVyXFxyZW5kZXJlclxcUmVuZGVyZXIuanMiLCJzcmNcXGpzXFxsYXllclxccmVuZGVyZXJcXFJlbmRlcmVyVXRpbC5qcyIsInNyY1xcanNcXGxheWVyXFxyZW5kZXJlclxcVGV4dEJ5RnJlcXVlbmN5UmVuZGVyZXIuanMiLCJzcmNcXGpzXFxsYXllclxccmVuZGVyZXJcXFRleHRTY29yZVJlbmRlcmVyLmpzIiwic3JjXFxqc1xcbGF5ZXJcXHJlbmRlcmVyXFxXb3JkQ2xvdWRSZW5kZXJlci5qcyIsInNyY1xcanNcXG1hcFxcQXhpcy5qcyIsInNyY1xcanNcXG1hcFxcQXhpc1V0aWwuanMiLCJzcmNcXGpzXFxtYXBcXE1hcC5qcyIsInNyY1xcanNcXG1hcFxcTWFwVXRpbC5qcyIsInNyY1xcanNcXG9wZW5sYXllcnNcXE9wZW5MYXllcnMubWluLmpzIiwic3JjXFxqc1xccmVzdFxcQW5ub3RhdGlvblNlcnZpY2UuanMiLCJzcmNcXGpzXFxyZXN0XFxMYXllclNlcnZpY2UuanMiLCJzcmNcXGpzXFxyZXN0XFxMZWdlbmRTZXJ2aWNlLmpzIiwic3JjXFxqc1xccmVzdFxcVGlsZVNlcnZpY2UuanMiLCJzcmNcXGpzXFx1aVxcT3ZlcmxheUJ1dHRvbi5qcyIsInNyY1xcanNcXHV0aWxcXFB1YlN1Yi5qcyIsInNyY1xcanNcXHV0aWxcXFV0aWwuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdCtSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25vTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0xBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25HQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcExBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcElBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaFdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4S0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNVBBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqaUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFYQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2bUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2MkNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4SEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM05BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbktBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgT2N1bHVzIEluZm8gSW5jLlxyXG4gKiBodHRwOi8vd3d3Lm9jdWx1c2luZm8uY29tL1xyXG4gKiBcclxuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKiBcclxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weSBvZlxyXG4gKiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluXHJcbiAqIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG9cclxuICogdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXNcclxuICogb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvXHJcbiAqIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcclxuICogXHJcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbFxyXG4gKiBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxyXG4gKiBcclxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxyXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXHJcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcclxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEVcclxuICogU09GVFdBUkUuXHJcbiAqL1xyXG5cclxuKCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICBtb2R1bGUuZXhwb3J0cyA9IHtcclxuXHJcbiAgICAgICAgLy8gQmlubmluZ1xyXG4gICAgICAgIEFyZWFPZkludGVyZXN0VGlsZVB5cmFtaWQ6IHJlcXVpcmUoJy4vYmlubmluZy9BcmVhT2ZJbnRlcmVzdFRpbGVQeXJhbWlkJyksXHJcbiAgICAgICAgVGlsZUl0ZXJhdG9yOiByZXF1aXJlKCcuL2Jpbm5pbmcvVGlsZUl0ZXJhdG9yJyksXHJcbiAgICAgICAgV2ViTWVyY2F0b3JUaWxlUHlyYW1pZDogcmVxdWlyZSgnLi9iaW5uaW5nL1dlYk1lcmNhdG9yVGlsZVB5cmFtaWQnKSxcclxuXHJcbiAgICAgICAgLy8gTGF5ZXJcclxuICAgICAgICBBbm5vdGF0aW9uTGF5ZXI6IHJlcXVpcmUoJy4vbGF5ZXIvQW5ub3RhdGlvbkxheWVyJyksXHJcbiAgICAgICAgQmFzZUxheWVyOiByZXF1aXJlKCcuL2xheWVyL0Jhc2VMYXllcicpLFxyXG4gICAgICAgIFNlcnZlckxheWVyOiByZXF1aXJlKCcuL2xheWVyL1NlcnZlckxheWVyJyksXHJcbiAgICAgICAgQ2xpZW50TGF5ZXI6IHJlcXVpcmUoJy4vbGF5ZXIvQ2xpZW50TGF5ZXInKSxcclxuICAgICAgICBMYXllclV0aWw6IHJlcXVpcmUoJy4vbGF5ZXIvTGF5ZXJVdGlsJyksXHJcblxyXG4gICAgICAgIC8vIFJlbmRlcmVyc1xyXG4gICAgICAgIEdyYXBoTGFiZWxSZW5kZXJlcjogcmVxdWlyZSgnLi9sYXllci9yZW5kZXJlci9HcmFwaExhYmVsUmVuZGVyZXInKSxcclxuICAgICAgICBHcmFwaE5vZGVSZW5kZXJlcjogcmVxdWlyZSgnLi9sYXllci9yZW5kZXJlci9HcmFwaE5vZGVSZW5kZXJlcicpLFxyXG4gICAgICAgIFBvaW50QWdncmVnYXRlUmVuZGVyZXI6IHJlcXVpcmUoJy4vbGF5ZXIvcmVuZGVyZXIvUG9pbnRBZ2dyZWdhdGVSZW5kZXJlcicpLFxyXG4gICAgICAgIFBvaW50UmVuZGVyZXI6IHJlcXVpcmUoJy4vbGF5ZXIvcmVuZGVyZXIvUG9pbnRSZW5kZXJlcicpLFxyXG4gICAgICAgIFRleHRCeUZyZXF1ZW5jeVJlbmRlcmVyOiByZXF1aXJlKCcuL2xheWVyL3JlbmRlcmVyL1RleHRCeUZyZXF1ZW5jeVJlbmRlcmVyJyksXHJcbiAgICAgICAgVGV4dFNjb3JlUmVuZGVyZXI6IHJlcXVpcmUoJy4vbGF5ZXIvcmVuZGVyZXIvVGV4dFNjb3JlUmVuZGVyZXInKSxcclxuICAgICAgICBXb3JkQ2xvdWRSZW5kZXJlcjogcmVxdWlyZSgnLi9sYXllci9yZW5kZXJlci9Xb3JkQ2xvdWRSZW5kZXJlcicpLFxyXG4gICAgICAgIFJlbmRlclRoZW1lOiByZXF1aXJlKCcuL2xheWVyL3JlbmRlcmVyL1JlbmRlclRoZW1lJyksXHJcblxyXG4gICAgICAgIC8vIE1hcFxyXG4gICAgICAgIE1hcDogcmVxdWlyZSgnLi9tYXAvTWFwJyksXHJcbiAgICAgICAgTWFwVXRpbDogcmVxdWlyZSgnLi9tYXAvTWFwVXRpbCcpLFxyXG4gICAgICAgIEF4aXM6IHJlcXVpcmUoJy4vbWFwL0F4aXMnKSxcclxuICAgICAgICBBeGlzVXRpbDogcmVxdWlyZSgnLi9tYXAvQXhpc1V0aWwnKSxcclxuXHJcbiAgICAgICAgLy8gUkVTVFxyXG4gICAgICAgIEFubm90YXRpb25TZXJ2aWNlOiByZXF1aXJlKCcuL3Jlc3QvQW5ub3RhdGlvblNlcnZpY2UnKSxcclxuICAgICAgICBMYXllclNlcnZpY2U6IHJlcXVpcmUoJy4vcmVzdC9MYXllclNlcnZpY2UnKSxcclxuICAgICAgICBMZWdlbmRTZXJ2aWNlOiByZXF1aXJlKCcuL3Jlc3QvTGVnZW5kU2VydmljZScpLFxyXG4gICAgICAgIFRpbGVTZXJ2aWNlOiByZXF1aXJlKCcuL3Jlc3QvVGlsZVNlcnZpY2UnKSxcclxuXHJcbiAgICAgICAgLy8gVUlcclxuICAgICAgICBPdmVybGF5QnV0dG9uOiByZXF1aXJlKCcuL3VpL092ZXJsYXlCdXR0b24nKSxcclxuXHJcbiAgICAgICAgLy8gVXRpbFxyXG4gICAgICAgIFB1YlN1YjogcmVxdWlyZSgnLi91dGlsL1B1YlN1YicpLFxyXG4gICAgICAgIFV0aWw6IHJlcXVpcmUoJy4vdXRpbC9VdGlsJylcclxuICAgIH07XHJcblxyXG59KCkpO1xyXG4iLCIvKiFcbiAqIGpRdWVyeSBKYXZhU2NyaXB0IExpYnJhcnkgdjIuMS4xXG4gKiBodHRwOi8vanF1ZXJ5LmNvbS9cbiAqXG4gKiBJbmNsdWRlcyBTaXp6bGUuanNcbiAqIGh0dHA6Ly9zaXp6bGVqcy5jb20vXG4gKlxuICogQ29weXJpZ2h0IDIwMDUsIDIwMTQgalF1ZXJ5IEZvdW5kYXRpb24sIEluYy4gYW5kIG90aGVyIGNvbnRyaWJ1dG9yc1xuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlXG4gKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlXG4gKlxuICogRGF0ZTogMjAxNC0wNS0wMVQxNzoxMVpcbiAqL1xuXG4oZnVuY3Rpb24oIGdsb2JhbCwgZmFjdG9yeSApIHtcblxuXHRpZiAoIHR5cGVvZiBtb2R1bGUgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIG1vZHVsZS5leHBvcnRzID09PSBcIm9iamVjdFwiICkge1xuXHRcdC8vIEZvciBDb21tb25KUyBhbmQgQ29tbW9uSlMtbGlrZSBlbnZpcm9ubWVudHMgd2hlcmUgYSBwcm9wZXIgd2luZG93IGlzIHByZXNlbnQsXG5cdFx0Ly8gZXhlY3V0ZSB0aGUgZmFjdG9yeSBhbmQgZ2V0IGpRdWVyeVxuXHRcdC8vIEZvciBlbnZpcm9ubWVudHMgdGhhdCBkbyBub3QgaW5oZXJlbnRseSBwb3NzZXMgYSB3aW5kb3cgd2l0aCBhIGRvY3VtZW50XG5cdFx0Ly8gKHN1Y2ggYXMgTm9kZS5qcyksIGV4cG9zZSBhIGpRdWVyeS1tYWtpbmcgZmFjdG9yeSBhcyBtb2R1bGUuZXhwb3J0c1xuXHRcdC8vIFRoaXMgYWNjZW50dWF0ZXMgdGhlIG5lZWQgZm9yIHRoZSBjcmVhdGlvbiBvZiBhIHJlYWwgd2luZG93XG5cdFx0Ly8gZS5nLiB2YXIgalF1ZXJ5ID0gcmVxdWlyZShcImpxdWVyeVwiKSh3aW5kb3cpO1xuXHRcdC8vIFNlZSB0aWNrZXQgIzE0NTQ5IGZvciBtb3JlIGluZm9cblx0XHRtb2R1bGUuZXhwb3J0cyA9IGdsb2JhbC5kb2N1bWVudCA/XG5cdFx0XHRmYWN0b3J5KCBnbG9iYWwsIHRydWUgKSA6XG5cdFx0XHRmdW5jdGlvbiggdyApIHtcblx0XHRcdFx0aWYgKCAhdy5kb2N1bWVudCApIHtcblx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoIFwialF1ZXJ5IHJlcXVpcmVzIGEgd2luZG93IHdpdGggYSBkb2N1bWVudFwiICk7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIGZhY3RvcnkoIHcgKTtcblx0XHRcdH07XG5cdH0gZWxzZSB7XG5cdFx0ZmFjdG9yeSggZ2xvYmFsICk7XG5cdH1cblxuLy8gUGFzcyB0aGlzIGlmIHdpbmRvdyBpcyBub3QgZGVmaW5lZCB5ZXRcbn0odHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHRoaXMsIGZ1bmN0aW9uKCB3aW5kb3csIG5vR2xvYmFsICkge1xuXG4vLyBDYW4ndCBkbyB0aGlzIGJlY2F1c2Ugc2V2ZXJhbCBhcHBzIGluY2x1ZGluZyBBU1AuTkVUIHRyYWNlXG4vLyB0aGUgc3RhY2sgdmlhIGFyZ3VtZW50cy5jYWxsZXIuY2FsbGVlIGFuZCBGaXJlZm94IGRpZXMgaWZcbi8vIHlvdSB0cnkgdG8gdHJhY2UgdGhyb3VnaCBcInVzZSBzdHJpY3RcIiBjYWxsIGNoYWlucy4gKCMxMzMzNSlcbi8vIFN1cHBvcnQ6IEZpcmVmb3ggMTgrXG4vL1xuXG52YXIgYXJyID0gW107XG5cbnZhciBzbGljZSA9IGFyci5zbGljZTtcblxudmFyIGNvbmNhdCA9IGFyci5jb25jYXQ7XG5cbnZhciBwdXNoID0gYXJyLnB1c2g7XG5cbnZhciBpbmRleE9mID0gYXJyLmluZGV4T2Y7XG5cbnZhciBjbGFzczJ0eXBlID0ge307XG5cbnZhciB0b1N0cmluZyA9IGNsYXNzMnR5cGUudG9TdHJpbmc7XG5cbnZhciBoYXNPd24gPSBjbGFzczJ0eXBlLmhhc093blByb3BlcnR5O1xuXG52YXIgc3VwcG9ydCA9IHt9O1xuXG5cblxudmFyXG5cdC8vIFVzZSB0aGUgY29ycmVjdCBkb2N1bWVudCBhY2NvcmRpbmdseSB3aXRoIHdpbmRvdyBhcmd1bWVudCAoc2FuZGJveClcblx0ZG9jdW1lbnQgPSB3aW5kb3cuZG9jdW1lbnQsXG5cblx0dmVyc2lvbiA9IFwiMi4xLjFcIixcblxuXHQvLyBEZWZpbmUgYSBsb2NhbCBjb3B5IG9mIGpRdWVyeVxuXHRqUXVlcnkgPSBmdW5jdGlvbiggc2VsZWN0b3IsIGNvbnRleHQgKSB7XG5cdFx0Ly8gVGhlIGpRdWVyeSBvYmplY3QgaXMgYWN0dWFsbHkganVzdCB0aGUgaW5pdCBjb25zdHJ1Y3RvciAnZW5oYW5jZWQnXG5cdFx0Ly8gTmVlZCBpbml0IGlmIGpRdWVyeSBpcyBjYWxsZWQgKGp1c3QgYWxsb3cgZXJyb3IgdG8gYmUgdGhyb3duIGlmIG5vdCBpbmNsdWRlZClcblx0XHRyZXR1cm4gbmV3IGpRdWVyeS5mbi5pbml0KCBzZWxlY3RvciwgY29udGV4dCApO1xuXHR9LFxuXG5cdC8vIFN1cHBvcnQ6IEFuZHJvaWQ8NC4xXG5cdC8vIE1ha2Ugc3VyZSB3ZSB0cmltIEJPTSBhbmQgTkJTUFxuXHRydHJpbSA9IC9eW1xcc1xcdUZFRkZcXHhBMF0rfFtcXHNcXHVGRUZGXFx4QTBdKyQvZyxcblxuXHQvLyBNYXRjaGVzIGRhc2hlZCBzdHJpbmcgZm9yIGNhbWVsaXppbmdcblx0cm1zUHJlZml4ID0gL14tbXMtLyxcblx0cmRhc2hBbHBoYSA9IC8tKFtcXGRhLXpdKS9naSxcblxuXHQvLyBVc2VkIGJ5IGpRdWVyeS5jYW1lbENhc2UgYXMgY2FsbGJhY2sgdG8gcmVwbGFjZSgpXG5cdGZjYW1lbENhc2UgPSBmdW5jdGlvbiggYWxsLCBsZXR0ZXIgKSB7XG5cdFx0cmV0dXJuIGxldHRlci50b1VwcGVyQ2FzZSgpO1xuXHR9O1xuXG5qUXVlcnkuZm4gPSBqUXVlcnkucHJvdG90eXBlID0ge1xuXHQvLyBUaGUgY3VycmVudCB2ZXJzaW9uIG9mIGpRdWVyeSBiZWluZyB1c2VkXG5cdGpxdWVyeTogdmVyc2lvbixcblxuXHRjb25zdHJ1Y3RvcjogalF1ZXJ5LFxuXG5cdC8vIFN0YXJ0IHdpdGggYW4gZW1wdHkgc2VsZWN0b3Jcblx0c2VsZWN0b3I6IFwiXCIsXG5cblx0Ly8gVGhlIGRlZmF1bHQgbGVuZ3RoIG9mIGEgalF1ZXJ5IG9iamVjdCBpcyAwXG5cdGxlbmd0aDogMCxcblxuXHR0b0FycmF5OiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gc2xpY2UuY2FsbCggdGhpcyApO1xuXHR9LFxuXG5cdC8vIEdldCB0aGUgTnRoIGVsZW1lbnQgaW4gdGhlIG1hdGNoZWQgZWxlbWVudCBzZXQgT1Jcblx0Ly8gR2V0IHRoZSB3aG9sZSBtYXRjaGVkIGVsZW1lbnQgc2V0IGFzIGEgY2xlYW4gYXJyYXlcblx0Z2V0OiBmdW5jdGlvbiggbnVtICkge1xuXHRcdHJldHVybiBudW0gIT0gbnVsbCA/XG5cblx0XHRcdC8vIFJldHVybiBqdXN0IHRoZSBvbmUgZWxlbWVudCBmcm9tIHRoZSBzZXRcblx0XHRcdCggbnVtIDwgMCA/IHRoaXNbIG51bSArIHRoaXMubGVuZ3RoIF0gOiB0aGlzWyBudW0gXSApIDpcblxuXHRcdFx0Ly8gUmV0dXJuIGFsbCB0aGUgZWxlbWVudHMgaW4gYSBjbGVhbiBhcnJheVxuXHRcdFx0c2xpY2UuY2FsbCggdGhpcyApO1xuXHR9LFxuXG5cdC8vIFRha2UgYW4gYXJyYXkgb2YgZWxlbWVudHMgYW5kIHB1c2ggaXQgb250byB0aGUgc3RhY2tcblx0Ly8gKHJldHVybmluZyB0aGUgbmV3IG1hdGNoZWQgZWxlbWVudCBzZXQpXG5cdHB1c2hTdGFjazogZnVuY3Rpb24oIGVsZW1zICkge1xuXG5cdFx0Ly8gQnVpbGQgYSBuZXcgalF1ZXJ5IG1hdGNoZWQgZWxlbWVudCBzZXRcblx0XHR2YXIgcmV0ID0galF1ZXJ5Lm1lcmdlKCB0aGlzLmNvbnN0cnVjdG9yKCksIGVsZW1zICk7XG5cblx0XHQvLyBBZGQgdGhlIG9sZCBvYmplY3Qgb250byB0aGUgc3RhY2sgKGFzIGEgcmVmZXJlbmNlKVxuXHRcdHJldC5wcmV2T2JqZWN0ID0gdGhpcztcblx0XHRyZXQuY29udGV4dCA9IHRoaXMuY29udGV4dDtcblxuXHRcdC8vIFJldHVybiB0aGUgbmV3bHktZm9ybWVkIGVsZW1lbnQgc2V0XG5cdFx0cmV0dXJuIHJldDtcblx0fSxcblxuXHQvLyBFeGVjdXRlIGEgY2FsbGJhY2sgZm9yIGV2ZXJ5IGVsZW1lbnQgaW4gdGhlIG1hdGNoZWQgc2V0LlxuXHQvLyAoWW91IGNhbiBzZWVkIHRoZSBhcmd1bWVudHMgd2l0aCBhbiBhcnJheSBvZiBhcmdzLCBidXQgdGhpcyBpc1xuXHQvLyBvbmx5IHVzZWQgaW50ZXJuYWxseS4pXG5cdGVhY2g6IGZ1bmN0aW9uKCBjYWxsYmFjaywgYXJncyApIHtcblx0XHRyZXR1cm4galF1ZXJ5LmVhY2goIHRoaXMsIGNhbGxiYWNrLCBhcmdzICk7XG5cdH0sXG5cblx0bWFwOiBmdW5jdGlvbiggY2FsbGJhY2sgKSB7XG5cdFx0cmV0dXJuIHRoaXMucHVzaFN0YWNrKCBqUXVlcnkubWFwKHRoaXMsIGZ1bmN0aW9uKCBlbGVtLCBpICkge1xuXHRcdFx0cmV0dXJuIGNhbGxiYWNrLmNhbGwoIGVsZW0sIGksIGVsZW0gKTtcblx0XHR9KSk7XG5cdH0sXG5cblx0c2xpY2U6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0aGlzLnB1c2hTdGFjayggc2xpY2UuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApICk7XG5cdH0sXG5cblx0Zmlyc3Q6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0aGlzLmVxKCAwICk7XG5cdH0sXG5cblx0bGFzdDogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMuZXEoIC0xICk7XG5cdH0sXG5cblx0ZXE6IGZ1bmN0aW9uKCBpICkge1xuXHRcdHZhciBsZW4gPSB0aGlzLmxlbmd0aCxcblx0XHRcdGogPSAraSArICggaSA8IDAgPyBsZW4gOiAwICk7XG5cdFx0cmV0dXJuIHRoaXMucHVzaFN0YWNrKCBqID49IDAgJiYgaiA8IGxlbiA/IFsgdGhpc1tqXSBdIDogW10gKTtcblx0fSxcblxuXHRlbmQ6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0aGlzLnByZXZPYmplY3QgfHwgdGhpcy5jb25zdHJ1Y3RvcihudWxsKTtcblx0fSxcblxuXHQvLyBGb3IgaW50ZXJuYWwgdXNlIG9ubHkuXG5cdC8vIEJlaGF2ZXMgbGlrZSBhbiBBcnJheSdzIG1ldGhvZCwgbm90IGxpa2UgYSBqUXVlcnkgbWV0aG9kLlxuXHRwdXNoOiBwdXNoLFxuXHRzb3J0OiBhcnIuc29ydCxcblx0c3BsaWNlOiBhcnIuc3BsaWNlXG59O1xuXG5qUXVlcnkuZXh0ZW5kID0galF1ZXJ5LmZuLmV4dGVuZCA9IGZ1bmN0aW9uKCkge1xuXHR2YXIgb3B0aW9ucywgbmFtZSwgc3JjLCBjb3B5LCBjb3B5SXNBcnJheSwgY2xvbmUsXG5cdFx0dGFyZ2V0ID0gYXJndW1lbnRzWzBdIHx8IHt9LFxuXHRcdGkgPSAxLFxuXHRcdGxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGgsXG5cdFx0ZGVlcCA9IGZhbHNlO1xuXG5cdC8vIEhhbmRsZSBhIGRlZXAgY29weSBzaXR1YXRpb25cblx0aWYgKCB0eXBlb2YgdGFyZ2V0ID09PSBcImJvb2xlYW5cIiApIHtcblx0XHRkZWVwID0gdGFyZ2V0O1xuXG5cdFx0Ly8gc2tpcCB0aGUgYm9vbGVhbiBhbmQgdGhlIHRhcmdldFxuXHRcdHRhcmdldCA9IGFyZ3VtZW50c1sgaSBdIHx8IHt9O1xuXHRcdGkrKztcblx0fVxuXG5cdC8vIEhhbmRsZSBjYXNlIHdoZW4gdGFyZ2V0IGlzIGEgc3RyaW5nIG9yIHNvbWV0aGluZyAocG9zc2libGUgaW4gZGVlcCBjb3B5KVxuXHRpZiAoIHR5cGVvZiB0YXJnZXQgIT09IFwib2JqZWN0XCIgJiYgIWpRdWVyeS5pc0Z1bmN0aW9uKHRhcmdldCkgKSB7XG5cdFx0dGFyZ2V0ID0ge307XG5cdH1cblxuXHQvLyBleHRlbmQgalF1ZXJ5IGl0c2VsZiBpZiBvbmx5IG9uZSBhcmd1bWVudCBpcyBwYXNzZWRcblx0aWYgKCBpID09PSBsZW5ndGggKSB7XG5cdFx0dGFyZ2V0ID0gdGhpcztcblx0XHRpLS07XG5cdH1cblxuXHRmb3IgKCA7IGkgPCBsZW5ndGg7IGkrKyApIHtcblx0XHQvLyBPbmx5IGRlYWwgd2l0aCBub24tbnVsbC91bmRlZmluZWQgdmFsdWVzXG5cdFx0aWYgKCAob3B0aW9ucyA9IGFyZ3VtZW50c1sgaSBdKSAhPSBudWxsICkge1xuXHRcdFx0Ly8gRXh0ZW5kIHRoZSBiYXNlIG9iamVjdFxuXHRcdFx0Zm9yICggbmFtZSBpbiBvcHRpb25zICkge1xuXHRcdFx0XHRzcmMgPSB0YXJnZXRbIG5hbWUgXTtcblx0XHRcdFx0Y29weSA9IG9wdGlvbnNbIG5hbWUgXTtcblxuXHRcdFx0XHQvLyBQcmV2ZW50IG5ldmVyLWVuZGluZyBsb29wXG5cdFx0XHRcdGlmICggdGFyZ2V0ID09PSBjb3B5ICkge1xuXHRcdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gUmVjdXJzZSBpZiB3ZSdyZSBtZXJnaW5nIHBsYWluIG9iamVjdHMgb3IgYXJyYXlzXG5cdFx0XHRcdGlmICggZGVlcCAmJiBjb3B5ICYmICggalF1ZXJ5LmlzUGxhaW5PYmplY3QoY29weSkgfHwgKGNvcHlJc0FycmF5ID0galF1ZXJ5LmlzQXJyYXkoY29weSkpICkgKSB7XG5cdFx0XHRcdFx0aWYgKCBjb3B5SXNBcnJheSApIHtcblx0XHRcdFx0XHRcdGNvcHlJc0FycmF5ID0gZmFsc2U7XG5cdFx0XHRcdFx0XHRjbG9uZSA9IHNyYyAmJiBqUXVlcnkuaXNBcnJheShzcmMpID8gc3JjIDogW107XG5cblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0Y2xvbmUgPSBzcmMgJiYgalF1ZXJ5LmlzUGxhaW5PYmplY3Qoc3JjKSA/IHNyYyA6IHt9O1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vIE5ldmVyIG1vdmUgb3JpZ2luYWwgb2JqZWN0cywgY2xvbmUgdGhlbVxuXHRcdFx0XHRcdHRhcmdldFsgbmFtZSBdID0galF1ZXJ5LmV4dGVuZCggZGVlcCwgY2xvbmUsIGNvcHkgKTtcblxuXHRcdFx0XHQvLyBEb24ndCBicmluZyBpbiB1bmRlZmluZWQgdmFsdWVzXG5cdFx0XHRcdH0gZWxzZSBpZiAoIGNvcHkgIT09IHVuZGVmaW5lZCApIHtcblx0XHRcdFx0XHR0YXJnZXRbIG5hbWUgXSA9IGNvcHk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHQvLyBSZXR1cm4gdGhlIG1vZGlmaWVkIG9iamVjdFxuXHRyZXR1cm4gdGFyZ2V0O1xufTtcblxualF1ZXJ5LmV4dGVuZCh7XG5cdC8vIFVuaXF1ZSBmb3IgZWFjaCBjb3B5IG9mIGpRdWVyeSBvbiB0aGUgcGFnZVxuXHRleHBhbmRvOiBcImpRdWVyeVwiICsgKCB2ZXJzaW9uICsgTWF0aC5yYW5kb20oKSApLnJlcGxhY2UoIC9cXEQvZywgXCJcIiApLFxuXG5cdC8vIEFzc3VtZSBqUXVlcnkgaXMgcmVhZHkgd2l0aG91dCB0aGUgcmVhZHkgbW9kdWxlXG5cdGlzUmVhZHk6IHRydWUsXG5cblx0ZXJyb3I6IGZ1bmN0aW9uKCBtc2cgKSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKCBtc2cgKTtcblx0fSxcblxuXHRub29wOiBmdW5jdGlvbigpIHt9LFxuXG5cdC8vIFNlZSB0ZXN0L3VuaXQvY29yZS5qcyBmb3IgZGV0YWlscyBjb25jZXJuaW5nIGlzRnVuY3Rpb24uXG5cdC8vIFNpbmNlIHZlcnNpb24gMS4zLCBET00gbWV0aG9kcyBhbmQgZnVuY3Rpb25zIGxpa2UgYWxlcnRcblx0Ly8gYXJlbid0IHN1cHBvcnRlZC4gVGhleSByZXR1cm4gZmFsc2Ugb24gSUUgKCMyOTY4KS5cblx0aXNGdW5jdGlvbjogZnVuY3Rpb24oIG9iaiApIHtcblx0XHRyZXR1cm4galF1ZXJ5LnR5cGUob2JqKSA9PT0gXCJmdW5jdGlvblwiO1xuXHR9LFxuXG5cdGlzQXJyYXk6IEFycmF5LmlzQXJyYXksXG5cblx0aXNXaW5kb3c6IGZ1bmN0aW9uKCBvYmogKSB7XG5cdFx0cmV0dXJuIG9iaiAhPSBudWxsICYmIG9iaiA9PT0gb2JqLndpbmRvdztcblx0fSxcblxuXHRpc051bWVyaWM6IGZ1bmN0aW9uKCBvYmogKSB7XG5cdFx0Ly8gcGFyc2VGbG9hdCBOYU5zIG51bWVyaWMtY2FzdCBmYWxzZSBwb3NpdGl2ZXMgKG51bGx8dHJ1ZXxmYWxzZXxcIlwiKVxuXHRcdC8vIC4uLmJ1dCBtaXNpbnRlcnByZXRzIGxlYWRpbmctbnVtYmVyIHN0cmluZ3MsIHBhcnRpY3VsYXJseSBoZXggbGl0ZXJhbHMgKFwiMHguLi5cIilcblx0XHQvLyBzdWJ0cmFjdGlvbiBmb3JjZXMgaW5maW5pdGllcyB0byBOYU5cblx0XHRyZXR1cm4gIWpRdWVyeS5pc0FycmF5KCBvYmogKSAmJiBvYmogLSBwYXJzZUZsb2F0KCBvYmogKSA+PSAwO1xuXHR9LFxuXG5cdGlzUGxhaW5PYmplY3Q6IGZ1bmN0aW9uKCBvYmogKSB7XG5cdFx0Ly8gTm90IHBsYWluIG9iamVjdHM6XG5cdFx0Ly8gLSBBbnkgb2JqZWN0IG9yIHZhbHVlIHdob3NlIGludGVybmFsIFtbQ2xhc3NdXSBwcm9wZXJ0eSBpcyBub3QgXCJbb2JqZWN0IE9iamVjdF1cIlxuXHRcdC8vIC0gRE9NIG5vZGVzXG5cdFx0Ly8gLSB3aW5kb3dcblx0XHRpZiAoIGpRdWVyeS50eXBlKCBvYmogKSAhPT0gXCJvYmplY3RcIiB8fCBvYmoubm9kZVR5cGUgfHwgalF1ZXJ5LmlzV2luZG93KCBvYmogKSApIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHRpZiAoIG9iai5jb25zdHJ1Y3RvciAmJlxuXHRcdFx0XHQhaGFzT3duLmNhbGwoIG9iai5jb25zdHJ1Y3Rvci5wcm90b3R5cGUsIFwiaXNQcm90b3R5cGVPZlwiICkgKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0Ly8gSWYgdGhlIGZ1bmN0aW9uIGhhc24ndCByZXR1cm5lZCBhbHJlYWR5LCB3ZSdyZSBjb25maWRlbnQgdGhhdFxuXHRcdC8vIHxvYmp8IGlzIGEgcGxhaW4gb2JqZWN0LCBjcmVhdGVkIGJ5IHt9IG9yIGNvbnN0cnVjdGVkIHdpdGggbmV3IE9iamVjdFxuXHRcdHJldHVybiB0cnVlO1xuXHR9LFxuXG5cdGlzRW1wdHlPYmplY3Q6IGZ1bmN0aW9uKCBvYmogKSB7XG5cdFx0dmFyIG5hbWU7XG5cdFx0Zm9yICggbmFtZSBpbiBvYmogKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHRcdHJldHVybiB0cnVlO1xuXHR9LFxuXG5cdHR5cGU6IGZ1bmN0aW9uKCBvYmogKSB7XG5cdFx0aWYgKCBvYmogPT0gbnVsbCApIHtcblx0XHRcdHJldHVybiBvYmogKyBcIlwiO1xuXHRcdH1cblx0XHQvLyBTdXBwb3J0OiBBbmRyb2lkIDwgNC4wLCBpT1MgPCA2IChmdW5jdGlvbmlzaCBSZWdFeHApXG5cdFx0cmV0dXJuIHR5cGVvZiBvYmogPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIG9iaiA9PT0gXCJmdW5jdGlvblwiID9cblx0XHRcdGNsYXNzMnR5cGVbIHRvU3RyaW5nLmNhbGwob2JqKSBdIHx8IFwib2JqZWN0XCIgOlxuXHRcdFx0dHlwZW9mIG9iajtcblx0fSxcblxuXHQvLyBFdmFsdWF0ZXMgYSBzY3JpcHQgaW4gYSBnbG9iYWwgY29udGV4dFxuXHRnbG9iYWxFdmFsOiBmdW5jdGlvbiggY29kZSApIHtcblx0XHR2YXIgc2NyaXB0LFxuXHRcdFx0aW5kaXJlY3QgPSBldmFsO1xuXG5cdFx0Y29kZSA9IGpRdWVyeS50cmltKCBjb2RlICk7XG5cblx0XHRpZiAoIGNvZGUgKSB7XG5cdFx0XHQvLyBJZiB0aGUgY29kZSBpbmNsdWRlcyBhIHZhbGlkLCBwcm9sb2d1ZSBwb3NpdGlvblxuXHRcdFx0Ly8gc3RyaWN0IG1vZGUgcHJhZ21hLCBleGVjdXRlIGNvZGUgYnkgaW5qZWN0aW5nIGFcblx0XHRcdC8vIHNjcmlwdCB0YWcgaW50byB0aGUgZG9jdW1lbnQuXG5cdFx0XHRpZiAoIGNvZGUuaW5kZXhPZihcInVzZSBzdHJpY3RcIikgPT09IDEgKSB7XG5cdFx0XHRcdHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIik7XG5cdFx0XHRcdHNjcmlwdC50ZXh0ID0gY29kZTtcblx0XHRcdFx0ZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZCggc2NyaXB0ICkucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCggc2NyaXB0ICk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gT3RoZXJ3aXNlLCBhdm9pZCB0aGUgRE9NIG5vZGUgY3JlYXRpb24sIGluc2VydGlvblxuXHRcdFx0Ly8gYW5kIHJlbW92YWwgYnkgdXNpbmcgYW4gaW5kaXJlY3QgZ2xvYmFsIGV2YWxcblx0XHRcdFx0aW5kaXJlY3QoIGNvZGUgKTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0Ly8gQ29udmVydCBkYXNoZWQgdG8gY2FtZWxDYXNlOyB1c2VkIGJ5IHRoZSBjc3MgYW5kIGRhdGEgbW9kdWxlc1xuXHQvLyBNaWNyb3NvZnQgZm9yZ290IHRvIGh1bXAgdGhlaXIgdmVuZG9yIHByZWZpeCAoIzk1NzIpXG5cdGNhbWVsQ2FzZTogZnVuY3Rpb24oIHN0cmluZyApIHtcblx0XHRyZXR1cm4gc3RyaW5nLnJlcGxhY2UoIHJtc1ByZWZpeCwgXCJtcy1cIiApLnJlcGxhY2UoIHJkYXNoQWxwaGEsIGZjYW1lbENhc2UgKTtcblx0fSxcblxuXHRub2RlTmFtZTogZnVuY3Rpb24oIGVsZW0sIG5hbWUgKSB7XG5cdFx0cmV0dXJuIGVsZW0ubm9kZU5hbWUgJiYgZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSBuYW1lLnRvTG93ZXJDYXNlKCk7XG5cdH0sXG5cblx0Ly8gYXJncyBpcyBmb3IgaW50ZXJuYWwgdXNhZ2Ugb25seVxuXHRlYWNoOiBmdW5jdGlvbiggb2JqLCBjYWxsYmFjaywgYXJncyApIHtcblx0XHR2YXIgdmFsdWUsXG5cdFx0XHRpID0gMCxcblx0XHRcdGxlbmd0aCA9IG9iai5sZW5ndGgsXG5cdFx0XHRpc0FycmF5ID0gaXNBcnJheWxpa2UoIG9iaiApO1xuXG5cdFx0aWYgKCBhcmdzICkge1xuXHRcdFx0aWYgKCBpc0FycmF5ICkge1xuXHRcdFx0XHRmb3IgKCA7IGkgPCBsZW5ndGg7IGkrKyApIHtcblx0XHRcdFx0XHR2YWx1ZSA9IGNhbGxiYWNrLmFwcGx5KCBvYmpbIGkgXSwgYXJncyApO1xuXG5cdFx0XHRcdFx0aWYgKCB2YWx1ZSA9PT0gZmFsc2UgKSB7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGZvciAoIGkgaW4gb2JqICkge1xuXHRcdFx0XHRcdHZhbHVlID0gY2FsbGJhY2suYXBwbHkoIG9ialsgaSBdLCBhcmdzICk7XG5cblx0XHRcdFx0XHRpZiAoIHZhbHVlID09PSBmYWxzZSApIHtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0Ly8gQSBzcGVjaWFsLCBmYXN0LCBjYXNlIGZvciB0aGUgbW9zdCBjb21tb24gdXNlIG9mIGVhY2hcblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKCBpc0FycmF5ICkge1xuXHRcdFx0XHRmb3IgKCA7IGkgPCBsZW5ndGg7IGkrKyApIHtcblx0XHRcdFx0XHR2YWx1ZSA9IGNhbGxiYWNrLmNhbGwoIG9ialsgaSBdLCBpLCBvYmpbIGkgXSApO1xuXG5cdFx0XHRcdFx0aWYgKCB2YWx1ZSA9PT0gZmFsc2UgKSB7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGZvciAoIGkgaW4gb2JqICkge1xuXHRcdFx0XHRcdHZhbHVlID0gY2FsbGJhY2suY2FsbCggb2JqWyBpIF0sIGksIG9ialsgaSBdICk7XG5cblx0XHRcdFx0XHRpZiAoIHZhbHVlID09PSBmYWxzZSApIHtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiBvYmo7XG5cdH0sXG5cblx0Ly8gU3VwcG9ydDogQW5kcm9pZDw0LjFcblx0dHJpbTogZnVuY3Rpb24oIHRleHQgKSB7XG5cdFx0cmV0dXJuIHRleHQgPT0gbnVsbCA/XG5cdFx0XHRcIlwiIDpcblx0XHRcdCggdGV4dCArIFwiXCIgKS5yZXBsYWNlKCBydHJpbSwgXCJcIiApO1xuXHR9LFxuXG5cdC8vIHJlc3VsdHMgaXMgZm9yIGludGVybmFsIHVzYWdlIG9ubHlcblx0bWFrZUFycmF5OiBmdW5jdGlvbiggYXJyLCByZXN1bHRzICkge1xuXHRcdHZhciByZXQgPSByZXN1bHRzIHx8IFtdO1xuXG5cdFx0aWYgKCBhcnIgIT0gbnVsbCApIHtcblx0XHRcdGlmICggaXNBcnJheWxpa2UoIE9iamVjdChhcnIpICkgKSB7XG5cdFx0XHRcdGpRdWVyeS5tZXJnZSggcmV0LFxuXHRcdFx0XHRcdHR5cGVvZiBhcnIgPT09IFwic3RyaW5nXCIgP1xuXHRcdFx0XHRcdFsgYXJyIF0gOiBhcnJcblx0XHRcdFx0KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHB1c2guY2FsbCggcmV0LCBhcnIgKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gcmV0O1xuXHR9LFxuXG5cdGluQXJyYXk6IGZ1bmN0aW9uKCBlbGVtLCBhcnIsIGkgKSB7XG5cdFx0cmV0dXJuIGFyciA9PSBudWxsID8gLTEgOiBpbmRleE9mLmNhbGwoIGFyciwgZWxlbSwgaSApO1xuXHR9LFxuXG5cdG1lcmdlOiBmdW5jdGlvbiggZmlyc3QsIHNlY29uZCApIHtcblx0XHR2YXIgbGVuID0gK3NlY29uZC5sZW5ndGgsXG5cdFx0XHRqID0gMCxcblx0XHRcdGkgPSBmaXJzdC5sZW5ndGg7XG5cblx0XHRmb3IgKCA7IGogPCBsZW47IGorKyApIHtcblx0XHRcdGZpcnN0WyBpKysgXSA9IHNlY29uZFsgaiBdO1xuXHRcdH1cblxuXHRcdGZpcnN0Lmxlbmd0aCA9IGk7XG5cblx0XHRyZXR1cm4gZmlyc3Q7XG5cdH0sXG5cblx0Z3JlcDogZnVuY3Rpb24oIGVsZW1zLCBjYWxsYmFjaywgaW52ZXJ0ICkge1xuXHRcdHZhciBjYWxsYmFja0ludmVyc2UsXG5cdFx0XHRtYXRjaGVzID0gW10sXG5cdFx0XHRpID0gMCxcblx0XHRcdGxlbmd0aCA9IGVsZW1zLmxlbmd0aCxcblx0XHRcdGNhbGxiYWNrRXhwZWN0ID0gIWludmVydDtcblxuXHRcdC8vIEdvIHRocm91Z2ggdGhlIGFycmF5LCBvbmx5IHNhdmluZyB0aGUgaXRlbXNcblx0XHQvLyB0aGF0IHBhc3MgdGhlIHZhbGlkYXRvciBmdW5jdGlvblxuXHRcdGZvciAoIDsgaSA8IGxlbmd0aDsgaSsrICkge1xuXHRcdFx0Y2FsbGJhY2tJbnZlcnNlID0gIWNhbGxiYWNrKCBlbGVtc1sgaSBdLCBpICk7XG5cdFx0XHRpZiAoIGNhbGxiYWNrSW52ZXJzZSAhPT0gY2FsbGJhY2tFeHBlY3QgKSB7XG5cdFx0XHRcdG1hdGNoZXMucHVzaCggZWxlbXNbIGkgXSApO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiBtYXRjaGVzO1xuXHR9LFxuXG5cdC8vIGFyZyBpcyBmb3IgaW50ZXJuYWwgdXNhZ2Ugb25seVxuXHRtYXA6IGZ1bmN0aW9uKCBlbGVtcywgY2FsbGJhY2ssIGFyZyApIHtcblx0XHR2YXIgdmFsdWUsXG5cdFx0XHRpID0gMCxcblx0XHRcdGxlbmd0aCA9IGVsZW1zLmxlbmd0aCxcblx0XHRcdGlzQXJyYXkgPSBpc0FycmF5bGlrZSggZWxlbXMgKSxcblx0XHRcdHJldCA9IFtdO1xuXG5cdFx0Ly8gR28gdGhyb3VnaCB0aGUgYXJyYXksIHRyYW5zbGF0aW5nIGVhY2ggb2YgdGhlIGl0ZW1zIHRvIHRoZWlyIG5ldyB2YWx1ZXNcblx0XHRpZiAoIGlzQXJyYXkgKSB7XG5cdFx0XHRmb3IgKCA7IGkgPCBsZW5ndGg7IGkrKyApIHtcblx0XHRcdFx0dmFsdWUgPSBjYWxsYmFjayggZWxlbXNbIGkgXSwgaSwgYXJnICk7XG5cblx0XHRcdFx0aWYgKCB2YWx1ZSAhPSBudWxsICkge1xuXHRcdFx0XHRcdHJldC5wdXNoKCB2YWx1ZSApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHQvLyBHbyB0aHJvdWdoIGV2ZXJ5IGtleSBvbiB0aGUgb2JqZWN0LFxuXHRcdH0gZWxzZSB7XG5cdFx0XHRmb3IgKCBpIGluIGVsZW1zICkge1xuXHRcdFx0XHR2YWx1ZSA9IGNhbGxiYWNrKCBlbGVtc1sgaSBdLCBpLCBhcmcgKTtcblxuXHRcdFx0XHRpZiAoIHZhbHVlICE9IG51bGwgKSB7XG5cdFx0XHRcdFx0cmV0LnB1c2goIHZhbHVlICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBGbGF0dGVuIGFueSBuZXN0ZWQgYXJyYXlzXG5cdFx0cmV0dXJuIGNvbmNhdC5hcHBseSggW10sIHJldCApO1xuXHR9LFxuXG5cdC8vIEEgZ2xvYmFsIEdVSUQgY291bnRlciBmb3Igb2JqZWN0c1xuXHRndWlkOiAxLFxuXG5cdC8vIEJpbmQgYSBmdW5jdGlvbiB0byBhIGNvbnRleHQsIG9wdGlvbmFsbHkgcGFydGlhbGx5IGFwcGx5aW5nIGFueVxuXHQvLyBhcmd1bWVudHMuXG5cdHByb3h5OiBmdW5jdGlvbiggZm4sIGNvbnRleHQgKSB7XG5cdFx0dmFyIHRtcCwgYXJncywgcHJveHk7XG5cblx0XHRpZiAoIHR5cGVvZiBjb250ZXh0ID09PSBcInN0cmluZ1wiICkge1xuXHRcdFx0dG1wID0gZm5bIGNvbnRleHQgXTtcblx0XHRcdGNvbnRleHQgPSBmbjtcblx0XHRcdGZuID0gdG1wO1xuXHRcdH1cblxuXHRcdC8vIFF1aWNrIGNoZWNrIHRvIGRldGVybWluZSBpZiB0YXJnZXQgaXMgY2FsbGFibGUsIGluIHRoZSBzcGVjXG5cdFx0Ly8gdGhpcyB0aHJvd3MgYSBUeXBlRXJyb3IsIGJ1dCB3ZSB3aWxsIGp1c3QgcmV0dXJuIHVuZGVmaW5lZC5cblx0XHRpZiAoICFqUXVlcnkuaXNGdW5jdGlvbiggZm4gKSApIHtcblx0XHRcdHJldHVybiB1bmRlZmluZWQ7XG5cdFx0fVxuXG5cdFx0Ly8gU2ltdWxhdGVkIGJpbmRcblx0XHRhcmdzID0gc2xpY2UuY2FsbCggYXJndW1lbnRzLCAyICk7XG5cdFx0cHJveHkgPSBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiBmbi5hcHBseSggY29udGV4dCB8fCB0aGlzLCBhcmdzLmNvbmNhdCggc2xpY2UuY2FsbCggYXJndW1lbnRzICkgKSApO1xuXHRcdH07XG5cblx0XHQvLyBTZXQgdGhlIGd1aWQgb2YgdW5pcXVlIGhhbmRsZXIgdG8gdGhlIHNhbWUgb2Ygb3JpZ2luYWwgaGFuZGxlciwgc28gaXQgY2FuIGJlIHJlbW92ZWRcblx0XHRwcm94eS5ndWlkID0gZm4uZ3VpZCA9IGZuLmd1aWQgfHwgalF1ZXJ5Lmd1aWQrKztcblxuXHRcdHJldHVybiBwcm94eTtcblx0fSxcblxuXHRub3c6IERhdGUubm93LFxuXG5cdC8vIGpRdWVyeS5zdXBwb3J0IGlzIG5vdCB1c2VkIGluIENvcmUgYnV0IG90aGVyIHByb2plY3RzIGF0dGFjaCB0aGVpclxuXHQvLyBwcm9wZXJ0aWVzIHRvIGl0IHNvIGl0IG5lZWRzIHRvIGV4aXN0LlxuXHRzdXBwb3J0OiBzdXBwb3J0XG59KTtcblxuLy8gUG9wdWxhdGUgdGhlIGNsYXNzMnR5cGUgbWFwXG5qUXVlcnkuZWFjaChcIkJvb2xlYW4gTnVtYmVyIFN0cmluZyBGdW5jdGlvbiBBcnJheSBEYXRlIFJlZ0V4cCBPYmplY3QgRXJyb3JcIi5zcGxpdChcIiBcIiksIGZ1bmN0aW9uKGksIG5hbWUpIHtcblx0Y2xhc3MydHlwZVsgXCJbb2JqZWN0IFwiICsgbmFtZSArIFwiXVwiIF0gPSBuYW1lLnRvTG93ZXJDYXNlKCk7XG59KTtcblxuZnVuY3Rpb24gaXNBcnJheWxpa2UoIG9iaiApIHtcblx0dmFyIGxlbmd0aCA9IG9iai5sZW5ndGgsXG5cdFx0dHlwZSA9IGpRdWVyeS50eXBlKCBvYmogKTtcblxuXHRpZiAoIHR5cGUgPT09IFwiZnVuY3Rpb25cIiB8fCBqUXVlcnkuaXNXaW5kb3coIG9iaiApICkge1xuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXG5cdGlmICggb2JqLm5vZGVUeXBlID09PSAxICYmIGxlbmd0aCApIHtcblx0XHRyZXR1cm4gdHJ1ZTtcblx0fVxuXG5cdHJldHVybiB0eXBlID09PSBcImFycmF5XCIgfHwgbGVuZ3RoID09PSAwIHx8XG5cdFx0dHlwZW9mIGxlbmd0aCA9PT0gXCJudW1iZXJcIiAmJiBsZW5ndGggPiAwICYmICggbGVuZ3RoIC0gMSApIGluIG9iajtcbn1cbnZhciBTaXp6bGUgPVxuLyohXG4gKiBTaXp6bGUgQ1NTIFNlbGVjdG9yIEVuZ2luZSB2MS4xMC4xOVxuICogaHR0cDovL3NpenpsZWpzLmNvbS9cbiAqXG4gKiBDb3B5cmlnaHQgMjAxMyBqUXVlcnkgRm91bmRhdGlvbiwgSW5jLiBhbmQgb3RoZXIgY29udHJpYnV0b3JzXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2VcbiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2VcbiAqXG4gKiBEYXRlOiAyMDE0LTA0LTE4XG4gKi9cbihmdW5jdGlvbiggd2luZG93ICkge1xuXG52YXIgaSxcblx0c3VwcG9ydCxcblx0RXhwcixcblx0Z2V0VGV4dCxcblx0aXNYTUwsXG5cdHRva2VuaXplLFxuXHRjb21waWxlLFxuXHRzZWxlY3QsXG5cdG91dGVybW9zdENvbnRleHQsXG5cdHNvcnRJbnB1dCxcblx0aGFzRHVwbGljYXRlLFxuXG5cdC8vIExvY2FsIGRvY3VtZW50IHZhcnNcblx0c2V0RG9jdW1lbnQsXG5cdGRvY3VtZW50LFxuXHRkb2NFbGVtLFxuXHRkb2N1bWVudElzSFRNTCxcblx0cmJ1Z2d5UVNBLFxuXHRyYnVnZ3lNYXRjaGVzLFxuXHRtYXRjaGVzLFxuXHRjb250YWlucyxcblxuXHQvLyBJbnN0YW5jZS1zcGVjaWZpYyBkYXRhXG5cdGV4cGFuZG8gPSBcInNpenpsZVwiICsgLShuZXcgRGF0ZSgpKSxcblx0cHJlZmVycmVkRG9jID0gd2luZG93LmRvY3VtZW50LFxuXHRkaXJydW5zID0gMCxcblx0ZG9uZSA9IDAsXG5cdGNsYXNzQ2FjaGUgPSBjcmVhdGVDYWNoZSgpLFxuXHR0b2tlbkNhY2hlID0gY3JlYXRlQ2FjaGUoKSxcblx0Y29tcGlsZXJDYWNoZSA9IGNyZWF0ZUNhY2hlKCksXG5cdHNvcnRPcmRlciA9IGZ1bmN0aW9uKCBhLCBiICkge1xuXHRcdGlmICggYSA9PT0gYiApIHtcblx0XHRcdGhhc0R1cGxpY2F0ZSA9IHRydWU7XG5cdFx0fVxuXHRcdHJldHVybiAwO1xuXHR9LFxuXG5cdC8vIEdlbmVyYWwtcHVycG9zZSBjb25zdGFudHNcblx0c3RydW5kZWZpbmVkID0gdHlwZW9mIHVuZGVmaW5lZCxcblx0TUFYX05FR0FUSVZFID0gMSA8PCAzMSxcblxuXHQvLyBJbnN0YW5jZSBtZXRob2RzXG5cdGhhc093biA9ICh7fSkuaGFzT3duUHJvcGVydHksXG5cdGFyciA9IFtdLFxuXHRwb3AgPSBhcnIucG9wLFxuXHRwdXNoX25hdGl2ZSA9IGFyci5wdXNoLFxuXHRwdXNoID0gYXJyLnB1c2gsXG5cdHNsaWNlID0gYXJyLnNsaWNlLFxuXHQvLyBVc2UgYSBzdHJpcHBlZC1kb3duIGluZGV4T2YgaWYgd2UgY2FuJ3QgdXNlIGEgbmF0aXZlIG9uZVxuXHRpbmRleE9mID0gYXJyLmluZGV4T2YgfHwgZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0dmFyIGkgPSAwLFxuXHRcdFx0bGVuID0gdGhpcy5sZW5ndGg7XG5cdFx0Zm9yICggOyBpIDwgbGVuOyBpKysgKSB7XG5cdFx0XHRpZiAoIHRoaXNbaV0gPT09IGVsZW0gKSB7XG5cdFx0XHRcdHJldHVybiBpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gLTE7XG5cdH0sXG5cblx0Ym9vbGVhbnMgPSBcImNoZWNrZWR8c2VsZWN0ZWR8YXN5bmN8YXV0b2ZvY3VzfGF1dG9wbGF5fGNvbnRyb2xzfGRlZmVyfGRpc2FibGVkfGhpZGRlbnxpc21hcHxsb29wfG11bHRpcGxlfG9wZW58cmVhZG9ubHl8cmVxdWlyZWR8c2NvcGVkXCIsXG5cblx0Ly8gUmVndWxhciBleHByZXNzaW9uc1xuXG5cdC8vIFdoaXRlc3BhY2UgY2hhcmFjdGVycyBodHRwOi8vd3d3LnczLm9yZy9UUi9jc3MzLXNlbGVjdG9ycy8jd2hpdGVzcGFjZVxuXHR3aGl0ZXNwYWNlID0gXCJbXFxcXHgyMFxcXFx0XFxcXHJcXFxcblxcXFxmXVwiLFxuXHQvLyBodHRwOi8vd3d3LnczLm9yZy9UUi9jc3MzLXN5bnRheC8jY2hhcmFjdGVyc1xuXHRjaGFyYWN0ZXJFbmNvZGluZyA9IFwiKD86XFxcXFxcXFwufFtcXFxcdy1dfFteXFxcXHgwMC1cXFxceGEwXSkrXCIsXG5cblx0Ly8gTG9vc2VseSBtb2RlbGVkIG9uIENTUyBpZGVudGlmaWVyIGNoYXJhY3RlcnNcblx0Ly8gQW4gdW5xdW90ZWQgdmFsdWUgc2hvdWxkIGJlIGEgQ1NTIGlkZW50aWZpZXIgaHR0cDovL3d3dy53My5vcmcvVFIvY3NzMy1zZWxlY3RvcnMvI2F0dHJpYnV0ZS1zZWxlY3RvcnNcblx0Ly8gUHJvcGVyIHN5bnRheDogaHR0cDovL3d3dy53My5vcmcvVFIvQ1NTMjEvc3luZGF0YS5odG1sI3ZhbHVlLWRlZi1pZGVudGlmaWVyXG5cdGlkZW50aWZpZXIgPSBjaGFyYWN0ZXJFbmNvZGluZy5yZXBsYWNlKCBcIndcIiwgXCJ3I1wiICksXG5cblx0Ly8gQXR0cmlidXRlIHNlbGVjdG9yczogaHR0cDovL3d3dy53My5vcmcvVFIvc2VsZWN0b3JzLyNhdHRyaWJ1dGUtc2VsZWN0b3JzXG5cdGF0dHJpYnV0ZXMgPSBcIlxcXFxbXCIgKyB3aGl0ZXNwYWNlICsgXCIqKFwiICsgY2hhcmFjdGVyRW5jb2RpbmcgKyBcIikoPzpcIiArIHdoaXRlc3BhY2UgK1xuXHRcdC8vIE9wZXJhdG9yIChjYXB0dXJlIDIpXG5cdFx0XCIqKFsqXiR8IX5dPz0pXCIgKyB3aGl0ZXNwYWNlICtcblx0XHQvLyBcIkF0dHJpYnV0ZSB2YWx1ZXMgbXVzdCBiZSBDU1MgaWRlbnRpZmllcnMgW2NhcHR1cmUgNV0gb3Igc3RyaW5ncyBbY2FwdHVyZSAzIG9yIGNhcHR1cmUgNF1cIlxuXHRcdFwiKig/OicoKD86XFxcXFxcXFwufFteXFxcXFxcXFwnXSkqKSd8XFxcIigoPzpcXFxcXFxcXC58W15cXFxcXFxcXFxcXCJdKSopXFxcInwoXCIgKyBpZGVudGlmaWVyICsgXCIpKXwpXCIgKyB3aGl0ZXNwYWNlICtcblx0XHRcIipcXFxcXVwiLFxuXG5cdHBzZXVkb3MgPSBcIjooXCIgKyBjaGFyYWN0ZXJFbmNvZGluZyArIFwiKSg/OlxcXFwoKFwiICtcblx0XHQvLyBUbyByZWR1Y2UgdGhlIG51bWJlciBvZiBzZWxlY3RvcnMgbmVlZGluZyB0b2tlbml6ZSBpbiB0aGUgcHJlRmlsdGVyLCBwcmVmZXIgYXJndW1lbnRzOlxuXHRcdC8vIDEuIHF1b3RlZCAoY2FwdHVyZSAzOyBjYXB0dXJlIDQgb3IgY2FwdHVyZSA1KVxuXHRcdFwiKCcoKD86XFxcXFxcXFwufFteXFxcXFxcXFwnXSkqKSd8XFxcIigoPzpcXFxcXFxcXC58W15cXFxcXFxcXFxcXCJdKSopXFxcIil8XCIgK1xuXHRcdC8vIDIuIHNpbXBsZSAoY2FwdHVyZSA2KVxuXHRcdFwiKCg/OlxcXFxcXFxcLnxbXlxcXFxcXFxcKClbXFxcXF1dfFwiICsgYXR0cmlidXRlcyArIFwiKSopfFwiICtcblx0XHQvLyAzLiBhbnl0aGluZyBlbHNlIChjYXB0dXJlIDIpXG5cdFx0XCIuKlwiICtcblx0XHRcIilcXFxcKXwpXCIsXG5cblx0Ly8gTGVhZGluZyBhbmQgbm9uLWVzY2FwZWQgdHJhaWxpbmcgd2hpdGVzcGFjZSwgY2FwdHVyaW5nIHNvbWUgbm9uLXdoaXRlc3BhY2UgY2hhcmFjdGVycyBwcmVjZWRpbmcgdGhlIGxhdHRlclxuXHRydHJpbSA9IG5ldyBSZWdFeHAoIFwiXlwiICsgd2hpdGVzcGFjZSArIFwiK3woKD86XnxbXlxcXFxcXFxcXSkoPzpcXFxcXFxcXC4pKilcIiArIHdoaXRlc3BhY2UgKyBcIiskXCIsIFwiZ1wiICksXG5cblx0cmNvbW1hID0gbmV3IFJlZ0V4cCggXCJeXCIgKyB3aGl0ZXNwYWNlICsgXCIqLFwiICsgd2hpdGVzcGFjZSArIFwiKlwiICksXG5cdHJjb21iaW5hdG9ycyA9IG5ldyBSZWdFeHAoIFwiXlwiICsgd2hpdGVzcGFjZSArIFwiKihbPit+XXxcIiArIHdoaXRlc3BhY2UgKyBcIilcIiArIHdoaXRlc3BhY2UgKyBcIipcIiApLFxuXG5cdHJhdHRyaWJ1dGVRdW90ZXMgPSBuZXcgUmVnRXhwKCBcIj1cIiArIHdoaXRlc3BhY2UgKyBcIiooW15cXFxcXSdcXFwiXSo/KVwiICsgd2hpdGVzcGFjZSArIFwiKlxcXFxdXCIsIFwiZ1wiICksXG5cblx0cnBzZXVkbyA9IG5ldyBSZWdFeHAoIHBzZXVkb3MgKSxcblx0cmlkZW50aWZpZXIgPSBuZXcgUmVnRXhwKCBcIl5cIiArIGlkZW50aWZpZXIgKyBcIiRcIiApLFxuXG5cdG1hdGNoRXhwciA9IHtcblx0XHRcIklEXCI6IG5ldyBSZWdFeHAoIFwiXiMoXCIgKyBjaGFyYWN0ZXJFbmNvZGluZyArIFwiKVwiICksXG5cdFx0XCJDTEFTU1wiOiBuZXcgUmVnRXhwKCBcIl5cXFxcLihcIiArIGNoYXJhY3RlckVuY29kaW5nICsgXCIpXCIgKSxcblx0XHRcIlRBR1wiOiBuZXcgUmVnRXhwKCBcIl4oXCIgKyBjaGFyYWN0ZXJFbmNvZGluZy5yZXBsYWNlKCBcIndcIiwgXCJ3KlwiICkgKyBcIilcIiApLFxuXHRcdFwiQVRUUlwiOiBuZXcgUmVnRXhwKCBcIl5cIiArIGF0dHJpYnV0ZXMgKSxcblx0XHRcIlBTRVVET1wiOiBuZXcgUmVnRXhwKCBcIl5cIiArIHBzZXVkb3MgKSxcblx0XHRcIkNISUxEXCI6IG5ldyBSZWdFeHAoIFwiXjoob25seXxmaXJzdHxsYXN0fG50aHxudGgtbGFzdCktKGNoaWxkfG9mLXR5cGUpKD86XFxcXChcIiArIHdoaXRlc3BhY2UgK1xuXHRcdFx0XCIqKGV2ZW58b2RkfCgoWystXXwpKFxcXFxkKilufClcIiArIHdoaXRlc3BhY2UgKyBcIiooPzooWystXXwpXCIgKyB3aGl0ZXNwYWNlICtcblx0XHRcdFwiKihcXFxcZCspfCkpXCIgKyB3aGl0ZXNwYWNlICsgXCIqXFxcXCl8KVwiLCBcImlcIiApLFxuXHRcdFwiYm9vbFwiOiBuZXcgUmVnRXhwKCBcIl4oPzpcIiArIGJvb2xlYW5zICsgXCIpJFwiLCBcImlcIiApLFxuXHRcdC8vIEZvciB1c2UgaW4gbGlicmFyaWVzIGltcGxlbWVudGluZyAuaXMoKVxuXHRcdC8vIFdlIHVzZSB0aGlzIGZvciBQT1MgbWF0Y2hpbmcgaW4gYHNlbGVjdGBcblx0XHRcIm5lZWRzQ29udGV4dFwiOiBuZXcgUmVnRXhwKCBcIl5cIiArIHdoaXRlc3BhY2UgKyBcIipbPit+XXw6KGV2ZW58b2RkfGVxfGd0fGx0fG50aHxmaXJzdHxsYXN0KSg/OlxcXFwoXCIgK1xuXHRcdFx0d2hpdGVzcGFjZSArIFwiKigoPzotXFxcXGQpP1xcXFxkKilcIiArIHdoaXRlc3BhY2UgKyBcIipcXFxcKXwpKD89W14tXXwkKVwiLCBcImlcIiApXG5cdH0sXG5cblx0cmlucHV0cyA9IC9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbikkL2ksXG5cdHJoZWFkZXIgPSAvXmhcXGQkL2ksXG5cblx0cm5hdGl2ZSA9IC9eW157XStcXHtcXHMqXFxbbmF0aXZlIFxcdy8sXG5cblx0Ly8gRWFzaWx5LXBhcnNlYWJsZS9yZXRyaWV2YWJsZSBJRCBvciBUQUcgb3IgQ0xBU1Mgc2VsZWN0b3JzXG5cdHJxdWlja0V4cHIgPSAvXig/OiMoW1xcdy1dKyl8KFxcdyspfFxcLihbXFx3LV0rKSkkLyxcblxuXHRyc2libGluZyA9IC9bK35dLyxcblx0cmVzY2FwZSA9IC8nfFxcXFwvZyxcblxuXHQvLyBDU1MgZXNjYXBlcyBodHRwOi8vd3d3LnczLm9yZy9UUi9DU1MyMS9zeW5kYXRhLmh0bWwjZXNjYXBlZC1jaGFyYWN0ZXJzXG5cdHJ1bmVzY2FwZSA9IG5ldyBSZWdFeHAoIFwiXFxcXFxcXFwoW1xcXFxkYS1mXXsxLDZ9XCIgKyB3aGl0ZXNwYWNlICsgXCI/fChcIiArIHdoaXRlc3BhY2UgKyBcIil8LilcIiwgXCJpZ1wiICksXG5cdGZ1bmVzY2FwZSA9IGZ1bmN0aW9uKCBfLCBlc2NhcGVkLCBlc2NhcGVkV2hpdGVzcGFjZSApIHtcblx0XHR2YXIgaGlnaCA9IFwiMHhcIiArIGVzY2FwZWQgLSAweDEwMDAwO1xuXHRcdC8vIE5hTiBtZWFucyBub24tY29kZXBvaW50XG5cdFx0Ly8gU3VwcG9ydDogRmlyZWZveDwyNFxuXHRcdC8vIFdvcmthcm91bmQgZXJyb25lb3VzIG51bWVyaWMgaW50ZXJwcmV0YXRpb24gb2YgK1wiMHhcIlxuXHRcdHJldHVybiBoaWdoICE9PSBoaWdoIHx8IGVzY2FwZWRXaGl0ZXNwYWNlID9cblx0XHRcdGVzY2FwZWQgOlxuXHRcdFx0aGlnaCA8IDAgP1xuXHRcdFx0XHQvLyBCTVAgY29kZXBvaW50XG5cdFx0XHRcdFN0cmluZy5mcm9tQ2hhckNvZGUoIGhpZ2ggKyAweDEwMDAwICkgOlxuXHRcdFx0XHQvLyBTdXBwbGVtZW50YWwgUGxhbmUgY29kZXBvaW50IChzdXJyb2dhdGUgcGFpcilcblx0XHRcdFx0U3RyaW5nLmZyb21DaGFyQ29kZSggaGlnaCA+PiAxMCB8IDB4RDgwMCwgaGlnaCAmIDB4M0ZGIHwgMHhEQzAwICk7XG5cdH07XG5cbi8vIE9wdGltaXplIGZvciBwdXNoLmFwcGx5KCBfLCBOb2RlTGlzdCApXG50cnkge1xuXHRwdXNoLmFwcGx5KFxuXHRcdChhcnIgPSBzbGljZS5jYWxsKCBwcmVmZXJyZWREb2MuY2hpbGROb2RlcyApKSxcblx0XHRwcmVmZXJyZWREb2MuY2hpbGROb2Rlc1xuXHQpO1xuXHQvLyBTdXBwb3J0OiBBbmRyb2lkPDQuMFxuXHQvLyBEZXRlY3Qgc2lsZW50bHkgZmFpbGluZyBwdXNoLmFwcGx5XG5cdGFyclsgcHJlZmVycmVkRG9jLmNoaWxkTm9kZXMubGVuZ3RoIF0ubm9kZVR5cGU7XG59IGNhdGNoICggZSApIHtcblx0cHVzaCA9IHsgYXBwbHk6IGFyci5sZW5ndGggP1xuXG5cdFx0Ly8gTGV2ZXJhZ2Ugc2xpY2UgaWYgcG9zc2libGVcblx0XHRmdW5jdGlvbiggdGFyZ2V0LCBlbHMgKSB7XG5cdFx0XHRwdXNoX25hdGl2ZS5hcHBseSggdGFyZ2V0LCBzbGljZS5jYWxsKGVscykgKTtcblx0XHR9IDpcblxuXHRcdC8vIFN1cHBvcnQ6IElFPDlcblx0XHQvLyBPdGhlcndpc2UgYXBwZW5kIGRpcmVjdGx5XG5cdFx0ZnVuY3Rpb24oIHRhcmdldCwgZWxzICkge1xuXHRcdFx0dmFyIGogPSB0YXJnZXQubGVuZ3RoLFxuXHRcdFx0XHRpID0gMDtcblx0XHRcdC8vIENhbid0IHRydXN0IE5vZGVMaXN0Lmxlbmd0aFxuXHRcdFx0d2hpbGUgKCAodGFyZ2V0W2orK10gPSBlbHNbaSsrXSkgKSB7fVxuXHRcdFx0dGFyZ2V0Lmxlbmd0aCA9IGogLSAxO1xuXHRcdH1cblx0fTtcbn1cblxuZnVuY3Rpb24gU2l6emxlKCBzZWxlY3RvciwgY29udGV4dCwgcmVzdWx0cywgc2VlZCApIHtcblx0dmFyIG1hdGNoLCBlbGVtLCBtLCBub2RlVHlwZSxcblx0XHQvLyBRU0EgdmFyc1xuXHRcdGksIGdyb3Vwcywgb2xkLCBuaWQsIG5ld0NvbnRleHQsIG5ld1NlbGVjdG9yO1xuXG5cdGlmICggKCBjb250ZXh0ID8gY29udGV4dC5vd25lckRvY3VtZW50IHx8IGNvbnRleHQgOiBwcmVmZXJyZWREb2MgKSAhPT0gZG9jdW1lbnQgKSB7XG5cdFx0c2V0RG9jdW1lbnQoIGNvbnRleHQgKTtcblx0fVxuXG5cdGNvbnRleHQgPSBjb250ZXh0IHx8IGRvY3VtZW50O1xuXHRyZXN1bHRzID0gcmVzdWx0cyB8fCBbXTtcblxuXHRpZiAoICFzZWxlY3RvciB8fCB0eXBlb2Ygc2VsZWN0b3IgIT09IFwic3RyaW5nXCIgKSB7XG5cdFx0cmV0dXJuIHJlc3VsdHM7XG5cdH1cblxuXHRpZiAoIChub2RlVHlwZSA9IGNvbnRleHQubm9kZVR5cGUpICE9PSAxICYmIG5vZGVUeXBlICE9PSA5ICkge1xuXHRcdHJldHVybiBbXTtcblx0fVxuXG5cdGlmICggZG9jdW1lbnRJc0hUTUwgJiYgIXNlZWQgKSB7XG5cblx0XHQvLyBTaG9ydGN1dHNcblx0XHRpZiAoIChtYXRjaCA9IHJxdWlja0V4cHIuZXhlYyggc2VsZWN0b3IgKSkgKSB7XG5cdFx0XHQvLyBTcGVlZC11cDogU2l6emxlKFwiI0lEXCIpXG5cdFx0XHRpZiAoIChtID0gbWF0Y2hbMV0pICkge1xuXHRcdFx0XHRpZiAoIG5vZGVUeXBlID09PSA5ICkge1xuXHRcdFx0XHRcdGVsZW0gPSBjb250ZXh0LmdldEVsZW1lbnRCeUlkKCBtICk7XG5cdFx0XHRcdFx0Ly8gQ2hlY2sgcGFyZW50Tm9kZSB0byBjYXRjaCB3aGVuIEJsYWNrYmVycnkgNC42IHJldHVybnNcblx0XHRcdFx0XHQvLyBub2RlcyB0aGF0IGFyZSBubyBsb25nZXIgaW4gdGhlIGRvY3VtZW50IChqUXVlcnkgIzY5NjMpXG5cdFx0XHRcdFx0aWYgKCBlbGVtICYmIGVsZW0ucGFyZW50Tm9kZSApIHtcblx0XHRcdFx0XHRcdC8vIEhhbmRsZSB0aGUgY2FzZSB3aGVyZSBJRSwgT3BlcmEsIGFuZCBXZWJraXQgcmV0dXJuIGl0ZW1zXG5cdFx0XHRcdFx0XHQvLyBieSBuYW1lIGluc3RlYWQgb2YgSURcblx0XHRcdFx0XHRcdGlmICggZWxlbS5pZCA9PT0gbSApIHtcblx0XHRcdFx0XHRcdFx0cmVzdWx0cy5wdXNoKCBlbGVtICk7XG5cdFx0XHRcdFx0XHRcdHJldHVybiByZXN1bHRzO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gcmVzdWx0cztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Ly8gQ29udGV4dCBpcyBub3QgYSBkb2N1bWVudFxuXHRcdFx0XHRcdGlmICggY29udGV4dC5vd25lckRvY3VtZW50ICYmIChlbGVtID0gY29udGV4dC5vd25lckRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCBtICkpICYmXG5cdFx0XHRcdFx0XHRjb250YWlucyggY29udGV4dCwgZWxlbSApICYmIGVsZW0uaWQgPT09IG0gKSB7XG5cdFx0XHRcdFx0XHRyZXN1bHRzLnB1c2goIGVsZW0gKTtcblx0XHRcdFx0XHRcdHJldHVybiByZXN1bHRzO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHQvLyBTcGVlZC11cDogU2l6emxlKFwiVEFHXCIpXG5cdFx0XHR9IGVsc2UgaWYgKCBtYXRjaFsyXSApIHtcblx0XHRcdFx0cHVzaC5hcHBseSggcmVzdWx0cywgY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZSggc2VsZWN0b3IgKSApO1xuXHRcdFx0XHRyZXR1cm4gcmVzdWx0cztcblxuXHRcdFx0Ly8gU3BlZWQtdXA6IFNpenpsZShcIi5DTEFTU1wiKVxuXHRcdFx0fSBlbHNlIGlmICggKG0gPSBtYXRjaFszXSkgJiYgc3VwcG9ydC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lICYmIGNvbnRleHQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSApIHtcblx0XHRcdFx0cHVzaC5hcHBseSggcmVzdWx0cywgY29udGV4dC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCBtICkgKTtcblx0XHRcdFx0cmV0dXJuIHJlc3VsdHM7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gUVNBIHBhdGhcblx0XHRpZiAoIHN1cHBvcnQucXNhICYmICghcmJ1Z2d5UVNBIHx8ICFyYnVnZ3lRU0EudGVzdCggc2VsZWN0b3IgKSkgKSB7XG5cdFx0XHRuaWQgPSBvbGQgPSBleHBhbmRvO1xuXHRcdFx0bmV3Q29udGV4dCA9IGNvbnRleHQ7XG5cdFx0XHRuZXdTZWxlY3RvciA9IG5vZGVUeXBlID09PSA5ICYmIHNlbGVjdG9yO1xuXG5cdFx0XHQvLyBxU0Egd29ya3Mgc3RyYW5nZWx5IG9uIEVsZW1lbnQtcm9vdGVkIHF1ZXJpZXNcblx0XHRcdC8vIFdlIGNhbiB3b3JrIGFyb3VuZCB0aGlzIGJ5IHNwZWNpZnlpbmcgYW4gZXh0cmEgSUQgb24gdGhlIHJvb3Rcblx0XHRcdC8vIGFuZCB3b3JraW5nIHVwIGZyb20gdGhlcmUgKFRoYW5rcyB0byBBbmRyZXcgRHVwb250IGZvciB0aGUgdGVjaG5pcXVlKVxuXHRcdFx0Ly8gSUUgOCBkb2Vzbid0IHdvcmsgb24gb2JqZWN0IGVsZW1lbnRzXG5cdFx0XHRpZiAoIG5vZGVUeXBlID09PSAxICYmIGNvbnRleHQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSAhPT0gXCJvYmplY3RcIiApIHtcblx0XHRcdFx0Z3JvdXBzID0gdG9rZW5pemUoIHNlbGVjdG9yICk7XG5cblx0XHRcdFx0aWYgKCAob2xkID0gY29udGV4dC5nZXRBdHRyaWJ1dGUoXCJpZFwiKSkgKSB7XG5cdFx0XHRcdFx0bmlkID0gb2xkLnJlcGxhY2UoIHJlc2NhcGUsIFwiXFxcXCQmXCIgKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRjb250ZXh0LnNldEF0dHJpYnV0ZSggXCJpZFwiLCBuaWQgKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRuaWQgPSBcIltpZD0nXCIgKyBuaWQgKyBcIiddIFwiO1xuXG5cdFx0XHRcdGkgPSBncm91cHMubGVuZ3RoO1xuXHRcdFx0XHR3aGlsZSAoIGktLSApIHtcblx0XHRcdFx0XHRncm91cHNbaV0gPSBuaWQgKyB0b1NlbGVjdG9yKCBncm91cHNbaV0gKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRuZXdDb250ZXh0ID0gcnNpYmxpbmcudGVzdCggc2VsZWN0b3IgKSAmJiB0ZXN0Q29udGV4dCggY29udGV4dC5wYXJlbnROb2RlICkgfHwgY29udGV4dDtcblx0XHRcdFx0bmV3U2VsZWN0b3IgPSBncm91cHMuam9pbihcIixcIik7XG5cdFx0XHR9XG5cblx0XHRcdGlmICggbmV3U2VsZWN0b3IgKSB7XG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0cHVzaC5hcHBseSggcmVzdWx0cyxcblx0XHRcdFx0XHRcdG5ld0NvbnRleHQucXVlcnlTZWxlY3RvckFsbCggbmV3U2VsZWN0b3IgKVxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0cmV0dXJuIHJlc3VsdHM7XG5cdFx0XHRcdH0gY2F0Y2gocXNhRXJyb3IpIHtcblx0XHRcdFx0fSBmaW5hbGx5IHtcblx0XHRcdFx0XHRpZiAoICFvbGQgKSB7XG5cdFx0XHRcdFx0XHRjb250ZXh0LnJlbW92ZUF0dHJpYnV0ZShcImlkXCIpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdC8vIEFsbCBvdGhlcnNcblx0cmV0dXJuIHNlbGVjdCggc2VsZWN0b3IucmVwbGFjZSggcnRyaW0sIFwiJDFcIiApLCBjb250ZXh0LCByZXN1bHRzLCBzZWVkICk7XG59XG5cbi8qKlxuICogQ3JlYXRlIGtleS12YWx1ZSBjYWNoZXMgb2YgbGltaXRlZCBzaXplXG4gKiBAcmV0dXJucyB7RnVuY3Rpb24oc3RyaW5nLCBPYmplY3QpfSBSZXR1cm5zIHRoZSBPYmplY3QgZGF0YSBhZnRlciBzdG9yaW5nIGl0IG9uIGl0c2VsZiB3aXRoXG4gKlx0cHJvcGVydHkgbmFtZSB0aGUgKHNwYWNlLXN1ZmZpeGVkKSBzdHJpbmcgYW5kIChpZiB0aGUgY2FjaGUgaXMgbGFyZ2VyIHRoYW4gRXhwci5jYWNoZUxlbmd0aClcbiAqXHRkZWxldGluZyB0aGUgb2xkZXN0IGVudHJ5XG4gKi9cbmZ1bmN0aW9uIGNyZWF0ZUNhY2hlKCkge1xuXHR2YXIga2V5cyA9IFtdO1xuXG5cdGZ1bmN0aW9uIGNhY2hlKCBrZXksIHZhbHVlICkge1xuXHRcdC8vIFVzZSAoa2V5ICsgXCIgXCIpIHRvIGF2b2lkIGNvbGxpc2lvbiB3aXRoIG5hdGl2ZSBwcm90b3R5cGUgcHJvcGVydGllcyAoc2VlIElzc3VlICMxNTcpXG5cdFx0aWYgKCBrZXlzLnB1c2goIGtleSArIFwiIFwiICkgPiBFeHByLmNhY2hlTGVuZ3RoICkge1xuXHRcdFx0Ly8gT25seSBrZWVwIHRoZSBtb3N0IHJlY2VudCBlbnRyaWVzXG5cdFx0XHRkZWxldGUgY2FjaGVbIGtleXMuc2hpZnQoKSBdO1xuXHRcdH1cblx0XHRyZXR1cm4gKGNhY2hlWyBrZXkgKyBcIiBcIiBdID0gdmFsdWUpO1xuXHR9XG5cdHJldHVybiBjYWNoZTtcbn1cblxuLyoqXG4gKiBNYXJrIGEgZnVuY3Rpb24gZm9yIHNwZWNpYWwgdXNlIGJ5IFNpenpsZVxuICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHRvIG1hcmtcbiAqL1xuZnVuY3Rpb24gbWFya0Z1bmN0aW9uKCBmbiApIHtcblx0Zm5bIGV4cGFuZG8gXSA9IHRydWU7XG5cdHJldHVybiBmbjtcbn1cblxuLyoqXG4gKiBTdXBwb3J0IHRlc3RpbmcgdXNpbmcgYW4gZWxlbWVudFxuICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gUGFzc2VkIHRoZSBjcmVhdGVkIGRpdiBhbmQgZXhwZWN0cyBhIGJvb2xlYW4gcmVzdWx0XG4gKi9cbmZ1bmN0aW9uIGFzc2VydCggZm4gKSB7XG5cdHZhciBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXG5cdHRyeSB7XG5cdFx0cmV0dXJuICEhZm4oIGRpdiApO1xuXHR9IGNhdGNoIChlKSB7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9IGZpbmFsbHkge1xuXHRcdC8vIFJlbW92ZSBmcm9tIGl0cyBwYXJlbnQgYnkgZGVmYXVsdFxuXHRcdGlmICggZGl2LnBhcmVudE5vZGUgKSB7XG5cdFx0XHRkaXYucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCggZGl2ICk7XG5cdFx0fVxuXHRcdC8vIHJlbGVhc2UgbWVtb3J5IGluIElFXG5cdFx0ZGl2ID0gbnVsbDtcblx0fVxufVxuXG4vKipcbiAqIEFkZHMgdGhlIHNhbWUgaGFuZGxlciBmb3IgYWxsIG9mIHRoZSBzcGVjaWZpZWQgYXR0cnNcbiAqIEBwYXJhbSB7U3RyaW5nfSBhdHRycyBQaXBlLXNlcGFyYXRlZCBsaXN0IG9mIGF0dHJpYnV0ZXNcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGhhbmRsZXIgVGhlIG1ldGhvZCB0aGF0IHdpbGwgYmUgYXBwbGllZFxuICovXG5mdW5jdGlvbiBhZGRIYW5kbGUoIGF0dHJzLCBoYW5kbGVyICkge1xuXHR2YXIgYXJyID0gYXR0cnMuc3BsaXQoXCJ8XCIpLFxuXHRcdGkgPSBhdHRycy5sZW5ndGg7XG5cblx0d2hpbGUgKCBpLS0gKSB7XG5cdFx0RXhwci5hdHRySGFuZGxlWyBhcnJbaV0gXSA9IGhhbmRsZXI7XG5cdH1cbn1cblxuLyoqXG4gKiBDaGVja3MgZG9jdW1lbnQgb3JkZXIgb2YgdHdvIHNpYmxpbmdzXG4gKiBAcGFyYW0ge0VsZW1lbnR9IGFcbiAqIEBwYXJhbSB7RWxlbWVudH0gYlxuICogQHJldHVybnMge051bWJlcn0gUmV0dXJucyBsZXNzIHRoYW4gMCBpZiBhIHByZWNlZGVzIGIsIGdyZWF0ZXIgdGhhbiAwIGlmIGEgZm9sbG93cyBiXG4gKi9cbmZ1bmN0aW9uIHNpYmxpbmdDaGVjayggYSwgYiApIHtcblx0dmFyIGN1ciA9IGIgJiYgYSxcblx0XHRkaWZmID0gY3VyICYmIGEubm9kZVR5cGUgPT09IDEgJiYgYi5ub2RlVHlwZSA9PT0gMSAmJlxuXHRcdFx0KCB+Yi5zb3VyY2VJbmRleCB8fCBNQVhfTkVHQVRJVkUgKSAtXG5cdFx0XHQoIH5hLnNvdXJjZUluZGV4IHx8IE1BWF9ORUdBVElWRSApO1xuXG5cdC8vIFVzZSBJRSBzb3VyY2VJbmRleCBpZiBhdmFpbGFibGUgb24gYm90aCBub2Rlc1xuXHRpZiAoIGRpZmYgKSB7XG5cdFx0cmV0dXJuIGRpZmY7XG5cdH1cblxuXHQvLyBDaGVjayBpZiBiIGZvbGxvd3MgYVxuXHRpZiAoIGN1ciApIHtcblx0XHR3aGlsZSAoIChjdXIgPSBjdXIubmV4dFNpYmxpbmcpICkge1xuXHRcdFx0aWYgKCBjdXIgPT09IGIgKSB7XG5cdFx0XHRcdHJldHVybiAtMTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gYSA/IDEgOiAtMTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgZnVuY3Rpb24gdG8gdXNlIGluIHBzZXVkb3MgZm9yIGlucHV0IHR5cGVzXG4gKiBAcGFyYW0ge1N0cmluZ30gdHlwZVxuICovXG5mdW5jdGlvbiBjcmVhdGVJbnB1dFBzZXVkbyggdHlwZSApIHtcblx0cmV0dXJuIGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdHZhciBuYW1lID0gZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO1xuXHRcdHJldHVybiBuYW1lID09PSBcImlucHV0XCIgJiYgZWxlbS50eXBlID09PSB0eXBlO1xuXHR9O1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBmdW5jdGlvbiB0byB1c2UgaW4gcHNldWRvcyBmb3IgYnV0dG9uc1xuICogQHBhcmFtIHtTdHJpbmd9IHR5cGVcbiAqL1xuZnVuY3Rpb24gY3JlYXRlQnV0dG9uUHNldWRvKCB0eXBlICkge1xuXHRyZXR1cm4gZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0dmFyIG5hbWUgPSBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7XG5cdFx0cmV0dXJuIChuYW1lID09PSBcImlucHV0XCIgfHwgbmFtZSA9PT0gXCJidXR0b25cIikgJiYgZWxlbS50eXBlID09PSB0eXBlO1xuXHR9O1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBmdW5jdGlvbiB0byB1c2UgaW4gcHNldWRvcyBmb3IgcG9zaXRpb25hbHNcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGZuXG4gKi9cbmZ1bmN0aW9uIGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oIGZuICkge1xuXHRyZXR1cm4gbWFya0Z1bmN0aW9uKGZ1bmN0aW9uKCBhcmd1bWVudCApIHtcblx0XHRhcmd1bWVudCA9ICthcmd1bWVudDtcblx0XHRyZXR1cm4gbWFya0Z1bmN0aW9uKGZ1bmN0aW9uKCBzZWVkLCBtYXRjaGVzICkge1xuXHRcdFx0dmFyIGosXG5cdFx0XHRcdG1hdGNoSW5kZXhlcyA9IGZuKCBbXSwgc2VlZC5sZW5ndGgsIGFyZ3VtZW50ICksXG5cdFx0XHRcdGkgPSBtYXRjaEluZGV4ZXMubGVuZ3RoO1xuXG5cdFx0XHQvLyBNYXRjaCBlbGVtZW50cyBmb3VuZCBhdCB0aGUgc3BlY2lmaWVkIGluZGV4ZXNcblx0XHRcdHdoaWxlICggaS0tICkge1xuXHRcdFx0XHRpZiAoIHNlZWRbIChqID0gbWF0Y2hJbmRleGVzW2ldKSBdICkge1xuXHRcdFx0XHRcdHNlZWRbal0gPSAhKG1hdGNoZXNbal0gPSBzZWVkW2pdKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXHR9KTtcbn1cblxuLyoqXG4gKiBDaGVja3MgYSBub2RlIGZvciB2YWxpZGl0eSBhcyBhIFNpenpsZSBjb250ZXh0XG4gKiBAcGFyYW0ge0VsZW1lbnR8T2JqZWN0PX0gY29udGV4dFxuICogQHJldHVybnMge0VsZW1lbnR8T2JqZWN0fEJvb2xlYW59IFRoZSBpbnB1dCBub2RlIGlmIGFjY2VwdGFibGUsIG90aGVyd2lzZSBhIGZhbHN5IHZhbHVlXG4gKi9cbmZ1bmN0aW9uIHRlc3RDb250ZXh0KCBjb250ZXh0ICkge1xuXHRyZXR1cm4gY29udGV4dCAmJiB0eXBlb2YgY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZSAhPT0gc3RydW5kZWZpbmVkICYmIGNvbnRleHQ7XG59XG5cbi8vIEV4cG9zZSBzdXBwb3J0IHZhcnMgZm9yIGNvbnZlbmllbmNlXG5zdXBwb3J0ID0gU2l6emxlLnN1cHBvcnQgPSB7fTtcblxuLyoqXG4gKiBEZXRlY3RzIFhNTCBub2Rlc1xuICogQHBhcmFtIHtFbGVtZW50fE9iamVjdH0gZWxlbSBBbiBlbGVtZW50IG9yIGEgZG9jdW1lbnRcbiAqIEByZXR1cm5zIHtCb29sZWFufSBUcnVlIGlmZiBlbGVtIGlzIGEgbm9uLUhUTUwgWE1MIG5vZGVcbiAqL1xuaXNYTUwgPSBTaXp6bGUuaXNYTUwgPSBmdW5jdGlvbiggZWxlbSApIHtcblx0Ly8gZG9jdW1lbnRFbGVtZW50IGlzIHZlcmlmaWVkIGZvciBjYXNlcyB3aGVyZSBpdCBkb2Vzbid0IHlldCBleGlzdFxuXHQvLyAoc3VjaCBhcyBsb2FkaW5nIGlmcmFtZXMgaW4gSUUgLSAjNDgzMylcblx0dmFyIGRvY3VtZW50RWxlbWVudCA9IGVsZW0gJiYgKGVsZW0ub3duZXJEb2N1bWVudCB8fCBlbGVtKS5kb2N1bWVudEVsZW1lbnQ7XG5cdHJldHVybiBkb2N1bWVudEVsZW1lbnQgPyBkb2N1bWVudEVsZW1lbnQubm9kZU5hbWUgIT09IFwiSFRNTFwiIDogZmFsc2U7XG59O1xuXG4vKipcbiAqIFNldHMgZG9jdW1lbnQtcmVsYXRlZCB2YXJpYWJsZXMgb25jZSBiYXNlZCBvbiB0aGUgY3VycmVudCBkb2N1bWVudFxuICogQHBhcmFtIHtFbGVtZW50fE9iamVjdH0gW2RvY10gQW4gZWxlbWVudCBvciBkb2N1bWVudCBvYmplY3QgdG8gdXNlIHRvIHNldCB0aGUgZG9jdW1lbnRcbiAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIGN1cnJlbnQgZG9jdW1lbnRcbiAqL1xuc2V0RG9jdW1lbnQgPSBTaXp6bGUuc2V0RG9jdW1lbnQgPSBmdW5jdGlvbiggbm9kZSApIHtcblx0dmFyIGhhc0NvbXBhcmUsXG5cdFx0ZG9jID0gbm9kZSA/IG5vZGUub3duZXJEb2N1bWVudCB8fCBub2RlIDogcHJlZmVycmVkRG9jLFxuXHRcdHBhcmVudCA9IGRvYy5kZWZhdWx0VmlldztcblxuXHQvLyBJZiBubyBkb2N1bWVudCBhbmQgZG9jdW1lbnRFbGVtZW50IGlzIGF2YWlsYWJsZSwgcmV0dXJuXG5cdGlmICggZG9jID09PSBkb2N1bWVudCB8fCBkb2Mubm9kZVR5cGUgIT09IDkgfHwgIWRvYy5kb2N1bWVudEVsZW1lbnQgKSB7XG5cdFx0cmV0dXJuIGRvY3VtZW50O1xuXHR9XG5cblx0Ly8gU2V0IG91ciBkb2N1bWVudFxuXHRkb2N1bWVudCA9IGRvYztcblx0ZG9jRWxlbSA9IGRvYy5kb2N1bWVudEVsZW1lbnQ7XG5cblx0Ly8gU3VwcG9ydCB0ZXN0c1xuXHRkb2N1bWVudElzSFRNTCA9ICFpc1hNTCggZG9jICk7XG5cblx0Ly8gU3VwcG9ydDogSUU+OFxuXHQvLyBJZiBpZnJhbWUgZG9jdW1lbnQgaXMgYXNzaWduZWQgdG8gXCJkb2N1bWVudFwiIHZhcmlhYmxlIGFuZCBpZiBpZnJhbWUgaGFzIGJlZW4gcmVsb2FkZWQsXG5cdC8vIElFIHdpbGwgdGhyb3cgXCJwZXJtaXNzaW9uIGRlbmllZFwiIGVycm9yIHdoZW4gYWNjZXNzaW5nIFwiZG9jdW1lbnRcIiB2YXJpYWJsZSwgc2VlIGpRdWVyeSAjMTM5MzZcblx0Ly8gSUU2LTggZG8gbm90IHN1cHBvcnQgdGhlIGRlZmF1bHRWaWV3IHByb3BlcnR5IHNvIHBhcmVudCB3aWxsIGJlIHVuZGVmaW5lZFxuXHRpZiAoIHBhcmVudCAmJiBwYXJlbnQgIT09IHBhcmVudC50b3AgKSB7XG5cdFx0Ly8gSUUxMSBkb2VzIG5vdCBoYXZlIGF0dGFjaEV2ZW50LCBzbyBhbGwgbXVzdCBzdWZmZXJcblx0XHRpZiAoIHBhcmVudC5hZGRFdmVudExpc3RlbmVyICkge1xuXHRcdFx0cGFyZW50LmFkZEV2ZW50TGlzdGVuZXIoIFwidW5sb2FkXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRzZXREb2N1bWVudCgpO1xuXHRcdFx0fSwgZmFsc2UgKTtcblx0XHR9IGVsc2UgaWYgKCBwYXJlbnQuYXR0YWNoRXZlbnQgKSB7XG5cdFx0XHRwYXJlbnQuYXR0YWNoRXZlbnQoIFwib251bmxvYWRcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHNldERvY3VtZW50KCk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdH1cblxuXHQvKiBBdHRyaWJ1dGVzXG5cdC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvLyBTdXBwb3J0OiBJRTw4XG5cdC8vIFZlcmlmeSB0aGF0IGdldEF0dHJpYnV0ZSByZWFsbHkgcmV0dXJucyBhdHRyaWJ1dGVzIGFuZCBub3QgcHJvcGVydGllcyAoZXhjZXB0aW5nIElFOCBib29sZWFucylcblx0c3VwcG9ydC5hdHRyaWJ1dGVzID0gYXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7XG5cdFx0ZGl2LmNsYXNzTmFtZSA9IFwiaVwiO1xuXHRcdHJldHVybiAhZGl2LmdldEF0dHJpYnV0ZShcImNsYXNzTmFtZVwiKTtcblx0fSk7XG5cblx0LyogZ2V0RWxlbWVudChzKUJ5KlxuXHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0Ly8gQ2hlY2sgaWYgZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCIqXCIpIHJldHVybnMgb25seSBlbGVtZW50c1xuXHRzdXBwb3J0LmdldEVsZW1lbnRzQnlUYWdOYW1lID0gYXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7XG5cdFx0ZGl2LmFwcGVuZENoaWxkKCBkb2MuY3JlYXRlQ29tbWVudChcIlwiKSApO1xuXHRcdHJldHVybiAhZGl2LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiKlwiKS5sZW5ndGg7XG5cdH0pO1xuXG5cdC8vIENoZWNrIGlmIGdldEVsZW1lbnRzQnlDbGFzc05hbWUgY2FuIGJlIHRydXN0ZWRcblx0c3VwcG9ydC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lID0gcm5hdGl2ZS50ZXN0KCBkb2MuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSApICYmIGFzc2VydChmdW5jdGlvbiggZGl2ICkge1xuXHRcdGRpdi5pbm5lckhUTUwgPSBcIjxkaXYgY2xhc3M9J2EnPjwvZGl2PjxkaXYgY2xhc3M9J2EgaSc+PC9kaXY+XCI7XG5cblx0XHQvLyBTdXBwb3J0OiBTYWZhcmk8NFxuXHRcdC8vIENhdGNoIGNsYXNzIG92ZXItY2FjaGluZ1xuXHRcdGRpdi5maXJzdENoaWxkLmNsYXNzTmFtZSA9IFwiaVwiO1xuXHRcdC8vIFN1cHBvcnQ6IE9wZXJhPDEwXG5cdFx0Ly8gQ2F0Y2ggZ0VCQ04gZmFpbHVyZSB0byBmaW5kIG5vbi1sZWFkaW5nIGNsYXNzZXNcblx0XHRyZXR1cm4gZGl2LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJpXCIpLmxlbmd0aCA9PT0gMjtcblx0fSk7XG5cblx0Ly8gU3VwcG9ydDogSUU8MTBcblx0Ly8gQ2hlY2sgaWYgZ2V0RWxlbWVudEJ5SWQgcmV0dXJucyBlbGVtZW50cyBieSBuYW1lXG5cdC8vIFRoZSBicm9rZW4gZ2V0RWxlbWVudEJ5SWQgbWV0aG9kcyBkb24ndCBwaWNrIHVwIHByb2dyYW1hdGljYWxseS1zZXQgbmFtZXMsXG5cdC8vIHNvIHVzZSBhIHJvdW5kYWJvdXQgZ2V0RWxlbWVudHNCeU5hbWUgdGVzdFxuXHRzdXBwb3J0LmdldEJ5SWQgPSBhc3NlcnQoZnVuY3Rpb24oIGRpdiApIHtcblx0XHRkb2NFbGVtLmFwcGVuZENoaWxkKCBkaXYgKS5pZCA9IGV4cGFuZG87XG5cdFx0cmV0dXJuICFkb2MuZ2V0RWxlbWVudHNCeU5hbWUgfHwgIWRvYy5nZXRFbGVtZW50c0J5TmFtZSggZXhwYW5kbyApLmxlbmd0aDtcblx0fSk7XG5cblx0Ly8gSUQgZmluZCBhbmQgZmlsdGVyXG5cdGlmICggc3VwcG9ydC5nZXRCeUlkICkge1xuXHRcdEV4cHIuZmluZFtcIklEXCJdID0gZnVuY3Rpb24oIGlkLCBjb250ZXh0ICkge1xuXHRcdFx0aWYgKCB0eXBlb2YgY29udGV4dC5nZXRFbGVtZW50QnlJZCAhPT0gc3RydW5kZWZpbmVkICYmIGRvY3VtZW50SXNIVE1MICkge1xuXHRcdFx0XHR2YXIgbSA9IGNvbnRleHQuZ2V0RWxlbWVudEJ5SWQoIGlkICk7XG5cdFx0XHRcdC8vIENoZWNrIHBhcmVudE5vZGUgdG8gY2F0Y2ggd2hlbiBCbGFja2JlcnJ5IDQuNiByZXR1cm5zXG5cdFx0XHRcdC8vIG5vZGVzIHRoYXQgYXJlIG5vIGxvbmdlciBpbiB0aGUgZG9jdW1lbnQgIzY5NjNcblx0XHRcdFx0cmV0dXJuIG0gJiYgbS5wYXJlbnROb2RlID8gWyBtIF0gOiBbXTtcblx0XHRcdH1cblx0XHR9O1xuXHRcdEV4cHIuZmlsdGVyW1wiSURcIl0gPSBmdW5jdGlvbiggaWQgKSB7XG5cdFx0XHR2YXIgYXR0cklkID0gaWQucmVwbGFjZSggcnVuZXNjYXBlLCBmdW5lc2NhcGUgKTtcblx0XHRcdHJldHVybiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdFx0cmV0dXJuIGVsZW0uZ2V0QXR0cmlidXRlKFwiaWRcIikgPT09IGF0dHJJZDtcblx0XHRcdH07XG5cdFx0fTtcblx0fSBlbHNlIHtcblx0XHQvLyBTdXBwb3J0OiBJRTYvN1xuXHRcdC8vIGdldEVsZW1lbnRCeUlkIGlzIG5vdCByZWxpYWJsZSBhcyBhIGZpbmQgc2hvcnRjdXRcblx0XHRkZWxldGUgRXhwci5maW5kW1wiSURcIl07XG5cblx0XHRFeHByLmZpbHRlcltcIklEXCJdID0gIGZ1bmN0aW9uKCBpZCApIHtcblx0XHRcdHZhciBhdHRySWQgPSBpZC5yZXBsYWNlKCBydW5lc2NhcGUsIGZ1bmVzY2FwZSApO1xuXHRcdFx0cmV0dXJuIGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0XHR2YXIgbm9kZSA9IHR5cGVvZiBlbGVtLmdldEF0dHJpYnV0ZU5vZGUgIT09IHN0cnVuZGVmaW5lZCAmJiBlbGVtLmdldEF0dHJpYnV0ZU5vZGUoXCJpZFwiKTtcblx0XHRcdFx0cmV0dXJuIG5vZGUgJiYgbm9kZS52YWx1ZSA9PT0gYXR0cklkO1xuXHRcdFx0fTtcblx0XHR9O1xuXHR9XG5cblx0Ly8gVGFnXG5cdEV4cHIuZmluZFtcIlRBR1wiXSA9IHN1cHBvcnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUgP1xuXHRcdGZ1bmN0aW9uKCB0YWcsIGNvbnRleHQgKSB7XG5cdFx0XHRpZiAoIHR5cGVvZiBjb250ZXh0LmdldEVsZW1lbnRzQnlUYWdOYW1lICE9PSBzdHJ1bmRlZmluZWQgKSB7XG5cdFx0XHRcdHJldHVybiBjb250ZXh0LmdldEVsZW1lbnRzQnlUYWdOYW1lKCB0YWcgKTtcblx0XHRcdH1cblx0XHR9IDpcblx0XHRmdW5jdGlvbiggdGFnLCBjb250ZXh0ICkge1xuXHRcdFx0dmFyIGVsZW0sXG5cdFx0XHRcdHRtcCA9IFtdLFxuXHRcdFx0XHRpID0gMCxcblx0XHRcdFx0cmVzdWx0cyA9IGNvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIHRhZyApO1xuXG5cdFx0XHQvLyBGaWx0ZXIgb3V0IHBvc3NpYmxlIGNvbW1lbnRzXG5cdFx0XHRpZiAoIHRhZyA9PT0gXCIqXCIgKSB7XG5cdFx0XHRcdHdoaWxlICggKGVsZW0gPSByZXN1bHRzW2krK10pICkge1xuXHRcdFx0XHRcdGlmICggZWxlbS5ub2RlVHlwZSA9PT0gMSApIHtcblx0XHRcdFx0XHRcdHRtcC5wdXNoKCBlbGVtICk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmV0dXJuIHRtcDtcblx0XHRcdH1cblx0XHRcdHJldHVybiByZXN1bHRzO1xuXHRcdH07XG5cblx0Ly8gQ2xhc3Ncblx0RXhwci5maW5kW1wiQ0xBU1NcIl0gPSBzdXBwb3J0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUgJiYgZnVuY3Rpb24oIGNsYXNzTmFtZSwgY29udGV4dCApIHtcblx0XHRpZiAoIHR5cGVvZiBjb250ZXh0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUgIT09IHN0cnVuZGVmaW5lZCAmJiBkb2N1bWVudElzSFRNTCApIHtcblx0XHRcdHJldHVybiBjb250ZXh0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoIGNsYXNzTmFtZSApO1xuXHRcdH1cblx0fTtcblxuXHQvKiBRU0EvbWF0Y2hlc1NlbGVjdG9yXG5cdC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvLyBRU0EgYW5kIG1hdGNoZXNTZWxlY3RvciBzdXBwb3J0XG5cblx0Ly8gbWF0Y2hlc1NlbGVjdG9yKDphY3RpdmUpIHJlcG9ydHMgZmFsc2Ugd2hlbiB0cnVlIChJRTkvT3BlcmEgMTEuNSlcblx0cmJ1Z2d5TWF0Y2hlcyA9IFtdO1xuXG5cdC8vIHFTYSg6Zm9jdXMpIHJlcG9ydHMgZmFsc2Ugd2hlbiB0cnVlIChDaHJvbWUgMjEpXG5cdC8vIFdlIGFsbG93IHRoaXMgYmVjYXVzZSBvZiBhIGJ1ZyBpbiBJRTgvOSB0aGF0IHRocm93cyBhbiBlcnJvclxuXHQvLyB3aGVuZXZlciBgZG9jdW1lbnQuYWN0aXZlRWxlbWVudGAgaXMgYWNjZXNzZWQgb24gYW4gaWZyYW1lXG5cdC8vIFNvLCB3ZSBhbGxvdyA6Zm9jdXMgdG8gcGFzcyB0aHJvdWdoIFFTQSBhbGwgdGhlIHRpbWUgdG8gYXZvaWQgdGhlIElFIGVycm9yXG5cdC8vIFNlZSBodHRwOi8vYnVncy5qcXVlcnkuY29tL3RpY2tldC8xMzM3OFxuXHRyYnVnZ3lRU0EgPSBbXTtcblxuXHRpZiAoIChzdXBwb3J0LnFzYSA9IHJuYXRpdmUudGVzdCggZG9jLnF1ZXJ5U2VsZWN0b3JBbGwgKSkgKSB7XG5cdFx0Ly8gQnVpbGQgUVNBIHJlZ2V4XG5cdFx0Ly8gUmVnZXggc3RyYXRlZ3kgYWRvcHRlZCBmcm9tIERpZWdvIFBlcmluaVxuXHRcdGFzc2VydChmdW5jdGlvbiggZGl2ICkge1xuXHRcdFx0Ly8gU2VsZWN0IGlzIHNldCB0byBlbXB0eSBzdHJpbmcgb24gcHVycG9zZVxuXHRcdFx0Ly8gVGhpcyBpcyB0byB0ZXN0IElFJ3MgdHJlYXRtZW50IG9mIG5vdCBleHBsaWNpdGx5XG5cdFx0XHQvLyBzZXR0aW5nIGEgYm9vbGVhbiBjb250ZW50IGF0dHJpYnV0ZSxcblx0XHRcdC8vIHNpbmNlIGl0cyBwcmVzZW5jZSBzaG91bGQgYmUgZW5vdWdoXG5cdFx0XHQvLyBodHRwOi8vYnVncy5qcXVlcnkuY29tL3RpY2tldC8xMjM1OVxuXHRcdFx0ZGl2LmlubmVySFRNTCA9IFwiPHNlbGVjdCBtc2FsbG93Y2xpcD0nJz48b3B0aW9uIHNlbGVjdGVkPScnPjwvb3B0aW9uPjwvc2VsZWN0PlwiO1xuXG5cdFx0XHQvLyBTdXBwb3J0OiBJRTgsIE9wZXJhIDExLTEyLjE2XG5cdFx0XHQvLyBOb3RoaW5nIHNob3VsZCBiZSBzZWxlY3RlZCB3aGVuIGVtcHR5IHN0cmluZ3MgZm9sbG93IF49IG9yICQ9IG9yICo9XG5cdFx0XHQvLyBUaGUgdGVzdCBhdHRyaWJ1dGUgbXVzdCBiZSB1bmtub3duIGluIE9wZXJhIGJ1dCBcInNhZmVcIiBmb3IgV2luUlRcblx0XHRcdC8vIGh0dHA6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS9pZS9oaDQ2NTM4OC5hc3B4I2F0dHJpYnV0ZV9zZWN0aW9uXG5cdFx0XHRpZiAoIGRpdi5xdWVyeVNlbGVjdG9yQWxsKFwiW21zYWxsb3djbGlwXj0nJ11cIikubGVuZ3RoICkge1xuXHRcdFx0XHRyYnVnZ3lRU0EucHVzaCggXCJbKl4kXT1cIiArIHdoaXRlc3BhY2UgKyBcIiooPzonJ3xcXFwiXFxcIilcIiApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBTdXBwb3J0OiBJRThcblx0XHRcdC8vIEJvb2xlYW4gYXR0cmlidXRlcyBhbmQgXCJ2YWx1ZVwiIGFyZSBub3QgdHJlYXRlZCBjb3JyZWN0bHlcblx0XHRcdGlmICggIWRpdi5xdWVyeVNlbGVjdG9yQWxsKFwiW3NlbGVjdGVkXVwiKS5sZW5ndGggKSB7XG5cdFx0XHRcdHJidWdneVFTQS5wdXNoKCBcIlxcXFxbXCIgKyB3aGl0ZXNwYWNlICsgXCIqKD86dmFsdWV8XCIgKyBib29sZWFucyArIFwiKVwiICk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFdlYmtpdC9PcGVyYSAtIDpjaGVja2VkIHNob3VsZCByZXR1cm4gc2VsZWN0ZWQgb3B0aW9uIGVsZW1lbnRzXG5cdFx0XHQvLyBodHRwOi8vd3d3LnczLm9yZy9UUi8yMDExL1JFQy1jc3MzLXNlbGVjdG9ycy0yMDExMDkyOS8jY2hlY2tlZFxuXHRcdFx0Ly8gSUU4IHRocm93cyBlcnJvciBoZXJlIGFuZCB3aWxsIG5vdCBzZWUgbGF0ZXIgdGVzdHNcblx0XHRcdGlmICggIWRpdi5xdWVyeVNlbGVjdG9yQWxsKFwiOmNoZWNrZWRcIikubGVuZ3RoICkge1xuXHRcdFx0XHRyYnVnZ3lRU0EucHVzaChcIjpjaGVja2VkXCIpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0YXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7XG5cdFx0XHQvLyBTdXBwb3J0OiBXaW5kb3dzIDggTmF0aXZlIEFwcHNcblx0XHRcdC8vIFRoZSB0eXBlIGFuZCBuYW1lIGF0dHJpYnV0ZXMgYXJlIHJlc3RyaWN0ZWQgZHVyaW5nIC5pbm5lckhUTUwgYXNzaWdubWVudFxuXHRcdFx0dmFyIGlucHV0ID0gZG9jLmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcblx0XHRcdGlucHV0LnNldEF0dHJpYnV0ZSggXCJ0eXBlXCIsIFwiaGlkZGVuXCIgKTtcblx0XHRcdGRpdi5hcHBlbmRDaGlsZCggaW5wdXQgKS5zZXRBdHRyaWJ1dGUoIFwibmFtZVwiLCBcIkRcIiApO1xuXG5cdFx0XHQvLyBTdXBwb3J0OiBJRThcblx0XHRcdC8vIEVuZm9yY2UgY2FzZS1zZW5zaXRpdml0eSBvZiBuYW1lIGF0dHJpYnV0ZVxuXHRcdFx0aWYgKCBkaXYucXVlcnlTZWxlY3RvckFsbChcIltuYW1lPWRdXCIpLmxlbmd0aCApIHtcblx0XHRcdFx0cmJ1Z2d5UVNBLnB1c2goIFwibmFtZVwiICsgd2hpdGVzcGFjZSArIFwiKlsqXiR8IX5dPz1cIiApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBGRiAzLjUgLSA6ZW5hYmxlZC86ZGlzYWJsZWQgYW5kIGhpZGRlbiBlbGVtZW50cyAoaGlkZGVuIGVsZW1lbnRzIGFyZSBzdGlsbCBlbmFibGVkKVxuXHRcdFx0Ly8gSUU4IHRocm93cyBlcnJvciBoZXJlIGFuZCB3aWxsIG5vdCBzZWUgbGF0ZXIgdGVzdHNcblx0XHRcdGlmICggIWRpdi5xdWVyeVNlbGVjdG9yQWxsKFwiOmVuYWJsZWRcIikubGVuZ3RoICkge1xuXHRcdFx0XHRyYnVnZ3lRU0EucHVzaCggXCI6ZW5hYmxlZFwiLCBcIjpkaXNhYmxlZFwiICk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIE9wZXJhIDEwLTExIGRvZXMgbm90IHRocm93IG9uIHBvc3QtY29tbWEgaW52YWxpZCBwc2V1ZG9zXG5cdFx0XHRkaXYucXVlcnlTZWxlY3RvckFsbChcIiosOnhcIik7XG5cdFx0XHRyYnVnZ3lRU0EucHVzaChcIiwuKjpcIik7XG5cdFx0fSk7XG5cdH1cblxuXHRpZiAoIChzdXBwb3J0Lm1hdGNoZXNTZWxlY3RvciA9IHJuYXRpdmUudGVzdCggKG1hdGNoZXMgPSBkb2NFbGVtLm1hdGNoZXMgfHxcblx0XHRkb2NFbGVtLndlYmtpdE1hdGNoZXNTZWxlY3RvciB8fFxuXHRcdGRvY0VsZW0ubW96TWF0Y2hlc1NlbGVjdG9yIHx8XG5cdFx0ZG9jRWxlbS5vTWF0Y2hlc1NlbGVjdG9yIHx8XG5cdFx0ZG9jRWxlbS5tc01hdGNoZXNTZWxlY3RvcikgKSkgKSB7XG5cblx0XHRhc3NlcnQoZnVuY3Rpb24oIGRpdiApIHtcblx0XHRcdC8vIENoZWNrIHRvIHNlZSBpZiBpdCdzIHBvc3NpYmxlIHRvIGRvIG1hdGNoZXNTZWxlY3RvclxuXHRcdFx0Ly8gb24gYSBkaXNjb25uZWN0ZWQgbm9kZSAoSUUgOSlcblx0XHRcdHN1cHBvcnQuZGlzY29ubmVjdGVkTWF0Y2ggPSBtYXRjaGVzLmNhbGwoIGRpdiwgXCJkaXZcIiApO1xuXG5cdFx0XHQvLyBUaGlzIHNob3VsZCBmYWlsIHdpdGggYW4gZXhjZXB0aW9uXG5cdFx0XHQvLyBHZWNrbyBkb2VzIG5vdCBlcnJvciwgcmV0dXJucyBmYWxzZSBpbnN0ZWFkXG5cdFx0XHRtYXRjaGVzLmNhbGwoIGRpdiwgXCJbcyE9JyddOnhcIiApO1xuXHRcdFx0cmJ1Z2d5TWF0Y2hlcy5wdXNoKCBcIiE9XCIsIHBzZXVkb3MgKTtcblx0XHR9KTtcblx0fVxuXG5cdHJidWdneVFTQSA9IHJidWdneVFTQS5sZW5ndGggJiYgbmV3IFJlZ0V4cCggcmJ1Z2d5UVNBLmpvaW4oXCJ8XCIpICk7XG5cdHJidWdneU1hdGNoZXMgPSByYnVnZ3lNYXRjaGVzLmxlbmd0aCAmJiBuZXcgUmVnRXhwKCByYnVnZ3lNYXRjaGVzLmpvaW4oXCJ8XCIpICk7XG5cblx0LyogQ29udGFpbnNcblx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXHRoYXNDb21wYXJlID0gcm5hdGl2ZS50ZXN0KCBkb2NFbGVtLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uICk7XG5cblx0Ly8gRWxlbWVudCBjb250YWlucyBhbm90aGVyXG5cdC8vIFB1cnBvc2VmdWxseSBkb2VzIG5vdCBpbXBsZW1lbnQgaW5jbHVzaXZlIGRlc2NlbmRlbnRcblx0Ly8gQXMgaW4sIGFuIGVsZW1lbnQgZG9lcyBub3QgY29udGFpbiBpdHNlbGZcblx0Y29udGFpbnMgPSBoYXNDb21wYXJlIHx8IHJuYXRpdmUudGVzdCggZG9jRWxlbS5jb250YWlucyApID9cblx0XHRmdW5jdGlvbiggYSwgYiApIHtcblx0XHRcdHZhciBhZG93biA9IGEubm9kZVR5cGUgPT09IDkgPyBhLmRvY3VtZW50RWxlbWVudCA6IGEsXG5cdFx0XHRcdGJ1cCA9IGIgJiYgYi5wYXJlbnROb2RlO1xuXHRcdFx0cmV0dXJuIGEgPT09IGJ1cCB8fCAhISggYnVwICYmIGJ1cC5ub2RlVHlwZSA9PT0gMSAmJiAoXG5cdFx0XHRcdGFkb3duLmNvbnRhaW5zID9cblx0XHRcdFx0XHRhZG93bi5jb250YWlucyggYnVwICkgOlxuXHRcdFx0XHRcdGEuY29tcGFyZURvY3VtZW50UG9zaXRpb24gJiYgYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiggYnVwICkgJiAxNlxuXHRcdFx0KSk7XG5cdFx0fSA6XG5cdFx0ZnVuY3Rpb24oIGEsIGIgKSB7XG5cdFx0XHRpZiAoIGIgKSB7XG5cdFx0XHRcdHdoaWxlICggKGIgPSBiLnBhcmVudE5vZGUpICkge1xuXHRcdFx0XHRcdGlmICggYiA9PT0gYSApIHtcblx0XHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH07XG5cblx0LyogU29ydGluZ1xuXHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0Ly8gRG9jdW1lbnQgb3JkZXIgc29ydGluZ1xuXHRzb3J0T3JkZXIgPSBoYXNDb21wYXJlID9cblx0ZnVuY3Rpb24oIGEsIGIgKSB7XG5cblx0XHQvLyBGbGFnIGZvciBkdXBsaWNhdGUgcmVtb3ZhbFxuXHRcdGlmICggYSA9PT0gYiApIHtcblx0XHRcdGhhc0R1cGxpY2F0ZSA9IHRydWU7XG5cdFx0XHRyZXR1cm4gMDtcblx0XHR9XG5cblx0XHQvLyBTb3J0IG9uIG1ldGhvZCBleGlzdGVuY2UgaWYgb25seSBvbmUgaW5wdXQgaGFzIGNvbXBhcmVEb2N1bWVudFBvc2l0aW9uXG5cdFx0dmFyIGNvbXBhcmUgPSAhYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiAtICFiLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uO1xuXHRcdGlmICggY29tcGFyZSApIHtcblx0XHRcdHJldHVybiBjb21wYXJlO1xuXHRcdH1cblxuXHRcdC8vIENhbGN1bGF0ZSBwb3NpdGlvbiBpZiBib3RoIGlucHV0cyBiZWxvbmcgdG8gdGhlIHNhbWUgZG9jdW1lbnRcblx0XHRjb21wYXJlID0gKCBhLm93bmVyRG9jdW1lbnQgfHwgYSApID09PSAoIGIub3duZXJEb2N1bWVudCB8fCBiICkgP1xuXHRcdFx0YS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiggYiApIDpcblxuXHRcdFx0Ly8gT3RoZXJ3aXNlIHdlIGtub3cgdGhleSBhcmUgZGlzY29ubmVjdGVkXG5cdFx0XHQxO1xuXG5cdFx0Ly8gRGlzY29ubmVjdGVkIG5vZGVzXG5cdFx0aWYgKCBjb21wYXJlICYgMSB8fFxuXHRcdFx0KCFzdXBwb3J0LnNvcnREZXRhY2hlZCAmJiBiLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKCBhICkgPT09IGNvbXBhcmUpICkge1xuXG5cdFx0XHQvLyBDaG9vc2UgdGhlIGZpcnN0IGVsZW1lbnQgdGhhdCBpcyByZWxhdGVkIHRvIG91ciBwcmVmZXJyZWQgZG9jdW1lbnRcblx0XHRcdGlmICggYSA9PT0gZG9jIHx8IGEub3duZXJEb2N1bWVudCA9PT0gcHJlZmVycmVkRG9jICYmIGNvbnRhaW5zKHByZWZlcnJlZERvYywgYSkgKSB7XG5cdFx0XHRcdHJldHVybiAtMTtcblx0XHRcdH1cblx0XHRcdGlmICggYiA9PT0gZG9jIHx8IGIub3duZXJEb2N1bWVudCA9PT0gcHJlZmVycmVkRG9jICYmIGNvbnRhaW5zKHByZWZlcnJlZERvYywgYikgKSB7XG5cdFx0XHRcdHJldHVybiAxO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBNYWludGFpbiBvcmlnaW5hbCBvcmRlclxuXHRcdFx0cmV0dXJuIHNvcnRJbnB1dCA/XG5cdFx0XHRcdCggaW5kZXhPZi5jYWxsKCBzb3J0SW5wdXQsIGEgKSAtIGluZGV4T2YuY2FsbCggc29ydElucHV0LCBiICkgKSA6XG5cdFx0XHRcdDA7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGNvbXBhcmUgJiA0ID8gLTEgOiAxO1xuXHR9IDpcblx0ZnVuY3Rpb24oIGEsIGIgKSB7XG5cdFx0Ly8gRXhpdCBlYXJseSBpZiB0aGUgbm9kZXMgYXJlIGlkZW50aWNhbFxuXHRcdGlmICggYSA9PT0gYiApIHtcblx0XHRcdGhhc0R1cGxpY2F0ZSA9IHRydWU7XG5cdFx0XHRyZXR1cm4gMDtcblx0XHR9XG5cblx0XHR2YXIgY3VyLFxuXHRcdFx0aSA9IDAsXG5cdFx0XHRhdXAgPSBhLnBhcmVudE5vZGUsXG5cdFx0XHRidXAgPSBiLnBhcmVudE5vZGUsXG5cdFx0XHRhcCA9IFsgYSBdLFxuXHRcdFx0YnAgPSBbIGIgXTtcblxuXHRcdC8vIFBhcmVudGxlc3Mgbm9kZXMgYXJlIGVpdGhlciBkb2N1bWVudHMgb3IgZGlzY29ubmVjdGVkXG5cdFx0aWYgKCAhYXVwIHx8ICFidXAgKSB7XG5cdFx0XHRyZXR1cm4gYSA9PT0gZG9jID8gLTEgOlxuXHRcdFx0XHRiID09PSBkb2MgPyAxIDpcblx0XHRcdFx0YXVwID8gLTEgOlxuXHRcdFx0XHRidXAgPyAxIDpcblx0XHRcdFx0c29ydElucHV0ID9cblx0XHRcdFx0KCBpbmRleE9mLmNhbGwoIHNvcnRJbnB1dCwgYSApIC0gaW5kZXhPZi5jYWxsKCBzb3J0SW5wdXQsIGIgKSApIDpcblx0XHRcdFx0MDtcblxuXHRcdC8vIElmIHRoZSBub2RlcyBhcmUgc2libGluZ3MsIHdlIGNhbiBkbyBhIHF1aWNrIGNoZWNrXG5cdFx0fSBlbHNlIGlmICggYXVwID09PSBidXAgKSB7XG5cdFx0XHRyZXR1cm4gc2libGluZ0NoZWNrKCBhLCBiICk7XG5cdFx0fVxuXG5cdFx0Ly8gT3RoZXJ3aXNlIHdlIG5lZWQgZnVsbCBsaXN0cyBvZiB0aGVpciBhbmNlc3RvcnMgZm9yIGNvbXBhcmlzb25cblx0XHRjdXIgPSBhO1xuXHRcdHdoaWxlICggKGN1ciA9IGN1ci5wYXJlbnROb2RlKSApIHtcblx0XHRcdGFwLnVuc2hpZnQoIGN1ciApO1xuXHRcdH1cblx0XHRjdXIgPSBiO1xuXHRcdHdoaWxlICggKGN1ciA9IGN1ci5wYXJlbnROb2RlKSApIHtcblx0XHRcdGJwLnVuc2hpZnQoIGN1ciApO1xuXHRcdH1cblxuXHRcdC8vIFdhbGsgZG93biB0aGUgdHJlZSBsb29raW5nIGZvciBhIGRpc2NyZXBhbmN5XG5cdFx0d2hpbGUgKCBhcFtpXSA9PT0gYnBbaV0gKSB7XG5cdFx0XHRpKys7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGkgP1xuXHRcdFx0Ly8gRG8gYSBzaWJsaW5nIGNoZWNrIGlmIHRoZSBub2RlcyBoYXZlIGEgY29tbW9uIGFuY2VzdG9yXG5cdFx0XHRzaWJsaW5nQ2hlY2soIGFwW2ldLCBicFtpXSApIDpcblxuXHRcdFx0Ly8gT3RoZXJ3aXNlIG5vZGVzIGluIG91ciBkb2N1bWVudCBzb3J0IGZpcnN0XG5cdFx0XHRhcFtpXSA9PT0gcHJlZmVycmVkRG9jID8gLTEgOlxuXHRcdFx0YnBbaV0gPT09IHByZWZlcnJlZERvYyA/IDEgOlxuXHRcdFx0MDtcblx0fTtcblxuXHRyZXR1cm4gZG9jO1xufTtcblxuU2l6emxlLm1hdGNoZXMgPSBmdW5jdGlvbiggZXhwciwgZWxlbWVudHMgKSB7XG5cdHJldHVybiBTaXp6bGUoIGV4cHIsIG51bGwsIG51bGwsIGVsZW1lbnRzICk7XG59O1xuXG5TaXp6bGUubWF0Y2hlc1NlbGVjdG9yID0gZnVuY3Rpb24oIGVsZW0sIGV4cHIgKSB7XG5cdC8vIFNldCBkb2N1bWVudCB2YXJzIGlmIG5lZWRlZFxuXHRpZiAoICggZWxlbS5vd25lckRvY3VtZW50IHx8IGVsZW0gKSAhPT0gZG9jdW1lbnQgKSB7XG5cdFx0c2V0RG9jdW1lbnQoIGVsZW0gKTtcblx0fVxuXG5cdC8vIE1ha2Ugc3VyZSB0aGF0IGF0dHJpYnV0ZSBzZWxlY3RvcnMgYXJlIHF1b3RlZFxuXHRleHByID0gZXhwci5yZXBsYWNlKCByYXR0cmlidXRlUXVvdGVzLCBcIj0nJDEnXVwiICk7XG5cblx0aWYgKCBzdXBwb3J0Lm1hdGNoZXNTZWxlY3RvciAmJiBkb2N1bWVudElzSFRNTCAmJlxuXHRcdCggIXJidWdneU1hdGNoZXMgfHwgIXJidWdneU1hdGNoZXMudGVzdCggZXhwciApICkgJiZcblx0XHQoICFyYnVnZ3lRU0EgICAgIHx8ICFyYnVnZ3lRU0EudGVzdCggZXhwciApICkgKSB7XG5cblx0XHR0cnkge1xuXHRcdFx0dmFyIHJldCA9IG1hdGNoZXMuY2FsbCggZWxlbSwgZXhwciApO1xuXG5cdFx0XHQvLyBJRSA5J3MgbWF0Y2hlc1NlbGVjdG9yIHJldHVybnMgZmFsc2Ugb24gZGlzY29ubmVjdGVkIG5vZGVzXG5cdFx0XHRpZiAoIHJldCB8fCBzdXBwb3J0LmRpc2Nvbm5lY3RlZE1hdGNoIHx8XG5cdFx0XHRcdFx0Ly8gQXMgd2VsbCwgZGlzY29ubmVjdGVkIG5vZGVzIGFyZSBzYWlkIHRvIGJlIGluIGEgZG9jdW1lbnRcblx0XHRcdFx0XHQvLyBmcmFnbWVudCBpbiBJRSA5XG5cdFx0XHRcdFx0ZWxlbS5kb2N1bWVudCAmJiBlbGVtLmRvY3VtZW50Lm5vZGVUeXBlICE9PSAxMSApIHtcblx0XHRcdFx0cmV0dXJuIHJldDtcblx0XHRcdH1cblx0XHR9IGNhdGNoKGUpIHt9XG5cdH1cblxuXHRyZXR1cm4gU2l6emxlKCBleHByLCBkb2N1bWVudCwgbnVsbCwgWyBlbGVtIF0gKS5sZW5ndGggPiAwO1xufTtcblxuU2l6emxlLmNvbnRhaW5zID0gZnVuY3Rpb24oIGNvbnRleHQsIGVsZW0gKSB7XG5cdC8vIFNldCBkb2N1bWVudCB2YXJzIGlmIG5lZWRlZFxuXHRpZiAoICggY29udGV4dC5vd25lckRvY3VtZW50IHx8IGNvbnRleHQgKSAhPT0gZG9jdW1lbnQgKSB7XG5cdFx0c2V0RG9jdW1lbnQoIGNvbnRleHQgKTtcblx0fVxuXHRyZXR1cm4gY29udGFpbnMoIGNvbnRleHQsIGVsZW0gKTtcbn07XG5cblNpenpsZS5hdHRyID0gZnVuY3Rpb24oIGVsZW0sIG5hbWUgKSB7XG5cdC8vIFNldCBkb2N1bWVudCB2YXJzIGlmIG5lZWRlZFxuXHRpZiAoICggZWxlbS5vd25lckRvY3VtZW50IHx8IGVsZW0gKSAhPT0gZG9jdW1lbnQgKSB7XG5cdFx0c2V0RG9jdW1lbnQoIGVsZW0gKTtcblx0fVxuXG5cdHZhciBmbiA9IEV4cHIuYXR0ckhhbmRsZVsgbmFtZS50b0xvd2VyQ2FzZSgpIF0sXG5cdFx0Ly8gRG9uJ3QgZ2V0IGZvb2xlZCBieSBPYmplY3QucHJvdG90eXBlIHByb3BlcnRpZXMgKGpRdWVyeSAjMTM4MDcpXG5cdFx0dmFsID0gZm4gJiYgaGFzT3duLmNhbGwoIEV4cHIuYXR0ckhhbmRsZSwgbmFtZS50b0xvd2VyQ2FzZSgpICkgP1xuXHRcdFx0Zm4oIGVsZW0sIG5hbWUsICFkb2N1bWVudElzSFRNTCApIDpcblx0XHRcdHVuZGVmaW5lZDtcblxuXHRyZXR1cm4gdmFsICE9PSB1bmRlZmluZWQgP1xuXHRcdHZhbCA6XG5cdFx0c3VwcG9ydC5hdHRyaWJ1dGVzIHx8ICFkb2N1bWVudElzSFRNTCA/XG5cdFx0XHRlbGVtLmdldEF0dHJpYnV0ZSggbmFtZSApIDpcblx0XHRcdCh2YWwgPSBlbGVtLmdldEF0dHJpYnV0ZU5vZGUobmFtZSkpICYmIHZhbC5zcGVjaWZpZWQgP1xuXHRcdFx0XHR2YWwudmFsdWUgOlxuXHRcdFx0XHRudWxsO1xufTtcblxuU2l6emxlLmVycm9yID0gZnVuY3Rpb24oIG1zZyApIHtcblx0dGhyb3cgbmV3IEVycm9yKCBcIlN5bnRheCBlcnJvciwgdW5yZWNvZ25pemVkIGV4cHJlc3Npb246IFwiICsgbXNnICk7XG59O1xuXG4vKipcbiAqIERvY3VtZW50IHNvcnRpbmcgYW5kIHJlbW92aW5nIGR1cGxpY2F0ZXNcbiAqIEBwYXJhbSB7QXJyYXlMaWtlfSByZXN1bHRzXG4gKi9cblNpenpsZS51bmlxdWVTb3J0ID0gZnVuY3Rpb24oIHJlc3VsdHMgKSB7XG5cdHZhciBlbGVtLFxuXHRcdGR1cGxpY2F0ZXMgPSBbXSxcblx0XHRqID0gMCxcblx0XHRpID0gMDtcblxuXHQvLyBVbmxlc3Mgd2UgKmtub3cqIHdlIGNhbiBkZXRlY3QgZHVwbGljYXRlcywgYXNzdW1lIHRoZWlyIHByZXNlbmNlXG5cdGhhc0R1cGxpY2F0ZSA9ICFzdXBwb3J0LmRldGVjdER1cGxpY2F0ZXM7XG5cdHNvcnRJbnB1dCA9ICFzdXBwb3J0LnNvcnRTdGFibGUgJiYgcmVzdWx0cy5zbGljZSggMCApO1xuXHRyZXN1bHRzLnNvcnQoIHNvcnRPcmRlciApO1xuXG5cdGlmICggaGFzRHVwbGljYXRlICkge1xuXHRcdHdoaWxlICggKGVsZW0gPSByZXN1bHRzW2krK10pICkge1xuXHRcdFx0aWYgKCBlbGVtID09PSByZXN1bHRzWyBpIF0gKSB7XG5cdFx0XHRcdGogPSBkdXBsaWNhdGVzLnB1c2goIGkgKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0d2hpbGUgKCBqLS0gKSB7XG5cdFx0XHRyZXN1bHRzLnNwbGljZSggZHVwbGljYXRlc1sgaiBdLCAxICk7XG5cdFx0fVxuXHR9XG5cblx0Ly8gQ2xlYXIgaW5wdXQgYWZ0ZXIgc29ydGluZyB0byByZWxlYXNlIG9iamVjdHNcblx0Ly8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9qcXVlcnkvc2l6emxlL3B1bGwvMjI1XG5cdHNvcnRJbnB1dCA9IG51bGw7XG5cblx0cmV0dXJuIHJlc3VsdHM7XG59O1xuXG4vKipcbiAqIFV0aWxpdHkgZnVuY3Rpb24gZm9yIHJldHJpZXZpbmcgdGhlIHRleHQgdmFsdWUgb2YgYW4gYXJyYXkgb2YgRE9NIG5vZGVzXG4gKiBAcGFyYW0ge0FycmF5fEVsZW1lbnR9IGVsZW1cbiAqL1xuZ2V0VGV4dCA9IFNpenpsZS5nZXRUZXh0ID0gZnVuY3Rpb24oIGVsZW0gKSB7XG5cdHZhciBub2RlLFxuXHRcdHJldCA9IFwiXCIsXG5cdFx0aSA9IDAsXG5cdFx0bm9kZVR5cGUgPSBlbGVtLm5vZGVUeXBlO1xuXG5cdGlmICggIW5vZGVUeXBlICkge1xuXHRcdC8vIElmIG5vIG5vZGVUeXBlLCB0aGlzIGlzIGV4cGVjdGVkIHRvIGJlIGFuIGFycmF5XG5cdFx0d2hpbGUgKCAobm9kZSA9IGVsZW1baSsrXSkgKSB7XG5cdFx0XHQvLyBEbyBub3QgdHJhdmVyc2UgY29tbWVudCBub2Rlc1xuXHRcdFx0cmV0ICs9IGdldFRleHQoIG5vZGUgKTtcblx0XHR9XG5cdH0gZWxzZSBpZiAoIG5vZGVUeXBlID09PSAxIHx8IG5vZGVUeXBlID09PSA5IHx8IG5vZGVUeXBlID09PSAxMSApIHtcblx0XHQvLyBVc2UgdGV4dENvbnRlbnQgZm9yIGVsZW1lbnRzXG5cdFx0Ly8gaW5uZXJUZXh0IHVzYWdlIHJlbW92ZWQgZm9yIGNvbnNpc3RlbmN5IG9mIG5ldyBsaW5lcyAoalF1ZXJ5ICMxMTE1Mylcblx0XHRpZiAoIHR5cGVvZiBlbGVtLnRleHRDb250ZW50ID09PSBcInN0cmluZ1wiICkge1xuXHRcdFx0cmV0dXJuIGVsZW0udGV4dENvbnRlbnQ7XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIFRyYXZlcnNlIGl0cyBjaGlsZHJlblxuXHRcdFx0Zm9yICggZWxlbSA9IGVsZW0uZmlyc3RDaGlsZDsgZWxlbTsgZWxlbSA9IGVsZW0ubmV4dFNpYmxpbmcgKSB7XG5cdFx0XHRcdHJldCArPSBnZXRUZXh0KCBlbGVtICk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9IGVsc2UgaWYgKCBub2RlVHlwZSA9PT0gMyB8fCBub2RlVHlwZSA9PT0gNCApIHtcblx0XHRyZXR1cm4gZWxlbS5ub2RlVmFsdWU7XG5cdH1cblx0Ly8gRG8gbm90IGluY2x1ZGUgY29tbWVudCBvciBwcm9jZXNzaW5nIGluc3RydWN0aW9uIG5vZGVzXG5cblx0cmV0dXJuIHJldDtcbn07XG5cbkV4cHIgPSBTaXp6bGUuc2VsZWN0b3JzID0ge1xuXG5cdC8vIENhbiBiZSBhZGp1c3RlZCBieSB0aGUgdXNlclxuXHRjYWNoZUxlbmd0aDogNTAsXG5cblx0Y3JlYXRlUHNldWRvOiBtYXJrRnVuY3Rpb24sXG5cblx0bWF0Y2g6IG1hdGNoRXhwcixcblxuXHRhdHRySGFuZGxlOiB7fSxcblxuXHRmaW5kOiB7fSxcblxuXHRyZWxhdGl2ZToge1xuXHRcdFwiPlwiOiB7IGRpcjogXCJwYXJlbnROb2RlXCIsIGZpcnN0OiB0cnVlIH0sXG5cdFx0XCIgXCI6IHsgZGlyOiBcInBhcmVudE5vZGVcIiB9LFxuXHRcdFwiK1wiOiB7IGRpcjogXCJwcmV2aW91c1NpYmxpbmdcIiwgZmlyc3Q6IHRydWUgfSxcblx0XHRcIn5cIjogeyBkaXI6IFwicHJldmlvdXNTaWJsaW5nXCIgfVxuXHR9LFxuXG5cdHByZUZpbHRlcjoge1xuXHRcdFwiQVRUUlwiOiBmdW5jdGlvbiggbWF0Y2ggKSB7XG5cdFx0XHRtYXRjaFsxXSA9IG1hdGNoWzFdLnJlcGxhY2UoIHJ1bmVzY2FwZSwgZnVuZXNjYXBlICk7XG5cblx0XHRcdC8vIE1vdmUgdGhlIGdpdmVuIHZhbHVlIHRvIG1hdGNoWzNdIHdoZXRoZXIgcXVvdGVkIG9yIHVucXVvdGVkXG5cdFx0XHRtYXRjaFszXSA9ICggbWF0Y2hbM10gfHwgbWF0Y2hbNF0gfHwgbWF0Y2hbNV0gfHwgXCJcIiApLnJlcGxhY2UoIHJ1bmVzY2FwZSwgZnVuZXNjYXBlICk7XG5cblx0XHRcdGlmICggbWF0Y2hbMl0gPT09IFwifj1cIiApIHtcblx0XHRcdFx0bWF0Y2hbM10gPSBcIiBcIiArIG1hdGNoWzNdICsgXCIgXCI7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBtYXRjaC5zbGljZSggMCwgNCApO1xuXHRcdH0sXG5cblx0XHRcIkNISUxEXCI6IGZ1bmN0aW9uKCBtYXRjaCApIHtcblx0XHRcdC8qIG1hdGNoZXMgZnJvbSBtYXRjaEV4cHJbXCJDSElMRFwiXVxuXHRcdFx0XHQxIHR5cGUgKG9ubHl8bnRofC4uLilcblx0XHRcdFx0MiB3aGF0IChjaGlsZHxvZi10eXBlKVxuXHRcdFx0XHQzIGFyZ3VtZW50IChldmVufG9kZHxcXGQqfFxcZCpuKFsrLV1cXGQrKT98Li4uKVxuXHRcdFx0XHQ0IHhuLWNvbXBvbmVudCBvZiB4bit5IGFyZ3VtZW50IChbKy1dP1xcZCpufClcblx0XHRcdFx0NSBzaWduIG9mIHhuLWNvbXBvbmVudFxuXHRcdFx0XHQ2IHggb2YgeG4tY29tcG9uZW50XG5cdFx0XHRcdDcgc2lnbiBvZiB5LWNvbXBvbmVudFxuXHRcdFx0XHQ4IHkgb2YgeS1jb21wb25lbnRcblx0XHRcdCovXG5cdFx0XHRtYXRjaFsxXSA9IG1hdGNoWzFdLnRvTG93ZXJDYXNlKCk7XG5cblx0XHRcdGlmICggbWF0Y2hbMV0uc2xpY2UoIDAsIDMgKSA9PT0gXCJudGhcIiApIHtcblx0XHRcdFx0Ly8gbnRoLSogcmVxdWlyZXMgYXJndW1lbnRcblx0XHRcdFx0aWYgKCAhbWF0Y2hbM10gKSB7XG5cdFx0XHRcdFx0U2l6emxlLmVycm9yKCBtYXRjaFswXSApO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gbnVtZXJpYyB4IGFuZCB5IHBhcmFtZXRlcnMgZm9yIEV4cHIuZmlsdGVyLkNISUxEXG5cdFx0XHRcdC8vIHJlbWVtYmVyIHRoYXQgZmFsc2UvdHJ1ZSBjYXN0IHJlc3BlY3RpdmVseSB0byAwLzFcblx0XHRcdFx0bWF0Y2hbNF0gPSArKCBtYXRjaFs0XSA/IG1hdGNoWzVdICsgKG1hdGNoWzZdIHx8IDEpIDogMiAqICggbWF0Y2hbM10gPT09IFwiZXZlblwiIHx8IG1hdGNoWzNdID09PSBcIm9kZFwiICkgKTtcblx0XHRcdFx0bWF0Y2hbNV0gPSArKCAoIG1hdGNoWzddICsgbWF0Y2hbOF0gKSB8fCBtYXRjaFszXSA9PT0gXCJvZGRcIiApO1xuXG5cdFx0XHQvLyBvdGhlciB0eXBlcyBwcm9oaWJpdCBhcmd1bWVudHNcblx0XHRcdH0gZWxzZSBpZiAoIG1hdGNoWzNdICkge1xuXHRcdFx0XHRTaXp6bGUuZXJyb3IoIG1hdGNoWzBdICk7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBtYXRjaDtcblx0XHR9LFxuXG5cdFx0XCJQU0VVRE9cIjogZnVuY3Rpb24oIG1hdGNoICkge1xuXHRcdFx0dmFyIGV4Y2Vzcyxcblx0XHRcdFx0dW5xdW90ZWQgPSAhbWF0Y2hbNl0gJiYgbWF0Y2hbMl07XG5cblx0XHRcdGlmICggbWF0Y2hFeHByW1wiQ0hJTERcIl0udGVzdCggbWF0Y2hbMF0gKSApIHtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdC8vIEFjY2VwdCBxdW90ZWQgYXJndW1lbnRzIGFzLWlzXG5cdFx0XHRpZiAoIG1hdGNoWzNdICkge1xuXHRcdFx0XHRtYXRjaFsyXSA9IG1hdGNoWzRdIHx8IG1hdGNoWzVdIHx8IFwiXCI7XG5cblx0XHRcdC8vIFN0cmlwIGV4Y2VzcyBjaGFyYWN0ZXJzIGZyb20gdW5xdW90ZWQgYXJndW1lbnRzXG5cdFx0XHR9IGVsc2UgaWYgKCB1bnF1b3RlZCAmJiBycHNldWRvLnRlc3QoIHVucXVvdGVkICkgJiZcblx0XHRcdFx0Ly8gR2V0IGV4Y2VzcyBmcm9tIHRva2VuaXplIChyZWN1cnNpdmVseSlcblx0XHRcdFx0KGV4Y2VzcyA9IHRva2VuaXplKCB1bnF1b3RlZCwgdHJ1ZSApKSAmJlxuXHRcdFx0XHQvLyBhZHZhbmNlIHRvIHRoZSBuZXh0IGNsb3NpbmcgcGFyZW50aGVzaXNcblx0XHRcdFx0KGV4Y2VzcyA9IHVucXVvdGVkLmluZGV4T2YoIFwiKVwiLCB1bnF1b3RlZC5sZW5ndGggLSBleGNlc3MgKSAtIHVucXVvdGVkLmxlbmd0aCkgKSB7XG5cblx0XHRcdFx0Ly8gZXhjZXNzIGlzIGEgbmVnYXRpdmUgaW5kZXhcblx0XHRcdFx0bWF0Y2hbMF0gPSBtYXRjaFswXS5zbGljZSggMCwgZXhjZXNzICk7XG5cdFx0XHRcdG1hdGNoWzJdID0gdW5xdW90ZWQuc2xpY2UoIDAsIGV4Y2VzcyApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBSZXR1cm4gb25seSBjYXB0dXJlcyBuZWVkZWQgYnkgdGhlIHBzZXVkbyBmaWx0ZXIgbWV0aG9kICh0eXBlIGFuZCBhcmd1bWVudClcblx0XHRcdHJldHVybiBtYXRjaC5zbGljZSggMCwgMyApO1xuXHRcdH1cblx0fSxcblxuXHRmaWx0ZXI6IHtcblxuXHRcdFwiVEFHXCI6IGZ1bmN0aW9uKCBub2RlTmFtZVNlbGVjdG9yICkge1xuXHRcdFx0dmFyIG5vZGVOYW1lID0gbm9kZU5hbWVTZWxlY3Rvci5yZXBsYWNlKCBydW5lc2NhcGUsIGZ1bmVzY2FwZSApLnRvTG93ZXJDYXNlKCk7XG5cdFx0XHRyZXR1cm4gbm9kZU5hbWVTZWxlY3RvciA9PT0gXCIqXCIgP1xuXHRcdFx0XHRmdW5jdGlvbigpIHsgcmV0dXJuIHRydWU7IH0gOlxuXHRcdFx0XHRmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdFx0XHRyZXR1cm4gZWxlbS5ub2RlTmFtZSAmJiBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09IG5vZGVOYW1lO1xuXHRcdFx0XHR9O1xuXHRcdH0sXG5cblx0XHRcIkNMQVNTXCI6IGZ1bmN0aW9uKCBjbGFzc05hbWUgKSB7XG5cdFx0XHR2YXIgcGF0dGVybiA9IGNsYXNzQ2FjaGVbIGNsYXNzTmFtZSArIFwiIFwiIF07XG5cblx0XHRcdHJldHVybiBwYXR0ZXJuIHx8XG5cdFx0XHRcdChwYXR0ZXJuID0gbmV3IFJlZ0V4cCggXCIoXnxcIiArIHdoaXRlc3BhY2UgKyBcIilcIiArIGNsYXNzTmFtZSArIFwiKFwiICsgd2hpdGVzcGFjZSArIFwifCQpXCIgKSkgJiZcblx0XHRcdFx0Y2xhc3NDYWNoZSggY2xhc3NOYW1lLCBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdFx0XHRyZXR1cm4gcGF0dGVybi50ZXN0KCB0eXBlb2YgZWxlbS5jbGFzc05hbWUgPT09IFwic3RyaW5nXCIgJiYgZWxlbS5jbGFzc05hbWUgfHwgdHlwZW9mIGVsZW0uZ2V0QXR0cmlidXRlICE9PSBzdHJ1bmRlZmluZWQgJiYgZWxlbS5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKSB8fCBcIlwiICk7XG5cdFx0XHRcdH0pO1xuXHRcdH0sXG5cblx0XHRcIkFUVFJcIjogZnVuY3Rpb24oIG5hbWUsIG9wZXJhdG9yLCBjaGVjayApIHtcblx0XHRcdHJldHVybiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdFx0dmFyIHJlc3VsdCA9IFNpenpsZS5hdHRyKCBlbGVtLCBuYW1lICk7XG5cblx0XHRcdFx0aWYgKCByZXN1bHQgPT0gbnVsbCApIHtcblx0XHRcdFx0XHRyZXR1cm4gb3BlcmF0b3IgPT09IFwiIT1cIjtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoICFvcGVyYXRvciApIHtcblx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJlc3VsdCArPSBcIlwiO1xuXG5cdFx0XHRcdHJldHVybiBvcGVyYXRvciA9PT0gXCI9XCIgPyByZXN1bHQgPT09IGNoZWNrIDpcblx0XHRcdFx0XHRvcGVyYXRvciA9PT0gXCIhPVwiID8gcmVzdWx0ICE9PSBjaGVjayA6XG5cdFx0XHRcdFx0b3BlcmF0b3IgPT09IFwiXj1cIiA/IGNoZWNrICYmIHJlc3VsdC5pbmRleE9mKCBjaGVjayApID09PSAwIDpcblx0XHRcdFx0XHRvcGVyYXRvciA9PT0gXCIqPVwiID8gY2hlY2sgJiYgcmVzdWx0LmluZGV4T2YoIGNoZWNrICkgPiAtMSA6XG5cdFx0XHRcdFx0b3BlcmF0b3IgPT09IFwiJD1cIiA/IGNoZWNrICYmIHJlc3VsdC5zbGljZSggLWNoZWNrLmxlbmd0aCApID09PSBjaGVjayA6XG5cdFx0XHRcdFx0b3BlcmF0b3IgPT09IFwifj1cIiA/ICggXCIgXCIgKyByZXN1bHQgKyBcIiBcIiApLmluZGV4T2YoIGNoZWNrICkgPiAtMSA6XG5cdFx0XHRcdFx0b3BlcmF0b3IgPT09IFwifD1cIiA/IHJlc3VsdCA9PT0gY2hlY2sgfHwgcmVzdWx0LnNsaWNlKCAwLCBjaGVjay5sZW5ndGggKyAxICkgPT09IGNoZWNrICsgXCItXCIgOlxuXHRcdFx0XHRcdGZhbHNlO1xuXHRcdFx0fTtcblx0XHR9LFxuXG5cdFx0XCJDSElMRFwiOiBmdW5jdGlvbiggdHlwZSwgd2hhdCwgYXJndW1lbnQsIGZpcnN0LCBsYXN0ICkge1xuXHRcdFx0dmFyIHNpbXBsZSA9IHR5cGUuc2xpY2UoIDAsIDMgKSAhPT0gXCJudGhcIixcblx0XHRcdFx0Zm9yd2FyZCA9IHR5cGUuc2xpY2UoIC00ICkgIT09IFwibGFzdFwiLFxuXHRcdFx0XHRvZlR5cGUgPSB3aGF0ID09PSBcIm9mLXR5cGVcIjtcblxuXHRcdFx0cmV0dXJuIGZpcnN0ID09PSAxICYmIGxhc3QgPT09IDAgP1xuXG5cdFx0XHRcdC8vIFNob3J0Y3V0IGZvciA6bnRoLSoobilcblx0XHRcdFx0ZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRcdFx0cmV0dXJuICEhZWxlbS5wYXJlbnROb2RlO1xuXHRcdFx0XHR9IDpcblxuXHRcdFx0XHRmdW5jdGlvbiggZWxlbSwgY29udGV4dCwgeG1sICkge1xuXHRcdFx0XHRcdHZhciBjYWNoZSwgb3V0ZXJDYWNoZSwgbm9kZSwgZGlmZiwgbm9kZUluZGV4LCBzdGFydCxcblx0XHRcdFx0XHRcdGRpciA9IHNpbXBsZSAhPT0gZm9yd2FyZCA/IFwibmV4dFNpYmxpbmdcIiA6IFwicHJldmlvdXNTaWJsaW5nXCIsXG5cdFx0XHRcdFx0XHRwYXJlbnQgPSBlbGVtLnBhcmVudE5vZGUsXG5cdFx0XHRcdFx0XHRuYW1lID0gb2ZUeXBlICYmIGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSxcblx0XHRcdFx0XHRcdHVzZUNhY2hlID0gIXhtbCAmJiAhb2ZUeXBlO1xuXG5cdFx0XHRcdFx0aWYgKCBwYXJlbnQgKSB7XG5cblx0XHRcdFx0XHRcdC8vIDooZmlyc3R8bGFzdHxvbmx5KS0oY2hpbGR8b2YtdHlwZSlcblx0XHRcdFx0XHRcdGlmICggc2ltcGxlICkge1xuXHRcdFx0XHRcdFx0XHR3aGlsZSAoIGRpciApIHtcblx0XHRcdFx0XHRcdFx0XHRub2RlID0gZWxlbTtcblx0XHRcdFx0XHRcdFx0XHR3aGlsZSAoIChub2RlID0gbm9kZVsgZGlyIF0pICkge1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKCBvZlR5cGUgPyBub2RlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09IG5hbWUgOiBub2RlLm5vZGVUeXBlID09PSAxICkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdC8vIFJldmVyc2UgZGlyZWN0aW9uIGZvciA6b25seS0qIChpZiB3ZSBoYXZlbid0IHlldCBkb25lIHNvKVxuXHRcdFx0XHRcdFx0XHRcdHN0YXJ0ID0gZGlyID0gdHlwZSA9PT0gXCJvbmx5XCIgJiYgIXN0YXJ0ICYmIFwibmV4dFNpYmxpbmdcIjtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0c3RhcnQgPSBbIGZvcndhcmQgPyBwYXJlbnQuZmlyc3RDaGlsZCA6IHBhcmVudC5sYXN0Q2hpbGQgXTtcblxuXHRcdFx0XHRcdFx0Ly8gbm9uLXhtbCA6bnRoLWNoaWxkKC4uLikgc3RvcmVzIGNhY2hlIGRhdGEgb24gYHBhcmVudGBcblx0XHRcdFx0XHRcdGlmICggZm9yd2FyZCAmJiB1c2VDYWNoZSApIHtcblx0XHRcdFx0XHRcdFx0Ly8gU2VlayBgZWxlbWAgZnJvbSBhIHByZXZpb3VzbHktY2FjaGVkIGluZGV4XG5cdFx0XHRcdFx0XHRcdG91dGVyQ2FjaGUgPSBwYXJlbnRbIGV4cGFuZG8gXSB8fCAocGFyZW50WyBleHBhbmRvIF0gPSB7fSk7XG5cdFx0XHRcdFx0XHRcdGNhY2hlID0gb3V0ZXJDYWNoZVsgdHlwZSBdIHx8IFtdO1xuXHRcdFx0XHRcdFx0XHRub2RlSW5kZXggPSBjYWNoZVswXSA9PT0gZGlycnVucyAmJiBjYWNoZVsxXTtcblx0XHRcdFx0XHRcdFx0ZGlmZiA9IGNhY2hlWzBdID09PSBkaXJydW5zICYmIGNhY2hlWzJdO1xuXHRcdFx0XHRcdFx0XHRub2RlID0gbm9kZUluZGV4ICYmIHBhcmVudC5jaGlsZE5vZGVzWyBub2RlSW5kZXggXTtcblxuXHRcdFx0XHRcdFx0XHR3aGlsZSAoIChub2RlID0gKytub2RlSW5kZXggJiYgbm9kZSAmJiBub2RlWyBkaXIgXSB8fFxuXG5cdFx0XHRcdFx0XHRcdFx0Ly8gRmFsbGJhY2sgdG8gc2Vla2luZyBgZWxlbWAgZnJvbSB0aGUgc3RhcnRcblx0XHRcdFx0XHRcdFx0XHQoZGlmZiA9IG5vZGVJbmRleCA9IDApIHx8IHN0YXJ0LnBvcCgpKSApIHtcblxuXHRcdFx0XHRcdFx0XHRcdC8vIFdoZW4gZm91bmQsIGNhY2hlIGluZGV4ZXMgb24gYHBhcmVudGAgYW5kIGJyZWFrXG5cdFx0XHRcdFx0XHRcdFx0aWYgKCBub2RlLm5vZGVUeXBlID09PSAxICYmICsrZGlmZiAmJiBub2RlID09PSBlbGVtICkge1xuXHRcdFx0XHRcdFx0XHRcdFx0b3V0ZXJDYWNoZVsgdHlwZSBdID0gWyBkaXJydW5zLCBub2RlSW5kZXgsIGRpZmYgXTtcblx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHQvLyBVc2UgcHJldmlvdXNseS1jYWNoZWQgZWxlbWVudCBpbmRleCBpZiBhdmFpbGFibGVcblx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoIHVzZUNhY2hlICYmIChjYWNoZSA9IChlbGVtWyBleHBhbmRvIF0gfHwgKGVsZW1bIGV4cGFuZG8gXSA9IHt9KSlbIHR5cGUgXSkgJiYgY2FjaGVbMF0gPT09IGRpcnJ1bnMgKSB7XG5cdFx0XHRcdFx0XHRcdGRpZmYgPSBjYWNoZVsxXTtcblxuXHRcdFx0XHRcdFx0Ly8geG1sIDpudGgtY2hpbGQoLi4uKSBvciA6bnRoLWxhc3QtY2hpbGQoLi4uKSBvciA6bnRoKC1sYXN0KT8tb2YtdHlwZSguLi4pXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHQvLyBVc2UgdGhlIHNhbWUgbG9vcCBhcyBhYm92ZSB0byBzZWVrIGBlbGVtYCBmcm9tIHRoZSBzdGFydFxuXHRcdFx0XHRcdFx0XHR3aGlsZSAoIChub2RlID0gKytub2RlSW5kZXggJiYgbm9kZSAmJiBub2RlWyBkaXIgXSB8fFxuXHRcdFx0XHRcdFx0XHRcdChkaWZmID0gbm9kZUluZGV4ID0gMCkgfHwgc3RhcnQucG9wKCkpICkge1xuXG5cdFx0XHRcdFx0XHRcdFx0aWYgKCAoIG9mVHlwZSA/IG5vZGUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gbmFtZSA6IG5vZGUubm9kZVR5cGUgPT09IDEgKSAmJiArK2RpZmYgKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBDYWNoZSB0aGUgaW5kZXggb2YgZWFjaCBlbmNvdW50ZXJlZCBlbGVtZW50XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAoIHVzZUNhY2hlICkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHQobm9kZVsgZXhwYW5kbyBdIHx8IChub2RlWyBleHBhbmRvIF0gPSB7fSkpWyB0eXBlIF0gPSBbIGRpcnJ1bnMsIGRpZmYgXTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKCBub2RlID09PSBlbGVtICkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0Ly8gSW5jb3Jwb3JhdGUgdGhlIG9mZnNldCwgdGhlbiBjaGVjayBhZ2FpbnN0IGN5Y2xlIHNpemVcblx0XHRcdFx0XHRcdGRpZmYgLT0gbGFzdDtcblx0XHRcdFx0XHRcdHJldHVybiBkaWZmID09PSBmaXJzdCB8fCAoIGRpZmYgJSBmaXJzdCA9PT0gMCAmJiBkaWZmIC8gZmlyc3QgPj0gMCApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fTtcblx0XHR9LFxuXG5cdFx0XCJQU0VVRE9cIjogZnVuY3Rpb24oIHBzZXVkbywgYXJndW1lbnQgKSB7XG5cdFx0XHQvLyBwc2V1ZG8tY2xhc3MgbmFtZXMgYXJlIGNhc2UtaW5zZW5zaXRpdmVcblx0XHRcdC8vIGh0dHA6Ly93d3cudzMub3JnL1RSL3NlbGVjdG9ycy8jcHNldWRvLWNsYXNzZXNcblx0XHRcdC8vIFByaW9yaXRpemUgYnkgY2FzZSBzZW5zaXRpdml0eSBpbiBjYXNlIGN1c3RvbSBwc2V1ZG9zIGFyZSBhZGRlZCB3aXRoIHVwcGVyY2FzZSBsZXR0ZXJzXG5cdFx0XHQvLyBSZW1lbWJlciB0aGF0IHNldEZpbHRlcnMgaW5oZXJpdHMgZnJvbSBwc2V1ZG9zXG5cdFx0XHR2YXIgYXJncyxcblx0XHRcdFx0Zm4gPSBFeHByLnBzZXVkb3NbIHBzZXVkbyBdIHx8IEV4cHIuc2V0RmlsdGVyc1sgcHNldWRvLnRvTG93ZXJDYXNlKCkgXSB8fFxuXHRcdFx0XHRcdFNpenpsZS5lcnJvciggXCJ1bnN1cHBvcnRlZCBwc2V1ZG86IFwiICsgcHNldWRvICk7XG5cblx0XHRcdC8vIFRoZSB1c2VyIG1heSB1c2UgY3JlYXRlUHNldWRvIHRvIGluZGljYXRlIHRoYXRcblx0XHRcdC8vIGFyZ3VtZW50cyBhcmUgbmVlZGVkIHRvIGNyZWF0ZSB0aGUgZmlsdGVyIGZ1bmN0aW9uXG5cdFx0XHQvLyBqdXN0IGFzIFNpenpsZSBkb2VzXG5cdFx0XHRpZiAoIGZuWyBleHBhbmRvIF0gKSB7XG5cdFx0XHRcdHJldHVybiBmbiggYXJndW1lbnQgKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQnV0IG1haW50YWluIHN1cHBvcnQgZm9yIG9sZCBzaWduYXR1cmVzXG5cdFx0XHRpZiAoIGZuLmxlbmd0aCA+IDEgKSB7XG5cdFx0XHRcdGFyZ3MgPSBbIHBzZXVkbywgcHNldWRvLCBcIlwiLCBhcmd1bWVudCBdO1xuXHRcdFx0XHRyZXR1cm4gRXhwci5zZXRGaWx0ZXJzLmhhc093blByb3BlcnR5KCBwc2V1ZG8udG9Mb3dlckNhc2UoKSApID9cblx0XHRcdFx0XHRtYXJrRnVuY3Rpb24oZnVuY3Rpb24oIHNlZWQsIG1hdGNoZXMgKSB7XG5cdFx0XHRcdFx0XHR2YXIgaWR4LFxuXHRcdFx0XHRcdFx0XHRtYXRjaGVkID0gZm4oIHNlZWQsIGFyZ3VtZW50ICksXG5cdFx0XHRcdFx0XHRcdGkgPSBtYXRjaGVkLmxlbmd0aDtcblx0XHRcdFx0XHRcdHdoaWxlICggaS0tICkge1xuXHRcdFx0XHRcdFx0XHRpZHggPSBpbmRleE9mLmNhbGwoIHNlZWQsIG1hdGNoZWRbaV0gKTtcblx0XHRcdFx0XHRcdFx0c2VlZFsgaWR4IF0gPSAhKCBtYXRjaGVzWyBpZHggXSA9IG1hdGNoZWRbaV0gKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KSA6XG5cdFx0XHRcdFx0ZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gZm4oIGVsZW0sIDAsIGFyZ3MgKTtcblx0XHRcdFx0XHR9O1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gZm47XG5cdFx0fVxuXHR9LFxuXG5cdHBzZXVkb3M6IHtcblx0XHQvLyBQb3RlbnRpYWxseSBjb21wbGV4IHBzZXVkb3Ncblx0XHRcIm5vdFwiOiBtYXJrRnVuY3Rpb24oZnVuY3Rpb24oIHNlbGVjdG9yICkge1xuXHRcdFx0Ly8gVHJpbSB0aGUgc2VsZWN0b3IgcGFzc2VkIHRvIGNvbXBpbGVcblx0XHRcdC8vIHRvIGF2b2lkIHRyZWF0aW5nIGxlYWRpbmcgYW5kIHRyYWlsaW5nXG5cdFx0XHQvLyBzcGFjZXMgYXMgY29tYmluYXRvcnNcblx0XHRcdHZhciBpbnB1dCA9IFtdLFxuXHRcdFx0XHRyZXN1bHRzID0gW10sXG5cdFx0XHRcdG1hdGNoZXIgPSBjb21waWxlKCBzZWxlY3Rvci5yZXBsYWNlKCBydHJpbSwgXCIkMVwiICkgKTtcblxuXHRcdFx0cmV0dXJuIG1hdGNoZXJbIGV4cGFuZG8gXSA/XG5cdFx0XHRcdG1hcmtGdW5jdGlvbihmdW5jdGlvbiggc2VlZCwgbWF0Y2hlcywgY29udGV4dCwgeG1sICkge1xuXHRcdFx0XHRcdHZhciBlbGVtLFxuXHRcdFx0XHRcdFx0dW5tYXRjaGVkID0gbWF0Y2hlciggc2VlZCwgbnVsbCwgeG1sLCBbXSApLFxuXHRcdFx0XHRcdFx0aSA9IHNlZWQubGVuZ3RoO1xuXG5cdFx0XHRcdFx0Ly8gTWF0Y2ggZWxlbWVudHMgdW5tYXRjaGVkIGJ5IGBtYXRjaGVyYFxuXHRcdFx0XHRcdHdoaWxlICggaS0tICkge1xuXHRcdFx0XHRcdFx0aWYgKCAoZWxlbSA9IHVubWF0Y2hlZFtpXSkgKSB7XG5cdFx0XHRcdFx0XHRcdHNlZWRbaV0gPSAhKG1hdGNoZXNbaV0gPSBlbGVtKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pIDpcblx0XHRcdFx0ZnVuY3Rpb24oIGVsZW0sIGNvbnRleHQsIHhtbCApIHtcblx0XHRcdFx0XHRpbnB1dFswXSA9IGVsZW07XG5cdFx0XHRcdFx0bWF0Y2hlciggaW5wdXQsIG51bGwsIHhtbCwgcmVzdWx0cyApO1xuXHRcdFx0XHRcdHJldHVybiAhcmVzdWx0cy5wb3AoKTtcblx0XHRcdFx0fTtcblx0XHR9KSxcblxuXHRcdFwiaGFzXCI6IG1hcmtGdW5jdGlvbihmdW5jdGlvbiggc2VsZWN0b3IgKSB7XG5cdFx0XHRyZXR1cm4gZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRcdHJldHVybiBTaXp6bGUoIHNlbGVjdG9yLCBlbGVtICkubGVuZ3RoID4gMDtcblx0XHRcdH07XG5cdFx0fSksXG5cblx0XHRcImNvbnRhaW5zXCI6IG1hcmtGdW5jdGlvbihmdW5jdGlvbiggdGV4dCApIHtcblx0XHRcdHJldHVybiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdFx0cmV0dXJuICggZWxlbS50ZXh0Q29udGVudCB8fCBlbGVtLmlubmVyVGV4dCB8fCBnZXRUZXh0KCBlbGVtICkgKS5pbmRleE9mKCB0ZXh0ICkgPiAtMTtcblx0XHRcdH07XG5cdFx0fSksXG5cblx0XHQvLyBcIldoZXRoZXIgYW4gZWxlbWVudCBpcyByZXByZXNlbnRlZCBieSBhIDpsYW5nKCkgc2VsZWN0b3Jcblx0XHQvLyBpcyBiYXNlZCBzb2xlbHkgb24gdGhlIGVsZW1lbnQncyBsYW5ndWFnZSB2YWx1ZVxuXHRcdC8vIGJlaW5nIGVxdWFsIHRvIHRoZSBpZGVudGlmaWVyIEMsXG5cdFx0Ly8gb3IgYmVnaW5uaW5nIHdpdGggdGhlIGlkZW50aWZpZXIgQyBpbW1lZGlhdGVseSBmb2xsb3dlZCBieSBcIi1cIi5cblx0XHQvLyBUaGUgbWF0Y2hpbmcgb2YgQyBhZ2FpbnN0IHRoZSBlbGVtZW50J3MgbGFuZ3VhZ2UgdmFsdWUgaXMgcGVyZm9ybWVkIGNhc2UtaW5zZW5zaXRpdmVseS5cblx0XHQvLyBUaGUgaWRlbnRpZmllciBDIGRvZXMgbm90IGhhdmUgdG8gYmUgYSB2YWxpZCBsYW5ndWFnZSBuYW1lLlwiXG5cdFx0Ly8gaHR0cDovL3d3dy53My5vcmcvVFIvc2VsZWN0b3JzLyNsYW5nLXBzZXVkb1xuXHRcdFwibGFuZ1wiOiBtYXJrRnVuY3Rpb24oIGZ1bmN0aW9uKCBsYW5nICkge1xuXHRcdFx0Ly8gbGFuZyB2YWx1ZSBtdXN0IGJlIGEgdmFsaWQgaWRlbnRpZmllclxuXHRcdFx0aWYgKCAhcmlkZW50aWZpZXIudGVzdChsYW5nIHx8IFwiXCIpICkge1xuXHRcdFx0XHRTaXp6bGUuZXJyb3IoIFwidW5zdXBwb3J0ZWQgbGFuZzogXCIgKyBsYW5nICk7XG5cdFx0XHR9XG5cdFx0XHRsYW5nID0gbGFuZy5yZXBsYWNlKCBydW5lc2NhcGUsIGZ1bmVzY2FwZSApLnRvTG93ZXJDYXNlKCk7XG5cdFx0XHRyZXR1cm4gZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRcdHZhciBlbGVtTGFuZztcblx0XHRcdFx0ZG8ge1xuXHRcdFx0XHRcdGlmICggKGVsZW1MYW5nID0gZG9jdW1lbnRJc0hUTUwgP1xuXHRcdFx0XHRcdFx0ZWxlbS5sYW5nIDpcblx0XHRcdFx0XHRcdGVsZW0uZ2V0QXR0cmlidXRlKFwieG1sOmxhbmdcIikgfHwgZWxlbS5nZXRBdHRyaWJ1dGUoXCJsYW5nXCIpKSApIHtcblxuXHRcdFx0XHRcdFx0ZWxlbUxhbmcgPSBlbGVtTGFuZy50b0xvd2VyQ2FzZSgpO1xuXHRcdFx0XHRcdFx0cmV0dXJuIGVsZW1MYW5nID09PSBsYW5nIHx8IGVsZW1MYW5nLmluZGV4T2YoIGxhbmcgKyBcIi1cIiApID09PSAwO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSB3aGlsZSAoIChlbGVtID0gZWxlbS5wYXJlbnROb2RlKSAmJiBlbGVtLm5vZGVUeXBlID09PSAxICk7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH07XG5cdFx0fSksXG5cblx0XHQvLyBNaXNjZWxsYW5lb3VzXG5cdFx0XCJ0YXJnZXRcIjogZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHR2YXIgaGFzaCA9IHdpbmRvdy5sb2NhdGlvbiAmJiB3aW5kb3cubG9jYXRpb24uaGFzaDtcblx0XHRcdHJldHVybiBoYXNoICYmIGhhc2guc2xpY2UoIDEgKSA9PT0gZWxlbS5pZDtcblx0XHR9LFxuXG5cdFx0XCJyb290XCI6IGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0cmV0dXJuIGVsZW0gPT09IGRvY0VsZW07XG5cdFx0fSxcblxuXHRcdFwiZm9jdXNcIjogZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRyZXR1cm4gZWxlbSA9PT0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudCAmJiAoIWRvY3VtZW50Lmhhc0ZvY3VzIHx8IGRvY3VtZW50Lmhhc0ZvY3VzKCkpICYmICEhKGVsZW0udHlwZSB8fCBlbGVtLmhyZWYgfHwgfmVsZW0udGFiSW5kZXgpO1xuXHRcdH0sXG5cblx0XHQvLyBCb29sZWFuIHByb3BlcnRpZXNcblx0XHRcImVuYWJsZWRcIjogZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRyZXR1cm4gZWxlbS5kaXNhYmxlZCA9PT0gZmFsc2U7XG5cdFx0fSxcblxuXHRcdFwiZGlzYWJsZWRcIjogZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRyZXR1cm4gZWxlbS5kaXNhYmxlZCA9PT0gdHJ1ZTtcblx0XHR9LFxuXG5cdFx0XCJjaGVja2VkXCI6IGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0Ly8gSW4gQ1NTMywgOmNoZWNrZWQgc2hvdWxkIHJldHVybiBib3RoIGNoZWNrZWQgYW5kIHNlbGVjdGVkIGVsZW1lbnRzXG5cdFx0XHQvLyBodHRwOi8vd3d3LnczLm9yZy9UUi8yMDExL1JFQy1jc3MzLXNlbGVjdG9ycy0yMDExMDkyOS8jY2hlY2tlZFxuXHRcdFx0dmFyIG5vZGVOYW1lID0gZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO1xuXHRcdFx0cmV0dXJuIChub2RlTmFtZSA9PT0gXCJpbnB1dFwiICYmICEhZWxlbS5jaGVja2VkKSB8fCAobm9kZU5hbWUgPT09IFwib3B0aW9uXCIgJiYgISFlbGVtLnNlbGVjdGVkKTtcblx0XHR9LFxuXG5cdFx0XCJzZWxlY3RlZFwiOiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdC8vIEFjY2Vzc2luZyB0aGlzIHByb3BlcnR5IG1ha2VzIHNlbGVjdGVkLWJ5LWRlZmF1bHRcblx0XHRcdC8vIG9wdGlvbnMgaW4gU2FmYXJpIHdvcmsgcHJvcGVybHlcblx0XHRcdGlmICggZWxlbS5wYXJlbnROb2RlICkge1xuXHRcdFx0XHRlbGVtLnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleDtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIGVsZW0uc2VsZWN0ZWQgPT09IHRydWU7XG5cdFx0fSxcblxuXHRcdC8vIENvbnRlbnRzXG5cdFx0XCJlbXB0eVwiOiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdC8vIGh0dHA6Ly93d3cudzMub3JnL1RSL3NlbGVjdG9ycy8jZW1wdHktcHNldWRvXG5cdFx0XHQvLyA6ZW1wdHkgaXMgbmVnYXRlZCBieSBlbGVtZW50ICgxKSBvciBjb250ZW50IG5vZGVzICh0ZXh0OiAzOyBjZGF0YTogNDsgZW50aXR5IHJlZjogNSksXG5cdFx0XHQvLyAgIGJ1dCBub3QgYnkgb3RoZXJzIChjb21tZW50OiA4OyBwcm9jZXNzaW5nIGluc3RydWN0aW9uOiA3OyBldGMuKVxuXHRcdFx0Ly8gbm9kZVR5cGUgPCA2IHdvcmtzIGJlY2F1c2UgYXR0cmlidXRlcyAoMikgZG8gbm90IGFwcGVhciBhcyBjaGlsZHJlblxuXHRcdFx0Zm9yICggZWxlbSA9IGVsZW0uZmlyc3RDaGlsZDsgZWxlbTsgZWxlbSA9IGVsZW0ubmV4dFNpYmxpbmcgKSB7XG5cdFx0XHRcdGlmICggZWxlbS5ub2RlVHlwZSA8IDYgKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9LFxuXG5cdFx0XCJwYXJlbnRcIjogZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRyZXR1cm4gIUV4cHIucHNldWRvc1tcImVtcHR5XCJdKCBlbGVtICk7XG5cdFx0fSxcblxuXHRcdC8vIEVsZW1lbnQvaW5wdXQgdHlwZXNcblx0XHRcImhlYWRlclwiOiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdHJldHVybiByaGVhZGVyLnRlc3QoIGVsZW0ubm9kZU5hbWUgKTtcblx0XHR9LFxuXG5cdFx0XCJpbnB1dFwiOiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdHJldHVybiByaW5wdXRzLnRlc3QoIGVsZW0ubm9kZU5hbWUgKTtcblx0XHR9LFxuXG5cdFx0XCJidXR0b25cIjogZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHR2YXIgbmFtZSA9IGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtcblx0XHRcdHJldHVybiBuYW1lID09PSBcImlucHV0XCIgJiYgZWxlbS50eXBlID09PSBcImJ1dHRvblwiIHx8IG5hbWUgPT09IFwiYnV0dG9uXCI7XG5cdFx0fSxcblxuXHRcdFwidGV4dFwiOiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdHZhciBhdHRyO1xuXHRcdFx0cmV0dXJuIGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gXCJpbnB1dFwiICYmXG5cdFx0XHRcdGVsZW0udHlwZSA9PT0gXCJ0ZXh0XCIgJiZcblxuXHRcdFx0XHQvLyBTdXBwb3J0OiBJRTw4XG5cdFx0XHRcdC8vIE5ldyBIVE1MNSBhdHRyaWJ1dGUgdmFsdWVzIChlLmcuLCBcInNlYXJjaFwiKSBhcHBlYXIgd2l0aCBlbGVtLnR5cGUgPT09IFwidGV4dFwiXG5cdFx0XHRcdCggKGF0dHIgPSBlbGVtLmdldEF0dHJpYnV0ZShcInR5cGVcIikpID09IG51bGwgfHwgYXR0ci50b0xvd2VyQ2FzZSgpID09PSBcInRleHRcIiApO1xuXHRcdH0sXG5cblx0XHQvLyBQb3NpdGlvbi1pbi1jb2xsZWN0aW9uXG5cdFx0XCJmaXJzdFwiOiBjcmVhdGVQb3NpdGlvbmFsUHNldWRvKGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIFsgMCBdO1xuXHRcdH0pLFxuXG5cdFx0XCJsYXN0XCI6IGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZnVuY3Rpb24oIG1hdGNoSW5kZXhlcywgbGVuZ3RoICkge1xuXHRcdFx0cmV0dXJuIFsgbGVuZ3RoIC0gMSBdO1xuXHRcdH0pLFxuXG5cdFx0XCJlcVwiOiBjcmVhdGVQb3NpdGlvbmFsUHNldWRvKGZ1bmN0aW9uKCBtYXRjaEluZGV4ZXMsIGxlbmd0aCwgYXJndW1lbnQgKSB7XG5cdFx0XHRyZXR1cm4gWyBhcmd1bWVudCA8IDAgPyBhcmd1bWVudCArIGxlbmd0aCA6IGFyZ3VtZW50IF07XG5cdFx0fSksXG5cblx0XHRcImV2ZW5cIjogY3JlYXRlUG9zaXRpb25hbFBzZXVkbyhmdW5jdGlvbiggbWF0Y2hJbmRleGVzLCBsZW5ndGggKSB7XG5cdFx0XHR2YXIgaSA9IDA7XG5cdFx0XHRmb3IgKCA7IGkgPCBsZW5ndGg7IGkgKz0gMiApIHtcblx0XHRcdFx0bWF0Y2hJbmRleGVzLnB1c2goIGkgKTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBtYXRjaEluZGV4ZXM7XG5cdFx0fSksXG5cblx0XHRcIm9kZFwiOiBjcmVhdGVQb3NpdGlvbmFsUHNldWRvKGZ1bmN0aW9uKCBtYXRjaEluZGV4ZXMsIGxlbmd0aCApIHtcblx0XHRcdHZhciBpID0gMTtcblx0XHRcdGZvciAoIDsgaSA8IGxlbmd0aDsgaSArPSAyICkge1xuXHRcdFx0XHRtYXRjaEluZGV4ZXMucHVzaCggaSApO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIG1hdGNoSW5kZXhlcztcblx0XHR9KSxcblxuXHRcdFwibHRcIjogY3JlYXRlUG9zaXRpb25hbFBzZXVkbyhmdW5jdGlvbiggbWF0Y2hJbmRleGVzLCBsZW5ndGgsIGFyZ3VtZW50ICkge1xuXHRcdFx0dmFyIGkgPSBhcmd1bWVudCA8IDAgPyBhcmd1bWVudCArIGxlbmd0aCA6IGFyZ3VtZW50O1xuXHRcdFx0Zm9yICggOyAtLWkgPj0gMDsgKSB7XG5cdFx0XHRcdG1hdGNoSW5kZXhlcy5wdXNoKCBpICk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gbWF0Y2hJbmRleGVzO1xuXHRcdH0pLFxuXG5cdFx0XCJndFwiOiBjcmVhdGVQb3NpdGlvbmFsUHNldWRvKGZ1bmN0aW9uKCBtYXRjaEluZGV4ZXMsIGxlbmd0aCwgYXJndW1lbnQgKSB7XG5cdFx0XHR2YXIgaSA9IGFyZ3VtZW50IDwgMCA/IGFyZ3VtZW50ICsgbGVuZ3RoIDogYXJndW1lbnQ7XG5cdFx0XHRmb3IgKCA7ICsraSA8IGxlbmd0aDsgKSB7XG5cdFx0XHRcdG1hdGNoSW5kZXhlcy5wdXNoKCBpICk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gbWF0Y2hJbmRleGVzO1xuXHRcdH0pXG5cdH1cbn07XG5cbkV4cHIucHNldWRvc1tcIm50aFwiXSA9IEV4cHIucHNldWRvc1tcImVxXCJdO1xuXG4vLyBBZGQgYnV0dG9uL2lucHV0IHR5cGUgcHNldWRvc1xuZm9yICggaSBpbiB7IHJhZGlvOiB0cnVlLCBjaGVja2JveDogdHJ1ZSwgZmlsZTogdHJ1ZSwgcGFzc3dvcmQ6IHRydWUsIGltYWdlOiB0cnVlIH0gKSB7XG5cdEV4cHIucHNldWRvc1sgaSBdID0gY3JlYXRlSW5wdXRQc2V1ZG8oIGkgKTtcbn1cbmZvciAoIGkgaW4geyBzdWJtaXQ6IHRydWUsIHJlc2V0OiB0cnVlIH0gKSB7XG5cdEV4cHIucHNldWRvc1sgaSBdID0gY3JlYXRlQnV0dG9uUHNldWRvKCBpICk7XG59XG5cbi8vIEVhc3kgQVBJIGZvciBjcmVhdGluZyBuZXcgc2V0RmlsdGVyc1xuZnVuY3Rpb24gc2V0RmlsdGVycygpIHt9XG5zZXRGaWx0ZXJzLnByb3RvdHlwZSA9IEV4cHIuZmlsdGVycyA9IEV4cHIucHNldWRvcztcbkV4cHIuc2V0RmlsdGVycyA9IG5ldyBzZXRGaWx0ZXJzKCk7XG5cbnRva2VuaXplID0gU2l6emxlLnRva2VuaXplID0gZnVuY3Rpb24oIHNlbGVjdG9yLCBwYXJzZU9ubHkgKSB7XG5cdHZhciBtYXRjaGVkLCBtYXRjaCwgdG9rZW5zLCB0eXBlLFxuXHRcdHNvRmFyLCBncm91cHMsIHByZUZpbHRlcnMsXG5cdFx0Y2FjaGVkID0gdG9rZW5DYWNoZVsgc2VsZWN0b3IgKyBcIiBcIiBdO1xuXG5cdGlmICggY2FjaGVkICkge1xuXHRcdHJldHVybiBwYXJzZU9ubHkgPyAwIDogY2FjaGVkLnNsaWNlKCAwICk7XG5cdH1cblxuXHRzb0ZhciA9IHNlbGVjdG9yO1xuXHRncm91cHMgPSBbXTtcblx0cHJlRmlsdGVycyA9IEV4cHIucHJlRmlsdGVyO1xuXG5cdHdoaWxlICggc29GYXIgKSB7XG5cblx0XHQvLyBDb21tYSBhbmQgZmlyc3QgcnVuXG5cdFx0aWYgKCAhbWF0Y2hlZCB8fCAobWF0Y2ggPSByY29tbWEuZXhlYyggc29GYXIgKSkgKSB7XG5cdFx0XHRpZiAoIG1hdGNoICkge1xuXHRcdFx0XHQvLyBEb24ndCBjb25zdW1lIHRyYWlsaW5nIGNvbW1hcyBhcyB2YWxpZFxuXHRcdFx0XHRzb0ZhciA9IHNvRmFyLnNsaWNlKCBtYXRjaFswXS5sZW5ndGggKSB8fCBzb0Zhcjtcblx0XHRcdH1cblx0XHRcdGdyb3Vwcy5wdXNoKCAodG9rZW5zID0gW10pICk7XG5cdFx0fVxuXG5cdFx0bWF0Y2hlZCA9IGZhbHNlO1xuXG5cdFx0Ly8gQ29tYmluYXRvcnNcblx0XHRpZiAoIChtYXRjaCA9IHJjb21iaW5hdG9ycy5leGVjKCBzb0ZhciApKSApIHtcblx0XHRcdG1hdGNoZWQgPSBtYXRjaC5zaGlmdCgpO1xuXHRcdFx0dG9rZW5zLnB1c2goe1xuXHRcdFx0XHR2YWx1ZTogbWF0Y2hlZCxcblx0XHRcdFx0Ly8gQ2FzdCBkZXNjZW5kYW50IGNvbWJpbmF0b3JzIHRvIHNwYWNlXG5cdFx0XHRcdHR5cGU6IG1hdGNoWzBdLnJlcGxhY2UoIHJ0cmltLCBcIiBcIiApXG5cdFx0XHR9KTtcblx0XHRcdHNvRmFyID0gc29GYXIuc2xpY2UoIG1hdGNoZWQubGVuZ3RoICk7XG5cdFx0fVxuXG5cdFx0Ly8gRmlsdGVyc1xuXHRcdGZvciAoIHR5cGUgaW4gRXhwci5maWx0ZXIgKSB7XG5cdFx0XHRpZiAoIChtYXRjaCA9IG1hdGNoRXhwclsgdHlwZSBdLmV4ZWMoIHNvRmFyICkpICYmICghcHJlRmlsdGVyc1sgdHlwZSBdIHx8XG5cdFx0XHRcdChtYXRjaCA9IHByZUZpbHRlcnNbIHR5cGUgXSggbWF0Y2ggKSkpICkge1xuXHRcdFx0XHRtYXRjaGVkID0gbWF0Y2guc2hpZnQoKTtcblx0XHRcdFx0dG9rZW5zLnB1c2goe1xuXHRcdFx0XHRcdHZhbHVlOiBtYXRjaGVkLFxuXHRcdFx0XHRcdHR5cGU6IHR5cGUsXG5cdFx0XHRcdFx0bWF0Y2hlczogbWF0Y2hcblx0XHRcdFx0fSk7XG5cdFx0XHRcdHNvRmFyID0gc29GYXIuc2xpY2UoIG1hdGNoZWQubGVuZ3RoICk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYgKCAhbWF0Y2hlZCApIHtcblx0XHRcdGJyZWFrO1xuXHRcdH1cblx0fVxuXG5cdC8vIFJldHVybiB0aGUgbGVuZ3RoIG9mIHRoZSBpbnZhbGlkIGV4Y2Vzc1xuXHQvLyBpZiB3ZSdyZSBqdXN0IHBhcnNpbmdcblx0Ly8gT3RoZXJ3aXNlLCB0aHJvdyBhbiBlcnJvciBvciByZXR1cm4gdG9rZW5zXG5cdHJldHVybiBwYXJzZU9ubHkgP1xuXHRcdHNvRmFyLmxlbmd0aCA6XG5cdFx0c29GYXIgP1xuXHRcdFx0U2l6emxlLmVycm9yKCBzZWxlY3RvciApIDpcblx0XHRcdC8vIENhY2hlIHRoZSB0b2tlbnNcblx0XHRcdHRva2VuQ2FjaGUoIHNlbGVjdG9yLCBncm91cHMgKS5zbGljZSggMCApO1xufTtcblxuZnVuY3Rpb24gdG9TZWxlY3RvciggdG9rZW5zICkge1xuXHR2YXIgaSA9IDAsXG5cdFx0bGVuID0gdG9rZW5zLmxlbmd0aCxcblx0XHRzZWxlY3RvciA9IFwiXCI7XG5cdGZvciAoIDsgaSA8IGxlbjsgaSsrICkge1xuXHRcdHNlbGVjdG9yICs9IHRva2Vuc1tpXS52YWx1ZTtcblx0fVxuXHRyZXR1cm4gc2VsZWN0b3I7XG59XG5cbmZ1bmN0aW9uIGFkZENvbWJpbmF0b3IoIG1hdGNoZXIsIGNvbWJpbmF0b3IsIGJhc2UgKSB7XG5cdHZhciBkaXIgPSBjb21iaW5hdG9yLmRpcixcblx0XHRjaGVja05vbkVsZW1lbnRzID0gYmFzZSAmJiBkaXIgPT09IFwicGFyZW50Tm9kZVwiLFxuXHRcdGRvbmVOYW1lID0gZG9uZSsrO1xuXG5cdHJldHVybiBjb21iaW5hdG9yLmZpcnN0ID9cblx0XHQvLyBDaGVjayBhZ2FpbnN0IGNsb3Nlc3QgYW5jZXN0b3IvcHJlY2VkaW5nIGVsZW1lbnRcblx0XHRmdW5jdGlvbiggZWxlbSwgY29udGV4dCwgeG1sICkge1xuXHRcdFx0d2hpbGUgKCAoZWxlbSA9IGVsZW1bIGRpciBdKSApIHtcblx0XHRcdFx0aWYgKCBlbGVtLm5vZGVUeXBlID09PSAxIHx8IGNoZWNrTm9uRWxlbWVudHMgKSB7XG5cdFx0XHRcdFx0cmV0dXJuIG1hdGNoZXIoIGVsZW0sIGNvbnRleHQsIHhtbCApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSA6XG5cblx0XHQvLyBDaGVjayBhZ2FpbnN0IGFsbCBhbmNlc3Rvci9wcmVjZWRpbmcgZWxlbWVudHNcblx0XHRmdW5jdGlvbiggZWxlbSwgY29udGV4dCwgeG1sICkge1xuXHRcdFx0dmFyIG9sZENhY2hlLCBvdXRlckNhY2hlLFxuXHRcdFx0XHRuZXdDYWNoZSA9IFsgZGlycnVucywgZG9uZU5hbWUgXTtcblxuXHRcdFx0Ly8gV2UgY2FuJ3Qgc2V0IGFyYml0cmFyeSBkYXRhIG9uIFhNTCBub2Rlcywgc28gdGhleSBkb24ndCBiZW5lZml0IGZyb20gZGlyIGNhY2hpbmdcblx0XHRcdGlmICggeG1sICkge1xuXHRcdFx0XHR3aGlsZSAoIChlbGVtID0gZWxlbVsgZGlyIF0pICkge1xuXHRcdFx0XHRcdGlmICggZWxlbS5ub2RlVHlwZSA9PT0gMSB8fCBjaGVja05vbkVsZW1lbnRzICkge1xuXHRcdFx0XHRcdFx0aWYgKCBtYXRjaGVyKCBlbGVtLCBjb250ZXh0LCB4bWwgKSApIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR3aGlsZSAoIChlbGVtID0gZWxlbVsgZGlyIF0pICkge1xuXHRcdFx0XHRcdGlmICggZWxlbS5ub2RlVHlwZSA9PT0gMSB8fCBjaGVja05vbkVsZW1lbnRzICkge1xuXHRcdFx0XHRcdFx0b3V0ZXJDYWNoZSA9IGVsZW1bIGV4cGFuZG8gXSB8fCAoZWxlbVsgZXhwYW5kbyBdID0ge30pO1xuXHRcdFx0XHRcdFx0aWYgKCAob2xkQ2FjaGUgPSBvdXRlckNhY2hlWyBkaXIgXSkgJiZcblx0XHRcdFx0XHRcdFx0b2xkQ2FjaGVbIDAgXSA9PT0gZGlycnVucyAmJiBvbGRDYWNoZVsgMSBdID09PSBkb25lTmFtZSApIHtcblxuXHRcdFx0XHRcdFx0XHQvLyBBc3NpZ24gdG8gbmV3Q2FjaGUgc28gcmVzdWx0cyBiYWNrLXByb3BhZ2F0ZSB0byBwcmV2aW91cyBlbGVtZW50c1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gKG5ld0NhY2hlWyAyIF0gPSBvbGRDYWNoZVsgMiBdKTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdC8vIFJldXNlIG5ld2NhY2hlIHNvIHJlc3VsdHMgYmFjay1wcm9wYWdhdGUgdG8gcHJldmlvdXMgZWxlbWVudHNcblx0XHRcdFx0XHRcdFx0b3V0ZXJDYWNoZVsgZGlyIF0gPSBuZXdDYWNoZTtcblxuXHRcdFx0XHRcdFx0XHQvLyBBIG1hdGNoIG1lYW5zIHdlJ3JlIGRvbmU7IGEgZmFpbCBtZWFucyB3ZSBoYXZlIHRvIGtlZXAgY2hlY2tpbmdcblx0XHRcdFx0XHRcdFx0aWYgKCAobmV3Q2FjaGVbIDIgXSA9IG1hdGNoZXIoIGVsZW0sIGNvbnRleHQsIHhtbCApKSApIHtcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH07XG59XG5cbmZ1bmN0aW9uIGVsZW1lbnRNYXRjaGVyKCBtYXRjaGVycyApIHtcblx0cmV0dXJuIG1hdGNoZXJzLmxlbmd0aCA+IDEgP1xuXHRcdGZ1bmN0aW9uKCBlbGVtLCBjb250ZXh0LCB4bWwgKSB7XG5cdFx0XHR2YXIgaSA9IG1hdGNoZXJzLmxlbmd0aDtcblx0XHRcdHdoaWxlICggaS0tICkge1xuXHRcdFx0XHRpZiAoICFtYXRjaGVyc1tpXSggZWxlbSwgY29udGV4dCwgeG1sICkgKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9IDpcblx0XHRtYXRjaGVyc1swXTtcbn1cblxuZnVuY3Rpb24gbXVsdGlwbGVDb250ZXh0cyggc2VsZWN0b3IsIGNvbnRleHRzLCByZXN1bHRzICkge1xuXHR2YXIgaSA9IDAsXG5cdFx0bGVuID0gY29udGV4dHMubGVuZ3RoO1xuXHRmb3IgKCA7IGkgPCBsZW47IGkrKyApIHtcblx0XHRTaXp6bGUoIHNlbGVjdG9yLCBjb250ZXh0c1tpXSwgcmVzdWx0cyApO1xuXHR9XG5cdHJldHVybiByZXN1bHRzO1xufVxuXG5mdW5jdGlvbiBjb25kZW5zZSggdW5tYXRjaGVkLCBtYXAsIGZpbHRlciwgY29udGV4dCwgeG1sICkge1xuXHR2YXIgZWxlbSxcblx0XHRuZXdVbm1hdGNoZWQgPSBbXSxcblx0XHRpID0gMCxcblx0XHRsZW4gPSB1bm1hdGNoZWQubGVuZ3RoLFxuXHRcdG1hcHBlZCA9IG1hcCAhPSBudWxsO1xuXG5cdGZvciAoIDsgaSA8IGxlbjsgaSsrICkge1xuXHRcdGlmICggKGVsZW0gPSB1bm1hdGNoZWRbaV0pICkge1xuXHRcdFx0aWYgKCAhZmlsdGVyIHx8IGZpbHRlciggZWxlbSwgY29udGV4dCwgeG1sICkgKSB7XG5cdFx0XHRcdG5ld1VubWF0Y2hlZC5wdXNoKCBlbGVtICk7XG5cdFx0XHRcdGlmICggbWFwcGVkICkge1xuXHRcdFx0XHRcdG1hcC5wdXNoKCBpICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gbmV3VW5tYXRjaGVkO1xufVxuXG5mdW5jdGlvbiBzZXRNYXRjaGVyKCBwcmVGaWx0ZXIsIHNlbGVjdG9yLCBtYXRjaGVyLCBwb3N0RmlsdGVyLCBwb3N0RmluZGVyLCBwb3N0U2VsZWN0b3IgKSB7XG5cdGlmICggcG9zdEZpbHRlciAmJiAhcG9zdEZpbHRlclsgZXhwYW5kbyBdICkge1xuXHRcdHBvc3RGaWx0ZXIgPSBzZXRNYXRjaGVyKCBwb3N0RmlsdGVyICk7XG5cdH1cblx0aWYgKCBwb3N0RmluZGVyICYmICFwb3N0RmluZGVyWyBleHBhbmRvIF0gKSB7XG5cdFx0cG9zdEZpbmRlciA9IHNldE1hdGNoZXIoIHBvc3RGaW5kZXIsIHBvc3RTZWxlY3RvciApO1xuXHR9XG5cdHJldHVybiBtYXJrRnVuY3Rpb24oZnVuY3Rpb24oIHNlZWQsIHJlc3VsdHMsIGNvbnRleHQsIHhtbCApIHtcblx0XHR2YXIgdGVtcCwgaSwgZWxlbSxcblx0XHRcdHByZU1hcCA9IFtdLFxuXHRcdFx0cG9zdE1hcCA9IFtdLFxuXHRcdFx0cHJlZXhpc3RpbmcgPSByZXN1bHRzLmxlbmd0aCxcblxuXHRcdFx0Ly8gR2V0IGluaXRpYWwgZWxlbWVudHMgZnJvbSBzZWVkIG9yIGNvbnRleHRcblx0XHRcdGVsZW1zID0gc2VlZCB8fCBtdWx0aXBsZUNvbnRleHRzKCBzZWxlY3RvciB8fCBcIipcIiwgY29udGV4dC5ub2RlVHlwZSA/IFsgY29udGV4dCBdIDogY29udGV4dCwgW10gKSxcblxuXHRcdFx0Ly8gUHJlZmlsdGVyIHRvIGdldCBtYXRjaGVyIGlucHV0LCBwcmVzZXJ2aW5nIGEgbWFwIGZvciBzZWVkLXJlc3VsdHMgc3luY2hyb25pemF0aW9uXG5cdFx0XHRtYXRjaGVySW4gPSBwcmVGaWx0ZXIgJiYgKCBzZWVkIHx8ICFzZWxlY3RvciApID9cblx0XHRcdFx0Y29uZGVuc2UoIGVsZW1zLCBwcmVNYXAsIHByZUZpbHRlciwgY29udGV4dCwgeG1sICkgOlxuXHRcdFx0XHRlbGVtcyxcblxuXHRcdFx0bWF0Y2hlck91dCA9IG1hdGNoZXIgP1xuXHRcdFx0XHQvLyBJZiB3ZSBoYXZlIGEgcG9zdEZpbmRlciwgb3IgZmlsdGVyZWQgc2VlZCwgb3Igbm9uLXNlZWQgcG9zdEZpbHRlciBvciBwcmVleGlzdGluZyByZXN1bHRzLFxuXHRcdFx0XHRwb3N0RmluZGVyIHx8ICggc2VlZCA/IHByZUZpbHRlciA6IHByZWV4aXN0aW5nIHx8IHBvc3RGaWx0ZXIgKSA/XG5cblx0XHRcdFx0XHQvLyAuLi5pbnRlcm1lZGlhdGUgcHJvY2Vzc2luZyBpcyBuZWNlc3Nhcnlcblx0XHRcdFx0XHRbXSA6XG5cblx0XHRcdFx0XHQvLyAuLi5vdGhlcndpc2UgdXNlIHJlc3VsdHMgZGlyZWN0bHlcblx0XHRcdFx0XHRyZXN1bHRzIDpcblx0XHRcdFx0bWF0Y2hlckluO1xuXG5cdFx0Ly8gRmluZCBwcmltYXJ5IG1hdGNoZXNcblx0XHRpZiAoIG1hdGNoZXIgKSB7XG5cdFx0XHRtYXRjaGVyKCBtYXRjaGVySW4sIG1hdGNoZXJPdXQsIGNvbnRleHQsIHhtbCApO1xuXHRcdH1cblxuXHRcdC8vIEFwcGx5IHBvc3RGaWx0ZXJcblx0XHRpZiAoIHBvc3RGaWx0ZXIgKSB7XG5cdFx0XHR0ZW1wID0gY29uZGVuc2UoIG1hdGNoZXJPdXQsIHBvc3RNYXAgKTtcblx0XHRcdHBvc3RGaWx0ZXIoIHRlbXAsIFtdLCBjb250ZXh0LCB4bWwgKTtcblxuXHRcdFx0Ly8gVW4tbWF0Y2ggZmFpbGluZyBlbGVtZW50cyBieSBtb3ZpbmcgdGhlbSBiYWNrIHRvIG1hdGNoZXJJblxuXHRcdFx0aSA9IHRlbXAubGVuZ3RoO1xuXHRcdFx0d2hpbGUgKCBpLS0gKSB7XG5cdFx0XHRcdGlmICggKGVsZW0gPSB0ZW1wW2ldKSApIHtcblx0XHRcdFx0XHRtYXRjaGVyT3V0WyBwb3N0TWFwW2ldIF0gPSAhKG1hdGNoZXJJblsgcG9zdE1hcFtpXSBdID0gZWxlbSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZiAoIHNlZWQgKSB7XG5cdFx0XHRpZiAoIHBvc3RGaW5kZXIgfHwgcHJlRmlsdGVyICkge1xuXHRcdFx0XHRpZiAoIHBvc3RGaW5kZXIgKSB7XG5cdFx0XHRcdFx0Ly8gR2V0IHRoZSBmaW5hbCBtYXRjaGVyT3V0IGJ5IGNvbmRlbnNpbmcgdGhpcyBpbnRlcm1lZGlhdGUgaW50byBwb3N0RmluZGVyIGNvbnRleHRzXG5cdFx0XHRcdFx0dGVtcCA9IFtdO1xuXHRcdFx0XHRcdGkgPSBtYXRjaGVyT3V0Lmxlbmd0aDtcblx0XHRcdFx0XHR3aGlsZSAoIGktLSApIHtcblx0XHRcdFx0XHRcdGlmICggKGVsZW0gPSBtYXRjaGVyT3V0W2ldKSApIHtcblx0XHRcdFx0XHRcdFx0Ly8gUmVzdG9yZSBtYXRjaGVySW4gc2luY2UgZWxlbSBpcyBub3QgeWV0IGEgZmluYWwgbWF0Y2hcblx0XHRcdFx0XHRcdFx0dGVtcC5wdXNoKCAobWF0Y2hlckluW2ldID0gZWxlbSkgKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cG9zdEZpbmRlciggbnVsbCwgKG1hdGNoZXJPdXQgPSBbXSksIHRlbXAsIHhtbCApO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gTW92ZSBtYXRjaGVkIGVsZW1lbnRzIGZyb20gc2VlZCB0byByZXN1bHRzIHRvIGtlZXAgdGhlbSBzeW5jaHJvbml6ZWRcblx0XHRcdFx0aSA9IG1hdGNoZXJPdXQubGVuZ3RoO1xuXHRcdFx0XHR3aGlsZSAoIGktLSApIHtcblx0XHRcdFx0XHRpZiAoIChlbGVtID0gbWF0Y2hlck91dFtpXSkgJiZcblx0XHRcdFx0XHRcdCh0ZW1wID0gcG9zdEZpbmRlciA/IGluZGV4T2YuY2FsbCggc2VlZCwgZWxlbSApIDogcHJlTWFwW2ldKSA+IC0xICkge1xuXG5cdFx0XHRcdFx0XHRzZWVkW3RlbXBdID0gIShyZXN1bHRzW3RlbXBdID0gZWxlbSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHQvLyBBZGQgZWxlbWVudHMgdG8gcmVzdWx0cywgdGhyb3VnaCBwb3N0RmluZGVyIGlmIGRlZmluZWRcblx0XHR9IGVsc2Uge1xuXHRcdFx0bWF0Y2hlck91dCA9IGNvbmRlbnNlKFxuXHRcdFx0XHRtYXRjaGVyT3V0ID09PSByZXN1bHRzID9cblx0XHRcdFx0XHRtYXRjaGVyT3V0LnNwbGljZSggcHJlZXhpc3RpbmcsIG1hdGNoZXJPdXQubGVuZ3RoICkgOlxuXHRcdFx0XHRcdG1hdGNoZXJPdXRcblx0XHRcdCk7XG5cdFx0XHRpZiAoIHBvc3RGaW5kZXIgKSB7XG5cdFx0XHRcdHBvc3RGaW5kZXIoIG51bGwsIHJlc3VsdHMsIG1hdGNoZXJPdXQsIHhtbCApO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cHVzaC5hcHBseSggcmVzdWx0cywgbWF0Y2hlck91dCApO1xuXHRcdFx0fVxuXHRcdH1cblx0fSk7XG59XG5cbmZ1bmN0aW9uIG1hdGNoZXJGcm9tVG9rZW5zKCB0b2tlbnMgKSB7XG5cdHZhciBjaGVja0NvbnRleHQsIG1hdGNoZXIsIGosXG5cdFx0bGVuID0gdG9rZW5zLmxlbmd0aCxcblx0XHRsZWFkaW5nUmVsYXRpdmUgPSBFeHByLnJlbGF0aXZlWyB0b2tlbnNbMF0udHlwZSBdLFxuXHRcdGltcGxpY2l0UmVsYXRpdmUgPSBsZWFkaW5nUmVsYXRpdmUgfHwgRXhwci5yZWxhdGl2ZVtcIiBcIl0sXG5cdFx0aSA9IGxlYWRpbmdSZWxhdGl2ZSA/IDEgOiAwLFxuXG5cdFx0Ly8gVGhlIGZvdW5kYXRpb25hbCBtYXRjaGVyIGVuc3VyZXMgdGhhdCBlbGVtZW50cyBhcmUgcmVhY2hhYmxlIGZyb20gdG9wLWxldmVsIGNvbnRleHQocylcblx0XHRtYXRjaENvbnRleHQgPSBhZGRDb21iaW5hdG9yKCBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdHJldHVybiBlbGVtID09PSBjaGVja0NvbnRleHQ7XG5cdFx0fSwgaW1wbGljaXRSZWxhdGl2ZSwgdHJ1ZSApLFxuXHRcdG1hdGNoQW55Q29udGV4dCA9IGFkZENvbWJpbmF0b3IoIGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0cmV0dXJuIGluZGV4T2YuY2FsbCggY2hlY2tDb250ZXh0LCBlbGVtICkgPiAtMTtcblx0XHR9LCBpbXBsaWNpdFJlbGF0aXZlLCB0cnVlICksXG5cdFx0bWF0Y2hlcnMgPSBbIGZ1bmN0aW9uKCBlbGVtLCBjb250ZXh0LCB4bWwgKSB7XG5cdFx0XHRyZXR1cm4gKCAhbGVhZGluZ1JlbGF0aXZlICYmICggeG1sIHx8IGNvbnRleHQgIT09IG91dGVybW9zdENvbnRleHQgKSApIHx8IChcblx0XHRcdFx0KGNoZWNrQ29udGV4dCA9IGNvbnRleHQpLm5vZGVUeXBlID9cblx0XHRcdFx0XHRtYXRjaENvbnRleHQoIGVsZW0sIGNvbnRleHQsIHhtbCApIDpcblx0XHRcdFx0XHRtYXRjaEFueUNvbnRleHQoIGVsZW0sIGNvbnRleHQsIHhtbCApICk7XG5cdFx0fSBdO1xuXG5cdGZvciAoIDsgaSA8IGxlbjsgaSsrICkge1xuXHRcdGlmICggKG1hdGNoZXIgPSBFeHByLnJlbGF0aXZlWyB0b2tlbnNbaV0udHlwZSBdKSApIHtcblx0XHRcdG1hdGNoZXJzID0gWyBhZGRDb21iaW5hdG9yKGVsZW1lbnRNYXRjaGVyKCBtYXRjaGVycyApLCBtYXRjaGVyKSBdO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRtYXRjaGVyID0gRXhwci5maWx0ZXJbIHRva2Vuc1tpXS50eXBlIF0uYXBwbHkoIG51bGwsIHRva2Vuc1tpXS5tYXRjaGVzICk7XG5cblx0XHRcdC8vIFJldHVybiBzcGVjaWFsIHVwb24gc2VlaW5nIGEgcG9zaXRpb25hbCBtYXRjaGVyXG5cdFx0XHRpZiAoIG1hdGNoZXJbIGV4cGFuZG8gXSApIHtcblx0XHRcdFx0Ly8gRmluZCB0aGUgbmV4dCByZWxhdGl2ZSBvcGVyYXRvciAoaWYgYW55KSBmb3IgcHJvcGVyIGhhbmRsaW5nXG5cdFx0XHRcdGogPSArK2k7XG5cdFx0XHRcdGZvciAoIDsgaiA8IGxlbjsgaisrICkge1xuXHRcdFx0XHRcdGlmICggRXhwci5yZWxhdGl2ZVsgdG9rZW5zW2pdLnR5cGUgXSApIHtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gc2V0TWF0Y2hlcihcblx0XHRcdFx0XHRpID4gMSAmJiBlbGVtZW50TWF0Y2hlciggbWF0Y2hlcnMgKSxcblx0XHRcdFx0XHRpID4gMSAmJiB0b1NlbGVjdG9yKFxuXHRcdFx0XHRcdFx0Ly8gSWYgdGhlIHByZWNlZGluZyB0b2tlbiB3YXMgYSBkZXNjZW5kYW50IGNvbWJpbmF0b3IsIGluc2VydCBhbiBpbXBsaWNpdCBhbnktZWxlbWVudCBgKmBcblx0XHRcdFx0XHRcdHRva2Vucy5zbGljZSggMCwgaSAtIDEgKS5jb25jYXQoeyB2YWx1ZTogdG9rZW5zWyBpIC0gMiBdLnR5cGUgPT09IFwiIFwiID8gXCIqXCIgOiBcIlwiIH0pXG5cdFx0XHRcdFx0KS5yZXBsYWNlKCBydHJpbSwgXCIkMVwiICksXG5cdFx0XHRcdFx0bWF0Y2hlcixcblx0XHRcdFx0XHRpIDwgaiAmJiBtYXRjaGVyRnJvbVRva2VucyggdG9rZW5zLnNsaWNlKCBpLCBqICkgKSxcblx0XHRcdFx0XHRqIDwgbGVuICYmIG1hdGNoZXJGcm9tVG9rZW5zKCAodG9rZW5zID0gdG9rZW5zLnNsaWNlKCBqICkpICksXG5cdFx0XHRcdFx0aiA8IGxlbiAmJiB0b1NlbGVjdG9yKCB0b2tlbnMgKVxuXHRcdFx0XHQpO1xuXHRcdFx0fVxuXHRcdFx0bWF0Y2hlcnMucHVzaCggbWF0Y2hlciApO1xuXHRcdH1cblx0fVxuXG5cdHJldHVybiBlbGVtZW50TWF0Y2hlciggbWF0Y2hlcnMgKTtcbn1cblxuZnVuY3Rpb24gbWF0Y2hlckZyb21Hcm91cE1hdGNoZXJzKCBlbGVtZW50TWF0Y2hlcnMsIHNldE1hdGNoZXJzICkge1xuXHR2YXIgYnlTZXQgPSBzZXRNYXRjaGVycy5sZW5ndGggPiAwLFxuXHRcdGJ5RWxlbWVudCA9IGVsZW1lbnRNYXRjaGVycy5sZW5ndGggPiAwLFxuXHRcdHN1cGVyTWF0Y2hlciA9IGZ1bmN0aW9uKCBzZWVkLCBjb250ZXh0LCB4bWwsIHJlc3VsdHMsIG91dGVybW9zdCApIHtcblx0XHRcdHZhciBlbGVtLCBqLCBtYXRjaGVyLFxuXHRcdFx0XHRtYXRjaGVkQ291bnQgPSAwLFxuXHRcdFx0XHRpID0gXCIwXCIsXG5cdFx0XHRcdHVubWF0Y2hlZCA9IHNlZWQgJiYgW10sXG5cdFx0XHRcdHNldE1hdGNoZWQgPSBbXSxcblx0XHRcdFx0Y29udGV4dEJhY2t1cCA9IG91dGVybW9zdENvbnRleHQsXG5cdFx0XHRcdC8vIFdlIG11c3QgYWx3YXlzIGhhdmUgZWl0aGVyIHNlZWQgZWxlbWVudHMgb3Igb3V0ZXJtb3N0IGNvbnRleHRcblx0XHRcdFx0ZWxlbXMgPSBzZWVkIHx8IGJ5RWxlbWVudCAmJiBFeHByLmZpbmRbXCJUQUdcIl0oIFwiKlwiLCBvdXRlcm1vc3QgKSxcblx0XHRcdFx0Ly8gVXNlIGludGVnZXIgZGlycnVucyBpZmYgdGhpcyBpcyB0aGUgb3V0ZXJtb3N0IG1hdGNoZXJcblx0XHRcdFx0ZGlycnVuc1VuaXF1ZSA9IChkaXJydW5zICs9IGNvbnRleHRCYWNrdXAgPT0gbnVsbCA/IDEgOiBNYXRoLnJhbmRvbSgpIHx8IDAuMSksXG5cdFx0XHRcdGxlbiA9IGVsZW1zLmxlbmd0aDtcblxuXHRcdFx0aWYgKCBvdXRlcm1vc3QgKSB7XG5cdFx0XHRcdG91dGVybW9zdENvbnRleHQgPSBjb250ZXh0ICE9PSBkb2N1bWVudCAmJiBjb250ZXh0O1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBBZGQgZWxlbWVudHMgcGFzc2luZyBlbGVtZW50TWF0Y2hlcnMgZGlyZWN0bHkgdG8gcmVzdWx0c1xuXHRcdFx0Ly8gS2VlcCBgaWAgYSBzdHJpbmcgaWYgdGhlcmUgYXJlIG5vIGVsZW1lbnRzIHNvIGBtYXRjaGVkQ291bnRgIHdpbGwgYmUgXCIwMFwiIGJlbG93XG5cdFx0XHQvLyBTdXBwb3J0OiBJRTw5LCBTYWZhcmlcblx0XHRcdC8vIFRvbGVyYXRlIE5vZGVMaXN0IHByb3BlcnRpZXMgKElFOiBcImxlbmd0aFwiOyBTYWZhcmk6IDxudW1iZXI+KSBtYXRjaGluZyBlbGVtZW50cyBieSBpZFxuXHRcdFx0Zm9yICggOyBpICE9PSBsZW4gJiYgKGVsZW0gPSBlbGVtc1tpXSkgIT0gbnVsbDsgaSsrICkge1xuXHRcdFx0XHRpZiAoIGJ5RWxlbWVudCAmJiBlbGVtICkge1xuXHRcdFx0XHRcdGogPSAwO1xuXHRcdFx0XHRcdHdoaWxlICggKG1hdGNoZXIgPSBlbGVtZW50TWF0Y2hlcnNbaisrXSkgKSB7XG5cdFx0XHRcdFx0XHRpZiAoIG1hdGNoZXIoIGVsZW0sIGNvbnRleHQsIHhtbCApICkge1xuXHRcdFx0XHRcdFx0XHRyZXN1bHRzLnB1c2goIGVsZW0gKTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmICggb3V0ZXJtb3N0ICkge1xuXHRcdFx0XHRcdFx0ZGlycnVucyA9IGRpcnJ1bnNVbmlxdWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gVHJhY2sgdW5tYXRjaGVkIGVsZW1lbnRzIGZvciBzZXQgZmlsdGVyc1xuXHRcdFx0XHRpZiAoIGJ5U2V0ICkge1xuXHRcdFx0XHRcdC8vIFRoZXkgd2lsbCBoYXZlIGdvbmUgdGhyb3VnaCBhbGwgcG9zc2libGUgbWF0Y2hlcnNcblx0XHRcdFx0XHRpZiAoIChlbGVtID0gIW1hdGNoZXIgJiYgZWxlbSkgKSB7XG5cdFx0XHRcdFx0XHRtYXRjaGVkQ291bnQtLTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyBMZW5ndGhlbiB0aGUgYXJyYXkgZm9yIGV2ZXJ5IGVsZW1lbnQsIG1hdGNoZWQgb3Igbm90XG5cdFx0XHRcdFx0aWYgKCBzZWVkICkge1xuXHRcdFx0XHRcdFx0dW5tYXRjaGVkLnB1c2goIGVsZW0gKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly8gQXBwbHkgc2V0IGZpbHRlcnMgdG8gdW5tYXRjaGVkIGVsZW1lbnRzXG5cdFx0XHRtYXRjaGVkQ291bnQgKz0gaTtcblx0XHRcdGlmICggYnlTZXQgJiYgaSAhPT0gbWF0Y2hlZENvdW50ICkge1xuXHRcdFx0XHRqID0gMDtcblx0XHRcdFx0d2hpbGUgKCAobWF0Y2hlciA9IHNldE1hdGNoZXJzW2orK10pICkge1xuXHRcdFx0XHRcdG1hdGNoZXIoIHVubWF0Y2hlZCwgc2V0TWF0Y2hlZCwgY29udGV4dCwgeG1sICk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoIHNlZWQgKSB7XG5cdFx0XHRcdFx0Ly8gUmVpbnRlZ3JhdGUgZWxlbWVudCBtYXRjaGVzIHRvIGVsaW1pbmF0ZSB0aGUgbmVlZCBmb3Igc29ydGluZ1xuXHRcdFx0XHRcdGlmICggbWF0Y2hlZENvdW50ID4gMCApIHtcblx0XHRcdFx0XHRcdHdoaWxlICggaS0tICkge1xuXHRcdFx0XHRcdFx0XHRpZiAoICEodW5tYXRjaGVkW2ldIHx8IHNldE1hdGNoZWRbaV0pICkge1xuXHRcdFx0XHRcdFx0XHRcdHNldE1hdGNoZWRbaV0gPSBwb3AuY2FsbCggcmVzdWx0cyApO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gRGlzY2FyZCBpbmRleCBwbGFjZWhvbGRlciB2YWx1ZXMgdG8gZ2V0IG9ubHkgYWN0dWFsIG1hdGNoZXNcblx0XHRcdFx0XHRzZXRNYXRjaGVkID0gY29uZGVuc2UoIHNldE1hdGNoZWQgKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIEFkZCBtYXRjaGVzIHRvIHJlc3VsdHNcblx0XHRcdFx0cHVzaC5hcHBseSggcmVzdWx0cywgc2V0TWF0Y2hlZCApO1xuXG5cdFx0XHRcdC8vIFNlZWRsZXNzIHNldCBtYXRjaGVzIHN1Y2NlZWRpbmcgbXVsdGlwbGUgc3VjY2Vzc2Z1bCBtYXRjaGVycyBzdGlwdWxhdGUgc29ydGluZ1xuXHRcdFx0XHRpZiAoIG91dGVybW9zdCAmJiAhc2VlZCAmJiBzZXRNYXRjaGVkLmxlbmd0aCA+IDAgJiZcblx0XHRcdFx0XHQoIG1hdGNoZWRDb3VudCArIHNldE1hdGNoZXJzLmxlbmd0aCApID4gMSApIHtcblxuXHRcdFx0XHRcdFNpenpsZS51bmlxdWVTb3J0KCByZXN1bHRzICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly8gT3ZlcnJpZGUgbWFuaXB1bGF0aW9uIG9mIGdsb2JhbHMgYnkgbmVzdGVkIG1hdGNoZXJzXG5cdFx0XHRpZiAoIG91dGVybW9zdCApIHtcblx0XHRcdFx0ZGlycnVucyA9IGRpcnJ1bnNVbmlxdWU7XG5cdFx0XHRcdG91dGVybW9zdENvbnRleHQgPSBjb250ZXh0QmFja3VwO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gdW5tYXRjaGVkO1xuXHRcdH07XG5cblx0cmV0dXJuIGJ5U2V0ID9cblx0XHRtYXJrRnVuY3Rpb24oIHN1cGVyTWF0Y2hlciApIDpcblx0XHRzdXBlck1hdGNoZXI7XG59XG5cbmNvbXBpbGUgPSBTaXp6bGUuY29tcGlsZSA9IGZ1bmN0aW9uKCBzZWxlY3RvciwgbWF0Y2ggLyogSW50ZXJuYWwgVXNlIE9ubHkgKi8gKSB7XG5cdHZhciBpLFxuXHRcdHNldE1hdGNoZXJzID0gW10sXG5cdFx0ZWxlbWVudE1hdGNoZXJzID0gW10sXG5cdFx0Y2FjaGVkID0gY29tcGlsZXJDYWNoZVsgc2VsZWN0b3IgKyBcIiBcIiBdO1xuXG5cdGlmICggIWNhY2hlZCApIHtcblx0XHQvLyBHZW5lcmF0ZSBhIGZ1bmN0aW9uIG9mIHJlY3Vyc2l2ZSBmdW5jdGlvbnMgdGhhdCBjYW4gYmUgdXNlZCB0byBjaGVjayBlYWNoIGVsZW1lbnRcblx0XHRpZiAoICFtYXRjaCApIHtcblx0XHRcdG1hdGNoID0gdG9rZW5pemUoIHNlbGVjdG9yICk7XG5cdFx0fVxuXHRcdGkgPSBtYXRjaC5sZW5ndGg7XG5cdFx0d2hpbGUgKCBpLS0gKSB7XG5cdFx0XHRjYWNoZWQgPSBtYXRjaGVyRnJvbVRva2VucyggbWF0Y2hbaV0gKTtcblx0XHRcdGlmICggY2FjaGVkWyBleHBhbmRvIF0gKSB7XG5cdFx0XHRcdHNldE1hdGNoZXJzLnB1c2goIGNhY2hlZCApO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZWxlbWVudE1hdGNoZXJzLnB1c2goIGNhY2hlZCApO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIENhY2hlIHRoZSBjb21waWxlZCBmdW5jdGlvblxuXHRcdGNhY2hlZCA9IGNvbXBpbGVyQ2FjaGUoIHNlbGVjdG9yLCBtYXRjaGVyRnJvbUdyb3VwTWF0Y2hlcnMoIGVsZW1lbnRNYXRjaGVycywgc2V0TWF0Y2hlcnMgKSApO1xuXG5cdFx0Ly8gU2F2ZSBzZWxlY3RvciBhbmQgdG9rZW5pemF0aW9uXG5cdFx0Y2FjaGVkLnNlbGVjdG9yID0gc2VsZWN0b3I7XG5cdH1cblx0cmV0dXJuIGNhY2hlZDtcbn07XG5cbi8qKlxuICogQSBsb3ctbGV2ZWwgc2VsZWN0aW9uIGZ1bmN0aW9uIHRoYXQgd29ya3Mgd2l0aCBTaXp6bGUncyBjb21waWxlZFxuICogIHNlbGVjdG9yIGZ1bmN0aW9uc1xuICogQHBhcmFtIHtTdHJpbmd8RnVuY3Rpb259IHNlbGVjdG9yIEEgc2VsZWN0b3Igb3IgYSBwcmUtY29tcGlsZWRcbiAqICBzZWxlY3RvciBmdW5jdGlvbiBidWlsdCB3aXRoIFNpenpsZS5jb21waWxlXG4gKiBAcGFyYW0ge0VsZW1lbnR9IGNvbnRleHRcbiAqIEBwYXJhbSB7QXJyYXl9IFtyZXN1bHRzXVxuICogQHBhcmFtIHtBcnJheX0gW3NlZWRdIEEgc2V0IG9mIGVsZW1lbnRzIHRvIG1hdGNoIGFnYWluc3RcbiAqL1xuc2VsZWN0ID0gU2l6emxlLnNlbGVjdCA9IGZ1bmN0aW9uKCBzZWxlY3RvciwgY29udGV4dCwgcmVzdWx0cywgc2VlZCApIHtcblx0dmFyIGksIHRva2VucywgdG9rZW4sIHR5cGUsIGZpbmQsXG5cdFx0Y29tcGlsZWQgPSB0eXBlb2Ygc2VsZWN0b3IgPT09IFwiZnVuY3Rpb25cIiAmJiBzZWxlY3Rvcixcblx0XHRtYXRjaCA9ICFzZWVkICYmIHRva2VuaXplKCAoc2VsZWN0b3IgPSBjb21waWxlZC5zZWxlY3RvciB8fCBzZWxlY3RvcikgKTtcblxuXHRyZXN1bHRzID0gcmVzdWx0cyB8fCBbXTtcblxuXHQvLyBUcnkgdG8gbWluaW1pemUgb3BlcmF0aW9ucyBpZiB0aGVyZSBpcyBubyBzZWVkIGFuZCBvbmx5IG9uZSBncm91cFxuXHRpZiAoIG1hdGNoLmxlbmd0aCA9PT0gMSApIHtcblxuXHRcdC8vIFRha2UgYSBzaG9ydGN1dCBhbmQgc2V0IHRoZSBjb250ZXh0IGlmIHRoZSByb290IHNlbGVjdG9yIGlzIGFuIElEXG5cdFx0dG9rZW5zID0gbWF0Y2hbMF0gPSBtYXRjaFswXS5zbGljZSggMCApO1xuXHRcdGlmICggdG9rZW5zLmxlbmd0aCA+IDIgJiYgKHRva2VuID0gdG9rZW5zWzBdKS50eXBlID09PSBcIklEXCIgJiZcblx0XHRcdFx0c3VwcG9ydC5nZXRCeUlkICYmIGNvbnRleHQubm9kZVR5cGUgPT09IDkgJiYgZG9jdW1lbnRJc0hUTUwgJiZcblx0XHRcdFx0RXhwci5yZWxhdGl2ZVsgdG9rZW5zWzFdLnR5cGUgXSApIHtcblxuXHRcdFx0Y29udGV4dCA9ICggRXhwci5maW5kW1wiSURcIl0oIHRva2VuLm1hdGNoZXNbMF0ucmVwbGFjZShydW5lc2NhcGUsIGZ1bmVzY2FwZSksIGNvbnRleHQgKSB8fCBbXSApWzBdO1xuXHRcdFx0aWYgKCAhY29udGV4dCApIHtcblx0XHRcdFx0cmV0dXJuIHJlc3VsdHM7XG5cblx0XHRcdC8vIFByZWNvbXBpbGVkIG1hdGNoZXJzIHdpbGwgc3RpbGwgdmVyaWZ5IGFuY2VzdHJ5LCBzbyBzdGVwIHVwIGEgbGV2ZWxcblx0XHRcdH0gZWxzZSBpZiAoIGNvbXBpbGVkICkge1xuXHRcdFx0XHRjb250ZXh0ID0gY29udGV4dC5wYXJlbnROb2RlO1xuXHRcdFx0fVxuXG5cdFx0XHRzZWxlY3RvciA9IHNlbGVjdG9yLnNsaWNlKCB0b2tlbnMuc2hpZnQoKS52YWx1ZS5sZW5ndGggKTtcblx0XHR9XG5cblx0XHQvLyBGZXRjaCBhIHNlZWQgc2V0IGZvciByaWdodC10by1sZWZ0IG1hdGNoaW5nXG5cdFx0aSA9IG1hdGNoRXhwcltcIm5lZWRzQ29udGV4dFwiXS50ZXN0KCBzZWxlY3RvciApID8gMCA6IHRva2Vucy5sZW5ndGg7XG5cdFx0d2hpbGUgKCBpLS0gKSB7XG5cdFx0XHR0b2tlbiA9IHRva2Vuc1tpXTtcblxuXHRcdFx0Ly8gQWJvcnQgaWYgd2UgaGl0IGEgY29tYmluYXRvclxuXHRcdFx0aWYgKCBFeHByLnJlbGF0aXZlWyAodHlwZSA9IHRva2VuLnR5cGUpIF0gKSB7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdFx0aWYgKCAoZmluZCA9IEV4cHIuZmluZFsgdHlwZSBdKSApIHtcblx0XHRcdFx0Ly8gU2VhcmNoLCBleHBhbmRpbmcgY29udGV4dCBmb3IgbGVhZGluZyBzaWJsaW5nIGNvbWJpbmF0b3JzXG5cdFx0XHRcdGlmICggKHNlZWQgPSBmaW5kKFxuXHRcdFx0XHRcdHRva2VuLm1hdGNoZXNbMF0ucmVwbGFjZSggcnVuZXNjYXBlLCBmdW5lc2NhcGUgKSxcblx0XHRcdFx0XHRyc2libGluZy50ZXN0KCB0b2tlbnNbMF0udHlwZSApICYmIHRlc3RDb250ZXh0KCBjb250ZXh0LnBhcmVudE5vZGUgKSB8fCBjb250ZXh0XG5cdFx0XHRcdCkpICkge1xuXG5cdFx0XHRcdFx0Ly8gSWYgc2VlZCBpcyBlbXB0eSBvciBubyB0b2tlbnMgcmVtYWluLCB3ZSBjYW4gcmV0dXJuIGVhcmx5XG5cdFx0XHRcdFx0dG9rZW5zLnNwbGljZSggaSwgMSApO1xuXHRcdFx0XHRcdHNlbGVjdG9yID0gc2VlZC5sZW5ndGggJiYgdG9TZWxlY3RvciggdG9rZW5zICk7XG5cdFx0XHRcdFx0aWYgKCAhc2VsZWN0b3IgKSB7XG5cdFx0XHRcdFx0XHRwdXNoLmFwcGx5KCByZXN1bHRzLCBzZWVkICk7XG5cdFx0XHRcdFx0XHRyZXR1cm4gcmVzdWx0cztcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdC8vIENvbXBpbGUgYW5kIGV4ZWN1dGUgYSBmaWx0ZXJpbmcgZnVuY3Rpb24gaWYgb25lIGlzIG5vdCBwcm92aWRlZFxuXHQvLyBQcm92aWRlIGBtYXRjaGAgdG8gYXZvaWQgcmV0b2tlbml6YXRpb24gaWYgd2UgbW9kaWZpZWQgdGhlIHNlbGVjdG9yIGFib3ZlXG5cdCggY29tcGlsZWQgfHwgY29tcGlsZSggc2VsZWN0b3IsIG1hdGNoICkgKShcblx0XHRzZWVkLFxuXHRcdGNvbnRleHQsXG5cdFx0IWRvY3VtZW50SXNIVE1MLFxuXHRcdHJlc3VsdHMsXG5cdFx0cnNpYmxpbmcudGVzdCggc2VsZWN0b3IgKSAmJiB0ZXN0Q29udGV4dCggY29udGV4dC5wYXJlbnROb2RlICkgfHwgY29udGV4dFxuXHQpO1xuXHRyZXR1cm4gcmVzdWx0cztcbn07XG5cbi8vIE9uZS10aW1lIGFzc2lnbm1lbnRzXG5cbi8vIFNvcnQgc3RhYmlsaXR5XG5zdXBwb3J0LnNvcnRTdGFibGUgPSBleHBhbmRvLnNwbGl0KFwiXCIpLnNvcnQoIHNvcnRPcmRlciApLmpvaW4oXCJcIikgPT09IGV4cGFuZG87XG5cbi8vIFN1cHBvcnQ6IENocm9tZTwxNFxuLy8gQWx3YXlzIGFzc3VtZSBkdXBsaWNhdGVzIGlmIHRoZXkgYXJlbid0IHBhc3NlZCB0byB0aGUgY29tcGFyaXNvbiBmdW5jdGlvblxuc3VwcG9ydC5kZXRlY3REdXBsaWNhdGVzID0gISFoYXNEdXBsaWNhdGU7XG5cbi8vIEluaXRpYWxpemUgYWdhaW5zdCB0aGUgZGVmYXVsdCBkb2N1bWVudFxuc2V0RG9jdW1lbnQoKTtcblxuLy8gU3VwcG9ydDogV2Via2l0PDUzNy4zMiAtIFNhZmFyaSA2LjAuMy9DaHJvbWUgMjUgKGZpeGVkIGluIENocm9tZSAyNylcbi8vIERldGFjaGVkIG5vZGVzIGNvbmZvdW5kaW5nbHkgZm9sbG93ICplYWNoIG90aGVyKlxuc3VwcG9ydC5zb3J0RGV0YWNoZWQgPSBhc3NlcnQoZnVuY3Rpb24oIGRpdjEgKSB7XG5cdC8vIFNob3VsZCByZXR1cm4gMSwgYnV0IHJldHVybnMgNCAoZm9sbG93aW5nKVxuXHRyZXR1cm4gZGl2MS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiggZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSApICYgMTtcbn0pO1xuXG4vLyBTdXBwb3J0OiBJRTw4XG4vLyBQcmV2ZW50IGF0dHJpYnV0ZS9wcm9wZXJ0eSBcImludGVycG9sYXRpb25cIlxuLy8gaHR0cDovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L21zNTM2NDI5JTI4VlMuODUlMjkuYXNweFxuaWYgKCAhYXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7XG5cdGRpdi5pbm5lckhUTUwgPSBcIjxhIGhyZWY9JyMnPjwvYT5cIjtcblx0cmV0dXJuIGRpdi5maXJzdENoaWxkLmdldEF0dHJpYnV0ZShcImhyZWZcIikgPT09IFwiI1wiIDtcbn0pICkge1xuXHRhZGRIYW5kbGUoIFwidHlwZXxocmVmfGhlaWdodHx3aWR0aFwiLCBmdW5jdGlvbiggZWxlbSwgbmFtZSwgaXNYTUwgKSB7XG5cdFx0aWYgKCAhaXNYTUwgKSB7XG5cdFx0XHRyZXR1cm4gZWxlbS5nZXRBdHRyaWJ1dGUoIG5hbWUsIG5hbWUudG9Mb3dlckNhc2UoKSA9PT0gXCJ0eXBlXCIgPyAxIDogMiApO1xuXHRcdH1cblx0fSk7XG59XG5cbi8vIFN1cHBvcnQ6IElFPDlcbi8vIFVzZSBkZWZhdWx0VmFsdWUgaW4gcGxhY2Ugb2YgZ2V0QXR0cmlidXRlKFwidmFsdWVcIilcbmlmICggIXN1cHBvcnQuYXR0cmlidXRlcyB8fCAhYXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7XG5cdGRpdi5pbm5lckhUTUwgPSBcIjxpbnB1dC8+XCI7XG5cdGRpdi5maXJzdENoaWxkLnNldEF0dHJpYnV0ZSggXCJ2YWx1ZVwiLCBcIlwiICk7XG5cdHJldHVybiBkaXYuZmlyc3RDaGlsZC5nZXRBdHRyaWJ1dGUoIFwidmFsdWVcIiApID09PSBcIlwiO1xufSkgKSB7XG5cdGFkZEhhbmRsZSggXCJ2YWx1ZVwiLCBmdW5jdGlvbiggZWxlbSwgbmFtZSwgaXNYTUwgKSB7XG5cdFx0aWYgKCAhaXNYTUwgJiYgZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSBcImlucHV0XCIgKSB7XG5cdFx0XHRyZXR1cm4gZWxlbS5kZWZhdWx0VmFsdWU7XG5cdFx0fVxuXHR9KTtcbn1cblxuLy8gU3VwcG9ydDogSUU8OVxuLy8gVXNlIGdldEF0dHJpYnV0ZU5vZGUgdG8gZmV0Y2ggYm9vbGVhbnMgd2hlbiBnZXRBdHRyaWJ1dGUgbGllc1xuaWYgKCAhYXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7XG5cdHJldHVybiBkaXYuZ2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIikgPT0gbnVsbDtcbn0pICkge1xuXHRhZGRIYW5kbGUoIGJvb2xlYW5zLCBmdW5jdGlvbiggZWxlbSwgbmFtZSwgaXNYTUwgKSB7XG5cdFx0dmFyIHZhbDtcblx0XHRpZiAoICFpc1hNTCApIHtcblx0XHRcdHJldHVybiBlbGVtWyBuYW1lIF0gPT09IHRydWUgPyBuYW1lLnRvTG93ZXJDYXNlKCkgOlxuXHRcdFx0XHRcdCh2YWwgPSBlbGVtLmdldEF0dHJpYnV0ZU5vZGUoIG5hbWUgKSkgJiYgdmFsLnNwZWNpZmllZCA/XG5cdFx0XHRcdFx0dmFsLnZhbHVlIDpcblx0XHRcdFx0bnVsbDtcblx0XHR9XG5cdH0pO1xufVxuXG5yZXR1cm4gU2l6emxlO1xuXG59KSggd2luZG93ICk7XG5cblxuXG5qUXVlcnkuZmluZCA9IFNpenpsZTtcbmpRdWVyeS5leHByID0gU2l6emxlLnNlbGVjdG9ycztcbmpRdWVyeS5leHByW1wiOlwiXSA9IGpRdWVyeS5leHByLnBzZXVkb3M7XG5qUXVlcnkudW5pcXVlID0gU2l6emxlLnVuaXF1ZVNvcnQ7XG5qUXVlcnkudGV4dCA9IFNpenpsZS5nZXRUZXh0O1xualF1ZXJ5LmlzWE1MRG9jID0gU2l6emxlLmlzWE1MO1xualF1ZXJ5LmNvbnRhaW5zID0gU2l6emxlLmNvbnRhaW5zO1xuXG5cblxudmFyIHJuZWVkc0NvbnRleHQgPSBqUXVlcnkuZXhwci5tYXRjaC5uZWVkc0NvbnRleHQ7XG5cbnZhciByc2luZ2xlVGFnID0gKC9ePChcXHcrKVxccypcXC8/Pig/OjxcXC9cXDE+fCkkLyk7XG5cblxuXG52YXIgcmlzU2ltcGxlID0gL14uW146I1xcW1xcLixdKiQvO1xuXG4vLyBJbXBsZW1lbnQgdGhlIGlkZW50aWNhbCBmdW5jdGlvbmFsaXR5IGZvciBmaWx0ZXIgYW5kIG5vdFxuZnVuY3Rpb24gd2lubm93KCBlbGVtZW50cywgcXVhbGlmaWVyLCBub3QgKSB7XG5cdGlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIHF1YWxpZmllciApICkge1xuXHRcdHJldHVybiBqUXVlcnkuZ3JlcCggZWxlbWVudHMsIGZ1bmN0aW9uKCBlbGVtLCBpICkge1xuXHRcdFx0LyoganNoaW50IC1XMDE4ICovXG5cdFx0XHRyZXR1cm4gISFxdWFsaWZpZXIuY2FsbCggZWxlbSwgaSwgZWxlbSApICE9PSBub3Q7XG5cdFx0fSk7XG5cblx0fVxuXG5cdGlmICggcXVhbGlmaWVyLm5vZGVUeXBlICkge1xuXHRcdHJldHVybiBqUXVlcnkuZ3JlcCggZWxlbWVudHMsIGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0cmV0dXJuICggZWxlbSA9PT0gcXVhbGlmaWVyICkgIT09IG5vdDtcblx0XHR9KTtcblxuXHR9XG5cblx0aWYgKCB0eXBlb2YgcXVhbGlmaWVyID09PSBcInN0cmluZ1wiICkge1xuXHRcdGlmICggcmlzU2ltcGxlLnRlc3QoIHF1YWxpZmllciApICkge1xuXHRcdFx0cmV0dXJuIGpRdWVyeS5maWx0ZXIoIHF1YWxpZmllciwgZWxlbWVudHMsIG5vdCApO1xuXHRcdH1cblxuXHRcdHF1YWxpZmllciA9IGpRdWVyeS5maWx0ZXIoIHF1YWxpZmllciwgZWxlbWVudHMgKTtcblx0fVxuXG5cdHJldHVybiBqUXVlcnkuZ3JlcCggZWxlbWVudHMsIGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdHJldHVybiAoIGluZGV4T2YuY2FsbCggcXVhbGlmaWVyLCBlbGVtICkgPj0gMCApICE9PSBub3Q7XG5cdH0pO1xufVxuXG5qUXVlcnkuZmlsdGVyID0gZnVuY3Rpb24oIGV4cHIsIGVsZW1zLCBub3QgKSB7XG5cdHZhciBlbGVtID0gZWxlbXNbIDAgXTtcblxuXHRpZiAoIG5vdCApIHtcblx0XHRleHByID0gXCI6bm90KFwiICsgZXhwciArIFwiKVwiO1xuXHR9XG5cblx0cmV0dXJuIGVsZW1zLmxlbmd0aCA9PT0gMSAmJiBlbGVtLm5vZGVUeXBlID09PSAxID9cblx0XHRqUXVlcnkuZmluZC5tYXRjaGVzU2VsZWN0b3IoIGVsZW0sIGV4cHIgKSA/IFsgZWxlbSBdIDogW10gOlxuXHRcdGpRdWVyeS5maW5kLm1hdGNoZXMoIGV4cHIsIGpRdWVyeS5ncmVwKCBlbGVtcywgZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRyZXR1cm4gZWxlbS5ub2RlVHlwZSA9PT0gMTtcblx0XHR9KSk7XG59O1xuXG5qUXVlcnkuZm4uZXh0ZW5kKHtcblx0ZmluZDogZnVuY3Rpb24oIHNlbGVjdG9yICkge1xuXHRcdHZhciBpLFxuXHRcdFx0bGVuID0gdGhpcy5sZW5ndGgsXG5cdFx0XHRyZXQgPSBbXSxcblx0XHRcdHNlbGYgPSB0aGlzO1xuXG5cdFx0aWYgKCB0eXBlb2Ygc2VsZWN0b3IgIT09IFwic3RyaW5nXCIgKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5wdXNoU3RhY2soIGpRdWVyeSggc2VsZWN0b3IgKS5maWx0ZXIoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGZvciAoIGkgPSAwOyBpIDwgbGVuOyBpKysgKSB7XG5cdFx0XHRcdFx0aWYgKCBqUXVlcnkuY29udGFpbnMoIHNlbGZbIGkgXSwgdGhpcyApICkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9KSApO1xuXHRcdH1cblxuXHRcdGZvciAoIGkgPSAwOyBpIDwgbGVuOyBpKysgKSB7XG5cdFx0XHRqUXVlcnkuZmluZCggc2VsZWN0b3IsIHNlbGZbIGkgXSwgcmV0ICk7XG5cdFx0fVxuXG5cdFx0Ly8gTmVlZGVkIGJlY2F1c2UgJCggc2VsZWN0b3IsIGNvbnRleHQgKSBiZWNvbWVzICQoIGNvbnRleHQgKS5maW5kKCBzZWxlY3RvciApXG5cdFx0cmV0ID0gdGhpcy5wdXNoU3RhY2soIGxlbiA+IDEgPyBqUXVlcnkudW5pcXVlKCByZXQgKSA6IHJldCApO1xuXHRcdHJldC5zZWxlY3RvciA9IHRoaXMuc2VsZWN0b3IgPyB0aGlzLnNlbGVjdG9yICsgXCIgXCIgKyBzZWxlY3RvciA6IHNlbGVjdG9yO1xuXHRcdHJldHVybiByZXQ7XG5cdH0sXG5cdGZpbHRlcjogZnVuY3Rpb24oIHNlbGVjdG9yICkge1xuXHRcdHJldHVybiB0aGlzLnB1c2hTdGFjayggd2lubm93KHRoaXMsIHNlbGVjdG9yIHx8IFtdLCBmYWxzZSkgKTtcblx0fSxcblx0bm90OiBmdW5jdGlvbiggc2VsZWN0b3IgKSB7XG5cdFx0cmV0dXJuIHRoaXMucHVzaFN0YWNrKCB3aW5ub3codGhpcywgc2VsZWN0b3IgfHwgW10sIHRydWUpICk7XG5cdH0sXG5cdGlzOiBmdW5jdGlvbiggc2VsZWN0b3IgKSB7XG5cdFx0cmV0dXJuICEhd2lubm93KFxuXHRcdFx0dGhpcyxcblxuXHRcdFx0Ly8gSWYgdGhpcyBpcyBhIHBvc2l0aW9uYWwvcmVsYXRpdmUgc2VsZWN0b3IsIGNoZWNrIG1lbWJlcnNoaXAgaW4gdGhlIHJldHVybmVkIHNldFxuXHRcdFx0Ly8gc28gJChcInA6Zmlyc3RcIikuaXMoXCJwOmxhc3RcIikgd29uJ3QgcmV0dXJuIHRydWUgZm9yIGEgZG9jIHdpdGggdHdvIFwicFwiLlxuXHRcdFx0dHlwZW9mIHNlbGVjdG9yID09PSBcInN0cmluZ1wiICYmIHJuZWVkc0NvbnRleHQudGVzdCggc2VsZWN0b3IgKSA/XG5cdFx0XHRcdGpRdWVyeSggc2VsZWN0b3IgKSA6XG5cdFx0XHRcdHNlbGVjdG9yIHx8IFtdLFxuXHRcdFx0ZmFsc2Vcblx0XHQpLmxlbmd0aDtcblx0fVxufSk7XG5cblxuLy8gSW5pdGlhbGl6ZSBhIGpRdWVyeSBvYmplY3RcblxuXG4vLyBBIGNlbnRyYWwgcmVmZXJlbmNlIHRvIHRoZSByb290IGpRdWVyeShkb2N1bWVudClcbnZhciByb290alF1ZXJ5LFxuXG5cdC8vIEEgc2ltcGxlIHdheSB0byBjaGVjayBmb3IgSFRNTCBzdHJpbmdzXG5cdC8vIFByaW9yaXRpemUgI2lkIG92ZXIgPHRhZz4gdG8gYXZvaWQgWFNTIHZpYSBsb2NhdGlvbi5oYXNoICgjOTUyMSlcblx0Ly8gU3RyaWN0IEhUTUwgcmVjb2duaXRpb24gKCMxMTI5MDogbXVzdCBzdGFydCB3aXRoIDwpXG5cdHJxdWlja0V4cHIgPSAvXig/OlxccyooPFtcXHdcXFddKz4pW14+XSp8IyhbXFx3LV0qKSkkLyxcblxuXHRpbml0ID0galF1ZXJ5LmZuLmluaXQgPSBmdW5jdGlvbiggc2VsZWN0b3IsIGNvbnRleHQgKSB7XG5cdFx0dmFyIG1hdGNoLCBlbGVtO1xuXG5cdFx0Ly8gSEFORExFOiAkKFwiXCIpLCAkKG51bGwpLCAkKHVuZGVmaW5lZCksICQoZmFsc2UpXG5cdFx0aWYgKCAhc2VsZWN0b3IgKSB7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9XG5cblx0XHQvLyBIYW5kbGUgSFRNTCBzdHJpbmdzXG5cdFx0aWYgKCB0eXBlb2Ygc2VsZWN0b3IgPT09IFwic3RyaW5nXCIgKSB7XG5cdFx0XHRpZiAoIHNlbGVjdG9yWzBdID09PSBcIjxcIiAmJiBzZWxlY3Rvclsgc2VsZWN0b3IubGVuZ3RoIC0gMSBdID09PSBcIj5cIiAmJiBzZWxlY3Rvci5sZW5ndGggPj0gMyApIHtcblx0XHRcdFx0Ly8gQXNzdW1lIHRoYXQgc3RyaW5ncyB0aGF0IHN0YXJ0IGFuZCBlbmQgd2l0aCA8PiBhcmUgSFRNTCBhbmQgc2tpcCB0aGUgcmVnZXggY2hlY2tcblx0XHRcdFx0bWF0Y2ggPSBbIG51bGwsIHNlbGVjdG9yLCBudWxsIF07XG5cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG1hdGNoID0gcnF1aWNrRXhwci5leGVjKCBzZWxlY3RvciApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBNYXRjaCBodG1sIG9yIG1ha2Ugc3VyZSBubyBjb250ZXh0IGlzIHNwZWNpZmllZCBmb3IgI2lkXG5cdFx0XHRpZiAoIG1hdGNoICYmIChtYXRjaFsxXSB8fCAhY29udGV4dCkgKSB7XG5cblx0XHRcdFx0Ly8gSEFORExFOiAkKGh0bWwpIC0+ICQoYXJyYXkpXG5cdFx0XHRcdGlmICggbWF0Y2hbMV0gKSB7XG5cdFx0XHRcdFx0Y29udGV4dCA9IGNvbnRleHQgaW5zdGFuY2VvZiBqUXVlcnkgPyBjb250ZXh0WzBdIDogY29udGV4dDtcblxuXHRcdFx0XHRcdC8vIHNjcmlwdHMgaXMgdHJ1ZSBmb3IgYmFjay1jb21wYXRcblx0XHRcdFx0XHQvLyBJbnRlbnRpb25hbGx5IGxldCB0aGUgZXJyb3IgYmUgdGhyb3duIGlmIHBhcnNlSFRNTCBpcyBub3QgcHJlc2VudFxuXHRcdFx0XHRcdGpRdWVyeS5tZXJnZSggdGhpcywgalF1ZXJ5LnBhcnNlSFRNTChcblx0XHRcdFx0XHRcdG1hdGNoWzFdLFxuXHRcdFx0XHRcdFx0Y29udGV4dCAmJiBjb250ZXh0Lm5vZGVUeXBlID8gY29udGV4dC5vd25lckRvY3VtZW50IHx8IGNvbnRleHQgOiBkb2N1bWVudCxcblx0XHRcdFx0XHRcdHRydWVcblx0XHRcdFx0XHQpICk7XG5cblx0XHRcdFx0XHQvLyBIQU5ETEU6ICQoaHRtbCwgcHJvcHMpXG5cdFx0XHRcdFx0aWYgKCByc2luZ2xlVGFnLnRlc3QoIG1hdGNoWzFdICkgJiYgalF1ZXJ5LmlzUGxhaW5PYmplY3QoIGNvbnRleHQgKSApIHtcblx0XHRcdFx0XHRcdGZvciAoIG1hdGNoIGluIGNvbnRleHQgKSB7XG5cdFx0XHRcdFx0XHRcdC8vIFByb3BlcnRpZXMgb2YgY29udGV4dCBhcmUgY2FsbGVkIGFzIG1ldGhvZHMgaWYgcG9zc2libGVcblx0XHRcdFx0XHRcdFx0aWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggdGhpc1sgbWF0Y2ggXSApICkge1xuXHRcdFx0XHRcdFx0XHRcdHRoaXNbIG1hdGNoIF0oIGNvbnRleHRbIG1hdGNoIF0gKTtcblxuXHRcdFx0XHRcdFx0XHQvLyAuLi5hbmQgb3RoZXJ3aXNlIHNldCBhcyBhdHRyaWJ1dGVzXG5cdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5hdHRyKCBtYXRjaCwgY29udGV4dFsgbWF0Y2ggXSApO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cblx0XHRcdFx0Ly8gSEFORExFOiAkKCNpZClcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRlbGVtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIG1hdGNoWzJdICk7XG5cblx0XHRcdFx0XHQvLyBDaGVjayBwYXJlbnROb2RlIHRvIGNhdGNoIHdoZW4gQmxhY2tiZXJyeSA0LjYgcmV0dXJuc1xuXHRcdFx0XHRcdC8vIG5vZGVzIHRoYXQgYXJlIG5vIGxvbmdlciBpbiB0aGUgZG9jdW1lbnQgIzY5NjNcblx0XHRcdFx0XHRpZiAoIGVsZW0gJiYgZWxlbS5wYXJlbnROb2RlICkge1xuXHRcdFx0XHRcdFx0Ly8gSW5qZWN0IHRoZSBlbGVtZW50IGRpcmVjdGx5IGludG8gdGhlIGpRdWVyeSBvYmplY3Rcblx0XHRcdFx0XHRcdHRoaXMubGVuZ3RoID0gMTtcblx0XHRcdFx0XHRcdHRoaXNbMF0gPSBlbGVtO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHRoaXMuY29udGV4dCA9IGRvY3VtZW50O1xuXHRcdFx0XHRcdHRoaXMuc2VsZWN0b3IgPSBzZWxlY3Rvcjtcblx0XHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdFx0fVxuXG5cdFx0XHQvLyBIQU5ETEU6ICQoZXhwciwgJCguLi4pKVxuXHRcdFx0fSBlbHNlIGlmICggIWNvbnRleHQgfHwgY29udGV4dC5qcXVlcnkgKSB7XG5cdFx0XHRcdHJldHVybiAoIGNvbnRleHQgfHwgcm9vdGpRdWVyeSApLmZpbmQoIHNlbGVjdG9yICk7XG5cblx0XHRcdC8vIEhBTkRMRTogJChleHByLCBjb250ZXh0KVxuXHRcdFx0Ly8gKHdoaWNoIGlzIGp1c3QgZXF1aXZhbGVudCB0bzogJChjb250ZXh0KS5maW5kKGV4cHIpXG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5jb25zdHJ1Y3RvciggY29udGV4dCApLmZpbmQoIHNlbGVjdG9yICk7XG5cdFx0XHR9XG5cblx0XHQvLyBIQU5ETEU6ICQoRE9NRWxlbWVudClcblx0XHR9IGVsc2UgaWYgKCBzZWxlY3Rvci5ub2RlVHlwZSApIHtcblx0XHRcdHRoaXMuY29udGV4dCA9IHRoaXNbMF0gPSBzZWxlY3Rvcjtcblx0XHRcdHRoaXMubGVuZ3RoID0gMTtcblx0XHRcdHJldHVybiB0aGlzO1xuXG5cdFx0Ly8gSEFORExFOiAkKGZ1bmN0aW9uKVxuXHRcdC8vIFNob3J0Y3V0IGZvciBkb2N1bWVudCByZWFkeVxuXHRcdH0gZWxzZSBpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBzZWxlY3RvciApICkge1xuXHRcdFx0cmV0dXJuIHR5cGVvZiByb290alF1ZXJ5LnJlYWR5ICE9PSBcInVuZGVmaW5lZFwiID9cblx0XHRcdFx0cm9vdGpRdWVyeS5yZWFkeSggc2VsZWN0b3IgKSA6XG5cdFx0XHRcdC8vIEV4ZWN1dGUgaW1tZWRpYXRlbHkgaWYgcmVhZHkgaXMgbm90IHByZXNlbnRcblx0XHRcdFx0c2VsZWN0b3IoIGpRdWVyeSApO1xuXHRcdH1cblxuXHRcdGlmICggc2VsZWN0b3Iuc2VsZWN0b3IgIT09IHVuZGVmaW5lZCApIHtcblx0XHRcdHRoaXMuc2VsZWN0b3IgPSBzZWxlY3Rvci5zZWxlY3Rvcjtcblx0XHRcdHRoaXMuY29udGV4dCA9IHNlbGVjdG9yLmNvbnRleHQ7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGpRdWVyeS5tYWtlQXJyYXkoIHNlbGVjdG9yLCB0aGlzICk7XG5cdH07XG5cbi8vIEdpdmUgdGhlIGluaXQgZnVuY3Rpb24gdGhlIGpRdWVyeSBwcm90b3R5cGUgZm9yIGxhdGVyIGluc3RhbnRpYXRpb25cbmluaXQucHJvdG90eXBlID0galF1ZXJ5LmZuO1xuXG4vLyBJbml0aWFsaXplIGNlbnRyYWwgcmVmZXJlbmNlXG5yb290alF1ZXJ5ID0galF1ZXJ5KCBkb2N1bWVudCApO1xuXG5cbnZhciBycGFyZW50c3ByZXYgPSAvXig/OnBhcmVudHN8cHJldig/OlVudGlsfEFsbCkpLyxcblx0Ly8gbWV0aG9kcyBndWFyYW50ZWVkIHRvIHByb2R1Y2UgYSB1bmlxdWUgc2V0IHdoZW4gc3RhcnRpbmcgZnJvbSBhIHVuaXF1ZSBzZXRcblx0Z3VhcmFudGVlZFVuaXF1ZSA9IHtcblx0XHRjaGlsZHJlbjogdHJ1ZSxcblx0XHRjb250ZW50czogdHJ1ZSxcblx0XHRuZXh0OiB0cnVlLFxuXHRcdHByZXY6IHRydWVcblx0fTtcblxualF1ZXJ5LmV4dGVuZCh7XG5cdGRpcjogZnVuY3Rpb24oIGVsZW0sIGRpciwgdW50aWwgKSB7XG5cdFx0dmFyIG1hdGNoZWQgPSBbXSxcblx0XHRcdHRydW5jYXRlID0gdW50aWwgIT09IHVuZGVmaW5lZDtcblxuXHRcdHdoaWxlICggKGVsZW0gPSBlbGVtWyBkaXIgXSkgJiYgZWxlbS5ub2RlVHlwZSAhPT0gOSApIHtcblx0XHRcdGlmICggZWxlbS5ub2RlVHlwZSA9PT0gMSApIHtcblx0XHRcdFx0aWYgKCB0cnVuY2F0ZSAmJiBqUXVlcnkoIGVsZW0gKS5pcyggdW50aWwgKSApIHtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0XHRtYXRjaGVkLnB1c2goIGVsZW0gKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIG1hdGNoZWQ7XG5cdH0sXG5cblx0c2libGluZzogZnVuY3Rpb24oIG4sIGVsZW0gKSB7XG5cdFx0dmFyIG1hdGNoZWQgPSBbXTtcblxuXHRcdGZvciAoIDsgbjsgbiA9IG4ubmV4dFNpYmxpbmcgKSB7XG5cdFx0XHRpZiAoIG4ubm9kZVR5cGUgPT09IDEgJiYgbiAhPT0gZWxlbSApIHtcblx0XHRcdFx0bWF0Y2hlZC5wdXNoKCBuICk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG1hdGNoZWQ7XG5cdH1cbn0pO1xuXG5qUXVlcnkuZm4uZXh0ZW5kKHtcblx0aGFzOiBmdW5jdGlvbiggdGFyZ2V0ICkge1xuXHRcdHZhciB0YXJnZXRzID0galF1ZXJ5KCB0YXJnZXQsIHRoaXMgKSxcblx0XHRcdGwgPSB0YXJnZXRzLmxlbmd0aDtcblxuXHRcdHJldHVybiB0aGlzLmZpbHRlcihmdW5jdGlvbigpIHtcblx0XHRcdHZhciBpID0gMDtcblx0XHRcdGZvciAoIDsgaSA8IGw7IGkrKyApIHtcblx0XHRcdFx0aWYgKCBqUXVlcnkuY29udGFpbnMoIHRoaXMsIHRhcmdldHNbaV0gKSApIHtcblx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXHR9LFxuXG5cdGNsb3Nlc3Q6IGZ1bmN0aW9uKCBzZWxlY3RvcnMsIGNvbnRleHQgKSB7XG5cdFx0dmFyIGN1cixcblx0XHRcdGkgPSAwLFxuXHRcdFx0bCA9IHRoaXMubGVuZ3RoLFxuXHRcdFx0bWF0Y2hlZCA9IFtdLFxuXHRcdFx0cG9zID0gcm5lZWRzQ29udGV4dC50ZXN0KCBzZWxlY3RvcnMgKSB8fCB0eXBlb2Ygc2VsZWN0b3JzICE9PSBcInN0cmluZ1wiID9cblx0XHRcdFx0alF1ZXJ5KCBzZWxlY3RvcnMsIGNvbnRleHQgfHwgdGhpcy5jb250ZXh0ICkgOlxuXHRcdFx0XHQwO1xuXG5cdFx0Zm9yICggOyBpIDwgbDsgaSsrICkge1xuXHRcdFx0Zm9yICggY3VyID0gdGhpc1tpXTsgY3VyICYmIGN1ciAhPT0gY29udGV4dDsgY3VyID0gY3VyLnBhcmVudE5vZGUgKSB7XG5cdFx0XHRcdC8vIEFsd2F5cyBza2lwIGRvY3VtZW50IGZyYWdtZW50c1xuXHRcdFx0XHRpZiAoIGN1ci5ub2RlVHlwZSA8IDExICYmIChwb3MgP1xuXHRcdFx0XHRcdHBvcy5pbmRleChjdXIpID4gLTEgOlxuXG5cdFx0XHRcdFx0Ly8gRG9uJ3QgcGFzcyBub24tZWxlbWVudHMgdG8gU2l6emxlXG5cdFx0XHRcdFx0Y3VyLm5vZGVUeXBlID09PSAxICYmXG5cdFx0XHRcdFx0XHRqUXVlcnkuZmluZC5tYXRjaGVzU2VsZWN0b3IoY3VyLCBzZWxlY3RvcnMpKSApIHtcblxuXHRcdFx0XHRcdG1hdGNoZWQucHVzaCggY3VyICk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcy5wdXNoU3RhY2soIG1hdGNoZWQubGVuZ3RoID4gMSA/IGpRdWVyeS51bmlxdWUoIG1hdGNoZWQgKSA6IG1hdGNoZWQgKTtcblx0fSxcblxuXHQvLyBEZXRlcm1pbmUgdGhlIHBvc2l0aW9uIG9mIGFuIGVsZW1lbnQgd2l0aGluXG5cdC8vIHRoZSBtYXRjaGVkIHNldCBvZiBlbGVtZW50c1xuXHRpbmRleDogZnVuY3Rpb24oIGVsZW0gKSB7XG5cblx0XHQvLyBObyBhcmd1bWVudCwgcmV0dXJuIGluZGV4IGluIHBhcmVudFxuXHRcdGlmICggIWVsZW0gKSB7XG5cdFx0XHRyZXR1cm4gKCB0aGlzWyAwIF0gJiYgdGhpc1sgMCBdLnBhcmVudE5vZGUgKSA/IHRoaXMuZmlyc3QoKS5wcmV2QWxsKCkubGVuZ3RoIDogLTE7XG5cdFx0fVxuXG5cdFx0Ly8gaW5kZXggaW4gc2VsZWN0b3Jcblx0XHRpZiAoIHR5cGVvZiBlbGVtID09PSBcInN0cmluZ1wiICkge1xuXHRcdFx0cmV0dXJuIGluZGV4T2YuY2FsbCggalF1ZXJ5KCBlbGVtICksIHRoaXNbIDAgXSApO1xuXHRcdH1cblxuXHRcdC8vIExvY2F0ZSB0aGUgcG9zaXRpb24gb2YgdGhlIGRlc2lyZWQgZWxlbWVudFxuXHRcdHJldHVybiBpbmRleE9mLmNhbGwoIHRoaXMsXG5cblx0XHRcdC8vIElmIGl0IHJlY2VpdmVzIGEgalF1ZXJ5IG9iamVjdCwgdGhlIGZpcnN0IGVsZW1lbnQgaXMgdXNlZFxuXHRcdFx0ZWxlbS5qcXVlcnkgPyBlbGVtWyAwIF0gOiBlbGVtXG5cdFx0KTtcblx0fSxcblxuXHRhZGQ6IGZ1bmN0aW9uKCBzZWxlY3RvciwgY29udGV4dCApIHtcblx0XHRyZXR1cm4gdGhpcy5wdXNoU3RhY2soXG5cdFx0XHRqUXVlcnkudW5pcXVlKFxuXHRcdFx0XHRqUXVlcnkubWVyZ2UoIHRoaXMuZ2V0KCksIGpRdWVyeSggc2VsZWN0b3IsIGNvbnRleHQgKSApXG5cdFx0XHQpXG5cdFx0KTtcblx0fSxcblxuXHRhZGRCYWNrOiBmdW5jdGlvbiggc2VsZWN0b3IgKSB7XG5cdFx0cmV0dXJuIHRoaXMuYWRkKCBzZWxlY3RvciA9PSBudWxsID9cblx0XHRcdHRoaXMucHJldk9iamVjdCA6IHRoaXMucHJldk9iamVjdC5maWx0ZXIoc2VsZWN0b3IpXG5cdFx0KTtcblx0fVxufSk7XG5cbmZ1bmN0aW9uIHNpYmxpbmcoIGN1ciwgZGlyICkge1xuXHR3aGlsZSAoIChjdXIgPSBjdXJbZGlyXSkgJiYgY3VyLm5vZGVUeXBlICE9PSAxICkge31cblx0cmV0dXJuIGN1cjtcbn1cblxualF1ZXJ5LmVhY2goe1xuXHRwYXJlbnQ6IGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdHZhciBwYXJlbnQgPSBlbGVtLnBhcmVudE5vZGU7XG5cdFx0cmV0dXJuIHBhcmVudCAmJiBwYXJlbnQubm9kZVR5cGUgIT09IDExID8gcGFyZW50IDogbnVsbDtcblx0fSxcblx0cGFyZW50czogZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0cmV0dXJuIGpRdWVyeS5kaXIoIGVsZW0sIFwicGFyZW50Tm9kZVwiICk7XG5cdH0sXG5cdHBhcmVudHNVbnRpbDogZnVuY3Rpb24oIGVsZW0sIGksIHVudGlsICkge1xuXHRcdHJldHVybiBqUXVlcnkuZGlyKCBlbGVtLCBcInBhcmVudE5vZGVcIiwgdW50aWwgKTtcblx0fSxcblx0bmV4dDogZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0cmV0dXJuIHNpYmxpbmcoIGVsZW0sIFwibmV4dFNpYmxpbmdcIiApO1xuXHR9LFxuXHRwcmV2OiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRyZXR1cm4gc2libGluZyggZWxlbSwgXCJwcmV2aW91c1NpYmxpbmdcIiApO1xuXHR9LFxuXHRuZXh0QWxsOiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRyZXR1cm4galF1ZXJ5LmRpciggZWxlbSwgXCJuZXh0U2libGluZ1wiICk7XG5cdH0sXG5cdHByZXZBbGw6IGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdHJldHVybiBqUXVlcnkuZGlyKCBlbGVtLCBcInByZXZpb3VzU2libGluZ1wiICk7XG5cdH0sXG5cdG5leHRVbnRpbDogZnVuY3Rpb24oIGVsZW0sIGksIHVudGlsICkge1xuXHRcdHJldHVybiBqUXVlcnkuZGlyKCBlbGVtLCBcIm5leHRTaWJsaW5nXCIsIHVudGlsICk7XG5cdH0sXG5cdHByZXZVbnRpbDogZnVuY3Rpb24oIGVsZW0sIGksIHVudGlsICkge1xuXHRcdHJldHVybiBqUXVlcnkuZGlyKCBlbGVtLCBcInByZXZpb3VzU2libGluZ1wiLCB1bnRpbCApO1xuXHR9LFxuXHRzaWJsaW5nczogZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0cmV0dXJuIGpRdWVyeS5zaWJsaW5nKCAoIGVsZW0ucGFyZW50Tm9kZSB8fCB7fSApLmZpcnN0Q2hpbGQsIGVsZW0gKTtcblx0fSxcblx0Y2hpbGRyZW46IGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdHJldHVybiBqUXVlcnkuc2libGluZyggZWxlbS5maXJzdENoaWxkICk7XG5cdH0sXG5cdGNvbnRlbnRzOiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRyZXR1cm4gZWxlbS5jb250ZW50RG9jdW1lbnQgfHwgalF1ZXJ5Lm1lcmdlKCBbXSwgZWxlbS5jaGlsZE5vZGVzICk7XG5cdH1cbn0sIGZ1bmN0aW9uKCBuYW1lLCBmbiApIHtcblx0alF1ZXJ5LmZuWyBuYW1lIF0gPSBmdW5jdGlvbiggdW50aWwsIHNlbGVjdG9yICkge1xuXHRcdHZhciBtYXRjaGVkID0galF1ZXJ5Lm1hcCggdGhpcywgZm4sIHVudGlsICk7XG5cblx0XHRpZiAoIG5hbWUuc2xpY2UoIC01ICkgIT09IFwiVW50aWxcIiApIHtcblx0XHRcdHNlbGVjdG9yID0gdW50aWw7XG5cdFx0fVxuXG5cdFx0aWYgKCBzZWxlY3RvciAmJiB0eXBlb2Ygc2VsZWN0b3IgPT09IFwic3RyaW5nXCIgKSB7XG5cdFx0XHRtYXRjaGVkID0galF1ZXJ5LmZpbHRlciggc2VsZWN0b3IsIG1hdGNoZWQgKTtcblx0XHR9XG5cblx0XHRpZiAoIHRoaXMubGVuZ3RoID4gMSApIHtcblx0XHRcdC8vIFJlbW92ZSBkdXBsaWNhdGVzXG5cdFx0XHRpZiAoICFndWFyYW50ZWVkVW5pcXVlWyBuYW1lIF0gKSB7XG5cdFx0XHRcdGpRdWVyeS51bmlxdWUoIG1hdGNoZWQgKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gUmV2ZXJzZSBvcmRlciBmb3IgcGFyZW50cyogYW5kIHByZXYtZGVyaXZhdGl2ZXNcblx0XHRcdGlmICggcnBhcmVudHNwcmV2LnRlc3QoIG5hbWUgKSApIHtcblx0XHRcdFx0bWF0Y2hlZC5yZXZlcnNlKCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRoaXMucHVzaFN0YWNrKCBtYXRjaGVkICk7XG5cdH07XG59KTtcbnZhciBybm90d2hpdGUgPSAoL1xcUysvZyk7XG5cblxuXG4vLyBTdHJpbmcgdG8gT2JqZWN0IG9wdGlvbnMgZm9ybWF0IGNhY2hlXG52YXIgb3B0aW9uc0NhY2hlID0ge307XG5cbi8vIENvbnZlcnQgU3RyaW5nLWZvcm1hdHRlZCBvcHRpb25zIGludG8gT2JqZWN0LWZvcm1hdHRlZCBvbmVzIGFuZCBzdG9yZSBpbiBjYWNoZVxuZnVuY3Rpb24gY3JlYXRlT3B0aW9ucyggb3B0aW9ucyApIHtcblx0dmFyIG9iamVjdCA9IG9wdGlvbnNDYWNoZVsgb3B0aW9ucyBdID0ge307XG5cdGpRdWVyeS5lYWNoKCBvcHRpb25zLm1hdGNoKCBybm90d2hpdGUgKSB8fCBbXSwgZnVuY3Rpb24oIF8sIGZsYWcgKSB7XG5cdFx0b2JqZWN0WyBmbGFnIF0gPSB0cnVlO1xuXHR9KTtcblx0cmV0dXJuIG9iamVjdDtcbn1cblxuLypcbiAqIENyZWF0ZSBhIGNhbGxiYWNrIGxpc3QgdXNpbmcgdGhlIGZvbGxvd2luZyBwYXJhbWV0ZXJzOlxuICpcbiAqXHRvcHRpb25zOiBhbiBvcHRpb25hbCBsaXN0IG9mIHNwYWNlLXNlcGFyYXRlZCBvcHRpb25zIHRoYXQgd2lsbCBjaGFuZ2UgaG93XG4gKlx0XHRcdHRoZSBjYWxsYmFjayBsaXN0IGJlaGF2ZXMgb3IgYSBtb3JlIHRyYWRpdGlvbmFsIG9wdGlvbiBvYmplY3RcbiAqXG4gKiBCeSBkZWZhdWx0IGEgY2FsbGJhY2sgbGlzdCB3aWxsIGFjdCBsaWtlIGFuIGV2ZW50IGNhbGxiYWNrIGxpc3QgYW5kIGNhbiBiZVxuICogXCJmaXJlZFwiIG11bHRpcGxlIHRpbWVzLlxuICpcbiAqIFBvc3NpYmxlIG9wdGlvbnM6XG4gKlxuICpcdG9uY2U6XHRcdFx0d2lsbCBlbnN1cmUgdGhlIGNhbGxiYWNrIGxpc3QgY2FuIG9ubHkgYmUgZmlyZWQgb25jZSAobGlrZSBhIERlZmVycmVkKVxuICpcbiAqXHRtZW1vcnk6XHRcdFx0d2lsbCBrZWVwIHRyYWNrIG9mIHByZXZpb3VzIHZhbHVlcyBhbmQgd2lsbCBjYWxsIGFueSBjYWxsYmFjayBhZGRlZFxuICpcdFx0XHRcdFx0YWZ0ZXIgdGhlIGxpc3QgaGFzIGJlZW4gZmlyZWQgcmlnaHQgYXdheSB3aXRoIHRoZSBsYXRlc3QgXCJtZW1vcml6ZWRcIlxuICpcdFx0XHRcdFx0dmFsdWVzIChsaWtlIGEgRGVmZXJyZWQpXG4gKlxuICpcdHVuaXF1ZTpcdFx0XHR3aWxsIGVuc3VyZSBhIGNhbGxiYWNrIGNhbiBvbmx5IGJlIGFkZGVkIG9uY2UgKG5vIGR1cGxpY2F0ZSBpbiB0aGUgbGlzdClcbiAqXG4gKlx0c3RvcE9uRmFsc2U6XHRpbnRlcnJ1cHQgY2FsbGluZ3Mgd2hlbiBhIGNhbGxiYWNrIHJldHVybnMgZmFsc2VcbiAqXG4gKi9cbmpRdWVyeS5DYWxsYmFja3MgPSBmdW5jdGlvbiggb3B0aW9ucyApIHtcblxuXHQvLyBDb252ZXJ0IG9wdGlvbnMgZnJvbSBTdHJpbmctZm9ybWF0dGVkIHRvIE9iamVjdC1mb3JtYXR0ZWQgaWYgbmVlZGVkXG5cdC8vICh3ZSBjaGVjayBpbiBjYWNoZSBmaXJzdClcblx0b3B0aW9ucyA9IHR5cGVvZiBvcHRpb25zID09PSBcInN0cmluZ1wiID9cblx0XHQoIG9wdGlvbnNDYWNoZVsgb3B0aW9ucyBdIHx8IGNyZWF0ZU9wdGlvbnMoIG9wdGlvbnMgKSApIDpcblx0XHRqUXVlcnkuZXh0ZW5kKCB7fSwgb3B0aW9ucyApO1xuXG5cdHZhciAvLyBMYXN0IGZpcmUgdmFsdWUgKGZvciBub24tZm9yZ2V0dGFibGUgbGlzdHMpXG5cdFx0bWVtb3J5LFxuXHRcdC8vIEZsYWcgdG8ga25vdyBpZiBsaXN0IHdhcyBhbHJlYWR5IGZpcmVkXG5cdFx0ZmlyZWQsXG5cdFx0Ly8gRmxhZyB0byBrbm93IGlmIGxpc3QgaXMgY3VycmVudGx5IGZpcmluZ1xuXHRcdGZpcmluZyxcblx0XHQvLyBGaXJzdCBjYWxsYmFjayB0byBmaXJlICh1c2VkIGludGVybmFsbHkgYnkgYWRkIGFuZCBmaXJlV2l0aClcblx0XHRmaXJpbmdTdGFydCxcblx0XHQvLyBFbmQgb2YgdGhlIGxvb3Agd2hlbiBmaXJpbmdcblx0XHRmaXJpbmdMZW5ndGgsXG5cdFx0Ly8gSW5kZXggb2YgY3VycmVudGx5IGZpcmluZyBjYWxsYmFjayAobW9kaWZpZWQgYnkgcmVtb3ZlIGlmIG5lZWRlZClcblx0XHRmaXJpbmdJbmRleCxcblx0XHQvLyBBY3R1YWwgY2FsbGJhY2sgbGlzdFxuXHRcdGxpc3QgPSBbXSxcblx0XHQvLyBTdGFjayBvZiBmaXJlIGNhbGxzIGZvciByZXBlYXRhYmxlIGxpc3RzXG5cdFx0c3RhY2sgPSAhb3B0aW9ucy5vbmNlICYmIFtdLFxuXHRcdC8vIEZpcmUgY2FsbGJhY2tzXG5cdFx0ZmlyZSA9IGZ1bmN0aW9uKCBkYXRhICkge1xuXHRcdFx0bWVtb3J5ID0gb3B0aW9ucy5tZW1vcnkgJiYgZGF0YTtcblx0XHRcdGZpcmVkID0gdHJ1ZTtcblx0XHRcdGZpcmluZ0luZGV4ID0gZmlyaW5nU3RhcnQgfHwgMDtcblx0XHRcdGZpcmluZ1N0YXJ0ID0gMDtcblx0XHRcdGZpcmluZ0xlbmd0aCA9IGxpc3QubGVuZ3RoO1xuXHRcdFx0ZmlyaW5nID0gdHJ1ZTtcblx0XHRcdGZvciAoIDsgbGlzdCAmJiBmaXJpbmdJbmRleCA8IGZpcmluZ0xlbmd0aDsgZmlyaW5nSW5kZXgrKyApIHtcblx0XHRcdFx0aWYgKCBsaXN0WyBmaXJpbmdJbmRleCBdLmFwcGx5KCBkYXRhWyAwIF0sIGRhdGFbIDEgXSApID09PSBmYWxzZSAmJiBvcHRpb25zLnN0b3BPbkZhbHNlICkge1xuXHRcdFx0XHRcdG1lbW9yeSA9IGZhbHNlOyAvLyBUbyBwcmV2ZW50IGZ1cnRoZXIgY2FsbHMgdXNpbmcgYWRkXG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGZpcmluZyA9IGZhbHNlO1xuXHRcdFx0aWYgKCBsaXN0ICkge1xuXHRcdFx0XHRpZiAoIHN0YWNrICkge1xuXHRcdFx0XHRcdGlmICggc3RhY2subGVuZ3RoICkge1xuXHRcdFx0XHRcdFx0ZmlyZSggc3RhY2suc2hpZnQoKSApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBlbHNlIGlmICggbWVtb3J5ICkge1xuXHRcdFx0XHRcdGxpc3QgPSBbXTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRzZWxmLmRpc2FibGUoKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0sXG5cdFx0Ly8gQWN0dWFsIENhbGxiYWNrcyBvYmplY3Rcblx0XHRzZWxmID0ge1xuXHRcdFx0Ly8gQWRkIGEgY2FsbGJhY2sgb3IgYSBjb2xsZWN0aW9uIG9mIGNhbGxiYWNrcyB0byB0aGUgbGlzdFxuXHRcdFx0YWRkOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKCBsaXN0ICkge1xuXHRcdFx0XHRcdC8vIEZpcnN0LCB3ZSBzYXZlIHRoZSBjdXJyZW50IGxlbmd0aFxuXHRcdFx0XHRcdHZhciBzdGFydCA9IGxpc3QubGVuZ3RoO1xuXHRcdFx0XHRcdChmdW5jdGlvbiBhZGQoIGFyZ3MgKSB7XG5cdFx0XHRcdFx0XHRqUXVlcnkuZWFjaCggYXJncywgZnVuY3Rpb24oIF8sIGFyZyApIHtcblx0XHRcdFx0XHRcdFx0dmFyIHR5cGUgPSBqUXVlcnkudHlwZSggYXJnICk7XG5cdFx0XHRcdFx0XHRcdGlmICggdHlwZSA9PT0gXCJmdW5jdGlvblwiICkge1xuXHRcdFx0XHRcdFx0XHRcdGlmICggIW9wdGlvbnMudW5pcXVlIHx8ICFzZWxmLmhhcyggYXJnICkgKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRsaXN0LnB1c2goIGFyZyApO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmICggYXJnICYmIGFyZy5sZW5ndGggJiYgdHlwZSAhPT0gXCJzdHJpbmdcIiApIHtcblx0XHRcdFx0XHRcdFx0XHQvLyBJbnNwZWN0IHJlY3Vyc2l2ZWx5XG5cdFx0XHRcdFx0XHRcdFx0YWRkKCBhcmcgKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fSkoIGFyZ3VtZW50cyApO1xuXHRcdFx0XHRcdC8vIERvIHdlIG5lZWQgdG8gYWRkIHRoZSBjYWxsYmFja3MgdG8gdGhlXG5cdFx0XHRcdFx0Ly8gY3VycmVudCBmaXJpbmcgYmF0Y2g/XG5cdFx0XHRcdFx0aWYgKCBmaXJpbmcgKSB7XG5cdFx0XHRcdFx0XHRmaXJpbmdMZW5ndGggPSBsaXN0Lmxlbmd0aDtcblx0XHRcdFx0XHQvLyBXaXRoIG1lbW9yeSwgaWYgd2UncmUgbm90IGZpcmluZyB0aGVuXG5cdFx0XHRcdFx0Ly8gd2Ugc2hvdWxkIGNhbGwgcmlnaHQgYXdheVxuXHRcdFx0XHRcdH0gZWxzZSBpZiAoIG1lbW9yeSApIHtcblx0XHRcdFx0XHRcdGZpcmluZ1N0YXJ0ID0gc3RhcnQ7XG5cdFx0XHRcdFx0XHRmaXJlKCBtZW1vcnkgKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHR9LFxuXHRcdFx0Ly8gUmVtb3ZlIGEgY2FsbGJhY2sgZnJvbSB0aGUgbGlzdFxuXHRcdFx0cmVtb3ZlOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKCBsaXN0ICkge1xuXHRcdFx0XHRcdGpRdWVyeS5lYWNoKCBhcmd1bWVudHMsIGZ1bmN0aW9uKCBfLCBhcmcgKSB7XG5cdFx0XHRcdFx0XHR2YXIgaW5kZXg7XG5cdFx0XHRcdFx0XHR3aGlsZSAoICggaW5kZXggPSBqUXVlcnkuaW5BcnJheSggYXJnLCBsaXN0LCBpbmRleCApICkgPiAtMSApIHtcblx0XHRcdFx0XHRcdFx0bGlzdC5zcGxpY2UoIGluZGV4LCAxICk7XG5cdFx0XHRcdFx0XHRcdC8vIEhhbmRsZSBmaXJpbmcgaW5kZXhlc1xuXHRcdFx0XHRcdFx0XHRpZiAoIGZpcmluZyApIHtcblx0XHRcdFx0XHRcdFx0XHRpZiAoIGluZGV4IDw9IGZpcmluZ0xlbmd0aCApIHtcblx0XHRcdFx0XHRcdFx0XHRcdGZpcmluZ0xlbmd0aC0tO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRpZiAoIGluZGV4IDw9IGZpcmluZ0luZGV4ICkge1xuXHRcdFx0XHRcdFx0XHRcdFx0ZmlyaW5nSW5kZXgtLTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdH0sXG5cdFx0XHQvLyBDaGVjayBpZiBhIGdpdmVuIGNhbGxiYWNrIGlzIGluIHRoZSBsaXN0LlxuXHRcdFx0Ly8gSWYgbm8gYXJndW1lbnQgaXMgZ2l2ZW4sIHJldHVybiB3aGV0aGVyIG9yIG5vdCBsaXN0IGhhcyBjYWxsYmFja3MgYXR0YWNoZWQuXG5cdFx0XHRoYXM6IGZ1bmN0aW9uKCBmbiApIHtcblx0XHRcdFx0cmV0dXJuIGZuID8galF1ZXJ5LmluQXJyYXkoIGZuLCBsaXN0ICkgPiAtMSA6ICEhKCBsaXN0ICYmIGxpc3QubGVuZ3RoICk7XG5cdFx0XHR9LFxuXHRcdFx0Ly8gUmVtb3ZlIGFsbCBjYWxsYmFja3MgZnJvbSB0aGUgbGlzdFxuXHRcdFx0ZW1wdHk6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRsaXN0ID0gW107XG5cdFx0XHRcdGZpcmluZ0xlbmd0aCA9IDA7XG5cdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0fSxcblx0XHRcdC8vIEhhdmUgdGhlIGxpc3QgZG8gbm90aGluZyBhbnltb3JlXG5cdFx0XHRkaXNhYmxlOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0bGlzdCA9IHN0YWNrID0gbWVtb3J5ID0gdW5kZWZpbmVkO1xuXHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdH0sXG5cdFx0XHQvLyBJcyBpdCBkaXNhYmxlZD9cblx0XHRcdGRpc2FibGVkOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuICFsaXN0O1xuXHRcdFx0fSxcblx0XHRcdC8vIExvY2sgdGhlIGxpc3QgaW4gaXRzIGN1cnJlbnQgc3RhdGVcblx0XHRcdGxvY2s6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRzdGFjayA9IHVuZGVmaW5lZDtcblx0XHRcdFx0aWYgKCAhbWVtb3J5ICkge1xuXHRcdFx0XHRcdHNlbGYuZGlzYWJsZSgpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0fSxcblx0XHRcdC8vIElzIGl0IGxvY2tlZD9cblx0XHRcdGxvY2tlZDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiAhc3RhY2s7XG5cdFx0XHR9LFxuXHRcdFx0Ly8gQ2FsbCBhbGwgY2FsbGJhY2tzIHdpdGggdGhlIGdpdmVuIGNvbnRleHQgYW5kIGFyZ3VtZW50c1xuXHRcdFx0ZmlyZVdpdGg6IGZ1bmN0aW9uKCBjb250ZXh0LCBhcmdzICkge1xuXHRcdFx0XHRpZiAoIGxpc3QgJiYgKCAhZmlyZWQgfHwgc3RhY2sgKSApIHtcblx0XHRcdFx0XHRhcmdzID0gYXJncyB8fCBbXTtcblx0XHRcdFx0XHRhcmdzID0gWyBjb250ZXh0LCBhcmdzLnNsaWNlID8gYXJncy5zbGljZSgpIDogYXJncyBdO1xuXHRcdFx0XHRcdGlmICggZmlyaW5nICkge1xuXHRcdFx0XHRcdFx0c3RhY2sucHVzaCggYXJncyApO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRmaXJlKCBhcmdzICk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0fSxcblx0XHRcdC8vIENhbGwgYWxsIHRoZSBjYWxsYmFja3Mgd2l0aCB0aGUgZ2l2ZW4gYXJndW1lbnRzXG5cdFx0XHRmaXJlOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0c2VsZi5maXJlV2l0aCggdGhpcywgYXJndW1lbnRzICk7XG5cdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0fSxcblx0XHRcdC8vIFRvIGtub3cgaWYgdGhlIGNhbGxiYWNrcyBoYXZlIGFscmVhZHkgYmVlbiBjYWxsZWQgYXQgbGVhc3Qgb25jZVxuXHRcdFx0ZmlyZWQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gISFmaXJlZDtcblx0XHRcdH1cblx0XHR9O1xuXG5cdHJldHVybiBzZWxmO1xufTtcblxuXG5qUXVlcnkuZXh0ZW5kKHtcblxuXHREZWZlcnJlZDogZnVuY3Rpb24oIGZ1bmMgKSB7XG5cdFx0dmFyIHR1cGxlcyA9IFtcblx0XHRcdFx0Ly8gYWN0aW9uLCBhZGQgbGlzdGVuZXIsIGxpc3RlbmVyIGxpc3QsIGZpbmFsIHN0YXRlXG5cdFx0XHRcdFsgXCJyZXNvbHZlXCIsIFwiZG9uZVwiLCBqUXVlcnkuQ2FsbGJhY2tzKFwib25jZSBtZW1vcnlcIiksIFwicmVzb2x2ZWRcIiBdLFxuXHRcdFx0XHRbIFwicmVqZWN0XCIsIFwiZmFpbFwiLCBqUXVlcnkuQ2FsbGJhY2tzKFwib25jZSBtZW1vcnlcIiksIFwicmVqZWN0ZWRcIiBdLFxuXHRcdFx0XHRbIFwibm90aWZ5XCIsIFwicHJvZ3Jlc3NcIiwgalF1ZXJ5LkNhbGxiYWNrcyhcIm1lbW9yeVwiKSBdXG5cdFx0XHRdLFxuXHRcdFx0c3RhdGUgPSBcInBlbmRpbmdcIixcblx0XHRcdHByb21pc2UgPSB7XG5cdFx0XHRcdHN0YXRlOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRyZXR1cm4gc3RhdGU7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdGFsd2F5czogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0ZGVmZXJyZWQuZG9uZSggYXJndW1lbnRzICkuZmFpbCggYXJndW1lbnRzICk7XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdHRoZW46IGZ1bmN0aW9uKCAvKiBmbkRvbmUsIGZuRmFpbCwgZm5Qcm9ncmVzcyAqLyApIHtcblx0XHRcdFx0XHR2YXIgZm5zID0gYXJndW1lbnRzO1xuXHRcdFx0XHRcdHJldHVybiBqUXVlcnkuRGVmZXJyZWQoZnVuY3Rpb24oIG5ld0RlZmVyICkge1xuXHRcdFx0XHRcdFx0alF1ZXJ5LmVhY2goIHR1cGxlcywgZnVuY3Rpb24oIGksIHR1cGxlICkge1xuXHRcdFx0XHRcdFx0XHR2YXIgZm4gPSBqUXVlcnkuaXNGdW5jdGlvbiggZm5zWyBpIF0gKSAmJiBmbnNbIGkgXTtcblx0XHRcdFx0XHRcdFx0Ly8gZGVmZXJyZWRbIGRvbmUgfCBmYWlsIHwgcHJvZ3Jlc3MgXSBmb3IgZm9yd2FyZGluZyBhY3Rpb25zIHRvIG5ld0RlZmVyXG5cdFx0XHRcdFx0XHRcdGRlZmVycmVkWyB0dXBsZVsxXSBdKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRcdHZhciByZXR1cm5lZCA9IGZuICYmIGZuLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTtcblx0XHRcdFx0XHRcdFx0XHRpZiAoIHJldHVybmVkICYmIGpRdWVyeS5pc0Z1bmN0aW9uKCByZXR1cm5lZC5wcm9taXNlICkgKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm5lZC5wcm9taXNlKClcblx0XHRcdFx0XHRcdFx0XHRcdFx0LmRvbmUoIG5ld0RlZmVyLnJlc29sdmUgKVxuXHRcdFx0XHRcdFx0XHRcdFx0XHQuZmFpbCggbmV3RGVmZXIucmVqZWN0IClcblx0XHRcdFx0XHRcdFx0XHRcdFx0LnByb2dyZXNzKCBuZXdEZWZlci5ub3RpZnkgKTtcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0bmV3RGVmZXJbIHR1cGxlWyAwIF0gKyBcIldpdGhcIiBdKCB0aGlzID09PSBwcm9taXNlID8gbmV3RGVmZXIucHJvbWlzZSgpIDogdGhpcywgZm4gPyBbIHJldHVybmVkIF0gOiBhcmd1bWVudHMgKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRmbnMgPSBudWxsO1xuXHRcdFx0XHRcdH0pLnByb21pc2UoKTtcblx0XHRcdFx0fSxcblx0XHRcdFx0Ly8gR2V0IGEgcHJvbWlzZSBmb3IgdGhpcyBkZWZlcnJlZFxuXHRcdFx0XHQvLyBJZiBvYmogaXMgcHJvdmlkZWQsIHRoZSBwcm9taXNlIGFzcGVjdCBpcyBhZGRlZCB0byB0aGUgb2JqZWN0XG5cdFx0XHRcdHByb21pc2U6IGZ1bmN0aW9uKCBvYmogKSB7XG5cdFx0XHRcdFx0cmV0dXJuIG9iaiAhPSBudWxsID8galF1ZXJ5LmV4dGVuZCggb2JqLCBwcm9taXNlICkgOiBwcm9taXNlO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXHRcdFx0ZGVmZXJyZWQgPSB7fTtcblxuXHRcdC8vIEtlZXAgcGlwZSBmb3IgYmFjay1jb21wYXRcblx0XHRwcm9taXNlLnBpcGUgPSBwcm9taXNlLnRoZW47XG5cblx0XHQvLyBBZGQgbGlzdC1zcGVjaWZpYyBtZXRob2RzXG5cdFx0alF1ZXJ5LmVhY2goIHR1cGxlcywgZnVuY3Rpb24oIGksIHR1cGxlICkge1xuXHRcdFx0dmFyIGxpc3QgPSB0dXBsZVsgMiBdLFxuXHRcdFx0XHRzdGF0ZVN0cmluZyA9IHR1cGxlWyAzIF07XG5cblx0XHRcdC8vIHByb21pc2VbIGRvbmUgfCBmYWlsIHwgcHJvZ3Jlc3MgXSA9IGxpc3QuYWRkXG5cdFx0XHRwcm9taXNlWyB0dXBsZVsxXSBdID0gbGlzdC5hZGQ7XG5cblx0XHRcdC8vIEhhbmRsZSBzdGF0ZVxuXHRcdFx0aWYgKCBzdGF0ZVN0cmluZyApIHtcblx0XHRcdFx0bGlzdC5hZGQoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0Ly8gc3RhdGUgPSBbIHJlc29sdmVkIHwgcmVqZWN0ZWQgXVxuXHRcdFx0XHRcdHN0YXRlID0gc3RhdGVTdHJpbmc7XG5cblx0XHRcdFx0Ly8gWyByZWplY3RfbGlzdCB8IHJlc29sdmVfbGlzdCBdLmRpc2FibGU7IHByb2dyZXNzX2xpc3QubG9ja1xuXHRcdFx0XHR9LCB0dXBsZXNbIGkgXiAxIF1bIDIgXS5kaXNhYmxlLCB0dXBsZXNbIDIgXVsgMiBdLmxvY2sgKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gZGVmZXJyZWRbIHJlc29sdmUgfCByZWplY3QgfCBub3RpZnkgXVxuXHRcdFx0ZGVmZXJyZWRbIHR1cGxlWzBdIF0gPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0ZGVmZXJyZWRbIHR1cGxlWzBdICsgXCJXaXRoXCIgXSggdGhpcyA9PT0gZGVmZXJyZWQgPyBwcm9taXNlIDogdGhpcywgYXJndW1lbnRzICk7XG5cdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0fTtcblx0XHRcdGRlZmVycmVkWyB0dXBsZVswXSArIFwiV2l0aFwiIF0gPSBsaXN0LmZpcmVXaXRoO1xuXHRcdH0pO1xuXG5cdFx0Ly8gTWFrZSB0aGUgZGVmZXJyZWQgYSBwcm9taXNlXG5cdFx0cHJvbWlzZS5wcm9taXNlKCBkZWZlcnJlZCApO1xuXG5cdFx0Ly8gQ2FsbCBnaXZlbiBmdW5jIGlmIGFueVxuXHRcdGlmICggZnVuYyApIHtcblx0XHRcdGZ1bmMuY2FsbCggZGVmZXJyZWQsIGRlZmVycmVkICk7XG5cdFx0fVxuXG5cdFx0Ly8gQWxsIGRvbmUhXG5cdFx0cmV0dXJuIGRlZmVycmVkO1xuXHR9LFxuXG5cdC8vIERlZmVycmVkIGhlbHBlclxuXHR3aGVuOiBmdW5jdGlvbiggc3Vib3JkaW5hdGUgLyogLCAuLi4sIHN1Ym9yZGluYXRlTiAqLyApIHtcblx0XHR2YXIgaSA9IDAsXG5cdFx0XHRyZXNvbHZlVmFsdWVzID0gc2xpY2UuY2FsbCggYXJndW1lbnRzICksXG5cdFx0XHRsZW5ndGggPSByZXNvbHZlVmFsdWVzLmxlbmd0aCxcblxuXHRcdFx0Ly8gdGhlIGNvdW50IG9mIHVuY29tcGxldGVkIHN1Ym9yZGluYXRlc1xuXHRcdFx0cmVtYWluaW5nID0gbGVuZ3RoICE9PSAxIHx8ICggc3Vib3JkaW5hdGUgJiYgalF1ZXJ5LmlzRnVuY3Rpb24oIHN1Ym9yZGluYXRlLnByb21pc2UgKSApID8gbGVuZ3RoIDogMCxcblxuXHRcdFx0Ly8gdGhlIG1hc3RlciBEZWZlcnJlZC4gSWYgcmVzb2x2ZVZhbHVlcyBjb25zaXN0IG9mIG9ubHkgYSBzaW5nbGUgRGVmZXJyZWQsIGp1c3QgdXNlIHRoYXQuXG5cdFx0XHRkZWZlcnJlZCA9IHJlbWFpbmluZyA9PT0gMSA/IHN1Ym9yZGluYXRlIDogalF1ZXJ5LkRlZmVycmVkKCksXG5cblx0XHRcdC8vIFVwZGF0ZSBmdW5jdGlvbiBmb3IgYm90aCByZXNvbHZlIGFuZCBwcm9ncmVzcyB2YWx1ZXNcblx0XHRcdHVwZGF0ZUZ1bmMgPSBmdW5jdGlvbiggaSwgY29udGV4dHMsIHZhbHVlcyApIHtcblx0XHRcdFx0cmV0dXJuIGZ1bmN0aW9uKCB2YWx1ZSApIHtcblx0XHRcdFx0XHRjb250ZXh0c1sgaSBdID0gdGhpcztcblx0XHRcdFx0XHR2YWx1ZXNbIGkgXSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxID8gc2xpY2UuY2FsbCggYXJndW1lbnRzICkgOiB2YWx1ZTtcblx0XHRcdFx0XHRpZiAoIHZhbHVlcyA9PT0gcHJvZ3Jlc3NWYWx1ZXMgKSB7XG5cdFx0XHRcdFx0XHRkZWZlcnJlZC5ub3RpZnlXaXRoKCBjb250ZXh0cywgdmFsdWVzICk7XG5cdFx0XHRcdFx0fSBlbHNlIGlmICggISggLS1yZW1haW5pbmcgKSApIHtcblx0XHRcdFx0XHRcdGRlZmVycmVkLnJlc29sdmVXaXRoKCBjb250ZXh0cywgdmFsdWVzICk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9O1xuXHRcdFx0fSxcblxuXHRcdFx0cHJvZ3Jlc3NWYWx1ZXMsIHByb2dyZXNzQ29udGV4dHMsIHJlc29sdmVDb250ZXh0cztcblxuXHRcdC8vIGFkZCBsaXN0ZW5lcnMgdG8gRGVmZXJyZWQgc3Vib3JkaW5hdGVzOyB0cmVhdCBvdGhlcnMgYXMgcmVzb2x2ZWRcblx0XHRpZiAoIGxlbmd0aCA+IDEgKSB7XG5cdFx0XHRwcm9ncmVzc1ZhbHVlcyA9IG5ldyBBcnJheSggbGVuZ3RoICk7XG5cdFx0XHRwcm9ncmVzc0NvbnRleHRzID0gbmV3IEFycmF5KCBsZW5ndGggKTtcblx0XHRcdHJlc29sdmVDb250ZXh0cyA9IG5ldyBBcnJheSggbGVuZ3RoICk7XG5cdFx0XHRmb3IgKCA7IGkgPCBsZW5ndGg7IGkrKyApIHtcblx0XHRcdFx0aWYgKCByZXNvbHZlVmFsdWVzWyBpIF0gJiYgalF1ZXJ5LmlzRnVuY3Rpb24oIHJlc29sdmVWYWx1ZXNbIGkgXS5wcm9taXNlICkgKSB7XG5cdFx0XHRcdFx0cmVzb2x2ZVZhbHVlc1sgaSBdLnByb21pc2UoKVxuXHRcdFx0XHRcdFx0LmRvbmUoIHVwZGF0ZUZ1bmMoIGksIHJlc29sdmVDb250ZXh0cywgcmVzb2x2ZVZhbHVlcyApIClcblx0XHRcdFx0XHRcdC5mYWlsKCBkZWZlcnJlZC5yZWplY3QgKVxuXHRcdFx0XHRcdFx0LnByb2dyZXNzKCB1cGRhdGVGdW5jKCBpLCBwcm9ncmVzc0NvbnRleHRzLCBwcm9ncmVzc1ZhbHVlcyApICk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0LS1yZW1haW5pbmc7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBpZiB3ZSdyZSBub3Qgd2FpdGluZyBvbiBhbnl0aGluZywgcmVzb2x2ZSB0aGUgbWFzdGVyXG5cdFx0aWYgKCAhcmVtYWluaW5nICkge1xuXHRcdFx0ZGVmZXJyZWQucmVzb2x2ZVdpdGgoIHJlc29sdmVDb250ZXh0cywgcmVzb2x2ZVZhbHVlcyApO1xuXHRcdH1cblxuXHRcdHJldHVybiBkZWZlcnJlZC5wcm9taXNlKCk7XG5cdH1cbn0pO1xuXG5cbi8vIFRoZSBkZWZlcnJlZCB1c2VkIG9uIERPTSByZWFkeVxudmFyIHJlYWR5TGlzdDtcblxualF1ZXJ5LmZuLnJlYWR5ID0gZnVuY3Rpb24oIGZuICkge1xuXHQvLyBBZGQgdGhlIGNhbGxiYWNrXG5cdGpRdWVyeS5yZWFkeS5wcm9taXNlKCkuZG9uZSggZm4gKTtcblxuXHRyZXR1cm4gdGhpcztcbn07XG5cbmpRdWVyeS5leHRlbmQoe1xuXHQvLyBJcyB0aGUgRE9NIHJlYWR5IHRvIGJlIHVzZWQ/IFNldCB0byB0cnVlIG9uY2UgaXQgb2NjdXJzLlxuXHRpc1JlYWR5OiBmYWxzZSxcblxuXHQvLyBBIGNvdW50ZXIgdG8gdHJhY2sgaG93IG1hbnkgaXRlbXMgdG8gd2FpdCBmb3IgYmVmb3JlXG5cdC8vIHRoZSByZWFkeSBldmVudCBmaXJlcy4gU2VlICM2NzgxXG5cdHJlYWR5V2FpdDogMSxcblxuXHQvLyBIb2xkIChvciByZWxlYXNlKSB0aGUgcmVhZHkgZXZlbnRcblx0aG9sZFJlYWR5OiBmdW5jdGlvbiggaG9sZCApIHtcblx0XHRpZiAoIGhvbGQgKSB7XG5cdFx0XHRqUXVlcnkucmVhZHlXYWl0Kys7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGpRdWVyeS5yZWFkeSggdHJ1ZSApO1xuXHRcdH1cblx0fSxcblxuXHQvLyBIYW5kbGUgd2hlbiB0aGUgRE9NIGlzIHJlYWR5XG5cdHJlYWR5OiBmdW5jdGlvbiggd2FpdCApIHtcblxuXHRcdC8vIEFib3J0IGlmIHRoZXJlIGFyZSBwZW5kaW5nIGhvbGRzIG9yIHdlJ3JlIGFscmVhZHkgcmVhZHlcblx0XHRpZiAoIHdhaXQgPT09IHRydWUgPyAtLWpRdWVyeS5yZWFkeVdhaXQgOiBqUXVlcnkuaXNSZWFkeSApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBSZW1lbWJlciB0aGF0IHRoZSBET00gaXMgcmVhZHlcblx0XHRqUXVlcnkuaXNSZWFkeSA9IHRydWU7XG5cblx0XHQvLyBJZiBhIG5vcm1hbCBET00gUmVhZHkgZXZlbnQgZmlyZWQsIGRlY3JlbWVudCwgYW5kIHdhaXQgaWYgbmVlZCBiZVxuXHRcdGlmICggd2FpdCAhPT0gdHJ1ZSAmJiAtLWpRdWVyeS5yZWFkeVdhaXQgPiAwICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIElmIHRoZXJlIGFyZSBmdW5jdGlvbnMgYm91bmQsIHRvIGV4ZWN1dGVcblx0XHRyZWFkeUxpc3QucmVzb2x2ZVdpdGgoIGRvY3VtZW50LCBbIGpRdWVyeSBdICk7XG5cblx0XHQvLyBUcmlnZ2VyIGFueSBib3VuZCByZWFkeSBldmVudHNcblx0XHRpZiAoIGpRdWVyeS5mbi50cmlnZ2VySGFuZGxlciApIHtcblx0XHRcdGpRdWVyeSggZG9jdW1lbnQgKS50cmlnZ2VySGFuZGxlciggXCJyZWFkeVwiICk7XG5cdFx0XHRqUXVlcnkoIGRvY3VtZW50ICkub2ZmKCBcInJlYWR5XCIgKTtcblx0XHR9XG5cdH1cbn0pO1xuXG4vKipcbiAqIFRoZSByZWFkeSBldmVudCBoYW5kbGVyIGFuZCBzZWxmIGNsZWFudXAgbWV0aG9kXG4gKi9cbmZ1bmN0aW9uIGNvbXBsZXRlZCgpIHtcblx0ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggXCJET01Db250ZW50TG9hZGVkXCIsIGNvbXBsZXRlZCwgZmFsc2UgKTtcblx0d2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoIFwibG9hZFwiLCBjb21wbGV0ZWQsIGZhbHNlICk7XG5cdGpRdWVyeS5yZWFkeSgpO1xufVxuXG5qUXVlcnkucmVhZHkucHJvbWlzZSA9IGZ1bmN0aW9uKCBvYmogKSB7XG5cdGlmICggIXJlYWR5TGlzdCApIHtcblxuXHRcdHJlYWR5TGlzdCA9IGpRdWVyeS5EZWZlcnJlZCgpO1xuXG5cdFx0Ly8gQ2F0Y2ggY2FzZXMgd2hlcmUgJChkb2N1bWVudCkucmVhZHkoKSBpcyBjYWxsZWQgYWZ0ZXIgdGhlIGJyb3dzZXIgZXZlbnQgaGFzIGFscmVhZHkgb2NjdXJyZWQuXG5cdFx0Ly8gd2Ugb25jZSB0cmllZCB0byB1c2UgcmVhZHlTdGF0ZSBcImludGVyYWN0aXZlXCIgaGVyZSwgYnV0IGl0IGNhdXNlZCBpc3N1ZXMgbGlrZSB0aGUgb25lXG5cdFx0Ly8gZGlzY292ZXJlZCBieSBDaHJpc1MgaGVyZTogaHR0cDovL2J1Z3MuanF1ZXJ5LmNvbS90aWNrZXQvMTIyODIjY29tbWVudDoxNVxuXHRcdGlmICggZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gXCJjb21wbGV0ZVwiICkge1xuXHRcdFx0Ly8gSGFuZGxlIGl0IGFzeW5jaHJvbm91c2x5IHRvIGFsbG93IHNjcmlwdHMgdGhlIG9wcG9ydHVuaXR5IHRvIGRlbGF5IHJlYWR5XG5cdFx0XHRzZXRUaW1lb3V0KCBqUXVlcnkucmVhZHkgKTtcblxuXHRcdH0gZWxzZSB7XG5cblx0XHRcdC8vIFVzZSB0aGUgaGFuZHkgZXZlbnQgY2FsbGJhY2tcblx0XHRcdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIFwiRE9NQ29udGVudExvYWRlZFwiLCBjb21wbGV0ZWQsIGZhbHNlICk7XG5cblx0XHRcdC8vIEEgZmFsbGJhY2sgdG8gd2luZG93Lm9ubG9hZCwgdGhhdCB3aWxsIGFsd2F5cyB3b3JrXG5cdFx0XHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciggXCJsb2FkXCIsIGNvbXBsZXRlZCwgZmFsc2UgKTtcblx0XHR9XG5cdH1cblx0cmV0dXJuIHJlYWR5TGlzdC5wcm9taXNlKCBvYmogKTtcbn07XG5cbi8vIEtpY2sgb2ZmIHRoZSBET00gcmVhZHkgY2hlY2sgZXZlbiBpZiB0aGUgdXNlciBkb2VzIG5vdFxualF1ZXJ5LnJlYWR5LnByb21pc2UoKTtcblxuXG5cblxuLy8gTXVsdGlmdW5jdGlvbmFsIG1ldGhvZCB0byBnZXQgYW5kIHNldCB2YWx1ZXMgb2YgYSBjb2xsZWN0aW9uXG4vLyBUaGUgdmFsdWUvcyBjYW4gb3B0aW9uYWxseSBiZSBleGVjdXRlZCBpZiBpdCdzIGEgZnVuY3Rpb25cbnZhciBhY2Nlc3MgPSBqUXVlcnkuYWNjZXNzID0gZnVuY3Rpb24oIGVsZW1zLCBmbiwga2V5LCB2YWx1ZSwgY2hhaW5hYmxlLCBlbXB0eUdldCwgcmF3ICkge1xuXHR2YXIgaSA9IDAsXG5cdFx0bGVuID0gZWxlbXMubGVuZ3RoLFxuXHRcdGJ1bGsgPSBrZXkgPT0gbnVsbDtcblxuXHQvLyBTZXRzIG1hbnkgdmFsdWVzXG5cdGlmICggalF1ZXJ5LnR5cGUoIGtleSApID09PSBcIm9iamVjdFwiICkge1xuXHRcdGNoYWluYWJsZSA9IHRydWU7XG5cdFx0Zm9yICggaSBpbiBrZXkgKSB7XG5cdFx0XHRqUXVlcnkuYWNjZXNzKCBlbGVtcywgZm4sIGksIGtleVtpXSwgdHJ1ZSwgZW1wdHlHZXQsIHJhdyApO1xuXHRcdH1cblxuXHQvLyBTZXRzIG9uZSB2YWx1ZVxuXHR9IGVsc2UgaWYgKCB2YWx1ZSAhPT0gdW5kZWZpbmVkICkge1xuXHRcdGNoYWluYWJsZSA9IHRydWU7XG5cblx0XHRpZiAoICFqUXVlcnkuaXNGdW5jdGlvbiggdmFsdWUgKSApIHtcblx0XHRcdHJhdyA9IHRydWU7XG5cdFx0fVxuXG5cdFx0aWYgKCBidWxrICkge1xuXHRcdFx0Ly8gQnVsayBvcGVyYXRpb25zIHJ1biBhZ2FpbnN0IHRoZSBlbnRpcmUgc2V0XG5cdFx0XHRpZiAoIHJhdyApIHtcblx0XHRcdFx0Zm4uY2FsbCggZWxlbXMsIHZhbHVlICk7XG5cdFx0XHRcdGZuID0gbnVsbDtcblxuXHRcdFx0Ly8gLi4uZXhjZXB0IHdoZW4gZXhlY3V0aW5nIGZ1bmN0aW9uIHZhbHVlc1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0YnVsayA9IGZuO1xuXHRcdFx0XHRmbiA9IGZ1bmN0aW9uKCBlbGVtLCBrZXksIHZhbHVlICkge1xuXHRcdFx0XHRcdHJldHVybiBidWxrLmNhbGwoIGpRdWVyeSggZWxlbSApLCB2YWx1ZSApO1xuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmICggZm4gKSB7XG5cdFx0XHRmb3IgKCA7IGkgPCBsZW47IGkrKyApIHtcblx0XHRcdFx0Zm4oIGVsZW1zW2ldLCBrZXksIHJhdyA/IHZhbHVlIDogdmFsdWUuY2FsbCggZWxlbXNbaV0sIGksIGZuKCBlbGVtc1tpXSwga2V5ICkgKSApO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdHJldHVybiBjaGFpbmFibGUgP1xuXHRcdGVsZW1zIDpcblxuXHRcdC8vIEdldHNcblx0XHRidWxrID9cblx0XHRcdGZuLmNhbGwoIGVsZW1zICkgOlxuXHRcdFx0bGVuID8gZm4oIGVsZW1zWzBdLCBrZXkgKSA6IGVtcHR5R2V0O1xufTtcblxuXG4vKipcbiAqIERldGVybWluZXMgd2hldGhlciBhbiBvYmplY3QgY2FuIGhhdmUgZGF0YVxuICovXG5qUXVlcnkuYWNjZXB0RGF0YSA9IGZ1bmN0aW9uKCBvd25lciApIHtcblx0Ly8gQWNjZXB0cyBvbmx5OlxuXHQvLyAgLSBOb2RlXG5cdC8vICAgIC0gTm9kZS5FTEVNRU5UX05PREVcblx0Ly8gICAgLSBOb2RlLkRPQ1VNRU5UX05PREVcblx0Ly8gIC0gT2JqZWN0XG5cdC8vICAgIC0gQW55XG5cdC8qIGpzaGludCAtVzAxOCAqL1xuXHRyZXR1cm4gb3duZXIubm9kZVR5cGUgPT09IDEgfHwgb3duZXIubm9kZVR5cGUgPT09IDkgfHwgISggK293bmVyLm5vZGVUeXBlICk7XG59O1xuXG5cbmZ1bmN0aW9uIERhdGEoKSB7XG5cdC8vIFN1cHBvcnQ6IEFuZHJvaWQgPCA0LFxuXHQvLyBPbGQgV2ViS2l0IGRvZXMgbm90IGhhdmUgT2JqZWN0LnByZXZlbnRFeHRlbnNpb25zL2ZyZWV6ZSBtZXRob2QsXG5cdC8vIHJldHVybiBuZXcgZW1wdHkgb2JqZWN0IGluc3RlYWQgd2l0aCBubyBbW3NldF1dIGFjY2Vzc29yXG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eSggdGhpcy5jYWNoZSA9IHt9LCAwLCB7XG5cdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiB7fTtcblx0XHR9XG5cdH0pO1xuXG5cdHRoaXMuZXhwYW5kbyA9IGpRdWVyeS5leHBhbmRvICsgTWF0aC5yYW5kb20oKTtcbn1cblxuRGF0YS51aWQgPSAxO1xuRGF0YS5hY2NlcHRzID0galF1ZXJ5LmFjY2VwdERhdGE7XG5cbkRhdGEucHJvdG90eXBlID0ge1xuXHRrZXk6IGZ1bmN0aW9uKCBvd25lciApIHtcblx0XHQvLyBXZSBjYW4gYWNjZXB0IGRhdGEgZm9yIG5vbi1lbGVtZW50IG5vZGVzIGluIG1vZGVybiBicm93c2Vycyxcblx0XHQvLyBidXQgd2Ugc2hvdWxkIG5vdCwgc2VlICM4MzM1LlxuXHRcdC8vIEFsd2F5cyByZXR1cm4gdGhlIGtleSBmb3IgYSBmcm96ZW4gb2JqZWN0LlxuXHRcdGlmICggIURhdGEuYWNjZXB0cyggb3duZXIgKSApIHtcblx0XHRcdHJldHVybiAwO1xuXHRcdH1cblxuXHRcdHZhciBkZXNjcmlwdG9yID0ge30sXG5cdFx0XHQvLyBDaGVjayBpZiB0aGUgb3duZXIgb2JqZWN0IGFscmVhZHkgaGFzIGEgY2FjaGUga2V5XG5cdFx0XHR1bmxvY2sgPSBvd25lclsgdGhpcy5leHBhbmRvIF07XG5cblx0XHQvLyBJZiBub3QsIGNyZWF0ZSBvbmVcblx0XHRpZiAoICF1bmxvY2sgKSB7XG5cdFx0XHR1bmxvY2sgPSBEYXRhLnVpZCsrO1xuXG5cdFx0XHQvLyBTZWN1cmUgaXQgaW4gYSBub24tZW51bWVyYWJsZSwgbm9uLXdyaXRhYmxlIHByb3BlcnR5XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRkZXNjcmlwdG9yWyB0aGlzLmV4cGFuZG8gXSA9IHsgdmFsdWU6IHVubG9jayB9O1xuXHRcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydGllcyggb3duZXIsIGRlc2NyaXB0b3IgKTtcblxuXHRcdFx0Ly8gU3VwcG9ydDogQW5kcm9pZCA8IDRcblx0XHRcdC8vIEZhbGxiYWNrIHRvIGEgbGVzcyBzZWN1cmUgZGVmaW5pdGlvblxuXHRcdFx0fSBjYXRjaCAoIGUgKSB7XG5cdFx0XHRcdGRlc2NyaXB0b3JbIHRoaXMuZXhwYW5kbyBdID0gdW5sb2NrO1xuXHRcdFx0XHRqUXVlcnkuZXh0ZW5kKCBvd25lciwgZGVzY3JpcHRvciApO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIEVuc3VyZSB0aGUgY2FjaGUgb2JqZWN0XG5cdFx0aWYgKCAhdGhpcy5jYWNoZVsgdW5sb2NrIF0gKSB7XG5cdFx0XHR0aGlzLmNhY2hlWyB1bmxvY2sgXSA9IHt9O1xuXHRcdH1cblxuXHRcdHJldHVybiB1bmxvY2s7XG5cdH0sXG5cdHNldDogZnVuY3Rpb24oIG93bmVyLCBkYXRhLCB2YWx1ZSApIHtcblx0XHR2YXIgcHJvcCxcblx0XHRcdC8vIFRoZXJlIG1heSBiZSBhbiB1bmxvY2sgYXNzaWduZWQgdG8gdGhpcyBub2RlLFxuXHRcdFx0Ly8gaWYgdGhlcmUgaXMgbm8gZW50cnkgZm9yIHRoaXMgXCJvd25lclwiLCBjcmVhdGUgb25lIGlubGluZVxuXHRcdFx0Ly8gYW5kIHNldCB0aGUgdW5sb2NrIGFzIHRob3VnaCBhbiBvd25lciBlbnRyeSBoYWQgYWx3YXlzIGV4aXN0ZWRcblx0XHRcdHVubG9jayA9IHRoaXMua2V5KCBvd25lciApLFxuXHRcdFx0Y2FjaGUgPSB0aGlzLmNhY2hlWyB1bmxvY2sgXTtcblxuXHRcdC8vIEhhbmRsZTogWyBvd25lciwga2V5LCB2YWx1ZSBdIGFyZ3Ncblx0XHRpZiAoIHR5cGVvZiBkYXRhID09PSBcInN0cmluZ1wiICkge1xuXHRcdFx0Y2FjaGVbIGRhdGEgXSA9IHZhbHVlO1xuXG5cdFx0Ly8gSGFuZGxlOiBbIG93bmVyLCB7IHByb3BlcnRpZXMgfSBdIGFyZ3Ncblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gRnJlc2ggYXNzaWdubWVudHMgYnkgb2JqZWN0IGFyZSBzaGFsbG93IGNvcGllZFxuXHRcdFx0aWYgKCBqUXVlcnkuaXNFbXB0eU9iamVjdCggY2FjaGUgKSApIHtcblx0XHRcdFx0alF1ZXJ5LmV4dGVuZCggdGhpcy5jYWNoZVsgdW5sb2NrIF0sIGRhdGEgKTtcblx0XHRcdC8vIE90aGVyd2lzZSwgY29weSB0aGUgcHJvcGVydGllcyBvbmUtYnktb25lIHRvIHRoZSBjYWNoZSBvYmplY3Rcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGZvciAoIHByb3AgaW4gZGF0YSApIHtcblx0XHRcdFx0XHRjYWNoZVsgcHJvcCBdID0gZGF0YVsgcHJvcCBdO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBjYWNoZTtcblx0fSxcblx0Z2V0OiBmdW5jdGlvbiggb3duZXIsIGtleSApIHtcblx0XHQvLyBFaXRoZXIgYSB2YWxpZCBjYWNoZSBpcyBmb3VuZCwgb3Igd2lsbCBiZSBjcmVhdGVkLlxuXHRcdC8vIE5ldyBjYWNoZXMgd2lsbCBiZSBjcmVhdGVkIGFuZCB0aGUgdW5sb2NrIHJldHVybmVkLFxuXHRcdC8vIGFsbG93aW5nIGRpcmVjdCBhY2Nlc3MgdG8gdGhlIG5ld2x5IGNyZWF0ZWRcblx0XHQvLyBlbXB0eSBkYXRhIG9iamVjdC4gQSB2YWxpZCBvd25lciBvYmplY3QgbXVzdCBiZSBwcm92aWRlZC5cblx0XHR2YXIgY2FjaGUgPSB0aGlzLmNhY2hlWyB0aGlzLmtleSggb3duZXIgKSBdO1xuXG5cdFx0cmV0dXJuIGtleSA9PT0gdW5kZWZpbmVkID9cblx0XHRcdGNhY2hlIDogY2FjaGVbIGtleSBdO1xuXHR9LFxuXHRhY2Nlc3M6IGZ1bmN0aW9uKCBvd25lciwga2V5LCB2YWx1ZSApIHtcblx0XHR2YXIgc3RvcmVkO1xuXHRcdC8vIEluIGNhc2VzIHdoZXJlIGVpdGhlcjpcblx0XHQvL1xuXHRcdC8vICAgMS4gTm8ga2V5IHdhcyBzcGVjaWZpZWRcblx0XHQvLyAgIDIuIEEgc3RyaW5nIGtleSB3YXMgc3BlY2lmaWVkLCBidXQgbm8gdmFsdWUgcHJvdmlkZWRcblx0XHQvL1xuXHRcdC8vIFRha2UgdGhlIFwicmVhZFwiIHBhdGggYW5kIGFsbG93IHRoZSBnZXQgbWV0aG9kIHRvIGRldGVybWluZVxuXHRcdC8vIHdoaWNoIHZhbHVlIHRvIHJldHVybiwgcmVzcGVjdGl2ZWx5IGVpdGhlcjpcblx0XHQvL1xuXHRcdC8vICAgMS4gVGhlIGVudGlyZSBjYWNoZSBvYmplY3Rcblx0XHQvLyAgIDIuIFRoZSBkYXRhIHN0b3JlZCBhdCB0aGUga2V5XG5cdFx0Ly9cblx0XHRpZiAoIGtleSA9PT0gdW5kZWZpbmVkIHx8XG5cdFx0XHRcdCgoa2V5ICYmIHR5cGVvZiBrZXkgPT09IFwic3RyaW5nXCIpICYmIHZhbHVlID09PSB1bmRlZmluZWQpICkge1xuXG5cdFx0XHRzdG9yZWQgPSB0aGlzLmdldCggb3duZXIsIGtleSApO1xuXG5cdFx0XHRyZXR1cm4gc3RvcmVkICE9PSB1bmRlZmluZWQgP1xuXHRcdFx0XHRzdG9yZWQgOiB0aGlzLmdldCggb3duZXIsIGpRdWVyeS5jYW1lbENhc2Uoa2V5KSApO1xuXHRcdH1cblxuXHRcdC8vIFsqXVdoZW4gdGhlIGtleSBpcyBub3QgYSBzdHJpbmcsIG9yIGJvdGggYSBrZXkgYW5kIHZhbHVlXG5cdFx0Ly8gYXJlIHNwZWNpZmllZCwgc2V0IG9yIGV4dGVuZCAoZXhpc3Rpbmcgb2JqZWN0cykgd2l0aCBlaXRoZXI6XG5cdFx0Ly9cblx0XHQvLyAgIDEuIEFuIG9iamVjdCBvZiBwcm9wZXJ0aWVzXG5cdFx0Ly8gICAyLiBBIGtleSBhbmQgdmFsdWVcblx0XHQvL1xuXHRcdHRoaXMuc2V0KCBvd25lciwga2V5LCB2YWx1ZSApO1xuXG5cdFx0Ly8gU2luY2UgdGhlIFwic2V0XCIgcGF0aCBjYW4gaGF2ZSB0d28gcG9zc2libGUgZW50cnkgcG9pbnRzXG5cdFx0Ly8gcmV0dXJuIHRoZSBleHBlY3RlZCBkYXRhIGJhc2VkIG9uIHdoaWNoIHBhdGggd2FzIHRha2VuWypdXG5cdFx0cmV0dXJuIHZhbHVlICE9PSB1bmRlZmluZWQgPyB2YWx1ZSA6IGtleTtcblx0fSxcblx0cmVtb3ZlOiBmdW5jdGlvbiggb3duZXIsIGtleSApIHtcblx0XHR2YXIgaSwgbmFtZSwgY2FtZWwsXG5cdFx0XHR1bmxvY2sgPSB0aGlzLmtleSggb3duZXIgKSxcblx0XHRcdGNhY2hlID0gdGhpcy5jYWNoZVsgdW5sb2NrIF07XG5cblx0XHRpZiAoIGtleSA9PT0gdW5kZWZpbmVkICkge1xuXHRcdFx0dGhpcy5jYWNoZVsgdW5sb2NrIF0gPSB7fTtcblxuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBTdXBwb3J0IGFycmF5IG9yIHNwYWNlIHNlcGFyYXRlZCBzdHJpbmcgb2Yga2V5c1xuXHRcdFx0aWYgKCBqUXVlcnkuaXNBcnJheSgga2V5ICkgKSB7XG5cdFx0XHRcdC8vIElmIFwibmFtZVwiIGlzIGFuIGFycmF5IG9mIGtleXMuLi5cblx0XHRcdFx0Ly8gV2hlbiBkYXRhIGlzIGluaXRpYWxseSBjcmVhdGVkLCB2aWEgKFwia2V5XCIsIFwidmFsXCIpIHNpZ25hdHVyZSxcblx0XHRcdFx0Ly8ga2V5cyB3aWxsIGJlIGNvbnZlcnRlZCB0byBjYW1lbENhc2UuXG5cdFx0XHRcdC8vIFNpbmNlIHRoZXJlIGlzIG5vIHdheSB0byB0ZWxsIF9ob3dfIGEga2V5IHdhcyBhZGRlZCwgcmVtb3ZlXG5cdFx0XHRcdC8vIGJvdGggcGxhaW4ga2V5IGFuZCBjYW1lbENhc2Uga2V5LiAjMTI3ODZcblx0XHRcdFx0Ly8gVGhpcyB3aWxsIG9ubHkgcGVuYWxpemUgdGhlIGFycmF5IGFyZ3VtZW50IHBhdGguXG5cdFx0XHRcdG5hbWUgPSBrZXkuY29uY2F0KCBrZXkubWFwKCBqUXVlcnkuY2FtZWxDYXNlICkgKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNhbWVsID0galF1ZXJ5LmNhbWVsQ2FzZSgga2V5ICk7XG5cdFx0XHRcdC8vIFRyeSB0aGUgc3RyaW5nIGFzIGEga2V5IGJlZm9yZSBhbnkgbWFuaXB1bGF0aW9uXG5cdFx0XHRcdGlmICgga2V5IGluIGNhY2hlICkge1xuXHRcdFx0XHRcdG5hbWUgPSBbIGtleSwgY2FtZWwgXTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQvLyBJZiBhIGtleSB3aXRoIHRoZSBzcGFjZXMgZXhpc3RzLCB1c2UgaXQuXG5cdFx0XHRcdFx0Ly8gT3RoZXJ3aXNlLCBjcmVhdGUgYW4gYXJyYXkgYnkgbWF0Y2hpbmcgbm9uLXdoaXRlc3BhY2Vcblx0XHRcdFx0XHRuYW1lID0gY2FtZWw7XG5cdFx0XHRcdFx0bmFtZSA9IG5hbWUgaW4gY2FjaGUgP1xuXHRcdFx0XHRcdFx0WyBuYW1lIF0gOiAoIG5hbWUubWF0Y2goIHJub3R3aGl0ZSApIHx8IFtdICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0aSA9IG5hbWUubGVuZ3RoO1xuXHRcdFx0d2hpbGUgKCBpLS0gKSB7XG5cdFx0XHRcdGRlbGV0ZSBjYWNoZVsgbmFtZVsgaSBdIF07XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXHRoYXNEYXRhOiBmdW5jdGlvbiggb3duZXIgKSB7XG5cdFx0cmV0dXJuICFqUXVlcnkuaXNFbXB0eU9iamVjdChcblx0XHRcdHRoaXMuY2FjaGVbIG93bmVyWyB0aGlzLmV4cGFuZG8gXSBdIHx8IHt9XG5cdFx0KTtcblx0fSxcblx0ZGlzY2FyZDogZnVuY3Rpb24oIG93bmVyICkge1xuXHRcdGlmICggb3duZXJbIHRoaXMuZXhwYW5kbyBdICkge1xuXHRcdFx0ZGVsZXRlIHRoaXMuY2FjaGVbIG93bmVyWyB0aGlzLmV4cGFuZG8gXSBdO1xuXHRcdH1cblx0fVxufTtcbnZhciBkYXRhX3ByaXYgPSBuZXcgRGF0YSgpO1xuXG52YXIgZGF0YV91c2VyID0gbmV3IERhdGEoKTtcblxuXG5cbi8qXG5cdEltcGxlbWVudGF0aW9uIFN1bW1hcnlcblxuXHQxLiBFbmZvcmNlIEFQSSBzdXJmYWNlIGFuZCBzZW1hbnRpYyBjb21wYXRpYmlsaXR5IHdpdGggMS45LnggYnJhbmNoXG5cdDIuIEltcHJvdmUgdGhlIG1vZHVsZSdzIG1haW50YWluYWJpbGl0eSBieSByZWR1Y2luZyB0aGUgc3RvcmFnZVxuXHRcdHBhdGhzIHRvIGEgc2luZ2xlIG1lY2hhbmlzbS5cblx0My4gVXNlIHRoZSBzYW1lIHNpbmdsZSBtZWNoYW5pc20gdG8gc3VwcG9ydCBcInByaXZhdGVcIiBhbmQgXCJ1c2VyXCIgZGF0YS5cblx0NC4gX05ldmVyXyBleHBvc2UgXCJwcml2YXRlXCIgZGF0YSB0byB1c2VyIGNvZGUgKFRPRE86IERyb3AgX2RhdGEsIF9yZW1vdmVEYXRhKVxuXHQ1LiBBdm9pZCBleHBvc2luZyBpbXBsZW1lbnRhdGlvbiBkZXRhaWxzIG9uIHVzZXIgb2JqZWN0cyAoZWcuIGV4cGFuZG8gcHJvcGVydGllcylcblx0Ni4gUHJvdmlkZSBhIGNsZWFyIHBhdGggZm9yIGltcGxlbWVudGF0aW9uIHVwZ3JhZGUgdG8gV2Vha01hcCBpbiAyMDE0XG4qL1xudmFyIHJicmFjZSA9IC9eKD86XFx7W1xcd1xcV10qXFx9fFxcW1tcXHdcXFddKlxcXSkkLyxcblx0cm11bHRpRGFzaCA9IC8oW0EtWl0pL2c7XG5cbmZ1bmN0aW9uIGRhdGFBdHRyKCBlbGVtLCBrZXksIGRhdGEgKSB7XG5cdHZhciBuYW1lO1xuXG5cdC8vIElmIG5vdGhpbmcgd2FzIGZvdW5kIGludGVybmFsbHksIHRyeSB0byBmZXRjaCBhbnlcblx0Ly8gZGF0YSBmcm9tIHRoZSBIVE1MNSBkYXRhLSogYXR0cmlidXRlXG5cdGlmICggZGF0YSA9PT0gdW5kZWZpbmVkICYmIGVsZW0ubm9kZVR5cGUgPT09IDEgKSB7XG5cdFx0bmFtZSA9IFwiZGF0YS1cIiArIGtleS5yZXBsYWNlKCBybXVsdGlEYXNoLCBcIi0kMVwiICkudG9Mb3dlckNhc2UoKTtcblx0XHRkYXRhID0gZWxlbS5nZXRBdHRyaWJ1dGUoIG5hbWUgKTtcblxuXHRcdGlmICggdHlwZW9mIGRhdGEgPT09IFwic3RyaW5nXCIgKSB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRkYXRhID0gZGF0YSA9PT0gXCJ0cnVlXCIgPyB0cnVlIDpcblx0XHRcdFx0XHRkYXRhID09PSBcImZhbHNlXCIgPyBmYWxzZSA6XG5cdFx0XHRcdFx0ZGF0YSA9PT0gXCJudWxsXCIgPyBudWxsIDpcblx0XHRcdFx0XHQvLyBPbmx5IGNvbnZlcnQgdG8gYSBudW1iZXIgaWYgaXQgZG9lc24ndCBjaGFuZ2UgdGhlIHN0cmluZ1xuXHRcdFx0XHRcdCtkYXRhICsgXCJcIiA9PT0gZGF0YSA/ICtkYXRhIDpcblx0XHRcdFx0XHRyYnJhY2UudGVzdCggZGF0YSApID8galF1ZXJ5LnBhcnNlSlNPTiggZGF0YSApIDpcblx0XHRcdFx0XHRkYXRhO1xuXHRcdFx0fSBjYXRjaCggZSApIHt9XG5cblx0XHRcdC8vIE1ha2Ugc3VyZSB3ZSBzZXQgdGhlIGRhdGEgc28gaXQgaXNuJ3QgY2hhbmdlZCBsYXRlclxuXHRcdFx0ZGF0YV91c2VyLnNldCggZWxlbSwga2V5LCBkYXRhICk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGRhdGEgPSB1bmRlZmluZWQ7XG5cdFx0fVxuXHR9XG5cdHJldHVybiBkYXRhO1xufVxuXG5qUXVlcnkuZXh0ZW5kKHtcblx0aGFzRGF0YTogZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0cmV0dXJuIGRhdGFfdXNlci5oYXNEYXRhKCBlbGVtICkgfHwgZGF0YV9wcml2Lmhhc0RhdGEoIGVsZW0gKTtcblx0fSxcblxuXHRkYXRhOiBmdW5jdGlvbiggZWxlbSwgbmFtZSwgZGF0YSApIHtcblx0XHRyZXR1cm4gZGF0YV91c2VyLmFjY2VzcyggZWxlbSwgbmFtZSwgZGF0YSApO1xuXHR9LFxuXG5cdHJlbW92ZURhdGE6IGZ1bmN0aW9uKCBlbGVtLCBuYW1lICkge1xuXHRcdGRhdGFfdXNlci5yZW1vdmUoIGVsZW0sIG5hbWUgKTtcblx0fSxcblxuXHQvLyBUT0RPOiBOb3cgdGhhdCBhbGwgY2FsbHMgdG8gX2RhdGEgYW5kIF9yZW1vdmVEYXRhIGhhdmUgYmVlbiByZXBsYWNlZFxuXHQvLyB3aXRoIGRpcmVjdCBjYWxscyB0byBkYXRhX3ByaXYgbWV0aG9kcywgdGhlc2UgY2FuIGJlIGRlcHJlY2F0ZWQuXG5cdF9kYXRhOiBmdW5jdGlvbiggZWxlbSwgbmFtZSwgZGF0YSApIHtcblx0XHRyZXR1cm4gZGF0YV9wcml2LmFjY2VzcyggZWxlbSwgbmFtZSwgZGF0YSApO1xuXHR9LFxuXG5cdF9yZW1vdmVEYXRhOiBmdW5jdGlvbiggZWxlbSwgbmFtZSApIHtcblx0XHRkYXRhX3ByaXYucmVtb3ZlKCBlbGVtLCBuYW1lICk7XG5cdH1cbn0pO1xuXG5qUXVlcnkuZm4uZXh0ZW5kKHtcblx0ZGF0YTogZnVuY3Rpb24oIGtleSwgdmFsdWUgKSB7XG5cdFx0dmFyIGksIG5hbWUsIGRhdGEsXG5cdFx0XHRlbGVtID0gdGhpc1sgMCBdLFxuXHRcdFx0YXR0cnMgPSBlbGVtICYmIGVsZW0uYXR0cmlidXRlcztcblxuXHRcdC8vIEdldHMgYWxsIHZhbHVlc1xuXHRcdGlmICgga2V5ID09PSB1bmRlZmluZWQgKSB7XG5cdFx0XHRpZiAoIHRoaXMubGVuZ3RoICkge1xuXHRcdFx0XHRkYXRhID0gZGF0YV91c2VyLmdldCggZWxlbSApO1xuXG5cdFx0XHRcdGlmICggZWxlbS5ub2RlVHlwZSA9PT0gMSAmJiAhZGF0YV9wcml2LmdldCggZWxlbSwgXCJoYXNEYXRhQXR0cnNcIiApICkge1xuXHRcdFx0XHRcdGkgPSBhdHRycy5sZW5ndGg7XG5cdFx0XHRcdFx0d2hpbGUgKCBpLS0gKSB7XG5cblx0XHRcdFx0XHRcdC8vIFN1cHBvcnQ6IElFMTErXG5cdFx0XHRcdFx0XHQvLyBUaGUgYXR0cnMgZWxlbWVudHMgY2FuIGJlIG51bGwgKCMxNDg5NClcblx0XHRcdFx0XHRcdGlmICggYXR0cnNbIGkgXSApIHtcblx0XHRcdFx0XHRcdFx0bmFtZSA9IGF0dHJzWyBpIF0ubmFtZTtcblx0XHRcdFx0XHRcdFx0aWYgKCBuYW1lLmluZGV4T2YoIFwiZGF0YS1cIiApID09PSAwICkge1xuXHRcdFx0XHRcdFx0XHRcdG5hbWUgPSBqUXVlcnkuY2FtZWxDYXNlKCBuYW1lLnNsaWNlKDUpICk7XG5cdFx0XHRcdFx0XHRcdFx0ZGF0YUF0dHIoIGVsZW0sIG5hbWUsIGRhdGFbIG5hbWUgXSApO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGRhdGFfcHJpdi5zZXQoIGVsZW0sIFwiaGFzRGF0YUF0dHJzXCIsIHRydWUgKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gZGF0YTtcblx0XHR9XG5cblx0XHQvLyBTZXRzIG11bHRpcGxlIHZhbHVlc1xuXHRcdGlmICggdHlwZW9mIGtleSA9PT0gXCJvYmplY3RcIiApIHtcblx0XHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGRhdGFfdXNlci5zZXQoIHRoaXMsIGtleSApO1xuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGFjY2VzcyggdGhpcywgZnVuY3Rpb24oIHZhbHVlICkge1xuXHRcdFx0dmFyIGRhdGEsXG5cdFx0XHRcdGNhbWVsS2V5ID0galF1ZXJ5LmNhbWVsQ2FzZSgga2V5ICk7XG5cblx0XHRcdC8vIFRoZSBjYWxsaW5nIGpRdWVyeSBvYmplY3QgKGVsZW1lbnQgbWF0Y2hlcykgaXMgbm90IGVtcHR5XG5cdFx0XHQvLyAoYW5kIHRoZXJlZm9yZSBoYXMgYW4gZWxlbWVudCBhcHBlYXJzIGF0IHRoaXNbIDAgXSkgYW5kIHRoZVxuXHRcdFx0Ly8gYHZhbHVlYCBwYXJhbWV0ZXIgd2FzIG5vdCB1bmRlZmluZWQuIEFuIGVtcHR5IGpRdWVyeSBvYmplY3Rcblx0XHRcdC8vIHdpbGwgcmVzdWx0IGluIGB1bmRlZmluZWRgIGZvciBlbGVtID0gdGhpc1sgMCBdIHdoaWNoIHdpbGxcblx0XHRcdC8vIHRocm93IGFuIGV4Y2VwdGlvbiBpZiBhbiBhdHRlbXB0IHRvIHJlYWQgYSBkYXRhIGNhY2hlIGlzIG1hZGUuXG5cdFx0XHRpZiAoIGVsZW0gJiYgdmFsdWUgPT09IHVuZGVmaW5lZCApIHtcblx0XHRcdFx0Ly8gQXR0ZW1wdCB0byBnZXQgZGF0YSBmcm9tIHRoZSBjYWNoZVxuXHRcdFx0XHQvLyB3aXRoIHRoZSBrZXkgYXMtaXNcblx0XHRcdFx0ZGF0YSA9IGRhdGFfdXNlci5nZXQoIGVsZW0sIGtleSApO1xuXHRcdFx0XHRpZiAoIGRhdGEgIT09IHVuZGVmaW5lZCApIHtcblx0XHRcdFx0XHRyZXR1cm4gZGF0YTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIEF0dGVtcHQgdG8gZ2V0IGRhdGEgZnJvbSB0aGUgY2FjaGVcblx0XHRcdFx0Ly8gd2l0aCB0aGUga2V5IGNhbWVsaXplZFxuXHRcdFx0XHRkYXRhID0gZGF0YV91c2VyLmdldCggZWxlbSwgY2FtZWxLZXkgKTtcblx0XHRcdFx0aWYgKCBkYXRhICE9PSB1bmRlZmluZWQgKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGRhdGE7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBBdHRlbXB0IHRvIFwiZGlzY292ZXJcIiB0aGUgZGF0YSBpblxuXHRcdFx0XHQvLyBIVE1MNSBjdXN0b20gZGF0YS0qIGF0dHJzXG5cdFx0XHRcdGRhdGEgPSBkYXRhQXR0ciggZWxlbSwgY2FtZWxLZXksIHVuZGVmaW5lZCApO1xuXHRcdFx0XHRpZiAoIGRhdGEgIT09IHVuZGVmaW5lZCApIHtcblx0XHRcdFx0XHRyZXR1cm4gZGF0YTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIFdlIHRyaWVkIHJlYWxseSBoYXJkLCBidXQgdGhlIGRhdGEgZG9lc24ndCBleGlzdC5cblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBTZXQgdGhlIGRhdGEuLi5cblx0XHRcdHRoaXMuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdFx0Ly8gRmlyc3QsIGF0dGVtcHQgdG8gc3RvcmUgYSBjb3B5IG9yIHJlZmVyZW5jZSBvZiBhbnlcblx0XHRcdFx0Ly8gZGF0YSB0aGF0IG1pZ2h0J3ZlIGJlZW4gc3RvcmUgd2l0aCBhIGNhbWVsQ2FzZWQga2V5LlxuXHRcdFx0XHR2YXIgZGF0YSA9IGRhdGFfdXNlci5nZXQoIHRoaXMsIGNhbWVsS2V5ICk7XG5cblx0XHRcdFx0Ly8gRm9yIEhUTUw1IGRhdGEtKiBhdHRyaWJ1dGUgaW50ZXJvcCwgd2UgaGF2ZSB0b1xuXHRcdFx0XHQvLyBzdG9yZSBwcm9wZXJ0eSBuYW1lcyB3aXRoIGRhc2hlcyBpbiBhIGNhbWVsQ2FzZSBmb3JtLlxuXHRcdFx0XHQvLyBUaGlzIG1pZ2h0IG5vdCBhcHBseSB0byBhbGwgcHJvcGVydGllcy4uLipcblx0XHRcdFx0ZGF0YV91c2VyLnNldCggdGhpcywgY2FtZWxLZXksIHZhbHVlICk7XG5cblx0XHRcdFx0Ly8gKi4uLiBJbiB0aGUgY2FzZSBvZiBwcm9wZXJ0aWVzIHRoYXQgbWlnaHQgX2FjdHVhbGx5X1xuXHRcdFx0XHQvLyBoYXZlIGRhc2hlcywgd2UgbmVlZCB0byBhbHNvIHN0b3JlIGEgY29weSBvZiB0aGF0XG5cdFx0XHRcdC8vIHVuY2hhbmdlZCBwcm9wZXJ0eS5cblx0XHRcdFx0aWYgKCBrZXkuaW5kZXhPZihcIi1cIikgIT09IC0xICYmIGRhdGEgIT09IHVuZGVmaW5lZCApIHtcblx0XHRcdFx0XHRkYXRhX3VzZXIuc2V0KCB0aGlzLCBrZXksIHZhbHVlICk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH0sIG51bGwsIHZhbHVlLCBhcmd1bWVudHMubGVuZ3RoID4gMSwgbnVsbCwgdHJ1ZSApO1xuXHR9LFxuXG5cdHJlbW92ZURhdGE6IGZ1bmN0aW9uKCBrZXkgKSB7XG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdGRhdGFfdXNlci5yZW1vdmUoIHRoaXMsIGtleSApO1xuXHRcdH0pO1xuXHR9XG59KTtcblxuXG5qUXVlcnkuZXh0ZW5kKHtcblx0cXVldWU6IGZ1bmN0aW9uKCBlbGVtLCB0eXBlLCBkYXRhICkge1xuXHRcdHZhciBxdWV1ZTtcblxuXHRcdGlmICggZWxlbSApIHtcblx0XHRcdHR5cGUgPSAoIHR5cGUgfHwgXCJmeFwiICkgKyBcInF1ZXVlXCI7XG5cdFx0XHRxdWV1ZSA9IGRhdGFfcHJpdi5nZXQoIGVsZW0sIHR5cGUgKTtcblxuXHRcdFx0Ly8gU3BlZWQgdXAgZGVxdWV1ZSBieSBnZXR0aW5nIG91dCBxdWlja2x5IGlmIHRoaXMgaXMganVzdCBhIGxvb2t1cFxuXHRcdFx0aWYgKCBkYXRhICkge1xuXHRcdFx0XHRpZiAoICFxdWV1ZSB8fCBqUXVlcnkuaXNBcnJheSggZGF0YSApICkge1xuXHRcdFx0XHRcdHF1ZXVlID0gZGF0YV9wcml2LmFjY2VzcyggZWxlbSwgdHlwZSwgalF1ZXJ5Lm1ha2VBcnJheShkYXRhKSApO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHF1ZXVlLnB1c2goIGRhdGEgKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIHF1ZXVlIHx8IFtdO1xuXHRcdH1cblx0fSxcblxuXHRkZXF1ZXVlOiBmdW5jdGlvbiggZWxlbSwgdHlwZSApIHtcblx0XHR0eXBlID0gdHlwZSB8fCBcImZ4XCI7XG5cblx0XHR2YXIgcXVldWUgPSBqUXVlcnkucXVldWUoIGVsZW0sIHR5cGUgKSxcblx0XHRcdHN0YXJ0TGVuZ3RoID0gcXVldWUubGVuZ3RoLFxuXHRcdFx0Zm4gPSBxdWV1ZS5zaGlmdCgpLFxuXHRcdFx0aG9va3MgPSBqUXVlcnkuX3F1ZXVlSG9va3MoIGVsZW0sIHR5cGUgKSxcblx0XHRcdG5leHQgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0alF1ZXJ5LmRlcXVldWUoIGVsZW0sIHR5cGUgKTtcblx0XHRcdH07XG5cblx0XHQvLyBJZiB0aGUgZnggcXVldWUgaXMgZGVxdWV1ZWQsIGFsd2F5cyByZW1vdmUgdGhlIHByb2dyZXNzIHNlbnRpbmVsXG5cdFx0aWYgKCBmbiA9PT0gXCJpbnByb2dyZXNzXCIgKSB7XG5cdFx0XHRmbiA9IHF1ZXVlLnNoaWZ0KCk7XG5cdFx0XHRzdGFydExlbmd0aC0tO1xuXHRcdH1cblxuXHRcdGlmICggZm4gKSB7XG5cblx0XHRcdC8vIEFkZCBhIHByb2dyZXNzIHNlbnRpbmVsIHRvIHByZXZlbnQgdGhlIGZ4IHF1ZXVlIGZyb20gYmVpbmdcblx0XHRcdC8vIGF1dG9tYXRpY2FsbHkgZGVxdWV1ZWRcblx0XHRcdGlmICggdHlwZSA9PT0gXCJmeFwiICkge1xuXHRcdFx0XHRxdWV1ZS51bnNoaWZ0KCBcImlucHJvZ3Jlc3NcIiApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBjbGVhciB1cCB0aGUgbGFzdCBxdWV1ZSBzdG9wIGZ1bmN0aW9uXG5cdFx0XHRkZWxldGUgaG9va3Muc3RvcDtcblx0XHRcdGZuLmNhbGwoIGVsZW0sIG5leHQsIGhvb2tzICk7XG5cdFx0fVxuXG5cdFx0aWYgKCAhc3RhcnRMZW5ndGggJiYgaG9va3MgKSB7XG5cdFx0XHRob29rcy5lbXB0eS5maXJlKCk7XG5cdFx0fVxuXHR9LFxuXG5cdC8vIG5vdCBpbnRlbmRlZCBmb3IgcHVibGljIGNvbnN1bXB0aW9uIC0gZ2VuZXJhdGVzIGEgcXVldWVIb29rcyBvYmplY3QsIG9yIHJldHVybnMgdGhlIGN1cnJlbnQgb25lXG5cdF9xdWV1ZUhvb2tzOiBmdW5jdGlvbiggZWxlbSwgdHlwZSApIHtcblx0XHR2YXIga2V5ID0gdHlwZSArIFwicXVldWVIb29rc1wiO1xuXHRcdHJldHVybiBkYXRhX3ByaXYuZ2V0KCBlbGVtLCBrZXkgKSB8fCBkYXRhX3ByaXYuYWNjZXNzKCBlbGVtLCBrZXksIHtcblx0XHRcdGVtcHR5OiBqUXVlcnkuQ2FsbGJhY2tzKFwib25jZSBtZW1vcnlcIikuYWRkKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRkYXRhX3ByaXYucmVtb3ZlKCBlbGVtLCBbIHR5cGUgKyBcInF1ZXVlXCIsIGtleSBdICk7XG5cdFx0XHR9KVxuXHRcdH0pO1xuXHR9XG59KTtcblxualF1ZXJ5LmZuLmV4dGVuZCh7XG5cdHF1ZXVlOiBmdW5jdGlvbiggdHlwZSwgZGF0YSApIHtcblx0XHR2YXIgc2V0dGVyID0gMjtcblxuXHRcdGlmICggdHlwZW9mIHR5cGUgIT09IFwic3RyaW5nXCIgKSB7XG5cdFx0XHRkYXRhID0gdHlwZTtcblx0XHRcdHR5cGUgPSBcImZ4XCI7XG5cdFx0XHRzZXR0ZXItLTtcblx0XHR9XG5cblx0XHRpZiAoIGFyZ3VtZW50cy5sZW5ndGggPCBzZXR0ZXIgKSB7XG5cdFx0XHRyZXR1cm4galF1ZXJ5LnF1ZXVlKCB0aGlzWzBdLCB0eXBlICk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGRhdGEgPT09IHVuZGVmaW5lZCA/XG5cdFx0XHR0aGlzIDpcblx0XHRcdHRoaXMuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIHF1ZXVlID0galF1ZXJ5LnF1ZXVlKCB0aGlzLCB0eXBlLCBkYXRhICk7XG5cblx0XHRcdFx0Ly8gZW5zdXJlIGEgaG9va3MgZm9yIHRoaXMgcXVldWVcblx0XHRcdFx0alF1ZXJ5Ll9xdWV1ZUhvb2tzKCB0aGlzLCB0eXBlICk7XG5cblx0XHRcdFx0aWYgKCB0eXBlID09PSBcImZ4XCIgJiYgcXVldWVbMF0gIT09IFwiaW5wcm9ncmVzc1wiICkge1xuXHRcdFx0XHRcdGpRdWVyeS5kZXF1ZXVlKCB0aGlzLCB0eXBlICk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHR9LFxuXHRkZXF1ZXVlOiBmdW5jdGlvbiggdHlwZSApIHtcblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xuXHRcdFx0alF1ZXJ5LmRlcXVldWUoIHRoaXMsIHR5cGUgKTtcblx0XHR9KTtcblx0fSxcblx0Y2xlYXJRdWV1ZTogZnVuY3Rpb24oIHR5cGUgKSB7XG5cdFx0cmV0dXJuIHRoaXMucXVldWUoIHR5cGUgfHwgXCJmeFwiLCBbXSApO1xuXHR9LFxuXHQvLyBHZXQgYSBwcm9taXNlIHJlc29sdmVkIHdoZW4gcXVldWVzIG9mIGEgY2VydGFpbiB0eXBlXG5cdC8vIGFyZSBlbXB0aWVkIChmeCBpcyB0aGUgdHlwZSBieSBkZWZhdWx0KVxuXHRwcm9taXNlOiBmdW5jdGlvbiggdHlwZSwgb2JqICkge1xuXHRcdHZhciB0bXAsXG5cdFx0XHRjb3VudCA9IDEsXG5cdFx0XHRkZWZlciA9IGpRdWVyeS5EZWZlcnJlZCgpLFxuXHRcdFx0ZWxlbWVudHMgPSB0aGlzLFxuXHRcdFx0aSA9IHRoaXMubGVuZ3RoLFxuXHRcdFx0cmVzb2x2ZSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAoICEoIC0tY291bnQgKSApIHtcblx0XHRcdFx0XHRkZWZlci5yZXNvbHZlV2l0aCggZWxlbWVudHMsIFsgZWxlbWVudHMgXSApO1xuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXG5cdFx0aWYgKCB0eXBlb2YgdHlwZSAhPT0gXCJzdHJpbmdcIiApIHtcblx0XHRcdG9iaiA9IHR5cGU7XG5cdFx0XHR0eXBlID0gdW5kZWZpbmVkO1xuXHRcdH1cblx0XHR0eXBlID0gdHlwZSB8fCBcImZ4XCI7XG5cblx0XHR3aGlsZSAoIGktLSApIHtcblx0XHRcdHRtcCA9IGRhdGFfcHJpdi5nZXQoIGVsZW1lbnRzWyBpIF0sIHR5cGUgKyBcInF1ZXVlSG9va3NcIiApO1xuXHRcdFx0aWYgKCB0bXAgJiYgdG1wLmVtcHR5ICkge1xuXHRcdFx0XHRjb3VudCsrO1xuXHRcdFx0XHR0bXAuZW1wdHkuYWRkKCByZXNvbHZlICk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJlc29sdmUoKTtcblx0XHRyZXR1cm4gZGVmZXIucHJvbWlzZSggb2JqICk7XG5cdH1cbn0pO1xudmFyIHBudW0gPSAoL1srLV0/KD86XFxkKlxcLnwpXFxkKyg/OltlRV1bKy1dP1xcZCt8KS8pLnNvdXJjZTtcblxudmFyIGNzc0V4cGFuZCA9IFsgXCJUb3BcIiwgXCJSaWdodFwiLCBcIkJvdHRvbVwiLCBcIkxlZnRcIiBdO1xuXG52YXIgaXNIaWRkZW4gPSBmdW5jdGlvbiggZWxlbSwgZWwgKSB7XG5cdFx0Ly8gaXNIaWRkZW4gbWlnaHQgYmUgY2FsbGVkIGZyb20galF1ZXJ5I2ZpbHRlciBmdW5jdGlvbjtcblx0XHQvLyBpbiB0aGF0IGNhc2UsIGVsZW1lbnQgd2lsbCBiZSBzZWNvbmQgYXJndW1lbnRcblx0XHRlbGVtID0gZWwgfHwgZWxlbTtcblx0XHRyZXR1cm4galF1ZXJ5LmNzcyggZWxlbSwgXCJkaXNwbGF5XCIgKSA9PT0gXCJub25lXCIgfHwgIWpRdWVyeS5jb250YWlucyggZWxlbS5vd25lckRvY3VtZW50LCBlbGVtICk7XG5cdH07XG5cbnZhciByY2hlY2thYmxlVHlwZSA9ICgvXig/OmNoZWNrYm94fHJhZGlvKSQvaSk7XG5cblxuXG4oZnVuY3Rpb24oKSB7XG5cdHZhciBmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSxcblx0XHRkaXYgPSBmcmFnbWVudC5hcHBlbmRDaGlsZCggZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggXCJkaXZcIiApICksXG5cdFx0aW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCBcImlucHV0XCIgKTtcblxuXHQvLyAjMTEyMTcgLSBXZWJLaXQgbG9zZXMgY2hlY2sgd2hlbiB0aGUgbmFtZSBpcyBhZnRlciB0aGUgY2hlY2tlZCBhdHRyaWJ1dGVcblx0Ly8gU3VwcG9ydDogV2luZG93cyBXZWIgQXBwcyAoV1dBKVxuXHQvLyBgbmFtZWAgYW5kIGB0eXBlYCBuZWVkIC5zZXRBdHRyaWJ1dGUgZm9yIFdXQVxuXHRpbnB1dC5zZXRBdHRyaWJ1dGUoIFwidHlwZVwiLCBcInJhZGlvXCIgKTtcblx0aW5wdXQuc2V0QXR0cmlidXRlKCBcImNoZWNrZWRcIiwgXCJjaGVja2VkXCIgKTtcblx0aW5wdXQuc2V0QXR0cmlidXRlKCBcIm5hbWVcIiwgXCJ0XCIgKTtcblxuXHRkaXYuYXBwZW5kQ2hpbGQoIGlucHV0ICk7XG5cblx0Ly8gU3VwcG9ydDogU2FmYXJpIDUuMSwgaU9TIDUuMSwgQW5kcm9pZCA0LngsIEFuZHJvaWQgMi4zXG5cdC8vIG9sZCBXZWJLaXQgZG9lc24ndCBjbG9uZSBjaGVja2VkIHN0YXRlIGNvcnJlY3RseSBpbiBmcmFnbWVudHNcblx0c3VwcG9ydC5jaGVja0Nsb25lID0gZGl2LmNsb25lTm9kZSggdHJ1ZSApLmNsb25lTm9kZSggdHJ1ZSApLmxhc3RDaGlsZC5jaGVja2VkO1xuXG5cdC8vIE1ha2Ugc3VyZSB0ZXh0YXJlYSAoYW5kIGNoZWNrYm94KSBkZWZhdWx0VmFsdWUgaXMgcHJvcGVybHkgY2xvbmVkXG5cdC8vIFN1cHBvcnQ6IElFOS1JRTExK1xuXHRkaXYuaW5uZXJIVE1MID0gXCI8dGV4dGFyZWE+eDwvdGV4dGFyZWE+XCI7XG5cdHN1cHBvcnQubm9DbG9uZUNoZWNrZWQgPSAhIWRpdi5jbG9uZU5vZGUoIHRydWUgKS5sYXN0Q2hpbGQuZGVmYXVsdFZhbHVlO1xufSkoKTtcbnZhciBzdHJ1bmRlZmluZWQgPSB0eXBlb2YgdW5kZWZpbmVkO1xuXG5cblxuc3VwcG9ydC5mb2N1c2luQnViYmxlcyA9IFwib25mb2N1c2luXCIgaW4gd2luZG93O1xuXG5cbnZhclxuXHRya2V5RXZlbnQgPSAvXmtleS8sXG5cdHJtb3VzZUV2ZW50ID0gL14oPzptb3VzZXxwb2ludGVyfGNvbnRleHRtZW51KXxjbGljay8sXG5cdHJmb2N1c01vcnBoID0gL14oPzpmb2N1c2luZm9jdXN8Zm9jdXNvdXRibHVyKSQvLFxuXHRydHlwZW5hbWVzcGFjZSA9IC9eKFteLl0qKSg/OlxcLiguKyl8KSQvO1xuXG5mdW5jdGlvbiByZXR1cm5UcnVlKCkge1xuXHRyZXR1cm4gdHJ1ZTtcbn1cblxuZnVuY3Rpb24gcmV0dXJuRmFsc2UoKSB7XG5cdHJldHVybiBmYWxzZTtcbn1cblxuZnVuY3Rpb24gc2FmZUFjdGl2ZUVsZW1lbnQoKSB7XG5cdHRyeSB7XG5cdFx0cmV0dXJuIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7XG5cdH0gY2F0Y2ggKCBlcnIgKSB7IH1cbn1cblxuLypcbiAqIEhlbHBlciBmdW5jdGlvbnMgZm9yIG1hbmFnaW5nIGV2ZW50cyAtLSBub3QgcGFydCBvZiB0aGUgcHVibGljIGludGVyZmFjZS5cbiAqIFByb3BzIHRvIERlYW4gRWR3YXJkcycgYWRkRXZlbnQgbGlicmFyeSBmb3IgbWFueSBvZiB0aGUgaWRlYXMuXG4gKi9cbmpRdWVyeS5ldmVudCA9IHtcblxuXHRnbG9iYWw6IHt9LFxuXG5cdGFkZDogZnVuY3Rpb24oIGVsZW0sIHR5cGVzLCBoYW5kbGVyLCBkYXRhLCBzZWxlY3RvciApIHtcblxuXHRcdHZhciBoYW5kbGVPYmpJbiwgZXZlbnRIYW5kbGUsIHRtcCxcblx0XHRcdGV2ZW50cywgdCwgaGFuZGxlT2JqLFxuXHRcdFx0c3BlY2lhbCwgaGFuZGxlcnMsIHR5cGUsIG5hbWVzcGFjZXMsIG9yaWdUeXBlLFxuXHRcdFx0ZWxlbURhdGEgPSBkYXRhX3ByaXYuZ2V0KCBlbGVtICk7XG5cblx0XHQvLyBEb24ndCBhdHRhY2ggZXZlbnRzIHRvIG5vRGF0YSBvciB0ZXh0L2NvbW1lbnQgbm9kZXMgKGJ1dCBhbGxvdyBwbGFpbiBvYmplY3RzKVxuXHRcdGlmICggIWVsZW1EYXRhICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIENhbGxlciBjYW4gcGFzcyBpbiBhbiBvYmplY3Qgb2YgY3VzdG9tIGRhdGEgaW4gbGlldSBvZiB0aGUgaGFuZGxlclxuXHRcdGlmICggaGFuZGxlci5oYW5kbGVyICkge1xuXHRcdFx0aGFuZGxlT2JqSW4gPSBoYW5kbGVyO1xuXHRcdFx0aGFuZGxlciA9IGhhbmRsZU9iakluLmhhbmRsZXI7XG5cdFx0XHRzZWxlY3RvciA9IGhhbmRsZU9iakluLnNlbGVjdG9yO1xuXHRcdH1cblxuXHRcdC8vIE1ha2Ugc3VyZSB0aGF0IHRoZSBoYW5kbGVyIGhhcyBhIHVuaXF1ZSBJRCwgdXNlZCB0byBmaW5kL3JlbW92ZSBpdCBsYXRlclxuXHRcdGlmICggIWhhbmRsZXIuZ3VpZCApIHtcblx0XHRcdGhhbmRsZXIuZ3VpZCA9IGpRdWVyeS5ndWlkKys7XG5cdFx0fVxuXG5cdFx0Ly8gSW5pdCB0aGUgZWxlbWVudCdzIGV2ZW50IHN0cnVjdHVyZSBhbmQgbWFpbiBoYW5kbGVyLCBpZiB0aGlzIGlzIHRoZSBmaXJzdFxuXHRcdGlmICggIShldmVudHMgPSBlbGVtRGF0YS5ldmVudHMpICkge1xuXHRcdFx0ZXZlbnRzID0gZWxlbURhdGEuZXZlbnRzID0ge307XG5cdFx0fVxuXHRcdGlmICggIShldmVudEhhbmRsZSA9IGVsZW1EYXRhLmhhbmRsZSkgKSB7XG5cdFx0XHRldmVudEhhbmRsZSA9IGVsZW1EYXRhLmhhbmRsZSA9IGZ1bmN0aW9uKCBlICkge1xuXHRcdFx0XHQvLyBEaXNjYXJkIHRoZSBzZWNvbmQgZXZlbnQgb2YgYSBqUXVlcnkuZXZlbnQudHJpZ2dlcigpIGFuZFxuXHRcdFx0XHQvLyB3aGVuIGFuIGV2ZW50IGlzIGNhbGxlZCBhZnRlciBhIHBhZ2UgaGFzIHVubG9hZGVkXG5cdFx0XHRcdHJldHVybiB0eXBlb2YgalF1ZXJ5ICE9PSBzdHJ1bmRlZmluZWQgJiYgalF1ZXJ5LmV2ZW50LnRyaWdnZXJlZCAhPT0gZS50eXBlID9cblx0XHRcdFx0XHRqUXVlcnkuZXZlbnQuZGlzcGF0Y2guYXBwbHkoIGVsZW0sIGFyZ3VtZW50cyApIDogdW5kZWZpbmVkO1xuXHRcdFx0fTtcblx0XHR9XG5cblx0XHQvLyBIYW5kbGUgbXVsdGlwbGUgZXZlbnRzIHNlcGFyYXRlZCBieSBhIHNwYWNlXG5cdFx0dHlwZXMgPSAoIHR5cGVzIHx8IFwiXCIgKS5tYXRjaCggcm5vdHdoaXRlICkgfHwgWyBcIlwiIF07XG5cdFx0dCA9IHR5cGVzLmxlbmd0aDtcblx0XHR3aGlsZSAoIHQtLSApIHtcblx0XHRcdHRtcCA9IHJ0eXBlbmFtZXNwYWNlLmV4ZWMoIHR5cGVzW3RdICkgfHwgW107XG5cdFx0XHR0eXBlID0gb3JpZ1R5cGUgPSB0bXBbMV07XG5cdFx0XHRuYW1lc3BhY2VzID0gKCB0bXBbMl0gfHwgXCJcIiApLnNwbGl0KCBcIi5cIiApLnNvcnQoKTtcblxuXHRcdFx0Ly8gVGhlcmUgKm11c3QqIGJlIGEgdHlwZSwgbm8gYXR0YWNoaW5nIG5hbWVzcGFjZS1vbmx5IGhhbmRsZXJzXG5cdFx0XHRpZiAoICF0eXBlICkge1xuXHRcdFx0XHRjb250aW51ZTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gSWYgZXZlbnQgY2hhbmdlcyBpdHMgdHlwZSwgdXNlIHRoZSBzcGVjaWFsIGV2ZW50IGhhbmRsZXJzIGZvciB0aGUgY2hhbmdlZCB0eXBlXG5cdFx0XHRzcGVjaWFsID0galF1ZXJ5LmV2ZW50LnNwZWNpYWxbIHR5cGUgXSB8fCB7fTtcblxuXHRcdFx0Ly8gSWYgc2VsZWN0b3IgZGVmaW5lZCwgZGV0ZXJtaW5lIHNwZWNpYWwgZXZlbnQgYXBpIHR5cGUsIG90aGVyd2lzZSBnaXZlbiB0eXBlXG5cdFx0XHR0eXBlID0gKCBzZWxlY3RvciA/IHNwZWNpYWwuZGVsZWdhdGVUeXBlIDogc3BlY2lhbC5iaW5kVHlwZSApIHx8IHR5cGU7XG5cblx0XHRcdC8vIFVwZGF0ZSBzcGVjaWFsIGJhc2VkIG9uIG5ld2x5IHJlc2V0IHR5cGVcblx0XHRcdHNwZWNpYWwgPSBqUXVlcnkuZXZlbnQuc3BlY2lhbFsgdHlwZSBdIHx8IHt9O1xuXG5cdFx0XHQvLyBoYW5kbGVPYmogaXMgcGFzc2VkIHRvIGFsbCBldmVudCBoYW5kbGVyc1xuXHRcdFx0aGFuZGxlT2JqID0galF1ZXJ5LmV4dGVuZCh7XG5cdFx0XHRcdHR5cGU6IHR5cGUsXG5cdFx0XHRcdG9yaWdUeXBlOiBvcmlnVHlwZSxcblx0XHRcdFx0ZGF0YTogZGF0YSxcblx0XHRcdFx0aGFuZGxlcjogaGFuZGxlcixcblx0XHRcdFx0Z3VpZDogaGFuZGxlci5ndWlkLFxuXHRcdFx0XHRzZWxlY3Rvcjogc2VsZWN0b3IsXG5cdFx0XHRcdG5lZWRzQ29udGV4dDogc2VsZWN0b3IgJiYgalF1ZXJ5LmV4cHIubWF0Y2gubmVlZHNDb250ZXh0LnRlc3QoIHNlbGVjdG9yICksXG5cdFx0XHRcdG5hbWVzcGFjZTogbmFtZXNwYWNlcy5qb2luKFwiLlwiKVxuXHRcdFx0fSwgaGFuZGxlT2JqSW4gKTtcblxuXHRcdFx0Ly8gSW5pdCB0aGUgZXZlbnQgaGFuZGxlciBxdWV1ZSBpZiB3ZSdyZSB0aGUgZmlyc3Rcblx0XHRcdGlmICggIShoYW5kbGVycyA9IGV2ZW50c1sgdHlwZSBdKSApIHtcblx0XHRcdFx0aGFuZGxlcnMgPSBldmVudHNbIHR5cGUgXSA9IFtdO1xuXHRcdFx0XHRoYW5kbGVycy5kZWxlZ2F0ZUNvdW50ID0gMDtcblxuXHRcdFx0XHQvLyBPbmx5IHVzZSBhZGRFdmVudExpc3RlbmVyIGlmIHRoZSBzcGVjaWFsIGV2ZW50cyBoYW5kbGVyIHJldHVybnMgZmFsc2Vcblx0XHRcdFx0aWYgKCAhc3BlY2lhbC5zZXR1cCB8fCBzcGVjaWFsLnNldHVwLmNhbGwoIGVsZW0sIGRhdGEsIG5hbWVzcGFjZXMsIGV2ZW50SGFuZGxlICkgPT09IGZhbHNlICkge1xuXHRcdFx0XHRcdGlmICggZWxlbS5hZGRFdmVudExpc3RlbmVyICkge1xuXHRcdFx0XHRcdFx0ZWxlbS5hZGRFdmVudExpc3RlbmVyKCB0eXBlLCBldmVudEhhbmRsZSwgZmFsc2UgKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0aWYgKCBzcGVjaWFsLmFkZCApIHtcblx0XHRcdFx0c3BlY2lhbC5hZGQuY2FsbCggZWxlbSwgaGFuZGxlT2JqICk7XG5cblx0XHRcdFx0aWYgKCAhaGFuZGxlT2JqLmhhbmRsZXIuZ3VpZCApIHtcblx0XHRcdFx0XHRoYW5kbGVPYmouaGFuZGxlci5ndWlkID0gaGFuZGxlci5ndWlkO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8vIEFkZCB0byB0aGUgZWxlbWVudCdzIGhhbmRsZXIgbGlzdCwgZGVsZWdhdGVzIGluIGZyb250XG5cdFx0XHRpZiAoIHNlbGVjdG9yICkge1xuXHRcdFx0XHRoYW5kbGVycy5zcGxpY2UoIGhhbmRsZXJzLmRlbGVnYXRlQ291bnQrKywgMCwgaGFuZGxlT2JqICk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRoYW5kbGVycy5wdXNoKCBoYW5kbGVPYmogKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gS2VlcCB0cmFjayBvZiB3aGljaCBldmVudHMgaGF2ZSBldmVyIGJlZW4gdXNlZCwgZm9yIGV2ZW50IG9wdGltaXphdGlvblxuXHRcdFx0alF1ZXJ5LmV2ZW50Lmdsb2JhbFsgdHlwZSBdID0gdHJ1ZTtcblx0XHR9XG5cblx0fSxcblxuXHQvLyBEZXRhY2ggYW4gZXZlbnQgb3Igc2V0IG9mIGV2ZW50cyBmcm9tIGFuIGVsZW1lbnRcblx0cmVtb3ZlOiBmdW5jdGlvbiggZWxlbSwgdHlwZXMsIGhhbmRsZXIsIHNlbGVjdG9yLCBtYXBwZWRUeXBlcyApIHtcblxuXHRcdHZhciBqLCBvcmlnQ291bnQsIHRtcCxcblx0XHRcdGV2ZW50cywgdCwgaGFuZGxlT2JqLFxuXHRcdFx0c3BlY2lhbCwgaGFuZGxlcnMsIHR5cGUsIG5hbWVzcGFjZXMsIG9yaWdUeXBlLFxuXHRcdFx0ZWxlbURhdGEgPSBkYXRhX3ByaXYuaGFzRGF0YSggZWxlbSApICYmIGRhdGFfcHJpdi5nZXQoIGVsZW0gKTtcblxuXHRcdGlmICggIWVsZW1EYXRhIHx8ICEoZXZlbnRzID0gZWxlbURhdGEuZXZlbnRzKSApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBPbmNlIGZvciBlYWNoIHR5cGUubmFtZXNwYWNlIGluIHR5cGVzOyB0eXBlIG1heSBiZSBvbWl0dGVkXG5cdFx0dHlwZXMgPSAoIHR5cGVzIHx8IFwiXCIgKS5tYXRjaCggcm5vdHdoaXRlICkgfHwgWyBcIlwiIF07XG5cdFx0dCA9IHR5cGVzLmxlbmd0aDtcblx0XHR3aGlsZSAoIHQtLSApIHtcblx0XHRcdHRtcCA9IHJ0eXBlbmFtZXNwYWNlLmV4ZWMoIHR5cGVzW3RdICkgfHwgW107XG5cdFx0XHR0eXBlID0gb3JpZ1R5cGUgPSB0bXBbMV07XG5cdFx0XHRuYW1lc3BhY2VzID0gKCB0bXBbMl0gfHwgXCJcIiApLnNwbGl0KCBcIi5cIiApLnNvcnQoKTtcblxuXHRcdFx0Ly8gVW5iaW5kIGFsbCBldmVudHMgKG9uIHRoaXMgbmFtZXNwYWNlLCBpZiBwcm92aWRlZCkgZm9yIHRoZSBlbGVtZW50XG5cdFx0XHRpZiAoICF0eXBlICkge1xuXHRcdFx0XHRmb3IgKCB0eXBlIGluIGV2ZW50cyApIHtcblx0XHRcdFx0XHRqUXVlcnkuZXZlbnQucmVtb3ZlKCBlbGVtLCB0eXBlICsgdHlwZXNbIHQgXSwgaGFuZGxlciwgc2VsZWN0b3IsIHRydWUgKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRjb250aW51ZTtcblx0XHRcdH1cblxuXHRcdFx0c3BlY2lhbCA9IGpRdWVyeS5ldmVudC5zcGVjaWFsWyB0eXBlIF0gfHwge307XG5cdFx0XHR0eXBlID0gKCBzZWxlY3RvciA/IHNwZWNpYWwuZGVsZWdhdGVUeXBlIDogc3BlY2lhbC5iaW5kVHlwZSApIHx8IHR5cGU7XG5cdFx0XHRoYW5kbGVycyA9IGV2ZW50c1sgdHlwZSBdIHx8IFtdO1xuXHRcdFx0dG1wID0gdG1wWzJdICYmIG5ldyBSZWdFeHAoIFwiKF58XFxcXC4pXCIgKyBuYW1lc3BhY2VzLmpvaW4oXCJcXFxcLig/Oi4qXFxcXC58KVwiKSArIFwiKFxcXFwufCQpXCIgKTtcblxuXHRcdFx0Ly8gUmVtb3ZlIG1hdGNoaW5nIGV2ZW50c1xuXHRcdFx0b3JpZ0NvdW50ID0gaiA9IGhhbmRsZXJzLmxlbmd0aDtcblx0XHRcdHdoaWxlICggai0tICkge1xuXHRcdFx0XHRoYW5kbGVPYmogPSBoYW5kbGVyc1sgaiBdO1xuXG5cdFx0XHRcdGlmICggKCBtYXBwZWRUeXBlcyB8fCBvcmlnVHlwZSA9PT0gaGFuZGxlT2JqLm9yaWdUeXBlICkgJiZcblx0XHRcdFx0XHQoICFoYW5kbGVyIHx8IGhhbmRsZXIuZ3VpZCA9PT0gaGFuZGxlT2JqLmd1aWQgKSAmJlxuXHRcdFx0XHRcdCggIXRtcCB8fCB0bXAudGVzdCggaGFuZGxlT2JqLm5hbWVzcGFjZSApICkgJiZcblx0XHRcdFx0XHQoICFzZWxlY3RvciB8fCBzZWxlY3RvciA9PT0gaGFuZGxlT2JqLnNlbGVjdG9yIHx8IHNlbGVjdG9yID09PSBcIioqXCIgJiYgaGFuZGxlT2JqLnNlbGVjdG9yICkgKSB7XG5cdFx0XHRcdFx0aGFuZGxlcnMuc3BsaWNlKCBqLCAxICk7XG5cblx0XHRcdFx0XHRpZiAoIGhhbmRsZU9iai5zZWxlY3RvciApIHtcblx0XHRcdFx0XHRcdGhhbmRsZXJzLmRlbGVnYXRlQ291bnQtLTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYgKCBzcGVjaWFsLnJlbW92ZSApIHtcblx0XHRcdFx0XHRcdHNwZWNpYWwucmVtb3ZlLmNhbGwoIGVsZW0sIGhhbmRsZU9iaiApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvLyBSZW1vdmUgZ2VuZXJpYyBldmVudCBoYW5kbGVyIGlmIHdlIHJlbW92ZWQgc29tZXRoaW5nIGFuZCBubyBtb3JlIGhhbmRsZXJzIGV4aXN0XG5cdFx0XHQvLyAoYXZvaWRzIHBvdGVudGlhbCBmb3IgZW5kbGVzcyByZWN1cnNpb24gZHVyaW5nIHJlbW92YWwgb2Ygc3BlY2lhbCBldmVudCBoYW5kbGVycylcblx0XHRcdGlmICggb3JpZ0NvdW50ICYmICFoYW5kbGVycy5sZW5ndGggKSB7XG5cdFx0XHRcdGlmICggIXNwZWNpYWwudGVhcmRvd24gfHwgc3BlY2lhbC50ZWFyZG93bi5jYWxsKCBlbGVtLCBuYW1lc3BhY2VzLCBlbGVtRGF0YS5oYW5kbGUgKSA9PT0gZmFsc2UgKSB7XG5cdFx0XHRcdFx0alF1ZXJ5LnJlbW92ZUV2ZW50KCBlbGVtLCB0eXBlLCBlbGVtRGF0YS5oYW5kbGUgKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGRlbGV0ZSBldmVudHNbIHR5cGUgXTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBSZW1vdmUgdGhlIGV4cGFuZG8gaWYgaXQncyBubyBsb25nZXIgdXNlZFxuXHRcdGlmICggalF1ZXJ5LmlzRW1wdHlPYmplY3QoIGV2ZW50cyApICkge1xuXHRcdFx0ZGVsZXRlIGVsZW1EYXRhLmhhbmRsZTtcblx0XHRcdGRhdGFfcHJpdi5yZW1vdmUoIGVsZW0sIFwiZXZlbnRzXCIgKTtcblx0XHR9XG5cdH0sXG5cblx0dHJpZ2dlcjogZnVuY3Rpb24oIGV2ZW50LCBkYXRhLCBlbGVtLCBvbmx5SGFuZGxlcnMgKSB7XG5cblx0XHR2YXIgaSwgY3VyLCB0bXAsIGJ1YmJsZVR5cGUsIG9udHlwZSwgaGFuZGxlLCBzcGVjaWFsLFxuXHRcdFx0ZXZlbnRQYXRoID0gWyBlbGVtIHx8IGRvY3VtZW50IF0sXG5cdFx0XHR0eXBlID0gaGFzT3duLmNhbGwoIGV2ZW50LCBcInR5cGVcIiApID8gZXZlbnQudHlwZSA6IGV2ZW50LFxuXHRcdFx0bmFtZXNwYWNlcyA9IGhhc093bi5jYWxsKCBldmVudCwgXCJuYW1lc3BhY2VcIiApID8gZXZlbnQubmFtZXNwYWNlLnNwbGl0KFwiLlwiKSA6IFtdO1xuXG5cdFx0Y3VyID0gdG1wID0gZWxlbSA9IGVsZW0gfHwgZG9jdW1lbnQ7XG5cblx0XHQvLyBEb24ndCBkbyBldmVudHMgb24gdGV4dCBhbmQgY29tbWVudCBub2Rlc1xuXHRcdGlmICggZWxlbS5ub2RlVHlwZSA9PT0gMyB8fCBlbGVtLm5vZGVUeXBlID09PSA4ICkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIGZvY3VzL2JsdXIgbW9ycGhzIHRvIGZvY3VzaW4vb3V0OyBlbnN1cmUgd2UncmUgbm90IGZpcmluZyB0aGVtIHJpZ2h0IG5vd1xuXHRcdGlmICggcmZvY3VzTW9ycGgudGVzdCggdHlwZSArIGpRdWVyeS5ldmVudC50cmlnZ2VyZWQgKSApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAoIHR5cGUuaW5kZXhPZihcIi5cIikgPj0gMCApIHtcblx0XHRcdC8vIE5hbWVzcGFjZWQgdHJpZ2dlcjsgY3JlYXRlIGEgcmVnZXhwIHRvIG1hdGNoIGV2ZW50IHR5cGUgaW4gaGFuZGxlKClcblx0XHRcdG5hbWVzcGFjZXMgPSB0eXBlLnNwbGl0KFwiLlwiKTtcblx0XHRcdHR5cGUgPSBuYW1lc3BhY2VzLnNoaWZ0KCk7XG5cdFx0XHRuYW1lc3BhY2VzLnNvcnQoKTtcblx0XHR9XG5cdFx0b250eXBlID0gdHlwZS5pbmRleE9mKFwiOlwiKSA8IDAgJiYgXCJvblwiICsgdHlwZTtcblxuXHRcdC8vIENhbGxlciBjYW4gcGFzcyBpbiBhIGpRdWVyeS5FdmVudCBvYmplY3QsIE9iamVjdCwgb3IganVzdCBhbiBldmVudCB0eXBlIHN0cmluZ1xuXHRcdGV2ZW50ID0gZXZlbnRbIGpRdWVyeS5leHBhbmRvIF0gP1xuXHRcdFx0ZXZlbnQgOlxuXHRcdFx0bmV3IGpRdWVyeS5FdmVudCggdHlwZSwgdHlwZW9mIGV2ZW50ID09PSBcIm9iamVjdFwiICYmIGV2ZW50ICk7XG5cblx0XHQvLyBUcmlnZ2VyIGJpdG1hc2s6ICYgMSBmb3IgbmF0aXZlIGhhbmRsZXJzOyAmIDIgZm9yIGpRdWVyeSAoYWx3YXlzIHRydWUpXG5cdFx0ZXZlbnQuaXNUcmlnZ2VyID0gb25seUhhbmRsZXJzID8gMiA6IDM7XG5cdFx0ZXZlbnQubmFtZXNwYWNlID0gbmFtZXNwYWNlcy5qb2luKFwiLlwiKTtcblx0XHRldmVudC5uYW1lc3BhY2VfcmUgPSBldmVudC5uYW1lc3BhY2UgP1xuXHRcdFx0bmV3IFJlZ0V4cCggXCIoXnxcXFxcLilcIiArIG5hbWVzcGFjZXMuam9pbihcIlxcXFwuKD86LipcXFxcLnwpXCIpICsgXCIoXFxcXC58JClcIiApIDpcblx0XHRcdG51bGw7XG5cblx0XHQvLyBDbGVhbiB1cCB0aGUgZXZlbnQgaW4gY2FzZSBpdCBpcyBiZWluZyByZXVzZWRcblx0XHRldmVudC5yZXN1bHQgPSB1bmRlZmluZWQ7XG5cdFx0aWYgKCAhZXZlbnQudGFyZ2V0ICkge1xuXHRcdFx0ZXZlbnQudGFyZ2V0ID0gZWxlbTtcblx0XHR9XG5cblx0XHQvLyBDbG9uZSBhbnkgaW5jb21pbmcgZGF0YSBhbmQgcHJlcGVuZCB0aGUgZXZlbnQsIGNyZWF0aW5nIHRoZSBoYW5kbGVyIGFyZyBsaXN0XG5cdFx0ZGF0YSA9IGRhdGEgPT0gbnVsbCA/XG5cdFx0XHRbIGV2ZW50IF0gOlxuXHRcdFx0alF1ZXJ5Lm1ha2VBcnJheSggZGF0YSwgWyBldmVudCBdICk7XG5cblx0XHQvLyBBbGxvdyBzcGVjaWFsIGV2ZW50cyB0byBkcmF3IG91dHNpZGUgdGhlIGxpbmVzXG5cdFx0c3BlY2lhbCA9IGpRdWVyeS5ldmVudC5zcGVjaWFsWyB0eXBlIF0gfHwge307XG5cdFx0aWYgKCAhb25seUhhbmRsZXJzICYmIHNwZWNpYWwudHJpZ2dlciAmJiBzcGVjaWFsLnRyaWdnZXIuYXBwbHkoIGVsZW0sIGRhdGEgKSA9PT0gZmFsc2UgKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gRGV0ZXJtaW5lIGV2ZW50IHByb3BhZ2F0aW9uIHBhdGggaW4gYWR2YW5jZSwgcGVyIFczQyBldmVudHMgc3BlYyAoIzk5NTEpXG5cdFx0Ly8gQnViYmxlIHVwIHRvIGRvY3VtZW50LCB0aGVuIHRvIHdpbmRvdzsgd2F0Y2ggZm9yIGEgZ2xvYmFsIG93bmVyRG9jdW1lbnQgdmFyICgjOTcyNClcblx0XHRpZiAoICFvbmx5SGFuZGxlcnMgJiYgIXNwZWNpYWwubm9CdWJibGUgJiYgIWpRdWVyeS5pc1dpbmRvdyggZWxlbSApICkge1xuXG5cdFx0XHRidWJibGVUeXBlID0gc3BlY2lhbC5kZWxlZ2F0ZVR5cGUgfHwgdHlwZTtcblx0XHRcdGlmICggIXJmb2N1c01vcnBoLnRlc3QoIGJ1YmJsZVR5cGUgKyB0eXBlICkgKSB7XG5cdFx0XHRcdGN1ciA9IGN1ci5wYXJlbnROb2RlO1xuXHRcdFx0fVxuXHRcdFx0Zm9yICggOyBjdXI7IGN1ciA9IGN1ci5wYXJlbnROb2RlICkge1xuXHRcdFx0XHRldmVudFBhdGgucHVzaCggY3VyICk7XG5cdFx0XHRcdHRtcCA9IGN1cjtcblx0XHRcdH1cblxuXHRcdFx0Ly8gT25seSBhZGQgd2luZG93IGlmIHdlIGdvdCB0byBkb2N1bWVudCAoZS5nLiwgbm90IHBsYWluIG9iaiBvciBkZXRhY2hlZCBET00pXG5cdFx0XHRpZiAoIHRtcCA9PT0gKGVsZW0ub3duZXJEb2N1bWVudCB8fCBkb2N1bWVudCkgKSB7XG5cdFx0XHRcdGV2ZW50UGF0aC5wdXNoKCB0bXAuZGVmYXVsdFZpZXcgfHwgdG1wLnBhcmVudFdpbmRvdyB8fCB3aW5kb3cgKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBGaXJlIGhhbmRsZXJzIG9uIHRoZSBldmVudCBwYXRoXG5cdFx0aSA9IDA7XG5cdFx0d2hpbGUgKCAoY3VyID0gZXZlbnRQYXRoW2krK10pICYmICFldmVudC5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpICkge1xuXG5cdFx0XHRldmVudC50eXBlID0gaSA+IDEgP1xuXHRcdFx0XHRidWJibGVUeXBlIDpcblx0XHRcdFx0c3BlY2lhbC5iaW5kVHlwZSB8fCB0eXBlO1xuXG5cdFx0XHQvLyBqUXVlcnkgaGFuZGxlclxuXHRcdFx0aGFuZGxlID0gKCBkYXRhX3ByaXYuZ2V0KCBjdXIsIFwiZXZlbnRzXCIgKSB8fCB7fSApWyBldmVudC50eXBlIF0gJiYgZGF0YV9wcml2LmdldCggY3VyLCBcImhhbmRsZVwiICk7XG5cdFx0XHRpZiAoIGhhbmRsZSApIHtcblx0XHRcdFx0aGFuZGxlLmFwcGx5KCBjdXIsIGRhdGEgKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gTmF0aXZlIGhhbmRsZXJcblx0XHRcdGhhbmRsZSA9IG9udHlwZSAmJiBjdXJbIG9udHlwZSBdO1xuXHRcdFx0aWYgKCBoYW5kbGUgJiYgaGFuZGxlLmFwcGx5ICYmIGpRdWVyeS5hY2NlcHREYXRhKCBjdXIgKSApIHtcblx0XHRcdFx0ZXZlbnQucmVzdWx0ID0gaGFuZGxlLmFwcGx5KCBjdXIsIGRhdGEgKTtcblx0XHRcdFx0aWYgKCBldmVudC5yZXN1bHQgPT09IGZhbHNlICkge1xuXHRcdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0ZXZlbnQudHlwZSA9IHR5cGU7XG5cblx0XHQvLyBJZiBub2JvZHkgcHJldmVudGVkIHRoZSBkZWZhdWx0IGFjdGlvbiwgZG8gaXQgbm93XG5cdFx0aWYgKCAhb25seUhhbmRsZXJzICYmICFldmVudC5pc0RlZmF1bHRQcmV2ZW50ZWQoKSApIHtcblxuXHRcdFx0aWYgKCAoIXNwZWNpYWwuX2RlZmF1bHQgfHwgc3BlY2lhbC5fZGVmYXVsdC5hcHBseSggZXZlbnRQYXRoLnBvcCgpLCBkYXRhICkgPT09IGZhbHNlKSAmJlxuXHRcdFx0XHRqUXVlcnkuYWNjZXB0RGF0YSggZWxlbSApICkge1xuXG5cdFx0XHRcdC8vIENhbGwgYSBuYXRpdmUgRE9NIG1ldGhvZCBvbiB0aGUgdGFyZ2V0IHdpdGggdGhlIHNhbWUgbmFtZSBuYW1lIGFzIHRoZSBldmVudC5cblx0XHRcdFx0Ly8gRG9uJ3QgZG8gZGVmYXVsdCBhY3Rpb25zIG9uIHdpbmRvdywgdGhhdCdzIHdoZXJlIGdsb2JhbCB2YXJpYWJsZXMgYmUgKCM2MTcwKVxuXHRcdFx0XHRpZiAoIG9udHlwZSAmJiBqUXVlcnkuaXNGdW5jdGlvbiggZWxlbVsgdHlwZSBdICkgJiYgIWpRdWVyeS5pc1dpbmRvdyggZWxlbSApICkge1xuXG5cdFx0XHRcdFx0Ly8gRG9uJ3QgcmUtdHJpZ2dlciBhbiBvbkZPTyBldmVudCB3aGVuIHdlIGNhbGwgaXRzIEZPTygpIG1ldGhvZFxuXHRcdFx0XHRcdHRtcCA9IGVsZW1bIG9udHlwZSBdO1xuXG5cdFx0XHRcdFx0aWYgKCB0bXAgKSB7XG5cdFx0XHRcdFx0XHRlbGVtWyBvbnR5cGUgXSA9IG51bGw7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gUHJldmVudCByZS10cmlnZ2VyaW5nIG9mIHRoZSBzYW1lIGV2ZW50LCBzaW5jZSB3ZSBhbHJlYWR5IGJ1YmJsZWQgaXQgYWJvdmVcblx0XHRcdFx0XHRqUXVlcnkuZXZlbnQudHJpZ2dlcmVkID0gdHlwZTtcblx0XHRcdFx0XHRlbGVtWyB0eXBlIF0oKTtcblx0XHRcdFx0XHRqUXVlcnkuZXZlbnQudHJpZ2dlcmVkID0gdW5kZWZpbmVkO1xuXG5cdFx0XHRcdFx0aWYgKCB0bXAgKSB7XG5cdFx0XHRcdFx0XHRlbGVtWyBvbnR5cGUgXSA9IHRtcDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gZXZlbnQucmVzdWx0O1xuXHR9LFxuXG5cdGRpc3BhdGNoOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cblx0XHQvLyBNYWtlIGEgd3JpdGFibGUgalF1ZXJ5LkV2ZW50IGZyb20gdGhlIG5hdGl2ZSBldmVudCBvYmplY3Rcblx0XHRldmVudCA9IGpRdWVyeS5ldmVudC5maXgoIGV2ZW50ICk7XG5cblx0XHR2YXIgaSwgaiwgcmV0LCBtYXRjaGVkLCBoYW5kbGVPYmosXG5cdFx0XHRoYW5kbGVyUXVldWUgPSBbXSxcblx0XHRcdGFyZ3MgPSBzbGljZS5jYWxsKCBhcmd1bWVudHMgKSxcblx0XHRcdGhhbmRsZXJzID0gKCBkYXRhX3ByaXYuZ2V0KCB0aGlzLCBcImV2ZW50c1wiICkgfHwge30gKVsgZXZlbnQudHlwZSBdIHx8IFtdLFxuXHRcdFx0c3BlY2lhbCA9IGpRdWVyeS5ldmVudC5zcGVjaWFsWyBldmVudC50eXBlIF0gfHwge307XG5cblx0XHQvLyBVc2UgdGhlIGZpeC1lZCBqUXVlcnkuRXZlbnQgcmF0aGVyIHRoYW4gdGhlIChyZWFkLW9ubHkpIG5hdGl2ZSBldmVudFxuXHRcdGFyZ3NbMF0gPSBldmVudDtcblx0XHRldmVudC5kZWxlZ2F0ZVRhcmdldCA9IHRoaXM7XG5cblx0XHQvLyBDYWxsIHRoZSBwcmVEaXNwYXRjaCBob29rIGZvciB0aGUgbWFwcGVkIHR5cGUsIGFuZCBsZXQgaXQgYmFpbCBpZiBkZXNpcmVkXG5cdFx0aWYgKCBzcGVjaWFsLnByZURpc3BhdGNoICYmIHNwZWNpYWwucHJlRGlzcGF0Y2guY2FsbCggdGhpcywgZXZlbnQgKSA9PT0gZmFsc2UgKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gRGV0ZXJtaW5lIGhhbmRsZXJzXG5cdFx0aGFuZGxlclF1ZXVlID0galF1ZXJ5LmV2ZW50LmhhbmRsZXJzLmNhbGwoIHRoaXMsIGV2ZW50LCBoYW5kbGVycyApO1xuXG5cdFx0Ly8gUnVuIGRlbGVnYXRlcyBmaXJzdDsgdGhleSBtYXkgd2FudCB0byBzdG9wIHByb3BhZ2F0aW9uIGJlbmVhdGggdXNcblx0XHRpID0gMDtcblx0XHR3aGlsZSAoIChtYXRjaGVkID0gaGFuZGxlclF1ZXVlWyBpKysgXSkgJiYgIWV2ZW50LmlzUHJvcGFnYXRpb25TdG9wcGVkKCkgKSB7XG5cdFx0XHRldmVudC5jdXJyZW50VGFyZ2V0ID0gbWF0Y2hlZC5lbGVtO1xuXG5cdFx0XHRqID0gMDtcblx0XHRcdHdoaWxlICggKGhhbmRsZU9iaiA9IG1hdGNoZWQuaGFuZGxlcnNbIGorKyBdKSAmJiAhZXZlbnQuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQoKSApIHtcblxuXHRcdFx0XHQvLyBUcmlnZ2VyZWQgZXZlbnQgbXVzdCBlaXRoZXIgMSkgaGF2ZSBubyBuYW1lc3BhY2UsIG9yXG5cdFx0XHRcdC8vIDIpIGhhdmUgbmFtZXNwYWNlKHMpIGEgc3Vic2V0IG9yIGVxdWFsIHRvIHRob3NlIGluIHRoZSBib3VuZCBldmVudCAoYm90aCBjYW4gaGF2ZSBubyBuYW1lc3BhY2UpLlxuXHRcdFx0XHRpZiAoICFldmVudC5uYW1lc3BhY2VfcmUgfHwgZXZlbnQubmFtZXNwYWNlX3JlLnRlc3QoIGhhbmRsZU9iai5uYW1lc3BhY2UgKSApIHtcblxuXHRcdFx0XHRcdGV2ZW50LmhhbmRsZU9iaiA9IGhhbmRsZU9iajtcblx0XHRcdFx0XHRldmVudC5kYXRhID0gaGFuZGxlT2JqLmRhdGE7XG5cblx0XHRcdFx0XHRyZXQgPSAoIChqUXVlcnkuZXZlbnQuc3BlY2lhbFsgaGFuZGxlT2JqLm9yaWdUeXBlIF0gfHwge30pLmhhbmRsZSB8fCBoYW5kbGVPYmouaGFuZGxlciApXG5cdFx0XHRcdFx0XHRcdC5hcHBseSggbWF0Y2hlZC5lbGVtLCBhcmdzICk7XG5cblx0XHRcdFx0XHRpZiAoIHJldCAhPT0gdW5kZWZpbmVkICkge1xuXHRcdFx0XHRcdFx0aWYgKCAoZXZlbnQucmVzdWx0ID0gcmV0KSA9PT0gZmFsc2UgKSB7XG5cdFx0XHRcdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0XHRcdGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIENhbGwgdGhlIHBvc3REaXNwYXRjaCBob29rIGZvciB0aGUgbWFwcGVkIHR5cGVcblx0XHRpZiAoIHNwZWNpYWwucG9zdERpc3BhdGNoICkge1xuXHRcdFx0c3BlY2lhbC5wb3N0RGlzcGF0Y2guY2FsbCggdGhpcywgZXZlbnQgKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZXZlbnQucmVzdWx0O1xuXHR9LFxuXG5cdGhhbmRsZXJzOiBmdW5jdGlvbiggZXZlbnQsIGhhbmRsZXJzICkge1xuXHRcdHZhciBpLCBtYXRjaGVzLCBzZWwsIGhhbmRsZU9iaixcblx0XHRcdGhhbmRsZXJRdWV1ZSA9IFtdLFxuXHRcdFx0ZGVsZWdhdGVDb3VudCA9IGhhbmRsZXJzLmRlbGVnYXRlQ291bnQsXG5cdFx0XHRjdXIgPSBldmVudC50YXJnZXQ7XG5cblx0XHQvLyBGaW5kIGRlbGVnYXRlIGhhbmRsZXJzXG5cdFx0Ly8gQmxhY2staG9sZSBTVkcgPHVzZT4gaW5zdGFuY2UgdHJlZXMgKCMxMzE4MClcblx0XHQvLyBBdm9pZCBub24tbGVmdC1jbGljayBidWJibGluZyBpbiBGaXJlZm94ICgjMzg2MSlcblx0XHRpZiAoIGRlbGVnYXRlQ291bnQgJiYgY3VyLm5vZGVUeXBlICYmICghZXZlbnQuYnV0dG9uIHx8IGV2ZW50LnR5cGUgIT09IFwiY2xpY2tcIikgKSB7XG5cblx0XHRcdGZvciAoIDsgY3VyICE9PSB0aGlzOyBjdXIgPSBjdXIucGFyZW50Tm9kZSB8fCB0aGlzICkge1xuXG5cdFx0XHRcdC8vIERvbid0IHByb2Nlc3MgY2xpY2tzIG9uIGRpc2FibGVkIGVsZW1lbnRzICgjNjkxMSwgIzgxNjUsICMxMTM4MiwgIzExNzY0KVxuXHRcdFx0XHRpZiAoIGN1ci5kaXNhYmxlZCAhPT0gdHJ1ZSB8fCBldmVudC50eXBlICE9PSBcImNsaWNrXCIgKSB7XG5cdFx0XHRcdFx0bWF0Y2hlcyA9IFtdO1xuXHRcdFx0XHRcdGZvciAoIGkgPSAwOyBpIDwgZGVsZWdhdGVDb3VudDsgaSsrICkge1xuXHRcdFx0XHRcdFx0aGFuZGxlT2JqID0gaGFuZGxlcnNbIGkgXTtcblxuXHRcdFx0XHRcdFx0Ly8gRG9uJ3QgY29uZmxpY3Qgd2l0aCBPYmplY3QucHJvdG90eXBlIHByb3BlcnRpZXMgKCMxMzIwMylcblx0XHRcdFx0XHRcdHNlbCA9IGhhbmRsZU9iai5zZWxlY3RvciArIFwiIFwiO1xuXG5cdFx0XHRcdFx0XHRpZiAoIG1hdGNoZXNbIHNlbCBdID09PSB1bmRlZmluZWQgKSB7XG5cdFx0XHRcdFx0XHRcdG1hdGNoZXNbIHNlbCBdID0gaGFuZGxlT2JqLm5lZWRzQ29udGV4dCA/XG5cdFx0XHRcdFx0XHRcdFx0alF1ZXJ5KCBzZWwsIHRoaXMgKS5pbmRleCggY3VyICkgPj0gMCA6XG5cdFx0XHRcdFx0XHRcdFx0alF1ZXJ5LmZpbmQoIHNlbCwgdGhpcywgbnVsbCwgWyBjdXIgXSApLmxlbmd0aDtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGlmICggbWF0Y2hlc1sgc2VsIF0gKSB7XG5cdFx0XHRcdFx0XHRcdG1hdGNoZXMucHVzaCggaGFuZGxlT2JqICk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmICggbWF0Y2hlcy5sZW5ndGggKSB7XG5cdFx0XHRcdFx0XHRoYW5kbGVyUXVldWUucHVzaCh7IGVsZW06IGN1ciwgaGFuZGxlcnM6IG1hdGNoZXMgfSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gQWRkIHRoZSByZW1haW5pbmcgKGRpcmVjdGx5LWJvdW5kKSBoYW5kbGVyc1xuXHRcdGlmICggZGVsZWdhdGVDb3VudCA8IGhhbmRsZXJzLmxlbmd0aCApIHtcblx0XHRcdGhhbmRsZXJRdWV1ZS5wdXNoKHsgZWxlbTogdGhpcywgaGFuZGxlcnM6IGhhbmRsZXJzLnNsaWNlKCBkZWxlZ2F0ZUNvdW50ICkgfSk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGhhbmRsZXJRdWV1ZTtcblx0fSxcblxuXHQvLyBJbmNsdWRlcyBzb21lIGV2ZW50IHByb3BzIHNoYXJlZCBieSBLZXlFdmVudCBhbmQgTW91c2VFdmVudFxuXHRwcm9wczogXCJhbHRLZXkgYnViYmxlcyBjYW5jZWxhYmxlIGN0cmxLZXkgY3VycmVudFRhcmdldCBldmVudFBoYXNlIG1ldGFLZXkgcmVsYXRlZFRhcmdldCBzaGlmdEtleSB0YXJnZXQgdGltZVN0YW1wIHZpZXcgd2hpY2hcIi5zcGxpdChcIiBcIiksXG5cblx0Zml4SG9va3M6IHt9LFxuXG5cdGtleUhvb2tzOiB7XG5cdFx0cHJvcHM6IFwiY2hhciBjaGFyQ29kZSBrZXkga2V5Q29kZVwiLnNwbGl0KFwiIFwiKSxcblx0XHRmaWx0ZXI6IGZ1bmN0aW9uKCBldmVudCwgb3JpZ2luYWwgKSB7XG5cblx0XHRcdC8vIEFkZCB3aGljaCBmb3Iga2V5IGV2ZW50c1xuXHRcdFx0aWYgKCBldmVudC53aGljaCA9PSBudWxsICkge1xuXHRcdFx0XHRldmVudC53aGljaCA9IG9yaWdpbmFsLmNoYXJDb2RlICE9IG51bGwgPyBvcmlnaW5hbC5jaGFyQ29kZSA6IG9yaWdpbmFsLmtleUNvZGU7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBldmVudDtcblx0XHR9XG5cdH0sXG5cblx0bW91c2VIb29rczoge1xuXHRcdHByb3BzOiBcImJ1dHRvbiBidXR0b25zIGNsaWVudFggY2xpZW50WSBvZmZzZXRYIG9mZnNldFkgcGFnZVggcGFnZVkgc2NyZWVuWCBzY3JlZW5ZIHRvRWxlbWVudFwiLnNwbGl0KFwiIFwiKSxcblx0XHRmaWx0ZXI6IGZ1bmN0aW9uKCBldmVudCwgb3JpZ2luYWwgKSB7XG5cdFx0XHR2YXIgZXZlbnREb2MsIGRvYywgYm9keSxcblx0XHRcdFx0YnV0dG9uID0gb3JpZ2luYWwuYnV0dG9uO1xuXG5cdFx0XHQvLyBDYWxjdWxhdGUgcGFnZVgvWSBpZiBtaXNzaW5nIGFuZCBjbGllbnRYL1kgYXZhaWxhYmxlXG5cdFx0XHRpZiAoIGV2ZW50LnBhZ2VYID09IG51bGwgJiYgb3JpZ2luYWwuY2xpZW50WCAhPSBudWxsICkge1xuXHRcdFx0XHRldmVudERvYyA9IGV2ZW50LnRhcmdldC5vd25lckRvY3VtZW50IHx8IGRvY3VtZW50O1xuXHRcdFx0XHRkb2MgPSBldmVudERvYy5kb2N1bWVudEVsZW1lbnQ7XG5cdFx0XHRcdGJvZHkgPSBldmVudERvYy5ib2R5O1xuXG5cdFx0XHRcdGV2ZW50LnBhZ2VYID0gb3JpZ2luYWwuY2xpZW50WCArICggZG9jICYmIGRvYy5zY3JvbGxMZWZ0IHx8IGJvZHkgJiYgYm9keS5zY3JvbGxMZWZ0IHx8IDAgKSAtICggZG9jICYmIGRvYy5jbGllbnRMZWZ0IHx8IGJvZHkgJiYgYm9keS5jbGllbnRMZWZ0IHx8IDAgKTtcblx0XHRcdFx0ZXZlbnQucGFnZVkgPSBvcmlnaW5hbC5jbGllbnRZICsgKCBkb2MgJiYgZG9jLnNjcm9sbFRvcCAgfHwgYm9keSAmJiBib2R5LnNjcm9sbFRvcCAgfHwgMCApIC0gKCBkb2MgJiYgZG9jLmNsaWVudFRvcCAgfHwgYm9keSAmJiBib2R5LmNsaWVudFRvcCAgfHwgMCApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBBZGQgd2hpY2ggZm9yIGNsaWNrOiAxID09PSBsZWZ0OyAyID09PSBtaWRkbGU7IDMgPT09IHJpZ2h0XG5cdFx0XHQvLyBOb3RlOiBidXR0b24gaXMgbm90IG5vcm1hbGl6ZWQsIHNvIGRvbid0IHVzZSBpdFxuXHRcdFx0aWYgKCAhZXZlbnQud2hpY2ggJiYgYnV0dG9uICE9PSB1bmRlZmluZWQgKSB7XG5cdFx0XHRcdGV2ZW50LndoaWNoID0gKCBidXR0b24gJiAxID8gMSA6ICggYnV0dG9uICYgMiA/IDMgOiAoIGJ1dHRvbiAmIDQgPyAyIDogMCApICkgKTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIGV2ZW50O1xuXHRcdH1cblx0fSxcblxuXHRmaXg6IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRpZiAoIGV2ZW50WyBqUXVlcnkuZXhwYW5kbyBdICkge1xuXHRcdFx0cmV0dXJuIGV2ZW50O1xuXHRcdH1cblxuXHRcdC8vIENyZWF0ZSBhIHdyaXRhYmxlIGNvcHkgb2YgdGhlIGV2ZW50IG9iamVjdCBhbmQgbm9ybWFsaXplIHNvbWUgcHJvcGVydGllc1xuXHRcdHZhciBpLCBwcm9wLCBjb3B5LFxuXHRcdFx0dHlwZSA9IGV2ZW50LnR5cGUsXG5cdFx0XHRvcmlnaW5hbEV2ZW50ID0gZXZlbnQsXG5cdFx0XHRmaXhIb29rID0gdGhpcy5maXhIb29rc1sgdHlwZSBdO1xuXG5cdFx0aWYgKCAhZml4SG9vayApIHtcblx0XHRcdHRoaXMuZml4SG9va3NbIHR5cGUgXSA9IGZpeEhvb2sgPVxuXHRcdFx0XHRybW91c2VFdmVudC50ZXN0KCB0eXBlICkgPyB0aGlzLm1vdXNlSG9va3MgOlxuXHRcdFx0XHRya2V5RXZlbnQudGVzdCggdHlwZSApID8gdGhpcy5rZXlIb29rcyA6XG5cdFx0XHRcdHt9O1xuXHRcdH1cblx0XHRjb3B5ID0gZml4SG9vay5wcm9wcyA/IHRoaXMucHJvcHMuY29uY2F0KCBmaXhIb29rLnByb3BzICkgOiB0aGlzLnByb3BzO1xuXG5cdFx0ZXZlbnQgPSBuZXcgalF1ZXJ5LkV2ZW50KCBvcmlnaW5hbEV2ZW50ICk7XG5cblx0XHRpID0gY29weS5sZW5ndGg7XG5cdFx0d2hpbGUgKCBpLS0gKSB7XG5cdFx0XHRwcm9wID0gY29weVsgaSBdO1xuXHRcdFx0ZXZlbnRbIHByb3AgXSA9IG9yaWdpbmFsRXZlbnRbIHByb3AgXTtcblx0XHR9XG5cblx0XHQvLyBTdXBwb3J0OiBDb3Jkb3ZhIDIuNSAoV2ViS2l0KSAoIzEzMjU1KVxuXHRcdC8vIEFsbCBldmVudHMgc2hvdWxkIGhhdmUgYSB0YXJnZXQ7IENvcmRvdmEgZGV2aWNlcmVhZHkgZG9lc24ndFxuXHRcdGlmICggIWV2ZW50LnRhcmdldCApIHtcblx0XHRcdGV2ZW50LnRhcmdldCA9IGRvY3VtZW50O1xuXHRcdH1cblxuXHRcdC8vIFN1cHBvcnQ6IFNhZmFyaSA2LjArLCBDaHJvbWUgPCAyOFxuXHRcdC8vIFRhcmdldCBzaG91bGQgbm90IGJlIGEgdGV4dCBub2RlICgjNTA0LCAjMTMxNDMpXG5cdFx0aWYgKCBldmVudC50YXJnZXQubm9kZVR5cGUgPT09IDMgKSB7XG5cdFx0XHRldmVudC50YXJnZXQgPSBldmVudC50YXJnZXQucGFyZW50Tm9kZTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZml4SG9vay5maWx0ZXIgPyBmaXhIb29rLmZpbHRlciggZXZlbnQsIG9yaWdpbmFsRXZlbnQgKSA6IGV2ZW50O1xuXHR9LFxuXG5cdHNwZWNpYWw6IHtcblx0XHRsb2FkOiB7XG5cdFx0XHQvLyBQcmV2ZW50IHRyaWdnZXJlZCBpbWFnZS5sb2FkIGV2ZW50cyBmcm9tIGJ1YmJsaW5nIHRvIHdpbmRvdy5sb2FkXG5cdFx0XHRub0J1YmJsZTogdHJ1ZVxuXHRcdH0sXG5cdFx0Zm9jdXM6IHtcblx0XHRcdC8vIEZpcmUgbmF0aXZlIGV2ZW50IGlmIHBvc3NpYmxlIHNvIGJsdXIvZm9jdXMgc2VxdWVuY2UgaXMgY29ycmVjdFxuXHRcdFx0dHJpZ2dlcjogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmICggdGhpcyAhPT0gc2FmZUFjdGl2ZUVsZW1lbnQoKSAmJiB0aGlzLmZvY3VzICkge1xuXHRcdFx0XHRcdHRoaXMuZm9jdXMoKTtcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cdFx0XHRkZWxlZ2F0ZVR5cGU6IFwiZm9jdXNpblwiXG5cdFx0fSxcblx0XHRibHVyOiB7XG5cdFx0XHR0cmlnZ2VyOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKCB0aGlzID09PSBzYWZlQWN0aXZlRWxlbWVudCgpICYmIHRoaXMuYmx1ciApIHtcblx0XHRcdFx0XHR0aGlzLmJsdXIoKTtcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cdFx0XHRkZWxlZ2F0ZVR5cGU6IFwiZm9jdXNvdXRcIlxuXHRcdH0sXG5cdFx0Y2xpY2s6IHtcblx0XHRcdC8vIEZvciBjaGVja2JveCwgZmlyZSBuYXRpdmUgZXZlbnQgc28gY2hlY2tlZCBzdGF0ZSB3aWxsIGJlIHJpZ2h0XG5cdFx0XHR0cmlnZ2VyOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKCB0aGlzLnR5cGUgPT09IFwiY2hlY2tib3hcIiAmJiB0aGlzLmNsaWNrICYmIGpRdWVyeS5ub2RlTmFtZSggdGhpcywgXCJpbnB1dFwiICkgKSB7XG5cdFx0XHRcdFx0dGhpcy5jbGljaygpO1xuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0fSxcblxuXHRcdFx0Ly8gRm9yIGNyb3NzLWJyb3dzZXIgY29uc2lzdGVuY3ksIGRvbid0IGZpcmUgbmF0aXZlIC5jbGljaygpIG9uIGxpbmtzXG5cdFx0XHRfZGVmYXVsdDogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0XHRyZXR1cm4galF1ZXJ5Lm5vZGVOYW1lKCBldmVudC50YXJnZXQsIFwiYVwiICk7XG5cdFx0XHR9XG5cdFx0fSxcblxuXHRcdGJlZm9yZXVubG9hZDoge1xuXHRcdFx0cG9zdERpc3BhdGNoOiBmdW5jdGlvbiggZXZlbnQgKSB7XG5cblx0XHRcdFx0Ly8gU3VwcG9ydDogRmlyZWZveCAyMCtcblx0XHRcdFx0Ly8gRmlyZWZveCBkb2Vzbid0IGFsZXJ0IGlmIHRoZSByZXR1cm5WYWx1ZSBmaWVsZCBpcyBub3Qgc2V0LlxuXHRcdFx0XHRpZiAoIGV2ZW50LnJlc3VsdCAhPT0gdW5kZWZpbmVkICYmIGV2ZW50Lm9yaWdpbmFsRXZlbnQgKSB7XG5cdFx0XHRcdFx0ZXZlbnQub3JpZ2luYWxFdmVudC5yZXR1cm5WYWx1ZSA9IGV2ZW50LnJlc3VsdDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fSxcblxuXHRzaW11bGF0ZTogZnVuY3Rpb24oIHR5cGUsIGVsZW0sIGV2ZW50LCBidWJibGUgKSB7XG5cdFx0Ly8gUGlnZ3liYWNrIG9uIGEgZG9ub3IgZXZlbnQgdG8gc2ltdWxhdGUgYSBkaWZmZXJlbnQgb25lLlxuXHRcdC8vIEZha2Ugb3JpZ2luYWxFdmVudCB0byBhdm9pZCBkb25vcidzIHN0b3BQcm9wYWdhdGlvbiwgYnV0IGlmIHRoZVxuXHRcdC8vIHNpbXVsYXRlZCBldmVudCBwcmV2ZW50cyBkZWZhdWx0IHRoZW4gd2UgZG8gdGhlIHNhbWUgb24gdGhlIGRvbm9yLlxuXHRcdHZhciBlID0galF1ZXJ5LmV4dGVuZChcblx0XHRcdG5ldyBqUXVlcnkuRXZlbnQoKSxcblx0XHRcdGV2ZW50LFxuXHRcdFx0e1xuXHRcdFx0XHR0eXBlOiB0eXBlLFxuXHRcdFx0XHRpc1NpbXVsYXRlZDogdHJ1ZSxcblx0XHRcdFx0b3JpZ2luYWxFdmVudDoge31cblx0XHRcdH1cblx0XHQpO1xuXHRcdGlmICggYnViYmxlICkge1xuXHRcdFx0alF1ZXJ5LmV2ZW50LnRyaWdnZXIoIGUsIG51bGwsIGVsZW0gKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0alF1ZXJ5LmV2ZW50LmRpc3BhdGNoLmNhbGwoIGVsZW0sIGUgKTtcblx0XHR9XG5cdFx0aWYgKCBlLmlzRGVmYXVsdFByZXZlbnRlZCgpICkge1xuXHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHR9XG5cdH1cbn07XG5cbmpRdWVyeS5yZW1vdmVFdmVudCA9IGZ1bmN0aW9uKCBlbGVtLCB0eXBlLCBoYW5kbGUgKSB7XG5cdGlmICggZWxlbS5yZW1vdmVFdmVudExpc3RlbmVyICkge1xuXHRcdGVsZW0ucmVtb3ZlRXZlbnRMaXN0ZW5lciggdHlwZSwgaGFuZGxlLCBmYWxzZSApO1xuXHR9XG59O1xuXG5qUXVlcnkuRXZlbnQgPSBmdW5jdGlvbiggc3JjLCBwcm9wcyApIHtcblx0Ly8gQWxsb3cgaW5zdGFudGlhdGlvbiB3aXRob3V0IHRoZSAnbmV3JyBrZXl3b3JkXG5cdGlmICggISh0aGlzIGluc3RhbmNlb2YgalF1ZXJ5LkV2ZW50KSApIHtcblx0XHRyZXR1cm4gbmV3IGpRdWVyeS5FdmVudCggc3JjLCBwcm9wcyApO1xuXHR9XG5cblx0Ly8gRXZlbnQgb2JqZWN0XG5cdGlmICggc3JjICYmIHNyYy50eXBlICkge1xuXHRcdHRoaXMub3JpZ2luYWxFdmVudCA9IHNyYztcblx0XHR0aGlzLnR5cGUgPSBzcmMudHlwZTtcblxuXHRcdC8vIEV2ZW50cyBidWJibGluZyB1cCB0aGUgZG9jdW1lbnQgbWF5IGhhdmUgYmVlbiBtYXJrZWQgYXMgcHJldmVudGVkXG5cdFx0Ly8gYnkgYSBoYW5kbGVyIGxvd2VyIGRvd24gdGhlIHRyZWU7IHJlZmxlY3QgdGhlIGNvcnJlY3QgdmFsdWUuXG5cdFx0dGhpcy5pc0RlZmF1bHRQcmV2ZW50ZWQgPSBzcmMuZGVmYXVsdFByZXZlbnRlZCB8fFxuXHRcdFx0XHRzcmMuZGVmYXVsdFByZXZlbnRlZCA9PT0gdW5kZWZpbmVkICYmXG5cdFx0XHRcdC8vIFN1cHBvcnQ6IEFuZHJvaWQgPCA0LjBcblx0XHRcdFx0c3JjLnJldHVyblZhbHVlID09PSBmYWxzZSA/XG5cdFx0XHRyZXR1cm5UcnVlIDpcblx0XHRcdHJldHVybkZhbHNlO1xuXG5cdC8vIEV2ZW50IHR5cGVcblx0fSBlbHNlIHtcblx0XHR0aGlzLnR5cGUgPSBzcmM7XG5cdH1cblxuXHQvLyBQdXQgZXhwbGljaXRseSBwcm92aWRlZCBwcm9wZXJ0aWVzIG9udG8gdGhlIGV2ZW50IG9iamVjdFxuXHRpZiAoIHByb3BzICkge1xuXHRcdGpRdWVyeS5leHRlbmQoIHRoaXMsIHByb3BzICk7XG5cdH1cblxuXHQvLyBDcmVhdGUgYSB0aW1lc3RhbXAgaWYgaW5jb21pbmcgZXZlbnQgZG9lc24ndCBoYXZlIG9uZVxuXHR0aGlzLnRpbWVTdGFtcCA9IHNyYyAmJiBzcmMudGltZVN0YW1wIHx8IGpRdWVyeS5ub3coKTtcblxuXHQvLyBNYXJrIGl0IGFzIGZpeGVkXG5cdHRoaXNbIGpRdWVyeS5leHBhbmRvIF0gPSB0cnVlO1xufTtcblxuLy8galF1ZXJ5LkV2ZW50IGlzIGJhc2VkIG9uIERPTTMgRXZlbnRzIGFzIHNwZWNpZmllZCBieSB0aGUgRUNNQVNjcmlwdCBMYW5ndWFnZSBCaW5kaW5nXG4vLyBodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAzL1dELURPTS1MZXZlbC0zLUV2ZW50cy0yMDAzMDMzMS9lY21hLXNjcmlwdC1iaW5kaW5nLmh0bWxcbmpRdWVyeS5FdmVudC5wcm90b3R5cGUgPSB7XG5cdGlzRGVmYXVsdFByZXZlbnRlZDogcmV0dXJuRmFsc2UsXG5cdGlzUHJvcGFnYXRpb25TdG9wcGVkOiByZXR1cm5GYWxzZSxcblx0aXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ6IHJldHVybkZhbHNlLFxuXG5cdHByZXZlbnREZWZhdWx0OiBmdW5jdGlvbigpIHtcblx0XHR2YXIgZSA9IHRoaXMub3JpZ2luYWxFdmVudDtcblxuXHRcdHRoaXMuaXNEZWZhdWx0UHJldmVudGVkID0gcmV0dXJuVHJ1ZTtcblxuXHRcdGlmICggZSAmJiBlLnByZXZlbnREZWZhdWx0ICkge1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdH1cblx0fSxcblx0c3RvcFByb3BhZ2F0aW9uOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgZSA9IHRoaXMub3JpZ2luYWxFdmVudDtcblxuXHRcdHRoaXMuaXNQcm9wYWdhdGlvblN0b3BwZWQgPSByZXR1cm5UcnVlO1xuXG5cdFx0aWYgKCBlICYmIGUuc3RvcFByb3BhZ2F0aW9uICkge1xuXHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHR9XG5cdH0sXG5cdHN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbjogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGUgPSB0aGlzLm9yaWdpbmFsRXZlbnQ7XG5cblx0XHR0aGlzLmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkID0gcmV0dXJuVHJ1ZTtcblxuXHRcdGlmICggZSAmJiBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbiApIHtcblx0XHRcdGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG5cdFx0fVxuXG5cdFx0dGhpcy5zdG9wUHJvcGFnYXRpb24oKTtcblx0fVxufTtcblxuLy8gQ3JlYXRlIG1vdXNlZW50ZXIvbGVhdmUgZXZlbnRzIHVzaW5nIG1vdXNlb3Zlci9vdXQgYW5kIGV2ZW50LXRpbWUgY2hlY2tzXG4vLyBTdXBwb3J0OiBDaHJvbWUgMTUrXG5qUXVlcnkuZWFjaCh7XG5cdG1vdXNlZW50ZXI6IFwibW91c2VvdmVyXCIsXG5cdG1vdXNlbGVhdmU6IFwibW91c2VvdXRcIixcblx0cG9pbnRlcmVudGVyOiBcInBvaW50ZXJvdmVyXCIsXG5cdHBvaW50ZXJsZWF2ZTogXCJwb2ludGVyb3V0XCJcbn0sIGZ1bmN0aW9uKCBvcmlnLCBmaXggKSB7XG5cdGpRdWVyeS5ldmVudC5zcGVjaWFsWyBvcmlnIF0gPSB7XG5cdFx0ZGVsZWdhdGVUeXBlOiBmaXgsXG5cdFx0YmluZFR5cGU6IGZpeCxcblxuXHRcdGhhbmRsZTogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdFx0dmFyIHJldCxcblx0XHRcdFx0dGFyZ2V0ID0gdGhpcyxcblx0XHRcdFx0cmVsYXRlZCA9IGV2ZW50LnJlbGF0ZWRUYXJnZXQsXG5cdFx0XHRcdGhhbmRsZU9iaiA9IGV2ZW50LmhhbmRsZU9iajtcblxuXHRcdFx0Ly8gRm9yIG1vdXNlbnRlci9sZWF2ZSBjYWxsIHRoZSBoYW5kbGVyIGlmIHJlbGF0ZWQgaXMgb3V0c2lkZSB0aGUgdGFyZ2V0LlxuXHRcdFx0Ly8gTkI6IE5vIHJlbGF0ZWRUYXJnZXQgaWYgdGhlIG1vdXNlIGxlZnQvZW50ZXJlZCB0aGUgYnJvd3NlciB3aW5kb3dcblx0XHRcdGlmICggIXJlbGF0ZWQgfHwgKHJlbGF0ZWQgIT09IHRhcmdldCAmJiAhalF1ZXJ5LmNvbnRhaW5zKCB0YXJnZXQsIHJlbGF0ZWQgKSkgKSB7XG5cdFx0XHRcdGV2ZW50LnR5cGUgPSBoYW5kbGVPYmoub3JpZ1R5cGU7XG5cdFx0XHRcdHJldCA9IGhhbmRsZU9iai5oYW5kbGVyLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTtcblx0XHRcdFx0ZXZlbnQudHlwZSA9IGZpeDtcblx0XHRcdH1cblx0XHRcdHJldHVybiByZXQ7XG5cdFx0fVxuXHR9O1xufSk7XG5cbi8vIENyZWF0ZSBcImJ1YmJsaW5nXCIgZm9jdXMgYW5kIGJsdXIgZXZlbnRzXG4vLyBTdXBwb3J0OiBGaXJlZm94LCBDaHJvbWUsIFNhZmFyaVxuaWYgKCAhc3VwcG9ydC5mb2N1c2luQnViYmxlcyApIHtcblx0alF1ZXJ5LmVhY2goeyBmb2N1czogXCJmb2N1c2luXCIsIGJsdXI6IFwiZm9jdXNvdXRcIiB9LCBmdW5jdGlvbiggb3JpZywgZml4ICkge1xuXG5cdFx0Ly8gQXR0YWNoIGEgc2luZ2xlIGNhcHR1cmluZyBoYW5kbGVyIG9uIHRoZSBkb2N1bWVudCB3aGlsZSBzb21lb25lIHdhbnRzIGZvY3VzaW4vZm9jdXNvdXRcblx0XHR2YXIgaGFuZGxlciA9IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdFx0alF1ZXJ5LmV2ZW50LnNpbXVsYXRlKCBmaXgsIGV2ZW50LnRhcmdldCwgalF1ZXJ5LmV2ZW50LmZpeCggZXZlbnQgKSwgdHJ1ZSApO1xuXHRcdFx0fTtcblxuXHRcdGpRdWVyeS5ldmVudC5zcGVjaWFsWyBmaXggXSA9IHtcblx0XHRcdHNldHVwOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIGRvYyA9IHRoaXMub3duZXJEb2N1bWVudCB8fCB0aGlzLFxuXHRcdFx0XHRcdGF0dGFjaGVzID0gZGF0YV9wcml2LmFjY2VzcyggZG9jLCBmaXggKTtcblxuXHRcdFx0XHRpZiAoICFhdHRhY2hlcyApIHtcblx0XHRcdFx0XHRkb2MuYWRkRXZlbnRMaXN0ZW5lciggb3JpZywgaGFuZGxlciwgdHJ1ZSApO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGRhdGFfcHJpdi5hY2Nlc3MoIGRvYywgZml4LCAoIGF0dGFjaGVzIHx8IDAgKSArIDEgKTtcblx0XHRcdH0sXG5cdFx0XHR0ZWFyZG93bjogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBkb2MgPSB0aGlzLm93bmVyRG9jdW1lbnQgfHwgdGhpcyxcblx0XHRcdFx0XHRhdHRhY2hlcyA9IGRhdGFfcHJpdi5hY2Nlc3MoIGRvYywgZml4ICkgLSAxO1xuXG5cdFx0XHRcdGlmICggIWF0dGFjaGVzICkge1xuXHRcdFx0XHRcdGRvYy5yZW1vdmVFdmVudExpc3RlbmVyKCBvcmlnLCBoYW5kbGVyLCB0cnVlICk7XG5cdFx0XHRcdFx0ZGF0YV9wcml2LnJlbW92ZSggZG9jLCBmaXggKTtcblxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGRhdGFfcHJpdi5hY2Nlc3MoIGRvYywgZml4LCBhdHRhY2hlcyApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fTtcblx0fSk7XG59XG5cbmpRdWVyeS5mbi5leHRlbmQoe1xuXG5cdG9uOiBmdW5jdGlvbiggdHlwZXMsIHNlbGVjdG9yLCBkYXRhLCBmbiwgLypJTlRFUk5BTCovIG9uZSApIHtcblx0XHR2YXIgb3JpZ0ZuLCB0eXBlO1xuXG5cdFx0Ly8gVHlwZXMgY2FuIGJlIGEgbWFwIG9mIHR5cGVzL2hhbmRsZXJzXG5cdFx0aWYgKCB0eXBlb2YgdHlwZXMgPT09IFwib2JqZWN0XCIgKSB7XG5cdFx0XHQvLyAoIHR5cGVzLU9iamVjdCwgc2VsZWN0b3IsIGRhdGEgKVxuXHRcdFx0aWYgKCB0eXBlb2Ygc2VsZWN0b3IgIT09IFwic3RyaW5nXCIgKSB7XG5cdFx0XHRcdC8vICggdHlwZXMtT2JqZWN0LCBkYXRhIClcblx0XHRcdFx0ZGF0YSA9IGRhdGEgfHwgc2VsZWN0b3I7XG5cdFx0XHRcdHNlbGVjdG9yID0gdW5kZWZpbmVkO1xuXHRcdFx0fVxuXHRcdFx0Zm9yICggdHlwZSBpbiB0eXBlcyApIHtcblx0XHRcdFx0dGhpcy5vbiggdHlwZSwgc2VsZWN0b3IsIGRhdGEsIHR5cGVzWyB0eXBlIF0sIG9uZSApO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fVxuXG5cdFx0aWYgKCBkYXRhID09IG51bGwgJiYgZm4gPT0gbnVsbCApIHtcblx0XHRcdC8vICggdHlwZXMsIGZuIClcblx0XHRcdGZuID0gc2VsZWN0b3I7XG5cdFx0XHRkYXRhID0gc2VsZWN0b3IgPSB1bmRlZmluZWQ7XG5cdFx0fSBlbHNlIGlmICggZm4gPT0gbnVsbCApIHtcblx0XHRcdGlmICggdHlwZW9mIHNlbGVjdG9yID09PSBcInN0cmluZ1wiICkge1xuXHRcdFx0XHQvLyAoIHR5cGVzLCBzZWxlY3RvciwgZm4gKVxuXHRcdFx0XHRmbiA9IGRhdGE7XG5cdFx0XHRcdGRhdGEgPSB1bmRlZmluZWQ7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyAoIHR5cGVzLCBkYXRhLCBmbiApXG5cdFx0XHRcdGZuID0gZGF0YTtcblx0XHRcdFx0ZGF0YSA9IHNlbGVjdG9yO1xuXHRcdFx0XHRzZWxlY3RvciA9IHVuZGVmaW5lZDtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYgKCBmbiA9PT0gZmFsc2UgKSB7XG5cdFx0XHRmbiA9IHJldHVybkZhbHNlO1xuXHRcdH0gZWxzZSBpZiAoICFmbiApIHtcblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH1cblxuXHRcdGlmICggb25lID09PSAxICkge1xuXHRcdFx0b3JpZ0ZuID0gZm47XG5cdFx0XHRmbiA9IGZ1bmN0aW9uKCBldmVudCApIHtcblx0XHRcdFx0Ly8gQ2FuIHVzZSBhbiBlbXB0eSBzZXQsIHNpbmNlIGV2ZW50IGNvbnRhaW5zIHRoZSBpbmZvXG5cdFx0XHRcdGpRdWVyeSgpLm9mZiggZXZlbnQgKTtcblx0XHRcdFx0cmV0dXJuIG9yaWdGbi5hcHBseSggdGhpcywgYXJndW1lbnRzICk7XG5cdFx0XHR9O1xuXHRcdFx0Ly8gVXNlIHNhbWUgZ3VpZCBzbyBjYWxsZXIgY2FuIHJlbW92ZSB1c2luZyBvcmlnRm5cblx0XHRcdGZuLmd1aWQgPSBvcmlnRm4uZ3VpZCB8fCAoIG9yaWdGbi5ndWlkID0galF1ZXJ5Lmd1aWQrKyApO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcy5lYWNoKCBmdW5jdGlvbigpIHtcblx0XHRcdGpRdWVyeS5ldmVudC5hZGQoIHRoaXMsIHR5cGVzLCBmbiwgZGF0YSwgc2VsZWN0b3IgKTtcblx0XHR9KTtcblx0fSxcblx0b25lOiBmdW5jdGlvbiggdHlwZXMsIHNlbGVjdG9yLCBkYXRhLCBmbiApIHtcblx0XHRyZXR1cm4gdGhpcy5vbiggdHlwZXMsIHNlbGVjdG9yLCBkYXRhLCBmbiwgMSApO1xuXHR9LFxuXHRvZmY6IGZ1bmN0aW9uKCB0eXBlcywgc2VsZWN0b3IsIGZuICkge1xuXHRcdHZhciBoYW5kbGVPYmosIHR5cGU7XG5cdFx0aWYgKCB0eXBlcyAmJiB0eXBlcy5wcmV2ZW50RGVmYXVsdCAmJiB0eXBlcy5oYW5kbGVPYmogKSB7XG5cdFx0XHQvLyAoIGV2ZW50ICkgIGRpc3BhdGNoZWQgalF1ZXJ5LkV2ZW50XG5cdFx0XHRoYW5kbGVPYmogPSB0eXBlcy5oYW5kbGVPYmo7XG5cdFx0XHRqUXVlcnkoIHR5cGVzLmRlbGVnYXRlVGFyZ2V0ICkub2ZmKFxuXHRcdFx0XHRoYW5kbGVPYmoubmFtZXNwYWNlID8gaGFuZGxlT2JqLm9yaWdUeXBlICsgXCIuXCIgKyBoYW5kbGVPYmoubmFtZXNwYWNlIDogaGFuZGxlT2JqLm9yaWdUeXBlLFxuXHRcdFx0XHRoYW5kbGVPYmouc2VsZWN0b3IsXG5cdFx0XHRcdGhhbmRsZU9iai5oYW5kbGVyXG5cdFx0XHQpO1xuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fVxuXHRcdGlmICggdHlwZW9mIHR5cGVzID09PSBcIm9iamVjdFwiICkge1xuXHRcdFx0Ly8gKCB0eXBlcy1vYmplY3QgWywgc2VsZWN0b3JdIClcblx0XHRcdGZvciAoIHR5cGUgaW4gdHlwZXMgKSB7XG5cdFx0XHRcdHRoaXMub2ZmKCB0eXBlLCBzZWxlY3RvciwgdHlwZXNbIHR5cGUgXSApO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fVxuXHRcdGlmICggc2VsZWN0b3IgPT09IGZhbHNlIHx8IHR5cGVvZiBzZWxlY3RvciA9PT0gXCJmdW5jdGlvblwiICkge1xuXHRcdFx0Ly8gKCB0eXBlcyBbLCBmbl0gKVxuXHRcdFx0Zm4gPSBzZWxlY3Rvcjtcblx0XHRcdHNlbGVjdG9yID0gdW5kZWZpbmVkO1xuXHRcdH1cblx0XHRpZiAoIGZuID09PSBmYWxzZSApIHtcblx0XHRcdGZuID0gcmV0dXJuRmFsc2U7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0XHRqUXVlcnkuZXZlbnQucmVtb3ZlKCB0aGlzLCB0eXBlcywgZm4sIHNlbGVjdG9yICk7XG5cdFx0fSk7XG5cdH0sXG5cblx0dHJpZ2dlcjogZnVuY3Rpb24oIHR5cGUsIGRhdGEgKSB7XG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdGpRdWVyeS5ldmVudC50cmlnZ2VyKCB0eXBlLCBkYXRhLCB0aGlzICk7XG5cdFx0fSk7XG5cdH0sXG5cdHRyaWdnZXJIYW5kbGVyOiBmdW5jdGlvbiggdHlwZSwgZGF0YSApIHtcblx0XHR2YXIgZWxlbSA9IHRoaXNbMF07XG5cdFx0aWYgKCBlbGVtICkge1xuXHRcdFx0cmV0dXJuIGpRdWVyeS5ldmVudC50cmlnZ2VyKCB0eXBlLCBkYXRhLCBlbGVtLCB0cnVlICk7XG5cdFx0fVxuXHR9XG59KTtcblxuXG52YXJcblx0cnhodG1sVGFnID0gLzwoPyFhcmVhfGJyfGNvbHxlbWJlZHxocnxpbWd8aW5wdXR8bGlua3xtZXRhfHBhcmFtKSgoW1xcdzpdKylbXj5dKilcXC8+L2dpLFxuXHRydGFnTmFtZSA9IC88KFtcXHc6XSspLyxcblx0cmh0bWwgPSAvPHwmIz9cXHcrOy8sXG5cdHJub0lubmVyaHRtbCA9IC88KD86c2NyaXB0fHN0eWxlfGxpbmspL2ksXG5cdC8vIGNoZWNrZWQ9XCJjaGVja2VkXCIgb3IgY2hlY2tlZFxuXHRyY2hlY2tlZCA9IC9jaGVja2VkXFxzKig/OltePV18PVxccyouY2hlY2tlZC4pL2ksXG5cdHJzY3JpcHRUeXBlID0gL14kfFxcLyg/OmphdmF8ZWNtYSlzY3JpcHQvaSxcblx0cnNjcmlwdFR5cGVNYXNrZWQgPSAvXnRydWVcXC8oLiopLyxcblx0cmNsZWFuU2NyaXB0ID0gL15cXHMqPCEoPzpcXFtDREFUQVxcW3wtLSl8KD86XFxdXFxdfC0tKT5cXHMqJC9nLFxuXG5cdC8vIFdlIGhhdmUgdG8gY2xvc2UgdGhlc2UgdGFncyB0byBzdXBwb3J0IFhIVE1MICgjMTMyMDApXG5cdHdyYXBNYXAgPSB7XG5cblx0XHQvLyBTdXBwb3J0OiBJRSA5XG5cdFx0b3B0aW9uOiBbIDEsIFwiPHNlbGVjdCBtdWx0aXBsZT0nbXVsdGlwbGUnPlwiLCBcIjwvc2VsZWN0PlwiIF0sXG5cblx0XHR0aGVhZDogWyAxLCBcIjx0YWJsZT5cIiwgXCI8L3RhYmxlPlwiIF0sXG5cdFx0Y29sOiBbIDIsIFwiPHRhYmxlPjxjb2xncm91cD5cIiwgXCI8L2NvbGdyb3VwPjwvdGFibGU+XCIgXSxcblx0XHR0cjogWyAyLCBcIjx0YWJsZT48dGJvZHk+XCIsIFwiPC90Ym9keT48L3RhYmxlPlwiIF0sXG5cdFx0dGQ6IFsgMywgXCI8dGFibGU+PHRib2R5Pjx0cj5cIiwgXCI8L3RyPjwvdGJvZHk+PC90YWJsZT5cIiBdLFxuXG5cdFx0X2RlZmF1bHQ6IFsgMCwgXCJcIiwgXCJcIiBdXG5cdH07XG5cbi8vIFN1cHBvcnQ6IElFIDlcbndyYXBNYXAub3B0Z3JvdXAgPSB3cmFwTWFwLm9wdGlvbjtcblxud3JhcE1hcC50Ym9keSA9IHdyYXBNYXAudGZvb3QgPSB3cmFwTWFwLmNvbGdyb3VwID0gd3JhcE1hcC5jYXB0aW9uID0gd3JhcE1hcC50aGVhZDtcbndyYXBNYXAudGggPSB3cmFwTWFwLnRkO1xuXG4vLyBTdXBwb3J0OiAxLnggY29tcGF0aWJpbGl0eVxuLy8gTWFuaXB1bGF0aW5nIHRhYmxlcyByZXF1aXJlcyBhIHRib2R5XG5mdW5jdGlvbiBtYW5pcHVsYXRpb25UYXJnZXQoIGVsZW0sIGNvbnRlbnQgKSB7XG5cdHJldHVybiBqUXVlcnkubm9kZU5hbWUoIGVsZW0sIFwidGFibGVcIiApICYmXG5cdFx0alF1ZXJ5Lm5vZGVOYW1lKCBjb250ZW50Lm5vZGVUeXBlICE9PSAxMSA/IGNvbnRlbnQgOiBjb250ZW50LmZpcnN0Q2hpbGQsIFwidHJcIiApID9cblxuXHRcdGVsZW0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJ0Ym9keVwiKVswXSB8fFxuXHRcdFx0ZWxlbS5hcHBlbmRDaGlsZCggZWxlbS5vd25lckRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0Ym9keVwiKSApIDpcblx0XHRlbGVtO1xufVxuXG4vLyBSZXBsYWNlL3Jlc3RvcmUgdGhlIHR5cGUgYXR0cmlidXRlIG9mIHNjcmlwdCBlbGVtZW50cyBmb3Igc2FmZSBET00gbWFuaXB1bGF0aW9uXG5mdW5jdGlvbiBkaXNhYmxlU2NyaXB0KCBlbGVtICkge1xuXHRlbGVtLnR5cGUgPSAoZWxlbS5nZXRBdHRyaWJ1dGUoXCJ0eXBlXCIpICE9PSBudWxsKSArIFwiL1wiICsgZWxlbS50eXBlO1xuXHRyZXR1cm4gZWxlbTtcbn1cbmZ1bmN0aW9uIHJlc3RvcmVTY3JpcHQoIGVsZW0gKSB7XG5cdHZhciBtYXRjaCA9IHJzY3JpcHRUeXBlTWFza2VkLmV4ZWMoIGVsZW0udHlwZSApO1xuXG5cdGlmICggbWF0Y2ggKSB7XG5cdFx0ZWxlbS50eXBlID0gbWF0Y2hbIDEgXTtcblx0fSBlbHNlIHtcblx0XHRlbGVtLnJlbW92ZUF0dHJpYnV0ZShcInR5cGVcIik7XG5cdH1cblxuXHRyZXR1cm4gZWxlbTtcbn1cblxuLy8gTWFyayBzY3JpcHRzIGFzIGhhdmluZyBhbHJlYWR5IGJlZW4gZXZhbHVhdGVkXG5mdW5jdGlvbiBzZXRHbG9iYWxFdmFsKCBlbGVtcywgcmVmRWxlbWVudHMgKSB7XG5cdHZhciBpID0gMCxcblx0XHRsID0gZWxlbXMubGVuZ3RoO1xuXG5cdGZvciAoIDsgaSA8IGw7IGkrKyApIHtcblx0XHRkYXRhX3ByaXYuc2V0KFxuXHRcdFx0ZWxlbXNbIGkgXSwgXCJnbG9iYWxFdmFsXCIsICFyZWZFbGVtZW50cyB8fCBkYXRhX3ByaXYuZ2V0KCByZWZFbGVtZW50c1sgaSBdLCBcImdsb2JhbEV2YWxcIiApXG5cdFx0KTtcblx0fVxufVxuXG5mdW5jdGlvbiBjbG9uZUNvcHlFdmVudCggc3JjLCBkZXN0ICkge1xuXHR2YXIgaSwgbCwgdHlwZSwgcGRhdGFPbGQsIHBkYXRhQ3VyLCB1ZGF0YU9sZCwgdWRhdGFDdXIsIGV2ZW50cztcblxuXHRpZiAoIGRlc3Qubm9kZVR5cGUgIT09IDEgKSB7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0Ly8gMS4gQ29weSBwcml2YXRlIGRhdGE6IGV2ZW50cywgaGFuZGxlcnMsIGV0Yy5cblx0aWYgKCBkYXRhX3ByaXYuaGFzRGF0YSggc3JjICkgKSB7XG5cdFx0cGRhdGFPbGQgPSBkYXRhX3ByaXYuYWNjZXNzKCBzcmMgKTtcblx0XHRwZGF0YUN1ciA9IGRhdGFfcHJpdi5zZXQoIGRlc3QsIHBkYXRhT2xkICk7XG5cdFx0ZXZlbnRzID0gcGRhdGFPbGQuZXZlbnRzO1xuXG5cdFx0aWYgKCBldmVudHMgKSB7XG5cdFx0XHRkZWxldGUgcGRhdGFDdXIuaGFuZGxlO1xuXHRcdFx0cGRhdGFDdXIuZXZlbnRzID0ge307XG5cblx0XHRcdGZvciAoIHR5cGUgaW4gZXZlbnRzICkge1xuXHRcdFx0XHRmb3IgKCBpID0gMCwgbCA9IGV2ZW50c1sgdHlwZSBdLmxlbmd0aDsgaSA8IGw7IGkrKyApIHtcblx0XHRcdFx0XHRqUXVlcnkuZXZlbnQuYWRkKCBkZXN0LCB0eXBlLCBldmVudHNbIHR5cGUgXVsgaSBdICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHQvLyAyLiBDb3B5IHVzZXIgZGF0YVxuXHRpZiAoIGRhdGFfdXNlci5oYXNEYXRhKCBzcmMgKSApIHtcblx0XHR1ZGF0YU9sZCA9IGRhdGFfdXNlci5hY2Nlc3MoIHNyYyApO1xuXHRcdHVkYXRhQ3VyID0galF1ZXJ5LmV4dGVuZCgge30sIHVkYXRhT2xkICk7XG5cblx0XHRkYXRhX3VzZXIuc2V0KCBkZXN0LCB1ZGF0YUN1ciApO1xuXHR9XG59XG5cbmZ1bmN0aW9uIGdldEFsbCggY29udGV4dCwgdGFnICkge1xuXHR2YXIgcmV0ID0gY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZSA/IGNvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIHRhZyB8fCBcIipcIiApIDpcblx0XHRcdGNvbnRleHQucXVlcnlTZWxlY3RvckFsbCA/IGNvbnRleHQucXVlcnlTZWxlY3RvckFsbCggdGFnIHx8IFwiKlwiICkgOlxuXHRcdFx0W107XG5cblx0cmV0dXJuIHRhZyA9PT0gdW5kZWZpbmVkIHx8IHRhZyAmJiBqUXVlcnkubm9kZU5hbWUoIGNvbnRleHQsIHRhZyApID9cblx0XHRqUXVlcnkubWVyZ2UoIFsgY29udGV4dCBdLCByZXQgKSA6XG5cdFx0cmV0O1xufVxuXG4vLyBTdXBwb3J0OiBJRSA+PSA5XG5mdW5jdGlvbiBmaXhJbnB1dCggc3JjLCBkZXN0ICkge1xuXHR2YXIgbm9kZU5hbWUgPSBkZXN0Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7XG5cblx0Ly8gRmFpbHMgdG8gcGVyc2lzdCB0aGUgY2hlY2tlZCBzdGF0ZSBvZiBhIGNsb25lZCBjaGVja2JveCBvciByYWRpbyBidXR0b24uXG5cdGlmICggbm9kZU5hbWUgPT09IFwiaW5wdXRcIiAmJiByY2hlY2thYmxlVHlwZS50ZXN0KCBzcmMudHlwZSApICkge1xuXHRcdGRlc3QuY2hlY2tlZCA9IHNyYy5jaGVja2VkO1xuXG5cdC8vIEZhaWxzIHRvIHJldHVybiB0aGUgc2VsZWN0ZWQgb3B0aW9uIHRvIHRoZSBkZWZhdWx0IHNlbGVjdGVkIHN0YXRlIHdoZW4gY2xvbmluZyBvcHRpb25zXG5cdH0gZWxzZSBpZiAoIG5vZGVOYW1lID09PSBcImlucHV0XCIgfHwgbm9kZU5hbWUgPT09IFwidGV4dGFyZWFcIiApIHtcblx0XHRkZXN0LmRlZmF1bHRWYWx1ZSA9IHNyYy5kZWZhdWx0VmFsdWU7XG5cdH1cbn1cblxualF1ZXJ5LmV4dGVuZCh7XG5cdGNsb25lOiBmdW5jdGlvbiggZWxlbSwgZGF0YUFuZEV2ZW50cywgZGVlcERhdGFBbmRFdmVudHMgKSB7XG5cdFx0dmFyIGksIGwsIHNyY0VsZW1lbnRzLCBkZXN0RWxlbWVudHMsXG5cdFx0XHRjbG9uZSA9IGVsZW0uY2xvbmVOb2RlKCB0cnVlICksXG5cdFx0XHRpblBhZ2UgPSBqUXVlcnkuY29udGFpbnMoIGVsZW0ub3duZXJEb2N1bWVudCwgZWxlbSApO1xuXG5cdFx0Ly8gU3VwcG9ydDogSUUgPj0gOVxuXHRcdC8vIEZpeCBDbG9uaW5nIGlzc3Vlc1xuXHRcdGlmICggIXN1cHBvcnQubm9DbG9uZUNoZWNrZWQgJiYgKCBlbGVtLm5vZGVUeXBlID09PSAxIHx8IGVsZW0ubm9kZVR5cGUgPT09IDExICkgJiZcblx0XHRcdFx0IWpRdWVyeS5pc1hNTERvYyggZWxlbSApICkge1xuXG5cdFx0XHQvLyBXZSBlc2NoZXcgU2l6emxlIGhlcmUgZm9yIHBlcmZvcm1hbmNlIHJlYXNvbnM6IGh0dHA6Ly9qc3BlcmYuY29tL2dldGFsbC12cy1zaXp6bGUvMlxuXHRcdFx0ZGVzdEVsZW1lbnRzID0gZ2V0QWxsKCBjbG9uZSApO1xuXHRcdFx0c3JjRWxlbWVudHMgPSBnZXRBbGwoIGVsZW0gKTtcblxuXHRcdFx0Zm9yICggaSA9IDAsIGwgPSBzcmNFbGVtZW50cy5sZW5ndGg7IGkgPCBsOyBpKysgKSB7XG5cdFx0XHRcdGZpeElucHV0KCBzcmNFbGVtZW50c1sgaSBdLCBkZXN0RWxlbWVudHNbIGkgXSApO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIENvcHkgdGhlIGV2ZW50cyBmcm9tIHRoZSBvcmlnaW5hbCB0byB0aGUgY2xvbmVcblx0XHRpZiAoIGRhdGFBbmRFdmVudHMgKSB7XG5cdFx0XHRpZiAoIGRlZXBEYXRhQW5kRXZlbnRzICkge1xuXHRcdFx0XHRzcmNFbGVtZW50cyA9IHNyY0VsZW1lbnRzIHx8IGdldEFsbCggZWxlbSApO1xuXHRcdFx0XHRkZXN0RWxlbWVudHMgPSBkZXN0RWxlbWVudHMgfHwgZ2V0QWxsKCBjbG9uZSApO1xuXG5cdFx0XHRcdGZvciAoIGkgPSAwLCBsID0gc3JjRWxlbWVudHMubGVuZ3RoOyBpIDwgbDsgaSsrICkge1xuXHRcdFx0XHRcdGNsb25lQ29weUV2ZW50KCBzcmNFbGVtZW50c1sgaSBdLCBkZXN0RWxlbWVudHNbIGkgXSApO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjbG9uZUNvcHlFdmVudCggZWxlbSwgY2xvbmUgKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBQcmVzZXJ2ZSBzY3JpcHQgZXZhbHVhdGlvbiBoaXN0b3J5XG5cdFx0ZGVzdEVsZW1lbnRzID0gZ2V0QWxsKCBjbG9uZSwgXCJzY3JpcHRcIiApO1xuXHRcdGlmICggZGVzdEVsZW1lbnRzLmxlbmd0aCA+IDAgKSB7XG5cdFx0XHRzZXRHbG9iYWxFdmFsKCBkZXN0RWxlbWVudHMsICFpblBhZ2UgJiYgZ2V0QWxsKCBlbGVtLCBcInNjcmlwdFwiICkgKTtcblx0XHR9XG5cblx0XHQvLyBSZXR1cm4gdGhlIGNsb25lZCBzZXRcblx0XHRyZXR1cm4gY2xvbmU7XG5cdH0sXG5cblx0YnVpbGRGcmFnbWVudDogZnVuY3Rpb24oIGVsZW1zLCBjb250ZXh0LCBzY3JpcHRzLCBzZWxlY3Rpb24gKSB7XG5cdFx0dmFyIGVsZW0sIHRtcCwgdGFnLCB3cmFwLCBjb250YWlucywgaixcblx0XHRcdGZyYWdtZW50ID0gY29udGV4dC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCksXG5cdFx0XHRub2RlcyA9IFtdLFxuXHRcdFx0aSA9IDAsXG5cdFx0XHRsID0gZWxlbXMubGVuZ3RoO1xuXG5cdFx0Zm9yICggOyBpIDwgbDsgaSsrICkge1xuXHRcdFx0ZWxlbSA9IGVsZW1zWyBpIF07XG5cblx0XHRcdGlmICggZWxlbSB8fCBlbGVtID09PSAwICkge1xuXG5cdFx0XHRcdC8vIEFkZCBub2RlcyBkaXJlY3RseVxuXHRcdFx0XHRpZiAoIGpRdWVyeS50eXBlKCBlbGVtICkgPT09IFwib2JqZWN0XCIgKSB7XG5cdFx0XHRcdFx0Ly8gU3VwcG9ydDogUXRXZWJLaXRcblx0XHRcdFx0XHQvLyBqUXVlcnkubWVyZ2UgYmVjYXVzZSBwdXNoLmFwcGx5KF8sIGFycmF5bGlrZSkgdGhyb3dzXG5cdFx0XHRcdFx0alF1ZXJ5Lm1lcmdlKCBub2RlcywgZWxlbS5ub2RlVHlwZSA/IFsgZWxlbSBdIDogZWxlbSApO1xuXG5cdFx0XHRcdC8vIENvbnZlcnQgbm9uLWh0bWwgaW50byBhIHRleHQgbm9kZVxuXHRcdFx0XHR9IGVsc2UgaWYgKCAhcmh0bWwudGVzdCggZWxlbSApICkge1xuXHRcdFx0XHRcdG5vZGVzLnB1c2goIGNvbnRleHQuY3JlYXRlVGV4dE5vZGUoIGVsZW0gKSApO1xuXG5cdFx0XHRcdC8vIENvbnZlcnQgaHRtbCBpbnRvIERPTSBub2Rlc1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHRtcCA9IHRtcCB8fCBmcmFnbWVudC5hcHBlbmRDaGlsZCggY29udGV4dC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpICk7XG5cblx0XHRcdFx0XHQvLyBEZXNlcmlhbGl6ZSBhIHN0YW5kYXJkIHJlcHJlc2VudGF0aW9uXG5cdFx0XHRcdFx0dGFnID0gKCBydGFnTmFtZS5leGVjKCBlbGVtICkgfHwgWyBcIlwiLCBcIlwiIF0gKVsgMSBdLnRvTG93ZXJDYXNlKCk7XG5cdFx0XHRcdFx0d3JhcCA9IHdyYXBNYXBbIHRhZyBdIHx8IHdyYXBNYXAuX2RlZmF1bHQ7XG5cdFx0XHRcdFx0dG1wLmlubmVySFRNTCA9IHdyYXBbIDEgXSArIGVsZW0ucmVwbGFjZSggcnhodG1sVGFnLCBcIjwkMT48LyQyPlwiICkgKyB3cmFwWyAyIF07XG5cblx0XHRcdFx0XHQvLyBEZXNjZW5kIHRocm91Z2ggd3JhcHBlcnMgdG8gdGhlIHJpZ2h0IGNvbnRlbnRcblx0XHRcdFx0XHRqID0gd3JhcFsgMCBdO1xuXHRcdFx0XHRcdHdoaWxlICggai0tICkge1xuXHRcdFx0XHRcdFx0dG1wID0gdG1wLmxhc3RDaGlsZDtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyBTdXBwb3J0OiBRdFdlYktpdFxuXHRcdFx0XHRcdC8vIGpRdWVyeS5tZXJnZSBiZWNhdXNlIHB1c2guYXBwbHkoXywgYXJyYXlsaWtlKSB0aHJvd3Ncblx0XHRcdFx0XHRqUXVlcnkubWVyZ2UoIG5vZGVzLCB0bXAuY2hpbGROb2RlcyApO1xuXG5cdFx0XHRcdFx0Ly8gUmVtZW1iZXIgdGhlIHRvcC1sZXZlbCBjb250YWluZXJcblx0XHRcdFx0XHR0bXAgPSBmcmFnbWVudC5maXJzdENoaWxkO1xuXG5cdFx0XHRcdFx0Ly8gRml4ZXMgIzEyMzQ2XG5cdFx0XHRcdFx0Ly8gU3VwcG9ydDogV2Via2l0LCBJRVxuXHRcdFx0XHRcdHRtcC50ZXh0Q29udGVudCA9IFwiXCI7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBSZW1vdmUgd3JhcHBlciBmcm9tIGZyYWdtZW50XG5cdFx0ZnJhZ21lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuXG5cdFx0aSA9IDA7XG5cdFx0d2hpbGUgKCAoZWxlbSA9IG5vZGVzWyBpKysgXSkgKSB7XG5cblx0XHRcdC8vICM0MDg3IC0gSWYgb3JpZ2luIGFuZCBkZXN0aW5hdGlvbiBlbGVtZW50cyBhcmUgdGhlIHNhbWUsIGFuZCB0aGlzIGlzXG5cdFx0XHQvLyB0aGF0IGVsZW1lbnQsIGRvIG5vdCBkbyBhbnl0aGluZ1xuXHRcdFx0aWYgKCBzZWxlY3Rpb24gJiYgalF1ZXJ5LmluQXJyYXkoIGVsZW0sIHNlbGVjdGlvbiApICE9PSAtMSApIHtcblx0XHRcdFx0Y29udGludWU7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnRhaW5zID0galF1ZXJ5LmNvbnRhaW5zKCBlbGVtLm93bmVyRG9jdW1lbnQsIGVsZW0gKTtcblxuXHRcdFx0Ly8gQXBwZW5kIHRvIGZyYWdtZW50XG5cdFx0XHR0bXAgPSBnZXRBbGwoIGZyYWdtZW50LmFwcGVuZENoaWxkKCBlbGVtICksIFwic2NyaXB0XCIgKTtcblxuXHRcdFx0Ly8gUHJlc2VydmUgc2NyaXB0IGV2YWx1YXRpb24gaGlzdG9yeVxuXHRcdFx0aWYgKCBjb250YWlucyApIHtcblx0XHRcdFx0c2V0R2xvYmFsRXZhbCggdG1wICk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIENhcHR1cmUgZXhlY3V0YWJsZXNcblx0XHRcdGlmICggc2NyaXB0cyApIHtcblx0XHRcdFx0aiA9IDA7XG5cdFx0XHRcdHdoaWxlICggKGVsZW0gPSB0bXBbIGorKyBdKSApIHtcblx0XHRcdFx0XHRpZiAoIHJzY3JpcHRUeXBlLnRlc3QoIGVsZW0udHlwZSB8fCBcIlwiICkgKSB7XG5cdFx0XHRcdFx0XHRzY3JpcHRzLnB1c2goIGVsZW0gKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gZnJhZ21lbnQ7XG5cdH0sXG5cblx0Y2xlYW5EYXRhOiBmdW5jdGlvbiggZWxlbXMgKSB7XG5cdFx0dmFyIGRhdGEsIGVsZW0sIHR5cGUsIGtleSxcblx0XHRcdHNwZWNpYWwgPSBqUXVlcnkuZXZlbnQuc3BlY2lhbCxcblx0XHRcdGkgPSAwO1xuXG5cdFx0Zm9yICggOyAoZWxlbSA9IGVsZW1zWyBpIF0pICE9PSB1bmRlZmluZWQ7IGkrKyApIHtcblx0XHRcdGlmICggalF1ZXJ5LmFjY2VwdERhdGEoIGVsZW0gKSApIHtcblx0XHRcdFx0a2V5ID0gZWxlbVsgZGF0YV9wcml2LmV4cGFuZG8gXTtcblxuXHRcdFx0XHRpZiAoIGtleSAmJiAoZGF0YSA9IGRhdGFfcHJpdi5jYWNoZVsga2V5IF0pICkge1xuXHRcdFx0XHRcdGlmICggZGF0YS5ldmVudHMgKSB7XG5cdFx0XHRcdFx0XHRmb3IgKCB0eXBlIGluIGRhdGEuZXZlbnRzICkge1xuXHRcdFx0XHRcdFx0XHRpZiAoIHNwZWNpYWxbIHR5cGUgXSApIHtcblx0XHRcdFx0XHRcdFx0XHRqUXVlcnkuZXZlbnQucmVtb3ZlKCBlbGVtLCB0eXBlICk7XG5cblx0XHRcdFx0XHRcdFx0Ly8gVGhpcyBpcyBhIHNob3J0Y3V0IHRvIGF2b2lkIGpRdWVyeS5ldmVudC5yZW1vdmUncyBvdmVyaGVhZFxuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdGpRdWVyeS5yZW1vdmVFdmVudCggZWxlbSwgdHlwZSwgZGF0YS5oYW5kbGUgKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpZiAoIGRhdGFfcHJpdi5jYWNoZVsga2V5IF0gKSB7XG5cdFx0XHRcdFx0XHQvLyBEaXNjYXJkIGFueSByZW1haW5pbmcgYHByaXZhdGVgIGRhdGFcblx0XHRcdFx0XHRcdGRlbGV0ZSBkYXRhX3ByaXYuY2FjaGVbIGtleSBdO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0Ly8gRGlzY2FyZCBhbnkgcmVtYWluaW5nIGB1c2VyYCBkYXRhXG5cdFx0XHRkZWxldGUgZGF0YV91c2VyLmNhY2hlWyBlbGVtWyBkYXRhX3VzZXIuZXhwYW5kbyBdIF07XG5cdFx0fVxuXHR9XG59KTtcblxualF1ZXJ5LmZuLmV4dGVuZCh7XG5cdHRleHQ6IGZ1bmN0aW9uKCB2YWx1ZSApIHtcblx0XHRyZXR1cm4gYWNjZXNzKCB0aGlzLCBmdW5jdGlvbiggdmFsdWUgKSB7XG5cdFx0XHRyZXR1cm4gdmFsdWUgPT09IHVuZGVmaW5lZCA/XG5cdFx0XHRcdGpRdWVyeS50ZXh0KCB0aGlzICkgOlxuXHRcdFx0XHR0aGlzLmVtcHR5KCkuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRpZiAoIHRoaXMubm9kZVR5cGUgPT09IDEgfHwgdGhpcy5ub2RlVHlwZSA9PT0gMTEgfHwgdGhpcy5ub2RlVHlwZSA9PT0gOSApIHtcblx0XHRcdFx0XHRcdHRoaXMudGV4dENvbnRlbnQgPSB2YWx1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdH0sIG51bGwsIHZhbHVlLCBhcmd1bWVudHMubGVuZ3RoICk7XG5cdH0sXG5cblx0YXBwZW5kOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5kb21NYW5pcCggYXJndW1lbnRzLCBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdGlmICggdGhpcy5ub2RlVHlwZSA9PT0gMSB8fCB0aGlzLm5vZGVUeXBlID09PSAxMSB8fCB0aGlzLm5vZGVUeXBlID09PSA5ICkge1xuXHRcdFx0XHR2YXIgdGFyZ2V0ID0gbWFuaXB1bGF0aW9uVGFyZ2V0KCB0aGlzLCBlbGVtICk7XG5cdFx0XHRcdHRhcmdldC5hcHBlbmRDaGlsZCggZWxlbSApO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9LFxuXG5cdHByZXBlbmQ6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0aGlzLmRvbU1hbmlwKCBhcmd1bWVudHMsIGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0aWYgKCB0aGlzLm5vZGVUeXBlID09PSAxIHx8IHRoaXMubm9kZVR5cGUgPT09IDExIHx8IHRoaXMubm9kZVR5cGUgPT09IDkgKSB7XG5cdFx0XHRcdHZhciB0YXJnZXQgPSBtYW5pcHVsYXRpb25UYXJnZXQoIHRoaXMsIGVsZW0gKTtcblx0XHRcdFx0dGFyZ2V0Lmluc2VydEJlZm9yZSggZWxlbSwgdGFyZ2V0LmZpcnN0Q2hpbGQgKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fSxcblxuXHRiZWZvcmU6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0aGlzLmRvbU1hbmlwKCBhcmd1bWVudHMsIGZ1bmN0aW9uKCBlbGVtICkge1xuXHRcdFx0aWYgKCB0aGlzLnBhcmVudE5vZGUgKSB7XG5cdFx0XHRcdHRoaXMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoIGVsZW0sIHRoaXMgKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fSxcblxuXHRhZnRlcjogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMuZG9tTWFuaXAoIGFyZ3VtZW50cywgZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRpZiAoIHRoaXMucGFyZW50Tm9kZSApIHtcblx0XHRcdFx0dGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZSggZWxlbSwgdGhpcy5uZXh0U2libGluZyApO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9LFxuXG5cdHJlbW92ZTogZnVuY3Rpb24oIHNlbGVjdG9yLCBrZWVwRGF0YSAvKiBJbnRlcm5hbCBVc2UgT25seSAqLyApIHtcblx0XHR2YXIgZWxlbSxcblx0XHRcdGVsZW1zID0gc2VsZWN0b3IgPyBqUXVlcnkuZmlsdGVyKCBzZWxlY3RvciwgdGhpcyApIDogdGhpcyxcblx0XHRcdGkgPSAwO1xuXG5cdFx0Zm9yICggOyAoZWxlbSA9IGVsZW1zW2ldKSAhPSBudWxsOyBpKysgKSB7XG5cdFx0XHRpZiAoICFrZWVwRGF0YSAmJiBlbGVtLm5vZGVUeXBlID09PSAxICkge1xuXHRcdFx0XHRqUXVlcnkuY2xlYW5EYXRhKCBnZXRBbGwoIGVsZW0gKSApO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIGVsZW0ucGFyZW50Tm9kZSApIHtcblx0XHRcdFx0aWYgKCBrZWVwRGF0YSAmJiBqUXVlcnkuY29udGFpbnMoIGVsZW0ub3duZXJEb2N1bWVudCwgZWxlbSApICkge1xuXHRcdFx0XHRcdHNldEdsb2JhbEV2YWwoIGdldEFsbCggZWxlbSwgXCJzY3JpcHRcIiApICk7XG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxlbS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKCBlbGVtICk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0ZW1wdHk6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBlbGVtLFxuXHRcdFx0aSA9IDA7XG5cblx0XHRmb3IgKCA7IChlbGVtID0gdGhpc1tpXSkgIT0gbnVsbDsgaSsrICkge1xuXHRcdFx0aWYgKCBlbGVtLm5vZGVUeXBlID09PSAxICkge1xuXG5cdFx0XHRcdC8vIFByZXZlbnQgbWVtb3J5IGxlYWtzXG5cdFx0XHRcdGpRdWVyeS5jbGVhbkRhdGEoIGdldEFsbCggZWxlbSwgZmFsc2UgKSApO1xuXG5cdFx0XHRcdC8vIFJlbW92ZSBhbnkgcmVtYWluaW5nIG5vZGVzXG5cdFx0XHRcdGVsZW0udGV4dENvbnRlbnQgPSBcIlwiO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdGNsb25lOiBmdW5jdGlvbiggZGF0YUFuZEV2ZW50cywgZGVlcERhdGFBbmRFdmVudHMgKSB7XG5cdFx0ZGF0YUFuZEV2ZW50cyA9IGRhdGFBbmRFdmVudHMgPT0gbnVsbCA/IGZhbHNlIDogZGF0YUFuZEV2ZW50cztcblx0XHRkZWVwRGF0YUFuZEV2ZW50cyA9IGRlZXBEYXRhQW5kRXZlbnRzID09IG51bGwgPyBkYXRhQW5kRXZlbnRzIDogZGVlcERhdGFBbmRFdmVudHM7XG5cblx0XHRyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4galF1ZXJ5LmNsb25lKCB0aGlzLCBkYXRhQW5kRXZlbnRzLCBkZWVwRGF0YUFuZEV2ZW50cyApO1xuXHRcdH0pO1xuXHR9LFxuXG5cdGh0bWw6IGZ1bmN0aW9uKCB2YWx1ZSApIHtcblx0XHRyZXR1cm4gYWNjZXNzKCB0aGlzLCBmdW5jdGlvbiggdmFsdWUgKSB7XG5cdFx0XHR2YXIgZWxlbSA9IHRoaXNbIDAgXSB8fCB7fSxcblx0XHRcdFx0aSA9IDAsXG5cdFx0XHRcdGwgPSB0aGlzLmxlbmd0aDtcblxuXHRcdFx0aWYgKCB2YWx1ZSA9PT0gdW5kZWZpbmVkICYmIGVsZW0ubm9kZVR5cGUgPT09IDEgKSB7XG5cdFx0XHRcdHJldHVybiBlbGVtLmlubmVySFRNTDtcblx0XHRcdH1cblxuXHRcdFx0Ly8gU2VlIGlmIHdlIGNhbiB0YWtlIGEgc2hvcnRjdXQgYW5kIGp1c3QgdXNlIGlubmVySFRNTFxuXHRcdFx0aWYgKCB0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgJiYgIXJub0lubmVyaHRtbC50ZXN0KCB2YWx1ZSApICYmXG5cdFx0XHRcdCF3cmFwTWFwWyAoIHJ0YWdOYW1lLmV4ZWMoIHZhbHVlICkgfHwgWyBcIlwiLCBcIlwiIF0gKVsgMSBdLnRvTG93ZXJDYXNlKCkgXSApIHtcblxuXHRcdFx0XHR2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoIHJ4aHRtbFRhZywgXCI8JDE+PC8kMj5cIiApO1xuXG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0Zm9yICggOyBpIDwgbDsgaSsrICkge1xuXHRcdFx0XHRcdFx0ZWxlbSA9IHRoaXNbIGkgXSB8fCB7fTtcblxuXHRcdFx0XHRcdFx0Ly8gUmVtb3ZlIGVsZW1lbnQgbm9kZXMgYW5kIHByZXZlbnQgbWVtb3J5IGxlYWtzXG5cdFx0XHRcdFx0XHRpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDEgKSB7XG5cdFx0XHRcdFx0XHRcdGpRdWVyeS5jbGVhbkRhdGEoIGdldEFsbCggZWxlbSwgZmFsc2UgKSApO1xuXHRcdFx0XHRcdFx0XHRlbGVtLmlubmVySFRNTCA9IHZhbHVlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGVsZW0gPSAwO1xuXG5cdFx0XHRcdC8vIElmIHVzaW5nIGlubmVySFRNTCB0aHJvd3MgYW4gZXhjZXB0aW9uLCB1c2UgdGhlIGZhbGxiYWNrIG1ldGhvZFxuXHRcdFx0XHR9IGNhdGNoKCBlICkge31cblx0XHRcdH1cblxuXHRcdFx0aWYgKCBlbGVtICkge1xuXHRcdFx0XHR0aGlzLmVtcHR5KCkuYXBwZW5kKCB2YWx1ZSApO1xuXHRcdFx0fVxuXHRcdH0sIG51bGwsIHZhbHVlLCBhcmd1bWVudHMubGVuZ3RoICk7XG5cdH0sXG5cblx0cmVwbGFjZVdpdGg6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBhcmcgPSBhcmd1bWVudHNbIDAgXTtcblxuXHRcdC8vIE1ha2UgdGhlIGNoYW5nZXMsIHJlcGxhY2luZyBlYWNoIGNvbnRleHQgZWxlbWVudCB3aXRoIHRoZSBuZXcgY29udGVudFxuXHRcdHRoaXMuZG9tTWFuaXAoIGFyZ3VtZW50cywgZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHRhcmcgPSB0aGlzLnBhcmVudE5vZGU7XG5cblx0XHRcdGpRdWVyeS5jbGVhbkRhdGEoIGdldEFsbCggdGhpcyApICk7XG5cblx0XHRcdGlmICggYXJnICkge1xuXHRcdFx0XHRhcmcucmVwbGFjZUNoaWxkKCBlbGVtLCB0aGlzICk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvLyBGb3JjZSByZW1vdmFsIGlmIHRoZXJlIHdhcyBubyBuZXcgY29udGVudCAoZS5nLiwgZnJvbSBlbXB0eSBhcmd1bWVudHMpXG5cdFx0cmV0dXJuIGFyZyAmJiAoYXJnLmxlbmd0aCB8fCBhcmcubm9kZVR5cGUpID8gdGhpcyA6IHRoaXMucmVtb3ZlKCk7XG5cdH0sXG5cblx0ZGV0YWNoOiBmdW5jdGlvbiggc2VsZWN0b3IgKSB7XG5cdFx0cmV0dXJuIHRoaXMucmVtb3ZlKCBzZWxlY3RvciwgdHJ1ZSApO1xuXHR9LFxuXG5cdGRvbU1hbmlwOiBmdW5jdGlvbiggYXJncywgY2FsbGJhY2sgKSB7XG5cblx0XHQvLyBGbGF0dGVuIGFueSBuZXN0ZWQgYXJyYXlzXG5cdFx0YXJncyA9IGNvbmNhdC5hcHBseSggW10sIGFyZ3MgKTtcblxuXHRcdHZhciBmcmFnbWVudCwgZmlyc3QsIHNjcmlwdHMsIGhhc1NjcmlwdHMsIG5vZGUsIGRvYyxcblx0XHRcdGkgPSAwLFxuXHRcdFx0bCA9IHRoaXMubGVuZ3RoLFxuXHRcdFx0c2V0ID0gdGhpcyxcblx0XHRcdGlOb0Nsb25lID0gbCAtIDEsXG5cdFx0XHR2YWx1ZSA9IGFyZ3NbIDAgXSxcblx0XHRcdGlzRnVuY3Rpb24gPSBqUXVlcnkuaXNGdW5jdGlvbiggdmFsdWUgKTtcblxuXHRcdC8vIFdlIGNhbid0IGNsb25lTm9kZSBmcmFnbWVudHMgdGhhdCBjb250YWluIGNoZWNrZWQsIGluIFdlYktpdFxuXHRcdGlmICggaXNGdW5jdGlvbiB8fFxuXHRcdFx0XHQoIGwgPiAxICYmIHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIiAmJlxuXHRcdFx0XHRcdCFzdXBwb3J0LmNoZWNrQ2xvbmUgJiYgcmNoZWNrZWQudGVzdCggdmFsdWUgKSApICkge1xuXHRcdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiggaW5kZXggKSB7XG5cdFx0XHRcdHZhciBzZWxmID0gc2V0LmVxKCBpbmRleCApO1xuXHRcdFx0XHRpZiAoIGlzRnVuY3Rpb24gKSB7XG5cdFx0XHRcdFx0YXJnc1sgMCBdID0gdmFsdWUuY2FsbCggdGhpcywgaW5kZXgsIHNlbGYuaHRtbCgpICk7XG5cdFx0XHRcdH1cblx0XHRcdFx0c2VsZi5kb21NYW5pcCggYXJncywgY2FsbGJhY2sgKTtcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdGlmICggbCApIHtcblx0XHRcdGZyYWdtZW50ID0galF1ZXJ5LmJ1aWxkRnJhZ21lbnQoIGFyZ3MsIHRoaXNbIDAgXS5vd25lckRvY3VtZW50LCBmYWxzZSwgdGhpcyApO1xuXHRcdFx0Zmlyc3QgPSBmcmFnbWVudC5maXJzdENoaWxkO1xuXG5cdFx0XHRpZiAoIGZyYWdtZW50LmNoaWxkTm9kZXMubGVuZ3RoID09PSAxICkge1xuXHRcdFx0XHRmcmFnbWVudCA9IGZpcnN0O1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIGZpcnN0ICkge1xuXHRcdFx0XHRzY3JpcHRzID0galF1ZXJ5Lm1hcCggZ2V0QWxsKCBmcmFnbWVudCwgXCJzY3JpcHRcIiApLCBkaXNhYmxlU2NyaXB0ICk7XG5cdFx0XHRcdGhhc1NjcmlwdHMgPSBzY3JpcHRzLmxlbmd0aDtcblxuXHRcdFx0XHQvLyBVc2UgdGhlIG9yaWdpbmFsIGZyYWdtZW50IGZvciB0aGUgbGFzdCBpdGVtIGluc3RlYWQgb2YgdGhlIGZpcnN0IGJlY2F1c2UgaXQgY2FuIGVuZCB1cFxuXHRcdFx0XHQvLyBiZWluZyBlbXB0aWVkIGluY29ycmVjdGx5IGluIGNlcnRhaW4gc2l0dWF0aW9ucyAoIzgwNzApLlxuXHRcdFx0XHRmb3IgKCA7IGkgPCBsOyBpKysgKSB7XG5cdFx0XHRcdFx0bm9kZSA9IGZyYWdtZW50O1xuXG5cdFx0XHRcdFx0aWYgKCBpICE9PSBpTm9DbG9uZSApIHtcblx0XHRcdFx0XHRcdG5vZGUgPSBqUXVlcnkuY2xvbmUoIG5vZGUsIHRydWUsIHRydWUgKTtcblxuXHRcdFx0XHRcdFx0Ly8gS2VlcCByZWZlcmVuY2VzIHRvIGNsb25lZCBzY3JpcHRzIGZvciBsYXRlciByZXN0b3JhdGlvblxuXHRcdFx0XHRcdFx0aWYgKCBoYXNTY3JpcHRzICkge1xuXHRcdFx0XHRcdFx0XHQvLyBTdXBwb3J0OiBRdFdlYktpdFxuXHRcdFx0XHRcdFx0XHQvLyBqUXVlcnkubWVyZ2UgYmVjYXVzZSBwdXNoLmFwcGx5KF8sIGFycmF5bGlrZSkgdGhyb3dzXG5cdFx0XHRcdFx0XHRcdGpRdWVyeS5tZXJnZSggc2NyaXB0cywgZ2V0QWxsKCBub2RlLCBcInNjcmlwdFwiICkgKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRjYWxsYmFjay5jYWxsKCB0aGlzWyBpIF0sIG5vZGUsIGkgKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICggaGFzU2NyaXB0cyApIHtcblx0XHRcdFx0XHRkb2MgPSBzY3JpcHRzWyBzY3JpcHRzLmxlbmd0aCAtIDEgXS5vd25lckRvY3VtZW50O1xuXG5cdFx0XHRcdFx0Ly8gUmVlbmFibGUgc2NyaXB0c1xuXHRcdFx0XHRcdGpRdWVyeS5tYXAoIHNjcmlwdHMsIHJlc3RvcmVTY3JpcHQgKTtcblxuXHRcdFx0XHRcdC8vIEV2YWx1YXRlIGV4ZWN1dGFibGUgc2NyaXB0cyBvbiBmaXJzdCBkb2N1bWVudCBpbnNlcnRpb25cblx0XHRcdFx0XHRmb3IgKCBpID0gMDsgaSA8IGhhc1NjcmlwdHM7IGkrKyApIHtcblx0XHRcdFx0XHRcdG5vZGUgPSBzY3JpcHRzWyBpIF07XG5cdFx0XHRcdFx0XHRpZiAoIHJzY3JpcHRUeXBlLnRlc3QoIG5vZGUudHlwZSB8fCBcIlwiICkgJiZcblx0XHRcdFx0XHRcdFx0IWRhdGFfcHJpdi5hY2Nlc3MoIG5vZGUsIFwiZ2xvYmFsRXZhbFwiICkgJiYgalF1ZXJ5LmNvbnRhaW5zKCBkb2MsIG5vZGUgKSApIHtcblxuXHRcdFx0XHRcdFx0XHRpZiAoIG5vZGUuc3JjICkge1xuXHRcdFx0XHRcdFx0XHRcdC8vIE9wdGlvbmFsIEFKQVggZGVwZW5kZW5jeSwgYnV0IHdvbid0IHJ1biBzY3JpcHRzIGlmIG5vdCBwcmVzZW50XG5cdFx0XHRcdFx0XHRcdFx0aWYgKCBqUXVlcnkuX2V2YWxVcmwgKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRqUXVlcnkuX2V2YWxVcmwoIG5vZGUuc3JjICk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdGpRdWVyeS5nbG9iYWxFdmFsKCBub2RlLnRleHRDb250ZW50LnJlcGxhY2UoIHJjbGVhblNjcmlwdCwgXCJcIiApICk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fVxufSk7XG5cbmpRdWVyeS5lYWNoKHtcblx0YXBwZW5kVG86IFwiYXBwZW5kXCIsXG5cdHByZXBlbmRUbzogXCJwcmVwZW5kXCIsXG5cdGluc2VydEJlZm9yZTogXCJiZWZvcmVcIixcblx0aW5zZXJ0QWZ0ZXI6IFwiYWZ0ZXJcIixcblx0cmVwbGFjZUFsbDogXCJyZXBsYWNlV2l0aFwiXG59LCBmdW5jdGlvbiggbmFtZSwgb3JpZ2luYWwgKSB7XG5cdGpRdWVyeS5mblsgbmFtZSBdID0gZnVuY3Rpb24oIHNlbGVjdG9yICkge1xuXHRcdHZhciBlbGVtcyxcblx0XHRcdHJldCA9IFtdLFxuXHRcdFx0aW5zZXJ0ID0galF1ZXJ5KCBzZWxlY3RvciApLFxuXHRcdFx0bGFzdCA9IGluc2VydC5sZW5ndGggLSAxLFxuXHRcdFx0aSA9IDA7XG5cblx0XHRmb3IgKCA7IGkgPD0gbGFzdDsgaSsrICkge1xuXHRcdFx0ZWxlbXMgPSBpID09PSBsYXN0ID8gdGhpcyA6IHRoaXMuY2xvbmUoIHRydWUgKTtcblx0XHRcdGpRdWVyeSggaW5zZXJ0WyBpIF0gKVsgb3JpZ2luYWwgXSggZWxlbXMgKTtcblxuXHRcdFx0Ly8gU3VwcG9ydDogUXRXZWJLaXRcblx0XHRcdC8vIC5nZXQoKSBiZWNhdXNlIHB1c2guYXBwbHkoXywgYXJyYXlsaWtlKSB0aHJvd3Ncblx0XHRcdHB1c2guYXBwbHkoIHJldCwgZWxlbXMuZ2V0KCkgKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcy5wdXNoU3RhY2soIHJldCApO1xuXHR9O1xufSk7XG5cblxudmFyIGlmcmFtZSxcblx0ZWxlbWRpc3BsYXkgPSB7fTtcblxuLyoqXG4gKiBSZXRyaWV2ZSB0aGUgYWN0dWFsIGRpc3BsYXkgb2YgYSBlbGVtZW50XG4gKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBub2RlTmFtZSBvZiB0aGUgZWxlbWVudFxuICogQHBhcmFtIHtPYmplY3R9IGRvYyBEb2N1bWVudCBvYmplY3RcbiAqL1xuLy8gQ2FsbGVkIG9ubHkgZnJvbSB3aXRoaW4gZGVmYXVsdERpc3BsYXlcbmZ1bmN0aW9uIGFjdHVhbERpc3BsYXkoIG5hbWUsIGRvYyApIHtcblx0dmFyIHN0eWxlLFxuXHRcdGVsZW0gPSBqUXVlcnkoIGRvYy5jcmVhdGVFbGVtZW50KCBuYW1lICkgKS5hcHBlbmRUbyggZG9jLmJvZHkgKSxcblxuXHRcdC8vIGdldERlZmF1bHRDb21wdXRlZFN0eWxlIG1pZ2h0IGJlIHJlbGlhYmx5IHVzZWQgb25seSBvbiBhdHRhY2hlZCBlbGVtZW50XG5cdFx0ZGlzcGxheSA9IHdpbmRvdy5nZXREZWZhdWx0Q29tcHV0ZWRTdHlsZSAmJiAoIHN0eWxlID0gd2luZG93LmdldERlZmF1bHRDb21wdXRlZFN0eWxlKCBlbGVtWyAwIF0gKSApID9cblxuXHRcdFx0Ly8gVXNlIG9mIHRoaXMgbWV0aG9kIGlzIGEgdGVtcG9yYXJ5IGZpeCAobW9yZSBsaWtlIG9wdG1pemF0aW9uKSB1bnRpbCBzb21ldGhpbmcgYmV0dGVyIGNvbWVzIGFsb25nLFxuXHRcdFx0Ly8gc2luY2UgaXQgd2FzIHJlbW92ZWQgZnJvbSBzcGVjaWZpY2F0aW9uIGFuZCBzdXBwb3J0ZWQgb25seSBpbiBGRlxuXHRcdFx0c3R5bGUuZGlzcGxheSA6IGpRdWVyeS5jc3MoIGVsZW1bIDAgXSwgXCJkaXNwbGF5XCIgKTtcblxuXHQvLyBXZSBkb24ndCBoYXZlIGFueSBkYXRhIHN0b3JlZCBvbiB0aGUgZWxlbWVudCxcblx0Ly8gc28gdXNlIFwiZGV0YWNoXCIgbWV0aG9kIGFzIGZhc3Qgd2F5IHRvIGdldCByaWQgb2YgdGhlIGVsZW1lbnRcblx0ZWxlbS5kZXRhY2goKTtcblxuXHRyZXR1cm4gZGlzcGxheTtcbn1cblxuLyoqXG4gKiBUcnkgdG8gZGV0ZXJtaW5lIHRoZSBkZWZhdWx0IGRpc3BsYXkgdmFsdWUgb2YgYW4gZWxlbWVudFxuICogQHBhcmFtIHtTdHJpbmd9IG5vZGVOYW1lXG4gKi9cbmZ1bmN0aW9uIGRlZmF1bHREaXNwbGF5KCBub2RlTmFtZSApIHtcblx0dmFyIGRvYyA9IGRvY3VtZW50LFxuXHRcdGRpc3BsYXkgPSBlbGVtZGlzcGxheVsgbm9kZU5hbWUgXTtcblxuXHRpZiAoICFkaXNwbGF5ICkge1xuXHRcdGRpc3BsYXkgPSBhY3R1YWxEaXNwbGF5KCBub2RlTmFtZSwgZG9jICk7XG5cblx0XHQvLyBJZiB0aGUgc2ltcGxlIHdheSBmYWlscywgcmVhZCBmcm9tIGluc2lkZSBhbiBpZnJhbWVcblx0XHRpZiAoIGRpc3BsYXkgPT09IFwibm9uZVwiIHx8ICFkaXNwbGF5ICkge1xuXG5cdFx0XHQvLyBVc2UgdGhlIGFscmVhZHktY3JlYXRlZCBpZnJhbWUgaWYgcG9zc2libGVcblx0XHRcdGlmcmFtZSA9IChpZnJhbWUgfHwgalF1ZXJ5KCBcIjxpZnJhbWUgZnJhbWVib3JkZXI9JzAnIHdpZHRoPScwJyBoZWlnaHQ9JzAnLz5cIiApKS5hcHBlbmRUbyggZG9jLmRvY3VtZW50RWxlbWVudCApO1xuXG5cdFx0XHQvLyBBbHdheXMgd3JpdGUgYSBuZXcgSFRNTCBza2VsZXRvbiBzbyBXZWJraXQgYW5kIEZpcmVmb3ggZG9uJ3QgY2hva2Ugb24gcmV1c2Vcblx0XHRcdGRvYyA9IGlmcmFtZVsgMCBdLmNvbnRlbnREb2N1bWVudDtcblxuXHRcdFx0Ly8gU3VwcG9ydDogSUVcblx0XHRcdGRvYy53cml0ZSgpO1xuXHRcdFx0ZG9jLmNsb3NlKCk7XG5cblx0XHRcdGRpc3BsYXkgPSBhY3R1YWxEaXNwbGF5KCBub2RlTmFtZSwgZG9jICk7XG5cdFx0XHRpZnJhbWUuZGV0YWNoKCk7XG5cdFx0fVxuXG5cdFx0Ly8gU3RvcmUgdGhlIGNvcnJlY3QgZGVmYXVsdCBkaXNwbGF5XG5cdFx0ZWxlbWRpc3BsYXlbIG5vZGVOYW1lIF0gPSBkaXNwbGF5O1xuXHR9XG5cblx0cmV0dXJuIGRpc3BsYXk7XG59XG52YXIgcm1hcmdpbiA9ICgvXm1hcmdpbi8pO1xuXG52YXIgcm51bW5vbnB4ID0gbmV3IFJlZ0V4cCggXCJeKFwiICsgcG51bSArIFwiKSg/IXB4KVthLXolXSskXCIsIFwiaVwiICk7XG5cbnZhciBnZXRTdHlsZXMgPSBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRyZXR1cm4gZWxlbS5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGUoIGVsZW0sIG51bGwgKTtcblx0fTtcblxuXG5cbmZ1bmN0aW9uIGN1ckNTUyggZWxlbSwgbmFtZSwgY29tcHV0ZWQgKSB7XG5cdHZhciB3aWR0aCwgbWluV2lkdGgsIG1heFdpZHRoLCByZXQsXG5cdFx0c3R5bGUgPSBlbGVtLnN0eWxlO1xuXG5cdGNvbXB1dGVkID0gY29tcHV0ZWQgfHwgZ2V0U3R5bGVzKCBlbGVtICk7XG5cblx0Ly8gU3VwcG9ydDogSUU5XG5cdC8vIGdldFByb3BlcnR5VmFsdWUgaXMgb25seSBuZWVkZWQgZm9yIC5jc3MoJ2ZpbHRlcicpIGluIElFOSwgc2VlICMxMjUzN1xuXHRpZiAoIGNvbXB1dGVkICkge1xuXHRcdHJldCA9IGNvbXB1dGVkLmdldFByb3BlcnR5VmFsdWUoIG5hbWUgKSB8fCBjb21wdXRlZFsgbmFtZSBdO1xuXHR9XG5cblx0aWYgKCBjb21wdXRlZCApIHtcblxuXHRcdGlmICggcmV0ID09PSBcIlwiICYmICFqUXVlcnkuY29udGFpbnMoIGVsZW0ub3duZXJEb2N1bWVudCwgZWxlbSApICkge1xuXHRcdFx0cmV0ID0galF1ZXJ5LnN0eWxlKCBlbGVtLCBuYW1lICk7XG5cdFx0fVxuXG5cdFx0Ly8gU3VwcG9ydDogaU9TIDwgNlxuXHRcdC8vIEEgdHJpYnV0ZSB0byB0aGUgXCJhd2Vzb21lIGhhY2sgYnkgRGVhbiBFZHdhcmRzXCJcblx0XHQvLyBpT1MgPCA2IChhdCBsZWFzdCkgcmV0dXJucyBwZXJjZW50YWdlIGZvciBhIGxhcmdlciBzZXQgb2YgdmFsdWVzLCBidXQgd2lkdGggc2VlbXMgdG8gYmUgcmVsaWFibHkgcGl4ZWxzXG5cdFx0Ly8gdGhpcyBpcyBhZ2FpbnN0IHRoZSBDU1NPTSBkcmFmdCBzcGVjOiBodHRwOi8vZGV2LnczLm9yZy9jc3N3Zy9jc3NvbS8jcmVzb2x2ZWQtdmFsdWVzXG5cdFx0aWYgKCBybnVtbm9ucHgudGVzdCggcmV0ICkgJiYgcm1hcmdpbi50ZXN0KCBuYW1lICkgKSB7XG5cblx0XHRcdC8vIFJlbWVtYmVyIHRoZSBvcmlnaW5hbCB2YWx1ZXNcblx0XHRcdHdpZHRoID0gc3R5bGUud2lkdGg7XG5cdFx0XHRtaW5XaWR0aCA9IHN0eWxlLm1pbldpZHRoO1xuXHRcdFx0bWF4V2lkdGggPSBzdHlsZS5tYXhXaWR0aDtcblxuXHRcdFx0Ly8gUHV0IGluIHRoZSBuZXcgdmFsdWVzIHRvIGdldCBhIGNvbXB1dGVkIHZhbHVlIG91dFxuXHRcdFx0c3R5bGUubWluV2lkdGggPSBzdHlsZS5tYXhXaWR0aCA9IHN0eWxlLndpZHRoID0gcmV0O1xuXHRcdFx0cmV0ID0gY29tcHV0ZWQud2lkdGg7XG5cblx0XHRcdC8vIFJldmVydCB0aGUgY2hhbmdlZCB2YWx1ZXNcblx0XHRcdHN0eWxlLndpZHRoID0gd2lkdGg7XG5cdFx0XHRzdHlsZS5taW5XaWR0aCA9IG1pbldpZHRoO1xuXHRcdFx0c3R5bGUubWF4V2lkdGggPSBtYXhXaWR0aDtcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gcmV0ICE9PSB1bmRlZmluZWQgP1xuXHRcdC8vIFN1cHBvcnQ6IElFXG5cdFx0Ly8gSUUgcmV0dXJucyB6SW5kZXggdmFsdWUgYXMgYW4gaW50ZWdlci5cblx0XHRyZXQgKyBcIlwiIDpcblx0XHRyZXQ7XG59XG5cblxuZnVuY3Rpb24gYWRkR2V0SG9va0lmKCBjb25kaXRpb25GbiwgaG9va0ZuICkge1xuXHQvLyBEZWZpbmUgdGhlIGhvb2ssIHdlJ2xsIGNoZWNrIG9uIHRoZSBmaXJzdCBydW4gaWYgaXQncyByZWFsbHkgbmVlZGVkLlxuXHRyZXR1cm4ge1xuXHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAoIGNvbmRpdGlvbkZuKCkgKSB7XG5cdFx0XHRcdC8vIEhvb2sgbm90IG5lZWRlZCAob3IgaXQncyBub3QgcG9zc2libGUgdG8gdXNlIGl0IGR1ZSB0byBtaXNzaW5nIGRlcGVuZGVuY3kpLFxuXHRcdFx0XHQvLyByZW1vdmUgaXQuXG5cdFx0XHRcdC8vIFNpbmNlIHRoZXJlIGFyZSBubyBvdGhlciBob29rcyBmb3IgbWFyZ2luUmlnaHQsIHJlbW92ZSB0aGUgd2hvbGUgb2JqZWN0LlxuXHRcdFx0XHRkZWxldGUgdGhpcy5nZXQ7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0Ly8gSG9vayBuZWVkZWQ7IHJlZGVmaW5lIGl0IHNvIHRoYXQgdGhlIHN1cHBvcnQgdGVzdCBpcyBub3QgZXhlY3V0ZWQgYWdhaW4uXG5cblx0XHRcdHJldHVybiAodGhpcy5nZXQgPSBob29rRm4pLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTtcblx0XHR9XG5cdH07XG59XG5cblxuKGZ1bmN0aW9uKCkge1xuXHR2YXIgcGl4ZWxQb3NpdGlvblZhbCwgYm94U2l6aW5nUmVsaWFibGVWYWwsXG5cdFx0ZG9jRWxlbSA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCxcblx0XHRjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCBcImRpdlwiICksXG5cdFx0ZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggXCJkaXZcIiApO1xuXG5cdGlmICggIWRpdi5zdHlsZSApIHtcblx0XHRyZXR1cm47XG5cdH1cblxuXHRkaXYuc3R5bGUuYmFja2dyb3VuZENsaXAgPSBcImNvbnRlbnQtYm94XCI7XG5cdGRpdi5jbG9uZU5vZGUoIHRydWUgKS5zdHlsZS5iYWNrZ3JvdW5kQ2xpcCA9IFwiXCI7XG5cdHN1cHBvcnQuY2xlYXJDbG9uZVN0eWxlID0gZGl2LnN0eWxlLmJhY2tncm91bmRDbGlwID09PSBcImNvbnRlbnQtYm94XCI7XG5cblx0Y29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSBcImJvcmRlcjowO3dpZHRoOjA7aGVpZ2h0OjA7dG9wOjA7bGVmdDotOTk5OXB4O21hcmdpbi10b3A6MXB4O1wiICtcblx0XHRcInBvc2l0aW9uOmFic29sdXRlXCI7XG5cdGNvbnRhaW5lci5hcHBlbmRDaGlsZCggZGl2ICk7XG5cblx0Ly8gRXhlY3V0aW5nIGJvdGggcGl4ZWxQb3NpdGlvbiAmIGJveFNpemluZ1JlbGlhYmxlIHRlc3RzIHJlcXVpcmUgb25seSBvbmUgbGF5b3V0XG5cdC8vIHNvIHRoZXkncmUgZXhlY3V0ZWQgYXQgdGhlIHNhbWUgdGltZSB0byBzYXZlIHRoZSBzZWNvbmQgY29tcHV0YXRpb24uXG5cdGZ1bmN0aW9uIGNvbXB1dGVQaXhlbFBvc2l0aW9uQW5kQm94U2l6aW5nUmVsaWFibGUoKSB7XG5cdFx0ZGl2LnN0eWxlLmNzc1RleHQgPVxuXHRcdFx0Ly8gU3VwcG9ydDogRmlyZWZveDwyOSwgQW5kcm9pZCAyLjNcblx0XHRcdC8vIFZlbmRvci1wcmVmaXggYm94LXNpemluZ1xuXHRcdFx0XCItd2Via2l0LWJveC1zaXppbmc6Ym9yZGVyLWJveDstbW96LWJveC1zaXppbmc6Ym9yZGVyLWJveDtcIiArXG5cdFx0XHRcImJveC1zaXppbmc6Ym9yZGVyLWJveDtkaXNwbGF5OmJsb2NrO21hcmdpbi10b3A6MSU7dG9wOjElO1wiICtcblx0XHRcdFwiYm9yZGVyOjFweDtwYWRkaW5nOjFweDt3aWR0aDo0cHg7cG9zaXRpb246YWJzb2x1dGVcIjtcblx0XHRkaXYuaW5uZXJIVE1MID0gXCJcIjtcblx0XHRkb2NFbGVtLmFwcGVuZENoaWxkKCBjb250YWluZXIgKTtcblxuXHRcdHZhciBkaXZTdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKCBkaXYsIG51bGwgKTtcblx0XHRwaXhlbFBvc2l0aW9uVmFsID0gZGl2U3R5bGUudG9wICE9PSBcIjElXCI7XG5cdFx0Ym94U2l6aW5nUmVsaWFibGVWYWwgPSBkaXZTdHlsZS53aWR0aCA9PT0gXCI0cHhcIjtcblxuXHRcdGRvY0VsZW0ucmVtb3ZlQ2hpbGQoIGNvbnRhaW5lciApO1xuXHR9XG5cblx0Ly8gU3VwcG9ydDogbm9kZS5qcyBqc2RvbVxuXHQvLyBEb24ndCBhc3N1bWUgdGhhdCBnZXRDb21wdXRlZFN0eWxlIGlzIGEgcHJvcGVydHkgb2YgdGhlIGdsb2JhbCBvYmplY3Rcblx0aWYgKCB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSApIHtcblx0XHRqUXVlcnkuZXh0ZW5kKCBzdXBwb3J0LCB7XG5cdFx0XHRwaXhlbFBvc2l0aW9uOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0Ly8gVGhpcyB0ZXN0IGlzIGV4ZWN1dGVkIG9ubHkgb25jZSBidXQgd2Ugc3RpbGwgZG8gbWVtb2l6aW5nXG5cdFx0XHRcdC8vIHNpbmNlIHdlIGNhbiB1c2UgdGhlIGJveFNpemluZ1JlbGlhYmxlIHByZS1jb21wdXRpbmcuXG5cdFx0XHRcdC8vIE5vIG5lZWQgdG8gY2hlY2sgaWYgdGhlIHRlc3Qgd2FzIGFscmVhZHkgcGVyZm9ybWVkLCB0aG91Z2guXG5cdFx0XHRcdGNvbXB1dGVQaXhlbFBvc2l0aW9uQW5kQm94U2l6aW5nUmVsaWFibGUoKTtcblx0XHRcdFx0cmV0dXJuIHBpeGVsUG9zaXRpb25WYWw7XG5cdFx0XHR9LFxuXHRcdFx0Ym94U2l6aW5nUmVsaWFibGU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAoIGJveFNpemluZ1JlbGlhYmxlVmFsID09IG51bGwgKSB7XG5cdFx0XHRcdFx0Y29tcHV0ZVBpeGVsUG9zaXRpb25BbmRCb3hTaXppbmdSZWxpYWJsZSgpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiBib3hTaXppbmdSZWxpYWJsZVZhbDtcblx0XHRcdH0sXG5cdFx0XHRyZWxpYWJsZU1hcmdpblJpZ2h0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0Ly8gU3VwcG9ydDogQW5kcm9pZCAyLjNcblx0XHRcdFx0Ly8gQ2hlY2sgaWYgZGl2IHdpdGggZXhwbGljaXQgd2lkdGggYW5kIG5vIG1hcmdpbi1yaWdodCBpbmNvcnJlY3RseVxuXHRcdFx0XHQvLyBnZXRzIGNvbXB1dGVkIG1hcmdpbi1yaWdodCBiYXNlZCBvbiB3aWR0aCBvZiBjb250YWluZXIuICgjMzMzMylcblx0XHRcdFx0Ly8gV2ViS2l0IEJ1ZyAxMzM0MyAtIGdldENvbXB1dGVkU3R5bGUgcmV0dXJucyB3cm9uZyB2YWx1ZSBmb3IgbWFyZ2luLXJpZ2h0XG5cdFx0XHRcdC8vIFRoaXMgc3VwcG9ydCBmdW5jdGlvbiBpcyBvbmx5IGV4ZWN1dGVkIG9uY2Ugc28gbm8gbWVtb2l6aW5nIGlzIG5lZWRlZC5cblx0XHRcdFx0dmFyIHJldCxcblx0XHRcdFx0XHRtYXJnaW5EaXYgPSBkaXYuYXBwZW5kQ2hpbGQoIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIFwiZGl2XCIgKSApO1xuXG5cdFx0XHRcdC8vIFJlc2V0IENTUzogYm94LXNpemluZzsgZGlzcGxheTsgbWFyZ2luOyBib3JkZXI7IHBhZGRpbmdcblx0XHRcdFx0bWFyZ2luRGl2LnN0eWxlLmNzc1RleHQgPSBkaXYuc3R5bGUuY3NzVGV4dCA9XG5cdFx0XHRcdFx0Ly8gU3VwcG9ydDogRmlyZWZveDwyOSwgQW5kcm9pZCAyLjNcblx0XHRcdFx0XHQvLyBWZW5kb3ItcHJlZml4IGJveC1zaXppbmdcblx0XHRcdFx0XHRcIi13ZWJraXQtYm94LXNpemluZzpjb250ZW50LWJveDstbW96LWJveC1zaXppbmc6Y29udGVudC1ib3g7XCIgK1xuXHRcdFx0XHRcdFwiYm94LXNpemluZzpjb250ZW50LWJveDtkaXNwbGF5OmJsb2NrO21hcmdpbjowO2JvcmRlcjowO3BhZGRpbmc6MFwiO1xuXHRcdFx0XHRtYXJnaW5EaXYuc3R5bGUubWFyZ2luUmlnaHQgPSBtYXJnaW5EaXYuc3R5bGUud2lkdGggPSBcIjBcIjtcblx0XHRcdFx0ZGl2LnN0eWxlLndpZHRoID0gXCIxcHhcIjtcblx0XHRcdFx0ZG9jRWxlbS5hcHBlbmRDaGlsZCggY29udGFpbmVyICk7XG5cblx0XHRcdFx0cmV0ID0gIXBhcnNlRmxvYXQoIHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKCBtYXJnaW5EaXYsIG51bGwgKS5tYXJnaW5SaWdodCApO1xuXG5cdFx0XHRcdGRvY0VsZW0ucmVtb3ZlQ2hpbGQoIGNvbnRhaW5lciApO1xuXG5cdFx0XHRcdHJldHVybiByZXQ7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cbn0pKCk7XG5cblxuLy8gQSBtZXRob2QgZm9yIHF1aWNrbHkgc3dhcHBpbmcgaW4vb3V0IENTUyBwcm9wZXJ0aWVzIHRvIGdldCBjb3JyZWN0IGNhbGN1bGF0aW9ucy5cbmpRdWVyeS5zd2FwID0gZnVuY3Rpb24oIGVsZW0sIG9wdGlvbnMsIGNhbGxiYWNrLCBhcmdzICkge1xuXHR2YXIgcmV0LCBuYW1lLFxuXHRcdG9sZCA9IHt9O1xuXG5cdC8vIFJlbWVtYmVyIHRoZSBvbGQgdmFsdWVzLCBhbmQgaW5zZXJ0IHRoZSBuZXcgb25lc1xuXHRmb3IgKCBuYW1lIGluIG9wdGlvbnMgKSB7XG5cdFx0b2xkWyBuYW1lIF0gPSBlbGVtLnN0eWxlWyBuYW1lIF07XG5cdFx0ZWxlbS5zdHlsZVsgbmFtZSBdID0gb3B0aW9uc1sgbmFtZSBdO1xuXHR9XG5cblx0cmV0ID0gY2FsbGJhY2suYXBwbHkoIGVsZW0sIGFyZ3MgfHwgW10gKTtcblxuXHQvLyBSZXZlcnQgdGhlIG9sZCB2YWx1ZXNcblx0Zm9yICggbmFtZSBpbiBvcHRpb25zICkge1xuXHRcdGVsZW0uc3R5bGVbIG5hbWUgXSA9IG9sZFsgbmFtZSBdO1xuXHR9XG5cblx0cmV0dXJuIHJldDtcbn07XG5cblxudmFyXG5cdC8vIHN3YXBwYWJsZSBpZiBkaXNwbGF5IGlzIG5vbmUgb3Igc3RhcnRzIHdpdGggdGFibGUgZXhjZXB0IFwidGFibGVcIiwgXCJ0YWJsZS1jZWxsXCIsIG9yIFwidGFibGUtY2FwdGlvblwiXG5cdC8vIHNlZSBoZXJlIGZvciBkaXNwbGF5IHZhbHVlczogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9DU1MvZGlzcGxheVxuXHRyZGlzcGxheXN3YXAgPSAvXihub25lfHRhYmxlKD8hLWNbZWFdKS4rKS8sXG5cdHJudW1zcGxpdCA9IG5ldyBSZWdFeHAoIFwiXihcIiArIHBudW0gKyBcIikoLiopJFwiLCBcImlcIiApLFxuXHRycmVsTnVtID0gbmV3IFJlZ0V4cCggXCJeKFsrLV0pPShcIiArIHBudW0gKyBcIilcIiwgXCJpXCIgKSxcblxuXHRjc3NTaG93ID0geyBwb3NpdGlvbjogXCJhYnNvbHV0ZVwiLCB2aXNpYmlsaXR5OiBcImhpZGRlblwiLCBkaXNwbGF5OiBcImJsb2NrXCIgfSxcblx0Y3NzTm9ybWFsVHJhbnNmb3JtID0ge1xuXHRcdGxldHRlclNwYWNpbmc6IFwiMFwiLFxuXHRcdGZvbnRXZWlnaHQ6IFwiNDAwXCJcblx0fSxcblxuXHRjc3NQcmVmaXhlcyA9IFsgXCJXZWJraXRcIiwgXCJPXCIsIFwiTW96XCIsIFwibXNcIiBdO1xuXG4vLyByZXR1cm4gYSBjc3MgcHJvcGVydHkgbWFwcGVkIHRvIGEgcG90ZW50aWFsbHkgdmVuZG9yIHByZWZpeGVkIHByb3BlcnR5XG5mdW5jdGlvbiB2ZW5kb3JQcm9wTmFtZSggc3R5bGUsIG5hbWUgKSB7XG5cblx0Ly8gc2hvcnRjdXQgZm9yIG5hbWVzIHRoYXQgYXJlIG5vdCB2ZW5kb3IgcHJlZml4ZWRcblx0aWYgKCBuYW1lIGluIHN0eWxlICkge1xuXHRcdHJldHVybiBuYW1lO1xuXHR9XG5cblx0Ly8gY2hlY2sgZm9yIHZlbmRvciBwcmVmaXhlZCBuYW1lc1xuXHR2YXIgY2FwTmFtZSA9IG5hbWVbMF0udG9VcHBlckNhc2UoKSArIG5hbWUuc2xpY2UoMSksXG5cdFx0b3JpZ05hbWUgPSBuYW1lLFxuXHRcdGkgPSBjc3NQcmVmaXhlcy5sZW5ndGg7XG5cblx0d2hpbGUgKCBpLS0gKSB7XG5cdFx0bmFtZSA9IGNzc1ByZWZpeGVzWyBpIF0gKyBjYXBOYW1lO1xuXHRcdGlmICggbmFtZSBpbiBzdHlsZSApIHtcblx0XHRcdHJldHVybiBuYW1lO1xuXHRcdH1cblx0fVxuXG5cdHJldHVybiBvcmlnTmFtZTtcbn1cblxuZnVuY3Rpb24gc2V0UG9zaXRpdmVOdW1iZXIoIGVsZW0sIHZhbHVlLCBzdWJ0cmFjdCApIHtcblx0dmFyIG1hdGNoZXMgPSBybnVtc3BsaXQuZXhlYyggdmFsdWUgKTtcblx0cmV0dXJuIG1hdGNoZXMgP1xuXHRcdC8vIEd1YXJkIGFnYWluc3QgdW5kZWZpbmVkIFwic3VidHJhY3RcIiwgZS5nLiwgd2hlbiB1c2VkIGFzIGluIGNzc0hvb2tzXG5cdFx0TWF0aC5tYXgoIDAsIG1hdGNoZXNbIDEgXSAtICggc3VidHJhY3QgfHwgMCApICkgKyAoIG1hdGNoZXNbIDIgXSB8fCBcInB4XCIgKSA6XG5cdFx0dmFsdWU7XG59XG5cbmZ1bmN0aW9uIGF1Z21lbnRXaWR0aE9ySGVpZ2h0KCBlbGVtLCBuYW1lLCBleHRyYSwgaXNCb3JkZXJCb3gsIHN0eWxlcyApIHtcblx0dmFyIGkgPSBleHRyYSA9PT0gKCBpc0JvcmRlckJveCA/IFwiYm9yZGVyXCIgOiBcImNvbnRlbnRcIiApID9cblx0XHQvLyBJZiB3ZSBhbHJlYWR5IGhhdmUgdGhlIHJpZ2h0IG1lYXN1cmVtZW50LCBhdm9pZCBhdWdtZW50YXRpb25cblx0XHQ0IDpcblx0XHQvLyBPdGhlcndpc2UgaW5pdGlhbGl6ZSBmb3IgaG9yaXpvbnRhbCBvciB2ZXJ0aWNhbCBwcm9wZXJ0aWVzXG5cdFx0bmFtZSA9PT0gXCJ3aWR0aFwiID8gMSA6IDAsXG5cblx0XHR2YWwgPSAwO1xuXG5cdGZvciAoIDsgaSA8IDQ7IGkgKz0gMiApIHtcblx0XHQvLyBib3RoIGJveCBtb2RlbHMgZXhjbHVkZSBtYXJnaW4sIHNvIGFkZCBpdCBpZiB3ZSB3YW50IGl0XG5cdFx0aWYgKCBleHRyYSA9PT0gXCJtYXJnaW5cIiApIHtcblx0XHRcdHZhbCArPSBqUXVlcnkuY3NzKCBlbGVtLCBleHRyYSArIGNzc0V4cGFuZFsgaSBdLCB0cnVlLCBzdHlsZXMgKTtcblx0XHR9XG5cblx0XHRpZiAoIGlzQm9yZGVyQm94ICkge1xuXHRcdFx0Ly8gYm9yZGVyLWJveCBpbmNsdWRlcyBwYWRkaW5nLCBzbyByZW1vdmUgaXQgaWYgd2Ugd2FudCBjb250ZW50XG5cdFx0XHRpZiAoIGV4dHJhID09PSBcImNvbnRlbnRcIiApIHtcblx0XHRcdFx0dmFsIC09IGpRdWVyeS5jc3MoIGVsZW0sIFwicGFkZGluZ1wiICsgY3NzRXhwYW5kWyBpIF0sIHRydWUsIHN0eWxlcyApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBhdCB0aGlzIHBvaW50LCBleHRyYSBpc24ndCBib3JkZXIgbm9yIG1hcmdpbiwgc28gcmVtb3ZlIGJvcmRlclxuXHRcdFx0aWYgKCBleHRyYSAhPT0gXCJtYXJnaW5cIiApIHtcblx0XHRcdFx0dmFsIC09IGpRdWVyeS5jc3MoIGVsZW0sIFwiYm9yZGVyXCIgKyBjc3NFeHBhbmRbIGkgXSArIFwiV2lkdGhcIiwgdHJ1ZSwgc3R5bGVzICk7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIGF0IHRoaXMgcG9pbnQsIGV4dHJhIGlzbid0IGNvbnRlbnQsIHNvIGFkZCBwYWRkaW5nXG5cdFx0XHR2YWwgKz0galF1ZXJ5LmNzcyggZWxlbSwgXCJwYWRkaW5nXCIgKyBjc3NFeHBhbmRbIGkgXSwgdHJ1ZSwgc3R5bGVzICk7XG5cblx0XHRcdC8vIGF0IHRoaXMgcG9pbnQsIGV4dHJhIGlzbid0IGNvbnRlbnQgbm9yIHBhZGRpbmcsIHNvIGFkZCBib3JkZXJcblx0XHRcdGlmICggZXh0cmEgIT09IFwicGFkZGluZ1wiICkge1xuXHRcdFx0XHR2YWwgKz0galF1ZXJ5LmNzcyggZWxlbSwgXCJib3JkZXJcIiArIGNzc0V4cGFuZFsgaSBdICsgXCJXaWR0aFwiLCB0cnVlLCBzdHlsZXMgKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gdmFsO1xufVxuXG5mdW5jdGlvbiBnZXRXaWR0aE9ySGVpZ2h0KCBlbGVtLCBuYW1lLCBleHRyYSApIHtcblxuXHQvLyBTdGFydCB3aXRoIG9mZnNldCBwcm9wZXJ0eSwgd2hpY2ggaXMgZXF1aXZhbGVudCB0byB0aGUgYm9yZGVyLWJveCB2YWx1ZVxuXHR2YXIgdmFsdWVJc0JvcmRlckJveCA9IHRydWUsXG5cdFx0dmFsID0gbmFtZSA9PT0gXCJ3aWR0aFwiID8gZWxlbS5vZmZzZXRXaWR0aCA6IGVsZW0ub2Zmc2V0SGVpZ2h0LFxuXHRcdHN0eWxlcyA9IGdldFN0eWxlcyggZWxlbSApLFxuXHRcdGlzQm9yZGVyQm94ID0galF1ZXJ5LmNzcyggZWxlbSwgXCJib3hTaXppbmdcIiwgZmFsc2UsIHN0eWxlcyApID09PSBcImJvcmRlci1ib3hcIjtcblxuXHQvLyBzb21lIG5vbi1odG1sIGVsZW1lbnRzIHJldHVybiB1bmRlZmluZWQgZm9yIG9mZnNldFdpZHRoLCBzbyBjaGVjayBmb3IgbnVsbC91bmRlZmluZWRcblx0Ly8gc3ZnIC0gaHR0cHM6Ly9idWd6aWxsYS5tb3ppbGxhLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9NjQ5Mjg1XG5cdC8vIE1hdGhNTCAtIGh0dHBzOi8vYnVnemlsbGEubW96aWxsYS5vcmcvc2hvd19idWcuY2dpP2lkPTQ5MTY2OFxuXHRpZiAoIHZhbCA8PSAwIHx8IHZhbCA9PSBudWxsICkge1xuXHRcdC8vIEZhbGwgYmFjayB0byBjb21wdXRlZCB0aGVuIHVuY29tcHV0ZWQgY3NzIGlmIG5lY2Vzc2FyeVxuXHRcdHZhbCA9IGN1ckNTUyggZWxlbSwgbmFtZSwgc3R5bGVzICk7XG5cdFx0aWYgKCB2YWwgPCAwIHx8IHZhbCA9PSBudWxsICkge1xuXHRcdFx0dmFsID0gZWxlbS5zdHlsZVsgbmFtZSBdO1xuXHRcdH1cblxuXHRcdC8vIENvbXB1dGVkIHVuaXQgaXMgbm90IHBpeGVscy4gU3RvcCBoZXJlIGFuZCByZXR1cm4uXG5cdFx0aWYgKCBybnVtbm9ucHgudGVzdCh2YWwpICkge1xuXHRcdFx0cmV0dXJuIHZhbDtcblx0XHR9XG5cblx0XHQvLyB3ZSBuZWVkIHRoZSBjaGVjayBmb3Igc3R5bGUgaW4gY2FzZSBhIGJyb3dzZXIgd2hpY2ggcmV0dXJucyB1bnJlbGlhYmxlIHZhbHVlc1xuXHRcdC8vIGZvciBnZXRDb21wdXRlZFN0eWxlIHNpbGVudGx5IGZhbGxzIGJhY2sgdG8gdGhlIHJlbGlhYmxlIGVsZW0uc3R5bGVcblx0XHR2YWx1ZUlzQm9yZGVyQm94ID0gaXNCb3JkZXJCb3ggJiZcblx0XHRcdCggc3VwcG9ydC5ib3hTaXppbmdSZWxpYWJsZSgpIHx8IHZhbCA9PT0gZWxlbS5zdHlsZVsgbmFtZSBdICk7XG5cblx0XHQvLyBOb3JtYWxpemUgXCJcIiwgYXV0bywgYW5kIHByZXBhcmUgZm9yIGV4dHJhXG5cdFx0dmFsID0gcGFyc2VGbG9hdCggdmFsICkgfHwgMDtcblx0fVxuXG5cdC8vIHVzZSB0aGUgYWN0aXZlIGJveC1zaXppbmcgbW9kZWwgdG8gYWRkL3N1YnRyYWN0IGlycmVsZXZhbnQgc3R5bGVzXG5cdHJldHVybiAoIHZhbCArXG5cdFx0YXVnbWVudFdpZHRoT3JIZWlnaHQoXG5cdFx0XHRlbGVtLFxuXHRcdFx0bmFtZSxcblx0XHRcdGV4dHJhIHx8ICggaXNCb3JkZXJCb3ggPyBcImJvcmRlclwiIDogXCJjb250ZW50XCIgKSxcblx0XHRcdHZhbHVlSXNCb3JkZXJCb3gsXG5cdFx0XHRzdHlsZXNcblx0XHQpXG5cdCkgKyBcInB4XCI7XG59XG5cbmZ1bmN0aW9uIHNob3dIaWRlKCBlbGVtZW50cywgc2hvdyApIHtcblx0dmFyIGRpc3BsYXksIGVsZW0sIGhpZGRlbixcblx0XHR2YWx1ZXMgPSBbXSxcblx0XHRpbmRleCA9IDAsXG5cdFx0bGVuZ3RoID0gZWxlbWVudHMubGVuZ3RoO1xuXG5cdGZvciAoIDsgaW5kZXggPCBsZW5ndGg7IGluZGV4KysgKSB7XG5cdFx0ZWxlbSA9IGVsZW1lbnRzWyBpbmRleCBdO1xuXHRcdGlmICggIWVsZW0uc3R5bGUgKSB7XG5cdFx0XHRjb250aW51ZTtcblx0XHR9XG5cblx0XHR2YWx1ZXNbIGluZGV4IF0gPSBkYXRhX3ByaXYuZ2V0KCBlbGVtLCBcIm9sZGRpc3BsYXlcIiApO1xuXHRcdGRpc3BsYXkgPSBlbGVtLnN0eWxlLmRpc3BsYXk7XG5cdFx0aWYgKCBzaG93ICkge1xuXHRcdFx0Ly8gUmVzZXQgdGhlIGlubGluZSBkaXNwbGF5IG9mIHRoaXMgZWxlbWVudCB0byBsZWFybiBpZiBpdCBpc1xuXHRcdFx0Ly8gYmVpbmcgaGlkZGVuIGJ5IGNhc2NhZGVkIHJ1bGVzIG9yIG5vdFxuXHRcdFx0aWYgKCAhdmFsdWVzWyBpbmRleCBdICYmIGRpc3BsYXkgPT09IFwibm9uZVwiICkge1xuXHRcdFx0XHRlbGVtLnN0eWxlLmRpc3BsYXkgPSBcIlwiO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBTZXQgZWxlbWVudHMgd2hpY2ggaGF2ZSBiZWVuIG92ZXJyaWRkZW4gd2l0aCBkaXNwbGF5OiBub25lXG5cdFx0XHQvLyBpbiBhIHN0eWxlc2hlZXQgdG8gd2hhdGV2ZXIgdGhlIGRlZmF1bHQgYnJvd3NlciBzdHlsZSBpc1xuXHRcdFx0Ly8gZm9yIHN1Y2ggYW4gZWxlbWVudFxuXHRcdFx0aWYgKCBlbGVtLnN0eWxlLmRpc3BsYXkgPT09IFwiXCIgJiYgaXNIaWRkZW4oIGVsZW0gKSApIHtcblx0XHRcdFx0dmFsdWVzWyBpbmRleCBdID0gZGF0YV9wcml2LmFjY2VzcyggZWxlbSwgXCJvbGRkaXNwbGF5XCIsIGRlZmF1bHREaXNwbGF5KGVsZW0ubm9kZU5hbWUpICk7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdGhpZGRlbiA9IGlzSGlkZGVuKCBlbGVtICk7XG5cblx0XHRcdGlmICggZGlzcGxheSAhPT0gXCJub25lXCIgfHwgIWhpZGRlbiApIHtcblx0XHRcdFx0ZGF0YV9wcml2LnNldCggZWxlbSwgXCJvbGRkaXNwbGF5XCIsIGhpZGRlbiA/IGRpc3BsYXkgOiBqUXVlcnkuY3NzKCBlbGVtLCBcImRpc3BsYXlcIiApICk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0Ly8gU2V0IHRoZSBkaXNwbGF5IG9mIG1vc3Qgb2YgdGhlIGVsZW1lbnRzIGluIGEgc2Vjb25kIGxvb3Bcblx0Ly8gdG8gYXZvaWQgdGhlIGNvbnN0YW50IHJlZmxvd1xuXHRmb3IgKCBpbmRleCA9IDA7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrICkge1xuXHRcdGVsZW0gPSBlbGVtZW50c1sgaW5kZXggXTtcblx0XHRpZiAoICFlbGVtLnN0eWxlICkge1xuXHRcdFx0Y29udGludWU7XG5cdFx0fVxuXHRcdGlmICggIXNob3cgfHwgZWxlbS5zdHlsZS5kaXNwbGF5ID09PSBcIm5vbmVcIiB8fCBlbGVtLnN0eWxlLmRpc3BsYXkgPT09IFwiXCIgKSB7XG5cdFx0XHRlbGVtLnN0eWxlLmRpc3BsYXkgPSBzaG93ID8gdmFsdWVzWyBpbmRleCBdIHx8IFwiXCIgOiBcIm5vbmVcIjtcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gZWxlbWVudHM7XG59XG5cbmpRdWVyeS5leHRlbmQoe1xuXHQvLyBBZGQgaW4gc3R5bGUgcHJvcGVydHkgaG9va3MgZm9yIG92ZXJyaWRpbmcgdGhlIGRlZmF1bHRcblx0Ly8gYmVoYXZpb3Igb2YgZ2V0dGluZyBhbmQgc2V0dGluZyBhIHN0eWxlIHByb3BlcnR5XG5cdGNzc0hvb2tzOiB7XG5cdFx0b3BhY2l0eToge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbiggZWxlbSwgY29tcHV0ZWQgKSB7XG5cdFx0XHRcdGlmICggY29tcHV0ZWQgKSB7XG5cdFx0XHRcdFx0Ly8gV2Ugc2hvdWxkIGFsd2F5cyBnZXQgYSBudW1iZXIgYmFjayBmcm9tIG9wYWNpdHlcblx0XHRcdFx0XHR2YXIgcmV0ID0gY3VyQ1NTKCBlbGVtLCBcIm9wYWNpdHlcIiApO1xuXHRcdFx0XHRcdHJldHVybiByZXQgPT09IFwiXCIgPyBcIjFcIiA6IHJldDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fSxcblxuXHQvLyBEb24ndCBhdXRvbWF0aWNhbGx5IGFkZCBcInB4XCIgdG8gdGhlc2UgcG9zc2libHktdW5pdGxlc3MgcHJvcGVydGllc1xuXHRjc3NOdW1iZXI6IHtcblx0XHRcImNvbHVtbkNvdW50XCI6IHRydWUsXG5cdFx0XCJmaWxsT3BhY2l0eVwiOiB0cnVlLFxuXHRcdFwiZmxleEdyb3dcIjogdHJ1ZSxcblx0XHRcImZsZXhTaHJpbmtcIjogdHJ1ZSxcblx0XHRcImZvbnRXZWlnaHRcIjogdHJ1ZSxcblx0XHRcImxpbmVIZWlnaHRcIjogdHJ1ZSxcblx0XHRcIm9wYWNpdHlcIjogdHJ1ZSxcblx0XHRcIm9yZGVyXCI6IHRydWUsXG5cdFx0XCJvcnBoYW5zXCI6IHRydWUsXG5cdFx0XCJ3aWRvd3NcIjogdHJ1ZSxcblx0XHRcInpJbmRleFwiOiB0cnVlLFxuXHRcdFwiem9vbVwiOiB0cnVlXG5cdH0sXG5cblx0Ly8gQWRkIGluIHByb3BlcnRpZXMgd2hvc2UgbmFtZXMgeW91IHdpc2ggdG8gZml4IGJlZm9yZVxuXHQvLyBzZXR0aW5nIG9yIGdldHRpbmcgdGhlIHZhbHVlXG5cdGNzc1Byb3BzOiB7XG5cdFx0Ly8gbm9ybWFsaXplIGZsb2F0IGNzcyBwcm9wZXJ0eVxuXHRcdFwiZmxvYXRcIjogXCJjc3NGbG9hdFwiXG5cdH0sXG5cblx0Ly8gR2V0IGFuZCBzZXQgdGhlIHN0eWxlIHByb3BlcnR5IG9uIGEgRE9NIE5vZGVcblx0c3R5bGU6IGZ1bmN0aW9uKCBlbGVtLCBuYW1lLCB2YWx1ZSwgZXh0cmEgKSB7XG5cdFx0Ly8gRG9uJ3Qgc2V0IHN0eWxlcyBvbiB0ZXh0IGFuZCBjb21tZW50IG5vZGVzXG5cdFx0aWYgKCAhZWxlbSB8fCBlbGVtLm5vZGVUeXBlID09PSAzIHx8IGVsZW0ubm9kZVR5cGUgPT09IDggfHwgIWVsZW0uc3R5bGUgKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gTWFrZSBzdXJlIHRoYXQgd2UncmUgd29ya2luZyB3aXRoIHRoZSByaWdodCBuYW1lXG5cdFx0dmFyIHJldCwgdHlwZSwgaG9va3MsXG5cdFx0XHRvcmlnTmFtZSA9IGpRdWVyeS5jYW1lbENhc2UoIG5hbWUgKSxcblx0XHRcdHN0eWxlID0gZWxlbS5zdHlsZTtcblxuXHRcdG5hbWUgPSBqUXVlcnkuY3NzUHJvcHNbIG9yaWdOYW1lIF0gfHwgKCBqUXVlcnkuY3NzUHJvcHNbIG9yaWdOYW1lIF0gPSB2ZW5kb3JQcm9wTmFtZSggc3R5bGUsIG9yaWdOYW1lICkgKTtcblxuXHRcdC8vIGdldHMgaG9vayBmb3IgdGhlIHByZWZpeGVkIHZlcnNpb25cblx0XHQvLyBmb2xsb3dlZCBieSB0aGUgdW5wcmVmaXhlZCB2ZXJzaW9uXG5cdFx0aG9va3MgPSBqUXVlcnkuY3NzSG9va3NbIG5hbWUgXSB8fCBqUXVlcnkuY3NzSG9va3NbIG9yaWdOYW1lIF07XG5cblx0XHQvLyBDaGVjayBpZiB3ZSdyZSBzZXR0aW5nIGEgdmFsdWVcblx0XHRpZiAoIHZhbHVlICE9PSB1bmRlZmluZWQgKSB7XG5cdFx0XHR0eXBlID0gdHlwZW9mIHZhbHVlO1xuXG5cdFx0XHQvLyBjb252ZXJ0IHJlbGF0aXZlIG51bWJlciBzdHJpbmdzICgrPSBvciAtPSkgdG8gcmVsYXRpdmUgbnVtYmVycy4gIzczNDVcblx0XHRcdGlmICggdHlwZSA9PT0gXCJzdHJpbmdcIiAmJiAocmV0ID0gcnJlbE51bS5leGVjKCB2YWx1ZSApKSApIHtcblx0XHRcdFx0dmFsdWUgPSAoIHJldFsxXSArIDEgKSAqIHJldFsyXSArIHBhcnNlRmxvYXQoIGpRdWVyeS5jc3MoIGVsZW0sIG5hbWUgKSApO1xuXHRcdFx0XHQvLyBGaXhlcyBidWcgIzkyMzdcblx0XHRcdFx0dHlwZSA9IFwibnVtYmVyXCI7XG5cdFx0XHR9XG5cblx0XHRcdC8vIE1ha2Ugc3VyZSB0aGF0IG51bGwgYW5kIE5hTiB2YWx1ZXMgYXJlbid0IHNldC4gU2VlOiAjNzExNlxuXHRcdFx0aWYgKCB2YWx1ZSA9PSBudWxsIHx8IHZhbHVlICE9PSB2YWx1ZSApIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBJZiBhIG51bWJlciB3YXMgcGFzc2VkIGluLCBhZGQgJ3B4JyB0byB0aGUgKGV4Y2VwdCBmb3IgY2VydGFpbiBDU1MgcHJvcGVydGllcylcblx0XHRcdGlmICggdHlwZSA9PT0gXCJudW1iZXJcIiAmJiAhalF1ZXJ5LmNzc051bWJlclsgb3JpZ05hbWUgXSApIHtcblx0XHRcdFx0dmFsdWUgKz0gXCJweFwiO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBGaXhlcyAjODkwOCwgaXQgY2FuIGJlIGRvbmUgbW9yZSBjb3JyZWN0bHkgYnkgc3BlY2lmeWluZyBzZXR0ZXJzIGluIGNzc0hvb2tzLFxuXHRcdFx0Ly8gYnV0IGl0IHdvdWxkIG1lYW4gdG8gZGVmaW5lIGVpZ2h0IChmb3IgZXZlcnkgcHJvYmxlbWF0aWMgcHJvcGVydHkpIGlkZW50aWNhbCBmdW5jdGlvbnNcblx0XHRcdGlmICggIXN1cHBvcnQuY2xlYXJDbG9uZVN0eWxlICYmIHZhbHVlID09PSBcIlwiICYmIG5hbWUuaW5kZXhPZiggXCJiYWNrZ3JvdW5kXCIgKSA9PT0gMCApIHtcblx0XHRcdFx0c3R5bGVbIG5hbWUgXSA9IFwiaW5oZXJpdFwiO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBJZiBhIGhvb2sgd2FzIHByb3ZpZGVkLCB1c2UgdGhhdCB2YWx1ZSwgb3RoZXJ3aXNlIGp1c3Qgc2V0IHRoZSBzcGVjaWZpZWQgdmFsdWVcblx0XHRcdGlmICggIWhvb2tzIHx8ICEoXCJzZXRcIiBpbiBob29rcykgfHwgKHZhbHVlID0gaG9va3Muc2V0KCBlbGVtLCB2YWx1ZSwgZXh0cmEgKSkgIT09IHVuZGVmaW5lZCApIHtcblx0XHRcdFx0c3R5bGVbIG5hbWUgXSA9IHZhbHVlO1xuXHRcdFx0fVxuXG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIElmIGEgaG9vayB3YXMgcHJvdmlkZWQgZ2V0IHRoZSBub24tY29tcHV0ZWQgdmFsdWUgZnJvbSB0aGVyZVxuXHRcdFx0aWYgKCBob29rcyAmJiBcImdldFwiIGluIGhvb2tzICYmIChyZXQgPSBob29rcy5nZXQoIGVsZW0sIGZhbHNlLCBleHRyYSApKSAhPT0gdW5kZWZpbmVkICkge1xuXHRcdFx0XHRyZXR1cm4gcmV0O1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBPdGhlcndpc2UganVzdCBnZXQgdGhlIHZhbHVlIGZyb20gdGhlIHN0eWxlIG9iamVjdFxuXHRcdFx0cmV0dXJuIHN0eWxlWyBuYW1lIF07XG5cdFx0fVxuXHR9LFxuXG5cdGNzczogZnVuY3Rpb24oIGVsZW0sIG5hbWUsIGV4dHJhLCBzdHlsZXMgKSB7XG5cdFx0dmFyIHZhbCwgbnVtLCBob29rcyxcblx0XHRcdG9yaWdOYW1lID0galF1ZXJ5LmNhbWVsQ2FzZSggbmFtZSApO1xuXG5cdFx0Ly8gTWFrZSBzdXJlIHRoYXQgd2UncmUgd29ya2luZyB3aXRoIHRoZSByaWdodCBuYW1lXG5cdFx0bmFtZSA9IGpRdWVyeS5jc3NQcm9wc1sgb3JpZ05hbWUgXSB8fCAoIGpRdWVyeS5jc3NQcm9wc1sgb3JpZ05hbWUgXSA9IHZlbmRvclByb3BOYW1lKCBlbGVtLnN0eWxlLCBvcmlnTmFtZSApICk7XG5cblx0XHQvLyBnZXRzIGhvb2sgZm9yIHRoZSBwcmVmaXhlZCB2ZXJzaW9uXG5cdFx0Ly8gZm9sbG93ZWQgYnkgdGhlIHVucHJlZml4ZWQgdmVyc2lvblxuXHRcdGhvb2tzID0galF1ZXJ5LmNzc0hvb2tzWyBuYW1lIF0gfHwgalF1ZXJ5LmNzc0hvb2tzWyBvcmlnTmFtZSBdO1xuXG5cdFx0Ly8gSWYgYSBob29rIHdhcyBwcm92aWRlZCBnZXQgdGhlIGNvbXB1dGVkIHZhbHVlIGZyb20gdGhlcmVcblx0XHRpZiAoIGhvb2tzICYmIFwiZ2V0XCIgaW4gaG9va3MgKSB7XG5cdFx0XHR2YWwgPSBob29rcy5nZXQoIGVsZW0sIHRydWUsIGV4dHJhICk7XG5cdFx0fVxuXG5cdFx0Ly8gT3RoZXJ3aXNlLCBpZiBhIHdheSB0byBnZXQgdGhlIGNvbXB1dGVkIHZhbHVlIGV4aXN0cywgdXNlIHRoYXRcblx0XHRpZiAoIHZhbCA9PT0gdW5kZWZpbmVkICkge1xuXHRcdFx0dmFsID0gY3VyQ1NTKCBlbGVtLCBuYW1lLCBzdHlsZXMgKTtcblx0XHR9XG5cblx0XHQvL2NvbnZlcnQgXCJub3JtYWxcIiB0byBjb21wdXRlZCB2YWx1ZVxuXHRcdGlmICggdmFsID09PSBcIm5vcm1hbFwiICYmIG5hbWUgaW4gY3NzTm9ybWFsVHJhbnNmb3JtICkge1xuXHRcdFx0dmFsID0gY3NzTm9ybWFsVHJhbnNmb3JtWyBuYW1lIF07XG5cdFx0fVxuXG5cdFx0Ly8gUmV0dXJuLCBjb252ZXJ0aW5nIHRvIG51bWJlciBpZiBmb3JjZWQgb3IgYSBxdWFsaWZpZXIgd2FzIHByb3ZpZGVkIGFuZCB2YWwgbG9va3MgbnVtZXJpY1xuXHRcdGlmICggZXh0cmEgPT09IFwiXCIgfHwgZXh0cmEgKSB7XG5cdFx0XHRudW0gPSBwYXJzZUZsb2F0KCB2YWwgKTtcblx0XHRcdHJldHVybiBleHRyYSA9PT0gdHJ1ZSB8fCBqUXVlcnkuaXNOdW1lcmljKCBudW0gKSA/IG51bSB8fCAwIDogdmFsO1xuXHRcdH1cblx0XHRyZXR1cm4gdmFsO1xuXHR9XG59KTtcblxualF1ZXJ5LmVhY2goWyBcImhlaWdodFwiLCBcIndpZHRoXCIgXSwgZnVuY3Rpb24oIGksIG5hbWUgKSB7XG5cdGpRdWVyeS5jc3NIb29rc1sgbmFtZSBdID0ge1xuXHRcdGdldDogZnVuY3Rpb24oIGVsZW0sIGNvbXB1dGVkLCBleHRyYSApIHtcblx0XHRcdGlmICggY29tcHV0ZWQgKSB7XG5cdFx0XHRcdC8vIGNlcnRhaW4gZWxlbWVudHMgY2FuIGhhdmUgZGltZW5zaW9uIGluZm8gaWYgd2UgaW52aXNpYmx5IHNob3cgdGhlbVxuXHRcdFx0XHQvLyBob3dldmVyLCBpdCBtdXN0IGhhdmUgYSBjdXJyZW50IGRpc3BsYXkgc3R5bGUgdGhhdCB3b3VsZCBiZW5lZml0IGZyb20gdGhpc1xuXHRcdFx0XHRyZXR1cm4gcmRpc3BsYXlzd2FwLnRlc3QoIGpRdWVyeS5jc3MoIGVsZW0sIFwiZGlzcGxheVwiICkgKSAmJiBlbGVtLm9mZnNldFdpZHRoID09PSAwID9cblx0XHRcdFx0XHRqUXVlcnkuc3dhcCggZWxlbSwgY3NzU2hvdywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gZ2V0V2lkdGhPckhlaWdodCggZWxlbSwgbmFtZSwgZXh0cmEgKTtcblx0XHRcdFx0XHR9KSA6XG5cdFx0XHRcdFx0Z2V0V2lkdGhPckhlaWdodCggZWxlbSwgbmFtZSwgZXh0cmEgKTtcblx0XHRcdH1cblx0XHR9LFxuXG5cdFx0c2V0OiBmdW5jdGlvbiggZWxlbSwgdmFsdWUsIGV4dHJhICkge1xuXHRcdFx0dmFyIHN0eWxlcyA9IGV4dHJhICYmIGdldFN0eWxlcyggZWxlbSApO1xuXHRcdFx0cmV0dXJuIHNldFBvc2l0aXZlTnVtYmVyKCBlbGVtLCB2YWx1ZSwgZXh0cmEgP1xuXHRcdFx0XHRhdWdtZW50V2lkdGhPckhlaWdodChcblx0XHRcdFx0XHRlbGVtLFxuXHRcdFx0XHRcdG5hbWUsXG5cdFx0XHRcdFx0ZXh0cmEsXG5cdFx0XHRcdFx0alF1ZXJ5LmNzcyggZWxlbSwgXCJib3hTaXppbmdcIiwgZmFsc2UsIHN0eWxlcyApID09PSBcImJvcmRlci1ib3hcIixcblx0XHRcdFx0XHRzdHlsZXNcblx0XHRcdFx0KSA6IDBcblx0XHRcdCk7XG5cdFx0fVxuXHR9O1xufSk7XG5cbi8vIFN1cHBvcnQ6IEFuZHJvaWQgMi4zXG5qUXVlcnkuY3NzSG9va3MubWFyZ2luUmlnaHQgPSBhZGRHZXRIb29rSWYoIHN1cHBvcnQucmVsaWFibGVNYXJnaW5SaWdodCxcblx0ZnVuY3Rpb24oIGVsZW0sIGNvbXB1dGVkICkge1xuXHRcdGlmICggY29tcHV0ZWQgKSB7XG5cdFx0XHQvLyBXZWJLaXQgQnVnIDEzMzQzIC0gZ2V0Q29tcHV0ZWRTdHlsZSByZXR1cm5zIHdyb25nIHZhbHVlIGZvciBtYXJnaW4tcmlnaHRcblx0XHRcdC8vIFdvcmsgYXJvdW5kIGJ5IHRlbXBvcmFyaWx5IHNldHRpbmcgZWxlbWVudCBkaXNwbGF5IHRvIGlubGluZS1ibG9ja1xuXHRcdFx0cmV0dXJuIGpRdWVyeS5zd2FwKCBlbGVtLCB7IFwiZGlzcGxheVwiOiBcImlubGluZS1ibG9ja1wiIH0sXG5cdFx0XHRcdGN1ckNTUywgWyBlbGVtLCBcIm1hcmdpblJpZ2h0XCIgXSApO1xuXHRcdH1cblx0fVxuKTtcblxuLy8gVGhlc2UgaG9va3MgYXJlIHVzZWQgYnkgYW5pbWF0ZSB0byBleHBhbmQgcHJvcGVydGllc1xualF1ZXJ5LmVhY2goe1xuXHRtYXJnaW46IFwiXCIsXG5cdHBhZGRpbmc6IFwiXCIsXG5cdGJvcmRlcjogXCJXaWR0aFwiXG59LCBmdW5jdGlvbiggcHJlZml4LCBzdWZmaXggKSB7XG5cdGpRdWVyeS5jc3NIb29rc1sgcHJlZml4ICsgc3VmZml4IF0gPSB7XG5cdFx0ZXhwYW5kOiBmdW5jdGlvbiggdmFsdWUgKSB7XG5cdFx0XHR2YXIgaSA9IDAsXG5cdFx0XHRcdGV4cGFuZGVkID0ge30sXG5cblx0XHRcdFx0Ly8gYXNzdW1lcyBhIHNpbmdsZSBudW1iZXIgaWYgbm90IGEgc3RyaW5nXG5cdFx0XHRcdHBhcnRzID0gdHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiID8gdmFsdWUuc3BsaXQoXCIgXCIpIDogWyB2YWx1ZSBdO1xuXG5cdFx0XHRmb3IgKCA7IGkgPCA0OyBpKysgKSB7XG5cdFx0XHRcdGV4cGFuZGVkWyBwcmVmaXggKyBjc3NFeHBhbmRbIGkgXSArIHN1ZmZpeCBdID1cblx0XHRcdFx0XHRwYXJ0c1sgaSBdIHx8IHBhcnRzWyBpIC0gMiBdIHx8IHBhcnRzWyAwIF07XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBleHBhbmRlZDtcblx0XHR9XG5cdH07XG5cblx0aWYgKCAhcm1hcmdpbi50ZXN0KCBwcmVmaXggKSApIHtcblx0XHRqUXVlcnkuY3NzSG9va3NbIHByZWZpeCArIHN1ZmZpeCBdLnNldCA9IHNldFBvc2l0aXZlTnVtYmVyO1xuXHR9XG59KTtcblxualF1ZXJ5LmZuLmV4dGVuZCh7XG5cdGNzczogZnVuY3Rpb24oIG5hbWUsIHZhbHVlICkge1xuXHRcdHJldHVybiBhY2Nlc3MoIHRoaXMsIGZ1bmN0aW9uKCBlbGVtLCBuYW1lLCB2YWx1ZSApIHtcblx0XHRcdHZhciBzdHlsZXMsIGxlbixcblx0XHRcdFx0bWFwID0ge30sXG5cdFx0XHRcdGkgPSAwO1xuXG5cdFx0XHRpZiAoIGpRdWVyeS5pc0FycmF5KCBuYW1lICkgKSB7XG5cdFx0XHRcdHN0eWxlcyA9IGdldFN0eWxlcyggZWxlbSApO1xuXHRcdFx0XHRsZW4gPSBuYW1lLmxlbmd0aDtcblxuXHRcdFx0XHRmb3IgKCA7IGkgPCBsZW47IGkrKyApIHtcblx0XHRcdFx0XHRtYXBbIG5hbWVbIGkgXSBdID0galF1ZXJ5LmNzcyggZWxlbSwgbmFtZVsgaSBdLCBmYWxzZSwgc3R5bGVzICk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4gbWFwO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gdmFsdWUgIT09IHVuZGVmaW5lZCA/XG5cdFx0XHRcdGpRdWVyeS5zdHlsZSggZWxlbSwgbmFtZSwgdmFsdWUgKSA6XG5cdFx0XHRcdGpRdWVyeS5jc3MoIGVsZW0sIG5hbWUgKTtcblx0XHR9LCBuYW1lLCB2YWx1ZSwgYXJndW1lbnRzLmxlbmd0aCA+IDEgKTtcblx0fSxcblx0c2hvdzogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHNob3dIaWRlKCB0aGlzLCB0cnVlICk7XG5cdH0sXG5cdGhpZGU6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiBzaG93SGlkZSggdGhpcyApO1xuXHR9LFxuXHR0b2dnbGU6IGZ1bmN0aW9uKCBzdGF0ZSApIHtcblx0XHRpZiAoIHR5cGVvZiBzdGF0ZSA9PT0gXCJib29sZWFuXCIgKSB7XG5cdFx0XHRyZXR1cm4gc3RhdGUgPyB0aGlzLnNob3coKSA6IHRoaXMuaGlkZSgpO1xuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAoIGlzSGlkZGVuKCB0aGlzICkgKSB7XG5cdFx0XHRcdGpRdWVyeSggdGhpcyApLnNob3coKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGpRdWVyeSggdGhpcyApLmhpZGUoKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxufSk7XG5cblxuZnVuY3Rpb24gVHdlZW4oIGVsZW0sIG9wdGlvbnMsIHByb3AsIGVuZCwgZWFzaW5nICkge1xuXHRyZXR1cm4gbmV3IFR3ZWVuLnByb3RvdHlwZS5pbml0KCBlbGVtLCBvcHRpb25zLCBwcm9wLCBlbmQsIGVhc2luZyApO1xufVxualF1ZXJ5LlR3ZWVuID0gVHdlZW47XG5cblR3ZWVuLnByb3RvdHlwZSA9IHtcblx0Y29uc3RydWN0b3I6IFR3ZWVuLFxuXHRpbml0OiBmdW5jdGlvbiggZWxlbSwgb3B0aW9ucywgcHJvcCwgZW5kLCBlYXNpbmcsIHVuaXQgKSB7XG5cdFx0dGhpcy5lbGVtID0gZWxlbTtcblx0XHR0aGlzLnByb3AgPSBwcm9wO1xuXHRcdHRoaXMuZWFzaW5nID0gZWFzaW5nIHx8IFwic3dpbmdcIjtcblx0XHR0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuXHRcdHRoaXMuc3RhcnQgPSB0aGlzLm5vdyA9IHRoaXMuY3VyKCk7XG5cdFx0dGhpcy5lbmQgPSBlbmQ7XG5cdFx0dGhpcy51bml0ID0gdW5pdCB8fCAoIGpRdWVyeS5jc3NOdW1iZXJbIHByb3AgXSA/IFwiXCIgOiBcInB4XCIgKTtcblx0fSxcblx0Y3VyOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgaG9va3MgPSBUd2Vlbi5wcm9wSG9va3NbIHRoaXMucHJvcCBdO1xuXG5cdFx0cmV0dXJuIGhvb2tzICYmIGhvb2tzLmdldCA/XG5cdFx0XHRob29rcy5nZXQoIHRoaXMgKSA6XG5cdFx0XHRUd2Vlbi5wcm9wSG9va3MuX2RlZmF1bHQuZ2V0KCB0aGlzICk7XG5cdH0sXG5cdHJ1bjogZnVuY3Rpb24oIHBlcmNlbnQgKSB7XG5cdFx0dmFyIGVhc2VkLFxuXHRcdFx0aG9va3MgPSBUd2Vlbi5wcm9wSG9va3NbIHRoaXMucHJvcCBdO1xuXG5cdFx0aWYgKCB0aGlzLm9wdGlvbnMuZHVyYXRpb24gKSB7XG5cdFx0XHR0aGlzLnBvcyA9IGVhc2VkID0galF1ZXJ5LmVhc2luZ1sgdGhpcy5lYXNpbmcgXShcblx0XHRcdFx0cGVyY2VudCwgdGhpcy5vcHRpb25zLmR1cmF0aW9uICogcGVyY2VudCwgMCwgMSwgdGhpcy5vcHRpb25zLmR1cmF0aW9uXG5cdFx0XHQpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLnBvcyA9IGVhc2VkID0gcGVyY2VudDtcblx0XHR9XG5cdFx0dGhpcy5ub3cgPSAoIHRoaXMuZW5kIC0gdGhpcy5zdGFydCApICogZWFzZWQgKyB0aGlzLnN0YXJ0O1xuXG5cdFx0aWYgKCB0aGlzLm9wdGlvbnMuc3RlcCApIHtcblx0XHRcdHRoaXMub3B0aW9ucy5zdGVwLmNhbGwoIHRoaXMuZWxlbSwgdGhpcy5ub3csIHRoaXMgKTtcblx0XHR9XG5cblx0XHRpZiAoIGhvb2tzICYmIGhvb2tzLnNldCApIHtcblx0XHRcdGhvb2tzLnNldCggdGhpcyApO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRUd2Vlbi5wcm9wSG9va3MuX2RlZmF1bHQuc2V0KCB0aGlzICk7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzO1xuXHR9XG59O1xuXG5Ud2Vlbi5wcm90b3R5cGUuaW5pdC5wcm90b3R5cGUgPSBUd2Vlbi5wcm90b3R5cGU7XG5cblR3ZWVuLnByb3BIb29rcyA9IHtcblx0X2RlZmF1bHQ6IHtcblx0XHRnZXQ6IGZ1bmN0aW9uKCB0d2VlbiApIHtcblx0XHRcdHZhciByZXN1bHQ7XG5cblx0XHRcdGlmICggdHdlZW4uZWxlbVsgdHdlZW4ucHJvcCBdICE9IG51bGwgJiZcblx0XHRcdFx0KCF0d2Vlbi5lbGVtLnN0eWxlIHx8IHR3ZWVuLmVsZW0uc3R5bGVbIHR3ZWVuLnByb3AgXSA9PSBudWxsKSApIHtcblx0XHRcdFx0cmV0dXJuIHR3ZWVuLmVsZW1bIHR3ZWVuLnByb3AgXTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gcGFzc2luZyBhbiBlbXB0eSBzdHJpbmcgYXMgYSAzcmQgcGFyYW1ldGVyIHRvIC5jc3Mgd2lsbCBhdXRvbWF0aWNhbGx5XG5cdFx0XHQvLyBhdHRlbXB0IGEgcGFyc2VGbG9hdCBhbmQgZmFsbGJhY2sgdG8gYSBzdHJpbmcgaWYgdGhlIHBhcnNlIGZhaWxzXG5cdFx0XHQvLyBzbywgc2ltcGxlIHZhbHVlcyBzdWNoIGFzIFwiMTBweFwiIGFyZSBwYXJzZWQgdG8gRmxvYXQuXG5cdFx0XHQvLyBjb21wbGV4IHZhbHVlcyBzdWNoIGFzIFwicm90YXRlKDFyYWQpXCIgYXJlIHJldHVybmVkIGFzIGlzLlxuXHRcdFx0cmVzdWx0ID0galF1ZXJ5LmNzcyggdHdlZW4uZWxlbSwgdHdlZW4ucHJvcCwgXCJcIiApO1xuXHRcdFx0Ly8gRW1wdHkgc3RyaW5ncywgbnVsbCwgdW5kZWZpbmVkIGFuZCBcImF1dG9cIiBhcmUgY29udmVydGVkIHRvIDAuXG5cdFx0XHRyZXR1cm4gIXJlc3VsdCB8fCByZXN1bHQgPT09IFwiYXV0b1wiID8gMCA6IHJlc3VsdDtcblx0XHR9LFxuXHRcdHNldDogZnVuY3Rpb24oIHR3ZWVuICkge1xuXHRcdFx0Ly8gdXNlIHN0ZXAgaG9vayBmb3IgYmFjayBjb21wYXQgLSB1c2UgY3NzSG9vayBpZiBpdHMgdGhlcmUgLSB1c2UgLnN0eWxlIGlmIGl0c1xuXHRcdFx0Ly8gYXZhaWxhYmxlIGFuZCB1c2UgcGxhaW4gcHJvcGVydGllcyB3aGVyZSBhdmFpbGFibGVcblx0XHRcdGlmICggalF1ZXJ5LmZ4LnN0ZXBbIHR3ZWVuLnByb3AgXSApIHtcblx0XHRcdFx0alF1ZXJ5LmZ4LnN0ZXBbIHR3ZWVuLnByb3AgXSggdHdlZW4gKTtcblx0XHRcdH0gZWxzZSBpZiAoIHR3ZWVuLmVsZW0uc3R5bGUgJiYgKCB0d2Vlbi5lbGVtLnN0eWxlWyBqUXVlcnkuY3NzUHJvcHNbIHR3ZWVuLnByb3AgXSBdICE9IG51bGwgfHwgalF1ZXJ5LmNzc0hvb2tzWyB0d2Vlbi5wcm9wIF0gKSApIHtcblx0XHRcdFx0alF1ZXJ5LnN0eWxlKCB0d2Vlbi5lbGVtLCB0d2Vlbi5wcm9wLCB0d2Vlbi5ub3cgKyB0d2Vlbi51bml0ICk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0d2Vlbi5lbGVtWyB0d2Vlbi5wcm9wIF0gPSB0d2Vlbi5ub3c7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG59O1xuXG4vLyBTdXBwb3J0OiBJRTlcbi8vIFBhbmljIGJhc2VkIGFwcHJvYWNoIHRvIHNldHRpbmcgdGhpbmdzIG9uIGRpc2Nvbm5lY3RlZCBub2Rlc1xuXG5Ud2Vlbi5wcm9wSG9va3Muc2Nyb2xsVG9wID0gVHdlZW4ucHJvcEhvb2tzLnNjcm9sbExlZnQgPSB7XG5cdHNldDogZnVuY3Rpb24oIHR3ZWVuICkge1xuXHRcdGlmICggdHdlZW4uZWxlbS5ub2RlVHlwZSAmJiB0d2Vlbi5lbGVtLnBhcmVudE5vZGUgKSB7XG5cdFx0XHR0d2Vlbi5lbGVtWyB0d2Vlbi5wcm9wIF0gPSB0d2Vlbi5ub3c7XG5cdFx0fVxuXHR9XG59O1xuXG5qUXVlcnkuZWFzaW5nID0ge1xuXHRsaW5lYXI6IGZ1bmN0aW9uKCBwICkge1xuXHRcdHJldHVybiBwO1xuXHR9LFxuXHRzd2luZzogZnVuY3Rpb24oIHAgKSB7XG5cdFx0cmV0dXJuIDAuNSAtIE1hdGguY29zKCBwICogTWF0aC5QSSApIC8gMjtcblx0fVxufTtcblxualF1ZXJ5LmZ4ID0gVHdlZW4ucHJvdG90eXBlLmluaXQ7XG5cbi8vIEJhY2sgQ29tcGF0IDwxLjggZXh0ZW5zaW9uIHBvaW50XG5qUXVlcnkuZnguc3RlcCA9IHt9O1xuXG5cblxuXG52YXJcblx0ZnhOb3csIHRpbWVySWQsXG5cdHJmeHR5cGVzID0gL14oPzp0b2dnbGV8c2hvd3xoaWRlKSQvLFxuXHRyZnhudW0gPSBuZXcgUmVnRXhwKCBcIl4oPzooWystXSk9fCkoXCIgKyBwbnVtICsgXCIpKFthLXolXSopJFwiLCBcImlcIiApLFxuXHRycnVuID0gL3F1ZXVlSG9va3MkLyxcblx0YW5pbWF0aW9uUHJlZmlsdGVycyA9IFsgZGVmYXVsdFByZWZpbHRlciBdLFxuXHR0d2VlbmVycyA9IHtcblx0XHRcIipcIjogWyBmdW5jdGlvbiggcHJvcCwgdmFsdWUgKSB7XG5cdFx0XHR2YXIgdHdlZW4gPSB0aGlzLmNyZWF0ZVR3ZWVuKCBwcm9wLCB2YWx1ZSApLFxuXHRcdFx0XHR0YXJnZXQgPSB0d2Vlbi5jdXIoKSxcblx0XHRcdFx0cGFydHMgPSByZnhudW0uZXhlYyggdmFsdWUgKSxcblx0XHRcdFx0dW5pdCA9IHBhcnRzICYmIHBhcnRzWyAzIF0gfHwgKCBqUXVlcnkuY3NzTnVtYmVyWyBwcm9wIF0gPyBcIlwiIDogXCJweFwiICksXG5cblx0XHRcdFx0Ly8gU3RhcnRpbmcgdmFsdWUgY29tcHV0YXRpb24gaXMgcmVxdWlyZWQgZm9yIHBvdGVudGlhbCB1bml0IG1pc21hdGNoZXNcblx0XHRcdFx0c3RhcnQgPSAoIGpRdWVyeS5jc3NOdW1iZXJbIHByb3AgXSB8fCB1bml0ICE9PSBcInB4XCIgJiYgK3RhcmdldCApICYmXG5cdFx0XHRcdFx0cmZ4bnVtLmV4ZWMoIGpRdWVyeS5jc3MoIHR3ZWVuLmVsZW0sIHByb3AgKSApLFxuXHRcdFx0XHRzY2FsZSA9IDEsXG5cdFx0XHRcdG1heEl0ZXJhdGlvbnMgPSAyMDtcblxuXHRcdFx0aWYgKCBzdGFydCAmJiBzdGFydFsgMyBdICE9PSB1bml0ICkge1xuXHRcdFx0XHQvLyBUcnVzdCB1bml0cyByZXBvcnRlZCBieSBqUXVlcnkuY3NzXG5cdFx0XHRcdHVuaXQgPSB1bml0IHx8IHN0YXJ0WyAzIF07XG5cblx0XHRcdFx0Ly8gTWFrZSBzdXJlIHdlIHVwZGF0ZSB0aGUgdHdlZW4gcHJvcGVydGllcyBsYXRlciBvblxuXHRcdFx0XHRwYXJ0cyA9IHBhcnRzIHx8IFtdO1xuXG5cdFx0XHRcdC8vIEl0ZXJhdGl2ZWx5IGFwcHJveGltYXRlIGZyb20gYSBub256ZXJvIHN0YXJ0aW5nIHBvaW50XG5cdFx0XHRcdHN0YXJ0ID0gK3RhcmdldCB8fCAxO1xuXG5cdFx0XHRcdGRvIHtcblx0XHRcdFx0XHQvLyBJZiBwcmV2aW91cyBpdGVyYXRpb24gemVyb2VkIG91dCwgZG91YmxlIHVudGlsIHdlIGdldCAqc29tZXRoaW5nKlxuXHRcdFx0XHRcdC8vIFVzZSBhIHN0cmluZyBmb3IgZG91YmxpbmcgZmFjdG9yIHNvIHdlIGRvbid0IGFjY2lkZW50YWxseSBzZWUgc2NhbGUgYXMgdW5jaGFuZ2VkIGJlbG93XG5cdFx0XHRcdFx0c2NhbGUgPSBzY2FsZSB8fCBcIi41XCI7XG5cblx0XHRcdFx0XHQvLyBBZGp1c3QgYW5kIGFwcGx5XG5cdFx0XHRcdFx0c3RhcnQgPSBzdGFydCAvIHNjYWxlO1xuXHRcdFx0XHRcdGpRdWVyeS5zdHlsZSggdHdlZW4uZWxlbSwgcHJvcCwgc3RhcnQgKyB1bml0ICk7XG5cblx0XHRcdFx0Ly8gVXBkYXRlIHNjYWxlLCB0b2xlcmF0aW5nIHplcm8gb3IgTmFOIGZyb20gdHdlZW4uY3VyKClcblx0XHRcdFx0Ly8gQW5kIGJyZWFraW5nIHRoZSBsb29wIGlmIHNjYWxlIGlzIHVuY2hhbmdlZCBvciBwZXJmZWN0LCBvciBpZiB3ZSd2ZSBqdXN0IGhhZCBlbm91Z2hcblx0XHRcdFx0fSB3aGlsZSAoIHNjYWxlICE9PSAoc2NhbGUgPSB0d2Vlbi5jdXIoKSAvIHRhcmdldCkgJiYgc2NhbGUgIT09IDEgJiYgLS1tYXhJdGVyYXRpb25zICk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFVwZGF0ZSB0d2VlbiBwcm9wZXJ0aWVzXG5cdFx0XHRpZiAoIHBhcnRzICkge1xuXHRcdFx0XHRzdGFydCA9IHR3ZWVuLnN0YXJ0ID0gK3N0YXJ0IHx8ICt0YXJnZXQgfHwgMDtcblx0XHRcdFx0dHdlZW4udW5pdCA9IHVuaXQ7XG5cdFx0XHRcdC8vIElmIGEgKz0vLT0gdG9rZW4gd2FzIHByb3ZpZGVkLCB3ZSdyZSBkb2luZyBhIHJlbGF0aXZlIGFuaW1hdGlvblxuXHRcdFx0XHR0d2Vlbi5lbmQgPSBwYXJ0c1sgMSBdID9cblx0XHRcdFx0XHRzdGFydCArICggcGFydHNbIDEgXSArIDEgKSAqIHBhcnRzWyAyIF0gOlxuXHRcdFx0XHRcdCtwYXJ0c1sgMiBdO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gdHdlZW47XG5cdFx0fSBdXG5cdH07XG5cbi8vIEFuaW1hdGlvbnMgY3JlYXRlZCBzeW5jaHJvbm91c2x5IHdpbGwgcnVuIHN5bmNocm9ub3VzbHlcbmZ1bmN0aW9uIGNyZWF0ZUZ4Tm93KCkge1xuXHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdGZ4Tm93ID0gdW5kZWZpbmVkO1xuXHR9KTtcblx0cmV0dXJuICggZnhOb3cgPSBqUXVlcnkubm93KCkgKTtcbn1cblxuLy8gR2VuZXJhdGUgcGFyYW1ldGVycyB0byBjcmVhdGUgYSBzdGFuZGFyZCBhbmltYXRpb25cbmZ1bmN0aW9uIGdlbkZ4KCB0eXBlLCBpbmNsdWRlV2lkdGggKSB7XG5cdHZhciB3aGljaCxcblx0XHRpID0gMCxcblx0XHRhdHRycyA9IHsgaGVpZ2h0OiB0eXBlIH07XG5cblx0Ly8gaWYgd2UgaW5jbHVkZSB3aWR0aCwgc3RlcCB2YWx1ZSBpcyAxIHRvIGRvIGFsbCBjc3NFeHBhbmQgdmFsdWVzLFxuXHQvLyBpZiB3ZSBkb24ndCBpbmNsdWRlIHdpZHRoLCBzdGVwIHZhbHVlIGlzIDIgdG8gc2tpcCBvdmVyIExlZnQgYW5kIFJpZ2h0XG5cdGluY2x1ZGVXaWR0aCA9IGluY2x1ZGVXaWR0aCA/IDEgOiAwO1xuXHRmb3IgKCA7IGkgPCA0IDsgaSArPSAyIC0gaW5jbHVkZVdpZHRoICkge1xuXHRcdHdoaWNoID0gY3NzRXhwYW5kWyBpIF07XG5cdFx0YXR0cnNbIFwibWFyZ2luXCIgKyB3aGljaCBdID0gYXR0cnNbIFwicGFkZGluZ1wiICsgd2hpY2ggXSA9IHR5cGU7XG5cdH1cblxuXHRpZiAoIGluY2x1ZGVXaWR0aCApIHtcblx0XHRhdHRycy5vcGFjaXR5ID0gYXR0cnMud2lkdGggPSB0eXBlO1xuXHR9XG5cblx0cmV0dXJuIGF0dHJzO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVUd2VlbiggdmFsdWUsIHByb3AsIGFuaW1hdGlvbiApIHtcblx0dmFyIHR3ZWVuLFxuXHRcdGNvbGxlY3Rpb24gPSAoIHR3ZWVuZXJzWyBwcm9wIF0gfHwgW10gKS5jb25jYXQoIHR3ZWVuZXJzWyBcIipcIiBdICksXG5cdFx0aW5kZXggPSAwLFxuXHRcdGxlbmd0aCA9IGNvbGxlY3Rpb24ubGVuZ3RoO1xuXHRmb3IgKCA7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrICkge1xuXHRcdGlmICggKHR3ZWVuID0gY29sbGVjdGlvblsgaW5kZXggXS5jYWxsKCBhbmltYXRpb24sIHByb3AsIHZhbHVlICkpICkge1xuXG5cdFx0XHQvLyB3ZSdyZSBkb25lIHdpdGggdGhpcyBwcm9wZXJ0eVxuXHRcdFx0cmV0dXJuIHR3ZWVuO1xuXHRcdH1cblx0fVxufVxuXG5mdW5jdGlvbiBkZWZhdWx0UHJlZmlsdGVyKCBlbGVtLCBwcm9wcywgb3B0cyApIHtcblx0LyoganNoaW50IHZhbGlkdGhpczogdHJ1ZSAqL1xuXHR2YXIgcHJvcCwgdmFsdWUsIHRvZ2dsZSwgdHdlZW4sIGhvb2tzLCBvbGRmaXJlLCBkaXNwbGF5LCBjaGVja0Rpc3BsYXksXG5cdFx0YW5pbSA9IHRoaXMsXG5cdFx0b3JpZyA9IHt9LFxuXHRcdHN0eWxlID0gZWxlbS5zdHlsZSxcblx0XHRoaWRkZW4gPSBlbGVtLm5vZGVUeXBlICYmIGlzSGlkZGVuKCBlbGVtICksXG5cdFx0ZGF0YVNob3cgPSBkYXRhX3ByaXYuZ2V0KCBlbGVtLCBcImZ4c2hvd1wiICk7XG5cblx0Ly8gaGFuZGxlIHF1ZXVlOiBmYWxzZSBwcm9taXNlc1xuXHRpZiAoICFvcHRzLnF1ZXVlICkge1xuXHRcdGhvb2tzID0galF1ZXJ5Ll9xdWV1ZUhvb2tzKCBlbGVtLCBcImZ4XCIgKTtcblx0XHRpZiAoIGhvb2tzLnVucXVldWVkID09IG51bGwgKSB7XG5cdFx0XHRob29rcy51bnF1ZXVlZCA9IDA7XG5cdFx0XHRvbGRmaXJlID0gaG9va3MuZW1wdHkuZmlyZTtcblx0XHRcdGhvb2tzLmVtcHR5LmZpcmUgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKCAhaG9va3MudW5xdWV1ZWQgKSB7XG5cdFx0XHRcdFx0b2xkZmlyZSgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXHRcdH1cblx0XHRob29rcy51bnF1ZXVlZCsrO1xuXG5cdFx0YW5pbS5hbHdheXMoZnVuY3Rpb24oKSB7XG5cdFx0XHQvLyBkb2luZyB0aGlzIG1ha2VzIHN1cmUgdGhhdCB0aGUgY29tcGxldGUgaGFuZGxlciB3aWxsIGJlIGNhbGxlZFxuXHRcdFx0Ly8gYmVmb3JlIHRoaXMgY29tcGxldGVzXG5cdFx0XHRhbmltLmFsd2F5cyhmdW5jdGlvbigpIHtcblx0XHRcdFx0aG9va3MudW5xdWV1ZWQtLTtcblx0XHRcdFx0aWYgKCAhalF1ZXJ5LnF1ZXVlKCBlbGVtLCBcImZ4XCIgKS5sZW5ndGggKSB7XG5cdFx0XHRcdFx0aG9va3MuZW1wdHkuZmlyZSgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9KTtcblx0fVxuXG5cdC8vIGhlaWdodC93aWR0aCBvdmVyZmxvdyBwYXNzXG5cdGlmICggZWxlbS5ub2RlVHlwZSA9PT0gMSAmJiAoIFwiaGVpZ2h0XCIgaW4gcHJvcHMgfHwgXCJ3aWR0aFwiIGluIHByb3BzICkgKSB7XG5cdFx0Ly8gTWFrZSBzdXJlIHRoYXQgbm90aGluZyBzbmVha3Mgb3V0XG5cdFx0Ly8gUmVjb3JkIGFsbCAzIG92ZXJmbG93IGF0dHJpYnV0ZXMgYmVjYXVzZSBJRTktMTAgZG8gbm90XG5cdFx0Ly8gY2hhbmdlIHRoZSBvdmVyZmxvdyBhdHRyaWJ1dGUgd2hlbiBvdmVyZmxvd1ggYW5kXG5cdFx0Ly8gb3ZlcmZsb3dZIGFyZSBzZXQgdG8gdGhlIHNhbWUgdmFsdWVcblx0XHRvcHRzLm92ZXJmbG93ID0gWyBzdHlsZS5vdmVyZmxvdywgc3R5bGUub3ZlcmZsb3dYLCBzdHlsZS5vdmVyZmxvd1kgXTtcblxuXHRcdC8vIFNldCBkaXNwbGF5IHByb3BlcnR5IHRvIGlubGluZS1ibG9jayBmb3IgaGVpZ2h0L3dpZHRoXG5cdFx0Ly8gYW5pbWF0aW9ucyBvbiBpbmxpbmUgZWxlbWVudHMgdGhhdCBhcmUgaGF2aW5nIHdpZHRoL2hlaWdodCBhbmltYXRlZFxuXHRcdGRpc3BsYXkgPSBqUXVlcnkuY3NzKCBlbGVtLCBcImRpc3BsYXlcIiApO1xuXG5cdFx0Ly8gVGVzdCBkZWZhdWx0IGRpc3BsYXkgaWYgZGlzcGxheSBpcyBjdXJyZW50bHkgXCJub25lXCJcblx0XHRjaGVja0Rpc3BsYXkgPSBkaXNwbGF5ID09PSBcIm5vbmVcIiA/XG5cdFx0XHRkYXRhX3ByaXYuZ2V0KCBlbGVtLCBcIm9sZGRpc3BsYXlcIiApIHx8IGRlZmF1bHREaXNwbGF5KCBlbGVtLm5vZGVOYW1lICkgOiBkaXNwbGF5O1xuXG5cdFx0aWYgKCBjaGVja0Rpc3BsYXkgPT09IFwiaW5saW5lXCIgJiYgalF1ZXJ5LmNzcyggZWxlbSwgXCJmbG9hdFwiICkgPT09IFwibm9uZVwiICkge1xuXHRcdFx0c3R5bGUuZGlzcGxheSA9IFwiaW5saW5lLWJsb2NrXCI7XG5cdFx0fVxuXHR9XG5cblx0aWYgKCBvcHRzLm92ZXJmbG93ICkge1xuXHRcdHN0eWxlLm92ZXJmbG93ID0gXCJoaWRkZW5cIjtcblx0XHRhbmltLmFsd2F5cyhmdW5jdGlvbigpIHtcblx0XHRcdHN0eWxlLm92ZXJmbG93ID0gb3B0cy5vdmVyZmxvd1sgMCBdO1xuXHRcdFx0c3R5bGUub3ZlcmZsb3dYID0gb3B0cy5vdmVyZmxvd1sgMSBdO1xuXHRcdFx0c3R5bGUub3ZlcmZsb3dZID0gb3B0cy5vdmVyZmxvd1sgMiBdO1xuXHRcdH0pO1xuXHR9XG5cblx0Ly8gc2hvdy9oaWRlIHBhc3Ncblx0Zm9yICggcHJvcCBpbiBwcm9wcyApIHtcblx0XHR2YWx1ZSA9IHByb3BzWyBwcm9wIF07XG5cdFx0aWYgKCByZnh0eXBlcy5leGVjKCB2YWx1ZSApICkge1xuXHRcdFx0ZGVsZXRlIHByb3BzWyBwcm9wIF07XG5cdFx0XHR0b2dnbGUgPSB0b2dnbGUgfHwgdmFsdWUgPT09IFwidG9nZ2xlXCI7XG5cdFx0XHRpZiAoIHZhbHVlID09PSAoIGhpZGRlbiA/IFwiaGlkZVwiIDogXCJzaG93XCIgKSApIHtcblxuXHRcdFx0XHQvLyBJZiB0aGVyZSBpcyBkYXRhU2hvdyBsZWZ0IG92ZXIgZnJvbSBhIHN0b3BwZWQgaGlkZSBvciBzaG93IGFuZCB3ZSBhcmUgZ29pbmcgdG8gcHJvY2VlZCB3aXRoIHNob3csIHdlIHNob3VsZCBwcmV0ZW5kIHRvIGJlIGhpZGRlblxuXHRcdFx0XHRpZiAoIHZhbHVlID09PSBcInNob3dcIiAmJiBkYXRhU2hvdyAmJiBkYXRhU2hvd1sgcHJvcCBdICE9PSB1bmRlZmluZWQgKSB7XG5cdFx0XHRcdFx0aGlkZGVuID0gdHJ1ZTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRjb250aW51ZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0b3JpZ1sgcHJvcCBdID0gZGF0YVNob3cgJiYgZGF0YVNob3dbIHByb3AgXSB8fCBqUXVlcnkuc3R5bGUoIGVsZW0sIHByb3AgKTtcblxuXHRcdC8vIEFueSBub24tZnggdmFsdWUgc3RvcHMgdXMgZnJvbSByZXN0b3JpbmcgdGhlIG9yaWdpbmFsIGRpc3BsYXkgdmFsdWVcblx0XHR9IGVsc2Uge1xuXHRcdFx0ZGlzcGxheSA9IHVuZGVmaW5lZDtcblx0XHR9XG5cdH1cblxuXHRpZiAoICFqUXVlcnkuaXNFbXB0eU9iamVjdCggb3JpZyApICkge1xuXHRcdGlmICggZGF0YVNob3cgKSB7XG5cdFx0XHRpZiAoIFwiaGlkZGVuXCIgaW4gZGF0YVNob3cgKSB7XG5cdFx0XHRcdGhpZGRlbiA9IGRhdGFTaG93LmhpZGRlbjtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0ZGF0YVNob3cgPSBkYXRhX3ByaXYuYWNjZXNzKCBlbGVtLCBcImZ4c2hvd1wiLCB7fSApO1xuXHRcdH1cblxuXHRcdC8vIHN0b3JlIHN0YXRlIGlmIGl0cyB0b2dnbGUgLSBlbmFibGVzIC5zdG9wKCkudG9nZ2xlKCkgdG8gXCJyZXZlcnNlXCJcblx0XHRpZiAoIHRvZ2dsZSApIHtcblx0XHRcdGRhdGFTaG93LmhpZGRlbiA9ICFoaWRkZW47XG5cdFx0fVxuXHRcdGlmICggaGlkZGVuICkge1xuXHRcdFx0alF1ZXJ5KCBlbGVtICkuc2hvdygpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRhbmltLmRvbmUoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGpRdWVyeSggZWxlbSApLmhpZGUoKTtcblx0XHRcdH0pO1xuXHRcdH1cblx0XHRhbmltLmRvbmUoZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgcHJvcDtcblxuXHRcdFx0ZGF0YV9wcml2LnJlbW92ZSggZWxlbSwgXCJmeHNob3dcIiApO1xuXHRcdFx0Zm9yICggcHJvcCBpbiBvcmlnICkge1xuXHRcdFx0XHRqUXVlcnkuc3R5bGUoIGVsZW0sIHByb3AsIG9yaWdbIHByb3AgXSApO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdGZvciAoIHByb3AgaW4gb3JpZyApIHtcblx0XHRcdHR3ZWVuID0gY3JlYXRlVHdlZW4oIGhpZGRlbiA/IGRhdGFTaG93WyBwcm9wIF0gOiAwLCBwcm9wLCBhbmltICk7XG5cblx0XHRcdGlmICggISggcHJvcCBpbiBkYXRhU2hvdyApICkge1xuXHRcdFx0XHRkYXRhU2hvd1sgcHJvcCBdID0gdHdlZW4uc3RhcnQ7XG5cdFx0XHRcdGlmICggaGlkZGVuICkge1xuXHRcdFx0XHRcdHR3ZWVuLmVuZCA9IHR3ZWVuLnN0YXJ0O1xuXHRcdFx0XHRcdHR3ZWVuLnN0YXJ0ID0gcHJvcCA9PT0gXCJ3aWR0aFwiIHx8IHByb3AgPT09IFwiaGVpZ2h0XCIgPyAxIDogMDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHQvLyBJZiB0aGlzIGlzIGEgbm9vcCBsaWtlIC5oaWRlKCkuaGlkZSgpLCByZXN0b3JlIGFuIG92ZXJ3cml0dGVuIGRpc3BsYXkgdmFsdWVcblx0fSBlbHNlIGlmICggKGRpc3BsYXkgPT09IFwibm9uZVwiID8gZGVmYXVsdERpc3BsYXkoIGVsZW0ubm9kZU5hbWUgKSA6IGRpc3BsYXkpID09PSBcImlubGluZVwiICkge1xuXHRcdHN0eWxlLmRpc3BsYXkgPSBkaXNwbGF5O1xuXHR9XG59XG5cbmZ1bmN0aW9uIHByb3BGaWx0ZXIoIHByb3BzLCBzcGVjaWFsRWFzaW5nICkge1xuXHR2YXIgaW5kZXgsIG5hbWUsIGVhc2luZywgdmFsdWUsIGhvb2tzO1xuXG5cdC8vIGNhbWVsQ2FzZSwgc3BlY2lhbEVhc2luZyBhbmQgZXhwYW5kIGNzc0hvb2sgcGFzc1xuXHRmb3IgKCBpbmRleCBpbiBwcm9wcyApIHtcblx0XHRuYW1lID0galF1ZXJ5LmNhbWVsQ2FzZSggaW5kZXggKTtcblx0XHRlYXNpbmcgPSBzcGVjaWFsRWFzaW5nWyBuYW1lIF07XG5cdFx0dmFsdWUgPSBwcm9wc1sgaW5kZXggXTtcblx0XHRpZiAoIGpRdWVyeS5pc0FycmF5KCB2YWx1ZSApICkge1xuXHRcdFx0ZWFzaW5nID0gdmFsdWVbIDEgXTtcblx0XHRcdHZhbHVlID0gcHJvcHNbIGluZGV4IF0gPSB2YWx1ZVsgMCBdO1xuXHRcdH1cblxuXHRcdGlmICggaW5kZXggIT09IG5hbWUgKSB7XG5cdFx0XHRwcm9wc1sgbmFtZSBdID0gdmFsdWU7XG5cdFx0XHRkZWxldGUgcHJvcHNbIGluZGV4IF07XG5cdFx0fVxuXG5cdFx0aG9va3MgPSBqUXVlcnkuY3NzSG9va3NbIG5hbWUgXTtcblx0XHRpZiAoIGhvb2tzICYmIFwiZXhwYW5kXCIgaW4gaG9va3MgKSB7XG5cdFx0XHR2YWx1ZSA9IGhvb2tzLmV4cGFuZCggdmFsdWUgKTtcblx0XHRcdGRlbGV0ZSBwcm9wc1sgbmFtZSBdO1xuXG5cdFx0XHQvLyBub3QgcXVpdGUgJC5leHRlbmQsIHRoaXMgd29udCBvdmVyd3JpdGUga2V5cyBhbHJlYWR5IHByZXNlbnQuXG5cdFx0XHQvLyBhbHNvIC0gcmV1c2luZyAnaW5kZXgnIGZyb20gYWJvdmUgYmVjYXVzZSB3ZSBoYXZlIHRoZSBjb3JyZWN0IFwibmFtZVwiXG5cdFx0XHRmb3IgKCBpbmRleCBpbiB2YWx1ZSApIHtcblx0XHRcdFx0aWYgKCAhKCBpbmRleCBpbiBwcm9wcyApICkge1xuXHRcdFx0XHRcdHByb3BzWyBpbmRleCBdID0gdmFsdWVbIGluZGV4IF07XG5cdFx0XHRcdFx0c3BlY2lhbEVhc2luZ1sgaW5kZXggXSA9IGVhc2luZztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRzcGVjaWFsRWFzaW5nWyBuYW1lIF0gPSBlYXNpbmc7XG5cdFx0fVxuXHR9XG59XG5cbmZ1bmN0aW9uIEFuaW1hdGlvbiggZWxlbSwgcHJvcGVydGllcywgb3B0aW9ucyApIHtcblx0dmFyIHJlc3VsdCxcblx0XHRzdG9wcGVkLFxuXHRcdGluZGV4ID0gMCxcblx0XHRsZW5ndGggPSBhbmltYXRpb25QcmVmaWx0ZXJzLmxlbmd0aCxcblx0XHRkZWZlcnJlZCA9IGpRdWVyeS5EZWZlcnJlZCgpLmFsd2F5cyggZnVuY3Rpb24oKSB7XG5cdFx0XHQvLyBkb24ndCBtYXRjaCBlbGVtIGluIHRoZSA6YW5pbWF0ZWQgc2VsZWN0b3Jcblx0XHRcdGRlbGV0ZSB0aWNrLmVsZW07XG5cdFx0fSksXG5cdFx0dGljayA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKCBzdG9wcGVkICkge1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0XHR2YXIgY3VycmVudFRpbWUgPSBmeE5vdyB8fCBjcmVhdGVGeE5vdygpLFxuXHRcdFx0XHRyZW1haW5pbmcgPSBNYXRoLm1heCggMCwgYW5pbWF0aW9uLnN0YXJ0VGltZSArIGFuaW1hdGlvbi5kdXJhdGlvbiAtIGN1cnJlbnRUaW1lICksXG5cdFx0XHRcdC8vIGFyY2hhaWMgY3Jhc2ggYnVnIHdvbid0IGFsbG93IHVzIHRvIHVzZSAxIC0gKCAwLjUgfHwgMCApICgjMTI0OTcpXG5cdFx0XHRcdHRlbXAgPSByZW1haW5pbmcgLyBhbmltYXRpb24uZHVyYXRpb24gfHwgMCxcblx0XHRcdFx0cGVyY2VudCA9IDEgLSB0ZW1wLFxuXHRcdFx0XHRpbmRleCA9IDAsXG5cdFx0XHRcdGxlbmd0aCA9IGFuaW1hdGlvbi50d2VlbnMubGVuZ3RoO1xuXG5cdFx0XHRmb3IgKCA7IGluZGV4IDwgbGVuZ3RoIDsgaW5kZXgrKyApIHtcblx0XHRcdFx0YW5pbWF0aW9uLnR3ZWVuc1sgaW5kZXggXS5ydW4oIHBlcmNlbnQgKTtcblx0XHRcdH1cblxuXHRcdFx0ZGVmZXJyZWQubm90aWZ5V2l0aCggZWxlbSwgWyBhbmltYXRpb24sIHBlcmNlbnQsIHJlbWFpbmluZyBdKTtcblxuXHRcdFx0aWYgKCBwZXJjZW50IDwgMSAmJiBsZW5ndGggKSB7XG5cdFx0XHRcdHJldHVybiByZW1haW5pbmc7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRkZWZlcnJlZC5yZXNvbHZlV2l0aCggZWxlbSwgWyBhbmltYXRpb24gXSApO1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRhbmltYXRpb24gPSBkZWZlcnJlZC5wcm9taXNlKHtcblx0XHRcdGVsZW06IGVsZW0sXG5cdFx0XHRwcm9wczogalF1ZXJ5LmV4dGVuZCgge30sIHByb3BlcnRpZXMgKSxcblx0XHRcdG9wdHM6IGpRdWVyeS5leHRlbmQoIHRydWUsIHsgc3BlY2lhbEVhc2luZzoge30gfSwgb3B0aW9ucyApLFxuXHRcdFx0b3JpZ2luYWxQcm9wZXJ0aWVzOiBwcm9wZXJ0aWVzLFxuXHRcdFx0b3JpZ2luYWxPcHRpb25zOiBvcHRpb25zLFxuXHRcdFx0c3RhcnRUaW1lOiBmeE5vdyB8fCBjcmVhdGVGeE5vdygpLFxuXHRcdFx0ZHVyYXRpb246IG9wdGlvbnMuZHVyYXRpb24sXG5cdFx0XHR0d2VlbnM6IFtdLFxuXHRcdFx0Y3JlYXRlVHdlZW46IGZ1bmN0aW9uKCBwcm9wLCBlbmQgKSB7XG5cdFx0XHRcdHZhciB0d2VlbiA9IGpRdWVyeS5Ud2VlbiggZWxlbSwgYW5pbWF0aW9uLm9wdHMsIHByb3AsIGVuZCxcblx0XHRcdFx0XHRcdGFuaW1hdGlvbi5vcHRzLnNwZWNpYWxFYXNpbmdbIHByb3AgXSB8fCBhbmltYXRpb24ub3B0cy5lYXNpbmcgKTtcblx0XHRcdFx0YW5pbWF0aW9uLnR3ZWVucy5wdXNoKCB0d2VlbiApO1xuXHRcdFx0XHRyZXR1cm4gdHdlZW47XG5cdFx0XHR9LFxuXHRcdFx0c3RvcDogZnVuY3Rpb24oIGdvdG9FbmQgKSB7XG5cdFx0XHRcdHZhciBpbmRleCA9IDAsXG5cdFx0XHRcdFx0Ly8gaWYgd2UgYXJlIGdvaW5nIHRvIHRoZSBlbmQsIHdlIHdhbnQgdG8gcnVuIGFsbCB0aGUgdHdlZW5zXG5cdFx0XHRcdFx0Ly8gb3RoZXJ3aXNlIHdlIHNraXAgdGhpcyBwYXJ0XG5cdFx0XHRcdFx0bGVuZ3RoID0gZ290b0VuZCA/IGFuaW1hdGlvbi50d2VlbnMubGVuZ3RoIDogMDtcblx0XHRcdFx0aWYgKCBzdG9wcGVkICkge1xuXHRcdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHN0b3BwZWQgPSB0cnVlO1xuXHRcdFx0XHRmb3IgKCA7IGluZGV4IDwgbGVuZ3RoIDsgaW5kZXgrKyApIHtcblx0XHRcdFx0XHRhbmltYXRpb24udHdlZW5zWyBpbmRleCBdLnJ1biggMSApO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gcmVzb2x2ZSB3aGVuIHdlIHBsYXllZCB0aGUgbGFzdCBmcmFtZVxuXHRcdFx0XHQvLyBvdGhlcndpc2UsIHJlamVjdFxuXHRcdFx0XHRpZiAoIGdvdG9FbmQgKSB7XG5cdFx0XHRcdFx0ZGVmZXJyZWQucmVzb2x2ZVdpdGgoIGVsZW0sIFsgYW5pbWF0aW9uLCBnb3RvRW5kIF0gKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRkZWZlcnJlZC5yZWplY3RXaXRoKCBlbGVtLCBbIGFuaW1hdGlvbiwgZ290b0VuZCBdICk7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHR9XG5cdFx0fSksXG5cdFx0cHJvcHMgPSBhbmltYXRpb24ucHJvcHM7XG5cblx0cHJvcEZpbHRlciggcHJvcHMsIGFuaW1hdGlvbi5vcHRzLnNwZWNpYWxFYXNpbmcgKTtcblxuXHRmb3IgKCA7IGluZGV4IDwgbGVuZ3RoIDsgaW5kZXgrKyApIHtcblx0XHRyZXN1bHQgPSBhbmltYXRpb25QcmVmaWx0ZXJzWyBpbmRleCBdLmNhbGwoIGFuaW1hdGlvbiwgZWxlbSwgcHJvcHMsIGFuaW1hdGlvbi5vcHRzICk7XG5cdFx0aWYgKCByZXN1bHQgKSB7XG5cdFx0XHRyZXR1cm4gcmVzdWx0O1xuXHRcdH1cblx0fVxuXG5cdGpRdWVyeS5tYXAoIHByb3BzLCBjcmVhdGVUd2VlbiwgYW5pbWF0aW9uICk7XG5cblx0aWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggYW5pbWF0aW9uLm9wdHMuc3RhcnQgKSApIHtcblx0XHRhbmltYXRpb24ub3B0cy5zdGFydC5jYWxsKCBlbGVtLCBhbmltYXRpb24gKTtcblx0fVxuXG5cdGpRdWVyeS5meC50aW1lcihcblx0XHRqUXVlcnkuZXh0ZW5kKCB0aWNrLCB7XG5cdFx0XHRlbGVtOiBlbGVtLFxuXHRcdFx0YW5pbTogYW5pbWF0aW9uLFxuXHRcdFx0cXVldWU6IGFuaW1hdGlvbi5vcHRzLnF1ZXVlXG5cdFx0fSlcblx0KTtcblxuXHQvLyBhdHRhY2ggY2FsbGJhY2tzIGZyb20gb3B0aW9uc1xuXHRyZXR1cm4gYW5pbWF0aW9uLnByb2dyZXNzKCBhbmltYXRpb24ub3B0cy5wcm9ncmVzcyApXG5cdFx0LmRvbmUoIGFuaW1hdGlvbi5vcHRzLmRvbmUsIGFuaW1hdGlvbi5vcHRzLmNvbXBsZXRlIClcblx0XHQuZmFpbCggYW5pbWF0aW9uLm9wdHMuZmFpbCApXG5cdFx0LmFsd2F5cyggYW5pbWF0aW9uLm9wdHMuYWx3YXlzICk7XG59XG5cbmpRdWVyeS5BbmltYXRpb24gPSBqUXVlcnkuZXh0ZW5kKCBBbmltYXRpb24sIHtcblxuXHR0d2VlbmVyOiBmdW5jdGlvbiggcHJvcHMsIGNhbGxiYWNrICkge1xuXHRcdGlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIHByb3BzICkgKSB7XG5cdFx0XHRjYWxsYmFjayA9IHByb3BzO1xuXHRcdFx0cHJvcHMgPSBbIFwiKlwiIF07XG5cdFx0fSBlbHNlIHtcblx0XHRcdHByb3BzID0gcHJvcHMuc3BsaXQoXCIgXCIpO1xuXHRcdH1cblxuXHRcdHZhciBwcm9wLFxuXHRcdFx0aW5kZXggPSAwLFxuXHRcdFx0bGVuZ3RoID0gcHJvcHMubGVuZ3RoO1xuXG5cdFx0Zm9yICggOyBpbmRleCA8IGxlbmd0aCA7IGluZGV4KysgKSB7XG5cdFx0XHRwcm9wID0gcHJvcHNbIGluZGV4IF07XG5cdFx0XHR0d2VlbmVyc1sgcHJvcCBdID0gdHdlZW5lcnNbIHByb3AgXSB8fCBbXTtcblx0XHRcdHR3ZWVuZXJzWyBwcm9wIF0udW5zaGlmdCggY2FsbGJhY2sgKTtcblx0XHR9XG5cdH0sXG5cblx0cHJlZmlsdGVyOiBmdW5jdGlvbiggY2FsbGJhY2ssIHByZXBlbmQgKSB7XG5cdFx0aWYgKCBwcmVwZW5kICkge1xuXHRcdFx0YW5pbWF0aW9uUHJlZmlsdGVycy51bnNoaWZ0KCBjYWxsYmFjayApO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRhbmltYXRpb25QcmVmaWx0ZXJzLnB1c2goIGNhbGxiYWNrICk7XG5cdFx0fVxuXHR9XG59KTtcblxualF1ZXJ5LnNwZWVkID0gZnVuY3Rpb24oIHNwZWVkLCBlYXNpbmcsIGZuICkge1xuXHR2YXIgb3B0ID0gc3BlZWQgJiYgdHlwZW9mIHNwZWVkID09PSBcIm9iamVjdFwiID8galF1ZXJ5LmV4dGVuZCgge30sIHNwZWVkICkgOiB7XG5cdFx0Y29tcGxldGU6IGZuIHx8ICFmbiAmJiBlYXNpbmcgfHxcblx0XHRcdGpRdWVyeS5pc0Z1bmN0aW9uKCBzcGVlZCApICYmIHNwZWVkLFxuXHRcdGR1cmF0aW9uOiBzcGVlZCxcblx0XHRlYXNpbmc6IGZuICYmIGVhc2luZyB8fCBlYXNpbmcgJiYgIWpRdWVyeS5pc0Z1bmN0aW9uKCBlYXNpbmcgKSAmJiBlYXNpbmdcblx0fTtcblxuXHRvcHQuZHVyYXRpb24gPSBqUXVlcnkuZngub2ZmID8gMCA6IHR5cGVvZiBvcHQuZHVyYXRpb24gPT09IFwibnVtYmVyXCIgPyBvcHQuZHVyYXRpb24gOlxuXHRcdG9wdC5kdXJhdGlvbiBpbiBqUXVlcnkuZnguc3BlZWRzID8galF1ZXJ5LmZ4LnNwZWVkc1sgb3B0LmR1cmF0aW9uIF0gOiBqUXVlcnkuZnguc3BlZWRzLl9kZWZhdWx0O1xuXG5cdC8vIG5vcm1hbGl6ZSBvcHQucXVldWUgLSB0cnVlL3VuZGVmaW5lZC9udWxsIC0+IFwiZnhcIlxuXHRpZiAoIG9wdC5xdWV1ZSA9PSBudWxsIHx8IG9wdC5xdWV1ZSA9PT0gdHJ1ZSApIHtcblx0XHRvcHQucXVldWUgPSBcImZ4XCI7XG5cdH1cblxuXHQvLyBRdWV1ZWluZ1xuXHRvcHQub2xkID0gb3B0LmNvbXBsZXRlO1xuXG5cdG9wdC5jb21wbGV0ZSA9IGZ1bmN0aW9uKCkge1xuXHRcdGlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIG9wdC5vbGQgKSApIHtcblx0XHRcdG9wdC5vbGQuY2FsbCggdGhpcyApO1xuXHRcdH1cblxuXHRcdGlmICggb3B0LnF1ZXVlICkge1xuXHRcdFx0alF1ZXJ5LmRlcXVldWUoIHRoaXMsIG9wdC5xdWV1ZSApO1xuXHRcdH1cblx0fTtcblxuXHRyZXR1cm4gb3B0O1xufTtcblxualF1ZXJ5LmZuLmV4dGVuZCh7XG5cdGZhZGVUbzogZnVuY3Rpb24oIHNwZWVkLCB0bywgZWFzaW5nLCBjYWxsYmFjayApIHtcblxuXHRcdC8vIHNob3cgYW55IGhpZGRlbiBlbGVtZW50cyBhZnRlciBzZXR0aW5nIG9wYWNpdHkgdG8gMFxuXHRcdHJldHVybiB0aGlzLmZpbHRlciggaXNIaWRkZW4gKS5jc3MoIFwib3BhY2l0eVwiLCAwICkuc2hvdygpXG5cblx0XHRcdC8vIGFuaW1hdGUgdG8gdGhlIHZhbHVlIHNwZWNpZmllZFxuXHRcdFx0LmVuZCgpLmFuaW1hdGUoeyBvcGFjaXR5OiB0byB9LCBzcGVlZCwgZWFzaW5nLCBjYWxsYmFjayApO1xuXHR9LFxuXHRhbmltYXRlOiBmdW5jdGlvbiggcHJvcCwgc3BlZWQsIGVhc2luZywgY2FsbGJhY2sgKSB7XG5cdFx0dmFyIGVtcHR5ID0galF1ZXJ5LmlzRW1wdHlPYmplY3QoIHByb3AgKSxcblx0XHRcdG9wdGFsbCA9IGpRdWVyeS5zcGVlZCggc3BlZWQsIGVhc2luZywgY2FsbGJhY2sgKSxcblx0XHRcdGRvQW5pbWF0aW9uID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdC8vIE9wZXJhdGUgb24gYSBjb3B5IG9mIHByb3Agc28gcGVyLXByb3BlcnR5IGVhc2luZyB3b24ndCBiZSBsb3N0XG5cdFx0XHRcdHZhciBhbmltID0gQW5pbWF0aW9uKCB0aGlzLCBqUXVlcnkuZXh0ZW5kKCB7fSwgcHJvcCApLCBvcHRhbGwgKTtcblxuXHRcdFx0XHQvLyBFbXB0eSBhbmltYXRpb25zLCBvciBmaW5pc2hpbmcgcmVzb2x2ZXMgaW1tZWRpYXRlbHlcblx0XHRcdFx0aWYgKCBlbXB0eSB8fCBkYXRhX3ByaXYuZ2V0KCB0aGlzLCBcImZpbmlzaFwiICkgKSB7XG5cdFx0XHRcdFx0YW5pbS5zdG9wKCB0cnVlICk7XG5cdFx0XHRcdH1cblx0XHRcdH07XG5cdFx0XHRkb0FuaW1hdGlvbi5maW5pc2ggPSBkb0FuaW1hdGlvbjtcblxuXHRcdHJldHVybiBlbXB0eSB8fCBvcHRhbGwucXVldWUgPT09IGZhbHNlID9cblx0XHRcdHRoaXMuZWFjaCggZG9BbmltYXRpb24gKSA6XG5cdFx0XHR0aGlzLnF1ZXVlKCBvcHRhbGwucXVldWUsIGRvQW5pbWF0aW9uICk7XG5cdH0sXG5cdHN0b3A6IGZ1bmN0aW9uKCB0eXBlLCBjbGVhclF1ZXVlLCBnb3RvRW5kICkge1xuXHRcdHZhciBzdG9wUXVldWUgPSBmdW5jdGlvbiggaG9va3MgKSB7XG5cdFx0XHR2YXIgc3RvcCA9IGhvb2tzLnN0b3A7XG5cdFx0XHRkZWxldGUgaG9va3Muc3RvcDtcblx0XHRcdHN0b3AoIGdvdG9FbmQgKTtcblx0XHR9O1xuXG5cdFx0aWYgKCB0eXBlb2YgdHlwZSAhPT0gXCJzdHJpbmdcIiApIHtcblx0XHRcdGdvdG9FbmQgPSBjbGVhclF1ZXVlO1xuXHRcdFx0Y2xlYXJRdWV1ZSA9IHR5cGU7XG5cdFx0XHR0eXBlID0gdW5kZWZpbmVkO1xuXHRcdH1cblx0XHRpZiAoIGNsZWFyUXVldWUgJiYgdHlwZSAhPT0gZmFsc2UgKSB7XG5cdFx0XHR0aGlzLnF1ZXVlKCB0eXBlIHx8IFwiZnhcIiwgW10gKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIGRlcXVldWUgPSB0cnVlLFxuXHRcdFx0XHRpbmRleCA9IHR5cGUgIT0gbnVsbCAmJiB0eXBlICsgXCJxdWV1ZUhvb2tzXCIsXG5cdFx0XHRcdHRpbWVycyA9IGpRdWVyeS50aW1lcnMsXG5cdFx0XHRcdGRhdGEgPSBkYXRhX3ByaXYuZ2V0KCB0aGlzICk7XG5cblx0XHRcdGlmICggaW5kZXggKSB7XG5cdFx0XHRcdGlmICggZGF0YVsgaW5kZXggXSAmJiBkYXRhWyBpbmRleCBdLnN0b3AgKSB7XG5cdFx0XHRcdFx0c3RvcFF1ZXVlKCBkYXRhWyBpbmRleCBdICk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGZvciAoIGluZGV4IGluIGRhdGEgKSB7XG5cdFx0XHRcdFx0aWYgKCBkYXRhWyBpbmRleCBdICYmIGRhdGFbIGluZGV4IF0uc3RvcCAmJiBycnVuLnRlc3QoIGluZGV4ICkgKSB7XG5cdFx0XHRcdFx0XHRzdG9wUXVldWUoIGRhdGFbIGluZGV4IF0gKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Zm9yICggaW5kZXggPSB0aW1lcnMubGVuZ3RoOyBpbmRleC0tOyApIHtcblx0XHRcdFx0aWYgKCB0aW1lcnNbIGluZGV4IF0uZWxlbSA9PT0gdGhpcyAmJiAodHlwZSA9PSBudWxsIHx8IHRpbWVyc1sgaW5kZXggXS5xdWV1ZSA9PT0gdHlwZSkgKSB7XG5cdFx0XHRcdFx0dGltZXJzWyBpbmRleCBdLmFuaW0uc3RvcCggZ290b0VuZCApO1xuXHRcdFx0XHRcdGRlcXVldWUgPSBmYWxzZTtcblx0XHRcdFx0XHR0aW1lcnMuc3BsaWNlKCBpbmRleCwgMSApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8vIHN0YXJ0IHRoZSBuZXh0IGluIHRoZSBxdWV1ZSBpZiB0aGUgbGFzdCBzdGVwIHdhc24ndCBmb3JjZWRcblx0XHRcdC8vIHRpbWVycyBjdXJyZW50bHkgd2lsbCBjYWxsIHRoZWlyIGNvbXBsZXRlIGNhbGxiYWNrcywgd2hpY2ggd2lsbCBkZXF1ZXVlXG5cdFx0XHQvLyBidXQgb25seSBpZiB0aGV5IHdlcmUgZ290b0VuZFxuXHRcdFx0aWYgKCBkZXF1ZXVlIHx8ICFnb3RvRW5kICkge1xuXHRcdFx0XHRqUXVlcnkuZGVxdWV1ZSggdGhpcywgdHlwZSApO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9LFxuXHRmaW5pc2g6IGZ1bmN0aW9uKCB0eXBlICkge1xuXHRcdGlmICggdHlwZSAhPT0gZmFsc2UgKSB7XG5cdFx0XHR0eXBlID0gdHlwZSB8fCBcImZ4XCI7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgaW5kZXgsXG5cdFx0XHRcdGRhdGEgPSBkYXRhX3ByaXYuZ2V0KCB0aGlzICksXG5cdFx0XHRcdHF1ZXVlID0gZGF0YVsgdHlwZSArIFwicXVldWVcIiBdLFxuXHRcdFx0XHRob29rcyA9IGRhdGFbIHR5cGUgKyBcInF1ZXVlSG9va3NcIiBdLFxuXHRcdFx0XHR0aW1lcnMgPSBqUXVlcnkudGltZXJzLFxuXHRcdFx0XHRsZW5ndGggPSBxdWV1ZSA/IHF1ZXVlLmxlbmd0aCA6IDA7XG5cblx0XHRcdC8vIGVuYWJsZSBmaW5pc2hpbmcgZmxhZyBvbiBwcml2YXRlIGRhdGFcblx0XHRcdGRhdGEuZmluaXNoID0gdHJ1ZTtcblxuXHRcdFx0Ly8gZW1wdHkgdGhlIHF1ZXVlIGZpcnN0XG5cdFx0XHRqUXVlcnkucXVldWUoIHRoaXMsIHR5cGUsIFtdICk7XG5cblx0XHRcdGlmICggaG9va3MgJiYgaG9va3Muc3RvcCApIHtcblx0XHRcdFx0aG9va3Muc3RvcC5jYWxsKCB0aGlzLCB0cnVlICk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIGxvb2sgZm9yIGFueSBhY3RpdmUgYW5pbWF0aW9ucywgYW5kIGZpbmlzaCB0aGVtXG5cdFx0XHRmb3IgKCBpbmRleCA9IHRpbWVycy5sZW5ndGg7IGluZGV4LS07ICkge1xuXHRcdFx0XHRpZiAoIHRpbWVyc1sgaW5kZXggXS5lbGVtID09PSB0aGlzICYmIHRpbWVyc1sgaW5kZXggXS5xdWV1ZSA9PT0gdHlwZSApIHtcblx0XHRcdFx0XHR0aW1lcnNbIGluZGV4IF0uYW5pbS5zdG9wKCB0cnVlICk7XG5cdFx0XHRcdFx0dGltZXJzLnNwbGljZSggaW5kZXgsIDEgKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvLyBsb29rIGZvciBhbnkgYW5pbWF0aW9ucyBpbiB0aGUgb2xkIHF1ZXVlIGFuZCBmaW5pc2ggdGhlbVxuXHRcdFx0Zm9yICggaW5kZXggPSAwOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKyApIHtcblx0XHRcdFx0aWYgKCBxdWV1ZVsgaW5kZXggXSAmJiBxdWV1ZVsgaW5kZXggXS5maW5pc2ggKSB7XG5cdFx0XHRcdFx0cXVldWVbIGluZGV4IF0uZmluaXNoLmNhbGwoIHRoaXMgKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvLyB0dXJuIG9mZiBmaW5pc2hpbmcgZmxhZ1xuXHRcdFx0ZGVsZXRlIGRhdGEuZmluaXNoO1xuXHRcdH0pO1xuXHR9XG59KTtcblxualF1ZXJ5LmVhY2goWyBcInRvZ2dsZVwiLCBcInNob3dcIiwgXCJoaWRlXCIgXSwgZnVuY3Rpb24oIGksIG5hbWUgKSB7XG5cdHZhciBjc3NGbiA9IGpRdWVyeS5mblsgbmFtZSBdO1xuXHRqUXVlcnkuZm5bIG5hbWUgXSA9IGZ1bmN0aW9uKCBzcGVlZCwgZWFzaW5nLCBjYWxsYmFjayApIHtcblx0XHRyZXR1cm4gc3BlZWQgPT0gbnVsbCB8fCB0eXBlb2Ygc3BlZWQgPT09IFwiYm9vbGVhblwiID9cblx0XHRcdGNzc0ZuLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKSA6XG5cdFx0XHR0aGlzLmFuaW1hdGUoIGdlbkZ4KCBuYW1lLCB0cnVlICksIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrICk7XG5cdH07XG59KTtcblxuLy8gR2VuZXJhdGUgc2hvcnRjdXRzIGZvciBjdXN0b20gYW5pbWF0aW9uc1xualF1ZXJ5LmVhY2goe1xuXHRzbGlkZURvd246IGdlbkZ4KFwic2hvd1wiKSxcblx0c2xpZGVVcDogZ2VuRngoXCJoaWRlXCIpLFxuXHRzbGlkZVRvZ2dsZTogZ2VuRngoXCJ0b2dnbGVcIiksXG5cdGZhZGVJbjogeyBvcGFjaXR5OiBcInNob3dcIiB9LFxuXHRmYWRlT3V0OiB7IG9wYWNpdHk6IFwiaGlkZVwiIH0sXG5cdGZhZGVUb2dnbGU6IHsgb3BhY2l0eTogXCJ0b2dnbGVcIiB9XG59LCBmdW5jdGlvbiggbmFtZSwgcHJvcHMgKSB7XG5cdGpRdWVyeS5mblsgbmFtZSBdID0gZnVuY3Rpb24oIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrICkge1xuXHRcdHJldHVybiB0aGlzLmFuaW1hdGUoIHByb3BzLCBzcGVlZCwgZWFzaW5nLCBjYWxsYmFjayApO1xuXHR9O1xufSk7XG5cbmpRdWVyeS50aW1lcnMgPSBbXTtcbmpRdWVyeS5meC50aWNrID0gZnVuY3Rpb24oKSB7XG5cdHZhciB0aW1lcixcblx0XHRpID0gMCxcblx0XHR0aW1lcnMgPSBqUXVlcnkudGltZXJzO1xuXG5cdGZ4Tm93ID0galF1ZXJ5Lm5vdygpO1xuXG5cdGZvciAoIDsgaSA8IHRpbWVycy5sZW5ndGg7IGkrKyApIHtcblx0XHR0aW1lciA9IHRpbWVyc1sgaSBdO1xuXHRcdC8vIENoZWNrcyB0aGUgdGltZXIgaGFzIG5vdCBhbHJlYWR5IGJlZW4gcmVtb3ZlZFxuXHRcdGlmICggIXRpbWVyKCkgJiYgdGltZXJzWyBpIF0gPT09IHRpbWVyICkge1xuXHRcdFx0dGltZXJzLnNwbGljZSggaS0tLCAxICk7XG5cdFx0fVxuXHR9XG5cblx0aWYgKCAhdGltZXJzLmxlbmd0aCApIHtcblx0XHRqUXVlcnkuZnguc3RvcCgpO1xuXHR9XG5cdGZ4Tm93ID0gdW5kZWZpbmVkO1xufTtcblxualF1ZXJ5LmZ4LnRpbWVyID0gZnVuY3Rpb24oIHRpbWVyICkge1xuXHRqUXVlcnkudGltZXJzLnB1c2goIHRpbWVyICk7XG5cdGlmICggdGltZXIoKSApIHtcblx0XHRqUXVlcnkuZnguc3RhcnQoKTtcblx0fSBlbHNlIHtcblx0XHRqUXVlcnkudGltZXJzLnBvcCgpO1xuXHR9XG59O1xuXG5qUXVlcnkuZnguaW50ZXJ2YWwgPSAxMztcblxualF1ZXJ5LmZ4LnN0YXJ0ID0gZnVuY3Rpb24oKSB7XG5cdGlmICggIXRpbWVySWQgKSB7XG5cdFx0dGltZXJJZCA9IHNldEludGVydmFsKCBqUXVlcnkuZngudGljaywgalF1ZXJ5LmZ4LmludGVydmFsICk7XG5cdH1cbn07XG5cbmpRdWVyeS5meC5zdG9wID0gZnVuY3Rpb24oKSB7XG5cdGNsZWFySW50ZXJ2YWwoIHRpbWVySWQgKTtcblx0dGltZXJJZCA9IG51bGw7XG59O1xuXG5qUXVlcnkuZnguc3BlZWRzID0ge1xuXHRzbG93OiA2MDAsXG5cdGZhc3Q6IDIwMCxcblx0Ly8gRGVmYXVsdCBzcGVlZFxuXHRfZGVmYXVsdDogNDAwXG59O1xuXG5cbi8vIEJhc2VkIG9mZiBvZiB0aGUgcGx1Z2luIGJ5IENsaW50IEhlbGZlcnMsIHdpdGggcGVybWlzc2lvbi5cbi8vIGh0dHA6Ly9ibGluZHNpZ25hbHMuY29tL2luZGV4LnBocC8yMDA5LzA3L2pxdWVyeS1kZWxheS9cbmpRdWVyeS5mbi5kZWxheSA9IGZ1bmN0aW9uKCB0aW1lLCB0eXBlICkge1xuXHR0aW1lID0galF1ZXJ5LmZ4ID8galF1ZXJ5LmZ4LnNwZWVkc1sgdGltZSBdIHx8IHRpbWUgOiB0aW1lO1xuXHR0eXBlID0gdHlwZSB8fCBcImZ4XCI7XG5cblx0cmV0dXJuIHRoaXMucXVldWUoIHR5cGUsIGZ1bmN0aW9uKCBuZXh0LCBob29rcyApIHtcblx0XHR2YXIgdGltZW91dCA9IHNldFRpbWVvdXQoIG5leHQsIHRpbWUgKTtcblx0XHRob29rcy5zdG9wID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRjbGVhclRpbWVvdXQoIHRpbWVvdXQgKTtcblx0XHR9O1xuXHR9KTtcbn07XG5cblxuKGZ1bmN0aW9uKCkge1xuXHR2YXIgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCBcImlucHV0XCIgKSxcblx0XHRzZWxlY3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCBcInNlbGVjdFwiICksXG5cdFx0b3B0ID0gc2VsZWN0LmFwcGVuZENoaWxkKCBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCBcIm9wdGlvblwiICkgKTtcblxuXHRpbnB1dC50eXBlID0gXCJjaGVja2JveFwiO1xuXG5cdC8vIFN1cHBvcnQ6IGlPUyA1LjEsIEFuZHJvaWQgNC54LCBBbmRyb2lkIDIuM1xuXHQvLyBDaGVjayB0aGUgZGVmYXVsdCBjaGVja2JveC9yYWRpbyB2YWx1ZSAoXCJcIiBvbiBvbGQgV2ViS2l0OyBcIm9uXCIgZWxzZXdoZXJlKVxuXHRzdXBwb3J0LmNoZWNrT24gPSBpbnB1dC52YWx1ZSAhPT0gXCJcIjtcblxuXHQvLyBNdXN0IGFjY2VzcyB0aGUgcGFyZW50IHRvIG1ha2UgYW4gb3B0aW9uIHNlbGVjdCBwcm9wZXJseVxuXHQvLyBTdXBwb3J0OiBJRTksIElFMTBcblx0c3VwcG9ydC5vcHRTZWxlY3RlZCA9IG9wdC5zZWxlY3RlZDtcblxuXHQvLyBNYWtlIHN1cmUgdGhhdCB0aGUgb3B0aW9ucyBpbnNpZGUgZGlzYWJsZWQgc2VsZWN0cyBhcmVuJ3QgbWFya2VkIGFzIGRpc2FibGVkXG5cdC8vIChXZWJLaXQgbWFya3MgdGhlbSBhcyBkaXNhYmxlZClcblx0c2VsZWN0LmRpc2FibGVkID0gdHJ1ZTtcblx0c3VwcG9ydC5vcHREaXNhYmxlZCA9ICFvcHQuZGlzYWJsZWQ7XG5cblx0Ly8gQ2hlY2sgaWYgYW4gaW5wdXQgbWFpbnRhaW5zIGl0cyB2YWx1ZSBhZnRlciBiZWNvbWluZyBhIHJhZGlvXG5cdC8vIFN1cHBvcnQ6IElFOSwgSUUxMFxuXHRpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIFwiaW5wdXRcIiApO1xuXHRpbnB1dC52YWx1ZSA9IFwidFwiO1xuXHRpbnB1dC50eXBlID0gXCJyYWRpb1wiO1xuXHRzdXBwb3J0LnJhZGlvVmFsdWUgPSBpbnB1dC52YWx1ZSA9PT0gXCJ0XCI7XG59KSgpO1xuXG5cbnZhciBub2RlSG9vaywgYm9vbEhvb2ssXG5cdGF0dHJIYW5kbGUgPSBqUXVlcnkuZXhwci5hdHRySGFuZGxlO1xuXG5qUXVlcnkuZm4uZXh0ZW5kKHtcblx0YXR0cjogZnVuY3Rpb24oIG5hbWUsIHZhbHVlICkge1xuXHRcdHJldHVybiBhY2Nlc3MoIHRoaXMsIGpRdWVyeS5hdHRyLCBuYW1lLCB2YWx1ZSwgYXJndW1lbnRzLmxlbmd0aCA+IDEgKTtcblx0fSxcblxuXHRyZW1vdmVBdHRyOiBmdW5jdGlvbiggbmFtZSApIHtcblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xuXHRcdFx0alF1ZXJ5LnJlbW92ZUF0dHIoIHRoaXMsIG5hbWUgKTtcblx0XHR9KTtcblx0fVxufSk7XG5cbmpRdWVyeS5leHRlbmQoe1xuXHRhdHRyOiBmdW5jdGlvbiggZWxlbSwgbmFtZSwgdmFsdWUgKSB7XG5cdFx0dmFyIGhvb2tzLCByZXQsXG5cdFx0XHRuVHlwZSA9IGVsZW0ubm9kZVR5cGU7XG5cblx0XHQvLyBkb24ndCBnZXQvc2V0IGF0dHJpYnV0ZXMgb24gdGV4dCwgY29tbWVudCBhbmQgYXR0cmlidXRlIG5vZGVzXG5cdFx0aWYgKCAhZWxlbSB8fCBuVHlwZSA9PT0gMyB8fCBuVHlwZSA9PT0gOCB8fCBuVHlwZSA9PT0gMiApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBGYWxsYmFjayB0byBwcm9wIHdoZW4gYXR0cmlidXRlcyBhcmUgbm90IHN1cHBvcnRlZFxuXHRcdGlmICggdHlwZW9mIGVsZW0uZ2V0QXR0cmlidXRlID09PSBzdHJ1bmRlZmluZWQgKSB7XG5cdFx0XHRyZXR1cm4galF1ZXJ5LnByb3AoIGVsZW0sIG5hbWUsIHZhbHVlICk7XG5cdFx0fVxuXG5cdFx0Ly8gQWxsIGF0dHJpYnV0ZXMgYXJlIGxvd2VyY2FzZVxuXHRcdC8vIEdyYWIgbmVjZXNzYXJ5IGhvb2sgaWYgb25lIGlzIGRlZmluZWRcblx0XHRpZiAoIG5UeXBlICE9PSAxIHx8ICFqUXVlcnkuaXNYTUxEb2MoIGVsZW0gKSApIHtcblx0XHRcdG5hbWUgPSBuYW1lLnRvTG93ZXJDYXNlKCk7XG5cdFx0XHRob29rcyA9IGpRdWVyeS5hdHRySG9va3NbIG5hbWUgXSB8fFxuXHRcdFx0XHQoIGpRdWVyeS5leHByLm1hdGNoLmJvb2wudGVzdCggbmFtZSApID8gYm9vbEhvb2sgOiBub2RlSG9vayApO1xuXHRcdH1cblxuXHRcdGlmICggdmFsdWUgIT09IHVuZGVmaW5lZCApIHtcblxuXHRcdFx0aWYgKCB2YWx1ZSA9PT0gbnVsbCApIHtcblx0XHRcdFx0alF1ZXJ5LnJlbW92ZUF0dHIoIGVsZW0sIG5hbWUgKTtcblxuXHRcdFx0fSBlbHNlIGlmICggaG9va3MgJiYgXCJzZXRcIiBpbiBob29rcyAmJiAocmV0ID0gaG9va3Muc2V0KCBlbGVtLCB2YWx1ZSwgbmFtZSApKSAhPT0gdW5kZWZpbmVkICkge1xuXHRcdFx0XHRyZXR1cm4gcmV0O1xuXG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRlbGVtLnNldEF0dHJpYnV0ZSggbmFtZSwgdmFsdWUgKyBcIlwiICk7XG5cdFx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHRcdH1cblxuXHRcdH0gZWxzZSBpZiAoIGhvb2tzICYmIFwiZ2V0XCIgaW4gaG9va3MgJiYgKHJldCA9IGhvb2tzLmdldCggZWxlbSwgbmFtZSApKSAhPT0gbnVsbCApIHtcblx0XHRcdHJldHVybiByZXQ7XG5cblx0XHR9IGVsc2Uge1xuXHRcdFx0cmV0ID0galF1ZXJ5LmZpbmQuYXR0ciggZWxlbSwgbmFtZSApO1xuXG5cdFx0XHQvLyBOb24tZXhpc3RlbnQgYXR0cmlidXRlcyByZXR1cm4gbnVsbCwgd2Ugbm9ybWFsaXplIHRvIHVuZGVmaW5lZFxuXHRcdFx0cmV0dXJuIHJldCA9PSBudWxsID9cblx0XHRcdFx0dW5kZWZpbmVkIDpcblx0XHRcdFx0cmV0O1xuXHRcdH1cblx0fSxcblxuXHRyZW1vdmVBdHRyOiBmdW5jdGlvbiggZWxlbSwgdmFsdWUgKSB7XG5cdFx0dmFyIG5hbWUsIHByb3BOYW1lLFxuXHRcdFx0aSA9IDAsXG5cdFx0XHRhdHRyTmFtZXMgPSB2YWx1ZSAmJiB2YWx1ZS5tYXRjaCggcm5vdHdoaXRlICk7XG5cblx0XHRpZiAoIGF0dHJOYW1lcyAmJiBlbGVtLm5vZGVUeXBlID09PSAxICkge1xuXHRcdFx0d2hpbGUgKCAobmFtZSA9IGF0dHJOYW1lc1tpKytdKSApIHtcblx0XHRcdFx0cHJvcE5hbWUgPSBqUXVlcnkucHJvcEZpeFsgbmFtZSBdIHx8IG5hbWU7XG5cblx0XHRcdFx0Ly8gQm9vbGVhbiBhdHRyaWJ1dGVzIGdldCBzcGVjaWFsIHRyZWF0bWVudCAoIzEwODcwKVxuXHRcdFx0XHRpZiAoIGpRdWVyeS5leHByLm1hdGNoLmJvb2wudGVzdCggbmFtZSApICkge1xuXHRcdFx0XHRcdC8vIFNldCBjb3JyZXNwb25kaW5nIHByb3BlcnR5IHRvIGZhbHNlXG5cdFx0XHRcdFx0ZWxlbVsgcHJvcE5hbWUgXSA9IGZhbHNlO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0ZWxlbS5yZW1vdmVBdHRyaWJ1dGUoIG5hbWUgKTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0YXR0ckhvb2tzOiB7XG5cdFx0dHlwZToge1xuXHRcdFx0c2V0OiBmdW5jdGlvbiggZWxlbSwgdmFsdWUgKSB7XG5cdFx0XHRcdGlmICggIXN1cHBvcnQucmFkaW9WYWx1ZSAmJiB2YWx1ZSA9PT0gXCJyYWRpb1wiICYmXG5cdFx0XHRcdFx0alF1ZXJ5Lm5vZGVOYW1lKCBlbGVtLCBcImlucHV0XCIgKSApIHtcblx0XHRcdFx0XHQvLyBTZXR0aW5nIHRoZSB0eXBlIG9uIGEgcmFkaW8gYnV0dG9uIGFmdGVyIHRoZSB2YWx1ZSByZXNldHMgdGhlIHZhbHVlIGluIElFNi05XG5cdFx0XHRcdFx0Ly8gUmVzZXQgdmFsdWUgdG8gZGVmYXVsdCBpbiBjYXNlIHR5cGUgaXMgc2V0IGFmdGVyIHZhbHVlIGR1cmluZyBjcmVhdGlvblxuXHRcdFx0XHRcdHZhciB2YWwgPSBlbGVtLnZhbHVlO1xuXHRcdFx0XHRcdGVsZW0uc2V0QXR0cmlidXRlKCBcInR5cGVcIiwgdmFsdWUgKTtcblx0XHRcdFx0XHRpZiAoIHZhbCApIHtcblx0XHRcdFx0XHRcdGVsZW0udmFsdWUgPSB2YWw7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxufSk7XG5cbi8vIEhvb2tzIGZvciBib29sZWFuIGF0dHJpYnV0ZXNcbmJvb2xIb29rID0ge1xuXHRzZXQ6IGZ1bmN0aW9uKCBlbGVtLCB2YWx1ZSwgbmFtZSApIHtcblx0XHRpZiAoIHZhbHVlID09PSBmYWxzZSApIHtcblx0XHRcdC8vIFJlbW92ZSBib29sZWFuIGF0dHJpYnV0ZXMgd2hlbiBzZXQgdG8gZmFsc2Vcblx0XHRcdGpRdWVyeS5yZW1vdmVBdHRyKCBlbGVtLCBuYW1lICk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGVsZW0uc2V0QXR0cmlidXRlKCBuYW1lLCBuYW1lICk7XG5cdFx0fVxuXHRcdHJldHVybiBuYW1lO1xuXHR9XG59O1xualF1ZXJ5LmVhY2goIGpRdWVyeS5leHByLm1hdGNoLmJvb2wuc291cmNlLm1hdGNoKCAvXFx3Ky9nICksIGZ1bmN0aW9uKCBpLCBuYW1lICkge1xuXHR2YXIgZ2V0dGVyID0gYXR0ckhhbmRsZVsgbmFtZSBdIHx8IGpRdWVyeS5maW5kLmF0dHI7XG5cblx0YXR0ckhhbmRsZVsgbmFtZSBdID0gZnVuY3Rpb24oIGVsZW0sIG5hbWUsIGlzWE1MICkge1xuXHRcdHZhciByZXQsIGhhbmRsZTtcblx0XHRpZiAoICFpc1hNTCApIHtcblx0XHRcdC8vIEF2b2lkIGFuIGluZmluaXRlIGxvb3AgYnkgdGVtcG9yYXJpbHkgcmVtb3ZpbmcgdGhpcyBmdW5jdGlvbiBmcm9tIHRoZSBnZXR0ZXJcblx0XHRcdGhhbmRsZSA9IGF0dHJIYW5kbGVbIG5hbWUgXTtcblx0XHRcdGF0dHJIYW5kbGVbIG5hbWUgXSA9IHJldDtcblx0XHRcdHJldCA9IGdldHRlciggZWxlbSwgbmFtZSwgaXNYTUwgKSAhPSBudWxsID9cblx0XHRcdFx0bmFtZS50b0xvd2VyQ2FzZSgpIDpcblx0XHRcdFx0bnVsbDtcblx0XHRcdGF0dHJIYW5kbGVbIG5hbWUgXSA9IGhhbmRsZTtcblx0XHR9XG5cdFx0cmV0dXJuIHJldDtcblx0fTtcbn0pO1xuXG5cblxuXG52YXIgcmZvY3VzYWJsZSA9IC9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbikkL2k7XG5cbmpRdWVyeS5mbi5leHRlbmQoe1xuXHRwcm9wOiBmdW5jdGlvbiggbmFtZSwgdmFsdWUgKSB7XG5cdFx0cmV0dXJuIGFjY2VzcyggdGhpcywgalF1ZXJ5LnByb3AsIG5hbWUsIHZhbHVlLCBhcmd1bWVudHMubGVuZ3RoID4gMSApO1xuXHR9LFxuXG5cdHJlbW92ZVByb3A6IGZ1bmN0aW9uKCBuYW1lICkge1xuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0XHRkZWxldGUgdGhpc1sgalF1ZXJ5LnByb3BGaXhbIG5hbWUgXSB8fCBuYW1lIF07XG5cdFx0fSk7XG5cdH1cbn0pO1xuXG5qUXVlcnkuZXh0ZW5kKHtcblx0cHJvcEZpeDoge1xuXHRcdFwiZm9yXCI6IFwiaHRtbEZvclwiLFxuXHRcdFwiY2xhc3NcIjogXCJjbGFzc05hbWVcIlxuXHR9LFxuXG5cdHByb3A6IGZ1bmN0aW9uKCBlbGVtLCBuYW1lLCB2YWx1ZSApIHtcblx0XHR2YXIgcmV0LCBob29rcywgbm90eG1sLFxuXHRcdFx0blR5cGUgPSBlbGVtLm5vZGVUeXBlO1xuXG5cdFx0Ly8gZG9uJ3QgZ2V0L3NldCBwcm9wZXJ0aWVzIG9uIHRleHQsIGNvbW1lbnQgYW5kIGF0dHJpYnV0ZSBub2Rlc1xuXHRcdGlmICggIWVsZW0gfHwgblR5cGUgPT09IDMgfHwgblR5cGUgPT09IDggfHwgblR5cGUgPT09IDIgKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0bm90eG1sID0gblR5cGUgIT09IDEgfHwgIWpRdWVyeS5pc1hNTERvYyggZWxlbSApO1xuXG5cdFx0aWYgKCBub3R4bWwgKSB7XG5cdFx0XHQvLyBGaXggbmFtZSBhbmQgYXR0YWNoIGhvb2tzXG5cdFx0XHRuYW1lID0galF1ZXJ5LnByb3BGaXhbIG5hbWUgXSB8fCBuYW1lO1xuXHRcdFx0aG9va3MgPSBqUXVlcnkucHJvcEhvb2tzWyBuYW1lIF07XG5cdFx0fVxuXG5cdFx0aWYgKCB2YWx1ZSAhPT0gdW5kZWZpbmVkICkge1xuXHRcdFx0cmV0dXJuIGhvb2tzICYmIFwic2V0XCIgaW4gaG9va3MgJiYgKHJldCA9IGhvb2tzLnNldCggZWxlbSwgdmFsdWUsIG5hbWUgKSkgIT09IHVuZGVmaW5lZCA/XG5cdFx0XHRcdHJldCA6XG5cdFx0XHRcdCggZWxlbVsgbmFtZSBdID0gdmFsdWUgKTtcblxuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4gaG9va3MgJiYgXCJnZXRcIiBpbiBob29rcyAmJiAocmV0ID0gaG9va3MuZ2V0KCBlbGVtLCBuYW1lICkpICE9PSBudWxsID9cblx0XHRcdFx0cmV0IDpcblx0XHRcdFx0ZWxlbVsgbmFtZSBdO1xuXHRcdH1cblx0fSxcblxuXHRwcm9wSG9va3M6IHtcblx0XHR0YWJJbmRleDoge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdFx0cmV0dXJuIGVsZW0uaGFzQXR0cmlidXRlKCBcInRhYmluZGV4XCIgKSB8fCByZm9jdXNhYmxlLnRlc3QoIGVsZW0ubm9kZU5hbWUgKSB8fCBlbGVtLmhyZWYgP1xuXHRcdFx0XHRcdGVsZW0udGFiSW5kZXggOlxuXHRcdFx0XHRcdC0xO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxufSk7XG5cbi8vIFN1cHBvcnQ6IElFOStcbi8vIFNlbGVjdGVkbmVzcyBmb3IgYW4gb3B0aW9uIGluIGFuIG9wdGdyb3VwIGNhbiBiZSBpbmFjY3VyYXRlXG5pZiAoICFzdXBwb3J0Lm9wdFNlbGVjdGVkICkge1xuXHRqUXVlcnkucHJvcEhvb2tzLnNlbGVjdGVkID0ge1xuXHRcdGdldDogZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHR2YXIgcGFyZW50ID0gZWxlbS5wYXJlbnROb2RlO1xuXHRcdFx0aWYgKCBwYXJlbnQgJiYgcGFyZW50LnBhcmVudE5vZGUgKSB7XG5cdFx0XHRcdHBhcmVudC5wYXJlbnROb2RlLnNlbGVjdGVkSW5kZXg7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cdH07XG59XG5cbmpRdWVyeS5lYWNoKFtcblx0XCJ0YWJJbmRleFwiLFxuXHRcInJlYWRPbmx5XCIsXG5cdFwibWF4TGVuZ3RoXCIsXG5cdFwiY2VsbFNwYWNpbmdcIixcblx0XCJjZWxsUGFkZGluZ1wiLFxuXHRcInJvd1NwYW5cIixcblx0XCJjb2xTcGFuXCIsXG5cdFwidXNlTWFwXCIsXG5cdFwiZnJhbWVCb3JkZXJcIixcblx0XCJjb250ZW50RWRpdGFibGVcIlxuXSwgZnVuY3Rpb24oKSB7XG5cdGpRdWVyeS5wcm9wRml4WyB0aGlzLnRvTG93ZXJDYXNlKCkgXSA9IHRoaXM7XG59KTtcblxuXG5cblxudmFyIHJjbGFzcyA9IC9bXFx0XFxyXFxuXFxmXS9nO1xuXG5qUXVlcnkuZm4uZXh0ZW5kKHtcblx0YWRkQ2xhc3M6IGZ1bmN0aW9uKCB2YWx1ZSApIHtcblx0XHR2YXIgY2xhc3NlcywgZWxlbSwgY3VyLCBjbGF6eiwgaiwgZmluYWxWYWx1ZSxcblx0XHRcdHByb2NlZWQgPSB0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgJiYgdmFsdWUsXG5cdFx0XHRpID0gMCxcblx0XHRcdGxlbiA9IHRoaXMubGVuZ3RoO1xuXG5cdFx0aWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggdmFsdWUgKSApIHtcblx0XHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oIGogKSB7XG5cdFx0XHRcdGpRdWVyeSggdGhpcyApLmFkZENsYXNzKCB2YWx1ZS5jYWxsKCB0aGlzLCBqLCB0aGlzLmNsYXNzTmFtZSApICk7XG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRpZiAoIHByb2NlZWQgKSB7XG5cdFx0XHQvLyBUaGUgZGlzanVuY3Rpb24gaGVyZSBpcyBmb3IgYmV0dGVyIGNvbXByZXNzaWJpbGl0eSAoc2VlIHJlbW92ZUNsYXNzKVxuXHRcdFx0Y2xhc3NlcyA9ICggdmFsdWUgfHwgXCJcIiApLm1hdGNoKCBybm90d2hpdGUgKSB8fCBbXTtcblxuXHRcdFx0Zm9yICggOyBpIDwgbGVuOyBpKysgKSB7XG5cdFx0XHRcdGVsZW0gPSB0aGlzWyBpIF07XG5cdFx0XHRcdGN1ciA9IGVsZW0ubm9kZVR5cGUgPT09IDEgJiYgKCBlbGVtLmNsYXNzTmFtZSA/XG5cdFx0XHRcdFx0KCBcIiBcIiArIGVsZW0uY2xhc3NOYW1lICsgXCIgXCIgKS5yZXBsYWNlKCByY2xhc3MsIFwiIFwiICkgOlxuXHRcdFx0XHRcdFwiIFwiXG5cdFx0XHRcdCk7XG5cblx0XHRcdFx0aWYgKCBjdXIgKSB7XG5cdFx0XHRcdFx0aiA9IDA7XG5cdFx0XHRcdFx0d2hpbGUgKCAoY2xhenogPSBjbGFzc2VzW2orK10pICkge1xuXHRcdFx0XHRcdFx0aWYgKCBjdXIuaW5kZXhPZiggXCIgXCIgKyBjbGF6eiArIFwiIFwiICkgPCAwICkge1xuXHRcdFx0XHRcdFx0XHRjdXIgKz0gY2xhenogKyBcIiBcIjtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyBvbmx5IGFzc2lnbiBpZiBkaWZmZXJlbnQgdG8gYXZvaWQgdW5uZWVkZWQgcmVuZGVyaW5nLlxuXHRcdFx0XHRcdGZpbmFsVmFsdWUgPSBqUXVlcnkudHJpbSggY3VyICk7XG5cdFx0XHRcdFx0aWYgKCBlbGVtLmNsYXNzTmFtZSAhPT0gZmluYWxWYWx1ZSApIHtcblx0XHRcdFx0XHRcdGVsZW0uY2xhc3NOYW1lID0gZmluYWxWYWx1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRyZW1vdmVDbGFzczogZnVuY3Rpb24oIHZhbHVlICkge1xuXHRcdHZhciBjbGFzc2VzLCBlbGVtLCBjdXIsIGNsYXp6LCBqLCBmaW5hbFZhbHVlLFxuXHRcdFx0cHJvY2VlZCA9IGFyZ3VtZW50cy5sZW5ndGggPT09IDAgfHwgdHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiICYmIHZhbHVlLFxuXHRcdFx0aSA9IDAsXG5cdFx0XHRsZW4gPSB0aGlzLmxlbmd0aDtcblxuXHRcdGlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIHZhbHVlICkgKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCBqICkge1xuXHRcdFx0XHRqUXVlcnkoIHRoaXMgKS5yZW1vdmVDbGFzcyggdmFsdWUuY2FsbCggdGhpcywgaiwgdGhpcy5jbGFzc05hbWUgKSApO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdGlmICggcHJvY2VlZCApIHtcblx0XHRcdGNsYXNzZXMgPSAoIHZhbHVlIHx8IFwiXCIgKS5tYXRjaCggcm5vdHdoaXRlICkgfHwgW107XG5cblx0XHRcdGZvciAoIDsgaSA8IGxlbjsgaSsrICkge1xuXHRcdFx0XHRlbGVtID0gdGhpc1sgaSBdO1xuXHRcdFx0XHQvLyBUaGlzIGV4cHJlc3Npb24gaXMgaGVyZSBmb3IgYmV0dGVyIGNvbXByZXNzaWJpbGl0eSAoc2VlIGFkZENsYXNzKVxuXHRcdFx0XHRjdXIgPSBlbGVtLm5vZGVUeXBlID09PSAxICYmICggZWxlbS5jbGFzc05hbWUgP1xuXHRcdFx0XHRcdCggXCIgXCIgKyBlbGVtLmNsYXNzTmFtZSArIFwiIFwiICkucmVwbGFjZSggcmNsYXNzLCBcIiBcIiApIDpcblx0XHRcdFx0XHRcIlwiXG5cdFx0XHRcdCk7XG5cblx0XHRcdFx0aWYgKCBjdXIgKSB7XG5cdFx0XHRcdFx0aiA9IDA7XG5cdFx0XHRcdFx0d2hpbGUgKCAoY2xhenogPSBjbGFzc2VzW2orK10pICkge1xuXHRcdFx0XHRcdFx0Ly8gUmVtb3ZlICphbGwqIGluc3RhbmNlc1xuXHRcdFx0XHRcdFx0d2hpbGUgKCBjdXIuaW5kZXhPZiggXCIgXCIgKyBjbGF6eiArIFwiIFwiICkgPj0gMCApIHtcblx0XHRcdFx0XHRcdFx0Y3VyID0gY3VyLnJlcGxhY2UoIFwiIFwiICsgY2xhenogKyBcIiBcIiwgXCIgXCIgKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyBvbmx5IGFzc2lnbiBpZiBkaWZmZXJlbnQgdG8gYXZvaWQgdW5uZWVkZWQgcmVuZGVyaW5nLlxuXHRcdFx0XHRcdGZpbmFsVmFsdWUgPSB2YWx1ZSA/IGpRdWVyeS50cmltKCBjdXIgKSA6IFwiXCI7XG5cdFx0XHRcdFx0aWYgKCBlbGVtLmNsYXNzTmFtZSAhPT0gZmluYWxWYWx1ZSApIHtcblx0XHRcdFx0XHRcdGVsZW0uY2xhc3NOYW1lID0gZmluYWxWYWx1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHR0b2dnbGVDbGFzczogZnVuY3Rpb24oIHZhbHVlLCBzdGF0ZVZhbCApIHtcblx0XHR2YXIgdHlwZSA9IHR5cGVvZiB2YWx1ZTtcblxuXHRcdGlmICggdHlwZW9mIHN0YXRlVmFsID09PSBcImJvb2xlYW5cIiAmJiB0eXBlID09PSBcInN0cmluZ1wiICkge1xuXHRcdFx0cmV0dXJuIHN0YXRlVmFsID8gdGhpcy5hZGRDbGFzcyggdmFsdWUgKSA6IHRoaXMucmVtb3ZlQ2xhc3MoIHZhbHVlICk7XG5cdFx0fVxuXG5cdFx0aWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggdmFsdWUgKSApIHtcblx0XHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oIGkgKSB7XG5cdFx0XHRcdGpRdWVyeSggdGhpcyApLnRvZ2dsZUNsYXNzKCB2YWx1ZS5jYWxsKHRoaXMsIGksIHRoaXMuY2xhc3NOYW1lLCBzdGF0ZVZhbCksIHN0YXRlVmFsICk7XG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKCB0eXBlID09PSBcInN0cmluZ1wiICkge1xuXHRcdFx0XHQvLyB0b2dnbGUgaW5kaXZpZHVhbCBjbGFzcyBuYW1lc1xuXHRcdFx0XHR2YXIgY2xhc3NOYW1lLFxuXHRcdFx0XHRcdGkgPSAwLFxuXHRcdFx0XHRcdHNlbGYgPSBqUXVlcnkoIHRoaXMgKSxcblx0XHRcdFx0XHRjbGFzc05hbWVzID0gdmFsdWUubWF0Y2goIHJub3R3aGl0ZSApIHx8IFtdO1xuXG5cdFx0XHRcdHdoaWxlICggKGNsYXNzTmFtZSA9IGNsYXNzTmFtZXNbIGkrKyBdKSApIHtcblx0XHRcdFx0XHQvLyBjaGVjayBlYWNoIGNsYXNzTmFtZSBnaXZlbiwgc3BhY2Ugc2VwYXJhdGVkIGxpc3Rcblx0XHRcdFx0XHRpZiAoIHNlbGYuaGFzQ2xhc3MoIGNsYXNzTmFtZSApICkge1xuXHRcdFx0XHRcdFx0c2VsZi5yZW1vdmVDbGFzcyggY2xhc3NOYW1lICk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHNlbGYuYWRkQ2xhc3MoIGNsYXNzTmFtZSApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHQvLyBUb2dnbGUgd2hvbGUgY2xhc3MgbmFtZVxuXHRcdFx0fSBlbHNlIGlmICggdHlwZSA9PT0gc3RydW5kZWZpbmVkIHx8IHR5cGUgPT09IFwiYm9vbGVhblwiICkge1xuXHRcdFx0XHRpZiAoIHRoaXMuY2xhc3NOYW1lICkge1xuXHRcdFx0XHRcdC8vIHN0b3JlIGNsYXNzTmFtZSBpZiBzZXRcblx0XHRcdFx0XHRkYXRhX3ByaXYuc2V0KCB0aGlzLCBcIl9fY2xhc3NOYW1lX19cIiwgdGhpcy5jbGFzc05hbWUgKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIElmIHRoZSBlbGVtZW50IGhhcyBhIGNsYXNzIG5hbWUgb3IgaWYgd2UncmUgcGFzc2VkIFwiZmFsc2VcIixcblx0XHRcdFx0Ly8gdGhlbiByZW1vdmUgdGhlIHdob2xlIGNsYXNzbmFtZSAoaWYgdGhlcmUgd2FzIG9uZSwgdGhlIGFib3ZlIHNhdmVkIGl0KS5cblx0XHRcdFx0Ly8gT3RoZXJ3aXNlIGJyaW5nIGJhY2sgd2hhdGV2ZXIgd2FzIHByZXZpb3VzbHkgc2F2ZWQgKGlmIGFueXRoaW5nKSxcblx0XHRcdFx0Ly8gZmFsbGluZyBiYWNrIHRvIHRoZSBlbXB0eSBzdHJpbmcgaWYgbm90aGluZyB3YXMgc3RvcmVkLlxuXHRcdFx0XHR0aGlzLmNsYXNzTmFtZSA9IHRoaXMuY2xhc3NOYW1lIHx8IHZhbHVlID09PSBmYWxzZSA/IFwiXCIgOiBkYXRhX3ByaXYuZ2V0KCB0aGlzLCBcIl9fY2xhc3NOYW1lX19cIiApIHx8IFwiXCI7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH0sXG5cblx0aGFzQ2xhc3M6IGZ1bmN0aW9uKCBzZWxlY3RvciApIHtcblx0XHR2YXIgY2xhc3NOYW1lID0gXCIgXCIgKyBzZWxlY3RvciArIFwiIFwiLFxuXHRcdFx0aSA9IDAsXG5cdFx0XHRsID0gdGhpcy5sZW5ndGg7XG5cdFx0Zm9yICggOyBpIDwgbDsgaSsrICkge1xuXHRcdFx0aWYgKCB0aGlzW2ldLm5vZGVUeXBlID09PSAxICYmIChcIiBcIiArIHRoaXNbaV0uY2xhc3NOYW1lICsgXCIgXCIpLnJlcGxhY2UocmNsYXNzLCBcIiBcIikuaW5kZXhPZiggY2xhc3NOYW1lICkgPj0gMCApIHtcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG59KTtcblxuXG5cblxudmFyIHJyZXR1cm4gPSAvXFxyL2c7XG5cbmpRdWVyeS5mbi5leHRlbmQoe1xuXHR2YWw6IGZ1bmN0aW9uKCB2YWx1ZSApIHtcblx0XHR2YXIgaG9va3MsIHJldCwgaXNGdW5jdGlvbixcblx0XHRcdGVsZW0gPSB0aGlzWzBdO1xuXG5cdFx0aWYgKCAhYXJndW1lbnRzLmxlbmd0aCApIHtcblx0XHRcdGlmICggZWxlbSApIHtcblx0XHRcdFx0aG9va3MgPSBqUXVlcnkudmFsSG9va3NbIGVsZW0udHlwZSBdIHx8IGpRdWVyeS52YWxIb29rc1sgZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpIF07XG5cblx0XHRcdFx0aWYgKCBob29rcyAmJiBcImdldFwiIGluIGhvb2tzICYmIChyZXQgPSBob29rcy5nZXQoIGVsZW0sIFwidmFsdWVcIiApKSAhPT0gdW5kZWZpbmVkICkge1xuXHRcdFx0XHRcdHJldHVybiByZXQ7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXQgPSBlbGVtLnZhbHVlO1xuXG5cdFx0XHRcdHJldHVybiB0eXBlb2YgcmV0ID09PSBcInN0cmluZ1wiID9cblx0XHRcdFx0XHQvLyBoYW5kbGUgbW9zdCBjb21tb24gc3RyaW5nIGNhc2VzXG5cdFx0XHRcdFx0cmV0LnJlcGxhY2UocnJldHVybiwgXCJcIikgOlxuXHRcdFx0XHRcdC8vIGhhbmRsZSBjYXNlcyB3aGVyZSB2YWx1ZSBpcyBudWxsL3VuZGVmIG9yIG51bWJlclxuXHRcdFx0XHRcdHJldCA9PSBudWxsID8gXCJcIiA6IHJldDtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGlzRnVuY3Rpb24gPSBqUXVlcnkuaXNGdW5jdGlvbiggdmFsdWUgKTtcblxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oIGkgKSB7XG5cdFx0XHR2YXIgdmFsO1xuXG5cdFx0XHRpZiAoIHRoaXMubm9kZVR5cGUgIT09IDEgKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCBpc0Z1bmN0aW9uICkge1xuXHRcdFx0XHR2YWwgPSB2YWx1ZS5jYWxsKCB0aGlzLCBpLCBqUXVlcnkoIHRoaXMgKS52YWwoKSApO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dmFsID0gdmFsdWU7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFRyZWF0IG51bGwvdW5kZWZpbmVkIGFzIFwiXCI7IGNvbnZlcnQgbnVtYmVycyB0byBzdHJpbmdcblx0XHRcdGlmICggdmFsID09IG51bGwgKSB7XG5cdFx0XHRcdHZhbCA9IFwiXCI7XG5cblx0XHRcdH0gZWxzZSBpZiAoIHR5cGVvZiB2YWwgPT09IFwibnVtYmVyXCIgKSB7XG5cdFx0XHRcdHZhbCArPSBcIlwiO1xuXG5cdFx0XHR9IGVsc2UgaWYgKCBqUXVlcnkuaXNBcnJheSggdmFsICkgKSB7XG5cdFx0XHRcdHZhbCA9IGpRdWVyeS5tYXAoIHZhbCwgZnVuY3Rpb24oIHZhbHVlICkge1xuXHRcdFx0XHRcdHJldHVybiB2YWx1ZSA9PSBudWxsID8gXCJcIiA6IHZhbHVlICsgXCJcIjtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cblx0XHRcdGhvb2tzID0galF1ZXJ5LnZhbEhvb2tzWyB0aGlzLnR5cGUgXSB8fCBqUXVlcnkudmFsSG9va3NbIHRoaXMubm9kZU5hbWUudG9Mb3dlckNhc2UoKSBdO1xuXG5cdFx0XHQvLyBJZiBzZXQgcmV0dXJucyB1bmRlZmluZWQsIGZhbGwgYmFjayB0byBub3JtYWwgc2V0dGluZ1xuXHRcdFx0aWYgKCAhaG9va3MgfHwgIShcInNldFwiIGluIGhvb2tzKSB8fCBob29rcy5zZXQoIHRoaXMsIHZhbCwgXCJ2YWx1ZVwiICkgPT09IHVuZGVmaW5lZCApIHtcblx0XHRcdFx0dGhpcy52YWx1ZSA9IHZhbDtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxufSk7XG5cbmpRdWVyeS5leHRlbmQoe1xuXHR2YWxIb29rczoge1xuXHRcdG9wdGlvbjoge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdFx0dmFyIHZhbCA9IGpRdWVyeS5maW5kLmF0dHIoIGVsZW0sIFwidmFsdWVcIiApO1xuXHRcdFx0XHRyZXR1cm4gdmFsICE9IG51bGwgP1xuXHRcdFx0XHRcdHZhbCA6XG5cdFx0XHRcdFx0Ly8gU3VwcG9ydDogSUUxMC0xMStcblx0XHRcdFx0XHQvLyBvcHRpb24udGV4dCB0aHJvd3MgZXhjZXB0aW9ucyAoIzE0Njg2LCAjMTQ4NTgpXG5cdFx0XHRcdFx0alF1ZXJ5LnRyaW0oIGpRdWVyeS50ZXh0KCBlbGVtICkgKTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdHNlbGVjdDoge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbiggZWxlbSApIHtcblx0XHRcdFx0dmFyIHZhbHVlLCBvcHRpb24sXG5cdFx0XHRcdFx0b3B0aW9ucyA9IGVsZW0ub3B0aW9ucyxcblx0XHRcdFx0XHRpbmRleCA9IGVsZW0uc2VsZWN0ZWRJbmRleCxcblx0XHRcdFx0XHRvbmUgPSBlbGVtLnR5cGUgPT09IFwic2VsZWN0LW9uZVwiIHx8IGluZGV4IDwgMCxcblx0XHRcdFx0XHR2YWx1ZXMgPSBvbmUgPyBudWxsIDogW10sXG5cdFx0XHRcdFx0bWF4ID0gb25lID8gaW5kZXggKyAxIDogb3B0aW9ucy5sZW5ndGgsXG5cdFx0XHRcdFx0aSA9IGluZGV4IDwgMCA/XG5cdFx0XHRcdFx0XHRtYXggOlxuXHRcdFx0XHRcdFx0b25lID8gaW5kZXggOiAwO1xuXG5cdFx0XHRcdC8vIExvb3AgdGhyb3VnaCBhbGwgdGhlIHNlbGVjdGVkIG9wdGlvbnNcblx0XHRcdFx0Zm9yICggOyBpIDwgbWF4OyBpKysgKSB7XG5cdFx0XHRcdFx0b3B0aW9uID0gb3B0aW9uc1sgaSBdO1xuXG5cdFx0XHRcdFx0Ly8gSUU2LTkgZG9lc24ndCB1cGRhdGUgc2VsZWN0ZWQgYWZ0ZXIgZm9ybSByZXNldCAoIzI1NTEpXG5cdFx0XHRcdFx0aWYgKCAoIG9wdGlvbi5zZWxlY3RlZCB8fCBpID09PSBpbmRleCApICYmXG5cdFx0XHRcdFx0XHRcdC8vIERvbid0IHJldHVybiBvcHRpb25zIHRoYXQgYXJlIGRpc2FibGVkIG9yIGluIGEgZGlzYWJsZWQgb3B0Z3JvdXBcblx0XHRcdFx0XHRcdFx0KCBzdXBwb3J0Lm9wdERpc2FibGVkID8gIW9wdGlvbi5kaXNhYmxlZCA6IG9wdGlvbi5nZXRBdHRyaWJ1dGUoIFwiZGlzYWJsZWRcIiApID09PSBudWxsICkgJiZcblx0XHRcdFx0XHRcdFx0KCAhb3B0aW9uLnBhcmVudE5vZGUuZGlzYWJsZWQgfHwgIWpRdWVyeS5ub2RlTmFtZSggb3B0aW9uLnBhcmVudE5vZGUsIFwib3B0Z3JvdXBcIiApICkgKSB7XG5cblx0XHRcdFx0XHRcdC8vIEdldCB0aGUgc3BlY2lmaWMgdmFsdWUgZm9yIHRoZSBvcHRpb25cblx0XHRcdFx0XHRcdHZhbHVlID0galF1ZXJ5KCBvcHRpb24gKS52YWwoKTtcblxuXHRcdFx0XHRcdFx0Ly8gV2UgZG9uJ3QgbmVlZCBhbiBhcnJheSBmb3Igb25lIHNlbGVjdHNcblx0XHRcdFx0XHRcdGlmICggb25lICkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8vIE11bHRpLVNlbGVjdHMgcmV0dXJuIGFuIGFycmF5XG5cdFx0XHRcdFx0XHR2YWx1ZXMucHVzaCggdmFsdWUgKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4gdmFsdWVzO1xuXHRcdFx0fSxcblxuXHRcdFx0c2V0OiBmdW5jdGlvbiggZWxlbSwgdmFsdWUgKSB7XG5cdFx0XHRcdHZhciBvcHRpb25TZXQsIG9wdGlvbixcblx0XHRcdFx0XHRvcHRpb25zID0gZWxlbS5vcHRpb25zLFxuXHRcdFx0XHRcdHZhbHVlcyA9IGpRdWVyeS5tYWtlQXJyYXkoIHZhbHVlICksXG5cdFx0XHRcdFx0aSA9IG9wdGlvbnMubGVuZ3RoO1xuXG5cdFx0XHRcdHdoaWxlICggaS0tICkge1xuXHRcdFx0XHRcdG9wdGlvbiA9IG9wdGlvbnNbIGkgXTtcblx0XHRcdFx0XHRpZiAoIChvcHRpb24uc2VsZWN0ZWQgPSBqUXVlcnkuaW5BcnJheSggb3B0aW9uLnZhbHVlLCB2YWx1ZXMgKSA+PSAwKSApIHtcblx0XHRcdFx0XHRcdG9wdGlvblNldCA9IHRydWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gZm9yY2UgYnJvd3NlcnMgdG8gYmVoYXZlIGNvbnNpc3RlbnRseSB3aGVuIG5vbi1tYXRjaGluZyB2YWx1ZSBpcyBzZXRcblx0XHRcdFx0aWYgKCAhb3B0aW9uU2V0ICkge1xuXHRcdFx0XHRcdGVsZW0uc2VsZWN0ZWRJbmRleCA9IC0xO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiB2YWx1ZXM7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG59KTtcblxuLy8gUmFkaW9zIGFuZCBjaGVja2JveGVzIGdldHRlci9zZXR0ZXJcbmpRdWVyeS5lYWNoKFsgXCJyYWRpb1wiLCBcImNoZWNrYm94XCIgXSwgZnVuY3Rpb24oKSB7XG5cdGpRdWVyeS52YWxIb29rc1sgdGhpcyBdID0ge1xuXHRcdHNldDogZnVuY3Rpb24oIGVsZW0sIHZhbHVlICkge1xuXHRcdFx0aWYgKCBqUXVlcnkuaXNBcnJheSggdmFsdWUgKSApIHtcblx0XHRcdFx0cmV0dXJuICggZWxlbS5jaGVja2VkID0galF1ZXJ5LmluQXJyYXkoIGpRdWVyeShlbGVtKS52YWwoKSwgdmFsdWUgKSA+PSAwICk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9O1xuXHRpZiAoICFzdXBwb3J0LmNoZWNrT24gKSB7XG5cdFx0alF1ZXJ5LnZhbEhvb2tzWyB0aGlzIF0uZ2V0ID0gZnVuY3Rpb24oIGVsZW0gKSB7XG5cdFx0XHQvLyBTdXBwb3J0OiBXZWJraXRcblx0XHRcdC8vIFwiXCIgaXMgcmV0dXJuZWQgaW5zdGVhZCBvZiBcIm9uXCIgaWYgYSB2YWx1ZSBpc24ndCBzcGVjaWZpZWRcblx0XHRcdHJldHVybiBlbGVtLmdldEF0dHJpYnV0ZShcInZhbHVlXCIpID09PSBudWxsID8gXCJvblwiIDogZWxlbS52YWx1ZTtcblx0XHR9O1xuXHR9XG59KTtcblxuXG5cblxuLy8gUmV0dXJuIGpRdWVyeSBmb3IgYXR0cmlidXRlcy1vbmx5IGluY2x1c2lvblxuXG5cbmpRdWVyeS5lYWNoKCAoXCJibHVyIGZvY3VzIGZvY3VzaW4gZm9jdXNvdXQgbG9hZCByZXNpemUgc2Nyb2xsIHVubG9hZCBjbGljayBkYmxjbGljayBcIiArXG5cdFwibW91c2Vkb3duIG1vdXNldXAgbW91c2Vtb3ZlIG1vdXNlb3ZlciBtb3VzZW91dCBtb3VzZWVudGVyIG1vdXNlbGVhdmUgXCIgK1xuXHRcImNoYW5nZSBzZWxlY3Qgc3VibWl0IGtleWRvd24ga2V5cHJlc3Mga2V5dXAgZXJyb3IgY29udGV4dG1lbnVcIikuc3BsaXQoXCIgXCIpLCBmdW5jdGlvbiggaSwgbmFtZSApIHtcblxuXHQvLyBIYW5kbGUgZXZlbnQgYmluZGluZ1xuXHRqUXVlcnkuZm5bIG5hbWUgXSA9IGZ1bmN0aW9uKCBkYXRhLCBmbiApIHtcblx0XHRyZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA+IDAgP1xuXHRcdFx0dGhpcy5vbiggbmFtZSwgbnVsbCwgZGF0YSwgZm4gKSA6XG5cdFx0XHR0aGlzLnRyaWdnZXIoIG5hbWUgKTtcblx0fTtcbn0pO1xuXG5qUXVlcnkuZm4uZXh0ZW5kKHtcblx0aG92ZXI6IGZ1bmN0aW9uKCBmbk92ZXIsIGZuT3V0ICkge1xuXHRcdHJldHVybiB0aGlzLm1vdXNlZW50ZXIoIGZuT3ZlciApLm1vdXNlbGVhdmUoIGZuT3V0IHx8IGZuT3ZlciApO1xuXHR9LFxuXG5cdGJpbmQ6IGZ1bmN0aW9uKCB0eXBlcywgZGF0YSwgZm4gKSB7XG5cdFx0cmV0dXJuIHRoaXMub24oIHR5cGVzLCBudWxsLCBkYXRhLCBmbiApO1xuXHR9LFxuXHR1bmJpbmQ6IGZ1bmN0aW9uKCB0eXBlcywgZm4gKSB7XG5cdFx0cmV0dXJuIHRoaXMub2ZmKCB0eXBlcywgbnVsbCwgZm4gKTtcblx0fSxcblxuXHRkZWxlZ2F0ZTogZnVuY3Rpb24oIHNlbGVjdG9yLCB0eXBlcywgZGF0YSwgZm4gKSB7XG5cdFx0cmV0dXJuIHRoaXMub24oIHR5cGVzLCBzZWxlY3RvciwgZGF0YSwgZm4gKTtcblx0fSxcblx0dW5kZWxlZ2F0ZTogZnVuY3Rpb24oIHNlbGVjdG9yLCB0eXBlcywgZm4gKSB7XG5cdFx0Ly8gKCBuYW1lc3BhY2UgKSBvciAoIHNlbGVjdG9yLCB0eXBlcyBbLCBmbl0gKVxuXHRcdHJldHVybiBhcmd1bWVudHMubGVuZ3RoID09PSAxID8gdGhpcy5vZmYoIHNlbGVjdG9yLCBcIioqXCIgKSA6IHRoaXMub2ZmKCB0eXBlcywgc2VsZWN0b3IgfHwgXCIqKlwiLCBmbiApO1xuXHR9XG59KTtcblxuXG52YXIgbm9uY2UgPSBqUXVlcnkubm93KCk7XG5cbnZhciBycXVlcnkgPSAoL1xcPy8pO1xuXG5cblxuLy8gU3VwcG9ydDogQW5kcm9pZCAyLjNcbi8vIFdvcmthcm91bmQgZmFpbHVyZSB0byBzdHJpbmctY2FzdCBudWxsIGlucHV0XG5qUXVlcnkucGFyc2VKU09OID0gZnVuY3Rpb24oIGRhdGEgKSB7XG5cdHJldHVybiBKU09OLnBhcnNlKCBkYXRhICsgXCJcIiApO1xufTtcblxuXG4vLyBDcm9zcy1icm93c2VyIHhtbCBwYXJzaW5nXG5qUXVlcnkucGFyc2VYTUwgPSBmdW5jdGlvbiggZGF0YSApIHtcblx0dmFyIHhtbCwgdG1wO1xuXHRpZiAoICFkYXRhIHx8IHR5cGVvZiBkYXRhICE9PSBcInN0cmluZ1wiICkge1xuXHRcdHJldHVybiBudWxsO1xuXHR9XG5cblx0Ly8gU3VwcG9ydDogSUU5XG5cdHRyeSB7XG5cdFx0dG1wID0gbmV3IERPTVBhcnNlcigpO1xuXHRcdHhtbCA9IHRtcC5wYXJzZUZyb21TdHJpbmcoIGRhdGEsIFwidGV4dC94bWxcIiApO1xuXHR9IGNhdGNoICggZSApIHtcblx0XHR4bWwgPSB1bmRlZmluZWQ7XG5cdH1cblxuXHRpZiAoICF4bWwgfHwgeG1sLmdldEVsZW1lbnRzQnlUYWdOYW1lKCBcInBhcnNlcmVycm9yXCIgKS5sZW5ndGggKSB7XG5cdFx0alF1ZXJ5LmVycm9yKCBcIkludmFsaWQgWE1MOiBcIiArIGRhdGEgKTtcblx0fVxuXHRyZXR1cm4geG1sO1xufTtcblxuXG52YXJcblx0Ly8gRG9jdW1lbnQgbG9jYXRpb25cblx0YWpheExvY1BhcnRzLFxuXHRhamF4TG9jYXRpb24sXG5cblx0cmhhc2ggPSAvIy4qJC8sXG5cdHJ0cyA9IC8oWz8mXSlfPVteJl0qLyxcblx0cmhlYWRlcnMgPSAvXiguKj8pOlsgXFx0XSooW15cXHJcXG5dKikkL21nLFxuXHQvLyAjNzY1MywgIzgxMjUsICM4MTUyOiBsb2NhbCBwcm90b2NvbCBkZXRlY3Rpb25cblx0cmxvY2FsUHJvdG9jb2wgPSAvXig/OmFib3V0fGFwcHxhcHAtc3RvcmFnZXwuKy1leHRlbnNpb258ZmlsZXxyZXN8d2lkZ2V0KTokLyxcblx0cm5vQ29udGVudCA9IC9eKD86R0VUfEhFQUQpJC8sXG5cdHJwcm90b2NvbCA9IC9eXFwvXFwvLyxcblx0cnVybCA9IC9eKFtcXHcuKy1dKzopKD86XFwvXFwvKD86W15cXC8/I10qQHwpKFteXFwvPyM6XSopKD86OihcXGQrKXwpfCkvLFxuXG5cdC8qIFByZWZpbHRlcnNcblx0ICogMSkgVGhleSBhcmUgdXNlZnVsIHRvIGludHJvZHVjZSBjdXN0b20gZGF0YVR5cGVzIChzZWUgYWpheC9qc29ucC5qcyBmb3IgYW4gZXhhbXBsZSlcblx0ICogMikgVGhlc2UgYXJlIGNhbGxlZDpcblx0ICogICAgLSBCRUZPUkUgYXNraW5nIGZvciBhIHRyYW5zcG9ydFxuXHQgKiAgICAtIEFGVEVSIHBhcmFtIHNlcmlhbGl6YXRpb24gKHMuZGF0YSBpcyBhIHN0cmluZyBpZiBzLnByb2Nlc3NEYXRhIGlzIHRydWUpXG5cdCAqIDMpIGtleSBpcyB0aGUgZGF0YVR5cGVcblx0ICogNCkgdGhlIGNhdGNoYWxsIHN5bWJvbCBcIipcIiBjYW4gYmUgdXNlZFxuXHQgKiA1KSBleGVjdXRpb24gd2lsbCBzdGFydCB3aXRoIHRyYW5zcG9ydCBkYXRhVHlwZSBhbmQgVEhFTiBjb250aW51ZSBkb3duIHRvIFwiKlwiIGlmIG5lZWRlZFxuXHQgKi9cblx0cHJlZmlsdGVycyA9IHt9LFxuXG5cdC8qIFRyYW5zcG9ydHMgYmluZGluZ3Ncblx0ICogMSkga2V5IGlzIHRoZSBkYXRhVHlwZVxuXHQgKiAyKSB0aGUgY2F0Y2hhbGwgc3ltYm9sIFwiKlwiIGNhbiBiZSB1c2VkXG5cdCAqIDMpIHNlbGVjdGlvbiB3aWxsIHN0YXJ0IHdpdGggdHJhbnNwb3J0IGRhdGFUeXBlIGFuZCBUSEVOIGdvIHRvIFwiKlwiIGlmIG5lZWRlZFxuXHQgKi9cblx0dHJhbnNwb3J0cyA9IHt9LFxuXG5cdC8vIEF2b2lkIGNvbW1lbnQtcHJvbG9nIGNoYXIgc2VxdWVuY2UgKCMxMDA5OCk7IG11c3QgYXBwZWFzZSBsaW50IGFuZCBldmFkZSBjb21wcmVzc2lvblxuXHRhbGxUeXBlcyA9IFwiKi9cIi5jb25jYXQoXCIqXCIpO1xuXG4vLyAjODEzOCwgSUUgbWF5IHRocm93IGFuIGV4Y2VwdGlvbiB3aGVuIGFjY2Vzc2luZ1xuLy8gYSBmaWVsZCBmcm9tIHdpbmRvdy5sb2NhdGlvbiBpZiBkb2N1bWVudC5kb21haW4gaGFzIGJlZW4gc2V0XG50cnkge1xuXHRhamF4TG9jYXRpb24gPSBsb2NhdGlvbi5ocmVmO1xufSBjYXRjaCggZSApIHtcblx0Ly8gVXNlIHRoZSBocmVmIGF0dHJpYnV0ZSBvZiBhbiBBIGVsZW1lbnRcblx0Ly8gc2luY2UgSUUgd2lsbCBtb2RpZnkgaXQgZ2l2ZW4gZG9jdW1lbnQubG9jYXRpb25cblx0YWpheExvY2F0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggXCJhXCIgKTtcblx0YWpheExvY2F0aW9uLmhyZWYgPSBcIlwiO1xuXHRhamF4TG9jYXRpb24gPSBhamF4TG9jYXRpb24uaHJlZjtcbn1cblxuLy8gU2VnbWVudCBsb2NhdGlvbiBpbnRvIHBhcnRzXG5hamF4TG9jUGFydHMgPSBydXJsLmV4ZWMoIGFqYXhMb2NhdGlvbi50b0xvd2VyQ2FzZSgpICkgfHwgW107XG5cbi8vIEJhc2UgXCJjb25zdHJ1Y3RvclwiIGZvciBqUXVlcnkuYWpheFByZWZpbHRlciBhbmQgalF1ZXJ5LmFqYXhUcmFuc3BvcnRcbmZ1bmN0aW9uIGFkZFRvUHJlZmlsdGVyc09yVHJhbnNwb3J0cyggc3RydWN0dXJlICkge1xuXG5cdC8vIGRhdGFUeXBlRXhwcmVzc2lvbiBpcyBvcHRpb25hbCBhbmQgZGVmYXVsdHMgdG8gXCIqXCJcblx0cmV0dXJuIGZ1bmN0aW9uKCBkYXRhVHlwZUV4cHJlc3Npb24sIGZ1bmMgKSB7XG5cblx0XHRpZiAoIHR5cGVvZiBkYXRhVHlwZUV4cHJlc3Npb24gIT09IFwic3RyaW5nXCIgKSB7XG5cdFx0XHRmdW5jID0gZGF0YVR5cGVFeHByZXNzaW9uO1xuXHRcdFx0ZGF0YVR5cGVFeHByZXNzaW9uID0gXCIqXCI7XG5cdFx0fVxuXG5cdFx0dmFyIGRhdGFUeXBlLFxuXHRcdFx0aSA9IDAsXG5cdFx0XHRkYXRhVHlwZXMgPSBkYXRhVHlwZUV4cHJlc3Npb24udG9Mb3dlckNhc2UoKS5tYXRjaCggcm5vdHdoaXRlICkgfHwgW107XG5cblx0XHRpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBmdW5jICkgKSB7XG5cdFx0XHQvLyBGb3IgZWFjaCBkYXRhVHlwZSBpbiB0aGUgZGF0YVR5cGVFeHByZXNzaW9uXG5cdFx0XHR3aGlsZSAoIChkYXRhVHlwZSA9IGRhdGFUeXBlc1tpKytdKSApIHtcblx0XHRcdFx0Ly8gUHJlcGVuZCBpZiByZXF1ZXN0ZWRcblx0XHRcdFx0aWYgKCBkYXRhVHlwZVswXSA9PT0gXCIrXCIgKSB7XG5cdFx0XHRcdFx0ZGF0YVR5cGUgPSBkYXRhVHlwZS5zbGljZSggMSApIHx8IFwiKlwiO1xuXHRcdFx0XHRcdChzdHJ1Y3R1cmVbIGRhdGFUeXBlIF0gPSBzdHJ1Y3R1cmVbIGRhdGFUeXBlIF0gfHwgW10pLnVuc2hpZnQoIGZ1bmMgKTtcblxuXHRcdFx0XHQvLyBPdGhlcndpc2UgYXBwZW5kXG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0KHN0cnVjdHVyZVsgZGF0YVR5cGUgXSA9IHN0cnVjdHVyZVsgZGF0YVR5cGUgXSB8fCBbXSkucHVzaCggZnVuYyApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9O1xufVxuXG4vLyBCYXNlIGluc3BlY3Rpb24gZnVuY3Rpb24gZm9yIHByZWZpbHRlcnMgYW5kIHRyYW5zcG9ydHNcbmZ1bmN0aW9uIGluc3BlY3RQcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKCBzdHJ1Y3R1cmUsIG9wdGlvbnMsIG9yaWdpbmFsT3B0aW9ucywganFYSFIgKSB7XG5cblx0dmFyIGluc3BlY3RlZCA9IHt9LFxuXHRcdHNlZWtpbmdUcmFuc3BvcnQgPSAoIHN0cnVjdHVyZSA9PT0gdHJhbnNwb3J0cyApO1xuXG5cdGZ1bmN0aW9uIGluc3BlY3QoIGRhdGFUeXBlICkge1xuXHRcdHZhciBzZWxlY3RlZDtcblx0XHRpbnNwZWN0ZWRbIGRhdGFUeXBlIF0gPSB0cnVlO1xuXHRcdGpRdWVyeS5lYWNoKCBzdHJ1Y3R1cmVbIGRhdGFUeXBlIF0gfHwgW10sIGZ1bmN0aW9uKCBfLCBwcmVmaWx0ZXJPckZhY3RvcnkgKSB7XG5cdFx0XHR2YXIgZGF0YVR5cGVPclRyYW5zcG9ydCA9IHByZWZpbHRlck9yRmFjdG9yeSggb3B0aW9ucywgb3JpZ2luYWxPcHRpb25zLCBqcVhIUiApO1xuXHRcdFx0aWYgKCB0eXBlb2YgZGF0YVR5cGVPclRyYW5zcG9ydCA9PT0gXCJzdHJpbmdcIiAmJiAhc2Vla2luZ1RyYW5zcG9ydCAmJiAhaW5zcGVjdGVkWyBkYXRhVHlwZU9yVHJhbnNwb3J0IF0gKSB7XG5cdFx0XHRcdG9wdGlvbnMuZGF0YVR5cGVzLnVuc2hpZnQoIGRhdGFUeXBlT3JUcmFuc3BvcnQgKTtcblx0XHRcdFx0aW5zcGVjdCggZGF0YVR5cGVPclRyYW5zcG9ydCApO1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9IGVsc2UgaWYgKCBzZWVraW5nVHJhbnNwb3J0ICkge1xuXHRcdFx0XHRyZXR1cm4gISggc2VsZWN0ZWQgPSBkYXRhVHlwZU9yVHJhbnNwb3J0ICk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0cmV0dXJuIHNlbGVjdGVkO1xuXHR9XG5cblx0cmV0dXJuIGluc3BlY3QoIG9wdGlvbnMuZGF0YVR5cGVzWyAwIF0gKSB8fCAhaW5zcGVjdGVkWyBcIipcIiBdICYmIGluc3BlY3QoIFwiKlwiICk7XG59XG5cbi8vIEEgc3BlY2lhbCBleHRlbmQgZm9yIGFqYXggb3B0aW9uc1xuLy8gdGhhdCB0YWtlcyBcImZsYXRcIiBvcHRpb25zIChub3QgdG8gYmUgZGVlcCBleHRlbmRlZClcbi8vIEZpeGVzICM5ODg3XG5mdW5jdGlvbiBhamF4RXh0ZW5kKCB0YXJnZXQsIHNyYyApIHtcblx0dmFyIGtleSwgZGVlcCxcblx0XHRmbGF0T3B0aW9ucyA9IGpRdWVyeS5hamF4U2V0dGluZ3MuZmxhdE9wdGlvbnMgfHwge307XG5cblx0Zm9yICgga2V5IGluIHNyYyApIHtcblx0XHRpZiAoIHNyY1sga2V5IF0gIT09IHVuZGVmaW5lZCApIHtcblx0XHRcdCggZmxhdE9wdGlvbnNbIGtleSBdID8gdGFyZ2V0IDogKCBkZWVwIHx8IChkZWVwID0ge30pICkgKVsga2V5IF0gPSBzcmNbIGtleSBdO1xuXHRcdH1cblx0fVxuXHRpZiAoIGRlZXAgKSB7XG5cdFx0alF1ZXJ5LmV4dGVuZCggdHJ1ZSwgdGFyZ2V0LCBkZWVwICk7XG5cdH1cblxuXHRyZXR1cm4gdGFyZ2V0O1xufVxuXG4vKiBIYW5kbGVzIHJlc3BvbnNlcyB0byBhbiBhamF4IHJlcXVlc3Q6XG4gKiAtIGZpbmRzIHRoZSByaWdodCBkYXRhVHlwZSAobWVkaWF0ZXMgYmV0d2VlbiBjb250ZW50LXR5cGUgYW5kIGV4cGVjdGVkIGRhdGFUeXBlKVxuICogLSByZXR1cm5zIHRoZSBjb3JyZXNwb25kaW5nIHJlc3BvbnNlXG4gKi9cbmZ1bmN0aW9uIGFqYXhIYW5kbGVSZXNwb25zZXMoIHMsIGpxWEhSLCByZXNwb25zZXMgKSB7XG5cblx0dmFyIGN0LCB0eXBlLCBmaW5hbERhdGFUeXBlLCBmaXJzdERhdGFUeXBlLFxuXHRcdGNvbnRlbnRzID0gcy5jb250ZW50cyxcblx0XHRkYXRhVHlwZXMgPSBzLmRhdGFUeXBlcztcblxuXHQvLyBSZW1vdmUgYXV0byBkYXRhVHlwZSBhbmQgZ2V0IGNvbnRlbnQtdHlwZSBpbiB0aGUgcHJvY2Vzc1xuXHR3aGlsZSAoIGRhdGFUeXBlc1sgMCBdID09PSBcIipcIiApIHtcblx0XHRkYXRhVHlwZXMuc2hpZnQoKTtcblx0XHRpZiAoIGN0ID09PSB1bmRlZmluZWQgKSB7XG5cdFx0XHRjdCA9IHMubWltZVR5cGUgfHwganFYSFIuZ2V0UmVzcG9uc2VIZWFkZXIoXCJDb250ZW50LVR5cGVcIik7XG5cdFx0fVxuXHR9XG5cblx0Ly8gQ2hlY2sgaWYgd2UncmUgZGVhbGluZyB3aXRoIGEga25vd24gY29udGVudC10eXBlXG5cdGlmICggY3QgKSB7XG5cdFx0Zm9yICggdHlwZSBpbiBjb250ZW50cyApIHtcblx0XHRcdGlmICggY29udGVudHNbIHR5cGUgXSAmJiBjb250ZW50c1sgdHlwZSBdLnRlc3QoIGN0ICkgKSB7XG5cdFx0XHRcdGRhdGFUeXBlcy51bnNoaWZ0KCB0eXBlICk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdC8vIENoZWNrIHRvIHNlZSBpZiB3ZSBoYXZlIGEgcmVzcG9uc2UgZm9yIHRoZSBleHBlY3RlZCBkYXRhVHlwZVxuXHRpZiAoIGRhdGFUeXBlc1sgMCBdIGluIHJlc3BvbnNlcyApIHtcblx0XHRmaW5hbERhdGFUeXBlID0gZGF0YVR5cGVzWyAwIF07XG5cdH0gZWxzZSB7XG5cdFx0Ly8gVHJ5IGNvbnZlcnRpYmxlIGRhdGFUeXBlc1xuXHRcdGZvciAoIHR5cGUgaW4gcmVzcG9uc2VzICkge1xuXHRcdFx0aWYgKCAhZGF0YVR5cGVzWyAwIF0gfHwgcy5jb252ZXJ0ZXJzWyB0eXBlICsgXCIgXCIgKyBkYXRhVHlwZXNbMF0gXSApIHtcblx0XHRcdFx0ZmluYWxEYXRhVHlwZSA9IHR5cGU7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdFx0aWYgKCAhZmlyc3REYXRhVHlwZSApIHtcblx0XHRcdFx0Zmlyc3REYXRhVHlwZSA9IHR5cGU7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdC8vIE9yIGp1c3QgdXNlIGZpcnN0IG9uZVxuXHRcdGZpbmFsRGF0YVR5cGUgPSBmaW5hbERhdGFUeXBlIHx8IGZpcnN0RGF0YVR5cGU7XG5cdH1cblxuXHQvLyBJZiB3ZSBmb3VuZCBhIGRhdGFUeXBlXG5cdC8vIFdlIGFkZCB0aGUgZGF0YVR5cGUgdG8gdGhlIGxpc3QgaWYgbmVlZGVkXG5cdC8vIGFuZCByZXR1cm4gdGhlIGNvcnJlc3BvbmRpbmcgcmVzcG9uc2Vcblx0aWYgKCBmaW5hbERhdGFUeXBlICkge1xuXHRcdGlmICggZmluYWxEYXRhVHlwZSAhPT0gZGF0YVR5cGVzWyAwIF0gKSB7XG5cdFx0XHRkYXRhVHlwZXMudW5zaGlmdCggZmluYWxEYXRhVHlwZSApO1xuXHRcdH1cblx0XHRyZXR1cm4gcmVzcG9uc2VzWyBmaW5hbERhdGFUeXBlIF07XG5cdH1cbn1cblxuLyogQ2hhaW4gY29udmVyc2lvbnMgZ2l2ZW4gdGhlIHJlcXVlc3QgYW5kIHRoZSBvcmlnaW5hbCByZXNwb25zZVxuICogQWxzbyBzZXRzIHRoZSByZXNwb25zZVhYWCBmaWVsZHMgb24gdGhlIGpxWEhSIGluc3RhbmNlXG4gKi9cbmZ1bmN0aW9uIGFqYXhDb252ZXJ0KCBzLCByZXNwb25zZSwganFYSFIsIGlzU3VjY2VzcyApIHtcblx0dmFyIGNvbnYyLCBjdXJyZW50LCBjb252LCB0bXAsIHByZXYsXG5cdFx0Y29udmVydGVycyA9IHt9LFxuXHRcdC8vIFdvcmsgd2l0aCBhIGNvcHkgb2YgZGF0YVR5cGVzIGluIGNhc2Ugd2UgbmVlZCB0byBtb2RpZnkgaXQgZm9yIGNvbnZlcnNpb25cblx0XHRkYXRhVHlwZXMgPSBzLmRhdGFUeXBlcy5zbGljZSgpO1xuXG5cdC8vIENyZWF0ZSBjb252ZXJ0ZXJzIG1hcCB3aXRoIGxvd2VyY2FzZWQga2V5c1xuXHRpZiAoIGRhdGFUeXBlc1sgMSBdICkge1xuXHRcdGZvciAoIGNvbnYgaW4gcy5jb252ZXJ0ZXJzICkge1xuXHRcdFx0Y29udmVydGVyc1sgY29udi50b0xvd2VyQ2FzZSgpIF0gPSBzLmNvbnZlcnRlcnNbIGNvbnYgXTtcblx0XHR9XG5cdH1cblxuXHRjdXJyZW50ID0gZGF0YVR5cGVzLnNoaWZ0KCk7XG5cblx0Ly8gQ29udmVydCB0byBlYWNoIHNlcXVlbnRpYWwgZGF0YVR5cGVcblx0d2hpbGUgKCBjdXJyZW50ICkge1xuXG5cdFx0aWYgKCBzLnJlc3BvbnNlRmllbGRzWyBjdXJyZW50IF0gKSB7XG5cdFx0XHRqcVhIUlsgcy5yZXNwb25zZUZpZWxkc1sgY3VycmVudCBdIF0gPSByZXNwb25zZTtcblx0XHR9XG5cblx0XHQvLyBBcHBseSB0aGUgZGF0YUZpbHRlciBpZiBwcm92aWRlZFxuXHRcdGlmICggIXByZXYgJiYgaXNTdWNjZXNzICYmIHMuZGF0YUZpbHRlciApIHtcblx0XHRcdHJlc3BvbnNlID0gcy5kYXRhRmlsdGVyKCByZXNwb25zZSwgcy5kYXRhVHlwZSApO1xuXHRcdH1cblxuXHRcdHByZXYgPSBjdXJyZW50O1xuXHRcdGN1cnJlbnQgPSBkYXRhVHlwZXMuc2hpZnQoKTtcblxuXHRcdGlmICggY3VycmVudCApIHtcblxuXHRcdC8vIFRoZXJlJ3Mgb25seSB3b3JrIHRvIGRvIGlmIGN1cnJlbnQgZGF0YVR5cGUgaXMgbm9uLWF1dG9cblx0XHRcdGlmICggY3VycmVudCA9PT0gXCIqXCIgKSB7XG5cblx0XHRcdFx0Y3VycmVudCA9IHByZXY7XG5cblx0XHRcdC8vIENvbnZlcnQgcmVzcG9uc2UgaWYgcHJldiBkYXRhVHlwZSBpcyBub24tYXV0byBhbmQgZGlmZmVycyBmcm9tIGN1cnJlbnRcblx0XHRcdH0gZWxzZSBpZiAoIHByZXYgIT09IFwiKlwiICYmIHByZXYgIT09IGN1cnJlbnQgKSB7XG5cblx0XHRcdFx0Ly8gU2VlayBhIGRpcmVjdCBjb252ZXJ0ZXJcblx0XHRcdFx0Y29udiA9IGNvbnZlcnRlcnNbIHByZXYgKyBcIiBcIiArIGN1cnJlbnQgXSB8fCBjb252ZXJ0ZXJzWyBcIiogXCIgKyBjdXJyZW50IF07XG5cblx0XHRcdFx0Ly8gSWYgbm9uZSBmb3VuZCwgc2VlayBhIHBhaXJcblx0XHRcdFx0aWYgKCAhY29udiApIHtcblx0XHRcdFx0XHRmb3IgKCBjb252MiBpbiBjb252ZXJ0ZXJzICkge1xuXG5cdFx0XHRcdFx0XHQvLyBJZiBjb252MiBvdXRwdXRzIGN1cnJlbnRcblx0XHRcdFx0XHRcdHRtcCA9IGNvbnYyLnNwbGl0KCBcIiBcIiApO1xuXHRcdFx0XHRcdFx0aWYgKCB0bXBbIDEgXSA9PT0gY3VycmVudCApIHtcblxuXHRcdFx0XHRcdFx0XHQvLyBJZiBwcmV2IGNhbiBiZSBjb252ZXJ0ZWQgdG8gYWNjZXB0ZWQgaW5wdXRcblx0XHRcdFx0XHRcdFx0Y29udiA9IGNvbnZlcnRlcnNbIHByZXYgKyBcIiBcIiArIHRtcFsgMCBdIF0gfHxcblx0XHRcdFx0XHRcdFx0XHRjb252ZXJ0ZXJzWyBcIiogXCIgKyB0bXBbIDAgXSBdO1xuXHRcdFx0XHRcdFx0XHRpZiAoIGNvbnYgKSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gQ29uZGVuc2UgZXF1aXZhbGVuY2UgY29udmVydGVyc1xuXHRcdFx0XHRcdFx0XHRcdGlmICggY29udiA9PT0gdHJ1ZSApIHtcblx0XHRcdFx0XHRcdFx0XHRcdGNvbnYgPSBjb252ZXJ0ZXJzWyBjb252MiBdO1xuXG5cdFx0XHRcdFx0XHRcdFx0Ly8gT3RoZXJ3aXNlLCBpbnNlcnQgdGhlIGludGVybWVkaWF0ZSBkYXRhVHlwZVxuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoIGNvbnZlcnRlcnNbIGNvbnYyIF0gIT09IHRydWUgKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRjdXJyZW50ID0gdG1wWyAwIF07XG5cdFx0XHRcdFx0XHRcdFx0XHRkYXRhVHlwZXMudW5zaGlmdCggdG1wWyAxIF0gKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBBcHBseSBjb252ZXJ0ZXIgKGlmIG5vdCBhbiBlcXVpdmFsZW5jZSlcblx0XHRcdFx0aWYgKCBjb252ICE9PSB0cnVlICkge1xuXG5cdFx0XHRcdFx0Ly8gVW5sZXNzIGVycm9ycyBhcmUgYWxsb3dlZCB0byBidWJibGUsIGNhdGNoIGFuZCByZXR1cm4gdGhlbVxuXHRcdFx0XHRcdGlmICggY29udiAmJiBzWyBcInRocm93c1wiIF0gKSB7XG5cdFx0XHRcdFx0XHRyZXNwb25zZSA9IGNvbnYoIHJlc3BvbnNlICk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdHJlc3BvbnNlID0gY29udiggcmVzcG9uc2UgKTtcblx0XHRcdFx0XHRcdH0gY2F0Y2ggKCBlICkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4geyBzdGF0ZTogXCJwYXJzZXJlcnJvclwiLCBlcnJvcjogY29udiA/IGUgOiBcIk5vIGNvbnZlcnNpb24gZnJvbSBcIiArIHByZXYgKyBcIiB0byBcIiArIGN1cnJlbnQgfTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRyZXR1cm4geyBzdGF0ZTogXCJzdWNjZXNzXCIsIGRhdGE6IHJlc3BvbnNlIH07XG59XG5cbmpRdWVyeS5leHRlbmQoe1xuXG5cdC8vIENvdW50ZXIgZm9yIGhvbGRpbmcgdGhlIG51bWJlciBvZiBhY3RpdmUgcXVlcmllc1xuXHRhY3RpdmU6IDAsXG5cblx0Ly8gTGFzdC1Nb2RpZmllZCBoZWFkZXIgY2FjaGUgZm9yIG5leHQgcmVxdWVzdFxuXHRsYXN0TW9kaWZpZWQ6IHt9LFxuXHRldGFnOiB7fSxcblxuXHRhamF4U2V0dGluZ3M6IHtcblx0XHR1cmw6IGFqYXhMb2NhdGlvbixcblx0XHR0eXBlOiBcIkdFVFwiLFxuXHRcdGlzTG9jYWw6IHJsb2NhbFByb3RvY29sLnRlc3QoIGFqYXhMb2NQYXJ0c1sgMSBdICksXG5cdFx0Z2xvYmFsOiB0cnVlLFxuXHRcdHByb2Nlc3NEYXRhOiB0cnVlLFxuXHRcdGFzeW5jOiB0cnVlLFxuXHRcdGNvbnRlbnRUeXBlOiBcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD1VVEYtOFwiLFxuXHRcdC8qXG5cdFx0dGltZW91dDogMCxcblx0XHRkYXRhOiBudWxsLFxuXHRcdGRhdGFUeXBlOiBudWxsLFxuXHRcdHVzZXJuYW1lOiBudWxsLFxuXHRcdHBhc3N3b3JkOiBudWxsLFxuXHRcdGNhY2hlOiBudWxsLFxuXHRcdHRocm93czogZmFsc2UsXG5cdFx0dHJhZGl0aW9uYWw6IGZhbHNlLFxuXHRcdGhlYWRlcnM6IHt9LFxuXHRcdCovXG5cblx0XHRhY2NlcHRzOiB7XG5cdFx0XHRcIipcIjogYWxsVHlwZXMsXG5cdFx0XHR0ZXh0OiBcInRleHQvcGxhaW5cIixcblx0XHRcdGh0bWw6IFwidGV4dC9odG1sXCIsXG5cdFx0XHR4bWw6IFwiYXBwbGljYXRpb24veG1sLCB0ZXh0L3htbFwiLFxuXHRcdFx0anNvbjogXCJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L2phdmFzY3JpcHRcIlxuXHRcdH0sXG5cblx0XHRjb250ZW50czoge1xuXHRcdFx0eG1sOiAveG1sLyxcblx0XHRcdGh0bWw6IC9odG1sLyxcblx0XHRcdGpzb246IC9qc29uL1xuXHRcdH0sXG5cblx0XHRyZXNwb25zZUZpZWxkczoge1xuXHRcdFx0eG1sOiBcInJlc3BvbnNlWE1MXCIsXG5cdFx0XHR0ZXh0OiBcInJlc3BvbnNlVGV4dFwiLFxuXHRcdFx0anNvbjogXCJyZXNwb25zZUpTT05cIlxuXHRcdH0sXG5cblx0XHQvLyBEYXRhIGNvbnZlcnRlcnNcblx0XHQvLyBLZXlzIHNlcGFyYXRlIHNvdXJjZSAob3IgY2F0Y2hhbGwgXCIqXCIpIGFuZCBkZXN0aW5hdGlvbiB0eXBlcyB3aXRoIGEgc2luZ2xlIHNwYWNlXG5cdFx0Y29udmVydGVyczoge1xuXG5cdFx0XHQvLyBDb252ZXJ0IGFueXRoaW5nIHRvIHRleHRcblx0XHRcdFwiKiB0ZXh0XCI6IFN0cmluZyxcblxuXHRcdFx0Ly8gVGV4dCB0byBodG1sICh0cnVlID0gbm8gdHJhbnNmb3JtYXRpb24pXG5cdFx0XHRcInRleHQgaHRtbFwiOiB0cnVlLFxuXG5cdFx0XHQvLyBFdmFsdWF0ZSB0ZXh0IGFzIGEganNvbiBleHByZXNzaW9uXG5cdFx0XHRcInRleHQganNvblwiOiBqUXVlcnkucGFyc2VKU09OLFxuXG5cdFx0XHQvLyBQYXJzZSB0ZXh0IGFzIHhtbFxuXHRcdFx0XCJ0ZXh0IHhtbFwiOiBqUXVlcnkucGFyc2VYTUxcblx0XHR9LFxuXG5cdFx0Ly8gRm9yIG9wdGlvbnMgdGhhdCBzaG91bGRuJ3QgYmUgZGVlcCBleHRlbmRlZDpcblx0XHQvLyB5b3UgY2FuIGFkZCB5b3VyIG93biBjdXN0b20gb3B0aW9ucyBoZXJlIGlmXG5cdFx0Ly8gYW5kIHdoZW4geW91IGNyZWF0ZSBvbmUgdGhhdCBzaG91bGRuJ3QgYmVcblx0XHQvLyBkZWVwIGV4dGVuZGVkIChzZWUgYWpheEV4dGVuZClcblx0XHRmbGF0T3B0aW9uczoge1xuXHRcdFx0dXJsOiB0cnVlLFxuXHRcdFx0Y29udGV4dDogdHJ1ZVxuXHRcdH1cblx0fSxcblxuXHQvLyBDcmVhdGVzIGEgZnVsbCBmbGVkZ2VkIHNldHRpbmdzIG9iamVjdCBpbnRvIHRhcmdldFxuXHQvLyB3aXRoIGJvdGggYWpheFNldHRpbmdzIGFuZCBzZXR0aW5ncyBmaWVsZHMuXG5cdC8vIElmIHRhcmdldCBpcyBvbWl0dGVkLCB3cml0ZXMgaW50byBhamF4U2V0dGluZ3MuXG5cdGFqYXhTZXR1cDogZnVuY3Rpb24oIHRhcmdldCwgc2V0dGluZ3MgKSB7XG5cdFx0cmV0dXJuIHNldHRpbmdzID9cblxuXHRcdFx0Ly8gQnVpbGRpbmcgYSBzZXR0aW5ncyBvYmplY3Rcblx0XHRcdGFqYXhFeHRlbmQoIGFqYXhFeHRlbmQoIHRhcmdldCwgalF1ZXJ5LmFqYXhTZXR0aW5ncyApLCBzZXR0aW5ncyApIDpcblxuXHRcdFx0Ly8gRXh0ZW5kaW5nIGFqYXhTZXR0aW5nc1xuXHRcdFx0YWpheEV4dGVuZCggalF1ZXJ5LmFqYXhTZXR0aW5ncywgdGFyZ2V0ICk7XG5cdH0sXG5cblx0YWpheFByZWZpbHRlcjogYWRkVG9QcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKCBwcmVmaWx0ZXJzICksXG5cdGFqYXhUcmFuc3BvcnQ6IGFkZFRvUHJlZmlsdGVyc09yVHJhbnNwb3J0cyggdHJhbnNwb3J0cyApLFxuXG5cdC8vIE1haW4gbWV0aG9kXG5cdGFqYXg6IGZ1bmN0aW9uKCB1cmwsIG9wdGlvbnMgKSB7XG5cblx0XHQvLyBJZiB1cmwgaXMgYW4gb2JqZWN0LCBzaW11bGF0ZSBwcmUtMS41IHNpZ25hdHVyZVxuXHRcdGlmICggdHlwZW9mIHVybCA9PT0gXCJvYmplY3RcIiApIHtcblx0XHRcdG9wdGlvbnMgPSB1cmw7XG5cdFx0XHR1cmwgPSB1bmRlZmluZWQ7XG5cdFx0fVxuXG5cdFx0Ly8gRm9yY2Ugb3B0aW9ucyB0byBiZSBhbiBvYmplY3Rcblx0XHRvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblxuXHRcdHZhciB0cmFuc3BvcnQsXG5cdFx0XHQvLyBVUkwgd2l0aG91dCBhbnRpLWNhY2hlIHBhcmFtXG5cdFx0XHRjYWNoZVVSTCxcblx0XHRcdC8vIFJlc3BvbnNlIGhlYWRlcnNcblx0XHRcdHJlc3BvbnNlSGVhZGVyc1N0cmluZyxcblx0XHRcdHJlc3BvbnNlSGVhZGVycyxcblx0XHRcdC8vIHRpbWVvdXQgaGFuZGxlXG5cdFx0XHR0aW1lb3V0VGltZXIsXG5cdFx0XHQvLyBDcm9zcy1kb21haW4gZGV0ZWN0aW9uIHZhcnNcblx0XHRcdHBhcnRzLFxuXHRcdFx0Ly8gVG8ga25vdyBpZiBnbG9iYWwgZXZlbnRzIGFyZSB0byBiZSBkaXNwYXRjaGVkXG5cdFx0XHRmaXJlR2xvYmFscyxcblx0XHRcdC8vIExvb3AgdmFyaWFibGVcblx0XHRcdGksXG5cdFx0XHQvLyBDcmVhdGUgdGhlIGZpbmFsIG9wdGlvbnMgb2JqZWN0XG5cdFx0XHRzID0galF1ZXJ5LmFqYXhTZXR1cCgge30sIG9wdGlvbnMgKSxcblx0XHRcdC8vIENhbGxiYWNrcyBjb250ZXh0XG5cdFx0XHRjYWxsYmFja0NvbnRleHQgPSBzLmNvbnRleHQgfHwgcyxcblx0XHRcdC8vIENvbnRleHQgZm9yIGdsb2JhbCBldmVudHMgaXMgY2FsbGJhY2tDb250ZXh0IGlmIGl0IGlzIGEgRE9NIG5vZGUgb3IgalF1ZXJ5IGNvbGxlY3Rpb25cblx0XHRcdGdsb2JhbEV2ZW50Q29udGV4dCA9IHMuY29udGV4dCAmJiAoIGNhbGxiYWNrQ29udGV4dC5ub2RlVHlwZSB8fCBjYWxsYmFja0NvbnRleHQuanF1ZXJ5ICkgP1xuXHRcdFx0XHRqUXVlcnkoIGNhbGxiYWNrQ29udGV4dCApIDpcblx0XHRcdFx0alF1ZXJ5LmV2ZW50LFxuXHRcdFx0Ly8gRGVmZXJyZWRzXG5cdFx0XHRkZWZlcnJlZCA9IGpRdWVyeS5EZWZlcnJlZCgpLFxuXHRcdFx0Y29tcGxldGVEZWZlcnJlZCA9IGpRdWVyeS5DYWxsYmFja3MoXCJvbmNlIG1lbW9yeVwiKSxcblx0XHRcdC8vIFN0YXR1cy1kZXBlbmRlbnQgY2FsbGJhY2tzXG5cdFx0XHRzdGF0dXNDb2RlID0gcy5zdGF0dXNDb2RlIHx8IHt9LFxuXHRcdFx0Ly8gSGVhZGVycyAodGhleSBhcmUgc2VudCBhbGwgYXQgb25jZSlcblx0XHRcdHJlcXVlc3RIZWFkZXJzID0ge30sXG5cdFx0XHRyZXF1ZXN0SGVhZGVyc05hbWVzID0ge30sXG5cdFx0XHQvLyBUaGUganFYSFIgc3RhdGVcblx0XHRcdHN0YXRlID0gMCxcblx0XHRcdC8vIERlZmF1bHQgYWJvcnQgbWVzc2FnZVxuXHRcdFx0c3RyQWJvcnQgPSBcImNhbmNlbGVkXCIsXG5cdFx0XHQvLyBGYWtlIHhoclxuXHRcdFx0anFYSFIgPSB7XG5cdFx0XHRcdHJlYWR5U3RhdGU6IDAsXG5cblx0XHRcdFx0Ly8gQnVpbGRzIGhlYWRlcnMgaGFzaHRhYmxlIGlmIG5lZWRlZFxuXHRcdFx0XHRnZXRSZXNwb25zZUhlYWRlcjogZnVuY3Rpb24oIGtleSApIHtcblx0XHRcdFx0XHR2YXIgbWF0Y2g7XG5cdFx0XHRcdFx0aWYgKCBzdGF0ZSA9PT0gMiApIHtcblx0XHRcdFx0XHRcdGlmICggIXJlc3BvbnNlSGVhZGVycyApIHtcblx0XHRcdFx0XHRcdFx0cmVzcG9uc2VIZWFkZXJzID0ge307XG5cdFx0XHRcdFx0XHRcdHdoaWxlICggKG1hdGNoID0gcmhlYWRlcnMuZXhlYyggcmVzcG9uc2VIZWFkZXJzU3RyaW5nICkpICkge1xuXHRcdFx0XHRcdFx0XHRcdHJlc3BvbnNlSGVhZGVyc1sgbWF0Y2hbMV0udG9Mb3dlckNhc2UoKSBdID0gbWF0Y2hbIDIgXTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0bWF0Y2ggPSByZXNwb25zZUhlYWRlcnNbIGtleS50b0xvd2VyQ2FzZSgpIF07XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybiBtYXRjaCA9PSBudWxsID8gbnVsbCA6IG1hdGNoO1xuXHRcdFx0XHR9LFxuXG5cdFx0XHRcdC8vIFJhdyBzdHJpbmdcblx0XHRcdFx0Z2V0QWxsUmVzcG9uc2VIZWFkZXJzOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRyZXR1cm4gc3RhdGUgPT09IDIgPyByZXNwb25zZUhlYWRlcnNTdHJpbmcgOiBudWxsO1xuXHRcdFx0XHR9LFxuXG5cdFx0XHRcdC8vIENhY2hlcyB0aGUgaGVhZGVyXG5cdFx0XHRcdHNldFJlcXVlc3RIZWFkZXI6IGZ1bmN0aW9uKCBuYW1lLCB2YWx1ZSApIHtcblx0XHRcdFx0XHR2YXIgbG5hbWUgPSBuYW1lLnRvTG93ZXJDYXNlKCk7XG5cdFx0XHRcdFx0aWYgKCAhc3RhdGUgKSB7XG5cdFx0XHRcdFx0XHRuYW1lID0gcmVxdWVzdEhlYWRlcnNOYW1lc1sgbG5hbWUgXSA9IHJlcXVlc3RIZWFkZXJzTmFtZXNbIGxuYW1lIF0gfHwgbmFtZTtcblx0XHRcdFx0XHRcdHJlcXVlc3RIZWFkZXJzWyBuYW1lIF0gPSB2YWx1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHRcdH0sXG5cblx0XHRcdFx0Ly8gT3ZlcnJpZGVzIHJlc3BvbnNlIGNvbnRlbnQtdHlwZSBoZWFkZXJcblx0XHRcdFx0b3ZlcnJpZGVNaW1lVHlwZTogZnVuY3Rpb24oIHR5cGUgKSB7XG5cdFx0XHRcdFx0aWYgKCAhc3RhdGUgKSB7XG5cdFx0XHRcdFx0XHRzLm1pbWVUeXBlID0gdHlwZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHRcdH0sXG5cblx0XHRcdFx0Ly8gU3RhdHVzLWRlcGVuZGVudCBjYWxsYmFja3Ncblx0XHRcdFx0c3RhdHVzQ29kZTogZnVuY3Rpb24oIG1hcCApIHtcblx0XHRcdFx0XHR2YXIgY29kZTtcblx0XHRcdFx0XHRpZiAoIG1hcCApIHtcblx0XHRcdFx0XHRcdGlmICggc3RhdGUgPCAyICkge1xuXHRcdFx0XHRcdFx0XHRmb3IgKCBjb2RlIGluIG1hcCApIHtcblx0XHRcdFx0XHRcdFx0XHQvLyBMYXp5LWFkZCB0aGUgbmV3IGNhbGxiYWNrIGluIGEgd2F5IHRoYXQgcHJlc2VydmVzIG9sZCBvbmVzXG5cdFx0XHRcdFx0XHRcdFx0c3RhdHVzQ29kZVsgY29kZSBdID0gWyBzdGF0dXNDb2RlWyBjb2RlIF0sIG1hcFsgY29kZSBdIF07XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdC8vIEV4ZWN1dGUgdGhlIGFwcHJvcHJpYXRlIGNhbGxiYWNrc1xuXHRcdFx0XHRcdFx0XHRqcVhIUi5hbHdheXMoIG1hcFsganFYSFIuc3RhdHVzIF0gKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHRcdH0sXG5cblx0XHRcdFx0Ly8gQ2FuY2VsIHRoZSByZXF1ZXN0XG5cdFx0XHRcdGFib3J0OiBmdW5jdGlvbiggc3RhdHVzVGV4dCApIHtcblx0XHRcdFx0XHR2YXIgZmluYWxUZXh0ID0gc3RhdHVzVGV4dCB8fCBzdHJBYm9ydDtcblx0XHRcdFx0XHRpZiAoIHRyYW5zcG9ydCApIHtcblx0XHRcdFx0XHRcdHRyYW5zcG9ydC5hYm9ydCggZmluYWxUZXh0ICk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGRvbmUoIDAsIGZpbmFsVGV4dCApO1xuXHRcdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXG5cdFx0Ly8gQXR0YWNoIGRlZmVycmVkc1xuXHRcdGRlZmVycmVkLnByb21pc2UoIGpxWEhSICkuY29tcGxldGUgPSBjb21wbGV0ZURlZmVycmVkLmFkZDtcblx0XHRqcVhIUi5zdWNjZXNzID0ganFYSFIuZG9uZTtcblx0XHRqcVhIUi5lcnJvciA9IGpxWEhSLmZhaWw7XG5cblx0XHQvLyBSZW1vdmUgaGFzaCBjaGFyYWN0ZXIgKCM3NTMxOiBhbmQgc3RyaW5nIHByb21vdGlvbilcblx0XHQvLyBBZGQgcHJvdG9jb2wgaWYgbm90IHByb3ZpZGVkIChwcmVmaWx0ZXJzIG1pZ2h0IGV4cGVjdCBpdClcblx0XHQvLyBIYW5kbGUgZmFsc3kgdXJsIGluIHRoZSBzZXR0aW5ncyBvYmplY3QgKCMxMDA5MzogY29uc2lzdGVuY3kgd2l0aCBvbGQgc2lnbmF0dXJlKVxuXHRcdC8vIFdlIGFsc28gdXNlIHRoZSB1cmwgcGFyYW1ldGVyIGlmIGF2YWlsYWJsZVxuXHRcdHMudXJsID0gKCAoIHVybCB8fCBzLnVybCB8fCBhamF4TG9jYXRpb24gKSArIFwiXCIgKS5yZXBsYWNlKCByaGFzaCwgXCJcIiApXG5cdFx0XHQucmVwbGFjZSggcnByb3RvY29sLCBhamF4TG9jUGFydHNbIDEgXSArIFwiLy9cIiApO1xuXG5cdFx0Ly8gQWxpYXMgbWV0aG9kIG9wdGlvbiB0byB0eXBlIGFzIHBlciB0aWNrZXQgIzEyMDA0XG5cdFx0cy50eXBlID0gb3B0aW9ucy5tZXRob2QgfHwgb3B0aW9ucy50eXBlIHx8IHMubWV0aG9kIHx8IHMudHlwZTtcblxuXHRcdC8vIEV4dHJhY3QgZGF0YVR5cGVzIGxpc3Rcblx0XHRzLmRhdGFUeXBlcyA9IGpRdWVyeS50cmltKCBzLmRhdGFUeXBlIHx8IFwiKlwiICkudG9Mb3dlckNhc2UoKS5tYXRjaCggcm5vdHdoaXRlICkgfHwgWyBcIlwiIF07XG5cblx0XHQvLyBBIGNyb3NzLWRvbWFpbiByZXF1ZXN0IGlzIGluIG9yZGVyIHdoZW4gd2UgaGF2ZSBhIHByb3RvY29sOmhvc3Q6cG9ydCBtaXNtYXRjaFxuXHRcdGlmICggcy5jcm9zc0RvbWFpbiA9PSBudWxsICkge1xuXHRcdFx0cGFydHMgPSBydXJsLmV4ZWMoIHMudXJsLnRvTG93ZXJDYXNlKCkgKTtcblx0XHRcdHMuY3Jvc3NEb21haW4gPSAhISggcGFydHMgJiZcblx0XHRcdFx0KCBwYXJ0c1sgMSBdICE9PSBhamF4TG9jUGFydHNbIDEgXSB8fCBwYXJ0c1sgMiBdICE9PSBhamF4TG9jUGFydHNbIDIgXSB8fFxuXHRcdFx0XHRcdCggcGFydHNbIDMgXSB8fCAoIHBhcnRzWyAxIF0gPT09IFwiaHR0cDpcIiA/IFwiODBcIiA6IFwiNDQzXCIgKSApICE9PVxuXHRcdFx0XHRcdFx0KCBhamF4TG9jUGFydHNbIDMgXSB8fCAoIGFqYXhMb2NQYXJ0c1sgMSBdID09PSBcImh0dHA6XCIgPyBcIjgwXCIgOiBcIjQ0M1wiICkgKSApXG5cdFx0XHQpO1xuXHRcdH1cblxuXHRcdC8vIENvbnZlcnQgZGF0YSBpZiBub3QgYWxyZWFkeSBhIHN0cmluZ1xuXHRcdGlmICggcy5kYXRhICYmIHMucHJvY2Vzc0RhdGEgJiYgdHlwZW9mIHMuZGF0YSAhPT0gXCJzdHJpbmdcIiApIHtcblx0XHRcdHMuZGF0YSA9IGpRdWVyeS5wYXJhbSggcy5kYXRhLCBzLnRyYWRpdGlvbmFsICk7XG5cdFx0fVxuXG5cdFx0Ly8gQXBwbHkgcHJlZmlsdGVyc1xuXHRcdGluc3BlY3RQcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKCBwcmVmaWx0ZXJzLCBzLCBvcHRpb25zLCBqcVhIUiApO1xuXG5cdFx0Ly8gSWYgcmVxdWVzdCB3YXMgYWJvcnRlZCBpbnNpZGUgYSBwcmVmaWx0ZXIsIHN0b3AgdGhlcmVcblx0XHRpZiAoIHN0YXRlID09PSAyICkge1xuXHRcdFx0cmV0dXJuIGpxWEhSO1xuXHRcdH1cblxuXHRcdC8vIFdlIGNhbiBmaXJlIGdsb2JhbCBldmVudHMgYXMgb2Ygbm93IGlmIGFza2VkIHRvXG5cdFx0ZmlyZUdsb2JhbHMgPSBzLmdsb2JhbDtcblxuXHRcdC8vIFdhdGNoIGZvciBhIG5ldyBzZXQgb2YgcmVxdWVzdHNcblx0XHRpZiAoIGZpcmVHbG9iYWxzICYmIGpRdWVyeS5hY3RpdmUrKyA9PT0gMCApIHtcblx0XHRcdGpRdWVyeS5ldmVudC50cmlnZ2VyKFwiYWpheFN0YXJ0XCIpO1xuXHRcdH1cblxuXHRcdC8vIFVwcGVyY2FzZSB0aGUgdHlwZVxuXHRcdHMudHlwZSA9IHMudHlwZS50b1VwcGVyQ2FzZSgpO1xuXG5cdFx0Ly8gRGV0ZXJtaW5lIGlmIHJlcXVlc3QgaGFzIGNvbnRlbnRcblx0XHRzLmhhc0NvbnRlbnQgPSAhcm5vQ29udGVudC50ZXN0KCBzLnR5cGUgKTtcblxuXHRcdC8vIFNhdmUgdGhlIFVSTCBpbiBjYXNlIHdlJ3JlIHRveWluZyB3aXRoIHRoZSBJZi1Nb2RpZmllZC1TaW5jZVxuXHRcdC8vIGFuZC9vciBJZi1Ob25lLU1hdGNoIGhlYWRlciBsYXRlciBvblxuXHRcdGNhY2hlVVJMID0gcy51cmw7XG5cblx0XHQvLyBNb3JlIG9wdGlvbnMgaGFuZGxpbmcgZm9yIHJlcXVlc3RzIHdpdGggbm8gY29udGVudFxuXHRcdGlmICggIXMuaGFzQ29udGVudCApIHtcblxuXHRcdFx0Ly8gSWYgZGF0YSBpcyBhdmFpbGFibGUsIGFwcGVuZCBkYXRhIHRvIHVybFxuXHRcdFx0aWYgKCBzLmRhdGEgKSB7XG5cdFx0XHRcdGNhY2hlVVJMID0gKCBzLnVybCArPSAoIHJxdWVyeS50ZXN0KCBjYWNoZVVSTCApID8gXCImXCIgOiBcIj9cIiApICsgcy5kYXRhICk7XG5cdFx0XHRcdC8vICM5NjgyOiByZW1vdmUgZGF0YSBzbyB0aGF0IGl0J3Mgbm90IHVzZWQgaW4gYW4gZXZlbnR1YWwgcmV0cnlcblx0XHRcdFx0ZGVsZXRlIHMuZGF0YTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQWRkIGFudGktY2FjaGUgaW4gdXJsIGlmIG5lZWRlZFxuXHRcdFx0aWYgKCBzLmNhY2hlID09PSBmYWxzZSApIHtcblx0XHRcdFx0cy51cmwgPSBydHMudGVzdCggY2FjaGVVUkwgKSA/XG5cblx0XHRcdFx0XHQvLyBJZiB0aGVyZSBpcyBhbHJlYWR5IGEgJ18nIHBhcmFtZXRlciwgc2V0IGl0cyB2YWx1ZVxuXHRcdFx0XHRcdGNhY2hlVVJMLnJlcGxhY2UoIHJ0cywgXCIkMV89XCIgKyBub25jZSsrICkgOlxuXG5cdFx0XHRcdFx0Ly8gT3RoZXJ3aXNlIGFkZCBvbmUgdG8gdGhlIGVuZFxuXHRcdFx0XHRcdGNhY2hlVVJMICsgKCBycXVlcnkudGVzdCggY2FjaGVVUkwgKSA/IFwiJlwiIDogXCI/XCIgKSArIFwiXz1cIiArIG5vbmNlKys7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gU2V0IHRoZSBJZi1Nb2RpZmllZC1TaW5jZSBhbmQvb3IgSWYtTm9uZS1NYXRjaCBoZWFkZXIsIGlmIGluIGlmTW9kaWZpZWQgbW9kZS5cblx0XHRpZiAoIHMuaWZNb2RpZmllZCApIHtcblx0XHRcdGlmICggalF1ZXJ5Lmxhc3RNb2RpZmllZFsgY2FjaGVVUkwgXSApIHtcblx0XHRcdFx0anFYSFIuc2V0UmVxdWVzdEhlYWRlciggXCJJZi1Nb2RpZmllZC1TaW5jZVwiLCBqUXVlcnkubGFzdE1vZGlmaWVkWyBjYWNoZVVSTCBdICk7XG5cdFx0XHR9XG5cdFx0XHRpZiAoIGpRdWVyeS5ldGFnWyBjYWNoZVVSTCBdICkge1xuXHRcdFx0XHRqcVhIUi5zZXRSZXF1ZXN0SGVhZGVyKCBcIklmLU5vbmUtTWF0Y2hcIiwgalF1ZXJ5LmV0YWdbIGNhY2hlVVJMIF0gKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBTZXQgdGhlIGNvcnJlY3QgaGVhZGVyLCBpZiBkYXRhIGlzIGJlaW5nIHNlbnRcblx0XHRpZiAoIHMuZGF0YSAmJiBzLmhhc0NvbnRlbnQgJiYgcy5jb250ZW50VHlwZSAhPT0gZmFsc2UgfHwgb3B0aW9ucy5jb250ZW50VHlwZSApIHtcblx0XHRcdGpxWEhSLnNldFJlcXVlc3RIZWFkZXIoIFwiQ29udGVudC1UeXBlXCIsIHMuY29udGVudFR5cGUgKTtcblx0XHR9XG5cblx0XHQvLyBTZXQgdGhlIEFjY2VwdHMgaGVhZGVyIGZvciB0aGUgc2VydmVyLCBkZXBlbmRpbmcgb24gdGhlIGRhdGFUeXBlXG5cdFx0anFYSFIuc2V0UmVxdWVzdEhlYWRlcihcblx0XHRcdFwiQWNjZXB0XCIsXG5cdFx0XHRzLmRhdGFUeXBlc1sgMCBdICYmIHMuYWNjZXB0c1sgcy5kYXRhVHlwZXNbMF0gXSA/XG5cdFx0XHRcdHMuYWNjZXB0c1sgcy5kYXRhVHlwZXNbMF0gXSArICggcy5kYXRhVHlwZXNbIDAgXSAhPT0gXCIqXCIgPyBcIiwgXCIgKyBhbGxUeXBlcyArIFwiOyBxPTAuMDFcIiA6IFwiXCIgKSA6XG5cdFx0XHRcdHMuYWNjZXB0c1sgXCIqXCIgXVxuXHRcdCk7XG5cblx0XHQvLyBDaGVjayBmb3IgaGVhZGVycyBvcHRpb25cblx0XHRmb3IgKCBpIGluIHMuaGVhZGVycyApIHtcblx0XHRcdGpxWEhSLnNldFJlcXVlc3RIZWFkZXIoIGksIHMuaGVhZGVyc1sgaSBdICk7XG5cdFx0fVxuXG5cdFx0Ly8gQWxsb3cgY3VzdG9tIGhlYWRlcnMvbWltZXR5cGVzIGFuZCBlYXJseSBhYm9ydFxuXHRcdGlmICggcy5iZWZvcmVTZW5kICYmICggcy5iZWZvcmVTZW5kLmNhbGwoIGNhbGxiYWNrQ29udGV4dCwganFYSFIsIHMgKSA9PT0gZmFsc2UgfHwgc3RhdGUgPT09IDIgKSApIHtcblx0XHRcdC8vIEFib3J0IGlmIG5vdCBkb25lIGFscmVhZHkgYW5kIHJldHVyblxuXHRcdFx0cmV0dXJuIGpxWEhSLmFib3J0KCk7XG5cdFx0fVxuXG5cdFx0Ly8gYWJvcnRpbmcgaXMgbm8gbG9uZ2VyIGEgY2FuY2VsbGF0aW9uXG5cdFx0c3RyQWJvcnQgPSBcImFib3J0XCI7XG5cblx0XHQvLyBJbnN0YWxsIGNhbGxiYWNrcyBvbiBkZWZlcnJlZHNcblx0XHRmb3IgKCBpIGluIHsgc3VjY2VzczogMSwgZXJyb3I6IDEsIGNvbXBsZXRlOiAxIH0gKSB7XG5cdFx0XHRqcVhIUlsgaSBdKCBzWyBpIF0gKTtcblx0XHR9XG5cblx0XHQvLyBHZXQgdHJhbnNwb3J0XG5cdFx0dHJhbnNwb3J0ID0gaW5zcGVjdFByZWZpbHRlcnNPclRyYW5zcG9ydHMoIHRyYW5zcG9ydHMsIHMsIG9wdGlvbnMsIGpxWEhSICk7XG5cblx0XHQvLyBJZiBubyB0cmFuc3BvcnQsIHdlIGF1dG8tYWJvcnRcblx0XHRpZiAoICF0cmFuc3BvcnQgKSB7XG5cdFx0XHRkb25lKCAtMSwgXCJObyBUcmFuc3BvcnRcIiApO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRqcVhIUi5yZWFkeVN0YXRlID0gMTtcblxuXHRcdFx0Ly8gU2VuZCBnbG9iYWwgZXZlbnRcblx0XHRcdGlmICggZmlyZUdsb2JhbHMgKSB7XG5cdFx0XHRcdGdsb2JhbEV2ZW50Q29udGV4dC50cmlnZ2VyKCBcImFqYXhTZW5kXCIsIFsganFYSFIsIHMgXSApO1xuXHRcdFx0fVxuXHRcdFx0Ly8gVGltZW91dFxuXHRcdFx0aWYgKCBzLmFzeW5jICYmIHMudGltZW91dCA+IDAgKSB7XG5cdFx0XHRcdHRpbWVvdXRUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0anFYSFIuYWJvcnQoXCJ0aW1lb3V0XCIpO1xuXHRcdFx0XHR9LCBzLnRpbWVvdXQgKTtcblx0XHRcdH1cblxuXHRcdFx0dHJ5IHtcblx0XHRcdFx0c3RhdGUgPSAxO1xuXHRcdFx0XHR0cmFuc3BvcnQuc2VuZCggcmVxdWVzdEhlYWRlcnMsIGRvbmUgKTtcblx0XHRcdH0gY2F0Y2ggKCBlICkge1xuXHRcdFx0XHQvLyBQcm9wYWdhdGUgZXhjZXB0aW9uIGFzIGVycm9yIGlmIG5vdCBkb25lXG5cdFx0XHRcdGlmICggc3RhdGUgPCAyICkge1xuXHRcdFx0XHRcdGRvbmUoIC0xLCBlICk7XG5cdFx0XHRcdC8vIFNpbXBseSByZXRocm93IG90aGVyd2lzZVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHRocm93IGU7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBDYWxsYmFjayBmb3Igd2hlbiBldmVyeXRoaW5nIGlzIGRvbmVcblx0XHRmdW5jdGlvbiBkb25lKCBzdGF0dXMsIG5hdGl2ZVN0YXR1c1RleHQsIHJlc3BvbnNlcywgaGVhZGVycyApIHtcblx0XHRcdHZhciBpc1N1Y2Nlc3MsIHN1Y2Nlc3MsIGVycm9yLCByZXNwb25zZSwgbW9kaWZpZWQsXG5cdFx0XHRcdHN0YXR1c1RleHQgPSBuYXRpdmVTdGF0dXNUZXh0O1xuXG5cdFx0XHQvLyBDYWxsZWQgb25jZVxuXHRcdFx0aWYgKCBzdGF0ZSA9PT0gMiApIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBTdGF0ZSBpcyBcImRvbmVcIiBub3dcblx0XHRcdHN0YXRlID0gMjtcblxuXHRcdFx0Ly8gQ2xlYXIgdGltZW91dCBpZiBpdCBleGlzdHNcblx0XHRcdGlmICggdGltZW91dFRpbWVyICkge1xuXHRcdFx0XHRjbGVhclRpbWVvdXQoIHRpbWVvdXRUaW1lciApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBEZXJlZmVyZW5jZSB0cmFuc3BvcnQgZm9yIGVhcmx5IGdhcmJhZ2UgY29sbGVjdGlvblxuXHRcdFx0Ly8gKG5vIG1hdHRlciBob3cgbG9uZyB0aGUganFYSFIgb2JqZWN0IHdpbGwgYmUgdXNlZClcblx0XHRcdHRyYW5zcG9ydCA9IHVuZGVmaW5lZDtcblxuXHRcdFx0Ly8gQ2FjaGUgcmVzcG9uc2UgaGVhZGVyc1xuXHRcdFx0cmVzcG9uc2VIZWFkZXJzU3RyaW5nID0gaGVhZGVycyB8fCBcIlwiO1xuXG5cdFx0XHQvLyBTZXQgcmVhZHlTdGF0ZVxuXHRcdFx0anFYSFIucmVhZHlTdGF0ZSA9IHN0YXR1cyA+IDAgPyA0IDogMDtcblxuXHRcdFx0Ly8gRGV0ZXJtaW5lIGlmIHN1Y2Nlc3NmdWxcblx0XHRcdGlzU3VjY2VzcyA9IHN0YXR1cyA+PSAyMDAgJiYgc3RhdHVzIDwgMzAwIHx8IHN0YXR1cyA9PT0gMzA0O1xuXG5cdFx0XHQvLyBHZXQgcmVzcG9uc2UgZGF0YVxuXHRcdFx0aWYgKCByZXNwb25zZXMgKSB7XG5cdFx0XHRcdHJlc3BvbnNlID0gYWpheEhhbmRsZVJlc3BvbnNlcyggcywganFYSFIsIHJlc3BvbnNlcyApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBDb252ZXJ0IG5vIG1hdHRlciB3aGF0ICh0aGF0IHdheSByZXNwb25zZVhYWCBmaWVsZHMgYXJlIGFsd2F5cyBzZXQpXG5cdFx0XHRyZXNwb25zZSA9IGFqYXhDb252ZXJ0KCBzLCByZXNwb25zZSwganFYSFIsIGlzU3VjY2VzcyApO1xuXG5cdFx0XHQvLyBJZiBzdWNjZXNzZnVsLCBoYW5kbGUgdHlwZSBjaGFpbmluZ1xuXHRcdFx0aWYgKCBpc1N1Y2Nlc3MgKSB7XG5cblx0XHRcdFx0Ly8gU2V0IHRoZSBJZi1Nb2RpZmllZC1TaW5jZSBhbmQvb3IgSWYtTm9uZS1NYXRjaCBoZWFkZXIsIGlmIGluIGlmTW9kaWZpZWQgbW9kZS5cblx0XHRcdFx0aWYgKCBzLmlmTW9kaWZpZWQgKSB7XG5cdFx0XHRcdFx0bW9kaWZpZWQgPSBqcVhIUi5nZXRSZXNwb25zZUhlYWRlcihcIkxhc3QtTW9kaWZpZWRcIik7XG5cdFx0XHRcdFx0aWYgKCBtb2RpZmllZCApIHtcblx0XHRcdFx0XHRcdGpRdWVyeS5sYXN0TW9kaWZpZWRbIGNhY2hlVVJMIF0gPSBtb2RpZmllZDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0bW9kaWZpZWQgPSBqcVhIUi5nZXRSZXNwb25zZUhlYWRlcihcImV0YWdcIik7XG5cdFx0XHRcdFx0aWYgKCBtb2RpZmllZCApIHtcblx0XHRcdFx0XHRcdGpRdWVyeS5ldGFnWyBjYWNoZVVSTCBdID0gbW9kaWZpZWQ7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gaWYgbm8gY29udGVudFxuXHRcdFx0XHRpZiAoIHN0YXR1cyA9PT0gMjA0IHx8IHMudHlwZSA9PT0gXCJIRUFEXCIgKSB7XG5cdFx0XHRcdFx0c3RhdHVzVGV4dCA9IFwibm9jb250ZW50XCI7XG5cblx0XHRcdFx0Ly8gaWYgbm90IG1vZGlmaWVkXG5cdFx0XHRcdH0gZWxzZSBpZiAoIHN0YXR1cyA9PT0gMzA0ICkge1xuXHRcdFx0XHRcdHN0YXR1c1RleHQgPSBcIm5vdG1vZGlmaWVkXCI7XG5cblx0XHRcdFx0Ly8gSWYgd2UgaGF2ZSBkYXRhLCBsZXQncyBjb252ZXJ0IGl0XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0c3RhdHVzVGV4dCA9IHJlc3BvbnNlLnN0YXRlO1xuXHRcdFx0XHRcdHN1Y2Nlc3MgPSByZXNwb25zZS5kYXRhO1xuXHRcdFx0XHRcdGVycm9yID0gcmVzcG9uc2UuZXJyb3I7XG5cdFx0XHRcdFx0aXNTdWNjZXNzID0gIWVycm9yO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBXZSBleHRyYWN0IGVycm9yIGZyb20gc3RhdHVzVGV4dFxuXHRcdFx0XHQvLyB0aGVuIG5vcm1hbGl6ZSBzdGF0dXNUZXh0IGFuZCBzdGF0dXMgZm9yIG5vbi1hYm9ydHNcblx0XHRcdFx0ZXJyb3IgPSBzdGF0dXNUZXh0O1xuXHRcdFx0XHRpZiAoIHN0YXR1cyB8fCAhc3RhdHVzVGV4dCApIHtcblx0XHRcdFx0XHRzdGF0dXNUZXh0ID0gXCJlcnJvclwiO1xuXHRcdFx0XHRcdGlmICggc3RhdHVzIDwgMCApIHtcblx0XHRcdFx0XHRcdHN0YXR1cyA9IDA7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8vIFNldCBkYXRhIGZvciB0aGUgZmFrZSB4aHIgb2JqZWN0XG5cdFx0XHRqcVhIUi5zdGF0dXMgPSBzdGF0dXM7XG5cdFx0XHRqcVhIUi5zdGF0dXNUZXh0ID0gKCBuYXRpdmVTdGF0dXNUZXh0IHx8IHN0YXR1c1RleHQgKSArIFwiXCI7XG5cblx0XHRcdC8vIFN1Y2Nlc3MvRXJyb3Jcblx0XHRcdGlmICggaXNTdWNjZXNzICkge1xuXHRcdFx0XHRkZWZlcnJlZC5yZXNvbHZlV2l0aCggY2FsbGJhY2tDb250ZXh0LCBbIHN1Y2Nlc3MsIHN0YXR1c1RleHQsIGpxWEhSIF0gKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGRlZmVycmVkLnJlamVjdFdpdGgoIGNhbGxiYWNrQ29udGV4dCwgWyBqcVhIUiwgc3RhdHVzVGV4dCwgZXJyb3IgXSApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBTdGF0dXMtZGVwZW5kZW50IGNhbGxiYWNrc1xuXHRcdFx0anFYSFIuc3RhdHVzQ29kZSggc3RhdHVzQ29kZSApO1xuXHRcdFx0c3RhdHVzQ29kZSA9IHVuZGVmaW5lZDtcblxuXHRcdFx0aWYgKCBmaXJlR2xvYmFscyApIHtcblx0XHRcdFx0Z2xvYmFsRXZlbnRDb250ZXh0LnRyaWdnZXIoIGlzU3VjY2VzcyA/IFwiYWpheFN1Y2Nlc3NcIiA6IFwiYWpheEVycm9yXCIsXG5cdFx0XHRcdFx0WyBqcVhIUiwgcywgaXNTdWNjZXNzID8gc3VjY2VzcyA6IGVycm9yIF0gKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ29tcGxldGVcblx0XHRcdGNvbXBsZXRlRGVmZXJyZWQuZmlyZVdpdGgoIGNhbGxiYWNrQ29udGV4dCwgWyBqcVhIUiwgc3RhdHVzVGV4dCBdICk7XG5cblx0XHRcdGlmICggZmlyZUdsb2JhbHMgKSB7XG5cdFx0XHRcdGdsb2JhbEV2ZW50Q29udGV4dC50cmlnZ2VyKCBcImFqYXhDb21wbGV0ZVwiLCBbIGpxWEhSLCBzIF0gKTtcblx0XHRcdFx0Ly8gSGFuZGxlIHRoZSBnbG9iYWwgQUpBWCBjb3VudGVyXG5cdFx0XHRcdGlmICggISggLS1qUXVlcnkuYWN0aXZlICkgKSB7XG5cdFx0XHRcdFx0alF1ZXJ5LmV2ZW50LnRyaWdnZXIoXCJhamF4U3RvcFwiKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiBqcVhIUjtcblx0fSxcblxuXHRnZXRKU09OOiBmdW5jdGlvbiggdXJsLCBkYXRhLCBjYWxsYmFjayApIHtcblx0XHRyZXR1cm4galF1ZXJ5LmdldCggdXJsLCBkYXRhLCBjYWxsYmFjaywgXCJqc29uXCIgKTtcblx0fSxcblxuXHRnZXRTY3JpcHQ6IGZ1bmN0aW9uKCB1cmwsIGNhbGxiYWNrICkge1xuXHRcdHJldHVybiBqUXVlcnkuZ2V0KCB1cmwsIHVuZGVmaW5lZCwgY2FsbGJhY2ssIFwic2NyaXB0XCIgKTtcblx0fVxufSk7XG5cbmpRdWVyeS5lYWNoKCBbIFwiZ2V0XCIsIFwicG9zdFwiIF0sIGZ1bmN0aW9uKCBpLCBtZXRob2QgKSB7XG5cdGpRdWVyeVsgbWV0aG9kIF0gPSBmdW5jdGlvbiggdXJsLCBkYXRhLCBjYWxsYmFjaywgdHlwZSApIHtcblx0XHQvLyBzaGlmdCBhcmd1bWVudHMgaWYgZGF0YSBhcmd1bWVudCB3YXMgb21pdHRlZFxuXHRcdGlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIGRhdGEgKSApIHtcblx0XHRcdHR5cGUgPSB0eXBlIHx8IGNhbGxiYWNrO1xuXHRcdFx0Y2FsbGJhY2sgPSBkYXRhO1xuXHRcdFx0ZGF0YSA9IHVuZGVmaW5lZDtcblx0XHR9XG5cblx0XHRyZXR1cm4galF1ZXJ5LmFqYXgoe1xuXHRcdFx0dXJsOiB1cmwsXG5cdFx0XHR0eXBlOiBtZXRob2QsXG5cdFx0XHRkYXRhVHlwZTogdHlwZSxcblx0XHRcdGRhdGE6IGRhdGEsXG5cdFx0XHRzdWNjZXNzOiBjYWxsYmFja1xuXHRcdH0pO1xuXHR9O1xufSk7XG5cbi8vIEF0dGFjaCBhIGJ1bmNoIG9mIGZ1bmN0aW9ucyBmb3IgaGFuZGxpbmcgY29tbW9uIEFKQVggZXZlbnRzXG5qUXVlcnkuZWFjaCggWyBcImFqYXhTdGFydFwiLCBcImFqYXhTdG9wXCIsIFwiYWpheENvbXBsZXRlXCIsIFwiYWpheEVycm9yXCIsIFwiYWpheFN1Y2Nlc3NcIiwgXCJhamF4U2VuZFwiIF0sIGZ1bmN0aW9uKCBpLCB0eXBlICkge1xuXHRqUXVlcnkuZm5bIHR5cGUgXSA9IGZ1bmN0aW9uKCBmbiApIHtcblx0XHRyZXR1cm4gdGhpcy5vbiggdHlwZSwgZm4gKTtcblx0fTtcbn0pO1xuXG5cbmpRdWVyeS5fZXZhbFVybCA9IGZ1bmN0aW9uKCB1cmwgKSB7XG5cdHJldHVybiBqUXVlcnkuYWpheCh7XG5cdFx0dXJsOiB1cmwsXG5cdFx0dHlwZTogXCJHRVRcIixcblx0XHRkYXRhVHlwZTogXCJzY3JpcHRcIixcblx0XHRhc3luYzogZmFsc2UsXG5cdFx0Z2xvYmFsOiBmYWxzZSxcblx0XHRcInRocm93c1wiOiB0cnVlXG5cdH0pO1xufTtcblxuXG5qUXVlcnkuZm4uZXh0ZW5kKHtcblx0d3JhcEFsbDogZnVuY3Rpb24oIGh0bWwgKSB7XG5cdFx0dmFyIHdyYXA7XG5cblx0XHRpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBodG1sICkgKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCBpICkge1xuXHRcdFx0XHRqUXVlcnkoIHRoaXMgKS53cmFwQWxsKCBodG1sLmNhbGwodGhpcywgaSkgKTtcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdGlmICggdGhpc1sgMCBdICkge1xuXG5cdFx0XHQvLyBUaGUgZWxlbWVudHMgdG8gd3JhcCB0aGUgdGFyZ2V0IGFyb3VuZFxuXHRcdFx0d3JhcCA9IGpRdWVyeSggaHRtbCwgdGhpc1sgMCBdLm93bmVyRG9jdW1lbnQgKS5lcSggMCApLmNsb25lKCB0cnVlICk7XG5cblx0XHRcdGlmICggdGhpc1sgMCBdLnBhcmVudE5vZGUgKSB7XG5cdFx0XHRcdHdyYXAuaW5zZXJ0QmVmb3JlKCB0aGlzWyAwIF0gKTtcblx0XHRcdH1cblxuXHRcdFx0d3JhcC5tYXAoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBlbGVtID0gdGhpcztcblxuXHRcdFx0XHR3aGlsZSAoIGVsZW0uZmlyc3RFbGVtZW50Q2hpbGQgKSB7XG5cdFx0XHRcdFx0ZWxlbSA9IGVsZW0uZmlyc3RFbGVtZW50Q2hpbGQ7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4gZWxlbTtcblx0XHRcdH0pLmFwcGVuZCggdGhpcyApO1xuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdHdyYXBJbm5lcjogZnVuY3Rpb24oIGh0bWwgKSB7XG5cdFx0aWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggaHRtbCApICkge1xuXHRcdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiggaSApIHtcblx0XHRcdFx0alF1ZXJ5KCB0aGlzICkud3JhcElubmVyKCBodG1sLmNhbGwodGhpcywgaSkgKTtcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgc2VsZiA9IGpRdWVyeSggdGhpcyApLFxuXHRcdFx0XHRjb250ZW50cyA9IHNlbGYuY29udGVudHMoKTtcblxuXHRcdFx0aWYgKCBjb250ZW50cy5sZW5ndGggKSB7XG5cdFx0XHRcdGNvbnRlbnRzLndyYXBBbGwoIGh0bWwgKTtcblxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0c2VsZi5hcHBlbmQoIGh0bWwgKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fSxcblxuXHR3cmFwOiBmdW5jdGlvbiggaHRtbCApIHtcblx0XHR2YXIgaXNGdW5jdGlvbiA9IGpRdWVyeS5pc0Z1bmN0aW9uKCBodG1sICk7XG5cblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCBpICkge1xuXHRcdFx0alF1ZXJ5KCB0aGlzICkud3JhcEFsbCggaXNGdW5jdGlvbiA/IGh0bWwuY2FsbCh0aGlzLCBpKSA6IGh0bWwgKTtcblx0XHR9KTtcblx0fSxcblxuXHR1bndyYXA6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0aGlzLnBhcmVudCgpLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAoICFqUXVlcnkubm9kZU5hbWUoIHRoaXMsIFwiYm9keVwiICkgKSB7XG5cdFx0XHRcdGpRdWVyeSggdGhpcyApLnJlcGxhY2VXaXRoKCB0aGlzLmNoaWxkTm9kZXMgKTtcblx0XHRcdH1cblx0XHR9KS5lbmQoKTtcblx0fVxufSk7XG5cblxualF1ZXJ5LmV4cHIuZmlsdGVycy5oaWRkZW4gPSBmdW5jdGlvbiggZWxlbSApIHtcblx0Ly8gU3VwcG9ydDogT3BlcmEgPD0gMTIuMTJcblx0Ly8gT3BlcmEgcmVwb3J0cyBvZmZzZXRXaWR0aHMgYW5kIG9mZnNldEhlaWdodHMgbGVzcyB0aGFuIHplcm8gb24gc29tZSBlbGVtZW50c1xuXHRyZXR1cm4gZWxlbS5vZmZzZXRXaWR0aCA8PSAwICYmIGVsZW0ub2Zmc2V0SGVpZ2h0IDw9IDA7XG59O1xualF1ZXJ5LmV4cHIuZmlsdGVycy52aXNpYmxlID0gZnVuY3Rpb24oIGVsZW0gKSB7XG5cdHJldHVybiAhalF1ZXJ5LmV4cHIuZmlsdGVycy5oaWRkZW4oIGVsZW0gKTtcbn07XG5cblxuXG5cbnZhciByMjAgPSAvJTIwL2csXG5cdHJicmFja2V0ID0gL1xcW1xcXSQvLFxuXHRyQ1JMRiA9IC9cXHI/XFxuL2csXG5cdHJzdWJtaXR0ZXJUeXBlcyA9IC9eKD86c3VibWl0fGJ1dHRvbnxpbWFnZXxyZXNldHxmaWxlKSQvaSxcblx0cnN1Ym1pdHRhYmxlID0gL14oPzppbnB1dHxzZWxlY3R8dGV4dGFyZWF8a2V5Z2VuKS9pO1xuXG5mdW5jdGlvbiBidWlsZFBhcmFtcyggcHJlZml4LCBvYmosIHRyYWRpdGlvbmFsLCBhZGQgKSB7XG5cdHZhciBuYW1lO1xuXG5cdGlmICggalF1ZXJ5LmlzQXJyYXkoIG9iaiApICkge1xuXHRcdC8vIFNlcmlhbGl6ZSBhcnJheSBpdGVtLlxuXHRcdGpRdWVyeS5lYWNoKCBvYmosIGZ1bmN0aW9uKCBpLCB2ICkge1xuXHRcdFx0aWYgKCB0cmFkaXRpb25hbCB8fCByYnJhY2tldC50ZXN0KCBwcmVmaXggKSApIHtcblx0XHRcdFx0Ly8gVHJlYXQgZWFjaCBhcnJheSBpdGVtIGFzIGEgc2NhbGFyLlxuXHRcdFx0XHRhZGQoIHByZWZpeCwgdiApO1xuXG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBJdGVtIGlzIG5vbi1zY2FsYXIgKGFycmF5IG9yIG9iamVjdCksIGVuY29kZSBpdHMgbnVtZXJpYyBpbmRleC5cblx0XHRcdFx0YnVpbGRQYXJhbXMoIHByZWZpeCArIFwiW1wiICsgKCB0eXBlb2YgdiA9PT0gXCJvYmplY3RcIiA/IGkgOiBcIlwiICkgKyBcIl1cIiwgdiwgdHJhZGl0aW9uYWwsIGFkZCApO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdH0gZWxzZSBpZiAoICF0cmFkaXRpb25hbCAmJiBqUXVlcnkudHlwZSggb2JqICkgPT09IFwib2JqZWN0XCIgKSB7XG5cdFx0Ly8gU2VyaWFsaXplIG9iamVjdCBpdGVtLlxuXHRcdGZvciAoIG5hbWUgaW4gb2JqICkge1xuXHRcdFx0YnVpbGRQYXJhbXMoIHByZWZpeCArIFwiW1wiICsgbmFtZSArIFwiXVwiLCBvYmpbIG5hbWUgXSwgdHJhZGl0aW9uYWwsIGFkZCApO1xuXHRcdH1cblxuXHR9IGVsc2Uge1xuXHRcdC8vIFNlcmlhbGl6ZSBzY2FsYXIgaXRlbS5cblx0XHRhZGQoIHByZWZpeCwgb2JqICk7XG5cdH1cbn1cblxuLy8gU2VyaWFsaXplIGFuIGFycmF5IG9mIGZvcm0gZWxlbWVudHMgb3IgYSBzZXQgb2Zcbi8vIGtleS92YWx1ZXMgaW50byBhIHF1ZXJ5IHN0cmluZ1xualF1ZXJ5LnBhcmFtID0gZnVuY3Rpb24oIGEsIHRyYWRpdGlvbmFsICkge1xuXHR2YXIgcHJlZml4LFxuXHRcdHMgPSBbXSxcblx0XHRhZGQgPSBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHtcblx0XHRcdC8vIElmIHZhbHVlIGlzIGEgZnVuY3Rpb24sIGludm9rZSBpdCBhbmQgcmV0dXJuIGl0cyB2YWx1ZVxuXHRcdFx0dmFsdWUgPSBqUXVlcnkuaXNGdW5jdGlvbiggdmFsdWUgKSA/IHZhbHVlKCkgOiAoIHZhbHVlID09IG51bGwgPyBcIlwiIDogdmFsdWUgKTtcblx0XHRcdHNbIHMubGVuZ3RoIF0gPSBlbmNvZGVVUklDb21wb25lbnQoIGtleSApICsgXCI9XCIgKyBlbmNvZGVVUklDb21wb25lbnQoIHZhbHVlICk7XG5cdFx0fTtcblxuXHQvLyBTZXQgdHJhZGl0aW9uYWwgdG8gdHJ1ZSBmb3IgalF1ZXJ5IDw9IDEuMy4yIGJlaGF2aW9yLlxuXHRpZiAoIHRyYWRpdGlvbmFsID09PSB1bmRlZmluZWQgKSB7XG5cdFx0dHJhZGl0aW9uYWwgPSBqUXVlcnkuYWpheFNldHRpbmdzICYmIGpRdWVyeS5hamF4U2V0dGluZ3MudHJhZGl0aW9uYWw7XG5cdH1cblxuXHQvLyBJZiBhbiBhcnJheSB3YXMgcGFzc2VkIGluLCBhc3N1bWUgdGhhdCBpdCBpcyBhbiBhcnJheSBvZiBmb3JtIGVsZW1lbnRzLlxuXHRpZiAoIGpRdWVyeS5pc0FycmF5KCBhICkgfHwgKCBhLmpxdWVyeSAmJiAhalF1ZXJ5LmlzUGxhaW5PYmplY3QoIGEgKSApICkge1xuXHRcdC8vIFNlcmlhbGl6ZSB0aGUgZm9ybSBlbGVtZW50c1xuXHRcdGpRdWVyeS5lYWNoKCBhLCBmdW5jdGlvbigpIHtcblx0XHRcdGFkZCggdGhpcy5uYW1lLCB0aGlzLnZhbHVlICk7XG5cdFx0fSk7XG5cblx0fSBlbHNlIHtcblx0XHQvLyBJZiB0cmFkaXRpb25hbCwgZW5jb2RlIHRoZSBcIm9sZFwiIHdheSAodGhlIHdheSAxLjMuMiBvciBvbGRlclxuXHRcdC8vIGRpZCBpdCksIG90aGVyd2lzZSBlbmNvZGUgcGFyYW1zIHJlY3Vyc2l2ZWx5LlxuXHRcdGZvciAoIHByZWZpeCBpbiBhICkge1xuXHRcdFx0YnVpbGRQYXJhbXMoIHByZWZpeCwgYVsgcHJlZml4IF0sIHRyYWRpdGlvbmFsLCBhZGQgKTtcblx0XHR9XG5cdH1cblxuXHQvLyBSZXR1cm4gdGhlIHJlc3VsdGluZyBzZXJpYWxpemF0aW9uXG5cdHJldHVybiBzLmpvaW4oIFwiJlwiICkucmVwbGFjZSggcjIwLCBcIitcIiApO1xufTtcblxualF1ZXJ5LmZuLmV4dGVuZCh7XG5cdHNlcmlhbGl6ZTogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIGpRdWVyeS5wYXJhbSggdGhpcy5zZXJpYWxpemVBcnJheSgpICk7XG5cdH0sXG5cdHNlcmlhbGl6ZUFycmF5OiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKSB7XG5cdFx0XHQvLyBDYW4gYWRkIHByb3BIb29rIGZvciBcImVsZW1lbnRzXCIgdG8gZmlsdGVyIG9yIGFkZCBmb3JtIGVsZW1lbnRzXG5cdFx0XHR2YXIgZWxlbWVudHMgPSBqUXVlcnkucHJvcCggdGhpcywgXCJlbGVtZW50c1wiICk7XG5cdFx0XHRyZXR1cm4gZWxlbWVudHMgPyBqUXVlcnkubWFrZUFycmF5KCBlbGVtZW50cyApIDogdGhpcztcblx0XHR9KVxuXHRcdC5maWx0ZXIoZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgdHlwZSA9IHRoaXMudHlwZTtcblxuXHRcdFx0Ly8gVXNlIC5pcyggXCI6ZGlzYWJsZWRcIiApIHNvIHRoYXQgZmllbGRzZXRbZGlzYWJsZWRdIHdvcmtzXG5cdFx0XHRyZXR1cm4gdGhpcy5uYW1lICYmICFqUXVlcnkoIHRoaXMgKS5pcyggXCI6ZGlzYWJsZWRcIiApICYmXG5cdFx0XHRcdHJzdWJtaXR0YWJsZS50ZXN0KCB0aGlzLm5vZGVOYW1lICkgJiYgIXJzdWJtaXR0ZXJUeXBlcy50ZXN0KCB0eXBlICkgJiZcblx0XHRcdFx0KCB0aGlzLmNoZWNrZWQgfHwgIXJjaGVja2FibGVUeXBlLnRlc3QoIHR5cGUgKSApO1xuXHRcdH0pXG5cdFx0Lm1hcChmdW5jdGlvbiggaSwgZWxlbSApIHtcblx0XHRcdHZhciB2YWwgPSBqUXVlcnkoIHRoaXMgKS52YWwoKTtcblxuXHRcdFx0cmV0dXJuIHZhbCA9PSBudWxsID9cblx0XHRcdFx0bnVsbCA6XG5cdFx0XHRcdGpRdWVyeS5pc0FycmF5KCB2YWwgKSA/XG5cdFx0XHRcdFx0alF1ZXJ5Lm1hcCggdmFsLCBmdW5jdGlvbiggdmFsICkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIHsgbmFtZTogZWxlbS5uYW1lLCB2YWx1ZTogdmFsLnJlcGxhY2UoIHJDUkxGLCBcIlxcclxcblwiICkgfTtcblx0XHRcdFx0XHR9KSA6XG5cdFx0XHRcdFx0eyBuYW1lOiBlbGVtLm5hbWUsIHZhbHVlOiB2YWwucmVwbGFjZSggckNSTEYsIFwiXFxyXFxuXCIgKSB9O1xuXHRcdH0pLmdldCgpO1xuXHR9XG59KTtcblxuXG5qUXVlcnkuYWpheFNldHRpbmdzLnhociA9IGZ1bmN0aW9uKCkge1xuXHR0cnkge1xuXHRcdHJldHVybiBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcblx0fSBjYXRjaCggZSApIHt9XG59O1xuXG52YXIgeGhySWQgPSAwLFxuXHR4aHJDYWxsYmFja3MgPSB7fSxcblx0eGhyU3VjY2Vzc1N0YXR1cyA9IHtcblx0XHQvLyBmaWxlIHByb3RvY29sIGFsd2F5cyB5aWVsZHMgc3RhdHVzIGNvZGUgMCwgYXNzdW1lIDIwMFxuXHRcdDA6IDIwMCxcblx0XHQvLyBTdXBwb3J0OiBJRTlcblx0XHQvLyAjMTQ1MDogc29tZXRpbWVzIElFIHJldHVybnMgMTIyMyB3aGVuIGl0IHNob3VsZCBiZSAyMDRcblx0XHQxMjIzOiAyMDRcblx0fSxcblx0eGhyU3VwcG9ydGVkID0galF1ZXJ5LmFqYXhTZXR0aW5ncy54aHIoKTtcblxuLy8gU3VwcG9ydDogSUU5XG4vLyBPcGVuIHJlcXVlc3RzIG11c3QgYmUgbWFudWFsbHkgYWJvcnRlZCBvbiB1bmxvYWQgKCM1MjgwKVxuaWYgKCB3aW5kb3cuQWN0aXZlWE9iamVjdCApIHtcblx0alF1ZXJ5KCB3aW5kb3cgKS5vbiggXCJ1bmxvYWRcIiwgZnVuY3Rpb24oKSB7XG5cdFx0Zm9yICggdmFyIGtleSBpbiB4aHJDYWxsYmFja3MgKSB7XG5cdFx0XHR4aHJDYWxsYmFja3NbIGtleSBdKCk7XG5cdFx0fVxuXHR9KTtcbn1cblxuc3VwcG9ydC5jb3JzID0gISF4aHJTdXBwb3J0ZWQgJiYgKCBcIndpdGhDcmVkZW50aWFsc1wiIGluIHhoclN1cHBvcnRlZCApO1xuc3VwcG9ydC5hamF4ID0geGhyU3VwcG9ydGVkID0gISF4aHJTdXBwb3J0ZWQ7XG5cbmpRdWVyeS5hamF4VHJhbnNwb3J0KGZ1bmN0aW9uKCBvcHRpb25zICkge1xuXHR2YXIgY2FsbGJhY2s7XG5cblx0Ly8gQ3Jvc3MgZG9tYWluIG9ubHkgYWxsb3dlZCBpZiBzdXBwb3J0ZWQgdGhyb3VnaCBYTUxIdHRwUmVxdWVzdFxuXHRpZiAoIHN1cHBvcnQuY29ycyB8fCB4aHJTdXBwb3J0ZWQgJiYgIW9wdGlvbnMuY3Jvc3NEb21haW4gKSB7XG5cdFx0cmV0dXJuIHtcblx0XHRcdHNlbmQ6IGZ1bmN0aW9uKCBoZWFkZXJzLCBjb21wbGV0ZSApIHtcblx0XHRcdFx0dmFyIGksXG5cdFx0XHRcdFx0eGhyID0gb3B0aW9ucy54aHIoKSxcblx0XHRcdFx0XHRpZCA9ICsreGhySWQ7XG5cblx0XHRcdFx0eGhyLm9wZW4oIG9wdGlvbnMudHlwZSwgb3B0aW9ucy51cmwsIG9wdGlvbnMuYXN5bmMsIG9wdGlvbnMudXNlcm5hbWUsIG9wdGlvbnMucGFzc3dvcmQgKTtcblxuXHRcdFx0XHQvLyBBcHBseSBjdXN0b20gZmllbGRzIGlmIHByb3ZpZGVkXG5cdFx0XHRcdGlmICggb3B0aW9ucy54aHJGaWVsZHMgKSB7XG5cdFx0XHRcdFx0Zm9yICggaSBpbiBvcHRpb25zLnhockZpZWxkcyApIHtcblx0XHRcdFx0XHRcdHhoclsgaSBdID0gb3B0aW9ucy54aHJGaWVsZHNbIGkgXTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBPdmVycmlkZSBtaW1lIHR5cGUgaWYgbmVlZGVkXG5cdFx0XHRcdGlmICggb3B0aW9ucy5taW1lVHlwZSAmJiB4aHIub3ZlcnJpZGVNaW1lVHlwZSApIHtcblx0XHRcdFx0XHR4aHIub3ZlcnJpZGVNaW1lVHlwZSggb3B0aW9ucy5taW1lVHlwZSApO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gWC1SZXF1ZXN0ZWQtV2l0aCBoZWFkZXJcblx0XHRcdFx0Ly8gRm9yIGNyb3NzLWRvbWFpbiByZXF1ZXN0cywgc2VlaW5nIGFzIGNvbmRpdGlvbnMgZm9yIGEgcHJlZmxpZ2h0IGFyZVxuXHRcdFx0XHQvLyBha2luIHRvIGEgamlnc2F3IHB1enpsZSwgd2Ugc2ltcGx5IG5ldmVyIHNldCBpdCB0byBiZSBzdXJlLlxuXHRcdFx0XHQvLyAoaXQgY2FuIGFsd2F5cyBiZSBzZXQgb24gYSBwZXItcmVxdWVzdCBiYXNpcyBvciBldmVuIHVzaW5nIGFqYXhTZXR1cClcblx0XHRcdFx0Ly8gRm9yIHNhbWUtZG9tYWluIHJlcXVlc3RzLCB3b24ndCBjaGFuZ2UgaGVhZGVyIGlmIGFscmVhZHkgcHJvdmlkZWQuXG5cdFx0XHRcdGlmICggIW9wdGlvbnMuY3Jvc3NEb21haW4gJiYgIWhlYWRlcnNbXCJYLVJlcXVlc3RlZC1XaXRoXCJdICkge1xuXHRcdFx0XHRcdGhlYWRlcnNbXCJYLVJlcXVlc3RlZC1XaXRoXCJdID0gXCJYTUxIdHRwUmVxdWVzdFwiO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gU2V0IGhlYWRlcnNcblx0XHRcdFx0Zm9yICggaSBpbiBoZWFkZXJzICkge1xuXHRcdFx0XHRcdHhoci5zZXRSZXF1ZXN0SGVhZGVyKCBpLCBoZWFkZXJzWyBpIF0gKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIENhbGxiYWNrXG5cdFx0XHRcdGNhbGxiYWNrID0gZnVuY3Rpb24oIHR5cGUgKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0aWYgKCBjYWxsYmFjayApIHtcblx0XHRcdFx0XHRcdFx0ZGVsZXRlIHhockNhbGxiYWNrc1sgaWQgXTtcblx0XHRcdFx0XHRcdFx0Y2FsbGJhY2sgPSB4aHIub25sb2FkID0geGhyLm9uZXJyb3IgPSBudWxsO1xuXG5cdFx0XHRcdFx0XHRcdGlmICggdHlwZSA9PT0gXCJhYm9ydFwiICkge1xuXHRcdFx0XHRcdFx0XHRcdHhoci5hYm9ydCgpO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKCB0eXBlID09PSBcImVycm9yXCIgKSB7XG5cdFx0XHRcdFx0XHRcdFx0Y29tcGxldGUoXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBmaWxlOiBwcm90b2NvbCBhbHdheXMgeWllbGRzIHN0YXR1cyAwOyBzZWUgIzg2MDUsICMxNDIwN1xuXHRcdFx0XHRcdFx0XHRcdFx0eGhyLnN0YXR1cyxcblx0XHRcdFx0XHRcdFx0XHRcdHhoci5zdGF0dXNUZXh0XG5cdFx0XHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRjb21wbGV0ZShcblx0XHRcdFx0XHRcdFx0XHRcdHhoclN1Y2Nlc3NTdGF0dXNbIHhoci5zdGF0dXMgXSB8fCB4aHIuc3RhdHVzLFxuXHRcdFx0XHRcdFx0XHRcdFx0eGhyLnN0YXR1c1RleHQsXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBTdXBwb3J0OiBJRTlcblx0XHRcdFx0XHRcdFx0XHRcdC8vIEFjY2Vzc2luZyBiaW5hcnktZGF0YSByZXNwb25zZVRleHQgdGhyb3dzIGFuIGV4Y2VwdGlvblxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gKCMxMTQyNilcblx0XHRcdFx0XHRcdFx0XHRcdHR5cGVvZiB4aHIucmVzcG9uc2VUZXh0ID09PSBcInN0cmluZ1wiID8ge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR0ZXh0OiB4aHIucmVzcG9uc2VUZXh0XG5cdFx0XHRcdFx0XHRcdFx0XHR9IDogdW5kZWZpbmVkLFxuXHRcdFx0XHRcdFx0XHRcdFx0eGhyLmdldEFsbFJlc3BvbnNlSGVhZGVycygpXG5cdFx0XHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0Ly8gTGlzdGVuIHRvIGV2ZW50c1xuXHRcdFx0XHR4aHIub25sb2FkID0gY2FsbGJhY2soKTtcblx0XHRcdFx0eGhyLm9uZXJyb3IgPSBjYWxsYmFjayhcImVycm9yXCIpO1xuXG5cdFx0XHRcdC8vIENyZWF0ZSB0aGUgYWJvcnQgY2FsbGJhY2tcblx0XHRcdFx0Y2FsbGJhY2sgPSB4aHJDYWxsYmFja3NbIGlkIF0gPSBjYWxsYmFjayhcImFib3J0XCIpO1xuXG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0Ly8gRG8gc2VuZCB0aGUgcmVxdWVzdCAodGhpcyBtYXkgcmFpc2UgYW4gZXhjZXB0aW9uKVxuXHRcdFx0XHRcdHhoci5zZW5kKCBvcHRpb25zLmhhc0NvbnRlbnQgJiYgb3B0aW9ucy5kYXRhIHx8IG51bGwgKTtcblx0XHRcdFx0fSBjYXRjaCAoIGUgKSB7XG5cdFx0XHRcdFx0Ly8gIzE0NjgzOiBPbmx5IHJldGhyb3cgaWYgdGhpcyBoYXNuJ3QgYmVlbiBub3RpZmllZCBhcyBhbiBlcnJvciB5ZXRcblx0XHRcdFx0XHRpZiAoIGNhbGxiYWNrICkge1xuXHRcdFx0XHRcdFx0dGhyb3cgZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cblx0XHRcdGFib3J0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKCBjYWxsYmFjayApIHtcblx0XHRcdFx0XHRjYWxsYmFjaygpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fTtcblx0fVxufSk7XG5cblxuXG5cbi8vIEluc3RhbGwgc2NyaXB0IGRhdGFUeXBlXG5qUXVlcnkuYWpheFNldHVwKHtcblx0YWNjZXB0czoge1xuXHRcdHNjcmlwdDogXCJ0ZXh0L2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2VjbWFzY3JpcHQsIGFwcGxpY2F0aW9uL3gtZWNtYXNjcmlwdFwiXG5cdH0sXG5cdGNvbnRlbnRzOiB7XG5cdFx0c2NyaXB0OiAvKD86amF2YXxlY21hKXNjcmlwdC9cblx0fSxcblx0Y29udmVydGVyczoge1xuXHRcdFwidGV4dCBzY3JpcHRcIjogZnVuY3Rpb24oIHRleHQgKSB7XG5cdFx0XHRqUXVlcnkuZ2xvYmFsRXZhbCggdGV4dCApO1xuXHRcdFx0cmV0dXJuIHRleHQ7XG5cdFx0fVxuXHR9XG59KTtcblxuLy8gSGFuZGxlIGNhY2hlJ3Mgc3BlY2lhbCBjYXNlIGFuZCBjcm9zc0RvbWFpblxualF1ZXJ5LmFqYXhQcmVmaWx0ZXIoIFwic2NyaXB0XCIsIGZ1bmN0aW9uKCBzICkge1xuXHRpZiAoIHMuY2FjaGUgPT09IHVuZGVmaW5lZCApIHtcblx0XHRzLmNhY2hlID0gZmFsc2U7XG5cdH1cblx0aWYgKCBzLmNyb3NzRG9tYWluICkge1xuXHRcdHMudHlwZSA9IFwiR0VUXCI7XG5cdH1cbn0pO1xuXG4vLyBCaW5kIHNjcmlwdCB0YWcgaGFjayB0cmFuc3BvcnRcbmpRdWVyeS5hamF4VHJhbnNwb3J0KCBcInNjcmlwdFwiLCBmdW5jdGlvbiggcyApIHtcblx0Ly8gVGhpcyB0cmFuc3BvcnQgb25seSBkZWFscyB3aXRoIGNyb3NzIGRvbWFpbiByZXF1ZXN0c1xuXHRpZiAoIHMuY3Jvc3NEb21haW4gKSB7XG5cdFx0dmFyIHNjcmlwdCwgY2FsbGJhY2s7XG5cdFx0cmV0dXJuIHtcblx0XHRcdHNlbmQ6IGZ1bmN0aW9uKCBfLCBjb21wbGV0ZSApIHtcblx0XHRcdFx0c2NyaXB0ID0galF1ZXJ5KFwiPHNjcmlwdD5cIikucHJvcCh7XG5cdFx0XHRcdFx0YXN5bmM6IHRydWUsXG5cdFx0XHRcdFx0Y2hhcnNldDogcy5zY3JpcHRDaGFyc2V0LFxuXHRcdFx0XHRcdHNyYzogcy51cmxcblx0XHRcdFx0fSkub24oXG5cdFx0XHRcdFx0XCJsb2FkIGVycm9yXCIsXG5cdFx0XHRcdFx0Y2FsbGJhY2sgPSBmdW5jdGlvbiggZXZ0ICkge1xuXHRcdFx0XHRcdFx0c2NyaXB0LnJlbW92ZSgpO1xuXHRcdFx0XHRcdFx0Y2FsbGJhY2sgPSBudWxsO1xuXHRcdFx0XHRcdFx0aWYgKCBldnQgKSB7XG5cdFx0XHRcdFx0XHRcdGNvbXBsZXRlKCBldnQudHlwZSA9PT0gXCJlcnJvclwiID8gNDA0IDogMjAwLCBldnQudHlwZSApO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0KTtcblx0XHRcdFx0ZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZCggc2NyaXB0WyAwIF0gKTtcblx0XHRcdH0sXG5cdFx0XHRhYm9ydDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmICggY2FsbGJhY2sgKSB7XG5cdFx0XHRcdFx0Y2FsbGJhY2soKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH07XG5cdH1cbn0pO1xuXG5cblxuXG52YXIgb2xkQ2FsbGJhY2tzID0gW10sXG5cdHJqc29ucCA9IC8oPSlcXD8oPz0mfCQpfFxcP1xcPy87XG5cbi8vIERlZmF1bHQganNvbnAgc2V0dGluZ3NcbmpRdWVyeS5hamF4U2V0dXAoe1xuXHRqc29ucDogXCJjYWxsYmFja1wiLFxuXHRqc29ucENhbGxiYWNrOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgY2FsbGJhY2sgPSBvbGRDYWxsYmFja3MucG9wKCkgfHwgKCBqUXVlcnkuZXhwYW5kbyArIFwiX1wiICsgKCBub25jZSsrICkgKTtcblx0XHR0aGlzWyBjYWxsYmFjayBdID0gdHJ1ZTtcblx0XHRyZXR1cm4gY2FsbGJhY2s7XG5cdH1cbn0pO1xuXG4vLyBEZXRlY3QsIG5vcm1hbGl6ZSBvcHRpb25zIGFuZCBpbnN0YWxsIGNhbGxiYWNrcyBmb3IganNvbnAgcmVxdWVzdHNcbmpRdWVyeS5hamF4UHJlZmlsdGVyKCBcImpzb24ganNvbnBcIiwgZnVuY3Rpb24oIHMsIG9yaWdpbmFsU2V0dGluZ3MsIGpxWEhSICkge1xuXG5cdHZhciBjYWxsYmFja05hbWUsIG92ZXJ3cml0dGVuLCByZXNwb25zZUNvbnRhaW5lcixcblx0XHRqc29uUHJvcCA9IHMuanNvbnAgIT09IGZhbHNlICYmICggcmpzb25wLnRlc3QoIHMudXJsICkgP1xuXHRcdFx0XCJ1cmxcIiA6XG5cdFx0XHR0eXBlb2Ygcy5kYXRhID09PSBcInN0cmluZ1wiICYmICEoIHMuY29udGVudFR5cGUgfHwgXCJcIiApLmluZGV4T2YoXCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcIikgJiYgcmpzb25wLnRlc3QoIHMuZGF0YSApICYmIFwiZGF0YVwiXG5cdFx0KTtcblxuXHQvLyBIYW5kbGUgaWZmIHRoZSBleHBlY3RlZCBkYXRhIHR5cGUgaXMgXCJqc29ucFwiIG9yIHdlIGhhdmUgYSBwYXJhbWV0ZXIgdG8gc2V0XG5cdGlmICgganNvblByb3AgfHwgcy5kYXRhVHlwZXNbIDAgXSA9PT0gXCJqc29ucFwiICkge1xuXG5cdFx0Ly8gR2V0IGNhbGxiYWNrIG5hbWUsIHJlbWVtYmVyaW5nIHByZWV4aXN0aW5nIHZhbHVlIGFzc29jaWF0ZWQgd2l0aCBpdFxuXHRcdGNhbGxiYWNrTmFtZSA9IHMuanNvbnBDYWxsYmFjayA9IGpRdWVyeS5pc0Z1bmN0aW9uKCBzLmpzb25wQ2FsbGJhY2sgKSA/XG5cdFx0XHRzLmpzb25wQ2FsbGJhY2soKSA6XG5cdFx0XHRzLmpzb25wQ2FsbGJhY2s7XG5cblx0XHQvLyBJbnNlcnQgY2FsbGJhY2sgaW50byB1cmwgb3IgZm9ybSBkYXRhXG5cdFx0aWYgKCBqc29uUHJvcCApIHtcblx0XHRcdHNbIGpzb25Qcm9wIF0gPSBzWyBqc29uUHJvcCBdLnJlcGxhY2UoIHJqc29ucCwgXCIkMVwiICsgY2FsbGJhY2tOYW1lICk7XG5cdFx0fSBlbHNlIGlmICggcy5qc29ucCAhPT0gZmFsc2UgKSB7XG5cdFx0XHRzLnVybCArPSAoIHJxdWVyeS50ZXN0KCBzLnVybCApID8gXCImXCIgOiBcIj9cIiApICsgcy5qc29ucCArIFwiPVwiICsgY2FsbGJhY2tOYW1lO1xuXHRcdH1cblxuXHRcdC8vIFVzZSBkYXRhIGNvbnZlcnRlciB0byByZXRyaWV2ZSBqc29uIGFmdGVyIHNjcmlwdCBleGVjdXRpb25cblx0XHRzLmNvbnZlcnRlcnNbXCJzY3JpcHQganNvblwiXSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKCAhcmVzcG9uc2VDb250YWluZXIgKSB7XG5cdFx0XHRcdGpRdWVyeS5lcnJvciggY2FsbGJhY2tOYW1lICsgXCIgd2FzIG5vdCBjYWxsZWRcIiApO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIHJlc3BvbnNlQ29udGFpbmVyWyAwIF07XG5cdFx0fTtcblxuXHRcdC8vIGZvcmNlIGpzb24gZGF0YVR5cGVcblx0XHRzLmRhdGFUeXBlc1sgMCBdID0gXCJqc29uXCI7XG5cblx0XHQvLyBJbnN0YWxsIGNhbGxiYWNrXG5cdFx0b3ZlcndyaXR0ZW4gPSB3aW5kb3dbIGNhbGxiYWNrTmFtZSBdO1xuXHRcdHdpbmRvd1sgY2FsbGJhY2tOYW1lIF0gPSBmdW5jdGlvbigpIHtcblx0XHRcdHJlc3BvbnNlQ29udGFpbmVyID0gYXJndW1lbnRzO1xuXHRcdH07XG5cblx0XHQvLyBDbGVhbi11cCBmdW5jdGlvbiAoZmlyZXMgYWZ0ZXIgY29udmVydGVycylcblx0XHRqcVhIUi5hbHdheXMoZnVuY3Rpb24oKSB7XG5cdFx0XHQvLyBSZXN0b3JlIHByZWV4aXN0aW5nIHZhbHVlXG5cdFx0XHR3aW5kb3dbIGNhbGxiYWNrTmFtZSBdID0gb3ZlcndyaXR0ZW47XG5cblx0XHRcdC8vIFNhdmUgYmFjayBhcyBmcmVlXG5cdFx0XHRpZiAoIHNbIGNhbGxiYWNrTmFtZSBdICkge1xuXHRcdFx0XHQvLyBtYWtlIHN1cmUgdGhhdCByZS11c2luZyB0aGUgb3B0aW9ucyBkb2Vzbid0IHNjcmV3IHRoaW5ncyBhcm91bmRcblx0XHRcdFx0cy5qc29ucENhbGxiYWNrID0gb3JpZ2luYWxTZXR0aW5ncy5qc29ucENhbGxiYWNrO1xuXG5cdFx0XHRcdC8vIHNhdmUgdGhlIGNhbGxiYWNrIG5hbWUgZm9yIGZ1dHVyZSB1c2Vcblx0XHRcdFx0b2xkQ2FsbGJhY2tzLnB1c2goIGNhbGxiYWNrTmFtZSApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBDYWxsIGlmIGl0IHdhcyBhIGZ1bmN0aW9uIGFuZCB3ZSBoYXZlIGEgcmVzcG9uc2Vcblx0XHRcdGlmICggcmVzcG9uc2VDb250YWluZXIgJiYgalF1ZXJ5LmlzRnVuY3Rpb24oIG92ZXJ3cml0dGVuICkgKSB7XG5cdFx0XHRcdG92ZXJ3cml0dGVuKCByZXNwb25zZUNvbnRhaW5lclsgMCBdICk7XG5cdFx0XHR9XG5cblx0XHRcdHJlc3BvbnNlQ29udGFpbmVyID0gb3ZlcndyaXR0ZW4gPSB1bmRlZmluZWQ7XG5cdFx0fSk7XG5cblx0XHQvLyBEZWxlZ2F0ZSB0byBzY3JpcHRcblx0XHRyZXR1cm4gXCJzY3JpcHRcIjtcblx0fVxufSk7XG5cblxuXG5cbi8vIGRhdGE6IHN0cmluZyBvZiBodG1sXG4vLyBjb250ZXh0IChvcHRpb25hbCk6IElmIHNwZWNpZmllZCwgdGhlIGZyYWdtZW50IHdpbGwgYmUgY3JlYXRlZCBpbiB0aGlzIGNvbnRleHQsIGRlZmF1bHRzIHRvIGRvY3VtZW50XG4vLyBrZWVwU2NyaXB0cyAob3B0aW9uYWwpOiBJZiB0cnVlLCB3aWxsIGluY2x1ZGUgc2NyaXB0cyBwYXNzZWQgaW4gdGhlIGh0bWwgc3RyaW5nXG5qUXVlcnkucGFyc2VIVE1MID0gZnVuY3Rpb24oIGRhdGEsIGNvbnRleHQsIGtlZXBTY3JpcHRzICkge1xuXHRpZiAoICFkYXRhIHx8IHR5cGVvZiBkYXRhICE9PSBcInN0cmluZ1wiICkge1xuXHRcdHJldHVybiBudWxsO1xuXHR9XG5cdGlmICggdHlwZW9mIGNvbnRleHQgPT09IFwiYm9vbGVhblwiICkge1xuXHRcdGtlZXBTY3JpcHRzID0gY29udGV4dDtcblx0XHRjb250ZXh0ID0gZmFsc2U7XG5cdH1cblx0Y29udGV4dCA9IGNvbnRleHQgfHwgZG9jdW1lbnQ7XG5cblx0dmFyIHBhcnNlZCA9IHJzaW5nbGVUYWcuZXhlYyggZGF0YSApLFxuXHRcdHNjcmlwdHMgPSAha2VlcFNjcmlwdHMgJiYgW107XG5cblx0Ly8gU2luZ2xlIHRhZ1xuXHRpZiAoIHBhcnNlZCApIHtcblx0XHRyZXR1cm4gWyBjb250ZXh0LmNyZWF0ZUVsZW1lbnQoIHBhcnNlZFsxXSApIF07XG5cdH1cblxuXHRwYXJzZWQgPSBqUXVlcnkuYnVpbGRGcmFnbWVudCggWyBkYXRhIF0sIGNvbnRleHQsIHNjcmlwdHMgKTtcblxuXHRpZiAoIHNjcmlwdHMgJiYgc2NyaXB0cy5sZW5ndGggKSB7XG5cdFx0alF1ZXJ5KCBzY3JpcHRzICkucmVtb3ZlKCk7XG5cdH1cblxuXHRyZXR1cm4galF1ZXJ5Lm1lcmdlKCBbXSwgcGFyc2VkLmNoaWxkTm9kZXMgKTtcbn07XG5cblxuLy8gS2VlcCBhIGNvcHkgb2YgdGhlIG9sZCBsb2FkIG1ldGhvZFxudmFyIF9sb2FkID0galF1ZXJ5LmZuLmxvYWQ7XG5cbi8qKlxuICogTG9hZCBhIHVybCBpbnRvIGEgcGFnZVxuICovXG5qUXVlcnkuZm4ubG9hZCA9IGZ1bmN0aW9uKCB1cmwsIHBhcmFtcywgY2FsbGJhY2sgKSB7XG5cdGlmICggdHlwZW9mIHVybCAhPT0gXCJzdHJpbmdcIiAmJiBfbG9hZCApIHtcblx0XHRyZXR1cm4gX2xvYWQuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApO1xuXHR9XG5cblx0dmFyIHNlbGVjdG9yLCB0eXBlLCByZXNwb25zZSxcblx0XHRzZWxmID0gdGhpcyxcblx0XHRvZmYgPSB1cmwuaW5kZXhPZihcIiBcIik7XG5cblx0aWYgKCBvZmYgPj0gMCApIHtcblx0XHRzZWxlY3RvciA9IGpRdWVyeS50cmltKCB1cmwuc2xpY2UoIG9mZiApICk7XG5cdFx0dXJsID0gdXJsLnNsaWNlKCAwLCBvZmYgKTtcblx0fVxuXG5cdC8vIElmIGl0J3MgYSBmdW5jdGlvblxuXHRpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBwYXJhbXMgKSApIHtcblxuXHRcdC8vIFdlIGFzc3VtZSB0aGF0IGl0J3MgdGhlIGNhbGxiYWNrXG5cdFx0Y2FsbGJhY2sgPSBwYXJhbXM7XG5cdFx0cGFyYW1zID0gdW5kZWZpbmVkO1xuXG5cdC8vIE90aGVyd2lzZSwgYnVpbGQgYSBwYXJhbSBzdHJpbmdcblx0fSBlbHNlIGlmICggcGFyYW1zICYmIHR5cGVvZiBwYXJhbXMgPT09IFwib2JqZWN0XCIgKSB7XG5cdFx0dHlwZSA9IFwiUE9TVFwiO1xuXHR9XG5cblx0Ly8gSWYgd2UgaGF2ZSBlbGVtZW50cyB0byBtb2RpZnksIG1ha2UgdGhlIHJlcXVlc3Rcblx0aWYgKCBzZWxmLmxlbmd0aCA+IDAgKSB7XG5cdFx0alF1ZXJ5LmFqYXgoe1xuXHRcdFx0dXJsOiB1cmwsXG5cblx0XHRcdC8vIGlmIFwidHlwZVwiIHZhcmlhYmxlIGlzIHVuZGVmaW5lZCwgdGhlbiBcIkdFVFwiIG1ldGhvZCB3aWxsIGJlIHVzZWRcblx0XHRcdHR5cGU6IHR5cGUsXG5cdFx0XHRkYXRhVHlwZTogXCJodG1sXCIsXG5cdFx0XHRkYXRhOiBwYXJhbXNcblx0XHR9KS5kb25lKGZ1bmN0aW9uKCByZXNwb25zZVRleHQgKSB7XG5cblx0XHRcdC8vIFNhdmUgcmVzcG9uc2UgZm9yIHVzZSBpbiBjb21wbGV0ZSBjYWxsYmFja1xuXHRcdFx0cmVzcG9uc2UgPSBhcmd1bWVudHM7XG5cblx0XHRcdHNlbGYuaHRtbCggc2VsZWN0b3IgP1xuXG5cdFx0XHRcdC8vIElmIGEgc2VsZWN0b3Igd2FzIHNwZWNpZmllZCwgbG9jYXRlIHRoZSByaWdodCBlbGVtZW50cyBpbiBhIGR1bW15IGRpdlxuXHRcdFx0XHQvLyBFeGNsdWRlIHNjcmlwdHMgdG8gYXZvaWQgSUUgJ1Blcm1pc3Npb24gRGVuaWVkJyBlcnJvcnNcblx0XHRcdFx0alF1ZXJ5KFwiPGRpdj5cIikuYXBwZW5kKCBqUXVlcnkucGFyc2VIVE1MKCByZXNwb25zZVRleHQgKSApLmZpbmQoIHNlbGVjdG9yICkgOlxuXG5cdFx0XHRcdC8vIE90aGVyd2lzZSB1c2UgdGhlIGZ1bGwgcmVzdWx0XG5cdFx0XHRcdHJlc3BvbnNlVGV4dCApO1xuXG5cdFx0fSkuY29tcGxldGUoIGNhbGxiYWNrICYmIGZ1bmN0aW9uKCBqcVhIUiwgc3RhdHVzICkge1xuXHRcdFx0c2VsZi5lYWNoKCBjYWxsYmFjaywgcmVzcG9uc2UgfHwgWyBqcVhIUi5yZXNwb25zZVRleHQsIHN0YXR1cywganFYSFIgXSApO1xuXHRcdH0pO1xuXHR9XG5cblx0cmV0dXJuIHRoaXM7XG59O1xuXG5cblxuXG5qUXVlcnkuZXhwci5maWx0ZXJzLmFuaW1hdGVkID0gZnVuY3Rpb24oIGVsZW0gKSB7XG5cdHJldHVybiBqUXVlcnkuZ3JlcChqUXVlcnkudGltZXJzLCBmdW5jdGlvbiggZm4gKSB7XG5cdFx0cmV0dXJuIGVsZW0gPT09IGZuLmVsZW07XG5cdH0pLmxlbmd0aDtcbn07XG5cblxuXG5cbnZhciBkb2NFbGVtID0gd2luZG93LmRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtcblxuLyoqXG4gKiBHZXRzIGEgd2luZG93IGZyb20gYW4gZWxlbWVudFxuICovXG5mdW5jdGlvbiBnZXRXaW5kb3coIGVsZW0gKSB7XG5cdHJldHVybiBqUXVlcnkuaXNXaW5kb3coIGVsZW0gKSA/IGVsZW0gOiBlbGVtLm5vZGVUeXBlID09PSA5ICYmIGVsZW0uZGVmYXVsdFZpZXc7XG59XG5cbmpRdWVyeS5vZmZzZXQgPSB7XG5cdHNldE9mZnNldDogZnVuY3Rpb24oIGVsZW0sIG9wdGlvbnMsIGkgKSB7XG5cdFx0dmFyIGN1clBvc2l0aW9uLCBjdXJMZWZ0LCBjdXJDU1NUb3AsIGN1clRvcCwgY3VyT2Zmc2V0LCBjdXJDU1NMZWZ0LCBjYWxjdWxhdGVQb3NpdGlvbixcblx0XHRcdHBvc2l0aW9uID0galF1ZXJ5LmNzcyggZWxlbSwgXCJwb3NpdGlvblwiICksXG5cdFx0XHRjdXJFbGVtID0galF1ZXJ5KCBlbGVtICksXG5cdFx0XHRwcm9wcyA9IHt9O1xuXG5cdFx0Ly8gU2V0IHBvc2l0aW9uIGZpcnN0LCBpbi1jYXNlIHRvcC9sZWZ0IGFyZSBzZXQgZXZlbiBvbiBzdGF0aWMgZWxlbVxuXHRcdGlmICggcG9zaXRpb24gPT09IFwic3RhdGljXCIgKSB7XG5cdFx0XHRlbGVtLnN0eWxlLnBvc2l0aW9uID0gXCJyZWxhdGl2ZVwiO1xuXHRcdH1cblxuXHRcdGN1ck9mZnNldCA9IGN1ckVsZW0ub2Zmc2V0KCk7XG5cdFx0Y3VyQ1NTVG9wID0galF1ZXJ5LmNzcyggZWxlbSwgXCJ0b3BcIiApO1xuXHRcdGN1ckNTU0xlZnQgPSBqUXVlcnkuY3NzKCBlbGVtLCBcImxlZnRcIiApO1xuXHRcdGNhbGN1bGF0ZVBvc2l0aW9uID0gKCBwb3NpdGlvbiA9PT0gXCJhYnNvbHV0ZVwiIHx8IHBvc2l0aW9uID09PSBcImZpeGVkXCIgKSAmJlxuXHRcdFx0KCBjdXJDU1NUb3AgKyBjdXJDU1NMZWZ0ICkuaW5kZXhPZihcImF1dG9cIikgPiAtMTtcblxuXHRcdC8vIE5lZWQgdG8gYmUgYWJsZSB0byBjYWxjdWxhdGUgcG9zaXRpb24gaWYgZWl0aGVyIHRvcCBvciBsZWZ0IGlzIGF1dG8gYW5kIHBvc2l0aW9uIGlzIGVpdGhlciBhYnNvbHV0ZSBvciBmaXhlZFxuXHRcdGlmICggY2FsY3VsYXRlUG9zaXRpb24gKSB7XG5cdFx0XHRjdXJQb3NpdGlvbiA9IGN1ckVsZW0ucG9zaXRpb24oKTtcblx0XHRcdGN1clRvcCA9IGN1clBvc2l0aW9uLnRvcDtcblx0XHRcdGN1ckxlZnQgPSBjdXJQb3NpdGlvbi5sZWZ0O1xuXG5cdFx0fSBlbHNlIHtcblx0XHRcdGN1clRvcCA9IHBhcnNlRmxvYXQoIGN1ckNTU1RvcCApIHx8IDA7XG5cdFx0XHRjdXJMZWZ0ID0gcGFyc2VGbG9hdCggY3VyQ1NTTGVmdCApIHx8IDA7XG5cdFx0fVxuXG5cdFx0aWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggb3B0aW9ucyApICkge1xuXHRcdFx0b3B0aW9ucyA9IG9wdGlvbnMuY2FsbCggZWxlbSwgaSwgY3VyT2Zmc2V0ICk7XG5cdFx0fVxuXG5cdFx0aWYgKCBvcHRpb25zLnRvcCAhPSBudWxsICkge1xuXHRcdFx0cHJvcHMudG9wID0gKCBvcHRpb25zLnRvcCAtIGN1ck9mZnNldC50b3AgKSArIGN1clRvcDtcblx0XHR9XG5cdFx0aWYgKCBvcHRpb25zLmxlZnQgIT0gbnVsbCApIHtcblx0XHRcdHByb3BzLmxlZnQgPSAoIG9wdGlvbnMubGVmdCAtIGN1ck9mZnNldC5sZWZ0ICkgKyBjdXJMZWZ0O1xuXHRcdH1cblxuXHRcdGlmICggXCJ1c2luZ1wiIGluIG9wdGlvbnMgKSB7XG5cdFx0XHRvcHRpb25zLnVzaW5nLmNhbGwoIGVsZW0sIHByb3BzICk7XG5cblx0XHR9IGVsc2Uge1xuXHRcdFx0Y3VyRWxlbS5jc3MoIHByb3BzICk7XG5cdFx0fVxuXHR9XG59O1xuXG5qUXVlcnkuZm4uZXh0ZW5kKHtcblx0b2Zmc2V0OiBmdW5jdGlvbiggb3B0aW9ucyApIHtcblx0XHRpZiAoIGFyZ3VtZW50cy5sZW5ndGggKSB7XG5cdFx0XHRyZXR1cm4gb3B0aW9ucyA9PT0gdW5kZWZpbmVkID9cblx0XHRcdFx0dGhpcyA6XG5cdFx0XHRcdHRoaXMuZWFjaChmdW5jdGlvbiggaSApIHtcblx0XHRcdFx0XHRqUXVlcnkub2Zmc2V0LnNldE9mZnNldCggdGhpcywgb3B0aW9ucywgaSApO1xuXHRcdFx0XHR9KTtcblx0XHR9XG5cblx0XHR2YXIgZG9jRWxlbSwgd2luLFxuXHRcdFx0ZWxlbSA9IHRoaXNbIDAgXSxcblx0XHRcdGJveCA9IHsgdG9wOiAwLCBsZWZ0OiAwIH0sXG5cdFx0XHRkb2MgPSBlbGVtICYmIGVsZW0ub3duZXJEb2N1bWVudDtcblxuXHRcdGlmICggIWRvYyApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRkb2NFbGVtID0gZG9jLmRvY3VtZW50RWxlbWVudDtcblxuXHRcdC8vIE1ha2Ugc3VyZSBpdCdzIG5vdCBhIGRpc2Nvbm5lY3RlZCBET00gbm9kZVxuXHRcdGlmICggIWpRdWVyeS5jb250YWlucyggZG9jRWxlbSwgZWxlbSApICkge1xuXHRcdFx0cmV0dXJuIGJveDtcblx0XHR9XG5cblx0XHQvLyBJZiB3ZSBkb24ndCBoYXZlIGdCQ1IsIGp1c3QgdXNlIDAsMCByYXRoZXIgdGhhbiBlcnJvclxuXHRcdC8vIEJsYWNrQmVycnkgNSwgaU9TIDMgKG9yaWdpbmFsIGlQaG9uZSlcblx0XHRpZiAoIHR5cGVvZiBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCAhPT0gc3RydW5kZWZpbmVkICkge1xuXHRcdFx0Ym94ID0gZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblx0XHR9XG5cdFx0d2luID0gZ2V0V2luZG93KCBkb2MgKTtcblx0XHRyZXR1cm4ge1xuXHRcdFx0dG9wOiBib3gudG9wICsgd2luLnBhZ2VZT2Zmc2V0IC0gZG9jRWxlbS5jbGllbnRUb3AsXG5cdFx0XHRsZWZ0OiBib3gubGVmdCArIHdpbi5wYWdlWE9mZnNldCAtIGRvY0VsZW0uY2xpZW50TGVmdFxuXHRcdH07XG5cdH0sXG5cblx0cG9zaXRpb246IGZ1bmN0aW9uKCkge1xuXHRcdGlmICggIXRoaXNbIDAgXSApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHR2YXIgb2Zmc2V0UGFyZW50LCBvZmZzZXQsXG5cdFx0XHRlbGVtID0gdGhpc1sgMCBdLFxuXHRcdFx0cGFyZW50T2Zmc2V0ID0geyB0b3A6IDAsIGxlZnQ6IDAgfTtcblxuXHRcdC8vIEZpeGVkIGVsZW1lbnRzIGFyZSBvZmZzZXQgZnJvbSB3aW5kb3cgKHBhcmVudE9mZnNldCA9IHt0b3A6MCwgbGVmdDogMH0sIGJlY2F1c2UgaXQgaXMgaXRzIG9ubHkgb2Zmc2V0IHBhcmVudFxuXHRcdGlmICggalF1ZXJ5LmNzcyggZWxlbSwgXCJwb3NpdGlvblwiICkgPT09IFwiZml4ZWRcIiApIHtcblx0XHRcdC8vIFdlIGFzc3VtZSB0aGF0IGdldEJvdW5kaW5nQ2xpZW50UmVjdCBpcyBhdmFpbGFibGUgd2hlbiBjb21wdXRlZCBwb3NpdGlvbiBpcyBmaXhlZFxuXHRcdFx0b2Zmc2V0ID0gZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBHZXQgKnJlYWwqIG9mZnNldFBhcmVudFxuXHRcdFx0b2Zmc2V0UGFyZW50ID0gdGhpcy5vZmZzZXRQYXJlbnQoKTtcblxuXHRcdFx0Ly8gR2V0IGNvcnJlY3Qgb2Zmc2V0c1xuXHRcdFx0b2Zmc2V0ID0gdGhpcy5vZmZzZXQoKTtcblx0XHRcdGlmICggIWpRdWVyeS5ub2RlTmFtZSggb2Zmc2V0UGFyZW50WyAwIF0sIFwiaHRtbFwiICkgKSB7XG5cdFx0XHRcdHBhcmVudE9mZnNldCA9IG9mZnNldFBhcmVudC5vZmZzZXQoKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQWRkIG9mZnNldFBhcmVudCBib3JkZXJzXG5cdFx0XHRwYXJlbnRPZmZzZXQudG9wICs9IGpRdWVyeS5jc3MoIG9mZnNldFBhcmVudFsgMCBdLCBcImJvcmRlclRvcFdpZHRoXCIsIHRydWUgKTtcblx0XHRcdHBhcmVudE9mZnNldC5sZWZ0ICs9IGpRdWVyeS5jc3MoIG9mZnNldFBhcmVudFsgMCBdLCBcImJvcmRlckxlZnRXaWR0aFwiLCB0cnVlICk7XG5cdFx0fVxuXG5cdFx0Ly8gU3VidHJhY3QgcGFyZW50IG9mZnNldHMgYW5kIGVsZW1lbnQgbWFyZ2luc1xuXHRcdHJldHVybiB7XG5cdFx0XHR0b3A6IG9mZnNldC50b3AgLSBwYXJlbnRPZmZzZXQudG9wIC0galF1ZXJ5LmNzcyggZWxlbSwgXCJtYXJnaW5Ub3BcIiwgdHJ1ZSApLFxuXHRcdFx0bGVmdDogb2Zmc2V0LmxlZnQgLSBwYXJlbnRPZmZzZXQubGVmdCAtIGpRdWVyeS5jc3MoIGVsZW0sIFwibWFyZ2luTGVmdFwiLCB0cnVlIClcblx0XHR9O1xuXHR9LFxuXG5cdG9mZnNldFBhcmVudDogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIG9mZnNldFBhcmVudCA9IHRoaXMub2Zmc2V0UGFyZW50IHx8IGRvY0VsZW07XG5cblx0XHRcdHdoaWxlICggb2Zmc2V0UGFyZW50ICYmICggIWpRdWVyeS5ub2RlTmFtZSggb2Zmc2V0UGFyZW50LCBcImh0bWxcIiApICYmIGpRdWVyeS5jc3MoIG9mZnNldFBhcmVudCwgXCJwb3NpdGlvblwiICkgPT09IFwic3RhdGljXCIgKSApIHtcblx0XHRcdFx0b2Zmc2V0UGFyZW50ID0gb2Zmc2V0UGFyZW50Lm9mZnNldFBhcmVudDtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIG9mZnNldFBhcmVudCB8fCBkb2NFbGVtO1xuXHRcdH0pO1xuXHR9XG59KTtcblxuLy8gQ3JlYXRlIHNjcm9sbExlZnQgYW5kIHNjcm9sbFRvcCBtZXRob2RzXG5qUXVlcnkuZWFjaCggeyBzY3JvbGxMZWZ0OiBcInBhZ2VYT2Zmc2V0XCIsIHNjcm9sbFRvcDogXCJwYWdlWU9mZnNldFwiIH0sIGZ1bmN0aW9uKCBtZXRob2QsIHByb3AgKSB7XG5cdHZhciB0b3AgPSBcInBhZ2VZT2Zmc2V0XCIgPT09IHByb3A7XG5cblx0alF1ZXJ5LmZuWyBtZXRob2QgXSA9IGZ1bmN0aW9uKCB2YWwgKSB7XG5cdFx0cmV0dXJuIGFjY2VzcyggdGhpcywgZnVuY3Rpb24oIGVsZW0sIG1ldGhvZCwgdmFsICkge1xuXHRcdFx0dmFyIHdpbiA9IGdldFdpbmRvdyggZWxlbSApO1xuXG5cdFx0XHRpZiAoIHZhbCA9PT0gdW5kZWZpbmVkICkge1xuXHRcdFx0XHRyZXR1cm4gd2luID8gd2luWyBwcm9wIF0gOiBlbGVtWyBtZXRob2QgXTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCB3aW4gKSB7XG5cdFx0XHRcdHdpbi5zY3JvbGxUbyhcblx0XHRcdFx0XHQhdG9wID8gdmFsIDogd2luZG93LnBhZ2VYT2Zmc2V0LFxuXHRcdFx0XHRcdHRvcCA/IHZhbCA6IHdpbmRvdy5wYWdlWU9mZnNldFxuXHRcdFx0XHQpO1xuXG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRlbGVtWyBtZXRob2QgXSA9IHZhbDtcblx0XHRcdH1cblx0XHR9LCBtZXRob2QsIHZhbCwgYXJndW1lbnRzLmxlbmd0aCwgbnVsbCApO1xuXHR9O1xufSk7XG5cbi8vIEFkZCB0aGUgdG9wL2xlZnQgY3NzSG9va3MgdXNpbmcgalF1ZXJ5LmZuLnBvc2l0aW9uXG4vLyBXZWJraXQgYnVnOiBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MjkwODRcbi8vIGdldENvbXB1dGVkU3R5bGUgcmV0dXJucyBwZXJjZW50IHdoZW4gc3BlY2lmaWVkIGZvciB0b3AvbGVmdC9ib3R0b20vcmlnaHRcbi8vIHJhdGhlciB0aGFuIG1ha2UgdGhlIGNzcyBtb2R1bGUgZGVwZW5kIG9uIHRoZSBvZmZzZXQgbW9kdWxlLCB3ZSBqdXN0IGNoZWNrIGZvciBpdCBoZXJlXG5qUXVlcnkuZWFjaCggWyBcInRvcFwiLCBcImxlZnRcIiBdLCBmdW5jdGlvbiggaSwgcHJvcCApIHtcblx0alF1ZXJ5LmNzc0hvb2tzWyBwcm9wIF0gPSBhZGRHZXRIb29rSWYoIHN1cHBvcnQucGl4ZWxQb3NpdGlvbixcblx0XHRmdW5jdGlvbiggZWxlbSwgY29tcHV0ZWQgKSB7XG5cdFx0XHRpZiAoIGNvbXB1dGVkICkge1xuXHRcdFx0XHRjb21wdXRlZCA9IGN1ckNTUyggZWxlbSwgcHJvcCApO1xuXHRcdFx0XHQvLyBpZiBjdXJDU1MgcmV0dXJucyBwZXJjZW50YWdlLCBmYWxsYmFjayB0byBvZmZzZXRcblx0XHRcdFx0cmV0dXJuIHJudW1ub25weC50ZXN0KCBjb21wdXRlZCApID9cblx0XHRcdFx0XHRqUXVlcnkoIGVsZW0gKS5wb3NpdGlvbigpWyBwcm9wIF0gKyBcInB4XCIgOlxuXHRcdFx0XHRcdGNvbXB1dGVkO1xuXHRcdFx0fVxuXHRcdH1cblx0KTtcbn0pO1xuXG5cbi8vIENyZWF0ZSBpbm5lckhlaWdodCwgaW5uZXJXaWR0aCwgaGVpZ2h0LCB3aWR0aCwgb3V0ZXJIZWlnaHQgYW5kIG91dGVyV2lkdGggbWV0aG9kc1xualF1ZXJ5LmVhY2goIHsgSGVpZ2h0OiBcImhlaWdodFwiLCBXaWR0aDogXCJ3aWR0aFwiIH0sIGZ1bmN0aW9uKCBuYW1lLCB0eXBlICkge1xuXHRqUXVlcnkuZWFjaCggeyBwYWRkaW5nOiBcImlubmVyXCIgKyBuYW1lLCBjb250ZW50OiB0eXBlLCBcIlwiOiBcIm91dGVyXCIgKyBuYW1lIH0sIGZ1bmN0aW9uKCBkZWZhdWx0RXh0cmEsIGZ1bmNOYW1lICkge1xuXHRcdC8vIG1hcmdpbiBpcyBvbmx5IGZvciBvdXRlckhlaWdodCwgb3V0ZXJXaWR0aFxuXHRcdGpRdWVyeS5mblsgZnVuY05hbWUgXSA9IGZ1bmN0aW9uKCBtYXJnaW4sIHZhbHVlICkge1xuXHRcdFx0dmFyIGNoYWluYWJsZSA9IGFyZ3VtZW50cy5sZW5ndGggJiYgKCBkZWZhdWx0RXh0cmEgfHwgdHlwZW9mIG1hcmdpbiAhPT0gXCJib29sZWFuXCIgKSxcblx0XHRcdFx0ZXh0cmEgPSBkZWZhdWx0RXh0cmEgfHwgKCBtYXJnaW4gPT09IHRydWUgfHwgdmFsdWUgPT09IHRydWUgPyBcIm1hcmdpblwiIDogXCJib3JkZXJcIiApO1xuXG5cdFx0XHRyZXR1cm4gYWNjZXNzKCB0aGlzLCBmdW5jdGlvbiggZWxlbSwgdHlwZSwgdmFsdWUgKSB7XG5cdFx0XHRcdHZhciBkb2M7XG5cblx0XHRcdFx0aWYgKCBqUXVlcnkuaXNXaW5kb3coIGVsZW0gKSApIHtcblx0XHRcdFx0XHQvLyBBcyBvZiA1LzgvMjAxMiB0aGlzIHdpbGwgeWllbGQgaW5jb3JyZWN0IHJlc3VsdHMgZm9yIE1vYmlsZSBTYWZhcmksIGJ1dCB0aGVyZVxuXHRcdFx0XHRcdC8vIGlzbid0IGEgd2hvbGUgbG90IHdlIGNhbiBkby4gU2VlIHB1bGwgcmVxdWVzdCBhdCB0aGlzIFVSTCBmb3IgZGlzY3Vzc2lvbjpcblx0XHRcdFx0XHQvLyBodHRwczovL2dpdGh1Yi5jb20vanF1ZXJ5L2pxdWVyeS9wdWxsLzc2NFxuXHRcdFx0XHRcdHJldHVybiBlbGVtLmRvY3VtZW50LmRvY3VtZW50RWxlbWVudFsgXCJjbGllbnRcIiArIG5hbWUgXTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIEdldCBkb2N1bWVudCB3aWR0aCBvciBoZWlnaHRcblx0XHRcdFx0aWYgKCBlbGVtLm5vZGVUeXBlID09PSA5ICkge1xuXHRcdFx0XHRcdGRvYyA9IGVsZW0uZG9jdW1lbnRFbGVtZW50O1xuXG5cdFx0XHRcdFx0Ly8gRWl0aGVyIHNjcm9sbFtXaWR0aC9IZWlnaHRdIG9yIG9mZnNldFtXaWR0aC9IZWlnaHRdIG9yIGNsaWVudFtXaWR0aC9IZWlnaHRdLFxuXHRcdFx0XHRcdC8vIHdoaWNoZXZlciBpcyBncmVhdGVzdFxuXHRcdFx0XHRcdHJldHVybiBNYXRoLm1heChcblx0XHRcdFx0XHRcdGVsZW0uYm9keVsgXCJzY3JvbGxcIiArIG5hbWUgXSwgZG9jWyBcInNjcm9sbFwiICsgbmFtZSBdLFxuXHRcdFx0XHRcdFx0ZWxlbS5ib2R5WyBcIm9mZnNldFwiICsgbmFtZSBdLCBkb2NbIFwib2Zmc2V0XCIgKyBuYW1lIF0sXG5cdFx0XHRcdFx0XHRkb2NbIFwiY2xpZW50XCIgKyBuYW1lIF1cblx0XHRcdFx0XHQpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmV0dXJuIHZhbHVlID09PSB1bmRlZmluZWQgP1xuXHRcdFx0XHRcdC8vIEdldCB3aWR0aCBvciBoZWlnaHQgb24gdGhlIGVsZW1lbnQsIHJlcXVlc3RpbmcgYnV0IG5vdCBmb3JjaW5nIHBhcnNlRmxvYXRcblx0XHRcdFx0XHRqUXVlcnkuY3NzKCBlbGVtLCB0eXBlLCBleHRyYSApIDpcblxuXHRcdFx0XHRcdC8vIFNldCB3aWR0aCBvciBoZWlnaHQgb24gdGhlIGVsZW1lbnRcblx0XHRcdFx0XHRqUXVlcnkuc3R5bGUoIGVsZW0sIHR5cGUsIHZhbHVlLCBleHRyYSApO1xuXHRcdFx0fSwgdHlwZSwgY2hhaW5hYmxlID8gbWFyZ2luIDogdW5kZWZpbmVkLCBjaGFpbmFibGUsIG51bGwgKTtcblx0XHR9O1xuXHR9KTtcbn0pO1xuXG5cbi8vIFRoZSBudW1iZXIgb2YgZWxlbWVudHMgY29udGFpbmVkIGluIHRoZSBtYXRjaGVkIGVsZW1lbnQgc2V0XG5qUXVlcnkuZm4uc2l6ZSA9IGZ1bmN0aW9uKCkge1xuXHRyZXR1cm4gdGhpcy5sZW5ndGg7XG59O1xuXG5qUXVlcnkuZm4uYW5kU2VsZiA9IGpRdWVyeS5mbi5hZGRCYWNrO1xuXG5cblxuXG4vLyBSZWdpc3RlciBhcyBhIG5hbWVkIEFNRCBtb2R1bGUsIHNpbmNlIGpRdWVyeSBjYW4gYmUgY29uY2F0ZW5hdGVkIHdpdGggb3RoZXJcbi8vIGZpbGVzIHRoYXQgbWF5IHVzZSBkZWZpbmUsIGJ1dCBub3QgdmlhIGEgcHJvcGVyIGNvbmNhdGVuYXRpb24gc2NyaXB0IHRoYXRcbi8vIHVuZGVyc3RhbmRzIGFub255bW91cyBBTUQgbW9kdWxlcy4gQSBuYW1lZCBBTUQgaXMgc2FmZXN0IGFuZCBtb3N0IHJvYnVzdFxuLy8gd2F5IHRvIHJlZ2lzdGVyLiBMb3dlcmNhc2UganF1ZXJ5IGlzIHVzZWQgYmVjYXVzZSBBTUQgbW9kdWxlIG5hbWVzIGFyZVxuLy8gZGVyaXZlZCBmcm9tIGZpbGUgbmFtZXMsIGFuZCBqUXVlcnkgaXMgbm9ybWFsbHkgZGVsaXZlcmVkIGluIGEgbG93ZXJjYXNlXG4vLyBmaWxlIG5hbWUuIERvIHRoaXMgYWZ0ZXIgY3JlYXRpbmcgdGhlIGdsb2JhbCBzbyB0aGF0IGlmIGFuIEFNRCBtb2R1bGUgd2FudHNcbi8vIHRvIGNhbGwgbm9Db25mbGljdCB0byBoaWRlIHRoaXMgdmVyc2lvbiBvZiBqUXVlcnksIGl0IHdpbGwgd29yay5cblxuLy8gTm90ZSB0aGF0IGZvciBtYXhpbXVtIHBvcnRhYmlsaXR5LCBsaWJyYXJpZXMgdGhhdCBhcmUgbm90IGpRdWVyeSBzaG91bGRcbi8vIGRlY2xhcmUgdGhlbXNlbHZlcyBhcyBhbm9ueW1vdXMgbW9kdWxlcywgYW5kIGF2b2lkIHNldHRpbmcgYSBnbG9iYWwgaWYgYW5cbi8vIEFNRCBsb2FkZXIgaXMgcHJlc2VudC4galF1ZXJ5IGlzIGEgc3BlY2lhbCBjYXNlLiBGb3IgbW9yZSBpbmZvcm1hdGlvbiwgc2VlXG4vLyBodHRwczovL2dpdGh1Yi5jb20vanJidXJrZS9yZXF1aXJlanMvd2lraS9VcGRhdGluZy1leGlzdGluZy1saWJyYXJpZXMjd2lraS1hbm9uXG5cbmlmICggdHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQgKSB7XG5cdGRlZmluZSggXCJqcXVlcnlcIiwgW10sIGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiBqUXVlcnk7XG5cdH0pO1xufVxuXG5cblxuXG52YXJcblx0Ly8gTWFwIG92ZXIgalF1ZXJ5IGluIGNhc2Ugb2Ygb3ZlcndyaXRlXG5cdF9qUXVlcnkgPSB3aW5kb3cualF1ZXJ5LFxuXG5cdC8vIE1hcCBvdmVyIHRoZSAkIGluIGNhc2Ugb2Ygb3ZlcndyaXRlXG5cdF8kID0gd2luZG93LiQ7XG5cbmpRdWVyeS5ub0NvbmZsaWN0ID0gZnVuY3Rpb24oIGRlZXAgKSB7XG5cdGlmICggd2luZG93LiQgPT09IGpRdWVyeSApIHtcblx0XHR3aW5kb3cuJCA9IF8kO1xuXHR9XG5cblx0aWYgKCBkZWVwICYmIHdpbmRvdy5qUXVlcnkgPT09IGpRdWVyeSApIHtcblx0XHR3aW5kb3cualF1ZXJ5ID0gX2pRdWVyeTtcblx0fVxuXG5cdHJldHVybiBqUXVlcnk7XG59O1xuXG4vLyBFeHBvc2UgalF1ZXJ5IGFuZCAkIGlkZW50aWZpZXJzLCBldmVuIGluXG4vLyBBTUQgKCM3MTAyI2NvbW1lbnQ6MTAsIGh0dHBzOi8vZ2l0aHViLmNvbS9qcXVlcnkvanF1ZXJ5L3B1bGwvNTU3KVxuLy8gYW5kIENvbW1vbkpTIGZvciBicm93c2VyIGVtdWxhdG9ycyAoIzEzNTY2KVxuaWYgKCB0eXBlb2Ygbm9HbG9iYWwgPT09IHN0cnVuZGVmaW5lZCApIHtcblx0d2luZG93LmpRdWVyeSA9IHdpbmRvdy4kID0galF1ZXJ5O1xufVxuXG5cblxuXG5yZXR1cm4galF1ZXJ5O1xuXG59KSk7XG4iLCIoZnVuY3Rpb24gKGdsb2JhbCl7XG4vKipcbiAqIEBsaWNlbnNlXG4gKiBMby1EYXNoIDIuNC4xIChDdXN0b20gQnVpbGQpIDxodHRwOi8vbG9kYXNoLmNvbS8+XG4gKiBCdWlsZDogYGxvZGFzaCBtb2Rlcm4gLW8gLi9kaXN0L2xvZGFzaC5qc2BcbiAqIENvcHlyaWdodCAyMDEyLTIwMTMgVGhlIERvam8gRm91bmRhdGlvbiA8aHR0cDovL2Rvam9mb3VuZGF0aW9uLm9yZy8+XG4gKiBCYXNlZCBvbiBVbmRlcnNjb3JlLmpzIDEuNS4yIDxodHRwOi8vdW5kZXJzY29yZWpzLm9yZy9MSUNFTlNFPlxuICogQ29weXJpZ2h0IDIwMDktMjAxMyBKZXJlbXkgQXNoa2VuYXMsIERvY3VtZW50Q2xvdWQgYW5kIEludmVzdGlnYXRpdmUgUmVwb3J0ZXJzICYgRWRpdG9yc1xuICogQXZhaWxhYmxlIHVuZGVyIE1JVCBsaWNlbnNlIDxodHRwOi8vbG9kYXNoLmNvbS9saWNlbnNlPlxuICovXG47KGZ1bmN0aW9uKCkge1xuXG4gIC8qKiBVc2VkIGFzIGEgc2FmZSByZWZlcmVuY2UgZm9yIGB1bmRlZmluZWRgIGluIHByZSBFUzUgZW52aXJvbm1lbnRzICovXG4gIHZhciB1bmRlZmluZWQ7XG5cbiAgLyoqIFVzZWQgdG8gcG9vbCBhcnJheXMgYW5kIG9iamVjdHMgdXNlZCBpbnRlcm5hbGx5ICovXG4gIHZhciBhcnJheVBvb2wgPSBbXSxcbiAgICAgIG9iamVjdFBvb2wgPSBbXTtcblxuICAvKiogVXNlZCB0byBnZW5lcmF0ZSB1bmlxdWUgSURzICovXG4gIHZhciBpZENvdW50ZXIgPSAwO1xuXG4gIC8qKiBVc2VkIHRvIHByZWZpeCBrZXlzIHRvIGF2b2lkIGlzc3VlcyB3aXRoIGBfX3Byb3RvX19gIGFuZCBwcm9wZXJ0aWVzIG9uIGBPYmplY3QucHJvdG90eXBlYCAqL1xuICB2YXIga2V5UHJlZml4ID0gK25ldyBEYXRlICsgJyc7XG5cbiAgLyoqIFVzZWQgYXMgdGhlIHNpemUgd2hlbiBvcHRpbWl6YXRpb25zIGFyZSBlbmFibGVkIGZvciBsYXJnZSBhcnJheXMgKi9cbiAgdmFyIGxhcmdlQXJyYXlTaXplID0gNzU7XG5cbiAgLyoqIFVzZWQgYXMgdGhlIG1heCBzaXplIG9mIHRoZSBgYXJyYXlQb29sYCBhbmQgYG9iamVjdFBvb2xgICovXG4gIHZhciBtYXhQb29sU2l6ZSA9IDQwO1xuXG4gIC8qKiBVc2VkIHRvIGRldGVjdCBhbmQgdGVzdCB3aGl0ZXNwYWNlICovXG4gIHZhciB3aGl0ZXNwYWNlID0gKFxuICAgIC8vIHdoaXRlc3BhY2VcbiAgICAnIFxcdFxceDBCXFxmXFx4QTBcXHVmZWZmJyArXG5cbiAgICAvLyBsaW5lIHRlcm1pbmF0b3JzXG4gICAgJ1xcblxcclxcdTIwMjhcXHUyMDI5JyArXG5cbiAgICAvLyB1bmljb2RlIGNhdGVnb3J5IFwiWnNcIiBzcGFjZSBzZXBhcmF0b3JzXG4gICAgJ1xcdTE2ODBcXHUxODBlXFx1MjAwMFxcdTIwMDFcXHUyMDAyXFx1MjAwM1xcdTIwMDRcXHUyMDA1XFx1MjAwNlxcdTIwMDdcXHUyMDA4XFx1MjAwOVxcdTIwMGFcXHUyMDJmXFx1MjA1ZlxcdTMwMDAnXG4gICk7XG5cbiAgLyoqIFVzZWQgdG8gbWF0Y2ggZW1wdHkgc3RyaW5nIGxpdGVyYWxzIGluIGNvbXBpbGVkIHRlbXBsYXRlIHNvdXJjZSAqL1xuICB2YXIgcmVFbXB0eVN0cmluZ0xlYWRpbmcgPSAvXFxiX19wIFxcKz0gJyc7L2csXG4gICAgICByZUVtcHR5U3RyaW5nTWlkZGxlID0gL1xcYihfX3AgXFwrPSkgJycgXFwrL2csXG4gICAgICByZUVtcHR5U3RyaW5nVHJhaWxpbmcgPSAvKF9fZVxcKC4qP1xcKXxcXGJfX3RcXCkpIFxcK1xcbicnOy9nO1xuXG4gIC8qKlxuICAgKiBVc2VkIHRvIG1hdGNoIEVTNiB0ZW1wbGF0ZSBkZWxpbWl0ZXJzXG4gICAqIGh0dHA6Ly9wZW9wbGUubW96aWxsYS5vcmcvfmpvcmVuZG9yZmYvZXM2LWRyYWZ0Lmh0bWwjc2VjLWxpdGVyYWxzLXN0cmluZy1saXRlcmFsc1xuICAgKi9cbiAgdmFyIHJlRXNUZW1wbGF0ZSA9IC9cXCRcXHsoW15cXFxcfV0qKD86XFxcXC5bXlxcXFx9XSopKilcXH0vZztcblxuICAvKiogVXNlZCB0byBtYXRjaCByZWdleHAgZmxhZ3MgZnJvbSB0aGVpciBjb2VyY2VkIHN0cmluZyB2YWx1ZXMgKi9cbiAgdmFyIHJlRmxhZ3MgPSAvXFx3KiQvO1xuXG4gIC8qKiBVc2VkIHRvIGRldGVjdGVkIG5hbWVkIGZ1bmN0aW9ucyAqL1xuICB2YXIgcmVGdW5jTmFtZSA9IC9eXFxzKmZ1bmN0aW9uWyBcXG5cXHJcXHRdK1xcdy87XG5cbiAgLyoqIFVzZWQgdG8gbWF0Y2ggXCJpbnRlcnBvbGF0ZVwiIHRlbXBsYXRlIGRlbGltaXRlcnMgKi9cbiAgdmFyIHJlSW50ZXJwb2xhdGUgPSAvPCU9KFtcXHNcXFNdKz8pJT4vZztcblxuICAvKiogVXNlZCB0byBtYXRjaCBsZWFkaW5nIHdoaXRlc3BhY2UgYW5kIHplcm9zIHRvIGJlIHJlbW92ZWQgKi9cbiAgdmFyIHJlTGVhZGluZ1NwYWNlc0FuZFplcm9zID0gUmVnRXhwKCdeWycgKyB3aGl0ZXNwYWNlICsgJ10qMCsoPz0uJCknKTtcblxuICAvKiogVXNlZCB0byBlbnN1cmUgY2FwdHVyaW5nIG9yZGVyIG9mIHRlbXBsYXRlIGRlbGltaXRlcnMgKi9cbiAgdmFyIHJlTm9NYXRjaCA9IC8oJF4pLztcblxuICAvKiogVXNlZCB0byBkZXRlY3QgZnVuY3Rpb25zIGNvbnRhaW5pbmcgYSBgdGhpc2AgcmVmZXJlbmNlICovXG4gIHZhciByZVRoaXMgPSAvXFxidGhpc1xcYi87XG5cbiAgLyoqIFVzZWQgdG8gbWF0Y2ggdW5lc2NhcGVkIGNoYXJhY3RlcnMgaW4gY29tcGlsZWQgc3RyaW5nIGxpdGVyYWxzICovXG4gIHZhciByZVVuZXNjYXBlZFN0cmluZyA9IC9bJ1xcblxcclxcdFxcdTIwMjhcXHUyMDI5XFxcXF0vZztcblxuICAvKiogVXNlZCB0byBhc3NpZ24gZGVmYXVsdCBgY29udGV4dGAgb2JqZWN0IHByb3BlcnRpZXMgKi9cbiAgdmFyIGNvbnRleHRQcm9wcyA9IFtcbiAgICAnQXJyYXknLCAnQm9vbGVhbicsICdEYXRlJywgJ0Z1bmN0aW9uJywgJ01hdGgnLCAnTnVtYmVyJywgJ09iamVjdCcsXG4gICAgJ1JlZ0V4cCcsICdTdHJpbmcnLCAnXycsICdhdHRhY2hFdmVudCcsICdjbGVhclRpbWVvdXQnLCAnaXNGaW5pdGUnLCAnaXNOYU4nLFxuICAgICdwYXJzZUludCcsICdzZXRUaW1lb3V0J1xuICBdO1xuXG4gIC8qKiBVc2VkIHRvIG1ha2UgdGVtcGxhdGUgc291cmNlVVJMcyBlYXNpZXIgdG8gaWRlbnRpZnkgKi9cbiAgdmFyIHRlbXBsYXRlQ291bnRlciA9IDA7XG5cbiAgLyoqIGBPYmplY3QjdG9TdHJpbmdgIHJlc3VsdCBzaG9ydGN1dHMgKi9cbiAgdmFyIGFyZ3NDbGFzcyA9ICdbb2JqZWN0IEFyZ3VtZW50c10nLFxuICAgICAgYXJyYXlDbGFzcyA9ICdbb2JqZWN0IEFycmF5XScsXG4gICAgICBib29sQ2xhc3MgPSAnW29iamVjdCBCb29sZWFuXScsXG4gICAgICBkYXRlQ2xhc3MgPSAnW29iamVjdCBEYXRlXScsXG4gICAgICBmdW5jQ2xhc3MgPSAnW29iamVjdCBGdW5jdGlvbl0nLFxuICAgICAgbnVtYmVyQ2xhc3MgPSAnW29iamVjdCBOdW1iZXJdJyxcbiAgICAgIG9iamVjdENsYXNzID0gJ1tvYmplY3QgT2JqZWN0XScsXG4gICAgICByZWdleHBDbGFzcyA9ICdbb2JqZWN0IFJlZ0V4cF0nLFxuICAgICAgc3RyaW5nQ2xhc3MgPSAnW29iamVjdCBTdHJpbmddJztcblxuICAvKiogVXNlZCB0byBpZGVudGlmeSBvYmplY3QgY2xhc3NpZmljYXRpb25zIHRoYXQgYF8uY2xvbmVgIHN1cHBvcnRzICovXG4gIHZhciBjbG9uZWFibGVDbGFzc2VzID0ge307XG4gIGNsb25lYWJsZUNsYXNzZXNbZnVuY0NsYXNzXSA9IGZhbHNlO1xuICBjbG9uZWFibGVDbGFzc2VzW2FyZ3NDbGFzc10gPSBjbG9uZWFibGVDbGFzc2VzW2FycmF5Q2xhc3NdID1cbiAgY2xvbmVhYmxlQ2xhc3Nlc1tib29sQ2xhc3NdID0gY2xvbmVhYmxlQ2xhc3Nlc1tkYXRlQ2xhc3NdID1cbiAgY2xvbmVhYmxlQ2xhc3Nlc1tudW1iZXJDbGFzc10gPSBjbG9uZWFibGVDbGFzc2VzW29iamVjdENsYXNzXSA9XG4gIGNsb25lYWJsZUNsYXNzZXNbcmVnZXhwQ2xhc3NdID0gY2xvbmVhYmxlQ2xhc3Nlc1tzdHJpbmdDbGFzc10gPSB0cnVlO1xuXG4gIC8qKiBVc2VkIGFzIGFuIGludGVybmFsIGBfLmRlYm91bmNlYCBvcHRpb25zIG9iamVjdCAqL1xuICB2YXIgZGVib3VuY2VPcHRpb25zID0ge1xuICAgICdsZWFkaW5nJzogZmFsc2UsXG4gICAgJ21heFdhaXQnOiAwLFxuICAgICd0cmFpbGluZyc6IGZhbHNlXG4gIH07XG5cbiAgLyoqIFVzZWQgYXMgdGhlIHByb3BlcnR5IGRlc2NyaXB0b3IgZm9yIGBfX2JpbmREYXRhX19gICovXG4gIHZhciBkZXNjcmlwdG9yID0ge1xuICAgICdjb25maWd1cmFibGUnOiBmYWxzZSxcbiAgICAnZW51bWVyYWJsZSc6IGZhbHNlLFxuICAgICd2YWx1ZSc6IG51bGwsXG4gICAgJ3dyaXRhYmxlJzogZmFsc2VcbiAgfTtcblxuICAvKiogVXNlZCB0byBkZXRlcm1pbmUgaWYgdmFsdWVzIGFyZSBvZiB0aGUgbGFuZ3VhZ2UgdHlwZSBPYmplY3QgKi9cbiAgdmFyIG9iamVjdFR5cGVzID0ge1xuICAgICdib29sZWFuJzogZmFsc2UsXG4gICAgJ2Z1bmN0aW9uJzogdHJ1ZSxcbiAgICAnb2JqZWN0JzogdHJ1ZSxcbiAgICAnbnVtYmVyJzogZmFsc2UsXG4gICAgJ3N0cmluZyc6IGZhbHNlLFxuICAgICd1bmRlZmluZWQnOiBmYWxzZVxuICB9O1xuXG4gIC8qKiBVc2VkIHRvIGVzY2FwZSBjaGFyYWN0ZXJzIGZvciBpbmNsdXNpb24gaW4gY29tcGlsZWQgc3RyaW5nIGxpdGVyYWxzICovXG4gIHZhciBzdHJpbmdFc2NhcGVzID0ge1xuICAgICdcXFxcJzogJ1xcXFwnLFxuICAgIFwiJ1wiOiBcIidcIixcbiAgICAnXFxuJzogJ24nLFxuICAgICdcXHInOiAncicsXG4gICAgJ1xcdCc6ICd0JyxcbiAgICAnXFx1MjAyOCc6ICd1MjAyOCcsXG4gICAgJ1xcdTIwMjknOiAndTIwMjknXG4gIH07XG5cbiAgLyoqIFVzZWQgYXMgYSByZWZlcmVuY2UgdG8gdGhlIGdsb2JhbCBvYmplY3QgKi9cbiAgdmFyIHJvb3QgPSAob2JqZWN0VHlwZXNbdHlwZW9mIHdpbmRvd10gJiYgd2luZG93KSB8fCB0aGlzO1xuXG4gIC8qKiBEZXRlY3QgZnJlZSB2YXJpYWJsZSBgZXhwb3J0c2AgKi9cbiAgdmFyIGZyZWVFeHBvcnRzID0gb2JqZWN0VHlwZXNbdHlwZW9mIGV4cG9ydHNdICYmIGV4cG9ydHMgJiYgIWV4cG9ydHMubm9kZVR5cGUgJiYgZXhwb3J0cztcblxuICAvKiogRGV0ZWN0IGZyZWUgdmFyaWFibGUgYG1vZHVsZWAgKi9cbiAgdmFyIGZyZWVNb2R1bGUgPSBvYmplY3RUeXBlc1t0eXBlb2YgbW9kdWxlXSAmJiBtb2R1bGUgJiYgIW1vZHVsZS5ub2RlVHlwZSAmJiBtb2R1bGU7XG5cbiAgLyoqIERldGVjdCB0aGUgcG9wdWxhciBDb21tb25KUyBleHRlbnNpb24gYG1vZHVsZS5leHBvcnRzYCAqL1xuICB2YXIgbW9kdWxlRXhwb3J0cyA9IGZyZWVNb2R1bGUgJiYgZnJlZU1vZHVsZS5leHBvcnRzID09PSBmcmVlRXhwb3J0cyAmJiBmcmVlRXhwb3J0cztcblxuICAvKiogRGV0ZWN0IGZyZWUgdmFyaWFibGUgYGdsb2JhbGAgZnJvbSBOb2RlLmpzIG9yIEJyb3dzZXJpZmllZCBjb2RlIGFuZCB1c2UgaXQgYXMgYHJvb3RgICovXG4gIHZhciBmcmVlR2xvYmFsID0gb2JqZWN0VHlwZXNbdHlwZW9mIGdsb2JhbF0gJiYgZ2xvYmFsO1xuICBpZiAoZnJlZUdsb2JhbCAmJiAoZnJlZUdsb2JhbC5nbG9iYWwgPT09IGZyZWVHbG9iYWwgfHwgZnJlZUdsb2JhbC53aW5kb3cgPT09IGZyZWVHbG9iYWwpKSB7XG4gICAgcm9vdCA9IGZyZWVHbG9iYWw7XG4gIH1cblxuICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAvKipcbiAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8uaW5kZXhPZmAgd2l0aG91dCBzdXBwb3J0IGZvciBiaW5hcnkgc2VhcmNoZXNcbiAgICogb3IgYGZyb21JbmRleGAgY29uc3RyYWludHMuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBzZWFyY2guXG4gICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHNlYXJjaCBmb3IuXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBbZnJvbUluZGV4PTBdIFRoZSBpbmRleCB0byBzZWFyY2ggZnJvbS5cbiAgICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgaW5kZXggb2YgdGhlIG1hdGNoZWQgdmFsdWUgb3IgYC0xYC5cbiAgICovXG4gIGZ1bmN0aW9uIGJhc2VJbmRleE9mKGFycmF5LCB2YWx1ZSwgZnJvbUluZGV4KSB7XG4gICAgdmFyIGluZGV4ID0gKGZyb21JbmRleCB8fCAwKSAtIDEsXG4gICAgICAgIGxlbmd0aCA9IGFycmF5ID8gYXJyYXkubGVuZ3RoIDogMDtcblxuICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICBpZiAoYXJyYXlbaW5kZXhdID09PSB2YWx1ZSkge1xuICAgICAgICByZXR1cm4gaW5kZXg7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiAtMTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBbiBpbXBsZW1lbnRhdGlvbiBvZiBgXy5jb250YWluc2AgZm9yIGNhY2hlIG9iamVjdHMgdGhhdCBtaW1pY3MgdGhlIHJldHVyblxuICAgKiBzaWduYXR1cmUgb2YgYF8uaW5kZXhPZmAgYnkgcmV0dXJuaW5nIGAwYCBpZiB0aGUgdmFsdWUgaXMgZm91bmQsIGVsc2UgYC0xYC5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtPYmplY3R9IGNhY2hlIFRoZSBjYWNoZSBvYmplY3QgdG8gaW5zcGVjdC5cbiAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gc2VhcmNoIGZvci5cbiAgICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyBgMGAgaWYgYHZhbHVlYCBpcyBmb3VuZCwgZWxzZSBgLTFgLlxuICAgKi9cbiAgZnVuY3Rpb24gY2FjaGVJbmRleE9mKGNhY2hlLCB2YWx1ZSkge1xuICAgIHZhciB0eXBlID0gdHlwZW9mIHZhbHVlO1xuICAgIGNhY2hlID0gY2FjaGUuY2FjaGU7XG5cbiAgICBpZiAodHlwZSA9PSAnYm9vbGVhbicgfHwgdmFsdWUgPT0gbnVsbCkge1xuICAgICAgcmV0dXJuIGNhY2hlW3ZhbHVlXSA/IDAgOiAtMTtcbiAgICB9XG4gICAgaWYgKHR5cGUgIT0gJ251bWJlcicgJiYgdHlwZSAhPSAnc3RyaW5nJykge1xuICAgICAgdHlwZSA9ICdvYmplY3QnO1xuICAgIH1cbiAgICB2YXIga2V5ID0gdHlwZSA9PSAnbnVtYmVyJyA/IHZhbHVlIDoga2V5UHJlZml4ICsgdmFsdWU7XG4gICAgY2FjaGUgPSAoY2FjaGUgPSBjYWNoZVt0eXBlXSkgJiYgY2FjaGVba2V5XTtcblxuICAgIHJldHVybiB0eXBlID09ICdvYmplY3QnXG4gICAgICA/IChjYWNoZSAmJiBiYXNlSW5kZXhPZihjYWNoZSwgdmFsdWUpID4gLTEgPyAwIDogLTEpXG4gICAgICA6IChjYWNoZSA/IDAgOiAtMSk7XG4gIH1cblxuICAvKipcbiAgICogQWRkcyBhIGdpdmVuIHZhbHVlIHRvIHRoZSBjb3JyZXNwb25kaW5nIGNhY2hlIG9iamVjdC5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gYWRkIHRvIHRoZSBjYWNoZS5cbiAgICovXG4gIGZ1bmN0aW9uIGNhY2hlUHVzaCh2YWx1ZSkge1xuICAgIHZhciBjYWNoZSA9IHRoaXMuY2FjaGUsXG4gICAgICAgIHR5cGUgPSB0eXBlb2YgdmFsdWU7XG5cbiAgICBpZiAodHlwZSA9PSAnYm9vbGVhbicgfHwgdmFsdWUgPT0gbnVsbCkge1xuICAgICAgY2FjaGVbdmFsdWVdID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHR5cGUgIT0gJ251bWJlcicgJiYgdHlwZSAhPSAnc3RyaW5nJykge1xuICAgICAgICB0eXBlID0gJ29iamVjdCc7XG4gICAgICB9XG4gICAgICB2YXIga2V5ID0gdHlwZSA9PSAnbnVtYmVyJyA/IHZhbHVlIDoga2V5UHJlZml4ICsgdmFsdWUsXG4gICAgICAgICAgdHlwZUNhY2hlID0gY2FjaGVbdHlwZV0gfHwgKGNhY2hlW3R5cGVdID0ge30pO1xuXG4gICAgICBpZiAodHlwZSA9PSAnb2JqZWN0Jykge1xuICAgICAgICAodHlwZUNhY2hlW2tleV0gfHwgKHR5cGVDYWNoZVtrZXldID0gW10pKS5wdXNoKHZhbHVlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHR5cGVDYWNoZVtrZXldID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVXNlZCBieSBgXy5tYXhgIGFuZCBgXy5taW5gIGFzIHRoZSBkZWZhdWx0IGNhbGxiYWNrIHdoZW4gYSBnaXZlblxuICAgKiBjb2xsZWN0aW9uIGlzIGEgc3RyaW5nIHZhbHVlLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge3N0cmluZ30gdmFsdWUgVGhlIGNoYXJhY3RlciB0byBpbnNwZWN0LlxuICAgKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIHRoZSBjb2RlIHVuaXQgb2YgZ2l2ZW4gY2hhcmFjdGVyLlxuICAgKi9cbiAgZnVuY3Rpb24gY2hhckF0Q2FsbGJhY2sodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUuY2hhckNvZGVBdCgwKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVc2VkIGJ5IGBzb3J0QnlgIHRvIGNvbXBhcmUgdHJhbnNmb3JtZWQgYGNvbGxlY3Rpb25gIGVsZW1lbnRzLCBzdGFibGUgc29ydGluZ1xuICAgKiB0aGVtIGluIGFzY2VuZGluZyBvcmRlci5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtPYmplY3R9IGEgVGhlIG9iamVjdCB0byBjb21wYXJlIHRvIGBiYC5cbiAgICogQHBhcmFtIHtPYmplY3R9IGIgVGhlIG9iamVjdCB0byBjb21wYXJlIHRvIGBhYC5cbiAgICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgc29ydCBvcmRlciBpbmRpY2F0b3Igb2YgYDFgIG9yIGAtMWAuXG4gICAqL1xuICBmdW5jdGlvbiBjb21wYXJlQXNjZW5kaW5nKGEsIGIpIHtcbiAgICB2YXIgYWMgPSBhLmNyaXRlcmlhLFxuICAgICAgICBiYyA9IGIuY3JpdGVyaWEsXG4gICAgICAgIGluZGV4ID0gLTEsXG4gICAgICAgIGxlbmd0aCA9IGFjLmxlbmd0aDtcblxuICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICB2YXIgdmFsdWUgPSBhY1tpbmRleF0sXG4gICAgICAgICAgb3RoZXIgPSBiY1tpbmRleF07XG5cbiAgICAgIGlmICh2YWx1ZSAhPT0gb3RoZXIpIHtcbiAgICAgICAgaWYgKHZhbHVlID4gb3RoZXIgfHwgdHlwZW9mIHZhbHVlID09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZhbHVlIDwgb3RoZXIgfHwgdHlwZW9mIG90aGVyID09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIC8vIEZpeGVzIGFuIGBBcnJheSNzb3J0YCBidWcgaW4gdGhlIEpTIGVuZ2luZSBlbWJlZGRlZCBpbiBBZG9iZSBhcHBsaWNhdGlvbnNcbiAgICAvLyB0aGF0IGNhdXNlcyBpdCwgdW5kZXIgY2VydGFpbiBjaXJjdW1zdGFuY2VzLCB0byByZXR1cm4gdGhlIHNhbWUgdmFsdWUgZm9yXG4gICAgLy8gYGFgIGFuZCBgYmAuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vamFzaGtlbmFzL3VuZGVyc2NvcmUvcHVsbC8xMjQ3XG4gICAgLy9cbiAgICAvLyBUaGlzIGFsc28gZW5zdXJlcyBhIHN0YWJsZSBzb3J0IGluIFY4IGFuZCBvdGhlciBlbmdpbmVzLlxuICAgIC8vIFNlZSBodHRwOi8vY29kZS5nb29nbGUuY29tL3AvdjgvaXNzdWVzL2RldGFpbD9pZD05MFxuICAgIHJldHVybiBhLmluZGV4IC0gYi5pbmRleDtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgY2FjaGUgb2JqZWN0IHRvIG9wdGltaXplIGxpbmVhciBzZWFyY2hlcyBvZiBsYXJnZSBhcnJheXMuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7QXJyYXl9IFthcnJheT1bXV0gVGhlIGFycmF5IHRvIHNlYXJjaC5cbiAgICogQHJldHVybnMge251bGx8T2JqZWN0fSBSZXR1cm5zIHRoZSBjYWNoZSBvYmplY3Qgb3IgYG51bGxgIGlmIGNhY2hpbmcgc2hvdWxkIG5vdCBiZSB1c2VkLlxuICAgKi9cbiAgZnVuY3Rpb24gY3JlYXRlQ2FjaGUoYXJyYXkpIHtcbiAgICB2YXIgaW5kZXggPSAtMSxcbiAgICAgICAgbGVuZ3RoID0gYXJyYXkubGVuZ3RoLFxuICAgICAgICBmaXJzdCA9IGFycmF5WzBdLFxuICAgICAgICBtaWQgPSBhcnJheVsobGVuZ3RoIC8gMikgfCAwXSxcbiAgICAgICAgbGFzdCA9IGFycmF5W2xlbmd0aCAtIDFdO1xuXG4gICAgaWYgKGZpcnN0ICYmIHR5cGVvZiBmaXJzdCA9PSAnb2JqZWN0JyAmJlxuICAgICAgICBtaWQgJiYgdHlwZW9mIG1pZCA9PSAnb2JqZWN0JyAmJiBsYXN0ICYmIHR5cGVvZiBsYXN0ID09ICdvYmplY3QnKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBjYWNoZSA9IGdldE9iamVjdCgpO1xuICAgIGNhY2hlWydmYWxzZSddID0gY2FjaGVbJ251bGwnXSA9IGNhY2hlWyd0cnVlJ10gPSBjYWNoZVsndW5kZWZpbmVkJ10gPSBmYWxzZTtcblxuICAgIHZhciByZXN1bHQgPSBnZXRPYmplY3QoKTtcbiAgICByZXN1bHQuYXJyYXkgPSBhcnJheTtcbiAgICByZXN1bHQuY2FjaGUgPSBjYWNoZTtcbiAgICByZXN1bHQucHVzaCA9IGNhY2hlUHVzaDtcblxuICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICByZXN1bHQucHVzaChhcnJheVtpbmRleF0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqIFVzZWQgYnkgYHRlbXBsYXRlYCB0byBlc2NhcGUgY2hhcmFjdGVycyBmb3IgaW5jbHVzaW9uIGluIGNvbXBpbGVkXG4gICAqIHN0cmluZyBsaXRlcmFscy5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtzdHJpbmd9IG1hdGNoIFRoZSBtYXRjaGVkIGNoYXJhY3RlciB0byBlc2NhcGUuXG4gICAqIEByZXR1cm5zIHtzdHJpbmd9IFJldHVybnMgdGhlIGVzY2FwZWQgY2hhcmFjdGVyLlxuICAgKi9cbiAgZnVuY3Rpb24gZXNjYXBlU3RyaW5nQ2hhcihtYXRjaCkge1xuICAgIHJldHVybiAnXFxcXCcgKyBzdHJpbmdFc2NhcGVzW21hdGNoXTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIGFuIGFycmF5IGZyb20gdGhlIGFycmF5IHBvb2wgb3IgY3JlYXRlcyBhIG5ldyBvbmUgaWYgdGhlIHBvb2wgaXMgZW1wdHkuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEByZXR1cm5zIHtBcnJheX0gVGhlIGFycmF5IGZyb20gdGhlIHBvb2wuXG4gICAqL1xuICBmdW5jdGlvbiBnZXRBcnJheSgpIHtcbiAgICByZXR1cm4gYXJyYXlQb29sLnBvcCgpIHx8IFtdO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgYW4gb2JqZWN0IGZyb20gdGhlIG9iamVjdCBwb29sIG9yIGNyZWF0ZXMgYSBuZXcgb25lIGlmIHRoZSBwb29sIGlzIGVtcHR5LlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcmV0dXJucyB7T2JqZWN0fSBUaGUgb2JqZWN0IGZyb20gdGhlIHBvb2wuXG4gICAqL1xuICBmdW5jdGlvbiBnZXRPYmplY3QoKSB7XG4gICAgcmV0dXJuIG9iamVjdFBvb2wucG9wKCkgfHwge1xuICAgICAgJ2FycmF5JzogbnVsbCxcbiAgICAgICdjYWNoZSc6IG51bGwsXG4gICAgICAnY3JpdGVyaWEnOiBudWxsLFxuICAgICAgJ2ZhbHNlJzogZmFsc2UsXG4gICAgICAnaW5kZXgnOiAwLFxuICAgICAgJ251bGwnOiBmYWxzZSxcbiAgICAgICdudW1iZXInOiBudWxsLFxuICAgICAgJ29iamVjdCc6IG51bGwsXG4gICAgICAncHVzaCc6IG51bGwsXG4gICAgICAnc3RyaW5nJzogbnVsbCxcbiAgICAgICd0cnVlJzogZmFsc2UsXG4gICAgICAndW5kZWZpbmVkJzogZmFsc2UsXG4gICAgICAndmFsdWUnOiBudWxsXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWxlYXNlcyB0aGUgZ2l2ZW4gYXJyYXkgYmFjayB0byB0aGUgYXJyYXkgcG9vbC5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtBcnJheX0gW2FycmF5XSBUaGUgYXJyYXkgdG8gcmVsZWFzZS5cbiAgICovXG4gIGZ1bmN0aW9uIHJlbGVhc2VBcnJheShhcnJheSkge1xuICAgIGFycmF5Lmxlbmd0aCA9IDA7XG4gICAgaWYgKGFycmF5UG9vbC5sZW5ndGggPCBtYXhQb29sU2l6ZSkge1xuICAgICAgYXJyYXlQb29sLnB1c2goYXJyYXkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZWxlYXNlcyB0aGUgZ2l2ZW4gb2JqZWN0IGJhY2sgdG8gdGhlIG9iamVjdCBwb29sLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge09iamVjdH0gW29iamVjdF0gVGhlIG9iamVjdCB0byByZWxlYXNlLlxuICAgKi9cbiAgZnVuY3Rpb24gcmVsZWFzZU9iamVjdChvYmplY3QpIHtcbiAgICB2YXIgY2FjaGUgPSBvYmplY3QuY2FjaGU7XG4gICAgaWYgKGNhY2hlKSB7XG4gICAgICByZWxlYXNlT2JqZWN0KGNhY2hlKTtcbiAgICB9XG4gICAgb2JqZWN0LmFycmF5ID0gb2JqZWN0LmNhY2hlID0gb2JqZWN0LmNyaXRlcmlhID0gb2JqZWN0Lm9iamVjdCA9IG9iamVjdC5udW1iZXIgPSBvYmplY3Quc3RyaW5nID0gb2JqZWN0LnZhbHVlID0gbnVsbDtcbiAgICBpZiAob2JqZWN0UG9vbC5sZW5ndGggPCBtYXhQb29sU2l6ZSkge1xuICAgICAgb2JqZWN0UG9vbC5wdXNoKG9iamVjdCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFNsaWNlcyB0aGUgYGNvbGxlY3Rpb25gIGZyb20gdGhlIGBzdGFydGAgaW5kZXggdXAgdG8sIGJ1dCBub3QgaW5jbHVkaW5nLFxuICAgKiB0aGUgYGVuZGAgaW5kZXguXG4gICAqXG4gICAqIE5vdGU6IFRoaXMgZnVuY3Rpb24gaXMgdXNlZCBpbnN0ZWFkIG9mIGBBcnJheSNzbGljZWAgdG8gc3VwcG9ydCBub2RlIGxpc3RzXG4gICAqIGluIElFIDwgOSBhbmQgdG8gZW5zdXJlIGRlbnNlIGFycmF5cyBhcmUgcmV0dXJuZWQuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fHN0cmluZ30gY29sbGVjdGlvbiBUaGUgY29sbGVjdGlvbiB0byBzbGljZS5cbiAgICogQHBhcmFtIHtudW1iZXJ9IHN0YXJ0IFRoZSBzdGFydCBpbmRleC5cbiAgICogQHBhcmFtIHtudW1iZXJ9IGVuZCBUaGUgZW5kIGluZGV4LlxuICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIG5ldyBhcnJheS5cbiAgICovXG4gIGZ1bmN0aW9uIHNsaWNlKGFycmF5LCBzdGFydCwgZW5kKSB7XG4gICAgc3RhcnQgfHwgKHN0YXJ0ID0gMCk7XG4gICAgaWYgKHR5cGVvZiBlbmQgPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIGVuZCA9IGFycmF5ID8gYXJyYXkubGVuZ3RoIDogMDtcbiAgICB9XG4gICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgIGxlbmd0aCA9IGVuZCAtIHN0YXJ0IHx8IDAsXG4gICAgICAgIHJlc3VsdCA9IEFycmF5KGxlbmd0aCA8IDAgPyAwIDogbGVuZ3RoKTtcblxuICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICByZXN1bHRbaW5kZXhdID0gYXJyYXlbc3RhcnQgKyBpbmRleF07XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAvKipcbiAgICogQ3JlYXRlIGEgbmV3IGBsb2Rhc2hgIGZ1bmN0aW9uIHVzaW5nIHRoZSBnaXZlbiBjb250ZXh0IG9iamVjdC5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAY2F0ZWdvcnkgVXRpbGl0aWVzXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBbY29udGV4dD1yb290XSBUaGUgY29udGV4dCBvYmplY3QuXG4gICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgYGxvZGFzaGAgZnVuY3Rpb24uXG4gICAqL1xuICBmdW5jdGlvbiBydW5JbkNvbnRleHQoY29udGV4dCkge1xuICAgIC8vIEF2b2lkIGlzc3VlcyB3aXRoIHNvbWUgRVMzIGVudmlyb25tZW50cyB0aGF0IGF0dGVtcHQgdG8gdXNlIHZhbHVlcywgbmFtZWRcbiAgICAvLyBhZnRlciBidWlsdC1pbiBjb25zdHJ1Y3RvcnMgbGlrZSBgT2JqZWN0YCwgZm9yIHRoZSBjcmVhdGlvbiBvZiBsaXRlcmFscy5cbiAgICAvLyBFUzUgY2xlYXJzIHRoaXMgdXAgYnkgc3RhdGluZyB0aGF0IGxpdGVyYWxzIG11c3QgdXNlIGJ1aWx0LWluIGNvbnN0cnVjdG9ycy5cbiAgICAvLyBTZWUgaHR0cDovL2VzNS5naXRodWIuaW8vI3gxMS4xLjUuXG4gICAgY29udGV4dCA9IGNvbnRleHQgPyBfLmRlZmF1bHRzKHJvb3QuT2JqZWN0KCksIGNvbnRleHQsIF8ucGljayhyb290LCBjb250ZXh0UHJvcHMpKSA6IHJvb3Q7XG5cbiAgICAvKiogTmF0aXZlIGNvbnN0cnVjdG9yIHJlZmVyZW5jZXMgKi9cbiAgICB2YXIgQXJyYXkgPSBjb250ZXh0LkFycmF5LFxuICAgICAgICBCb29sZWFuID0gY29udGV4dC5Cb29sZWFuLFxuICAgICAgICBEYXRlID0gY29udGV4dC5EYXRlLFxuICAgICAgICBGdW5jdGlvbiA9IGNvbnRleHQuRnVuY3Rpb24sXG4gICAgICAgIE1hdGggPSBjb250ZXh0Lk1hdGgsXG4gICAgICAgIE51bWJlciA9IGNvbnRleHQuTnVtYmVyLFxuICAgICAgICBPYmplY3QgPSBjb250ZXh0Lk9iamVjdCxcbiAgICAgICAgUmVnRXhwID0gY29udGV4dC5SZWdFeHAsXG4gICAgICAgIFN0cmluZyA9IGNvbnRleHQuU3RyaW5nLFxuICAgICAgICBUeXBlRXJyb3IgPSBjb250ZXh0LlR5cGVFcnJvcjtcblxuICAgIC8qKlxuICAgICAqIFVzZWQgZm9yIGBBcnJheWAgbWV0aG9kIHJlZmVyZW5jZXMuXG4gICAgICpcbiAgICAgKiBOb3JtYWxseSBgQXJyYXkucHJvdG90eXBlYCB3b3VsZCBzdWZmaWNlLCBob3dldmVyLCB1c2luZyBhbiBhcnJheSBsaXRlcmFsXG4gICAgICogYXZvaWRzIGlzc3VlcyBpbiBOYXJ3aGFsLlxuICAgICAqL1xuICAgIHZhciBhcnJheVJlZiA9IFtdO1xuXG4gICAgLyoqIFVzZWQgZm9yIG5hdGl2ZSBtZXRob2QgcmVmZXJlbmNlcyAqL1xuICAgIHZhciBvYmplY3RQcm90byA9IE9iamVjdC5wcm90b3R5cGU7XG5cbiAgICAvKiogVXNlZCB0byByZXN0b3JlIHRoZSBvcmlnaW5hbCBgX2AgcmVmZXJlbmNlIGluIGBub0NvbmZsaWN0YCAqL1xuICAgIHZhciBvbGREYXNoID0gY29udGV4dC5fO1xuXG4gICAgLyoqIFVzZWQgdG8gcmVzb2x2ZSB0aGUgaW50ZXJuYWwgW1tDbGFzc11dIG9mIHZhbHVlcyAqL1xuICAgIHZhciB0b1N0cmluZyA9IG9iamVjdFByb3RvLnRvU3RyaW5nO1xuXG4gICAgLyoqIFVzZWQgdG8gZGV0ZWN0IGlmIGEgbWV0aG9kIGlzIG5hdGl2ZSAqL1xuICAgIHZhciByZU5hdGl2ZSA9IFJlZ0V4cCgnXicgK1xuICAgICAgU3RyaW5nKHRvU3RyaW5nKVxuICAgICAgICAucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xcXVxcXFxdL2csICdcXFxcJCYnKVxuICAgICAgICAucmVwbGFjZSgvdG9TdHJpbmd8IGZvciBbXlxcXV0rL2csICcuKj8nKSArICckJ1xuICAgICk7XG5cbiAgICAvKiogTmF0aXZlIG1ldGhvZCBzaG9ydGN1dHMgKi9cbiAgICB2YXIgY2VpbCA9IE1hdGguY2VpbCxcbiAgICAgICAgY2xlYXJUaW1lb3V0ID0gY29udGV4dC5jbGVhclRpbWVvdXQsXG4gICAgICAgIGZsb29yID0gTWF0aC5mbG9vcixcbiAgICAgICAgZm5Ub1N0cmluZyA9IEZ1bmN0aW9uLnByb3RvdHlwZS50b1N0cmluZyxcbiAgICAgICAgZ2V0UHJvdG90eXBlT2YgPSBpc05hdGl2ZShnZXRQcm90b3R5cGVPZiA9IE9iamVjdC5nZXRQcm90b3R5cGVPZikgJiYgZ2V0UHJvdG90eXBlT2YsXG4gICAgICAgIGhhc093blByb3BlcnR5ID0gb2JqZWN0UHJvdG8uaGFzT3duUHJvcGVydHksXG4gICAgICAgIHB1c2ggPSBhcnJheVJlZi5wdXNoLFxuICAgICAgICBzZXRUaW1lb3V0ID0gY29udGV4dC5zZXRUaW1lb3V0LFxuICAgICAgICBzcGxpY2UgPSBhcnJheVJlZi5zcGxpY2UsXG4gICAgICAgIHVuc2hpZnQgPSBhcnJheVJlZi51bnNoaWZ0O1xuXG4gICAgLyoqIFVzZWQgdG8gc2V0IG1ldGEgZGF0YSBvbiBmdW5jdGlvbnMgKi9cbiAgICB2YXIgZGVmaW5lUHJvcGVydHkgPSAoZnVuY3Rpb24oKSB7XG4gICAgICAvLyBJRSA4IG9ubHkgYWNjZXB0cyBET00gZWxlbWVudHNcbiAgICAgIHRyeSB7XG4gICAgICAgIHZhciBvID0ge30sXG4gICAgICAgICAgICBmdW5jID0gaXNOYXRpdmUoZnVuYyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSkgJiYgZnVuYyxcbiAgICAgICAgICAgIHJlc3VsdCA9IGZ1bmMobywgbywgbykgJiYgZnVuYztcbiAgICAgIH0gY2F0Y2goZSkgeyB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0oKSk7XG5cbiAgICAvKiBOYXRpdmUgbWV0aG9kIHNob3J0Y3V0cyBmb3IgbWV0aG9kcyB3aXRoIHRoZSBzYW1lIG5hbWUgYXMgb3RoZXIgYGxvZGFzaGAgbWV0aG9kcyAqL1xuICAgIHZhciBuYXRpdmVDcmVhdGUgPSBpc05hdGl2ZShuYXRpdmVDcmVhdGUgPSBPYmplY3QuY3JlYXRlKSAmJiBuYXRpdmVDcmVhdGUsXG4gICAgICAgIG5hdGl2ZUlzQXJyYXkgPSBpc05hdGl2ZShuYXRpdmVJc0FycmF5ID0gQXJyYXkuaXNBcnJheSkgJiYgbmF0aXZlSXNBcnJheSxcbiAgICAgICAgbmF0aXZlSXNGaW5pdGUgPSBjb250ZXh0LmlzRmluaXRlLFxuICAgICAgICBuYXRpdmVJc05hTiA9IGNvbnRleHQuaXNOYU4sXG4gICAgICAgIG5hdGl2ZUtleXMgPSBpc05hdGl2ZShuYXRpdmVLZXlzID0gT2JqZWN0LmtleXMpICYmIG5hdGl2ZUtleXMsXG4gICAgICAgIG5hdGl2ZU1heCA9IE1hdGgubWF4LFxuICAgICAgICBuYXRpdmVNaW4gPSBNYXRoLm1pbixcbiAgICAgICAgbmF0aXZlUGFyc2VJbnQgPSBjb250ZXh0LnBhcnNlSW50LFxuICAgICAgICBuYXRpdmVSYW5kb20gPSBNYXRoLnJhbmRvbTtcblxuICAgIC8qKiBVc2VkIHRvIGxvb2t1cCBhIGJ1aWx0LWluIGNvbnN0cnVjdG9yIGJ5IFtbQ2xhc3NdXSAqL1xuICAgIHZhciBjdG9yQnlDbGFzcyA9IHt9O1xuICAgIGN0b3JCeUNsYXNzW2FycmF5Q2xhc3NdID0gQXJyYXk7XG4gICAgY3RvckJ5Q2xhc3NbYm9vbENsYXNzXSA9IEJvb2xlYW47XG4gICAgY3RvckJ5Q2xhc3NbZGF0ZUNsYXNzXSA9IERhdGU7XG4gICAgY3RvckJ5Q2xhc3NbZnVuY0NsYXNzXSA9IEZ1bmN0aW9uO1xuICAgIGN0b3JCeUNsYXNzW29iamVjdENsYXNzXSA9IE9iamVjdDtcbiAgICBjdG9yQnlDbGFzc1tudW1iZXJDbGFzc10gPSBOdW1iZXI7XG4gICAgY3RvckJ5Q2xhc3NbcmVnZXhwQ2xhc3NdID0gUmVnRXhwO1xuICAgIGN0b3JCeUNsYXNzW3N0cmluZ0NsYXNzXSA9IFN0cmluZztcblxuICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGBsb2Rhc2hgIG9iamVjdCB3aGljaCB3cmFwcyB0aGUgZ2l2ZW4gdmFsdWUgdG8gZW5hYmxlIGludHVpdGl2ZVxuICAgICAqIG1ldGhvZCBjaGFpbmluZy5cbiAgICAgKlxuICAgICAqIEluIGFkZGl0aW9uIHRvIExvLURhc2ggbWV0aG9kcywgd3JhcHBlcnMgYWxzbyBoYXZlIHRoZSBmb2xsb3dpbmcgYEFycmF5YCBtZXRob2RzOlxuICAgICAqIGBjb25jYXRgLCBgam9pbmAsIGBwb3BgLCBgcHVzaGAsIGByZXZlcnNlYCwgYHNoaWZ0YCwgYHNsaWNlYCwgYHNvcnRgLCBgc3BsaWNlYCxcbiAgICAgKiBhbmQgYHVuc2hpZnRgXG4gICAgICpcbiAgICAgKiBDaGFpbmluZyBpcyBzdXBwb3J0ZWQgaW4gY3VzdG9tIGJ1aWxkcyBhcyBsb25nIGFzIHRoZSBgdmFsdWVgIG1ldGhvZCBpc1xuICAgICAqIGltcGxpY2l0bHkgb3IgZXhwbGljaXRseSBpbmNsdWRlZCBpbiB0aGUgYnVpbGQuXG4gICAgICpcbiAgICAgKiBUaGUgY2hhaW5hYmxlIHdyYXBwZXIgZnVuY3Rpb25zIGFyZTpcbiAgICAgKiBgYWZ0ZXJgLCBgYXNzaWduYCwgYGJpbmRgLCBgYmluZEFsbGAsIGBiaW5kS2V5YCwgYGNoYWluYCwgYGNvbXBhY3RgLFxuICAgICAqIGBjb21wb3NlYCwgYGNvbmNhdGAsIGBjb3VudEJ5YCwgYGNyZWF0ZWAsIGBjcmVhdGVDYWxsYmFja2AsIGBjdXJyeWAsXG4gICAgICogYGRlYm91bmNlYCwgYGRlZmF1bHRzYCwgYGRlZmVyYCwgYGRlbGF5YCwgYGRpZmZlcmVuY2VgLCBgZmlsdGVyYCwgYGZsYXR0ZW5gLFxuICAgICAqIGBmb3JFYWNoYCwgYGZvckVhY2hSaWdodGAsIGBmb3JJbmAsIGBmb3JJblJpZ2h0YCwgYGZvck93bmAsIGBmb3JPd25SaWdodGAsXG4gICAgICogYGZ1bmN0aW9uc2AsIGBncm91cEJ5YCwgYGluZGV4QnlgLCBgaW5pdGlhbGAsIGBpbnRlcnNlY3Rpb25gLCBgaW52ZXJ0YCxcbiAgICAgKiBgaW52b2tlYCwgYGtleXNgLCBgbWFwYCwgYG1heGAsIGBtZW1vaXplYCwgYG1lcmdlYCwgYG1pbmAsIGBvYmplY3RgLCBgb21pdGAsXG4gICAgICogYG9uY2VgLCBgcGFpcnNgLCBgcGFydGlhbGAsIGBwYXJ0aWFsUmlnaHRgLCBgcGlja2AsIGBwbHVja2AsIGBwdWxsYCwgYHB1c2hgLFxuICAgICAqIGByYW5nZWAsIGByZWplY3RgLCBgcmVtb3ZlYCwgYHJlc3RgLCBgcmV2ZXJzZWAsIGBzaHVmZmxlYCwgYHNsaWNlYCwgYHNvcnRgLFxuICAgICAqIGBzb3J0QnlgLCBgc3BsaWNlYCwgYHRhcGAsIGB0aHJvdHRsZWAsIGB0aW1lc2AsIGB0b0FycmF5YCwgYHRyYW5zZm9ybWAsXG4gICAgICogYHVuaW9uYCwgYHVuaXFgLCBgdW5zaGlmdGAsIGB1bnppcGAsIGB2YWx1ZXNgLCBgd2hlcmVgLCBgd2l0aG91dGAsIGB3cmFwYCxcbiAgICAgKiBhbmQgYHppcGBcbiAgICAgKlxuICAgICAqIFRoZSBub24tY2hhaW5hYmxlIHdyYXBwZXIgZnVuY3Rpb25zIGFyZTpcbiAgICAgKiBgY2xvbmVgLCBgY2xvbmVEZWVwYCwgYGNvbnRhaW5zYCwgYGVzY2FwZWAsIGBldmVyeWAsIGBmaW5kYCwgYGZpbmRJbmRleGAsXG4gICAgICogYGZpbmRLZXlgLCBgZmluZExhc3RgLCBgZmluZExhc3RJbmRleGAsIGBmaW5kTGFzdEtleWAsIGBoYXNgLCBgaWRlbnRpdHlgLFxuICAgICAqIGBpbmRleE9mYCwgYGlzQXJndW1lbnRzYCwgYGlzQXJyYXlgLCBgaXNCb29sZWFuYCwgYGlzRGF0ZWAsIGBpc0VsZW1lbnRgLFxuICAgICAqIGBpc0VtcHR5YCwgYGlzRXF1YWxgLCBgaXNGaW5pdGVgLCBgaXNGdW5jdGlvbmAsIGBpc05hTmAsIGBpc051bGxgLCBgaXNOdW1iZXJgLFxuICAgICAqIGBpc09iamVjdGAsIGBpc1BsYWluT2JqZWN0YCwgYGlzUmVnRXhwYCwgYGlzU3RyaW5nYCwgYGlzVW5kZWZpbmVkYCwgYGpvaW5gLFxuICAgICAqIGBsYXN0SW5kZXhPZmAsIGBtaXhpbmAsIGBub0NvbmZsaWN0YCwgYHBhcnNlSW50YCwgYHBvcGAsIGByYW5kb21gLCBgcmVkdWNlYCxcbiAgICAgKiBgcmVkdWNlUmlnaHRgLCBgcmVzdWx0YCwgYHNoaWZ0YCwgYHNpemVgLCBgc29tZWAsIGBzb3J0ZWRJbmRleGAsIGBydW5JbkNvbnRleHRgLFxuICAgICAqIGB0ZW1wbGF0ZWAsIGB1bmVzY2FwZWAsIGB1bmlxdWVJZGAsIGFuZCBgdmFsdWVgXG4gICAgICpcbiAgICAgKiBUaGUgd3JhcHBlciBmdW5jdGlvbnMgYGZpcnN0YCBhbmQgYGxhc3RgIHJldHVybiB3cmFwcGVkIHZhbHVlcyB3aGVuIGBuYCBpc1xuICAgICAqIHByb3ZpZGVkLCBvdGhlcndpc2UgdGhleSByZXR1cm4gdW53cmFwcGVkIHZhbHVlcy5cbiAgICAgKlxuICAgICAqIEV4cGxpY2l0IGNoYWluaW5nIGNhbiBiZSBlbmFibGVkIGJ5IHVzaW5nIHRoZSBgXy5jaGFpbmAgbWV0aG9kLlxuICAgICAqXG4gICAgICogQG5hbWUgX1xuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBjYXRlZ29yeSBDaGFpbmluZ1xuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHdyYXAgaW4gYSBgbG9kYXNoYCBpbnN0YW5jZS5cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIGEgYGxvZGFzaGAgaW5zdGFuY2UuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciB3cmFwcGVkID0gXyhbMSwgMiwgM10pO1xuICAgICAqXG4gICAgICogLy8gcmV0dXJucyBhbiB1bndyYXBwZWQgdmFsdWVcbiAgICAgKiB3cmFwcGVkLnJlZHVjZShmdW5jdGlvbihzdW0sIG51bSkge1xuICAgICAqICAgcmV0dXJuIHN1bSArIG51bTtcbiAgICAgKiB9KTtcbiAgICAgKiAvLyA9PiA2XG4gICAgICpcbiAgICAgKiAvLyByZXR1cm5zIGEgd3JhcHBlZCB2YWx1ZVxuICAgICAqIHZhciBzcXVhcmVzID0gd3JhcHBlZC5tYXAoZnVuY3Rpb24obnVtKSB7XG4gICAgICogICByZXR1cm4gbnVtICogbnVtO1xuICAgICAqIH0pO1xuICAgICAqXG4gICAgICogXy5pc0FycmF5KHNxdWFyZXMpO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICpcbiAgICAgKiBfLmlzQXJyYXkoc3F1YXJlcy52YWx1ZSgpKTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICovXG4gICAgZnVuY3Rpb24gbG9kYXNoKHZhbHVlKSB7XG4gICAgICAvLyBkb24ndCB3cmFwIGlmIGFscmVhZHkgd3JhcHBlZCwgZXZlbiBpZiB3cmFwcGVkIGJ5IGEgZGlmZmVyZW50IGBsb2Rhc2hgIGNvbnN0cnVjdG9yXG4gICAgICByZXR1cm4gKHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PSAnb2JqZWN0JyAmJiAhaXNBcnJheSh2YWx1ZSkgJiYgaGFzT3duUHJvcGVydHkuY2FsbCh2YWx1ZSwgJ19fd3JhcHBlZF9fJykpXG4gICAgICAgPyB2YWx1ZVxuICAgICAgIDogbmV3IGxvZGFzaFdyYXBwZXIodmFsdWUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEEgZmFzdCBwYXRoIGZvciBjcmVhdGluZyBgbG9kYXNoYCB3cmFwcGVyIG9iamVjdHMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHdyYXAgaW4gYSBgbG9kYXNoYCBpbnN0YW5jZS5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGNoYWluQWxsIEEgZmxhZyB0byBlbmFibGUgY2hhaW5pbmcgZm9yIGFsbCBtZXRob2RzXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyBhIGBsb2Rhc2hgIGluc3RhbmNlLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGxvZGFzaFdyYXBwZXIodmFsdWUsIGNoYWluQWxsKSB7XG4gICAgICB0aGlzLl9fY2hhaW5fXyA9ICEhY2hhaW5BbGw7XG4gICAgICB0aGlzLl9fd3JhcHBlZF9fID0gdmFsdWU7XG4gICAgfVxuICAgIC8vIGVuc3VyZSBgbmV3IGxvZGFzaFdyYXBwZXJgIGlzIGFuIGluc3RhbmNlIG9mIGBsb2Rhc2hgXG4gICAgbG9kYXNoV3JhcHBlci5wcm90b3R5cGUgPSBsb2Rhc2gucHJvdG90eXBlO1xuXG4gICAgLyoqXG4gICAgICogQW4gb2JqZWN0IHVzZWQgdG8gZmxhZyBlbnZpcm9ubWVudHMgZmVhdHVyZXMuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAdHlwZSBPYmplY3RcbiAgICAgKi9cbiAgICB2YXIgc3VwcG9ydCA9IGxvZGFzaC5zdXBwb3J0ID0ge307XG5cbiAgICAvKipcbiAgICAgKiBEZXRlY3QgaWYgZnVuY3Rpb25zIGNhbiBiZSBkZWNvbXBpbGVkIGJ5IGBGdW5jdGlvbiN0b1N0cmluZ2BcbiAgICAgKiAoYWxsIGJ1dCBQUzMgYW5kIG9sZGVyIE9wZXJhIG1vYmlsZSBicm93c2VycyAmIGF2b2lkZWQgaW4gV2luZG93cyA4IGFwcHMpLlxuICAgICAqXG4gICAgICogQG1lbWJlck9mIF8uc3VwcG9ydFxuICAgICAqIEB0eXBlIGJvb2xlYW5cbiAgICAgKi9cbiAgICBzdXBwb3J0LmZ1bmNEZWNvbXAgPSAhaXNOYXRpdmUoY29udGV4dC5XaW5SVEVycm9yKSAmJiByZVRoaXMudGVzdChydW5JbkNvbnRleHQpO1xuXG4gICAgLyoqXG4gICAgICogRGV0ZWN0IGlmIGBGdW5jdGlvbiNuYW1lYCBpcyBzdXBwb3J0ZWQgKGFsbCBidXQgSUUpLlxuICAgICAqXG4gICAgICogQG1lbWJlck9mIF8uc3VwcG9ydFxuICAgICAqIEB0eXBlIGJvb2xlYW5cbiAgICAgKi9cbiAgICBzdXBwb3J0LmZ1bmNOYW1lcyA9IHR5cGVvZiBGdW5jdGlvbi5uYW1lID09ICdzdHJpbmcnO1xuXG4gICAgLyoqXG4gICAgICogQnkgZGVmYXVsdCwgdGhlIHRlbXBsYXRlIGRlbGltaXRlcnMgdXNlZCBieSBMby1EYXNoIGFyZSBzaW1pbGFyIHRvIHRob3NlIGluXG4gICAgICogZW1iZWRkZWQgUnVieSAoRVJCKS4gQ2hhbmdlIHRoZSBmb2xsb3dpbmcgdGVtcGxhdGUgc2V0dGluZ3MgdG8gdXNlIGFsdGVybmF0aXZlXG4gICAgICogZGVsaW1pdGVycy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEB0eXBlIE9iamVjdFxuICAgICAqL1xuICAgIGxvZGFzaC50ZW1wbGF0ZVNldHRpbmdzID0ge1xuXG4gICAgICAvKipcbiAgICAgICAqIFVzZWQgdG8gZGV0ZWN0IGBkYXRhYCBwcm9wZXJ0eSB2YWx1ZXMgdG8gYmUgSFRNTC1lc2NhcGVkLlxuICAgICAgICpcbiAgICAgICAqIEBtZW1iZXJPZiBfLnRlbXBsYXRlU2V0dGluZ3NcbiAgICAgICAqIEB0eXBlIFJlZ0V4cFxuICAgICAgICovXG4gICAgICAnZXNjYXBlJzogLzwlLShbXFxzXFxTXSs/KSU+L2csXG5cbiAgICAgIC8qKlxuICAgICAgICogVXNlZCB0byBkZXRlY3QgY29kZSB0byBiZSBldmFsdWF0ZWQuXG4gICAgICAgKlxuICAgICAgICogQG1lbWJlck9mIF8udGVtcGxhdGVTZXR0aW5nc1xuICAgICAgICogQHR5cGUgUmVnRXhwXG4gICAgICAgKi9cbiAgICAgICdldmFsdWF0ZSc6IC88JShbXFxzXFxTXSs/KSU+L2csXG5cbiAgICAgIC8qKlxuICAgICAgICogVXNlZCB0byBkZXRlY3QgYGRhdGFgIHByb3BlcnR5IHZhbHVlcyB0byBpbmplY3QuXG4gICAgICAgKlxuICAgICAgICogQG1lbWJlck9mIF8udGVtcGxhdGVTZXR0aW5nc1xuICAgICAgICogQHR5cGUgUmVnRXhwXG4gICAgICAgKi9cbiAgICAgICdpbnRlcnBvbGF0ZSc6IHJlSW50ZXJwb2xhdGUsXG5cbiAgICAgIC8qKlxuICAgICAgICogVXNlZCB0byByZWZlcmVuY2UgdGhlIGRhdGEgb2JqZWN0IGluIHRoZSB0ZW1wbGF0ZSB0ZXh0LlxuICAgICAgICpcbiAgICAgICAqIEBtZW1iZXJPZiBfLnRlbXBsYXRlU2V0dGluZ3NcbiAgICAgICAqIEB0eXBlIHN0cmluZ1xuICAgICAgICovXG4gICAgICAndmFyaWFibGUnOiAnJyxcblxuICAgICAgLyoqXG4gICAgICAgKiBVc2VkIHRvIGltcG9ydCB2YXJpYWJsZXMgaW50byB0aGUgY29tcGlsZWQgdGVtcGxhdGUuXG4gICAgICAgKlxuICAgICAgICogQG1lbWJlck9mIF8udGVtcGxhdGVTZXR0aW5nc1xuICAgICAgICogQHR5cGUgT2JqZWN0XG4gICAgICAgKi9cbiAgICAgICdpbXBvcnRzJzoge1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIHJlZmVyZW5jZSB0byB0aGUgYGxvZGFzaGAgZnVuY3Rpb24uXG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXJPZiBfLnRlbXBsYXRlU2V0dGluZ3MuaW1wb3J0c1xuICAgICAgICAgKiBAdHlwZSBGdW5jdGlvblxuICAgICAgICAgKi9cbiAgICAgICAgJ18nOiBsb2Rhc2hcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbiAgICAvKipcbiAgICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy5iaW5kYCB0aGF0IGNyZWF0ZXMgdGhlIGJvdW5kIGZ1bmN0aW9uIGFuZFxuICAgICAqIHNldHMgaXRzIG1ldGEgZGF0YS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtBcnJheX0gYmluZERhdGEgVGhlIGJpbmQgZGF0YSBhcnJheS5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBib3VuZCBmdW5jdGlvbi5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBiYXNlQmluZChiaW5kRGF0YSkge1xuICAgICAgdmFyIGZ1bmMgPSBiaW5kRGF0YVswXSxcbiAgICAgICAgICBwYXJ0aWFsQXJncyA9IGJpbmREYXRhWzJdLFxuICAgICAgICAgIHRoaXNBcmcgPSBiaW5kRGF0YVs0XTtcblxuICAgICAgZnVuY3Rpb24gYm91bmQoKSB7XG4gICAgICAgIC8vIGBGdW5jdGlvbiNiaW5kYCBzcGVjXG4gICAgICAgIC8vIGh0dHA6Ly9lczUuZ2l0aHViLmlvLyN4MTUuMy40LjVcbiAgICAgICAgaWYgKHBhcnRpYWxBcmdzKSB7XG4gICAgICAgICAgLy8gYXZvaWQgYGFyZ3VtZW50c2Agb2JqZWN0IGRlb3B0aW1pemF0aW9ucyBieSB1c2luZyBgc2xpY2VgIGluc3RlYWRcbiAgICAgICAgICAvLyBvZiBgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGxgIGFuZCBub3QgYXNzaWduaW5nIGBhcmd1bWVudHNgIHRvIGFcbiAgICAgICAgICAvLyB2YXJpYWJsZSBhcyBhIHRlcm5hcnkgZXhwcmVzc2lvblxuICAgICAgICAgIHZhciBhcmdzID0gc2xpY2UocGFydGlhbEFyZ3MpO1xuICAgICAgICAgIHB1c2guYXBwbHkoYXJncywgYXJndW1lbnRzKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBtaW1pYyB0aGUgY29uc3RydWN0b3IncyBgcmV0dXJuYCBiZWhhdmlvclxuICAgICAgICAvLyBodHRwOi8vZXM1LmdpdGh1Yi5pby8jeDEzLjIuMlxuICAgICAgICBpZiAodGhpcyBpbnN0YW5jZW9mIGJvdW5kKSB7XG4gICAgICAgICAgLy8gZW5zdXJlIGBuZXcgYm91bmRgIGlzIGFuIGluc3RhbmNlIG9mIGBmdW5jYFxuICAgICAgICAgIHZhciB0aGlzQmluZGluZyA9IGJhc2VDcmVhdGUoZnVuYy5wcm90b3R5cGUpLFxuICAgICAgICAgICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KHRoaXNCaW5kaW5nLCBhcmdzIHx8IGFyZ3VtZW50cyk7XG4gICAgICAgICAgcmV0dXJuIGlzT2JqZWN0KHJlc3VsdCkgPyByZXN1bHQgOiB0aGlzQmluZGluZztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZnVuYy5hcHBseSh0aGlzQXJnLCBhcmdzIHx8IGFyZ3VtZW50cyk7XG4gICAgICB9XG4gICAgICBzZXRCaW5kRGF0YShib3VuZCwgYmluZERhdGEpO1xuICAgICAgcmV0dXJuIGJvdW5kO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLmNsb25lYCB3aXRob3V0IGFyZ3VtZW50IGp1Z2dsaW5nIG9yIHN1cHBvcnRcbiAgICAgKiBmb3IgYHRoaXNBcmdgIGJpbmRpbmcuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNsb25lLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2lzRGVlcD1mYWxzZV0gU3BlY2lmeSBhIGRlZXAgY2xvbmUuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2NhbGxiYWNrXSBUaGUgZnVuY3Rpb24gdG8gY3VzdG9taXplIGNsb25pbmcgdmFsdWVzLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFtzdGFja0E9W11dIFRyYWNrcyB0cmF2ZXJzZWQgc291cmNlIG9iamVjdHMuXG4gICAgICogQHBhcmFtIHtBcnJheX0gW3N0YWNrQj1bXV0gQXNzb2NpYXRlcyBjbG9uZXMgd2l0aCBzb3VyY2UgY291bnRlcnBhcnRzLlxuICAgICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSBjbG9uZWQgdmFsdWUuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZUNsb25lKHZhbHVlLCBpc0RlZXAsIGNhbGxiYWNrLCBzdGFja0EsIHN0YWNrQikge1xuICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBjYWxsYmFjayh2YWx1ZSk7XG4gICAgICAgIGlmICh0eXBlb2YgcmVzdWx0ICE9ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgLy8gaW5zcGVjdCBbW0NsYXNzXV1cbiAgICAgIHZhciBpc09iaiA9IGlzT2JqZWN0KHZhbHVlKTtcbiAgICAgIGlmIChpc09iaikge1xuICAgICAgICB2YXIgY2xhc3NOYW1lID0gdG9TdHJpbmcuY2FsbCh2YWx1ZSk7XG4gICAgICAgIGlmICghY2xvbmVhYmxlQ2xhc3Nlc1tjbGFzc05hbWVdKSB7XG4gICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjdG9yID0gY3RvckJ5Q2xhc3NbY2xhc3NOYW1lXTtcbiAgICAgICAgc3dpdGNoIChjbGFzc05hbWUpIHtcbiAgICAgICAgICBjYXNlIGJvb2xDbGFzczpcbiAgICAgICAgICBjYXNlIGRhdGVDbGFzczpcbiAgICAgICAgICAgIHJldHVybiBuZXcgY3RvcigrdmFsdWUpO1xuXG4gICAgICAgICAgY2FzZSBudW1iZXJDbGFzczpcbiAgICAgICAgICBjYXNlIHN0cmluZ0NsYXNzOlxuICAgICAgICAgICAgcmV0dXJuIG5ldyBjdG9yKHZhbHVlKTtcblxuICAgICAgICAgIGNhc2UgcmVnZXhwQ2xhc3M6XG4gICAgICAgICAgICByZXN1bHQgPSBjdG9yKHZhbHVlLnNvdXJjZSwgcmVGbGFncy5leGVjKHZhbHVlKSk7XG4gICAgICAgICAgICByZXN1bHQubGFzdEluZGV4ID0gdmFsdWUubGFzdEluZGV4O1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgfVxuICAgICAgdmFyIGlzQXJyID0gaXNBcnJheSh2YWx1ZSk7XG4gICAgICBpZiAoaXNEZWVwKSB7XG4gICAgICAgIC8vIGNoZWNrIGZvciBjaXJjdWxhciByZWZlcmVuY2VzIGFuZCByZXR1cm4gY29ycmVzcG9uZGluZyBjbG9uZVxuICAgICAgICB2YXIgaW5pdGVkU3RhY2sgPSAhc3RhY2tBO1xuICAgICAgICBzdGFja0EgfHwgKHN0YWNrQSA9IGdldEFycmF5KCkpO1xuICAgICAgICBzdGFja0IgfHwgKHN0YWNrQiA9IGdldEFycmF5KCkpO1xuXG4gICAgICAgIHZhciBsZW5ndGggPSBzdGFja0EubGVuZ3RoO1xuICAgICAgICB3aGlsZSAobGVuZ3RoLS0pIHtcbiAgICAgICAgICBpZiAoc3RhY2tBW2xlbmd0aF0gPT0gdmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybiBzdGFja0JbbGVuZ3RoXTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0ID0gaXNBcnIgPyBjdG9yKHZhbHVlLmxlbmd0aCkgOiB7fTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICByZXN1bHQgPSBpc0FyciA/IHNsaWNlKHZhbHVlKSA6IGFzc2lnbih7fSwgdmFsdWUpO1xuICAgICAgfVxuICAgICAgLy8gYWRkIGFycmF5IHByb3BlcnRpZXMgYXNzaWduZWQgYnkgYFJlZ0V4cCNleGVjYFxuICAgICAgaWYgKGlzQXJyKSB7XG4gICAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKHZhbHVlLCAnaW5kZXgnKSkge1xuICAgICAgICAgIHJlc3VsdC5pbmRleCA9IHZhbHVlLmluZGV4O1xuICAgICAgICB9XG4gICAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKHZhbHVlLCAnaW5wdXQnKSkge1xuICAgICAgICAgIHJlc3VsdC5pbnB1dCA9IHZhbHVlLmlucHV0O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICAvLyBleGl0IGZvciBzaGFsbG93IGNsb25lXG4gICAgICBpZiAoIWlzRGVlcCkge1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfVxuICAgICAgLy8gYWRkIHRoZSBzb3VyY2UgdmFsdWUgdG8gdGhlIHN0YWNrIG9mIHRyYXZlcnNlZCBvYmplY3RzXG4gICAgICAvLyBhbmQgYXNzb2NpYXRlIGl0IHdpdGggaXRzIGNsb25lXG4gICAgICBzdGFja0EucHVzaCh2YWx1ZSk7XG4gICAgICBzdGFja0IucHVzaChyZXN1bHQpO1xuXG4gICAgICAvLyByZWN1cnNpdmVseSBwb3B1bGF0ZSBjbG9uZSAoc3VzY2VwdGlibGUgdG8gY2FsbCBzdGFjayBsaW1pdHMpXG4gICAgICAoaXNBcnIgPyBmb3JFYWNoIDogZm9yT3duKSh2YWx1ZSwgZnVuY3Rpb24ob2JqVmFsdWUsIGtleSkge1xuICAgICAgICByZXN1bHRba2V5XSA9IGJhc2VDbG9uZShvYmpWYWx1ZSwgaXNEZWVwLCBjYWxsYmFjaywgc3RhY2tBLCBzdGFja0IpO1xuICAgICAgfSk7XG5cbiAgICAgIGlmIChpbml0ZWRTdGFjaykge1xuICAgICAgICByZWxlYXNlQXJyYXkoc3RhY2tBKTtcbiAgICAgICAgcmVsZWFzZUFycmF5KHN0YWNrQik7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLmNyZWF0ZWAgd2l0aG91dCBzdXBwb3J0IGZvciBhc3NpZ25pbmdcbiAgICAgKiBwcm9wZXJ0aWVzIHRvIHRoZSBjcmVhdGVkIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHByb3RvdHlwZSBUaGUgb2JqZWN0IHRvIGluaGVyaXQgZnJvbS5cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBuZXcgb2JqZWN0LlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJhc2VDcmVhdGUocHJvdG90eXBlLCBwcm9wZXJ0aWVzKSB7XG4gICAgICByZXR1cm4gaXNPYmplY3QocHJvdG90eXBlKSA/IG5hdGl2ZUNyZWF0ZShwcm90b3R5cGUpIDoge307XG4gICAgfVxuICAgIC8vIGZhbGxiYWNrIGZvciBicm93c2VycyB3aXRob3V0IGBPYmplY3QuY3JlYXRlYFxuICAgIGlmICghbmF0aXZlQ3JlYXRlKSB7XG4gICAgICBiYXNlQ3JlYXRlID0gKGZ1bmN0aW9uKCkge1xuICAgICAgICBmdW5jdGlvbiBPYmplY3QoKSB7fVxuICAgICAgICByZXR1cm4gZnVuY3Rpb24ocHJvdG90eXBlKSB7XG4gICAgICAgICAgaWYgKGlzT2JqZWN0KHByb3RvdHlwZSkpIHtcbiAgICAgICAgICAgIE9iamVjdC5wcm90b3R5cGUgPSBwcm90b3R5cGU7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IE9iamVjdDtcbiAgICAgICAgICAgIE9iamVjdC5wcm90b3R5cGUgPSBudWxsO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gcmVzdWx0IHx8IGNvbnRleHQuT2JqZWN0KCk7XG4gICAgICAgIH07XG4gICAgICB9KCkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLmNyZWF0ZUNhbGxiYWNrYCB3aXRob3V0IHN1cHBvcnQgZm9yIGNyZWF0aW5nXG4gICAgICogXCJfLnBsdWNrXCIgb3IgXCJfLndoZXJlXCIgc3R5bGUgY2FsbGJhY2tzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0geyp9IFtmdW5jPWlkZW50aXR5XSBUaGUgdmFsdWUgdG8gY29udmVydCB0byBhIGNhbGxiYWNrLlxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiB0aGUgY3JlYXRlZCBjYWxsYmFjay5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW2FyZ0NvdW50XSBUaGUgbnVtYmVyIG9mIGFyZ3VtZW50cyB0aGUgY2FsbGJhY2sgYWNjZXB0cy5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgYSBjYWxsYmFjayBmdW5jdGlvbi5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBiYXNlQ3JlYXRlQ2FsbGJhY2soZnVuYywgdGhpc0FyZywgYXJnQ291bnQpIHtcbiAgICAgIGlmICh0eXBlb2YgZnVuYyAhPSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHJldHVybiBpZGVudGl0eTtcbiAgICAgIH1cbiAgICAgIC8vIGV4aXQgZWFybHkgZm9yIG5vIGB0aGlzQXJnYCBvciBhbHJlYWR5IGJvdW5kIGJ5IGBGdW5jdGlvbiNiaW5kYFxuICAgICAgaWYgKHR5cGVvZiB0aGlzQXJnID09ICd1bmRlZmluZWQnIHx8ICEoJ3Byb3RvdHlwZScgaW4gZnVuYykpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmM7XG4gICAgICB9XG4gICAgICB2YXIgYmluZERhdGEgPSBmdW5jLl9fYmluZERhdGFfXztcbiAgICAgIGlmICh0eXBlb2YgYmluZERhdGEgPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgaWYgKHN1cHBvcnQuZnVuY05hbWVzKSB7XG4gICAgICAgICAgYmluZERhdGEgPSAhZnVuYy5uYW1lO1xuICAgICAgICB9XG4gICAgICAgIGJpbmREYXRhID0gYmluZERhdGEgfHwgIXN1cHBvcnQuZnVuY0RlY29tcDtcbiAgICAgICAgaWYgKCFiaW5kRGF0YSkge1xuICAgICAgICAgIHZhciBzb3VyY2UgPSBmblRvU3RyaW5nLmNhbGwoZnVuYyk7XG4gICAgICAgICAgaWYgKCFzdXBwb3J0LmZ1bmNOYW1lcykge1xuICAgICAgICAgICAgYmluZERhdGEgPSAhcmVGdW5jTmFtZS50ZXN0KHNvdXJjZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICghYmluZERhdGEpIHtcbiAgICAgICAgICAgIC8vIGNoZWNrcyBpZiBgZnVuY2AgcmVmZXJlbmNlcyB0aGUgYHRoaXNgIGtleXdvcmQgYW5kIHN0b3JlcyB0aGUgcmVzdWx0XG4gICAgICAgICAgICBiaW5kRGF0YSA9IHJlVGhpcy50ZXN0KHNvdXJjZSk7XG4gICAgICAgICAgICBzZXRCaW5kRGF0YShmdW5jLCBiaW5kRGF0YSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICAvLyBleGl0IGVhcmx5IGlmIHRoZXJlIGFyZSBubyBgdGhpc2AgcmVmZXJlbmNlcyBvciBgZnVuY2AgaXMgYm91bmRcbiAgICAgIGlmIChiaW5kRGF0YSA9PT0gZmFsc2UgfHwgKGJpbmREYXRhICE9PSB0cnVlICYmIGJpbmREYXRhWzFdICYgMSkpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmM7XG4gICAgICB9XG4gICAgICBzd2l0Y2ggKGFyZ0NvdW50KSB7XG4gICAgICAgIGNhc2UgMTogcmV0dXJuIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgcmV0dXJuIGZ1bmMuY2FsbCh0aGlzQXJnLCB2YWx1ZSk7XG4gICAgICAgIH07XG4gICAgICAgIGNhc2UgMjogcmV0dXJuIGZ1bmN0aW9uKGEsIGIpIHtcbiAgICAgICAgICByZXR1cm4gZnVuYy5jYWxsKHRoaXNBcmcsIGEsIGIpO1xuICAgICAgICB9O1xuICAgICAgICBjYXNlIDM6IHJldHVybiBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pIHtcbiAgICAgICAgICByZXR1cm4gZnVuYy5jYWxsKHRoaXNBcmcsIHZhbHVlLCBpbmRleCwgY29sbGVjdGlvbik7XG4gICAgICAgIH07XG4gICAgICAgIGNhc2UgNDogcmV0dXJuIGZ1bmN0aW9uKGFjY3VtdWxhdG9yLCB2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pIHtcbiAgICAgICAgICByZXR1cm4gZnVuYy5jYWxsKHRoaXNBcmcsIGFjY3VtdWxhdG9yLCB2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgcmV0dXJuIGJpbmQoZnVuYywgdGhpc0FyZyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYGNyZWF0ZVdyYXBwZXJgIHRoYXQgY3JlYXRlcyB0aGUgd3JhcHBlciBhbmRcbiAgICAgKiBzZXRzIGl0cyBtZXRhIGRhdGEuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGJpbmREYXRhIFRoZSBiaW5kIGRhdGEgYXJyYXkuXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgZnVuY3Rpb24uXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZUNyZWF0ZVdyYXBwZXIoYmluZERhdGEpIHtcbiAgICAgIHZhciBmdW5jID0gYmluZERhdGFbMF0sXG4gICAgICAgICAgYml0bWFzayA9IGJpbmREYXRhWzFdLFxuICAgICAgICAgIHBhcnRpYWxBcmdzID0gYmluZERhdGFbMl0sXG4gICAgICAgICAgcGFydGlhbFJpZ2h0QXJncyA9IGJpbmREYXRhWzNdLFxuICAgICAgICAgIHRoaXNBcmcgPSBiaW5kRGF0YVs0XSxcbiAgICAgICAgICBhcml0eSA9IGJpbmREYXRhWzVdO1xuXG4gICAgICB2YXIgaXNCaW5kID0gYml0bWFzayAmIDEsXG4gICAgICAgICAgaXNCaW5kS2V5ID0gYml0bWFzayAmIDIsXG4gICAgICAgICAgaXNDdXJyeSA9IGJpdG1hc2sgJiA0LFxuICAgICAgICAgIGlzQ3VycnlCb3VuZCA9IGJpdG1hc2sgJiA4LFxuICAgICAgICAgIGtleSA9IGZ1bmM7XG5cbiAgICAgIGZ1bmN0aW9uIGJvdW5kKCkge1xuICAgICAgICB2YXIgdGhpc0JpbmRpbmcgPSBpc0JpbmQgPyB0aGlzQXJnIDogdGhpcztcbiAgICAgICAgaWYgKHBhcnRpYWxBcmdzKSB7XG4gICAgICAgICAgdmFyIGFyZ3MgPSBzbGljZShwYXJ0aWFsQXJncyk7XG4gICAgICAgICAgcHVzaC5hcHBseShhcmdzLCBhcmd1bWVudHMpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJ0aWFsUmlnaHRBcmdzIHx8IGlzQ3VycnkpIHtcbiAgICAgICAgICBhcmdzIHx8IChhcmdzID0gc2xpY2UoYXJndW1lbnRzKSk7XG4gICAgICAgICAgaWYgKHBhcnRpYWxSaWdodEFyZ3MpIHtcbiAgICAgICAgICAgIHB1c2guYXBwbHkoYXJncywgcGFydGlhbFJpZ2h0QXJncyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChpc0N1cnJ5ICYmIGFyZ3MubGVuZ3RoIDwgYXJpdHkpIHtcbiAgICAgICAgICAgIGJpdG1hc2sgfD0gMTYgJiB+MzI7XG4gICAgICAgICAgICByZXR1cm4gYmFzZUNyZWF0ZVdyYXBwZXIoW2Z1bmMsIChpc0N1cnJ5Qm91bmQgPyBiaXRtYXNrIDogYml0bWFzayAmIH4zKSwgYXJncywgbnVsbCwgdGhpc0FyZywgYXJpdHldKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYXJncyB8fCAoYXJncyA9IGFyZ3VtZW50cyk7XG4gICAgICAgIGlmIChpc0JpbmRLZXkpIHtcbiAgICAgICAgICBmdW5jID0gdGhpc0JpbmRpbmdba2V5XTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcyBpbnN0YW5jZW9mIGJvdW5kKSB7XG4gICAgICAgICAgdGhpc0JpbmRpbmcgPSBiYXNlQ3JlYXRlKGZ1bmMucHJvdG90eXBlKTtcbiAgICAgICAgICB2YXIgcmVzdWx0ID0gZnVuYy5hcHBseSh0aGlzQmluZGluZywgYXJncyk7XG4gICAgICAgICAgcmV0dXJuIGlzT2JqZWN0KHJlc3VsdCkgPyByZXN1bHQgOiB0aGlzQmluZGluZztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZnVuYy5hcHBseSh0aGlzQmluZGluZywgYXJncyk7XG4gICAgICB9XG4gICAgICBzZXRCaW5kRGF0YShib3VuZCwgYmluZERhdGEpO1xuICAgICAgcmV0dXJuIGJvdW5kO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLmRpZmZlcmVuY2VgIHRoYXQgYWNjZXB0cyBhIHNpbmdsZSBhcnJheVxuICAgICAqIG9mIHZhbHVlcyB0byBleGNsdWRlLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gcHJvY2Vzcy5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBbdmFsdWVzXSBUaGUgYXJyYXkgb2YgdmFsdWVzIHRvIGV4Y2x1ZGUuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIGEgbmV3IGFycmF5IG9mIGZpbHRlcmVkIHZhbHVlcy5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBiYXNlRGlmZmVyZW5jZShhcnJheSwgdmFsdWVzKSB7XG4gICAgICB2YXIgaW5kZXggPSAtMSxcbiAgICAgICAgICBpbmRleE9mID0gZ2V0SW5kZXhPZigpLFxuICAgICAgICAgIGxlbmd0aCA9IGFycmF5ID8gYXJyYXkubGVuZ3RoIDogMCxcbiAgICAgICAgICBpc0xhcmdlID0gbGVuZ3RoID49IGxhcmdlQXJyYXlTaXplICYmIGluZGV4T2YgPT09IGJhc2VJbmRleE9mLFxuICAgICAgICAgIHJlc3VsdCA9IFtdO1xuXG4gICAgICBpZiAoaXNMYXJnZSkge1xuICAgICAgICB2YXIgY2FjaGUgPSBjcmVhdGVDYWNoZSh2YWx1ZXMpO1xuICAgICAgICBpZiAoY2FjaGUpIHtcbiAgICAgICAgICBpbmRleE9mID0gY2FjaGVJbmRleE9mO1xuICAgICAgICAgIHZhbHVlcyA9IGNhY2hlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlzTGFyZ2UgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gYXJyYXlbaW5kZXhdO1xuICAgICAgICBpZiAoaW5kZXhPZih2YWx1ZXMsIHZhbHVlKSA8IDApIHtcbiAgICAgICAgICByZXN1bHQucHVzaCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChpc0xhcmdlKSB7XG4gICAgICAgIHJlbGVhc2VPYmplY3QodmFsdWVzKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8uZmxhdHRlbmAgd2l0aG91dCBzdXBwb3J0IGZvciBjYWxsYmFja1xuICAgICAqIHNob3J0aGFuZHMgb3IgYHRoaXNBcmdgIGJpbmRpbmcuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBmbGF0dGVuLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2lzU2hhbGxvdz1mYWxzZV0gQSBmbGFnIHRvIHJlc3RyaWN0IGZsYXR0ZW5pbmcgdG8gYSBzaW5nbGUgbGV2ZWwuXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbaXNTdHJpY3Q9ZmFsc2VdIEEgZmxhZyB0byByZXN0cmljdCBmbGF0dGVuaW5nIHRvIGFycmF5cyBhbmQgYGFyZ3VtZW50c2Agb2JqZWN0cy5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW2Zyb21JbmRleD0wXSBUaGUgaW5kZXggdG8gc3RhcnQgZnJvbS5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgYSBuZXcgZmxhdHRlbmVkIGFycmF5LlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJhc2VGbGF0dGVuKGFycmF5LCBpc1NoYWxsb3csIGlzU3RyaWN0LCBmcm9tSW5kZXgpIHtcbiAgICAgIHZhciBpbmRleCA9IChmcm9tSW5kZXggfHwgMCkgLSAxLFxuICAgICAgICAgIGxlbmd0aCA9IGFycmF5ID8gYXJyYXkubGVuZ3RoIDogMCxcbiAgICAgICAgICByZXN1bHQgPSBbXTtcblxuICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gYXJyYXlbaW5kZXhdO1xuXG4gICAgICAgIGlmICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT0gJ29iamVjdCcgJiYgdHlwZW9mIHZhbHVlLmxlbmd0aCA9PSAnbnVtYmVyJ1xuICAgICAgICAgICAgJiYgKGlzQXJyYXkodmFsdWUpIHx8IGlzQXJndW1lbnRzKHZhbHVlKSkpIHtcbiAgICAgICAgICAvLyByZWN1cnNpdmVseSBmbGF0dGVuIGFycmF5cyAoc3VzY2VwdGlibGUgdG8gY2FsbCBzdGFjayBsaW1pdHMpXG4gICAgICAgICAgaWYgKCFpc1NoYWxsb3cpIHtcbiAgICAgICAgICAgIHZhbHVlID0gYmFzZUZsYXR0ZW4odmFsdWUsIGlzU2hhbGxvdywgaXNTdHJpY3QpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgdmFsSW5kZXggPSAtMSxcbiAgICAgICAgICAgICAgdmFsTGVuZ3RoID0gdmFsdWUubGVuZ3RoLFxuICAgICAgICAgICAgICByZXNJbmRleCA9IHJlc3VsdC5sZW5ndGg7XG5cbiAgICAgICAgICByZXN1bHQubGVuZ3RoICs9IHZhbExlbmd0aDtcbiAgICAgICAgICB3aGlsZSAoKyt2YWxJbmRleCA8IHZhbExlbmd0aCkge1xuICAgICAgICAgICAgcmVzdWx0W3Jlc0luZGV4KytdID0gdmFsdWVbdmFsSW5kZXhdO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICghaXNTdHJpY3QpIHtcbiAgICAgICAgICByZXN1bHQucHVzaCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8uaXNFcXVhbGAsIHdpdGhvdXQgc3VwcG9ydCBmb3IgYHRoaXNBcmdgIGJpbmRpbmcsXG4gICAgICogdGhhdCBhbGxvd3MgcGFydGlhbCBcIl8ud2hlcmVcIiBzdHlsZSBjb21wYXJpc29ucy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHsqfSBhIFRoZSB2YWx1ZSB0byBjb21wYXJlLlxuICAgICAqIEBwYXJhbSB7Kn0gYiBUaGUgb3RoZXIgdmFsdWUgdG8gY29tcGFyZS5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY2FsbGJhY2tdIFRoZSBmdW5jdGlvbiB0byBjdXN0b21pemUgY29tcGFyaW5nIHZhbHVlcy5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbaXNXaGVyZT1mYWxzZV0gQSBmbGFnIHRvIGluZGljYXRlIHBlcmZvcm1pbmcgcGFydGlhbCBjb21wYXJpc29ucy5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBbc3RhY2tBPVtdXSBUcmFja3MgdHJhdmVyc2VkIGBhYCBvYmplY3RzLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFtzdGFja0I9W11dIFRyYWNrcyB0cmF2ZXJzZWQgYGJgIG9iamVjdHMuXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSB2YWx1ZXMgYXJlIGVxdWl2YWxlbnQsIGVsc2UgYGZhbHNlYC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBiYXNlSXNFcXVhbChhLCBiLCBjYWxsYmFjaywgaXNXaGVyZSwgc3RhY2tBLCBzdGFja0IpIHtcbiAgICAgIC8vIHVzZWQgdG8gaW5kaWNhdGUgdGhhdCB3aGVuIGNvbXBhcmluZyBvYmplY3RzLCBgYWAgaGFzIGF0IGxlYXN0IHRoZSBwcm9wZXJ0aWVzIG9mIGBiYFxuICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBjYWxsYmFjayhhLCBiKTtcbiAgICAgICAgaWYgKHR5cGVvZiByZXN1bHQgIT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICByZXR1cm4gISFyZXN1bHQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIC8vIGV4aXQgZWFybHkgZm9yIGlkZW50aWNhbCB2YWx1ZXNcbiAgICAgIGlmIChhID09PSBiKSB7XG4gICAgICAgIC8vIHRyZWF0IGArMGAgdnMuIGAtMGAgYXMgbm90IGVxdWFsXG4gICAgICAgIHJldHVybiBhICE9PSAwIHx8ICgxIC8gYSA9PSAxIC8gYik7XG4gICAgICB9XG4gICAgICB2YXIgdHlwZSA9IHR5cGVvZiBhLFxuICAgICAgICAgIG90aGVyVHlwZSA9IHR5cGVvZiBiO1xuXG4gICAgICAvLyBleGl0IGVhcmx5IGZvciB1bmxpa2UgcHJpbWl0aXZlIHZhbHVlc1xuICAgICAgaWYgKGEgPT09IGEgJiZcbiAgICAgICAgICAhKGEgJiYgb2JqZWN0VHlwZXNbdHlwZV0pICYmXG4gICAgICAgICAgIShiICYmIG9iamVjdFR5cGVzW290aGVyVHlwZV0pKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIC8vIGV4aXQgZWFybHkgZm9yIGBudWxsYCBhbmQgYHVuZGVmaW5lZGAgYXZvaWRpbmcgRVMzJ3MgRnVuY3Rpb24jY2FsbCBiZWhhdmlvclxuICAgICAgLy8gaHR0cDovL2VzNS5naXRodWIuaW8vI3gxNS4zLjQuNFxuICAgICAgaWYgKGEgPT0gbnVsbCB8fCBiID09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIGEgPT09IGI7XG4gICAgICB9XG4gICAgICAvLyBjb21wYXJlIFtbQ2xhc3NdXSBuYW1lc1xuICAgICAgdmFyIGNsYXNzTmFtZSA9IHRvU3RyaW5nLmNhbGwoYSksXG4gICAgICAgICAgb3RoZXJDbGFzcyA9IHRvU3RyaW5nLmNhbGwoYik7XG5cbiAgICAgIGlmIChjbGFzc05hbWUgPT0gYXJnc0NsYXNzKSB7XG4gICAgICAgIGNsYXNzTmFtZSA9IG9iamVjdENsYXNzO1xuICAgICAgfVxuICAgICAgaWYgKG90aGVyQ2xhc3MgPT0gYXJnc0NsYXNzKSB7XG4gICAgICAgIG90aGVyQ2xhc3MgPSBvYmplY3RDbGFzcztcbiAgICAgIH1cbiAgICAgIGlmIChjbGFzc05hbWUgIT0gb3RoZXJDbGFzcykge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBzd2l0Y2ggKGNsYXNzTmFtZSkge1xuICAgICAgICBjYXNlIGJvb2xDbGFzczpcbiAgICAgICAgY2FzZSBkYXRlQ2xhc3M6XG4gICAgICAgICAgLy8gY29lcmNlIGRhdGVzIGFuZCBib29sZWFucyB0byBudW1iZXJzLCBkYXRlcyB0byBtaWxsaXNlY29uZHMgYW5kIGJvb2xlYW5zXG4gICAgICAgICAgLy8gdG8gYDFgIG9yIGAwYCB0cmVhdGluZyBpbnZhbGlkIGRhdGVzIGNvZXJjZWQgdG8gYE5hTmAgYXMgbm90IGVxdWFsXG4gICAgICAgICAgcmV0dXJuICthID09ICtiO1xuXG4gICAgICAgIGNhc2UgbnVtYmVyQ2xhc3M6XG4gICAgICAgICAgLy8gdHJlYXQgYE5hTmAgdnMuIGBOYU5gIGFzIGVxdWFsXG4gICAgICAgICAgcmV0dXJuIChhICE9ICthKVxuICAgICAgICAgICAgPyBiICE9ICtiXG4gICAgICAgICAgICAvLyBidXQgdHJlYXQgYCswYCB2cy4gYC0wYCBhcyBub3QgZXF1YWxcbiAgICAgICAgICAgIDogKGEgPT0gMCA/ICgxIC8gYSA9PSAxIC8gYikgOiBhID09ICtiKTtcblxuICAgICAgICBjYXNlIHJlZ2V4cENsYXNzOlxuICAgICAgICBjYXNlIHN0cmluZ0NsYXNzOlxuICAgICAgICAgIC8vIGNvZXJjZSByZWdleGVzIHRvIHN0cmluZ3MgKGh0dHA6Ly9lczUuZ2l0aHViLmlvLyN4MTUuMTAuNi40KVxuICAgICAgICAgIC8vIHRyZWF0IHN0cmluZyBwcmltaXRpdmVzIGFuZCB0aGVpciBjb3JyZXNwb25kaW5nIG9iamVjdCBpbnN0YW5jZXMgYXMgZXF1YWxcbiAgICAgICAgICByZXR1cm4gYSA9PSBTdHJpbmcoYik7XG4gICAgICB9XG4gICAgICB2YXIgaXNBcnIgPSBjbGFzc05hbWUgPT0gYXJyYXlDbGFzcztcbiAgICAgIGlmICghaXNBcnIpIHtcbiAgICAgICAgLy8gdW53cmFwIGFueSBgbG9kYXNoYCB3cmFwcGVkIHZhbHVlc1xuICAgICAgICB2YXIgYVdyYXBwZWQgPSBoYXNPd25Qcm9wZXJ0eS5jYWxsKGEsICdfX3dyYXBwZWRfXycpLFxuICAgICAgICAgICAgYldyYXBwZWQgPSBoYXNPd25Qcm9wZXJ0eS5jYWxsKGIsICdfX3dyYXBwZWRfXycpO1xuXG4gICAgICAgIGlmIChhV3JhcHBlZCB8fCBiV3JhcHBlZCkge1xuICAgICAgICAgIHJldHVybiBiYXNlSXNFcXVhbChhV3JhcHBlZCA/IGEuX193cmFwcGVkX18gOiBhLCBiV3JhcHBlZCA/IGIuX193cmFwcGVkX18gOiBiLCBjYWxsYmFjaywgaXNXaGVyZSwgc3RhY2tBLCBzdGFja0IpO1xuICAgICAgICB9XG4gICAgICAgIC8vIGV4aXQgZm9yIGZ1bmN0aW9ucyBhbmQgRE9NIG5vZGVzXG4gICAgICAgIGlmIChjbGFzc05hbWUgIT0gb2JqZWN0Q2xhc3MpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgLy8gaW4gb2xkZXIgdmVyc2lvbnMgb2YgT3BlcmEsIGBhcmd1bWVudHNgIG9iamVjdHMgaGF2ZSBgQXJyYXlgIGNvbnN0cnVjdG9yc1xuICAgICAgICB2YXIgY3RvckEgPSBhLmNvbnN0cnVjdG9yLFxuICAgICAgICAgICAgY3RvckIgPSBiLmNvbnN0cnVjdG9yO1xuXG4gICAgICAgIC8vIG5vbiBgT2JqZWN0YCBvYmplY3QgaW5zdGFuY2VzIHdpdGggZGlmZmVyZW50IGNvbnN0cnVjdG9ycyBhcmUgbm90IGVxdWFsXG4gICAgICAgIGlmIChjdG9yQSAhPSBjdG9yQiAmJlxuICAgICAgICAgICAgICAhKGlzRnVuY3Rpb24oY3RvckEpICYmIGN0b3JBIGluc3RhbmNlb2YgY3RvckEgJiYgaXNGdW5jdGlvbihjdG9yQikgJiYgY3RvckIgaW5zdGFuY2VvZiBjdG9yQikgJiZcbiAgICAgICAgICAgICAgKCdjb25zdHJ1Y3RvcicgaW4gYSAmJiAnY29uc3RydWN0b3InIGluIGIpXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIC8vIGFzc3VtZSBjeWNsaWMgc3RydWN0dXJlcyBhcmUgZXF1YWxcbiAgICAgIC8vIHRoZSBhbGdvcml0aG0gZm9yIGRldGVjdGluZyBjeWNsaWMgc3RydWN0dXJlcyBpcyBhZGFwdGVkIGZyb20gRVMgNS4xXG4gICAgICAvLyBzZWN0aW9uIDE1LjEyLjMsIGFic3RyYWN0IG9wZXJhdGlvbiBgSk9gIChodHRwOi8vZXM1LmdpdGh1Yi5pby8jeDE1LjEyLjMpXG4gICAgICB2YXIgaW5pdGVkU3RhY2sgPSAhc3RhY2tBO1xuICAgICAgc3RhY2tBIHx8IChzdGFja0EgPSBnZXRBcnJheSgpKTtcbiAgICAgIHN0YWNrQiB8fCAoc3RhY2tCID0gZ2V0QXJyYXkoKSk7XG5cbiAgICAgIHZhciBsZW5ndGggPSBzdGFja0EubGVuZ3RoO1xuICAgICAgd2hpbGUgKGxlbmd0aC0tKSB7XG4gICAgICAgIGlmIChzdGFja0FbbGVuZ3RoXSA9PSBhKSB7XG4gICAgICAgICAgcmV0dXJuIHN0YWNrQltsZW5ndGhdID09IGI7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHZhciBzaXplID0gMDtcbiAgICAgIHJlc3VsdCA9IHRydWU7XG5cbiAgICAgIC8vIGFkZCBgYWAgYW5kIGBiYCB0byB0aGUgc3RhY2sgb2YgdHJhdmVyc2VkIG9iamVjdHNcbiAgICAgIHN0YWNrQS5wdXNoKGEpO1xuICAgICAgc3RhY2tCLnB1c2goYik7XG5cbiAgICAgIC8vIHJlY3Vyc2l2ZWx5IGNvbXBhcmUgb2JqZWN0cyBhbmQgYXJyYXlzIChzdXNjZXB0aWJsZSB0byBjYWxsIHN0YWNrIGxpbWl0cylcbiAgICAgIGlmIChpc0Fycikge1xuICAgICAgICAvLyBjb21wYXJlIGxlbmd0aHMgdG8gZGV0ZXJtaW5lIGlmIGEgZGVlcCBjb21wYXJpc29uIGlzIG5lY2Vzc2FyeVxuICAgICAgICBsZW5ndGggPSBhLmxlbmd0aDtcbiAgICAgICAgc2l6ZSA9IGIubGVuZ3RoO1xuICAgICAgICByZXN1bHQgPSBzaXplID09IGxlbmd0aDtcblxuICAgICAgICBpZiAocmVzdWx0IHx8IGlzV2hlcmUpIHtcbiAgICAgICAgICAvLyBkZWVwIGNvbXBhcmUgdGhlIGNvbnRlbnRzLCBpZ25vcmluZyBub24tbnVtZXJpYyBwcm9wZXJ0aWVzXG4gICAgICAgICAgd2hpbGUgKHNpemUtLSkge1xuICAgICAgICAgICAgdmFyIGluZGV4ID0gbGVuZ3RoLFxuICAgICAgICAgICAgICAgIHZhbHVlID0gYltzaXplXTtcblxuICAgICAgICAgICAgaWYgKGlzV2hlcmUpIHtcbiAgICAgICAgICAgICAgd2hpbGUgKGluZGV4LS0pIHtcbiAgICAgICAgICAgICAgICBpZiAoKHJlc3VsdCA9IGJhc2VJc0VxdWFsKGFbaW5kZXhdLCB2YWx1ZSwgY2FsbGJhY2ssIGlzV2hlcmUsIHN0YWNrQSwgc3RhY2tCKSkpIHtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmICghKHJlc3VsdCA9IGJhc2VJc0VxdWFsKGFbc2l6ZV0sIHZhbHVlLCBjYWxsYmFjaywgaXNXaGVyZSwgc3RhY2tBLCBzdGFja0IpKSkge1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICAvLyBkZWVwIGNvbXBhcmUgb2JqZWN0cyB1c2luZyBgZm9ySW5gLCBpbnN0ZWFkIG9mIGBmb3JPd25gLCB0byBhdm9pZCBgT2JqZWN0LmtleXNgXG4gICAgICAgIC8vIHdoaWNoLCBpbiB0aGlzIGNhc2UsIGlzIG1vcmUgY29zdGx5XG4gICAgICAgIGZvckluKGIsIGZ1bmN0aW9uKHZhbHVlLCBrZXksIGIpIHtcbiAgICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChiLCBrZXkpKSB7XG4gICAgICAgICAgICAvLyBjb3VudCB0aGUgbnVtYmVyIG9mIHByb3BlcnRpZXMuXG4gICAgICAgICAgICBzaXplKys7XG4gICAgICAgICAgICAvLyBkZWVwIGNvbXBhcmUgZWFjaCBwcm9wZXJ0eSB2YWx1ZS5cbiAgICAgICAgICAgIHJldHVybiAocmVzdWx0ID0gaGFzT3duUHJvcGVydHkuY2FsbChhLCBrZXkpICYmIGJhc2VJc0VxdWFsKGFba2V5XSwgdmFsdWUsIGNhbGxiYWNrLCBpc1doZXJlLCBzdGFja0EsIHN0YWNrQikpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKHJlc3VsdCAmJiAhaXNXaGVyZSkge1xuICAgICAgICAgIC8vIGVuc3VyZSBib3RoIG9iamVjdHMgaGF2ZSB0aGUgc2FtZSBudW1iZXIgb2YgcHJvcGVydGllc1xuICAgICAgICAgIGZvckluKGEsIGZ1bmN0aW9uKHZhbHVlLCBrZXksIGEpIHtcbiAgICAgICAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKGEsIGtleSkpIHtcbiAgICAgICAgICAgICAgLy8gYHNpemVgIHdpbGwgYmUgYC0xYCBpZiBgYWAgaGFzIG1vcmUgcHJvcGVydGllcyB0aGFuIGBiYFxuICAgICAgICAgICAgICByZXR1cm4gKHJlc3VsdCA9IC0tc2l6ZSA+IC0xKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgc3RhY2tBLnBvcCgpO1xuICAgICAgc3RhY2tCLnBvcCgpO1xuXG4gICAgICBpZiAoaW5pdGVkU3RhY2spIHtcbiAgICAgICAgcmVsZWFzZUFycmF5KHN0YWNrQSk7XG4gICAgICAgIHJlbGVhc2VBcnJheShzdGFja0IpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy5tZXJnZWAgd2l0aG91dCBhcmd1bWVudCBqdWdnbGluZyBvciBzdXBwb3J0XG4gICAgICogZm9yIGB0aGlzQXJnYCBiaW5kaW5nLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBkZXN0aW5hdGlvbiBvYmplY3QuXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHNvdXJjZSBUaGUgc291cmNlIG9iamVjdC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY2FsbGJhY2tdIFRoZSBmdW5jdGlvbiB0byBjdXN0b21pemUgbWVyZ2luZyBwcm9wZXJ0aWVzLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFtzdGFja0E9W11dIFRyYWNrcyB0cmF2ZXJzZWQgc291cmNlIG9iamVjdHMuXG4gICAgICogQHBhcmFtIHtBcnJheX0gW3N0YWNrQj1bXV0gQXNzb2NpYXRlcyB2YWx1ZXMgd2l0aCBzb3VyY2UgY291bnRlcnBhcnRzLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJhc2VNZXJnZShvYmplY3QsIHNvdXJjZSwgY2FsbGJhY2ssIHN0YWNrQSwgc3RhY2tCKSB7XG4gICAgICAoaXNBcnJheShzb3VyY2UpID8gZm9yRWFjaCA6IGZvck93bikoc291cmNlLCBmdW5jdGlvbihzb3VyY2UsIGtleSkge1xuICAgICAgICB2YXIgZm91bmQsXG4gICAgICAgICAgICBpc0FycixcbiAgICAgICAgICAgIHJlc3VsdCA9IHNvdXJjZSxcbiAgICAgICAgICAgIHZhbHVlID0gb2JqZWN0W2tleV07XG5cbiAgICAgICAgaWYgKHNvdXJjZSAmJiAoKGlzQXJyID0gaXNBcnJheShzb3VyY2UpKSB8fCBpc1BsYWluT2JqZWN0KHNvdXJjZSkpKSB7XG4gICAgICAgICAgLy8gYXZvaWQgbWVyZ2luZyBwcmV2aW91c2x5IG1lcmdlZCBjeWNsaWMgc291cmNlc1xuICAgICAgICAgIHZhciBzdGFja0xlbmd0aCA9IHN0YWNrQS5sZW5ndGg7XG4gICAgICAgICAgd2hpbGUgKHN0YWNrTGVuZ3RoLS0pIHtcbiAgICAgICAgICAgIGlmICgoZm91bmQgPSBzdGFja0Fbc3RhY2tMZW5ndGhdID09IHNvdXJjZSkpIHtcbiAgICAgICAgICAgICAgdmFsdWUgPSBzdGFja0Jbc3RhY2tMZW5ndGhdO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFmb3VuZCkge1xuICAgICAgICAgICAgdmFyIGlzU2hhbGxvdztcbiAgICAgICAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICAgICAgICByZXN1bHQgPSBjYWxsYmFjayh2YWx1ZSwgc291cmNlKTtcbiAgICAgICAgICAgICAgaWYgKChpc1NoYWxsb3cgPSB0eXBlb2YgcmVzdWx0ICE9ICd1bmRlZmluZWQnKSkge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gcmVzdWx0O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWlzU2hhbGxvdykge1xuICAgICAgICAgICAgICB2YWx1ZSA9IGlzQXJyXG4gICAgICAgICAgICAgICAgPyAoaXNBcnJheSh2YWx1ZSkgPyB2YWx1ZSA6IFtdKVxuICAgICAgICAgICAgICAgIDogKGlzUGxhaW5PYmplY3QodmFsdWUpID8gdmFsdWUgOiB7fSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBhZGQgYHNvdXJjZWAgYW5kIGFzc29jaWF0ZWQgYHZhbHVlYCB0byB0aGUgc3RhY2sgb2YgdHJhdmVyc2VkIG9iamVjdHNcbiAgICAgICAgICAgIHN0YWNrQS5wdXNoKHNvdXJjZSk7XG4gICAgICAgICAgICBzdGFja0IucHVzaCh2YWx1ZSk7XG5cbiAgICAgICAgICAgIC8vIHJlY3Vyc2l2ZWx5IG1lcmdlIG9iamVjdHMgYW5kIGFycmF5cyAoc3VzY2VwdGlibGUgdG8gY2FsbCBzdGFjayBsaW1pdHMpXG4gICAgICAgICAgICBpZiAoIWlzU2hhbGxvdykge1xuICAgICAgICAgICAgICBiYXNlTWVyZ2UodmFsdWUsIHNvdXJjZSwgY2FsbGJhY2ssIHN0YWNrQSwgc3RhY2tCKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICByZXN1bHQgPSBjYWxsYmFjayh2YWx1ZSwgc291cmNlKTtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgcmVzdWx0ID09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgIHJlc3VsdCA9IHNvdXJjZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHR5cGVvZiByZXN1bHQgIT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHZhbHVlID0gcmVzdWx0O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBvYmplY3Rba2V5XSA9IHZhbHVlO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8ucmFuZG9tYCB3aXRob3V0IGFyZ3VtZW50IGp1Z2dsaW5nIG9yIHN1cHBvcnRcbiAgICAgKiBmb3IgcmV0dXJuaW5nIGZsb2F0aW5nLXBvaW50IG51bWJlcnMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBtaW4gVGhlIG1pbmltdW0gcG9zc2libGUgdmFsdWUuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IG1heCBUaGUgbWF4aW11bSBwb3NzaWJsZSB2YWx1ZS5cbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIGEgcmFuZG9tIG51bWJlci5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBiYXNlUmFuZG9tKG1pbiwgbWF4KSB7XG4gICAgICByZXR1cm4gbWluICsgZmxvb3IobmF0aXZlUmFuZG9tKCkgKiAobWF4IC0gbWluICsgMSkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLnVuaXFgIHdpdGhvdXQgc3VwcG9ydCBmb3IgY2FsbGJhY2sgc2hvcnRoYW5kc1xuICAgICAqIG9yIGB0aGlzQXJnYCBiaW5kaW5nLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gcHJvY2Vzcy5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtpc1NvcnRlZD1mYWxzZV0gQSBmbGFnIHRvIGluZGljYXRlIHRoYXQgYGFycmF5YCBpcyBzb3J0ZWQuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2NhbGxiYWNrXSBUaGUgZnVuY3Rpb24gY2FsbGVkIHBlciBpdGVyYXRpb24uXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIGEgZHVwbGljYXRlLXZhbHVlLWZyZWUgYXJyYXkuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZVVuaXEoYXJyYXksIGlzU29ydGVkLCBjYWxsYmFjaykge1xuICAgICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgICAgaW5kZXhPZiA9IGdldEluZGV4T2YoKSxcbiAgICAgICAgICBsZW5ndGggPSBhcnJheSA/IGFycmF5Lmxlbmd0aCA6IDAsXG4gICAgICAgICAgcmVzdWx0ID0gW107XG5cbiAgICAgIHZhciBpc0xhcmdlID0gIWlzU29ydGVkICYmIGxlbmd0aCA+PSBsYXJnZUFycmF5U2l6ZSAmJiBpbmRleE9mID09PSBiYXNlSW5kZXhPZixcbiAgICAgICAgICBzZWVuID0gKGNhbGxiYWNrIHx8IGlzTGFyZ2UpID8gZ2V0QXJyYXkoKSA6IHJlc3VsdDtcblxuICAgICAgaWYgKGlzTGFyZ2UpIHtcbiAgICAgICAgdmFyIGNhY2hlID0gY3JlYXRlQ2FjaGUoc2Vlbik7XG4gICAgICAgIGluZGV4T2YgPSBjYWNoZUluZGV4T2Y7XG4gICAgICAgIHNlZW4gPSBjYWNoZTtcbiAgICAgIH1cbiAgICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IGFycmF5W2luZGV4XSxcbiAgICAgICAgICAgIGNvbXB1dGVkID0gY2FsbGJhY2sgPyBjYWxsYmFjayh2YWx1ZSwgaW5kZXgsIGFycmF5KSA6IHZhbHVlO1xuXG4gICAgICAgIGlmIChpc1NvcnRlZFxuICAgICAgICAgICAgICA/ICFpbmRleCB8fCBzZWVuW3NlZW4ubGVuZ3RoIC0gMV0gIT09IGNvbXB1dGVkXG4gICAgICAgICAgICAgIDogaW5kZXhPZihzZWVuLCBjb21wdXRlZCkgPCAwXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICBpZiAoY2FsbGJhY2sgfHwgaXNMYXJnZSkge1xuICAgICAgICAgICAgc2Vlbi5wdXNoKGNvbXB1dGVkKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmVzdWx0LnB1c2godmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoaXNMYXJnZSkge1xuICAgICAgICByZWxlYXNlQXJyYXkoc2Vlbi5hcnJheSk7XG4gICAgICAgIHJlbGVhc2VPYmplY3Qoc2Vlbik7XG4gICAgICB9IGVsc2UgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgIHJlbGVhc2VBcnJheShzZWVuKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGZ1bmN0aW9uIHRoYXQgYWdncmVnYXRlcyBhIGNvbGxlY3Rpb24sIGNyZWF0aW5nIGFuIG9iamVjdCBjb21wb3NlZFxuICAgICAqIG9mIGtleXMgZ2VuZXJhdGVkIGZyb20gdGhlIHJlc3VsdHMgb2YgcnVubmluZyBlYWNoIGVsZW1lbnQgb2YgdGhlIGNvbGxlY3Rpb25cbiAgICAgKiB0aHJvdWdoIGEgY2FsbGJhY2suIFRoZSBnaXZlbiBgc2V0dGVyYCBmdW5jdGlvbiBzZXRzIHRoZSBrZXlzIGFuZCB2YWx1ZXNcbiAgICAgKiBvZiB0aGUgY29tcG9zZWQgb2JqZWN0LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBzZXR0ZXIgVGhlIHNldHRlciBmdW5jdGlvbi5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBhZ2dyZWdhdG9yIGZ1bmN0aW9uLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNyZWF0ZUFnZ3JlZ2F0b3Ioc2V0dGVyKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24oY29sbGVjdGlvbiwgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgICAgICBjYWxsYmFjayA9IGxvZGFzaC5jcmVhdGVDYWxsYmFjayhjYWxsYmFjaywgdGhpc0FyZywgMyk7XG5cbiAgICAgICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgICAgICBsZW5ndGggPSBjb2xsZWN0aW9uID8gY29sbGVjdGlvbi5sZW5ndGggOiAwO1xuXG4gICAgICAgIGlmICh0eXBlb2YgbGVuZ3RoID09ICdudW1iZXInKSB7XG4gICAgICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IGNvbGxlY3Rpb25baW5kZXhdO1xuICAgICAgICAgICAgc2V0dGVyKHJlc3VsdCwgdmFsdWUsIGNhbGxiYWNrKHZhbHVlLCBpbmRleCwgY29sbGVjdGlvbiksIGNvbGxlY3Rpb24pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBmb3JPd24oY29sbGVjdGlvbiwgZnVuY3Rpb24odmFsdWUsIGtleSwgY29sbGVjdGlvbikge1xuICAgICAgICAgICAgc2V0dGVyKHJlc3VsdCwgdmFsdWUsIGNhbGxiYWNrKHZhbHVlLCBrZXksIGNvbGxlY3Rpb24pLCBjb2xsZWN0aW9uKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCwgd2hlbiBjYWxsZWQsIGVpdGhlciBjdXJyaWVzIG9yIGludm9rZXMgYGZ1bmNgXG4gICAgICogd2l0aCBhbiBvcHRpb25hbCBgdGhpc2AgYmluZGluZyBhbmQgcGFydGlhbGx5IGFwcGxpZWQgYXJndW1lbnRzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufHN0cmluZ30gZnVuYyBUaGUgZnVuY3Rpb24gb3IgbWV0aG9kIG5hbWUgdG8gcmVmZXJlbmNlLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBiaXRtYXNrIFRoZSBiaXRtYXNrIG9mIG1ldGhvZCBmbGFncyB0byBjb21wb3NlLlxuICAgICAqICBUaGUgYml0bWFzayBtYXkgYmUgY29tcG9zZWQgb2YgdGhlIGZvbGxvd2luZyBmbGFnczpcbiAgICAgKiAgMSAtIGBfLmJpbmRgXG4gICAgICogIDIgLSBgXy5iaW5kS2V5YFxuICAgICAqICA0IC0gYF8uY3VycnlgXG4gICAgICogIDggLSBgXy5jdXJyeWAgKGJvdW5kKVxuICAgICAqICAxNiAtIGBfLnBhcnRpYWxgXG4gICAgICogIDMyIC0gYF8ucGFydGlhbFJpZ2h0YFxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFtwYXJ0aWFsQXJnc10gQW4gYXJyYXkgb2YgYXJndW1lbnRzIHRvIHByZXBlbmQgdG8gdGhvc2VcbiAgICAgKiAgcHJvdmlkZWQgdG8gdGhlIG5ldyBmdW5jdGlvbi5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBbcGFydGlhbFJpZ2h0QXJnc10gQW4gYXJyYXkgb2YgYXJndW1lbnRzIHRvIGFwcGVuZCB0byB0aG9zZVxuICAgICAqICBwcm92aWRlZCB0byB0aGUgbmV3IGZ1bmN0aW9uLlxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgZnVuY2AuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFthcml0eV0gVGhlIGFyaXR5IG9mIGBmdW5jYC5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBmdW5jdGlvbi5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjcmVhdGVXcmFwcGVyKGZ1bmMsIGJpdG1hc2ssIHBhcnRpYWxBcmdzLCBwYXJ0aWFsUmlnaHRBcmdzLCB0aGlzQXJnLCBhcml0eSkge1xuICAgICAgdmFyIGlzQmluZCA9IGJpdG1hc2sgJiAxLFxuICAgICAgICAgIGlzQmluZEtleSA9IGJpdG1hc2sgJiAyLFxuICAgICAgICAgIGlzQ3VycnkgPSBiaXRtYXNrICYgNCxcbiAgICAgICAgICBpc0N1cnJ5Qm91bmQgPSBiaXRtYXNrICYgOCxcbiAgICAgICAgICBpc1BhcnRpYWwgPSBiaXRtYXNrICYgMTYsXG4gICAgICAgICAgaXNQYXJ0aWFsUmlnaHQgPSBiaXRtYXNrICYgMzI7XG5cbiAgICAgIGlmICghaXNCaW5kS2V5ICYmICFpc0Z1bmN0aW9uKGZ1bmMpKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3I7XG4gICAgICB9XG4gICAgICBpZiAoaXNQYXJ0aWFsICYmICFwYXJ0aWFsQXJncy5sZW5ndGgpIHtcbiAgICAgICAgYml0bWFzayAmPSB+MTY7XG4gICAgICAgIGlzUGFydGlhbCA9IHBhcnRpYWxBcmdzID0gZmFsc2U7XG4gICAgICB9XG4gICAgICBpZiAoaXNQYXJ0aWFsUmlnaHQgJiYgIXBhcnRpYWxSaWdodEFyZ3MubGVuZ3RoKSB7XG4gICAgICAgIGJpdG1hc2sgJj0gfjMyO1xuICAgICAgICBpc1BhcnRpYWxSaWdodCA9IHBhcnRpYWxSaWdodEFyZ3MgPSBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHZhciBiaW5kRGF0YSA9IGZ1bmMgJiYgZnVuYy5fX2JpbmREYXRhX187XG4gICAgICBpZiAoYmluZERhdGEgJiYgYmluZERhdGEgIT09IHRydWUpIHtcbiAgICAgICAgLy8gY2xvbmUgYGJpbmREYXRhYFxuICAgICAgICBiaW5kRGF0YSA9IHNsaWNlKGJpbmREYXRhKTtcbiAgICAgICAgaWYgKGJpbmREYXRhWzJdKSB7XG4gICAgICAgICAgYmluZERhdGFbMl0gPSBzbGljZShiaW5kRGF0YVsyXSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGJpbmREYXRhWzNdKSB7XG4gICAgICAgICAgYmluZERhdGFbM10gPSBzbGljZShiaW5kRGF0YVszXSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gc2V0IGB0aGlzQmluZGluZ2AgaXMgbm90IHByZXZpb3VzbHkgYm91bmRcbiAgICAgICAgaWYgKGlzQmluZCAmJiAhKGJpbmREYXRhWzFdICYgMSkpIHtcbiAgICAgICAgICBiaW5kRGF0YVs0XSA9IHRoaXNBcmc7XG4gICAgICAgIH1cbiAgICAgICAgLy8gc2V0IGlmIHByZXZpb3VzbHkgYm91bmQgYnV0IG5vdCBjdXJyZW50bHkgKHN1YnNlcXVlbnQgY3VycmllZCBmdW5jdGlvbnMpXG4gICAgICAgIGlmICghaXNCaW5kICYmIGJpbmREYXRhWzFdICYgMSkge1xuICAgICAgICAgIGJpdG1hc2sgfD0gODtcbiAgICAgICAgfVxuICAgICAgICAvLyBzZXQgY3VycmllZCBhcml0eSBpZiBub3QgeWV0IHNldFxuICAgICAgICBpZiAoaXNDdXJyeSAmJiAhKGJpbmREYXRhWzFdICYgNCkpIHtcbiAgICAgICAgICBiaW5kRGF0YVs1XSA9IGFyaXR5O1xuICAgICAgICB9XG4gICAgICAgIC8vIGFwcGVuZCBwYXJ0aWFsIGxlZnQgYXJndW1lbnRzXG4gICAgICAgIGlmIChpc1BhcnRpYWwpIHtcbiAgICAgICAgICBwdXNoLmFwcGx5KGJpbmREYXRhWzJdIHx8IChiaW5kRGF0YVsyXSA9IFtdKSwgcGFydGlhbEFyZ3MpO1xuICAgICAgICB9XG4gICAgICAgIC8vIGFwcGVuZCBwYXJ0aWFsIHJpZ2h0IGFyZ3VtZW50c1xuICAgICAgICBpZiAoaXNQYXJ0aWFsUmlnaHQpIHtcbiAgICAgICAgICB1bnNoaWZ0LmFwcGx5KGJpbmREYXRhWzNdIHx8IChiaW5kRGF0YVszXSA9IFtdKSwgcGFydGlhbFJpZ2h0QXJncyk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gbWVyZ2UgZmxhZ3NcbiAgICAgICAgYmluZERhdGFbMV0gfD0gYml0bWFzaztcbiAgICAgICAgcmV0dXJuIGNyZWF0ZVdyYXBwZXIuYXBwbHkobnVsbCwgYmluZERhdGEpO1xuICAgICAgfVxuICAgICAgLy8gZmFzdCBwYXRoIGZvciBgXy5iaW5kYFxuICAgICAgdmFyIGNyZWF0ZXIgPSAoYml0bWFzayA9PSAxIHx8IGJpdG1hc2sgPT09IDE3KSA/IGJhc2VCaW5kIDogYmFzZUNyZWF0ZVdyYXBwZXI7XG4gICAgICByZXR1cm4gY3JlYXRlcihbZnVuYywgYml0bWFzaywgcGFydGlhbEFyZ3MsIHBhcnRpYWxSaWdodEFyZ3MsIHRoaXNBcmcsIGFyaXR5XSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXNlZCBieSBgZXNjYXBlYCB0byBjb252ZXJ0IGNoYXJhY3RlcnMgdG8gSFRNTCBlbnRpdGllcy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG1hdGNoIFRoZSBtYXRjaGVkIGNoYXJhY3RlciB0byBlc2NhcGUuXG4gICAgICogQHJldHVybnMge3N0cmluZ30gUmV0dXJucyB0aGUgZXNjYXBlZCBjaGFyYWN0ZXIuXG4gICAgICovXG4gICAgZnVuY3Rpb24gZXNjYXBlSHRtbENoYXIobWF0Y2gpIHtcbiAgICAgIHJldHVybiBodG1sRXNjYXBlc1ttYXRjaF07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgYXBwcm9wcmlhdGUgXCJpbmRleE9mXCIgZnVuY3Rpb24uIElmIHRoZSBgXy5pbmRleE9mYCBtZXRob2QgaXNcbiAgICAgKiBjdXN0b21pemVkLCB0aGlzIG1ldGhvZCByZXR1cm5zIHRoZSBjdXN0b20gbWV0aG9kLCBvdGhlcndpc2UgaXQgcmV0dXJuc1xuICAgICAqIHRoZSBgYmFzZUluZGV4T2ZgIGZ1bmN0aW9uLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIFwiaW5kZXhPZlwiIGZ1bmN0aW9uLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldEluZGV4T2YoKSB7XG4gICAgICB2YXIgcmVzdWx0ID0gKHJlc3VsdCA9IGxvZGFzaC5pbmRleE9mKSA9PT0gaW5kZXhPZiA/IGJhc2VJbmRleE9mIDogcmVzdWx0O1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBhIG5hdGl2ZSBmdW5jdGlvbi5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSBgdmFsdWVgIGlzIGEgbmF0aXZlIGZ1bmN0aW9uLCBlbHNlIGBmYWxzZWAuXG4gICAgICovXG4gICAgZnVuY3Rpb24gaXNOYXRpdmUodmFsdWUpIHtcbiAgICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT0gJ2Z1bmN0aW9uJyAmJiByZU5hdGl2ZS50ZXN0KHZhbHVlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIGB0aGlzYCBiaW5kaW5nIGRhdGEgb24gYSBnaXZlbiBmdW5jdGlvbi5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gc2V0IGRhdGEgb24uXG4gICAgICogQHBhcmFtIHtBcnJheX0gdmFsdWUgVGhlIGRhdGEgYXJyYXkgdG8gc2V0LlxuICAgICAqL1xuICAgIHZhciBzZXRCaW5kRGF0YSA9ICFkZWZpbmVQcm9wZXJ0eSA/IG5vb3AgOiBmdW5jdGlvbihmdW5jLCB2YWx1ZSkge1xuICAgICAgZGVzY3JpcHRvci52YWx1ZSA9IHZhbHVlO1xuICAgICAgZGVmaW5lUHJvcGVydHkoZnVuYywgJ19fYmluZERhdGFfXycsIGRlc2NyaXB0b3IpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBBIGZhbGxiYWNrIGltcGxlbWVudGF0aW9uIG9mIGBpc1BsYWluT2JqZWN0YCB3aGljaCBjaGVja3MgaWYgYSBnaXZlbiB2YWx1ZVxuICAgICAqIGlzIGFuIG9iamVjdCBjcmVhdGVkIGJ5IHRoZSBgT2JqZWN0YCBjb25zdHJ1Y3RvciwgYXNzdW1pbmcgb2JqZWN0cyBjcmVhdGVkXG4gICAgICogYnkgdGhlIGBPYmplY3RgIGNvbnN0cnVjdG9yIGhhdmUgbm8gaW5oZXJpdGVkIGVudW1lcmFibGUgcHJvcGVydGllcyBhbmQgdGhhdFxuICAgICAqIHRoZXJlIGFyZSBubyBgT2JqZWN0LnByb3RvdHlwZWAgZXh0ZW5zaW9ucy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYSBwbGFpbiBvYmplY3QsIGVsc2UgYGZhbHNlYC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzaGltSXNQbGFpbk9iamVjdCh2YWx1ZSkge1xuICAgICAgdmFyIGN0b3IsXG4gICAgICAgICAgcmVzdWx0O1xuXG4gICAgICAvLyBhdm9pZCBub24gT2JqZWN0IG9iamVjdHMsIGBhcmd1bWVudHNgIG9iamVjdHMsIGFuZCBET00gZWxlbWVudHNcbiAgICAgIGlmICghKHZhbHVlICYmIHRvU3RyaW5nLmNhbGwodmFsdWUpID09IG9iamVjdENsYXNzKSB8fFxuICAgICAgICAgIChjdG9yID0gdmFsdWUuY29uc3RydWN0b3IsIGlzRnVuY3Rpb24oY3RvcikgJiYgIShjdG9yIGluc3RhbmNlb2YgY3RvcikpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIC8vIEluIG1vc3QgZW52aXJvbm1lbnRzIGFuIG9iamVjdCdzIG93biBwcm9wZXJ0aWVzIGFyZSBpdGVyYXRlZCBiZWZvcmVcbiAgICAgIC8vIGl0cyBpbmhlcml0ZWQgcHJvcGVydGllcy4gSWYgdGhlIGxhc3QgaXRlcmF0ZWQgcHJvcGVydHkgaXMgYW4gb2JqZWN0J3NcbiAgICAgIC8vIG93biBwcm9wZXJ0eSB0aGVuIHRoZXJlIGFyZSBubyBpbmhlcml0ZWQgZW51bWVyYWJsZSBwcm9wZXJ0aWVzLlxuICAgICAgZm9ySW4odmFsdWUsIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcbiAgICAgICAgcmVzdWx0ID0ga2V5O1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gdHlwZW9mIHJlc3VsdCA9PSAndW5kZWZpbmVkJyB8fCBoYXNPd25Qcm9wZXJ0eS5jYWxsKHZhbHVlLCByZXN1bHQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVzZWQgYnkgYHVuZXNjYXBlYCB0byBjb252ZXJ0IEhUTUwgZW50aXRpZXMgdG8gY2hhcmFjdGVycy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG1hdGNoIFRoZSBtYXRjaGVkIGNoYXJhY3RlciB0byB1bmVzY2FwZS5cbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBSZXR1cm5zIHRoZSB1bmVzY2FwZWQgY2hhcmFjdGVyLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHVuZXNjYXBlSHRtbENoYXIobWF0Y2gpIHtcbiAgICAgIHJldHVybiBodG1sVW5lc2NhcGVzW21hdGNoXTtcbiAgICB9XG5cbiAgICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGFuIGBhcmd1bWVudHNgIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBPYmplY3RzXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSBgdmFsdWVgIGlzIGFuIGBhcmd1bWVudHNgIG9iamVjdCwgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAoZnVuY3Rpb24oKSB7IHJldHVybiBfLmlzQXJndW1lbnRzKGFyZ3VtZW50cyk7IH0pKDEsIDIsIDMpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uaXNBcmd1bWVudHMoWzEsIDIsIDNdKTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGlzQXJndW1lbnRzKHZhbHVlKSB7XG4gICAgICByZXR1cm4gdmFsdWUgJiYgdHlwZW9mIHZhbHVlID09ICdvYmplY3QnICYmIHR5cGVvZiB2YWx1ZS5sZW5ndGggPT0gJ251bWJlcicgJiZcbiAgICAgICAgdG9TdHJpbmcuY2FsbCh2YWx1ZSkgPT0gYXJnc0NsYXNzIHx8IGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGFuIGFycmF5LlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHR5cGUgRnVuY3Rpb25cbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0c1xuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgYHZhbHVlYCBpcyBhbiBhcnJheSwgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAoZnVuY3Rpb24oKSB7IHJldHVybiBfLmlzQXJyYXkoYXJndW1lbnRzKTsgfSkoKTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqXG4gICAgICogXy5pc0FycmF5KFsxLCAyLCAzXSk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqL1xuICAgIHZhciBpc0FycmF5ID0gbmF0aXZlSXNBcnJheSB8fCBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgcmV0dXJuIHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PSAnb2JqZWN0JyAmJiB0eXBlb2YgdmFsdWUubGVuZ3RoID09ICdudW1iZXInICYmXG4gICAgICAgIHRvU3RyaW5nLmNhbGwodmFsdWUpID09IGFycmF5Q2xhc3MgfHwgZmFsc2U7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEEgZmFsbGJhY2sgaW1wbGVtZW50YXRpb24gb2YgYE9iamVjdC5rZXlzYCB3aGljaCBwcm9kdWNlcyBhbiBhcnJheSBvZiB0aGVcbiAgICAgKiBnaXZlbiBvYmplY3QncyBvd24gZW51bWVyYWJsZSBwcm9wZXJ0eSBuYW1lcy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHR5cGUgRnVuY3Rpb25cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gaW5zcGVjdC5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgYW4gYXJyYXkgb2YgcHJvcGVydHkgbmFtZXMuXG4gICAgICovXG4gICAgdmFyIHNoaW1LZXlzID0gZnVuY3Rpb24ob2JqZWN0KSB7XG4gICAgICB2YXIgaW5kZXgsIGl0ZXJhYmxlID0gb2JqZWN0LCByZXN1bHQgPSBbXTtcbiAgICAgIGlmICghaXRlcmFibGUpIHJldHVybiByZXN1bHQ7XG4gICAgICBpZiAoIShvYmplY3RUeXBlc1t0eXBlb2Ygb2JqZWN0XSkpIHJldHVybiByZXN1bHQ7XG4gICAgICAgIGZvciAoaW5kZXggaW4gaXRlcmFibGUpIHtcbiAgICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChpdGVyYWJsZSwgaW5kZXgpKSB7XG4gICAgICAgICAgICByZXN1bHQucHVzaChpbmRleCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gYXJyYXkgY29tcG9zZWQgb2YgdGhlIG93biBlbnVtZXJhYmxlIHByb3BlcnR5IG5hbWVzIG9mIGFuIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBPYmplY3RzXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIGluc3BlY3QuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIGFuIGFycmF5IG9mIHByb3BlcnR5IG5hbWVzLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmtleXMoeyAnb25lJzogMSwgJ3R3byc6IDIsICd0aHJlZSc6IDMgfSk7XG4gICAgICogLy8gPT4gWydvbmUnLCAndHdvJywgJ3RocmVlJ10gKHByb3BlcnR5IG9yZGVyIGlzIG5vdCBndWFyYW50ZWVkIGFjcm9zcyBlbnZpcm9ubWVudHMpXG4gICAgICovXG4gICAgdmFyIGtleXMgPSAhbmF0aXZlS2V5cyA/IHNoaW1LZXlzIDogZnVuY3Rpb24ob2JqZWN0KSB7XG4gICAgICBpZiAoIWlzT2JqZWN0KG9iamVjdCkpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG5hdGl2ZUtleXMob2JqZWN0KTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogVXNlZCB0byBjb252ZXJ0IGNoYXJhY3RlcnMgdG8gSFRNTCBlbnRpdGllczpcbiAgICAgKlxuICAgICAqIFRob3VnaCB0aGUgYD5gIGNoYXJhY3RlciBpcyBlc2NhcGVkIGZvciBzeW1tZXRyeSwgY2hhcmFjdGVycyBsaWtlIGA+YCBhbmQgYC9gXG4gICAgICogZG9uJ3QgcmVxdWlyZSBlc2NhcGluZyBpbiBIVE1MIGFuZCBoYXZlIG5vIHNwZWNpYWwgbWVhbmluZyB1bmxlc3MgdGhleSdyZSBwYXJ0XG4gICAgICogb2YgYSB0YWcgb3IgYW4gdW5xdW90ZWQgYXR0cmlidXRlIHZhbHVlLlxuICAgICAqIGh0dHA6Ly9tYXRoaWFzYnluZW5zLmJlL25vdGVzL2FtYmlndW91cy1hbXBlcnNhbmRzICh1bmRlciBcInNlbWktcmVsYXRlZCBmdW4gZmFjdFwiKVxuICAgICAqL1xuICAgIHZhciBodG1sRXNjYXBlcyA9IHtcbiAgICAgICcmJzogJyZhbXA7JyxcbiAgICAgICc8JzogJyZsdDsnLFxuICAgICAgJz4nOiAnJmd0OycsXG4gICAgICAnXCInOiAnJnF1b3Q7JyxcbiAgICAgIFwiJ1wiOiAnJiMzOTsnXG4gICAgfTtcblxuICAgIC8qKiBVc2VkIHRvIGNvbnZlcnQgSFRNTCBlbnRpdGllcyB0byBjaGFyYWN0ZXJzICovXG4gICAgdmFyIGh0bWxVbmVzY2FwZXMgPSBpbnZlcnQoaHRtbEVzY2FwZXMpO1xuXG4gICAgLyoqIFVzZWQgdG8gbWF0Y2ggSFRNTCBlbnRpdGllcyBhbmQgSFRNTCBjaGFyYWN0ZXJzICovXG4gICAgdmFyIHJlRXNjYXBlZEh0bWwgPSBSZWdFeHAoJygnICsga2V5cyhodG1sVW5lc2NhcGVzKS5qb2luKCd8JykgKyAnKScsICdnJyksXG4gICAgICAgIHJlVW5lc2NhcGVkSHRtbCA9IFJlZ0V4cCgnWycgKyBrZXlzKGh0bWxFc2NhcGVzKS5qb2luKCcnKSArICddJywgJ2cnKTtcblxuICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gICAgLyoqXG4gICAgICogQXNzaWducyBvd24gZW51bWVyYWJsZSBwcm9wZXJ0aWVzIG9mIHNvdXJjZSBvYmplY3QocykgdG8gdGhlIGRlc3RpbmF0aW9uXG4gICAgICogb2JqZWN0LiBTdWJzZXF1ZW50IHNvdXJjZXMgd2lsbCBvdmVyd3JpdGUgcHJvcGVydHkgYXNzaWdubWVudHMgb2YgcHJldmlvdXNcbiAgICAgKiBzb3VyY2VzLiBJZiBhIGNhbGxiYWNrIGlzIHByb3ZpZGVkIGl0IHdpbGwgYmUgZXhlY3V0ZWQgdG8gcHJvZHVjZSB0aGVcbiAgICAgKiBhc3NpZ25lZCB2YWx1ZXMuIFRoZSBjYWxsYmFjayBpcyBib3VuZCB0byBgdGhpc0FyZ2AgYW5kIGludm9rZWQgd2l0aCB0d29cbiAgICAgKiBhcmd1bWVudHM7IChvYmplY3RWYWx1ZSwgc291cmNlVmFsdWUpLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHR5cGUgRnVuY3Rpb25cbiAgICAgKiBAYWxpYXMgZXh0ZW5kXG4gICAgICogQGNhdGVnb3J5IE9iamVjdHNcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBkZXN0aW5hdGlvbiBvYmplY3QuXG4gICAgICogQHBhcmFtIHsuLi5PYmplY3R9IFtzb3VyY2VdIFRoZSBzb3VyY2Ugb2JqZWN0cy5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY2FsbGJhY2tdIFRoZSBmdW5jdGlvbiB0byBjdXN0b21pemUgYXNzaWduaW5nIHZhbHVlcy5cbiAgICAgKiBAcGFyYW0geyp9IFt0aGlzQXJnXSBUaGUgYHRoaXNgIGJpbmRpbmcgb2YgYGNhbGxiYWNrYC5cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBkZXN0aW5hdGlvbiBvYmplY3QuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uYXNzaWduKHsgJ25hbWUnOiAnZnJlZCcgfSwgeyAnZW1wbG95ZXInOiAnc2xhdGUnIH0pO1xuICAgICAqIC8vID0+IHsgJ25hbWUnOiAnZnJlZCcsICdlbXBsb3llcic6ICdzbGF0ZScgfVxuICAgICAqXG4gICAgICogdmFyIGRlZmF1bHRzID0gXy5wYXJ0aWFsUmlnaHQoXy5hc3NpZ24sIGZ1bmN0aW9uKGEsIGIpIHtcbiAgICAgKiAgIHJldHVybiB0eXBlb2YgYSA9PSAndW5kZWZpbmVkJyA/IGIgOiBhO1xuICAgICAqIH0pO1xuICAgICAqXG4gICAgICogdmFyIG9iamVjdCA9IHsgJ25hbWUnOiAnYmFybmV5JyB9O1xuICAgICAqIGRlZmF1bHRzKG9iamVjdCwgeyAnbmFtZSc6ICdmcmVkJywgJ2VtcGxveWVyJzogJ3NsYXRlJyB9KTtcbiAgICAgKiAvLyA9PiB7ICduYW1lJzogJ2Jhcm5leScsICdlbXBsb3llcic6ICdzbGF0ZScgfVxuICAgICAqL1xuICAgIHZhciBhc3NpZ24gPSBmdW5jdGlvbihvYmplY3QsIHNvdXJjZSwgZ3VhcmQpIHtcbiAgICAgIHZhciBpbmRleCwgaXRlcmFibGUgPSBvYmplY3QsIHJlc3VsdCA9IGl0ZXJhYmxlO1xuICAgICAgaWYgKCFpdGVyYWJsZSkgcmV0dXJuIHJlc3VsdDtcbiAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzLFxuICAgICAgICAgIGFyZ3NJbmRleCA9IDAsXG4gICAgICAgICAgYXJnc0xlbmd0aCA9IHR5cGVvZiBndWFyZCA9PSAnbnVtYmVyJyA/IDIgOiBhcmdzLmxlbmd0aDtcbiAgICAgIGlmIChhcmdzTGVuZ3RoID4gMyAmJiB0eXBlb2YgYXJnc1thcmdzTGVuZ3RoIC0gMl0gPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB2YXIgY2FsbGJhY2sgPSBiYXNlQ3JlYXRlQ2FsbGJhY2soYXJnc1stLWFyZ3NMZW5ndGggLSAxXSwgYXJnc1thcmdzTGVuZ3RoLS1dLCAyKTtcbiAgICAgIH0gZWxzZSBpZiAoYXJnc0xlbmd0aCA+IDIgJiYgdHlwZW9mIGFyZ3NbYXJnc0xlbmd0aCAtIDFdID09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgY2FsbGJhY2sgPSBhcmdzWy0tYXJnc0xlbmd0aF07XG4gICAgICB9XG4gICAgICB3aGlsZSAoKythcmdzSW5kZXggPCBhcmdzTGVuZ3RoKSB7XG4gICAgICAgIGl0ZXJhYmxlID0gYXJnc1thcmdzSW5kZXhdO1xuICAgICAgICBpZiAoaXRlcmFibGUgJiYgb2JqZWN0VHlwZXNbdHlwZW9mIGl0ZXJhYmxlXSkge1xuICAgICAgICB2YXIgb3duSW5kZXggPSAtMSxcbiAgICAgICAgICAgIG93blByb3BzID0gb2JqZWN0VHlwZXNbdHlwZW9mIGl0ZXJhYmxlXSAmJiBrZXlzKGl0ZXJhYmxlKSxcbiAgICAgICAgICAgIGxlbmd0aCA9IG93blByb3BzID8gb3duUHJvcHMubGVuZ3RoIDogMDtcblxuICAgICAgICB3aGlsZSAoKytvd25JbmRleCA8IGxlbmd0aCkge1xuICAgICAgICAgIGluZGV4ID0gb3duUHJvcHNbb3duSW5kZXhdO1xuICAgICAgICAgIHJlc3VsdFtpbmRleF0gPSBjYWxsYmFjayA/IGNhbGxiYWNrKHJlc3VsdFtpbmRleF0sIGl0ZXJhYmxlW2luZGV4XSkgOiBpdGVyYWJsZVtpbmRleF07XG4gICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdFxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgY2xvbmUgb2YgYHZhbHVlYC4gSWYgYGlzRGVlcGAgaXMgYHRydWVgIG5lc3RlZCBvYmplY3RzIHdpbGwgYWxzb1xuICAgICAqIGJlIGNsb25lZCwgb3RoZXJ3aXNlIHRoZXkgd2lsbCBiZSBhc3NpZ25lZCBieSByZWZlcmVuY2UuIElmIGEgY2FsbGJhY2tcbiAgICAgKiBpcyBwcm92aWRlZCBpdCB3aWxsIGJlIGV4ZWN1dGVkIHRvIHByb2R1Y2UgdGhlIGNsb25lZCB2YWx1ZXMuIElmIHRoZVxuICAgICAqIGNhbGxiYWNrIHJldHVybnMgYHVuZGVmaW5lZGAgY2xvbmluZyB3aWxsIGJlIGhhbmRsZWQgYnkgdGhlIG1ldGhvZCBpbnN0ZWFkLlxuICAgICAqIFRoZSBjYWxsYmFjayBpcyBib3VuZCB0byBgdGhpc0FyZ2AgYW5kIGludm9rZWQgd2l0aCBvbmUgYXJndW1lbnQ7ICh2YWx1ZSkuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0c1xuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNsb25lLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2lzRGVlcD1mYWxzZV0gU3BlY2lmeSBhIGRlZXAgY2xvbmUuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2NhbGxiYWNrXSBUaGUgZnVuY3Rpb24gdG8gY3VzdG9taXplIGNsb25pbmcgdmFsdWVzLlxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgY2FsbGJhY2tgLlxuICAgICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSBjbG9uZWQgdmFsdWUuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBjaGFyYWN0ZXJzID0gW1xuICAgICAqICAgeyAnbmFtZSc6ICdiYXJuZXknLCAnYWdlJzogMzYgfSxcbiAgICAgKiAgIHsgJ25hbWUnOiAnZnJlZCcsICAgJ2FnZSc6IDQwIH1cbiAgICAgKiBdO1xuICAgICAqXG4gICAgICogdmFyIHNoYWxsb3cgPSBfLmNsb25lKGNoYXJhY3RlcnMpO1xuICAgICAqIHNoYWxsb3dbMF0gPT09IGNoYXJhY3RlcnNbMF07XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogdmFyIGRlZXAgPSBfLmNsb25lKGNoYXJhY3RlcnMsIHRydWUpO1xuICAgICAqIGRlZXBbMF0gPT09IGNoYXJhY3RlcnNbMF07XG4gICAgICogLy8gPT4gZmFsc2VcbiAgICAgKlxuICAgICAqIF8ubWl4aW4oe1xuICAgICAqICAgJ2Nsb25lJzogXy5wYXJ0aWFsUmlnaHQoXy5jbG9uZSwgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgKiAgICAgcmV0dXJuIF8uaXNFbGVtZW50KHZhbHVlKSA/IHZhbHVlLmNsb25lTm9kZShmYWxzZSkgOiB1bmRlZmluZWQ7XG4gICAgICogICB9KVxuICAgICAqIH0pO1xuICAgICAqXG4gICAgICogdmFyIGNsb25lID0gXy5jbG9uZShkb2N1bWVudC5ib2R5KTtcbiAgICAgKiBjbG9uZS5jaGlsZE5vZGVzLmxlbmd0aDtcbiAgICAgKiAvLyA9PiAwXG4gICAgICovXG4gICAgZnVuY3Rpb24gY2xvbmUodmFsdWUsIGlzRGVlcCwgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgIC8vIGFsbG93cyB3b3JraW5nIHdpdGggXCJDb2xsZWN0aW9uc1wiIG1ldGhvZHMgd2l0aG91dCB1c2luZyB0aGVpciBgaW5kZXhgXG4gICAgICAvLyBhbmQgYGNvbGxlY3Rpb25gIGFyZ3VtZW50cyBmb3IgYGlzRGVlcGAgYW5kIGBjYWxsYmFja2BcbiAgICAgIGlmICh0eXBlb2YgaXNEZWVwICE9ICdib29sZWFuJyAmJiBpc0RlZXAgIT0gbnVsbCkge1xuICAgICAgICB0aGlzQXJnID0gY2FsbGJhY2s7XG4gICAgICAgIGNhbGxiYWNrID0gaXNEZWVwO1xuICAgICAgICBpc0RlZXAgPSBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBiYXNlQ2xvbmUodmFsdWUsIGlzRGVlcCwgdHlwZW9mIGNhbGxiYWNrID09ICdmdW5jdGlvbicgJiYgYmFzZUNyZWF0ZUNhbGxiYWNrKGNhbGxiYWNrLCB0aGlzQXJnLCAxKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGRlZXAgY2xvbmUgb2YgYHZhbHVlYC4gSWYgYSBjYWxsYmFjayBpcyBwcm92aWRlZCBpdCB3aWxsIGJlXG4gICAgICogZXhlY3V0ZWQgdG8gcHJvZHVjZSB0aGUgY2xvbmVkIHZhbHVlcy4gSWYgdGhlIGNhbGxiYWNrIHJldHVybnMgYHVuZGVmaW5lZGBcbiAgICAgKiBjbG9uaW5nIHdpbGwgYmUgaGFuZGxlZCBieSB0aGUgbWV0aG9kIGluc3RlYWQuIFRoZSBjYWxsYmFjayBpcyBib3VuZCB0b1xuICAgICAqIGB0aGlzQXJnYCBhbmQgaW52b2tlZCB3aXRoIG9uZSBhcmd1bWVudDsgKHZhbHVlKS5cbiAgICAgKlxuICAgICAqIE5vdGU6IFRoaXMgbWV0aG9kIGlzIGxvb3NlbHkgYmFzZWQgb24gdGhlIHN0cnVjdHVyZWQgY2xvbmUgYWxnb3JpdGhtLiBGdW5jdGlvbnNcbiAgICAgKiBhbmQgRE9NIG5vZGVzIGFyZSAqKm5vdCoqIGNsb25lZC4gVGhlIGVudW1lcmFibGUgcHJvcGVydGllcyBvZiBgYXJndW1lbnRzYCBvYmplY3RzIGFuZFxuICAgICAqIG9iamVjdHMgY3JlYXRlZCBieSBjb25zdHJ1Y3RvcnMgb3RoZXIgdGhhbiBgT2JqZWN0YCBhcmUgY2xvbmVkIHRvIHBsYWluIGBPYmplY3RgIG9iamVjdHMuXG4gICAgICogU2VlIGh0dHA6Ly93d3cudzMub3JnL1RSL2h0bWw1L2luZnJhc3RydWN0dXJlLmh0bWwjaW50ZXJuYWwtc3RydWN0dXJlZC1jbG9uaW5nLWFsZ29yaXRobS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBPYmplY3RzXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gZGVlcCBjbG9uZS5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY2FsbGJhY2tdIFRoZSBmdW5jdGlvbiB0byBjdXN0b21pemUgY2xvbmluZyB2YWx1ZXMuXG4gICAgICogQHBhcmFtIHsqfSBbdGhpc0FyZ10gVGhlIGB0aGlzYCBiaW5kaW5nIG9mIGBjYWxsYmFja2AuXG4gICAgICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIGRlZXAgY2xvbmVkIHZhbHVlLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgY2hhcmFjdGVycyA9IFtcbiAgICAgKiAgIHsgJ25hbWUnOiAnYmFybmV5JywgJ2FnZSc6IDM2IH0sXG4gICAgICogICB7ICduYW1lJzogJ2ZyZWQnLCAgICdhZ2UnOiA0MCB9XG4gICAgICogXTtcbiAgICAgKlxuICAgICAqIHZhciBkZWVwID0gXy5jbG9uZURlZXAoY2hhcmFjdGVycyk7XG4gICAgICogZGVlcFswXSA9PT0gY2hhcmFjdGVyc1swXTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqXG4gICAgICogdmFyIHZpZXcgPSB7XG4gICAgICogICAnbGFiZWwnOiAnZG9jcycsXG4gICAgICogICAnbm9kZSc6IGVsZW1lbnRcbiAgICAgKiB9O1xuICAgICAqXG4gICAgICogdmFyIGNsb25lID0gXy5jbG9uZURlZXAodmlldywgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgKiAgIHJldHVybiBfLmlzRWxlbWVudCh2YWx1ZSkgPyB2YWx1ZS5jbG9uZU5vZGUodHJ1ZSkgOiB1bmRlZmluZWQ7XG4gICAgICogfSk7XG4gICAgICpcbiAgICAgKiBjbG9uZS5ub2RlID09IHZpZXcubm9kZTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNsb25lRGVlcCh2YWx1ZSwgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgIHJldHVybiBiYXNlQ2xvbmUodmFsdWUsIHRydWUsIHR5cGVvZiBjYWxsYmFjayA9PSAnZnVuY3Rpb24nICYmIGJhc2VDcmVhdGVDYWxsYmFjayhjYWxsYmFjaywgdGhpc0FyZywgMSkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gb2JqZWN0IHRoYXQgaW5oZXJpdHMgZnJvbSB0aGUgZ2l2ZW4gYHByb3RvdHlwZWAgb2JqZWN0LiBJZiBhXG4gICAgICogYHByb3BlcnRpZXNgIG9iamVjdCBpcyBwcm92aWRlZCBpdHMgb3duIGVudW1lcmFibGUgcHJvcGVydGllcyBhcmUgYXNzaWduZWRcbiAgICAgKiB0byB0aGUgY3JlYXRlZCBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0c1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBwcm90b3R5cGUgVGhlIG9iamVjdCB0byBpbmhlcml0IGZyb20uXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtwcm9wZXJ0aWVzXSBUaGUgcHJvcGVydGllcyB0byBhc3NpZ24gdG8gdGhlIG9iamVjdC5cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBuZXcgb2JqZWN0LlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBmdW5jdGlvbiBTaGFwZSgpIHtcbiAgICAgKiAgIHRoaXMueCA9IDA7XG4gICAgICogICB0aGlzLnkgPSAwO1xuICAgICAqIH1cbiAgICAgKlxuICAgICAqIGZ1bmN0aW9uIENpcmNsZSgpIHtcbiAgICAgKiAgIFNoYXBlLmNhbGwodGhpcyk7XG4gICAgICogfVxuICAgICAqXG4gICAgICogQ2lyY2xlLnByb3RvdHlwZSA9IF8uY3JlYXRlKFNoYXBlLnByb3RvdHlwZSwgeyAnY29uc3RydWN0b3InOiBDaXJjbGUgfSk7XG4gICAgICpcbiAgICAgKiB2YXIgY2lyY2xlID0gbmV3IENpcmNsZTtcbiAgICAgKiBjaXJjbGUgaW5zdGFuY2VvZiBDaXJjbGU7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogY2lyY2xlIGluc3RhbmNlb2YgU2hhcGU7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNyZWF0ZShwcm90b3R5cGUsIHByb3BlcnRpZXMpIHtcbiAgICAgIHZhciByZXN1bHQgPSBiYXNlQ3JlYXRlKHByb3RvdHlwZSk7XG4gICAgICByZXR1cm4gcHJvcGVydGllcyA/IGFzc2lnbihyZXN1bHQsIHByb3BlcnRpZXMpIDogcmVzdWx0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFzc2lnbnMgb3duIGVudW1lcmFibGUgcHJvcGVydGllcyBvZiBzb3VyY2Ugb2JqZWN0KHMpIHRvIHRoZSBkZXN0aW5hdGlvblxuICAgICAqIG9iamVjdCBmb3IgYWxsIGRlc3RpbmF0aW9uIHByb3BlcnRpZXMgdGhhdCByZXNvbHZlIHRvIGB1bmRlZmluZWRgLiBPbmNlIGFcbiAgICAgKiBwcm9wZXJ0eSBpcyBzZXQsIGFkZGl0aW9uYWwgZGVmYXVsdHMgb2YgdGhlIHNhbWUgcHJvcGVydHkgd2lsbCBiZSBpZ25vcmVkLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHR5cGUgRnVuY3Rpb25cbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0c1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIGRlc3RpbmF0aW9uIG9iamVjdC5cbiAgICAgKiBAcGFyYW0gey4uLk9iamVjdH0gW3NvdXJjZV0gVGhlIHNvdXJjZSBvYmplY3RzLlxuICAgICAqIEBwYXJhbS0ge09iamVjdH0gW2d1YXJkXSBBbGxvd3Mgd29ya2luZyB3aXRoIGBfLnJlZHVjZWAgd2l0aG91dCB1c2luZyBpdHNcbiAgICAgKiAgYGtleWAgYW5kIGBvYmplY3RgIGFyZ3VtZW50cyBhcyBzb3VyY2VzLlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIGRlc3RpbmF0aW9uIG9iamVjdC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIG9iamVjdCA9IHsgJ25hbWUnOiAnYmFybmV5JyB9O1xuICAgICAqIF8uZGVmYXVsdHMob2JqZWN0LCB7ICduYW1lJzogJ2ZyZWQnLCAnZW1wbG95ZXInOiAnc2xhdGUnIH0pO1xuICAgICAqIC8vID0+IHsgJ25hbWUnOiAnYmFybmV5JywgJ2VtcGxveWVyJzogJ3NsYXRlJyB9XG4gICAgICovXG4gICAgdmFyIGRlZmF1bHRzID0gZnVuY3Rpb24ob2JqZWN0LCBzb3VyY2UsIGd1YXJkKSB7XG4gICAgICB2YXIgaW5kZXgsIGl0ZXJhYmxlID0gb2JqZWN0LCByZXN1bHQgPSBpdGVyYWJsZTtcbiAgICAgIGlmICghaXRlcmFibGUpIHJldHVybiByZXN1bHQ7XG4gICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cyxcbiAgICAgICAgICBhcmdzSW5kZXggPSAwLFxuICAgICAgICAgIGFyZ3NMZW5ndGggPSB0eXBlb2YgZ3VhcmQgPT0gJ251bWJlcicgPyAyIDogYXJncy5sZW5ndGg7XG4gICAgICB3aGlsZSAoKythcmdzSW5kZXggPCBhcmdzTGVuZ3RoKSB7XG4gICAgICAgIGl0ZXJhYmxlID0gYXJnc1thcmdzSW5kZXhdO1xuICAgICAgICBpZiAoaXRlcmFibGUgJiYgb2JqZWN0VHlwZXNbdHlwZW9mIGl0ZXJhYmxlXSkge1xuICAgICAgICB2YXIgb3duSW5kZXggPSAtMSxcbiAgICAgICAgICAgIG93blByb3BzID0gb2JqZWN0VHlwZXNbdHlwZW9mIGl0ZXJhYmxlXSAmJiBrZXlzKGl0ZXJhYmxlKSxcbiAgICAgICAgICAgIGxlbmd0aCA9IG93blByb3BzID8gb3duUHJvcHMubGVuZ3RoIDogMDtcblxuICAgICAgICB3aGlsZSAoKytvd25JbmRleCA8IGxlbmd0aCkge1xuICAgICAgICAgIGluZGV4ID0gb3duUHJvcHNbb3duSW5kZXhdO1xuICAgICAgICAgIGlmICh0eXBlb2YgcmVzdWx0W2luZGV4XSA9PSAndW5kZWZpbmVkJykgcmVzdWx0W2luZGV4XSA9IGl0ZXJhYmxlW2luZGV4XTtcbiAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGxpa2UgYF8uZmluZEluZGV4YCBleGNlcHQgdGhhdCBpdCByZXR1cm5zIHRoZSBrZXkgb2YgdGhlXG4gICAgICogZmlyc3QgZWxlbWVudCB0aGF0IHBhc3NlcyB0aGUgY2FsbGJhY2sgY2hlY2ssIGluc3RlYWQgb2YgdGhlIGVsZW1lbnQgaXRzZWxmLlxuICAgICAqXG4gICAgICogSWYgYSBwcm9wZXJ0eSBuYW1lIGlzIHByb3ZpZGVkIGZvciBgY2FsbGJhY2tgIHRoZSBjcmVhdGVkIFwiXy5wbHVja1wiIHN0eWxlXG4gICAgICogY2FsbGJhY2sgd2lsbCByZXR1cm4gdGhlIHByb3BlcnR5IHZhbHVlIG9mIHRoZSBnaXZlbiBlbGVtZW50LlxuICAgICAqXG4gICAgICogSWYgYW4gb2JqZWN0IGlzIHByb3ZpZGVkIGZvciBgY2FsbGJhY2tgIHRoZSBjcmVhdGVkIFwiXy53aGVyZVwiIHN0eWxlIGNhbGxiYWNrXG4gICAgICogd2lsbCByZXR1cm4gYHRydWVgIGZvciBlbGVtZW50cyB0aGF0IGhhdmUgdGhlIHByb3BlcnRpZXMgb2YgdGhlIGdpdmVuIG9iamVjdCxcbiAgICAgKiBlbHNlIGBmYWxzZWAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0c1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBzZWFyY2guXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbnxPYmplY3R8c3RyaW5nfSBbY2FsbGJhY2s9aWRlbnRpdHldIFRoZSBmdW5jdGlvbiBjYWxsZWQgcGVyXG4gICAgICogIGl0ZXJhdGlvbi4gSWYgYSBwcm9wZXJ0eSBuYW1lIG9yIG9iamVjdCBpcyBwcm92aWRlZCBpdCB3aWxsIGJlIHVzZWQgdG9cbiAgICAgKiAgY3JlYXRlIGEgXCJfLnBsdWNrXCIgb3IgXCJfLndoZXJlXCIgc3R5bGUgY2FsbGJhY2ssIHJlc3BlY3RpdmVseS5cbiAgICAgKiBAcGFyYW0geyp9IFt0aGlzQXJnXSBUaGUgYHRoaXNgIGJpbmRpbmcgb2YgYGNhbGxiYWNrYC5cbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfHVuZGVmaW5lZH0gUmV0dXJucyB0aGUga2V5IG9mIHRoZSBmb3VuZCBlbGVtZW50LCBlbHNlIGB1bmRlZmluZWRgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgY2hhcmFjdGVycyA9IHtcbiAgICAgKiAgICdiYXJuZXknOiB7ICAnYWdlJzogMzYsICdibG9ja2VkJzogZmFsc2UgfSxcbiAgICAgKiAgICdmcmVkJzogeyAgICAnYWdlJzogNDAsICdibG9ja2VkJzogdHJ1ZSB9LFxuICAgICAqICAgJ3BlYmJsZXMnOiB7ICdhZ2UnOiAxLCAgJ2Jsb2NrZWQnOiBmYWxzZSB9XG4gICAgICogfTtcbiAgICAgKlxuICAgICAqIF8uZmluZEtleShjaGFyYWN0ZXJzLCBmdW5jdGlvbihjaHIpIHtcbiAgICAgKiAgIHJldHVybiBjaHIuYWdlIDwgNDA7XG4gICAgICogfSk7XG4gICAgICogLy8gPT4gJ2Jhcm5leScgKHByb3BlcnR5IG9yZGVyIGlzIG5vdCBndWFyYW50ZWVkIGFjcm9zcyBlbnZpcm9ubWVudHMpXG4gICAgICpcbiAgICAgKiAvLyB1c2luZyBcIl8ud2hlcmVcIiBjYWxsYmFjayBzaG9ydGhhbmRcbiAgICAgKiBfLmZpbmRLZXkoY2hhcmFjdGVycywgeyAnYWdlJzogMSB9KTtcbiAgICAgKiAvLyA9PiAncGViYmxlcydcbiAgICAgKlxuICAgICAqIC8vIHVzaW5nIFwiXy5wbHVja1wiIGNhbGxiYWNrIHNob3J0aGFuZFxuICAgICAqIF8uZmluZEtleShjaGFyYWN0ZXJzLCAnYmxvY2tlZCcpO1xuICAgICAqIC8vID0+ICdmcmVkJ1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGZpbmRLZXkob2JqZWN0LCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgdmFyIHJlc3VsdDtcbiAgICAgIGNhbGxiYWNrID0gbG9kYXNoLmNyZWF0ZUNhbGxiYWNrKGNhbGxiYWNrLCB0aGlzQXJnLCAzKTtcbiAgICAgIGZvck93bihvYmplY3QsIGZ1bmN0aW9uKHZhbHVlLCBrZXksIG9iamVjdCkge1xuICAgICAgICBpZiAoY2FsbGJhY2sodmFsdWUsIGtleSwgb2JqZWN0KSkge1xuICAgICAgICAgIHJlc3VsdCA9IGtleTtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBsaWtlIGBfLmZpbmRLZXlgIGV4Y2VwdCB0aGF0IGl0IGl0ZXJhdGVzIG92ZXIgZWxlbWVudHNcbiAgICAgKiBvZiBhIGBjb2xsZWN0aW9uYCBpbiB0aGUgb3Bwb3NpdGUgb3JkZXIuXG4gICAgICpcbiAgICAgKiBJZiBhIHByb3BlcnR5IG5hbWUgaXMgcHJvdmlkZWQgZm9yIGBjYWxsYmFja2AgdGhlIGNyZWF0ZWQgXCJfLnBsdWNrXCIgc3R5bGVcbiAgICAgKiBjYWxsYmFjayB3aWxsIHJldHVybiB0aGUgcHJvcGVydHkgdmFsdWUgb2YgdGhlIGdpdmVuIGVsZW1lbnQuXG4gICAgICpcbiAgICAgKiBJZiBhbiBvYmplY3QgaXMgcHJvdmlkZWQgZm9yIGBjYWxsYmFja2AgdGhlIGNyZWF0ZWQgXCJfLndoZXJlXCIgc3R5bGUgY2FsbGJhY2tcbiAgICAgKiB3aWxsIHJldHVybiBgdHJ1ZWAgZm9yIGVsZW1lbnRzIHRoYXQgaGF2ZSB0aGUgcHJvcGVydGllcyBvZiB0aGUgZ2l2ZW4gb2JqZWN0LFxuICAgICAqIGVsc2UgYGZhbHNlYC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBPYmplY3RzXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIHNlYXJjaC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufE9iamVjdHxzdHJpbmd9IFtjYWxsYmFjaz1pZGVudGl0eV0gVGhlIGZ1bmN0aW9uIGNhbGxlZCBwZXJcbiAgICAgKiAgaXRlcmF0aW9uLiBJZiBhIHByb3BlcnR5IG5hbWUgb3Igb2JqZWN0IGlzIHByb3ZpZGVkIGl0IHdpbGwgYmUgdXNlZCB0b1xuICAgICAqICBjcmVhdGUgYSBcIl8ucGx1Y2tcIiBvciBcIl8ud2hlcmVcIiBzdHlsZSBjYWxsYmFjaywgcmVzcGVjdGl2ZWx5LlxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgY2FsbGJhY2tgLlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd8dW5kZWZpbmVkfSBSZXR1cm5zIHRoZSBrZXkgb2YgdGhlIGZvdW5kIGVsZW1lbnQsIGVsc2UgYHVuZGVmaW5lZGAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBjaGFyYWN0ZXJzID0ge1xuICAgICAqICAgJ2Jhcm5leSc6IHsgICdhZ2UnOiAzNiwgJ2Jsb2NrZWQnOiB0cnVlIH0sXG4gICAgICogICAnZnJlZCc6IHsgICAgJ2FnZSc6IDQwLCAnYmxvY2tlZCc6IGZhbHNlIH0sXG4gICAgICogICAncGViYmxlcyc6IHsgJ2FnZSc6IDEsICAnYmxvY2tlZCc6IHRydWUgfVxuICAgICAqIH07XG4gICAgICpcbiAgICAgKiBfLmZpbmRMYXN0S2V5KGNoYXJhY3RlcnMsIGZ1bmN0aW9uKGNocikge1xuICAgICAqICAgcmV0dXJuIGNoci5hZ2UgPCA0MDtcbiAgICAgKiB9KTtcbiAgICAgKiAvLyA9PiByZXR1cm5zIGBwZWJibGVzYCwgYXNzdW1pbmcgYF8uZmluZEtleWAgcmV0dXJucyBgYmFybmV5YFxuICAgICAqXG4gICAgICogLy8gdXNpbmcgXCJfLndoZXJlXCIgY2FsbGJhY2sgc2hvcnRoYW5kXG4gICAgICogXy5maW5kTGFzdEtleShjaGFyYWN0ZXJzLCB7ICdhZ2UnOiA0MCB9KTtcbiAgICAgKiAvLyA9PiAnZnJlZCdcbiAgICAgKlxuICAgICAqIC8vIHVzaW5nIFwiXy5wbHVja1wiIGNhbGxiYWNrIHNob3J0aGFuZFxuICAgICAqIF8uZmluZExhc3RLZXkoY2hhcmFjdGVycywgJ2Jsb2NrZWQnKTtcbiAgICAgKiAvLyA9PiAncGViYmxlcydcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBmaW5kTGFzdEtleShvYmplY3QsIGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgICB2YXIgcmVzdWx0O1xuICAgICAgY2FsbGJhY2sgPSBsb2Rhc2guY3JlYXRlQ2FsbGJhY2soY2FsbGJhY2ssIHRoaXNBcmcsIDMpO1xuICAgICAgZm9yT3duUmlnaHQob2JqZWN0LCBmdW5jdGlvbih2YWx1ZSwga2V5LCBvYmplY3QpIHtcbiAgICAgICAgaWYgKGNhbGxiYWNrKHZhbHVlLCBrZXksIG9iamVjdCkpIHtcbiAgICAgICAgICByZXN1bHQgPSBrZXk7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSXRlcmF0ZXMgb3ZlciBvd24gYW5kIGluaGVyaXRlZCBlbnVtZXJhYmxlIHByb3BlcnRpZXMgb2YgYW4gb2JqZWN0LFxuICAgICAqIGV4ZWN1dGluZyB0aGUgY2FsbGJhY2sgZm9yIGVhY2ggcHJvcGVydHkuIFRoZSBjYWxsYmFjayBpcyBib3VuZCB0byBgdGhpc0FyZ2BcbiAgICAgKiBhbmQgaW52b2tlZCB3aXRoIHRocmVlIGFyZ3VtZW50czsgKHZhbHVlLCBrZXksIG9iamVjdCkuIENhbGxiYWNrcyBtYXkgZXhpdFxuICAgICAqIGl0ZXJhdGlvbiBlYXJseSBieSBleHBsaWNpdGx5IHJldHVybmluZyBgZmFsc2VgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHR5cGUgRnVuY3Rpb25cbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0c1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBpdGVyYXRlIG92ZXIuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2NhbGxiYWNrPWlkZW50aXR5XSBUaGUgZnVuY3Rpb24gY2FsbGVkIHBlciBpdGVyYXRpb24uXG4gICAgICogQHBhcmFtIHsqfSBbdGhpc0FyZ10gVGhlIGB0aGlzYCBiaW5kaW5nIG9mIGBjYWxsYmFja2AuXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyBgb2JqZWN0YC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogZnVuY3Rpb24gU2hhcGUoKSB7XG4gICAgICogICB0aGlzLnggPSAwO1xuICAgICAqICAgdGhpcy55ID0gMDtcbiAgICAgKiB9XG4gICAgICpcbiAgICAgKiBTaGFwZS5wcm90b3R5cGUubW92ZSA9IGZ1bmN0aW9uKHgsIHkpIHtcbiAgICAgKiAgIHRoaXMueCArPSB4O1xuICAgICAqICAgdGhpcy55ICs9IHk7XG4gICAgICogfTtcbiAgICAgKlxuICAgICAqIF8uZm9ySW4obmV3IFNoYXBlLCBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG4gICAgICogICBjb25zb2xlLmxvZyhrZXkpO1xuICAgICAqIH0pO1xuICAgICAqIC8vID0+IGxvZ3MgJ3gnLCAneScsIGFuZCAnbW92ZScgKHByb3BlcnR5IG9yZGVyIGlzIG5vdCBndWFyYW50ZWVkIGFjcm9zcyBlbnZpcm9ubWVudHMpXG4gICAgICovXG4gICAgdmFyIGZvckluID0gZnVuY3Rpb24oY29sbGVjdGlvbiwgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgIHZhciBpbmRleCwgaXRlcmFibGUgPSBjb2xsZWN0aW9uLCByZXN1bHQgPSBpdGVyYWJsZTtcbiAgICAgIGlmICghaXRlcmFibGUpIHJldHVybiByZXN1bHQ7XG4gICAgICBpZiAoIW9iamVjdFR5cGVzW3R5cGVvZiBpdGVyYWJsZV0pIHJldHVybiByZXN1bHQ7XG4gICAgICBjYWxsYmFjayA9IGNhbGxiYWNrICYmIHR5cGVvZiB0aGlzQXJnID09ICd1bmRlZmluZWQnID8gY2FsbGJhY2sgOiBiYXNlQ3JlYXRlQ2FsbGJhY2soY2FsbGJhY2ssIHRoaXNBcmcsIDMpO1xuICAgICAgICBmb3IgKGluZGV4IGluIGl0ZXJhYmxlKSB7XG4gICAgICAgICAgaWYgKGNhbGxiYWNrKGl0ZXJhYmxlW2luZGV4XSwgaW5kZXgsIGNvbGxlY3Rpb24pID09PSBmYWxzZSkgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdFxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBsaWtlIGBfLmZvckluYCBleGNlcHQgdGhhdCBpdCBpdGVyYXRlcyBvdmVyIGVsZW1lbnRzXG4gICAgICogb2YgYSBgY29sbGVjdGlvbmAgaW4gdGhlIG9wcG9zaXRlIG9yZGVyLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IE9iamVjdHNcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjYWxsYmFjaz1pZGVudGl0eV0gVGhlIGZ1bmN0aW9uIGNhbGxlZCBwZXIgaXRlcmF0aW9uLlxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgY2FsbGJhY2tgLlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgYG9iamVjdGAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIGZ1bmN0aW9uIFNoYXBlKCkge1xuICAgICAqICAgdGhpcy54ID0gMDtcbiAgICAgKiAgIHRoaXMueSA9IDA7XG4gICAgICogfVxuICAgICAqXG4gICAgICogU2hhcGUucHJvdG90eXBlLm1vdmUgPSBmdW5jdGlvbih4LCB5KSB7XG4gICAgICogICB0aGlzLnggKz0geDtcbiAgICAgKiAgIHRoaXMueSArPSB5O1xuICAgICAqIH07XG4gICAgICpcbiAgICAgKiBfLmZvckluUmlnaHQobmV3IFNoYXBlLCBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG4gICAgICogICBjb25zb2xlLmxvZyhrZXkpO1xuICAgICAqIH0pO1xuICAgICAqIC8vID0+IGxvZ3MgJ21vdmUnLCAneScsIGFuZCAneCcgYXNzdW1pbmcgYF8uZm9ySW4gYCBsb2dzICd4JywgJ3knLCBhbmQgJ21vdmUnXG4gICAgICovXG4gICAgZnVuY3Rpb24gZm9ySW5SaWdodChvYmplY3QsIGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgICB2YXIgcGFpcnMgPSBbXTtcblxuICAgICAgZm9ySW4ob2JqZWN0LCBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG4gICAgICAgIHBhaXJzLnB1c2goa2V5LCB2YWx1ZSk7XG4gICAgICB9KTtcblxuICAgICAgdmFyIGxlbmd0aCA9IHBhaXJzLmxlbmd0aDtcbiAgICAgIGNhbGxiYWNrID0gYmFzZUNyZWF0ZUNhbGxiYWNrKGNhbGxiYWNrLCB0aGlzQXJnLCAzKTtcbiAgICAgIHdoaWxlIChsZW5ndGgtLSkge1xuICAgICAgICBpZiAoY2FsbGJhY2socGFpcnNbbGVuZ3RoLS1dLCBwYWlyc1tsZW5ndGhdLCBvYmplY3QpID09PSBmYWxzZSkge1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gb2JqZWN0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEl0ZXJhdGVzIG92ZXIgb3duIGVudW1lcmFibGUgcHJvcGVydGllcyBvZiBhbiBvYmplY3QsIGV4ZWN1dGluZyB0aGUgY2FsbGJhY2tcbiAgICAgKiBmb3IgZWFjaCBwcm9wZXJ0eS4gVGhlIGNhbGxiYWNrIGlzIGJvdW5kIHRvIGB0aGlzQXJnYCBhbmQgaW52b2tlZCB3aXRoIHRocmVlXG4gICAgICogYXJndW1lbnRzOyAodmFsdWUsIGtleSwgb2JqZWN0KS4gQ2FsbGJhY2tzIG1heSBleGl0IGl0ZXJhdGlvbiBlYXJseSBieVxuICAgICAqIGV4cGxpY2l0bHkgcmV0dXJuaW5nIGBmYWxzZWAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAdHlwZSBGdW5jdGlvblxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RzXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY2FsbGJhY2s9aWRlbnRpdHldIFRoZSBmdW5jdGlvbiBjYWxsZWQgcGVyIGl0ZXJhdGlvbi5cbiAgICAgKiBAcGFyYW0geyp9IFt0aGlzQXJnXSBUaGUgYHRoaXNgIGJpbmRpbmcgb2YgYGNhbGxiYWNrYC5cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIGBvYmplY3RgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmZvck93bih7ICcwJzogJ3plcm8nLCAnMSc6ICdvbmUnLCAnbGVuZ3RoJzogMiB9LCBmdW5jdGlvbihudW0sIGtleSkge1xuICAgICAqICAgY29uc29sZS5sb2coa2V5KTtcbiAgICAgKiB9KTtcbiAgICAgKiAvLyA9PiBsb2dzICcwJywgJzEnLCBhbmQgJ2xlbmd0aCcgKHByb3BlcnR5IG9yZGVyIGlzIG5vdCBndWFyYW50ZWVkIGFjcm9zcyBlbnZpcm9ubWVudHMpXG4gICAgICovXG4gICAgdmFyIGZvck93biA9IGZ1bmN0aW9uKGNvbGxlY3Rpb24sIGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgICB2YXIgaW5kZXgsIGl0ZXJhYmxlID0gY29sbGVjdGlvbiwgcmVzdWx0ID0gaXRlcmFibGU7XG4gICAgICBpZiAoIWl0ZXJhYmxlKSByZXR1cm4gcmVzdWx0O1xuICAgICAgaWYgKCFvYmplY3RUeXBlc1t0eXBlb2YgaXRlcmFibGVdKSByZXR1cm4gcmVzdWx0O1xuICAgICAgY2FsbGJhY2sgPSBjYWxsYmFjayAmJiB0eXBlb2YgdGhpc0FyZyA9PSAndW5kZWZpbmVkJyA/IGNhbGxiYWNrIDogYmFzZUNyZWF0ZUNhbGxiYWNrKGNhbGxiYWNrLCB0aGlzQXJnLCAzKTtcbiAgICAgICAgdmFyIG93bkluZGV4ID0gLTEsXG4gICAgICAgICAgICBvd25Qcm9wcyA9IG9iamVjdFR5cGVzW3R5cGVvZiBpdGVyYWJsZV0gJiYga2V5cyhpdGVyYWJsZSksXG4gICAgICAgICAgICBsZW5ndGggPSBvd25Qcm9wcyA/IG93blByb3BzLmxlbmd0aCA6IDA7XG5cbiAgICAgICAgd2hpbGUgKCsrb3duSW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgICBpbmRleCA9IG93blByb3BzW293bkluZGV4XTtcbiAgICAgICAgICBpZiAoY2FsbGJhY2soaXRlcmFibGVbaW5kZXhdLCBpbmRleCwgY29sbGVjdGlvbikgPT09IGZhbHNlKSByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGxpa2UgYF8uZm9yT3duYCBleGNlcHQgdGhhdCBpdCBpdGVyYXRlcyBvdmVyIGVsZW1lbnRzXG4gICAgICogb2YgYSBgY29sbGVjdGlvbmAgaW4gdGhlIG9wcG9zaXRlIG9yZGVyLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IE9iamVjdHNcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjYWxsYmFjaz1pZGVudGl0eV0gVGhlIGZ1bmN0aW9uIGNhbGxlZCBwZXIgaXRlcmF0aW9uLlxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgY2FsbGJhY2tgLlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgYG9iamVjdGAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uZm9yT3duUmlnaHQoeyAnMCc6ICd6ZXJvJywgJzEnOiAnb25lJywgJ2xlbmd0aCc6IDIgfSwgZnVuY3Rpb24obnVtLCBrZXkpIHtcbiAgICAgKiAgIGNvbnNvbGUubG9nKGtleSk7XG4gICAgICogfSk7XG4gICAgICogLy8gPT4gbG9ncyAnbGVuZ3RoJywgJzEnLCBhbmQgJzAnIGFzc3VtaW5nIGBfLmZvck93bmAgbG9ncyAnMCcsICcxJywgYW5kICdsZW5ndGgnXG4gICAgICovXG4gICAgZnVuY3Rpb24gZm9yT3duUmlnaHQob2JqZWN0LCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgdmFyIHByb3BzID0ga2V5cyhvYmplY3QpLFxuICAgICAgICAgIGxlbmd0aCA9IHByb3BzLmxlbmd0aDtcblxuICAgICAgY2FsbGJhY2sgPSBiYXNlQ3JlYXRlQ2FsbGJhY2soY2FsbGJhY2ssIHRoaXNBcmcsIDMpO1xuICAgICAgd2hpbGUgKGxlbmd0aC0tKSB7XG4gICAgICAgIHZhciBrZXkgPSBwcm9wc1tsZW5ndGhdO1xuICAgICAgICBpZiAoY2FsbGJhY2sob2JqZWN0W2tleV0sIGtleSwgb2JqZWN0KSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG9iamVjdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgc29ydGVkIGFycmF5IG9mIHByb3BlcnR5IG5hbWVzIG9mIGFsbCBlbnVtZXJhYmxlIHByb3BlcnRpZXMsXG4gICAgICogb3duIGFuZCBpbmhlcml0ZWQsIG9mIGBvYmplY3RgIHRoYXQgaGF2ZSBmdW5jdGlvbiB2YWx1ZXMuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAYWxpYXMgbWV0aG9kc1xuICAgICAqIEBjYXRlZ29yeSBPYmplY3RzXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIGluc3BlY3QuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIGFuIGFycmF5IG9mIHByb3BlcnR5IG5hbWVzIHRoYXQgaGF2ZSBmdW5jdGlvbiB2YWx1ZXMuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uZnVuY3Rpb25zKF8pO1xuICAgICAqIC8vID0+IFsnYWxsJywgJ2FueScsICdiaW5kJywgJ2JpbmRBbGwnLCAnY2xvbmUnLCAnY29tcGFjdCcsICdjb21wb3NlJywgLi4uXVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGZ1bmN0aW9ucyhvYmplY3QpIHtcbiAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgIGZvckluKG9iamVjdCwgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuICAgICAgICBpZiAoaXNGdW5jdGlvbih2YWx1ZSkpIHtcbiAgICAgICAgICByZXN1bHQucHVzaChrZXkpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiByZXN1bHQuc29ydCgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiB0aGUgc3BlY2lmaWVkIHByb3BlcnR5IG5hbWUgZXhpc3RzIGFzIGEgZGlyZWN0IHByb3BlcnR5IG9mIGBvYmplY3RgLFxuICAgICAqIGluc3RlYWQgb2YgYW4gaW5oZXJpdGVkIHByb3BlcnR5LlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IE9iamVjdHNcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gaW5zcGVjdC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5IFRoZSBuYW1lIG9mIHRoZSBwcm9wZXJ0eSB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYga2V5IGlzIGEgZGlyZWN0IHByb3BlcnR5LCBlbHNlIGBmYWxzZWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uaGFzKHsgJ2EnOiAxLCAnYic6IDIsICdjJzogMyB9LCAnYicpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBoYXMob2JqZWN0LCBrZXkpIHtcbiAgICAgIHJldHVybiBvYmplY3QgPyBoYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwga2V5KSA6IGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gb2JqZWN0IGNvbXBvc2VkIG9mIHRoZSBpbnZlcnRlZCBrZXlzIGFuZCB2YWx1ZXMgb2YgdGhlIGdpdmVuIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBPYmplY3RzXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIGludmVydC5cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBjcmVhdGVkIGludmVydGVkIG9iamVjdC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5pbnZlcnQoeyAnZmlyc3QnOiAnZnJlZCcsICdzZWNvbmQnOiAnYmFybmV5JyB9KTtcbiAgICAgKiAvLyA9PiB7ICdmcmVkJzogJ2ZpcnN0JywgJ2Jhcm5leSc6ICdzZWNvbmQnIH1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpbnZlcnQob2JqZWN0KSB7XG4gICAgICB2YXIgaW5kZXggPSAtMSxcbiAgICAgICAgICBwcm9wcyA9IGtleXMob2JqZWN0KSxcbiAgICAgICAgICBsZW5ndGggPSBwcm9wcy5sZW5ndGgsXG4gICAgICAgICAgcmVzdWx0ID0ge307XG5cbiAgICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgIHZhciBrZXkgPSBwcm9wc1tpbmRleF07XG4gICAgICAgIHJlc3VsdFtvYmplY3Rba2V5XV0gPSBrZXk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGEgYm9vbGVhbiB2YWx1ZS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBPYmplY3RzXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSBgdmFsdWVgIGlzIGEgYm9vbGVhbiB2YWx1ZSwgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmlzQm9vbGVhbihudWxsKTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGlzQm9vbGVhbih2YWx1ZSkge1xuICAgICAgcmV0dXJuIHZhbHVlID09PSB0cnVlIHx8IHZhbHVlID09PSBmYWxzZSB8fFxuICAgICAgICB2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT0gJ29iamVjdCcgJiYgdG9TdHJpbmcuY2FsbCh2YWx1ZSkgPT0gYm9vbENsYXNzIHx8IGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGEgZGF0ZS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBPYmplY3RzXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSBgdmFsdWVgIGlzIGEgZGF0ZSwgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmlzRGF0ZShuZXcgRGF0ZSk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGlzRGF0ZSh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PSAnb2JqZWN0JyAmJiB0b1N0cmluZy5jYWxsKHZhbHVlKSA9PSBkYXRlQ2xhc3MgfHwgZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgYSBET00gZWxlbWVudC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBPYmplY3RzXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSBgdmFsdWVgIGlzIGEgRE9NIGVsZW1lbnQsIGVsc2UgYGZhbHNlYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5pc0VsZW1lbnQoZG9jdW1lbnQuYm9keSk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGlzRWxlbWVudCh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHZhbHVlICYmIHZhbHVlLm5vZGVUeXBlID09PSAxIHx8IGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGVtcHR5LiBBcnJheXMsIHN0cmluZ3MsIG9yIGBhcmd1bWVudHNgIG9iamVjdHMgd2l0aCBhXG4gICAgICogbGVuZ3RoIG9mIGAwYCBhbmQgb2JqZWN0cyB3aXRoIG5vIG93biBlbnVtZXJhYmxlIHByb3BlcnRpZXMgYXJlIGNvbnNpZGVyZWRcbiAgICAgKiBcImVtcHR5XCIuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0c1xuICAgICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fHN0cmluZ30gdmFsdWUgVGhlIHZhbHVlIHRvIGluc3BlY3QuXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSBgdmFsdWVgIGlzIGVtcHR5LCBlbHNlIGBmYWxzZWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uaXNFbXB0eShbMSwgMiwgM10pO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICpcbiAgICAgKiBfLmlzRW1wdHkoe30pO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uaXNFbXB0eSgnJyk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGlzRW1wdHkodmFsdWUpIHtcbiAgICAgIHZhciByZXN1bHQgPSB0cnVlO1xuICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfVxuICAgICAgdmFyIGNsYXNzTmFtZSA9IHRvU3RyaW5nLmNhbGwodmFsdWUpLFxuICAgICAgICAgIGxlbmd0aCA9IHZhbHVlLmxlbmd0aDtcblxuICAgICAgaWYgKChjbGFzc05hbWUgPT0gYXJyYXlDbGFzcyB8fCBjbGFzc05hbWUgPT0gc3RyaW5nQ2xhc3MgfHwgY2xhc3NOYW1lID09IGFyZ3NDbGFzcyApIHx8XG4gICAgICAgICAgKGNsYXNzTmFtZSA9PSBvYmplY3RDbGFzcyAmJiB0eXBlb2YgbGVuZ3RoID09ICdudW1iZXInICYmIGlzRnVuY3Rpb24odmFsdWUuc3BsaWNlKSkpIHtcbiAgICAgICAgcmV0dXJuICFsZW5ndGg7XG4gICAgICB9XG4gICAgICBmb3JPd24odmFsdWUsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gKHJlc3VsdCA9IGZhbHNlKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQZXJmb3JtcyBhIGRlZXAgY29tcGFyaXNvbiBiZXR3ZWVuIHR3byB2YWx1ZXMgdG8gZGV0ZXJtaW5lIGlmIHRoZXkgYXJlXG4gICAgICogZXF1aXZhbGVudCB0byBlYWNoIG90aGVyLiBJZiBhIGNhbGxiYWNrIGlzIHByb3ZpZGVkIGl0IHdpbGwgYmUgZXhlY3V0ZWRcbiAgICAgKiB0byBjb21wYXJlIHZhbHVlcy4gSWYgdGhlIGNhbGxiYWNrIHJldHVybnMgYHVuZGVmaW5lZGAgY29tcGFyaXNvbnMgd2lsbFxuICAgICAqIGJlIGhhbmRsZWQgYnkgdGhlIG1ldGhvZCBpbnN0ZWFkLiBUaGUgY2FsbGJhY2sgaXMgYm91bmQgdG8gYHRoaXNBcmdgIGFuZFxuICAgICAqIGludm9rZWQgd2l0aCB0d28gYXJndW1lbnRzOyAoYSwgYikuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0c1xuICAgICAqIEBwYXJhbSB7Kn0gYSBUaGUgdmFsdWUgdG8gY29tcGFyZS5cbiAgICAgKiBAcGFyYW0geyp9IGIgVGhlIG90aGVyIHZhbHVlIHRvIGNvbXBhcmUuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2NhbGxiYWNrXSBUaGUgZnVuY3Rpb24gdG8gY3VzdG9taXplIGNvbXBhcmluZyB2YWx1ZXMuXG4gICAgICogQHBhcmFtIHsqfSBbdGhpc0FyZ10gVGhlIGB0aGlzYCBiaW5kaW5nIG9mIGBjYWxsYmFja2AuXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSB2YWx1ZXMgYXJlIGVxdWl2YWxlbnQsIGVsc2UgYGZhbHNlYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIG9iamVjdCA9IHsgJ25hbWUnOiAnZnJlZCcgfTtcbiAgICAgKiB2YXIgY29weSA9IHsgJ25hbWUnOiAnZnJlZCcgfTtcbiAgICAgKlxuICAgICAqIG9iamVjdCA9PSBjb3B5O1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICpcbiAgICAgKiBfLmlzRXF1YWwob2JqZWN0LCBjb3B5KTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICpcbiAgICAgKiB2YXIgd29yZHMgPSBbJ2hlbGxvJywgJ2dvb2RieWUnXTtcbiAgICAgKiB2YXIgb3RoZXJXb3JkcyA9IFsnaGknLCAnZ29vZGJ5ZSddO1xuICAgICAqXG4gICAgICogXy5pc0VxdWFsKHdvcmRzLCBvdGhlcldvcmRzLCBmdW5jdGlvbihhLCBiKSB7XG4gICAgICogICB2YXIgcmVHcmVldCA9IC9eKD86aGVsbG98aGkpJC9pLFxuICAgICAqICAgICAgIGFHcmVldCA9IF8uaXNTdHJpbmcoYSkgJiYgcmVHcmVldC50ZXN0KGEpLFxuICAgICAqICAgICAgIGJHcmVldCA9IF8uaXNTdHJpbmcoYikgJiYgcmVHcmVldC50ZXN0KGIpO1xuICAgICAqXG4gICAgICogICByZXR1cm4gKGFHcmVldCB8fCBiR3JlZXQpID8gKGFHcmVldCA9PSBiR3JlZXQpIDogdW5kZWZpbmVkO1xuICAgICAqIH0pO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpc0VxdWFsKGEsIGIsIGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgICByZXR1cm4gYmFzZUlzRXF1YWwoYSwgYiwgdHlwZW9mIGNhbGxiYWNrID09ICdmdW5jdGlvbicgJiYgYmFzZUNyZWF0ZUNhbGxiYWNrKGNhbGxiYWNrLCB0aGlzQXJnLCAyKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMsIG9yIGNhbiBiZSBjb2VyY2VkIHRvLCBhIGZpbml0ZSBudW1iZXIuXG4gICAgICpcbiAgICAgKiBOb3RlOiBUaGlzIGlzIG5vdCB0aGUgc2FtZSBhcyBuYXRpdmUgYGlzRmluaXRlYCB3aGljaCB3aWxsIHJldHVybiB0cnVlIGZvclxuICAgICAqIGJvb2xlYW5zIGFuZCBlbXB0eSBzdHJpbmdzLiBTZWUgaHR0cDovL2VzNS5naXRodWIuaW8vI3gxNS4xLjIuNS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBPYmplY3RzXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSBgdmFsdWVgIGlzIGZpbml0ZSwgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmlzRmluaXRlKC0xMDEpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uaXNGaW5pdGUoJzEwJyk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogXy5pc0Zpbml0ZSh0cnVlKTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqXG4gICAgICogXy5pc0Zpbml0ZSgnJyk7XG4gICAgICogLy8gPT4gZmFsc2VcbiAgICAgKlxuICAgICAqIF8uaXNGaW5pdGUoSW5maW5pdHkpO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICovXG4gICAgZnVuY3Rpb24gaXNGaW5pdGUodmFsdWUpIHtcbiAgICAgIHJldHVybiBuYXRpdmVJc0Zpbml0ZSh2YWx1ZSkgJiYgIW5hdGl2ZUlzTmFOKHBhcnNlRmxvYXQodmFsdWUpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBhIGZ1bmN0aW9uLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IE9iamVjdHNcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGB2YWx1ZWAgaXMgYSBmdW5jdGlvbiwgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmlzRnVuY3Rpb24oXyk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGlzRnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT0gJ2Z1bmN0aW9uJztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgYHZhbHVlYCBpcyB0aGUgbGFuZ3VhZ2UgdHlwZSBvZiBPYmplY3QuXG4gICAgICogKGUuZy4gYXJyYXlzLCBmdW5jdGlvbnMsIG9iamVjdHMsIHJlZ2V4ZXMsIGBuZXcgTnVtYmVyKDApYCwgYW5kIGBuZXcgU3RyaW5nKCcnKWApXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0c1xuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgYHZhbHVlYCBpcyBhbiBvYmplY3QsIGVsc2UgYGZhbHNlYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5pc09iamVjdCh7fSk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogXy5pc09iamVjdChbMSwgMiwgM10pO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uaXNPYmplY3QoMSk7XG4gICAgICogLy8gPT4gZmFsc2VcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpc09iamVjdCh2YWx1ZSkge1xuICAgICAgLy8gY2hlY2sgaWYgdGhlIHZhbHVlIGlzIHRoZSBFQ01BU2NyaXB0IGxhbmd1YWdlIHR5cGUgb2YgT2JqZWN0XG4gICAgICAvLyBodHRwOi8vZXM1LmdpdGh1Yi5pby8jeDhcbiAgICAgIC8vIGFuZCBhdm9pZCBhIFY4IGJ1Z1xuICAgICAgLy8gaHR0cDovL2NvZGUuZ29vZ2xlLmNvbS9wL3Y4L2lzc3Vlcy9kZXRhaWw/aWQ9MjI5MVxuICAgICAgcmV0dXJuICEhKHZhbHVlICYmIG9iamVjdFR5cGVzW3R5cGVvZiB2YWx1ZV0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGBOYU5gLlxuICAgICAqXG4gICAgICogTm90ZTogVGhpcyBpcyBub3QgdGhlIHNhbWUgYXMgbmF0aXZlIGBpc05hTmAgd2hpY2ggd2lsbCByZXR1cm4gYHRydWVgIGZvclxuICAgICAqIGB1bmRlZmluZWRgIGFuZCBvdGhlciBub24tbnVtZXJpYyB2YWx1ZXMuIFNlZSBodHRwOi8vZXM1LmdpdGh1Yi5pby8jeDE1LjEuMi40LlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IE9iamVjdHNcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGB2YWx1ZWAgaXMgYE5hTmAsIGVsc2UgYGZhbHNlYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5pc05hTihOYU4pO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uaXNOYU4obmV3IE51bWJlcihOYU4pKTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICpcbiAgICAgKiBpc05hTih1bmRlZmluZWQpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uaXNOYU4odW5kZWZpbmVkKTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGlzTmFOKHZhbHVlKSB7XG4gICAgICAvLyBgTmFOYCBhcyBhIHByaW1pdGl2ZSBpcyB0aGUgb25seSB2YWx1ZSB0aGF0IGlzIG5vdCBlcXVhbCB0byBpdHNlbGZcbiAgICAgIC8vIChwZXJmb3JtIHRoZSBbW0NsYXNzXV0gY2hlY2sgZmlyc3QgdG8gYXZvaWQgZXJyb3JzIHdpdGggc29tZSBob3N0IG9iamVjdHMgaW4gSUUpXG4gICAgICByZXR1cm4gaXNOdW1iZXIodmFsdWUpICYmIHZhbHVlICE9ICt2YWx1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBgbnVsbGAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0c1xuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgYHZhbHVlYCBpcyBgbnVsbGAsIGVsc2UgYGZhbHNlYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5pc051bGwobnVsbCk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogXy5pc051bGwodW5kZWZpbmVkKTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGlzTnVsbCh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHZhbHVlID09PSBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGEgbnVtYmVyLlxuICAgICAqXG4gICAgICogTm90ZTogYE5hTmAgaXMgY29uc2lkZXJlZCBhIG51bWJlci4gU2VlIGh0dHA6Ly9lczUuZ2l0aHViLmlvLyN4OC41LlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IE9iamVjdHNcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGB2YWx1ZWAgaXMgYSBudW1iZXIsIGVsc2UgYGZhbHNlYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5pc051bWJlcig4LjQgKiA1KTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICovXG4gICAgZnVuY3Rpb24gaXNOdW1iZXIodmFsdWUpIHtcbiAgICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT0gJ251bWJlcicgfHxcbiAgICAgICAgdmFsdWUgJiYgdHlwZW9mIHZhbHVlID09ICdvYmplY3QnICYmIHRvU3RyaW5nLmNhbGwodmFsdWUpID09IG51bWJlckNsYXNzIHx8IGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGFuIG9iamVjdCBjcmVhdGVkIGJ5IHRoZSBgT2JqZWN0YCBjb25zdHJ1Y3Rvci5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBPYmplY3RzXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYSBwbGFpbiBvYmplY3QsIGVsc2UgYGZhbHNlYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogZnVuY3Rpb24gU2hhcGUoKSB7XG4gICAgICogICB0aGlzLnggPSAwO1xuICAgICAqICAgdGhpcy55ID0gMDtcbiAgICAgKiB9XG4gICAgICpcbiAgICAgKiBfLmlzUGxhaW5PYmplY3QobmV3IFNoYXBlKTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqXG4gICAgICogXy5pc1BsYWluT2JqZWN0KFsxLCAyLCAzXSk7XG4gICAgICogLy8gPT4gZmFsc2VcbiAgICAgKlxuICAgICAqIF8uaXNQbGFpbk9iamVjdCh7ICd4JzogMCwgJ3knOiAwIH0pO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKi9cbiAgICB2YXIgaXNQbGFpbk9iamVjdCA9ICFnZXRQcm90b3R5cGVPZiA/IHNoaW1Jc1BsYWluT2JqZWN0IDogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIGlmICghKHZhbHVlICYmIHRvU3RyaW5nLmNhbGwodmFsdWUpID09IG9iamVjdENsYXNzKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICB2YXIgdmFsdWVPZiA9IHZhbHVlLnZhbHVlT2YsXG4gICAgICAgICAgb2JqUHJvdG8gPSBpc05hdGl2ZSh2YWx1ZU9mKSAmJiAob2JqUHJvdG8gPSBnZXRQcm90b3R5cGVPZih2YWx1ZU9mKSkgJiYgZ2V0UHJvdG90eXBlT2Yob2JqUHJvdG8pO1xuXG4gICAgICByZXR1cm4gb2JqUHJvdG9cbiAgICAgICAgPyAodmFsdWUgPT0gb2JqUHJvdG8gfHwgZ2V0UHJvdG90eXBlT2YodmFsdWUpID09IG9ialByb3RvKVxuICAgICAgICA6IHNoaW1Jc1BsYWluT2JqZWN0KHZhbHVlKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgYSByZWd1bGFyIGV4cHJlc3Npb24uXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0c1xuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgYHZhbHVlYCBpcyBhIHJlZ3VsYXIgZXhwcmVzc2lvbiwgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmlzUmVnRXhwKC9mcmVkLyk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGlzUmVnRXhwKHZhbHVlKSB7XG4gICAgICByZXR1cm4gdmFsdWUgJiYgdHlwZW9mIHZhbHVlID09ICdvYmplY3QnICYmIHRvU3RyaW5nLmNhbGwodmFsdWUpID09IHJlZ2V4cENsYXNzIHx8IGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGEgc3RyaW5nLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IE9iamVjdHNcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGB2YWx1ZWAgaXMgYSBzdHJpbmcsIGVsc2UgYGZhbHNlYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5pc1N0cmluZygnZnJlZCcpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpc1N0cmluZyh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PSAnc3RyaW5nJyB8fFxuICAgICAgICB2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT0gJ29iamVjdCcgJiYgdG9TdHJpbmcuY2FsbCh2YWx1ZSkgPT0gc3RyaW5nQ2xhc3MgfHwgZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgYHVuZGVmaW5lZGAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0c1xuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgYHZhbHVlYCBpcyBgdW5kZWZpbmVkYCwgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmlzVW5kZWZpbmVkKHZvaWQgMCk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGlzVW5kZWZpbmVkKHZhbHVlKSB7XG4gICAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09ICd1bmRlZmluZWQnO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gb2JqZWN0IHdpdGggdGhlIHNhbWUga2V5cyBhcyBgb2JqZWN0YCBhbmQgdmFsdWVzIGdlbmVyYXRlZCBieVxuICAgICAqIHJ1bm5pbmcgZWFjaCBvd24gZW51bWVyYWJsZSBwcm9wZXJ0eSBvZiBgb2JqZWN0YCB0aHJvdWdoIHRoZSBjYWxsYmFjay5cbiAgICAgKiBUaGUgY2FsbGJhY2sgaXMgYm91bmQgdG8gYHRoaXNBcmdgIGFuZCBpbnZva2VkIHdpdGggdGhyZWUgYXJndW1lbnRzO1xuICAgICAqICh2YWx1ZSwga2V5LCBvYmplY3QpLlxuICAgICAqXG4gICAgICogSWYgYSBwcm9wZXJ0eSBuYW1lIGlzIHByb3ZpZGVkIGZvciBgY2FsbGJhY2tgIHRoZSBjcmVhdGVkIFwiXy5wbHVja1wiIHN0eWxlXG4gICAgICogY2FsbGJhY2sgd2lsbCByZXR1cm4gdGhlIHByb3BlcnR5IHZhbHVlIG9mIHRoZSBnaXZlbiBlbGVtZW50LlxuICAgICAqXG4gICAgICogSWYgYW4gb2JqZWN0IGlzIHByb3ZpZGVkIGZvciBgY2FsbGJhY2tgIHRoZSBjcmVhdGVkIFwiXy53aGVyZVwiIHN0eWxlIGNhbGxiYWNrXG4gICAgICogd2lsbCByZXR1cm4gYHRydWVgIGZvciBlbGVtZW50cyB0aGF0IGhhdmUgdGhlIHByb3BlcnRpZXMgb2YgdGhlIGdpdmVuIG9iamVjdCxcbiAgICAgKiBlbHNlIGBmYWxzZWAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0c1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBpdGVyYXRlIG92ZXIuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbnxPYmplY3R8c3RyaW5nfSBbY2FsbGJhY2s9aWRlbnRpdHldIFRoZSBmdW5jdGlvbiBjYWxsZWRcbiAgICAgKiAgcGVyIGl0ZXJhdGlvbi4gSWYgYSBwcm9wZXJ0eSBuYW1lIG9yIG9iamVjdCBpcyBwcm92aWRlZCBpdCB3aWxsIGJlIHVzZWRcbiAgICAgKiAgdG8gY3JlYXRlIGEgXCJfLnBsdWNrXCIgb3IgXCJfLndoZXJlXCIgc3R5bGUgY2FsbGJhY2ssIHJlc3BlY3RpdmVseS5cbiAgICAgKiBAcGFyYW0geyp9IFt0aGlzQXJnXSBUaGUgYHRoaXNgIGJpbmRpbmcgb2YgYGNhbGxiYWNrYC5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggdmFsdWVzIG9mIHRoZSByZXN1bHRzIG9mIGVhY2ggYGNhbGxiYWNrYCBleGVjdXRpb24uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8ubWFwVmFsdWVzKHsgJ2EnOiAxLCAnYic6IDIsICdjJzogM30gLCBmdW5jdGlvbihudW0pIHsgcmV0dXJuIG51bSAqIDM7IH0pO1xuICAgICAqIC8vID0+IHsgJ2EnOiAzLCAnYic6IDYsICdjJzogOSB9XG4gICAgICpcbiAgICAgKiB2YXIgY2hhcmFjdGVycyA9IHtcbiAgICAgKiAgICdmcmVkJzogeyAnbmFtZSc6ICdmcmVkJywgJ2FnZSc6IDQwIH0sXG4gICAgICogICAncGViYmxlcyc6IHsgJ25hbWUnOiAncGViYmxlcycsICdhZ2UnOiAxIH1cbiAgICAgKiB9O1xuICAgICAqXG4gICAgICogLy8gdXNpbmcgXCJfLnBsdWNrXCIgY2FsbGJhY2sgc2hvcnRoYW5kXG4gICAgICogXy5tYXBWYWx1ZXMoY2hhcmFjdGVycywgJ2FnZScpO1xuICAgICAqIC8vID0+IHsgJ2ZyZWQnOiA0MCwgJ3BlYmJsZXMnOiAxIH1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBtYXBWYWx1ZXMob2JqZWN0LCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgICAgY2FsbGJhY2sgPSBsb2Rhc2guY3JlYXRlQ2FsbGJhY2soY2FsbGJhY2ssIHRoaXNBcmcsIDMpO1xuXG4gICAgICBmb3JPd24ob2JqZWN0LCBmdW5jdGlvbih2YWx1ZSwga2V5LCBvYmplY3QpIHtcbiAgICAgICAgcmVzdWx0W2tleV0gPSBjYWxsYmFjayh2YWx1ZSwga2V5LCBvYmplY3QpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlY3Vyc2l2ZWx5IG1lcmdlcyBvd24gZW51bWVyYWJsZSBwcm9wZXJ0aWVzIG9mIHRoZSBzb3VyY2Ugb2JqZWN0KHMpLCB0aGF0XG4gICAgICogZG9uJ3QgcmVzb2x2ZSB0byBgdW5kZWZpbmVkYCBpbnRvIHRoZSBkZXN0aW5hdGlvbiBvYmplY3QuIFN1YnNlcXVlbnQgc291cmNlc1xuICAgICAqIHdpbGwgb3ZlcndyaXRlIHByb3BlcnR5IGFzc2lnbm1lbnRzIG9mIHByZXZpb3VzIHNvdXJjZXMuIElmIGEgY2FsbGJhY2sgaXNcbiAgICAgKiBwcm92aWRlZCBpdCB3aWxsIGJlIGV4ZWN1dGVkIHRvIHByb2R1Y2UgdGhlIG1lcmdlZCB2YWx1ZXMgb2YgdGhlIGRlc3RpbmF0aW9uXG4gICAgICogYW5kIHNvdXJjZSBwcm9wZXJ0aWVzLiBJZiB0aGUgY2FsbGJhY2sgcmV0dXJucyBgdW5kZWZpbmVkYCBtZXJnaW5nIHdpbGxcbiAgICAgKiBiZSBoYW5kbGVkIGJ5IHRoZSBtZXRob2QgaW5zdGVhZC4gVGhlIGNhbGxiYWNrIGlzIGJvdW5kIHRvIGB0aGlzQXJnYCBhbmRcbiAgICAgKiBpbnZva2VkIHdpdGggdHdvIGFyZ3VtZW50czsgKG9iamVjdFZhbHVlLCBzb3VyY2VWYWx1ZSkuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0c1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIGRlc3RpbmF0aW9uIG9iamVjdC5cbiAgICAgKiBAcGFyYW0gey4uLk9iamVjdH0gW3NvdXJjZV0gVGhlIHNvdXJjZSBvYmplY3RzLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjYWxsYmFja10gVGhlIGZ1bmN0aW9uIHRvIGN1c3RvbWl6ZSBtZXJnaW5nIHByb3BlcnRpZXMuXG4gICAgICogQHBhcmFtIHsqfSBbdGhpc0FyZ10gVGhlIGB0aGlzYCBiaW5kaW5nIG9mIGBjYWxsYmFja2AuXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyB0aGUgZGVzdGluYXRpb24gb2JqZWN0LlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgbmFtZXMgPSB7XG4gICAgICogICAnY2hhcmFjdGVycyc6IFtcbiAgICAgKiAgICAgeyAnbmFtZSc6ICdiYXJuZXknIH0sXG4gICAgICogICAgIHsgJ25hbWUnOiAnZnJlZCcgfVxuICAgICAqICAgXVxuICAgICAqIH07XG4gICAgICpcbiAgICAgKiB2YXIgYWdlcyA9IHtcbiAgICAgKiAgICdjaGFyYWN0ZXJzJzogW1xuICAgICAqICAgICB7ICdhZ2UnOiAzNiB9LFxuICAgICAqICAgICB7ICdhZ2UnOiA0MCB9XG4gICAgICogICBdXG4gICAgICogfTtcbiAgICAgKlxuICAgICAqIF8ubWVyZ2UobmFtZXMsIGFnZXMpO1xuICAgICAqIC8vID0+IHsgJ2NoYXJhY3RlcnMnOiBbeyAnbmFtZSc6ICdiYXJuZXknLCAnYWdlJzogMzYgfSwgeyAnbmFtZSc6ICdmcmVkJywgJ2FnZSc6IDQwIH1dIH1cbiAgICAgKlxuICAgICAqIHZhciBmb29kID0ge1xuICAgICAqICAgJ2ZydWl0cyc6IFsnYXBwbGUnXSxcbiAgICAgKiAgICd2ZWdldGFibGVzJzogWydiZWV0J11cbiAgICAgKiB9O1xuICAgICAqXG4gICAgICogdmFyIG90aGVyRm9vZCA9IHtcbiAgICAgKiAgICdmcnVpdHMnOiBbJ2JhbmFuYSddLFxuICAgICAqICAgJ3ZlZ2V0YWJsZXMnOiBbJ2NhcnJvdCddXG4gICAgICogfTtcbiAgICAgKlxuICAgICAqIF8ubWVyZ2UoZm9vZCwgb3RoZXJGb29kLCBmdW5jdGlvbihhLCBiKSB7XG4gICAgICogICByZXR1cm4gXy5pc0FycmF5KGEpID8gYS5jb25jYXQoYikgOiB1bmRlZmluZWQ7XG4gICAgICogfSk7XG4gICAgICogLy8gPT4geyAnZnJ1aXRzJzogWydhcHBsZScsICdiYW5hbmEnXSwgJ3ZlZ2V0YWJsZXMnOiBbJ2JlZXQnLCAnY2Fycm90XSB9XG4gICAgICovXG4gICAgZnVuY3Rpb24gbWVyZ2Uob2JqZWN0KSB7XG4gICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cyxcbiAgICAgICAgICBsZW5ndGggPSAyO1xuXG4gICAgICBpZiAoIWlzT2JqZWN0KG9iamVjdCkpIHtcbiAgICAgICAgcmV0dXJuIG9iamVjdDtcbiAgICAgIH1cbiAgICAgIC8vIGFsbG93cyB3b3JraW5nIHdpdGggYF8ucmVkdWNlYCBhbmQgYF8ucmVkdWNlUmlnaHRgIHdpdGhvdXQgdXNpbmdcbiAgICAgIC8vIHRoZWlyIGBpbmRleGAgYW5kIGBjb2xsZWN0aW9uYCBhcmd1bWVudHNcbiAgICAgIGlmICh0eXBlb2YgYXJnc1syXSAhPSAnbnVtYmVyJykge1xuICAgICAgICBsZW5ndGggPSBhcmdzLmxlbmd0aDtcbiAgICAgIH1cbiAgICAgIGlmIChsZW5ndGggPiAzICYmIHR5cGVvZiBhcmdzW2xlbmd0aCAtIDJdID09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdmFyIGNhbGxiYWNrID0gYmFzZUNyZWF0ZUNhbGxiYWNrKGFyZ3NbLS1sZW5ndGggLSAxXSwgYXJnc1tsZW5ndGgtLV0sIDIpO1xuICAgICAgfSBlbHNlIGlmIChsZW5ndGggPiAyICYmIHR5cGVvZiBhcmdzW2xlbmd0aCAtIDFdID09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgY2FsbGJhY2sgPSBhcmdzWy0tbGVuZ3RoXTtcbiAgICAgIH1cbiAgICAgIHZhciBzb3VyY2VzID0gc2xpY2UoYXJndW1lbnRzLCAxLCBsZW5ndGgpLFxuICAgICAgICAgIGluZGV4ID0gLTEsXG4gICAgICAgICAgc3RhY2tBID0gZ2V0QXJyYXkoKSxcbiAgICAgICAgICBzdGFja0IgPSBnZXRBcnJheSgpO1xuXG4gICAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgICBiYXNlTWVyZ2Uob2JqZWN0LCBzb3VyY2VzW2luZGV4XSwgY2FsbGJhY2ssIHN0YWNrQSwgc3RhY2tCKTtcbiAgICAgIH1cbiAgICAgIHJlbGVhc2VBcnJheShzdGFja0EpO1xuICAgICAgcmVsZWFzZUFycmF5KHN0YWNrQik7XG4gICAgICByZXR1cm4gb2JqZWN0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBzaGFsbG93IGNsb25lIG9mIGBvYmplY3RgIGV4Y2x1ZGluZyB0aGUgc3BlY2lmaWVkIHByb3BlcnRpZXMuXG4gICAgICogUHJvcGVydHkgbmFtZXMgbWF5IGJlIHNwZWNpZmllZCBhcyBpbmRpdmlkdWFsIGFyZ3VtZW50cyBvciBhcyBhcnJheXMgb2ZcbiAgICAgKiBwcm9wZXJ0eSBuYW1lcy4gSWYgYSBjYWxsYmFjayBpcyBwcm92aWRlZCBpdCB3aWxsIGJlIGV4ZWN1dGVkIGZvciBlYWNoXG4gICAgICogcHJvcGVydHkgb2YgYG9iamVjdGAgb21pdHRpbmcgdGhlIHByb3BlcnRpZXMgdGhlIGNhbGxiYWNrIHJldHVybnMgdHJ1ZXlcbiAgICAgKiBmb3IuIFRoZSBjYWxsYmFjayBpcyBib3VuZCB0byBgdGhpc0FyZ2AgYW5kIGludm9rZWQgd2l0aCB0aHJlZSBhcmd1bWVudHM7XG4gICAgICogKHZhbHVlLCBrZXksIG9iamVjdCkuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0c1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIHNvdXJjZSBvYmplY3QuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbnwuLi5zdHJpbmd8c3RyaW5nW119IFtjYWxsYmFja10gVGhlIHByb3BlcnRpZXMgdG8gb21pdCBvciB0aGVcbiAgICAgKiAgZnVuY3Rpb24gY2FsbGVkIHBlciBpdGVyYXRpb24uXG4gICAgICogQHBhcmFtIHsqfSBbdGhpc0FyZ10gVGhlIGB0aGlzYCBiaW5kaW5nIG9mIGBjYWxsYmFja2AuXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyBhbiBvYmplY3Qgd2l0aG91dCB0aGUgb21pdHRlZCBwcm9wZXJ0aWVzLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLm9taXQoeyAnbmFtZSc6ICdmcmVkJywgJ2FnZSc6IDQwIH0sICdhZ2UnKTtcbiAgICAgKiAvLyA9PiB7ICduYW1lJzogJ2ZyZWQnIH1cbiAgICAgKlxuICAgICAqIF8ub21pdCh7ICduYW1lJzogJ2ZyZWQnLCAnYWdlJzogNDAgfSwgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgKiAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT0gJ251bWJlcic7XG4gICAgICogfSk7XG4gICAgICogLy8gPT4geyAnbmFtZSc6ICdmcmVkJyB9XG4gICAgICovXG4gICAgZnVuY3Rpb24gb21pdChvYmplY3QsIGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICBpZiAodHlwZW9mIGNhbGxiYWNrICE9ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdmFyIHByb3BzID0gW107XG4gICAgICAgIGZvckluKG9iamVjdCwgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuICAgICAgICAgIHByb3BzLnB1c2goa2V5KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHByb3BzID0gYmFzZURpZmZlcmVuY2UocHJvcHMsIGJhc2VGbGF0dGVuKGFyZ3VtZW50cywgdHJ1ZSwgZmFsc2UsIDEpKTtcblxuICAgICAgICB2YXIgaW5kZXggPSAtMSxcbiAgICAgICAgICAgIGxlbmd0aCA9IHByb3BzLmxlbmd0aDtcblxuICAgICAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgICAgIHZhciBrZXkgPSBwcm9wc1tpbmRleF07XG4gICAgICAgICAgcmVzdWx0W2tleV0gPSBvYmplY3Rba2V5XTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2FsbGJhY2sgPSBsb2Rhc2guY3JlYXRlQ2FsbGJhY2soY2FsbGJhY2ssIHRoaXNBcmcsIDMpO1xuICAgICAgICBmb3JJbihvYmplY3QsIGZ1bmN0aW9uKHZhbHVlLCBrZXksIG9iamVjdCkge1xuICAgICAgICAgIGlmICghY2FsbGJhY2sodmFsdWUsIGtleSwgb2JqZWN0KSkge1xuICAgICAgICAgICAgcmVzdWx0W2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgdHdvIGRpbWVuc2lvbmFsIGFycmF5IG9mIGFuIG9iamVjdCdzIGtleS12YWx1ZSBwYWlycyxcbiAgICAgKiBpLmUuIGBbW2tleTEsIHZhbHVlMV0sIFtrZXkyLCB2YWx1ZTJdXWAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0c1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBpbnNwZWN0LlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyBuZXcgYXJyYXkgb2Yga2V5LXZhbHVlIHBhaXJzLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLnBhaXJzKHsgJ2Jhcm5leSc6IDM2LCAnZnJlZCc6IDQwIH0pO1xuICAgICAqIC8vID0+IFtbJ2Jhcm5leScsIDM2XSwgWydmcmVkJywgNDBdXSAocHJvcGVydHkgb3JkZXIgaXMgbm90IGd1YXJhbnRlZWQgYWNyb3NzIGVudmlyb25tZW50cylcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBwYWlycyhvYmplY3QpIHtcbiAgICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICAgIHByb3BzID0ga2V5cyhvYmplY3QpLFxuICAgICAgICAgIGxlbmd0aCA9IHByb3BzLmxlbmd0aCxcbiAgICAgICAgICByZXN1bHQgPSBBcnJheShsZW5ndGgpO1xuXG4gICAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgICB2YXIga2V5ID0gcHJvcHNbaW5kZXhdO1xuICAgICAgICByZXN1bHRbaW5kZXhdID0gW2tleSwgb2JqZWN0W2tleV1dO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgc2hhbGxvdyBjbG9uZSBvZiBgb2JqZWN0YCBjb21wb3NlZCBvZiB0aGUgc3BlY2lmaWVkIHByb3BlcnRpZXMuXG4gICAgICogUHJvcGVydHkgbmFtZXMgbWF5IGJlIHNwZWNpZmllZCBhcyBpbmRpdmlkdWFsIGFyZ3VtZW50cyBvciBhcyBhcnJheXMgb2ZcbiAgICAgKiBwcm9wZXJ0eSBuYW1lcy4gSWYgYSBjYWxsYmFjayBpcyBwcm92aWRlZCBpdCB3aWxsIGJlIGV4ZWN1dGVkIGZvciBlYWNoXG4gICAgICogcHJvcGVydHkgb2YgYG9iamVjdGAgcGlja2luZyB0aGUgcHJvcGVydGllcyB0aGUgY2FsbGJhY2sgcmV0dXJucyB0cnVleVxuICAgICAqIGZvci4gVGhlIGNhbGxiYWNrIGlzIGJvdW5kIHRvIGB0aGlzQXJnYCBhbmQgaW52b2tlZCB3aXRoIHRocmVlIGFyZ3VtZW50cztcbiAgICAgKiAodmFsdWUsIGtleSwgb2JqZWN0KS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBPYmplY3RzXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgc291cmNlIG9iamVjdC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufC4uLnN0cmluZ3xzdHJpbmdbXX0gW2NhbGxiYWNrXSBUaGUgZnVuY3Rpb24gY2FsbGVkIHBlclxuICAgICAqICBpdGVyYXRpb24gb3IgcHJvcGVydHkgbmFtZXMgdG8gcGljaywgc3BlY2lmaWVkIGFzIGluZGl2aWR1YWwgcHJvcGVydHlcbiAgICAgKiAgbmFtZXMgb3IgYXJyYXlzIG9mIHByb3BlcnR5IG5hbWVzLlxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgY2FsbGJhY2tgLlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgYW4gb2JqZWN0IGNvbXBvc2VkIG9mIHRoZSBwaWNrZWQgcHJvcGVydGllcy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5waWNrKHsgJ25hbWUnOiAnZnJlZCcsICdfdXNlcmlkJzogJ2ZyZWQxJyB9LCAnbmFtZScpO1xuICAgICAqIC8vID0+IHsgJ25hbWUnOiAnZnJlZCcgfVxuICAgICAqXG4gICAgICogXy5waWNrKHsgJ25hbWUnOiAnZnJlZCcsICdfdXNlcmlkJzogJ2ZyZWQxJyB9LCBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG4gICAgICogICByZXR1cm4ga2V5LmNoYXJBdCgwKSAhPSAnXyc7XG4gICAgICogfSk7XG4gICAgICogLy8gPT4geyAnbmFtZSc6ICdmcmVkJyB9XG4gICAgICovXG4gICAgZnVuY3Rpb24gcGljayhvYmplY3QsIGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICBpZiAodHlwZW9mIGNhbGxiYWNrICE9ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgICAgICBwcm9wcyA9IGJhc2VGbGF0dGVuKGFyZ3VtZW50cywgdHJ1ZSwgZmFsc2UsIDEpLFxuICAgICAgICAgICAgbGVuZ3RoID0gaXNPYmplY3Qob2JqZWN0KSA/IHByb3BzLmxlbmd0aCA6IDA7XG5cbiAgICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgICB2YXIga2V5ID0gcHJvcHNbaW5kZXhdO1xuICAgICAgICAgIGlmIChrZXkgaW4gb2JqZWN0KSB7XG4gICAgICAgICAgICByZXN1bHRba2V5XSA9IG9iamVjdFtrZXldO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2FsbGJhY2sgPSBsb2Rhc2guY3JlYXRlQ2FsbGJhY2soY2FsbGJhY2ssIHRoaXNBcmcsIDMpO1xuICAgICAgICBmb3JJbihvYmplY3QsIGZ1bmN0aW9uKHZhbHVlLCBrZXksIG9iamVjdCkge1xuICAgICAgICAgIGlmIChjYWxsYmFjayh2YWx1ZSwga2V5LCBvYmplY3QpKSB7XG4gICAgICAgICAgICByZXN1bHRba2V5XSA9IHZhbHVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFuIGFsdGVybmF0aXZlIHRvIGBfLnJlZHVjZWAgdGhpcyBtZXRob2QgdHJhbnNmb3JtcyBgb2JqZWN0YCB0byBhIG5ld1xuICAgICAqIGBhY2N1bXVsYXRvcmAgb2JqZWN0IHdoaWNoIGlzIHRoZSByZXN1bHQgb2YgcnVubmluZyBlYWNoIG9mIGl0cyBvd25cbiAgICAgKiBlbnVtZXJhYmxlIHByb3BlcnRpZXMgdGhyb3VnaCBhIGNhbGxiYWNrLCB3aXRoIGVhY2ggY2FsbGJhY2sgZXhlY3V0aW9uXG4gICAgICogcG90ZW50aWFsbHkgbXV0YXRpbmcgdGhlIGBhY2N1bXVsYXRvcmAgb2JqZWN0LiBUaGUgY2FsbGJhY2sgaXMgYm91bmQgdG9cbiAgICAgKiBgdGhpc0FyZ2AgYW5kIGludm9rZWQgd2l0aCBmb3VyIGFyZ3VtZW50czsgKGFjY3VtdWxhdG9yLCB2YWx1ZSwga2V5LCBvYmplY3QpLlxuICAgICAqIENhbGxiYWNrcyBtYXkgZXhpdCBpdGVyYXRpb24gZWFybHkgYnkgZXhwbGljaXRseSByZXR1cm5pbmcgYGZhbHNlYC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBPYmplY3RzXG4gICAgICogQHBhcmFtIHtBcnJheXxPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY2FsbGJhY2s9aWRlbnRpdHldIFRoZSBmdW5jdGlvbiBjYWxsZWQgcGVyIGl0ZXJhdGlvbi5cbiAgICAgKiBAcGFyYW0geyp9IFthY2N1bXVsYXRvcl0gVGhlIGN1c3RvbSBhY2N1bXVsYXRvciB2YWx1ZS5cbiAgICAgKiBAcGFyYW0geyp9IFt0aGlzQXJnXSBUaGUgYHRoaXNgIGJpbmRpbmcgb2YgYGNhbGxiYWNrYC5cbiAgICAgKiBAcmV0dXJucyB7Kn0gUmV0dXJucyB0aGUgYWNjdW11bGF0ZWQgdmFsdWUuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBzcXVhcmVzID0gXy50cmFuc2Zvcm0oWzEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDksIDEwXSwgZnVuY3Rpb24ocmVzdWx0LCBudW0pIHtcbiAgICAgKiAgIG51bSAqPSBudW07XG4gICAgICogICBpZiAobnVtICUgMikge1xuICAgICAqICAgICByZXR1cm4gcmVzdWx0LnB1c2gobnVtKSA8IDM7XG4gICAgICogICB9XG4gICAgICogfSk7XG4gICAgICogLy8gPT4gWzEsIDksIDI1XVxuICAgICAqXG4gICAgICogdmFyIG1hcHBlZCA9IF8udHJhbnNmb3JtKHsgJ2EnOiAxLCAnYic6IDIsICdjJzogMyB9LCBmdW5jdGlvbihyZXN1bHQsIG51bSwga2V5KSB7XG4gICAgICogICByZXN1bHRba2V5XSA9IG51bSAqIDM7XG4gICAgICogfSk7XG4gICAgICogLy8gPT4geyAnYSc6IDMsICdiJzogNiwgJ2MnOiA5IH1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB0cmFuc2Zvcm0ob2JqZWN0LCBjYWxsYmFjaywgYWNjdW11bGF0b3IsIHRoaXNBcmcpIHtcbiAgICAgIHZhciBpc0FyciA9IGlzQXJyYXkob2JqZWN0KTtcbiAgICAgIGlmIChhY2N1bXVsYXRvciA9PSBudWxsKSB7XG4gICAgICAgIGlmIChpc0Fycikge1xuICAgICAgICAgIGFjY3VtdWxhdG9yID0gW107XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIGN0b3IgPSBvYmplY3QgJiYgb2JqZWN0LmNvbnN0cnVjdG9yLFxuICAgICAgICAgICAgICBwcm90byA9IGN0b3IgJiYgY3Rvci5wcm90b3R5cGU7XG5cbiAgICAgICAgICBhY2N1bXVsYXRvciA9IGJhc2VDcmVhdGUocHJvdG8pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgY2FsbGJhY2sgPSBsb2Rhc2guY3JlYXRlQ2FsbGJhY2soY2FsbGJhY2ssIHRoaXNBcmcsIDQpO1xuICAgICAgICAoaXNBcnIgPyBmb3JFYWNoIDogZm9yT3duKShvYmplY3QsIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgb2JqZWN0KSB7XG4gICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKGFjY3VtdWxhdG9yLCB2YWx1ZSwgaW5kZXgsIG9iamVjdCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGFjY3VtdWxhdG9yO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gYXJyYXkgY29tcG9zZWQgb2YgdGhlIG93biBlbnVtZXJhYmxlIHByb3BlcnR5IHZhbHVlcyBvZiBgb2JqZWN0YC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBPYmplY3RzXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIGluc3BlY3QuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIGFuIGFycmF5IG9mIHByb3BlcnR5IHZhbHVlcy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy52YWx1ZXMoeyAnb25lJzogMSwgJ3R3byc6IDIsICd0aHJlZSc6IDMgfSk7XG4gICAgICogLy8gPT4gWzEsIDIsIDNdIChwcm9wZXJ0eSBvcmRlciBpcyBub3QgZ3VhcmFudGVlZCBhY3Jvc3MgZW52aXJvbm1lbnRzKVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHZhbHVlcyhvYmplY3QpIHtcbiAgICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICAgIHByb3BzID0ga2V5cyhvYmplY3QpLFxuICAgICAgICAgIGxlbmd0aCA9IHByb3BzLmxlbmd0aCxcbiAgICAgICAgICByZXN1bHQgPSBBcnJheShsZW5ndGgpO1xuXG4gICAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgICByZXN1bHRbaW5kZXhdID0gb2JqZWN0W3Byb3BzW2luZGV4XV07XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBhcnJheSBvZiBlbGVtZW50cyBmcm9tIHRoZSBzcGVjaWZpZWQgaW5kZXhlcywgb3Iga2V5cywgb2YgdGhlXG4gICAgICogYGNvbGxlY3Rpb25gLiBJbmRleGVzIG1heSBiZSBzcGVjaWZpZWQgYXMgaW5kaXZpZHVhbCBhcmd1bWVudHMgb3IgYXMgYXJyYXlzXG4gICAgICogb2YgaW5kZXhlcy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBDb2xsZWN0aW9uc1xuICAgICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fHN0cmluZ30gY29sbGVjdGlvbiBUaGUgY29sbGVjdGlvbiB0byBpdGVyYXRlIG92ZXIuXG4gICAgICogQHBhcmFtIHsuLi4obnVtYmVyfG51bWJlcltdfHN0cmluZ3xzdHJpbmdbXSl9IFtpbmRleF0gVGhlIGluZGV4ZXMgb2YgYGNvbGxlY3Rpb25gXG4gICAgICogICB0byByZXRyaWV2ZSwgc3BlY2lmaWVkIGFzIGluZGl2aWR1YWwgaW5kZXhlcyBvciBhcnJheXMgb2YgaW5kZXhlcy5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgYSBuZXcgYXJyYXkgb2YgZWxlbWVudHMgY29ycmVzcG9uZGluZyB0byB0aGVcbiAgICAgKiAgcHJvdmlkZWQgaW5kZXhlcy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5hdChbJ2EnLCAnYicsICdjJywgJ2QnLCAnZSddLCBbMCwgMiwgNF0pO1xuICAgICAqIC8vID0+IFsnYScsICdjJywgJ2UnXVxuICAgICAqXG4gICAgICogXy5hdChbJ2ZyZWQnLCAnYmFybmV5JywgJ3BlYmJsZXMnXSwgMCwgMik7XG4gICAgICogLy8gPT4gWydmcmVkJywgJ3BlYmJsZXMnXVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGF0KGNvbGxlY3Rpb24pIHtcbiAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzLFxuICAgICAgICAgIGluZGV4ID0gLTEsXG4gICAgICAgICAgcHJvcHMgPSBiYXNlRmxhdHRlbihhcmdzLCB0cnVlLCBmYWxzZSwgMSksXG4gICAgICAgICAgbGVuZ3RoID0gKGFyZ3NbMl0gJiYgYXJnc1syXVthcmdzWzFdXSA9PT0gY29sbGVjdGlvbikgPyAxIDogcHJvcHMubGVuZ3RoLFxuICAgICAgICAgIHJlc3VsdCA9IEFycmF5KGxlbmd0aCk7XG5cbiAgICAgIHdoaWxlKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgcmVzdWx0W2luZGV4XSA9IGNvbGxlY3Rpb25bcHJvcHNbaW5kZXhdXTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGEgZ2l2ZW4gdmFsdWUgaXMgcHJlc2VudCBpbiBhIGNvbGxlY3Rpb24gdXNpbmcgc3RyaWN0IGVxdWFsaXR5XG4gICAgICogZm9yIGNvbXBhcmlzb25zLCBpLmUuIGA9PT1gLiBJZiBgZnJvbUluZGV4YCBpcyBuZWdhdGl2ZSwgaXQgaXMgdXNlZCBhcyB0aGVcbiAgICAgKiBvZmZzZXQgZnJvbSB0aGUgZW5kIG9mIHRoZSBjb2xsZWN0aW9uLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGFsaWFzIGluY2x1ZGVcbiAgICAgKiBAY2F0ZWdvcnkgQ29sbGVjdGlvbnNcbiAgICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdHxzdHJpbmd9IGNvbGxlY3Rpb24gVGhlIGNvbGxlY3Rpb24gdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEBwYXJhbSB7Kn0gdGFyZ2V0IFRoZSB2YWx1ZSB0byBjaGVjayBmb3IuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtmcm9tSW5kZXg9MF0gVGhlIGluZGV4IHRvIHNlYXJjaCBmcm9tLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgYHRhcmdldGAgZWxlbWVudCBpcyBmb3VuZCwgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmNvbnRhaW5zKFsxLCAyLCAzXSwgMSk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogXy5jb250YWlucyhbMSwgMiwgM10sIDEsIDIpO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICpcbiAgICAgKiBfLmNvbnRhaW5zKHsgJ25hbWUnOiAnZnJlZCcsICdhZ2UnOiA0MCB9LCAnZnJlZCcpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uY29udGFpbnMoJ3BlYmJsZXMnLCAnZWInKTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICovXG4gICAgZnVuY3Rpb24gY29udGFpbnMoY29sbGVjdGlvbiwgdGFyZ2V0LCBmcm9tSW5kZXgpIHtcbiAgICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICAgIGluZGV4T2YgPSBnZXRJbmRleE9mKCksXG4gICAgICAgICAgbGVuZ3RoID0gY29sbGVjdGlvbiA/IGNvbGxlY3Rpb24ubGVuZ3RoIDogMCxcbiAgICAgICAgICByZXN1bHQgPSBmYWxzZTtcblxuICAgICAgZnJvbUluZGV4ID0gKGZyb21JbmRleCA8IDAgPyBuYXRpdmVNYXgoMCwgbGVuZ3RoICsgZnJvbUluZGV4KSA6IGZyb21JbmRleCkgfHwgMDtcbiAgICAgIGlmIChpc0FycmF5KGNvbGxlY3Rpb24pKSB7XG4gICAgICAgIHJlc3VsdCA9IGluZGV4T2YoY29sbGVjdGlvbiwgdGFyZ2V0LCBmcm9tSW5kZXgpID4gLTE7XG4gICAgICB9IGVsc2UgaWYgKHR5cGVvZiBsZW5ndGggPT0gJ251bWJlcicpIHtcbiAgICAgICAgcmVzdWx0ID0gKGlzU3RyaW5nKGNvbGxlY3Rpb24pID8gY29sbGVjdGlvbi5pbmRleE9mKHRhcmdldCwgZnJvbUluZGV4KSA6IGluZGV4T2YoY29sbGVjdGlvbiwgdGFyZ2V0LCBmcm9tSW5kZXgpKSA+IC0xO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZm9yT3duKGNvbGxlY3Rpb24sIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgaWYgKCsraW5kZXggPj0gZnJvbUluZGV4KSB7XG4gICAgICAgICAgICByZXR1cm4gIShyZXN1bHQgPSB2YWx1ZSA9PT0gdGFyZ2V0KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIG9iamVjdCBjb21wb3NlZCBvZiBrZXlzIGdlbmVyYXRlZCBmcm9tIHRoZSByZXN1bHRzIG9mIHJ1bm5pbmdcbiAgICAgKiBlYWNoIGVsZW1lbnQgb2YgYGNvbGxlY3Rpb25gIHRocm91Z2ggdGhlIGNhbGxiYWNrLiBUaGUgY29ycmVzcG9uZGluZyB2YWx1ZVxuICAgICAqIG9mIGVhY2gga2V5IGlzIHRoZSBudW1iZXIgb2YgdGltZXMgdGhlIGtleSB3YXMgcmV0dXJuZWQgYnkgdGhlIGNhbGxiYWNrLlxuICAgICAqIFRoZSBjYWxsYmFjayBpcyBib3VuZCB0byBgdGhpc0FyZ2AgYW5kIGludm9rZWQgd2l0aCB0aHJlZSBhcmd1bWVudHM7XG4gICAgICogKHZhbHVlLCBpbmRleHxrZXksIGNvbGxlY3Rpb24pLlxuICAgICAqXG4gICAgICogSWYgYSBwcm9wZXJ0eSBuYW1lIGlzIHByb3ZpZGVkIGZvciBgY2FsbGJhY2tgIHRoZSBjcmVhdGVkIFwiXy5wbHVja1wiIHN0eWxlXG4gICAgICogY2FsbGJhY2sgd2lsbCByZXR1cm4gdGhlIHByb3BlcnR5IHZhbHVlIG9mIHRoZSBnaXZlbiBlbGVtZW50LlxuICAgICAqXG4gICAgICogSWYgYW4gb2JqZWN0IGlzIHByb3ZpZGVkIGZvciBgY2FsbGJhY2tgIHRoZSBjcmVhdGVkIFwiXy53aGVyZVwiIHN0eWxlIGNhbGxiYWNrXG4gICAgICogd2lsbCByZXR1cm4gYHRydWVgIGZvciBlbGVtZW50cyB0aGF0IGhhdmUgdGhlIHByb3BlcnRpZXMgb2YgdGhlIGdpdmVuIG9iamVjdCxcbiAgICAgKiBlbHNlIGBmYWxzZWAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgQ29sbGVjdGlvbnNcbiAgICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdHxzdHJpbmd9IGNvbGxlY3Rpb24gVGhlIGNvbGxlY3Rpb24gdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb258T2JqZWN0fHN0cmluZ30gW2NhbGxiYWNrPWlkZW50aXR5XSBUaGUgZnVuY3Rpb24gY2FsbGVkXG4gICAgICogIHBlciBpdGVyYXRpb24uIElmIGEgcHJvcGVydHkgbmFtZSBvciBvYmplY3QgaXMgcHJvdmlkZWQgaXQgd2lsbCBiZSB1c2VkXG4gICAgICogIHRvIGNyZWF0ZSBhIFwiXy5wbHVja1wiIG9yIFwiXy53aGVyZVwiIHN0eWxlIGNhbGxiYWNrLCByZXNwZWN0aXZlbHkuXG4gICAgICogQHBhcmFtIHsqfSBbdGhpc0FyZ10gVGhlIGB0aGlzYCBiaW5kaW5nIG9mIGBjYWxsYmFja2AuXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyB0aGUgY29tcG9zZWQgYWdncmVnYXRlIG9iamVjdC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5jb3VudEJ5KFs0LjMsIDYuMSwgNi40XSwgZnVuY3Rpb24obnVtKSB7IHJldHVybiBNYXRoLmZsb29yKG51bSk7IH0pO1xuICAgICAqIC8vID0+IHsgJzQnOiAxLCAnNic6IDIgfVxuICAgICAqXG4gICAgICogXy5jb3VudEJ5KFs0LjMsIDYuMSwgNi40XSwgZnVuY3Rpb24obnVtKSB7IHJldHVybiB0aGlzLmZsb29yKG51bSk7IH0sIE1hdGgpO1xuICAgICAqIC8vID0+IHsgJzQnOiAxLCAnNic6IDIgfVxuICAgICAqXG4gICAgICogXy5jb3VudEJ5KFsnb25lJywgJ3R3bycsICd0aHJlZSddLCAnbGVuZ3RoJyk7XG4gICAgICogLy8gPT4geyAnMyc6IDIsICc1JzogMSB9XG4gICAgICovXG4gICAgdmFyIGNvdW50QnkgPSBjcmVhdGVBZ2dyZWdhdG9yKGZ1bmN0aW9uKHJlc3VsdCwgdmFsdWUsIGtleSkge1xuICAgICAgKGhhc093blByb3BlcnR5LmNhbGwocmVzdWx0LCBrZXkpID8gcmVzdWx0W2tleV0rKyA6IHJlc3VsdFtrZXldID0gMSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgdGhlIGdpdmVuIGNhbGxiYWNrIHJldHVybnMgdHJ1ZXkgdmFsdWUgZm9yICoqYWxsKiogZWxlbWVudHMgb2ZcbiAgICAgKiBhIGNvbGxlY3Rpb24uIFRoZSBjYWxsYmFjayBpcyBib3VuZCB0byBgdGhpc0FyZ2AgYW5kIGludm9rZWQgd2l0aCB0aHJlZVxuICAgICAqIGFyZ3VtZW50czsgKHZhbHVlLCBpbmRleHxrZXksIGNvbGxlY3Rpb24pLlxuICAgICAqXG4gICAgICogSWYgYSBwcm9wZXJ0eSBuYW1lIGlzIHByb3ZpZGVkIGZvciBgY2FsbGJhY2tgIHRoZSBjcmVhdGVkIFwiXy5wbHVja1wiIHN0eWxlXG4gICAgICogY2FsbGJhY2sgd2lsbCByZXR1cm4gdGhlIHByb3BlcnR5IHZhbHVlIG9mIHRoZSBnaXZlbiBlbGVtZW50LlxuICAgICAqXG4gICAgICogSWYgYW4gb2JqZWN0IGlzIHByb3ZpZGVkIGZvciBgY2FsbGJhY2tgIHRoZSBjcmVhdGVkIFwiXy53aGVyZVwiIHN0eWxlIGNhbGxiYWNrXG4gICAgICogd2lsbCByZXR1cm4gYHRydWVgIGZvciBlbGVtZW50cyB0aGF0IGhhdmUgdGhlIHByb3BlcnRpZXMgb2YgdGhlIGdpdmVuIG9iamVjdCxcbiAgICAgKiBlbHNlIGBmYWxzZWAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAYWxpYXMgYWxsXG4gICAgICogQGNhdGVnb3J5IENvbGxlY3Rpb25zXG4gICAgICogQHBhcmFtIHtBcnJheXxPYmplY3R8c3RyaW5nfSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufE9iamVjdHxzdHJpbmd9IFtjYWxsYmFjaz1pZGVudGl0eV0gVGhlIGZ1bmN0aW9uIGNhbGxlZFxuICAgICAqICBwZXIgaXRlcmF0aW9uLiBJZiBhIHByb3BlcnR5IG5hbWUgb3Igb2JqZWN0IGlzIHByb3ZpZGVkIGl0IHdpbGwgYmUgdXNlZFxuICAgICAqICB0byBjcmVhdGUgYSBcIl8ucGx1Y2tcIiBvciBcIl8ud2hlcmVcIiBzdHlsZSBjYWxsYmFjaywgcmVzcGVjdGl2ZWx5LlxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgY2FsbGJhY2tgLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBhbGwgZWxlbWVudHMgcGFzc2VkIHRoZSBjYWxsYmFjayBjaGVjayxcbiAgICAgKiAgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmV2ZXJ5KFt0cnVlLCAxLCBudWxsLCAneWVzJ10pO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICpcbiAgICAgKiB2YXIgY2hhcmFjdGVycyA9IFtcbiAgICAgKiAgIHsgJ25hbWUnOiAnYmFybmV5JywgJ2FnZSc6IDM2IH0sXG4gICAgICogICB7ICduYW1lJzogJ2ZyZWQnLCAgICdhZ2UnOiA0MCB9XG4gICAgICogXTtcbiAgICAgKlxuICAgICAqIC8vIHVzaW5nIFwiXy5wbHVja1wiIGNhbGxiYWNrIHNob3J0aGFuZFxuICAgICAqIF8uZXZlcnkoY2hhcmFjdGVycywgJ2FnZScpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIC8vIHVzaW5nIFwiXy53aGVyZVwiIGNhbGxiYWNrIHNob3J0aGFuZFxuICAgICAqIF8uZXZlcnkoY2hhcmFjdGVycywgeyAnYWdlJzogMzYgfSk7XG4gICAgICogLy8gPT4gZmFsc2VcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBldmVyeShjb2xsZWN0aW9uLCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgdmFyIHJlc3VsdCA9IHRydWU7XG4gICAgICBjYWxsYmFjayA9IGxvZGFzaC5jcmVhdGVDYWxsYmFjayhjYWxsYmFjaywgdGhpc0FyZywgMyk7XG5cbiAgICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICAgIGxlbmd0aCA9IGNvbGxlY3Rpb24gPyBjb2xsZWN0aW9uLmxlbmd0aCA6IDA7XG5cbiAgICAgIGlmICh0eXBlb2YgbGVuZ3RoID09ICdudW1iZXInKSB7XG4gICAgICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgICAgaWYgKCEocmVzdWx0ID0gISFjYWxsYmFjayhjb2xsZWN0aW9uW2luZGV4XSwgaW5kZXgsIGNvbGxlY3Rpb24pKSkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmb3JPd24oY29sbGVjdGlvbiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBjb2xsZWN0aW9uKSB7XG4gICAgICAgICAgcmV0dXJuIChyZXN1bHQgPSAhIWNhbGxiYWNrKHZhbHVlLCBpbmRleCwgY29sbGVjdGlvbikpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSXRlcmF0ZXMgb3ZlciBlbGVtZW50cyBvZiBhIGNvbGxlY3Rpb24sIHJldHVybmluZyBhbiBhcnJheSBvZiBhbGwgZWxlbWVudHNcbiAgICAgKiB0aGUgY2FsbGJhY2sgcmV0dXJucyB0cnVleSBmb3IuIFRoZSBjYWxsYmFjayBpcyBib3VuZCB0byBgdGhpc0FyZ2AgYW5kXG4gICAgICogaW52b2tlZCB3aXRoIHRocmVlIGFyZ3VtZW50czsgKHZhbHVlLCBpbmRleHxrZXksIGNvbGxlY3Rpb24pLlxuICAgICAqXG4gICAgICogSWYgYSBwcm9wZXJ0eSBuYW1lIGlzIHByb3ZpZGVkIGZvciBgY2FsbGJhY2tgIHRoZSBjcmVhdGVkIFwiXy5wbHVja1wiIHN0eWxlXG4gICAgICogY2FsbGJhY2sgd2lsbCByZXR1cm4gdGhlIHByb3BlcnR5IHZhbHVlIG9mIHRoZSBnaXZlbiBlbGVtZW50LlxuICAgICAqXG4gICAgICogSWYgYW4gb2JqZWN0IGlzIHByb3ZpZGVkIGZvciBgY2FsbGJhY2tgIHRoZSBjcmVhdGVkIFwiXy53aGVyZVwiIHN0eWxlIGNhbGxiYWNrXG4gICAgICogd2lsbCByZXR1cm4gYHRydWVgIGZvciBlbGVtZW50cyB0aGF0IGhhdmUgdGhlIHByb3BlcnRpZXMgb2YgdGhlIGdpdmVuIG9iamVjdCxcbiAgICAgKiBlbHNlIGBmYWxzZWAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAYWxpYXMgc2VsZWN0XG4gICAgICogQGNhdGVnb3J5IENvbGxlY3Rpb25zXG4gICAgICogQHBhcmFtIHtBcnJheXxPYmplY3R8c3RyaW5nfSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufE9iamVjdHxzdHJpbmd9IFtjYWxsYmFjaz1pZGVudGl0eV0gVGhlIGZ1bmN0aW9uIGNhbGxlZFxuICAgICAqICBwZXIgaXRlcmF0aW9uLiBJZiBhIHByb3BlcnR5IG5hbWUgb3Igb2JqZWN0IGlzIHByb3ZpZGVkIGl0IHdpbGwgYmUgdXNlZFxuICAgICAqICB0byBjcmVhdGUgYSBcIl8ucGx1Y2tcIiBvciBcIl8ud2hlcmVcIiBzdHlsZSBjYWxsYmFjaywgcmVzcGVjdGl2ZWx5LlxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgY2FsbGJhY2tgLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyBhIG5ldyBhcnJheSBvZiBlbGVtZW50cyB0aGF0IHBhc3NlZCB0aGUgY2FsbGJhY2sgY2hlY2suXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBldmVucyA9IF8uZmlsdGVyKFsxLCAyLCAzLCA0LCA1LCA2XSwgZnVuY3Rpb24obnVtKSB7IHJldHVybiBudW0gJSAyID09IDA7IH0pO1xuICAgICAqIC8vID0+IFsyLCA0LCA2XVxuICAgICAqXG4gICAgICogdmFyIGNoYXJhY3RlcnMgPSBbXG4gICAgICogICB7ICduYW1lJzogJ2Jhcm5leScsICdhZ2UnOiAzNiwgJ2Jsb2NrZWQnOiBmYWxzZSB9LFxuICAgICAqICAgeyAnbmFtZSc6ICdmcmVkJywgICAnYWdlJzogNDAsICdibG9ja2VkJzogdHJ1ZSB9XG4gICAgICogXTtcbiAgICAgKlxuICAgICAqIC8vIHVzaW5nIFwiXy5wbHVja1wiIGNhbGxiYWNrIHNob3J0aGFuZFxuICAgICAqIF8uZmlsdGVyKGNoYXJhY3RlcnMsICdibG9ja2VkJyk7XG4gICAgICogLy8gPT4gW3sgJ25hbWUnOiAnZnJlZCcsICdhZ2UnOiA0MCwgJ2Jsb2NrZWQnOiB0cnVlIH1dXG4gICAgICpcbiAgICAgKiAvLyB1c2luZyBcIl8ud2hlcmVcIiBjYWxsYmFjayBzaG9ydGhhbmRcbiAgICAgKiBfLmZpbHRlcihjaGFyYWN0ZXJzLCB7ICdhZ2UnOiAzNiB9KTtcbiAgICAgKiAvLyA9PiBbeyAnbmFtZSc6ICdiYXJuZXknLCAnYWdlJzogMzYsICdibG9ja2VkJzogZmFsc2UgfV1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBmaWx0ZXIoY29sbGVjdGlvbiwgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgIGNhbGxiYWNrID0gbG9kYXNoLmNyZWF0ZUNhbGxiYWNrKGNhbGxiYWNrLCB0aGlzQXJnLCAzKTtcblxuICAgICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgICAgbGVuZ3RoID0gY29sbGVjdGlvbiA/IGNvbGxlY3Rpb24ubGVuZ3RoIDogMDtcblxuICAgICAgaWYgKHR5cGVvZiBsZW5ndGggPT0gJ251bWJlcicpIHtcbiAgICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgICB2YXIgdmFsdWUgPSBjb2xsZWN0aW9uW2luZGV4XTtcbiAgICAgICAgICBpZiAoY2FsbGJhY2sodmFsdWUsIGluZGV4LCBjb2xsZWN0aW9uKSkge1xuICAgICAgICAgICAgcmVzdWx0LnB1c2godmFsdWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZm9yT3duKGNvbGxlY3Rpb24sIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgY29sbGVjdGlvbikge1xuICAgICAgICAgIGlmIChjYWxsYmFjayh2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pKSB7XG4gICAgICAgICAgICByZXN1bHQucHVzaCh2YWx1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSXRlcmF0ZXMgb3ZlciBlbGVtZW50cyBvZiBhIGNvbGxlY3Rpb24sIHJldHVybmluZyB0aGUgZmlyc3QgZWxlbWVudCB0aGF0XG4gICAgICogdGhlIGNhbGxiYWNrIHJldHVybnMgdHJ1ZXkgZm9yLiBUaGUgY2FsbGJhY2sgaXMgYm91bmQgdG8gYHRoaXNBcmdgIGFuZFxuICAgICAqIGludm9rZWQgd2l0aCB0aHJlZSBhcmd1bWVudHM7ICh2YWx1ZSwgaW5kZXh8a2V5LCBjb2xsZWN0aW9uKS5cbiAgICAgKlxuICAgICAqIElmIGEgcHJvcGVydHkgbmFtZSBpcyBwcm92aWRlZCBmb3IgYGNhbGxiYWNrYCB0aGUgY3JlYXRlZCBcIl8ucGx1Y2tcIiBzdHlsZVxuICAgICAqIGNhbGxiYWNrIHdpbGwgcmV0dXJuIHRoZSBwcm9wZXJ0eSB2YWx1ZSBvZiB0aGUgZ2l2ZW4gZWxlbWVudC5cbiAgICAgKlxuICAgICAqIElmIGFuIG9iamVjdCBpcyBwcm92aWRlZCBmb3IgYGNhbGxiYWNrYCB0aGUgY3JlYXRlZCBcIl8ud2hlcmVcIiBzdHlsZSBjYWxsYmFja1xuICAgICAqIHdpbGwgcmV0dXJuIGB0cnVlYCBmb3IgZWxlbWVudHMgdGhhdCBoYXZlIHRoZSBwcm9wZXJ0aWVzIG9mIHRoZSBnaXZlbiBvYmplY3QsXG4gICAgICogZWxzZSBgZmFsc2VgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGFsaWFzIGRldGVjdCwgZmluZFdoZXJlXG4gICAgICogQGNhdGVnb3J5IENvbGxlY3Rpb25zXG4gICAgICogQHBhcmFtIHtBcnJheXxPYmplY3R8c3RyaW5nfSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufE9iamVjdHxzdHJpbmd9IFtjYWxsYmFjaz1pZGVudGl0eV0gVGhlIGZ1bmN0aW9uIGNhbGxlZFxuICAgICAqICBwZXIgaXRlcmF0aW9uLiBJZiBhIHByb3BlcnR5IG5hbWUgb3Igb2JqZWN0IGlzIHByb3ZpZGVkIGl0IHdpbGwgYmUgdXNlZFxuICAgICAqICB0byBjcmVhdGUgYSBcIl8ucGx1Y2tcIiBvciBcIl8ud2hlcmVcIiBzdHlsZSBjYWxsYmFjaywgcmVzcGVjdGl2ZWx5LlxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgY2FsbGJhY2tgLlxuICAgICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSBmb3VuZCBlbGVtZW50LCBlbHNlIGB1bmRlZmluZWRgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgY2hhcmFjdGVycyA9IFtcbiAgICAgKiAgIHsgJ25hbWUnOiAnYmFybmV5JywgICdhZ2UnOiAzNiwgJ2Jsb2NrZWQnOiBmYWxzZSB9LFxuICAgICAqICAgeyAnbmFtZSc6ICdmcmVkJywgICAgJ2FnZSc6IDQwLCAnYmxvY2tlZCc6IHRydWUgfSxcbiAgICAgKiAgIHsgJ25hbWUnOiAncGViYmxlcycsICdhZ2UnOiAxLCAgJ2Jsb2NrZWQnOiBmYWxzZSB9XG4gICAgICogXTtcbiAgICAgKlxuICAgICAqIF8uZmluZChjaGFyYWN0ZXJzLCBmdW5jdGlvbihjaHIpIHtcbiAgICAgKiAgIHJldHVybiBjaHIuYWdlIDwgNDA7XG4gICAgICogfSk7XG4gICAgICogLy8gPT4geyAnbmFtZSc6ICdiYXJuZXknLCAnYWdlJzogMzYsICdibG9ja2VkJzogZmFsc2UgfVxuICAgICAqXG4gICAgICogLy8gdXNpbmcgXCJfLndoZXJlXCIgY2FsbGJhY2sgc2hvcnRoYW5kXG4gICAgICogXy5maW5kKGNoYXJhY3RlcnMsIHsgJ2FnZSc6IDEgfSk7XG4gICAgICogLy8gPT4gIHsgJ25hbWUnOiAncGViYmxlcycsICdhZ2UnOiAxLCAnYmxvY2tlZCc6IGZhbHNlIH1cbiAgICAgKlxuICAgICAqIC8vIHVzaW5nIFwiXy5wbHVja1wiIGNhbGxiYWNrIHNob3J0aGFuZFxuICAgICAqIF8uZmluZChjaGFyYWN0ZXJzLCAnYmxvY2tlZCcpO1xuICAgICAqIC8vID0+IHsgJ25hbWUnOiAnZnJlZCcsICdhZ2UnOiA0MCwgJ2Jsb2NrZWQnOiB0cnVlIH1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBmaW5kKGNvbGxlY3Rpb24sIGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgICBjYWxsYmFjayA9IGxvZGFzaC5jcmVhdGVDYWxsYmFjayhjYWxsYmFjaywgdGhpc0FyZywgMyk7XG5cbiAgICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICAgIGxlbmd0aCA9IGNvbGxlY3Rpb24gPyBjb2xsZWN0aW9uLmxlbmd0aCA6IDA7XG5cbiAgICAgIGlmICh0eXBlb2YgbGVuZ3RoID09ICdudW1iZXInKSB7XG4gICAgICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgICAgdmFyIHZhbHVlID0gY29sbGVjdGlvbltpbmRleF07XG4gICAgICAgICAgaWYgKGNhbGxiYWNrKHZhbHVlLCBpbmRleCwgY29sbGVjdGlvbikpIHtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciByZXN1bHQ7XG4gICAgICAgIGZvck93bihjb2xsZWN0aW9uLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pIHtcbiAgICAgICAgICBpZiAoY2FsbGJhY2sodmFsdWUsIGluZGV4LCBjb2xsZWN0aW9uKSkge1xuICAgICAgICAgICAgcmVzdWx0ID0gdmFsdWU7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBsaWtlIGBfLmZpbmRgIGV4Y2VwdCB0aGF0IGl0IGl0ZXJhdGVzIG92ZXIgZWxlbWVudHNcbiAgICAgKiBvZiBhIGBjb2xsZWN0aW9uYCBmcm9tIHJpZ2h0IHRvIGxlZnQuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgQ29sbGVjdGlvbnNcbiAgICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdHxzdHJpbmd9IGNvbGxlY3Rpb24gVGhlIGNvbGxlY3Rpb24gdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb258T2JqZWN0fHN0cmluZ30gW2NhbGxiYWNrPWlkZW50aXR5XSBUaGUgZnVuY3Rpb24gY2FsbGVkXG4gICAgICogIHBlciBpdGVyYXRpb24uIElmIGEgcHJvcGVydHkgbmFtZSBvciBvYmplY3QgaXMgcHJvdmlkZWQgaXQgd2lsbCBiZSB1c2VkXG4gICAgICogIHRvIGNyZWF0ZSBhIFwiXy5wbHVja1wiIG9yIFwiXy53aGVyZVwiIHN0eWxlIGNhbGxiYWNrLCByZXNwZWN0aXZlbHkuXG4gICAgICogQHBhcmFtIHsqfSBbdGhpc0FyZ10gVGhlIGB0aGlzYCBiaW5kaW5nIG9mIGBjYWxsYmFja2AuXG4gICAgICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIGZvdW5kIGVsZW1lbnQsIGVsc2UgYHVuZGVmaW5lZGAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uZmluZExhc3QoWzEsIDIsIDMsIDRdLCBmdW5jdGlvbihudW0pIHtcbiAgICAgKiAgIHJldHVybiBudW0gJSAyID09IDE7XG4gICAgICogfSk7XG4gICAgICogLy8gPT4gM1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGZpbmRMYXN0KGNvbGxlY3Rpb24sIGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgICB2YXIgcmVzdWx0O1xuICAgICAgY2FsbGJhY2sgPSBsb2Rhc2guY3JlYXRlQ2FsbGJhY2soY2FsbGJhY2ssIHRoaXNBcmcsIDMpO1xuICAgICAgZm9yRWFjaFJpZ2h0KGNvbGxlY3Rpb24sIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgY29sbGVjdGlvbikge1xuICAgICAgICBpZiAoY2FsbGJhY2sodmFsdWUsIGluZGV4LCBjb2xsZWN0aW9uKSkge1xuICAgICAgICAgIHJlc3VsdCA9IHZhbHVlO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEl0ZXJhdGVzIG92ZXIgZWxlbWVudHMgb2YgYSBjb2xsZWN0aW9uLCBleGVjdXRpbmcgdGhlIGNhbGxiYWNrIGZvciBlYWNoXG4gICAgICogZWxlbWVudC4gVGhlIGNhbGxiYWNrIGlzIGJvdW5kIHRvIGB0aGlzQXJnYCBhbmQgaW52b2tlZCB3aXRoIHRocmVlIGFyZ3VtZW50cztcbiAgICAgKiAodmFsdWUsIGluZGV4fGtleSwgY29sbGVjdGlvbikuIENhbGxiYWNrcyBtYXkgZXhpdCBpdGVyYXRpb24gZWFybHkgYnlcbiAgICAgKiBleHBsaWNpdGx5IHJldHVybmluZyBgZmFsc2VgLlxuICAgICAqXG4gICAgICogTm90ZTogQXMgd2l0aCBvdGhlciBcIkNvbGxlY3Rpb25zXCIgbWV0aG9kcywgb2JqZWN0cyB3aXRoIGEgYGxlbmd0aGAgcHJvcGVydHlcbiAgICAgKiBhcmUgaXRlcmF0ZWQgbGlrZSBhcnJheXMuIFRvIGF2b2lkIHRoaXMgYmVoYXZpb3IgYF8uZm9ySW5gIG9yIGBfLmZvck93bmBcbiAgICAgKiBtYXkgYmUgdXNlZCBmb3Igb2JqZWN0IGl0ZXJhdGlvbi5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBhbGlhcyBlYWNoXG4gICAgICogQGNhdGVnb3J5IENvbGxlY3Rpb25zXG4gICAgICogQHBhcmFtIHtBcnJheXxPYmplY3R8c3RyaW5nfSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY2FsbGJhY2s9aWRlbnRpdHldIFRoZSBmdW5jdGlvbiBjYWxsZWQgcGVyIGl0ZXJhdGlvbi5cbiAgICAgKiBAcGFyYW0geyp9IFt0aGlzQXJnXSBUaGUgYHRoaXNgIGJpbmRpbmcgb2YgYGNhbGxiYWNrYC5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl8T2JqZWN0fHN0cmluZ30gUmV0dXJucyBgY29sbGVjdGlvbmAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8oWzEsIDIsIDNdKS5mb3JFYWNoKGZ1bmN0aW9uKG51bSkgeyBjb25zb2xlLmxvZyhudW0pOyB9KS5qb2luKCcsJyk7XG4gICAgICogLy8gPT4gbG9ncyBlYWNoIG51bWJlciBhbmQgcmV0dXJucyAnMSwyLDMnXG4gICAgICpcbiAgICAgKiBfLmZvckVhY2goeyAnb25lJzogMSwgJ3R3byc6IDIsICd0aHJlZSc6IDMgfSwgZnVuY3Rpb24obnVtKSB7IGNvbnNvbGUubG9nKG51bSk7IH0pO1xuICAgICAqIC8vID0+IGxvZ3MgZWFjaCBudW1iZXIgYW5kIHJldHVybnMgdGhlIG9iamVjdCAocHJvcGVydHkgb3JkZXIgaXMgbm90IGd1YXJhbnRlZWQgYWNyb3NzIGVudmlyb25tZW50cylcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBmb3JFYWNoKGNvbGxlY3Rpb24sIGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgICB2YXIgaW5kZXggPSAtMSxcbiAgICAgICAgICBsZW5ndGggPSBjb2xsZWN0aW9uID8gY29sbGVjdGlvbi5sZW5ndGggOiAwO1xuXG4gICAgICBjYWxsYmFjayA9IGNhbGxiYWNrICYmIHR5cGVvZiB0aGlzQXJnID09ICd1bmRlZmluZWQnID8gY2FsbGJhY2sgOiBiYXNlQ3JlYXRlQ2FsbGJhY2soY2FsbGJhY2ssIHRoaXNBcmcsIDMpO1xuICAgICAgaWYgKHR5cGVvZiBsZW5ndGggPT0gJ251bWJlcicpIHtcbiAgICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgICBpZiAoY2FsbGJhY2soY29sbGVjdGlvbltpbmRleF0sIGluZGV4LCBjb2xsZWN0aW9uKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZm9yT3duKGNvbGxlY3Rpb24sIGNhbGxiYWNrKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBjb2xsZWN0aW9uO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGxpa2UgYF8uZm9yRWFjaGAgZXhjZXB0IHRoYXQgaXQgaXRlcmF0ZXMgb3ZlciBlbGVtZW50c1xuICAgICAqIG9mIGEgYGNvbGxlY3Rpb25gIGZyb20gcmlnaHQgdG8gbGVmdC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBhbGlhcyBlYWNoUmlnaHRcbiAgICAgKiBAY2F0ZWdvcnkgQ29sbGVjdGlvbnNcbiAgICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdHxzdHJpbmd9IGNvbGxlY3Rpb24gVGhlIGNvbGxlY3Rpb24gdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjYWxsYmFjaz1pZGVudGl0eV0gVGhlIGZ1bmN0aW9uIGNhbGxlZCBwZXIgaXRlcmF0aW9uLlxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgY2FsbGJhY2tgLlxuICAgICAqIEByZXR1cm5zIHtBcnJheXxPYmplY3R8c3RyaW5nfSBSZXR1cm5zIGBjb2xsZWN0aW9uYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXyhbMSwgMiwgM10pLmZvckVhY2hSaWdodChmdW5jdGlvbihudW0pIHsgY29uc29sZS5sb2cobnVtKTsgfSkuam9pbignLCcpO1xuICAgICAqIC8vID0+IGxvZ3MgZWFjaCBudW1iZXIgZnJvbSByaWdodCB0byBsZWZ0IGFuZCByZXR1cm5zICczLDIsMSdcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBmb3JFYWNoUmlnaHQoY29sbGVjdGlvbiwgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgIHZhciBsZW5ndGggPSBjb2xsZWN0aW9uID8gY29sbGVjdGlvbi5sZW5ndGggOiAwO1xuICAgICAgY2FsbGJhY2sgPSBjYWxsYmFjayAmJiB0eXBlb2YgdGhpc0FyZyA9PSAndW5kZWZpbmVkJyA/IGNhbGxiYWNrIDogYmFzZUNyZWF0ZUNhbGxiYWNrKGNhbGxiYWNrLCB0aGlzQXJnLCAzKTtcbiAgICAgIGlmICh0eXBlb2YgbGVuZ3RoID09ICdudW1iZXInKSB7XG4gICAgICAgIHdoaWxlIChsZW5ndGgtLSkge1xuICAgICAgICAgIGlmIChjYWxsYmFjayhjb2xsZWN0aW9uW2xlbmd0aF0sIGxlbmd0aCwgY29sbGVjdGlvbikgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBwcm9wcyA9IGtleXMoY29sbGVjdGlvbik7XG4gICAgICAgIGxlbmd0aCA9IHByb3BzLmxlbmd0aDtcbiAgICAgICAgZm9yT3duKGNvbGxlY3Rpb24sIGZ1bmN0aW9uKHZhbHVlLCBrZXksIGNvbGxlY3Rpb24pIHtcbiAgICAgICAgICBrZXkgPSBwcm9wcyA/IHByb3BzWy0tbGVuZ3RoXSA6IC0tbGVuZ3RoO1xuICAgICAgICAgIHJldHVybiBjYWxsYmFjayhjb2xsZWN0aW9uW2tleV0sIGtleSwgY29sbGVjdGlvbik7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGNvbGxlY3Rpb247XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBvYmplY3QgY29tcG9zZWQgb2Yga2V5cyBnZW5lcmF0ZWQgZnJvbSB0aGUgcmVzdWx0cyBvZiBydW5uaW5nXG4gICAgICogZWFjaCBlbGVtZW50IG9mIGEgY29sbGVjdGlvbiB0aHJvdWdoIHRoZSBjYWxsYmFjay4gVGhlIGNvcnJlc3BvbmRpbmcgdmFsdWVcbiAgICAgKiBvZiBlYWNoIGtleSBpcyBhbiBhcnJheSBvZiB0aGUgZWxlbWVudHMgcmVzcG9uc2libGUgZm9yIGdlbmVyYXRpbmcgdGhlIGtleS5cbiAgICAgKiBUaGUgY2FsbGJhY2sgaXMgYm91bmQgdG8gYHRoaXNBcmdgIGFuZCBpbnZva2VkIHdpdGggdGhyZWUgYXJndW1lbnRzO1xuICAgICAqICh2YWx1ZSwgaW5kZXh8a2V5LCBjb2xsZWN0aW9uKS5cbiAgICAgKlxuICAgICAqIElmIGEgcHJvcGVydHkgbmFtZSBpcyBwcm92aWRlZCBmb3IgYGNhbGxiYWNrYCB0aGUgY3JlYXRlZCBcIl8ucGx1Y2tcIiBzdHlsZVxuICAgICAqIGNhbGxiYWNrIHdpbGwgcmV0dXJuIHRoZSBwcm9wZXJ0eSB2YWx1ZSBvZiB0aGUgZ2l2ZW4gZWxlbWVudC5cbiAgICAgKlxuICAgICAqIElmIGFuIG9iamVjdCBpcyBwcm92aWRlZCBmb3IgYGNhbGxiYWNrYCB0aGUgY3JlYXRlZCBcIl8ud2hlcmVcIiBzdHlsZSBjYWxsYmFja1xuICAgICAqIHdpbGwgcmV0dXJuIGB0cnVlYCBmb3IgZWxlbWVudHMgdGhhdCBoYXZlIHRoZSBwcm9wZXJ0aWVzIG9mIHRoZSBnaXZlbiBvYmplY3QsXG4gICAgICogZWxzZSBgZmFsc2VgXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgQ29sbGVjdGlvbnNcbiAgICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdHxzdHJpbmd9IGNvbGxlY3Rpb24gVGhlIGNvbGxlY3Rpb24gdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb258T2JqZWN0fHN0cmluZ30gW2NhbGxiYWNrPWlkZW50aXR5XSBUaGUgZnVuY3Rpb24gY2FsbGVkXG4gICAgICogIHBlciBpdGVyYXRpb24uIElmIGEgcHJvcGVydHkgbmFtZSBvciBvYmplY3QgaXMgcHJvdmlkZWQgaXQgd2lsbCBiZSB1c2VkXG4gICAgICogIHRvIGNyZWF0ZSBhIFwiXy5wbHVja1wiIG9yIFwiXy53aGVyZVwiIHN0eWxlIGNhbGxiYWNrLCByZXNwZWN0aXZlbHkuXG4gICAgICogQHBhcmFtIHsqfSBbdGhpc0FyZ10gVGhlIGB0aGlzYCBiaW5kaW5nIG9mIGBjYWxsYmFja2AuXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyB0aGUgY29tcG9zZWQgYWdncmVnYXRlIG9iamVjdC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5ncm91cEJ5KFs0LjIsIDYuMSwgNi40XSwgZnVuY3Rpb24obnVtKSB7IHJldHVybiBNYXRoLmZsb29yKG51bSk7IH0pO1xuICAgICAqIC8vID0+IHsgJzQnOiBbNC4yXSwgJzYnOiBbNi4xLCA2LjRdIH1cbiAgICAgKlxuICAgICAqIF8uZ3JvdXBCeShbNC4yLCA2LjEsIDYuNF0sIGZ1bmN0aW9uKG51bSkgeyByZXR1cm4gdGhpcy5mbG9vcihudW0pOyB9LCBNYXRoKTtcbiAgICAgKiAvLyA9PiB7ICc0JzogWzQuMl0sICc2JzogWzYuMSwgNi40XSB9XG4gICAgICpcbiAgICAgKiAvLyB1c2luZyBcIl8ucGx1Y2tcIiBjYWxsYmFjayBzaG9ydGhhbmRcbiAgICAgKiBfLmdyb3VwQnkoWydvbmUnLCAndHdvJywgJ3RocmVlJ10sICdsZW5ndGgnKTtcbiAgICAgKiAvLyA9PiB7ICczJzogWydvbmUnLCAndHdvJ10sICc1JzogWyd0aHJlZSddIH1cbiAgICAgKi9cbiAgICB2YXIgZ3JvdXBCeSA9IGNyZWF0ZUFnZ3JlZ2F0b3IoZnVuY3Rpb24ocmVzdWx0LCB2YWx1ZSwga2V5KSB7XG4gICAgICAoaGFzT3duUHJvcGVydHkuY2FsbChyZXN1bHQsIGtleSkgPyByZXN1bHRba2V5XSA6IHJlc3VsdFtrZXldID0gW10pLnB1c2godmFsdWUpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBvYmplY3QgY29tcG9zZWQgb2Yga2V5cyBnZW5lcmF0ZWQgZnJvbSB0aGUgcmVzdWx0cyBvZiBydW5uaW5nXG4gICAgICogZWFjaCBlbGVtZW50IG9mIHRoZSBjb2xsZWN0aW9uIHRocm91Z2ggdGhlIGdpdmVuIGNhbGxiYWNrLiBUaGUgY29ycmVzcG9uZGluZ1xuICAgICAqIHZhbHVlIG9mIGVhY2gga2V5IGlzIHRoZSBsYXN0IGVsZW1lbnQgcmVzcG9uc2libGUgZm9yIGdlbmVyYXRpbmcgdGhlIGtleS5cbiAgICAgKiBUaGUgY2FsbGJhY2sgaXMgYm91bmQgdG8gYHRoaXNBcmdgIGFuZCBpbnZva2VkIHdpdGggdGhyZWUgYXJndW1lbnRzO1xuICAgICAqICh2YWx1ZSwgaW5kZXh8a2V5LCBjb2xsZWN0aW9uKS5cbiAgICAgKlxuICAgICAqIElmIGEgcHJvcGVydHkgbmFtZSBpcyBwcm92aWRlZCBmb3IgYGNhbGxiYWNrYCB0aGUgY3JlYXRlZCBcIl8ucGx1Y2tcIiBzdHlsZVxuICAgICAqIGNhbGxiYWNrIHdpbGwgcmV0dXJuIHRoZSBwcm9wZXJ0eSB2YWx1ZSBvZiB0aGUgZ2l2ZW4gZWxlbWVudC5cbiAgICAgKlxuICAgICAqIElmIGFuIG9iamVjdCBpcyBwcm92aWRlZCBmb3IgYGNhbGxiYWNrYCB0aGUgY3JlYXRlZCBcIl8ud2hlcmVcIiBzdHlsZSBjYWxsYmFja1xuICAgICAqIHdpbGwgcmV0dXJuIGB0cnVlYCBmb3IgZWxlbWVudHMgdGhhdCBoYXZlIHRoZSBwcm9wZXJ0aWVzIG9mIHRoZSBnaXZlbiBvYmplY3QsXG4gICAgICogZWxzZSBgZmFsc2VgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IENvbGxlY3Rpb25zXG4gICAgICogQHBhcmFtIHtBcnJheXxPYmplY3R8c3RyaW5nfSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufE9iamVjdHxzdHJpbmd9IFtjYWxsYmFjaz1pZGVudGl0eV0gVGhlIGZ1bmN0aW9uIGNhbGxlZFxuICAgICAqICBwZXIgaXRlcmF0aW9uLiBJZiBhIHByb3BlcnR5IG5hbWUgb3Igb2JqZWN0IGlzIHByb3ZpZGVkIGl0IHdpbGwgYmUgdXNlZFxuICAgICAqICB0byBjcmVhdGUgYSBcIl8ucGx1Y2tcIiBvciBcIl8ud2hlcmVcIiBzdHlsZSBjYWxsYmFjaywgcmVzcGVjdGl2ZWx5LlxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgY2FsbGJhY2tgLlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIGNvbXBvc2VkIGFnZ3JlZ2F0ZSBvYmplY3QuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBrZXlzID0gW1xuICAgICAqICAgeyAnZGlyJzogJ2xlZnQnLCAnY29kZSc6IDk3IH0sXG4gICAgICogICB7ICdkaXInOiAncmlnaHQnLCAnY29kZSc6IDEwMCB9XG4gICAgICogXTtcbiAgICAgKlxuICAgICAqIF8uaW5kZXhCeShrZXlzLCAnZGlyJyk7XG4gICAgICogLy8gPT4geyAnbGVmdCc6IHsgJ2Rpcic6ICdsZWZ0JywgJ2NvZGUnOiA5NyB9LCAncmlnaHQnOiB7ICdkaXInOiAncmlnaHQnLCAnY29kZSc6IDEwMCB9IH1cbiAgICAgKlxuICAgICAqIF8uaW5kZXhCeShrZXlzLCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoa2V5LmNvZGUpOyB9KTtcbiAgICAgKiAvLyA9PiB7ICdhJzogeyAnZGlyJzogJ2xlZnQnLCAnY29kZSc6IDk3IH0sICdkJzogeyAnZGlyJzogJ3JpZ2h0JywgJ2NvZGUnOiAxMDAgfSB9XG4gICAgICpcbiAgICAgKiBfLmluZGV4QnkoY2hhcmFjdGVycywgZnVuY3Rpb24oa2V5KSB7IHRoaXMuZnJvbUNoYXJDb2RlKGtleS5jb2RlKTsgfSwgU3RyaW5nKTtcbiAgICAgKiAvLyA9PiB7ICdhJzogeyAnZGlyJzogJ2xlZnQnLCAnY29kZSc6IDk3IH0sICdkJzogeyAnZGlyJzogJ3JpZ2h0JywgJ2NvZGUnOiAxMDAgfSB9XG4gICAgICovXG4gICAgdmFyIGluZGV4QnkgPSBjcmVhdGVBZ2dyZWdhdG9yKGZ1bmN0aW9uKHJlc3VsdCwgdmFsdWUsIGtleSkge1xuICAgICAgcmVzdWx0W2tleV0gPSB2YWx1ZTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIEludm9rZXMgdGhlIG1ldGhvZCBuYW1lZCBieSBgbWV0aG9kTmFtZWAgb24gZWFjaCBlbGVtZW50IGluIHRoZSBgY29sbGVjdGlvbmBcbiAgICAgKiByZXR1cm5pbmcgYW4gYXJyYXkgb2YgdGhlIHJlc3VsdHMgb2YgZWFjaCBpbnZva2VkIG1ldGhvZC4gQWRkaXRpb25hbCBhcmd1bWVudHNcbiAgICAgKiB3aWxsIGJlIHByb3ZpZGVkIHRvIGVhY2ggaW52b2tlZCBtZXRob2QuIElmIGBtZXRob2ROYW1lYCBpcyBhIGZ1bmN0aW9uIGl0XG4gICAgICogd2lsbCBiZSBpbnZva2VkIGZvciwgYW5kIGB0aGlzYCBib3VuZCB0bywgZWFjaCBlbGVtZW50IGluIHRoZSBgY29sbGVjdGlvbmAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgQ29sbGVjdGlvbnNcbiAgICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdHxzdHJpbmd9IGNvbGxlY3Rpb24gVGhlIGNvbGxlY3Rpb24gdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb258c3RyaW5nfSBtZXRob2ROYW1lIFRoZSBuYW1lIG9mIHRoZSBtZXRob2QgdG8gaW52b2tlIG9yXG4gICAgICogIHRoZSBmdW5jdGlvbiBpbnZva2VkIHBlciBpdGVyYXRpb24uXG4gICAgICogQHBhcmFtIHsuLi4qfSBbYXJnXSBBcmd1bWVudHMgdG8gaW52b2tlIHRoZSBtZXRob2Qgd2l0aC5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgYSBuZXcgYXJyYXkgb2YgdGhlIHJlc3VsdHMgb2YgZWFjaCBpbnZva2VkIG1ldGhvZC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5pbnZva2UoW1s1LCAxLCA3XSwgWzMsIDIsIDFdXSwgJ3NvcnQnKTtcbiAgICAgKiAvLyA9PiBbWzEsIDUsIDddLCBbMSwgMiwgM11dXG4gICAgICpcbiAgICAgKiBfLmludm9rZShbMTIzLCA0NTZdLCBTdHJpbmcucHJvdG90eXBlLnNwbGl0LCAnJyk7XG4gICAgICogLy8gPT4gW1snMScsICcyJywgJzMnXSwgWyc0JywgJzUnLCAnNiddXVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGludm9rZShjb2xsZWN0aW9uLCBtZXRob2ROYW1lKSB7XG4gICAgICB2YXIgYXJncyA9IHNsaWNlKGFyZ3VtZW50cywgMiksXG4gICAgICAgICAgaW5kZXggPSAtMSxcbiAgICAgICAgICBpc0Z1bmMgPSB0eXBlb2YgbWV0aG9kTmFtZSA9PSAnZnVuY3Rpb24nLFxuICAgICAgICAgIGxlbmd0aCA9IGNvbGxlY3Rpb24gPyBjb2xsZWN0aW9uLmxlbmd0aCA6IDAsXG4gICAgICAgICAgcmVzdWx0ID0gQXJyYXkodHlwZW9mIGxlbmd0aCA9PSAnbnVtYmVyJyA/IGxlbmd0aCA6IDApO1xuXG4gICAgICBmb3JFYWNoKGNvbGxlY3Rpb24sIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHJlc3VsdFsrK2luZGV4XSA9IChpc0Z1bmMgPyBtZXRob2ROYW1lIDogdmFsdWVbbWV0aG9kTmFtZV0pLmFwcGx5KHZhbHVlLCBhcmdzKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGFycmF5IG9mIHZhbHVlcyBieSBydW5uaW5nIGVhY2ggZWxlbWVudCBpbiB0aGUgY29sbGVjdGlvblxuICAgICAqIHRocm91Z2ggdGhlIGNhbGxiYWNrLiBUaGUgY2FsbGJhY2sgaXMgYm91bmQgdG8gYHRoaXNBcmdgIGFuZCBpbnZva2VkIHdpdGhcbiAgICAgKiB0aHJlZSBhcmd1bWVudHM7ICh2YWx1ZSwgaW5kZXh8a2V5LCBjb2xsZWN0aW9uKS5cbiAgICAgKlxuICAgICAqIElmIGEgcHJvcGVydHkgbmFtZSBpcyBwcm92aWRlZCBmb3IgYGNhbGxiYWNrYCB0aGUgY3JlYXRlZCBcIl8ucGx1Y2tcIiBzdHlsZVxuICAgICAqIGNhbGxiYWNrIHdpbGwgcmV0dXJuIHRoZSBwcm9wZXJ0eSB2YWx1ZSBvZiB0aGUgZ2l2ZW4gZWxlbWVudC5cbiAgICAgKlxuICAgICAqIElmIGFuIG9iamVjdCBpcyBwcm92aWRlZCBmb3IgYGNhbGxiYWNrYCB0aGUgY3JlYXRlZCBcIl8ud2hlcmVcIiBzdHlsZSBjYWxsYmFja1xuICAgICAqIHdpbGwgcmV0dXJuIGB0cnVlYCBmb3IgZWxlbWVudHMgdGhhdCBoYXZlIHRoZSBwcm9wZXJ0aWVzIG9mIHRoZSBnaXZlbiBvYmplY3QsXG4gICAgICogZWxzZSBgZmFsc2VgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGFsaWFzIGNvbGxlY3RcbiAgICAgKiBAY2F0ZWdvcnkgQ29sbGVjdGlvbnNcbiAgICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdHxzdHJpbmd9IGNvbGxlY3Rpb24gVGhlIGNvbGxlY3Rpb24gdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb258T2JqZWN0fHN0cmluZ30gW2NhbGxiYWNrPWlkZW50aXR5XSBUaGUgZnVuY3Rpb24gY2FsbGVkXG4gICAgICogIHBlciBpdGVyYXRpb24uIElmIGEgcHJvcGVydHkgbmFtZSBvciBvYmplY3QgaXMgcHJvdmlkZWQgaXQgd2lsbCBiZSB1c2VkXG4gICAgICogIHRvIGNyZWF0ZSBhIFwiXy5wbHVja1wiIG9yIFwiXy53aGVyZVwiIHN0eWxlIGNhbGxiYWNrLCByZXNwZWN0aXZlbHkuXG4gICAgICogQHBhcmFtIHsqfSBbdGhpc0FyZ10gVGhlIGB0aGlzYCBiaW5kaW5nIG9mIGBjYWxsYmFja2AuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIGEgbmV3IGFycmF5IG9mIHRoZSByZXN1bHRzIG9mIGVhY2ggYGNhbGxiYWNrYCBleGVjdXRpb24uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8ubWFwKFsxLCAyLCAzXSwgZnVuY3Rpb24obnVtKSB7IHJldHVybiBudW0gKiAzOyB9KTtcbiAgICAgKiAvLyA9PiBbMywgNiwgOV1cbiAgICAgKlxuICAgICAqIF8ubWFwKHsgJ29uZSc6IDEsICd0d28nOiAyLCAndGhyZWUnOiAzIH0sIGZ1bmN0aW9uKG51bSkgeyByZXR1cm4gbnVtICogMzsgfSk7XG4gICAgICogLy8gPT4gWzMsIDYsIDldIChwcm9wZXJ0eSBvcmRlciBpcyBub3QgZ3VhcmFudGVlZCBhY3Jvc3MgZW52aXJvbm1lbnRzKVxuICAgICAqXG4gICAgICogdmFyIGNoYXJhY3RlcnMgPSBbXG4gICAgICogICB7ICduYW1lJzogJ2Jhcm5leScsICdhZ2UnOiAzNiB9LFxuICAgICAqICAgeyAnbmFtZSc6ICdmcmVkJywgICAnYWdlJzogNDAgfVxuICAgICAqIF07XG4gICAgICpcbiAgICAgKiAvLyB1c2luZyBcIl8ucGx1Y2tcIiBjYWxsYmFjayBzaG9ydGhhbmRcbiAgICAgKiBfLm1hcChjaGFyYWN0ZXJzLCAnbmFtZScpO1xuICAgICAqIC8vID0+IFsnYmFybmV5JywgJ2ZyZWQnXVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIG1hcChjb2xsZWN0aW9uLCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgICAgbGVuZ3RoID0gY29sbGVjdGlvbiA/IGNvbGxlY3Rpb24ubGVuZ3RoIDogMDtcblxuICAgICAgY2FsbGJhY2sgPSBsb2Rhc2guY3JlYXRlQ2FsbGJhY2soY2FsbGJhY2ssIHRoaXNBcmcsIDMpO1xuICAgICAgaWYgKHR5cGVvZiBsZW5ndGggPT0gJ251bWJlcicpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IEFycmF5KGxlbmd0aCk7XG4gICAgICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgICAgcmVzdWx0W2luZGV4XSA9IGNhbGxiYWNrKGNvbGxlY3Rpb25baW5kZXhdLCBpbmRleCwgY29sbGVjdGlvbik7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdCA9IFtdO1xuICAgICAgICBmb3JPd24oY29sbGVjdGlvbiwgZnVuY3Rpb24odmFsdWUsIGtleSwgY29sbGVjdGlvbikge1xuICAgICAgICAgIHJlc3VsdFsrK2luZGV4XSA9IGNhbGxiYWNrKHZhbHVlLCBrZXksIGNvbGxlY3Rpb24pO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0cmlldmVzIHRoZSBtYXhpbXVtIHZhbHVlIG9mIGEgY29sbGVjdGlvbi4gSWYgdGhlIGNvbGxlY3Rpb24gaXMgZW1wdHkgb3JcbiAgICAgKiBmYWxzZXkgYC1JbmZpbml0eWAgaXMgcmV0dXJuZWQuIElmIGEgY2FsbGJhY2sgaXMgcHJvdmlkZWQgaXQgd2lsbCBiZSBleGVjdXRlZFxuICAgICAqIGZvciBlYWNoIHZhbHVlIGluIHRoZSBjb2xsZWN0aW9uIHRvIGdlbmVyYXRlIHRoZSBjcml0ZXJpb24gYnkgd2hpY2ggdGhlIHZhbHVlXG4gICAgICogaXMgcmFua2VkLiBUaGUgY2FsbGJhY2sgaXMgYm91bmQgdG8gYHRoaXNBcmdgIGFuZCBpbnZva2VkIHdpdGggdGhyZWVcbiAgICAgKiBhcmd1bWVudHM7ICh2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pLlxuICAgICAqXG4gICAgICogSWYgYSBwcm9wZXJ0eSBuYW1lIGlzIHByb3ZpZGVkIGZvciBgY2FsbGJhY2tgIHRoZSBjcmVhdGVkIFwiXy5wbHVja1wiIHN0eWxlXG4gICAgICogY2FsbGJhY2sgd2lsbCByZXR1cm4gdGhlIHByb3BlcnR5IHZhbHVlIG9mIHRoZSBnaXZlbiBlbGVtZW50LlxuICAgICAqXG4gICAgICogSWYgYW4gb2JqZWN0IGlzIHByb3ZpZGVkIGZvciBgY2FsbGJhY2tgIHRoZSBjcmVhdGVkIFwiXy53aGVyZVwiIHN0eWxlIGNhbGxiYWNrXG4gICAgICogd2lsbCByZXR1cm4gYHRydWVgIGZvciBlbGVtZW50cyB0aGF0IGhhdmUgdGhlIHByb3BlcnRpZXMgb2YgdGhlIGdpdmVuIG9iamVjdCxcbiAgICAgKiBlbHNlIGBmYWxzZWAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgQ29sbGVjdGlvbnNcbiAgICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdHxzdHJpbmd9IGNvbGxlY3Rpb24gVGhlIGNvbGxlY3Rpb24gdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb258T2JqZWN0fHN0cmluZ30gW2NhbGxiYWNrPWlkZW50aXR5XSBUaGUgZnVuY3Rpb24gY2FsbGVkXG4gICAgICogIHBlciBpdGVyYXRpb24uIElmIGEgcHJvcGVydHkgbmFtZSBvciBvYmplY3QgaXMgcHJvdmlkZWQgaXQgd2lsbCBiZSB1c2VkXG4gICAgICogIHRvIGNyZWF0ZSBhIFwiXy5wbHVja1wiIG9yIFwiXy53aGVyZVwiIHN0eWxlIGNhbGxiYWNrLCByZXNwZWN0aXZlbHkuXG4gICAgICogQHBhcmFtIHsqfSBbdGhpc0FyZ10gVGhlIGB0aGlzYCBiaW5kaW5nIG9mIGBjYWxsYmFja2AuXG4gICAgICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIG1heGltdW0gdmFsdWUuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8ubWF4KFs0LCAyLCA4LCA2XSk7XG4gICAgICogLy8gPT4gOFxuICAgICAqXG4gICAgICogdmFyIGNoYXJhY3RlcnMgPSBbXG4gICAgICogICB7ICduYW1lJzogJ2Jhcm5leScsICdhZ2UnOiAzNiB9LFxuICAgICAqICAgeyAnbmFtZSc6ICdmcmVkJywgICAnYWdlJzogNDAgfVxuICAgICAqIF07XG4gICAgICpcbiAgICAgKiBfLm1heChjaGFyYWN0ZXJzLCBmdW5jdGlvbihjaHIpIHsgcmV0dXJuIGNoci5hZ2U7IH0pO1xuICAgICAqIC8vID0+IHsgJ25hbWUnOiAnZnJlZCcsICdhZ2UnOiA0MCB9O1xuICAgICAqXG4gICAgICogLy8gdXNpbmcgXCJfLnBsdWNrXCIgY2FsbGJhY2sgc2hvcnRoYW5kXG4gICAgICogXy5tYXgoY2hhcmFjdGVycywgJ2FnZScpO1xuICAgICAqIC8vID0+IHsgJ25hbWUnOiAnZnJlZCcsICdhZ2UnOiA0MCB9O1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIG1heChjb2xsZWN0aW9uLCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgdmFyIGNvbXB1dGVkID0gLUluZmluaXR5LFxuICAgICAgICAgIHJlc3VsdCA9IGNvbXB1dGVkO1xuXG4gICAgICAvLyBhbGxvd3Mgd29ya2luZyB3aXRoIGZ1bmN0aW9ucyBsaWtlIGBfLm1hcGAgd2l0aG91dCB1c2luZ1xuICAgICAgLy8gdGhlaXIgYGluZGV4YCBhcmd1bWVudCBhcyBhIGNhbGxiYWNrXG4gICAgICBpZiAodHlwZW9mIGNhbGxiYWNrICE9ICdmdW5jdGlvbicgJiYgdGhpc0FyZyAmJiB0aGlzQXJnW2NhbGxiYWNrXSA9PT0gY29sbGVjdGlvbikge1xuICAgICAgICBjYWxsYmFjayA9IG51bGw7XG4gICAgICB9XG4gICAgICBpZiAoY2FsbGJhY2sgPT0gbnVsbCAmJiBpc0FycmF5KGNvbGxlY3Rpb24pKSB7XG4gICAgICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICAgICAgbGVuZ3RoID0gY29sbGVjdGlvbi5sZW5ndGg7XG5cbiAgICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgICB2YXIgdmFsdWUgPSBjb2xsZWN0aW9uW2luZGV4XTtcbiAgICAgICAgICBpZiAodmFsdWUgPiByZXN1bHQpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IHZhbHVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2FsbGJhY2sgPSAoY2FsbGJhY2sgPT0gbnVsbCAmJiBpc1N0cmluZyhjb2xsZWN0aW9uKSlcbiAgICAgICAgICA/IGNoYXJBdENhbGxiYWNrXG4gICAgICAgICAgOiBsb2Rhc2guY3JlYXRlQ2FsbGJhY2soY2FsbGJhY2ssIHRoaXNBcmcsIDMpO1xuXG4gICAgICAgIGZvckVhY2goY29sbGVjdGlvbiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBjb2xsZWN0aW9uKSB7XG4gICAgICAgICAgdmFyIGN1cnJlbnQgPSBjYWxsYmFjayh2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pO1xuICAgICAgICAgIGlmIChjdXJyZW50ID4gY29tcHV0ZWQpIHtcbiAgICAgICAgICAgIGNvbXB1dGVkID0gY3VycmVudDtcbiAgICAgICAgICAgIHJlc3VsdCA9IHZhbHVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHJpZXZlcyB0aGUgbWluaW11bSB2YWx1ZSBvZiBhIGNvbGxlY3Rpb24uIElmIHRoZSBjb2xsZWN0aW9uIGlzIGVtcHR5IG9yXG4gICAgICogZmFsc2V5IGBJbmZpbml0eWAgaXMgcmV0dXJuZWQuIElmIGEgY2FsbGJhY2sgaXMgcHJvdmlkZWQgaXQgd2lsbCBiZSBleGVjdXRlZFxuICAgICAqIGZvciBlYWNoIHZhbHVlIGluIHRoZSBjb2xsZWN0aW9uIHRvIGdlbmVyYXRlIHRoZSBjcml0ZXJpb24gYnkgd2hpY2ggdGhlIHZhbHVlXG4gICAgICogaXMgcmFua2VkLiBUaGUgY2FsbGJhY2sgaXMgYm91bmQgdG8gYHRoaXNBcmdgIGFuZCBpbnZva2VkIHdpdGggdGhyZWVcbiAgICAgKiBhcmd1bWVudHM7ICh2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pLlxuICAgICAqXG4gICAgICogSWYgYSBwcm9wZXJ0eSBuYW1lIGlzIHByb3ZpZGVkIGZvciBgY2FsbGJhY2tgIHRoZSBjcmVhdGVkIFwiXy5wbHVja1wiIHN0eWxlXG4gICAgICogY2FsbGJhY2sgd2lsbCByZXR1cm4gdGhlIHByb3BlcnR5IHZhbHVlIG9mIHRoZSBnaXZlbiBlbGVtZW50LlxuICAgICAqXG4gICAgICogSWYgYW4gb2JqZWN0IGlzIHByb3ZpZGVkIGZvciBgY2FsbGJhY2tgIHRoZSBjcmVhdGVkIFwiXy53aGVyZVwiIHN0eWxlIGNhbGxiYWNrXG4gICAgICogd2lsbCByZXR1cm4gYHRydWVgIGZvciBlbGVtZW50cyB0aGF0IGhhdmUgdGhlIHByb3BlcnRpZXMgb2YgdGhlIGdpdmVuIG9iamVjdCxcbiAgICAgKiBlbHNlIGBmYWxzZWAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgQ29sbGVjdGlvbnNcbiAgICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdHxzdHJpbmd9IGNvbGxlY3Rpb24gVGhlIGNvbGxlY3Rpb24gdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb258T2JqZWN0fHN0cmluZ30gW2NhbGxiYWNrPWlkZW50aXR5XSBUaGUgZnVuY3Rpb24gY2FsbGVkXG4gICAgICogIHBlciBpdGVyYXRpb24uIElmIGEgcHJvcGVydHkgbmFtZSBvciBvYmplY3QgaXMgcHJvdmlkZWQgaXQgd2lsbCBiZSB1c2VkXG4gICAgICogIHRvIGNyZWF0ZSBhIFwiXy5wbHVja1wiIG9yIFwiXy53aGVyZVwiIHN0eWxlIGNhbGxiYWNrLCByZXNwZWN0aXZlbHkuXG4gICAgICogQHBhcmFtIHsqfSBbdGhpc0FyZ10gVGhlIGB0aGlzYCBiaW5kaW5nIG9mIGBjYWxsYmFja2AuXG4gICAgICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIG1pbmltdW0gdmFsdWUuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8ubWluKFs0LCAyLCA4LCA2XSk7XG4gICAgICogLy8gPT4gMlxuICAgICAqXG4gICAgICogdmFyIGNoYXJhY3RlcnMgPSBbXG4gICAgICogICB7ICduYW1lJzogJ2Jhcm5leScsICdhZ2UnOiAzNiB9LFxuICAgICAqICAgeyAnbmFtZSc6ICdmcmVkJywgICAnYWdlJzogNDAgfVxuICAgICAqIF07XG4gICAgICpcbiAgICAgKiBfLm1pbihjaGFyYWN0ZXJzLCBmdW5jdGlvbihjaHIpIHsgcmV0dXJuIGNoci5hZ2U7IH0pO1xuICAgICAqIC8vID0+IHsgJ25hbWUnOiAnYmFybmV5JywgJ2FnZSc6IDM2IH07XG4gICAgICpcbiAgICAgKiAvLyB1c2luZyBcIl8ucGx1Y2tcIiBjYWxsYmFjayBzaG9ydGhhbmRcbiAgICAgKiBfLm1pbihjaGFyYWN0ZXJzLCAnYWdlJyk7XG4gICAgICogLy8gPT4geyAnbmFtZSc6ICdiYXJuZXknLCAnYWdlJzogMzYgfTtcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBtaW4oY29sbGVjdGlvbiwgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgIHZhciBjb21wdXRlZCA9IEluZmluaXR5LFxuICAgICAgICAgIHJlc3VsdCA9IGNvbXB1dGVkO1xuXG4gICAgICAvLyBhbGxvd3Mgd29ya2luZyB3aXRoIGZ1bmN0aW9ucyBsaWtlIGBfLm1hcGAgd2l0aG91dCB1c2luZ1xuICAgICAgLy8gdGhlaXIgYGluZGV4YCBhcmd1bWVudCBhcyBhIGNhbGxiYWNrXG4gICAgICBpZiAodHlwZW9mIGNhbGxiYWNrICE9ICdmdW5jdGlvbicgJiYgdGhpc0FyZyAmJiB0aGlzQXJnW2NhbGxiYWNrXSA9PT0gY29sbGVjdGlvbikge1xuICAgICAgICBjYWxsYmFjayA9IG51bGw7XG4gICAgICB9XG4gICAgICBpZiAoY2FsbGJhY2sgPT0gbnVsbCAmJiBpc0FycmF5KGNvbGxlY3Rpb24pKSB7XG4gICAgICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICAgICAgbGVuZ3RoID0gY29sbGVjdGlvbi5sZW5ndGg7XG5cbiAgICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgICB2YXIgdmFsdWUgPSBjb2xsZWN0aW9uW2luZGV4XTtcbiAgICAgICAgICBpZiAodmFsdWUgPCByZXN1bHQpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IHZhbHVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2FsbGJhY2sgPSAoY2FsbGJhY2sgPT0gbnVsbCAmJiBpc1N0cmluZyhjb2xsZWN0aW9uKSlcbiAgICAgICAgICA/IGNoYXJBdENhbGxiYWNrXG4gICAgICAgICAgOiBsb2Rhc2guY3JlYXRlQ2FsbGJhY2soY2FsbGJhY2ssIHRoaXNBcmcsIDMpO1xuXG4gICAgICAgIGZvckVhY2goY29sbGVjdGlvbiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBjb2xsZWN0aW9uKSB7XG4gICAgICAgICAgdmFyIGN1cnJlbnQgPSBjYWxsYmFjayh2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pO1xuICAgICAgICAgIGlmIChjdXJyZW50IDwgY29tcHV0ZWQpIHtcbiAgICAgICAgICAgIGNvbXB1dGVkID0gY3VycmVudDtcbiAgICAgICAgICAgIHJlc3VsdCA9IHZhbHVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHJpZXZlcyB0aGUgdmFsdWUgb2YgYSBzcGVjaWZpZWQgcHJvcGVydHkgZnJvbSBhbGwgZWxlbWVudHMgaW4gdGhlIGNvbGxlY3Rpb24uXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAdHlwZSBGdW5jdGlvblxuICAgICAqIEBjYXRlZ29yeSBDb2xsZWN0aW9uc1xuICAgICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fHN0cmluZ30gY29sbGVjdGlvbiBUaGUgY29sbGVjdGlvbiB0byBpdGVyYXRlIG92ZXIuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHByb3BlcnR5IFRoZSBuYW1lIG9mIHRoZSBwcm9wZXJ0eSB0byBwbHVjay5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgYSBuZXcgYXJyYXkgb2YgcHJvcGVydHkgdmFsdWVzLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgY2hhcmFjdGVycyA9IFtcbiAgICAgKiAgIHsgJ25hbWUnOiAnYmFybmV5JywgJ2FnZSc6IDM2IH0sXG4gICAgICogICB7ICduYW1lJzogJ2ZyZWQnLCAgICdhZ2UnOiA0MCB9XG4gICAgICogXTtcbiAgICAgKlxuICAgICAqIF8ucGx1Y2soY2hhcmFjdGVycywgJ25hbWUnKTtcbiAgICAgKiAvLyA9PiBbJ2Jhcm5leScsICdmcmVkJ11cbiAgICAgKi9cbiAgICB2YXIgcGx1Y2sgPSBtYXA7XG5cbiAgICAvKipcbiAgICAgKiBSZWR1Y2VzIGEgY29sbGVjdGlvbiB0byBhIHZhbHVlIHdoaWNoIGlzIHRoZSBhY2N1bXVsYXRlZCByZXN1bHQgb2YgcnVubmluZ1xuICAgICAqIGVhY2ggZWxlbWVudCBpbiB0aGUgY29sbGVjdGlvbiB0aHJvdWdoIHRoZSBjYWxsYmFjaywgd2hlcmUgZWFjaCBzdWNjZXNzaXZlXG4gICAgICogY2FsbGJhY2sgZXhlY3V0aW9uIGNvbnN1bWVzIHRoZSByZXR1cm4gdmFsdWUgb2YgdGhlIHByZXZpb3VzIGV4ZWN1dGlvbi4gSWZcbiAgICAgKiBgYWNjdW11bGF0b3JgIGlzIG5vdCBwcm92aWRlZCB0aGUgZmlyc3QgZWxlbWVudCBvZiB0aGUgY29sbGVjdGlvbiB3aWxsIGJlXG4gICAgICogdXNlZCBhcyB0aGUgaW5pdGlhbCBgYWNjdW11bGF0b3JgIHZhbHVlLiBUaGUgY2FsbGJhY2sgaXMgYm91bmQgdG8gYHRoaXNBcmdgXG4gICAgICogYW5kIGludm9rZWQgd2l0aCBmb3VyIGFyZ3VtZW50czsgKGFjY3VtdWxhdG9yLCB2YWx1ZSwgaW5kZXh8a2V5LCBjb2xsZWN0aW9uKS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBhbGlhcyBmb2xkbCwgaW5qZWN0XG4gICAgICogQGNhdGVnb3J5IENvbGxlY3Rpb25zXG4gICAgICogQHBhcmFtIHtBcnJheXxPYmplY3R8c3RyaW5nfSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY2FsbGJhY2s9aWRlbnRpdHldIFRoZSBmdW5jdGlvbiBjYWxsZWQgcGVyIGl0ZXJhdGlvbi5cbiAgICAgKiBAcGFyYW0geyp9IFthY2N1bXVsYXRvcl0gSW5pdGlhbCB2YWx1ZSBvZiB0aGUgYWNjdW11bGF0b3IuXG4gICAgICogQHBhcmFtIHsqfSBbdGhpc0FyZ10gVGhlIGB0aGlzYCBiaW5kaW5nIG9mIGBjYWxsYmFja2AuXG4gICAgICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIGFjY3VtdWxhdGVkIHZhbHVlLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgc3VtID0gXy5yZWR1Y2UoWzEsIDIsIDNdLCBmdW5jdGlvbihzdW0sIG51bSkge1xuICAgICAqICAgcmV0dXJuIHN1bSArIG51bTtcbiAgICAgKiB9KTtcbiAgICAgKiAvLyA9PiA2XG4gICAgICpcbiAgICAgKiB2YXIgbWFwcGVkID0gXy5yZWR1Y2UoeyAnYSc6IDEsICdiJzogMiwgJ2MnOiAzIH0sIGZ1bmN0aW9uKHJlc3VsdCwgbnVtLCBrZXkpIHtcbiAgICAgKiAgIHJlc3VsdFtrZXldID0gbnVtICogMztcbiAgICAgKiAgIHJldHVybiByZXN1bHQ7XG4gICAgICogfSwge30pO1xuICAgICAqIC8vID0+IHsgJ2EnOiAzLCAnYic6IDYsICdjJzogOSB9XG4gICAgICovXG4gICAgZnVuY3Rpb24gcmVkdWNlKGNvbGxlY3Rpb24sIGNhbGxiYWNrLCBhY2N1bXVsYXRvciwgdGhpc0FyZykge1xuICAgICAgaWYgKCFjb2xsZWN0aW9uKSByZXR1cm4gYWNjdW11bGF0b3I7XG4gICAgICB2YXIgbm9hY2N1bSA9IGFyZ3VtZW50cy5sZW5ndGggPCAzO1xuICAgICAgY2FsbGJhY2sgPSBsb2Rhc2guY3JlYXRlQ2FsbGJhY2soY2FsbGJhY2ssIHRoaXNBcmcsIDQpO1xuXG4gICAgICB2YXIgaW5kZXggPSAtMSxcbiAgICAgICAgICBsZW5ndGggPSBjb2xsZWN0aW9uLmxlbmd0aDtcblxuICAgICAgaWYgKHR5cGVvZiBsZW5ndGggPT0gJ251bWJlcicpIHtcbiAgICAgICAgaWYgKG5vYWNjdW0pIHtcbiAgICAgICAgICBhY2N1bXVsYXRvciA9IGNvbGxlY3Rpb25bKytpbmRleF07XG4gICAgICAgIH1cbiAgICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgICBhY2N1bXVsYXRvciA9IGNhbGxiYWNrKGFjY3VtdWxhdG9yLCBjb2xsZWN0aW9uW2luZGV4XSwgaW5kZXgsIGNvbGxlY3Rpb24pO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmb3JPd24oY29sbGVjdGlvbiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBjb2xsZWN0aW9uKSB7XG4gICAgICAgICAgYWNjdW11bGF0b3IgPSBub2FjY3VtXG4gICAgICAgICAgICA/IChub2FjY3VtID0gZmFsc2UsIHZhbHVlKVxuICAgICAgICAgICAgOiBjYWxsYmFjayhhY2N1bXVsYXRvciwgdmFsdWUsIGluZGV4LCBjb2xsZWN0aW9uKVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBhY2N1bXVsYXRvcjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBsaWtlIGBfLnJlZHVjZWAgZXhjZXB0IHRoYXQgaXQgaXRlcmF0ZXMgb3ZlciBlbGVtZW50c1xuICAgICAqIG9mIGEgYGNvbGxlY3Rpb25gIGZyb20gcmlnaHQgdG8gbGVmdC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBhbGlhcyBmb2xkclxuICAgICAqIEBjYXRlZ29yeSBDb2xsZWN0aW9uc1xuICAgICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fHN0cmluZ30gY29sbGVjdGlvbiBUaGUgY29sbGVjdGlvbiB0byBpdGVyYXRlIG92ZXIuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2NhbGxiYWNrPWlkZW50aXR5XSBUaGUgZnVuY3Rpb24gY2FsbGVkIHBlciBpdGVyYXRpb24uXG4gICAgICogQHBhcmFtIHsqfSBbYWNjdW11bGF0b3JdIEluaXRpYWwgdmFsdWUgb2YgdGhlIGFjY3VtdWxhdG9yLlxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgY2FsbGJhY2tgLlxuICAgICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSBhY2N1bXVsYXRlZCB2YWx1ZS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIGxpc3QgPSBbWzAsIDFdLCBbMiwgM10sIFs0LCA1XV07XG4gICAgICogdmFyIGZsYXQgPSBfLnJlZHVjZVJpZ2h0KGxpc3QsIGZ1bmN0aW9uKGEsIGIpIHsgcmV0dXJuIGEuY29uY2F0KGIpOyB9LCBbXSk7XG4gICAgICogLy8gPT4gWzQsIDUsIDIsIDMsIDAsIDFdXG4gICAgICovXG4gICAgZnVuY3Rpb24gcmVkdWNlUmlnaHQoY29sbGVjdGlvbiwgY2FsbGJhY2ssIGFjY3VtdWxhdG9yLCB0aGlzQXJnKSB7XG4gICAgICB2YXIgbm9hY2N1bSA9IGFyZ3VtZW50cy5sZW5ndGggPCAzO1xuICAgICAgY2FsbGJhY2sgPSBsb2Rhc2guY3JlYXRlQ2FsbGJhY2soY2FsbGJhY2ssIHRoaXNBcmcsIDQpO1xuICAgICAgZm9yRWFjaFJpZ2h0KGNvbGxlY3Rpb24sIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgY29sbGVjdGlvbikge1xuICAgICAgICBhY2N1bXVsYXRvciA9IG5vYWNjdW1cbiAgICAgICAgICA/IChub2FjY3VtID0gZmFsc2UsIHZhbHVlKVxuICAgICAgICAgIDogY2FsbGJhY2soYWNjdW11bGF0b3IsIHZhbHVlLCBpbmRleCwgY29sbGVjdGlvbik7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBhY2N1bXVsYXRvcjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgb3Bwb3NpdGUgb2YgYF8uZmlsdGVyYCB0aGlzIG1ldGhvZCByZXR1cm5zIHRoZSBlbGVtZW50cyBvZiBhXG4gICAgICogY29sbGVjdGlvbiB0aGF0IHRoZSBjYWxsYmFjayBkb2VzICoqbm90KiogcmV0dXJuIHRydWV5IGZvci5cbiAgICAgKlxuICAgICAqIElmIGEgcHJvcGVydHkgbmFtZSBpcyBwcm92aWRlZCBmb3IgYGNhbGxiYWNrYCB0aGUgY3JlYXRlZCBcIl8ucGx1Y2tcIiBzdHlsZVxuICAgICAqIGNhbGxiYWNrIHdpbGwgcmV0dXJuIHRoZSBwcm9wZXJ0eSB2YWx1ZSBvZiB0aGUgZ2l2ZW4gZWxlbWVudC5cbiAgICAgKlxuICAgICAqIElmIGFuIG9iamVjdCBpcyBwcm92aWRlZCBmb3IgYGNhbGxiYWNrYCB0aGUgY3JlYXRlZCBcIl8ud2hlcmVcIiBzdHlsZSBjYWxsYmFja1xuICAgICAqIHdpbGwgcmV0dXJuIGB0cnVlYCBmb3IgZWxlbWVudHMgdGhhdCBoYXZlIHRoZSBwcm9wZXJ0aWVzIG9mIHRoZSBnaXZlbiBvYmplY3QsXG4gICAgICogZWxzZSBgZmFsc2VgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IENvbGxlY3Rpb25zXG4gICAgICogQHBhcmFtIHtBcnJheXxPYmplY3R8c3RyaW5nfSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufE9iamVjdHxzdHJpbmd9IFtjYWxsYmFjaz1pZGVudGl0eV0gVGhlIGZ1bmN0aW9uIGNhbGxlZFxuICAgICAqICBwZXIgaXRlcmF0aW9uLiBJZiBhIHByb3BlcnR5IG5hbWUgb3Igb2JqZWN0IGlzIHByb3ZpZGVkIGl0IHdpbGwgYmUgdXNlZFxuICAgICAqICB0byBjcmVhdGUgYSBcIl8ucGx1Y2tcIiBvciBcIl8ud2hlcmVcIiBzdHlsZSBjYWxsYmFjaywgcmVzcGVjdGl2ZWx5LlxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgY2FsbGJhY2tgLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyBhIG5ldyBhcnJheSBvZiBlbGVtZW50cyB0aGF0IGZhaWxlZCB0aGUgY2FsbGJhY2sgY2hlY2suXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBvZGRzID0gXy5yZWplY3QoWzEsIDIsIDMsIDQsIDUsIDZdLCBmdW5jdGlvbihudW0pIHsgcmV0dXJuIG51bSAlIDIgPT0gMDsgfSk7XG4gICAgICogLy8gPT4gWzEsIDMsIDVdXG4gICAgICpcbiAgICAgKiB2YXIgY2hhcmFjdGVycyA9IFtcbiAgICAgKiAgIHsgJ25hbWUnOiAnYmFybmV5JywgJ2FnZSc6IDM2LCAnYmxvY2tlZCc6IGZhbHNlIH0sXG4gICAgICogICB7ICduYW1lJzogJ2ZyZWQnLCAgICdhZ2UnOiA0MCwgJ2Jsb2NrZWQnOiB0cnVlIH1cbiAgICAgKiBdO1xuICAgICAqXG4gICAgICogLy8gdXNpbmcgXCJfLnBsdWNrXCIgY2FsbGJhY2sgc2hvcnRoYW5kXG4gICAgICogXy5yZWplY3QoY2hhcmFjdGVycywgJ2Jsb2NrZWQnKTtcbiAgICAgKiAvLyA9PiBbeyAnbmFtZSc6ICdiYXJuZXknLCAnYWdlJzogMzYsICdibG9ja2VkJzogZmFsc2UgfV1cbiAgICAgKlxuICAgICAqIC8vIHVzaW5nIFwiXy53aGVyZVwiIGNhbGxiYWNrIHNob3J0aGFuZFxuICAgICAqIF8ucmVqZWN0KGNoYXJhY3RlcnMsIHsgJ2FnZSc6IDM2IH0pO1xuICAgICAqIC8vID0+IFt7ICduYW1lJzogJ2ZyZWQnLCAnYWdlJzogNDAsICdibG9ja2VkJzogdHJ1ZSB9XVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHJlamVjdChjb2xsZWN0aW9uLCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgY2FsbGJhY2sgPSBsb2Rhc2guY3JlYXRlQ2FsbGJhY2soY2FsbGJhY2ssIHRoaXNBcmcsIDMpO1xuICAgICAgcmV0dXJuIGZpbHRlcihjb2xsZWN0aW9uLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pIHtcbiAgICAgICAgcmV0dXJuICFjYWxsYmFjayh2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0cmlldmVzIGEgcmFuZG9tIGVsZW1lbnQgb3IgYG5gIHJhbmRvbSBlbGVtZW50cyBmcm9tIGEgY29sbGVjdGlvbi5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBDb2xsZWN0aW9uc1xuICAgICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fHN0cmluZ30gY29sbGVjdGlvbiBUaGUgY29sbGVjdGlvbiB0byBzYW1wbGUuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtuXSBUaGUgbnVtYmVyIG9mIGVsZW1lbnRzIHRvIHNhbXBsZS5cbiAgICAgKiBAcGFyYW0tIHtPYmplY3R9IFtndWFyZF0gQWxsb3dzIHdvcmtpbmcgd2l0aCBmdW5jdGlvbnMgbGlrZSBgXy5tYXBgXG4gICAgICogIHdpdGhvdXQgdXNpbmcgdGhlaXIgYGluZGV4YCBhcmd1bWVudHMgYXMgYG5gLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgcmFuZG9tIHNhbXBsZShzKSBvZiBgY29sbGVjdGlvbmAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uc2FtcGxlKFsxLCAyLCAzLCA0XSk7XG4gICAgICogLy8gPT4gMlxuICAgICAqXG4gICAgICogXy5zYW1wbGUoWzEsIDIsIDMsIDRdLCAyKTtcbiAgICAgKiAvLyA9PiBbMywgMV1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzYW1wbGUoY29sbGVjdGlvbiwgbiwgZ3VhcmQpIHtcbiAgICAgIGlmIChjb2xsZWN0aW9uICYmIHR5cGVvZiBjb2xsZWN0aW9uLmxlbmd0aCAhPSAnbnVtYmVyJykge1xuICAgICAgICBjb2xsZWN0aW9uID0gdmFsdWVzKGNvbGxlY3Rpb24pO1xuICAgICAgfVxuICAgICAgaWYgKG4gPT0gbnVsbCB8fCBndWFyZCkge1xuICAgICAgICByZXR1cm4gY29sbGVjdGlvbiA/IGNvbGxlY3Rpb25bYmFzZVJhbmRvbSgwLCBjb2xsZWN0aW9uLmxlbmd0aCAtIDEpXSA6IHVuZGVmaW5lZDtcbiAgICAgIH1cbiAgICAgIHZhciByZXN1bHQgPSBzaHVmZmxlKGNvbGxlY3Rpb24pO1xuICAgICAgcmVzdWx0Lmxlbmd0aCA9IG5hdGl2ZU1pbihuYXRpdmVNYXgoMCwgbiksIHJlc3VsdC5sZW5ndGgpO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGFycmF5IG9mIHNodWZmbGVkIHZhbHVlcywgdXNpbmcgYSB2ZXJzaW9uIG9mIHRoZSBGaXNoZXItWWF0ZXNcbiAgICAgKiBzaHVmZmxlLiBTZWUgaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9GaXNoZXItWWF0ZXNfc2h1ZmZsZS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBDb2xsZWN0aW9uc1xuICAgICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fHN0cmluZ30gY29sbGVjdGlvbiBUaGUgY29sbGVjdGlvbiB0byBzaHVmZmxlLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyBhIG5ldyBzaHVmZmxlZCBjb2xsZWN0aW9uLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLnNodWZmbGUoWzEsIDIsIDMsIDQsIDUsIDZdKTtcbiAgICAgKiAvLyA9PiBbNCwgMSwgNiwgMywgNSwgMl1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzaHVmZmxlKGNvbGxlY3Rpb24pIHtcbiAgICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICAgIGxlbmd0aCA9IGNvbGxlY3Rpb24gPyBjb2xsZWN0aW9uLmxlbmd0aCA6IDAsXG4gICAgICAgICAgcmVzdWx0ID0gQXJyYXkodHlwZW9mIGxlbmd0aCA9PSAnbnVtYmVyJyA/IGxlbmd0aCA6IDApO1xuXG4gICAgICBmb3JFYWNoKGNvbGxlY3Rpb24sIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHZhciByYW5kID0gYmFzZVJhbmRvbSgwLCArK2luZGV4KTtcbiAgICAgICAgcmVzdWx0W2luZGV4XSA9IHJlc3VsdFtyYW5kXTtcbiAgICAgICAgcmVzdWx0W3JhbmRdID0gdmFsdWU7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgc2l6ZSBvZiB0aGUgYGNvbGxlY3Rpb25gIGJ5IHJldHVybmluZyBgY29sbGVjdGlvbi5sZW5ndGhgIGZvciBhcnJheXNcbiAgICAgKiBhbmQgYXJyYXktbGlrZSBvYmplY3RzIG9yIHRoZSBudW1iZXIgb2Ygb3duIGVudW1lcmFibGUgcHJvcGVydGllcyBmb3Igb2JqZWN0cy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBDb2xsZWN0aW9uc1xuICAgICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fHN0cmluZ30gY29sbGVjdGlvbiBUaGUgY29sbGVjdGlvbiB0byBpbnNwZWN0LlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgYGNvbGxlY3Rpb24ubGVuZ3RoYCBvciBudW1iZXIgb2Ygb3duIGVudW1lcmFibGUgcHJvcGVydGllcy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5zaXplKFsxLCAyXSk7XG4gICAgICogLy8gPT4gMlxuICAgICAqXG4gICAgICogXy5zaXplKHsgJ29uZSc6IDEsICd0d28nOiAyLCAndGhyZWUnOiAzIH0pO1xuICAgICAqIC8vID0+IDNcbiAgICAgKlxuICAgICAqIF8uc2l6ZSgncGViYmxlcycpO1xuICAgICAqIC8vID0+IDdcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzaXplKGNvbGxlY3Rpb24pIHtcbiAgICAgIHZhciBsZW5ndGggPSBjb2xsZWN0aW9uID8gY29sbGVjdGlvbi5sZW5ndGggOiAwO1xuICAgICAgcmV0dXJuIHR5cGVvZiBsZW5ndGggPT0gJ251bWJlcicgPyBsZW5ndGggOiBrZXlzKGNvbGxlY3Rpb24pLmxlbmd0aDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgdGhlIGNhbGxiYWNrIHJldHVybnMgYSB0cnVleSB2YWx1ZSBmb3IgKiphbnkqKiBlbGVtZW50IG9mIGFcbiAgICAgKiBjb2xsZWN0aW9uLiBUaGUgZnVuY3Rpb24gcmV0dXJucyBhcyBzb29uIGFzIGl0IGZpbmRzIGEgcGFzc2luZyB2YWx1ZSBhbmRcbiAgICAgKiBkb2VzIG5vdCBpdGVyYXRlIG92ZXIgdGhlIGVudGlyZSBjb2xsZWN0aW9uLiBUaGUgY2FsbGJhY2sgaXMgYm91bmQgdG9cbiAgICAgKiBgdGhpc0FyZ2AgYW5kIGludm9rZWQgd2l0aCB0aHJlZSBhcmd1bWVudHM7ICh2YWx1ZSwgaW5kZXh8a2V5LCBjb2xsZWN0aW9uKS5cbiAgICAgKlxuICAgICAqIElmIGEgcHJvcGVydHkgbmFtZSBpcyBwcm92aWRlZCBmb3IgYGNhbGxiYWNrYCB0aGUgY3JlYXRlZCBcIl8ucGx1Y2tcIiBzdHlsZVxuICAgICAqIGNhbGxiYWNrIHdpbGwgcmV0dXJuIHRoZSBwcm9wZXJ0eSB2YWx1ZSBvZiB0aGUgZ2l2ZW4gZWxlbWVudC5cbiAgICAgKlxuICAgICAqIElmIGFuIG9iamVjdCBpcyBwcm92aWRlZCBmb3IgYGNhbGxiYWNrYCB0aGUgY3JlYXRlZCBcIl8ud2hlcmVcIiBzdHlsZSBjYWxsYmFja1xuICAgICAqIHdpbGwgcmV0dXJuIGB0cnVlYCBmb3IgZWxlbWVudHMgdGhhdCBoYXZlIHRoZSBwcm9wZXJ0aWVzIG9mIHRoZSBnaXZlbiBvYmplY3QsXG4gICAgICogZWxzZSBgZmFsc2VgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGFsaWFzIGFueVxuICAgICAqIEBjYXRlZ29yeSBDb2xsZWN0aW9uc1xuICAgICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fHN0cmluZ30gY29sbGVjdGlvbiBUaGUgY29sbGVjdGlvbiB0byBpdGVyYXRlIG92ZXIuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbnxPYmplY3R8c3RyaW5nfSBbY2FsbGJhY2s9aWRlbnRpdHldIFRoZSBmdW5jdGlvbiBjYWxsZWRcbiAgICAgKiAgcGVyIGl0ZXJhdGlvbi4gSWYgYSBwcm9wZXJ0eSBuYW1lIG9yIG9iamVjdCBpcyBwcm92aWRlZCBpdCB3aWxsIGJlIHVzZWRcbiAgICAgKiAgdG8gY3JlYXRlIGEgXCJfLnBsdWNrXCIgb3IgXCJfLndoZXJlXCIgc3R5bGUgY2FsbGJhY2ssIHJlc3BlY3RpdmVseS5cbiAgICAgKiBAcGFyYW0geyp9IFt0aGlzQXJnXSBUaGUgYHRoaXNgIGJpbmRpbmcgb2YgYGNhbGxiYWNrYC5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYW55IGVsZW1lbnQgcGFzc2VkIHRoZSBjYWxsYmFjayBjaGVjayxcbiAgICAgKiAgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLnNvbWUoW251bGwsIDAsICd5ZXMnLCBmYWxzZV0sIEJvb2xlYW4pO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIHZhciBjaGFyYWN0ZXJzID0gW1xuICAgICAqICAgeyAnbmFtZSc6ICdiYXJuZXknLCAnYWdlJzogMzYsICdibG9ja2VkJzogZmFsc2UgfSxcbiAgICAgKiAgIHsgJ25hbWUnOiAnZnJlZCcsICAgJ2FnZSc6IDQwLCAnYmxvY2tlZCc6IHRydWUgfVxuICAgICAqIF07XG4gICAgICpcbiAgICAgKiAvLyB1c2luZyBcIl8ucGx1Y2tcIiBjYWxsYmFjayBzaG9ydGhhbmRcbiAgICAgKiBfLnNvbWUoY2hhcmFjdGVycywgJ2Jsb2NrZWQnKTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICpcbiAgICAgKiAvLyB1c2luZyBcIl8ud2hlcmVcIiBjYWxsYmFjayBzaG9ydGhhbmRcbiAgICAgKiBfLnNvbWUoY2hhcmFjdGVycywgeyAnYWdlJzogMSB9KTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHNvbWUoY29sbGVjdGlvbiwgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgIHZhciByZXN1bHQ7XG4gICAgICBjYWxsYmFjayA9IGxvZGFzaC5jcmVhdGVDYWxsYmFjayhjYWxsYmFjaywgdGhpc0FyZywgMyk7XG5cbiAgICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICAgIGxlbmd0aCA9IGNvbGxlY3Rpb24gPyBjb2xsZWN0aW9uLmxlbmd0aCA6IDA7XG5cbiAgICAgIGlmICh0eXBlb2YgbGVuZ3RoID09ICdudW1iZXInKSB7XG4gICAgICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgICAgaWYgKChyZXN1bHQgPSBjYWxsYmFjayhjb2xsZWN0aW9uW2luZGV4XSwgaW5kZXgsIGNvbGxlY3Rpb24pKSkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmb3JPd24oY29sbGVjdGlvbiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBjb2xsZWN0aW9uKSB7XG4gICAgICAgICAgcmV0dXJuICEocmVzdWx0ID0gY2FsbGJhY2sodmFsdWUsIGluZGV4LCBjb2xsZWN0aW9uKSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuICEhcmVzdWx0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gYXJyYXkgb2YgZWxlbWVudHMsIHNvcnRlZCBpbiBhc2NlbmRpbmcgb3JkZXIgYnkgdGhlIHJlc3VsdHMgb2ZcbiAgICAgKiBydW5uaW5nIGVhY2ggZWxlbWVudCBpbiBhIGNvbGxlY3Rpb24gdGhyb3VnaCB0aGUgY2FsbGJhY2suIFRoaXMgbWV0aG9kXG4gICAgICogcGVyZm9ybXMgYSBzdGFibGUgc29ydCwgdGhhdCBpcywgaXQgd2lsbCBwcmVzZXJ2ZSB0aGUgb3JpZ2luYWwgc29ydCBvcmRlclxuICAgICAqIG9mIGVxdWFsIGVsZW1lbnRzLiBUaGUgY2FsbGJhY2sgaXMgYm91bmQgdG8gYHRoaXNBcmdgIGFuZCBpbnZva2VkIHdpdGhcbiAgICAgKiB0aHJlZSBhcmd1bWVudHM7ICh2YWx1ZSwgaW5kZXh8a2V5LCBjb2xsZWN0aW9uKS5cbiAgICAgKlxuICAgICAqIElmIGEgcHJvcGVydHkgbmFtZSBpcyBwcm92aWRlZCBmb3IgYGNhbGxiYWNrYCB0aGUgY3JlYXRlZCBcIl8ucGx1Y2tcIiBzdHlsZVxuICAgICAqIGNhbGxiYWNrIHdpbGwgcmV0dXJuIHRoZSBwcm9wZXJ0eSB2YWx1ZSBvZiB0aGUgZ2l2ZW4gZWxlbWVudC5cbiAgICAgKlxuICAgICAqIElmIGFuIGFycmF5IG9mIHByb3BlcnR5IG5hbWVzIGlzIHByb3ZpZGVkIGZvciBgY2FsbGJhY2tgIHRoZSBjb2xsZWN0aW9uXG4gICAgICogd2lsbCBiZSBzb3J0ZWQgYnkgZWFjaCBwcm9wZXJ0eSB2YWx1ZS5cbiAgICAgKlxuICAgICAqIElmIGFuIG9iamVjdCBpcyBwcm92aWRlZCBmb3IgYGNhbGxiYWNrYCB0aGUgY3JlYXRlZCBcIl8ud2hlcmVcIiBzdHlsZSBjYWxsYmFja1xuICAgICAqIHdpbGwgcmV0dXJuIGB0cnVlYCBmb3IgZWxlbWVudHMgdGhhdCBoYXZlIHRoZSBwcm9wZXJ0aWVzIG9mIHRoZSBnaXZlbiBvYmplY3QsXG4gICAgICogZWxzZSBgZmFsc2VgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IENvbGxlY3Rpb25zXG4gICAgICogQHBhcmFtIHtBcnJheXxPYmplY3R8c3RyaW5nfSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0ge0FycmF5fEZ1bmN0aW9ufE9iamVjdHxzdHJpbmd9IFtjYWxsYmFjaz1pZGVudGl0eV0gVGhlIGZ1bmN0aW9uIGNhbGxlZFxuICAgICAqICBwZXIgaXRlcmF0aW9uLiBJZiBhIHByb3BlcnR5IG5hbWUgb3Igb2JqZWN0IGlzIHByb3ZpZGVkIGl0IHdpbGwgYmUgdXNlZFxuICAgICAqICB0byBjcmVhdGUgYSBcIl8ucGx1Y2tcIiBvciBcIl8ud2hlcmVcIiBzdHlsZSBjYWxsYmFjaywgcmVzcGVjdGl2ZWx5LlxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgY2FsbGJhY2tgLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyBhIG5ldyBhcnJheSBvZiBzb3J0ZWQgZWxlbWVudHMuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uc29ydEJ5KFsxLCAyLCAzXSwgZnVuY3Rpb24obnVtKSB7IHJldHVybiBNYXRoLnNpbihudW0pOyB9KTtcbiAgICAgKiAvLyA9PiBbMywgMSwgMl1cbiAgICAgKlxuICAgICAqIF8uc29ydEJ5KFsxLCAyLCAzXSwgZnVuY3Rpb24obnVtKSB7IHJldHVybiB0aGlzLnNpbihudW0pOyB9LCBNYXRoKTtcbiAgICAgKiAvLyA9PiBbMywgMSwgMl1cbiAgICAgKlxuICAgICAqIHZhciBjaGFyYWN0ZXJzID0gW1xuICAgICAqICAgeyAnbmFtZSc6ICdiYXJuZXknLCAgJ2FnZSc6IDM2IH0sXG4gICAgICogICB7ICduYW1lJzogJ2ZyZWQnLCAgICAnYWdlJzogNDAgfSxcbiAgICAgKiAgIHsgJ25hbWUnOiAnYmFybmV5JywgICdhZ2UnOiAyNiB9LFxuICAgICAqICAgeyAnbmFtZSc6ICdmcmVkJywgICAgJ2FnZSc6IDMwIH1cbiAgICAgKiBdO1xuICAgICAqXG4gICAgICogLy8gdXNpbmcgXCJfLnBsdWNrXCIgY2FsbGJhY2sgc2hvcnRoYW5kXG4gICAgICogXy5tYXAoXy5zb3J0QnkoY2hhcmFjdGVycywgJ2FnZScpLCBfLnZhbHVlcyk7XG4gICAgICogLy8gPT4gW1snYmFybmV5JywgMjZdLCBbJ2ZyZWQnLCAzMF0sIFsnYmFybmV5JywgMzZdLCBbJ2ZyZWQnLCA0MF1dXG4gICAgICpcbiAgICAgKiAvLyBzb3J0aW5nIGJ5IG11bHRpcGxlIHByb3BlcnRpZXNcbiAgICAgKiBfLm1hcChfLnNvcnRCeShjaGFyYWN0ZXJzLCBbJ25hbWUnLCAnYWdlJ10pLCBfLnZhbHVlcyk7XG4gICAgICogLy8gPSA+IFtbJ2Jhcm5leScsIDI2XSwgWydiYXJuZXknLCAzNl0sIFsnZnJlZCcsIDMwXSwgWydmcmVkJywgNDBdXVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHNvcnRCeShjb2xsZWN0aW9uLCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgICAgaXNBcnIgPSBpc0FycmF5KGNhbGxiYWNrKSxcbiAgICAgICAgICBsZW5ndGggPSBjb2xsZWN0aW9uID8gY29sbGVjdGlvbi5sZW5ndGggOiAwLFxuICAgICAgICAgIHJlc3VsdCA9IEFycmF5KHR5cGVvZiBsZW5ndGggPT0gJ251bWJlcicgPyBsZW5ndGggOiAwKTtcblxuICAgICAgaWYgKCFpc0Fycikge1xuICAgICAgICBjYWxsYmFjayA9IGxvZGFzaC5jcmVhdGVDYWxsYmFjayhjYWxsYmFjaywgdGhpc0FyZywgMyk7XG4gICAgICB9XG4gICAgICBmb3JFYWNoKGNvbGxlY3Rpb24sIGZ1bmN0aW9uKHZhbHVlLCBrZXksIGNvbGxlY3Rpb24pIHtcbiAgICAgICAgdmFyIG9iamVjdCA9IHJlc3VsdFsrK2luZGV4XSA9IGdldE9iamVjdCgpO1xuICAgICAgICBpZiAoaXNBcnIpIHtcbiAgICAgICAgICBvYmplY3QuY3JpdGVyaWEgPSBtYXAoY2FsbGJhY2ssIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgKG9iamVjdC5jcml0ZXJpYSA9IGdldEFycmF5KCkpWzBdID0gY2FsbGJhY2sodmFsdWUsIGtleSwgY29sbGVjdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgb2JqZWN0LmluZGV4ID0gaW5kZXg7XG4gICAgICAgIG9iamVjdC52YWx1ZSA9IHZhbHVlO1xuICAgICAgfSk7XG5cbiAgICAgIGxlbmd0aCA9IHJlc3VsdC5sZW5ndGg7XG4gICAgICByZXN1bHQuc29ydChjb21wYXJlQXNjZW5kaW5nKTtcbiAgICAgIHdoaWxlIChsZW5ndGgtLSkge1xuICAgICAgICB2YXIgb2JqZWN0ID0gcmVzdWx0W2xlbmd0aF07XG4gICAgICAgIHJlc3VsdFtsZW5ndGhdID0gb2JqZWN0LnZhbHVlO1xuICAgICAgICBpZiAoIWlzQXJyKSB7XG4gICAgICAgICAgcmVsZWFzZUFycmF5KG9iamVjdC5jcml0ZXJpYSk7XG4gICAgICAgIH1cbiAgICAgICAgcmVsZWFzZU9iamVjdChvYmplY3QpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyB0aGUgYGNvbGxlY3Rpb25gIHRvIGFuIGFycmF5LlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IENvbGxlY3Rpb25zXG4gICAgICogQHBhcmFtIHtBcnJheXxPYmplY3R8c3RyaW5nfSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIGNvbnZlcnQuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBuZXcgY29udmVydGVkIGFycmF5LlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAoZnVuY3Rpb24oKSB7IHJldHVybiBfLnRvQXJyYXkoYXJndW1lbnRzKS5zbGljZSgxKTsgfSkoMSwgMiwgMywgNCk7XG4gICAgICogLy8gPT4gWzIsIDMsIDRdXG4gICAgICovXG4gICAgZnVuY3Rpb24gdG9BcnJheShjb2xsZWN0aW9uKSB7XG4gICAgICBpZiAoY29sbGVjdGlvbiAmJiB0eXBlb2YgY29sbGVjdGlvbi5sZW5ndGggPT0gJ251bWJlcicpIHtcbiAgICAgICAgcmV0dXJuIHNsaWNlKGNvbGxlY3Rpb24pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHZhbHVlcyhjb2xsZWN0aW9uKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQZXJmb3JtcyBhIGRlZXAgY29tcGFyaXNvbiBvZiBlYWNoIGVsZW1lbnQgaW4gYSBgY29sbGVjdGlvbmAgdG8gdGhlIGdpdmVuXG4gICAgICogYHByb3BlcnRpZXNgIG9iamVjdCwgcmV0dXJuaW5nIGFuIGFycmF5IG9mIGFsbCBlbGVtZW50cyB0aGF0IGhhdmUgZXF1aXZhbGVudFxuICAgICAqIHByb3BlcnR5IHZhbHVlcy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEB0eXBlIEZ1bmN0aW9uXG4gICAgICogQGNhdGVnb3J5IENvbGxlY3Rpb25zXG4gICAgICogQHBhcmFtIHtBcnJheXxPYmplY3R8c3RyaW5nfSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gcHJvcHMgVGhlIG9iamVjdCBvZiBwcm9wZXJ0eSB2YWx1ZXMgdG8gZmlsdGVyIGJ5LlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyBhIG5ldyBhcnJheSBvZiBlbGVtZW50cyB0aGF0IGhhdmUgdGhlIGdpdmVuIHByb3BlcnRpZXMuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBjaGFyYWN0ZXJzID0gW1xuICAgICAqICAgeyAnbmFtZSc6ICdiYXJuZXknLCAnYWdlJzogMzYsICdwZXRzJzogWydob3BweSddIH0sXG4gICAgICogICB7ICduYW1lJzogJ2ZyZWQnLCAgICdhZ2UnOiA0MCwgJ3BldHMnOiBbJ2JhYnkgcHVzcycsICdkaW5vJ10gfVxuICAgICAqIF07XG4gICAgICpcbiAgICAgKiBfLndoZXJlKGNoYXJhY3RlcnMsIHsgJ2FnZSc6IDM2IH0pO1xuICAgICAqIC8vID0+IFt7ICduYW1lJzogJ2Jhcm5leScsICdhZ2UnOiAzNiwgJ3BldHMnOiBbJ2hvcHB5J10gfV1cbiAgICAgKlxuICAgICAqIF8ud2hlcmUoY2hhcmFjdGVycywgeyAncGV0cyc6IFsnZGlubyddIH0pO1xuICAgICAqIC8vID0+IFt7ICduYW1lJzogJ2ZyZWQnLCAnYWdlJzogNDAsICdwZXRzJzogWydiYWJ5IHB1c3MnLCAnZGlubyddIH1dXG4gICAgICovXG4gICAgdmFyIHdoZXJlID0gZmlsdGVyO1xuXG4gICAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGFycmF5IHdpdGggYWxsIGZhbHNleSB2YWx1ZXMgcmVtb3ZlZC4gVGhlIHZhbHVlcyBgZmFsc2VgLCBgbnVsbGAsXG4gICAgICogYDBgLCBgXCJcImAsIGB1bmRlZmluZWRgLCBhbmQgYE5hTmAgYXJlIGFsbCBmYWxzZXkuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlzXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGNvbXBhY3QuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIGEgbmV3IGFycmF5IG9mIGZpbHRlcmVkIHZhbHVlcy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5jb21wYWN0KFswLCAxLCBmYWxzZSwgMiwgJycsIDNdKTtcbiAgICAgKiAvLyA9PiBbMSwgMiwgM11cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb21wYWN0KGFycmF5KSB7XG4gICAgICB2YXIgaW5kZXggPSAtMSxcbiAgICAgICAgICBsZW5ndGggPSBhcnJheSA/IGFycmF5Lmxlbmd0aCA6IDAsXG4gICAgICAgICAgcmVzdWx0ID0gW107XG5cbiAgICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IGFycmF5W2luZGV4XTtcbiAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgcmVzdWx0LnB1c2godmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gYXJyYXkgZXhjbHVkaW5nIGFsbCB2YWx1ZXMgb2YgdGhlIHByb3ZpZGVkIGFycmF5cyB1c2luZyBzdHJpY3RcbiAgICAgKiBlcXVhbGl0eSBmb3IgY29tcGFyaXNvbnMsIGkuZS4gYD09PWAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlzXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIHByb2Nlc3MuXG4gICAgICogQHBhcmFtIHsuLi5BcnJheX0gW3ZhbHVlc10gVGhlIGFycmF5cyBvZiB2YWx1ZXMgdG8gZXhjbHVkZS5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgYSBuZXcgYXJyYXkgb2YgZmlsdGVyZWQgdmFsdWVzLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmRpZmZlcmVuY2UoWzEsIDIsIDMsIDQsIDVdLCBbNSwgMiwgMTBdKTtcbiAgICAgKiAvLyA9PiBbMSwgMywgNF1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBkaWZmZXJlbmNlKGFycmF5KSB7XG4gICAgICByZXR1cm4gYmFzZURpZmZlcmVuY2UoYXJyYXksIGJhc2VGbGF0dGVuKGFyZ3VtZW50cywgdHJ1ZSwgdHJ1ZSwgMSkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGxpa2UgYF8uZmluZGAgZXhjZXB0IHRoYXQgaXQgcmV0dXJucyB0aGUgaW5kZXggb2YgdGhlIGZpcnN0XG4gICAgICogZWxlbWVudCB0aGF0IHBhc3NlcyB0aGUgY2FsbGJhY2sgY2hlY2ssIGluc3RlYWQgb2YgdGhlIGVsZW1lbnQgaXRzZWxmLlxuICAgICAqXG4gICAgICogSWYgYSBwcm9wZXJ0eSBuYW1lIGlzIHByb3ZpZGVkIGZvciBgY2FsbGJhY2tgIHRoZSBjcmVhdGVkIFwiXy5wbHVja1wiIHN0eWxlXG4gICAgICogY2FsbGJhY2sgd2lsbCByZXR1cm4gdGhlIHByb3BlcnR5IHZhbHVlIG9mIHRoZSBnaXZlbiBlbGVtZW50LlxuICAgICAqXG4gICAgICogSWYgYW4gb2JqZWN0IGlzIHByb3ZpZGVkIGZvciBgY2FsbGJhY2tgIHRoZSBjcmVhdGVkIFwiXy53aGVyZVwiIHN0eWxlIGNhbGxiYWNrXG4gICAgICogd2lsbCByZXR1cm4gYHRydWVgIGZvciBlbGVtZW50cyB0aGF0IGhhdmUgdGhlIHByb3BlcnRpZXMgb2YgdGhlIGdpdmVuIG9iamVjdCxcbiAgICAgKiBlbHNlIGBmYWxzZWAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlzXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIHNlYXJjaC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufE9iamVjdHxzdHJpbmd9IFtjYWxsYmFjaz1pZGVudGl0eV0gVGhlIGZ1bmN0aW9uIGNhbGxlZFxuICAgICAqICBwZXIgaXRlcmF0aW9uLiBJZiBhIHByb3BlcnR5IG5hbWUgb3Igb2JqZWN0IGlzIHByb3ZpZGVkIGl0IHdpbGwgYmUgdXNlZFxuICAgICAqICB0byBjcmVhdGUgYSBcIl8ucGx1Y2tcIiBvciBcIl8ud2hlcmVcIiBzdHlsZSBjYWxsYmFjaywgcmVzcGVjdGl2ZWx5LlxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgY2FsbGJhY2tgLlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIGluZGV4IG9mIHRoZSBmb3VuZCBlbGVtZW50LCBlbHNlIGAtMWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBjaGFyYWN0ZXJzID0gW1xuICAgICAqICAgeyAnbmFtZSc6ICdiYXJuZXknLCAgJ2FnZSc6IDM2LCAnYmxvY2tlZCc6IGZhbHNlIH0sXG4gICAgICogICB7ICduYW1lJzogJ2ZyZWQnLCAgICAnYWdlJzogNDAsICdibG9ja2VkJzogdHJ1ZSB9LFxuICAgICAqICAgeyAnbmFtZSc6ICdwZWJibGVzJywgJ2FnZSc6IDEsICAnYmxvY2tlZCc6IGZhbHNlIH1cbiAgICAgKiBdO1xuICAgICAqXG4gICAgICogXy5maW5kSW5kZXgoY2hhcmFjdGVycywgZnVuY3Rpb24oY2hyKSB7XG4gICAgICogICByZXR1cm4gY2hyLmFnZSA8IDIwO1xuICAgICAqIH0pO1xuICAgICAqIC8vID0+IDJcbiAgICAgKlxuICAgICAqIC8vIHVzaW5nIFwiXy53aGVyZVwiIGNhbGxiYWNrIHNob3J0aGFuZFxuICAgICAqIF8uZmluZEluZGV4KGNoYXJhY3RlcnMsIHsgJ2FnZSc6IDM2IH0pO1xuICAgICAqIC8vID0+IDBcbiAgICAgKlxuICAgICAqIC8vIHVzaW5nIFwiXy5wbHVja1wiIGNhbGxiYWNrIHNob3J0aGFuZFxuICAgICAqIF8uZmluZEluZGV4KGNoYXJhY3RlcnMsICdibG9ja2VkJyk7XG4gICAgICogLy8gPT4gMVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGZpbmRJbmRleChhcnJheSwgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICAgIGxlbmd0aCA9IGFycmF5ID8gYXJyYXkubGVuZ3RoIDogMDtcblxuICAgICAgY2FsbGJhY2sgPSBsb2Rhc2guY3JlYXRlQ2FsbGJhY2soY2FsbGJhY2ssIHRoaXNBcmcsIDMpO1xuICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgaWYgKGNhbGxiYWNrKGFycmF5W2luZGV4XSwgaW5kZXgsIGFycmF5KSkge1xuICAgICAgICAgIHJldHVybiBpbmRleDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIC0xO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGxpa2UgYF8uZmluZEluZGV4YCBleGNlcHQgdGhhdCBpdCBpdGVyYXRlcyBvdmVyIGVsZW1lbnRzXG4gICAgICogb2YgYSBgY29sbGVjdGlvbmAgZnJvbSByaWdodCB0byBsZWZ0LlxuICAgICAqXG4gICAgICogSWYgYSBwcm9wZXJ0eSBuYW1lIGlzIHByb3ZpZGVkIGZvciBgY2FsbGJhY2tgIHRoZSBjcmVhdGVkIFwiXy5wbHVja1wiIHN0eWxlXG4gICAgICogY2FsbGJhY2sgd2lsbCByZXR1cm4gdGhlIHByb3BlcnR5IHZhbHVlIG9mIHRoZSBnaXZlbiBlbGVtZW50LlxuICAgICAqXG4gICAgICogSWYgYW4gb2JqZWN0IGlzIHByb3ZpZGVkIGZvciBgY2FsbGJhY2tgIHRoZSBjcmVhdGVkIFwiXy53aGVyZVwiIHN0eWxlIGNhbGxiYWNrXG4gICAgICogd2lsbCByZXR1cm4gYHRydWVgIGZvciBlbGVtZW50cyB0aGF0IGhhdmUgdGhlIHByb3BlcnRpZXMgb2YgdGhlIGdpdmVuIG9iamVjdCxcbiAgICAgKiBlbHNlIGBmYWxzZWAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlzXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIHNlYXJjaC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufE9iamVjdHxzdHJpbmd9IFtjYWxsYmFjaz1pZGVudGl0eV0gVGhlIGZ1bmN0aW9uIGNhbGxlZFxuICAgICAqICBwZXIgaXRlcmF0aW9uLiBJZiBhIHByb3BlcnR5IG5hbWUgb3Igb2JqZWN0IGlzIHByb3ZpZGVkIGl0IHdpbGwgYmUgdXNlZFxuICAgICAqICB0byBjcmVhdGUgYSBcIl8ucGx1Y2tcIiBvciBcIl8ud2hlcmVcIiBzdHlsZSBjYWxsYmFjaywgcmVzcGVjdGl2ZWx5LlxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgY2FsbGJhY2tgLlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIGluZGV4IG9mIHRoZSBmb3VuZCBlbGVtZW50LCBlbHNlIGAtMWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBjaGFyYWN0ZXJzID0gW1xuICAgICAqICAgeyAnbmFtZSc6ICdiYXJuZXknLCAgJ2FnZSc6IDM2LCAnYmxvY2tlZCc6IHRydWUgfSxcbiAgICAgKiAgIHsgJ25hbWUnOiAnZnJlZCcsICAgICdhZ2UnOiA0MCwgJ2Jsb2NrZWQnOiBmYWxzZSB9LFxuICAgICAqICAgeyAnbmFtZSc6ICdwZWJibGVzJywgJ2FnZSc6IDEsICAnYmxvY2tlZCc6IHRydWUgfVxuICAgICAqIF07XG4gICAgICpcbiAgICAgKiBfLmZpbmRMYXN0SW5kZXgoY2hhcmFjdGVycywgZnVuY3Rpb24oY2hyKSB7XG4gICAgICogICByZXR1cm4gY2hyLmFnZSA+IDMwO1xuICAgICAqIH0pO1xuICAgICAqIC8vID0+IDFcbiAgICAgKlxuICAgICAqIC8vIHVzaW5nIFwiXy53aGVyZVwiIGNhbGxiYWNrIHNob3J0aGFuZFxuICAgICAqIF8uZmluZExhc3RJbmRleChjaGFyYWN0ZXJzLCB7ICdhZ2UnOiAzNiB9KTtcbiAgICAgKiAvLyA9PiAwXG4gICAgICpcbiAgICAgKiAvLyB1c2luZyBcIl8ucGx1Y2tcIiBjYWxsYmFjayBzaG9ydGhhbmRcbiAgICAgKiBfLmZpbmRMYXN0SW5kZXgoY2hhcmFjdGVycywgJ2Jsb2NrZWQnKTtcbiAgICAgKiAvLyA9PiAyXG4gICAgICovXG4gICAgZnVuY3Rpb24gZmluZExhc3RJbmRleChhcnJheSwgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgIHZhciBsZW5ndGggPSBhcnJheSA/IGFycmF5Lmxlbmd0aCA6IDA7XG4gICAgICBjYWxsYmFjayA9IGxvZGFzaC5jcmVhdGVDYWxsYmFjayhjYWxsYmFjaywgdGhpc0FyZywgMyk7XG4gICAgICB3aGlsZSAobGVuZ3RoLS0pIHtcbiAgICAgICAgaWYgKGNhbGxiYWNrKGFycmF5W2xlbmd0aF0sIGxlbmd0aCwgYXJyYXkpKSB7XG4gICAgICAgICAgcmV0dXJuIGxlbmd0aDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIC0xO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGZpcnN0IGVsZW1lbnQgb3IgZmlyc3QgYG5gIGVsZW1lbnRzIG9mIGFuIGFycmF5LiBJZiBhIGNhbGxiYWNrXG4gICAgICogaXMgcHJvdmlkZWQgZWxlbWVudHMgYXQgdGhlIGJlZ2lubmluZyBvZiB0aGUgYXJyYXkgYXJlIHJldHVybmVkIGFzIGxvbmdcbiAgICAgKiBhcyB0aGUgY2FsbGJhY2sgcmV0dXJucyB0cnVleS4gVGhlIGNhbGxiYWNrIGlzIGJvdW5kIHRvIGB0aGlzQXJnYCBhbmRcbiAgICAgKiBpbnZva2VkIHdpdGggdGhyZWUgYXJndW1lbnRzOyAodmFsdWUsIGluZGV4LCBhcnJheSkuXG4gICAgICpcbiAgICAgKiBJZiBhIHByb3BlcnR5IG5hbWUgaXMgcHJvdmlkZWQgZm9yIGBjYWxsYmFja2AgdGhlIGNyZWF0ZWQgXCJfLnBsdWNrXCIgc3R5bGVcbiAgICAgKiBjYWxsYmFjayB3aWxsIHJldHVybiB0aGUgcHJvcGVydHkgdmFsdWUgb2YgdGhlIGdpdmVuIGVsZW1lbnQuXG4gICAgICpcbiAgICAgKiBJZiBhbiBvYmplY3QgaXMgcHJvdmlkZWQgZm9yIGBjYWxsYmFja2AgdGhlIGNyZWF0ZWQgXCJfLndoZXJlXCIgc3R5bGUgY2FsbGJhY2tcbiAgICAgKiB3aWxsIHJldHVybiBgdHJ1ZWAgZm9yIGVsZW1lbnRzIHRoYXQgaGF2ZSB0aGUgcHJvcGVydGllcyBvZiB0aGUgZ2l2ZW4gb2JqZWN0LFxuICAgICAqIGVsc2UgYGZhbHNlYC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBhbGlhcyBoZWFkLCB0YWtlXG4gICAgICogQGNhdGVnb3J5IEFycmF5c1xuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBxdWVyeS5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufE9iamVjdHxudW1iZXJ8c3RyaW5nfSBbY2FsbGJhY2tdIFRoZSBmdW5jdGlvbiBjYWxsZWRcbiAgICAgKiAgcGVyIGVsZW1lbnQgb3IgdGhlIG51bWJlciBvZiBlbGVtZW50cyB0byByZXR1cm4uIElmIGEgcHJvcGVydHkgbmFtZSBvclxuICAgICAqICBvYmplY3QgaXMgcHJvdmlkZWQgaXQgd2lsbCBiZSB1c2VkIHRvIGNyZWF0ZSBhIFwiXy5wbHVja1wiIG9yIFwiXy53aGVyZVwiXG4gICAgICogIHN0eWxlIGNhbGxiYWNrLCByZXNwZWN0aXZlbHkuXG4gICAgICogQHBhcmFtIHsqfSBbdGhpc0FyZ10gVGhlIGB0aGlzYCBiaW5kaW5nIG9mIGBjYWxsYmFja2AuXG4gICAgICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIGZpcnN0IGVsZW1lbnQocykgb2YgYGFycmF5YC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5maXJzdChbMSwgMiwgM10pO1xuICAgICAqIC8vID0+IDFcbiAgICAgKlxuICAgICAqIF8uZmlyc3QoWzEsIDIsIDNdLCAyKTtcbiAgICAgKiAvLyA9PiBbMSwgMl1cbiAgICAgKlxuICAgICAqIF8uZmlyc3QoWzEsIDIsIDNdLCBmdW5jdGlvbihudW0pIHtcbiAgICAgKiAgIHJldHVybiBudW0gPCAzO1xuICAgICAqIH0pO1xuICAgICAqIC8vID0+IFsxLCAyXVxuICAgICAqXG4gICAgICogdmFyIGNoYXJhY3RlcnMgPSBbXG4gICAgICogICB7ICduYW1lJzogJ2Jhcm5leScsICAnYmxvY2tlZCc6IHRydWUsICAnZW1wbG95ZXInOiAnc2xhdGUnIH0sXG4gICAgICogICB7ICduYW1lJzogJ2ZyZWQnLCAgICAnYmxvY2tlZCc6IGZhbHNlLCAnZW1wbG95ZXInOiAnc2xhdGUnIH0sXG4gICAgICogICB7ICduYW1lJzogJ3BlYmJsZXMnLCAnYmxvY2tlZCc6IHRydWUsICAnZW1wbG95ZXInOiAnbmEnIH1cbiAgICAgKiBdO1xuICAgICAqXG4gICAgICogLy8gdXNpbmcgXCJfLnBsdWNrXCIgY2FsbGJhY2sgc2hvcnRoYW5kXG4gICAgICogXy5maXJzdChjaGFyYWN0ZXJzLCAnYmxvY2tlZCcpO1xuICAgICAqIC8vID0+IFt7ICduYW1lJzogJ2Jhcm5leScsICdibG9ja2VkJzogdHJ1ZSwgJ2VtcGxveWVyJzogJ3NsYXRlJyB9XVxuICAgICAqXG4gICAgICogLy8gdXNpbmcgXCJfLndoZXJlXCIgY2FsbGJhY2sgc2hvcnRoYW5kXG4gICAgICogXy5wbHVjayhfLmZpcnN0KGNoYXJhY3RlcnMsIHsgJ2VtcGxveWVyJzogJ3NsYXRlJyB9KSwgJ25hbWUnKTtcbiAgICAgKiAvLyA9PiBbJ2Jhcm5leScsICdmcmVkJ11cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBmaXJzdChhcnJheSwgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgIHZhciBuID0gMCxcbiAgICAgICAgICBsZW5ndGggPSBhcnJheSA/IGFycmF5Lmxlbmd0aCA6IDA7XG5cbiAgICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgIT0gJ251bWJlcicgJiYgY2FsbGJhY2sgIT0gbnVsbCkge1xuICAgICAgICB2YXIgaW5kZXggPSAtMTtcbiAgICAgICAgY2FsbGJhY2sgPSBsb2Rhc2guY3JlYXRlQ2FsbGJhY2soY2FsbGJhY2ssIHRoaXNBcmcsIDMpO1xuICAgICAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCAmJiBjYWxsYmFjayhhcnJheVtpbmRleF0sIGluZGV4LCBhcnJheSkpIHtcbiAgICAgICAgICBuKys7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG4gPSBjYWxsYmFjaztcbiAgICAgICAgaWYgKG4gPT0gbnVsbCB8fCB0aGlzQXJnKSB7XG4gICAgICAgICAgcmV0dXJuIGFycmF5ID8gYXJyYXlbMF0gOiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBzbGljZShhcnJheSwgMCwgbmF0aXZlTWluKG5hdGl2ZU1heCgwLCBuKSwgbGVuZ3RoKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRmxhdHRlbnMgYSBuZXN0ZWQgYXJyYXkgKHRoZSBuZXN0aW5nIGNhbiBiZSB0byBhbnkgZGVwdGgpLiBJZiBgaXNTaGFsbG93YFxuICAgICAqIGlzIHRydWV5LCB0aGUgYXJyYXkgd2lsbCBvbmx5IGJlIGZsYXR0ZW5lZCBhIHNpbmdsZSBsZXZlbC4gSWYgYSBjYWxsYmFja1xuICAgICAqIGlzIHByb3ZpZGVkIGVhY2ggZWxlbWVudCBvZiB0aGUgYXJyYXkgaXMgcGFzc2VkIHRocm91Z2ggdGhlIGNhbGxiYWNrIGJlZm9yZVxuICAgICAqIGZsYXR0ZW5pbmcuIFRoZSBjYWxsYmFjayBpcyBib3VuZCB0byBgdGhpc0FyZ2AgYW5kIGludm9rZWQgd2l0aCB0aHJlZVxuICAgICAqIGFyZ3VtZW50czsgKHZhbHVlLCBpbmRleCwgYXJyYXkpLlxuICAgICAqXG4gICAgICogSWYgYSBwcm9wZXJ0eSBuYW1lIGlzIHByb3ZpZGVkIGZvciBgY2FsbGJhY2tgIHRoZSBjcmVhdGVkIFwiXy5wbHVja1wiIHN0eWxlXG4gICAgICogY2FsbGJhY2sgd2lsbCByZXR1cm4gdGhlIHByb3BlcnR5IHZhbHVlIG9mIHRoZSBnaXZlbiBlbGVtZW50LlxuICAgICAqXG4gICAgICogSWYgYW4gb2JqZWN0IGlzIHByb3ZpZGVkIGZvciBgY2FsbGJhY2tgIHRoZSBjcmVhdGVkIFwiXy53aGVyZVwiIHN0eWxlIGNhbGxiYWNrXG4gICAgICogd2lsbCByZXR1cm4gYHRydWVgIGZvciBlbGVtZW50cyB0aGF0IGhhdmUgdGhlIHByb3BlcnRpZXMgb2YgdGhlIGdpdmVuIG9iamVjdCxcbiAgICAgKiBlbHNlIGBmYWxzZWAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlzXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGZsYXR0ZW4uXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbaXNTaGFsbG93PWZhbHNlXSBBIGZsYWcgdG8gcmVzdHJpY3QgZmxhdHRlbmluZyB0byBhIHNpbmdsZSBsZXZlbC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufE9iamVjdHxzdHJpbmd9IFtjYWxsYmFjaz1pZGVudGl0eV0gVGhlIGZ1bmN0aW9uIGNhbGxlZFxuICAgICAqICBwZXIgaXRlcmF0aW9uLiBJZiBhIHByb3BlcnR5IG5hbWUgb3Igb2JqZWN0IGlzIHByb3ZpZGVkIGl0IHdpbGwgYmUgdXNlZFxuICAgICAqICB0byBjcmVhdGUgYSBcIl8ucGx1Y2tcIiBvciBcIl8ud2hlcmVcIiBzdHlsZSBjYWxsYmFjaywgcmVzcGVjdGl2ZWx5LlxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgY2FsbGJhY2tgLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyBhIG5ldyBmbGF0dGVuZWQgYXJyYXkuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uZmxhdHRlbihbMSwgWzJdLCBbMywgW1s0XV1dXSk7XG4gICAgICogLy8gPT4gWzEsIDIsIDMsIDRdO1xuICAgICAqXG4gICAgICogXy5mbGF0dGVuKFsxLCBbMl0sIFszLCBbWzRdXV1dLCB0cnVlKTtcbiAgICAgKiAvLyA9PiBbMSwgMiwgMywgW1s0XV1dO1xuICAgICAqXG4gICAgICogdmFyIGNoYXJhY3RlcnMgPSBbXG4gICAgICogICB7ICduYW1lJzogJ2Jhcm5leScsICdhZ2UnOiAzMCwgJ3BldHMnOiBbJ2hvcHB5J10gfSxcbiAgICAgKiAgIHsgJ25hbWUnOiAnZnJlZCcsICAgJ2FnZSc6IDQwLCAncGV0cyc6IFsnYmFieSBwdXNzJywgJ2Rpbm8nXSB9XG4gICAgICogXTtcbiAgICAgKlxuICAgICAqIC8vIHVzaW5nIFwiXy5wbHVja1wiIGNhbGxiYWNrIHNob3J0aGFuZFxuICAgICAqIF8uZmxhdHRlbihjaGFyYWN0ZXJzLCAncGV0cycpO1xuICAgICAqIC8vID0+IFsnaG9wcHknLCAnYmFieSBwdXNzJywgJ2Rpbm8nXVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGZsYXR0ZW4oYXJyYXksIGlzU2hhbGxvdywgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgIC8vIGp1Z2dsZSBhcmd1bWVudHNcbiAgICAgIGlmICh0eXBlb2YgaXNTaGFsbG93ICE9ICdib29sZWFuJyAmJiBpc1NoYWxsb3cgIT0gbnVsbCkge1xuICAgICAgICB0aGlzQXJnID0gY2FsbGJhY2s7XG4gICAgICAgIGNhbGxiYWNrID0gKHR5cGVvZiBpc1NoYWxsb3cgIT0gJ2Z1bmN0aW9uJyAmJiB0aGlzQXJnICYmIHRoaXNBcmdbaXNTaGFsbG93XSA9PT0gYXJyYXkpID8gbnVsbCA6IGlzU2hhbGxvdztcbiAgICAgICAgaXNTaGFsbG93ID0gZmFsc2U7XG4gICAgICB9XG4gICAgICBpZiAoY2FsbGJhY2sgIT0gbnVsbCkge1xuICAgICAgICBhcnJheSA9IG1hcChhcnJheSwgY2FsbGJhY2ssIHRoaXNBcmcpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGJhc2VGbGF0dGVuKGFycmF5LCBpc1NoYWxsb3cpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGluZGV4IGF0IHdoaWNoIHRoZSBmaXJzdCBvY2N1cnJlbmNlIG9mIGB2YWx1ZWAgaXMgZm91bmQgdXNpbmdcbiAgICAgKiBzdHJpY3QgZXF1YWxpdHkgZm9yIGNvbXBhcmlzb25zLCBpLmUuIGA9PT1gLiBJZiB0aGUgYXJyYXkgaXMgYWxyZWFkeSBzb3J0ZWRcbiAgICAgKiBwcm92aWRpbmcgYHRydWVgIGZvciBgZnJvbUluZGV4YCB3aWxsIHJ1biBhIGZhc3RlciBiaW5hcnkgc2VhcmNoLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IEFycmF5c1xuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBzZWFyY2guXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gc2VhcmNoIGZvci5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW58bnVtYmVyfSBbZnJvbUluZGV4PTBdIFRoZSBpbmRleCB0byBzZWFyY2ggZnJvbSBvciBgdHJ1ZWBcbiAgICAgKiAgdG8gcGVyZm9ybSBhIGJpbmFyeSBzZWFyY2ggb24gYSBzb3J0ZWQgYXJyYXkuXG4gICAgICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgaW5kZXggb2YgdGhlIG1hdGNoZWQgdmFsdWUgb3IgYC0xYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5pbmRleE9mKFsxLCAyLCAzLCAxLCAyLCAzXSwgMik7XG4gICAgICogLy8gPT4gMVxuICAgICAqXG4gICAgICogXy5pbmRleE9mKFsxLCAyLCAzLCAxLCAyLCAzXSwgMiwgMyk7XG4gICAgICogLy8gPT4gNFxuICAgICAqXG4gICAgICogXy5pbmRleE9mKFsxLCAxLCAyLCAyLCAzLCAzXSwgMiwgdHJ1ZSk7XG4gICAgICogLy8gPT4gMlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGluZGV4T2YoYXJyYXksIHZhbHVlLCBmcm9tSW5kZXgpIHtcbiAgICAgIGlmICh0eXBlb2YgZnJvbUluZGV4ID09ICdudW1iZXInKSB7XG4gICAgICAgIHZhciBsZW5ndGggPSBhcnJheSA/IGFycmF5Lmxlbmd0aCA6IDA7XG4gICAgICAgIGZyb21JbmRleCA9IChmcm9tSW5kZXggPCAwID8gbmF0aXZlTWF4KDAsIGxlbmd0aCArIGZyb21JbmRleCkgOiBmcm9tSW5kZXggfHwgMCk7XG4gICAgICB9IGVsc2UgaWYgKGZyb21JbmRleCkge1xuICAgICAgICB2YXIgaW5kZXggPSBzb3J0ZWRJbmRleChhcnJheSwgdmFsdWUpO1xuICAgICAgICByZXR1cm4gYXJyYXlbaW5kZXhdID09PSB2YWx1ZSA/IGluZGV4IDogLTE7XG4gICAgICB9XG4gICAgICByZXR1cm4gYmFzZUluZGV4T2YoYXJyYXksIHZhbHVlLCBmcm9tSW5kZXgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgYWxsIGJ1dCB0aGUgbGFzdCBlbGVtZW50IG9yIGxhc3QgYG5gIGVsZW1lbnRzIG9mIGFuIGFycmF5LiBJZiBhXG4gICAgICogY2FsbGJhY2sgaXMgcHJvdmlkZWQgZWxlbWVudHMgYXQgdGhlIGVuZCBvZiB0aGUgYXJyYXkgYXJlIGV4Y2x1ZGVkIGZyb21cbiAgICAgKiB0aGUgcmVzdWx0IGFzIGxvbmcgYXMgdGhlIGNhbGxiYWNrIHJldHVybnMgdHJ1ZXkuIFRoZSBjYWxsYmFjayBpcyBib3VuZFxuICAgICAqIHRvIGB0aGlzQXJnYCBhbmQgaW52b2tlZCB3aXRoIHRocmVlIGFyZ3VtZW50czsgKHZhbHVlLCBpbmRleCwgYXJyYXkpLlxuICAgICAqXG4gICAgICogSWYgYSBwcm9wZXJ0eSBuYW1lIGlzIHByb3ZpZGVkIGZvciBgY2FsbGJhY2tgIHRoZSBjcmVhdGVkIFwiXy5wbHVja1wiIHN0eWxlXG4gICAgICogY2FsbGJhY2sgd2lsbCByZXR1cm4gdGhlIHByb3BlcnR5IHZhbHVlIG9mIHRoZSBnaXZlbiBlbGVtZW50LlxuICAgICAqXG4gICAgICogSWYgYW4gb2JqZWN0IGlzIHByb3ZpZGVkIGZvciBgY2FsbGJhY2tgIHRoZSBjcmVhdGVkIFwiXy53aGVyZVwiIHN0eWxlIGNhbGxiYWNrXG4gICAgICogd2lsbCByZXR1cm4gYHRydWVgIGZvciBlbGVtZW50cyB0aGF0IGhhdmUgdGhlIHByb3BlcnRpZXMgb2YgdGhlIGdpdmVuIG9iamVjdCxcbiAgICAgKiBlbHNlIGBmYWxzZWAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlzXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIHF1ZXJ5LlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb258T2JqZWN0fG51bWJlcnxzdHJpbmd9IFtjYWxsYmFjaz0xXSBUaGUgZnVuY3Rpb24gY2FsbGVkXG4gICAgICogIHBlciBlbGVtZW50IG9yIHRoZSBudW1iZXIgb2YgZWxlbWVudHMgdG8gZXhjbHVkZS4gSWYgYSBwcm9wZXJ0eSBuYW1lIG9yXG4gICAgICogIG9iamVjdCBpcyBwcm92aWRlZCBpdCB3aWxsIGJlIHVzZWQgdG8gY3JlYXRlIGEgXCJfLnBsdWNrXCIgb3IgXCJfLndoZXJlXCJcbiAgICAgKiAgc3R5bGUgY2FsbGJhY2ssIHJlc3BlY3RpdmVseS5cbiAgICAgKiBAcGFyYW0geyp9IFt0aGlzQXJnXSBUaGUgYHRoaXNgIGJpbmRpbmcgb2YgYGNhbGxiYWNrYC5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgYSBzbGljZSBvZiBgYXJyYXlgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmluaXRpYWwoWzEsIDIsIDNdKTtcbiAgICAgKiAvLyA9PiBbMSwgMl1cbiAgICAgKlxuICAgICAqIF8uaW5pdGlhbChbMSwgMiwgM10sIDIpO1xuICAgICAqIC8vID0+IFsxXVxuICAgICAqXG4gICAgICogXy5pbml0aWFsKFsxLCAyLCAzXSwgZnVuY3Rpb24obnVtKSB7XG4gICAgICogICByZXR1cm4gbnVtID4gMTtcbiAgICAgKiB9KTtcbiAgICAgKiAvLyA9PiBbMV1cbiAgICAgKlxuICAgICAqIHZhciBjaGFyYWN0ZXJzID0gW1xuICAgICAqICAgeyAnbmFtZSc6ICdiYXJuZXknLCAgJ2Jsb2NrZWQnOiBmYWxzZSwgJ2VtcGxveWVyJzogJ3NsYXRlJyB9LFxuICAgICAqICAgeyAnbmFtZSc6ICdmcmVkJywgICAgJ2Jsb2NrZWQnOiB0cnVlLCAgJ2VtcGxveWVyJzogJ3NsYXRlJyB9LFxuICAgICAqICAgeyAnbmFtZSc6ICdwZWJibGVzJywgJ2Jsb2NrZWQnOiB0cnVlLCAgJ2VtcGxveWVyJzogJ25hJyB9XG4gICAgICogXTtcbiAgICAgKlxuICAgICAqIC8vIHVzaW5nIFwiXy5wbHVja1wiIGNhbGxiYWNrIHNob3J0aGFuZFxuICAgICAqIF8uaW5pdGlhbChjaGFyYWN0ZXJzLCAnYmxvY2tlZCcpO1xuICAgICAqIC8vID0+IFt7ICduYW1lJzogJ2Jhcm5leScsICAnYmxvY2tlZCc6IGZhbHNlLCAnZW1wbG95ZXInOiAnc2xhdGUnIH1dXG4gICAgICpcbiAgICAgKiAvLyB1c2luZyBcIl8ud2hlcmVcIiBjYWxsYmFjayBzaG9ydGhhbmRcbiAgICAgKiBfLnBsdWNrKF8uaW5pdGlhbChjaGFyYWN0ZXJzLCB7ICdlbXBsb3llcic6ICduYScgfSksICduYW1lJyk7XG4gICAgICogLy8gPT4gWydiYXJuZXknLCAnZnJlZCddXG4gICAgICovXG4gICAgZnVuY3Rpb24gaW5pdGlhbChhcnJheSwgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgIHZhciBuID0gMCxcbiAgICAgICAgICBsZW5ndGggPSBhcnJheSA/IGFycmF5Lmxlbmd0aCA6IDA7XG5cbiAgICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgIT0gJ251bWJlcicgJiYgY2FsbGJhY2sgIT0gbnVsbCkge1xuICAgICAgICB2YXIgaW5kZXggPSBsZW5ndGg7XG4gICAgICAgIGNhbGxiYWNrID0gbG9kYXNoLmNyZWF0ZUNhbGxiYWNrKGNhbGxiYWNrLCB0aGlzQXJnLCAzKTtcbiAgICAgICAgd2hpbGUgKGluZGV4LS0gJiYgY2FsbGJhY2soYXJyYXlbaW5kZXhdLCBpbmRleCwgYXJyYXkpKSB7XG4gICAgICAgICAgbisrO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBuID0gKGNhbGxiYWNrID09IG51bGwgfHwgdGhpc0FyZykgPyAxIDogY2FsbGJhY2sgfHwgbjtcbiAgICAgIH1cbiAgICAgIHJldHVybiBzbGljZShhcnJheSwgMCwgbmF0aXZlTWluKG5hdGl2ZU1heCgwLCBsZW5ndGggLSBuKSwgbGVuZ3RoKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBhcnJheSBvZiB1bmlxdWUgdmFsdWVzIHByZXNlbnQgaW4gYWxsIHByb3ZpZGVkIGFycmF5cyB1c2luZ1xuICAgICAqIHN0cmljdCBlcXVhbGl0eSBmb3IgY29tcGFyaXNvbnMsIGkuZS4gYD09PWAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlzXG4gICAgICogQHBhcmFtIHsuLi5BcnJheX0gW2FycmF5XSBUaGUgYXJyYXlzIHRvIGluc3BlY3QuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIGFuIGFycmF5IG9mIHNoYXJlZCB2YWx1ZXMuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uaW50ZXJzZWN0aW9uKFsxLCAyLCAzXSwgWzUsIDIsIDEsIDRdLCBbMiwgMV0pO1xuICAgICAqIC8vID0+IFsxLCAyXVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGludGVyc2VjdGlvbigpIHtcbiAgICAgIHZhciBhcmdzID0gW10sXG4gICAgICAgICAgYXJnc0luZGV4ID0gLTEsXG4gICAgICAgICAgYXJnc0xlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGgsXG4gICAgICAgICAgY2FjaGVzID0gZ2V0QXJyYXkoKSxcbiAgICAgICAgICBpbmRleE9mID0gZ2V0SW5kZXhPZigpLFxuICAgICAgICAgIHRydXN0SW5kZXhPZiA9IGluZGV4T2YgPT09IGJhc2VJbmRleE9mLFxuICAgICAgICAgIHNlZW4gPSBnZXRBcnJheSgpO1xuXG4gICAgICB3aGlsZSAoKythcmdzSW5kZXggPCBhcmdzTGVuZ3RoKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IGFyZ3VtZW50c1thcmdzSW5kZXhdO1xuICAgICAgICBpZiAoaXNBcnJheSh2YWx1ZSkgfHwgaXNBcmd1bWVudHModmFsdWUpKSB7XG4gICAgICAgICAgYXJncy5wdXNoKHZhbHVlKTtcbiAgICAgICAgICBjYWNoZXMucHVzaCh0cnVzdEluZGV4T2YgJiYgdmFsdWUubGVuZ3RoID49IGxhcmdlQXJyYXlTaXplICYmXG4gICAgICAgICAgICBjcmVhdGVDYWNoZShhcmdzSW5kZXggPyBhcmdzW2FyZ3NJbmRleF0gOiBzZWVuKSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHZhciBhcnJheSA9IGFyZ3NbMF0sXG4gICAgICAgICAgaW5kZXggPSAtMSxcbiAgICAgICAgICBsZW5ndGggPSBhcnJheSA/IGFycmF5Lmxlbmd0aCA6IDAsXG4gICAgICAgICAgcmVzdWx0ID0gW107XG5cbiAgICAgIG91dGVyOlxuICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgdmFyIGNhY2hlID0gY2FjaGVzWzBdO1xuICAgICAgICB2YWx1ZSA9IGFycmF5W2luZGV4XTtcblxuICAgICAgICBpZiAoKGNhY2hlID8gY2FjaGVJbmRleE9mKGNhY2hlLCB2YWx1ZSkgOiBpbmRleE9mKHNlZW4sIHZhbHVlKSkgPCAwKSB7XG4gICAgICAgICAgYXJnc0luZGV4ID0gYXJnc0xlbmd0aDtcbiAgICAgICAgICAoY2FjaGUgfHwgc2VlbikucHVzaCh2YWx1ZSk7XG4gICAgICAgICAgd2hpbGUgKC0tYXJnc0luZGV4KSB7XG4gICAgICAgICAgICBjYWNoZSA9IGNhY2hlc1thcmdzSW5kZXhdO1xuICAgICAgICAgICAgaWYgKChjYWNoZSA/IGNhY2hlSW5kZXhPZihjYWNoZSwgdmFsdWUpIDogaW5kZXhPZihhcmdzW2FyZ3NJbmRleF0sIHZhbHVlKSkgPCAwKSB7XG4gICAgICAgICAgICAgIGNvbnRpbnVlIG91dGVyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXN1bHQucHVzaCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHdoaWxlIChhcmdzTGVuZ3RoLS0pIHtcbiAgICAgICAgY2FjaGUgPSBjYWNoZXNbYXJnc0xlbmd0aF07XG4gICAgICAgIGlmIChjYWNoZSkge1xuICAgICAgICAgIHJlbGVhc2VPYmplY3QoY2FjaGUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZWxlYXNlQXJyYXkoY2FjaGVzKTtcbiAgICAgIHJlbGVhc2VBcnJheShzZWVuKTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgbGFzdCBlbGVtZW50IG9yIGxhc3QgYG5gIGVsZW1lbnRzIG9mIGFuIGFycmF5LiBJZiBhIGNhbGxiYWNrIGlzXG4gICAgICogcHJvdmlkZWQgZWxlbWVudHMgYXQgdGhlIGVuZCBvZiB0aGUgYXJyYXkgYXJlIHJldHVybmVkIGFzIGxvbmcgYXMgdGhlXG4gICAgICogY2FsbGJhY2sgcmV0dXJucyB0cnVleS4gVGhlIGNhbGxiYWNrIGlzIGJvdW5kIHRvIGB0aGlzQXJnYCBhbmQgaW52b2tlZFxuICAgICAqIHdpdGggdGhyZWUgYXJndW1lbnRzOyAodmFsdWUsIGluZGV4LCBhcnJheSkuXG4gICAgICpcbiAgICAgKiBJZiBhIHByb3BlcnR5IG5hbWUgaXMgcHJvdmlkZWQgZm9yIGBjYWxsYmFja2AgdGhlIGNyZWF0ZWQgXCJfLnBsdWNrXCIgc3R5bGVcbiAgICAgKiBjYWxsYmFjayB3aWxsIHJldHVybiB0aGUgcHJvcGVydHkgdmFsdWUgb2YgdGhlIGdpdmVuIGVsZW1lbnQuXG4gICAgICpcbiAgICAgKiBJZiBhbiBvYmplY3QgaXMgcHJvdmlkZWQgZm9yIGBjYWxsYmFja2AgdGhlIGNyZWF0ZWQgXCJfLndoZXJlXCIgc3R5bGUgY2FsbGJhY2tcbiAgICAgKiB3aWxsIHJldHVybiBgdHJ1ZWAgZm9yIGVsZW1lbnRzIHRoYXQgaGF2ZSB0aGUgcHJvcGVydGllcyBvZiB0aGUgZ2l2ZW4gb2JqZWN0LFxuICAgICAqIGVsc2UgYGZhbHNlYC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBBcnJheXNcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gcXVlcnkuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbnxPYmplY3R8bnVtYmVyfHN0cmluZ30gW2NhbGxiYWNrXSBUaGUgZnVuY3Rpb24gY2FsbGVkXG4gICAgICogIHBlciBlbGVtZW50IG9yIHRoZSBudW1iZXIgb2YgZWxlbWVudHMgdG8gcmV0dXJuLiBJZiBhIHByb3BlcnR5IG5hbWUgb3JcbiAgICAgKiAgb2JqZWN0IGlzIHByb3ZpZGVkIGl0IHdpbGwgYmUgdXNlZCB0byBjcmVhdGUgYSBcIl8ucGx1Y2tcIiBvciBcIl8ud2hlcmVcIlxuICAgICAqICBzdHlsZSBjYWxsYmFjaywgcmVzcGVjdGl2ZWx5LlxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgY2FsbGJhY2tgLlxuICAgICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSBsYXN0IGVsZW1lbnQocykgb2YgYGFycmF5YC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5sYXN0KFsxLCAyLCAzXSk7XG4gICAgICogLy8gPT4gM1xuICAgICAqXG4gICAgICogXy5sYXN0KFsxLCAyLCAzXSwgMik7XG4gICAgICogLy8gPT4gWzIsIDNdXG4gICAgICpcbiAgICAgKiBfLmxhc3QoWzEsIDIsIDNdLCBmdW5jdGlvbihudW0pIHtcbiAgICAgKiAgIHJldHVybiBudW0gPiAxO1xuICAgICAqIH0pO1xuICAgICAqIC8vID0+IFsyLCAzXVxuICAgICAqXG4gICAgICogdmFyIGNoYXJhY3RlcnMgPSBbXG4gICAgICogICB7ICduYW1lJzogJ2Jhcm5leScsICAnYmxvY2tlZCc6IGZhbHNlLCAnZW1wbG95ZXInOiAnc2xhdGUnIH0sXG4gICAgICogICB7ICduYW1lJzogJ2ZyZWQnLCAgICAnYmxvY2tlZCc6IHRydWUsICAnZW1wbG95ZXInOiAnc2xhdGUnIH0sXG4gICAgICogICB7ICduYW1lJzogJ3BlYmJsZXMnLCAnYmxvY2tlZCc6IHRydWUsICAnZW1wbG95ZXInOiAnbmEnIH1cbiAgICAgKiBdO1xuICAgICAqXG4gICAgICogLy8gdXNpbmcgXCJfLnBsdWNrXCIgY2FsbGJhY2sgc2hvcnRoYW5kXG4gICAgICogXy5wbHVjayhfLmxhc3QoY2hhcmFjdGVycywgJ2Jsb2NrZWQnKSwgJ25hbWUnKTtcbiAgICAgKiAvLyA9PiBbJ2ZyZWQnLCAncGViYmxlcyddXG4gICAgICpcbiAgICAgKiAvLyB1c2luZyBcIl8ud2hlcmVcIiBjYWxsYmFjayBzaG9ydGhhbmRcbiAgICAgKiBfLmxhc3QoY2hhcmFjdGVycywgeyAnZW1wbG95ZXInOiAnbmEnIH0pO1xuICAgICAqIC8vID0+IFt7ICduYW1lJzogJ3BlYmJsZXMnLCAnYmxvY2tlZCc6IHRydWUsICdlbXBsb3llcic6ICduYScgfV1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBsYXN0KGFycmF5LCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgdmFyIG4gPSAwLFxuICAgICAgICAgIGxlbmd0aCA9IGFycmF5ID8gYXJyYXkubGVuZ3RoIDogMDtcblxuICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayAhPSAnbnVtYmVyJyAmJiBjYWxsYmFjayAhPSBudWxsKSB7XG4gICAgICAgIHZhciBpbmRleCA9IGxlbmd0aDtcbiAgICAgICAgY2FsbGJhY2sgPSBsb2Rhc2guY3JlYXRlQ2FsbGJhY2soY2FsbGJhY2ssIHRoaXNBcmcsIDMpO1xuICAgICAgICB3aGlsZSAoaW5kZXgtLSAmJiBjYWxsYmFjayhhcnJheVtpbmRleF0sIGluZGV4LCBhcnJheSkpIHtcbiAgICAgICAgICBuKys7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG4gPSBjYWxsYmFjaztcbiAgICAgICAgaWYgKG4gPT0gbnVsbCB8fCB0aGlzQXJnKSB7XG4gICAgICAgICAgcmV0dXJuIGFycmF5ID8gYXJyYXlbbGVuZ3RoIC0gMV0gOiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBzbGljZShhcnJheSwgbmF0aXZlTWF4KDAsIGxlbmd0aCAtIG4pKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBpbmRleCBhdCB3aGljaCB0aGUgbGFzdCBvY2N1cnJlbmNlIG9mIGB2YWx1ZWAgaXMgZm91bmQgdXNpbmcgc3RyaWN0XG4gICAgICogZXF1YWxpdHkgZm9yIGNvbXBhcmlzb25zLCBpLmUuIGA9PT1gLiBJZiBgZnJvbUluZGV4YCBpcyBuZWdhdGl2ZSwgaXQgaXMgdXNlZFxuICAgICAqIGFzIHRoZSBvZmZzZXQgZnJvbSB0aGUgZW5kIG9mIHRoZSBjb2xsZWN0aW9uLlxuICAgICAqXG4gICAgICogSWYgYSBwcm9wZXJ0eSBuYW1lIGlzIHByb3ZpZGVkIGZvciBgY2FsbGJhY2tgIHRoZSBjcmVhdGVkIFwiXy5wbHVja1wiIHN0eWxlXG4gICAgICogY2FsbGJhY2sgd2lsbCByZXR1cm4gdGhlIHByb3BlcnR5IHZhbHVlIG9mIHRoZSBnaXZlbiBlbGVtZW50LlxuICAgICAqXG4gICAgICogSWYgYW4gb2JqZWN0IGlzIHByb3ZpZGVkIGZvciBgY2FsbGJhY2tgIHRoZSBjcmVhdGVkIFwiXy53aGVyZVwiIHN0eWxlIGNhbGxiYWNrXG4gICAgICogd2lsbCByZXR1cm4gYHRydWVgIGZvciBlbGVtZW50cyB0aGF0IGhhdmUgdGhlIHByb3BlcnRpZXMgb2YgdGhlIGdpdmVuIG9iamVjdCxcbiAgICAgKiBlbHNlIGBmYWxzZWAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlzXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIHNlYXJjaC5cbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBzZWFyY2ggZm9yLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbZnJvbUluZGV4PWFycmF5Lmxlbmd0aC0xXSBUaGUgaW5kZXggdG8gc2VhcmNoIGZyb20uXG4gICAgICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgaW5kZXggb2YgdGhlIG1hdGNoZWQgdmFsdWUgb3IgYC0xYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5sYXN0SW5kZXhPZihbMSwgMiwgMywgMSwgMiwgM10sIDIpO1xuICAgICAqIC8vID0+IDRcbiAgICAgKlxuICAgICAqIF8ubGFzdEluZGV4T2YoWzEsIDIsIDMsIDEsIDIsIDNdLCAyLCAzKTtcbiAgICAgKiAvLyA9PiAxXG4gICAgICovXG4gICAgZnVuY3Rpb24gbGFzdEluZGV4T2YoYXJyYXksIHZhbHVlLCBmcm9tSW5kZXgpIHtcbiAgICAgIHZhciBpbmRleCA9IGFycmF5ID8gYXJyYXkubGVuZ3RoIDogMDtcbiAgICAgIGlmICh0eXBlb2YgZnJvbUluZGV4ID09ICdudW1iZXInKSB7XG4gICAgICAgIGluZGV4ID0gKGZyb21JbmRleCA8IDAgPyBuYXRpdmVNYXgoMCwgaW5kZXggKyBmcm9tSW5kZXgpIDogbmF0aXZlTWluKGZyb21JbmRleCwgaW5kZXggLSAxKSkgKyAxO1xuICAgICAgfVxuICAgICAgd2hpbGUgKGluZGV4LS0pIHtcbiAgICAgICAgaWYgKGFycmF5W2luZGV4XSA9PT0gdmFsdWUpIHtcbiAgICAgICAgICByZXR1cm4gaW5kZXg7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiAtMTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIGFsbCBwcm92aWRlZCB2YWx1ZXMgZnJvbSB0aGUgZ2l2ZW4gYXJyYXkgdXNpbmcgc3RyaWN0IGVxdWFsaXR5IGZvclxuICAgICAqIGNvbXBhcmlzb25zLCBpLmUuIGA9PT1gLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IEFycmF5c1xuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBtb2RpZnkuXG4gICAgICogQHBhcmFtIHsuLi4qfSBbdmFsdWVdIFRoZSB2YWx1ZXMgdG8gcmVtb3ZlLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyBgYXJyYXlgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgYXJyYXkgPSBbMSwgMiwgMywgMSwgMiwgM107XG4gICAgICogXy5wdWxsKGFycmF5LCAyLCAzKTtcbiAgICAgKiBjb25zb2xlLmxvZyhhcnJheSk7XG4gICAgICogLy8gPT4gWzEsIDFdXG4gICAgICovXG4gICAgZnVuY3Rpb24gcHVsbChhcnJheSkge1xuICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHMsXG4gICAgICAgICAgYXJnc0luZGV4ID0gMCxcbiAgICAgICAgICBhcmdzTGVuZ3RoID0gYXJncy5sZW5ndGgsXG4gICAgICAgICAgbGVuZ3RoID0gYXJyYXkgPyBhcnJheS5sZW5ndGggOiAwO1xuXG4gICAgICB3aGlsZSAoKythcmdzSW5kZXggPCBhcmdzTGVuZ3RoKSB7XG4gICAgICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICAgICAgdmFsdWUgPSBhcmdzW2FyZ3NJbmRleF07XG4gICAgICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgICAgaWYgKGFycmF5W2luZGV4XSA9PT0gdmFsdWUpIHtcbiAgICAgICAgICAgIHNwbGljZS5jYWxsKGFycmF5LCBpbmRleC0tLCAxKTtcbiAgICAgICAgICAgIGxlbmd0aC0tO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGFycmF5O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gYXJyYXkgb2YgbnVtYmVycyAocG9zaXRpdmUgYW5kL29yIG5lZ2F0aXZlKSBwcm9ncmVzc2luZyBmcm9tXG4gICAgICogYHN0YXJ0YCB1cCB0byBidXQgbm90IGluY2x1ZGluZyBgZW5kYC4gSWYgYHN0YXJ0YCBpcyBsZXNzIHRoYW4gYHN0b3BgIGFcbiAgICAgKiB6ZXJvLWxlbmd0aCByYW5nZSBpcyBjcmVhdGVkIHVubGVzcyBhIG5lZ2F0aXZlIGBzdGVwYCBpcyBzcGVjaWZpZWQuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlzXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtzdGFydD0wXSBUaGUgc3RhcnQgb2YgdGhlIHJhbmdlLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBlbmQgVGhlIGVuZCBvZiB0aGUgcmFuZ2UuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtzdGVwPTFdIFRoZSB2YWx1ZSB0byBpbmNyZW1lbnQgb3IgZGVjcmVtZW50IGJ5LlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyBhIG5ldyByYW5nZSBhcnJheS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5yYW5nZSg0KTtcbiAgICAgKiAvLyA9PiBbMCwgMSwgMiwgM11cbiAgICAgKlxuICAgICAqIF8ucmFuZ2UoMSwgNSk7XG4gICAgICogLy8gPT4gWzEsIDIsIDMsIDRdXG4gICAgICpcbiAgICAgKiBfLnJhbmdlKDAsIDIwLCA1KTtcbiAgICAgKiAvLyA9PiBbMCwgNSwgMTAsIDE1XVxuICAgICAqXG4gICAgICogXy5yYW5nZSgwLCAtNCwgLTEpO1xuICAgICAqIC8vID0+IFswLCAtMSwgLTIsIC0zXVxuICAgICAqXG4gICAgICogXy5yYW5nZSgxLCA0LCAwKTtcbiAgICAgKiAvLyA9PiBbMSwgMSwgMV1cbiAgICAgKlxuICAgICAqIF8ucmFuZ2UoMCk7XG4gICAgICogLy8gPT4gW11cbiAgICAgKi9cbiAgICBmdW5jdGlvbiByYW5nZShzdGFydCwgZW5kLCBzdGVwKSB7XG4gICAgICBzdGFydCA9ICtzdGFydCB8fCAwO1xuICAgICAgc3RlcCA9IHR5cGVvZiBzdGVwID09ICdudW1iZXInID8gc3RlcCA6ICgrc3RlcCB8fCAxKTtcblxuICAgICAgaWYgKGVuZCA9PSBudWxsKSB7XG4gICAgICAgIGVuZCA9IHN0YXJ0O1xuICAgICAgICBzdGFydCA9IDA7XG4gICAgICB9XG4gICAgICAvLyB1c2UgYEFycmF5KGxlbmd0aClgIHNvIGVuZ2luZXMgbGlrZSBDaGFrcmEgYW5kIFY4IGF2b2lkIHNsb3dlciBtb2Rlc1xuICAgICAgLy8gaHR0cDovL3lvdXR1LmJlL1hBcUlwR1U4WlprI3Q9MTdtMjVzXG4gICAgICB2YXIgaW5kZXggPSAtMSxcbiAgICAgICAgICBsZW5ndGggPSBuYXRpdmVNYXgoMCwgY2VpbCgoZW5kIC0gc3RhcnQpIC8gKHN0ZXAgfHwgMSkpKSxcbiAgICAgICAgICByZXN1bHQgPSBBcnJheShsZW5ndGgpO1xuXG4gICAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgICByZXN1bHRbaW5kZXhdID0gc3RhcnQ7XG4gICAgICAgIHN0YXJ0ICs9IHN0ZXA7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgYWxsIGVsZW1lbnRzIGZyb20gYW4gYXJyYXkgdGhhdCB0aGUgY2FsbGJhY2sgcmV0dXJucyB0cnVleSBmb3JcbiAgICAgKiBhbmQgcmV0dXJucyBhbiBhcnJheSBvZiByZW1vdmVkIGVsZW1lbnRzLiBUaGUgY2FsbGJhY2sgaXMgYm91bmQgdG8gYHRoaXNBcmdgXG4gICAgICogYW5kIGludm9rZWQgd2l0aCB0aHJlZSBhcmd1bWVudHM7ICh2YWx1ZSwgaW5kZXgsIGFycmF5KS5cbiAgICAgKlxuICAgICAqIElmIGEgcHJvcGVydHkgbmFtZSBpcyBwcm92aWRlZCBmb3IgYGNhbGxiYWNrYCB0aGUgY3JlYXRlZCBcIl8ucGx1Y2tcIiBzdHlsZVxuICAgICAqIGNhbGxiYWNrIHdpbGwgcmV0dXJuIHRoZSBwcm9wZXJ0eSB2YWx1ZSBvZiB0aGUgZ2l2ZW4gZWxlbWVudC5cbiAgICAgKlxuICAgICAqIElmIGFuIG9iamVjdCBpcyBwcm92aWRlZCBmb3IgYGNhbGxiYWNrYCB0aGUgY3JlYXRlZCBcIl8ud2hlcmVcIiBzdHlsZSBjYWxsYmFja1xuICAgICAqIHdpbGwgcmV0dXJuIGB0cnVlYCBmb3IgZWxlbWVudHMgdGhhdCBoYXZlIHRoZSBwcm9wZXJ0aWVzIG9mIHRoZSBnaXZlbiBvYmplY3QsXG4gICAgICogZWxzZSBgZmFsc2VgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IEFycmF5c1xuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBtb2RpZnkuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbnxPYmplY3R8c3RyaW5nfSBbY2FsbGJhY2s9aWRlbnRpdHldIFRoZSBmdW5jdGlvbiBjYWxsZWRcbiAgICAgKiAgcGVyIGl0ZXJhdGlvbi4gSWYgYSBwcm9wZXJ0eSBuYW1lIG9yIG9iamVjdCBpcyBwcm92aWRlZCBpdCB3aWxsIGJlIHVzZWRcbiAgICAgKiAgdG8gY3JlYXRlIGEgXCJfLnBsdWNrXCIgb3IgXCJfLndoZXJlXCIgc3R5bGUgY2FsbGJhY2ssIHJlc3BlY3RpdmVseS5cbiAgICAgKiBAcGFyYW0geyp9IFt0aGlzQXJnXSBUaGUgYHRoaXNgIGJpbmRpbmcgb2YgYGNhbGxiYWNrYC5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgYSBuZXcgYXJyYXkgb2YgcmVtb3ZlZCBlbGVtZW50cy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIGFycmF5ID0gWzEsIDIsIDMsIDQsIDUsIDZdO1xuICAgICAqIHZhciBldmVucyA9IF8ucmVtb3ZlKGFycmF5LCBmdW5jdGlvbihudW0pIHsgcmV0dXJuIG51bSAlIDIgPT0gMDsgfSk7XG4gICAgICpcbiAgICAgKiBjb25zb2xlLmxvZyhhcnJheSk7XG4gICAgICogLy8gPT4gWzEsIDMsIDVdXG4gICAgICpcbiAgICAgKiBjb25zb2xlLmxvZyhldmVucyk7XG4gICAgICogLy8gPT4gWzIsIDQsIDZdXG4gICAgICovXG4gICAgZnVuY3Rpb24gcmVtb3ZlKGFycmF5LCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgICAgbGVuZ3RoID0gYXJyYXkgPyBhcnJheS5sZW5ndGggOiAwLFxuICAgICAgICAgIHJlc3VsdCA9IFtdO1xuXG4gICAgICBjYWxsYmFjayA9IGxvZGFzaC5jcmVhdGVDYWxsYmFjayhjYWxsYmFjaywgdGhpc0FyZywgMyk7XG4gICAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgICB2YXIgdmFsdWUgPSBhcnJheVtpbmRleF07XG4gICAgICAgIGlmIChjYWxsYmFjayh2YWx1ZSwgaW5kZXgsIGFycmF5KSkge1xuICAgICAgICAgIHJlc3VsdC5wdXNoKHZhbHVlKTtcbiAgICAgICAgICBzcGxpY2UuY2FsbChhcnJheSwgaW5kZXgtLSwgMSk7XG4gICAgICAgICAgbGVuZ3RoLS07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIG9wcG9zaXRlIG9mIGBfLmluaXRpYWxgIHRoaXMgbWV0aG9kIGdldHMgYWxsIGJ1dCB0aGUgZmlyc3QgZWxlbWVudCBvclxuICAgICAqIGZpcnN0IGBuYCBlbGVtZW50cyBvZiBhbiBhcnJheS4gSWYgYSBjYWxsYmFjayBmdW5jdGlvbiBpcyBwcm92aWRlZCBlbGVtZW50c1xuICAgICAqIGF0IHRoZSBiZWdpbm5pbmcgb2YgdGhlIGFycmF5IGFyZSBleGNsdWRlZCBmcm9tIHRoZSByZXN1bHQgYXMgbG9uZyBhcyB0aGVcbiAgICAgKiBjYWxsYmFjayByZXR1cm5zIHRydWV5LiBUaGUgY2FsbGJhY2sgaXMgYm91bmQgdG8gYHRoaXNBcmdgIGFuZCBpbnZva2VkXG4gICAgICogd2l0aCB0aHJlZSBhcmd1bWVudHM7ICh2YWx1ZSwgaW5kZXgsIGFycmF5KS5cbiAgICAgKlxuICAgICAqIElmIGEgcHJvcGVydHkgbmFtZSBpcyBwcm92aWRlZCBmb3IgYGNhbGxiYWNrYCB0aGUgY3JlYXRlZCBcIl8ucGx1Y2tcIiBzdHlsZVxuICAgICAqIGNhbGxiYWNrIHdpbGwgcmV0dXJuIHRoZSBwcm9wZXJ0eSB2YWx1ZSBvZiB0aGUgZ2l2ZW4gZWxlbWVudC5cbiAgICAgKlxuICAgICAqIElmIGFuIG9iamVjdCBpcyBwcm92aWRlZCBmb3IgYGNhbGxiYWNrYCB0aGUgY3JlYXRlZCBcIl8ud2hlcmVcIiBzdHlsZSBjYWxsYmFja1xuICAgICAqIHdpbGwgcmV0dXJuIGB0cnVlYCBmb3IgZWxlbWVudHMgdGhhdCBoYXZlIHRoZSBwcm9wZXJ0aWVzIG9mIHRoZSBnaXZlbiBvYmplY3QsXG4gICAgICogZWxzZSBgZmFsc2VgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGFsaWFzIGRyb3AsIHRhaWxcbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlzXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIHF1ZXJ5LlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb258T2JqZWN0fG51bWJlcnxzdHJpbmd9IFtjYWxsYmFjaz0xXSBUaGUgZnVuY3Rpb24gY2FsbGVkXG4gICAgICogIHBlciBlbGVtZW50IG9yIHRoZSBudW1iZXIgb2YgZWxlbWVudHMgdG8gZXhjbHVkZS4gSWYgYSBwcm9wZXJ0eSBuYW1lIG9yXG4gICAgICogIG9iamVjdCBpcyBwcm92aWRlZCBpdCB3aWxsIGJlIHVzZWQgdG8gY3JlYXRlIGEgXCJfLnBsdWNrXCIgb3IgXCJfLndoZXJlXCJcbiAgICAgKiAgc3R5bGUgY2FsbGJhY2ssIHJlc3BlY3RpdmVseS5cbiAgICAgKiBAcGFyYW0geyp9IFt0aGlzQXJnXSBUaGUgYHRoaXNgIGJpbmRpbmcgb2YgYGNhbGxiYWNrYC5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgYSBzbGljZSBvZiBgYXJyYXlgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLnJlc3QoWzEsIDIsIDNdKTtcbiAgICAgKiAvLyA9PiBbMiwgM11cbiAgICAgKlxuICAgICAqIF8ucmVzdChbMSwgMiwgM10sIDIpO1xuICAgICAqIC8vID0+IFszXVxuICAgICAqXG4gICAgICogXy5yZXN0KFsxLCAyLCAzXSwgZnVuY3Rpb24obnVtKSB7XG4gICAgICogICByZXR1cm4gbnVtIDwgMztcbiAgICAgKiB9KTtcbiAgICAgKiAvLyA9PiBbM11cbiAgICAgKlxuICAgICAqIHZhciBjaGFyYWN0ZXJzID0gW1xuICAgICAqICAgeyAnbmFtZSc6ICdiYXJuZXknLCAgJ2Jsb2NrZWQnOiB0cnVlLCAgJ2VtcGxveWVyJzogJ3NsYXRlJyB9LFxuICAgICAqICAgeyAnbmFtZSc6ICdmcmVkJywgICAgJ2Jsb2NrZWQnOiBmYWxzZSwgICdlbXBsb3llcic6ICdzbGF0ZScgfSxcbiAgICAgKiAgIHsgJ25hbWUnOiAncGViYmxlcycsICdibG9ja2VkJzogdHJ1ZSwgJ2VtcGxveWVyJzogJ25hJyB9XG4gICAgICogXTtcbiAgICAgKlxuICAgICAqIC8vIHVzaW5nIFwiXy5wbHVja1wiIGNhbGxiYWNrIHNob3J0aGFuZFxuICAgICAqIF8ucGx1Y2soXy5yZXN0KGNoYXJhY3RlcnMsICdibG9ja2VkJyksICduYW1lJyk7XG4gICAgICogLy8gPT4gWydmcmVkJywgJ3BlYmJsZXMnXVxuICAgICAqXG4gICAgICogLy8gdXNpbmcgXCJfLndoZXJlXCIgY2FsbGJhY2sgc2hvcnRoYW5kXG4gICAgICogXy5yZXN0KGNoYXJhY3RlcnMsIHsgJ2VtcGxveWVyJzogJ3NsYXRlJyB9KTtcbiAgICAgKiAvLyA9PiBbeyAnbmFtZSc6ICdwZWJibGVzJywgJ2Jsb2NrZWQnOiB0cnVlLCAnZW1wbG95ZXInOiAnbmEnIH1dXG4gICAgICovXG4gICAgZnVuY3Rpb24gcmVzdChhcnJheSwgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgIT0gJ251bWJlcicgJiYgY2FsbGJhY2sgIT0gbnVsbCkge1xuICAgICAgICB2YXIgbiA9IDAsXG4gICAgICAgICAgICBpbmRleCA9IC0xLFxuICAgICAgICAgICAgbGVuZ3RoID0gYXJyYXkgPyBhcnJheS5sZW5ndGggOiAwO1xuXG4gICAgICAgIGNhbGxiYWNrID0gbG9kYXNoLmNyZWF0ZUNhbGxiYWNrKGNhbGxiYWNrLCB0aGlzQXJnLCAzKTtcbiAgICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGggJiYgY2FsbGJhY2soYXJyYXlbaW5kZXhdLCBpbmRleCwgYXJyYXkpKSB7XG4gICAgICAgICAgbisrO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBuID0gKGNhbGxiYWNrID09IG51bGwgfHwgdGhpc0FyZykgPyAxIDogbmF0aXZlTWF4KDAsIGNhbGxiYWNrKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBzbGljZShhcnJheSwgbik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXNlcyBhIGJpbmFyeSBzZWFyY2ggdG8gZGV0ZXJtaW5lIHRoZSBzbWFsbGVzdCBpbmRleCBhdCB3aGljaCBhIHZhbHVlXG4gICAgICogc2hvdWxkIGJlIGluc2VydGVkIGludG8gYSBnaXZlbiBzb3J0ZWQgYXJyYXkgaW4gb3JkZXIgdG8gbWFpbnRhaW4gdGhlIHNvcnRcbiAgICAgKiBvcmRlciBvZiB0aGUgYXJyYXkuIElmIGEgY2FsbGJhY2sgaXMgcHJvdmlkZWQgaXQgd2lsbCBiZSBleGVjdXRlZCBmb3JcbiAgICAgKiBgdmFsdWVgIGFuZCBlYWNoIGVsZW1lbnQgb2YgYGFycmF5YCB0byBjb21wdXRlIHRoZWlyIHNvcnQgcmFua2luZy4gVGhlXG4gICAgICogY2FsbGJhY2sgaXMgYm91bmQgdG8gYHRoaXNBcmdgIGFuZCBpbnZva2VkIHdpdGggb25lIGFyZ3VtZW50OyAodmFsdWUpLlxuICAgICAqXG4gICAgICogSWYgYSBwcm9wZXJ0eSBuYW1lIGlzIHByb3ZpZGVkIGZvciBgY2FsbGJhY2tgIHRoZSBjcmVhdGVkIFwiXy5wbHVja1wiIHN0eWxlXG4gICAgICogY2FsbGJhY2sgd2lsbCByZXR1cm4gdGhlIHByb3BlcnR5IHZhbHVlIG9mIHRoZSBnaXZlbiBlbGVtZW50LlxuICAgICAqXG4gICAgICogSWYgYW4gb2JqZWN0IGlzIHByb3ZpZGVkIGZvciBgY2FsbGJhY2tgIHRoZSBjcmVhdGVkIFwiXy53aGVyZVwiIHN0eWxlIGNhbGxiYWNrXG4gICAgICogd2lsbCByZXR1cm4gYHRydWVgIGZvciBlbGVtZW50cyB0aGF0IGhhdmUgdGhlIHByb3BlcnRpZXMgb2YgdGhlIGdpdmVuIG9iamVjdCxcbiAgICAgKiBlbHNlIGBmYWxzZWAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlzXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGluc3BlY3QuXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gZXZhbHVhdGUuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbnxPYmplY3R8c3RyaW5nfSBbY2FsbGJhY2s9aWRlbnRpdHldIFRoZSBmdW5jdGlvbiBjYWxsZWRcbiAgICAgKiAgcGVyIGl0ZXJhdGlvbi4gSWYgYSBwcm9wZXJ0eSBuYW1lIG9yIG9iamVjdCBpcyBwcm92aWRlZCBpdCB3aWxsIGJlIHVzZWRcbiAgICAgKiAgdG8gY3JlYXRlIGEgXCJfLnBsdWNrXCIgb3IgXCJfLndoZXJlXCIgc3R5bGUgY2FsbGJhY2ssIHJlc3BlY3RpdmVseS5cbiAgICAgKiBAcGFyYW0geyp9IFt0aGlzQXJnXSBUaGUgYHRoaXNgIGJpbmRpbmcgb2YgYGNhbGxiYWNrYC5cbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIHRoZSBpbmRleCBhdCB3aGljaCBgdmFsdWVgIHNob3VsZCBiZSBpbnNlcnRlZFxuICAgICAqICBpbnRvIGBhcnJheWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uc29ydGVkSW5kZXgoWzIwLCAzMCwgNTBdLCA0MCk7XG4gICAgICogLy8gPT4gMlxuICAgICAqXG4gICAgICogLy8gdXNpbmcgXCJfLnBsdWNrXCIgY2FsbGJhY2sgc2hvcnRoYW5kXG4gICAgICogXy5zb3J0ZWRJbmRleChbeyAneCc6IDIwIH0sIHsgJ3gnOiAzMCB9LCB7ICd4JzogNTAgfV0sIHsgJ3gnOiA0MCB9LCAneCcpO1xuICAgICAqIC8vID0+IDJcbiAgICAgKlxuICAgICAqIHZhciBkaWN0ID0ge1xuICAgICAqICAgJ3dvcmRUb051bWJlcic6IHsgJ3R3ZW50eSc6IDIwLCAndGhpcnR5JzogMzAsICdmb3VydHknOiA0MCwgJ2ZpZnR5JzogNTAgfVxuICAgICAqIH07XG4gICAgICpcbiAgICAgKiBfLnNvcnRlZEluZGV4KFsndHdlbnR5JywgJ3RoaXJ0eScsICdmaWZ0eSddLCAnZm91cnR5JywgZnVuY3Rpb24od29yZCkge1xuICAgICAqICAgcmV0dXJuIGRpY3Qud29yZFRvTnVtYmVyW3dvcmRdO1xuICAgICAqIH0pO1xuICAgICAqIC8vID0+IDJcbiAgICAgKlxuICAgICAqIF8uc29ydGVkSW5kZXgoWyd0d2VudHknLCAndGhpcnR5JywgJ2ZpZnR5J10sICdmb3VydHknLCBmdW5jdGlvbih3b3JkKSB7XG4gICAgICogICByZXR1cm4gdGhpcy53b3JkVG9OdW1iZXJbd29yZF07XG4gICAgICogfSwgZGljdCk7XG4gICAgICogLy8gPT4gMlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHNvcnRlZEluZGV4KGFycmF5LCB2YWx1ZSwgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgIHZhciBsb3cgPSAwLFxuICAgICAgICAgIGhpZ2ggPSBhcnJheSA/IGFycmF5Lmxlbmd0aCA6IGxvdztcblxuICAgICAgLy8gZXhwbGljaXRseSByZWZlcmVuY2UgYGlkZW50aXR5YCBmb3IgYmV0dGVyIGlubGluaW5nIGluIEZpcmVmb3hcbiAgICAgIGNhbGxiYWNrID0gY2FsbGJhY2sgPyBsb2Rhc2guY3JlYXRlQ2FsbGJhY2soY2FsbGJhY2ssIHRoaXNBcmcsIDEpIDogaWRlbnRpdHk7XG4gICAgICB2YWx1ZSA9IGNhbGxiYWNrKHZhbHVlKTtcblxuICAgICAgd2hpbGUgKGxvdyA8IGhpZ2gpIHtcbiAgICAgICAgdmFyIG1pZCA9IChsb3cgKyBoaWdoKSA+Pj4gMTtcbiAgICAgICAgKGNhbGxiYWNrKGFycmF5W21pZF0pIDwgdmFsdWUpXG4gICAgICAgICAgPyBsb3cgPSBtaWQgKyAxXG4gICAgICAgICAgOiBoaWdoID0gbWlkO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGxvdztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGFycmF5IG9mIHVuaXF1ZSB2YWx1ZXMsIGluIG9yZGVyLCBvZiB0aGUgcHJvdmlkZWQgYXJyYXlzIHVzaW5nXG4gICAgICogc3RyaWN0IGVxdWFsaXR5IGZvciBjb21wYXJpc29ucywgaS5lLiBgPT09YC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBBcnJheXNcbiAgICAgKiBAcGFyYW0gey4uLkFycmF5fSBbYXJyYXldIFRoZSBhcnJheXMgdG8gaW5zcGVjdC5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgYW4gYXJyYXkgb2YgY29tYmluZWQgdmFsdWVzLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLnVuaW9uKFsxLCAyLCAzXSwgWzUsIDIsIDEsIDRdLCBbMiwgMV0pO1xuICAgICAqIC8vID0+IFsxLCAyLCAzLCA1LCA0XVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHVuaW9uKCkge1xuICAgICAgcmV0dXJuIGJhc2VVbmlxKGJhc2VGbGF0dGVuKGFyZ3VtZW50cywgdHJ1ZSwgdHJ1ZSkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBkdXBsaWNhdGUtdmFsdWUtZnJlZSB2ZXJzaW9uIG9mIGFuIGFycmF5IHVzaW5nIHN0cmljdCBlcXVhbGl0eVxuICAgICAqIGZvciBjb21wYXJpc29ucywgaS5lLiBgPT09YC4gSWYgdGhlIGFycmF5IGlzIHNvcnRlZCwgcHJvdmlkaW5nXG4gICAgICogYHRydWVgIGZvciBgaXNTb3J0ZWRgIHdpbGwgdXNlIGEgZmFzdGVyIGFsZ29yaXRobS4gSWYgYSBjYWxsYmFjayBpcyBwcm92aWRlZFxuICAgICAqIGVhY2ggZWxlbWVudCBvZiBgYXJyYXlgIGlzIHBhc3NlZCB0aHJvdWdoIHRoZSBjYWxsYmFjayBiZWZvcmUgdW5pcXVlbmVzc1xuICAgICAqIGlzIGNvbXB1dGVkLiBUaGUgY2FsbGJhY2sgaXMgYm91bmQgdG8gYHRoaXNBcmdgIGFuZCBpbnZva2VkIHdpdGggdGhyZWVcbiAgICAgKiBhcmd1bWVudHM7ICh2YWx1ZSwgaW5kZXgsIGFycmF5KS5cbiAgICAgKlxuICAgICAqIElmIGEgcHJvcGVydHkgbmFtZSBpcyBwcm92aWRlZCBmb3IgYGNhbGxiYWNrYCB0aGUgY3JlYXRlZCBcIl8ucGx1Y2tcIiBzdHlsZVxuICAgICAqIGNhbGxiYWNrIHdpbGwgcmV0dXJuIHRoZSBwcm9wZXJ0eSB2YWx1ZSBvZiB0aGUgZ2l2ZW4gZWxlbWVudC5cbiAgICAgKlxuICAgICAqIElmIGFuIG9iamVjdCBpcyBwcm92aWRlZCBmb3IgYGNhbGxiYWNrYCB0aGUgY3JlYXRlZCBcIl8ud2hlcmVcIiBzdHlsZSBjYWxsYmFja1xuICAgICAqIHdpbGwgcmV0dXJuIGB0cnVlYCBmb3IgZWxlbWVudHMgdGhhdCBoYXZlIHRoZSBwcm9wZXJ0aWVzIG9mIHRoZSBnaXZlbiBvYmplY3QsXG4gICAgICogZWxzZSBgZmFsc2VgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGFsaWFzIHVuaXF1ZVxuICAgICAqIEBjYXRlZ29yeSBBcnJheXNcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gcHJvY2Vzcy5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtpc1NvcnRlZD1mYWxzZV0gQSBmbGFnIHRvIGluZGljYXRlIHRoYXQgYGFycmF5YCBpcyBzb3J0ZWQuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbnxPYmplY3R8c3RyaW5nfSBbY2FsbGJhY2s9aWRlbnRpdHldIFRoZSBmdW5jdGlvbiBjYWxsZWRcbiAgICAgKiAgcGVyIGl0ZXJhdGlvbi4gSWYgYSBwcm9wZXJ0eSBuYW1lIG9yIG9iamVjdCBpcyBwcm92aWRlZCBpdCB3aWxsIGJlIHVzZWRcbiAgICAgKiAgdG8gY3JlYXRlIGEgXCJfLnBsdWNrXCIgb3IgXCJfLndoZXJlXCIgc3R5bGUgY2FsbGJhY2ssIHJlc3BlY3RpdmVseS5cbiAgICAgKiBAcGFyYW0geyp9IFt0aGlzQXJnXSBUaGUgYHRoaXNgIGJpbmRpbmcgb2YgYGNhbGxiYWNrYC5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgYSBkdXBsaWNhdGUtdmFsdWUtZnJlZSBhcnJheS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy51bmlxKFsxLCAyLCAxLCAzLCAxXSk7XG4gICAgICogLy8gPT4gWzEsIDIsIDNdXG4gICAgICpcbiAgICAgKiBfLnVuaXEoWzEsIDEsIDIsIDIsIDNdLCB0cnVlKTtcbiAgICAgKiAvLyA9PiBbMSwgMiwgM11cbiAgICAgKlxuICAgICAqIF8udW5pcShbJ0EnLCAnYicsICdDJywgJ2EnLCAnQicsICdjJ10sIGZ1bmN0aW9uKGxldHRlcikgeyByZXR1cm4gbGV0dGVyLnRvTG93ZXJDYXNlKCk7IH0pO1xuICAgICAqIC8vID0+IFsnQScsICdiJywgJ0MnXVxuICAgICAqXG4gICAgICogXy51bmlxKFsxLCAyLjUsIDMsIDEuNSwgMiwgMy41XSwgZnVuY3Rpb24obnVtKSB7IHJldHVybiB0aGlzLmZsb29yKG51bSk7IH0sIE1hdGgpO1xuICAgICAqIC8vID0+IFsxLCAyLjUsIDNdXG4gICAgICpcbiAgICAgKiAvLyB1c2luZyBcIl8ucGx1Y2tcIiBjYWxsYmFjayBzaG9ydGhhbmRcbiAgICAgKiBfLnVuaXEoW3sgJ3gnOiAxIH0sIHsgJ3gnOiAyIH0sIHsgJ3gnOiAxIH1dLCAneCcpO1xuICAgICAqIC8vID0+IFt7ICd4JzogMSB9LCB7ICd4JzogMiB9XVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHVuaXEoYXJyYXksIGlzU29ydGVkLCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgLy8ganVnZ2xlIGFyZ3VtZW50c1xuICAgICAgaWYgKHR5cGVvZiBpc1NvcnRlZCAhPSAnYm9vbGVhbicgJiYgaXNTb3J0ZWQgIT0gbnVsbCkge1xuICAgICAgICB0aGlzQXJnID0gY2FsbGJhY2s7XG4gICAgICAgIGNhbGxiYWNrID0gKHR5cGVvZiBpc1NvcnRlZCAhPSAnZnVuY3Rpb24nICYmIHRoaXNBcmcgJiYgdGhpc0FyZ1tpc1NvcnRlZF0gPT09IGFycmF5KSA/IG51bGwgOiBpc1NvcnRlZDtcbiAgICAgICAgaXNTb3J0ZWQgPSBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGlmIChjYWxsYmFjayAhPSBudWxsKSB7XG4gICAgICAgIGNhbGxiYWNrID0gbG9kYXNoLmNyZWF0ZUNhbGxiYWNrKGNhbGxiYWNrLCB0aGlzQXJnLCAzKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBiYXNlVW5pcShhcnJheSwgaXNTb3J0ZWQsIGNhbGxiYWNrKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGFycmF5IGV4Y2x1ZGluZyBhbGwgcHJvdmlkZWQgdmFsdWVzIHVzaW5nIHN0cmljdCBlcXVhbGl0eSBmb3JcbiAgICAgKiBjb21wYXJpc29ucywgaS5lLiBgPT09YC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBBcnJheXNcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gZmlsdGVyLlxuICAgICAqIEBwYXJhbSB7Li4uKn0gW3ZhbHVlXSBUaGUgdmFsdWVzIHRvIGV4Y2x1ZGUuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIGEgbmV3IGFycmF5IG9mIGZpbHRlcmVkIHZhbHVlcy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy53aXRob3V0KFsxLCAyLCAxLCAwLCAzLCAxLCA0XSwgMCwgMSk7XG4gICAgICogLy8gPT4gWzIsIDMsIDRdXG4gICAgICovXG4gICAgZnVuY3Rpb24gd2l0aG91dChhcnJheSkge1xuICAgICAgcmV0dXJuIGJhc2VEaWZmZXJlbmNlKGFycmF5LCBzbGljZShhcmd1bWVudHMsIDEpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGFycmF5IHRoYXQgaXMgdGhlIHN5bW1ldHJpYyBkaWZmZXJlbmNlIG9mIHRoZSBwcm92aWRlZCBhcnJheXMuXG4gICAgICogU2VlIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvU3ltbWV0cmljX2RpZmZlcmVuY2UuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlzXG4gICAgICogQHBhcmFtIHsuLi5BcnJheX0gW2FycmF5XSBUaGUgYXJyYXlzIHRvIGluc3BlY3QuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIGFuIGFycmF5IG9mIHZhbHVlcy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy54b3IoWzEsIDIsIDNdLCBbNSwgMiwgMSwgNF0pO1xuICAgICAqIC8vID0+IFszLCA1LCA0XVxuICAgICAqXG4gICAgICogXy54b3IoWzEsIDIsIDVdLCBbMiwgMywgNV0sIFszLCA0LCA1XSk7XG4gICAgICogLy8gPT4gWzEsIDQsIDVdXG4gICAgICovXG4gICAgZnVuY3Rpb24geG9yKCkge1xuICAgICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgICAgbGVuZ3RoID0gYXJndW1lbnRzLmxlbmd0aDtcblxuICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgdmFyIGFycmF5ID0gYXJndW1lbnRzW2luZGV4XTtcbiAgICAgICAgaWYgKGlzQXJyYXkoYXJyYXkpIHx8IGlzQXJndW1lbnRzKGFycmF5KSkge1xuICAgICAgICAgIHZhciByZXN1bHQgPSByZXN1bHRcbiAgICAgICAgICAgID8gYmFzZVVuaXEoYmFzZURpZmZlcmVuY2UocmVzdWx0LCBhcnJheSkuY29uY2F0KGJhc2VEaWZmZXJlbmNlKGFycmF5LCByZXN1bHQpKSlcbiAgICAgICAgICAgIDogYXJyYXk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQgfHwgW107XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBhcnJheSBvZiBncm91cGVkIGVsZW1lbnRzLCB0aGUgZmlyc3Qgb2Ygd2hpY2ggY29udGFpbnMgdGhlIGZpcnN0XG4gICAgICogZWxlbWVudHMgb2YgdGhlIGdpdmVuIGFycmF5cywgdGhlIHNlY29uZCBvZiB3aGljaCBjb250YWlucyB0aGUgc2Vjb25kXG4gICAgICogZWxlbWVudHMgb2YgdGhlIGdpdmVuIGFycmF5cywgYW5kIHNvIG9uLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGFsaWFzIHVuemlwXG4gICAgICogQGNhdGVnb3J5IEFycmF5c1xuICAgICAqIEBwYXJhbSB7Li4uQXJyYXl9IFthcnJheV0gQXJyYXlzIHRvIHByb2Nlc3MuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIGEgbmV3IGFycmF5IG9mIGdyb3VwZWQgZWxlbWVudHMuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uemlwKFsnZnJlZCcsICdiYXJuZXknXSwgWzMwLCA0MF0sIFt0cnVlLCBmYWxzZV0pO1xuICAgICAqIC8vID0+IFtbJ2ZyZWQnLCAzMCwgdHJ1ZV0sIFsnYmFybmV5JywgNDAsIGZhbHNlXV1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB6aXAoKSB7XG4gICAgICB2YXIgYXJyYXkgPSBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50cyA6IGFyZ3VtZW50c1swXSxcbiAgICAgICAgICBpbmRleCA9IC0xLFxuICAgICAgICAgIGxlbmd0aCA9IGFycmF5ID8gbWF4KHBsdWNrKGFycmF5LCAnbGVuZ3RoJykpIDogMCxcbiAgICAgICAgICByZXN1bHQgPSBBcnJheShsZW5ndGggPCAwID8gMCA6IGxlbmd0aCk7XG5cbiAgICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgIHJlc3VsdFtpbmRleF0gPSBwbHVjayhhcnJheSwgaW5kZXgpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIG9iamVjdCBjb21wb3NlZCBmcm9tIGFycmF5cyBvZiBga2V5c2AgYW5kIGB2YWx1ZXNgLiBQcm92aWRlXG4gICAgICogZWl0aGVyIGEgc2luZ2xlIHR3byBkaW1lbnNpb25hbCBhcnJheSwgaS5lLiBgW1trZXkxLCB2YWx1ZTFdLCBba2V5MiwgdmFsdWUyXV1gXG4gICAgICogb3IgdHdvIGFycmF5cywgb25lIG9mIGBrZXlzYCBhbmQgb25lIG9mIGNvcnJlc3BvbmRpbmcgYHZhbHVlc2AuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAYWxpYXMgb2JqZWN0XG4gICAgICogQGNhdGVnb3J5IEFycmF5c1xuICAgICAqIEBwYXJhbSB7QXJyYXl9IGtleXMgVGhlIGFycmF5IG9mIGtleXMuXG4gICAgICogQHBhcmFtIHtBcnJheX0gW3ZhbHVlcz1bXV0gVGhlIGFycmF5IG9mIHZhbHVlcy5cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIGFuIG9iamVjdCBjb21wb3NlZCBvZiB0aGUgZ2l2ZW4ga2V5cyBhbmRcbiAgICAgKiAgY29ycmVzcG9uZGluZyB2YWx1ZXMuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uemlwT2JqZWN0KFsnZnJlZCcsICdiYXJuZXknXSwgWzMwLCA0MF0pO1xuICAgICAqIC8vID0+IHsgJ2ZyZWQnOiAzMCwgJ2Jhcm5leSc6IDQwIH1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB6aXBPYmplY3Qoa2V5cywgdmFsdWVzKSB7XG4gICAgICB2YXIgaW5kZXggPSAtMSxcbiAgICAgICAgICBsZW5ndGggPSBrZXlzID8ga2V5cy5sZW5ndGggOiAwLFxuICAgICAgICAgIHJlc3VsdCA9IHt9O1xuXG4gICAgICBpZiAoIXZhbHVlcyAmJiBsZW5ndGggJiYgIWlzQXJyYXkoa2V5c1swXSkpIHtcbiAgICAgICAgdmFsdWVzID0gW107XG4gICAgICB9XG4gICAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgICB2YXIga2V5ID0ga2V5c1tpbmRleF07XG4gICAgICAgIGlmICh2YWx1ZXMpIHtcbiAgICAgICAgICByZXN1bHRba2V5XSA9IHZhbHVlc1tpbmRleF07XG4gICAgICAgIH0gZWxzZSBpZiAoa2V5KSB7XG4gICAgICAgICAgcmVzdWx0W2tleVswXV0gPSBrZXlbMV07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCBleGVjdXRlcyBgZnVuY2AsIHdpdGggIHRoZSBgdGhpc2AgYmluZGluZyBhbmRcbiAgICAgKiBhcmd1bWVudHMgb2YgdGhlIGNyZWF0ZWQgZnVuY3Rpb24sIG9ubHkgYWZ0ZXIgYmVpbmcgY2FsbGVkIGBuYCB0aW1lcy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvbnNcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbiBUaGUgbnVtYmVyIG9mIHRpbWVzIHRoZSBmdW5jdGlvbiBtdXN0IGJlIGNhbGxlZCBiZWZvcmVcbiAgICAgKiAgYGZ1bmNgIGlzIGV4ZWN1dGVkLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGZ1bmN0aW9uIHRvIHJlc3RyaWN0LlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IHJlc3RyaWN0ZWQgZnVuY3Rpb24uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBzYXZlcyA9IFsncHJvZmlsZScsICdzZXR0aW5ncyddO1xuICAgICAqXG4gICAgICogdmFyIGRvbmUgPSBfLmFmdGVyKHNhdmVzLmxlbmd0aCwgZnVuY3Rpb24oKSB7XG4gICAgICogICBjb25zb2xlLmxvZygnRG9uZSBzYXZpbmchJyk7XG4gICAgICogfSk7XG4gICAgICpcbiAgICAgKiBfLmZvckVhY2goc2F2ZXMsIGZ1bmN0aW9uKHR5cGUpIHtcbiAgICAgKiAgIGFzeW5jU2F2ZSh7ICd0eXBlJzogdHlwZSwgJ2NvbXBsZXRlJzogZG9uZSB9KTtcbiAgICAgKiB9KTtcbiAgICAgKiAvLyA9PiBsb2dzICdEb25lIHNhdmluZyEnLCBhZnRlciBhbGwgc2F2ZXMgaGF2ZSBjb21wbGV0ZWRcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBhZnRlcihuLCBmdW5jKSB7XG4gICAgICBpZiAoIWlzRnVuY3Rpb24oZnVuYykpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcjtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKC0tbiA8IDEpIHtcbiAgICAgICAgICByZXR1cm4gZnVuYy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0LCB3aGVuIGNhbGxlZCwgaW52b2tlcyBgZnVuY2Agd2l0aCB0aGUgYHRoaXNgXG4gICAgICogYmluZGluZyBvZiBgdGhpc0FyZ2AgYW5kIHByZXBlbmRzIGFueSBhZGRpdGlvbmFsIGBiaW5kYCBhcmd1bWVudHMgdG8gdGhvc2VcbiAgICAgKiBwcm92aWRlZCB0byB0aGUgYm91bmQgZnVuY3Rpb24uXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25zXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gYmluZC5cbiAgICAgKiBAcGFyYW0geyp9IFt0aGlzQXJnXSBUaGUgYHRoaXNgIGJpbmRpbmcgb2YgYGZ1bmNgLlxuICAgICAqIEBwYXJhbSB7Li4uKn0gW2FyZ10gQXJndW1lbnRzIHRvIGJlIHBhcnRpYWxseSBhcHBsaWVkLlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IGJvdW5kIGZ1bmN0aW9uLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgZnVuYyA9IGZ1bmN0aW9uKGdyZWV0aW5nKSB7XG4gICAgICogICByZXR1cm4gZ3JlZXRpbmcgKyAnICcgKyB0aGlzLm5hbWU7XG4gICAgICogfTtcbiAgICAgKlxuICAgICAqIGZ1bmMgPSBfLmJpbmQoZnVuYywgeyAnbmFtZSc6ICdmcmVkJyB9LCAnaGknKTtcbiAgICAgKiBmdW5jKCk7XG4gICAgICogLy8gPT4gJ2hpIGZyZWQnXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmluZChmdW5jLCB0aGlzQXJnKSB7XG4gICAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA+IDJcbiAgICAgICAgPyBjcmVhdGVXcmFwcGVyKGZ1bmMsIDE3LCBzbGljZShhcmd1bWVudHMsIDIpLCBudWxsLCB0aGlzQXJnKVxuICAgICAgICA6IGNyZWF0ZVdyYXBwZXIoZnVuYywgMSwgbnVsbCwgbnVsbCwgdGhpc0FyZyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQmluZHMgbWV0aG9kcyBvZiBhbiBvYmplY3QgdG8gdGhlIG9iamVjdCBpdHNlbGYsIG92ZXJ3cml0aW5nIHRoZSBleGlzdGluZ1xuICAgICAqIG1ldGhvZC4gTWV0aG9kIG5hbWVzIG1heSBiZSBzcGVjaWZpZWQgYXMgaW5kaXZpZHVhbCBhcmd1bWVudHMgb3IgYXMgYXJyYXlzXG4gICAgICogb2YgbWV0aG9kIG5hbWVzLiBJZiBubyBtZXRob2QgbmFtZXMgYXJlIHByb3ZpZGVkIGFsbCB0aGUgZnVuY3Rpb24gcHJvcGVydGllc1xuICAgICAqIG9mIGBvYmplY3RgIHdpbGwgYmUgYm91bmQuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25zXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIGJpbmQgYW5kIGFzc2lnbiB0aGUgYm91bmQgbWV0aG9kcyB0by5cbiAgICAgKiBAcGFyYW0gey4uLnN0cmluZ30gW21ldGhvZE5hbWVdIFRoZSBvYmplY3QgbWV0aG9kIG5hbWVzIHRvXG4gICAgICogIGJpbmQsIHNwZWNpZmllZCBhcyBpbmRpdmlkdWFsIG1ldGhvZCBuYW1lcyBvciBhcnJheXMgb2YgbWV0aG9kIG5hbWVzLlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgYG9iamVjdGAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciB2aWV3ID0ge1xuICAgICAqICAgJ2xhYmVsJzogJ2RvY3MnLFxuICAgICAqICAgJ29uQ2xpY2snOiBmdW5jdGlvbigpIHsgY29uc29sZS5sb2coJ2NsaWNrZWQgJyArIHRoaXMubGFiZWwpOyB9XG4gICAgICogfTtcbiAgICAgKlxuICAgICAqIF8uYmluZEFsbCh2aWV3KTtcbiAgICAgKiBqUXVlcnkoJyNkb2NzJykub24oJ2NsaWNrJywgdmlldy5vbkNsaWNrKTtcbiAgICAgKiAvLyA9PiBsb2dzICdjbGlja2VkIGRvY3MnLCB3aGVuIHRoZSBidXR0b24gaXMgY2xpY2tlZFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJpbmRBbGwob2JqZWN0KSB7XG4gICAgICB2YXIgZnVuY3MgPSBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGJhc2VGbGF0dGVuKGFyZ3VtZW50cywgdHJ1ZSwgZmFsc2UsIDEpIDogZnVuY3Rpb25zKG9iamVjdCksXG4gICAgICAgICAgaW5kZXggPSAtMSxcbiAgICAgICAgICBsZW5ndGggPSBmdW5jcy5sZW5ndGg7XG5cbiAgICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgIHZhciBrZXkgPSBmdW5jc1tpbmRleF07XG4gICAgICAgIG9iamVjdFtrZXldID0gY3JlYXRlV3JhcHBlcihvYmplY3Rba2V5XSwgMSwgbnVsbCwgbnVsbCwgb2JqZWN0KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBvYmplY3Q7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGZ1bmN0aW9uIHRoYXQsIHdoZW4gY2FsbGVkLCBpbnZva2VzIHRoZSBtZXRob2QgYXQgYG9iamVjdFtrZXldYFxuICAgICAqIGFuZCBwcmVwZW5kcyBhbnkgYWRkaXRpb25hbCBgYmluZEtleWAgYXJndW1lbnRzIHRvIHRob3NlIHByb3ZpZGVkIHRvIHRoZSBib3VuZFxuICAgICAqIGZ1bmN0aW9uLiBUaGlzIG1ldGhvZCBkaWZmZXJzIGZyb20gYF8uYmluZGAgYnkgYWxsb3dpbmcgYm91bmQgZnVuY3Rpb25zIHRvXG4gICAgICogcmVmZXJlbmNlIG1ldGhvZHMgdGhhdCB3aWxsIGJlIHJlZGVmaW5lZCBvciBkb24ndCB5ZXQgZXhpc3QuXG4gICAgICogU2VlIGh0dHA6Ly9taWNoYXV4LmNhL2FydGljbGVzL2xhenktZnVuY3Rpb24tZGVmaW5pdGlvbi1wYXR0ZXJuLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uc1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0aGUgbWV0aG9kIGJlbG9uZ3MgdG8uXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGtleSBUaGUga2V5IG9mIHRoZSBtZXRob2QuXG4gICAgICogQHBhcmFtIHsuLi4qfSBbYXJnXSBBcmd1bWVudHMgdG8gYmUgcGFydGlhbGx5IGFwcGxpZWQuXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgYm91bmQgZnVuY3Rpb24uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBvYmplY3QgPSB7XG4gICAgICogICAnbmFtZSc6ICdmcmVkJyxcbiAgICAgKiAgICdncmVldCc6IGZ1bmN0aW9uKGdyZWV0aW5nKSB7XG4gICAgICogICAgIHJldHVybiBncmVldGluZyArICcgJyArIHRoaXMubmFtZTtcbiAgICAgKiAgIH1cbiAgICAgKiB9O1xuICAgICAqXG4gICAgICogdmFyIGZ1bmMgPSBfLmJpbmRLZXkob2JqZWN0LCAnZ3JlZXQnLCAnaGknKTtcbiAgICAgKiBmdW5jKCk7XG4gICAgICogLy8gPT4gJ2hpIGZyZWQnXG4gICAgICpcbiAgICAgKiBvYmplY3QuZ3JlZXQgPSBmdW5jdGlvbihncmVldGluZykge1xuICAgICAqICAgcmV0dXJuIGdyZWV0aW5nICsgJ3lhICcgKyB0aGlzLm5hbWUgKyAnISc7XG4gICAgICogfTtcbiAgICAgKlxuICAgICAqIGZ1bmMoKTtcbiAgICAgKiAvLyA9PiAnaGl5YSBmcmVkISdcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBiaW5kS2V5KG9iamVjdCwga2V5KSB7XG4gICAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA+IDJcbiAgICAgICAgPyBjcmVhdGVXcmFwcGVyKGtleSwgMTksIHNsaWNlKGFyZ3VtZW50cywgMiksIG51bGwsIG9iamVjdClcbiAgICAgICAgOiBjcmVhdGVXcmFwcGVyKGtleSwgMywgbnVsbCwgbnVsbCwgb2JqZWN0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCBpcyB0aGUgY29tcG9zaXRpb24gb2YgdGhlIHByb3ZpZGVkIGZ1bmN0aW9ucyxcbiAgICAgKiB3aGVyZSBlYWNoIGZ1bmN0aW9uIGNvbnN1bWVzIHRoZSByZXR1cm4gdmFsdWUgb2YgdGhlIGZ1bmN0aW9uIHRoYXQgZm9sbG93cy5cbiAgICAgKiBGb3IgZXhhbXBsZSwgY29tcG9zaW5nIHRoZSBmdW5jdGlvbnMgYGYoKWAsIGBnKClgLCBhbmQgYGgoKWAgcHJvZHVjZXMgYGYoZyhoKCkpKWAuXG4gICAgICogRWFjaCBmdW5jdGlvbiBpcyBleGVjdXRlZCB3aXRoIHRoZSBgdGhpc2AgYmluZGluZyBvZiB0aGUgY29tcG9zZWQgZnVuY3Rpb24uXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25zXG4gICAgICogQHBhcmFtIHsuLi5GdW5jdGlvbn0gW2Z1bmNdIEZ1bmN0aW9ucyB0byBjb21wb3NlLlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IGNvbXBvc2VkIGZ1bmN0aW9uLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgcmVhbE5hbWVNYXAgPSB7XG4gICAgICogICAncGViYmxlcyc6ICdwZW5lbG9wZSdcbiAgICAgKiB9O1xuICAgICAqXG4gICAgICogdmFyIGZvcm1hdCA9IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgKiAgIG5hbWUgPSByZWFsTmFtZU1hcFtuYW1lLnRvTG93ZXJDYXNlKCldIHx8IG5hbWU7XG4gICAgICogICByZXR1cm4gbmFtZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIG5hbWUuc2xpY2UoMSkudG9Mb3dlckNhc2UoKTtcbiAgICAgKiB9O1xuICAgICAqXG4gICAgICogdmFyIGdyZWV0ID0gZnVuY3Rpb24oZm9ybWF0dGVkKSB7XG4gICAgICogICByZXR1cm4gJ0hpeWEgJyArIGZvcm1hdHRlZCArICchJztcbiAgICAgKiB9O1xuICAgICAqXG4gICAgICogdmFyIHdlbGNvbWUgPSBfLmNvbXBvc2UoZ3JlZXQsIGZvcm1hdCk7XG4gICAgICogd2VsY29tZSgncGViYmxlcycpO1xuICAgICAqIC8vID0+ICdIaXlhIFBlbmVsb3BlISdcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb21wb3NlKCkge1xuICAgICAgdmFyIGZ1bmNzID0gYXJndW1lbnRzLFxuICAgICAgICAgIGxlbmd0aCA9IGZ1bmNzLmxlbmd0aDtcblxuICAgICAgd2hpbGUgKGxlbmd0aC0tKSB7XG4gICAgICAgIGlmICghaXNGdW5jdGlvbihmdW5jc1tsZW5ndGhdKSkge1xuICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3I7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHMsXG4gICAgICAgICAgICBsZW5ndGggPSBmdW5jcy5sZW5ndGg7XG5cbiAgICAgICAgd2hpbGUgKGxlbmd0aC0tKSB7XG4gICAgICAgICAgYXJncyA9IFtmdW5jc1tsZW5ndGhdLmFwcGx5KHRoaXMsIGFyZ3MpXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXJnc1swXTtcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGZ1bmN0aW9uIHdoaWNoIGFjY2VwdHMgb25lIG9yIG1vcmUgYXJndW1lbnRzIG9mIGBmdW5jYCB0aGF0IHdoZW5cbiAgICAgKiBpbnZva2VkIGVpdGhlciBleGVjdXRlcyBgZnVuY2AgcmV0dXJuaW5nIGl0cyByZXN1bHQsIGlmIGFsbCBgZnVuY2AgYXJndW1lbnRzXG4gICAgICogaGF2ZSBiZWVuIHByb3ZpZGVkLCBvciByZXR1cm5zIGEgZnVuY3Rpb24gdGhhdCBhY2NlcHRzIG9uZSBvciBtb3JlIG9mIHRoZVxuICAgICAqIHJlbWFpbmluZyBgZnVuY2AgYXJndW1lbnRzLCBhbmQgc28gb24uIFRoZSBhcml0eSBvZiBgZnVuY2AgY2FuIGJlIHNwZWNpZmllZFxuICAgICAqIGlmIGBmdW5jLmxlbmd0aGAgaXMgbm90IHN1ZmZpY2llbnQuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25zXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gY3VycnkuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFthcml0eT1mdW5jLmxlbmd0aF0gVGhlIGFyaXR5IG9mIGBmdW5jYC5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBjdXJyaWVkIGZ1bmN0aW9uLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgY3VycmllZCA9IF8uY3VycnkoZnVuY3Rpb24oYSwgYiwgYykge1xuICAgICAqICAgY29uc29sZS5sb2coYSArIGIgKyBjKTtcbiAgICAgKiB9KTtcbiAgICAgKlxuICAgICAqIGN1cnJpZWQoMSkoMikoMyk7XG4gICAgICogLy8gPT4gNlxuICAgICAqXG4gICAgICogY3VycmllZCgxLCAyKSgzKTtcbiAgICAgKiAvLyA9PiA2XG4gICAgICpcbiAgICAgKiBjdXJyaWVkKDEsIDIsIDMpO1xuICAgICAqIC8vID0+IDZcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjdXJyeShmdW5jLCBhcml0eSkge1xuICAgICAgYXJpdHkgPSB0eXBlb2YgYXJpdHkgPT0gJ251bWJlcicgPyBhcml0eSA6ICgrYXJpdHkgfHwgZnVuYy5sZW5ndGgpO1xuICAgICAgcmV0dXJuIGNyZWF0ZVdyYXBwZXIoZnVuYywgNCwgbnVsbCwgbnVsbCwgbnVsbCwgYXJpdHkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0IHdpbGwgZGVsYXkgdGhlIGV4ZWN1dGlvbiBvZiBgZnVuY2AgdW50aWwgYWZ0ZXJcbiAgICAgKiBgd2FpdGAgbWlsbGlzZWNvbmRzIGhhdmUgZWxhcHNlZCBzaW5jZSB0aGUgbGFzdCB0aW1lIGl0IHdhcyBpbnZva2VkLlxuICAgICAqIFByb3ZpZGUgYW4gb3B0aW9ucyBvYmplY3QgdG8gaW5kaWNhdGUgdGhhdCBgZnVuY2Agc2hvdWxkIGJlIGludm9rZWQgb25cbiAgICAgKiB0aGUgbGVhZGluZyBhbmQvb3IgdHJhaWxpbmcgZWRnZSBvZiB0aGUgYHdhaXRgIHRpbWVvdXQuIFN1YnNlcXVlbnQgY2FsbHNcbiAgICAgKiB0byB0aGUgZGVib3VuY2VkIGZ1bmN0aW9uIHdpbGwgcmV0dXJuIHRoZSByZXN1bHQgb2YgdGhlIGxhc3QgYGZ1bmNgIGNhbGwuXG4gICAgICpcbiAgICAgKiBOb3RlOiBJZiBgbGVhZGluZ2AgYW5kIGB0cmFpbGluZ2Agb3B0aW9ucyBhcmUgYHRydWVgIGBmdW5jYCB3aWxsIGJlIGNhbGxlZFxuICAgICAqIG9uIHRoZSB0cmFpbGluZyBlZGdlIG9mIHRoZSB0aW1lb3V0IG9ubHkgaWYgdGhlIHRoZSBkZWJvdW5jZWQgZnVuY3Rpb24gaXNcbiAgICAgKiBpbnZva2VkIG1vcmUgdGhhbiBvbmNlIGR1cmluZyB0aGUgYHdhaXRgIHRpbWVvdXQuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25zXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gZGVib3VuY2UuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHdhaXQgVGhlIG51bWJlciBvZiBtaWxsaXNlY29uZHMgdG8gZGVsYXkuXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXSBUaGUgb3B0aW9ucyBvYmplY3QuXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5sZWFkaW5nPWZhbHNlXSBTcGVjaWZ5IGV4ZWN1dGlvbiBvbiB0aGUgbGVhZGluZyBlZGdlIG9mIHRoZSB0aW1lb3V0LlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9ucy5tYXhXYWl0XSBUaGUgbWF4aW11bSB0aW1lIGBmdW5jYCBpcyBhbGxvd2VkIHRvIGJlIGRlbGF5ZWQgYmVmb3JlIGl0J3MgY2FsbGVkLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMudHJhaWxpbmc9dHJ1ZV0gU3BlY2lmeSBleGVjdXRpb24gb24gdGhlIHRyYWlsaW5nIGVkZ2Ugb2YgdGhlIHRpbWVvdXQuXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgZGVib3VuY2VkIGZ1bmN0aW9uLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAvLyBhdm9pZCBjb3N0bHkgY2FsY3VsYXRpb25zIHdoaWxlIHRoZSB3aW5kb3cgc2l6ZSBpcyBpbiBmbHV4XG4gICAgICogdmFyIGxhenlMYXlvdXQgPSBfLmRlYm91bmNlKGNhbGN1bGF0ZUxheW91dCwgMTUwKTtcbiAgICAgKiBqUXVlcnkod2luZG93KS5vbigncmVzaXplJywgbGF6eUxheW91dCk7XG4gICAgICpcbiAgICAgKiAvLyBleGVjdXRlIGBzZW5kTWFpbGAgd2hlbiB0aGUgY2xpY2sgZXZlbnQgaXMgZmlyZWQsIGRlYm91bmNpbmcgc3Vic2VxdWVudCBjYWxsc1xuICAgICAqIGpRdWVyeSgnI3Bvc3Rib3gnKS5vbignY2xpY2snLCBfLmRlYm91bmNlKHNlbmRNYWlsLCAzMDAsIHtcbiAgICAgKiAgICdsZWFkaW5nJzogdHJ1ZSxcbiAgICAgKiAgICd0cmFpbGluZyc6IGZhbHNlXG4gICAgICogfSk7XG4gICAgICpcbiAgICAgKiAvLyBlbnN1cmUgYGJhdGNoTG9nYCBpcyBleGVjdXRlZCBvbmNlIGFmdGVyIDEgc2Vjb25kIG9mIGRlYm91bmNlZCBjYWxsc1xuICAgICAqIHZhciBzb3VyY2UgPSBuZXcgRXZlbnRTb3VyY2UoJy9zdHJlYW0nKTtcbiAgICAgKiBzb3VyY2UuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIF8uZGVib3VuY2UoYmF0Y2hMb2csIDI1MCwge1xuICAgICAqICAgJ21heFdhaXQnOiAxMDAwXG4gICAgICogfSwgZmFsc2UpO1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGRlYm91bmNlKGZ1bmMsIHdhaXQsIG9wdGlvbnMpIHtcbiAgICAgIHZhciBhcmdzLFxuICAgICAgICAgIG1heFRpbWVvdXRJZCxcbiAgICAgICAgICByZXN1bHQsXG4gICAgICAgICAgc3RhbXAsXG4gICAgICAgICAgdGhpc0FyZyxcbiAgICAgICAgICB0aW1lb3V0SWQsXG4gICAgICAgICAgdHJhaWxpbmdDYWxsLFxuICAgICAgICAgIGxhc3RDYWxsZWQgPSAwLFxuICAgICAgICAgIG1heFdhaXQgPSBmYWxzZSxcbiAgICAgICAgICB0cmFpbGluZyA9IHRydWU7XG5cbiAgICAgIGlmICghaXNGdW5jdGlvbihmdW5jKSkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yO1xuICAgICAgfVxuICAgICAgd2FpdCA9IG5hdGl2ZU1heCgwLCB3YWl0KSB8fCAwO1xuICAgICAgaWYgKG9wdGlvbnMgPT09IHRydWUpIHtcbiAgICAgICAgdmFyIGxlYWRpbmcgPSB0cnVlO1xuICAgICAgICB0cmFpbGluZyA9IGZhbHNlO1xuICAgICAgfSBlbHNlIGlmIChpc09iamVjdChvcHRpb25zKSkge1xuICAgICAgICBsZWFkaW5nID0gb3B0aW9ucy5sZWFkaW5nO1xuICAgICAgICBtYXhXYWl0ID0gJ21heFdhaXQnIGluIG9wdGlvbnMgJiYgKG5hdGl2ZU1heCh3YWl0LCBvcHRpb25zLm1heFdhaXQpIHx8IDApO1xuICAgICAgICB0cmFpbGluZyA9ICd0cmFpbGluZycgaW4gb3B0aW9ucyA/IG9wdGlvbnMudHJhaWxpbmcgOiB0cmFpbGluZztcbiAgICAgIH1cbiAgICAgIHZhciBkZWxheWVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciByZW1haW5pbmcgPSB3YWl0IC0gKG5vdygpIC0gc3RhbXApO1xuICAgICAgICBpZiAocmVtYWluaW5nIDw9IDApIHtcbiAgICAgICAgICBpZiAobWF4VGltZW91dElkKSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQobWF4VGltZW91dElkKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGlzQ2FsbGVkID0gdHJhaWxpbmdDYWxsO1xuICAgICAgICAgIG1heFRpbWVvdXRJZCA9IHRpbWVvdXRJZCA9IHRyYWlsaW5nQ2FsbCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICBpZiAoaXNDYWxsZWQpIHtcbiAgICAgICAgICAgIGxhc3RDYWxsZWQgPSBub3coKTtcbiAgICAgICAgICAgIHJlc3VsdCA9IGZ1bmMuYXBwbHkodGhpc0FyZywgYXJncyk7XG4gICAgICAgICAgICBpZiAoIXRpbWVvdXRJZCAmJiAhbWF4VGltZW91dElkKSB7XG4gICAgICAgICAgICAgIGFyZ3MgPSB0aGlzQXJnID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGltZW91dElkID0gc2V0VGltZW91dChkZWxheWVkLCByZW1haW5pbmcpO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICB2YXIgbWF4RGVsYXllZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGltZW91dElkKSB7XG4gICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XG4gICAgICAgIH1cbiAgICAgICAgbWF4VGltZW91dElkID0gdGltZW91dElkID0gdHJhaWxpbmdDYWxsID0gdW5kZWZpbmVkO1xuICAgICAgICBpZiAodHJhaWxpbmcgfHwgKG1heFdhaXQgIT09IHdhaXQpKSB7XG4gICAgICAgICAgbGFzdENhbGxlZCA9IG5vdygpO1xuICAgICAgICAgIHJlc3VsdCA9IGZ1bmMuYXBwbHkodGhpc0FyZywgYXJncyk7XG4gICAgICAgICAgaWYgKCF0aW1lb3V0SWQgJiYgIW1heFRpbWVvdXRJZCkge1xuICAgICAgICAgICAgYXJncyA9IHRoaXNBcmcgPSBudWxsO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICBhcmdzID0gYXJndW1lbnRzO1xuICAgICAgICBzdGFtcCA9IG5vdygpO1xuICAgICAgICB0aGlzQXJnID0gdGhpcztcbiAgICAgICAgdHJhaWxpbmdDYWxsID0gdHJhaWxpbmcgJiYgKHRpbWVvdXRJZCB8fCAhbGVhZGluZyk7XG5cbiAgICAgICAgaWYgKG1heFdhaXQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgdmFyIGxlYWRpbmdDYWxsID0gbGVhZGluZyAmJiAhdGltZW91dElkO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmICghbWF4VGltZW91dElkICYmICFsZWFkaW5nKSB7XG4gICAgICAgICAgICBsYXN0Q2FsbGVkID0gc3RhbXA7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciByZW1haW5pbmcgPSBtYXhXYWl0IC0gKHN0YW1wIC0gbGFzdENhbGxlZCksXG4gICAgICAgICAgICAgIGlzQ2FsbGVkID0gcmVtYWluaW5nIDw9IDA7XG5cbiAgICAgICAgICBpZiAoaXNDYWxsZWQpIHtcbiAgICAgICAgICAgIGlmIChtYXhUaW1lb3V0SWQpIHtcbiAgICAgICAgICAgICAgbWF4VGltZW91dElkID0gY2xlYXJUaW1lb3V0KG1heFRpbWVvdXRJZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsYXN0Q2FsbGVkID0gc3RhbXA7XG4gICAgICAgICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KHRoaXNBcmcsIGFyZ3MpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIGlmICghbWF4VGltZW91dElkKSB7XG4gICAgICAgICAgICBtYXhUaW1lb3V0SWQgPSBzZXRUaW1lb3V0KG1heERlbGF5ZWQsIHJlbWFpbmluZyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChpc0NhbGxlZCAmJiB0aW1lb3V0SWQpIHtcbiAgICAgICAgICB0aW1lb3V0SWQgPSBjbGVhclRpbWVvdXQodGltZW91dElkKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghdGltZW91dElkICYmIHdhaXQgIT09IG1heFdhaXQpIHtcbiAgICAgICAgICB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KGRlbGF5ZWQsIHdhaXQpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChsZWFkaW5nQ2FsbCkge1xuICAgICAgICAgIGlzQ2FsbGVkID0gdHJ1ZTtcbiAgICAgICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KHRoaXNBcmcsIGFyZ3MpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc0NhbGxlZCAmJiAhdGltZW91dElkICYmICFtYXhUaW1lb3V0SWQpIHtcbiAgICAgICAgICBhcmdzID0gdGhpc0FyZyA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGVmZXJzIGV4ZWN1dGluZyB0aGUgYGZ1bmNgIGZ1bmN0aW9uIHVudGlsIHRoZSBjdXJyZW50IGNhbGwgc3RhY2sgaGFzIGNsZWFyZWQuXG4gICAgICogQWRkaXRpb25hbCBhcmd1bWVudHMgd2lsbCBiZSBwcm92aWRlZCB0byBgZnVuY2Agd2hlbiBpdCBpcyBpbnZva2VkLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uc1xuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGZ1bmN0aW9uIHRvIGRlZmVyLlxuICAgICAqIEBwYXJhbSB7Li4uKn0gW2FyZ10gQXJndW1lbnRzIHRvIGludm9rZSB0aGUgZnVuY3Rpb24gd2l0aC5cbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIHRoZSB0aW1lciBpZC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5kZWZlcihmdW5jdGlvbih0ZXh0KSB7IGNvbnNvbGUubG9nKHRleHQpOyB9LCAnZGVmZXJyZWQnKTtcbiAgICAgKiAvLyBsb2dzICdkZWZlcnJlZCcgYWZ0ZXIgb25lIG9yIG1vcmUgbWlsbGlzZWNvbmRzXG4gICAgICovXG4gICAgZnVuY3Rpb24gZGVmZXIoZnVuYykge1xuICAgICAgaWYgKCFpc0Z1bmN0aW9uKGZ1bmMpKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3I7XG4gICAgICB9XG4gICAgICB2YXIgYXJncyA9IHNsaWNlKGFyZ3VtZW50cywgMSk7XG4gICAgICByZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbigpIHsgZnVuYy5hcHBseSh1bmRlZmluZWQsIGFyZ3MpOyB9LCAxKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlcyB0aGUgYGZ1bmNgIGZ1bmN0aW9uIGFmdGVyIGB3YWl0YCBtaWxsaXNlY29uZHMuIEFkZGl0aW9uYWwgYXJndW1lbnRzXG4gICAgICogd2lsbCBiZSBwcm92aWRlZCB0byBgZnVuY2Agd2hlbiBpdCBpcyBpbnZva2VkLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uc1xuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGZ1bmN0aW9uIHRvIGRlbGF5LlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB3YWl0IFRoZSBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIHRvIGRlbGF5IGV4ZWN1dGlvbi5cbiAgICAgKiBAcGFyYW0gey4uLip9IFthcmddIEFyZ3VtZW50cyB0byBpbnZva2UgdGhlIGZ1bmN0aW9uIHdpdGguXG4gICAgICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgdGltZXIgaWQuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uZGVsYXkoZnVuY3Rpb24odGV4dCkgeyBjb25zb2xlLmxvZyh0ZXh0KTsgfSwgMTAwMCwgJ2xhdGVyJyk7XG4gICAgICogLy8gPT4gbG9ncyAnbGF0ZXInIGFmdGVyIG9uZSBzZWNvbmRcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBkZWxheShmdW5jLCB3YWl0KSB7XG4gICAgICBpZiAoIWlzRnVuY3Rpb24oZnVuYykpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcjtcbiAgICAgIH1cbiAgICAgIHZhciBhcmdzID0gc2xpY2UoYXJndW1lbnRzLCAyKTtcbiAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgeyBmdW5jLmFwcGx5KHVuZGVmaW5lZCwgYXJncyk7IH0sIHdhaXQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0IG1lbW9pemVzIHRoZSByZXN1bHQgb2YgYGZ1bmNgLiBJZiBgcmVzb2x2ZXJgIGlzXG4gICAgICogcHJvdmlkZWQgaXQgd2lsbCBiZSB1c2VkIHRvIGRldGVybWluZSB0aGUgY2FjaGUga2V5IGZvciBzdG9yaW5nIHRoZSByZXN1bHRcbiAgICAgKiBiYXNlZCBvbiB0aGUgYXJndW1lbnRzIHByb3ZpZGVkIHRvIHRoZSBtZW1vaXplZCBmdW5jdGlvbi4gQnkgZGVmYXVsdCwgdGhlXG4gICAgICogZmlyc3QgYXJndW1lbnQgcHJvdmlkZWQgdG8gdGhlIG1lbW9pemVkIGZ1bmN0aW9uIGlzIHVzZWQgYXMgdGhlIGNhY2hlIGtleS5cbiAgICAgKiBUaGUgYGZ1bmNgIGlzIGV4ZWN1dGVkIHdpdGggdGhlIGB0aGlzYCBiaW5kaW5nIG9mIHRoZSBtZW1vaXplZCBmdW5jdGlvbi5cbiAgICAgKiBUaGUgcmVzdWx0IGNhY2hlIGlzIGV4cG9zZWQgYXMgdGhlIGBjYWNoZWAgcHJvcGVydHkgb24gdGhlIG1lbW9pemVkIGZ1bmN0aW9uLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uc1xuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGZ1bmN0aW9uIHRvIGhhdmUgaXRzIG91dHB1dCBtZW1vaXplZC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbcmVzb2x2ZXJdIEEgZnVuY3Rpb24gdXNlZCB0byByZXNvbHZlIHRoZSBjYWNoZSBrZXkuXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgbWVtb2l6aW5nIGZ1bmN0aW9uLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgZmlib25hY2NpID0gXy5tZW1vaXplKGZ1bmN0aW9uKG4pIHtcbiAgICAgKiAgIHJldHVybiBuIDwgMiA/IG4gOiBmaWJvbmFjY2kobiAtIDEpICsgZmlib25hY2NpKG4gLSAyKTtcbiAgICAgKiB9KTtcbiAgICAgKlxuICAgICAqIGZpYm9uYWNjaSg5KVxuICAgICAqIC8vID0+IDM0XG4gICAgICpcbiAgICAgKiB2YXIgZGF0YSA9IHtcbiAgICAgKiAgICdmcmVkJzogeyAnbmFtZSc6ICdmcmVkJywgJ2FnZSc6IDQwIH0sXG4gICAgICogICAncGViYmxlcyc6IHsgJ25hbWUnOiAncGViYmxlcycsICdhZ2UnOiAxIH1cbiAgICAgKiB9O1xuICAgICAqXG4gICAgICogLy8gbW9kaWZ5aW5nIHRoZSByZXN1bHQgY2FjaGVcbiAgICAgKiB2YXIgZ2V0ID0gXy5tZW1vaXplKGZ1bmN0aW9uKG5hbWUpIHsgcmV0dXJuIGRhdGFbbmFtZV07IH0sIF8uaWRlbnRpdHkpO1xuICAgICAqIGdldCgncGViYmxlcycpO1xuICAgICAqIC8vID0+IHsgJ25hbWUnOiAncGViYmxlcycsICdhZ2UnOiAxIH1cbiAgICAgKlxuICAgICAqIGdldC5jYWNoZS5wZWJibGVzLm5hbWUgPSAncGVuZWxvcGUnO1xuICAgICAqIGdldCgncGViYmxlcycpO1xuICAgICAqIC8vID0+IHsgJ25hbWUnOiAncGVuZWxvcGUnLCAnYWdlJzogMSB9XG4gICAgICovXG4gICAgZnVuY3Rpb24gbWVtb2l6ZShmdW5jLCByZXNvbHZlcikge1xuICAgICAgaWYgKCFpc0Z1bmN0aW9uKGZ1bmMpKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3I7XG4gICAgICB9XG4gICAgICB2YXIgbWVtb2l6ZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGNhY2hlID0gbWVtb2l6ZWQuY2FjaGUsXG4gICAgICAgICAgICBrZXkgPSByZXNvbHZlciA/IHJlc29sdmVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgOiBrZXlQcmVmaXggKyBhcmd1bWVudHNbMF07XG5cbiAgICAgICAgcmV0dXJuIGhhc093blByb3BlcnR5LmNhbGwoY2FjaGUsIGtleSlcbiAgICAgICAgICA/IGNhY2hlW2tleV1cbiAgICAgICAgICA6IChjYWNoZVtrZXldID0gZnVuYy5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcbiAgICAgIH1cbiAgICAgIG1lbW9pemVkLmNhY2hlID0ge307XG4gICAgICByZXR1cm4gbWVtb2l6ZWQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGZ1bmN0aW9uIHRoYXQgaXMgcmVzdHJpY3RlZCB0byBleGVjdXRlIGBmdW5jYCBvbmNlLiBSZXBlYXQgY2FsbHMgdG9cbiAgICAgKiB0aGUgZnVuY3Rpb24gd2lsbCByZXR1cm4gdGhlIHZhbHVlIG9mIHRoZSBmaXJzdCBjYWxsLiBUaGUgYGZ1bmNgIGlzIGV4ZWN1dGVkXG4gICAgICogd2l0aCB0aGUgYHRoaXNgIGJpbmRpbmcgb2YgdGhlIGNyZWF0ZWQgZnVuY3Rpb24uXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25zXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gcmVzdHJpY3QuXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgcmVzdHJpY3RlZCBmdW5jdGlvbi5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIGluaXRpYWxpemUgPSBfLm9uY2UoY3JlYXRlQXBwbGljYXRpb24pO1xuICAgICAqIGluaXRpYWxpemUoKTtcbiAgICAgKiBpbml0aWFsaXplKCk7XG4gICAgICogLy8gYGluaXRpYWxpemVgIGV4ZWN1dGVzIGBjcmVhdGVBcHBsaWNhdGlvbmAgb25jZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIG9uY2UoZnVuYykge1xuICAgICAgdmFyIHJhbixcbiAgICAgICAgICByZXN1bHQ7XG5cbiAgICAgIGlmICghaXNGdW5jdGlvbihmdW5jKSkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAocmFuKSB7XG4gICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuICAgICAgICByYW4gPSB0cnVlO1xuICAgICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cbiAgICAgICAgLy8gY2xlYXIgdGhlIGBmdW5jYCB2YXJpYWJsZSBzbyB0aGUgZnVuY3Rpb24gbWF5IGJlIGdhcmJhZ2UgY29sbGVjdGVkXG4gICAgICAgIGZ1bmMgPSBudWxsO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCwgd2hlbiBjYWxsZWQsIGludm9rZXMgYGZ1bmNgIHdpdGggYW55IGFkZGl0aW9uYWxcbiAgICAgKiBgcGFydGlhbGAgYXJndW1lbnRzIHByZXBlbmRlZCB0byB0aG9zZSBwcm92aWRlZCB0byB0aGUgbmV3IGZ1bmN0aW9uLiBUaGlzXG4gICAgICogbWV0aG9kIGlzIHNpbWlsYXIgdG8gYF8uYmluZGAgZXhjZXB0IGl0IGRvZXMgKipub3QqKiBhbHRlciB0aGUgYHRoaXNgIGJpbmRpbmcuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25zXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gcGFydGlhbGx5IGFwcGx5IGFyZ3VtZW50cyB0by5cbiAgICAgKiBAcGFyYW0gey4uLip9IFthcmddIEFyZ3VtZW50cyB0byBiZSBwYXJ0aWFsbHkgYXBwbGllZC5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBwYXJ0aWFsbHkgYXBwbGllZCBmdW5jdGlvbi5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIGdyZWV0ID0gZnVuY3Rpb24oZ3JlZXRpbmcsIG5hbWUpIHsgcmV0dXJuIGdyZWV0aW5nICsgJyAnICsgbmFtZTsgfTtcbiAgICAgKiB2YXIgaGkgPSBfLnBhcnRpYWwoZ3JlZXQsICdoaScpO1xuICAgICAqIGhpKCdmcmVkJyk7XG4gICAgICogLy8gPT4gJ2hpIGZyZWQnXG4gICAgICovXG4gICAgZnVuY3Rpb24gcGFydGlhbChmdW5jKSB7XG4gICAgICByZXR1cm4gY3JlYXRlV3JhcHBlcihmdW5jLCAxNiwgc2xpY2UoYXJndW1lbnRzLCAxKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2QgaXMgbGlrZSBgXy5wYXJ0aWFsYCBleGNlcHQgdGhhdCBgcGFydGlhbGAgYXJndW1lbnRzIGFyZVxuICAgICAqIGFwcGVuZGVkIHRvIHRob3NlIHByb3ZpZGVkIHRvIHRoZSBuZXcgZnVuY3Rpb24uXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25zXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gcGFydGlhbGx5IGFwcGx5IGFyZ3VtZW50cyB0by5cbiAgICAgKiBAcGFyYW0gey4uLip9IFthcmddIEFyZ3VtZW50cyB0byBiZSBwYXJ0aWFsbHkgYXBwbGllZC5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBwYXJ0aWFsbHkgYXBwbGllZCBmdW5jdGlvbi5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIGRlZmF1bHRzRGVlcCA9IF8ucGFydGlhbFJpZ2h0KF8ubWVyZ2UsIF8uZGVmYXVsdHMpO1xuICAgICAqXG4gICAgICogdmFyIG9wdGlvbnMgPSB7XG4gICAgICogICAndmFyaWFibGUnOiAnZGF0YScsXG4gICAgICogICAnaW1wb3J0cyc6IHsgJ2pxJzogJCB9XG4gICAgICogfTtcbiAgICAgKlxuICAgICAqIGRlZmF1bHRzRGVlcChvcHRpb25zLCBfLnRlbXBsYXRlU2V0dGluZ3MpO1xuICAgICAqXG4gICAgICogb3B0aW9ucy52YXJpYWJsZVxuICAgICAqIC8vID0+ICdkYXRhJ1xuICAgICAqXG4gICAgICogb3B0aW9ucy5pbXBvcnRzXG4gICAgICogLy8gPT4geyAnXyc6IF8sICdqcSc6ICQgfVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHBhcnRpYWxSaWdodChmdW5jKSB7XG4gICAgICByZXR1cm4gY3JlYXRlV3JhcHBlcihmdW5jLCAzMiwgbnVsbCwgc2xpY2UoYXJndW1lbnRzLCAxKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGZ1bmN0aW9uIHRoYXQsIHdoZW4gZXhlY3V0ZWQsIHdpbGwgb25seSBjYWxsIHRoZSBgZnVuY2AgZnVuY3Rpb25cbiAgICAgKiBhdCBtb3N0IG9uY2UgcGVyIGV2ZXJ5IGB3YWl0YCBtaWxsaXNlY29uZHMuIFByb3ZpZGUgYW4gb3B0aW9ucyBvYmplY3QgdG9cbiAgICAgKiBpbmRpY2F0ZSB0aGF0IGBmdW5jYCBzaG91bGQgYmUgaW52b2tlZCBvbiB0aGUgbGVhZGluZyBhbmQvb3IgdHJhaWxpbmcgZWRnZVxuICAgICAqIG9mIHRoZSBgd2FpdGAgdGltZW91dC4gU3Vic2VxdWVudCBjYWxscyB0byB0aGUgdGhyb3R0bGVkIGZ1bmN0aW9uIHdpbGxcbiAgICAgKiByZXR1cm4gdGhlIHJlc3VsdCBvZiB0aGUgbGFzdCBgZnVuY2AgY2FsbC5cbiAgICAgKlxuICAgICAqIE5vdGU6IElmIGBsZWFkaW5nYCBhbmQgYHRyYWlsaW5nYCBvcHRpb25zIGFyZSBgdHJ1ZWAgYGZ1bmNgIHdpbGwgYmUgY2FsbGVkXG4gICAgICogb24gdGhlIHRyYWlsaW5nIGVkZ2Ugb2YgdGhlIHRpbWVvdXQgb25seSBpZiB0aGUgdGhlIHRocm90dGxlZCBmdW5jdGlvbiBpc1xuICAgICAqIGludm9rZWQgbW9yZSB0aGFuIG9uY2UgZHVyaW5nIHRoZSBgd2FpdGAgdGltZW91dC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvbnNcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byB0aHJvdHRsZS5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gd2FpdCBUaGUgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0byB0aHJvdHRsZSBleGVjdXRpb25zIHRvLlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc10gVGhlIG9wdGlvbnMgb2JqZWN0LlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMubGVhZGluZz10cnVlXSBTcGVjaWZ5IGV4ZWN1dGlvbiBvbiB0aGUgbGVhZGluZyBlZGdlIG9mIHRoZSB0aW1lb3V0LlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMudHJhaWxpbmc9dHJ1ZV0gU3BlY2lmeSBleGVjdXRpb24gb24gdGhlIHRyYWlsaW5nIGVkZ2Ugb2YgdGhlIHRpbWVvdXQuXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgdGhyb3R0bGVkIGZ1bmN0aW9uLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAvLyBhdm9pZCBleGNlc3NpdmVseSB1cGRhdGluZyB0aGUgcG9zaXRpb24gd2hpbGUgc2Nyb2xsaW5nXG4gICAgICogdmFyIHRocm90dGxlZCA9IF8udGhyb3R0bGUodXBkYXRlUG9zaXRpb24sIDEwMCk7XG4gICAgICogalF1ZXJ5KHdpbmRvdykub24oJ3Njcm9sbCcsIHRocm90dGxlZCk7XG4gICAgICpcbiAgICAgKiAvLyBleGVjdXRlIGByZW5ld1Rva2VuYCB3aGVuIHRoZSBjbGljayBldmVudCBpcyBmaXJlZCwgYnV0IG5vdCBtb3JlIHRoYW4gb25jZSBldmVyeSA1IG1pbnV0ZXNcbiAgICAgKiBqUXVlcnkoJy5pbnRlcmFjdGl2ZScpLm9uKCdjbGljaycsIF8udGhyb3R0bGUocmVuZXdUb2tlbiwgMzAwMDAwLCB7XG4gICAgICogICAndHJhaWxpbmcnOiBmYWxzZVxuICAgICAqIH0pKTtcbiAgICAgKi9cbiAgICBmdW5jdGlvbiB0aHJvdHRsZShmdW5jLCB3YWl0LCBvcHRpb25zKSB7XG4gICAgICB2YXIgbGVhZGluZyA9IHRydWUsXG4gICAgICAgICAgdHJhaWxpbmcgPSB0cnVlO1xuXG4gICAgICBpZiAoIWlzRnVuY3Rpb24oZnVuYykpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcjtcbiAgICAgIH1cbiAgICAgIGlmIChvcHRpb25zID09PSBmYWxzZSkge1xuICAgICAgICBsZWFkaW5nID0gZmFsc2U7XG4gICAgICB9IGVsc2UgaWYgKGlzT2JqZWN0KG9wdGlvbnMpKSB7XG4gICAgICAgIGxlYWRpbmcgPSAnbGVhZGluZycgaW4gb3B0aW9ucyA/IG9wdGlvbnMubGVhZGluZyA6IGxlYWRpbmc7XG4gICAgICAgIHRyYWlsaW5nID0gJ3RyYWlsaW5nJyBpbiBvcHRpb25zID8gb3B0aW9ucy50cmFpbGluZyA6IHRyYWlsaW5nO1xuICAgICAgfVxuICAgICAgZGVib3VuY2VPcHRpb25zLmxlYWRpbmcgPSBsZWFkaW5nO1xuICAgICAgZGVib3VuY2VPcHRpb25zLm1heFdhaXQgPSB3YWl0O1xuICAgICAgZGVib3VuY2VPcHRpb25zLnRyYWlsaW5nID0gdHJhaWxpbmc7XG5cbiAgICAgIHJldHVybiBkZWJvdW5jZShmdW5jLCB3YWl0LCBkZWJvdW5jZU9wdGlvbnMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0IHByb3ZpZGVzIGB2YWx1ZWAgdG8gdGhlIHdyYXBwZXIgZnVuY3Rpb24gYXMgaXRzXG4gICAgICogZmlyc3QgYXJndW1lbnQuIEFkZGl0aW9uYWwgYXJndW1lbnRzIHByb3ZpZGVkIHRvIHRoZSBmdW5jdGlvbiBhcmUgYXBwZW5kZWRcbiAgICAgKiB0byB0aG9zZSBwcm92aWRlZCB0byB0aGUgd3JhcHBlciBmdW5jdGlvbi4gVGhlIHdyYXBwZXIgaXMgZXhlY3V0ZWQgd2l0aFxuICAgICAqIHRoZSBgdGhpc2AgYmluZGluZyBvZiB0aGUgY3JlYXRlZCBmdW5jdGlvbi5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvbnNcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byB3cmFwLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IHdyYXBwZXIgVGhlIHdyYXBwZXIgZnVuY3Rpb24uXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgZnVuY3Rpb24uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBwID0gXy53cmFwKF8uZXNjYXBlLCBmdW5jdGlvbihmdW5jLCB0ZXh0KSB7XG4gICAgICogICByZXR1cm4gJzxwPicgKyBmdW5jKHRleHQpICsgJzwvcD4nO1xuICAgICAqIH0pO1xuICAgICAqXG4gICAgICogcCgnRnJlZCwgV2lsbWEsICYgUGViYmxlcycpO1xuICAgICAqIC8vID0+ICc8cD5GcmVkLCBXaWxtYSwgJmFtcDsgUGViYmxlczwvcD4nXG4gICAgICovXG4gICAgZnVuY3Rpb24gd3JhcCh2YWx1ZSwgd3JhcHBlcikge1xuICAgICAgcmV0dXJuIGNyZWF0ZVdyYXBwZXIod3JhcHBlciwgMTYsIFt2YWx1ZV0pO1xuICAgIH1cblxuICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBgdmFsdWVgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IFV0aWxpdGllc1xuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHJldHVybiBmcm9tIHRoZSBuZXcgZnVuY3Rpb24uXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgZnVuY3Rpb24uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBvYmplY3QgPSB7ICduYW1lJzogJ2ZyZWQnIH07XG4gICAgICogdmFyIGdldHRlciA9IF8uY29uc3RhbnQob2JqZWN0KTtcbiAgICAgKiBnZXR0ZXIoKSA9PT0gb2JqZWN0O1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb25zdGFudCh2YWx1ZSkge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFByb2R1Y2VzIGEgY2FsbGJhY2sgYm91bmQgdG8gYW4gb3B0aW9uYWwgYHRoaXNBcmdgLiBJZiBgZnVuY2AgaXMgYSBwcm9wZXJ0eVxuICAgICAqIG5hbWUgdGhlIGNyZWF0ZWQgY2FsbGJhY2sgd2lsbCByZXR1cm4gdGhlIHByb3BlcnR5IHZhbHVlIGZvciBhIGdpdmVuIGVsZW1lbnQuXG4gICAgICogSWYgYGZ1bmNgIGlzIGFuIG9iamVjdCB0aGUgY3JlYXRlZCBjYWxsYmFjayB3aWxsIHJldHVybiBgdHJ1ZWAgZm9yIGVsZW1lbnRzXG4gICAgICogdGhhdCBjb250YWluIHRoZSBlcXVpdmFsZW50IG9iamVjdCBwcm9wZXJ0aWVzLCBvdGhlcndpc2UgaXQgd2lsbCByZXR1cm4gYGZhbHNlYC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBVdGlsaXRpZXNcbiAgICAgKiBAcGFyYW0geyp9IFtmdW5jPWlkZW50aXR5XSBUaGUgdmFsdWUgdG8gY29udmVydCB0byBhIGNhbGxiYWNrLlxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiB0aGUgY3JlYXRlZCBjYWxsYmFjay5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW2FyZ0NvdW50XSBUaGUgbnVtYmVyIG9mIGFyZ3VtZW50cyB0aGUgY2FsbGJhY2sgYWNjZXB0cy5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgYSBjYWxsYmFjayBmdW5jdGlvbi5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIGNoYXJhY3RlcnMgPSBbXG4gICAgICogICB7ICduYW1lJzogJ2Jhcm5leScsICdhZ2UnOiAzNiB9LFxuICAgICAqICAgeyAnbmFtZSc6ICdmcmVkJywgICAnYWdlJzogNDAgfVxuICAgICAqIF07XG4gICAgICpcbiAgICAgKiAvLyB3cmFwIHRvIGNyZWF0ZSBjdXN0b20gY2FsbGJhY2sgc2hvcnRoYW5kc1xuICAgICAqIF8uY3JlYXRlQ2FsbGJhY2sgPSBfLndyYXAoXy5jcmVhdGVDYWxsYmFjaywgZnVuY3Rpb24oZnVuYywgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgKiAgIHZhciBtYXRjaCA9IC9eKC4rPylfXyhbZ2xddCkoLispJC8uZXhlYyhjYWxsYmFjayk7XG4gICAgICogICByZXR1cm4gIW1hdGNoID8gZnVuYyhjYWxsYmFjaywgdGhpc0FyZykgOiBmdW5jdGlvbihvYmplY3QpIHtcbiAgICAgKiAgICAgcmV0dXJuIG1hdGNoWzJdID09ICdndCcgPyBvYmplY3RbbWF0Y2hbMV1dID4gbWF0Y2hbM10gOiBvYmplY3RbbWF0Y2hbMV1dIDwgbWF0Y2hbM107XG4gICAgICogICB9O1xuICAgICAqIH0pO1xuICAgICAqXG4gICAgICogXy5maWx0ZXIoY2hhcmFjdGVycywgJ2FnZV9fZ3QzOCcpO1xuICAgICAqIC8vID0+IFt7ICduYW1lJzogJ2ZyZWQnLCAnYWdlJzogNDAgfV1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjcmVhdGVDYWxsYmFjayhmdW5jLCB0aGlzQXJnLCBhcmdDb3VudCkge1xuICAgICAgdmFyIHR5cGUgPSB0eXBlb2YgZnVuYztcbiAgICAgIGlmIChmdW5jID09IG51bGwgfHwgdHlwZSA9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHJldHVybiBiYXNlQ3JlYXRlQ2FsbGJhY2soZnVuYywgdGhpc0FyZywgYXJnQ291bnQpO1xuICAgICAgfVxuICAgICAgLy8gaGFuZGxlIFwiXy5wbHVja1wiIHN0eWxlIGNhbGxiYWNrIHNob3J0aGFuZHNcbiAgICAgIGlmICh0eXBlICE9ICdvYmplY3QnKSB7XG4gICAgICAgIHJldHVybiBwcm9wZXJ0eShmdW5jKTtcbiAgICAgIH1cbiAgICAgIHZhciBwcm9wcyA9IGtleXMoZnVuYyksXG4gICAgICAgICAga2V5ID0gcHJvcHNbMF0sXG4gICAgICAgICAgYSA9IGZ1bmNba2V5XTtcblxuICAgICAgLy8gaGFuZGxlIFwiXy53aGVyZVwiIHN0eWxlIGNhbGxiYWNrIHNob3J0aGFuZHNcbiAgICAgIGlmIChwcm9wcy5sZW5ndGggPT0gMSAmJiBhID09PSBhICYmICFpc09iamVjdChhKSkge1xuICAgICAgICAvLyBmYXN0IHBhdGggdGhlIGNvbW1vbiBjYXNlIG9mIHByb3ZpZGluZyBhbiBvYmplY3Qgd2l0aCBhIHNpbmdsZVxuICAgICAgICAvLyBwcm9wZXJ0eSBjb250YWluaW5nIGEgcHJpbWl0aXZlIHZhbHVlXG4gICAgICAgIHJldHVybiBmdW5jdGlvbihvYmplY3QpIHtcbiAgICAgICAgICB2YXIgYiA9IG9iamVjdFtrZXldO1xuICAgICAgICAgIHJldHVybiBhID09PSBiICYmIChhICE9PSAwIHx8ICgxIC8gYSA9PSAxIC8gYikpO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgcmV0dXJuIGZ1bmN0aW9uKG9iamVjdCkge1xuICAgICAgICB2YXIgbGVuZ3RoID0gcHJvcHMubGVuZ3RoLFxuICAgICAgICAgICAgcmVzdWx0ID0gZmFsc2U7XG5cbiAgICAgICAgd2hpbGUgKGxlbmd0aC0tKSB7XG4gICAgICAgICAgaWYgKCEocmVzdWx0ID0gYmFzZUlzRXF1YWwob2JqZWN0W3Byb3BzW2xlbmd0aF1dLCBmdW5jW3Byb3BzW2xlbmd0aF1dLCBudWxsLCB0cnVlKSkpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyB0aGUgY2hhcmFjdGVycyBgJmAsIGA8YCwgYD5gLCBgXCJgLCBhbmQgYCdgIGluIGBzdHJpbmdgIHRvIHRoZWlyXG4gICAgICogY29ycmVzcG9uZGluZyBIVE1MIGVudGl0aWVzLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IFV0aWxpdGllc1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzdHJpbmcgVGhlIHN0cmluZyB0byBlc2NhcGUuXG4gICAgICogQHJldHVybnMge3N0cmluZ30gUmV0dXJucyB0aGUgZXNjYXBlZCBzdHJpbmcuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uZXNjYXBlKCdGcmVkLCBXaWxtYSwgJiBQZWJibGVzJyk7XG4gICAgICogLy8gPT4gJ0ZyZWQsIFdpbG1hLCAmYW1wOyBQZWJibGVzJ1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGVzY2FwZShzdHJpbmcpIHtcbiAgICAgIHJldHVybiBzdHJpbmcgPT0gbnVsbCA/ICcnIDogU3RyaW5nKHN0cmluZykucmVwbGFjZShyZVVuZXNjYXBlZEh0bWwsIGVzY2FwZUh0bWxDaGFyKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCByZXR1cm5zIHRoZSBmaXJzdCBhcmd1bWVudCBwcm92aWRlZCB0byBpdC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBVdGlsaXRpZXNcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIEFueSB2YWx1ZS5cbiAgICAgKiBAcmV0dXJucyB7Kn0gUmV0dXJucyBgdmFsdWVgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgb2JqZWN0ID0geyAnbmFtZSc6ICdmcmVkJyB9O1xuICAgICAqIF8uaWRlbnRpdHkob2JqZWN0KSA9PT0gb2JqZWN0O1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpZGVudGl0eSh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZHMgZnVuY3Rpb24gcHJvcGVydGllcyBvZiBhIHNvdXJjZSBvYmplY3QgdG8gdGhlIGRlc3RpbmF0aW9uIG9iamVjdC5cbiAgICAgKiBJZiBgb2JqZWN0YCBpcyBhIGZ1bmN0aW9uIG1ldGhvZHMgd2lsbCBiZSBhZGRlZCB0byBpdHMgcHJvdG90eXBlIGFzIHdlbGwuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgVXRpbGl0aWVzXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbnxPYmplY3R9IFtvYmplY3Q9bG9kYXNoXSBvYmplY3QgVGhlIGRlc3RpbmF0aW9uIG9iamVjdC5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gc291cmNlIFRoZSBvYmplY3Qgb2YgZnVuY3Rpb25zIHRvIGFkZC5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdIFRoZSBvcHRpb25zIG9iamVjdC5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLmNoYWluPXRydWVdIFNwZWNpZnkgd2hldGhlciB0aGUgZnVuY3Rpb25zIGFkZGVkIGFyZSBjaGFpbmFibGUuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIGZ1bmN0aW9uIGNhcGl0YWxpemUoc3RyaW5nKSB7XG4gICAgICogICByZXR1cm4gc3RyaW5nLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgc3RyaW5nLnNsaWNlKDEpLnRvTG93ZXJDYXNlKCk7XG4gICAgICogfVxuICAgICAqXG4gICAgICogXy5taXhpbih7ICdjYXBpdGFsaXplJzogY2FwaXRhbGl6ZSB9KTtcbiAgICAgKiBfLmNhcGl0YWxpemUoJ2ZyZWQnKTtcbiAgICAgKiAvLyA9PiAnRnJlZCdcbiAgICAgKlxuICAgICAqIF8oJ2ZyZWQnKS5jYXBpdGFsaXplKCkudmFsdWUoKTtcbiAgICAgKiAvLyA9PiAnRnJlZCdcbiAgICAgKlxuICAgICAqIF8ubWl4aW4oeyAnY2FwaXRhbGl6ZSc6IGNhcGl0YWxpemUgfSwgeyAnY2hhaW4nOiBmYWxzZSB9KTtcbiAgICAgKiBfKCdmcmVkJykuY2FwaXRhbGl6ZSgpO1xuICAgICAqIC8vID0+ICdGcmVkJ1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIG1peGluKG9iamVjdCwgc291cmNlLCBvcHRpb25zKSB7XG4gICAgICB2YXIgY2hhaW4gPSB0cnVlLFxuICAgICAgICAgIG1ldGhvZE5hbWVzID0gc291cmNlICYmIGZ1bmN0aW9ucyhzb3VyY2UpO1xuXG4gICAgICBpZiAoIXNvdXJjZSB8fCAoIW9wdGlvbnMgJiYgIW1ldGhvZE5hbWVzLmxlbmd0aCkpIHtcbiAgICAgICAgaWYgKG9wdGlvbnMgPT0gbnVsbCkge1xuICAgICAgICAgIG9wdGlvbnMgPSBzb3VyY2U7XG4gICAgICAgIH1cbiAgICAgICAgY3RvciA9IGxvZGFzaFdyYXBwZXI7XG4gICAgICAgIHNvdXJjZSA9IG9iamVjdDtcbiAgICAgICAgb2JqZWN0ID0gbG9kYXNoO1xuICAgICAgICBtZXRob2ROYW1lcyA9IGZ1bmN0aW9ucyhzb3VyY2UpO1xuICAgICAgfVxuICAgICAgaWYgKG9wdGlvbnMgPT09IGZhbHNlKSB7XG4gICAgICAgIGNoYWluID0gZmFsc2U7XG4gICAgICB9IGVsc2UgaWYgKGlzT2JqZWN0KG9wdGlvbnMpICYmICdjaGFpbicgaW4gb3B0aW9ucykge1xuICAgICAgICBjaGFpbiA9IG9wdGlvbnMuY2hhaW47XG4gICAgICB9XG4gICAgICB2YXIgY3RvciA9IG9iamVjdCxcbiAgICAgICAgICBpc0Z1bmMgPSBpc0Z1bmN0aW9uKGN0b3IpO1xuXG4gICAgICBmb3JFYWNoKG1ldGhvZE5hbWVzLCBmdW5jdGlvbihtZXRob2ROYW1lKSB7XG4gICAgICAgIHZhciBmdW5jID0gb2JqZWN0W21ldGhvZE5hbWVdID0gc291cmNlW21ldGhvZE5hbWVdO1xuICAgICAgICBpZiAoaXNGdW5jKSB7XG4gICAgICAgICAgY3Rvci5wcm90b3R5cGVbbWV0aG9kTmFtZV0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBjaGFpbkFsbCA9IHRoaXMuX19jaGFpbl9fLFxuICAgICAgICAgICAgICAgIHZhbHVlID0gdGhpcy5fX3dyYXBwZWRfXyxcbiAgICAgICAgICAgICAgICBhcmdzID0gW3ZhbHVlXTtcblxuICAgICAgICAgICAgcHVzaC5hcHBseShhcmdzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGZ1bmMuYXBwbHkob2JqZWN0LCBhcmdzKTtcbiAgICAgICAgICAgIGlmIChjaGFpbiB8fCBjaGFpbkFsbCkge1xuICAgICAgICAgICAgICBpZiAodmFsdWUgPT09IHJlc3VsdCAmJiBpc09iamVjdChyZXN1bHQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmVzdWx0ID0gbmV3IGN0b3IocmVzdWx0KTtcbiAgICAgICAgICAgICAgcmVzdWx0Ll9fY2hhaW5fXyA9IGNoYWluQWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXZlcnRzIHRoZSAnXycgdmFyaWFibGUgdG8gaXRzIHByZXZpb3VzIHZhbHVlIGFuZCByZXR1cm5zIGEgcmVmZXJlbmNlIHRvXG4gICAgICogdGhlIGBsb2Rhc2hgIGZ1bmN0aW9uLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IFV0aWxpdGllc1xuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgYGxvZGFzaGAgZnVuY3Rpb24uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBsb2Rhc2ggPSBfLm5vQ29uZmxpY3QoKTtcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBub0NvbmZsaWN0KCkge1xuICAgICAgY29udGV4dC5fID0gb2xkRGFzaDtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEEgbm8tb3BlcmF0aW9uIGZ1bmN0aW9uLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IFV0aWxpdGllc1xuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgb2JqZWN0ID0geyAnbmFtZSc6ICdmcmVkJyB9O1xuICAgICAqIF8ubm9vcChvYmplY3QpID09PSB1bmRlZmluZWQ7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIG5vb3AoKSB7XG4gICAgICAvLyBubyBvcGVyYXRpb24gcGVyZm9ybWVkXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0aGF0IGhhdmUgZWxhcHNlZCBzaW5jZSB0aGUgVW5peCBlcG9jaFxuICAgICAqICgxIEphbnVhcnkgMTk3MCAwMDowMDowMCBVVEMpLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IFV0aWxpdGllc1xuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgc3RhbXAgPSBfLm5vdygpO1xuICAgICAqIF8uZGVmZXIoZnVuY3Rpb24oKSB7IGNvbnNvbGUubG9nKF8ubm93KCkgLSBzdGFtcCk7IH0pO1xuICAgICAqIC8vID0+IGxvZ3MgdGhlIG51bWJlciBvZiBtaWxsaXNlY29uZHMgaXQgdG9vayBmb3IgdGhlIGRlZmVycmVkIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZFxuICAgICAqL1xuICAgIHZhciBub3cgPSBpc05hdGl2ZShub3cgPSBEYXRlLm5vdykgJiYgbm93IHx8IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyB0aGUgZ2l2ZW4gdmFsdWUgaW50byBhbiBpbnRlZ2VyIG9mIHRoZSBzcGVjaWZpZWQgcmFkaXguXG4gICAgICogSWYgYHJhZGl4YCBpcyBgdW5kZWZpbmVkYCBvciBgMGAgYSBgcmFkaXhgIG9mIGAxMGAgaXMgdXNlZCB1bmxlc3MgdGhlXG4gICAgICogYHZhbHVlYCBpcyBhIGhleGFkZWNpbWFsLCBpbiB3aGljaCBjYXNlIGEgYHJhZGl4YCBvZiBgMTZgIGlzIHVzZWQuXG4gICAgICpcbiAgICAgKiBOb3RlOiBUaGlzIG1ldGhvZCBhdm9pZHMgZGlmZmVyZW5jZXMgaW4gbmF0aXZlIEVTMyBhbmQgRVM1IGBwYXJzZUludGBcbiAgICAgKiBpbXBsZW1lbnRhdGlvbnMuIFNlZSBodHRwOi8vZXM1LmdpdGh1Yi5pby8jRS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBVdGlsaXRpZXNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdmFsdWUgVGhlIHZhbHVlIHRvIHBhcnNlLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbcmFkaXhdIFRoZSByYWRpeCB1c2VkIHRvIGludGVycHJldCB0aGUgdmFsdWUgdG8gcGFyc2UuXG4gICAgICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgbmV3IGludGVnZXIgdmFsdWUuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8ucGFyc2VJbnQoJzA4Jyk7XG4gICAgICogLy8gPT4gOFxuICAgICAqL1xuICAgIHZhciBwYXJzZUludCA9IG5hdGl2ZVBhcnNlSW50KHdoaXRlc3BhY2UgKyAnMDgnKSA9PSA4ID8gbmF0aXZlUGFyc2VJbnQgOiBmdW5jdGlvbih2YWx1ZSwgcmFkaXgpIHtcbiAgICAgIC8vIEZpcmVmb3ggPCAyMSBhbmQgT3BlcmEgPCAxNSBmb2xsb3cgdGhlIEVTMyBzcGVjaWZpZWQgaW1wbGVtZW50YXRpb24gb2YgYHBhcnNlSW50YFxuICAgICAgcmV0dXJuIG5hdGl2ZVBhcnNlSW50KGlzU3RyaW5nKHZhbHVlKSA/IHZhbHVlLnJlcGxhY2UocmVMZWFkaW5nU3BhY2VzQW5kWmVyb3MsICcnKSA6IHZhbHVlLCByYWRpeCB8fCAwKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIFwiXy5wbHVja1wiIHN0eWxlIGZ1bmN0aW9uLCB3aGljaCByZXR1cm5zIHRoZSBga2V5YCB2YWx1ZSBvZiBhXG4gICAgICogZ2l2ZW4gb2JqZWN0LlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IFV0aWxpdGllc1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgVGhlIG5hbWUgb2YgdGhlIHByb3BlcnR5IHRvIHJldHJpZXZlLlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IGZ1bmN0aW9uLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgY2hhcmFjdGVycyA9IFtcbiAgICAgKiAgIHsgJ25hbWUnOiAnZnJlZCcsICAgJ2FnZSc6IDQwIH0sXG4gICAgICogICB7ICduYW1lJzogJ2Jhcm5leScsICdhZ2UnOiAzNiB9XG4gICAgICogXTtcbiAgICAgKlxuICAgICAqIHZhciBnZXROYW1lID0gXy5wcm9wZXJ0eSgnbmFtZScpO1xuICAgICAqXG4gICAgICogXy5tYXAoY2hhcmFjdGVycywgZ2V0TmFtZSk7XG4gICAgICogLy8gPT4gWydiYXJuZXknLCAnZnJlZCddXG4gICAgICpcbiAgICAgKiBfLnNvcnRCeShjaGFyYWN0ZXJzLCBnZXROYW1lKTtcbiAgICAgKiAvLyA9PiBbeyAnbmFtZSc6ICdiYXJuZXknLCAnYWdlJzogMzYgfSwgeyAnbmFtZSc6ICdmcmVkJywgICAnYWdlJzogNDAgfV1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBwcm9wZXJ0eShrZXkpIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbihvYmplY3QpIHtcbiAgICAgICAgcmV0dXJuIG9iamVjdFtrZXldO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcm9kdWNlcyBhIHJhbmRvbSBudW1iZXIgYmV0d2VlbiBgbWluYCBhbmQgYG1heGAgKGluY2x1c2l2ZSkuIElmIG9ubHkgb25lXG4gICAgICogYXJndW1lbnQgaXMgcHJvdmlkZWQgYSBudW1iZXIgYmV0d2VlbiBgMGAgYW5kIHRoZSBnaXZlbiBudW1iZXIgd2lsbCBiZVxuICAgICAqIHJldHVybmVkLiBJZiBgZmxvYXRpbmdgIGlzIHRydWV5IG9yIGVpdGhlciBgbWluYCBvciBgbWF4YCBhcmUgZmxvYXRzIGFcbiAgICAgKiBmbG9hdGluZy1wb2ludCBudW1iZXIgd2lsbCBiZSByZXR1cm5lZCBpbnN0ZWFkIG9mIGFuIGludGVnZXIuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgVXRpbGl0aWVzXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFttaW49MF0gVGhlIG1pbmltdW0gcG9zc2libGUgdmFsdWUuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFttYXg9MV0gVGhlIG1heGltdW0gcG9zc2libGUgdmFsdWUuXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbZmxvYXRpbmc9ZmFsc2VdIFNwZWNpZnkgcmV0dXJuaW5nIGEgZmxvYXRpbmctcG9pbnQgbnVtYmVyLlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgYSByYW5kb20gbnVtYmVyLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLnJhbmRvbSgwLCA1KTtcbiAgICAgKiAvLyA9PiBhbiBpbnRlZ2VyIGJldHdlZW4gMCBhbmQgNVxuICAgICAqXG4gICAgICogXy5yYW5kb20oNSk7XG4gICAgICogLy8gPT4gYWxzbyBhbiBpbnRlZ2VyIGJldHdlZW4gMCBhbmQgNVxuICAgICAqXG4gICAgICogXy5yYW5kb20oNSwgdHJ1ZSk7XG4gICAgICogLy8gPT4gYSBmbG9hdGluZy1wb2ludCBudW1iZXIgYmV0d2VlbiAwIGFuZCA1XG4gICAgICpcbiAgICAgKiBfLnJhbmRvbSgxLjIsIDUuMik7XG4gICAgICogLy8gPT4gYSBmbG9hdGluZy1wb2ludCBudW1iZXIgYmV0d2VlbiAxLjIgYW5kIDUuMlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHJhbmRvbShtaW4sIG1heCwgZmxvYXRpbmcpIHtcbiAgICAgIHZhciBub01pbiA9IG1pbiA9PSBudWxsLFxuICAgICAgICAgIG5vTWF4ID0gbWF4ID09IG51bGw7XG5cbiAgICAgIGlmIChmbG9hdGluZyA9PSBudWxsKSB7XG4gICAgICAgIGlmICh0eXBlb2YgbWluID09ICdib29sZWFuJyAmJiBub01heCkge1xuICAgICAgICAgIGZsb2F0aW5nID0gbWluO1xuICAgICAgICAgIG1pbiA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIW5vTWF4ICYmIHR5cGVvZiBtYXggPT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgICAgZmxvYXRpbmcgPSBtYXg7XG4gICAgICAgICAgbm9NYXggPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAobm9NaW4gJiYgbm9NYXgpIHtcbiAgICAgICAgbWF4ID0gMTtcbiAgICAgIH1cbiAgICAgIG1pbiA9ICttaW4gfHwgMDtcbiAgICAgIGlmIChub01heCkge1xuICAgICAgICBtYXggPSBtaW47XG4gICAgICAgIG1pbiA9IDA7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBtYXggPSArbWF4IHx8IDA7XG4gICAgICB9XG4gICAgICBpZiAoZmxvYXRpbmcgfHwgbWluICUgMSB8fCBtYXggJSAxKSB7XG4gICAgICAgIHZhciByYW5kID0gbmF0aXZlUmFuZG9tKCk7XG4gICAgICAgIHJldHVybiBuYXRpdmVNaW4obWluICsgKHJhbmQgKiAobWF4IC0gbWluICsgcGFyc2VGbG9hdCgnMWUtJyArICgocmFuZCArJycpLmxlbmd0aCAtIDEpKSkpLCBtYXgpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGJhc2VSYW5kb20obWluLCBtYXgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlc29sdmVzIHRoZSB2YWx1ZSBvZiBwcm9wZXJ0eSBga2V5YCBvbiBgb2JqZWN0YC4gSWYgYGtleWAgaXMgYSBmdW5jdGlvblxuICAgICAqIGl0IHdpbGwgYmUgaW52b2tlZCB3aXRoIHRoZSBgdGhpc2AgYmluZGluZyBvZiBgb2JqZWN0YCBhbmQgaXRzIHJlc3VsdCByZXR1cm5lZCxcbiAgICAgKiBlbHNlIHRoZSBwcm9wZXJ0eSB2YWx1ZSBpcyByZXR1cm5lZC4gSWYgYG9iamVjdGAgaXMgZmFsc2V5IHRoZW4gYHVuZGVmaW5lZGBcbiAgICAgKiBpcyByZXR1cm5lZC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBVdGlsaXRpZXNcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gaW5zcGVjdC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5IFRoZSBuYW1lIG9mIHRoZSBwcm9wZXJ0eSB0byByZXNvbHZlLlxuICAgICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSByZXNvbHZlZCB2YWx1ZS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIG9iamVjdCA9IHtcbiAgICAgKiAgICdjaGVlc2UnOiAnY3J1bXBldHMnLFxuICAgICAqICAgJ3N0dWZmJzogZnVuY3Rpb24oKSB7XG4gICAgICogICAgIHJldHVybiAnbm9uc2Vuc2UnO1xuICAgICAqICAgfVxuICAgICAqIH07XG4gICAgICpcbiAgICAgKiBfLnJlc3VsdChvYmplY3QsICdjaGVlc2UnKTtcbiAgICAgKiAvLyA9PiAnY3J1bXBldHMnXG4gICAgICpcbiAgICAgKiBfLnJlc3VsdChvYmplY3QsICdzdHVmZicpO1xuICAgICAqIC8vID0+ICdub25zZW5zZSdcbiAgICAgKi9cbiAgICBmdW5jdGlvbiByZXN1bHQob2JqZWN0LCBrZXkpIHtcbiAgICAgIGlmIChvYmplY3QpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gb2JqZWN0W2tleV07XG4gICAgICAgIHJldHVybiBpc0Z1bmN0aW9uKHZhbHVlKSA/IG9iamVjdFtrZXldKCkgOiB2YWx1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBIG1pY3JvLXRlbXBsYXRpbmcgbWV0aG9kIHRoYXQgaGFuZGxlcyBhcmJpdHJhcnkgZGVsaW1pdGVycywgcHJlc2VydmVzXG4gICAgICogd2hpdGVzcGFjZSwgYW5kIGNvcnJlY3RseSBlc2NhcGVzIHF1b3RlcyB3aXRoaW4gaW50ZXJwb2xhdGVkIGNvZGUuXG4gICAgICpcbiAgICAgKiBOb3RlOiBJbiB0aGUgZGV2ZWxvcG1lbnQgYnVpbGQsIGBfLnRlbXBsYXRlYCB1dGlsaXplcyBzb3VyY2VVUkxzIGZvciBlYXNpZXJcbiAgICAgKiBkZWJ1Z2dpbmcuIFNlZSBodHRwOi8vd3d3Lmh0bWw1cm9ja3MuY29tL2VuL3R1dG9yaWFscy9kZXZlbG9wZXJ0b29scy9zb3VyY2VtYXBzLyN0b2Mtc291cmNldXJsXG4gICAgICpcbiAgICAgKiBGb3IgbW9yZSBpbmZvcm1hdGlvbiBvbiBwcmVjb21waWxpbmcgdGVtcGxhdGVzIHNlZTpcbiAgICAgKiBodHRwOi8vbG9kYXNoLmNvbS9jdXN0b20tYnVpbGRzXG4gICAgICpcbiAgICAgKiBGb3IgbW9yZSBpbmZvcm1hdGlvbiBvbiBDaHJvbWUgZXh0ZW5zaW9uIHNhbmRib3hlcyBzZWU6XG4gICAgICogaHR0cDovL2RldmVsb3Blci5jaHJvbWUuY29tL3N0YWJsZS9leHRlbnNpb25zL3NhbmRib3hpbmdFdmFsLmh0bWxcbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBVdGlsaXRpZXNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdGV4dCBUaGUgdGVtcGxhdGUgdGV4dC5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YSBUaGUgZGF0YSBvYmplY3QgdXNlZCB0byBwb3B1bGF0ZSB0aGUgdGV4dC5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdIFRoZSBvcHRpb25zIG9iamVjdC5cbiAgICAgKiBAcGFyYW0ge1JlZ0V4cH0gW29wdGlvbnMuZXNjYXBlXSBUaGUgXCJlc2NhcGVcIiBkZWxpbWl0ZXIuXG4gICAgICogQHBhcmFtIHtSZWdFeHB9IFtvcHRpb25zLmV2YWx1YXRlXSBUaGUgXCJldmFsdWF0ZVwiIGRlbGltaXRlci5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnMuaW1wb3J0c10gQW4gb2JqZWN0IHRvIGltcG9ydCBpbnRvIHRoZSB0ZW1wbGF0ZSBhcyBsb2NhbCB2YXJpYWJsZXMuXG4gICAgICogQHBhcmFtIHtSZWdFeHB9IFtvcHRpb25zLmludGVycG9sYXRlXSBUaGUgXCJpbnRlcnBvbGF0ZVwiIGRlbGltaXRlci5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW3NvdXJjZVVSTF0gVGhlIHNvdXJjZVVSTCBvZiB0aGUgdGVtcGxhdGUncyBjb21waWxlZCBzb3VyY2UuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFt2YXJpYWJsZV0gVGhlIGRhdGEgb2JqZWN0IHZhcmlhYmxlIG5hbWUuXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufHN0cmluZ30gUmV0dXJucyBhIGNvbXBpbGVkIGZ1bmN0aW9uIHdoZW4gbm8gYGRhdGFgIG9iamVjdFxuICAgICAqICBpcyBnaXZlbiwgZWxzZSBpdCByZXR1cm5zIHRoZSBpbnRlcnBvbGF0ZWQgdGV4dC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogLy8gdXNpbmcgdGhlIFwiaW50ZXJwb2xhdGVcIiBkZWxpbWl0ZXIgdG8gY3JlYXRlIGEgY29tcGlsZWQgdGVtcGxhdGVcbiAgICAgKiB2YXIgY29tcGlsZWQgPSBfLnRlbXBsYXRlKCdoZWxsbyA8JT0gbmFtZSAlPicpO1xuICAgICAqIGNvbXBpbGVkKHsgJ25hbWUnOiAnZnJlZCcgfSk7XG4gICAgICogLy8gPT4gJ2hlbGxvIGZyZWQnXG4gICAgICpcbiAgICAgKiAvLyB1c2luZyB0aGUgXCJlc2NhcGVcIiBkZWxpbWl0ZXIgdG8gZXNjYXBlIEhUTUwgaW4gZGF0YSBwcm9wZXJ0eSB2YWx1ZXNcbiAgICAgKiBfLnRlbXBsYXRlKCc8Yj48JS0gdmFsdWUgJT48L2I+JywgeyAndmFsdWUnOiAnPHNjcmlwdD4nIH0pO1xuICAgICAqIC8vID0+ICc8Yj4mbHQ7c2NyaXB0Jmd0OzwvYj4nXG4gICAgICpcbiAgICAgKiAvLyB1c2luZyB0aGUgXCJldmFsdWF0ZVwiIGRlbGltaXRlciB0byBnZW5lcmF0ZSBIVE1MXG4gICAgICogdmFyIGxpc3QgPSAnPCUgXy5mb3JFYWNoKHBlb3BsZSwgZnVuY3Rpb24obmFtZSkgeyAlPjxsaT48JS0gbmFtZSAlPjwvbGk+PCUgfSk7ICU+JztcbiAgICAgKiBfLnRlbXBsYXRlKGxpc3QsIHsgJ3Blb3BsZSc6IFsnZnJlZCcsICdiYXJuZXknXSB9KTtcbiAgICAgKiAvLyA9PiAnPGxpPmZyZWQ8L2xpPjxsaT5iYXJuZXk8L2xpPidcbiAgICAgKlxuICAgICAqIC8vIHVzaW5nIHRoZSBFUzYgZGVsaW1pdGVyIGFzIGFuIGFsdGVybmF0aXZlIHRvIHRoZSBkZWZhdWx0IFwiaW50ZXJwb2xhdGVcIiBkZWxpbWl0ZXJcbiAgICAgKiBfLnRlbXBsYXRlKCdoZWxsbyAkeyBuYW1lIH0nLCB7ICduYW1lJzogJ3BlYmJsZXMnIH0pO1xuICAgICAqIC8vID0+ICdoZWxsbyBwZWJibGVzJ1xuICAgICAqXG4gICAgICogLy8gdXNpbmcgdGhlIGludGVybmFsIGBwcmludGAgZnVuY3Rpb24gaW4gXCJldmFsdWF0ZVwiIGRlbGltaXRlcnNcbiAgICAgKiBfLnRlbXBsYXRlKCc8JSBwcmludChcImhlbGxvIFwiICsgbmFtZSk7ICU+IScsIHsgJ25hbWUnOiAnYmFybmV5JyB9KTtcbiAgICAgKiAvLyA9PiAnaGVsbG8gYmFybmV5ISdcbiAgICAgKlxuICAgICAqIC8vIHVzaW5nIGEgY3VzdG9tIHRlbXBsYXRlIGRlbGltaXRlcnNcbiAgICAgKiBfLnRlbXBsYXRlU2V0dGluZ3MgPSB7XG4gICAgICogICAnaW50ZXJwb2xhdGUnOiAve3soW1xcc1xcU10rPyl9fS9nXG4gICAgICogfTtcbiAgICAgKlxuICAgICAqIF8udGVtcGxhdGUoJ2hlbGxvIHt7IG5hbWUgfX0hJywgeyAnbmFtZSc6ICdtdXN0YWNoZScgfSk7XG4gICAgICogLy8gPT4gJ2hlbGxvIG11c3RhY2hlISdcbiAgICAgKlxuICAgICAqIC8vIHVzaW5nIHRoZSBgaW1wb3J0c2Agb3B0aW9uIHRvIGltcG9ydCBqUXVlcnlcbiAgICAgKiB2YXIgbGlzdCA9ICc8JSBqcS5lYWNoKHBlb3BsZSwgZnVuY3Rpb24obmFtZSkgeyAlPjxsaT48JS0gbmFtZSAlPjwvbGk+PCUgfSk7ICU+JztcbiAgICAgKiBfLnRlbXBsYXRlKGxpc3QsIHsgJ3Blb3BsZSc6IFsnZnJlZCcsICdiYXJuZXknXSB9LCB7ICdpbXBvcnRzJzogeyAnanEnOiBqUXVlcnkgfSB9KTtcbiAgICAgKiAvLyA9PiAnPGxpPmZyZWQ8L2xpPjxsaT5iYXJuZXk8L2xpPidcbiAgICAgKlxuICAgICAqIC8vIHVzaW5nIHRoZSBgc291cmNlVVJMYCBvcHRpb24gdG8gc3BlY2lmeSBhIGN1c3RvbSBzb3VyY2VVUkwgZm9yIHRoZSB0ZW1wbGF0ZVxuICAgICAqIHZhciBjb21waWxlZCA9IF8udGVtcGxhdGUoJ2hlbGxvIDwlPSBuYW1lICU+JywgbnVsbCwgeyAnc291cmNlVVJMJzogJy9iYXNpYy9ncmVldGluZy5qc3QnIH0pO1xuICAgICAqIGNvbXBpbGVkKGRhdGEpO1xuICAgICAqIC8vID0+IGZpbmQgdGhlIHNvdXJjZSBvZiBcImdyZWV0aW5nLmpzdFwiIHVuZGVyIHRoZSBTb3VyY2VzIHRhYiBvciBSZXNvdXJjZXMgcGFuZWwgb2YgdGhlIHdlYiBpbnNwZWN0b3JcbiAgICAgKlxuICAgICAqIC8vIHVzaW5nIHRoZSBgdmFyaWFibGVgIG9wdGlvbiB0byBlbnN1cmUgYSB3aXRoLXN0YXRlbWVudCBpc24ndCB1c2VkIGluIHRoZSBjb21waWxlZCB0ZW1wbGF0ZVxuICAgICAqIHZhciBjb21waWxlZCA9IF8udGVtcGxhdGUoJ2hpIDwlPSBkYXRhLm5hbWUgJT4hJywgbnVsbCwgeyAndmFyaWFibGUnOiAnZGF0YScgfSk7XG4gICAgICogY29tcGlsZWQuc291cmNlO1xuICAgICAqIC8vID0+IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgKiAgIHZhciBfX3QsIF9fcCA9ICcnLCBfX2UgPSBfLmVzY2FwZTtcbiAgICAgKiAgIF9fcCArPSAnaGkgJyArICgoX190ID0gKCBkYXRhLm5hbWUgKSkgPT0gbnVsbCA/ICcnIDogX190KSArICchJztcbiAgICAgKiAgIHJldHVybiBfX3A7XG4gICAgICogfVxuICAgICAqXG4gICAgICogLy8gdXNpbmcgdGhlIGBzb3VyY2VgIHByb3BlcnR5IHRvIGlubGluZSBjb21waWxlZCB0ZW1wbGF0ZXMgZm9yIG1lYW5pbmdmdWxcbiAgICAgKiAvLyBsaW5lIG51bWJlcnMgaW4gZXJyb3IgbWVzc2FnZXMgYW5kIGEgc3RhY2sgdHJhY2VcbiAgICAgKiBmcy53cml0ZUZpbGVTeW5jKHBhdGguam9pbihjd2QsICdqc3QuanMnKSwgJ1xcXG4gICAgICogICB2YXIgSlNUID0ge1xcXG4gICAgICogICAgIFwibWFpblwiOiAnICsgXy50ZW1wbGF0ZShtYWluVGV4dCkuc291cmNlICsgJ1xcXG4gICAgICogICB9O1xcXG4gICAgICogJyk7XG4gICAgICovXG4gICAgZnVuY3Rpb24gdGVtcGxhdGUodGV4dCwgZGF0YSwgb3B0aW9ucykge1xuICAgICAgLy8gYmFzZWQgb24gSm9obiBSZXNpZydzIGB0bXBsYCBpbXBsZW1lbnRhdGlvblxuICAgICAgLy8gaHR0cDovL2Vqb2huLm9yZy9ibG9nL2phdmFzY3JpcHQtbWljcm8tdGVtcGxhdGluZy9cbiAgICAgIC8vIGFuZCBMYXVyYSBEb2t0b3JvdmEncyBkb1QuanNcbiAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9vbGFkby9kb1RcbiAgICAgIHZhciBzZXR0aW5ncyA9IGxvZGFzaC50ZW1wbGF0ZVNldHRpbmdzO1xuICAgICAgdGV4dCA9IFN0cmluZyh0ZXh0IHx8ICcnKTtcblxuICAgICAgLy8gYXZvaWQgbWlzc2luZyBkZXBlbmRlbmNpZXMgd2hlbiBgaXRlcmF0b3JUZW1wbGF0ZWAgaXMgbm90IGRlZmluZWRcbiAgICAgIG9wdGlvbnMgPSBkZWZhdWx0cyh7fSwgb3B0aW9ucywgc2V0dGluZ3MpO1xuXG4gICAgICB2YXIgaW1wb3J0cyA9IGRlZmF1bHRzKHt9LCBvcHRpb25zLmltcG9ydHMsIHNldHRpbmdzLmltcG9ydHMpLFxuICAgICAgICAgIGltcG9ydHNLZXlzID0ga2V5cyhpbXBvcnRzKSxcbiAgICAgICAgICBpbXBvcnRzVmFsdWVzID0gdmFsdWVzKGltcG9ydHMpO1xuXG4gICAgICB2YXIgaXNFdmFsdWF0aW5nLFxuICAgICAgICAgIGluZGV4ID0gMCxcbiAgICAgICAgICBpbnRlcnBvbGF0ZSA9IG9wdGlvbnMuaW50ZXJwb2xhdGUgfHwgcmVOb01hdGNoLFxuICAgICAgICAgIHNvdXJjZSA9IFwiX19wICs9ICdcIjtcblxuICAgICAgLy8gY29tcGlsZSB0aGUgcmVnZXhwIHRvIG1hdGNoIGVhY2ggZGVsaW1pdGVyXG4gICAgICB2YXIgcmVEZWxpbWl0ZXJzID0gUmVnRXhwKFxuICAgICAgICAob3B0aW9ucy5lc2NhcGUgfHwgcmVOb01hdGNoKS5zb3VyY2UgKyAnfCcgK1xuICAgICAgICBpbnRlcnBvbGF0ZS5zb3VyY2UgKyAnfCcgK1xuICAgICAgICAoaW50ZXJwb2xhdGUgPT09IHJlSW50ZXJwb2xhdGUgPyByZUVzVGVtcGxhdGUgOiByZU5vTWF0Y2gpLnNvdXJjZSArICd8JyArXG4gICAgICAgIChvcHRpb25zLmV2YWx1YXRlIHx8IHJlTm9NYXRjaCkuc291cmNlICsgJ3wkJ1xuICAgICAgLCAnZycpO1xuXG4gICAgICB0ZXh0LnJlcGxhY2UocmVEZWxpbWl0ZXJzLCBmdW5jdGlvbihtYXRjaCwgZXNjYXBlVmFsdWUsIGludGVycG9sYXRlVmFsdWUsIGVzVGVtcGxhdGVWYWx1ZSwgZXZhbHVhdGVWYWx1ZSwgb2Zmc2V0KSB7XG4gICAgICAgIGludGVycG9sYXRlVmFsdWUgfHwgKGludGVycG9sYXRlVmFsdWUgPSBlc1RlbXBsYXRlVmFsdWUpO1xuXG4gICAgICAgIC8vIGVzY2FwZSBjaGFyYWN0ZXJzIHRoYXQgY2Fubm90IGJlIGluY2x1ZGVkIGluIHN0cmluZyBsaXRlcmFsc1xuICAgICAgICBzb3VyY2UgKz0gdGV4dC5zbGljZShpbmRleCwgb2Zmc2V0KS5yZXBsYWNlKHJlVW5lc2NhcGVkU3RyaW5nLCBlc2NhcGVTdHJpbmdDaGFyKTtcblxuICAgICAgICAvLyByZXBsYWNlIGRlbGltaXRlcnMgd2l0aCBzbmlwcGV0c1xuICAgICAgICBpZiAoZXNjYXBlVmFsdWUpIHtcbiAgICAgICAgICBzb3VyY2UgKz0gXCInICtcXG5fX2UoXCIgKyBlc2NhcGVWYWx1ZSArIFwiKSArXFxuJ1wiO1xuICAgICAgICB9XG4gICAgICAgIGlmIChldmFsdWF0ZVZhbHVlKSB7XG4gICAgICAgICAgaXNFdmFsdWF0aW5nID0gdHJ1ZTtcbiAgICAgICAgICBzb3VyY2UgKz0gXCInO1xcblwiICsgZXZhbHVhdGVWYWx1ZSArIFwiO1xcbl9fcCArPSAnXCI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGludGVycG9sYXRlVmFsdWUpIHtcbiAgICAgICAgICBzb3VyY2UgKz0gXCInICtcXG4oKF9fdCA9IChcIiArIGludGVycG9sYXRlVmFsdWUgKyBcIikpID09IG51bGwgPyAnJyA6IF9fdCkgK1xcbidcIjtcbiAgICAgICAgfVxuICAgICAgICBpbmRleCA9IG9mZnNldCArIG1hdGNoLmxlbmd0aDtcblxuICAgICAgICAvLyB0aGUgSlMgZW5naW5lIGVtYmVkZGVkIGluIEFkb2JlIHByb2R1Y3RzIHJlcXVpcmVzIHJldHVybmluZyB0aGUgYG1hdGNoYFxuICAgICAgICAvLyBzdHJpbmcgaW4gb3JkZXIgdG8gcHJvZHVjZSB0aGUgY29ycmVjdCBgb2Zmc2V0YCB2YWx1ZVxuICAgICAgICByZXR1cm4gbWF0Y2g7XG4gICAgICB9KTtcblxuICAgICAgc291cmNlICs9IFwiJztcXG5cIjtcblxuICAgICAgLy8gaWYgYHZhcmlhYmxlYCBpcyBub3Qgc3BlY2lmaWVkLCB3cmFwIGEgd2l0aC1zdGF0ZW1lbnQgYXJvdW5kIHRoZSBnZW5lcmF0ZWRcbiAgICAgIC8vIGNvZGUgdG8gYWRkIHRoZSBkYXRhIG9iamVjdCB0byB0aGUgdG9wIG9mIHRoZSBzY29wZSBjaGFpblxuICAgICAgdmFyIHZhcmlhYmxlID0gb3B0aW9ucy52YXJpYWJsZSxcbiAgICAgICAgICBoYXNWYXJpYWJsZSA9IHZhcmlhYmxlO1xuXG4gICAgICBpZiAoIWhhc1ZhcmlhYmxlKSB7XG4gICAgICAgIHZhcmlhYmxlID0gJ29iaic7XG4gICAgICAgIHNvdXJjZSA9ICd3aXRoICgnICsgdmFyaWFibGUgKyAnKSB7XFxuJyArIHNvdXJjZSArICdcXG59XFxuJztcbiAgICAgIH1cbiAgICAgIC8vIGNsZWFudXAgY29kZSBieSBzdHJpcHBpbmcgZW1wdHkgc3RyaW5nc1xuICAgICAgc291cmNlID0gKGlzRXZhbHVhdGluZyA/IHNvdXJjZS5yZXBsYWNlKHJlRW1wdHlTdHJpbmdMZWFkaW5nLCAnJykgOiBzb3VyY2UpXG4gICAgICAgIC5yZXBsYWNlKHJlRW1wdHlTdHJpbmdNaWRkbGUsICckMScpXG4gICAgICAgIC5yZXBsYWNlKHJlRW1wdHlTdHJpbmdUcmFpbGluZywgJyQxOycpO1xuXG4gICAgICAvLyBmcmFtZSBjb2RlIGFzIHRoZSBmdW5jdGlvbiBib2R5XG4gICAgICBzb3VyY2UgPSAnZnVuY3Rpb24oJyArIHZhcmlhYmxlICsgJykge1xcbicgK1xuICAgICAgICAoaGFzVmFyaWFibGUgPyAnJyA6IHZhcmlhYmxlICsgJyB8fCAoJyArIHZhcmlhYmxlICsgJyA9IHt9KTtcXG4nKSArXG4gICAgICAgIFwidmFyIF9fdCwgX19wID0gJycsIF9fZSA9IF8uZXNjYXBlXCIgK1xuICAgICAgICAoaXNFdmFsdWF0aW5nXG4gICAgICAgICAgPyAnLCBfX2ogPSBBcnJheS5wcm90b3R5cGUuam9pbjtcXG4nICtcbiAgICAgICAgICAgIFwiZnVuY3Rpb24gcHJpbnQoKSB7IF9fcCArPSBfX2ouY2FsbChhcmd1bWVudHMsICcnKSB9XFxuXCJcbiAgICAgICAgICA6ICc7XFxuJ1xuICAgICAgICApICtcbiAgICAgICAgc291cmNlICtcbiAgICAgICAgJ3JldHVybiBfX3BcXG59JztcblxuICAgICAgLy8gVXNlIGEgc291cmNlVVJMIGZvciBlYXNpZXIgZGVidWdnaW5nLlxuICAgICAgLy8gaHR0cDovL3d3dy5odG1sNXJvY2tzLmNvbS9lbi90dXRvcmlhbHMvZGV2ZWxvcGVydG9vbHMvc291cmNlbWFwcy8jdG9jLXNvdXJjZXVybFxuICAgICAgdmFyIHNvdXJjZVVSTCA9ICdcXG4vKlxcbi8vIyBzb3VyY2VVUkw9JyArIChvcHRpb25zLnNvdXJjZVVSTCB8fCAnL2xvZGFzaC90ZW1wbGF0ZS9zb3VyY2VbJyArICh0ZW1wbGF0ZUNvdW50ZXIrKykgKyAnXScpICsgJ1xcbiovJztcblxuICAgICAgdHJ5IHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IEZ1bmN0aW9uKGltcG9ydHNLZXlzLCAncmV0dXJuICcgKyBzb3VyY2UgKyBzb3VyY2VVUkwpLmFwcGx5KHVuZGVmaW5lZCwgaW1wb3J0c1ZhbHVlcyk7XG4gICAgICB9IGNhdGNoKGUpIHtcbiAgICAgICAgZS5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICAgIHRocm93IGU7XG4gICAgICB9XG4gICAgICBpZiAoZGF0YSkge1xuICAgICAgICByZXR1cm4gcmVzdWx0KGRhdGEpO1xuICAgICAgfVxuICAgICAgLy8gcHJvdmlkZSB0aGUgY29tcGlsZWQgZnVuY3Rpb24ncyBzb3VyY2UgYnkgaXRzIGB0b1N0cmluZ2AgbWV0aG9kLCBpblxuICAgICAgLy8gc3VwcG9ydGVkIGVudmlyb25tZW50cywgb3IgdGhlIGBzb3VyY2VgIHByb3BlcnR5IGFzIGEgY29udmVuaWVuY2UgZm9yXG4gICAgICAvLyBpbmxpbmluZyBjb21waWxlZCB0ZW1wbGF0ZXMgZHVyaW5nIHRoZSBidWlsZCBwcm9jZXNzXG4gICAgICByZXN1bHQuc291cmNlID0gc291cmNlO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlcyB0aGUgY2FsbGJhY2sgYG5gIHRpbWVzLCByZXR1cm5pbmcgYW4gYXJyYXkgb2YgdGhlIHJlc3VsdHNcbiAgICAgKiBvZiBlYWNoIGNhbGxiYWNrIGV4ZWN1dGlvbi4gVGhlIGNhbGxiYWNrIGlzIGJvdW5kIHRvIGB0aGlzQXJnYCBhbmQgaW52b2tlZFxuICAgICAqIHdpdGggb25lIGFyZ3VtZW50OyAoaW5kZXgpLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IFV0aWxpdGllc1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBuIFRoZSBudW1iZXIgb2YgdGltZXMgdG8gZXhlY3V0ZSB0aGUgY2FsbGJhY2suXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgVGhlIGZ1bmN0aW9uIGNhbGxlZCBwZXIgaXRlcmF0aW9uLlxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgY2FsbGJhY2tgLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyBhbiBhcnJheSBvZiB0aGUgcmVzdWx0cyBvZiBlYWNoIGBjYWxsYmFja2AgZXhlY3V0aW9uLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgZGljZVJvbGxzID0gXy50aW1lcygzLCBfLnBhcnRpYWwoXy5yYW5kb20sIDEsIDYpKTtcbiAgICAgKiAvLyA9PiBbMywgNiwgNF1cbiAgICAgKlxuICAgICAqIF8udGltZXMoMywgZnVuY3Rpb24obikgeyBtYWdlLmNhc3RTcGVsbChuKTsgfSk7XG4gICAgICogLy8gPT4gY2FsbHMgYG1hZ2UuY2FzdFNwZWxsKG4pYCB0aHJlZSB0aW1lcywgcGFzc2luZyBgbmAgb2YgYDBgLCBgMWAsIGFuZCBgMmAgcmVzcGVjdGl2ZWx5XG4gICAgICpcbiAgICAgKiBfLnRpbWVzKDMsIGZ1bmN0aW9uKG4pIHsgdGhpcy5jYXN0KG4pOyB9LCBtYWdlKTtcbiAgICAgKiAvLyA9PiBhbHNvIGNhbGxzIGBtYWdlLmNhc3RTcGVsbChuKWAgdGhyZWUgdGltZXNcbiAgICAgKi9cbiAgICBmdW5jdGlvbiB0aW1lcyhuLCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgbiA9IChuID0gK24pID4gLTEgPyBuIDogMDtcbiAgICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICAgIHJlc3VsdCA9IEFycmF5KG4pO1xuXG4gICAgICBjYWxsYmFjayA9IGJhc2VDcmVhdGVDYWxsYmFjayhjYWxsYmFjaywgdGhpc0FyZywgMSk7XG4gICAgICB3aGlsZSAoKytpbmRleCA8IG4pIHtcbiAgICAgICAgcmVzdWx0W2luZGV4XSA9IGNhbGxiYWNrKGluZGV4KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGludmVyc2Ugb2YgYF8uZXNjYXBlYCB0aGlzIG1ldGhvZCBjb252ZXJ0cyB0aGUgSFRNTCBlbnRpdGllc1xuICAgICAqIGAmYW1wO2AsIGAmbHQ7YCwgYCZndDtgLCBgJnF1b3Q7YCwgYW5kIGAmIzM5O2AgaW4gYHN0cmluZ2AgdG8gdGhlaXJcbiAgICAgKiBjb3JyZXNwb25kaW5nIGNoYXJhY3RlcnMuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgVXRpbGl0aWVzXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHN0cmluZyBUaGUgc3RyaW5nIHRvIHVuZXNjYXBlLlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IFJldHVybnMgdGhlIHVuZXNjYXBlZCBzdHJpbmcuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8udW5lc2NhcGUoJ0ZyZWQsIEJhcm5leSAmYW1wOyBQZWJibGVzJyk7XG4gICAgICogLy8gPT4gJ0ZyZWQsIEJhcm5leSAmIFBlYmJsZXMnXG4gICAgICovXG4gICAgZnVuY3Rpb24gdW5lc2NhcGUoc3RyaW5nKSB7XG4gICAgICByZXR1cm4gc3RyaW5nID09IG51bGwgPyAnJyA6IFN0cmluZyhzdHJpbmcpLnJlcGxhY2UocmVFc2NhcGVkSHRtbCwgdW5lc2NhcGVIdG1sQ2hhcik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2VuZXJhdGVzIGEgdW5pcXVlIElELiBJZiBgcHJlZml4YCBpcyBwcm92aWRlZCB0aGUgSUQgd2lsbCBiZSBhcHBlbmRlZCB0byBpdC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBVdGlsaXRpZXNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW3ByZWZpeF0gVGhlIHZhbHVlIHRvIHByZWZpeCB0aGUgSUQgd2l0aC5cbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBSZXR1cm5zIHRoZSB1bmlxdWUgSUQuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8udW5pcXVlSWQoJ2NvbnRhY3RfJyk7XG4gICAgICogLy8gPT4gJ2NvbnRhY3RfMTA0J1xuICAgICAqXG4gICAgICogXy51bmlxdWVJZCgpO1xuICAgICAqIC8vID0+ICcxMDUnXG4gICAgICovXG4gICAgZnVuY3Rpb24gdW5pcXVlSWQocHJlZml4KSB7XG4gICAgICB2YXIgaWQgPSArK2lkQ291bnRlcjtcbiAgICAgIHJldHVybiBTdHJpbmcocHJlZml4ID09IG51bGwgPyAnJyA6IHByZWZpeCkgKyBpZDtcbiAgICB9XG5cbiAgICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBgbG9kYXNoYCBvYmplY3QgdGhhdCB3cmFwcyB0aGUgZ2l2ZW4gdmFsdWUgd2l0aCBleHBsaWNpdFxuICAgICAqIG1ldGhvZCBjaGFpbmluZyBlbmFibGVkLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IENoYWluaW5nXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gd3JhcC5cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSB3cmFwcGVyIG9iamVjdC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIGNoYXJhY3RlcnMgPSBbXG4gICAgICogICB7ICduYW1lJzogJ2Jhcm5leScsICAnYWdlJzogMzYgfSxcbiAgICAgKiAgIHsgJ25hbWUnOiAnZnJlZCcsICAgICdhZ2UnOiA0MCB9LFxuICAgICAqICAgeyAnbmFtZSc6ICdwZWJibGVzJywgJ2FnZSc6IDEgfVxuICAgICAqIF07XG4gICAgICpcbiAgICAgKiB2YXIgeW91bmdlc3QgPSBfLmNoYWluKGNoYXJhY3RlcnMpXG4gICAgICogICAgIC5zb3J0QnkoJ2FnZScpXG4gICAgICogICAgIC5tYXAoZnVuY3Rpb24oY2hyKSB7IHJldHVybiBjaHIubmFtZSArICcgaXMgJyArIGNoci5hZ2U7IH0pXG4gICAgICogICAgIC5maXJzdCgpXG4gICAgICogICAgIC52YWx1ZSgpO1xuICAgICAqIC8vID0+ICdwZWJibGVzIGlzIDEnXG4gICAgICovXG4gICAgZnVuY3Rpb24gY2hhaW4odmFsdWUpIHtcbiAgICAgIHZhbHVlID0gbmV3IGxvZGFzaFdyYXBwZXIodmFsdWUpO1xuICAgICAgdmFsdWUuX19jaGFpbl9fID0gdHJ1ZTtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbnZva2VzIGBpbnRlcmNlcHRvcmAgd2l0aCB0aGUgYHZhbHVlYCBhcyB0aGUgZmlyc3QgYXJndW1lbnQgYW5kIHRoZW5cbiAgICAgKiByZXR1cm5zIGB2YWx1ZWAuIFRoZSBwdXJwb3NlIG9mIHRoaXMgbWV0aG9kIGlzIHRvIFwidGFwIGludG9cIiBhIG1ldGhvZFxuICAgICAqIGNoYWluIGluIG9yZGVyIHRvIHBlcmZvcm0gb3BlcmF0aW9ucyBvbiBpbnRlcm1lZGlhdGUgcmVzdWx0cyB3aXRoaW5cbiAgICAgKiB0aGUgY2hhaW4uXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgQ2hhaW5pbmdcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBwcm92aWRlIHRvIGBpbnRlcmNlcHRvcmAuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gaW50ZXJjZXB0b3IgVGhlIGZ1bmN0aW9uIHRvIGludm9rZS5cbiAgICAgKiBAcmV0dXJucyB7Kn0gUmV0dXJucyBgdmFsdWVgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfKFsxLCAyLCAzLCA0XSlcbiAgICAgKiAgLnRhcChmdW5jdGlvbihhcnJheSkgeyBhcnJheS5wb3AoKTsgfSlcbiAgICAgKiAgLnJldmVyc2UoKVxuICAgICAqICAudmFsdWUoKTtcbiAgICAgKiAvLyA9PiBbMywgMiwgMV1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB0YXAodmFsdWUsIGludGVyY2VwdG9yKSB7XG4gICAgICBpbnRlcmNlcHRvcih2YWx1ZSk7XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRW5hYmxlcyBleHBsaWNpdCBtZXRob2QgY2hhaW5pbmcgb24gdGhlIHdyYXBwZXIgb2JqZWN0LlxuICAgICAqXG4gICAgICogQG5hbWUgY2hhaW5cbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBDaGFpbmluZ1xuICAgICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSB3cmFwcGVyIG9iamVjdC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIGNoYXJhY3RlcnMgPSBbXG4gICAgICogICB7ICduYW1lJzogJ2Jhcm5leScsICdhZ2UnOiAzNiB9LFxuICAgICAqICAgeyAnbmFtZSc6ICdmcmVkJywgICAnYWdlJzogNDAgfVxuICAgICAqIF07XG4gICAgICpcbiAgICAgKiAvLyB3aXRob3V0IGV4cGxpY2l0IGNoYWluaW5nXG4gICAgICogXyhjaGFyYWN0ZXJzKS5maXJzdCgpO1xuICAgICAqIC8vID0+IHsgJ25hbWUnOiAnYmFybmV5JywgJ2FnZSc6IDM2IH1cbiAgICAgKlxuICAgICAqIC8vIHdpdGggZXhwbGljaXQgY2hhaW5pbmdcbiAgICAgKiBfKGNoYXJhY3RlcnMpLmNoYWluKClcbiAgICAgKiAgIC5maXJzdCgpXG4gICAgICogICAucGljaygnYWdlJylcbiAgICAgKiAgIC52YWx1ZSgpO1xuICAgICAqIC8vID0+IHsgJ2FnZSc6IDM2IH1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB3cmFwcGVyQ2hhaW4oKSB7XG4gICAgICB0aGlzLl9fY2hhaW5fXyA9IHRydWU7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcm9kdWNlcyB0aGUgYHRvU3RyaW5nYCByZXN1bHQgb2YgdGhlIHdyYXBwZWQgdmFsdWUuXG4gICAgICpcbiAgICAgKiBAbmFtZSB0b1N0cmluZ1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IENoYWluaW5nXG4gICAgICogQHJldHVybnMge3N0cmluZ30gUmV0dXJucyB0aGUgc3RyaW5nIHJlc3VsdC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXyhbMSwgMiwgM10pLnRvU3RyaW5nKCk7XG4gICAgICogLy8gPT4gJzEsMiwzJ1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIHdyYXBwZXJUb1N0cmluZygpIHtcbiAgICAgIHJldHVybiBTdHJpbmcodGhpcy5fX3dyYXBwZWRfXyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXh0cmFjdHMgdGhlIHdyYXBwZWQgdmFsdWUuXG4gICAgICpcbiAgICAgKiBAbmFtZSB2YWx1ZU9mXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAYWxpYXMgdmFsdWVcbiAgICAgKiBAY2F0ZWdvcnkgQ2hhaW5pbmdcbiAgICAgKiBAcmV0dXJucyB7Kn0gUmV0dXJucyB0aGUgd3JhcHBlZCB2YWx1ZS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXyhbMSwgMiwgM10pLnZhbHVlT2YoKTtcbiAgICAgKiAvLyA9PiBbMSwgMiwgM11cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB3cmFwcGVyVmFsdWVPZigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9fd3JhcHBlZF9fO1xuICAgIH1cblxuICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gICAgLy8gYWRkIGZ1bmN0aW9ucyB0aGF0IHJldHVybiB3cmFwcGVkIHZhbHVlcyB3aGVuIGNoYWluaW5nXG4gICAgbG9kYXNoLmFmdGVyID0gYWZ0ZXI7XG4gICAgbG9kYXNoLmFzc2lnbiA9IGFzc2lnbjtcbiAgICBsb2Rhc2guYXQgPSBhdDtcbiAgICBsb2Rhc2guYmluZCA9IGJpbmQ7XG4gICAgbG9kYXNoLmJpbmRBbGwgPSBiaW5kQWxsO1xuICAgIGxvZGFzaC5iaW5kS2V5ID0gYmluZEtleTtcbiAgICBsb2Rhc2guY2hhaW4gPSBjaGFpbjtcbiAgICBsb2Rhc2guY29tcGFjdCA9IGNvbXBhY3Q7XG4gICAgbG9kYXNoLmNvbXBvc2UgPSBjb21wb3NlO1xuICAgIGxvZGFzaC5jb25zdGFudCA9IGNvbnN0YW50O1xuICAgIGxvZGFzaC5jb3VudEJ5ID0gY291bnRCeTtcbiAgICBsb2Rhc2guY3JlYXRlID0gY3JlYXRlO1xuICAgIGxvZGFzaC5jcmVhdGVDYWxsYmFjayA9IGNyZWF0ZUNhbGxiYWNrO1xuICAgIGxvZGFzaC5jdXJyeSA9IGN1cnJ5O1xuICAgIGxvZGFzaC5kZWJvdW5jZSA9IGRlYm91bmNlO1xuICAgIGxvZGFzaC5kZWZhdWx0cyA9IGRlZmF1bHRzO1xuICAgIGxvZGFzaC5kZWZlciA9IGRlZmVyO1xuICAgIGxvZGFzaC5kZWxheSA9IGRlbGF5O1xuICAgIGxvZGFzaC5kaWZmZXJlbmNlID0gZGlmZmVyZW5jZTtcbiAgICBsb2Rhc2guZmlsdGVyID0gZmlsdGVyO1xuICAgIGxvZGFzaC5mbGF0dGVuID0gZmxhdHRlbjtcbiAgICBsb2Rhc2guZm9yRWFjaCA9IGZvckVhY2g7XG4gICAgbG9kYXNoLmZvckVhY2hSaWdodCA9IGZvckVhY2hSaWdodDtcbiAgICBsb2Rhc2guZm9ySW4gPSBmb3JJbjtcbiAgICBsb2Rhc2guZm9ySW5SaWdodCA9IGZvckluUmlnaHQ7XG4gICAgbG9kYXNoLmZvck93biA9IGZvck93bjtcbiAgICBsb2Rhc2guZm9yT3duUmlnaHQgPSBmb3JPd25SaWdodDtcbiAgICBsb2Rhc2guZnVuY3Rpb25zID0gZnVuY3Rpb25zO1xuICAgIGxvZGFzaC5ncm91cEJ5ID0gZ3JvdXBCeTtcbiAgICBsb2Rhc2guaW5kZXhCeSA9IGluZGV4Qnk7XG4gICAgbG9kYXNoLmluaXRpYWwgPSBpbml0aWFsO1xuICAgIGxvZGFzaC5pbnRlcnNlY3Rpb24gPSBpbnRlcnNlY3Rpb247XG4gICAgbG9kYXNoLmludmVydCA9IGludmVydDtcbiAgICBsb2Rhc2guaW52b2tlID0gaW52b2tlO1xuICAgIGxvZGFzaC5rZXlzID0ga2V5cztcbiAgICBsb2Rhc2gubWFwID0gbWFwO1xuICAgIGxvZGFzaC5tYXBWYWx1ZXMgPSBtYXBWYWx1ZXM7XG4gICAgbG9kYXNoLm1heCA9IG1heDtcbiAgICBsb2Rhc2gubWVtb2l6ZSA9IG1lbW9pemU7XG4gICAgbG9kYXNoLm1lcmdlID0gbWVyZ2U7XG4gICAgbG9kYXNoLm1pbiA9IG1pbjtcbiAgICBsb2Rhc2gub21pdCA9IG9taXQ7XG4gICAgbG9kYXNoLm9uY2UgPSBvbmNlO1xuICAgIGxvZGFzaC5wYWlycyA9IHBhaXJzO1xuICAgIGxvZGFzaC5wYXJ0aWFsID0gcGFydGlhbDtcbiAgICBsb2Rhc2gucGFydGlhbFJpZ2h0ID0gcGFydGlhbFJpZ2h0O1xuICAgIGxvZGFzaC5waWNrID0gcGljaztcbiAgICBsb2Rhc2gucGx1Y2sgPSBwbHVjaztcbiAgICBsb2Rhc2gucHJvcGVydHkgPSBwcm9wZXJ0eTtcbiAgICBsb2Rhc2gucHVsbCA9IHB1bGw7XG4gICAgbG9kYXNoLnJhbmdlID0gcmFuZ2U7XG4gICAgbG9kYXNoLnJlamVjdCA9IHJlamVjdDtcbiAgICBsb2Rhc2gucmVtb3ZlID0gcmVtb3ZlO1xuICAgIGxvZGFzaC5yZXN0ID0gcmVzdDtcbiAgICBsb2Rhc2guc2h1ZmZsZSA9IHNodWZmbGU7XG4gICAgbG9kYXNoLnNvcnRCeSA9IHNvcnRCeTtcbiAgICBsb2Rhc2gudGFwID0gdGFwO1xuICAgIGxvZGFzaC50aHJvdHRsZSA9IHRocm90dGxlO1xuICAgIGxvZGFzaC50aW1lcyA9IHRpbWVzO1xuICAgIGxvZGFzaC50b0FycmF5ID0gdG9BcnJheTtcbiAgICBsb2Rhc2gudHJhbnNmb3JtID0gdHJhbnNmb3JtO1xuICAgIGxvZGFzaC51bmlvbiA9IHVuaW9uO1xuICAgIGxvZGFzaC51bmlxID0gdW5pcTtcbiAgICBsb2Rhc2gudmFsdWVzID0gdmFsdWVzO1xuICAgIGxvZGFzaC53aGVyZSA9IHdoZXJlO1xuICAgIGxvZGFzaC53aXRob3V0ID0gd2l0aG91dDtcbiAgICBsb2Rhc2gud3JhcCA9IHdyYXA7XG4gICAgbG9kYXNoLnhvciA9IHhvcjtcbiAgICBsb2Rhc2guemlwID0gemlwO1xuICAgIGxvZGFzaC56aXBPYmplY3QgPSB6aXBPYmplY3Q7XG5cbiAgICAvLyBhZGQgYWxpYXNlc1xuICAgIGxvZGFzaC5jb2xsZWN0ID0gbWFwO1xuICAgIGxvZGFzaC5kcm9wID0gcmVzdDtcbiAgICBsb2Rhc2guZWFjaCA9IGZvckVhY2g7XG4gICAgbG9kYXNoLmVhY2hSaWdodCA9IGZvckVhY2hSaWdodDtcbiAgICBsb2Rhc2guZXh0ZW5kID0gYXNzaWduO1xuICAgIGxvZGFzaC5tZXRob2RzID0gZnVuY3Rpb25zO1xuICAgIGxvZGFzaC5vYmplY3QgPSB6aXBPYmplY3Q7XG4gICAgbG9kYXNoLnNlbGVjdCA9IGZpbHRlcjtcbiAgICBsb2Rhc2gudGFpbCA9IHJlc3Q7XG4gICAgbG9kYXNoLnVuaXF1ZSA9IHVuaXE7XG4gICAgbG9kYXNoLnVuemlwID0gemlwO1xuXG4gICAgLy8gYWRkIGZ1bmN0aW9ucyB0byBgbG9kYXNoLnByb3RvdHlwZWBcbiAgICBtaXhpbihsb2Rhc2gpO1xuXG4gICAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbiAgICAvLyBhZGQgZnVuY3Rpb25zIHRoYXQgcmV0dXJuIHVud3JhcHBlZCB2YWx1ZXMgd2hlbiBjaGFpbmluZ1xuICAgIGxvZGFzaC5jbG9uZSA9IGNsb25lO1xuICAgIGxvZGFzaC5jbG9uZURlZXAgPSBjbG9uZURlZXA7XG4gICAgbG9kYXNoLmNvbnRhaW5zID0gY29udGFpbnM7XG4gICAgbG9kYXNoLmVzY2FwZSA9IGVzY2FwZTtcbiAgICBsb2Rhc2guZXZlcnkgPSBldmVyeTtcbiAgICBsb2Rhc2guZmluZCA9IGZpbmQ7XG4gICAgbG9kYXNoLmZpbmRJbmRleCA9IGZpbmRJbmRleDtcbiAgICBsb2Rhc2guZmluZEtleSA9IGZpbmRLZXk7XG4gICAgbG9kYXNoLmZpbmRMYXN0ID0gZmluZExhc3Q7XG4gICAgbG9kYXNoLmZpbmRMYXN0SW5kZXggPSBmaW5kTGFzdEluZGV4O1xuICAgIGxvZGFzaC5maW5kTGFzdEtleSA9IGZpbmRMYXN0S2V5O1xuICAgIGxvZGFzaC5oYXMgPSBoYXM7XG4gICAgbG9kYXNoLmlkZW50aXR5ID0gaWRlbnRpdHk7XG4gICAgbG9kYXNoLmluZGV4T2YgPSBpbmRleE9mO1xuICAgIGxvZGFzaC5pc0FyZ3VtZW50cyA9IGlzQXJndW1lbnRzO1xuICAgIGxvZGFzaC5pc0FycmF5ID0gaXNBcnJheTtcbiAgICBsb2Rhc2guaXNCb29sZWFuID0gaXNCb29sZWFuO1xuICAgIGxvZGFzaC5pc0RhdGUgPSBpc0RhdGU7XG4gICAgbG9kYXNoLmlzRWxlbWVudCA9IGlzRWxlbWVudDtcbiAgICBsb2Rhc2guaXNFbXB0eSA9IGlzRW1wdHk7XG4gICAgbG9kYXNoLmlzRXF1YWwgPSBpc0VxdWFsO1xuICAgIGxvZGFzaC5pc0Zpbml0ZSA9IGlzRmluaXRlO1xuICAgIGxvZGFzaC5pc0Z1bmN0aW9uID0gaXNGdW5jdGlvbjtcbiAgICBsb2Rhc2guaXNOYU4gPSBpc05hTjtcbiAgICBsb2Rhc2guaXNOdWxsID0gaXNOdWxsO1xuICAgIGxvZGFzaC5pc051bWJlciA9IGlzTnVtYmVyO1xuICAgIGxvZGFzaC5pc09iamVjdCA9IGlzT2JqZWN0O1xuICAgIGxvZGFzaC5pc1BsYWluT2JqZWN0ID0gaXNQbGFpbk9iamVjdDtcbiAgICBsb2Rhc2guaXNSZWdFeHAgPSBpc1JlZ0V4cDtcbiAgICBsb2Rhc2guaXNTdHJpbmcgPSBpc1N0cmluZztcbiAgICBsb2Rhc2guaXNVbmRlZmluZWQgPSBpc1VuZGVmaW5lZDtcbiAgICBsb2Rhc2gubGFzdEluZGV4T2YgPSBsYXN0SW5kZXhPZjtcbiAgICBsb2Rhc2gubWl4aW4gPSBtaXhpbjtcbiAgICBsb2Rhc2gubm9Db25mbGljdCA9IG5vQ29uZmxpY3Q7XG4gICAgbG9kYXNoLm5vb3AgPSBub29wO1xuICAgIGxvZGFzaC5ub3cgPSBub3c7XG4gICAgbG9kYXNoLnBhcnNlSW50ID0gcGFyc2VJbnQ7XG4gICAgbG9kYXNoLnJhbmRvbSA9IHJhbmRvbTtcbiAgICBsb2Rhc2gucmVkdWNlID0gcmVkdWNlO1xuICAgIGxvZGFzaC5yZWR1Y2VSaWdodCA9IHJlZHVjZVJpZ2h0O1xuICAgIGxvZGFzaC5yZXN1bHQgPSByZXN1bHQ7XG4gICAgbG9kYXNoLnJ1bkluQ29udGV4dCA9IHJ1bkluQ29udGV4dDtcbiAgICBsb2Rhc2guc2l6ZSA9IHNpemU7XG4gICAgbG9kYXNoLnNvbWUgPSBzb21lO1xuICAgIGxvZGFzaC5zb3J0ZWRJbmRleCA9IHNvcnRlZEluZGV4O1xuICAgIGxvZGFzaC50ZW1wbGF0ZSA9IHRlbXBsYXRlO1xuICAgIGxvZGFzaC51bmVzY2FwZSA9IHVuZXNjYXBlO1xuICAgIGxvZGFzaC51bmlxdWVJZCA9IHVuaXF1ZUlkO1xuXG4gICAgLy8gYWRkIGFsaWFzZXNcbiAgICBsb2Rhc2guYWxsID0gZXZlcnk7XG4gICAgbG9kYXNoLmFueSA9IHNvbWU7XG4gICAgbG9kYXNoLmRldGVjdCA9IGZpbmQ7XG4gICAgbG9kYXNoLmZpbmRXaGVyZSA9IGZpbmQ7XG4gICAgbG9kYXNoLmZvbGRsID0gcmVkdWNlO1xuICAgIGxvZGFzaC5mb2xkciA9IHJlZHVjZVJpZ2h0O1xuICAgIGxvZGFzaC5pbmNsdWRlID0gY29udGFpbnM7XG4gICAgbG9kYXNoLmluamVjdCA9IHJlZHVjZTtcblxuICAgIG1peGluKGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHNvdXJjZSA9IHt9XG4gICAgICBmb3JPd24obG9kYXNoLCBmdW5jdGlvbihmdW5jLCBtZXRob2ROYW1lKSB7XG4gICAgICAgIGlmICghbG9kYXNoLnByb3RvdHlwZVttZXRob2ROYW1lXSkge1xuICAgICAgICAgIHNvdXJjZVttZXRob2ROYW1lXSA9IGZ1bmM7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHNvdXJjZTtcbiAgICB9KCksIGZhbHNlKTtcblxuICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gICAgLy8gYWRkIGZ1bmN0aW9ucyBjYXBhYmxlIG9mIHJldHVybmluZyB3cmFwcGVkIGFuZCB1bndyYXBwZWQgdmFsdWVzIHdoZW4gY2hhaW5pbmdcbiAgICBsb2Rhc2guZmlyc3QgPSBmaXJzdDtcbiAgICBsb2Rhc2gubGFzdCA9IGxhc3Q7XG4gICAgbG9kYXNoLnNhbXBsZSA9IHNhbXBsZTtcblxuICAgIC8vIGFkZCBhbGlhc2VzXG4gICAgbG9kYXNoLnRha2UgPSBmaXJzdDtcbiAgICBsb2Rhc2guaGVhZCA9IGZpcnN0O1xuXG4gICAgZm9yT3duKGxvZGFzaCwgZnVuY3Rpb24oZnVuYywgbWV0aG9kTmFtZSkge1xuICAgICAgdmFyIGNhbGxiYWNrYWJsZSA9IG1ldGhvZE5hbWUgIT09ICdzYW1wbGUnO1xuICAgICAgaWYgKCFsb2Rhc2gucHJvdG90eXBlW21ldGhvZE5hbWVdKSB7XG4gICAgICAgIGxvZGFzaC5wcm90b3R5cGVbbWV0aG9kTmFtZV09IGZ1bmN0aW9uKG4sIGd1YXJkKSB7XG4gICAgICAgICAgdmFyIGNoYWluQWxsID0gdGhpcy5fX2NoYWluX18sXG4gICAgICAgICAgICAgIHJlc3VsdCA9IGZ1bmModGhpcy5fX3dyYXBwZWRfXywgbiwgZ3VhcmQpO1xuXG4gICAgICAgICAgcmV0dXJuICFjaGFpbkFsbCAmJiAobiA9PSBudWxsIHx8IChndWFyZCAmJiAhKGNhbGxiYWNrYWJsZSAmJiB0eXBlb2YgbiA9PSAnZnVuY3Rpb24nKSkpXG4gICAgICAgICAgICA/IHJlc3VsdFxuICAgICAgICAgICAgOiBuZXcgbG9kYXNoV3JhcHBlcihyZXN1bHQsIGNoYWluQWxsKTtcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gICAgLyoqXG4gICAgICogVGhlIHNlbWFudGljIHZlcnNpb24gbnVtYmVyLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHR5cGUgc3RyaW5nXG4gICAgICovXG4gICAgbG9kYXNoLlZFUlNJT04gPSAnMi40LjEnO1xuXG4gICAgLy8gYWRkIFwiQ2hhaW5pbmdcIiBmdW5jdGlvbnMgdG8gdGhlIHdyYXBwZXJcbiAgICBsb2Rhc2gucHJvdG90eXBlLmNoYWluID0gd3JhcHBlckNoYWluO1xuICAgIGxvZGFzaC5wcm90b3R5cGUudG9TdHJpbmcgPSB3cmFwcGVyVG9TdHJpbmc7XG4gICAgbG9kYXNoLnByb3RvdHlwZS52YWx1ZSA9IHdyYXBwZXJWYWx1ZU9mO1xuICAgIGxvZGFzaC5wcm90b3R5cGUudmFsdWVPZiA9IHdyYXBwZXJWYWx1ZU9mO1xuXG4gICAgLy8gYWRkIGBBcnJheWAgZnVuY3Rpb25zIHRoYXQgcmV0dXJuIHVud3JhcHBlZCB2YWx1ZXNcbiAgICBmb3JFYWNoKFsnam9pbicsICdwb3AnLCAnc2hpZnQnXSwgZnVuY3Rpb24obWV0aG9kTmFtZSkge1xuICAgICAgdmFyIGZ1bmMgPSBhcnJheVJlZlttZXRob2ROYW1lXTtcbiAgICAgIGxvZGFzaC5wcm90b3R5cGVbbWV0aG9kTmFtZV0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGNoYWluQWxsID0gdGhpcy5fX2NoYWluX18sXG4gICAgICAgICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KHRoaXMuX193cmFwcGVkX18sIGFyZ3VtZW50cyk7XG5cbiAgICAgICAgcmV0dXJuIGNoYWluQWxsXG4gICAgICAgICAgPyBuZXcgbG9kYXNoV3JhcHBlcihyZXN1bHQsIGNoYWluQWxsKVxuICAgICAgICAgIDogcmVzdWx0O1xuICAgICAgfTtcbiAgICB9KTtcblxuICAgIC8vIGFkZCBgQXJyYXlgIGZ1bmN0aW9ucyB0aGF0IHJldHVybiB0aGUgZXhpc3Rpbmcgd3JhcHBlZCB2YWx1ZVxuICAgIGZvckVhY2goWydwdXNoJywgJ3JldmVyc2UnLCAnc29ydCcsICd1bnNoaWZ0J10sIGZ1bmN0aW9uKG1ldGhvZE5hbWUpIHtcbiAgICAgIHZhciBmdW5jID0gYXJyYXlSZWZbbWV0aG9kTmFtZV07XG4gICAgICBsb2Rhc2gucHJvdG90eXBlW21ldGhvZE5hbWVdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGZ1bmMuYXBwbHkodGhpcy5fX3dyYXBwZWRfXywgYXJndW1lbnRzKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgIH0pO1xuXG4gICAgLy8gYWRkIGBBcnJheWAgZnVuY3Rpb25zIHRoYXQgcmV0dXJuIG5ldyB3cmFwcGVkIHZhbHVlc1xuICAgIGZvckVhY2goWydjb25jYXQnLCAnc2xpY2UnLCAnc3BsaWNlJ10sIGZ1bmN0aW9uKG1ldGhvZE5hbWUpIHtcbiAgICAgIHZhciBmdW5jID0gYXJyYXlSZWZbbWV0aG9kTmFtZV07XG4gICAgICBsb2Rhc2gucHJvdG90eXBlW21ldGhvZE5hbWVdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBuZXcgbG9kYXNoV3JhcHBlcihmdW5jLmFwcGx5KHRoaXMuX193cmFwcGVkX18sIGFyZ3VtZW50cyksIHRoaXMuX19jaGFpbl9fKTtcbiAgICAgIH07XG4gICAgfSk7XG5cbiAgICByZXR1cm4gbG9kYXNoO1xuICB9XG5cbiAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbiAgLy8gZXhwb3NlIExvLURhc2hcbiAgdmFyIF8gPSBydW5JbkNvbnRleHQoKTtcblxuICAvLyBzb21lIEFNRCBidWlsZCBvcHRpbWl6ZXJzIGxpa2Ugci5qcyBjaGVjayBmb3IgY29uZGl0aW9uIHBhdHRlcm5zIGxpa2UgdGhlIGZvbGxvd2luZzpcbiAgaWYgKHR5cGVvZiBkZWZpbmUgPT0gJ2Z1bmN0aW9uJyAmJiB0eXBlb2YgZGVmaW5lLmFtZCA9PSAnb2JqZWN0JyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgLy8gRXhwb3NlIExvLURhc2ggdG8gdGhlIGdsb2JhbCBvYmplY3QgZXZlbiB3aGVuIGFuIEFNRCBsb2FkZXIgaXMgcHJlc2VudCBpblxuICAgIC8vIGNhc2UgTG8tRGFzaCBpcyBsb2FkZWQgd2l0aCBhIFJlcXVpcmVKUyBzaGltIGNvbmZpZy5cbiAgICAvLyBTZWUgaHR0cDovL3JlcXVpcmVqcy5vcmcvZG9jcy9hcGkuaHRtbCNjb25maWctc2hpbVxuICAgIHJvb3QuXyA9IF87XG5cbiAgICAvLyBkZWZpbmUgYXMgYW4gYW5vbnltb3VzIG1vZHVsZSBzbywgdGhyb3VnaCBwYXRoIG1hcHBpbmcsIGl0IGNhbiBiZVxuICAgIC8vIHJlZmVyZW5jZWQgYXMgdGhlIFwidW5kZXJzY29yZVwiIG1vZHVsZVxuICAgIGRlZmluZShmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBfO1xuICAgIH0pO1xuICB9XG4gIC8vIGNoZWNrIGZvciBgZXhwb3J0c2AgYWZ0ZXIgYGRlZmluZWAgaW4gY2FzZSBhIGJ1aWxkIG9wdGltaXplciBhZGRzIGFuIGBleHBvcnRzYCBvYmplY3RcbiAgZWxzZSBpZiAoZnJlZUV4cG9ydHMgJiYgZnJlZU1vZHVsZSkge1xuICAgIC8vIGluIE5vZGUuanMgb3IgUmluZ29KU1xuICAgIGlmIChtb2R1bGVFeHBvcnRzKSB7XG4gICAgICAoZnJlZU1vZHVsZS5leHBvcnRzID0gXykuXyA9IF87XG4gICAgfVxuICAgIC8vIGluIE5hcndoYWwgb3IgUmhpbm8gLXJlcXVpcmVcbiAgICBlbHNlIHtcbiAgICAgIGZyZWVFeHBvcnRzLl8gPSBfO1xuICAgIH1cbiAgfVxuICBlbHNlIHtcbiAgICAvLyBpbiBhIGJyb3dzZXIgb3IgUmhpbm9cbiAgICByb290Ll8gPSBfO1xuICB9XG59LmNhbGwodGhpcykpO1xuXG59KS5jYWxsKHRoaXMsdHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbCA6IHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiB7fSkiLCIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgT2N1bHVzIEluZm8gSW5jLlxyXG4gKiBodHRwOi8vd3d3Lm9jdWx1c2luZm8uY29tL1xyXG4gKlxyXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXHJcbiAqXHJcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkgb2ZcclxuICogdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpblxyXG4gKiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvXHJcbiAqIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzXHJcbiAqIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkb1xyXG4gKiBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XHJcblxyXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbiBhbGxcclxuICogY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cclxuXHJcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcclxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXHJcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxyXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXHJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXHJcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFXHJcbiAqIFNPRlRXQVJFLlxyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBUaGlzIG1vZHVsZSBkZWZpbmVzIGEgVGlsZVB5cmFtaWQgY2xhc3MsIHRoZSBlcXVpdmFsZW50IG9mIEFPSVRpbGVQeXJhbWlkIGluXHJcbiAqIGJpbm5pbmctdXRpbGl0aWVzLlxyXG4gKi9cclxuKCBmdW5jdGlvbigpIHtcclxuICAgIFxyXG5cdFwidXNlIHN0cmljdFwiO1xyXG5cclxuXHRmdW5jdGlvbiBBcmVhT2ZJbnRlcmVzdFRpbGVQeXJhbWlkKCBzcGVjICkge1xyXG4gICAgICAgIHRoaXMubWluWCA9IHNwZWMubWluWDtcclxuICAgICAgICB0aGlzLm1pblkgPSBzcGVjLm1pblk7XHJcbiAgICAgICAgdGhpcy5tYXhYID0gc3BlYy5tYXhYO1xyXG4gICAgICAgIHRoaXMubWF4WSA9IHNwZWMubWF4WTtcclxuICAgIH1cclxuXHJcbiAgICBBcmVhT2ZJbnRlcmVzdFRpbGVQeXJhbWlkLnByb3RvdHlwZS5nZXRQcm9qZWN0aW9uID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIFwiRVBTRzo0MzI2XCI7XHJcbiAgICB9O1xyXG5cclxuXHRBcmVhT2ZJbnRlcmVzdFRpbGVQeXJhbWlkLnByb3RvdHlwZS5nZXRUaWxlU2NoZW1lID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIFwiVE1TXCI7XHJcbiAgICB9O1xyXG5cclxuXHRBcmVhT2ZJbnRlcmVzdFRpbGVQeXJhbWlkLnByb3RvdHlwZS5yb290VG9GcmFjdGlvbmFsVGlsZSA9IGZ1bmN0aW9uKCByb290ICkge1xyXG4gICAgICAgIHZhciBudW1EaXZzLCB0aWxlWCwgdGlsZVk7XHJcbiAgICAgICAgbnVtRGl2cyA9IDEgPDwgcm9vdC5sZXZlbDtcclxuICAgICAgICB0aWxlWCA9IG51bURpdnMgKiAocm9vdC54SW5kZXggLSB0aGlzLm1pblgpIC8gKHRoaXMubWF4WCAtIHRoaXMubWluWCk7XHJcbiAgICAgICAgdGlsZVkgPSBudW1EaXZzICogKHJvb3QueUluZGV4IC0gdGhpcy5taW5ZKSAvICh0aGlzLm1heFkgLSB0aGlzLm1pblkpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICdsZXZlbCc6IHJvb3QubGV2ZWwsXHJcbiAgICAgICAgICAgICd4SW5kZXgnOiB0aWxlWCxcclxuICAgICAgICAgICAgJ3lJbmRleCc6IHRpbGVZXHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcblxyXG4gICAgQXJlYU9mSW50ZXJlc3RUaWxlUHlyYW1pZC5wcm90b3R5cGUuZnJhY3Rpb25hbFRpbGVUb1Jvb3QgPSBmdW5jdGlvbiggdGlsZSApIHtcclxuICAgICAgICB2YXIgcG93MiwgdGlsZVhTaXplLCB0aWxlWVNpemU7XHJcbiAgICAgICAgcG93MiA9IDEgPDwgdGlsZS5sZXZlbDtcclxuICAgICAgICB0aWxlWFNpemUgPSAodGhpcy5tYXhYIC0gdGhpcy5taW5YKSAvIHBvdzI7XHJcbiAgICAgICAgdGlsZVlTaXplID0gKHRoaXMubWF4WSAtIHRoaXMubWluWSkgLyBwb3cyO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGxldmVsOiB0aWxlLmxldmVsLFxyXG4gICAgICAgICAgICB4SW5kZXg6IHRoaXMubWluWCArIHRpbGVYU2l6ZSAqIHRpbGUueEluZGV4LFxyXG4gICAgICAgICAgICB5SW5kZXg6IHRoaXMubWluWSArIHRpbGVZU2l6ZSAqIHRpbGUueUluZGV4XHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcblxyXG4gICAgQXJlYU9mSW50ZXJlc3RUaWxlUHlyYW1pZC5wcm90b3R5cGUucm9vdFRvVGlsZSA9IGZ1bmN0aW9uICh4LCB5LCBsZXZlbCwgYmlucykge1xyXG4gICAgICAgIHZhciBudW1EaXZzLCB0aWxlWCwgdGlsZVk7XHJcbiAgICAgICAgbnVtRGl2cyA9IDEgPDwgbGV2ZWw7XHJcbiAgICAgICAgdGlsZVggPSBNYXRoLmZsb29yKG51bURpdnMgKiAoeCAtIHRoaXMubWluWCkgLyAodGhpcy5tYXhYIC0gdGhpcy5taW5YKSk7XHJcbiAgICAgICAgdGlsZVkgPSBNYXRoLmZsb29yKG51bURpdnMgKiAoeSAtIHRoaXMubWluWSkgLyAodGhpcy5tYXhZIC0gdGhpcy5taW5ZKSk7XHJcbiAgICAgICAgaWYgKCFiaW5zKSB7XHJcbiAgICAgICAgICAgIGJpbnMgPSAyNTY7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB7bGV2ZWw6ICAgICBsZXZlbCxcclxuICAgICAgICAgICAgICAgIHhJbmRleDogICAgdGlsZVgsXHJcbiAgICAgICAgICAgICAgICB5SW5kZXg6ICAgIHRpbGVZLFxyXG4gICAgICAgICAgICAgICAgeEJpbkNvdW50OiBiaW5zLFxyXG4gICAgICAgICAgICAgICAgeUJpbkNvdW50OiBiaW5zfTtcclxuICAgIH07XHJcblxyXG4gICAgQXJlYU9mSW50ZXJlc3RUaWxlUHlyYW1pZC5wcm90b3R5cGUucm9vdFRvQmluID0gZnVuY3Rpb24gKHgsIHksIHRpbGUpIHtcclxuICAgICAgICB2YXIgcG93MiwgdGlsZVhTaXplLCB0aWxlWVNpemUsIHhJblRpbGUsIHlJblRpbGUsIGJpblgsIGJpblk7XHJcbiAgICAgICAgcG93MiA9IDEgPDwgdGlsZS5sZXZlbDtcclxuICAgICAgICB0aWxlWFNpemUgPSAodGhpcy5tYXhYIC0gdGhpcy5taW5YKSAvIHBvdzI7XHJcbiAgICAgICAgdGlsZVlTaXplID0gKHRoaXMubWF4WSAtIHRoaXMubWluWSkgLyBwb3cyO1xyXG4gICAgICAgIHhJblRpbGUgPSB4IC0gdGhpcy5taW5YIC0gdGlsZS54SW5kZXggKiB0aWxlWFNpemU7XHJcbiAgICAgICAgeUluVGlsZSA9IHkgLSB0aGlzLm1pblkgLSB0aWxlLnlJbmRleCAqIHRpbGVZU2l6ZTtcclxuICAgICAgICBiaW5YID0gTWF0aC5mbG9vcih4SW5UaWxlICogdGlsZS54QmluQ291bnQgLyB0aWxlWFNpemUpO1xyXG4gICAgICAgIGJpblkgPSBNYXRoLmZsb29yKHlJblRpbGUgKiB0aWxlLnlCaW5Db3VudCAvIHRpbGVZU2l6ZSk7XHJcbiAgICAgICAgcmV0dXJuIHt4OiBiaW5YLFxyXG4gICAgICAgICAgICAgICAgeTogdGlsZS55QmluQ291bnQgLSAxIC0gYmluWX07XHJcbiAgICB9O1xyXG5cclxuICAgIEFyZWFPZkludGVyZXN0VGlsZVB5cmFtaWQucHJvdG90eXBlLmdldFRpbGVCb3VuZHMgPSBmdW5jdGlvbiAodGlsZSkge1xyXG4gICAgICAgIHZhciBwb3cyLCB0aWxlWFNpemUsIHRpbGVZU2l6ZTtcclxuICAgICAgICBwb3cyID0gMSA8PCB0aWxlLmxldmVsO1xyXG4gICAgICAgIHRpbGVYU2l6ZSA9ICh0aGlzLm1heFggLSB0aGlzLm1pblgpIC8gcG93MjtcclxuICAgICAgICB0aWxlWVNpemUgPSAodGhpcy5tYXhZIC0gdGhpcy5taW5ZKSAvIHBvdzI7XHJcbiAgICAgICAgcmV0dXJuIHttaW5YOiB0aGlzLm1pblggKyB0aWxlWFNpemUgKiB0aWxlLnhJbmRleCxcclxuICAgICAgICAgICAgICAgIG1pblk6IHRoaXMubWluWSArIHRpbGVZU2l6ZSAqIHRpbGUueUluZGV4LFxyXG4gICAgICAgICAgICAgICAgbWF4WDogdGhpcy5taW5YICsgdGlsZVhTaXplICogKHRpbGUueEluZGV4ICsgMSksXHJcbiAgICAgICAgICAgICAgICBtYXhZOiB0aGlzLm1pblkgKyB0aWxlWVNpemUgKiAodGlsZS55SW5kZXggKyAxKSxcclxuICAgICAgICAgICAgICAgIGNlbnRlclg6IHRoaXMubWluWCArIHRpbGVYU2l6ZSAqICh0aWxlLnhJbmRleCArIDAuNSksXHJcbiAgICAgICAgICAgICAgICBjZW50ZXJZOiB0aGlzLm1pblkgKyB0aWxlWVNpemUgKiAodGlsZS55SW5kZXggKyAwLjUpLFxyXG4gICAgICAgICAgICAgICAgd2lkdGg6IHRpbGVYU2l6ZSxcclxuICAgICAgICAgICAgICAgIGhlaWdodDogdGlsZVlTaXplfTtcclxuICAgIH07XHJcblxyXG4gICAgQXJlYU9mSW50ZXJlc3RUaWxlUHlyYW1pZC5wcm90b3R5cGUuZ2V0QmluQm91bmRzID0gZnVuY3Rpb24gKHRpbGUsIGJpbikge1xyXG4gICAgICAgIHZhciBwb3cyLCB0aWxlWFNpemUsIHRpbGVZU2l6ZSwgYmluWFNpemUsIGJpbllTaXplLCBhZGp1c3RlZFksXHJcbiAgICAgICAgICAgIGxlZnQsIGJvdHRvbTtcclxuICAgICAgICBwb3cyID0gMSA8PCB0aWxlLmxldmVsO1xyXG4gICAgICAgIHRpbGVYU2l6ZSA9ICh0aGlzLm1heFggLSB0aGlzLm1pblgpIC8gcG93MjtcclxuICAgICAgICB0aWxlWVNpemUgPSAodGhpcy5tYXhZIC0gdGhpcy5taW5ZKSAvIHBvdzI7XHJcbiAgICAgICAgYmluWFNpemUgPSB0aWxlWFNpemUgLyB0aWxlLnhCaW5Db3VudDtcclxuICAgICAgICBiaW5ZU2l6ZSA9IHRpbGVZU2l6ZSAvIHRpbGUueUJpbkNvdW50O1xyXG4gICAgICAgIGFkanVzdGVkWSA9IHRpbGUueUJpbkNvdW50IC0gMSAtIGJpbi55O1xyXG4gICAgICAgIGxlZnQgPSB0aGlzLm1pblggKyB0aWxlWFNpemUgKiB0aWxlLnhJbmRleDtcclxuICAgICAgICBib3R0b20gPSB0aGlzLm1pblkgKyB0aWxlWVNpemUgKiB0aWxlLnlJbmRleDtcclxuICAgICAgICByZXR1cm4ge21pblg6IGxlZnQgKyBiaW5YU2l6ZSAqIGJpbi54LFxyXG4gICAgICAgICAgICAgICAgbWluWTogYm90dG9tICsgYmluWVNpemUgKiBhZGp1c3RlZFksXHJcbiAgICAgICAgICAgICAgICBtYXhYOiBsZWZ0ICsgYmluWFNpemUgKiAoYmluLnggKyAxKSxcclxuICAgICAgICAgICAgICAgIG1heFk6IGJvdHRvbSArIGJpbllTaXplICogKGFkanVzdGVkWSArIDEpLFxyXG4gICAgICAgICAgICAgICAgY2VudGVyWDogbGVmdCArIGJpblhTaXplICogKGJpbi54ICsgMC41KSxcclxuICAgICAgICAgICAgICAgIGNlbnRlclk6IGJvdHRvbSArIGJpbllTaXplICogKGFkanVzdGVkWSArIDAuNSksXHJcbiAgICAgICAgICAgICAgICB3aWR0aDogYmluWFNpemUsXHJcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IGJpbllTaXplfTtcclxuICAgIH07XHJcblxyXG4gICAgQXJlYU9mSW50ZXJlc3RUaWxlUHlyYW1pZC5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIFwidHlwZVwiOiBcIkFyZWFPZkludGVyZXN0XCIsXHJcbiAgICAgICAgICAgIFwibWluWFwiOiB0aGlzLm1pblgsXHJcbiAgICAgICAgICAgIFwibWF4WFwiOiB0aGlzLm1heFgsXHJcbiAgICAgICAgICAgIFwibWluWVwiOiB0aGlzLm1pblksXHJcbiAgICAgICAgICAgIFwibWF4WVwiOiB0aGlzLm1heFlcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuXHJcblx0bW9kdWxlLmV4cG9ydHMgPSBBcmVhT2ZJbnRlcmVzdFRpbGVQeXJhbWlkO1xyXG5cclxufSgpKTtcclxuIiwiLypcclxuICogQ29weXJpZ2h0IChjKSAyMDE0IE9jdWx1cyBJbmZvIEluYy5cclxuICogaHR0cDovL3d3dy5vY3VsdXNpbmZvLmNvbS9cclxuICpcclxuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKlxyXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5IG9mXHJcbiAqIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW5cclxuICogdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0b1xyXG4gKiB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllc1xyXG4gKiBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG9cclxuICogc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxyXG5cclxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsXHJcbiAqIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXHJcblxyXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXHJcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxyXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcclxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxyXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxyXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRVxyXG4gKiBTT0ZUV0FSRS5cclxuICovXHJcblxyXG4vKipcclxuICogVGhpcyBtb2R1bGUgZGVmaW5lcyBhIFRpbGVJdGVyYXRvciBjbGFzcywgdGhlIGVxdWl2YWxlbnQgb2YgVGlsZUl0ZXJhdG9yIGluXHJcbiAqIGJpbm5pbmctdXRpbGl0aWVzLlxyXG4gKi9cclxuKCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICBmdW5jdGlvbiBUaWxlSXRlcmF0b3IoIHNwZWMgKSB7XHJcbiAgICAgICAgdGhpcy5weXJhbWlkID0gc3BlYy5weXJhbWlkO1xyXG4gICAgICAgIHRoaXMubGV2ZWwgPSBzcGVjLmxldmVsO1xyXG4gICAgICAgIHRoaXMubWluVGlsZSA9IHNwZWMucHlyYW1pZC5yb290VG9UaWxlKCBzcGVjLm1pblgsIHNwZWMubWluWSwgc3BlYy5sZXZlbCApO1xyXG4gICAgICAgIHRoaXMubWF4VGlsZSA9IHNwZWMucHlyYW1pZC5yb290VG9UaWxlKCBzcGVjLm1heFgsIHNwZWMubWF4WSwgc3BlYy5sZXZlbCApO1xyXG4gICAgICAgIHRoaXMuY3VyWCA9IHRoaXMubWluVGlsZS54SW5kZXg7XHJcbiAgICAgICAgdGhpcy5jdXJZID0gdGhpcy5taW5UaWxlLnlJbmRleDtcclxuICAgIH1cclxuXHJcbiAgICBUaWxlSXRlcmF0b3IucHJvdG90eXBlLmhhc05leHQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLmN1clggPD0gdGhpcy5tYXhUaWxlLnhJbmRleCAmJlxyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJZIDw9IHRoaXMubWF4VGlsZS55SW5kZXgpO1xyXG4gICAgfTtcclxuXHJcbiAgICBUaWxlSXRlcmF0b3IucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHRpbGUgPSB7XHJcbiAgICAgICAgICAgIHhJbmRleDogICAgdGhpcy5jdXJYLFxyXG4gICAgICAgICAgICB5SW5kZXg6ICAgIHRoaXMuY3VyWSxcclxuICAgICAgICAgICAgbGV2ZWw6ICAgICB0aGlzLmxldmVsLFxyXG4gICAgICAgICAgICB4QmluQ291bnQ6IDI1NixcclxuICAgICAgICAgICAgeUJpbkNvdW50OiAyNTZcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuY3VyWCA9IHRoaXMuY3VyWCArIDE7XHJcbiAgICAgICAgaWYgKHRoaXMuY3VyWCA+IHRoaXMubWF4VGlsZS54SW5kZXgpIHtcclxuICAgICAgICAgICAgdGhpcy5jdXJYID0gdGhpcy5taW5UaWxlLnhJbmRleDtcclxuICAgICAgICAgICAgdGhpcy5jdXJZID0gdGhpcy5jdXJZICsgMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRpbGU7XHJcbiAgICB9O1xyXG5cclxuICAgIFRpbGVJdGVyYXRvci5wcm90b3R5cGUuZ2V0UmVzdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgYWxsID0gW107XHJcbiAgICAgICAgd2hpbGUgKHRoaXMuaGFzTmV4dCgpKSB7XHJcbiAgICAgICAgICAgIGFsbFthbGwubGVuZ3RoXSA9IHRoaXMubmV4dCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYWxsO1xyXG4gICAgfTtcclxuXHJcbiAgICBUaWxlSXRlcmF0b3IucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBzcmVwID0gXCJcIiwgaW5kZXg7XHJcbiAgICAgICAgd2hpbGUgKHRoaXMuaGFzTmV4dCgpKSB7XHJcbiAgICAgICAgICAgIGlmIChzcmVwLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHNyZXAgPSBzcmVwICsgXCJ8XCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaW5kZXggPSB0aGlzLm5leHQoKTtcclxuICAgICAgICAgICAgc3JlcCA9IHNyZXAgKyBcIltcIitpbmRleC54SW5kZXgrXCIvXCIraW5kZXgueEJpbkNvdW50K1wiLFwiK2luZGV4LnlJbmRleCtcIi9cIitpbmRleC55QmluQ291bnQrXCIsIGx2bCBcIitpbmRleC5sZXZlbCtcIl1cIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHNyZXA7XHJcbiAgICB9O1xyXG5cclxuICAgIFRpbGVJdGVyYXRvci5wcm90b3R5cGUudG9UaWxlQm91bmRzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICdtaW5YJzogdGhpcy5taW5UaWxlLnhJbmRleCxcclxuICAgICAgICAgICAgJ21heFgnOiB0aGlzLm1heFRpbGUueEluZGV4LFxyXG4gICAgICAgICAgICAnbWluWSc6IHRoaXMubWluVGlsZS55SW5kZXgsXHJcbiAgICAgICAgICAgICdtYXhZJzogdGhpcy5tYXhUaWxlLnlJbmRleCxcclxuICAgICAgICAgICAgJ21pblonOiB0aGlzLmxldmVsLFxyXG4gICAgICAgICAgICAnbWF4Wic6IHRoaXMubGV2ZWxcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuXHJcbiAgICBtb2R1bGUuZXhwb3J0cyA9IFRpbGVJdGVyYXRvcjtcclxufSgpKTtcclxuXHJcbiIsIi8qXHJcbiAqIENvcHlyaWdodCAoYykgMjAxNCBPY3VsdXMgSW5mbyBJbmMuXHJcbiAqIGh0dHA6Ly93d3cub2N1bHVzaW5mby5jb20vXHJcbiAqXHJcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuICpcclxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weSBvZlxyXG4gKiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluXHJcbiAqIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG9cclxuICogdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXNcclxuICogb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvXHJcbiAqIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcclxuXHJcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbFxyXG4gKiBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxyXG5cclxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxyXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXHJcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcclxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEVcclxuICogU09GVFdBUkUuXHJcbiAqL1xyXG5cclxuLyoqXHJcbiAqIFRoaXMgbW9kdWxlIGRlZmluZXMgYSBUaWxlUHlyYW1pZCBjbGFzcywgdGhlIGVxdWl2YWxlbnQgb2YgXHJcbiAqIFdlYk1lcmNhdG9yVGlsZVB5cmFtaWQgaW4gYmlubmluZy11dGlsaXRpZXMuXHJcbiAqL1xyXG4oIGZ1bmN0aW9uKCkge1xyXG5cclxuXHRcInVzZSBzdHJpY3RcIjtcclxuXHJcblx0dmFyIEVQU0dfOTAwOTEzX1NDQUxFX0ZBQ1RPUiA9IDIwMDM3NTA4LjM0Mjc4OTI0NCxcclxuXHQgICAgRVBTR185MDA5MTNfTEFUSVRVREUgPSA4NS4wNTExMjg3OCxcclxuXHQgICAgREVHUkVFU19UT19SQURJQU5TID0gTWF0aC5QSSAvIDE4MC4wLFx0Ly8gRmFjdG9yIGZvciBjaGFuZ2luZyBkZWdyZWVzIHRvIHJhZGlhbnNcclxuXHQgICAgUkFESUFOU19UT19ERUdSRUVTID0gMTgwLjAgLyBNYXRoLlBJLFx0Ly8gRmFjdG9yIGZvciBjaGFuZ2luZyByYWRpYW5zIHRvIGRlZ3JlZXNcclxuXHQgICAgcm9vdFRvVGlsZU1lcmNhdG9yLCBzaW5oLCB0aWxlVG9Mb24sIHRpbGVUb0xhdCxcclxuXHQgICAgbGluZWFyVG9HdWRlcm1hbm5pYW4sXHJcblx0ICAgIGd1ZGVybWFubmlhblRvTGluZWFyO1xyXG5cclxuXHRyb290VG9UaWxlTWVyY2F0b3IgPSBmdW5jdGlvbiAobG9uLCBsYXQsIGxldmVsKSB7XHJcblx0XHR2YXIgbGF0UiA9IGxhdCAqIERFR1JFRVNfVE9fUkFESUFOUyxcclxuXHRcdCAgICBwb3cyID0gMSA8PCBsZXZlbCxcclxuXHRcdCAgICB4ICAgID0gKGxvbiArIDE4MC4wKSAvIDM2MC4wICogcG93MixcclxuXHRcdCAgICB5ICAgID0gKHBvdzIgKiAoMSAtIE1hdGgubG9nKE1hdGgudGFuKGxhdFIpICsgMSAvIE1hdGguY29zKGxhdFIpKSAvIE1hdGguUEkpIC8gMik7XHJcblx0XHRyZXR1cm4ge3g6IHgsIHk6IHBvdzIteX07XHJcblx0fTtcclxuXHJcblx0dGlsZVRvTG9uID0gZnVuY3Rpb24gKHgsIGxldmVsKSB7XHJcblx0XHR2YXIgcG93MiA9IDEgPDwgbGV2ZWw7XHJcblx0XHRyZXR1cm4geCAvIHBvdzIgKiAzNjAuMCAtIDE4MC4wO1xyXG5cdH07XHJcblxyXG5cdHNpbmggPSBmdW5jdGlvbiAoYXJnKSB7XHJcblx0XHRyZXR1cm4gKE1hdGguZXhwKGFyZykgLSBNYXRoLmV4cCgtYXJnKSkgLyAyLjA7XHJcblx0fTtcclxuXHJcblx0dGlsZVRvTGF0ID0gZnVuY3Rpb24gKHksIGxldmVsKSB7XHJcblx0XHR2YXIgcG93MiA9IDEgPDwgbGV2ZWwsXHJcblx0XHQgICAgbiAgICA9IC1NYXRoLlBJICsgKDIuMCAqIE1hdGguUEkgKiB5KSAvIHBvdzI7XHJcblx0XHRyZXR1cm4gTWF0aC5hdGFuKHNpbmgobikpICogUkFESUFOU19UT19ERUdSRUVTO1xyXG5cdH07XHJcblxyXG5cdGxpbmVhclRvR3VkZXJtYW5uaWFuID0gZnVuY3Rpb24odmFsdWUpIHtcclxuXHRcdHZhciBndWRlcm1hbm5pYW4gPSBmdW5jdGlvbih5KSB7XHJcblx0XHRcdC8vIGNvbnZlcnRzIGEgeSB2YWx1ZSBmcm9tIC1QSShib3R0b20pIHRvIFBJKHRvcCkgaW50byB0aGVcclxuXHRcdFx0Ly8gbWVyY2F0b3IgcHJvamVjdGlvbiBsYXRpdHVkZVxyXG5cdFx0XHR2YXIgc2luaCA9IGZ1bmN0aW9uIChhcmcpIHtcclxuXHRcdFx0XHRyZXR1cm4gKE1hdGguZXhwKGFyZykgLSBNYXRoLmV4cCgtYXJnKSkgLyAyLjA7XHJcblx0XHRcdH07XHJcblx0XHRcdHJldHVybiBNYXRoLmF0YW4oc2luaCh5KSkgKiBSQURJQU5TX1RPX0RFR1JFRVM7XHJcblx0XHR9O1xyXG5cdFx0cmV0dXJuIGd1ZGVybWFubmlhbiggKHZhbHVlIC8gRVBTR185MDA5MTNfTEFUSVRVREUpICogTWF0aC5QSSApO1xyXG5cdH07XHJcblxyXG5cdGd1ZGVybWFubmlhblRvTGluZWFyID0gZnVuY3Rpb24odmFsdWUpIHtcclxuXHRcdHZhciBndWRlcm1hbm5pYW5JbnYgPSBmdW5jdGlvbiggbGF0aXR1ZGUgKSB7XHJcblx0XHRcdC8vIGNvbnZlcnRzIGEgbGF0aXR1ZGUgdmFsdWUgZnJvbSAtRVBTR185MDA5MTNfTEFUSVRVREUgdG8gRVBTR185MDA5MTNfTEFUSVRVREUgaW50b1xyXG5cdFx0XHQvLyBhIHkgdmFsdWUgZnJvbSAtUEkoYm90dG9tKSB0byBQSSh0b3ApXHJcblx0XHRcdHZhciBzaWduID0gKCBsYXRpdHVkZSAhPT0gMCApID8gbGF0aXR1ZGUgLyBNYXRoLmFicyhsYXRpdHVkZSkgOiAwLFxyXG5cdFx0XHQgICAgc2luID0gTWF0aC5zaW4obGF0aXR1ZGUgKiBERUdSRUVTX1RPX1JBRElBTlMgKiBzaWduKTtcclxuXHJcblx0XHRcdHJldHVybiBzaWduICogKE1hdGgubG9nKCgxLjAgKyBzaW4pIC8gKDEuMCAtIHNpbikpIC8gMi4wKTtcclxuXHRcdH07XHJcblx0XHRyZXR1cm4gKGd1ZGVybWFubmlhbkludiggdmFsdWUgKSAvIE1hdGguUEkpICogRVBTR185MDA5MTNfTEFUSVRVREU7XHJcblx0fTtcclxuXHJcblx0ZnVuY3Rpb24gV2ViTWVyY2F0b3JUaWxlUHlyYW1pZCgpIHtcclxuICAgICAgICB0aGlzLm1pblggPSAtMTgwLjA7XHJcbiAgICAgICAgdGhpcy5taW5ZID0gLTg1LjA1O1xyXG4gICAgICAgIHRoaXMubWF4WCA9IDE4MC4wO1xyXG4gICAgICAgIHRoaXMubWF4WSA9IDg1LjA1O1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIFdlYk1lcmNhdG9yVGlsZVB5cmFtaWQucHJvdG90eXBlLmdldFByb2plY3Rpb24gPSBmdW5jdGlvbigpe1xyXG4gICAgICAgIHJldHVybiBcIkVQU0c6OTAwOTEzXCI7XHJcbiAgICB9O1xyXG5cclxuICAgIFdlYk1lcmNhdG9yVGlsZVB5cmFtaWQucHJvdG90eXBlLmdldFRpbGVTY2hlbWUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gXCJUTVNcIjtcclxuICAgIH07XHJcblxyXG4gICAgV2ViTWVyY2F0b3JUaWxlUHlyYW1pZC5wcm90b3R5cGUuZ2V0RVBTRzkwMDkxM0JvdW5kcyA9IGZ1bmN0aW9uKCB0aWxlLCBiaW4gKSB7XHJcbiAgICAgICAgdmFyIHBvdzIgICAgICAgICAgPSAxIDw8IHRpbGUubGV2ZWwsXHJcbiAgICAgICAgICAgIHRpbGVJbmNyZW1lbnQgPSAxLjAvcG93MixcclxuICAgICAgICAgICAgbWluWCAgICAgICAgICA9IHRpbGUueEluZGV4ICogdGlsZUluY3JlbWVudCAtIDAuNSxcclxuICAgICAgICAgICAgbWluWSAgICAgICAgICA9IHRpbGUueUluZGV4ICogdGlsZUluY3JlbWVudCAtIDAuNSxcclxuICAgICAgICAgICAgbWF4WCwgbWF4WSwgYmluWEluYywgYmluWUluYztcclxuXHJcbiAgICAgICAgaWYgKGJpbikge1xyXG4gICAgICAgICAgICBtYXhYID0gbWluWCArIHRpbGVJbmNyZW1lbnQ7XHJcbiAgICAgICAgICAgIG1heFkgPSBtaW5ZICsgdGlsZUluY3JlbWVudDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBiaW5YSW5jID0gdGlsZUluY3JlbWVudCAvIHRpbGUueEJpbkNvdW50O1xyXG4gICAgICAgICAgICBiaW5ZSW5jID0gdGlsZUluY3JlbWVudCAvIHRpbGUueUJpbkNvdW50O1xyXG4gICAgICAgICAgICBtaW5YID0gbWluWCArIGJpbi54ICogYmluWEluYztcclxuICAgICAgICAgICAgbWluWSA9IG1pblkgKyAodGlsZS55QmluQ291bnQgLSBiaW4ueSAtIDEpICogYmluWUluYztcclxuICAgICAgICAgICAgbWF4WCA9IG1pblggKyBiaW5YSW5jO1xyXG4gICAgICAgICAgICBtYXhZID0gbWluWSArIGJpbllJbmM7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBtaW5YOiAgICBtaW5YICogMi4wICogRVBTR185MDA5MTNfU0NBTEVfRkFDVE9SLFxyXG4gICAgICAgICAgICBtaW5ZOiAgICBtaW5ZICogMi4wICogRVBTR185MDA5MTNfU0NBTEVfRkFDVE9SLFxyXG4gICAgICAgICAgICBtYXhYOiAgICBtYXhYICogMi4wICogRVBTR185MDA5MTNfU0NBTEVfRkFDVE9SLFxyXG4gICAgICAgICAgICBtYXhZOiAgICBtYXhZICogMi4wICogRVBTR185MDA5MTNfU0NBTEVfRkFDVE9SLFxyXG4gICAgICAgICAgICBjZW50ZXJYOiAobWluWCArIG1heFgpICogRVBTR185MDA5MTNfU0NBTEVfRkFDVE9SLFxyXG4gICAgICAgICAgICBjZW50ZXJZOiAobWluWSArIG1heFkpICogRVBTR185MDA5MTNfU0NBTEVfRkFDVE9SLFxyXG4gICAgICAgICAgICB3aWR0aDogICAobWF4WCAtIG1pblgpICogMi4wICogRVBTR185MDA5MTNfU0NBTEVfRkFDVE9SLFxyXG4gICAgICAgICAgICBoZWlnaHQ6ICAobWF4WSAtIG1pblkpICogMi4wICogRVBTR185MDA5MTNfU0NBTEVfRkFDVE9SXHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcblxyXG4gICAgV2ViTWVyY2F0b3JUaWxlUHlyYW1pZC5wcm90b3R5cGUucm9vdFRvRnJhY3Rpb25hbFRpbGUgPSBmdW5jdGlvbiggcm9vdCApIHtcclxuICAgICAgICB2YXIgdGlsZU1lcmNhdG9yID0gcm9vdFRvVGlsZU1lcmNhdG9yKHJvb3QueEluZGV4LCByb290LnlJbmRleCwgcm9vdC5sZXZlbCk7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgJ2xldmVsJzogcm9vdC5sZXZlbCxcclxuICAgICAgICAgICAgJ3hJbmRleCc6IHRpbGVNZXJjYXRvci54LFxyXG4gICAgICAgICAgICAneUluZGV4JzogdGlsZU1lcmNhdG9yLnlcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuXHJcbiAgICBXZWJNZXJjYXRvclRpbGVQeXJhbWlkLnByb3RvdHlwZS5mcmFjdGlvbmFsVGlsZVRvUm9vdCA9IGZ1bmN0aW9uKCB0aWxlICkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGxldmVsOiB0aWxlLmxldmVsLFxyXG4gICAgICAgICAgICB4SW5kZXg6IHRpbGVUb0xvbih0aWxlLnhJbmRleCwgdGlsZS5sZXZlbCksXHJcbiAgICAgICAgICAgIHlJbmRleDogdGlsZVRvTGF0KHRpbGUueUluZGV4LCB0aWxlLmxldmVsKVxyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG5cclxuICAgIFdlYk1lcmNhdG9yVGlsZVB5cmFtaWQucHJvdG90eXBlLnJvb3RUb1RpbGUgPSBmdW5jdGlvbiAobG9uLCBsYXQsIGxldmVsLCBiaW5zKSB7XHJcbiAgICAgICAgaWYgKCFiaW5zKSB7XHJcbiAgICAgICAgICAgIGJpbnMgPSAyNTY7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciB0aWxlTWVyY2F0b3IgPSByb290VG9UaWxlTWVyY2F0b3IobG9uLCBsYXQsIGxldmVsKTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBsZXZlbDogICAgIGxldmVsLFxyXG4gICAgICAgICAgICB4SW5kZXg6ICAgIE1hdGguZmxvb3IodGlsZU1lcmNhdG9yLngpLFxyXG4gICAgICAgICAgICB5SW5kZXg6ICAgIE1hdGguZmxvb3IodGlsZU1lcmNhdG9yLnkpLFxyXG4gICAgICAgICAgICB4QmluQ291bnQ6IGJpbnMsXHJcbiAgICAgICAgICAgIHlCaW5Db3VudDogYmluc1xyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG5cclxuICAgIFdlYk1lcmNhdG9yVGlsZVB5cmFtaWQucHJvdG90eXBlLnJvb3RUb0JpbiA9IGZ1bmN0aW9uKCB4LCB5LCB0aWxlICkge1xyXG4gICAgICAgIHZhciB0aWxlTWVyY2F0b3IgPSByb290VG9UaWxlTWVyY2F0b3IoeCwgeSwgdGlsZS5sZXZlbCk7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgeDogTWF0aC5mbG9vcigodGlsZU1lcmNhdG9yLnggLSB0aWxlLnhJbmRleCkgKiB0aWxlLnhCaW5Db3VudCksXHJcbiAgICAgICAgICAgIHk6IHRpbGUueUJpbkNvdW50IC0gMSAtIE1hdGguZmxvb3IoKHRpbGVNZXJjYXRvci55IC0gdGlsZS55SW5kZXgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB0aWxlLnlCaW5Db3VudClcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuXHJcbiAgICBXZWJNZXJjYXRvclRpbGVQeXJhbWlkLnByb3RvdHlwZS5nZXRUaWxlQm91bmRzID0gZnVuY3Rpb24oIHRpbGUgKSB7XHJcbiAgICAgICAgdmFyIGxldmVsID0gdGlsZS5sZXZlbCxcclxuICAgICAgICAgICAgbm9ydGggPSB0aWxlVG9MYXQodGlsZS55SW5kZXgrMSwgbGV2ZWwpLFxyXG4gICAgICAgICAgICBzb3V0aCA9IHRpbGVUb0xhdCh0aWxlLnlJbmRleCwgbGV2ZWwpLFxyXG4gICAgICAgICAgICBlYXN0ICA9IHRpbGVUb0xvbih0aWxlLnhJbmRleCsxLCBsZXZlbCksXHJcbiAgICAgICAgICAgIHdlc3QgID0gdGlsZVRvTG9uKHRpbGUueEluZGV4LCBsZXZlbCksXHJcbiAgICAgICAgICAgIC8vIGFzIG1lcmNhdG9yIGxhdGl0dWRlIGNhbm5vdCBiZSBsaW5lYXJseSBpbnRlcnBvbGF0ZWQsIGNvbnZlcnQgdGhlIGd1ZGVybWFubmlhblxyXG4gICAgICAgICAgICAvLyBjb29yZGluYXRlcyBiYWNrIGludG8gdGhlaXIgZXF1aXZhbGVudCBsaW5lYXIgY291bnRlcnBhcnRzLiBJbnRlcnBvbGF0ZSB0aGVzZSxcclxuICAgICAgICAgICAgLy8gdGhlbiBjb252ZXJ0IHRvIHRoZSBlcXVpdmFsZW50IGd1ZGVybWFubmlhbiBjb29yZGluYXRlLlxyXG4gICAgICAgICAgICBsaW5Ob3J0aCA9IGd1ZGVybWFubmlhblRvTGluZWFyKG5vcnRoKSxcclxuICAgICAgICAgICAgbGluU291dGggPSBndWRlcm1hbm5pYW5Ub0xpbmVhcihzb3V0aCksXHJcbiAgICAgICAgICAgIGNlbnRlclkgPSBsaW5lYXJUb0d1ZGVybWFubmlhbiggKGxpbk5vcnRoK2xpblNvdXRoKS8yLjAgKTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBtaW5YOiAgICB3ZXN0LFxyXG4gICAgICAgICAgICBtaW5ZOiAgICBzb3V0aCxcclxuICAgICAgICAgICAgbWF4WDogICAgZWFzdCxcclxuICAgICAgICAgICAgbWF4WTogICAgbm9ydGgsXHJcbiAgICAgICAgICAgIGNlbnRlclg6IChlYXN0K3dlc3QpLzIuMCxcclxuICAgICAgICAgICAgY2VudGVyWTogY2VudGVyWSxcclxuICAgICAgICAgICAgd2lkdGg6ICAgKGVhc3Qtd2VzdCksXHJcbiAgICAgICAgICAgIGhlaWdodDogIChub3J0aC1zb3V0aClcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuXHJcbiAgICBXZWJNZXJjYXRvclRpbGVQeXJhbWlkLnByb3RvdHlwZS5nZXRCaW5Cb3VuZHMgPSBmdW5jdGlvbiggdGlsZSwgYmluICkge1xyXG4gICAgICAgIHZhciBsZXZlbCAgID0gdGlsZS5sZXZlbCxcclxuICAgICAgICAgICAgYmluWEluYyA9IDEuMCAvIHRpbGUueEJpbkNvdW50LFxyXG4gICAgICAgICAgICBiYXNlWCAgID0gdGlsZS54SW5kZXggKyBiaW4ueCAqIGJpblhJbmMsXHJcbiAgICAgICAgICAgIGJpbllJbmMgPSAxLjAgLyB0aWxlLnlCaW5Db3VudCxcclxuICAgICAgICAgICAgYmFzZVkgICA9IHRpbGUueUluZGV4ICsgKHRpbGUueUJpbkNvdW50IC0gMSAtIGJpbi55KSAqIGJpbllJbmMsXHJcbiAgICAgICAgICAgIG5vcnRoICAgPSB0aWxlVG9MYXQoYmFzZVkgKyBiaW5ZSW5jLCBsZXZlbCksXHJcbiAgICAgICAgICAgIHNvdXRoICAgPSB0aWxlVG9MYXQoYmFzZVksIGxldmVsKSxcclxuICAgICAgICAgICAgZWFzdCAgICA9IHRpbGVUb0xvbihiYXNlWCArIGJpblhJbmMsIGxldmVsKSxcclxuICAgICAgICAgICAgd2VzdCAgICA9IHRpbGVUb0xvbihiYXNlWCwgbGV2ZWwpLFxyXG4gICAgICAgICAgICAvLyBhcyBtZXJjYXRvciBsYXRpdHVkZSBjYW5ub3QgYmUgbGluZWFybHkgaW50ZXJwb2xhdGVkLCBjb252ZXJ0IHRoZSBndWRlcm1hbm5pYW5cclxuICAgICAgICAgICAgLy8gY29vcmRpbmF0ZXMgYmFjayBpbnRvIHRoZWlyIGVxdWl2YWxlbnQgbGluZWFyIGNvdW50ZXJwYXJ0cy4gSW50ZXJwb2xhdGUgdGhlc2UsXHJcbiAgICAgICAgICAgIC8vIHRoZW4gY29udmVydCB0byB0aGUgZXF1aXZhbGVudCBndWRlcm1hbm5pYW4gY29vcmRpbmF0ZS5cclxuICAgICAgICAgICAgbGluTm9ydGggPSBndWRlcm1hbm5pYW5Ub0xpbmVhcihub3J0aCksXHJcbiAgICAgICAgICAgIGxpblNvdXRoID0gZ3VkZXJtYW5uaWFuVG9MaW5lYXIoc291dGgpLFxyXG4gICAgICAgICAgICBjZW50ZXJZID0gbGluZWFyVG9HdWRlcm1hbm5pYW4oIChsaW5Ob3J0aCtsaW5Tb3V0aCkvMi4wICk7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgbWluWDogICAgd2VzdCxcclxuICAgICAgICAgICAgbWluWTogICAgc291dGgsXHJcbiAgICAgICAgICAgIG1heFg6ICAgIGVhc3QsXHJcbiAgICAgICAgICAgIG1heFk6ICAgIG5vcnRoLFxyXG4gICAgICAgICAgICBjZW50ZXJYOiAoZWFzdCt3ZXN0KS8yLjAsXHJcbiAgICAgICAgICAgIGNlbnRlclk6IGNlbnRlclksXHJcbiAgICAgICAgICAgIHdpZHRoOiAgIChlYXN0LXdlc3QpLFxyXG4gICAgICAgICAgICBoZWlnaHQ6ICAobm9ydGgtc291dGgpXHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcblxyXG4gICAgV2ViTWVyY2F0b3JUaWxlUHlyYW1pZC5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIFwidHlwZVwiOiBcIldlYk1lcmNhdG9yXCJcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuXHJcblx0bW9kdWxlLmV4cG9ydHMgPSBXZWJNZXJjYXRvclRpbGVQeXJhbWlkO1xyXG59KCkpO1xyXG5cclxuIiwiLypcclxuICogQ29weXJpZ2h0IChjKSAyMDE0IE9jdWx1cyBJbmZvIEluYy5cclxuICogaHR0cDovL3d3dy5vY3VsdXNpbmZvLmNvbS9cclxuICpcclxuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKlxyXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5IG9mXHJcbiAqIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW5cclxuICogdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0b1xyXG4gKiB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllc1xyXG4gKiBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG9cclxuICogc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxyXG5cclxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsXHJcbiAqIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXHJcblxyXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXHJcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxyXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcclxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxyXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxyXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRVxyXG4gKiBTT0ZUV0FSRS5cclxuICovXHJcblxyXG4oIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIHZhciBPcGVuTGF5ZXJzID0gcmVxdWlyZSgnLi4vb3BlbmxheWVycy9PcGVuTGF5ZXJzLm1pbicpLFxyXG4gICAgICAgICQgPSByZXF1aXJlKCdqcXVlcnknKSxcclxuICAgICAgICBMYXllciA9IHJlcXVpcmUoJy4vTGF5ZXInKSxcclxuICAgICAgICBMYXllclV0aWwgPSByZXF1aXJlKCcuL0xheWVyVXRpbCcpLFxyXG4gICAgICAgIEFubm90YXRpb25TZXJ2aWNlID0gcmVxdWlyZSgnLi4vcmVzdC9Bbm5vdGF0aW9uU2VydmljZScpLFxyXG4gICAgICAgIEh0bWxUaWxlTGF5ZXIgPSByZXF1aXJlKCcuL0h0bWxUaWxlTGF5ZXInKSxcclxuICAgICAgICBQdWJTdWIgPSByZXF1aXJlKCcuLi91dGlsL1B1YlN1YicpO1xyXG5cclxuICAgIGZ1bmN0aW9uIEFubm90YXRpb25MYXllciggc3BlYyApIHtcclxuICAgICAgICAvLyBzZXQgcmVhc29uYWJsZSBkZWZhdWx0c1xyXG4gICAgICAgIHNwZWMuZW5hYmxlZCA9ICggc3BlYy5lbmFibGVkICE9PSB1bmRlZmluZWQgKSA/IHNwZWMuZW5hYmxlZCA6IHRydWU7XHJcbiAgICAgICAgc3BlYy5vcGFjaXR5ID0gKCBzcGVjLm9wYWNpdHkgIT09IHVuZGVmaW5lZCApID8gc3BlYy5vcGFjaXR5IDogMS4wO1xyXG4gICAgICAgIHNwZWMuekluZGV4ID0gKCBzcGVjLnpJbmRleCAhPT0gdW5kZWZpbmVkICkgPyBzcGVjLnpJbmRleCA6IDUwMDtcclxuICAgICAgICBzcGVjLmRvbWFpbiA9IFwiYW5ub3RhdGlvblwiO1xyXG4gICAgICAgIC8vIGNhbGwgYmFzZSBjb25zdHJ1Y3RvciAgICBcclxuICAgICAgICBMYXllci5jYWxsKCB0aGlzLCBzcGVjICk7XHJcbiAgICB9XHJcblxyXG4gICAgQW5ub3RhdGlvbkxheWVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoIExheWVyLnByb3RvdHlwZSApO1xyXG5cclxuICAgIEFubm90YXRpb25MYXllci5wcm90b3R5cGUuYWN0aXZhdGUgPSBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgLy8gYWRkIHRoZSBuZXcgbGF5ZXJcclxuICAgICAgICB0aGlzLm9sTGF5ZXIgPSBuZXcgSHRtbFRpbGVMYXllcihcclxuICAgICAgICAgICAgJ0Fubm90YXRpb24gVGlsZSBMYXllcicsXHJcbiAgICAgICAgICAgIHRoaXMuc3BlYy5zb3VyY2UudG1zLFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBsYXllcm5hbWU6IHRoaXMuc3BlYy5zb3VyY2UuaWQsXHJcbiAgICAgICAgICAgICAgICB0eXBlOiAnanNvbicsXHJcbiAgICAgICAgICAgICAgICBtYXhFeHRlbnQ6IG5ldyBPcGVuTGF5ZXJzLkJvdW5kcygtMjAwMzc1MDAsIC0yMDAzNzUwMCxcclxuICAgICAgICAgICAgICAgICAgICAyMDAzNzUwMCwgIDIwMDM3NTAwKSxcclxuICAgICAgICAgICAgICAgIGlzQmFzZUxheWVyOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIGdldFVSTDogTGF5ZXJVdGlsLmdldFVSTCxcclxuICAgICAgICAgICAgICAgIGh0bWw6IHRoaXMuc3BlYy5odG1sLFxyXG4gICAgICAgICAgICAgICAgcmVuZGVyZXI6IHRoaXMuc3BlYy5yZW5kZXJlcixcclxuICAgICAgICAgICAgICAgIGVudHJ5OiB0aGlzLnNwZWMuZW50cnlcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMubWFwLm9sTWFwLmFkZExheWVyKCB0aGlzLm9sTGF5ZXIgKTtcclxuXHJcbiAgICAgICAgdGhpcy5zZXRaSW5kZXgoIHRoaXMuc3BlYy56SW5kZXggKTtcclxuICAgICAgICB0aGlzLnNldE9wYWNpdHkoIHRoaXMuc3BlYy5vcGFjaXR5ICk7XHJcbiAgICAgICAgdGhpcy5zZXRWaXNpYmlsaXR5KCB0aGlzLnNwZWMuZW5hYmxlZCApO1xyXG4gICAgICAgIHRoaXMuc2V0VGhlbWUoIHRoaXMubWFwLmdldFRoZW1lKCkgKTtcclxuXHJcbiAgICAgICAgaWYgKCB0aGlzLnNwZWMucmVuZGVyZXIgKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3BlYy5yZW5kZXJlci5tZXRhID0gdGhpcy5zcGVjLnNvdXJjZS5tZXRhLm1ldGE7XHJcbiAgICAgICAgICAgIHRoaXMuc3BlYy5yZW5kZXJlci5tYXAgPSB0aGlzLm1hcDtcclxuICAgICAgICAgICAgdGhpcy5zcGVjLnJlbmRlcmVyLnBhcmVudCA9IHRoaXM7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBBbm5vdGF0aW9uTGF5ZXIucHJvdG90eXBlLmRlYWN0aXZhdGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoIHRoaXMub2xMYXllciApIHtcclxuICAgICAgICAgICAgdGhpcy5tYXAub2xNYXAucmVtb3ZlTGF5ZXIoIHRoaXMub2xMYXllciApO1xyXG4gICAgICAgICAgICB0aGlzLm9sTGF5ZXIuZGVzdHJveSgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBVcGRhdGVzIHRoZSB0aGVtZSBhc3NvY2lhdGVkIHdpdGggdGhlIGxheWVyXHJcbiAgICAgKi9cclxuICAgIEFubm90YXRpb25MYXllci5wcm90b3R5cGUuc2V0VGhlbWUgPSBmdW5jdGlvbiggdGhlbWUgKSB7XHJcbiAgICAgICAgdGhpcy5zcGVjLnRoZW1lID0gdGhlbWU7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0IHRoZSBjdXJyZW50IHRoZW1lIGZvciB0aGUgbGF5ZXJcclxuICAgICAqL1xyXG4gICAgQW5ub3RhdGlvbkxheWVyLnByb3RvdHlwZS5nZXRUaGVtZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNwZWMudGhlbWU7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHpJbmRleCAtIFRoZSBuZXcgei1vcmRlciB2YWx1ZSBvZiB0aGUgbGF5ZXIsIHdoZXJlIDAgaXMgZnJvbnQuXHJcbiAgICAgKi9cclxuICAgIEFubm90YXRpb25MYXllci5wcm90b3R5cGUuc2V0WkluZGV4ID0gZnVuY3Rpb24gKCB6SW5kZXggKSB7XHJcbiAgICAgICAgLy8gd2UgYnktcGFzcyB0aGUgT3BlbkxheWVycy5NYXAuc2V0TGF5ZXJJbmRleCgpIG1ldGhvZCBhbmQgbWFudWFsbHlcclxuICAgICAgICAvLyBzZXQgdGhlIHotaW5kZXggb2YgdGhlIGxheWVyIGRldi4gc2V0TGF5ZXJJbmRleCBzZXRzIGEgcmVsYXRpdmVcclxuICAgICAgICAvLyBpbmRleCBiYXNlZCBvbiBjdXJyZW50IG1hcCBsYXllcnMsIHdoaWNoIHRoZW4gc2V0cyBhIHotaW5kZXguIFRoaXNcclxuICAgICAgICAvLyBjYXVzZWQgaXNzdWVzIHdpdGggYXN5bmMgbGF5ZXIgbG9hZGluZy5cclxuICAgICAgICB0aGlzLnNwZWMuekluZGV4ID0gekluZGV4O1xyXG4gICAgICAgICQoIHRoaXMub2xMYXllci5kaXYgKS5jc3MoICd6LWluZGV4JywgekluZGV4ICk7XHJcbiAgICAgICAgUHViU3ViLnB1Ymxpc2goIHRoaXMuZ2V0Q2hhbm5lbCgpLCB7IGZpZWxkOiAnekluZGV4JywgdmFsdWU6IHpJbmRleCB9KTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgdGhlIGxheWVycyB6SW5kZXhcclxuICAgICAqL1xyXG4gICAgQW5ub3RhdGlvbkxheWVyLnByb3RvdHlwZS5nZXRaSW5kZXggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc3BlYy56SW5kZXg7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlIHRoZSBhIG5ldyBhbm5vdGF0aW9uXHJcbiAgICAgKi9cclxuICAgIEFubm90YXRpb25MYXllci5wcm90b3R5cGUud3JpdGUgPSBmdW5jdGlvbiggcG9zaXRpb24gKSB7XHJcblxyXG4gICAgICAgIHZhciB0aGF0ID0gdGhpcyxcclxuICAgICAgICAgICAgY29vcmQ7XHJcblxyXG4gICAgICAgIC8vIHRlbXAgZm9yIGRlYnVnIHdyaXRpbmdcclxuICAgICAgICBmdW5jdGlvbiBERUJVR19BTk5PVEFUSU9OKCBjb29yZCApIHtcclxuICAgICAgICAgICAgdmFyIHJhbmRvbUdyb3VwSW5kZXggPSBNYXRoLmZsb29yKCB0aGF0LnNwZWMuZ3JvdXBzLmxlbmd0aCpNYXRoLnJhbmRvbSgpICk7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICB4OiBjb29yZC54LFxyXG4gICAgICAgICAgICAgICAgeTogY29vcmQueSxcclxuICAgICAgICAgICAgICAgIGdyb3VwOiB0aGF0LnNwZWMuZ3JvdXBzWyByYW5kb21Hcm91cEluZGV4IF0sXHJcbiAgICAgICAgICAgICAgICByYW5nZToge1xyXG4gICAgICAgICAgICAgICAgICAgIG1pbjogMCxcclxuICAgICAgICAgICAgICAgICAgICBtYXg6IHRoYXQubWFwLmdldFpvb20oKVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGxldmVsOiB0aGF0Lm1hcC5nZXRab29tKCksXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7fVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gZ2V0IHBvc2l0aW9uIGFuZCB0aWxla2V5IGZvciBhbm5vdGF0aW9uXHJcbiAgICAgICAgY29vcmQgPSB0aGlzLm1hcC5nZXRDb29yZEZyb21WaWV3cG9ydFBpeGVsKCBwb3NpdGlvbi54LCBwb3NpdGlvbi55ICk7XHJcblxyXG4gICAgICAgIC8vIHdyaXRlIGFubm90YXRpb25cclxuICAgICAgICBBbm5vdGF0aW9uU2VydmljZS53cml0ZUFubm90YXRpb24oXHJcbiAgICAgICAgICAgIHRoaXMuc3BlYy5zb3VyY2UuaWQsXHJcbiAgICAgICAgICAgIERFQlVHX0FOTk9UQVRJT04oIGNvb3JkICksXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAvLyBUT0RPOiByZWZyZXNoIHRpbGVcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBNb2RpZnkgYW4gZXhpc3RpbmcgYW5ub3RhdGlvblxyXG4gICAgICovXHJcbiAgICBBbm5vdGF0aW9uTGF5ZXIucHJvdG90eXBlLm1vZGlmeSA9IGZ1bmN0aW9uKCBhbm5vdGF0aW9uICkge1xyXG4gICAgICAgIEFubm90YXRpb25TZXJ2aWNlLm1vZGlmeUFubm90YXRpb24oXHJcbiAgICAgICAgICAgIHRoaXMuc3BlYy5zb3VyY2UuaWQsXHJcbiAgICAgICAgICAgIGFubm90YXRpb24sXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAvLyBUT0RPOiByZWZyZXNoIHRpbGVcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZW1vdmUgYW4gZXhpc3RpbmcgYW5ub3RhdGlvbi5cclxuICAgICAqL1xyXG4gICAgQW5ub3RhdGlvbkxheWVyLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiggYW5ub3RhdGlvbiApIHtcclxuICAgICAgICBBbm5vdGF0aW9uU2VydmljZS5yZW1vdmVBbm5vdGF0aW9uKFxyXG4gICAgICAgICAgICB0aGlzLnNwZWMuc291cmNlLmlkLFxyXG4gICAgICAgICAgICBhbm5vdGF0aW9uLmNlcnRpZmljYXRlLFxyXG4gICAgICAgICAgICBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgLy8gVE9ETzogcmVmcmVzaCB0aWxlXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIG1vZHVsZS5leHBvcnRzID0gQW5ub3RhdGlvbkxheWVyO1xyXG59KCkpO1xyXG4iLCIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgT2N1bHVzIEluZm8gSW5jLlxyXG4gKiBodHRwOi8vd3d3Lm9jdWx1c2luZm8uY29tL1xyXG4gKlxyXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXHJcbiAqXHJcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkgb2ZcclxuICogdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpblxyXG4gKiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvXHJcbiAqIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzXHJcbiAqIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkb1xyXG4gKiBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XHJcblxyXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbiBhbGxcclxuICogY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cclxuXHJcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcclxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXHJcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxyXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXHJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXHJcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFXHJcbiAqIFNPRlRXQVJFLlxyXG4gKi9cclxuXHJcbi8qZ2xvYmFsIGdvb2dsZSAqL1xyXG4oIGZ1bmN0aW9uKCkge1xyXG5cclxuXHRcInVzZSBzdHJpY3RcIjtcclxuXHJcblx0dmFyIE9wZW5MYXllcnMgPSByZXF1aXJlKCcuLi9vcGVubGF5ZXJzL09wZW5MYXllcnMubWluJyksXHJcbiAgICAgICAgTGF5ZXIgPSByZXF1aXJlKCcuL0xheWVyJyk7XHJcbiAgICAgICAgXHJcblx0ZnVuY3Rpb24gQmFzZUxheWVyKCBzcGVjICkge1xyXG4gICAgICAgIC8vIHNldCBkZWZhdWx0c1xyXG4gICAgICAgIHNwZWMgPSBzcGVjIHx8IHt9O1xyXG4gICAgICAgIHNwZWMub3BhY2l0eSA9ICggc3BlYy5vcGFjaXR5ICE9PSB1bmRlZmluZWQgKSA/IHNwZWMub3BhY2l0eSA6IDEuMDtcclxuICAgICAgICBzcGVjLmVuYWJsZWQgPSAoIHNwZWMuZW5hYmxlZCAhPT0gdW5kZWZpbmVkICkgPyBzcGVjLmVuYWJsZWQgOiB0cnVlO1xyXG4gICAgICAgIHNwZWMudHlwZSA9IHNwZWMudHlwZSB8fCBcIkJsYW5rXCI7XHJcbiAgICAgICAgc3BlYy5vcHRpb25zID0gc3BlYy5vcHRpb25zIHx8IHtcclxuICAgICAgICAgICAgbmFtZSA6IFwiYmxhY2tcIixcclxuICAgICAgICAgICAgY29sb3IgOiBcInJnYigwLDAsMClcIlxyXG4gICAgICAgIH07XHJcbiAgICAgICAgc3BlYy5kb21haW4gPSBcImJhc2VcIjtcclxuICAgICAgICAvLyBjYWxsIGJhc2UgY29uc3RydWN0b3JcclxuICAgICAgICBMYXllci5jYWxsKCB0aGlzLCBzcGVjICk7XHJcbiAgICB9XHJcblxyXG4gICAgQmFzZUxheWVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoIExheWVyLnByb3RvdHlwZSApO1xyXG5cclxuICAgIEJhc2VMYXllci5wcm90b3R5cGUuYWN0aXZhdGUgPSBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgdmFyIHNwZWMgPSB0aGlzLnNwZWMsXHJcbiAgICAgICAgICAgIHN0eWxlZE1hcFR5cGU7XHJcblxyXG4gICAgICAgIHN3aXRjaCAoIHRoaXMuc3BlYy50eXBlICkge1xyXG5cclxuICAgICAgICAgICAgY2FzZSBcIkJsYW5rXCI6XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5vbExheWVyID0gbmV3IE9wZW5MYXllcnMuTGF5ZXIuVmVjdG9yKCBcIkJhc2VMYXllclwiLCB7fSApO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tYXAuZ2V0RWxlbWVudCgpLnN0eWxlWydiYWNrZ3JvdW5kLWNvbG9yJ10gPSBzcGVjLm9wdGlvbnMuY29sb3I7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgIGNhc2UgXCJHb29nbGVcIjpcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLm9sTGF5ZXIgPSBuZXcgT3BlbkxheWVycy5MYXllci5Hb29nbGUoIFwiQmFzZUxheWVyXCIsIHNwZWMub3B0aW9ucyApO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICBjYXNlIFwiVE1TXCI6XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5vbExheWVyID0gbmV3IE9wZW5MYXllcnMuTGF5ZXIuVE1TKCBcIkJhc2VMYXllclwiLCBzcGVjLnVybCwgc3BlYy5vcHRpb25zICk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMubWFwLm9sTWFwLmFkZExheWVyKCB0aGlzLm9sTGF5ZXIgKTtcclxuICAgICAgICB0aGlzLm1hcC5vbE1hcC5zZXRCYXNlTGF5ZXIoIHRoaXMub2xMYXllciApO1xyXG5cclxuICAgICAgICBpZiAoIHNwZWMub3B0aW9ucy50eXBlID09PSAnc3R5bGVkJyApIHtcclxuICAgICAgICAgICAgc3R5bGVkTWFwVHlwZSA9IG5ldyBnb29nbGUubWFwcy5TdHlsZWRNYXBUeXBlKCBzcGVjLm9wdGlvbnMuc3R5bGUsIHtuYW1lOiAnU3R5bGVkIE1hcCd9ICk7XHJcbiAgICAgICAgICAgIHRoaXMub2xMYXllci5tYXBPYmplY3QubWFwVHlwZXMuc2V0KCAnc3R5bGVkJywgc3R5bGVkTWFwVHlwZSApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gZW5zdXJlIGJhc2VsYXllciByZW1haW5zIGJvdHRvbSBsYXllclxyXG4gICAgICAgIHRoaXMubWFwLm9sTWFwLnNldExheWVySW5kZXgoIHRoaXMub2xMYXllciwgLTEgKTtcclxuXHJcbiAgICAgICAgdGhpcy5zZXRPcGFjaXR5KCB0aGlzLmdldE9wYWNpdHkoKSApO1xyXG4gICAgICAgIHRoaXMuc2V0VmlzaWJpbGl0eSggdGhpcy5nZXRWaXNpYmlsaXR5KCkgKTtcclxuICAgIH07XHJcblxyXG4gICAgQmFzZUxheWVyLnByb3RvdHlwZS5kZWFjdGl2YXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKCB0aGlzLm9sTGF5ZXIgKSB7XHJcbiAgICAgICAgICAgIHRoaXMubWFwLm9sTWFwLnJlbW92ZUxheWVyKCB0aGlzLm9sTGF5ZXIgKTtcclxuICAgICAgICAgICAgdGhpcy5vbExheWVyLmRlc3Ryb3koKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5tYXAuZ2V0RWxlbWVudCgpLnN0eWxlWydiYWNrZ3JvdW5kLWNvbG9yJ10gPSAnJztcclxuICAgIH07XHJcblxyXG5cdG1vZHVsZS5leHBvcnRzID0gQmFzZUxheWVyO1xyXG59KCkpO1xyXG4iLCIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgT2N1bHVzIEluZm8gSW5jLlxyXG4gKiBodHRwOi8vd3d3Lm9jdWx1c2luZm8uY29tL1xyXG4gKlxyXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXHJcbiAqXHJcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkgb2ZcclxuICogdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpblxyXG4gKiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvXHJcbiAqIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzXHJcbiAqIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkb1xyXG4gKiBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XHJcblxyXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbiBhbGxcclxuICogY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cclxuXHJcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcclxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXHJcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxyXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXHJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXHJcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFXHJcbiAqIFNPRlRXQVJFLlxyXG4gKi9cclxuXHJcbiggZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgdmFyIE9wZW5MYXllcnMgPSByZXF1aXJlKCcuLi9vcGVubGF5ZXJzL09wZW5MYXllcnMubWluJyksXHJcbiAgICAgICAgJCA9IHJlcXVpcmUoJ2pxdWVyeScpLFxyXG4gICAgICAgIExheWVyID0gcmVxdWlyZSgnLi9MYXllcicpLFxyXG4gICAgICAgIExheWVyVXRpbCA9IHJlcXVpcmUoJy4vTGF5ZXJVdGlsJyksXHJcbiAgICAgICAgSHRtbFRpbGVMYXllciA9IHJlcXVpcmUoJy4vSHRtbFRpbGVMYXllcicpLFxyXG4gICAgICAgIFB1YlN1YiA9IHJlcXVpcmUoJy4uL3V0aWwvUHViU3ViJyk7XHJcblxyXG4gICAgZnVuY3Rpb24gQ2xpZW50TGF5ZXIoIHNwZWMgKSB7XHJcbiAgICAgICAgLy8gc2V0IHJlYXNvbmFibGUgZGVmYXVsdHNcclxuICAgICAgICBzcGVjLmVuYWJsZWQgPSAoIHNwZWMuZW5hYmxlZCAhPT0gdW5kZWZpbmVkICkgPyBzcGVjLmVuYWJsZWQgOiB0cnVlO1xyXG4gICAgICAgIHNwZWMub3BhY2l0eSA9ICggc3BlYy5vcGFjaXR5ICE9PSB1bmRlZmluZWQgKSA/IHNwZWMub3BhY2l0eSA6IDEuMDtcclxuICAgICAgICBzcGVjLnpJbmRleCA9ICggc3BlYy56SW5kZXggIT09IHVuZGVmaW5lZCApID8gc3BlYy56SW5kZXggOiAxMDAwO1xyXG4gICAgICAgIHNwZWMuZG9tYWluID0gXCJjbGllbnRcIjtcclxuICAgICAgICAvLyBjYWxsIGJhc2UgY29uc3RydWN0b3IgICAgXHJcbiAgICAgICAgTGF5ZXIuY2FsbCggdGhpcywgc3BlYyApO1xyXG4gICAgfVxyXG5cclxuICAgIENsaWVudExheWVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoIExheWVyLnByb3RvdHlwZSApO1xyXG5cclxuICAgIENsaWVudExheWVyLnByb3RvdHlwZS5hY3RpdmF0ZSA9IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAvLyBhZGQgdGhlIG5ldyBsYXllclxyXG4gICAgICAgIHRoaXMub2xMYXllciA9IG5ldyBIdG1sVGlsZUxheWVyKFxyXG4gICAgICAgICAgICAnQ2xpZW50IFJlbmRlcmVkIFRpbGUgTGF5ZXInLFxyXG4gICAgICAgICAgICB0aGlzLnNwZWMuc291cmNlLnRtcyxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgbGF5ZXJuYW1lOiB0aGlzLnNwZWMuc291cmNlLmlkLFxyXG4gICAgICAgICAgICAgICAgdHlwZTogJ2pzb24nLFxyXG4gICAgICAgICAgICAgICAgbWF4RXh0ZW50OiBuZXcgT3BlbkxheWVycy5Cb3VuZHMoLTIwMDM3NTAwLCAtMjAwMzc1MDAsXHJcbiAgICAgICAgICAgICAgICAgICAgMjAwMzc1MDAsICAyMDAzNzUwMCksXHJcbiAgICAgICAgICAgICAgICBpc0Jhc2VMYXllcjogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBnZXRVUkw6IExheWVyVXRpbC5nZXRVUkwsXHJcbiAgICAgICAgICAgICAgICBodG1sOiB0aGlzLnNwZWMuaHRtbCxcclxuICAgICAgICAgICAgICAgIHJlbmRlcmVyOiB0aGlzLnNwZWMucmVuZGVyZXIsXHJcbiAgICAgICAgICAgICAgICBlbnRyeTogdGhpcy5zcGVjLmVudHJ5XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLm1hcC5vbE1hcC5hZGRMYXllciggdGhpcy5vbExheWVyICk7XHJcblxyXG4gICAgICAgIHRoaXMuc2V0WkluZGV4KCB0aGlzLnNwZWMuekluZGV4ICk7XHJcbiAgICAgICAgdGhpcy5zZXRPcGFjaXR5KCB0aGlzLnNwZWMub3BhY2l0eSApO1xyXG4gICAgICAgIHRoaXMuc2V0VmlzaWJpbGl0eSggdGhpcy5zcGVjLmVuYWJsZWQgKTtcclxuICAgICAgICB0aGlzLnNldFRoZW1lKCB0aGlzLm1hcC5nZXRUaGVtZSgpICk7XHJcblxyXG4gICAgICAgIGlmICggdGhpcy5zcGVjLnJlbmRlcmVyICkge1xyXG4gICAgICAgICAgICB0aGlzLnNwZWMucmVuZGVyZXIubWV0YSA9IHRoaXMuc3BlYy5zb3VyY2UubWV0YS5tZXRhO1xyXG4gICAgICAgICAgICB0aGlzLnNwZWMucmVuZGVyZXIubWFwID0gdGhpcy5tYXA7XHJcbiAgICAgICAgICAgIHRoaXMuc3BlYy5yZW5kZXJlci5wYXJlbnQgPSB0aGlzO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgQ2xpZW50TGF5ZXIucHJvdG90eXBlLmRlYWN0aXZhdGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoIHRoaXMub2xMYXllciApIHtcclxuICAgICAgICAgICAgdGhpcy5tYXAub2xNYXAucmVtb3ZlTGF5ZXIoIHRoaXMub2xMYXllciApO1xyXG4gICAgICAgICAgICB0aGlzLm9sTGF5ZXIuZGVzdHJveSgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBVcGRhdGVzIHRoZSB0aGVtZSBhc3NvY2lhdGVkIHdpdGggdGhlIGxheWVyXHJcbiAgICAgKi9cclxuICAgIENsaWVudExheWVyLnByb3RvdHlwZS5zZXRUaGVtZSA9IGZ1bmN0aW9uKCB0aGVtZSApIHtcclxuICAgICAgICB0aGlzLnNwZWMudGhlbWUgPSB0aGVtZTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgdGhlIGN1cnJlbnQgdGhlbWUgZm9yIHRoZSBsYXllclxyXG4gICAgICovXHJcbiAgICBDbGllbnRMYXllci5wcm90b3R5cGUuZ2V0VGhlbWUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zcGVjLnRoZW1lO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBwYXJhbSB6SW5kZXgge251bWJlcn0gVGhlIG5ldyB6LW9yZGVyIHZhbHVlIG9mIHRoZSBsYXllciwgd2hlcmUgMCBpcyBmcm9udC5cclxuICAgICAqL1xyXG4gICAgQ2xpZW50TGF5ZXIucHJvdG90eXBlLnNldFpJbmRleCA9IGZ1bmN0aW9uICggekluZGV4ICkge1xyXG4gICAgICAgIC8vIHdlIGJ5LXBhc3MgdGhlIE9wZW5MYXllcnMuTWFwLnNldExheWVySW5kZXgoKSBtZXRob2QgYW5kIG1hbnVhbGx5XHJcbiAgICAgICAgLy8gc2V0IHRoZSB6LWluZGV4IG9mIHRoZSBsYXllciBkZXYuIHNldExheWVySW5kZXggc2V0cyBhIHJlbGF0aXZlXHJcbiAgICAgICAgLy8gaW5kZXggYmFzZWQgb24gY3VycmVudCBtYXAgbGF5ZXJzLCB3aGljaCB0aGVuIHNldHMgYSB6LWluZGV4LiBUaGlzXHJcbiAgICAgICAgLy8gY2F1c2VkIGlzc3VlcyB3aXRoIGFzeW5jIGxheWVyIGxvYWRpbmcuXHJcbiAgICAgICAgdGhpcy5zcGVjLnpJbmRleCA9IHpJbmRleDtcclxuICAgICAgICAkKCB0aGlzLm9sTGF5ZXIuZGl2ICkuY3NzKCAnei1pbmRleCcsIHpJbmRleCApO1xyXG4gICAgICAgIFB1YlN1Yi5wdWJsaXNoKCB0aGlzLmdldENoYW5uZWwoKSwgeyBmaWVsZDogJ3pJbmRleCcsIHZhbHVlOiB6SW5kZXggfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0IHRoZSBsYXllcnMgekluZGV4XHJcbiAgICAgKi9cclxuICAgIENsaWVudExheWVyLnByb3RvdHlwZS5nZXRaSW5kZXggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc3BlYy56SW5kZXg7XHJcbiAgICB9O1xyXG5cclxuICAgIG1vZHVsZS5leHBvcnRzID0gQ2xpZW50TGF5ZXI7XHJcbn0oKSk7XHJcbiIsIi8qXHJcbiAqIENvcHlyaWdodCAoYykgMjAxNCBPY3VsdXMgSW5mbyBJbmMuXHJcbiAqIGh0dHA6Ly93d3cub2N1bHVzaW5mby5jb20vXHJcbiAqXHJcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuICpcclxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weSBvZlxyXG4gKiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluXHJcbiAqIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG9cclxuICogdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXNcclxuICogb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvXHJcbiAqIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcclxuXHJcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbFxyXG4gKiBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxyXG5cclxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxyXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXHJcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcclxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEVcclxuICogU09GVFdBUkUuXHJcbiAqL1xyXG5cclxuLypnbG9iYWwgSFRNTEVsZW1lbnQgKi9cclxuKCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICB2YXIgT3BlbkxheWVycyA9IHJlcXVpcmUoJy4uL29wZW5sYXllcnMvT3BlbkxheWVycy5taW4nKSxcclxuICAgICAgICAkID0gcmVxdWlyZSgnanF1ZXJ5Jyk7XHJcblxyXG4gICAgT3BlbkxheWVycy5UaWxlLkhUTUwgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICBPcGVuTGF5ZXJzLlRpbGUuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApO1xyXG4gICAgfTtcclxuXHJcbiAgICBPcGVuTGF5ZXJzLlRpbGUuSFRNTC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKCBPcGVuTGF5ZXJzLlRpbGUucHJvdG90eXBlICk7XHJcblxyXG4gICAgT3BlbkxheWVycy5UaWxlLkhUTUwucHJvdG90eXBlLmRyYXcgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgdGhhdCA9IHRoaXMsXHJcbiAgICAgICAgICAgIHNob3VsZERyYXcgPSBPcGVuTGF5ZXJzLlRpbGUucHJvdG90eXBlLmRyYXcuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyksXHJcbiAgICAgICAgICAgIGRhdGFVcmw7XHJcbiAgICAgICAgaWYgKCBzaG91bGREcmF3ICkge1xyXG4gICAgICAgICAgICB0aGlzLnBvc2l0aW9uVGlsZSgpO1xyXG4gICAgICAgICAgICBkYXRhVXJsID0gdGhpcy5sYXllci5nZXRVUkwoIHRoaXMuYm91bmRzICk7XHJcbiAgICAgICAgICAgIGlmICggZGF0YVVybCAhPT0gdGhpcy51cmwgKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy51cmwgPSBkYXRhVXJsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50aWxlRGF0YSA9IG51bGw7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gbmV3IHVybCB0byByZW5kZXJcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzTG9hZGluZykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YVJlcXVlc3QuYWJvcnQoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFSZXF1ZXN0ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmlzTG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy51cmwpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnVubG9hZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvLyBoaWRlIHRpbGUgY29udGVudHMgdW50aWwgaGF2ZSBkYXRhXHJcbiAgICAgICAgICAgICAgICB0aGlzLmRpdi5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhUmVxdWVzdCA9ICQuYWpheCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB0aGlzLnVybFxyXG4gICAgICAgICAgICAgICAgfSkudGhlbihcclxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiggZGF0YSApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC50aWxlRGF0YSA9IGRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQucmVuZGVyVGlsZSggdGhhdC5kaXYsIHRoYXQudGlsZURhdGEgKTtcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCB4aHIsIHN0YXR1cywgZXJyb3IgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRPRE8gaGFuZGxlIGVycm9yXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICkuYWx3YXlzKCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGF0LmlzTG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoYXQuZGF0YVJlcXVlc3QgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gYWxyZWFkeSBoYXZlIHJpZ2h0IGRhdGEsIGp1c3QgcmVuZGVyXHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlclRpbGUoIHRoaXMuZGl2LCB0aGlzLnRpbGVEYXRhICk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSBlbHNlIGlmICggc2hvdWxkRHJhdyA9PT0gZmFsc2UgKSB7XHJcbiAgICAgICAgICAgIHRoaXMudW5sb2FkKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBzaG91bGREcmF3O1xyXG4gICAgfTtcclxuXHJcbiAgICBPcGVuTGF5ZXJzLlRpbGUuSFRNTC5wcm90b3R5cGUucG9zaXRpb25UaWxlID0gZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgIGlmICggIXRoaXMuZGl2ICkge1xyXG4gICAgICAgICAgICB0aGlzLmRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdkaXYnICk7XHJcbiAgICAgICAgICAgIHRoaXMuZGl2LnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcclxuICAgICAgICAgICAgdGhpcy5kaXYuY2xhc3NOYW1lID0gJ29sVGlsZUh0bWwnO1xyXG4gICAgICAgICAgICB0aGlzLmxheWVyLmRpdi5hcHBlbmRDaGlsZCggdGhpcy5kaXYgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBzdHlsZSA9IHRoaXMuZGl2LnN0eWxlLFxyXG4gICAgICAgICAgICBzaXplID0gdGhpcy5sYXllci5nZXRJbWFnZVNpemUoIHRoaXMuYm91bmRzICksXHJcbiAgICAgICAgICAgIHJhdGlvID0gMTtcclxuXHJcbiAgICAgICAgaWYgKCB0aGlzLmxheWVyIGluc3RhbmNlb2YgT3BlbkxheWVycy5MYXllci5HcmlkICkge1xyXG4gICAgICAgICAgICByYXRpbyA9IHRoaXMubGF5ZXIuZ2V0U2VydmVyUmVzb2x1dGlvbigpIC8gdGhpcy5sYXllci5tYXAuZ2V0UmVzb2x1dGlvbigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgc3R5bGUubGVmdCA9IHRoaXMucG9zaXRpb24ueCArICdweCc7XHJcbiAgICAgICAgc3R5bGUudG9wID0gdGhpcy5wb3NpdGlvbi55ICsgJ3B4JztcclxuICAgICAgICBzdHlsZS53aWR0aCA9IE1hdGgucm91bmQoIHJhdGlvICogc2l6ZS53ICkgKyAncHgnO1xyXG4gICAgICAgIHN0eWxlLmhlaWdodCA9IE1hdGgucm91bmQoIHJhdGlvICogc2l6ZS5oICkgKyAncHgnO1xyXG4gICAgfTtcclxuXHJcbiAgICBPcGVuTGF5ZXJzLlRpbGUuSFRNTC5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICBPcGVuTGF5ZXJzLlRpbGUucHJvdG90eXBlLmNsZWFyLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTtcclxuICAgICAgICB0aGlzLnRpbGVEYXRhID0gbnVsbDtcclxuICAgICAgICB0aGlzLnVybCA9IG51bGw7XHJcbiAgICAgICAgaWYgKCB0aGlzLmRpdiApIHtcclxuICAgICAgICAgICAgdGhpcy5sYXllci5kaXYucmVtb3ZlQ2hpbGQoIHRoaXMuZGl2ICk7XHJcbiAgICAgICAgICAgIHRoaXMuZGl2ID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIE9wZW5MYXllcnMuVGlsZS5IVE1MLnByb3RvdHlwZS5yZW5kZXJUaWxlID0gZnVuY3Rpb24oY29udGFpbmVyLCBkYXRhKSB7XHJcblxyXG4gICAgICAgIGlmICggIXRoaXMubGF5ZXIgfHwgIXRoaXMuZGl2IHx8ICFkYXRhLnRpbGUgKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciByZW5kZXJlciA9IHRoaXMubGF5ZXIucmVuZGVyZXIsXHJcbiAgICAgICAgICAgIGh0bWwgPSB0aGlzLmxheWVyLmh0bWwsXHJcbiAgICAgICAgICAgIHJlbmRlcixcclxuICAgICAgICAgICAgZW50cmllcyxcclxuICAgICAgICAgICAgZWxlbWVudHMsXHJcbiAgICAgICAgICAgIGk7XHJcblxyXG4gICAgICAgIGlmICggcmVuZGVyZXIgKSB7XHJcbiAgICAgICAgICAgIC8vIGlmIHJlbmRlcmVyIGlzIGF0dGFjaGVkLCB1c2UgaXRcclxuICAgICAgICAgICAgcmVuZGVyID0gcmVuZGVyZXIucmVuZGVyKCBkYXRhICk7XHJcbiAgICAgICAgICAgIGh0bWwgPSByZW5kZXIuaHRtbDtcclxuICAgICAgICAgICAgZW50cmllcyA9IHJlbmRlci5lbnRyaWVzO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIGVsc2UgZXhlY3V0ZSBodG1sXHJcbiAgICAgICAgICAgIGlmICggdHlwZW9mIGh0bWwgPT09IFwiZnVuY3Rpb25cIiApIHtcclxuICAgICAgICAgICAgICAgIGh0bWwgPSBodG1sKCBkYXRhICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICggaHRtbCBpbnN0YW5jZW9mICQgKSB7XHJcbiAgICAgICAgICAgIC8vIGlmIGdlbmVyYXRlZCBhIGpxdWVyeSBvYmplY3QsIGFwcGVuZCBpdFxyXG4gICAgICAgICAgICAkKCB0aGlzLmRpdiApLmFwcGVuZCggaHRtbCApO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoIGh0bWwgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCApIHtcclxuICAgICAgICAgICAgLy8gaWYgZ2VuZXJhdGVkIGFuIEhUTUxFbGVtZW50LCBnZXQgaHRtbCB0ZXh0XHJcbiAgICAgICAgICAgIHRoaXMuZGl2LmFwcGVuZENoaWxkKCBodG1sICk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gaWYgZ2VuZXJhdGVkIHN0cmluZywgc2V0IGlubmVyIGh0bWxcclxuICAgICAgICAgICAgdGhpcy5kaXYuaW5uZXJIVE1MID0gaHRtbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuZGl2LnN0eWxlLnZpc2liaWxpdHkgPSAnaW5oZXJpdCc7XHJcbiAgICAgICAgdGhpcy5kaXYuc3R5bGUub3BhY2l0eSA9ICdpbmhlcml0JztcclxuICAgICAgICB0aGlzLmRpdi5zdHlsZVsncG9pbnRlci1ldmVudHMnXSA9ICdub25lJztcclxuXHJcbiAgICAgICAgLy8gc2V0IHBvaW50ZXItZXZlbnRzIG9uIHRpbGUgZWxlbWVudHMgdG8gJ2FsbCdcclxuICAgICAgICBlbGVtZW50cyA9IHRoaXMuZGl2LmNoaWxkcmVuO1xyXG4gICAgICAgIGZvciAoIGk9MDsgaTxlbGVtZW50cy5sZW5ndGg7IGkrKyApIHtcclxuICAgICAgICAgICAgZWxlbWVudHNbaV0uc3R5bGVbJ3BvaW50ZXItZXZlbnRzJ10gPSAnYWxsJztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICggcmVuZGVyZXIgKSB7XHJcbiAgICAgICAgICAgIC8vIGlmIHJlbmRlcmVyIGlzIGF0dGFjaGVkLCBjYWxsIGhvb2sgZnVuY3Rpb25cclxuICAgICAgICAgICAgcmVuZGVyZXIuaG9vayggZWxlbWVudHMsIGVudHJpZXMsIGRhdGEgKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIG1vZHVsZS5leHBvcnRzID0gT3BlbkxheWVycy5UaWxlLkhUTUw7XHJcbn0oKSk7XHJcbiIsIi8qXHJcbiAqIENvcHlyaWdodCAoYykgMjAxNCBPY3VsdXMgSW5mbyBJbmMuXHJcbiAqIGh0dHA6Ly93d3cub2N1bHVzaW5mby5jb20vXHJcbiAqXHJcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuICpcclxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weSBvZlxyXG4gKiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluXHJcbiAqIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG9cclxuICogdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXNcclxuICogb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvXHJcbiAqIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcclxuXHJcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbFxyXG4gKiBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxyXG5cclxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxyXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXHJcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcclxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEVcclxuICogU09GVFdBUkUuXHJcbiAqL1xyXG5cclxuKCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICB2YXIgT3BlbkxheWVycyA9IHJlcXVpcmUoJy4uL29wZW5sYXllcnMvT3BlbkxheWVycy5taW4nKSxcclxuICAgICAgICBIdG1sVGlsZSA9IHJlcXVpcmUoJy4vSHRtbFRpbGUnKTtcclxuXHJcbiAgICBPcGVuTGF5ZXJzLkxheWVyLkhUTUwgPSBmdW5jdGlvbiggbmFtZSwgdXJsLCBvcHRpb25zICkge1xyXG4gICAgICAgIE9wZW5MYXllcnMuTGF5ZXIuR3JpZC5jYWxsKCB0aGlzLCBuYW1lLCB1cmwsIG9wdGlvbnMgKTtcclxuICAgICAgICB0aGlzLmdldFVSTCA9IG9wdGlvbnMuZ2V0VVJMO1xyXG4gICAgICAgIHRoaXMubGF5ZXJuYW1lID0gb3B0aW9ucy5sYXllcm5hbWU7XHJcbiAgICAgICAgdGhpcy50eXBlID0gb3B0aW9ucy50eXBlO1xyXG4gICAgICAgIHRoaXMudGlsZUNsYXNzID0gSHRtbFRpbGU7XHJcbiAgICAgICAgdGhpcy5odG1sID0gb3B0aW9ucy5odG1sO1xyXG4gICAgICAgIHRoaXMucmVuZGVyZXIgPSBvcHRpb25zLnJlbmRlcmVyO1xyXG4gICAgICAgIHRoaXMuQ0xBU1NfTkFNRSA9ICdPcGVuTGF5ZXJzLkxheWVyLkhUTUwnO1xyXG4gICAgfTtcclxuXHJcbiAgICBPcGVuTGF5ZXJzLkxheWVyLkhUTUwucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZSggT3BlbkxheWVycy5MYXllci5HcmlkLnByb3RvdHlwZSApO1xyXG5cclxuICAgIG1vZHVsZS5leHBvcnRzID0gT3BlbkxheWVycy5MYXllci5IVE1MO1xyXG59KCkpO1xyXG4iLCIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgT2N1bHVzIEluZm8gSW5jLlxyXG4gKiBodHRwOi8vd3d3Lm9jdWx1c2luZm8uY29tL1xyXG4gKlxyXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXHJcbiAqXHJcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkgb2ZcclxuICogdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpblxyXG4gKiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvXHJcbiAqIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzXHJcbiAqIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkb1xyXG4gKiBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XHJcblxyXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbiBhbGxcclxuICogY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cclxuXHJcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcclxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXHJcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxyXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXHJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXHJcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFXHJcbiAqIFNPRlRXQVJFLlxyXG4gKi9cclxuXHJcbiggZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgdmFyIFV0aWwgPSByZXF1aXJlKCcuLi91dGlsL1V0aWwnKSxcclxuICAgICAgICBQdWJTdWIgPSByZXF1aXJlKCcuLi91dGlsL1B1YlN1YicpO1xyXG5cclxuICAgIGZ1bmN0aW9uIExheWVyKCBzcGVjICkge1xyXG4gICAgICAgIHRoaXMudXVpZCA9IFV0aWwuZ2VuZXJhdGVVdWlkKCk7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gc3BlYy5uYW1lIHx8IFwiVW5uYW1lZCBMYXllclwiO1xyXG4gICAgICAgIHRoaXMuZG9tYWluID0gc3BlYy5kb21haW47XHJcbiAgICAgICAgdGhpcy5tYXAgPSBzcGVjLm1hcDtcclxuICAgICAgICBzcGVjLm9wYWNpdHkgPSAoIHNwZWMub3BhY2l0eSAhPT0gdW5kZWZpbmVkICkgPyBzcGVjLm9wYWNpdHkgOiAxLjA7XHJcbiAgICAgICAgc3BlYy5lbmFibGVkID0gKCBzcGVjLmVuYWJsZWQgIT09IHVuZGVmaW5lZCApID8gc3BlYy5lbmFibGVkIDogdHJ1ZTtcclxuICAgICAgICB0aGlzLnNwZWMgPSBzcGVjO1xyXG4gICAgfVxyXG5cclxuICAgIExheWVyLnByb3RvdHlwZSA9IHtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogU2V0IHRoZSBvcGFjaXR5IG9mIHRoZSBsYXllclxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIG9wYWNpdHkge2Zsb2F0fSBvcGFjaXR5IHZhbHVlIGZyb20gMCB0byAxXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0T3BhY2l0eTogZnVuY3Rpb24oIG9wYWNpdHkgKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3BlYy5vcGFjaXR5ID0gb3BhY2l0eTtcclxuICAgICAgICAgICAgaWYgKCB0aGlzLm9sTGF5ZXIgKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9sTGF5ZXIuc2V0T3BhY2l0eSAoIG9wYWNpdHkgKTtcclxuICAgICAgICAgICAgICAgIFB1YlN1Yi5wdWJsaXNoKCB0aGlzLmdldENoYW5uZWwoKSwgeyBmaWVsZDogJ29wYWNpdHknLCB2YWx1ZTogb3BhY2l0eSB9ICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBSZXR1cm5zIHRoZSBvcGFjaXR5IG9mIHRoZSBsYXllci5cclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRPcGFjaXR5OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3BlYy5vcGFjaXR5O1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFNldCB0aGUgdmlzaWJpbGl0eSBvZiB0aGUgbGF5ZXIuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gdmlzaWJpbGl0eSB7Ym9vbGVhbn0gd2hldGhlciB0aGUgbGF5ZXIgaXMgdmlzaWJsZSBvciBub3RcclxuICAgICAgICAgKi9cclxuICAgICAgICBzZXRWaXNpYmlsaXR5OiBmdW5jdGlvbiggdmlzaWJpbGl0eSApIHtcclxuICAgICAgICAgICAgdGhpcy5zcGVjLmVuYWJsZWQgPSB2aXNpYmlsaXR5O1xyXG4gICAgICAgICAgICBpZiAoIHRoaXMub2xMYXllciApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMub2xMYXllci5zZXRWaXNpYmlsaXR5KHZpc2liaWxpdHkpO1xyXG4gICAgICAgICAgICAgICAgUHViU3ViLnB1Ymxpc2goIHRoaXMuZ2V0Q2hhbm5lbCgpLCB7IGZpZWxkOiAnZW5hYmxlZCcsIHZhbHVlOiB2aXNpYmlsaXR5IH0gKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFJldHVybnMgdGhlIHZpc2liaWxpdHkgb2YgdGhlIGxheWVyLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldFZpc2liaWxpdHk6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zcGVjLmVuYWJsZWQ7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogUmV0dXJucyB0aGUgVVVJRCB0aGF0IHVuaXF1ZWx5IGlkZW50aWZpZXMgdGhpcyBsYXllci5cclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRVVUlEOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMudXVpZDtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBSZXR1cm5zIHRoZSBwdWJsaXNoL3N1YnNjcmliZSBjaGFubmVsIGlkIG9mIHRoaXMgc3BlY2lmaWMgbGF5ZXIuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0Q2hhbm5lbDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJ2xheWVyLicgKyB0aGlzLmRvbWFpbiArICcuJyArIHRoaXMudXVpZDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgbW9kdWxlLmV4cG9ydHMgPSBMYXllcjtcclxufSgpKTtcclxuIiwiLypcclxuICogQ29weXJpZ2h0IChjKSAyMDE0IE9jdWx1cyBJbmZvIEluYy5cclxuICogaHR0cDovL3d3dy5vY3VsdXNpbmZvLmNvbS9cclxuICpcclxuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKlxyXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5IG9mXHJcbiAqIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW5cclxuICogdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0b1xyXG4gKiB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllc1xyXG4gKiBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG9cclxuICogc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxyXG5cclxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsXHJcbiAqIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXHJcblxyXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXHJcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxyXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcclxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxyXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxyXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRVxyXG4gKiBTT0ZUV0FSRS5cclxuICovXHJcblxyXG4oIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIHZhciAkID0gcmVxdWlyZSgnanF1ZXJ5Jyk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBQcml2YXRlOiBQYXJzZXMgYSBtYWxmb3JtZWQgSlNPTiBzdHJpbmcgaW50byBhIHVzYWJsZSBvYmplY3QuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGpzb25TdHJpbmcge1N0cmluZ30gdGhlIG1hbGZvcm1lZCBKU09OIHN0cmluZ1xyXG4gICAgICovXHJcbiAgICAgZnVuY3Rpb24gcGFyc2VNYWxmb3JtZWRKc29uKCBqc29uU3RyaW5nICkge1xyXG4gICAgICAgIC8vIHJlcGxhY2UgKCBhbmQgKSB3aXRoIFsgYW5kIF1cclxuICAgICAgICB2YXIgc3F1YXJlZCA9IGpzb25TdHJpbmcucmVwbGFjZSggL1xcKC9nLCAnWycgKS5yZXBsYWNlKCAvXFwpL2csICddJyksXHJcbiAgICAgICAgICAgIC8vIGVuc3VyZSBhbGwgYXR0cmlidXRlcyBhcmUgcXVvdGVkIGluIFwiXCJcclxuICAgICAgICAgICAgcXVvdGVkID0gc3F1YXJlZC5yZXBsYWNlKC8oW2EtekEtWjAtOV0rKSg6KS9nLCdcIiQxXCIkMicpO1xyXG4gICAgICAgIHJldHVybiBKU09OLnBhcnNlKCBxdW90ZWQgKTtcclxuICAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBQcml2YXRlOiBQYXJzZSBhIGdpdmVuIGxheWVycyBtZXRhIGRhdGEgbWluIGFuZCBtYXgganNvbiBzdHJpbmdzLFxyXG4gICAgICogdGhleSBhcmUgY3VycmVudGx5IHN0b3JlZCBhcyBtYWxmb3JtZWQganNvbiwgc28gdGhleSByZXF1aXJlIHNvbWVcclxuICAgICAqIG1hc3NhZ2luZy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gbWV0YSB7T2JqZWN0fSB0aGUgbGF5ZXJzIG1ldGEgZGF0YSBvYmplY3RcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gcGFyc2VNZXRhTWluTWF4SnNvbiggbWV0YSApIHtcclxuICAgICAgICB2YXIgbWluID0ge30sIG1heCA9IHt9O1xyXG4gICAgICAgIGlmICggbWV0YSAmJiAoICggbWV0YS5tYXggJiYgbWV0YS5tYXgubWF4aW11bSApIHx8IG1ldGEubWF4aW11bSApICkge1xyXG4gICAgICAgICAgICBtYXggPSBwYXJzZU1hbGZvcm1lZEpzb24oIG1ldGEubWF4aW11bSB8fCBtZXRhLm1heC5tYXhpbXVtICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICggbWV0YSAmJiAoICggbWV0YS5taW4gJiYgbWV0YS5taW4ubWluaW11bSApIHx8IG1ldGEubWluaW11bSApICkge1xyXG4gICAgICAgICAgICBtaW4gPSBwYXJzZU1hbGZvcm1lZEpzb24oIG1ldGEubWluaW11bSB8fCBtZXRhLm1pbi5taW5pbXVtICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIG1pbjogJC5pc0FycmF5KCBtaW4gKSA/IG1pblswXSA6IG1pbixcclxuICAgICAgICAgICAgbWF4OiAkLmlzQXJyYXkoIG1heCApID8gbWF4WzBdIDogbWF4XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFByaXZhdGU6IE1ldGEgZGF0YSBtaW5pbXVtIGFuZCBtYXhpbXVtcyBhcmUgc3RvcmVkIGFzIG1hbGZvcm1lZCBqc29uXHJcbiAgICAgKiBzdHJpbmdzLCBidXQgYXJlIHVzdWFsbHkgYWNjZXNzZWQgYXQgYSBoaWdoIGZyZXF1ZW5jeSAoIG11bHRpcGxlXHJcbiAgICAgKiB0aW1lcyBwZXIgdGlsZSByZW5kZXIgKS4gVGhpcyBwYXJzZXMgdGhlbSBhbGwgYW5kIHN0b3JlcyB0aGVtXHJcbiAgICAgKiBhcyBhY3R1YWwgb2JqZWN0cy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gbGF5ZXJNZXRhIHtPYmplY3R9IHRoZSAubWV0YSBub2RlIG9mIHRoZSBkYXRhIHJldHVybmVkIGZvciBhIGxheWVyXHJcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZpY2UgY2FsbFxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBwYXJzZUxldmVsc01pbk1heCggbGF5ZXJNZXRhICkge1xyXG4gICAgICAgIHZhciBtZXRhID0gbGF5ZXJNZXRhLm1ldGEsXHJcbiAgICAgICAgICAgIGtleTtcclxuICAgICAgICBmb3IgKCBrZXkgaW4gbWV0YSApIHtcclxuICAgICAgICAgICAgaWYgKCBtZXRhLmhhc093blByb3BlcnR5KCBrZXkgKSApIHtcclxuICAgICAgICAgICAgICAgIG1ldGFbIGtleSBdLm1pbk1heCA9IHBhcnNlTWV0YU1pbk1heEpzb24oIG1ldGFba2V5XSApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBtZXRhO1xyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5leHBvcnRzID0ge1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBQYXJzZXMgYSBsYXllciBvciBhbiBhcnJheSBvZiBsYXllciBkYXRhIG9iamVjdHMsIGZvcm1hdHMgbWV0YSBkYXRhXHJcbiAgICAgICAgICogbWluIGFuZCBtYXggYW5kIHJldHVybnMgZWl0aGVyIHRoZSBzaW5nbGUgbGF5ZXIsIG9yIGEgbWFwIG9mIGxheWVyc1xyXG4gICAgICAgICAqIGtleWVkIGJ5IGxheWVySWQuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gbGF5ZXJEYXRhIHtPYmplY3R8QXJyYXl9IGxheWVyIGRhdGEgb2JqZWN0IG9yIGFycmF5IG9mIGxheWVyIGRhdGEgb2JqZWN0c1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHBhcnNlOiBmdW5jdGlvbiggbGF5ZXJEYXRhICkge1xyXG4gICAgICAgICAgICB2YXIgbGF5ZXJNYXAsXHJcbiAgICAgICAgICAgICAgICBpO1xyXG4gICAgICAgICAgICBpZiAoICEobGF5ZXJEYXRhIGluc3RhbmNlb2YgQXJyYXkpICkge1xyXG4gICAgICAgICAgICAgICAgbGF5ZXJEYXRhLm1ldGEubWluTWF4ID0gcGFyc2VMZXZlbHNNaW5NYXgoIGxheWVyRGF0YS5tZXRhICk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbGF5ZXJEYXRhO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIGlmIGdpdmVuIGFuIGFycmF5LCBjb252ZXJ0IGl0IGludG8gYSBtYXAga2V5ZWQgYnkgbGF5ZXJJZFxyXG4gICAgICAgICAgICBsYXllck1hcCA9IHt9O1xyXG4gICAgICAgICAgICBmb3IgKCBpPTA7IGk8bGF5ZXJEYXRhLmxlbmd0aDsgaSsrICkge1xyXG4gICAgICAgICAgICAgICAgbGF5ZXJEYXRhW2ldLm1ldGEubWluTWF4ID0gcGFyc2VMZXZlbHNNaW5NYXgoIGxheWVyRGF0YVtpXS5tZXRhICk7XHJcbiAgICAgICAgICAgICAgICBsYXllck1hcFsgbGF5ZXJEYXRhW2ldLmlkIF0gPSBsYXllckRhdGFbaV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGxheWVyTWFwO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSBnZXRVUkwgZnVuY3Rpb24gcGFzc2VkIHRvIGEgT3BlbkxheWVycyBUTVMgLyBHcmlkIExheWVyIHRvIGdlbmVyYXRlIHRoZVxyXG4gICAgICAgICAqIHRpbGUgdXJscy4gQ2FuIGJlIHBhc3NlZCBhcyBpcywgb3IgYXBwZW5kZWQgYnkgdXNpbmcgJ2NhbGwnLiBUaGUgJ3RoaXMnXHJcbiAgICAgICAgICogY29udGV4dCBpcyBzZXQgdG8gdGhlIGNvbnRleHQgb2YgdGhlIE9wZW5MYXllcnMgbGF5ZXIuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gYm91bmRzIHtPYmplY3R9IHRoZSBib3VuZHMgb2JqZWN0IGZvciB0aGUgY3VycmVudCB0aWxlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0VVJMOiBmdW5jdGlvbiggYm91bmRzICkge1xyXG4gICAgICAgICAgICB2YXIgcmVzID0gdGhpcy5tYXAuZ2V0UmVzb2x1dGlvbigpLFxyXG4gICAgICAgICAgICAgICAgbWF4Qm91bmRzID0gdGhpcy5tYXhFeHRlbnQsXHJcbiAgICAgICAgICAgICAgICB0aWxlU2l6ZSA9IHRoaXMudGlsZVNpemUsXHJcbiAgICAgICAgICAgICAgICB4ID0gTWF0aC5yb3VuZCggKGJvdW5kcy5sZWZ0LW1heEJvdW5kcy5sZWZ0KSAvIChyZXMqdGlsZVNpemUudykgKSxcclxuICAgICAgICAgICAgICAgIHkgPSBNYXRoLnJvdW5kKCAoYm91bmRzLmJvdHRvbS1tYXhCb3VuZHMuYm90dG9tKSAvIChyZXMqdGlsZVNpemUuaCkgKSxcclxuICAgICAgICAgICAgICAgIHogPSB0aGlzLm1hcC5nZXRab29tKCk7XHJcbiAgICAgICAgICAgIGlmICggeCA+PSAwICYmIHkgPj0gMCApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnVybCArIHRoaXMubGF5ZXJuYW1lXHJcbiAgICAgICAgICAgICAgICAgICAgKyBcIi9cIiArIHogKyBcIi9cIiArIHggKyBcIi9cIiArIHkgKyBcIi5cIlxyXG4gICAgICAgICAgICAgICAgICAgICsgdGhpcy50eXBlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufSgpKTtcclxuIiwiLypcclxuICogQ29weXJpZ2h0IChjKSAyMDE0IE9jdWx1cyBJbmZvIEluYy5cclxuICogaHR0cDovL3d3dy5vY3VsdXNpbmZvLmNvbS9cclxuICpcclxuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKlxyXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5IG9mXHJcbiAqIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW5cclxuICogdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0b1xyXG4gKiB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllc1xyXG4gKiBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG9cclxuICogc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxyXG5cclxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsXHJcbiAqIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXHJcblxyXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXHJcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxyXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcclxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxyXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxyXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRVxyXG4gKiBTT0ZUV0FSRS5cclxuICovXHJcblxyXG4oIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIHZhciBPcGVuTGF5ZXJzID0gcmVxdWlyZSgnLi4vb3BlbmxheWVycy9PcGVuTGF5ZXJzLm1pbicpLFxyXG4gICAgICAgICQgPSByZXF1aXJlKCdqcXVlcnknKSxcclxuICAgICAgICBfID0gcmVxdWlyZSgnbG9kYXNoJyksXHJcbiAgICAgICAgTGF5ZXIgPSByZXF1aXJlKCcuL0xheWVyJyksXHJcbiAgICAgICAgTGF5ZXJVdGlsID0gcmVxdWlyZSgnLi9MYXllclV0aWwnKSxcclxuICAgICAgICBQdWJTdWIgPSByZXF1aXJlKCcuLi91dGlsL1B1YlN1YicpLFxyXG4gICAgICAgIExlZ2VuZFNlcnZpY2UgPSByZXF1aXJlKCcuLi9yZXN0L0xlZ2VuZFNlcnZpY2UnKSxcclxuICAgICAgICByZXF1ZXN0UmFtcEltYWdlLFxyXG4gICAgICAgIGdldExldmVsTWluTWF4LFxyXG4gICAgICAgIHpvb21DYWxsYmFjaztcclxuXHJcbiAgICAvKipcclxuICAgICAqIFByaXZhdGU6IFJlcXVlc3QgY29sb3VyIHJhbXAgaW1hZ2UgZnJvbSBzZXJ2ZXIuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGxheWVyIHtPYmplY3R9IHRoZSBsYXllciBvYmplY3RcclxuICAgICAqL1xyXG4gICAgcmVxdWVzdFJhbXBJbWFnZSA9IGZ1bmN0aW9uKCBsYXllciApIHtcclxuICAgICAgICBMZWdlbmRTZXJ2aWNlLmdldEVuY29kZWRJbWFnZSggbGF5ZXIuc3BlYy5zb3VyY2UuaWQsIHtcclxuICAgICAgICAgICAgICAgIHJlbmRlcmVyOiBsYXllci5zcGVjLnJlbmRlcmVyXHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uICggbGVnZW5kU3RyaW5nICkge1xyXG4gICAgICAgICAgICAgICAgIGxheWVyLnNldFJhbXBJbWFnZVVybCggbGVnZW5kU3RyaW5nICk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFByaXZhdGU6IFJldHVybnMgdGhlIGxheWVycyBtaW4gYW5kIG1heCB2YWx1ZXMgZm9yIHRoZSBnaXZlbiB6b29tIGxldmVsLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBsYXllciB7T2JqZWN0fSB0aGUgbGF5ZXIgb2JqZWN0LlxyXG4gICAgICovXHJcbiAgICBnZXRMZXZlbE1pbk1heCA9IGZ1bmN0aW9uKCBsYXllciApIHtcclxuICAgICAgICB2YXIgem9vbUxldmVsID0gbGF5ZXIubWFwLmdldFpvb20oKSxcclxuICAgICAgICAgICAgY29hcnNlbmVzcyA9IGxheWVyLnNwZWMucmVuZGVyZXIuY29hcnNlbmVzcyxcclxuICAgICAgICAgICAgYWRqdXN0ZWRab29tID0gem9vbUxldmVsIC0gKCBjb2Fyc2VuZXNzLTEgKSxcclxuICAgICAgICAgICAgbWV0YSA9ICBsYXllci5zcGVjLnNvdXJjZS5tZXRhLFxyXG4gICAgICAgICAgICBsZXZlbE1pbk1heCA9IG1ldGEubWluTWF4WyBhZGp1c3RlZFpvb20gXSxcclxuICAgICAgICAgICAgbWluTWF4ID0gbGV2ZWxNaW5NYXggPyBsZXZlbE1pbk1heC5taW5NYXggOiB7XHJcbiAgICAgICAgICAgICAgICBtaW46IG51bGwsXHJcbiAgICAgICAgICAgICAgICBtYXg6IG51bGxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gWyBtaW5NYXgubWluLCBtaW5NYXgubWF4IF07XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUHJpdmF0ZTogUmV0dXJucyB0aGUgem9vbSBjYWxsYmFjayBmdW5jdGlvbiB0byB1cGRhdGUgbGV2ZWwgbWluIGFuZCBtYXhlcy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gbGF5ZXIge1NlcnZlckxheWVyfSBUaGUgbGF5ZXIgb2JqZWN0LlxyXG4gICAgICovXHJcbiAgICB6b29tQ2FsbGJhY2sgPSBmdW5jdGlvbiggbGF5ZXIgKSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoIGxheWVyLm9sTGF5ZXIgKSB7XHJcbiAgICAgICAgICAgICAgICBsYXllci5zZXRMZXZlbE1pbk1heCggZ2V0TGV2ZWxNaW5NYXgoIGxheWVyICkgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIFNlcnZlckxheWVyKCBzcGVjICkge1xyXG4gICAgICAgIC8vIHNldCByZWFzb25hYmxlIGRlZmF1bHRzXHJcbiAgICAgICAgc3BlYy56SW5kZXggPSAoIHNwZWMuekluZGV4ICE9PSB1bmRlZmluZWQgKSA/IHNwZWMuekluZGV4IDogMTtcclxuICAgICAgICBzcGVjLnJlbmRlcmVyID0gc3BlYy5yZW5kZXJlciB8fCB7fTtcclxuICAgICAgICBzcGVjLnJlbmRlcmVyLmNvYXJzZW5lc3MgPSAoIHNwZWMucmVuZGVyZXIuY29hcnNlbmVzcyAhPT0gdW5kZWZpbmVkICkgPyAgc3BlYy5yZW5kZXJlci5jb2Fyc2VuZXNzIDogMTtcclxuICAgICAgICBzcGVjLnJlbmRlcmVyLnJhbXAgPSBzcGVjLnJlbmRlcmVyLnJhbXAgfHwgXCJzcGVjdHJhbFwiO1xyXG4gICAgICAgIHNwZWMucmVuZGVyZXIucmFuZ2VNaW4gPSAoIHNwZWMucmVuZGVyZXIucmFuZ2VNaW4gIT09IHVuZGVmaW5lZCApID8gc3BlYy5yZW5kZXJlci5yYW5nZU1pbiA6IDA7XHJcbiAgICAgICAgc3BlYy5yZW5kZXJlci5yYW5nZU1heCA9ICggc3BlYy5yZW5kZXJlci5yYW5nZU1heCAhPT0gdW5kZWZpbmVkICkgPyBzcGVjLnJlbmRlcmVyLnJhbmdlTWF4IDogMTAwO1xyXG4gICAgICAgIHNwZWMudmFsdWVUcmFuc2Zvcm0gPSBzcGVjLnZhbHVlVHJhbnNmb3JtIHx8IHsgdHlwZTogJ2xpbmVhcicgfTtcclxuICAgICAgICBzcGVjLnRpbGVUcmFuc2Zvcm0gPSBzcGVjLnRpbGVUcmFuc2Zvcm0gfHwgeyB0eXBlOiAnaWRlbnRpdHknIH07XHJcbiAgICAgICAgc3BlYy5kb21haW4gPSBcInNlcnZlclwiO1xyXG4gICAgICAgIC8vIGNhbGwgYmFzZSBjb25zdHJ1Y3RvclxyXG4gICAgICAgIExheWVyLmNhbGwoIHRoaXMsIHNwZWMgKTtcclxuICAgIH1cclxuXHJcbiAgICBTZXJ2ZXJMYXllci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKCBMYXllci5wcm90b3R5cGUgKTtcclxuXHJcbiAgICBTZXJ2ZXJMYXllci5wcm90b3R5cGUuYWN0aXZhdGUgPSBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xyXG4gICAgICAgIC8vIHNldCBjYWxsYmFjayBoZXJlIHNvIGl0IGNhbiBiZSByZW1vdmVkIGxhdGVyXHJcbiAgICAgICAgdGhpcy56b29tQ2FsbGJhY2sgPSB6b29tQ2FsbGJhY2soIHRoaXMgKTtcclxuICAgICAgICAvLyBzZXQgY2FsbGJhY2sgdG8gdXBkYXRlIHJhbXAgbWluL21heCBvbiB6b29tXHJcbiAgICAgICAgdGhpcy5tYXAub24oIFwiem9vbWVuZFwiLCB0aGlzLnpvb21DYWxsYmFjayApO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBnZXRVUkwoIGJvdW5kcyApIHtcclxuICAgICAgICAgICAgcmV0dXJuIExheWVyVXRpbC5nZXRVUkwuY2FsbCggdGhpcywgYm91bmRzICkgKyB0aGF0LmdldFF1ZXJ5UGFyYW1TdHJpbmcoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIGFkZCB0aGUgbmV3IGxheWVyXHJcbiAgICAgICAgdGhpcy5vbExheWVyID0gbmV3IE9wZW5MYXllcnMuTGF5ZXIuVE1TKFxyXG4gICAgICAgICAgICAnU2VydmVyIFJlbmRlcmVkIFRpbGUgTGF5ZXInLFxyXG4gICAgICAgICAgICB0aGlzLnNwZWMuc291cmNlLnRtcyxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgbGF5ZXJuYW1lOiB0aGlzLnNwZWMuc291cmNlLmlkLFxyXG4gICAgICAgICAgICAgICAgdHlwZTogJ3BuZycsXHJcbiAgICAgICAgICAgICAgICBtYXhFeHRlbnQ6IG5ldyBPcGVuTGF5ZXJzLkJvdW5kcygtMjAwMzc1MDAsIC0yMDAzNzUwMCxcclxuICAgICAgICAgICAgICAgICAgICAyMDAzNzUwMCwgIDIwMDM3NTAwKSxcclxuICAgICAgICAgICAgICAgIHRyYW5zcGFyZW50OiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgaXNCYXNlTGF5ZXI6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgZ2V0VVJMOiBnZXRVUkxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5tYXAub2xNYXAuYWRkTGF5ZXIoIHRoaXMub2xMYXllciApO1xyXG5cclxuICAgICAgICByZXF1ZXN0UmFtcEltYWdlKCB0aGlzICk7XHJcbiAgICAgICAgdGhpcy5zZXRaSW5kZXgoIHRoaXMuc3BlYy56SW5kZXggKTtcclxuICAgICAgICB0aGlzLnNldE9wYWNpdHkoIHRoaXMuc3BlYy5vcGFjaXR5ICk7XHJcbiAgICAgICAgdGhpcy5zZXRWaXNpYmlsaXR5KCB0aGlzLnNwZWMuZW5hYmxlZCApO1xyXG4gICAgICAgIHRoaXMuc2V0VGhlbWUoIHRoaXMubWFwLmdldFRoZW1lKCkgKTtcclxuICAgICAgICB0aGlzLnNldExldmVsTWluTWF4KCBnZXRMZXZlbE1pbk1heCggdGhhdCApICk7XHJcbiAgICB9O1xyXG5cclxuICAgIFNlcnZlckxheWVyLnByb3RvdHlwZS5kZWFjdGl2YXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKCB0aGlzLm9sTGF5ZXIgKSB7XHJcbiAgICAgICAgICAgIHRoaXMubWFwLm9sTWFwLnJlbW92ZUxheWVyKCB0aGlzLm9sTGF5ZXIgKTtcclxuICAgICAgICAgICAgdGhpcy5vbExheWVyLmRlc3Ryb3koKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5tYXAub2ZmKCBcInpvb21lbmRcIiwgdGhpcy56b29tQ2FsbGJhY2sgKTtcclxuICAgICAgICB0aGlzLnpvb21DYWxsYmFjayA9IG51bGw7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogVmFsaWQgcmFtcCB0eXBlIHN0cmluZ3MuXHJcbiAgICAgKi9cclxuICAgIFNlcnZlckxheWVyLnByb3RvdHlwZS5SQU1QX1RZUEVTID0gW1xyXG4gICAgICAgICB7aWQ6IFwic3BlY3RyYWxcIiwgbmFtZTogXCJTcGVjdHJhbFwifSxcclxuICAgICAgICAge2lkOiBcImhvdFwiLCBuYW1lOiBcIkhvdFwifSxcclxuICAgICAgICAge2lkOiBcInBvbGFyXCIsIG5hbWU6IFwiUG9sYXJcIn0sXHJcbiAgICAgICAgIHtpZDogXCJuZXV0cmFsXCIsIG5hbWU6IFwiTmV1dHJhbFwifSxcclxuICAgICAgICAge2lkOiBcImNvb2xcIiwgbmFtZTogXCJDb29sXCJ9LFxyXG4gICAgICAgICB7aWQ6IFwidmFsZW5jZVwiLCBuYW1lOiBcIlZhbGVuY2VcIn0sXHJcbiAgICAgICAgIHtpZDogXCJmbGF0XCIsIG5hbWU6IFwiRmxhdFwifVxyXG4gICAgXTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFZhbGlkIHJhbXAgZnVuY3Rpb24gc3RyaW5ncy5cclxuICAgICAqL1xyXG4gICAgU2VydmVyTGF5ZXIucHJvdG90eXBlLlJBTVBfRlVOQ1RJT05TID0gW1xyXG4gICAgICAgIHtpZDogXCJsaW5lYXJcIiwgbmFtZTogXCJMaW5lYXJcIn0sXHJcbiAgICAgICAge2lkOiBcImxvZzEwXCIsIG5hbWU6IFwiTG9nIDEwXCJ9XHJcbiAgICBdO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHpJbmRleCAtIFRoZSBuZXcgei1vcmRlciB2YWx1ZSBvZiB0aGUgbGF5ZXIsIHdoZXJlIDAgaXMgZnJvbnQuXHJcbiAgICAgKi9cclxuICAgIFNlcnZlckxheWVyLnByb3RvdHlwZS5zZXRaSW5kZXggPSBmdW5jdGlvbiAoIHpJbmRleCApIHtcclxuICAgICAgICAvLyB3ZSBieS1wYXNzIHRoZSBPcGVuTGF5ZXJzLk1hcC5zZXRMYXllckluZGV4KCkgbWV0aG9kIGFuZCBtYW51YWxseVxyXG4gICAgICAgIC8vIHNldCB0aGUgei1pbmRleCBvZiB0aGUgbGF5ZXIgZGV2LiBzZXRMYXllckluZGV4IHNldHMgYSByZWxhdGl2ZVxyXG4gICAgICAgIC8vIGluZGV4IGJhc2VkIG9uIGN1cnJlbnQgbWFwIGxheWVycywgd2hpY2ggdGhlbiBzZXRzIGEgei1pbmRleC4gVGhpc1xyXG4gICAgICAgIC8vIGNhdXNlZCBpc3N1ZXMgd2l0aCBhc3luYyBsYXllciBsb2FkaW5nLlxyXG4gICAgICAgIHRoaXMuc3BlYy56SW5kZXggPSB6SW5kZXg7XHJcbiAgICAgICAgaWYgKCB0aGlzLm9sTGF5ZXIgKSB7XHJcbiAgICAgICAgICAgICQoIHRoaXMub2xMYXllci5kaXYgKS5jc3MoICd6LWluZGV4JywgekluZGV4ICk7XHJcbiAgICAgICAgICAgIFB1YlN1Yi5wdWJsaXNoKCB0aGlzLmdldENoYW5uZWwoKSwgeyBmaWVsZDogJ3pJbmRleCcsIHZhbHVlOiB6SW5kZXggfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldCB0aGUgbGF5ZXJzIHpJbmRleFxyXG4gICAgICovXHJcbiAgICBTZXJ2ZXJMYXllci5wcm90b3R5cGUuZ2V0WkluZGV4ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNwZWMuekluZGV4O1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFVwZGF0ZXMgdGhlIHJhbXAgdHlwZSBhc3NvY2lhdGVkIHdpdGggdGhlIGxheWVyXHJcbiAgICAgKi9cclxuICAgIFNlcnZlckxheWVyLnByb3RvdHlwZS5zZXRSYW1wVHlwZSA9IGZ1bmN0aW9uICggcmFtcFR5cGUgKSB7XHJcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuc3BlYy5yZW5kZXJlci5yYW1wID0gcmFtcFR5cGU7XHJcbiAgICAgICAgcmVxdWVzdFJhbXBJbWFnZSggdGhhdCApO1xyXG4gICAgICAgIHRoaXMub2xMYXllci5yZWRyYXcoKTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiAgR2V0IHJhbXAgdHlwZSBmb3IgbGF5ZXJcclxuICAgICAqL1xyXG4gICAgU2VydmVyTGF5ZXIucHJvdG90eXBlLmdldFJhbXBUeXBlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc3BlYy5yZW5kZXJlci5yYW1wO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFVwZGF0ZXMgdGhlIHRoZW1lIGFzc29jaWF0ZWQgd2l0aCB0aGUgbGF5ZXJcclxuICAgICAqL1xyXG4gICAgU2VydmVyTGF5ZXIucHJvdG90eXBlLnNldFRoZW1lID0gZnVuY3Rpb24oIHRoZW1lICkge1xyXG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcclxuICAgICAgICB0aGlzLnNwZWMucmVuZGVyZXIudGhlbWUgPSB0aGVtZTtcclxuICAgICAgICByZXF1ZXN0UmFtcEltYWdlKCB0aGF0ICk7XHJcbiAgICAgICAgdGhpcy5vbExheWVyLnJlZHJhdygpO1xyXG4gICAgICAgIHRoaXMuc2V0WkluZGV4KCB0aGlzLmdldFpJbmRleCgpICk7IC8vIHVwZGF0ZSB6IGluZGV4LCBzaW5jZSBjaGFuZ2luZyBiYXNlbGF5ZXIgcmVzZXRzIHRoZW1cclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgdGhlIGN1cnJlbnQgdGhlbWUgZm9yIHRoZSBsYXllclxyXG4gICAgICovXHJcbiAgICBTZXJ2ZXJMYXllci5wcm90b3R5cGUuZ2V0VGhlbWUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zcGVjLnJlbmRlcmVyLnRoZW1lO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFNldHMgdGhlIHJhbXBzIGN1cnJlbnQgbWluIGFuZCBtYXhcclxuICAgICAqL1xyXG4gICAgU2VydmVyTGF5ZXIucHJvdG90eXBlLnNldExldmVsTWluTWF4ID0gZnVuY3Rpb24oIG1pbk1heCApIHtcclxuICAgICAgICB0aGlzLmxldmVsTWluTWF4ID0gbWluTWF4O1xyXG4gICAgICAgIFB1YlN1Yi5wdWJsaXNoKCB0aGlzLmdldENoYW5uZWwoKSwgeyBmaWVsZDogJ2xldmVsTWluTWF4JywgdmFsdWU6IG1pbk1heCB9KTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgdGhlIHJhbXBzIGN1cnJlbnQgbWluIGFuZCBtYXggZm9yIHRoZSB6b29tIGxldmVsXHJcbiAgICAgKi9cclxuICAgIFNlcnZlckxheWVyLnByb3RvdHlwZS5nZXRMZXZlbE1pbk1heCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxldmVsTWluTWF4O1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFVwZGF0ZSB0aGUgcmFtcHMgVVJMIHN0cmluZ1xyXG4gICAgICovXHJcbiAgICBTZXJ2ZXJMYXllci5wcm90b3R5cGUuc2V0UmFtcEltYWdlVXJsID0gZnVuY3Rpb24gKCB1cmwgKSB7XHJcbiAgICAgICAgdGhpcy5yYW1wSW1hZ2VVcmwgPSB1cmw7XHJcbiAgICAgICAgUHViU3ViLnB1Ymxpc2goIHRoaXMuZ2V0Q2hhbm5lbCgpLCB7IGZpZWxkOiAncmFtcEltYWdlVXJsJywgdmFsdWU6IHVybCB9KTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgdGhlIGN1cnJlbnQgcmFtcHMgVVJMIHN0cmluZ1xyXG4gICAgICovXHJcbiAgICBTZXJ2ZXJMYXllci5wcm90b3R5cGUuZ2V0UmFtcEltYWdlVXJsID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmFtcEltYWdlVXJsO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFVwZGF0ZXMgdGhlIHJhbXAgZnVuY3Rpb24gYXNzb2NpYXRlZCB3aXRoIHRoZSBsYXllci4gIFJlc3VsdHMgaW4gYSBQT1NUXHJcbiAgICAgKiB0byB0aGUgc2VydmVyLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSByYW1wRnVuY3Rpb24gLSBUaGUgbmV3IG5ldyByYW1wIGZ1bmN0aW9uLlxyXG4gICAgICovXHJcbiAgICBTZXJ2ZXJMYXllci5wcm90b3R5cGUuc2V0UmFtcEZ1bmN0aW9uID0gZnVuY3Rpb24gKCByYW1wRnVuY3Rpb24gKSB7XHJcbiAgICAgICAgdGhpcy5zcGVjLnZhbHVlVHJhbnNmb3JtID0geyB0eXBlOiByYW1wRnVuY3Rpb24gfTtcclxuICAgICAgICB0aGlzLm9sTGF5ZXIucmVkcmF3KCk7XHJcbiAgICAgICAgUHViU3ViLnB1Ymxpc2goIHRoaXMuZ2V0Q2hhbm5lbCgpLCB7IGZpZWxkOiAncmFtcEZ1bmN0aW9uJywgdmFsdWU6IHJhbXBGdW5jdGlvbiB9KTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgdGhlIGN1cnJlbnQgcmFtcHMgZnVuY3Rpb25cclxuICAgICAqL1xyXG4gICAgU2VydmVyTGF5ZXIucHJvdG90eXBlLmdldFJhbXBGdW5jdGlvbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNwZWMudmFsdWVUcmFuc2Zvcm0udHlwZTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTZXQgdGhlIGxheWVycyB0cmFuc2Zvcm1lciB0eXBlXHJcbiAgICAgKi9cclxuICAgIFNlcnZlckxheWVyLnByb3RvdHlwZS5zZXRUcmFuc2Zvcm1lclR5cGUgPSBmdW5jdGlvbiAoIHRyYW5zZm9ybWVyVHlwZSApIHtcclxuICAgICAgICB0aGlzLnNwZWMudGlsZVRyYW5zZm9ybS50eXBlID0gdHJhbnNmb3JtZXJUeXBlO1xyXG4gICAgICAgIHRoaXMub2xMYXllci5yZWRyYXcoKTtcclxuICAgICAgICBQdWJTdWIucHVibGlzaCggdGhpcy5nZXRDaGFubmVsKCksIHsgZmllbGQ6ICd0cmFuc2Zvcm1lclR5cGUnLCB2YWx1ZTogdHJhbnNmb3JtZXJUeXBlIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldCB0aGUgbGF5ZXJzIHRyYW5zZm9ybWVyIHR5cGVcclxuICAgICAqL1xyXG4gICAgU2VydmVyTGF5ZXIucHJvdG90eXBlLmdldFRyYW5zZm9ybWVyVHlwZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zcGVjLnRpbGVUcmFuc2Zvcm0udHlwZTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTZXQgdGhlIHRyYW5zZm9ybWVyIGRhdGEgYXJndW1lbnRzXHJcbiAgICAgKi9cclxuICAgIFNlcnZlckxheWVyLnByb3RvdHlwZS5zZXRUcmFuc2Zvcm1lckRhdGEgPSBmdW5jdGlvbiAoIHRyYW5zZm9ybWVyRGF0YSApIHtcclxuICAgICAgICB0aGlzLnNwZWMudGlsZVRyYW5zZm9ybS5kYXRhID0gdHJhbnNmb3JtZXJEYXRhO1xyXG4gICAgICAgIHRoaXMub2xMYXllci5yZWRyYXcoKTtcclxuICAgICAgICBQdWJTdWIucHVibGlzaCggdGhpcy5nZXRDaGFubmVsKCksIHsgZmllbGQ6ICd0cmFuc2Zvcm1lckRhdGEnLCB2YWx1ZTogdHJhbnNmb3JtZXJEYXRhIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldCB0aGUgdHJhbnNmb3JtZXIgZGF0YSBhcmd1bWVudHNcclxuICAgICAqL1xyXG4gICAgU2VydmVyTGF5ZXIucHJvdG90eXBlLmdldFRyYW5zZm9ybWVyRGF0YSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zcGVjLnRpbGVUcmFuc2Zvcm0uZGF0YTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTZXQgdGhlIGxheWVyIGNvYXJzZW5lc3NcclxuICAgICAqL1xyXG4gICAgU2VydmVyTGF5ZXIucHJvdG90eXBlLnNldENvYXJzZW5lc3MgPSBmdW5jdGlvbiggY29hcnNlbmVzcyApIHtcclxuICAgICAgICB0aGlzLnNwZWMucmVuZGVyZXIuY29hcnNlbmVzcyA9IGNvYXJzZW5lc3M7XHJcbiAgICAgICAgdGhpcy5zZXRMZXZlbE1pbk1heCggZ2V0TGV2ZWxNaW5NYXgoIHRoaXMgKSApO1xyXG4gICAgICAgIHRoaXMub2xMYXllci5yZWRyYXcoKTtcclxuICAgICAgICBQdWJTdWIucHVibGlzaCggdGhpcy5nZXRDaGFubmVsKCksIHsgZmllbGQ6ICdjb2Fyc2VuZXNzJywgdmFsdWU6IGNvYXJzZW5lc3MgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0IHRoZSBsYXllciBjb2Fyc2VuZXNzXHJcbiAgICAgKi9cclxuICAgIFNlcnZlckxheWVyLnByb3RvdHlwZS5nZXRDb2Fyc2VuZXNzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc3BlYy5yZW5kZXJlci5jb2Fyc2VuZXNzO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEdlbmVyYXRlIHF1ZXJ5IHBhcmFtZXRlcnMgYmFzZWQgb24gc3RhdGUgb2YgbGF5ZXJcclxuICAgICAqL1xyXG4gICAgU2VydmVyTGF5ZXIucHJvdG90eXBlLmdldFF1ZXJ5UGFyYW1TdHJpbmcgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICBmdW5jdGlvbiBlbmNvZGVRdWVyeVBhcmFtcyggcGFyYW1zICkge1xyXG4gICAgICAgICAgICB2YXIgcXVlcnk7XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIHRyYXZlcnNlUGFyYW1zKCBwYXJhbXMsIHF1ZXJ5ICkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICBfLmZvckluKCBwYXJhbXMsIGZ1bmN0aW9uKCB2YWx1ZSwga2V5ICkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICggdHlwZW9mIHZhbHVlICE9PSBcIm9iamVjdFwiICkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gcXVlcnkgKyBrZXkgKyAnPScgKyB2YWx1ZSArIFwiJlwiO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSB0cmF2ZXJzZVBhcmFtcyggcGFyYW1zWyBrZXkgXSwgcXVlcnkgKyBrZXkgKyBcIi5cIiApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBxdWVyeSA9IFwiP1wiICsgdHJhdmVyc2VQYXJhbXMoIHBhcmFtcywgJycgKTtcclxuICAgICAgICAgICAgcmV0dXJuIHF1ZXJ5LnNsaWNlKCAwLCBxdWVyeS5sZW5ndGggLSAxICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBxdWVyeSA9IHtcclxuICAgICAgICAgICAgICAgIHJlbmRlcmVyOiB0aGlzLnNwZWMucmVuZGVyZXIsXHJcbiAgICAgICAgICAgICAgICB0aWxlVHJhbnNmb3JtOiB0aGlzLnNwZWMudGlsZVRyYW5zZm9ybSxcclxuICAgICAgICAgICAgICAgIHZhbHVlVHJhbnNmb3JtOiB0aGlzLnNwZWMudmFsdWVUcmFuc2Zvcm1cclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGVuY29kZVF1ZXJ5UGFyYW1zKCBxdWVyeSApO1xyXG4gICAgfTtcclxuXHJcbiAgICBtb2R1bGUuZXhwb3J0cyA9IFNlcnZlckxheWVyO1xyXG59KCkpO1xyXG4iLCIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTMgT2N1bHVzIEluZm8gSW5jLlxyXG4gKiBodHRwOi8vd3d3Lm9jdWx1c2luZm8uY29tL1xyXG4gKlxyXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXHJcbiAqXHJcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkgb2ZcclxuICogdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpblxyXG4gKiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvXHJcbiAqIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzXHJcbiAqIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkb1xyXG4gKiBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XHJcblxyXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbiBhbGxcclxuICogY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cclxuXHJcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcclxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXHJcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxyXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXHJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXHJcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFXHJcbiAqIFNPRlRXQVJFLlxyXG4gKi9cclxuXHJcbiggZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgdmFyIFJlbmRlcmVyID0gcmVxdWlyZSgnLi9SZW5kZXJlcicpLFxyXG4gICAgICAgIFJlbmRlcmVyVXRpbCA9IHJlcXVpcmUoJy4vUmVuZGVyZXJVdGlsJyksXHJcbiAgICAgICAgaW5qZWN0Q3NzO1xyXG5cclxuICAgIGluamVjdENzcyA9IGZ1bmN0aW9uKCBzcGVjICkge1xyXG4gICAgICAgIHZhciBpO1xyXG4gICAgICAgIGlmICggc3BlYy50ZXh0LnRoZW1lcyApIHtcclxuICAgICAgICAgICAgZm9yICggaT0wOyBpPHNwZWMudGV4dC50aGVtZXMubGVuZ3RoOyBpKysgKSB7XHJcbiAgICAgICAgICAgICAgICBzcGVjLnRleHQudGhlbWVzW2ldLmluamVjdFRoZW1lKHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RvcjogXCIubm9kZS1sYWJlbFwiXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgZnVuY3Rpb24gR3JhcGhMYWJlbFJlbmRlcmVyKCBzcGVjICkge1xyXG4gICAgICAgIFJlbmRlcmVyLmNhbGwoIHRoaXMsIHNwZWMgKTtcclxuICAgICAgICBpbmplY3RDc3MoIHRoaXMuc3BlYyApO1xyXG4gICAgfVxyXG5cclxuICAgIEdyYXBoTGFiZWxSZW5kZXJlci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKCBSZW5kZXJlci5wcm90b3R5cGUgKTtcclxuXHJcbiAgICBHcmFwaExhYmVsUmVuZGVyZXIucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uKCBkYXRhICkge1xyXG5cclxuICAgICAgICB2YXIgR1JBUEhfQ09PUkRfUkFOR0UgPSAyNTYsXHJcbiAgICAgICAgICAgIHRleHQgPSB0aGlzLnNwZWMudGV4dCxcclxuICAgICAgICAgICAgbWV0YSA9IHRoaXMubWV0YVsgdGhpcy5tYXAuZ2V0Wm9vbSgpIF0sXHJcbiAgICAgICAgICAgIGNvbW11bml0aWVzID0gZGF0YS50aWxlLnZhbHVlc1swXS52YWx1ZVswXS5jb21tdW5pdGllcyxcclxuICAgICAgICAgICAgc2NhbGUgPSBNYXRoLnBvdyggMiwgdGhpcy5tYXAuZ2V0Wm9vbSgpICksXHJcbiAgICAgICAgICAgIHJhbmdlID0gIEdSQVBIX0NPT1JEX1JBTkdFIC8gc2NhbGUsXHJcbiAgICAgICAgICAgIGxhYmVsSW5kZXggPSAoIHRleHQubGFiZWxJbmRleCAhPT0gdW5kZWZpbmVkICkgPyB0ZXh0LmxhYmVsSW5kZXggOiAwLFxyXG4gICAgICAgICAgICBtZXRhQ29tbXVuaXRpZXMgPSBtZXRhLm1pbk1heC5tYXguY29tbXVuaXRpZXNbMF0sXHJcbiAgICAgICAgICAgIHNpemVNdWx0aXBsaWVyLFxyXG4gICAgICAgICAgICBjb21tdW5pdHksXHJcbiAgICAgICAgICAgIGh0bWwgPSBcIlwiLFxyXG4gICAgICAgICAgICBmb250U2NhbGUsXHJcbiAgICAgICAgICAgIGZvbnRTaXplLFxyXG4gICAgICAgICAgICBzcGxpdCxcclxuICAgICAgICAgICAgbGFiZWwsXHJcbiAgICAgICAgICAgIGNvdW50Tm9ybSxcclxuICAgICAgICAgICAgcGVyY2VudCxcclxuICAgICAgICAgICAgaGllckxldmVsLFxyXG4gICAgICAgICAgICBwYXJlbnRJRGFycmF5ID0gW10sXHJcbiAgICAgICAgICAgIGVudHJpZXMgPSBbXSxcclxuICAgICAgICAgICAgeCwgeSwgaTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY2FwaXRhbGl6ZSggc3RyICkge1xyXG4gICAgICAgICAgICByZXR1cm4gc3RyLnJlcGxhY2UoLyg/Ol58LHxcXHMpXFxTL2csIGZ1bmN0aW9uKCBhICkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGEudG9VcHBlckNhc2UoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGdldCBsYWJlbFNpemVNdWx0aXBsaWVyIHZhbHVlIC0tIHZhbHVlIGJldHdlZW4gMC4wMDEgYW5kIDEgdGhhdCBjb250cm9scyBsYWJlbCBmb250IHNpemUgc2NhbGluZy5cclxuICAgICAgICAvLyAoTG93ZXIgdmFsdWUgY2FwcyBmb250IHNpemUgZm9yIHZlcnkgbGFyZ2UgY29tbXVuaXRpZXMsIGFuZCBpcyBiZXR0ZXIgZm9yIGdyYXBocyB3aXRoIG1hbnkgc21hbGwgY29tbXVuaXRpZXMgYW5kIGEgZmV3IHZlcnkgbGFyZ2Ugb25lcylcclxuICAgICAgICBzaXplTXVsdGlwbGllciA9ICggdGV4dC5zaXplTXVsdGlwbGllciApXHJcbiAgICAgICAgICAgID8gTWF0aC5taW4oIE1hdGgubWF4KCB0ZXh0LnNpemVNdWx0aXBsaWVyLCAwLjAwMSApLCAxLjAgKVxyXG4gICAgICAgICAgICA6IDAuNTtcclxuXHJcbiAgICAgICAgLy8gZ2V0IGdyYXBoIGhpZXJhcmNoeSBsZXZlbCBmb3IgdGhpcyB6b29tIGxldmVsXHJcbiAgICAgICAgLy8gYXNzdW1lcyBzYW1lIGhpZXJhcmNoeSBsZXZlbCBmb3IgYWxsIHRpbGVzIGF0IGEgZ2l2ZW4gem9vbSBsZXZlbFxyXG4gICAgICAgIGhpZXJMZXZlbCA9IG1ldGFDb21tdW5pdGllcy5oaWVyTGV2ZWw7XHJcblxyXG4gICAgICAgIC8vIGlmIGhpZXJMZXZlbCA9IDAsIG5vcm1hbGl6ZSBsYWJlbCBhdHRyaWJ1dGVzIGJ5IGNvbW11bml0eSBkZWdyZWVcclxuICAgICAgICAvLyBlbHNlIG5vcm1hbGl6ZSBsYWJlbCBhdHRyaWJ1dGVzIGJ5IG51bSBpbnRlcm5hbCBub2Rlc1xyXG4gICAgICAgIGNvdW50Tm9ybSA9ICggaGllckxldmVsID09PSAwIClcclxuICAgICAgICAgICAgPyBtZXRhQ29tbXVuaXRpZXMuZGVncmVlICogc2l6ZU11bHRpcGxpZXJcclxuICAgICAgICAgICAgOiBtZXRhQ29tbXVuaXRpZXMubnVtTm9kZXMgKiBzaXplTXVsdGlwbGllcjtcclxuXHJcbiAgICAgICAgZm9yICggaT0wOyBpPGNvbW11bml0aWVzLmxlbmd0aDsgaSsrICkge1xyXG5cclxuICAgICAgICAgICAgY29tbXVuaXR5ID0gY29tbXVuaXRpZXNbaV07XHJcbiAgICAgICAgICAgIGVudHJpZXMucHVzaCggY29tbXVuaXR5ICk7XHJcblxyXG4gICAgICAgICAgICAvLyBjYXBpdGFsaXplIGxhYmVsIGFycmF5LCBzcGxpdCBieSBjb21tYVxyXG4gICAgICAgICAgICBzcGxpdCA9IGNvbW11bml0eS5tZXRhZGF0YS5zcGxpdChcIixcIik7XHJcbiAgICAgICAgICAgIC8vIGRvbid0IGRyYXcgbGFiZWxzIGZvciBpc29sYXRlZCBjb21tdW5pdGllc1xyXG4gICAgICAgICAgICAvLyBhbmQgZG9uJ3QgcmVuZGVyIGlmIGxhYmVsIHN0cmluZyBpcyBlbXB0eVxyXG4gICAgICAgICAgICAvLyBvbmx5IGRyYXcgb25lIGxhYmVsIHBlciBwYXJlbnQgY29tbXVuaXR5IHBlciB0aWxlXHJcbiAgICAgICAgICAgIC8vIG9ubHkgZHJhdyB1cCB0byA1IGxhYmVscyBwZXIgdGlsZVxyXG4gICAgICAgICAgICBpZiAoIGNvbW11bml0eS5kZWdyZWUgPT09IDAgfHxcclxuICAgICAgICAgICAgICAgICBzcGxpdFsgbGFiZWxJbmRleCBdID09PSBcIlwiIHx8XHJcbiAgICAgICAgICAgICAgICAgcGFyZW50SURhcnJheS5sZW5ndGggPj0gNSB8fFxyXG4gICAgICAgICAgICAgICAgIHBhcmVudElEYXJyYXkuaW5kZXhPZiggY29tbXVuaXR5LnBhcmVudElEICkgIT09IC0xICkge1xyXG4gICAgICAgICAgICAgICAgLy8gU2tpcCB0aGlzIGxhYmVsIGVudHJ5XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIGFkZCB0aGlzIHBhcmVudCBJRCB0byB0aGUgbGlzdCwgYW5kIGRyYXcgdGhlIGxhYmVsIChiZWxvd1xyXG4gICAgICAgICAgICAgICAgcGFyZW50SURhcnJheS5wdXNoKCBjb21tdW5pdHkucGFyZW50SUQgKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gZ2V0IGxhYmVsIHBvc2l0aW9uXHJcbiAgICAgICAgICAgIHggPSAoIGNvbW11bml0eVsgdGV4dC54IF0gJSByYW5nZSApICogc2NhbGU7XHJcbiAgICAgICAgICAgIHkgPSAoIGNvbW11bml0eVsgdGV4dC55IF0gJSByYW5nZSApICogc2NhbGU7XHJcblxyXG4gICAgICAgICAgICAvLyBjYXBpdGFsaXplIGxhYmVsXHJcbiAgICAgICAgICAgIGxhYmVsID0gY2FwaXRhbGl6ZSggc3BsaXRbIGxhYmVsSW5kZXggXS50b0xvd2VyQ2FzZSgpICk7XHJcblxyXG4gICAgICAgICAgICAvLyBnZXQgZm9udCBzY2FsZSBiYXNlZCBvbiBoaWVyYXJjaHkgbGV2ZWxcclxuICAgICAgICAgICAgZm9udFNjYWxlID0gKCBoaWVyTGV2ZWwgPT09IDAgKSA/IGNvbW11bml0eS5kZWdyZWUgOiBjb21tdW5pdHkubnVtTm9kZXM7XHJcbiAgICAgICAgICAgIGZvbnRTaXplID0gUmVuZGVyZXJVdGlsLmdldEZvbnRTaXplKCBmb250U2NhbGUsIGNvdW50Tm9ybSApO1xyXG5cclxuICAgICAgICAgICAgLy9cclxuICAgICAgICAgICAgcGVyY2VudCA9IE1hdGgubWluKCAxLCBmb250U2NhbGUgLyBjb3VudE5vcm0gKSArIDAuNTtcclxuXHJcbiAgICAgICAgICAgIGh0bWwgKz0gJzxkaXYgY2xhc3M9XCJub2RlLWxhYmVsXCIgc3R5bGU9XCInXHJcbiAgICAgICAgICAgICAgICAgICsgJ2xlZnQ6Jyt4KydweDsnXHJcbiAgICAgICAgICAgICAgICAgICsgJ2JvdHRvbTonK3krJ3B4OydcclxuICAgICAgICAgICAgICAgICAgKyAnZm9udC1zaXplOicgKyBmb250U2l6ZSArICdweDsnXHJcbiAgICAgICAgICAgICAgICAgICsgJ2xpbmUtaGVpZ2h0OicgKyBmb250U2l6ZSArICdweDsnXHJcbiAgICAgICAgICAgICAgICAgICsgJ21hcmdpbi10b3A6JyArICgtZm9udFNpemUvMikgKyAncHg7J1xyXG4gICAgICAgICAgICAgICAgICArICdoZWlnaHQ6JyArIGZvbnRTaXplICsgJ3B4OydcclxuICAgICAgICAgICAgICAgICAgKyAnb3BhY2l0eTonICsgcGVyY2VudCArICc7J1xyXG4gICAgICAgICAgICAgICAgICArICd6LWluZGV4OicgKyBNYXRoLmZsb29yKCBmb250U2l6ZSApICsgJzsnXHJcbiAgICAgICAgICAgICAgICAgICsgJ1wiPicrbGFiZWwrJzwvZGl2Pic7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGh0bWw6IGh0bWwsXHJcbiAgICAgICAgICAgIGVudHJpZXM6IGVudHJpZXNcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuXHJcbiAgICBtb2R1bGUuZXhwb3J0cyA9IEdyYXBoTGFiZWxSZW5kZXJlcjtcclxufSgpKTsiLCIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTMgT2N1bHVzIEluZm8gSW5jLlxyXG4gKiBodHRwOi8vd3d3Lm9jdWx1c2luZm8uY29tL1xyXG4gKlxyXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXHJcbiAqXHJcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkgb2ZcclxuICogdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpblxyXG4gKiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvXHJcbiAqIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzXHJcbiAqIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkb1xyXG4gKiBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XHJcblxyXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbiBhbGxcclxuICogY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cclxuXHJcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcclxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXHJcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxyXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXHJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXHJcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFXHJcbiAqIFNPRlRXQVJFLlxyXG4gKi9cclxuXHJcbiggZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgdmFyIFJlbmRlcmVyID0gcmVxdWlyZSgnLi9SZW5kZXJlcicpLFxyXG4gICAgICAgIGluamVjdENzcztcclxuXHJcbiAgICBpbmplY3RDc3MgPSBmdW5jdGlvbiggc3BlYyApIHtcclxuICAgICAgICB2YXIgaTtcclxuICAgICAgICBpZiAoIHNwZWMubm9kZS50aGVtZXMgKSB7XHJcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBzcGVjLm5vZGUudGhlbWVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBzcGVjLm5vZGUudGhlbWVzW2ldLmluamVjdFRoZW1lKHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RvcjogXCIuY29tbXVuaXR5LW5vZGVcIlxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCBzcGVjLmNyaXRpY2FsTm9kZS50aGVtZXMgKSB7XHJcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBzcGVjLmNyaXRpY2FsTm9kZS50aGVtZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHNwZWMuY3JpdGljYWxOb2RlLnRoZW1lc1tpXS5pbmplY3RUaGVtZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0b3I6IFwiLmNvbW11bml0eS1ub2RlLmNvbW11bml0eS1jcml0aWNhbC1ub2RlXCJcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICggc3BlYy5wYXJlbnROb2RlLnRoZW1lcyApIHtcclxuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHNwZWMucGFyZW50Tm9kZS50aGVtZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHNwZWMucGFyZW50Tm9kZS50aGVtZXNbaV0uaW5qZWN0VGhlbWUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdG9yOiBcIi5jb21tdW5pdHktcGFyZW50LW5vZGVcIlxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIEdyYXBoTm9kZVJlbmRlcmVyKCBzcGVjICkge1xyXG4gICAgICAgIFJlbmRlcmVyLmNhbGwoIHRoaXMsIHNwZWMgKTtcclxuICAgICAgICBpbmplY3RDc3MoIHRoaXMuc3BlYyApO1xyXG4gICAgfVxyXG5cclxuICAgIEdyYXBoTm9kZVJlbmRlcmVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoIFJlbmRlcmVyLnByb3RvdHlwZSApO1xyXG5cclxuICAgIEdyYXBoTm9kZVJlbmRlcmVyLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiggZGF0YSApIHtcclxuXHJcbiAgICAgICAgdmFyIEdSQVBIX0NPT1JEX1JBTkdFID0gMjU2LFxyXG4gICAgICAgICAgICBCT1JERVJfV0lEVEggPSAyLFxyXG4gICAgICAgICAgICBzcGVjID0gdGhpcy5zcGVjLFxyXG4gICAgICAgICAgICBjb21tdW5pdGllcyA9IGRhdGEudGlsZS52YWx1ZXNbMF0udmFsdWVbMF0uY29tbXVuaXRpZXMsXHJcbiAgICAgICAgICAgIHNjYWxlID0gTWF0aC5wb3coIDIsIHRoaXMubWFwLmdldFpvb20oKSApLFxyXG4gICAgICAgICAgICByYW5nZSA9ICBHUkFQSF9DT09SRF9SQU5HRSAvIHNjYWxlLFxyXG4gICAgICAgICAgICBjbGFzc05hbWUsXHJcbiAgICAgICAgICAgIGNvbW11bml0eSxcclxuICAgICAgICAgICAgcmFkaXVzLFxyXG4gICAgICAgICAgICBkaWFtZXRlcixcclxuICAgICAgICAgICAgcGFyZW50UmFkaXVzLFxyXG4gICAgICAgICAgICBwYXJlbnREaWFtZXRlcixcclxuICAgICAgICAgICAgaHRtbCA9ICcnLFxyXG4gICAgICAgICAgICBlbnRyaWVzID0gW10sXHJcbiAgICAgICAgICAgIGksIHgsIHksIHB4LCBweTtcclxuXHJcbiAgICAgICAgZm9yICggaT0wOyBpPGNvbW11bml0aWVzLmxlbmd0aDsgaSsrICkge1xyXG5cclxuICAgICAgICAgICAgY29tbXVuaXR5ID0gY29tbXVuaXRpZXNbaV07XHJcbiAgICAgICAgICAgIGVudHJpZXMucHVzaCggY29tbXVuaXR5ICk7XHJcblxyXG4gICAgICAgICAgICAvLyBnZXQgbm9kZSBwb3NpdGlvbiwgcmFkaXVzLCBhbmQgZGlhbWV0ZXJcclxuICAgICAgICAgICAgeCA9ICggY29tbXVuaXR5WyBzcGVjLm5vZGUueCBdICUgcmFuZ2UgKSAqIHNjYWxlO1xyXG4gICAgICAgICAgICB5ID0gKCBjb21tdW5pdHlbIHNwZWMubm9kZS55IF0gJSByYW5nZSApICogc2NhbGU7XHJcbiAgICAgICAgICAgIHJhZGl1cyA9IGNvbW11bml0eVsgc3BlYy5ub2RlLnJhZGl1cyBdICogc2NhbGU7XHJcbiAgICAgICAgICAgIGRpYW1ldGVyID0gcmFkaXVzKjI7XHJcblxyXG4gICAgICAgICAgICAvLyBkb24ndCBkcmF3IG5vZGUgaWYgcmFkaXVzIDwgMVxyXG4gICAgICAgICAgICAvLyBvciBpZiBpdCBpcyBhbiBpc29sYXRlZCBjb21tdW5pdHlcclxuICAgICAgICAgICAgaWYgKCByYWRpdXMgPCAxIHx8IGNvbW11bml0eS5kZWdyZWUgPT09IDAgKSB7XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKCBjb21tdW5pdHlbIHNwZWMuY3JpdGljYWxOb2RlLmZsYWcgXSApIHtcclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZSA9ICdjb21tdW5pdHktbm9kZSBjb21tdW5pdHktY3JpdGljYWwtbm9kZSc7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWUgPSAnY29tbXVuaXR5LW5vZGUnO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBkcmF3IG5vZGVcclxuICAgICAgICAgICAgaHRtbCArPSAnPGRpdiBjbGFzcz1cIicrY2xhc3NOYW1lKydcIiBzdHlsZT1cIidcclxuICAgICAgICAgICAgICAgICAgKyAnaGVpZ2h0OicrZGlhbWV0ZXIrJ3B4OydcclxuICAgICAgICAgICAgICAgICAgKyAnd2lkdGg6JytkaWFtZXRlcisncHg7J1xyXG4gICAgICAgICAgICAgICAgICArICdib3JkZXItcmFkaXVzOicrZGlhbWV0ZXIrJ3B4OydcclxuICAgICAgICAgICAgICAgICAgKyAnbGVmdDonKyh4IC0gcmFkaXVzIC0gQk9SREVSX1dJRFRIKSsncHg7J1xyXG4gICAgICAgICAgICAgICAgICArICdib3R0b206JysoeSAtIHJhZGl1cyAtIEJPUkRFUl9XSURUSCkrJ3B4OydcclxuICAgICAgICAgICAgICAgICAgKyAnYm9yZGVyLXdpZHRoOicgKyBCT1JERVJfV0lEVEggKyAncHg7J1xyXG4gICAgICAgICAgICAgICAgICArICdcIj48L2Rpdj4nO1xyXG5cclxuICAgICAgICAgICAgLy8gb25seSBoYXZlIHRoZSBjcml0aWNhbCBub2RlIGRyYXcgdGhlIHBhcmVudFxyXG4gICAgICAgICAgICAvLyBhc3N1bWVzIHRoZXJlIGlzIGEgY3JpdGljYWwgbm9kZSBwcmVzZW50IGluIGFsbCBjb21tdW5pdGllc1xyXG4gICAgICAgICAgICBpZiAoIGNvbW11bml0eVsgc3BlYy5jcml0aWNhbE5vZGUuZmxhZyBdICkge1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIGdldCBwYXJlbnQgbm9kZSBwb3NpdGlvbiwgcmFkaXVzLCBhbmQgZGlhbWV0ZXJcclxuICAgICAgICAgICAgICAgIHB4ID0gKCBjb21tdW5pdHlbIHNwZWMucGFyZW50Tm9kZS54IF0gJSByYW5nZSApICogc2NhbGU7XHJcbiAgICAgICAgICAgICAgICBweSA9ICggY29tbXVuaXR5WyBzcGVjLnBhcmVudE5vZGUueSBdICUgcmFuZ2UgKSAqIHNjYWxlO1xyXG4gICAgICAgICAgICAgICAgcGFyZW50UmFkaXVzID0gY29tbXVuaXR5WyBzcGVjLnBhcmVudE5vZGUucmFkaXVzIF0gKiBzY2FsZTtcclxuICAgICAgICAgICAgICAgIHBhcmVudERpYW1ldGVyID0gcGFyZW50UmFkaXVzICogMjtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBkcmF3IHBhcmVudCBub2RlXHJcbiAgICAgICAgICAgICAgICBodG1sICs9ICc8ZGl2IGNsYXNzPVwiY29tbXVuaXR5LXBhcmVudC1ub2RlXCIgc3R5bGU9XCInXHJcbiAgICAgICAgICAgICAgICAgICAgICArICdoZWlnaHQ6JytwYXJlbnREaWFtZXRlcisncHg7J1xyXG4gICAgICAgICAgICAgICAgICAgICAgKyAnd2lkdGg6JytwYXJlbnREaWFtZXRlcisncHg7J1xyXG4gICAgICAgICAgICAgICAgICAgICAgKyAnYm9yZGVyLXJhZGl1czonK3BhcmVudERpYW1ldGVyKydweDsnXHJcbiAgICAgICAgICAgICAgICAgICAgICArICdsZWZ0OicrKHB4IC0gcGFyZW50UmFkaXVzIC0gQk9SREVSX1dJRFRIKSsncHg7J1xyXG4gICAgICAgICAgICAgICAgICAgICAgKyAnYm90dG9tOicrKHB5IC0gcGFyZW50UmFkaXVzIC0gQk9SREVSX1dJRFRIKSsncHg7J1xyXG4gICAgICAgICAgICAgICAgICAgICAgKyAnYm9yZGVyLXdpZHRoOicgKyBCT1JERVJfV0lEVEggKyAncHg7J1xyXG4gICAgICAgICAgICAgICAgICAgICAgKyAnXCI+PC9kaXY+JztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBodG1sOiBodG1sLFxyXG4gICAgICAgICAgICBlbnRyaWVzOiBlbnRyaWVzXHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcblxyXG4gICAgbW9kdWxlLmV4cG9ydHMgPSBHcmFwaE5vZGVSZW5kZXJlcjtcclxufSgpKTsiLCIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTMgT2N1bHVzIEluZm8gSW5jLlxyXG4gKiBodHRwOi8vd3d3Lm9jdWx1c2luZm8uY29tL1xyXG4gKlxyXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXHJcbiAqXHJcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkgb2ZcclxuICogdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpblxyXG4gKiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvXHJcbiAqIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzXHJcbiAqIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkb1xyXG4gKiBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XHJcblxyXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbiBhbGxcclxuICogY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cclxuXHJcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcclxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXHJcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxyXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXHJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXHJcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFXHJcbiAqIFNPRlRXQVJFLlxyXG4gKi9cclxuXHJcbiggZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgdmFyIFJlbmRlcmVyID0gcmVxdWlyZSgnLi9SZW5kZXJlcicpLFxyXG4gICAgICAgIE1hcFV0aWwgPSByZXF1aXJlKCcuLi8uLi9tYXAvTWFwVXRpbCcpLFxyXG4gICAgICAgIGluamVjdENzcztcclxuXHJcbiAgICBpbmplY3RDc3MgPSBmdW5jdGlvbiggc3BlYyApIHtcclxuICAgICAgICB2YXIgaTtcclxuICAgICAgICBpZiAoIHNwZWMucG9pbnQudGhlbWVzICkge1xyXG4gICAgICAgICAgICBmb3IgKCBpID0gMDsgaSA8IHNwZWMucG9pbnQudGhlbWVzLmxlbmd0aDsgaSsrICkge1xyXG4gICAgICAgICAgICAgICAgc3BlYy5wb2ludC50aGVtZXNbaV0uaW5qZWN0VGhlbWUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdG9yOiBcIi5wb2ludC1hbm5vdGF0aW9uLWZpbGxcIixcclxuICAgICAgICAgICAgICAgICAgICBwYXJlbnRTZWxlY3RvcjogXCIucG9pbnQtYW5ub3RhdGlvbi1hZ2dyZWdhdGVcIlxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCBzcGVjLmFnZ3JlZ2F0ZS50aGVtZXMgKSB7XHJcbiAgICAgICAgICAgIGZvciAoIGkgPSAwOyBpIDwgc3BlYy5hZ2dyZWdhdGUudGhlbWVzLmxlbmd0aDsgaSsrICkge1xyXG4gICAgICAgICAgICAgICAgc3BlYy5hZ2dyZWdhdGUudGhlbWVzW2ldLmluamVjdFRoZW1lKHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RvcjogXCIucG9pbnQtYW5ub3RhdGlvbi1ib3JkZXJcIixcclxuICAgICAgICAgICAgICAgICAgICBwYXJlbnRTZWxlY3RvcjogXCIucG9pbnQtYW5ub3RhdGlvbi1hZ2dyZWdhdGVcIlxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIFBvaW50QWdncmVnYXRlUmVuZGVyZXIoIHNwZWMgKSB7XHJcbiAgICAgICAgUmVuZGVyZXIuY2FsbCggdGhpcywgc3BlYyApO1xyXG4gICAgICAgIGluamVjdENzcyggdGhpcy5zcGVjICk7XHJcbiAgICB9XHJcblxyXG4gICAgUG9pbnRBZ2dyZWdhdGVSZW5kZXJlci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKCBSZW5kZXJlci5wcm90b3R5cGUgKTtcclxuXHJcbiAgICBQb2ludEFnZ3JlZ2F0ZVJlbmRlcmVyLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiggZGF0YSApIHtcclxuXHJcbiAgICAgICAgdmFyIC8vc3BlYyA9IHRoaXMuc3BlYyxcclxuICAgICAgICAgICAgLy9tZXRhID0gdGhpcy5tZXRhWyB0aGlzLm1hcC5nZXRab29tKCkgXSxcclxuICAgICAgICAgICAgdmFsdWVzID0gZGF0YS50aWxlLnZhbHVlcyxcclxuICAgICAgICAgICAgZW50cmllcyA9IFtdLFxyXG4gICAgICAgICAgICBwb3NpdGlvbk1hcCA9IHt9LFxyXG4gICAgICAgICAgICBwb3NpdGlvbktleSxcclxuICAgICAgICAgICAgdGlsZWtleSxcclxuICAgICAgICAgICAgdGlsZVBvcyxcclxuICAgICAgICAgICAgaHRtbCA9ICcnLFxyXG4gICAgICAgICAgICBwb3NpdGlvbixcclxuICAgICAgICAgICAgb2Zmc2V0LFxyXG4gICAgICAgICAgICB2YWx1ZSxcclxuICAgICAgICAgICAgaSwgajtcclxuXHJcbiAgICAgICAgLy8gZm9yIGVhY2ggYmluXHJcbiAgICAgICAgZm9yICggaT0wOyBpPHZhbHVlcy5sZW5ndGg7IGkrKyApIHtcclxuXHJcbiAgICAgICAgICAgIHZhbHVlID0gdmFsdWVzW2ldLnZhbHVlO1xyXG5cclxuICAgICAgICAgICAgaWYgKCB2YWx1ZS5sZW5ndGggPT09IDAgKSB7XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbnRyaWVzLnB1c2goIHZhbHVlICk7XHJcblxyXG4gICAgICAgICAgICBodG1sICs9ICc8ZGl2IGNsYXNzPVwicG9pbnQtYW5ub3RhdGlvbi1hZ2dyZWdhdGVcIj4nO1xyXG5cclxuICAgICAgICAgICAgZm9yICggaj0wOyBqPHZhbHVlLmxlbmd0aDsgaisrICkge1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIGdldCBhbm5vdGF0aW9ucyBwb3NpdGlvbiBpbiB2aWV3cG9ydCBzcGFjZVxyXG4gICAgICAgICAgICAgICAgdGlsZWtleSA9IGRhdGEuaW5kZXgubGV2ZWwgKyBcIixcIiArIGRhdGEuaW5kZXgueEluZGV4ICsgXCIsXCIgKyBkYXRhLmluZGV4LnlJbmRleDtcclxuICAgICAgICAgICAgICAgIHRpbGVQb3MgPSBNYXBVdGlsLmdldFRvcExlZnRWaWV3cG9ydFBpeGVsRm9yVGlsZSggdGhpcy5tYXAsIHRpbGVrZXkgKTtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uID0gTWFwVXRpbC5nZXRWaWV3cG9ydFBpeGVsRnJvbUNvb3JkKCB0aGlzLm1hcCwgdmFsdWVbal0ueCwgdmFsdWVbal0ueSApO1xyXG4gICAgICAgICAgICAgICAgLy8gZ2V0IHJlbGF0aXZlIHBvc2l0aW9uIGZyb20gdGlsZSB0b3AgbGVmdFxyXG4gICAgICAgICAgICAgICAgb2Zmc2V0ID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHg6IHBvc2l0aW9uLnggLSB0aWxlUG9zLngsXHJcbiAgICAgICAgICAgICAgICAgICAgeTogcG9zaXRpb24ueSAtIHRpbGVQb3MueVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIC8vIHByZXZlbnQgY3JlYXRpbmcgdHdvIGFubm90YXRpb25zIG9uIHRoZSBleGFjdCBzYW1lIHBpeGVsXHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbktleSA9IE1hdGguZmxvb3IoIG9mZnNldC54ICkgKyBcIixcIiArIE1hdGguZmxvb3IoIG9mZnNldC55ICk7XHJcbiAgICAgICAgICAgICAgICBpZiAoICFwb3NpdGlvbk1hcFsgcG9zaXRpb25LZXkgXSApIHtcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbk1hcFsgcG9zaXRpb25LZXkgXSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgaHRtbCArPSAnPGRpdiBjbGFzcz1cInBvaW50LWFubm90YXRpb24gcG9pbnQtYW5ub3RhdGlvbi1maWxsXCIgc3R5bGU9XCInXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgKyAnbGVmdDonICsgb2Zmc2V0LnggKyAncHg7J1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICsgJ3RvcDonICsgb2Zmc2V0LnkgKyAncHg7J1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICsgJ2JvcmRlci13aWR0aDogMnB4O1wiPjwvZGl2PidcclxuICAgICAgICAgICAgICAgICAgICAgICAgICArICc8ZGl2IGNsYXNzPVwicG9pbnQtYW5ub3RhdGlvbiBwb2ludC1hbm5vdGF0aW9uLWJvcmRlclwiIHN0eWxlPVwiJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICsgJ2xlZnQ6JyArIG9mZnNldC54ICsgJ3B4OydcclxuICAgICAgICAgICAgICAgICAgICAgICAgICArICd0b3A6JyArIG9mZnNldC55ICsgJ3B4OydcclxuICAgICAgICAgICAgICAgICAgICAgICAgICArICdib3JkZXItd2lkdGg6IDJweFwiPjwvZGl2Pic7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGh0bWwgKz0gJzwvZGl2Pic7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGh0bWw6IGh0bWwsXHJcbiAgICAgICAgICAgIGVudHJpZXM6IGVudHJpZXNcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuXHJcbiAgICBtb2R1bGUuZXhwb3J0cyA9IFBvaW50QWdncmVnYXRlUmVuZGVyZXI7XHJcbn0oKSk7IiwiLypcclxuICogQ29weXJpZ2h0IChjKSAyMDEzIE9jdWx1cyBJbmZvIEluYy5cclxuICogaHR0cDovL3d3dy5vY3VsdXNpbmZvLmNvbS9cclxuICpcclxuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKlxyXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5IG9mXHJcbiAqIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW5cclxuICogdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0b1xyXG4gKiB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllc1xyXG4gKiBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG9cclxuICogc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxyXG5cclxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsXHJcbiAqIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXHJcblxyXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXHJcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxyXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcclxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxyXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxyXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRVxyXG4gKiBTT0ZUV0FSRS5cclxuICovXHJcblxyXG4oIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIHZhciBSZW5kZXJlciA9IHJlcXVpcmUoJy4vUmVuZGVyZXInKSxcclxuICAgICAgICBNYXBVdGlsID0gcmVxdWlyZSgnLi4vLi4vbWFwL01hcFV0aWwnKSxcclxuICAgICAgICBpbmplY3RDc3M7XHJcblxyXG4gICAgaW5qZWN0Q3NzID0gZnVuY3Rpb24oIHNwZWMgKSB7XHJcbiAgICAgICAgdmFyIGk7XHJcbiAgICAgICAgaWYgKCBzcGVjLnBvaW50LnRoZW1lcyApIHtcclxuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHNwZWMucG9pbnQudGhlbWVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBzcGVjLnBvaW50LnRoZW1lc1tpXS5pbmplY3RUaGVtZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0b3I6IFwiLnBvaW50LWFubm90YXRpb25cIlxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIFBvaW50UmVuZGVyZXIoIHNwZWMgKSB7XHJcbiAgICAgICAgUmVuZGVyZXIuY2FsbCggdGhpcywgc3BlYyApO1xyXG4gICAgICAgIGluamVjdENzcyggdGhpcy5zcGVjICk7XHJcbiAgICB9XHJcblxyXG4gICAgUG9pbnRSZW5kZXJlci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKCBSZW5kZXJlci5wcm90b3R5cGUgKTtcclxuXHJcbiAgICBQb2ludFJlbmRlcmVyLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiggZGF0YSApIHtcclxuXHJcbiAgICAgICAgdmFyIC8vc3BlYyA9IHRoaXMuc3BlYyxcclxuICAgICAgICAgICAgLy9tZXRhID0gdGhpcy5tZXRhWyB0aGlzLm1hcC5nZXRab29tKCkgXSxcclxuICAgICAgICAgICAgdmFsdWVzID0gZGF0YS50aWxlLnZhbHVlcyxcclxuICAgICAgICAgICAgZW50cmllcyA9IFtdLFxyXG4gICAgICAgICAgICBwb3NpdGlvbk1hcCA9IHt9LFxyXG4gICAgICAgICAgICBwb3NpdGlvbktleSxcclxuICAgICAgICAgICAgdGlsZWtleSxcclxuICAgICAgICAgICAgdGlsZVBvcyxcclxuICAgICAgICAgICAgaHRtbCA9ICcnLFxyXG4gICAgICAgICAgICBwb3NpdGlvbixcclxuICAgICAgICAgICAgb2Zmc2V0LFxyXG4gICAgICAgICAgICB2YWx1ZSxcclxuICAgICAgICAgICAgaSwgajtcclxuXHJcbiAgICAgICAgLy8gZm9yIGVhY2ggYmluXHJcbiAgICAgICAgZm9yICggaT0wOyBpPHZhbHVlcy5sZW5ndGg7IGkrKyApIHtcclxuXHJcbiAgICAgICAgICAgIHZhbHVlID0gdmFsdWVzW2ldLnZhbHVlO1xyXG5cclxuICAgICAgICAgICAgaWYgKCB2YWx1ZS5sZW5ndGggPT09IDAgKSB7XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZm9yICggaj0wOyBqPHZhbHVlLmxlbmd0aDsgaisrICkge1xyXG5cclxuICAgICAgICAgICAgICAgIGVudHJpZXMucHVzaCggdmFsdWVbal0gKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBnZXQgYW5ub3RhdGlvbnMgcG9zaXRpb24gaW4gdmlld3BvcnQgc3BhY2VcclxuICAgICAgICAgICAgICAgIHRpbGVrZXkgPSBkYXRhLmluZGV4LmxldmVsICsgXCIsXCIgKyBkYXRhLmluZGV4LnhJbmRleCArIFwiLFwiICsgZGF0YS5pbmRleC55SW5kZXg7XHJcbiAgICAgICAgICAgICAgICB0aWxlUG9zID0gTWFwVXRpbC5nZXRUb3BMZWZ0Vmlld3BvcnRQaXhlbEZvclRpbGUoIHRoaXMubWFwLCB0aWxla2V5ICk7XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IE1hcFV0aWwuZ2V0Vmlld3BvcnRQaXhlbEZyb21Db29yZCggdGhpcy5tYXAsIHZhbHVlW2pdLngsIHZhbHVlW2pdLnkgKTtcclxuICAgICAgICAgICAgICAgIC8vIGdldCByZWxhdGl2ZSBwb3NpdGlvbiBmcm9tIHRpbGUgdG9wIGxlZnRcclxuICAgICAgICAgICAgICAgIG9mZnNldCA9IHtcclxuICAgICAgICAgICAgICAgICAgICB4OiBwb3NpdGlvbi54IC0gdGlsZVBvcy54LFxyXG4gICAgICAgICAgICAgICAgICAgIHk6IHBvc2l0aW9uLnkgLSB0aWxlUG9zLnlcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAvLyBwcmV2ZW50IGNyZWF0aW5nIHR3byBhbm5vdGF0aW9ucyBvbiB0aGUgZXhhY3Qgc2FtZSBwaXhlbFxyXG4gICAgICAgICAgICAgICAgcG9zaXRpb25LZXkgPSBNYXRoLmZsb29yKCBvZmZzZXQueCApICsgXCIsXCIgKyBNYXRoLmZsb29yKCBvZmZzZXQueSApO1xyXG4gICAgICAgICAgICAgICAgaWYgKCAhcG9zaXRpb25NYXBbIHBvc2l0aW9uS2V5IF0gKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25NYXBbIHBvc2l0aW9uS2V5IF0gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gJzxkaXYgY2xhc3M9XCJwb2ludC1hbm5vdGF0aW9uIHBvaW50LWFubm90YXRpb24tc2luZ2xlXCIgc3R5bGU9XCInXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgKyAnbGVmdDonICsgb2Zmc2V0LnggKyAncHg7J1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICsgJ3RvcDonICsgb2Zmc2V0LnkgKyAncHg7J1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICsgJ2JvcmRlci13aWR0aDogMnB4XCI+PC9kaXY+JztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBodG1sOiBodG1sLFxyXG4gICAgICAgICAgICBlbnRyaWVzOiBlbnRyaWVzXHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcblxyXG4gICAgbW9kdWxlLmV4cG9ydHMgPSBQb2ludFJlbmRlcmVyO1xyXG59KCkpOyIsIi8qXHJcbiAqIENvcHlyaWdodCAoYykgMjAxMyBPY3VsdXMgSW5mbyBJbmMuXHJcbiAqIGh0dHA6Ly93d3cub2N1bHVzaW5mby5jb20vXHJcbiAqXHJcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuICpcclxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weSBvZlxyXG4gKiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluXHJcbiAqIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG9cclxuICogdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXNcclxuICogb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvXHJcbiAqIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcclxuXHJcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbFxyXG4gKiBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxyXG5cclxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxyXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXHJcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcclxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEVcclxuICogU09GVFdBUkUuXHJcbiAqL1xyXG5cclxuKCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICB2YXIgJCA9IHJlcXVpcmUoJ2pxdWVyeScpLFxyXG4gICAgICAgIGdldE91dGxpbmVDc3M7XHJcblxyXG4gICAgZ2V0T3V0bGluZUNzcyA9IGZ1bmN0aW9uKCB0eXBlLCB2YWx1ZSApIHtcclxuICAgICAgICBmdW5jdGlvbiBpc0NvbG9yKCB2YWwgKSB7XHJcbiAgICAgICAgICAgIHZhciBzcGxpdCA9IHZhbC5yZXBsYWNlKC9cXHMrL2csICcnKS5zcGxpdCgvW1xcKFxcKV0vKTtcclxuICAgICAgICAgICAgaWYgKCBzcGxpdFswXSA9PT0gXCJyZ2JcIiB8fCBzcGxpdFswXSA9PT0gXCJyZ2JhXCIgKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB2YWxbMF0gPT09IFwiI1wiICYmICggdmFsLmxlbmd0aCA9PT0gNCB8fCB2YWwubGVuZ3RoID09PSA3ICk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoICF2YWx1ZSApIHtcclxuICAgICAgICAgICAgcmV0dXJuIFwiXCI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIHR5cGUgPT09IFwidGV4dC1zaGFkb3dcIiApIHtcclxuICAgICAgICAgICAgaWYgKCBpc0NvbG9yKCB2YWx1ZSApICkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwidGV4dC1zaGFkb3c6XCJcclxuICAgICAgICAgICAgICAgICAgICArIFwiLTFweCAtMXB4IDAgXCIgKyB2YWx1ZSArIFwiLFwiXHJcbiAgICAgICAgICAgICAgICAgICAgKyBcIiAxcHggLTFweCAwIFwiICsgdmFsdWUgKyBcIixcIlxyXG4gICAgICAgICAgICAgICAgICAgICsgXCItMXB4ICAxcHggMCBcIiArIHZhbHVlICsgXCIsXCJcclxuICAgICAgICAgICAgICAgICAgICArIFwiIDFweCAgMXB4IDAgXCIgKyB2YWx1ZSArIFwiLFwiXHJcbiAgICAgICAgICAgICAgICAgICAgKyBcIiAxcHggIDAgICAwIFwiICsgdmFsdWUgKyBcIixcIlxyXG4gICAgICAgICAgICAgICAgICAgICsgXCItMXB4ICAwICAgMCBcIiArIHZhbHVlICsgXCIsXCJcclxuICAgICAgICAgICAgICAgICAgICArIFwiIDAgICAgMXB4IDAgXCIgKyB2YWx1ZSArIFwiLFwiXHJcbiAgICAgICAgICAgICAgICAgICAgKyBcIiAwICAgLTFweCAwIFwiICsgdmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIFwidGV4dC1zaGFkb3c6XCIgKyB2YWx1ZSArIFwiO1wiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIHR5cGUgPT09IFwiYm9yZGVyXCIgKSB7XHJcbiAgICAgICAgICAgIGlmICggaXNDb2xvciggdmFsdWUgKSApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcImJvcmRlcjogMXB4IHNvbGlkIFwiICsgdmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIFwiYm9yZGVyOlwiICsgdmFsdWUgKyBcIjtcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFwiXCI7XHJcbiAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIFJlbmRlclRoZW1lKCBzZWxlY3Rvciwgc3BlYyApIHtcclxuICAgICAgICBzcGVjID0gc3BlYyB8fCB7fTtcclxuICAgICAgICB0aGlzLnNlbGVjdG9yID0gc2VsZWN0b3I7XHJcbiAgICAgICAgdGhpcy5zcGVjID0gc3BlYztcclxuICAgIH1cclxuXHJcbiAgICBSZW5kZXJUaGVtZS5wcm90b3R5cGUuaW5qZWN0VGhlbWUgPSBmdW5jdGlvbiggb3B0aW9ucyApIHtcclxuICAgICAgICB2YXIgdGhlbWUgPSB0aGlzLnNlbGVjdG9yLFxyXG4gICAgICAgICAgICBzcGVjID0gdGhpcy5zcGVjLFxyXG4gICAgICAgICAgICBzZWxlY3RvciA9IG9wdGlvbnMuc2VsZWN0b3IsXHJcbiAgICAgICAgICAgIHBhcmVudFNlbGVjdG9yID0gb3B0aW9ucy5wYXJlbnRTZWxlY3RvcixcclxuICAgICAgICAgICAgY3NzO1xyXG4gICAgICAgIGNzcyA9ICc8c3R5bGUgY2xhc3M9XCJyZW5kZXItdGhlbWVcIiB0eXBlPVwidGV4dC9jc3NcIj4nO1xyXG5cclxuICAgICAgICAvLyBzZXQgY29sb3JcclxuICAgICAgICBpZiAoIHNwZWNbJ2JhY2tncm91bmQtY29sb3InXSApIHtcclxuICAgICAgICAgICAgY3NzICs9IHRoZW1lICsgJyAnICsgc2VsZWN0b3IgKyAne2JhY2tncm91bmQtY29sb3I6JytzcGVjWydiYWNrZ3JvdW5kLWNvbG9yJ10rJzt9JztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCBzcGVjLmNvbG9yICkge1xyXG4gICAgICAgICAgICBjc3MgKz0gdGhlbWUgKyAnICcgKyBzZWxlY3RvciArICd7Y29sb3I6JyArIHNwZWMuY29sb3IgKyAnO30nO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gc2V0IDpob3ZlciBjb2xvclxyXG4gICAgICAgIGlmICggcGFyZW50U2VsZWN0b3IgKSB7XHJcbiAgICAgICAgICAgIGlmICggc3BlY1snYmFja2dyb3VuZC1jb2xvcjpob3ZlciddICkge1xyXG4gICAgICAgICAgICAgICAgY3NzICs9IHRoZW1lICsgJyAnK3BhcmVudFNlbGVjdG9yKyc6aG92ZXIgJytzZWxlY3RvcisnIHtiYWNrZ3JvdW5kLWNvbG9yOicrc3BlY1snYmFja2dyb3VuZC1jb2xvcjpob3ZlciddKyc7fSc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCBzcGVjWydjb2xvcjpob3ZlciddICkge1xyXG4gICAgICAgICAgICAgICAgY3NzICs9IHRoZW1lICsgJyAnK3BhcmVudFNlbGVjdG9yKyc6aG92ZXIgJytzZWxlY3RvcisnIHtjb2xvcjonK3NwZWNbJ2NvbG9yOmhvdmVyJ10rJzt9JztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmICggc3BlY1snYmFja2dyb3VuZC1jb2xvcjpob3ZlciddICkge1xyXG4gICAgICAgICAgICAgICAgY3NzICs9IHRoZW1lICsgJyAnK3NlbGVjdG9yKyc6aG92ZXIge2JhY2tncm91bmQtY29sb3I6JytzcGVjWydiYWNrZ3JvdW5kLWNvbG9yOmhvdmVyJ10rJzt9JztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIHNwZWNbJ2NvbG9yOmhvdmVyJ10gKSB7XHJcbiAgICAgICAgICAgICAgICBjc3MgKz0gdGhlbWUgKyAnICcrc2VsZWN0b3IrJzpob3ZlciB7Y29sb3I6JytzcGVjWydjb2xvcjpob3ZlciddKyc7fSc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIHNldCBib3JkZXJzXHJcbiAgICAgICAgaWYgKCBzcGVjWyd0ZXh0LXNoYWRvdyddICkge1xyXG4gICAgICAgICAgICBjc3MgKz0gdGhlbWUgKyAnICcgKyBzZWxlY3RvciArICd7JyArIGdldE91dGxpbmVDc3MoICd0ZXh0LXNoYWRvdycsIHNwZWNbJ3RleHQtc2hhZG93J10gKSArICc7fSc7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIHNwZWMuYm9yZGVyICkge1xyXG4gICAgICAgICAgICBjc3MgKz0gdGhlbWUgKyAnICcgKyBzZWxlY3RvciArICd7JyArIGdldE91dGxpbmVDc3MoICdib3JkZXInLCBzcGVjLmJvcmRlciApICsgJzt9JztcclxuICAgICAgICB9XHJcbiAgICAgICAgY3NzICs9ICc8L3N0eWxlPic7XHJcbiAgICAgICAgJCggZG9jdW1lbnQuYm9keSApLnByZXBlbmQoIGNzcyApO1xyXG4gICAgfTtcclxuXHJcbiAgICBtb2R1bGUuZXhwb3J0cyA9IFJlbmRlclRoZW1lO1xyXG59KCkpOyIsIi8qXHJcbiAqIENvcHlyaWdodCAoYykgMjAxMyBPY3VsdXMgSW5mbyBJbmMuXHJcbiAqIGh0dHA6Ly93d3cub2N1bHVzaW5mby5jb20vXHJcbiAqXHJcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuICpcclxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weSBvZlxyXG4gKiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluXHJcbiAqIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG9cclxuICogdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXNcclxuICogb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvXHJcbiAqIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcclxuXHJcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbFxyXG4gKiBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxyXG5cclxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxyXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXHJcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcclxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEVcclxuICogU09GVFdBUkUuXHJcbiAqL1xyXG5cclxuKCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICB2YXIgJCA9IHJlcXVpcmUoJ2pxdWVyeScpO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQmFzZSBjb25zdHJ1Y3RvciBmb3IgUmVuZGVyZXIuIFJlbmRlcmVycyBhcmUgZGVzaWduZWQgdG8gcHJvdmlkZSBnZW5lcmljIHJlbmRlcmluZ1xyXG4gICAgICogY2FwYWJpbGl0aWVzIHRoYXQgY2FuIGJlIHJldXNlZCBhY3Jvc3MgYXBwbGljYXRpb25zLlxyXG4gICAgICogQHBhcmFtIHNwZWMge09iamVjdH0gVGhlIHNwZWNpZmljYXRpb24gb2JqZWN0LlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBSZW5kZXJlciggc3BlYyApIHtcclxuICAgICAgICB0aGlzLnNwZWMgPSBzcGVjIHx8IHt9O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogV2hlbiByZW5kZXJpbmcgYSB0aWxlLCB0aGUgcmVuZGVyZXIgd2lsbCBieSBkZWZhdWx0IGFzc3VtZSBlYWNoIGltbWVkaWF0ZSBzaWJsaW5nXHJcbiAgICAgKiBjb3JyZXNwb25kcyB0byBhIGRhdGEgZW50cnkuIFRoaXMgZnVuY3Rpb24gYWxsb3dzIGEgcmVuZGVyZXIgaW1wbGVtZW50YXRpb24gdG9cclxuICAgICAqIHByb3ZpZGUgYSBzZWxlY3RvciBpbiBzaXR1YXRpb25zIHdoZXJlIHRoaXMgaXMgbm90IHRoZSBjYXNlLiBUaGlzIGlzIG9ubHkgcmVsZXZhbnRcclxuICAgICAqIGlmIHRoZSBob29rIGNhbGxiYWNrIGlzIHNldC5cclxuICAgICAqIEByZXR1cm5zIHtib29sZWFuIHx8IHN0cmluZ31cclxuICAgICAqL1xyXG4gICAgUmVuZGVyZXIucHJvdG90eXBlLmdldEVudHJ5U2VsZWN0b3IgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogVGhlIGNlbnRyYWwgcmVuZGVyaW5nIGZ1bmN0aW9uLiBUaGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCBmb3IgZXZlcnkgdGlsZSBjb250YWluaW5nIGRhdGEuXHJcbiAgICAgKiBSZXR1cm5zIGFuIG9iamVjdCBjb250YWluaW5nIHRoZSB0aWxlcyBodG1sLCBhbG9uZyB3aXRoIGFuIGFycmF5IG9mIGVhY2ggZGF0YSBlbnRyeS4gVGhlXHJcbiAgICAgKiBpbXBsZW1lbnRhdGlvbiBvZiB0aGlzIGZ1bmN0aW9uIGlzIHVuaXF1ZSB0byBlYWNoIHJlbmRlcmVyLlxyXG4gICAgICogQHJldHVybnMge3todG1sOiBzdHJpbmcsIGVudHJpZXM6IEFycmF5fX1cclxuICAgICAqL1xyXG4gICAgUmVuZGVyZXIucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGh0bWw6IFwiXCIsXHJcbiAgICAgICAgICAgIGVudHJpZXM6IFtdXHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgaG9vayBjYWxsYmFjayBleGVjdXRvciBmdW5jdGlvbi4gSWYgYSBob29rIGZ1bmN0aW9uIGlzIHByb3ZpZGVkIHRvIHRoZSByZW5kZXJlciwgdGhpc1xyXG4gICAgICogd2lsbCBleGVjdXRlIGl0IHBhc3NpbmcgdGhlIHJlc3BlY3RpdmUgZWxlbWVudCBhbmQgZGF0YSBlbnRyeSBhbG9uZyB3aXRoIGFsbCBlbnRyaWVzIGFuZFxyXG4gICAgICogdGhlIHJhdyB0aWxlIGRhdGEuXHJcbiAgICAgKiBAcGFyYW0gZWxlbWVudHMge0hUTUxDb2xsZWN0aW9ufSBBIGNvbGxlY3Rpb24gb2YgaHRtbCBlbGVtZW50cy5cclxuICAgICAqIEBwYXJhbSBlbnRyaWVzICB7QXJyYXl9IFRoZSBhcnJheSBvZiBhbGwgZGF0YSBlbnRyaWVzLlxyXG4gICAgICogQHBhcmFtIGRhdGEgICAgIHtPYmplY3R9IFRoZSByYXcgdGlsZSBkYXRhIG9iamVjdC5cclxuICAgICAqL1xyXG4gICAgUmVuZGVyZXIucHJvdG90eXBlLmhvb2sgPSBmdW5jdGlvbiggZWxlbWVudHMsIGVudHJpZXMsIGRhdGEgKSB7XHJcbiAgICAgICAgdmFyIGhvb2sgPSB0aGlzLnNwZWMuaG9vayxcclxuICAgICAgICAgICAgJGVsZW1lbnRzO1xyXG4gICAgICAgIGlmICggaG9vayAmJiB0eXBlb2YgaG9vayA9PT0gXCJmdW5jdGlvblwiICkge1xyXG4gICAgICAgICAgICAvLyBnZXQgdGhlIGVudHJpZXNcclxuICAgICAgICAgICAgJGVsZW1lbnRzID0gJCggZWxlbWVudHMgKTtcclxuICAgICAgICAgICAgLy8gaWYgZW50cnkgc2VsZWN0b3IgaXMgc2V0LCB1c2UgaXQgdG8gc2VsZWN0IGVudHJpZXNcclxuICAgICAgICAgICAgaWYgKCB0aGlzLmdldEVudHJ5U2VsZWN0b3IoKSApIHtcclxuICAgICAgICAgICAgICAgICRlbGVtZW50cyA9ICRlbGVtZW50cy5maW5kKCB0aGlzLmdldEVudHJ5U2VsZWN0b3IoKSApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIGNhbGwgZW50cnkgZnVuY3Rpb24gb24gZWFjaCBlbnRyeVxyXG4gICAgICAgICAgICAkZWxlbWVudHMuZWFjaCggZnVuY3Rpb24oIGluZGV4LCBlbGVtICkge1xyXG4gICAgICAgICAgICAgICAgaG9vayggZWxlbSwgZW50cmllc1sgaW5kZXggXSwgZW50cmllcywgZGF0YSApO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIG1vZHVsZS5leHBvcnRzID0gUmVuZGVyZXI7XHJcbn0oKSk7IiwiLypcclxuICogQ29weXJpZ2h0IChjKSAyMDEzIE9jdWx1cyBJbmZvIEluYy5cclxuICogaHR0cDovL3d3dy5vY3VsdXNpbmZvLmNvbS9cclxuICpcclxuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKlxyXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5IG9mXHJcbiAqIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW5cclxuICogdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0b1xyXG4gKiB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllc1xyXG4gKiBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG9cclxuICogc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxyXG5cclxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsXHJcbiAqIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXHJcblxyXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXHJcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxyXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcclxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxyXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxyXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRVxyXG4gKiBTT0ZUV0FSRS5cclxuICovXHJcblxyXG4oIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIG1vZHVsZS5leHBvcnRzID0ge1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBSZXR1cm5zIGEgeSBvZmZzZXQgcmVxdWlyZWQgdG8gdmVydGljYWwgY2VudHJlIGEgbnVtYmVyIG9mIGVudHJpZXMgYmFzZWRcclxuICAgICAgICAgKiBvbiBzcGFjaW5nIGFuZCBvZmZzZXRcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSBudW1FbnRyaWVzIHtpbnR9IG51bWJlciBvZiBlbnRyaWVzIHRvIHJlbmRlclxyXG4gICAgICAgICAqIEBwYXJhbSBzcGFjaW5nICAgIHtpbnR9IHRoZSBzcGFjaW5nIGJldHdlZW4gZW50cmllcyBpbiBwaXhlbHNcclxuICAgICAgICAgKiBAcGFyYW0gb2Zmc2V0ICAgICB7aW50fSB0aGUgb2Zmc2V0IGZyb20gdGhlIHRvcCBvZiB0aGUgdGlsZSB0byBjZW50cmUgb24gaW4gcGl4ZWxzXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0WU9mZnNldDogZnVuY3Rpb24oIG51bUVudHJpZXMsIHNwYWNpbmcsIG9mZnNldCApIHtcclxuICAgICAgICAgICAgcmV0dXJuIG9mZnNldCAtICggKCAoIG51bUVudHJpZXMgLSAxKSAvIDIgKSApICogc3BhY2luZztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBSZXR1cm5zIGEgZm9udCBzaXplIGJhc2VkIG9uIHRoZSBwZXJjZW50YWdlIG9mIHR3ZWV0cyByZWxhdGl2ZSB0byB0aGUgdG90YWwgY291bnRcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSBjb3VudCAgICAgIHtpbnR9IGxvY2FsIGNvdW50XHJcbiAgICAgICAgICogQHBhcmFtIHRvdGFsQ291bnQge2ludH0gZ2xvYmFsIGNvdW50XHJcbiAgICAgICAgICogQHBhcmFtIFtvcHRpb25zXSAgICB7T2JqZWN0fSBvcHRpb25zIG9iamVjdCB0byBzZXQgbWluIGFuZCBtYXggZm9udCBzaXplIGFuZCBiaWFzIChvcHRpb25hbClcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRGb250U2l6ZTogZnVuY3Rpb24oIGNvdW50LCB0b3RhbENvdW50LCBvcHRpb25zICkge1xyXG4gICAgICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcclxuICAgICAgICAgICAgdmFyIE1BWF9GT05UX1NJWkUgPSBvcHRpb25zLm1heEZvbnRTaXplIHx8IDIyLFxyXG4gICAgICAgICAgICAgICAgTUlOX0ZPTlRfU0laRSA9IG9wdGlvbnMubWluRm9udFNpemUgfHwgMTIsXHJcbiAgICAgICAgICAgICAgICBCSUFTID0gb3B0aW9ucy5iaWFzIHx8IDAsXHJcbiAgICAgICAgICAgICAgICBGT05UX1JBTkdFID0gTUFYX0ZPTlRfU0laRSAtIE1JTl9GT05UX1NJWkUsXHJcbiAgICAgICAgICAgICAgICBwZXJjZW50YWdlID0gKCBjb3VudCAvIHRvdGFsQ291bnQgKSB8fCAwLFxyXG4gICAgICAgICAgICAgICAgc2l6ZSA9ICggcGVyY2VudGFnZSAqIEZPTlRfUkFOR0UgKSArIE1JTl9GT05UX1NJWkU7XHJcbiAgICAgICAgICAgIHNpemUgPSBNYXRoLm1pbiggTWF0aC5tYXgoIHNpemUsIE1JTl9GT05UX1NJWkUpLCBNQVhfRk9OVF9TSVpFICk7XHJcbiAgICAgICAgICAgIHJldHVybiBNYXRoLm1pbiggTWF0aC5tYXgoIHNpemUrQklBUywgTUlOX0ZPTlRfU0laRSksIE1BWF9GT05UX1NJWkUgKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUcmF2ZXJzZXMgYW4gb2JqZWN0IHRvIHJldHVybiBhIG5lc3RlZCBhdHRyaWJ1dGVcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSBvYmogICAgICAgIHtPYmplY3R9IHRoZSBvYmplY3QgdG8gdHJhdmVyc2VcclxuICAgICAgICAgKiBAcGFyYW0gYXR0cmliUGF0aCB7U3RyaW5nfSBwZXJpb2QgZGVsaW1pdGVkIGF0dHJpYnV0ZSBwYXRoXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0QXR0cmlidXRlVmFsdWU6IGZ1bmN0aW9uKCBvYmosIGF0dHJpYlBhdGggKSB7XHJcbiAgICAgICAgICAgIHZhciBhdHRyaWJzID0gYXR0cmliUGF0aC5zcGxpdCgnLicpLFxyXG4gICAgICAgICAgICAgICAgYXR0cmliLFxyXG4gICAgICAgICAgICAgICAgaTtcclxuICAgICAgICAgICAgYXR0cmliID0gb2JqO1xyXG4gICAgICAgICAgICBmb3IgKGk9MDsgaTxhdHRyaWJzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBhdHRyaWIgPSBhdHRyaWJbIGF0dHJpYnNbaV0gXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gYXR0cmliO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIENvbnZlcnRzIGEgaGV4Y29kZSBjb2xvciB0byBpdHMgUkdCIGNvdW50ZXIgcGFydC5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSBoZXgge1N0cmluZ30gaGV4IGNvZGUgY29sb3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBoZXhUb1JnYjogZnVuY3Rpb24oaGV4KSB7XHJcbiAgICAgICAgICAgIHZhciBiaWdpbnQ7XHJcbiAgICAgICAgICAgIC8vIHJlbW92ZSAjXHJcbiAgICAgICAgICAgIGhleCA9IGhleC5yZXBsYWNlKC8jLywgJycpO1xyXG4gICAgICAgICAgICAvLyBpZiBvbmx5IDMgaGV4IHZhbHVlcyBhcmUgcHJvdmlkZWQsIGV4cGFuZCBpbnRvIDYgZGlnaXQgaGV4IGNvZGVcclxuICAgICAgICAgICAgaWYgKCBoZXgubGVuZ3RoID09PSAzICkge1xyXG4gICAgICAgICAgICAgICAgaGV4ID0gaGV4WzBdICsgaGV4WzBdICsgaGV4WzFdICsgaGV4WzFdICsgaGV4WzJdICsgaGV4WzJdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGJpZ2ludCA9IHBhcnNlSW50KGhleCwgMTYpO1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgcjogKGJpZ2ludCA+PiAxNikgJiAyNTUsXHJcbiAgICAgICAgICAgICAgICBnOiAoYmlnaW50ID4+IDgpICYgMjU1LFxyXG4gICAgICAgICAgICAgICAgYjogYmlnaW50ICYgMjU1XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQ29udmVydHMgYW4gUkdCIGNvbG9yIHRvIGl0cyBoZXhjb2RlIGNvdW50ZXIgcGFydC5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSByZ2Ige09iamVjdH0gUkdCIGNvbG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcmdiVG9IZXg6IGZ1bmN0aW9uKCByZ2IgKSB7XHJcbiAgICAgICAgICAgIHZhciByID0gcmdiLnIsXHJcbiAgICAgICAgICAgICAgICBnID0gcmdiLmcsXHJcbiAgICAgICAgICAgICAgICBiID0gcmdiLmI7XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGNvbXBvbmVudFRvSGV4KGMpIHtcclxuICAgICAgICAgICAgICAgIHZhciBoZXggPSBjLnRvU3RyaW5nKDE2KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiAoaGV4Lmxlbmd0aCA9PT0gMSkgPyBcIjBcIiArIGhleCA6IGhleDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gXCIjXCIgKyBjb21wb25lbnRUb0hleCggTWF0aC5mbG9vcihyKSkgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50VG9IZXgoIE1hdGguZmxvb3IoZykpICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudFRvSGV4KCBNYXRoLmZsb29yKGIpKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBJbmNyZWFzZXMgdGhlIGJyaWdodG5lc3Mgb2YgYSBoZXhjb2RlIGNvbG9yIGJ5IGEgcGVyY2VudGFnZSBmYWN0b3JcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSBoZXggICAge1N0cmluZ30gaGV4IGNvZGUgY29sb3JcclxuICAgICAgICAgKiBAcGFyYW0gZmFjdG9yIHtmbG9hdH0gIHBlcmNlbnRhZ2UgZmFjdG9yIG9mIGluY3JlYXNlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaGV4QnJpZ2h0bmVzczogZnVuY3Rpb24oIGhleCwgZmFjdG9yICkge1xyXG4gICAgICAgICAgICB2YXIgcmdiID0gdGhpcy5oZXhUb1JnYiggaGV4ICk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJnYlRvSGV4KCB7IHI6IE1hdGgubWluKCBNYXRoLm1heCggMCwgcmdiLnIgKiBmYWN0b3IgKSwgMjU1ICksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGc6IE1hdGgubWluKCBNYXRoLm1heCggMCwgcmdiLmcgKiBmYWN0b3IgKSwgMjU1ICksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI6IE1hdGgubWluKCBNYXRoLm1heCggMCwgcmdiLmIgKiBmYWN0b3IgKSwgMjU1ICkgfSApO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIENvbnZlcnRzIGEgaGV4Y29kZSBjb2xvciB0byBncmV5c2NhbGUgdXNpbmcgYWx1bWlub3NpdHkgYmFzZWQgbW9kZWxcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSBoZXgge1N0cmluZ30gaGV4IGNvZGUgY29sb3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBoZXhHcmV5c2NhbGU6IGZ1bmN0aW9uKCBoZXggKSB7XHJcbiAgICAgICAgICAgIHZhciByZ2IgPSB0aGlzLmhleFRvUmdiKCBoZXggKSxcclxuICAgICAgICAgICAgICAgIGF2ZyA9ICggcmdiLnIgKiAwLjIxICsgcmdiLmcgKiAwLjcyICsgcmdiLmIgKiAwLjA3ICk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJnYlRvSGV4KHtcclxuICAgICAgICAgICAgICAgIHI6IGF2ZyxcclxuICAgICAgICAgICAgICAgIGc6IGF2ZyxcclxuICAgICAgICAgICAgICAgIGI6IGF2Z1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBCbGVuZHMgdHdvIGhleGNvZGUgY29sb3JzIHRvZ2V0aGVyLCBkZWZhdWx0cyB0byA1MC81MCBibGVuZFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIGhleEEge1N0cmluZ30gaGV4IGNvZGUgY29sb3IgQVxyXG4gICAgICAgICAqIEBwYXJhbSBoZXhCIHtTdHJpbmd9IGhleCBjb2RlIGNvbG9yIEJcclxuICAgICAgICAgKiBAcGFyYW0gW2FJbnRvQlBlcmNlbnRhZ2VdIHtmbG9hdH0gcGVyY2VudGFnZSB0byBibGVuZCBoZXhBIGludG8gaGV4QiAob3B0aW9uYWwpXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaGV4QmxlbmQ6IGZ1bmN0aW9uKCBoZXhBLCBoZXhCLCBhSW50b0JQZXJjZW50YWdlICkge1xyXG4gICAgICAgICAgICB2YXIgYVBlcmMgPSBNYXRoLm1pbiggMSwgYUludG9CUGVyY2VudGFnZSApIHx8IDAuNSxcclxuICAgICAgICAgICAgICAgIGJQZXJjID0gMSAtIGFQZXJjLFxyXG4gICAgICAgICAgICAgICAgcmdiMSA9IHRoaXMuaGV4VG9SZ2IoIGhleEEgKSxcclxuICAgICAgICAgICAgICAgIHJnYjIgPSB0aGlzLmhleFRvUmdiKCBoZXhCICk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZ2JUb0hleCh7XHJcbiAgICAgICAgICAgICAgICByIDogKCByZ2IxLnIqYVBlcmMgKyByZ2IyLnIqYlBlcmMgKSxcclxuICAgICAgICAgICAgICAgIGcgOiAoIHJnYjEuZyphUGVyYyArIHJnYjIuZypiUGVyYyApLFxyXG4gICAgICAgICAgICAgICAgYiA6ICggcmdiMS5iKmFQZXJjICsgcmdiMi5iKmJQZXJjIClcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH07XHJcblxyXG59KCkpOyIsIi8qXHJcbiAqIENvcHlyaWdodCAoYykgMjAxMyBPY3VsdXMgSW5mbyBJbmMuXHJcbiAqIGh0dHA6Ly93d3cub2N1bHVzaW5mby5jb20vXHJcbiAqXHJcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuICpcclxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weSBvZlxyXG4gKiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluXHJcbiAqIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG9cclxuICogdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXNcclxuICogb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvXHJcbiAqIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcclxuXHJcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbFxyXG4gKiBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxyXG5cclxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxyXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXHJcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcclxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEVcclxuICogU09GVFdBUkUuXHJcbiAqL1xyXG5cclxuKCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICB2YXIgUmVuZGVyZXIgPSByZXF1aXJlKCcuL1JlbmRlcmVyJyksXHJcbiAgICAgICAgUmVuZGVyZXJVdGlsID0gcmVxdWlyZSgnLi9SZW5kZXJlclV0aWwnKSxcclxuICAgICAgICBNQVhfV09SRFNfRElTUExBWUVEID0gOCxcclxuICAgICAgICBpbmplY3RDc3M7XHJcblxyXG4gICAgaW5qZWN0Q3NzID0gZnVuY3Rpb24oIHNwZWMgKSB7XHJcbiAgICAgICAgdmFyIGk7XHJcbiAgICAgICAgaWYgKCBzcGVjLnRleHQudGhlbWVzICkge1xyXG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgc3BlYy50ZXh0LnRoZW1lcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgc3BlYy50ZXh0LnRoZW1lc1tpXS5pbmplY3RUaGVtZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0b3I6IFwiLnRleHQtYnktZnJlcXVlbmN5LWxhYmVsXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50U2VsZWN0b3I6IFwiLnRleHQtYnktZnJlcXVlbmN5LWVudHJ5XCJcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICggc3BlYy5mcmVxdWVuY3kudGhlbWVzICkge1xyXG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgc3BlYy5mcmVxdWVuY3kudGhlbWVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBzcGVjLmZyZXF1ZW5jeS50aGVtZXNbaV0uaW5qZWN0VGhlbWUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdG9yOiBcIi50ZXh0LWJ5LWZyZXF1ZW5jeS1iYXJcIixcclxuICAgICAgICAgICAgICAgICAgICBwYXJlbnRTZWxlY3RvcjogXCIudGV4dC1ieS1mcmVxdWVuY3ktZW50cnlcIlxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIFRleHRCeUZyZXF1ZW5jeVJlbmRlcmVyKCBzcGVjICkge1xyXG4gICAgICAgIFJlbmRlcmVyLmNhbGwoIHRoaXMsIHNwZWMgKTtcclxuICAgICAgICBpbmplY3RDc3MoIHRoaXMuc3BlYyApO1xyXG4gICAgfVxyXG5cclxuICAgIFRleHRCeUZyZXF1ZW5jeVJlbmRlcmVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoIFJlbmRlcmVyLnByb3RvdHlwZSApO1xyXG5cclxuICAgIFRleHRCeUZyZXF1ZW5jeVJlbmRlcmVyLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiggZGF0YSApIHtcclxuXHJcbiAgICAgICAgdmFyIHRleHRLZXkgPSB0aGlzLnNwZWMudGV4dC50ZXh0S2V5LFxyXG4gICAgICAgICAgICBjb3VudEtleSA9IHRoaXMuc3BlYy5mcmVxdWVuY3kuY291bnRLZXksXHJcbiAgICAgICAgICAgIHZhbHVlcyA9IGRhdGEudGlsZS52YWx1ZXNbMF0udmFsdWUsXHJcbiAgICAgICAgICAgIG51bUVudHJpZXMgPSBNYXRoLm1pbiggdmFsdWVzLmxlbmd0aCwgTUFYX1dPUkRTX0RJU1BMQVlFRCApLFxyXG4gICAgICAgICAgICBodG1sID0gJycsXHJcbiAgICAgICAgICAgIGVudHJpZXMgPSBbXSxcclxuICAgICAgICAgICAgdmFsdWUsXHJcbiAgICAgICAgICAgIGVudHJ5VGV4dCxcclxuICAgICAgICAgICAgbWF4UGVyY2VudGFnZSxcclxuICAgICAgICAgICAgcmVsYXRpdmVQZXJjZW50LFxyXG4gICAgICAgICAgICB2aXNpYmlsaXR5LFxyXG4gICAgICAgICAgICBjaGFydFNpemUsXHJcbiAgICAgICAgICAgIGksIGo7XHJcblxyXG4gICAgICAgIC8qXHJcbiAgICAgICAgICAgIFV0aWxpdHkgZnVuY3Rpb24gZm9yIHBvc2l0aW9uaW5nIHRoZSBsYWJlbHNcclxuICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIGdldFlPZmZzZXQoIGluZGV4LCBudW1FbnRyaWVzICkge1xyXG4gICAgICAgICAgICB2YXIgU1BBQ0lORyA9IDIwO1xyXG4gICAgICAgICAgICByZXR1cm4gMTE4IC0gKCAoKCBudW1FbnRyaWVzIC0gMSkgLyAyICkgLSBpbmRleCApICogU1BBQ0lORztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdldENoYXJ0U2l6ZSggdmFsdWUsIGNvdW50S2V5ICkge1xyXG4gICAgICAgICAgICByZXR1cm4gdmFsdWVbIGNvdW50S2V5IF0ubGVuZ3RoO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLypcclxuICAgICAgICAgICAgUmV0dXJucyB0aGUgdG90YWwgY291bnQgZm9yIHNpbmdsZSB2YWx1ZVxyXG4gICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0Q291bnQoIHZhbHVlLCBpbmRleCwgY291bnRLZXkgKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBSZW5kZXJlclV0aWwuZ2V0QXR0cmlidXRlVmFsdWUoIHZhbHVlLCBjb3VudEtleSApW2luZGV4XTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qXHJcbiAgICAgICAgICAgIFJldHVybnMgdGhlIHRvdGFsIHN1bSBjb3VudFxyXG4gICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0Q291bnRBcnJheVN1bSggdmFsdWUsIGNvdW50S2V5ICkge1xyXG4gICAgICAgICAgICB2YXIgc3VtID0gMCwgaTtcclxuICAgICAgICAgICAgZm9yICggaT0wOyBpPHZhbHVlWyBjb3VudEtleSBdLmxlbmd0aDsgaSsrICkge1xyXG4gICAgICAgICAgICAgICAgc3VtICs9IHZhbHVlWyBjb3VudEtleSBdW2ldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBzdW07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKlxyXG4gICAgICAgICAgICBSZXR1cm5zIHRoZSBwZXJjZW50YWdlIGNvdW50XHJcbiAgICAgICAgKi9cclxuICAgICAgICBmdW5jdGlvbiBnZXRQZXJjZW50YWdlKCB2YWx1ZSwgaW5kZXgsIGNvdW50S2V5ICkge1xyXG4gICAgICAgICAgICByZXR1cm4gKCBnZXRDb3VudCggdmFsdWUsIGluZGV4LCBjb3VudEtleSApIC8gZ2V0Q291bnRBcnJheVN1bSggdmFsdWUsIGNvdW50S2V5ICkgKSB8fCAwO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLypcclxuICAgICAgICAgICAgUmV0dXJucyB0aGUgbWF4aW11bSBwZXJjZW50YWdlIGNvdW50XHJcbiAgICAgICAgKi9cclxuICAgICAgICBmdW5jdGlvbiBnZXRNYXhQZXJjZW50YWdlKCB2YWx1ZSwgY291bnRLZXkgKSB7XHJcbiAgICAgICAgICAgIHZhciBpLFxyXG4gICAgICAgICAgICAgICAgcGVyY2VudCxcclxuICAgICAgICAgICAgICAgIGNoYXJ0U2l6ZSA9IGdldENoYXJ0U2l6ZSggdmFsdWUsIGNvdW50S2V5ICksXHJcbiAgICAgICAgICAgICAgICBtYXhQZXJjZW50ID0gMCxcclxuICAgICAgICAgICAgICAgIGNvdW50ID0gZ2V0Q291bnRBcnJheVN1bSggdmFsdWUsIGNvdW50S2V5ICk7XHJcblxyXG4gICAgICAgICAgICBpZiAoY291bnQgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmb3IgKGk9MDsgaTxjaGFydFNpemU7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgLy8gZ2V0IG1heGltdW0gcGVyY2VudFxyXG4gICAgICAgICAgICAgICAgcGVyY2VudCA9IGdldENvdW50KCB2YWx1ZSwgaSwgY291bnRLZXkgKSAvIGNvdW50O1xyXG4gICAgICAgICAgICAgICAgaWYgKHBlcmNlbnQgPiBtYXhQZXJjZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWF4UGVyY2VudCA9IHBlcmNlbnQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG1heFBlcmNlbnQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKGk9MDsgaTxudW1FbnRyaWVzOyBpKyspIHtcclxuXHJcbiAgICAgICAgICAgIHZhbHVlID0gdmFsdWVzW2ldO1xyXG4gICAgICAgICAgICBlbnRyaWVzLnB1c2goIHZhbHVlICk7XHJcbiAgICAgICAgICAgIGVudHJ5VGV4dCA9IFJlbmRlcmVyVXRpbC5nZXRBdHRyaWJ1dGVWYWx1ZSggdmFsdWUsIHRleHRLZXkgKTtcclxuICAgICAgICAgICAgY2hhcnRTaXplID0gZ2V0Q2hhcnRTaXplKCB2YWx1ZSwgY291bnRLZXkgKTtcclxuICAgICAgICAgICAgbWF4UGVyY2VudGFnZSA9IGdldE1heFBlcmNlbnRhZ2UoIHZhbHVlLCBjb3VudEtleSApO1xyXG5cclxuICAgICAgICAgICAgaHRtbCArPSAnPGRpdiBjbGFzcz1cInRleHQtYnktZnJlcXVlbmN5LWVudHJ5XCIgc3R5bGU9XCInXHJcbiAgICAgICAgICAgICAgICAgICsgJ3RvcDonICsgIGdldFlPZmZzZXQoIGksIG51bUVudHJpZXMgKSArICdweDtcIj4nO1xyXG5cclxuICAgICAgICAgICAgLy8gY3JlYXRlIGNoYXJ0XHJcbiAgICAgICAgICAgIGh0bWwgKz0gJzxkaXYgY2xhc3M9XCJ0ZXh0LWJ5LWZyZXF1ZW5jeS1sZWZ0XCI+JztcclxuICAgICAgICAgICAgZm9yIChqPTA7IGo8Y2hhcnRTaXplOyBqKyspIHtcclxuICAgICAgICAgICAgICAgIHJlbGF0aXZlUGVyY2VudCA9ICggZ2V0UGVyY2VudGFnZSggdmFsdWUsIGosIGNvdW50S2V5ICkgLyBtYXhQZXJjZW50YWdlICkgKiAxMDA7XHJcbiAgICAgICAgICAgICAgICB2aXNpYmlsaXR5ID0gKHJlbGF0aXZlUGVyY2VudCA+IDApID8gJycgOiAnaGlkZGVuJztcclxuICAgICAgICAgICAgICAgIHJlbGF0aXZlUGVyY2VudCA9IE1hdGgubWF4KCByZWxhdGl2ZVBlcmNlbnQsIDIwICk7XHJcbiAgICAgICAgICAgICAgICAvLyBjcmVhdGUgYmFyXHJcbiAgICAgICAgICAgICAgICBodG1sICs9ICc8ZGl2IGNsYXNzPVwidGV4dC1ieS1mcmVxdWVuY3ktYmFyXCIgc3R5bGU9XCInXHJcbiAgICAgICAgICAgICAgICAgICAgICArICd2aXNpYmlsaXR5OicrdmlzaWJpbGl0eSsnOydcclxuICAgICAgICAgICAgICAgICAgICAgICsgJ2hlaWdodDonK3JlbGF0aXZlUGVyY2VudCsnJTsnXHJcbiAgICAgICAgICAgICAgICAgICAgICArICd3aWR0aDonKyBNYXRoLmZsb29yKCAoMTA1K2NoYXJ0U2l6ZSkvY2hhcnRTaXplICkgKydweDsnXHJcbiAgICAgICAgICAgICAgICAgICAgICArICd0b3A6JysoMTAwLXJlbGF0aXZlUGVyY2VudCkrJyU7XCI+PC9kaXY+JztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBodG1sICs9ICc8L2Rpdj4nO1xyXG5cclxuICAgICAgICAgICAgLy8gY3JlYXRlIHRhZyBsYWJlbFxyXG4gICAgICAgICAgICBodG1sICs9ICc8ZGl2IGNsYXNzPVwidGV4dC1ieS1mcmVxdWVuY3ktcmlnaHRcIj4nO1xyXG4gICAgICAgICAgICBodG1sICs9ICc8ZGl2IGNsYXNzPVwidGV4dC1ieS1mcmVxdWVuY3ktbGFiZWxcIj4nK2VudHJ5VGV4dCsnPC9kaXY+JztcclxuICAgICAgICAgICAgaHRtbCArPSAnPC9kaXY+JztcclxuICAgICAgICAgICAgaHRtbCArPSAnPC9kaXY+JztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGh0bWw6IGh0bWwsXHJcbiAgICAgICAgICAgIGVudHJpZXM6IGVudHJpZXNcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuXHJcbiAgICBtb2R1bGUuZXhwb3J0cyA9IFRleHRCeUZyZXF1ZW5jeVJlbmRlcmVyO1xyXG59KCkpOyIsIi8qXHJcbiAqIENvcHlyaWdodCAoYykgMjAxMyBPY3VsdXMgSW5mbyBJbmMuXHJcbiAqIGh0dHA6Ly93d3cub2N1bHVzaW5mby5jb20vXHJcbiAqXHJcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuICpcclxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weSBvZlxyXG4gKiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluXHJcbiAqIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG9cclxuICogdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXNcclxuICogb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvXHJcbiAqIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcclxuXHJcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbFxyXG4gKiBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxyXG5cclxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxyXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXHJcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcclxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEVcclxuICogU09GVFdBUkUuXHJcbiAqL1xyXG5cclxuKCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICB2YXIgUmVuZGVyZXIgPSByZXF1aXJlKCcuL1JlbmRlcmVyJyksXHJcbiAgICAgICAgUmVuZGVyZXJVdGlsID0gcmVxdWlyZSgnLi9SZW5kZXJlclV0aWwnKSxcclxuICAgICAgICBNQVhfV09SRFNfRElTUExBWUVEID0gNSxcclxuICAgICAgICBpbmplY3RDc3M7XHJcblxyXG4gICAgaW5qZWN0Q3NzID0gZnVuY3Rpb24oIHNwZWMgKSB7XHJcbiAgICAgICAgdmFyIGk7XHJcbiAgICAgICAgaWYgKCBzcGVjLnRleHQudGhlbWVzICkge1xyXG4gICAgICAgICAgICBmb3IgKCBpPTA7IGk8c3BlYy50ZXh0LnRoZW1lcy5sZW5ndGg7IGkrKyApIHtcclxuICAgICAgICAgICAgICAgIHNwZWMudGV4dC50aGVtZXNbaV0uaW5qZWN0VGhlbWUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdG9yOiBcIi50ZXh0LXNjb3JlLWxhYmVsXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50U2VsZWN0b3I6IFwiLnRleHQtc2NvcmUtZW50cnlcIlxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIFRleHRTY29yZVJlbmRlcmVyKCBzcGVjICkge1xyXG4gICAgICAgIFJlbmRlcmVyLmNhbGwoIHRoaXMsIHNwZWMgKTtcclxuICAgICAgICBpbmplY3RDc3MoIHRoaXMuc3BlYyApO1xyXG4gICAgfVxyXG5cclxuICAgIFRleHRTY29yZVJlbmRlcmVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoIFJlbmRlcmVyLnByb3RvdHlwZSApO1xyXG5cclxuICAgIFRleHRTY29yZVJlbmRlcmVyLnByb3RvdHlwZS5nZXRFbnRyeVNlbGVjdG9yID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIFwiLnRleHQtc2NvcmUtZW50cnlcIjtcclxuICAgIH07XHJcblxyXG4gICAgVGV4dFNjb3JlUmVuZGVyZXIucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uKCBkYXRhICkge1xyXG5cclxuICAgICAgICB2YXIgdGV4dCA9IHRoaXMuc3BlYy50ZXh0LFxyXG4gICAgICAgICAgICB0ZXh0S2V5ID0gdGV4dC50ZXh0S2V5LFxyXG4gICAgICAgICAgICBjb3VudEtleSA9IHRleHQuY291bnRLZXksXHJcbiAgICAgICAgICAgIG1ldGEgPSB0aGlzLm1ldGFbIHRoaXMubWFwLmdldFpvb20oKSBdLFxyXG4gICAgICAgICAgICB2YWx1ZXMgPSBkYXRhLnRpbGUudmFsdWVzWzBdLnZhbHVlLFxyXG4gICAgICAgICAgICBudW1FbnRyaWVzID0gTWF0aC5taW4oIHZhbHVlcy5sZW5ndGgsIE1BWF9XT1JEU19ESVNQTEFZRUQgKSxcclxuICAgICAgICAgICAgZW50cmllcyA9IFtdLFxyXG4gICAgICAgICAgICB0b3RhbENvdW50LFxyXG4gICAgICAgICAgICB5T2Zmc2V0LFxyXG4gICAgICAgICAgICBodG1sID0gJycsXHJcbiAgICAgICAgICAgIHZhbHVlLFxyXG4gICAgICAgICAgICB0ZXh0RW50cnksXHJcbiAgICAgICAgICAgIGZvbnRTaXplLFxyXG4gICAgICAgICAgICB0ZXh0Q291bnQsXHJcbiAgICAgICAgICAgIGk7XHJcblxyXG4gICAgICAgICAvLyBnZXQgbWF4aW11bSBjb3VudCBmb3IgbGF5ZXIgaWYgaXQgZXhpc3RzIGluIG1ldGEgZGF0YVxyXG4gICAgICAgIHRvdGFsQ291bnQgPSBtZXRhLm1pbk1heC5tYXhbIGNvdW50S2V5IF07XHJcbiAgICAgICAgeU9mZnNldCA9IFJlbmRlcmVyVXRpbC5nZXRZT2Zmc2V0KCBudW1FbnRyaWVzLCAzNiwgMTIyICk7XHJcblxyXG4gICAgICAgIGZvciAoaT0wOyBpPG51bUVudHJpZXM7IGkrKykge1xyXG5cclxuICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZXNbaV07XHJcbiAgICAgICAgICAgIGVudHJpZXMucHVzaCggdmFsdWUgKTtcclxuICAgICAgICAgICAgdGV4dEVudHJ5ID0gUmVuZGVyZXJVdGlsLmdldEF0dHJpYnV0ZVZhbHVlKCB2YWx1ZSwgdGV4dEtleSApO1xyXG4gICAgICAgICAgICB0ZXh0Q291bnQgPSBSZW5kZXJlclV0aWwuZ2V0QXR0cmlidXRlVmFsdWUoIHZhbHVlLCBjb3VudEtleSApO1xyXG4gICAgICAgICAgICBmb250U2l6ZSA9IFJlbmRlcmVyVXRpbC5nZXRGb250U2l6ZSggdGV4dENvdW50LCB0b3RhbENvdW50ICk7XHJcblxyXG4gICAgICAgICAgICAvLyBwYXJlbnRcclxuICAgICAgICAgICAgaHRtbCArPSAnPGRpdiBjbGFzcz1cInRleHQtc2NvcmUtZW50cnktcGFyZW50XCIgc3R5bGU9XCJ0b3A6JyArIHlPZmZzZXQgKyAncHg7XCI+JztcclxuXHJcbiAgICAgICAgICAgIC8vIGNyZWF0ZSBlbnRyeVxyXG4gICAgICAgICAgICBodG1sICs9ICc8ZGl2IGNsYXNzPVwidGV4dC1zY29yZS1lbnRyeVwiPic7XHJcbiAgICAgICAgICAgIC8vIGNyZWF0ZSBsYWJlbFxyXG4gICAgICAgICAgICBodG1sICs9ICc8ZGl2IGNsYXNzPVwidGV4dC1zY29yZS1sYWJlbFwiIHN0eWxlPVwiJ1xyXG4gICAgICAgICAgICAgICAgICArICdmb250LXNpemU6JysgZm9udFNpemUgKydweDsnXHJcbiAgICAgICAgICAgICAgICAgICsgJ2xpbmUtaGVpZ2h0OicrIGZvbnRTaXplICsncHg7XCI+Jyt0ZXh0RW50cnkrJzwvZGl2Pic7XHJcbiAgICAgICAgICAgIGh0bWwgKz0gJzwvZGl2Pic7XHJcbiAgICAgICAgICAgIGh0bWwgKz0gJzwvZGl2Pic7XHJcblxyXG4gICAgICAgICAgICBodG1sICs9ICc8ZGl2IGNsYXNzPVwiY2xlYXJcIj48L2Rpdj4nO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgaHRtbDogaHRtbCxcclxuICAgICAgICAgICAgZW50cmllczogZW50cmllc1xyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG5cclxuICAgIG1vZHVsZS5leHBvcnRzID0gVGV4dFNjb3JlUmVuZGVyZXI7XHJcbn0oKSk7IiwiLypcclxuICogQ29weXJpZ2h0IChjKSAyMDEzIE9jdWx1cyBJbmZvIEluYy5cclxuICogaHR0cDovL3d3dy5vY3VsdXNpbmZvLmNvbS9cclxuICpcclxuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKlxyXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5IG9mXHJcbiAqIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW5cclxuICogdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0b1xyXG4gKiB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllc1xyXG4gKiBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG9cclxuICogc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxyXG5cclxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsXHJcbiAqIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXHJcblxyXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXHJcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxyXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcclxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxyXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxyXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRVxyXG4gKiBTT0ZUV0FSRS5cclxuICovXHJcblxyXG4oIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIHZhciAkID0gcmVxdWlyZSgnanF1ZXJ5JyksXHJcbiAgICAgICAgUmVuZGVyZXIgPSByZXF1aXJlKCcuL1JlbmRlcmVyJyksXHJcbiAgICAgICAgUmVuZGVyZXJVdGlsID0gcmVxdWlyZSgnLi9SZW5kZXJlclV0aWwnKSxcclxuICAgICAgICBNQVhfV09SRFNfRElTUExBWUVEID0gMTAsXHJcbiAgICAgICAgSE9SSVpPTlRBTF9PRkZTRVQgPSAxMCxcclxuICAgICAgICBWRVJUSUNBTF9PRkZTRVQgPSAyNCxcclxuICAgICAgICBzcGlyYWxQb3NpdGlvbixcclxuICAgICAgICBpbnRlcnNlY3RUZXN0LFxyXG4gICAgICAgIG92ZXJsYXBUZXN0LFxyXG4gICAgICAgIGludGVyc2VjdFdvcmQsXHJcbiAgICAgICAgZ2V0V29yZERpbWVuc2lvbnMsXHJcbiAgICAgICAgY3JlYXRlV29yZENsb3VkLFxyXG4gICAgICAgIGluamVjdENzcztcclxuXHJcbiAgICBpbmplY3RDc3MgPSBmdW5jdGlvbiggc3BlYyApIHtcclxuICAgICAgICB2YXIgaTtcclxuICAgICAgICBpZiAoIHNwZWMudGV4dC50aGVtZXMgKSB7XHJcbiAgICAgICAgICAgIGZvciAoIGkgPSAwOyBpIDwgc3BlYy50ZXh0LnRoZW1lcy5sZW5ndGg7IGkrKyApIHtcclxuICAgICAgICAgICAgICAgIHNwZWMudGV4dC50aGVtZXNbaV0uaW5qZWN0VGhlbWUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdG9yOiBcIi53b3JkLWNsb3VkLWxhYmVsXCJcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEdpdmVuIGFuIGluaXRpYWwgcG9zaXRpb24sIHJldHVybiBhIG5ldyBwb3NpdGlvbiwgaW5jcmVtZW50YWxseSBzcGlyYWxsZWRcclxuICAgICAqIG91dHdhcmRzLlxyXG4gICAgICovXHJcbiAgICBzcGlyYWxQb3NpdGlvbiA9IGZ1bmN0aW9uKCBwb3MgKSB7XHJcbiAgICAgICAgdmFyIHBpMiA9IDIgKiBNYXRoLlBJLFxyXG4gICAgICAgICAgICBjaXJjID0gcGkyICogcG9zLnJhZGl1cyxcclxuICAgICAgICAgICAgaW5jID0gKCBwb3MuYXJjTGVuZ3RoID4gY2lyYy8xMCkgPyBjaXJjLzEwIDogcG9zLmFyY0xlbmd0aCxcclxuICAgICAgICAgICAgZGEgPSBpbmMgLyBwb3MucmFkaXVzLFxyXG4gICAgICAgICAgICBudCA9IChwb3MudCtkYSk7XHJcbiAgICAgICAgaWYgKG50ID4gcGkyKSB7XHJcbiAgICAgICAgICAgIG50ID0gbnQgJSBwaTI7XHJcbiAgICAgICAgICAgIHBvcy5yYWRpdXMgPSBwb3MucmFkaXVzICsgcG9zLnJhZGl1c0luYztcclxuICAgICAgICB9XHJcbiAgICAgICAgcG9zLnQgPSBudDtcclxuICAgICAgICBwb3MueCA9IHBvcy5yYWRpdXMgKiBNYXRoLmNvcyhudCk7XHJcbiAgICAgICAgcG9zLnkgPSBwb3MucmFkaXVzICogTWF0aC5zaW4obnQpO1xyXG4gICAgICAgIHJldHVybiBwb3M7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogIFJldHVybnMgdHJ1ZSBpZiBib3VuZGluZyBib3ggYSBpbnRlcnNlY3RzIGJvdW5kaW5nIGJveCBiXHJcbiAgICAgKi9cclxuICAgIGludGVyc2VjdFRlc3QgPSBmdW5jdGlvbiggYSwgYiApIHtcclxuICAgICAgICByZXR1cm4gKE1hdGguYWJzKGEueCAtIGIueCkgKiAyIDwgKGEud2lkdGggKyBiLndpZHRoKSkgJiZcclxuICAgICAgICAgICAgICAgKE1hdGguYWJzKGEueSAtIGIueSkgKiAyIDwgKGEuaGVpZ2h0ICsgYi5oZWlnaHQpKTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiAgUmV0dXJucyB0cnVlIGlmIGJvdW5kaW5nIGJveCBhIGlzIG5vdCBmdWxseSBjb250YWluZWQgaW5zaWRlIGJvdW5kaW5nIGJveCBiXHJcbiAgICAgKi9cclxuICAgIG92ZXJsYXBUZXN0ID0gZnVuY3Rpb24oIGEsIGIgKSB7XHJcbiAgICAgICAgcmV0dXJuICggYS54ICsgYS53aWR0aC8yID4gYi54K2Iud2lkdGgvMiB8fFxyXG4gICAgICAgICAgICAgICAgIGEueCAtIGEud2lkdGgvMiA8IGIueC1iLndpZHRoLzIgfHxcclxuICAgICAgICAgICAgICAgICBhLnkgKyBhLmhlaWdodC8yID4gYi55K2IuaGVpZ2h0LzIgfHxcclxuICAgICAgICAgICAgICAgICBhLnkgLSBhLmhlaWdodC8yIDwgYi55LWIuaGVpZ2h0LzIgKTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVjayBpZiBhIHdvcmQgaW50ZXJzZWN0cyBhbm90aGVyIHdvcmQsIG9yIGlzIG5vdCBmdWxseSBjb250YWluZWQgaW4gdGhlXHJcbiAgICAgKiB0aWxlIGJvdW5kaW5nIGJveFxyXG4gICAgICovXHJcbiAgICBpbnRlcnNlY3RXb3JkID0gZnVuY3Rpb24oIHBvc2l0aW9uLCBkaW1lbnNpb25zLCBjbG91ZCwgYmIgKSB7XHJcbiAgICAgICAgdmFyIGJveCA9IHtcclxuICAgICAgICAgICAgICAgIHg6IHBvc2l0aW9uLngsXHJcbiAgICAgICAgICAgICAgICB5OiBwb3NpdGlvbi55LFxyXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiBkaW1lbnNpb25zLmhlaWdodCxcclxuICAgICAgICAgICAgICAgIHdpZHRoOiBkaW1lbnNpb25zLndpZHRoXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGk7XHJcbiAgICAgICAgZm9yICggaT0wOyBpPGNsb3VkLmxlbmd0aDsgaSsrICkge1xyXG4gICAgICAgICAgICBpZiAoIGludGVyc2VjdFRlc3QoIGJveCwgY2xvdWRbaV0gKSApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIG1ha2Ugc3VyZSBpdCBkb2Vzbid0IGludGVyc2VjdCB0aGUgYm9yZGVyO1xyXG4gICAgICAgIGlmICggb3ZlcmxhcFRlc3QoIGJveCwgYmIgKSApIHtcclxuICAgICAgICAgICAgLy8gaWYgaXQgaGl0cyBhIGJvcmRlciwgaW5jcmVtZW50IGNvbGxpc2lvbiBjb3VudFxyXG4gICAgICAgICAgICAvLyBhbmQgZXh0ZW5kIGFyYyBsZW5ndGhcclxuICAgICAgICAgICAgcG9zaXRpb24uY29sbGlzaW9ucysrO1xyXG4gICAgICAgICAgICBwb3NpdGlvbi5hcmNMZW5ndGggPSBwb3NpdGlvbi5yYWRpdXM7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0aGUgcGl4ZWwgZGltZW5zaW9ucyBvZiB0aGUgbGFiZWxcclxuICAgICAqL1xyXG4gICAgZ2V0V29yZERpbWVuc2lvbnMgPSBmdW5jdGlvbiggc3RyLCBmb250U2l6ZSApIHtcclxuICAgICAgICB2YXIgJHRlbXAsXHJcbiAgICAgICAgICAgIGRpbWVuc2lvbiA9IHt9O1xyXG4gICAgICAgICR0ZW1wID0gJCgnPGRpdiBjbGFzcz1cIndvcmQtY2xvdWQtbGFiZWwtdGVtcFwiIHN0eWxlPVwiZm9udC1zaXplOicrZm9udFNpemUrJ3B4O1wiPicrc3RyKyc8L2Rpdj4nKTtcclxuICAgICAgICAkKCdib2R5JykuYXBwZW5kKCAkdGVtcCApO1xyXG4gICAgICAgIGRpbWVuc2lvbi53aWR0aCA9ICR0ZW1wLm91dGVyV2lkdGgoKTtcclxuICAgICAgICBkaW1lbnNpb24uaGVpZ2h0ID0gJHRlbXAub3V0ZXJIZWlnaHQoKTtcclxuICAgICAgICAkdGVtcC5yZW1vdmUoKTtcclxuICAgICAgICByZXR1cm4gZGltZW5zaW9uO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdGhlIHdvcmQgY2xvdWQgd29yZHMgY29udGFpbmluZyBmb250IHNpemUgYW5kIHggYW5kIHkgY29vcmRpbmF0ZXNcclxuICAgICAqL1xyXG4gICAgY3JlYXRlV29yZENsb3VkID0gZnVuY3Rpb24oIHdvcmRDb3VudHMsIG1heENvdW50ICkge1xyXG4gICAgICAgIHZhciBib3VuZGluZ0JveCA9IHtcclxuICAgICAgICAgICAgICAgIHdpZHRoOiAyNTYgLSBIT1JJWk9OVEFMX09GRlNFVCoyLFxyXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiAyNTYgLSBWRVJUSUNBTF9PRkZTRVQqMixcclxuICAgICAgICAgICAgICAgIHg6IDAsXHJcbiAgICAgICAgICAgICAgICB5OiAwXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGNsb3VkID0gW10sXHJcbiAgICAgICAgICAgIGksIHdvcmQsIGNvdW50LCBkaW0sXHJcbiAgICAgICAgICAgIGZvbnRTaXplLCBwb3M7XHJcbiAgICAgICAgLy8gc29ydCB3b3JkcyBieSBmcmVxdWVuY3lcclxuICAgICAgICB3b3JkQ291bnRzLnNvcnQoIGZ1bmN0aW9uKCBhLCBiICkge1xyXG4gICAgICAgICAgICByZXR1cm4gYi5jb3VudCAtIGEuY291bnQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy8gYXNzZW1ibGUgd29yZCBjbG91ZFxyXG4gICAgICAgIGZvciAoIGk9MDsgaTx3b3JkQ291bnRzLmxlbmd0aDsgaSsrICkge1xyXG4gICAgICAgICAgICB3b3JkID0gd29yZENvdW50c1tpXS53b3JkO1xyXG4gICAgICAgICAgICBjb3VudCA9IHdvcmRDb3VudHNbaV0uY291bnQ7XHJcbiAgICAgICAgICAgIC8vIGdldCBmb250IHNpemUgYmFzZWQgb24gZm9udCBzaXplIGZ1bmN0aW9uXHJcbiAgICAgICAgICAgIGZvbnRTaXplID0gUmVuZGVyZXJVdGlsLmdldEZvbnRTaXplKCBjb3VudCwgbWF4Q291bnQsIHtcclxuICAgICAgICAgICAgICAgIG1heEZvbnRTaXplOiAzMCxcclxuICAgICAgICAgICAgICAgIG1pbkZvbnRTaXplOiAxMixcclxuICAgICAgICAgICAgICAgIGJpYXM6IC1pLzJcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIC8vIGdldCBkaW1lbnNpb25zIG9mIHdvcmRcclxuICAgICAgICAgICAgZGltID0gZ2V0V29yZERpbWVuc2lvbnMoIHdvcmQsIGZvbnRTaXplICk7XHJcbiAgICAgICAgICAgIC8vIHN0YXJ0aW5nIHNwaXJhbCBwb3NpdGlvblxyXG4gICAgICAgICAgICBwb3MgPSB7XHJcbiAgICAgICAgICAgICAgICByYWRpdXMgOiAxLFxyXG4gICAgICAgICAgICAgICAgcmFkaXVzSW5jIDogNSxcclxuICAgICAgICAgICAgICAgIGFyY0xlbmd0aCA6IDUsXHJcbiAgICAgICAgICAgICAgICB4IDogMCxcclxuICAgICAgICAgICAgICAgIHkgOiAwLFxyXG4gICAgICAgICAgICAgICAgdCA6IDAsXHJcbiAgICAgICAgICAgICAgICBjb2xsaXNpb25zIDogMFxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgd2hpbGUoIHBvcy5jb2xsaXNpb25zIDwgMTAgKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBpbmNyZW1lbnQgcG9zaXRpb24gaW4gYSBzcGlyYWxcclxuICAgICAgICAgICAgICAgIHBvcyA9IHNwaXJhbFBvc2l0aW9uKCBwb3MgKTtcclxuICAgICAgICAgICAgICAgIC8vIHRlc3QgZm9yIGludGVyc2VjdGlvblxyXG4gICAgICAgICAgICAgICAgaWYgKCAhaW50ZXJzZWN0V29yZCggcG9zLCBkaW0sIGNsb3VkLCBib3VuZGluZ0JveCApICkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNsb3VkLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JkOiB3b3JkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb250U2l6ZTogZm9udFNpemUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6cG9zLngsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6cG9zLnksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiBkaW0ud2lkdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogZGltLmhlaWdodFxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBjbG91ZDtcclxuICAgIH07XHJcblxyXG4gICAgZnVuY3Rpb24gV29yZENsb3VkUmVuZGVyZXIoIHNwZWMgKSB7XHJcbiAgICAgICAgUmVuZGVyZXIuY2FsbCggdGhpcywgc3BlYyApO1xyXG4gICAgICAgIGluamVjdENzcyggdGhpcy5zcGVjICk7XHJcbiAgICB9XHJcblxyXG4gICAgV29yZENsb3VkUmVuZGVyZXIucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZSggUmVuZGVyZXIucHJvdG90eXBlICk7XHJcblxyXG4gICAgV29yZENsb3VkUmVuZGVyZXIucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uKCBkYXRhICkge1xyXG5cclxuICAgICAgICB2YXIgdGV4dCA9IHRoaXMuc3BlYy50ZXh0LFxyXG4gICAgICAgICAgICB0ZXh0S2V5ID0gdGV4dC50ZXh0S2V5LFxyXG4gICAgICAgICAgICBjb3VudEtleSA9IHRleHQuY291bnRLZXksXHJcbiAgICAgICAgICAgIG1ldGEgPSB0aGlzLm1ldGFbIHRoaXMubWFwLmdldFpvb20oKSBdLFxyXG4gICAgICAgICAgICB2YWx1ZXMgPSBkYXRhLnRpbGUudmFsdWVzWzBdLnZhbHVlLFxyXG4gICAgICAgICAgICBudW1FbnRyaWVzID0gTWF0aC5taW4oIHZhbHVlcy5sZW5ndGgsIE1BWF9XT1JEU19ESVNQTEFZRUQpLFxyXG4gICAgICAgICAgICBodG1sID0gJycsXHJcbiAgICAgICAgICAgIHdvcmRDb3VudHMgPSBbXSxcclxuICAgICAgICAgICAgZW50cmllcyA9IFtdLFxyXG4gICAgICAgICAgICBtYXhDb3VudCxcclxuICAgICAgICAgICAgdmFsdWUsXHJcbiAgICAgICAgICAgIHdvcmQsXHJcbiAgICAgICAgICAgIGksXHJcbiAgICAgICAgICAgIGNsb3VkO1xyXG5cclxuICAgICAgICAgLy8gZ2V0IG1heGltdW0gY291bnQgZm9yIGxheWVyIGlmIGl0IGV4aXN0cyBpbiBtZXRhIGRhdGFcclxuICAgICAgICBtYXhDb3VudCA9IG1ldGEubWluTWF4Lm1heFsgY291bnRLZXkgXTtcclxuXHJcbiAgICAgICAgZm9yIChpPTA7IGk8bnVtRW50cmllczsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhbHVlID0gdmFsdWVzW2ldO1xyXG4gICAgICAgICAgICBlbnRyaWVzLnB1c2goIHZhbHVlICk7XHJcbiAgICAgICAgICAgIHdvcmRDb3VudHMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICB3b3JkOiBSZW5kZXJlclV0aWwuZ2V0QXR0cmlidXRlVmFsdWUoIHZhbHVlLCB0ZXh0S2V5ICksXHJcbiAgICAgICAgICAgICAgICBjb3VudDogUmVuZGVyZXJVdGlsLmdldEF0dHJpYnV0ZVZhbHVlKCB2YWx1ZSwgY291bnRLZXkgKVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsb3VkID0gY3JlYXRlV29yZENsb3VkKCB3b3JkQ291bnRzLCBtYXhDb3VudCApO1xyXG5cclxuICAgICAgICBmb3IgKCBpPTA7IGk8Y2xvdWQubGVuZ3RoOyBpKysgKSB7XHJcblxyXG4gICAgICAgICAgICB3b3JkID0gY2xvdWRbaV07XHJcbiAgICAgICAgICAgIHZhbHVlID0gdmFsdWVzW2ldO1xyXG5cclxuICAgICAgICAgICAgaHRtbCArPSAnPGRpdiBjbGFzcz1cIndvcmQtY2xvdWQtbGFiZWxcIiBzdHlsZT1cIidcclxuICAgICAgICAgICAgICAgICAgICArICdmb250LXNpemU6Jyt3b3JkLmZvbnRTaXplKydweDsnXHJcbiAgICAgICAgICAgICAgICAgICAgKyAnbGVmdDonKygxMjgrd29yZC54LSh3b3JkLndpZHRoLzIpKSsncHg7J1xyXG4gICAgICAgICAgICAgICAgICAgICsgJ3RvcDonKygxMjgrd29yZC55LSh3b3JkLmhlaWdodC8yKSkrJ3B4OydcclxuICAgICAgICAgICAgICAgICAgICArICd3aWR0aDonK3dvcmQud2lkdGgrJ3B4OydcclxuICAgICAgICAgICAgICAgICAgICArICdoZWlnaHQ6Jyt3b3JkLmhlaWdodCsncHg7XCI+Jyt3b3JkLndvcmQrJzwvZGl2Pic7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBodG1sOiBodG1sLFxyXG4gICAgICAgICAgICBlbnRyaWVzOiBlbnRyaWVzXHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcblxyXG4gICAgbW9kdWxlLmV4cG9ydHMgPSBXb3JkQ2xvdWRSZW5kZXJlcjtcclxufSgpKTsiLCIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgT2N1bHVzIEluZm8gSW5jLlxyXG4gKiBodHRwOi8vd3d3Lm9jdWx1c2luZm8uY29tL1xyXG4gKlxyXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXHJcbiAqXHJcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkgb2ZcclxuICogdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpblxyXG4gKiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvXHJcbiAqIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzXHJcbiAqIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkb1xyXG4gKiBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XHJcblxyXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbiBhbGxcclxuICogY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cclxuXHJcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcclxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXHJcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxyXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXHJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXHJcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFXHJcbiAqIFNPRlRXQVJFLlxyXG4gKi9cclxuXHJcbiggZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgdmFyICQgPSByZXF1aXJlKCdqcXVlcnknKSxcclxuICAgICAgICBfID0gcmVxdWlyZSgnbG9kYXNoJyksXHJcbiAgICAgICAgVXRpbCA9IHJlcXVpcmUoJy4uL3V0aWwvVXRpbCcpLFxyXG4gICAgICAgIEF4aXNVdGlsID0gcmVxdWlyZSgnLi9BeGlzVXRpbCcpLFxyXG4gICAgICAgIEFYSVNfVElUTEVfQ0xBU1MgPSBcImF4aXMtdGl0bGUtbGFiZWxcIixcclxuICAgICAgICBBWElTX0RJVl9DTEFTU19TVUZGSVggPSBcIi1heGlzXCIsXHJcbiAgICAgICAgQVhJU19IRUFERVJfQ0xBU1MgPSBcImF4aXMtaGVhZGVyXCIsXHJcbiAgICAgICAgQVhJU19IRUFERVJfQ0xBU1NfU1VGRklYID0gXCItYXhpcy1oZWFkZXJcIixcclxuICAgICAgICBBWElTX0NPTlRFTlRfQ0xBU1MgPSBcImF4aXMtY29udGVudFwiLFxyXG4gICAgICAgIEFYSVNfQ09OVEVOVF9DTEFTU19TVUZGSVggPSBcIi1heGlzLWNvbnRlbnRcIixcclxuICAgICAgICBBWElTX0xBQkVMX0NMQVNTID0gXCJheGlzLW1hcmtlci1sYWJlbFwiLFxyXG4gICAgICAgIEFYSVNfUE9TSVRJT05FRF9MQUJFTF9DTEFTU19TVUZGSVggPSBcIi1heGlzLW1hcmtlci1sYWJlbFwiICxcclxuICAgICAgICBBWElTX01BUktFUl9DTEFTUyA9IFwiYXhpcy1tYXJrZXJcIixcclxuICAgICAgICBBWElTX01BUktFUl9TVUZGSVggPSBcIi1heGlzLW1hcmtlclwiLFxyXG4gICAgICAgIEFYSVNfUE9TSVRJT05fU1VGRklYID0gXCItYXhpc1wiLFxyXG4gICAgICAgIFNQQUNJTkdfQkVUV0VFTl9NQVJLRVJfQU5EX0xBQkVMID0gNSxcclxuICAgICAgICBaX0lOREVYID0gMjAwMTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFByaXZhdGU6IENyZWF0ZXMgYW5kIHJldHVybnMgYSBkdW1teSBtYXJrZXIgbGFiZWwgZWxlbWVudCB0byBtZWFzdXJlLiBUaGlzIGZ1bmN0aW9uXHJcbiAgICAgKiBpcyB1c2VkIGZvciBtZWFzdXJpbmcsIGFzIHRoZSByZWFsIGxhYmVsIGZ1bmMgc2l6ZXMgdGhlIGxhYmVscyB0byB0aGUgY3VycmVudFxyXG4gICAgICogbWF4IG1lYXN1cmVtZW50c1xyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBheGlzICAge0F4aXN9ICAgICB0aGUgYXhpcyBvYmplY3QuXHJcbiAgICAgKiBAcGFyYW0gbWFya2VyIHtPYmplY3R9IHRoZSBtYXJrZXIgb2JqZWN0LlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBjcmVhdGVEdW1teU1hcmtlckxhYmVsSFRNTCggYXhpcywgbWFya2VyICkge1xyXG4gICAgICAgIHJldHVybiAnPGRpdiBjbGFzcz1cIicgKyBBWElTX0xBQkVMX0NMQVNTXHJcbiAgICAgICAgICAgICsgJyAnICsgYXhpcy5ob3Jpem9udGFsT3JWZXJ0aWNhbCArIEFYSVNfUE9TSVRJT05FRF9MQUJFTF9DTEFTU19TVUZGSVggKyAnXCInXHJcbiAgICAgICAgICAgICsgJ3N0eWxlPVwicG9zaXRpb246YWJzb2x1dGU7XCI+J1xyXG4gICAgICAgICAgICArIEF4aXNVdGlsLmZvcm1hdFRleHQoIG1hcmtlci5sYWJlbCwgYXhpcy51bml0cyApXHJcbiAgICAgICAgICAgICsgJzwvZGl2Pic7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBQcml2YXRlOiBDcmVhdGVzIGFuZCByZXR1cm5zIGEgbWFya2VyIGxhYmVsIGVsZW1lbnQgd2l0aCBwcm9wZXIgQ1NTXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGF4aXMgICB7QXhpc30gICAgIHRoZSBheGlzIG9iamVjdC5cclxuICAgICAqIEBwYXJhbSBtYXJrZXIge09iamVjdH0gdGhlIG1hcmtlciBvYmplY3QuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGNyZWF0ZU1hcmtlckxhYmVsSFRNTCggYXhpcywgbWFya2VyICkge1xyXG4gICAgICAgIHZhciBwcmltYXJ5UG9zaXRpb24sXHJcbiAgICAgICAgICAgIHNlY29uZGFyeVBvc2l0aW9uO1xyXG4gICAgICAgIGlmICggYXhpcy5pc1hBeGlzICkge1xyXG4gICAgICAgICAgICAvLyBpZiB4IGF4aXMsIGFkZCBoYWxmIG9mIGxhYmVsIGxlbmd0aCBhcyB0ZXh0IGlzIGFuY2hvcmVkIGZyb20gYm90dG9tXHJcbiAgICAgICAgICAgIHByaW1hcnlQb3NpdGlvbiA9IG1hcmtlci5waXhlbCAtIGF4aXMuTUFYX0xBQkVMX1VOUk9UQVRFRF9XSURUSCowLjU7XHJcbiAgICAgICAgICAgIHNlY29uZGFyeVBvc2l0aW9uID0gIGF4aXMuTEFSR0VfTUFSS0VSX0xFTkdUSFxyXG4gICAgICAgICAgICAgICAgKyBTUEFDSU5HX0JFVFdFRU5fTUFSS0VSX0FORF9MQUJFTDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBwcmltYXJ5UG9zaXRpb24gPSBtYXJrZXIucGl4ZWwgLSBheGlzLk1BWF9MQUJFTF9IRUlHSFQqMC41O1xyXG4gICAgICAgICAgICBzZWNvbmRhcnlQb3NpdGlvbiA9ICBheGlzLkxBUkdFX01BUktFUl9MRU5HVEhcclxuICAgICAgICAgICAgICAgICsgU1BBQ0lOR19CRVRXRUVOX01BUktFUl9BTkRfTEFCRUw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiAnPGRpdiBjbGFzcz1cIicgKyBBWElTX0xBQkVMX0NMQVNTICsgJyAnXHJcbiAgICAgICAgICAgICsgYXhpcy5ob3Jpem9udGFsT3JWZXJ0aWNhbCArIEFYSVNfUE9TSVRJT05FRF9MQUJFTF9DTEFTU19TVUZGSVggKyAnXCInXHJcbiAgICAgICAgICAgICsgJ3N0eWxlPVwicG9zaXRpb246YWJzb2x1dGU7J1xyXG4gICAgICAgICAgICArICd0ZXh0LWFsaWduOiBjZW50ZXI7ICcgICAgLy8gY2VudGVyIHRleHQgaG9yaXpvbnRhbGx5XHJcbiAgICAgICAgICAgICsgJ3dpZHRoOiAnICsgYXhpcy5NQVhfTEFCRUxfV0lEVEggKyAncHg7J1xyXG4gICAgICAgICAgICArICdoZWlnaHQ6ICcgKyBheGlzLk1BWF9MQUJFTF9IRUlHSFQgKyAncHg7J1xyXG4gICAgICAgICAgICArICdsaW5lLWhlaWdodDogJyArIGF4aXMuTUFYX0xBQkVMX0hFSUdIVCArICdweDsnICAgLy8gY2VudGVyIHRleHQgdmVydGljYWxseVxyXG4gICAgICAgICAgICArIGF4aXMubGVmdE9yVG9wICsgXCI6XCIgKyBwcmltYXJ5UG9zaXRpb24gKyAncHg7J1xyXG4gICAgICAgICAgICArIGF4aXMub3Bwb3NpdGVQb3NpdGlvbiArIFwiOlwiICsgc2Vjb25kYXJ5UG9zaXRpb24gKyAncHg7XCI+J1xyXG4gICAgICAgICAgICArIEF4aXNVdGlsLmZvcm1hdFRleHQoIG1hcmtlci5sYWJlbCwgYXhpcy51bml0cyApXHJcbiAgICAgICAgICAgICsnPC9kaXY+JztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFByaXZhdGU6IENyZWF0ZXMgYW5kIHJldHVybnMgYSBsYXJnZSBtYXJrZXIgZWxlbWVudCB3aXRoIHByb3BlciBDU1NcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gYXhpcyAgIHtBeGlzfSAgICAgdGhlIGF4aXMgb2JqZWN0LlxyXG4gICAgICogQHBhcmFtIG1hcmtlciB7T2JqZWN0fSB0aGUgbWFya2VyIG9iamVjdC5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gY3JlYXRlTGFyZ2VNYXJrZXJIVE1MKCBheGlzLCBtYXJrZXIgKSB7XHJcbiAgICAgICAgcmV0dXJuICc8ZGl2IGNsYXNzPVwiJyArIEFYSVNfTUFSS0VSX0NMQVNTXHJcbiAgICAgICAgICAgICsgJyBsYXJnZS0nICsgYXhpcy5ob3Jpem9udGFsT3JWZXJ0aWNhbCArIEFYSVNfTUFSS0VSX1NVRkZJWFxyXG4gICAgICAgICAgICArICcgJyArIGF4aXMucG9zaXRpb24gKyBBWElTX1BPU0lUSU9OX1NVRkZJWCArICdcIidcclxuICAgICAgICAgICAgKyAnc3R5bGU9XCJwb3NpdGlvbjphYnNvbHV0ZTsnXHJcbiAgICAgICAgICAgICsgYXhpcy5sZWZ0T3JUb3AgKyBcIjpcIiArIChtYXJrZXIucGl4ZWwgLSBheGlzLkxBUkdFX01BUktFUl9IQUxGX1dJRFRIKSArICdweDtcIj4nXHJcbiAgICAgICAgICAgICsgJzwvZGl2Pic7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBQcml2YXRlOiBDcmVhdGVzIGFuZCByZXR1cm5zIGEgbWFqb3IgbWFya2VyIGVsZW1lbnQgd2l0aCBwcm9wZXIgQ1NTXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGF4aXMgICB7QXhpc30gICAgIHRoZSBheGlzIG9iamVjdC5cclxuICAgICAqIEBwYXJhbSBtYXJrZXIge09iamVjdH0gdGhlIG1hcmtlciBvYmplY3QuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGNyZWF0ZU1lZGl1bU1hcmtlckhUTUwoIGF4aXMsIG1hcmtlciApIHtcclxuICAgICAgICByZXR1cm4gJzxkaXYgY2xhc3M9XCInICsgQVhJU19NQVJLRVJfQ0xBU1NcclxuICAgICAgICAgICAgKyAnIG1lZGl1bS0nICsgYXhpcy5ob3Jpem9udGFsT3JWZXJ0aWNhbCArIEFYSVNfTUFSS0VSX1NVRkZJWFxyXG4gICAgICAgICAgICArICcgJyArIGF4aXMucG9zaXRpb24gKyBBWElTX1BPU0lUSU9OX1NVRkZJWCArICdcIidcclxuICAgICAgICAgICAgKyAnc3R5bGU9XCJwb3NpdGlvbjphYnNvbHV0ZTsnXHJcbiAgICAgICAgICAgICsgYXhpcy5sZWZ0T3JUb3AgKyBcIjpcIiArIChtYXJrZXIucGl4ZWwgLSBheGlzLk1FRElVTV9NQVJLRVJfSEFMRl9XSURUSCkgKyAncHg7XCI+J1xyXG4gICAgICAgICAgICArICc8L2Rpdj4nO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUHJpdmF0ZTogQ3JlYXRlcyBhbmQgcmV0dXJucyBhIG1ham9yIG1hcmtlciBlbGVtZW50IHdpdGggcHJvcGVyIENTU1xyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBheGlzICAge0F4aXN9ICAgICB0aGUgYXhpcyBvYmplY3QuXHJcbiAgICAgKiBAcGFyYW0gbWFya2VyIHtPYmplY3R9IHRoZSBtYXJrZXIgb2JqZWN0LlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBjcmVhdGVTbWFsbE1hcmtlckhUTUwoIGF4aXMsIG1hcmtlciApIHtcclxuICAgICAgICByZXR1cm4gJzxkaXYgY2xhc3M9XCInICsgQVhJU19NQVJLRVJfQ0xBU1NcclxuICAgICAgICAgICAgKyAnIHNtYWxsLScgKyBheGlzLmhvcml6b250YWxPclZlcnRpY2FsICsgQVhJU19NQVJLRVJfU1VGRklYXHJcbiAgICAgICAgICAgICsgJyAnICsgYXhpcy5wb3NpdGlvbiArIEFYSVNfUE9TSVRJT05fU1VGRklYICsgJ1wiJ1xyXG4gICAgICAgICAgICArICdzdHlsZT1cInBvc2l0aW9uOmFic29sdXRlOydcclxuICAgICAgICAgICAgKyBheGlzLmxlZnRPclRvcCArIFwiOlwiICsgKG1hcmtlci5waXhlbCAtIGF4aXMuU01BTExfTUFSS0VSX0hBTEZfV0lEVEgpICsgJ3B4O1wiPidcclxuICAgICAgICAgICAgKyAnPC9kaXY+JztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFByaXZhdGU6IFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byBjcmVhdGUgdGVtcG9yYXJ5IGVsZW1lbnRzIHRvIGRldGVybWluZSB0aGUgcmVxdWlyZWQgcnVuLXRpbWVcclxuICAgICAqIGRpbWVuc2lvbnMuIFRoaXMgaXMgb25seSBiZSBjYWxsZWQgb25jZSBwZXIgYXhpcyBhcyB0aGVzZSBkaW1lbnNpb25zIHdpbGwgbmV2ZXIgY2hhbmdlLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBheGlze0F4aXN9IHRoZSBheGlzIG9iamVjdC5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gY2FsY0VsZW1lbnREaW1lbnNpb25zKCBheGlzICkge1xyXG4gICAgICAgIHZhciAkdGVtcDtcclxuICAgICAgICBmdW5jdGlvbiBtZWFzdXJlTGFiZWxSb3RhdGlvbiggJGxhYmVsICkge1xyXG4gICAgICAgICAgICB2YXIgbWF0cml4LCB2YWx1ZXMsIGFuZ2xlO1xyXG4gICAgICAgICAgICBtYXRyaXggPSAkbGFiZWwuY3NzKFwiLXdlYmtpdC10cmFuc2Zvcm1cIikgfHxcclxuICAgICAgICAgICAgICAgICAgICAgJGxhYmVsLmNzcyhcIi1tb3otdHJhbnNmb3JtXCIpICAgIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICRsYWJlbC5jc3MoXCItbXMtdHJhbnNmb3JtXCIpICAgICB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAkbGFiZWwuY3NzKFwiLW8tdHJhbnNmb3JtXCIpICAgICAgfHxcclxuICAgICAgICAgICAgICAgICAgICAgJGxhYmVsLmNzcyhcInRyYW5zZm9ybVwiKSB8fCAnbm9uZSc7XHJcbiAgICAgICAgICAgIGlmKG1hdHJpeCAhPT0gJ25vbmUnKSB7XHJcbiAgICAgICAgICAgICAgICB2YWx1ZXMgPSBtYXRyaXguc3BsaXQoJygnKVsxXS5zcGxpdCgnKScpWzBdLnNwbGl0KCcsJyk7XHJcbiAgICAgICAgICAgICAgICBhbmdsZSA9IE1hdGguYXRhbjIodmFsdWVzWzFdLCB2YWx1ZXNbMF0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgYW5nbGUgPSAwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGF4aXMuUk9UQVRJT05fUkFESUFOUyA9IE1hdGguYWJzKGFuZ2xlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gbWVhc3VyZUxhYmVsTWF4RGltZW5zaW9ucyggJGxhYmVsICkge1xyXG4gICAgICAgICAgICB2YXIgc2luVyA9ICRsYWJlbC53aWR0aCgpICogTWF0aC5zaW4oYXhpcy5ST1RBVElPTl9SQURJQU5TKSxcclxuICAgICAgICAgICAgICAgIHNpbkggPSAkbGFiZWwuaGVpZ2h0KCkgKiBNYXRoLnNpbihheGlzLlJPVEFUSU9OX1JBRElBTlMpLFxyXG4gICAgICAgICAgICAgICAgY29zVyA9ICRsYWJlbC53aWR0aCgpICogTWF0aC5jb3MoYXhpcy5ST1RBVElPTl9SQURJQU5TKSxcclxuICAgICAgICAgICAgICAgIGNvc0ggPSAkbGFiZWwuaGVpZ2h0KCkgKiBNYXRoLmNvcyhheGlzLlJPVEFUSU9OX1JBRElBTlMpO1xyXG4gICAgICAgICAgICBheGlzLk1BWF9MQUJFTF9XSURUSCA9IE1hdGgubWF4KCBzaW5IICsgY29zVywgYXhpcy5NQVhfTEFCRUxfV0lEVEggKTtcclxuICAgICAgICAgICAgYXhpcy5NQVhfTEFCRUxfSEVJR0hUID0gTWF0aC5tYXgoIGNvc0ggKyBzaW5XLCBheGlzLk1BWF9MQUJFTF9IRUlHSFQgKTtcclxuICAgICAgICAgICAgYXhpcy5NQVhfTEFCRUxfVU5ST1RBVEVEX1dJRFRIID0gTWF0aC5tYXgoICRsYWJlbC53aWR0aCgpLCBheGlzLk1BWF9MQUJFTF9VTlJPVEFURURfV0lEVEggKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gaW5pdGlhbGl6ZWQgYWxsIG1lYXN1cmVtZW50cyB0byB6ZXJvXHJcbiAgICAgICAgYXhpcy5MQVJHRV9NQVJLRVJfTEVOR1RIID0gMDtcclxuICAgICAgICBheGlzLkxBUkdFX01BUktFUl9IQUxGX1dJRFRIID0gMDtcclxuICAgICAgICBheGlzLk1FRElVTV9NQVJLRVJfSEFMRl9XSURUSCA9IDA7XHJcbiAgICAgICAgYXhpcy5TTUFMTF9NQVJLRVJfSEFMRl9XSURUSCA9IDA7XHJcbiAgICAgICAgYXhpcy5NQVhfTEFCRUxfV0lEVEggPSAwO1xyXG4gICAgICAgIGF4aXMuTUFYX0xBQkVMX0hFSUdIVCA9IDA7XHJcbiAgICAgICAgYXhpcy5NQVhfTEFCRUxfVU5ST1RBVEVEX1dJRFRIID0gMDtcclxuICAgICAgICBheGlzLlJPVEFUSU9OX1JBRElBTlMgPSAwO1xyXG4gICAgICAgIGF4aXMuSEVBREVSX1dJRFRIID0gYXhpcy5pc1hBeGlzID8gYXhpcy4kaGVhZGVyLmhlaWdodCgpIDogYXhpcy4kaGVhZGVyLndpZHRoKCk7XHJcbiAgICAgICAgLy8gbWVhc3VyZSBsYXJnZSBtYXJrZXJzXHJcbiAgICAgICAgJHRlbXAgPSAkKGNyZWF0ZUxhcmdlTWFya2VySFRNTCggYXhpcywge3BpeGVsOjB9ICkpLmhpZGUoKS5hcHBlbmRUbyhheGlzLiRjb250ZW50KTtcclxuICAgICAgICBheGlzLkxBUkdFX01BUktFUl9MRU5HVEggPSAkdGVtcFtheGlzLm1hcmtlcldpZHRoT3JIZWlnaHRdKCk7XHJcbiAgICAgICAgYXhpcy5MQVJHRV9NQVJLRVJfSEFMRl9XSURUSCA9IE1hdGguZmxvb3IoICR0ZW1wW2F4aXMuYXhpc1dpZHRoT3JIZWlnaHRdKCkqMC41ICk7XHJcbiAgICAgICAgJHRlbXAucmVtb3ZlKCk7XHJcbiAgICAgICAgLy8gbWVhc3VyZSBtZWRpdW0gbWFya2Vyc1xyXG4gICAgICAgICR0ZW1wID0gJChjcmVhdGVNZWRpdW1NYXJrZXJIVE1MKCBheGlzLCB7cGl4ZWw6MH0gKSkuaGlkZSgpLmFwcGVuZFRvKGF4aXMuJGNvbnRlbnQpO1xyXG4gICAgICAgIGF4aXMuTUVESVVNX01BUktFUl9IQUxGX1dJRFRIID0gTWF0aC5mbG9vciggJHRlbXBbYXhpcy5heGlzV2lkdGhPckhlaWdodF0oKSAqIDAuNSk7XHJcbiAgICAgICAgJHRlbXAucmVtb3ZlKCk7XHJcbiAgICAgICAgLy8gbWVhc3VyZSBzbWFsbCBtYXJrZXJzXHJcbiAgICAgICAgJHRlbXAgPSAkKGNyZWF0ZVNtYWxsTWFya2VySFRNTCggYXhpcywge3BpeGVsOjB9ICkpLmhpZGUoKS5hcHBlbmRUbyhheGlzLiRjb250ZW50KTtcclxuICAgICAgICBheGlzLlNNQUxMX01BUktFUl9IQUxGX1dJRFRIID0gTWF0aC5mbG9vciggJHRlbXBbYXhpcy5heGlzV2lkdGhPckhlaWdodF0oKSAqIDAuNSk7XHJcbiAgICAgICAgJHRlbXAucmVtb3ZlKCk7XHJcbiAgICAgICAgLy8gbGFiZWwgbWVhc3VyZW1lbnRzXHJcbiAgICAgICAgJHRlbXAgPSAkKGNyZWF0ZUR1bW15TWFya2VyTGFiZWxIVE1MKCBheGlzLCB7cGl4ZWw6MCwgbGFiZWw6YXhpcy5tYXggfSApKS5hcHBlbmRUbyhheGlzLiRjb250ZW50KTtcclxuICAgICAgICAvLyBnZXQgYW5nbGUgZmlyc3QsIGl0IGlzIHVzZWQgaW4gbGFiZWwgbWVhc3VyZW1lbnRzXHJcbiAgICAgICAgbWVhc3VyZUxhYmVsUm90YXRpb24oICR0ZW1wICk7XHJcbiAgICAgICAgLy8gbWVhc3VyZSBtYXggbGFiZWxcclxuICAgICAgICBtZWFzdXJlTGFiZWxNYXhEaW1lbnNpb25zKCAkdGVtcCApO1xyXG4gICAgICAgICR0ZW1wLnJlbW92ZSgpO1xyXG4gICAgICAgIC8vIG1lYXN1cmUgbWluIGxhYmVsXHJcbiAgICAgICAgJHRlbXAgPSAkKGNyZWF0ZUR1bW15TWFya2VyTGFiZWxIVE1MKCBheGlzLCB7cGl4ZWw6MCwgbGFiZWw6YXhpcy5taW59ICkpLmFwcGVuZFRvKGF4aXMuJGNvbnRlbnQpO1xyXG4gICAgICAgIG1lYXN1cmVMYWJlbE1heERpbWVuc2lvbnMoICR0ZW1wICk7XHJcbiAgICAgICAgJHRlbXAucmVtb3ZlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBQcml2YXRlOiBDcmVhdGVzIGFuZCByZXR1cm5zIHRoZSBheGlzIGxhYmVsIGVsZW1lbnQgd2l0aCBwcm9wZXIgQ1NTLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBheGlzIHtBeGlzfSB0aGUgYXhpcyBvYmplY3QuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGNyZWF0ZVRpdGxlKCBheGlzICkge1xyXG4gICAgICAgIHZhciByb3RhdGlvbiA9IFwiXCIsXHJcbiAgICAgICAgICAgIHRyYW5zZm9ybU9yaWdpbiA9XCJcIjtcclxuICAgICAgICBpZiAoICFheGlzLmlzWEF4aXMgKSB7XHJcbiAgICAgICAgICAgIGlmIChheGlzLnBvc2l0aW9uID09PSBcImxlZnRcIikge1xyXG4gICAgICAgICAgICAgICAgcm90YXRpb24gPSBcInJvdGF0ZShcIiArICgtOTApICsgXCJkZWcpXCI7XHJcbiAgICAgICAgICAgICAgICB0cmFuc2Zvcm1PcmlnaW4gPSBcInRvcCBsZWZ0XCI7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByb3RhdGlvbiA9IFwicm90YXRlKFwiICsgOTAgKyBcImRlZylcIjtcclxuICAgICAgICAgICAgICAgIHRyYW5zZm9ybU9yaWdpbiA9IFwiYm90dG9tIGxlZnRcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gJCgnPHNwYW4gY2xhc3M9XCInK0FYSVNfVElUTEVfQ0xBU1MrJ1wiJ1xyXG4gICAgICAgICAgICArICdzdHlsZT1cInBvc2l0aW9uOmFic29sdXRlOydcclxuICAgICAgICAgICAgKyAnLXdlYmtpdC10cmFuc2Zvcm06ICcgKyByb3RhdGlvbiArIFwiO1wiXHJcbiAgICAgICAgICAgICsgJy1tb3otdHJhbnNmb3JtOiAnICsgcm90YXRpb24gKyBcIjtcIlxyXG4gICAgICAgICAgICArICctbXMtdHJhbnNmb3JtOiAnICsgcm90YXRpb24gKyBcIjtcIlxyXG4gICAgICAgICAgICArICctby10cmFuc2Zvcm06ICcgKyByb3RhdGlvbiArIFwiO1wiXHJcbiAgICAgICAgICAgICsgJ3RyYW5zZm9ybTogJyArIHJvdGF0aW9uICsgXCI7XCJcclxuICAgICAgICAgICAgKyAnLXdlYmtpdC10cmFuc2Zvcm0tb3JpZ2luOiAnICsgdHJhbnNmb3JtT3JpZ2luICsgXCI7XCJcclxuICAgICAgICAgICAgKyAnLW1vei10cmFuc2Zvcm0tb3JpZ2luOiAnICsgdHJhbnNmb3JtT3JpZ2luICsgXCI7XCJcclxuICAgICAgICAgICAgKyAnLW1zLXRyYW5zZm9ybS1vcmlnaW46ICcgKyB0cmFuc2Zvcm1PcmlnaW4gKyBcIjtcIlxyXG4gICAgICAgICAgICArICctby10cmFuc2Zvcm0tb3JpZ2luOiAnICsgdHJhbnNmb3JtT3JpZ2luICsgXCI7XCJcclxuICAgICAgICAgICAgKyAndHJhbnNmb3JtLW9yaWdpbjogJyArIHRyYW5zZm9ybU9yaWdpbiArIFwiO1wiXHJcbiAgICAgICAgICAgICsgJ1wiPicgKyBheGlzLnRpdGxlICsgJzwvZGl2PicpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUHJpdmF0ZTogQ3JlYXRlcyBhbmQgcmV0dXJucyB0aGUgYXhpcyBoZWFkZXIganF1ZXJ5IG9iamVjdC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gYXhpcyB7QXhpc30gdGhlIGF4aXMgb2JqZWN0LlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBjcmVhdGVIZWFkZXIoIGF4aXMgKSB7XHJcbiAgICAgICAgdmFyIG1hcmdpbkxlZnQgPSAwLFxyXG4gICAgICAgICAgICBtYXJnaW5SaWdodCA9IDAsXHJcbiAgICAgICAgICAgIG1hcmdpblRvcCA9IDAsXHJcbiAgICAgICAgICAgIG1hcmdpbkJvdHRvbSA9IDA7XHJcbiAgICAgICAgLy8gYWRkIG1hcmdpbnMgaW4gY2FzZSBvdGhlciBheGlzIGV4aXN0LCB0aGlzIHByZXZlbnRzIGFuIHVnbHkgYm9yZGVyIG92ZXJsYXBcclxuICAgICAgICBpZiAoIGF4aXMuaXNYQXhpcyApIHtcclxuICAgICAgICAgICAgbWFyZ2luTGVmdCA9IGF4aXMuJG1hcC5maW5kKCcubGVmdCcgKyBBWElTX0hFQURFUl9DTEFTU19TVUZGSVggKS53aWR0aCgpIHx8IDA7XHJcbiAgICAgICAgICAgIG1hcmdpblJpZ2h0ID0gYXhpcy4kbWFwLmZpbmQoJy5yaWdodCcgKyBBWElTX0hFQURFUl9DTEFTU19TVUZGSVggKS53aWR0aCgpIHx8IDA7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbWFyZ2luVG9wID0gYXhpcy4kbWFwLmZpbmQoJy50b3AnICsgQVhJU19IRUFERVJfQ0xBU1NfU1VGRklYICkuaGVpZ2h0KCkgfHwgMDtcclxuICAgICAgICAgICAgbWFyZ2luQm90dG9tID0gYXhpcy4kbWFwLmZpbmQoJy5ib3R0b20nICsgQVhJU19IRUFERVJfQ0xBU1NfU1VGRklYICkuaGVpZ2h0KCkgfHwgMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuICQoJzxkaXYgY2xhc3M9XCInKyBBWElTX0hFQURFUl9DTEFTUyArIFwiIFwiICsgYXhpcy5wb3NpdGlvbiArIEFYSVNfSEVBREVSX0NMQVNTX1NVRkZJWCArICdcIidcclxuICAgICAgICAgICAgICAgKyAnc3R5bGU9XCJ6LWluZGV4OicrKFpfSU5ERVgrMikrJzsnXHJcbiAgICAgICAgICAgICAgICsgJ21hcmdpbjonK21hcmdpblRvcCsncHggJyttYXJnaW5SaWdodCsncHggJyttYXJnaW5Cb3R0b20rJ3B4ICcrbWFyZ2luTGVmdCsncHg7XCI+PC9kaXY+Jyk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUHJpdmF0ZTogQ3JlYXRlcyBhbmQgcmV0dXJucyB0aGUgYXhpcyBoZWFkZXIgYmFja2dyb3VuZCBqcXVlcnkgb2JqZWN0LiBUaGlzIGlzIHVzZWRcclxuICAgICAqIHRvIGFwcGx5IGEgYm94LXNoYWRvdyBjc3Mgd2l0aG91dCB1Z2x5IG92ZXJsYXAuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGF4aXMge0F4aXN9IHRoZSBheGlzIG9iamVjdC5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gY3JlYXRlSGVhZGVyQmFjayggYXhpcyApIHtcclxuICAgICAgICByZXR1cm4gJCgnPGRpdiBjbGFzcz1cIicrIEFYSVNfSEVBREVSX0NMQVNTICsgXCIgXCIgKyBBWElTX0hFQURFUl9DTEFTUyArIFwiLWJhY2sgXCIgKyBheGlzLnBvc2l0aW9uICsgQVhJU19IRUFERVJfQ0xBU1NfU1VGRklYICsgJ1wiJ1xyXG4gICAgICAgICAgICAgICArICdzdHlsZT1cInotaW5kZXg6JysoWl9JTkRFWCsxKSsnO1wiPjwvZGl2PicgKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBQcml2YXRlOiBDcmVhdGVzIGFuZCByZXR1cm5zIHRoZSBlbXB0eSBheGlzIGNvbnRlbnQganF1ZXJ5IG9iamVjdC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gYXhpcyB7QXhpc30gdGhlIGF4aXMgb2JqZWN0LlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBjcmVhdGVDb250ZW50KCBheGlzICkge1xyXG4gICAgICAgIHJldHVybiAkKCc8ZGl2IGNsYXNzPVwiJysgQVhJU19DT05URU5UX0NMQVNTXHJcbiAgICAgICAgICAgICAgICsgXCIgXCIgKyBheGlzLnBvc2l0aW9uICsgQVhJU19DT05URU5UX0NMQVNTX1NVRkZJWFxyXG4gICAgICAgICAgICAgICArICdcIiAgc3R5bGU9XCJ6LWluZGV4OicrWl9JTkRFWCsnO1wiPjwvZGl2PicpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIFByaXZhdGU6IENyZWF0ZXMgYW5kIHJldHVybnMgdGhlIGF4aXMgcGFyZW50IGRpdiBqcXVlcnkgb2JqZWN0LlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBheGlzIHtBeGlzfSB0aGUgYXhpcyBvYmplY3QuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGNyZWF0ZUF4aXMoIGF4aXMgKSB7XHJcbiAgICAgICAgdmFyICRheGlzLFxyXG4gICAgICAgICAgICBlbmFibGVTbGlkZSxcclxuICAgICAgICAgICAgZGlzYWJsZVNsaWRlLFxyXG4gICAgICAgICAgICBob3Jpem9udGFsU2xpZGUsXHJcbiAgICAgICAgICAgIHZlcnRpY2FsU2xpZGU7XHJcbiAgICAgICAgZW5hYmxlU2xpZGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgLy8gc2V0IGVuYWJsZSAvIGRpc2FibGUgY2FsbGJhY2tzXHJcbiAgICAgICAgICAgIGlmIChheGlzLmlzWEF4aXMpIHtcclxuICAgICAgICAgICAgICAgIGF4aXMuJGhlYWRlci5jbGljayh2ZXJ0aWNhbFNsaWRlKTtcclxuICAgICAgICAgICAgICAgIGF4aXMuJGNvbnRlbnQuY2xpY2sodmVydGljYWxTbGlkZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBheGlzLiRoZWFkZXIuY2xpY2soaG9yaXpvbnRhbFNsaWRlKTtcclxuICAgICAgICAgICAgICAgIGF4aXMuJGNvbnRlbnQuY2xpY2soaG9yaXpvbnRhbFNsaWRlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgZGlzYWJsZVNsaWRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGF4aXMuJGhlYWRlci5vZmYoJ2NsaWNrJyk7XHJcbiAgICAgICAgICAgIGF4aXMuJGNvbnRlbnQub2ZmKCdjbGljaycpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgaG9yaXpvbnRhbFNsaWRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGF4aXMuc2V0RW5hYmxlZCggIWF4aXMuaXNFbmFibGVkKCkgKTtcclxuICAgICAgICAgICAgYXhpcy5zZXRDb250ZW50RGltZW5zaW9uKCk7XHJcbiAgICAgICAgICAgIGRpc2FibGVTbGlkZSgpO1xyXG4gICAgICAgICAgICBheGlzLiRjb250ZW50LmFuaW1hdGUoe3dpZHRoOiAndG9nZ2xlJ30sIHtkdXJhdGlvbjogMzAwLCBjb21wbGV0ZTogZnVuY3Rpb24oKXsgZW5hYmxlU2xpZGUoKTt9IH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmVydGljYWxTbGlkZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBheGlzLnNldEVuYWJsZWQoICFheGlzLmlzRW5hYmxlZCgpICk7XHJcbiAgICAgICAgICAgIGF4aXMuc2V0Q29udGVudERpbWVuc2lvbigpO1xyXG4gICAgICAgICAgICBkaXNhYmxlU2xpZGUoKTtcclxuICAgICAgICAgICAgYXhpcy4kY29udGVudC5hbmltYXRlKHtoZWlnaHQ6ICd0b2dnbGUnfSwge2R1cmF0aW9uOiAzMDAsIGNvbXBsZXRlOiBmdW5jdGlvbigpeyBlbmFibGVTbGlkZSgpO30gfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyBjcmVhdGUgYXhpcyB0aXRsZSwgaGVhZGVyLCBhbmQgY29udGFpbmVyIGFuZCBhcHBlbmQgdGhlbSB0byByb290XHJcbiAgICAgICAgYXhpcy4kdGl0bGUgPSBjcmVhdGVUaXRsZSggYXhpcyApO1xyXG4gICAgICAgIGF4aXMuJGhlYWRlciA9IGNyZWF0ZUhlYWRlciggYXhpcyApLmFwcGVuZCggYXhpcy4kdGl0bGUgKTtcclxuICAgICAgICBheGlzLiRjb250ZW50ID0gY3JlYXRlQ29udGVudCggYXhpcyApO1xyXG4gICAgICAgICRheGlzID0gJCgnPGRpdiBjbGFzcz1cIicrIGF4aXMucG9zaXRpb24gKyBBWElTX0RJVl9DTEFTU19TVUZGSVggKyAnXCI+PC9kaXY+JylcclxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCBheGlzLiRjb250ZW50IClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCggYXhpcy4kaGVhZGVyIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoIGNyZWF0ZUhlYWRlckJhY2soIGF4aXMgKSApO1xyXG4gICAgICAgIC8vIGVuYWJsZSBjYWxsYmFja3NcclxuICAgICAgICBlbmFibGVTbGlkZSgpO1xyXG4gICAgICAgIC8vIHJldHVybiByb290XHJcbiAgICAgICAgcmV0dXJuICRheGlzO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUHJpdmF0ZTogVXBkYXRlcyB0aGUgcG9zaXRvbiBvZiB0aGUgYXhpcyB0aXRsZSBvZiBpdHMgc2l6ZSBjaGFuZ2VzLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBheGlzIHtBeGlzfSB0aGUgYXhpcyBvYmplY3QuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIHVwZGF0ZUF4aXNUaXRsZSggYXhpcyApIHtcclxuICAgICAgICAvLyB1cGRhdGUgYXhpcyBsZW5ndGhcclxuICAgICAgICB2YXIgJHRpdGxlID0gYXhpcy4kdGl0bGUsXHJcbiAgICAgICAgICAgIGF4aXNMZW5ndGggPSBheGlzLiRtYXAuY3NzKCBheGlzLmF4aXNXaWR0aE9ySGVpZ2h0ICkucmVwbGFjZSgncHgnLCAnJyksIC8vIHN0cmlwIHB4IHN1ZmZpeFxyXG4gICAgICAgICAgICBwYWRkaW5nO1xyXG4gICAgICAgIC8vIGFkZCBwb3NpdGlvbiBvZmZzZXQgZm9yIHZlcnRpY2FsIGF4ZXNcclxuICAgICAgICBpZiAoICFheGlzLmlzWEF4aXMgKSB7XHJcbiAgICAgICAgICAgIGlmIChheGlzLnBvc2l0aW9uID09PSAnbGVmdCcpIHtcclxuICAgICAgICAgICAgICAgICR0aXRsZS5jc3MoIGF4aXMubGVmdE9yVG9wLCBheGlzTGVuZ3RoICsgXCJweFwiICk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkdGl0bGUuY3NzKCBheGlzLmxlZnRPclRvcCwgLSR0aXRsZS53aWR0aCgpKjAuNSArIFwicHhcIiApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGNhbGMgcGFkZGluZ1xyXG4gICAgICAgIHBhZGRpbmcgPSAoYXhpc0xlbmd0aCowLjUgLSAkdGl0bGUud2lkdGgoKSowLjUpO1xyXG4gICAgICAgIC8vIGFkZCBwYWRkaW5nIGZvciBob3ZlciBoaXQgYm94XHJcbiAgICAgICAgJHRpdGxlLmNzcygncGFkZGluZy1sZWZ0JywgcGFkZGluZyArIFwicHhcIik7XHJcbiAgICAgICAgJHRpdGxlLmNzcygncGFkZGluZy1yaWdodCcsIHBhZGRpbmcgKyBcInB4XCIgKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFByaXZhdGU6IENyZWF0ZXMgdGhlIGF4aXMgbWFya2VyIGVsZW1lbnRzIGFuZCBhcHBlbmRzIHRoZW0gdG8gdGhlIGNvbnRlbnQgZGl2LlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBheGlzIHtBeGlzfSB0aGUgYXhpcyBvYmplY3QuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIHVwZGF0ZUF4aXNDb250ZW50KCBheGlzICkge1xyXG4gICAgICAgIHZhciBtYXJrZXJzLFxyXG4gICAgICAgICAgICBtYXJrZXJzSFRNTCA9IFwiXCIsXHJcbiAgICAgICAgICAgIG1hcmtlcnNCeVNpemUsXHJcbiAgICAgICAgICAgIGk7XHJcbiAgICAgICAgLy8gZ2VuZXJhdGUgYXJyYXkgb2YgbWFya2VyIGxhYmVscyBhbmQgcGl4ZWwgbG9jYXRpb25zXHJcbiAgICAgICAgbWFya2Vyc0J5U2l6ZSA9IEF4aXNVdGlsLmdldE1hcmtlcnMoIGF4aXMgKTtcclxuICAgICAgICAvLyBsYXJnZSBtYXJrZXJzXHJcbiAgICAgICAgbWFya2VycyA9IG1hcmtlcnNCeVNpemUubGFyZ2U7XHJcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IG1hcmtlcnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgbWFya2Vyc0hUTUwgKz0gY3JlYXRlTGFyZ2VNYXJrZXJIVE1MKCBheGlzLCBtYXJrZXJzW2ldICk7XHJcbiAgICAgICAgICAgIG1hcmtlcnNIVE1MICs9IGNyZWF0ZU1hcmtlckxhYmVsSFRNTCggYXhpcywgbWFya2Vyc1tpXSApO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBtZWRpdW0gbWFya2Vyc1xyXG4gICAgICAgIG1hcmtlcnMgPSBtYXJrZXJzQnlTaXplLm1lZGl1bTtcclxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbWFya2Vycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBtYXJrZXJzSFRNTCArPSBjcmVhdGVNZWRpdW1NYXJrZXJIVE1MKCBheGlzLCBtYXJrZXJzW2ldICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIHNtYWxsIG1hcmtlcnNcclxuICAgICAgICBtYXJrZXJzID0gbWFya2Vyc0J5U2l6ZS5zbWFsbDtcclxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbWFya2Vycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBtYXJrZXJzSFRNTCArPSBjcmVhdGVTbWFsbE1hcmtlckhUTUwoIGF4aXMsIG1hcmtlcnNbaV0gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gYXBwZW5kIGFsbCBtYXJrZXJzIGFuZCBsYWJlbHMgYXQgb25jZVxyXG4gICAgICAgIGF4aXMuJGNvbnRlbnRbMF0uaW5uZXJIVE1MID0gbWFya2Vyc0hUTUw7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBQcml2YXRlOiBSZXR1cm5zIHRoZSBkcmF3IGNhbGxiYWNrIGZ1bmN0aW9uIG9uIG1hcCAnbW92ZScgZXZlbnQuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGF4aXMge0F4aXN9IFRoZSBheGlzIG9iamVjdC5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gcmVkcmF3Q2FsbGJhY2soIGF4aXMgKSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBheGlzLnJlZHJhdygpO1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBQcml2YXRlOiBSZXR1cm5zIHRoZSBtb3VzZSBtYXJrZXIgY2FsbGJhY2sgZnVuY3Rpb24gb24gJ21vdXNlbW92ZScgZXZlbnQuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGF4aXMge0F4aXN9IFRoZSBheGlzIG9iamVjdC5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gbW91c2VNb3ZlQ2FsbGJhY2soIGF4aXMgKSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCBldmVudCApIHtcclxuICAgICAgICAgICAgaWYgKCAhYXhpcy5lbmFibGVkICkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBtYXJrZXIgPSBBeGlzVXRpbC5nZXRNYXJrZXIoIGF4aXMsIGV2ZW50Lnh5LngsIGV2ZW50Lnh5LnkgKTtcclxuICAgICAgICAgICAgYXhpcy4kY29udGVudC5maW5kKCAnLm1vdXNlLW1hcmtlcicgKS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgYXhpcy4kY29udGVudC5hcHBlbmQoICQoIGNyZWF0ZUxhcmdlTWFya2VySFRNTCggYXhpcywgbWFya2VyICkgKS5hZGRDbGFzcyggJ21vdXNlLW1hcmtlcicgKSApO1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gQXhpcyggc3BlYyApIHtcclxuXHJcbiAgICAgICAgdGhpcy5wb3NpdGlvbiA9ICggc3BlYy5wb3NpdGlvbiAhPT0gdW5kZWZpbmVkICkgPyBzcGVjLnBvc2l0aW9uLnRvTG93ZXJDYXNlKCkgOiAnYm90dG9tJztcclxuICAgICAgICB0aGlzLnJlcGVhdCA9ICggc3BlYy5yZXBlYXQgIT09IHVuZGVmaW5lZCApID8gc3BlYy5yZXBlYXQgOiBmYWxzZTtcclxuICAgICAgICB0aGlzLnRpdGxlID0gc3BlYy50aXRsZSB8fCAnQXhpcyc7XHJcbiAgICAgICAgdGhpcy5pc09wZW4gPSAoIHNwZWMuaXNPcGVuICE9PSB1bmRlZmluZWQgKSA/IHNwZWMuaXNPcGVuIDogdHJ1ZTtcclxuXHJcbiAgICAgICAgc3BlYy5pbnRlcnZhbHMgPSBzcGVjLmludGVydmFscyB8fCB7fTtcclxuICAgICAgICB0aGlzLmludGVydmFscyA9IHt9O1xyXG4gICAgICAgIHRoaXMuaW50ZXJ2YWxzLnR5cGUgPSAoIHNwZWMuaW50ZXJ2YWxzLnR5cGUgIT09IHVuZGVmaW5lZCApID8gc3BlYy5pbnRlcnZhbHMudHlwZS50b0xvd2VyQ2FzZSgpIDogJ3BlcmNlbnRhZ2UnO1xyXG4gICAgICAgIHRoaXMuaW50ZXJ2YWxzLmluY3JlbWVudCA9IHNwZWMuaW50ZXJ2YWxzLmluY3JlbWVudCB8fCAxMDtcclxuICAgICAgICB0aGlzLmludGVydmFscy5waXZvdCA9ICggc3BlYy5pbnRlcnZhbHMucGl2b3QgIT09IHVuZGVmaW5lZCApID8gc3BlYy5pbnRlcnZhbHMucGl2b3QgOiAwO1xyXG4gICAgICAgIHRoaXMuaW50ZXJ2YWxzLnNjYWxlQnlab29tID0gKCBzcGVjLmludGVydmFscy5zY2FsZUJ5Wm9vbSAhPT0gdW5kZWZpbmVkICkgPyBzcGVjLmludGVydmFscy5zY2FsZUJ5Wm9vbSA6IHRydWU7XHJcblxyXG4gICAgICAgIHNwZWMudW5pdHMgPSBzcGVjLnVuaXRzIHx8IHt9O1xyXG4gICAgICAgIHRoaXMudW5pdHMgPSB7fTtcclxuICAgICAgICB0aGlzLnVuaXRzLnR5cGUgPSAoIHNwZWMudW5pdHMudHlwZSAhPT0gdW5kZWZpbmVkICkgPyBzcGVjLnVuaXRzLnR5cGUudG9Mb3dlckNhc2UoKSA6ICdkZWNpbWFsJztcclxuICAgICAgICB0aGlzLnVuaXRzLmRpdmlzb3IgPSBzcGVjLnVuaXRzLmRpdmlzb3IgfHwgMTAwMDtcclxuICAgICAgICB0aGlzLnVuaXRzLmRlY2ltYWxzID0gc3BlYy51bml0cy5kZWNpbWFscyB8fCAyO1xyXG4gICAgICAgIHRoaXMudW5pdHMuc3RlcERvd24gPSAoIHNwZWMudW5pdHMuc3RlcERvd24gIT09IHVuZGVmaW5lZCApID8gc3BlYy51bml0cy5zdGVwRG93biA6IHRydWU7XHJcblxyXG4gICAgICAgIC8vIGdlbmVyYXRlIG1vcmUgYXR0cmlidXRlc1xyXG4gICAgICAgIHRoaXMuaXNYQXhpcyA9ICggdGhpcy5wb3NpdGlvbiA9PT0gJ3RvcCcgfHwgdGhpcy5wb3NpdGlvbiA9PT0gJ2JvdHRvbScgKTtcclxuICAgICAgICB0aGlzLmF4aXNXaWR0aE9ySGVpZ2h0ID0gdGhpcy5pc1hBeGlzID8gXCJ3aWR0aFwiIDogXCJoZWlnaHRcIjtcclxuICAgICAgICB0aGlzLm1hcmtlcldpZHRoT3JIZWlnaHQgPSB0aGlzLmlzWEF4aXMgPyBcImhlaWdodFwiIDogXCJ3aWR0aFwiO1xyXG4gICAgICAgIHRoaXMubGVmdE9yVG9wID0gdGhpcy5pc1hBeGlzID8gXCJsZWZ0XCIgOiBcInRvcFwiO1xyXG4gICAgICAgIHRoaXMuaG9yaXpvbnRhbE9yVmVydGljYWwgPSAodGhpcy5pc1hBeGlzKSA/ICdob3Jpem9udGFsJyA6ICd2ZXJ0aWNhbCc7XHJcbiAgICAgICAgdGhpcy5vcHBvc2l0ZVBvc2l0aW9uID0gKHRoaXMucG9zaXRpb24gPT09ICdsZWZ0JykgPyAncmlnaHQnIDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHRoaXMucG9zaXRpb24gPT09ICdyaWdodCcpID8gJ2xlZnQnIDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICh0aGlzLnBvc2l0aW9uID09PSAndG9wJykgPyAnYm90dG9tJyA6ICd0b3AnO1xyXG4gICAgfVxyXG5cclxuICAgIEF4aXMucHJvdG90eXBlLmFjdGl2YXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgLy8gY3JlYXRlIHVuaXF1ZSBjYWxsYmFja3Mgc28gdGhleSBjYW4gYmUgcmVtb3ZlZCBsYXRlclxyXG4gICAgICAgIHRoaXMucmVkcmF3Q2FsbGJhY2sgPSByZWRyYXdDYWxsYmFjayggdGhpcyApO1xyXG4gICAgICAgIHRoaXMubW91c2VNb3ZlQ2FsbGJhY2sgPSBtb3VzZU1vdmVDYWxsYmFjayggdGhpcyApO1xyXG4gICAgICAgIC8vIGF0dGFjaCBjYWxsYmFja3NcclxuICAgICAgICB0aGlzLm1hcC5vbiggJ21vdmUnLCB0aGlzLnJlZHJhd0NhbGxiYWNrICk7XHJcbiAgICAgICAgdGhpcy5tYXAub24oICdtb3VzZW1vdmUnLCB0aGlzLm1vdXNlTW92ZUNhbGxiYWNrICk7XHJcbiAgICAgICAgLy8gZ2VuZXJhdGUgdGhlIGNvcmUgaHRtbCBlbGVtZW50c1xyXG4gICAgICAgIHRoaXMuJG1hcCA9ICQoIHRoaXMubWFwLmdldEVsZW1lbnQoKSApO1xyXG4gICAgICAgIHRoaXMuJGF4aXMgPSBjcmVhdGVBeGlzKCB0aGlzICk7XHJcbiAgICAgICAgdGhpcy4kbWFwLmFwcGVuZCggdGhpcy4kYXhpcyApO1xyXG4gICAgICAgIC8vIGFsd2F5cyBzZXQgZW5hYmxlZCB0byB0cnVlLCBhcyBpc09wZW4gYXR0ciB3aWxsIHRyaWdnZXIgYSBjbGljaywgd2hpY2ggdG9nZ2xlcyB0aGUgZW5hYmxlZCBmbGFnXHJcbiAgICAgICAgdGhpcy5lbmFibGVkID0gdHJ1ZTtcclxuICAgICAgICAvLyBjYWxjdWxhdGUgdGhlIGRpbWVuc2lvbnMgb2YgdGhlIGluZGl2aWR1YWwgZWxlbWVudHMgb25jZVxyXG4gICAgICAgIGNhbGNFbGVtZW50RGltZW5zaW9ucyggdGhpcyApO1xyXG4gICAgICAgIC8vIGNoZWNrIGlmIGF4aXMgc3RhcnRzIG9wZW4gb3IgY2xvc2VkXHJcbiAgICAgICAgaWYgKCAhdGhpcy5pc09wZW4gKSB7XHJcbiAgICAgICAgICAgIC8vIHRyaWdnZXIgY2xvc2UgYW5kIHNraXAgYW5pbWF0aW9uO1xyXG4gICAgICAgICAgICB0aGlzLiRoZWFkZXIuY2xpY2soKTtcclxuICAgICAgICAgICAgdGhpcy4kY29udGVudC5maW5pc2goKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gYWxsb3cgZXZlbnRzIHRvIHByb3BhZ2F0ZSBiZWxvdyB0byBtYXAgZXhjZXB0ICdjbGljaydcclxuICAgICAgICBVdGlsLmVuYWJsZUV2ZW50UHJvcGFnYXRpb24oIHRoaXMuJGF4aXMgKTtcclxuICAgICAgICBVdGlsLmRpc2FibGVFdmVudFByb3BhZ2F0aW9uKCB0aGlzLiRheGlzLCBbJ29uY2xpY2snLCAnb25kYmxjbGljayddICk7XHJcbiAgICB9O1xyXG5cclxuICAgIEF4aXMucHJvdG90eXBlLmRlYWN0aXZhdGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLm1hcC5vZmYoICdtb3ZlJywgdGhpcy5yZWRyYXdDYWxsYmFjayApO1xyXG4gICAgICAgIHRoaXMubWFwLm9mZiggJ21vdXNlbW92ZScsIHRoaXMubW91c2VNb3ZlQ2FsbGJhY2sgKTtcclxuICAgICAgICB0aGlzLiRheGlzLnJlbW92ZSgpO1xyXG4gICAgICAgIHRoaXMuJGF4aXMgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuJHRpdGxlID0gbnVsbDtcclxuICAgICAgICB0aGlzLiRoZWFkZXIgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuJGNvbnRlbnQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMucmVkcmF3Q2FsbGJhY2sgPSBudWxsO1xyXG4gICAgICAgIHRoaXMubW91c2VNb3ZlQ2FsbGJhY2sgPSBudWxsO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqICBSZXR1cm5zIHRydWUgaWYgdGhlIGF4aXMgaXMgY3VycmVudGx5IGVuYWJsZWQsIGZhbHNlIGlmIG5vdFxyXG4gICAgICovXHJcbiAgICBBeGlzLnByb3RvdHlwZS5pc0VuYWJsZWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5lbmFibGVkO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqICBFbmFibGUgb3IgZGlzYWJsZSB0aGUgYXhpc1xyXG4gICAgICovXHJcbiAgICBBeGlzLnByb3RvdHlwZS5zZXRFbmFibGVkID0gZnVuY3Rpb24oIGVuYWJsZWQgKSB7XHJcbiAgICAgICAgdGhpcy5lbmFibGVkID0gZW5hYmxlZDtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiAgUmV0dXJucyB0aGUgZGltZW5zaW9uIG9mIHRoZSBjb250ZW50IGRpdiBvZiB0aGUgYXhpc1xyXG4gICAgICovXHJcbiAgICBBeGlzLnByb3RvdHlwZS5nZXRDb250ZW50RGltZW5zaW9uID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGRpbSA9IHRoaXMuaXNYQXhpcyA/IHRoaXMuTUFYX0xBQkVMX0hFSUdIVCA6IHRoaXMuTUFYX0xBQkVMX1dJRFRIO1xyXG4gICAgICAgIHJldHVybiBkaW0gKyBTUEFDSU5HX0JFVFdFRU5fTUFSS0VSX0FORF9MQUJFTCoyICsgdGhpcy5MQVJHRV9NQVJLRVJfTEVOR1RIICsgdGhpcy5IRUFERVJfV0lEVEg7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogSXRlcmF0ZXMgb3ZlciBhbGwgYXhlcyBvbiB0aGUgbWFwLCBkZXRlcm1pbmVzIHRoZSBtYXggY29udGVudCBzaXplLCBhbmQgc2V0cyB0aGUgY29udGVudCBkaW1lbnNpb25cclxuICAgICAqIHRvIHRoYXQgc2l6ZS5cclxuICAgICAqL1xyXG4gICAgQXhpcy5wcm90b3R5cGUuc2V0Q29udGVudERpbWVuc2lvbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBkaW0gPSB0aGlzLmlzWEF4aXMgPyAnaGVpZ2h0JyA6ICd3aWR0aCcsXHJcbiAgICAgICAgICAgIG1heEF4aXNMYWJlbERpbSA9IDA7XHJcbiAgICAgICAgXy5mb3JJbiggdGhpcy5tYXAuYXhlcywgZnVuY3Rpb24oIHZhbHVlICkge1xyXG4gICAgICAgICAgICBtYXhBeGlzTGFiZWxEaW0gPSBNYXRoLm1heCggdmFsdWUuZ2V0Q29udGVudERpbWVuc2lvbigpIHx8IDAsIG1heEF4aXNMYWJlbERpbSApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuJGNvbnRlbnRbIGRpbSBdKCBtYXhBeGlzTGFiZWxEaW0gKTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVja3MgaWYgdGhlIG11dGFibGUgc3BlYyBhdHRyaWJ1dGVzIGhhdmUgY2hhbmdlZCwgaWYgc28sIHJlZHJhd3NcclxuICAgICAqIHRoYXQuXHJcbiAgICAgKi9cclxuICAgIEF4aXMucHJvdG90eXBlLnJlZHJhdyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIC8vIGFsd2F5cyB1cGRhdGUgdGl0bGUgcG9zaXRpb24gKGluIGNhc2Ugb2Ygd2luZG93IHJlc2l6ZSlcclxuICAgICAgICB1cGRhdGVBeGlzVGl0bGUoIHRoaXMgKTtcclxuICAgICAgICAvLyBleGl0IGVhcmx5IGlmIG5vIG1hcmtlcnMgYXJlIHZpc2libGVcclxuICAgICAgICBpZiAoICF0aGlzLmlzRW5hYmxlZCgpICkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGFkZCBlYWNoIG1hcmtlciB0byBjb3JyZWN0IHBpeGVsIGxvY2F0aW9uIGluIGF4aXMgRE9NIGVsZW1lbnRzXHJcbiAgICAgICAgdXBkYXRlQXhpc0NvbnRlbnQoIHRoaXMgKTtcclxuICAgIH07XHJcblxyXG4gICAgbW9kdWxlLmV4cG9ydHMgPSBBeGlzO1xyXG59KCkpO1xyXG4iLCIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgT2N1bHVzIEluZm8gSW5jLlxyXG4gKiBodHRwOi8vd3d3Lm9jdWx1c2luZm8uY29tL1xyXG4gKlxyXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXHJcbiAqXHJcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkgb2ZcclxuICogdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpblxyXG4gKiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvXHJcbiAqIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzXHJcbiAqIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkb1xyXG4gKiBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XHJcblxyXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbiBhbGxcclxuICogY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cclxuXHJcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcclxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXHJcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxyXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXHJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXHJcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFXHJcbiAqIFNPRlRXQVJFLlxyXG4gKi9cclxuXHJcbiggZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgdmFyIFV0aWwgPSByZXF1aXJlKCcuLi91dGlsL1V0aWwnKSxcclxuICAgICAgICBNYXBVdGlsID0gcmVxdWlyZSgnLi9NYXBVdGlsJyksXHJcbiAgICAgICAgTUFSS0VSX1RZUEVfT1JERVIgPSBbJ2xhcmdlJywgJ3NtYWxsJywgJ21lZGl1bScsICdzbWFsbCddO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUHJpdmF0ZTogR2l2ZW4gYSB2YWx1ZSB0aGF0IGlzIG91dHNpZGUgb2YgdGhlIG1pbiBhbmQgbWF4IG9mIGF4aXMsXHJcbiAgICAgKiBlbnN1cmUgdGhlIHZhbHVlcyByb2xsb3ZlciBwcm9wZXJseVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBheGlzICB7QXhpc30gICB0aGUgYXhpcyBvYmplY3QuXHJcbiAgICAgKiBAcGFyYW0gdmFsdWUge251bWJlcn0gb3JpZ2luYWwgdmFsdWUuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGdldE1hcmtlclJvbGxvdmVyKCBheGlzLCB2YWx1ZSApIHtcclxuICAgICAgICB2YXIgcm9sbG92ZXI7XHJcbiAgICAgICAgaWYgKCBheGlzLnJlcGVhdCApIHtcclxuICAgICAgICAgICAgLy8gaWYgcmVwZWF0IGVuYWJsZWQgZW5zdXJlIGxhYmVsIHZhbHVlIHdyYXBzIHBhc3QgbWluL21heCBwcm9wZXJseVxyXG4gICAgICAgICAgICBpZiAoIHZhbHVlID4gYXhpcy5tYXggKSB7XHJcbiAgICAgICAgICAgICAgICByb2xsb3ZlciA9IHZhbHVlIC0gYXhpcy5tYXggKyBheGlzLm1pbjtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICggdmFsdWUgPCBheGlzLm1pbiApIHtcclxuICAgICAgICAgICAgICAgIHJvbGxvdmVyID0gdmFsdWUgKyBheGlzLm1heCAtIGF4aXMubWluO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcm9sbG92ZXIgPSB2YWx1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIG5vbi1yZXBlYXQgbGFiZWwgaXMgYWx3YXlzIHZhbHVlIGFzIHRoZXJlIGlzIG5vIHdyYXAgYXJvdW5kXHJcbiAgICAgICAgICAgIHJvbGxvdmVyID0gdmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByb2xsb3ZlcjtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFByaXZhdGU6IFJldHVybnMgdGhlIHBpeGVsIHBvc2l0aW9uIGZvciB0aGUgdmFsdWUgaW4gdmlld3BvcnQgY29vcmRpbmF0ZXMuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGF4aXMgIHtBeGlzfSAgIGF4aXMgb2JqZWN0LlxyXG4gICAgICogQHBhcmFtIHZhbHVlIHtudW1iZXJ9IHRoZSBjb29yZGluYXRlIHZhbHVlLlxyXG4gICAgICogQHJldHVybnMge2ludH0gcGl4ZWwgcG9zaXRpb25cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gZ2V0UGl4ZWxQb3NpdGlvbiggYXhpcywgdmFsdWUgKSB7XHJcbiAgICAgICAgLy8gZ2l2ZW4gYW4gYXhpcyB2YWx1ZSwgZ2V0IHRoZSBwaXhlbCBwb3NpdGlvbiBvbiB0aGUgcGFnZVxyXG4gICAgICAgIGlmICggYXhpcy5pc1hBeGlzICkge1xyXG4gICAgICAgICAgICByZXR1cm4gTWFwVXRpbC5nZXRWaWV3cG9ydFBpeGVsRnJvbUNvb3JkKCBheGlzLm1hcCwgdmFsdWUsIDAgKS54O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gTWFwVXRpbC5nZXRWaWV3cG9ydFBpeGVsRnJvbUNvb3JkKCBheGlzLm1hcCwgMCwgdmFsdWUgKS55O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUHJpdmF0ZTogRmlsbHMgYW4gYXJyYXkgb2YgbWFya2VycyBieSBzdWIgaW5jcmVtZW50cy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gYXhpcyAgICAgIHtBeGlzfSAgIGF4aXMgb2JqZWN0LlxyXG4gICAgICogQHBhcmFtIHN0YXJ0ICAgICB7bnVtYmVyfSBzdGFydCBpbmNyZW1lbnQuXHJcbiAgICAgKiBAcGFyYW0gZW5kICAgICAgIHtudW1iZXJ9IGVuZCBpbmNyZW1lbnRcclxuICAgICAqIEBwYXJhbSBpbnRlcnZhbHMge09iamVjdH0gaW50ZXJ2YWxzIHNwZWNpZmljYXRpb24gb2JqZWN0LlxyXG4gICAgICogQHJldHVybnMge3tsYXJnZTogQXJyYXksIG1lZGl1bTogQXJyYXksIHNtYWxsOiBBcnJheX19XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGZpbGxBcnJheUJ5SW5jcmVtZW50KCBheGlzLCBzdGFydCwgZW5kLCBpbnRlcnZhbHMgKSB7XHJcbiAgICAgICAgdmFyIEVQU0lMT04gPSAwLjAwMDAwMSxcclxuICAgICAgICAgICAgc3ViSW5jcmVtZW50ID0gaW50ZXJ2YWxzLnN1YkluY3JlbWVudCxcclxuICAgICAgICAgICAgc3RhcnRpbmdNYXJrZXJUeXBlSW5kZXggPSBpbnRlcnZhbHMuc3RhcnRpbmdNYXJrZXJUeXBlSW5kZXgsXHJcbiAgICAgICAgICAgIG1hcmtlcnMgPSB7XHJcbiAgICAgICAgICAgICAgICBsYXJnZTogW10sXHJcbiAgICAgICAgICAgICAgICBtZWRpdW06IFtdLFxyXG4gICAgICAgICAgICAgICAgc21hbGw6IFtdXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGkgPSBVdGlsLm1vZCggc3RhcnRpbmdNYXJrZXJUeXBlSW5kZXgsIE1BUktFUl9UWVBFX09SREVSLmxlbmd0aCApLFxyXG4gICAgICAgICAgICB2YWx1ZTtcclxuICAgICAgICAvLyByZWR1Y2Ugc3ViIGluY3JlbWVudCBieSBlcHNpbG9uIHRvIHByZXZlbnQgcHJlY2lzaW9uIGVycm9ycyBjdWxsaW5nIG1heCBwb2ludFxyXG4gICAgICAgIHN1YkluY3JlbWVudCA9ICggc3ViSW5jcmVtZW50ID4gMCApID8gc3ViSW5jcmVtZW50IC0gRVBTSUxPTiA6IHN1YkluY3JlbWVudCArIEVQU0lMT047XHJcblxyXG4gICAgICAgIGZvciAoIHZhbHVlID0gc3RhcnQ7IHZhbHVlIDw9IGVuZDsgdmFsdWUgKz0gc3ViSW5jcmVtZW50ICkge1xyXG4gICAgICAgICAgICBtYXJrZXJzWyBNQVJLRVJfVFlQRV9PUkRFUltpXSBdLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgbGFiZWw6IGdldE1hcmtlclJvbGxvdmVyKCBheGlzLCB2YWx1ZSApLFxyXG4gICAgICAgICAgICAgICAgcGl4ZWw6IGdldFBpeGVsUG9zaXRpb24oIGF4aXMsIHZhbHVlIClcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGkgPSAoaSArIDEpICUgTUFSS0VSX1RZUEVfT1JERVIubGVuZ3RoO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbWFya2VycztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFByaXZhdGU6IFJldHVybnMgdGhlIG1pbmltdW0gdmlzaWJsZSBpbmNyZW1lbnQgb24gdGhlIGF4aXMuIEFsc28gc2V0cyB0aGVcclxuICAgICAqICdzdGFydGluZ01hcmtlclR5cGVJbmRleCcgYXR0cmlidXRlIG9uIHRoZSBpbnRlcnZhbHMgb2JqZWN0IHRvIGRpc3Rpbmd1aXNoXHJcbiAgICAgKiB3aGljaCB0eXBlIG9mIG1hcmtlciB0byBzdGFydCBvbi5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gYXhpcyAgICAgIHtBeGlzfSAgIGF4aXMgb2JqZWN0LlxyXG4gICAgICogQHBhcmFtIGludGVydmFscyB7T2JqZWN0fSBpbnRlcnZhbHMgc3BlY2lmaWNhdGlvbiBvYmplY3QuXHJcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBtaW5pbXVtIGluY3JlbWVudC5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gZ2V0TWluSW5jcmVtZW50KCBheGlzLCBpbnRlcnZhbHMgKSB7XHJcbiAgICAgICAgdmFyIG1pbkN1bGwsIC8vIGV4YWN0IHZhbHVlIG9mIGN1bGwgcG9pbnQsIGFueSB2YWx1ZSBsZXNzIHdpbGwgYmUgY3VsbGVkIGZyb20gdmlld1xyXG4gICAgICAgICAgICBpbmNyZW1lbnRDb3VudDsgLy8gbnVtYmVyIG9mIHN1YiBpbmNyZW1lbnRzIGZyb20gdGhlIHBpdm90XHJcbiAgICAgICAgaWYgKCBheGlzLmlzWEF4aXMgKSB7XHJcbiAgICAgICAgICAgIG1pbkN1bGwgPSBNYXBVdGlsLmdldENvb3JkRnJvbVZpZXdwb3J0UGl4ZWwoIGF4aXMubWFwLCAwLCAwICkueDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBtaW5DdWxsID0gTWFwVXRpbC5nZXRDb29yZEZyb21WaWV3cG9ydFBpeGVsKCBheGlzLm1hcCwgMCwgYXhpcy5tYXAuZ2V0Vmlld3BvcnRIZWlnaHQoKSApLnk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICggIWF4aXMucmVwZWF0ICYmIG1pbkN1bGwgPCBheGlzLm1pbiApIHtcclxuICAgICAgICAgICAgLy8gcHJldmVudCByb2xsLW92ZXJcclxuICAgICAgICAgICAgbWluQ3VsbCA9IGF4aXMubWluO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBkZXRlcm1pbmUgaG93IG1hbnkgc3ViIGluY3JlbWVudHMgZnJvbSB0aGUgcGl2b3QgdG8gdGhlIG1pbmltdW0gY3VsbGluZyBwb2ludFxyXG4gICAgICAgIGluY3JlbWVudENvdW50ID0gTWF0aC5mbG9vciggKCBtaW5DdWxsIC0gaW50ZXJ2YWxzLnBpdm90ICkgLyBpbnRlcnZhbHMuc3ViSW5jcmVtZW50ICk7XHJcbiAgICAgICAgaW50ZXJ2YWxzLnN0YXJ0aW5nTWFya2VyVHlwZUluZGV4ID0gaW5jcmVtZW50Q291bnQ7XHJcbiAgICAgICAgLy8gcmV0dXJuIHRoZSBtaW5pbXVtIGluY3JlbWVudCB0aGF0IGlzIHN0aWxsIGluIHZpZXdcclxuICAgICAgICByZXR1cm4gaW50ZXJ2YWxzLnBpdm90ICsgaW50ZXJ2YWxzLnN1YkluY3JlbWVudCAqIGluY3JlbWVudENvdW50O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUHJpdmF0ZTogUmV0dXJucyB0aGUgbWF4aW11bSB2aXNpYmxlIGluY3JlbWVudCBvbiB0aGUgYXhpcy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gYXhpcyAgICAgIHtBeGlzfSAgIGF4aXMgb2JqZWN0LlxyXG4gICAgICogQHBhcmFtIGludGVydmFscyB7T2JqZWN0fSBpbnRlcnZhbHMgc3BlY2lmaWNhdGlvbiBvYmplY3QuXHJcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBtYXhpbXVtIGluY3JlbWVudC5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gZ2V0TWF4SW5jcmVtZW50KCBheGlzLCBpbnRlcnZhbHMgKSB7XHJcbiAgICAgICAgdmFyIG1heEN1bGwsIC8vIGV4YWN0IHZhbHVlIG9mIGN1bGwgcG9pbnQsIGFueSB2YWx1ZSBncmVhdGVyIHdpbGwgYmUgY3VsbGVkIGZyb20gdmlld1xyXG4gICAgICAgICAgICBpbmNyZW1lbnRDb3VudDsgLy8gbnVtYmVyIG9mIHN1YiBpbmNyZW1lbnRzIGZyb20gdGhlIHBpdm90XHJcbiAgICAgICAgaWYgKCBheGlzLmlzWEF4aXMgKSB7XHJcbiAgICAgICAgICAgIG1heEN1bGwgPSBNYXBVdGlsLmdldENvb3JkRnJvbVZpZXdwb3J0UGl4ZWwoIGF4aXMubWFwLCBheGlzLm1hcC5nZXRWaWV3cG9ydFdpZHRoKCksIDAgKS54O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIG1heEN1bGwgPSBNYXBVdGlsLmdldENvb3JkRnJvbVZpZXdwb3J0UGl4ZWwoIGF4aXMubWFwLCAwLCAwICkueTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCAhYXhpcy5yZXBlYXQgJiYgbWF4Q3VsbCA+IGF4aXMubWF4ICkge1xyXG4gICAgICAgICAgICAvLyBwcmV2ZW50IHJvbGwtb3ZlclxyXG4gICAgICAgICAgICBtYXhDdWxsID0gYXhpcy5tYXg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGRldGVybWluZSBob3cgbWFueSBzdWIgaW5jcmVtZW50cyBmcm9tIHRoZSBwaXZvdCB0byB0aGUgbWF4aW11bSBjdWxsaW5nIHBvaW50XHJcbiAgICAgICAgaW5jcmVtZW50Q291bnQgPSBNYXRoLmZsb29yKCAoIG1heEN1bGwgLSBpbnRlcnZhbHMucGl2b3QgKSAvIGludGVydmFscy5zdWJJbmNyZW1lbnQgKTtcclxuICAgICAgICAvLyByZXR1cm4gdGhlIG1heGltdW0gaW5jcmVtZW50IHRoYXQgaXMgc3RpbGwgaW4gdmlld1xyXG4gICAgICAgIHJldHVybiBpbnRlcnZhbHMucGl2b3QgKyBpbnRlcnZhbHMuc3ViSW5jcmVtZW50ICogaW5jcmVtZW50Q291bnQ7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBQcml2YXRlOiBSb3VuZHMgYSB2YWx1ZSB0byBhbiBpbnRlZ2VyIHJlcHJlc2VudGF0aW9uLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB2YWx1ZSB7bnVtYmVyfSB0aGUgdmFsdWUuXHJcbiAgICAgKiBAcmV0dXJucyB7aW50fVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBmb3JtYXRJbnRlZ2VyKCB2YWx1ZSApIHtcclxuICAgICAgICByZXR1cm4gTWF0aC5yb3VuZCggdmFsdWUgKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFByaXZhdGU6IFJvdW5kcyBhIHZhbHVlIHRvIGFuIGZsb2F0aW5nIHBvaW50IHJlcHJlc2VudGF0aW9uIHdpdGggc3BlY2lmaWMgZGVjaW1hbCBwbGFjZXMuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHZhbHVlICAgIHtudW1iZXJ9IHRoZSB2YWx1ZS5cclxuICAgICAqIEBwYXJhbSBkZWNpbWFscyB7aW50fSAgICB0aGUgbnVtYmVyIG9mIGRlY2ltYWwgcGxhY2VzLlxyXG4gICAgICogQHJldHVybnMge3N0cmluZ31cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gZm9ybWF0TnVtYmVyKCB2YWx1ZSwgZGVjaW1hbHMgKSB7XHJcbiAgICAgICAgcmV0dXJuIFV0aWwucm91bmRUb0RlY2ltYWxzKCB2YWx1ZSwgZGVjaW1hbHMgKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFByaXZhdGU6IFJvdW5kcyBhIHZhbHVlIHRvIGFuIGZsb2F0aW5nIHBvaW50IHJlcHJlc2VudGF0aW9uIG9mIHRob3VzYW5kcyB3aXRoIGEgJ0snIGFwcGVuZGVkXHJcbiAgICAgKiBvbnRvIHRoZSBlbmQuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHZhbHVlICAgICAgICAge251bWJlcn0gIHRoZSB2YWx1ZS5cclxuICAgICAqIEBwYXJhbSBkZWNpbWFscyAgICAgIHtpbnR9ICAgICB0aGUgbnVtYmVyIG9mIGRlY2ltYWwgcGxhY2VzLlxyXG4gICAgICogQHBhcmFtIGFsbG93U3RlcERvd24ge2Jvb2xlYW59IHdoZXRoZXIgb3Igbm90IHRvIHN0ZXAgZG93biB1bml0cyBpZiA8IDFcclxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGZvcm1hdFRob3VzYW5kKCB2YWx1ZSwgZGVjaW1hbHMsIGFsbG93U3RlcERvd24gKSB7XHJcbiAgICAgICAgdmFyIHRydW5jVmFsdWUgPSB2YWx1ZSAvIDFlMztcclxuICAgICAgICBpZiAoIGFsbG93U3RlcERvd24gJiYgTWF0aC5hYnMoIHRydW5jVmFsdWUgKSA8IDEgJiYgdmFsdWUgIT09IDAgKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmb3JtYXROdW1iZXIoIHZhbHVlLCAwICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBVdGlsLnJvdW5kVG9EZWNpbWFscyggdHJ1bmNWYWx1ZSwgZGVjaW1hbHMgKSArICdLJztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFByaXZhdGU6IFJvdW5kcyBhIHZhbHVlIHRvIGFuIGZsb2F0aW5nIHBvaW50IHJlcHJlc2VudGF0aW9uIG9mIG1pbGxpb25zIHdpdGggYW4gJ00nIGFwcGVuZGVkXHJcbiAgICAgKiBvbnRvIHRoZSBlbmQuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHZhbHVlICAgICAgICAge251bWJlcn0gIHRoZSB2YWx1ZS5cclxuICAgICAqIEBwYXJhbSBkZWNpbWFscyAgICAgIHtpbnR9ICAgICB0aGUgbnVtYmVyIG9mIGRlY2ltYWwgcGxhY2VzLlxyXG4gICAgICogQHBhcmFtIGFsbG93U3RlcERvd24ge2Jvb2xlYW59IHdoZXRoZXIgb3Igbm90IHRvIHN0ZXAgZG93biB1bml0cyBpZiA8IDFcclxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGZvcm1hdE1pbGxpb24oIHZhbHVlLCBkZWNpbWFscywgYWxsb3dTdGVwRG93biApIHtcclxuICAgICAgICB2YXIgdHJ1bmNWYWx1ZSA9IHZhbHVlIC8gMWU2O1xyXG4gICAgICAgIGlmICggYWxsb3dTdGVwRG93biAmJiBNYXRoLmFicyggdHJ1bmNWYWx1ZSApIDwgMSAmJiB2YWx1ZSAhPT0gMCApIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZvcm1hdFRob3VzYW5kKCB2YWx1ZSwgMCApO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gVXRpbC5yb3VuZFRvRGVjaW1hbHMoIHRydW5jVmFsdWUsIGRlY2ltYWxzICkgKyAnTSc7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBQcml2YXRlOiBSb3VuZHMgYSB2YWx1ZSB0byBhbiBmbG9hdGluZyBwb2ludCByZXByZXNlbnRhdGlvbiBvZiBiaWxsaW9ucyB3aXRoIGEgJ0InIGFwcGVuZGVkXHJcbiAgICAgKiBvbnRvIHRoZSBlbmQuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHZhbHVlICAgICAgICAge251bWJlcn0gIHRoZSB2YWx1ZS5cclxuICAgICAqIEBwYXJhbSBkZWNpbWFscyAgICAgIHtpbnR9ICAgICB0aGUgbnVtYmVyIG9mIGRlY2ltYWwgcGxhY2VzLlxyXG4gICAgICogQHBhcmFtIGFsbG93U3RlcERvd24ge2Jvb2xlYW59IHdoZXRoZXIgb3Igbm90IHRvIHN0ZXAgZG93biB1bml0cyBpZiA8IDFcclxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGZvcm1hdEJpbGxpb24oIHZhbHVlLCBkZWNpbWFscywgYWxsb3dTdGVwRG93biApIHtcclxuICAgICAgICB2YXIgdHJ1bmNWYWx1ZSA9IHZhbHVlIC8gMWU5O1xyXG4gICAgICAgIGlmICggYWxsb3dTdGVwRG93biAmJiBNYXRoLmFicyggdHJ1bmNWYWx1ZSApIDwgMSAmJiB2YWx1ZSAhPT0gMCApIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZvcm1hdE1pbGxpb24oIHZhbHVlLCAwICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBVdGlsLnJvdW5kVG9EZWNpbWFscyggdHJ1bmNWYWx1ZSwgZGVjaW1hbHMgKSArICdCJztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFByaXZhdGU6IEZvcm1hdHMgYSB0aW1lc3RhbXAgaW50byBhIGRhdGUuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHZhbHVlIHtpbnR9IHVuaXggdGltZXN0YW1wLlxyXG4gICAgICogQHJldHVybnMge3N0cmluZ31cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gZm9ybWF0VGltZSggdmFsdWUgKSB7XHJcbiAgICAgICAgdmFyIGQgPSBuZXcgRGF0ZSggMCApOyAvLyBUaGUgMCB0aGVyZSBpcyB0aGUga2V5LCB3aGljaCBzZXRzIHRoZSBkYXRlIHRvIHRoZSBlcG9jaFxyXG4gICAgICAgIGQuc2V0VVRDU2Vjb25kcyggdmFsdWUgLyAxMDAwICk7IC8vIEFzc3VtZSBkZWZhdWx0IG9mIG1pbGxpc2Vjb25kc1xyXG4gICAgICAgIHJldHVybiAoIGQuZ2V0TW9udGgoKSArIDEgKSArICcvJyArIGQuZ2V0RGF0ZSgpICsgJy8nICsgKCBkLmdldEZ1bGxZZWFyKCkgKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFByaXZhdGU6IEZvcm1hdHMgYSBmbG9hdGluZyBwb2ludCBudW1iZXIgYW5kIGFwcGVuZHMgYSAnZGVncmVlcycgc3ltYm9sLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB2YWx1ZSAgICB7ZmxvYXR9IGRlZ3JlZXMgdmFsdWUuXHJcbiAgICAgKiBAcGFyYW0gZGVjaW1hbHMge2ludH0gICB0aGUgbnVtYmVyIG9mIGRlY2ltYWwgcGxhY2VzLlxyXG4gICAgICogQHJldHVybnMge3N0cmluZ31cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gZm9ybWF0RGVncmVlcyggdmFsdWUsIGRlY2ltYWxzICkge1xyXG4gICAgICAgIHJldHVybiBmb3JtYXROdW1iZXIoIHZhbHVlLCBkZWNpbWFscyApICsgXCJcXHUwMGIwXCI7XHJcbiAgICB9XHJcblxyXG4gICAgbW9kdWxlLmV4cG9ydHMgPSB7XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEZvcm1hdHMgYXhpcyBtYXJrZXIgbGFiZWwgdGV4dC5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSB2YWx1ZSB7bnVtYmVyfSB2YWx1ZSBvZiB0aGUgbGFiZWxcclxuICAgICAgICAgKiBAcGFyYW0gdW5pdHMge09iamVjdH0gdW5pdCBzcGVjaWZpY2F0aW9uIG9mIHRoZSBheGlzLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZvcm1hdFRleHQ6IGZ1bmN0aW9uKCB2YWx1ZSwgdW5pdHMgKSB7XHJcblxyXG4gICAgICAgICAgICBpZiAoICF1bml0cyApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmb3JtYXROdW1iZXIoIHZhbHVlLCAyICk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN3aXRjaCAoIHVuaXRzLnR5cGUgKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSAnZGVncmVlcyc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdkZWdyZWUnOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnZGVnJzpcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZvcm1hdERlZ3JlZXMoIHZhbHVlLCB1bml0cy5kZWNpbWFscyApO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgJ3RpbWUnOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnZGF0ZSc6XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmb3JtYXRUaW1lKCB2YWx1ZSApO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgJ2snOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAndGhvdXNhbmQnOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAndGhvdXNhbmRzJzpcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZvcm1hdFRob3VzYW5kKCB2YWx1ZSwgdW5pdHMuZGVjaW1hbHMsIHVuaXRzLnN0ZXBEb3duICk7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSAnbSc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdtaWxsaW9uJzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ21pbGxpb25zJzpcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZvcm1hdE1pbGxpb24oIHZhbHVlLCB1bml0cy5kZWNpbWFscywgdW5pdHMuc3RlcERvd24gKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlICdiJzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2JpbGxpb24nOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnYmlsbGlvbnMnOlxyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm9ybWF0QmlsbGlvbiggdmFsdWUsIHVuaXRzLmRlY2ltYWxzLCB1bml0cy5zdGVwRG93biApO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgJ2knOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnaW50JzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2ludGVnZXInOlxyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm9ybWF0SW50ZWdlcih2YWx1ZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZvcm1hdE51bWJlciggdmFsdWUsIHVuaXRzLmRlY2ltYWxzICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBHZW5lcmF0ZXMgYSBtYXJrZXIgdmFsdWUgZm9yIHRoZSBnaXZlbiB2aWV3cG9ydCBwaXhlbCBjb29yZHMuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gYXhpcyB7QXhpc30gdGhlIGF4aXMgb2JqZWN0LlxyXG4gICAgICAgICAqIEBwYXJhbSB2eCAgIHtpbnR9ICB4IHZpZXdwb3J0IHBpeGVsIGNvb3JkaW5hdGVcclxuICAgICAgICAgKiBAcGFyYW0gdnkgICB7aW50fSAgeSB2aWV3cG9ydCBwaXhlbCBjb29yZGluYXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0TWFya2VyOiBmdW5jdGlvbiggYXhpcywgdngsIHZ5ICkge1xyXG4gICAgICAgICAgICB2YXIgeE9yWSA9IGF4aXMuaXNYQXhpcyA/ICd4JyA6ICd5JyxcclxuICAgICAgICAgICAgICAgIHBpeGVsID0gKCBheGlzLmlzWEF4aXMgKSA/IHZ4IDogdnksXHJcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IE1hcFV0aWwuZ2V0Q29vcmRGcm9tVmlld3BvcnRQaXhlbCggYXhpcy5tYXAsIHZ4LCB2eSApWyB4T3JZIF07XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBsYWJlbDogZ2V0TWFya2VyUm9sbG92ZXIoYXhpcywgdmFsdWUpLFxyXG4gICAgICAgICAgICAgICAgcGl4ZWw6IHBpeGVsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogR2VuZXJhdGVzIGFsbCB2aXNpYmxlIG1hcmtlciB2YWx1ZXMsIHJldHVybnMgYXJyYXkgb2Ygb2JqZWN0cywgY29udGFpbmluZ1xyXG4gICAgICAgICAqIGxhYmVscyBhbmQgcGl4ZWwgbG9jYXRpb25zXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gYXhpcyB7QXhpc30gdGhlIGF4aXMgb2JqZWN0LlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldE1hcmtlcnM6IGZ1bmN0aW9uKCBheGlzICkge1xyXG4gICAgICAgICAgICB2YXIgaW50ZXJ2YWxzID0ge30sXHJcbiAgICAgICAgICAgICAgICBpbmNyZW1lbnQsXHJcbiAgICAgICAgICAgICAgICBtaW5JbmNyZW1lbnQsXHJcbiAgICAgICAgICAgICAgICBtYXhJbmNyZW1lbnQ7XHJcblxyXG4gICAgICAgICAgICBzd2l0Y2ggKCBheGlzLmludGVydmFscy50eXBlICkge1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgXCJ2YWx1ZVwiOlxyXG4gICAgICAgICAgICAgICAgY2FzZSBcImZpeGVkXCI6XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiI1wiOlxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHVzZSBmaXhlZCBpbnRlcnZhbFxyXG4gICAgICAgICAgICAgICAgICAgIGluY3JlbWVudCA9IGF4aXMuaW50ZXJ2YWxzLmluY3JlbWVudDtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHVzZSBwZXJjZW50YWdlXHJcbiAgICAgICAgICAgICAgICAgICAgaW5jcmVtZW50ID0gYXhpcy5pbnRlcnZhbHMuaW5jcmVtZW50O1xyXG4gICAgICAgICAgICAgICAgICAgIGluY3JlbWVudCA9ICggaW5jcmVtZW50ID4gMSApID8gaW5jcmVtZW50ICogMC4wMSA6IGluY3JlbWVudDtcclxuICAgICAgICAgICAgICAgICAgICBpbmNyZW1lbnQgPSAoIGF4aXMubWF4IC0gYXhpcy5taW4gKSAqIGluY3JlbWVudDtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gc2V0IHBpdm90XHJcbiAgICAgICAgICAgIGludGVydmFscy5waXZvdCA9IGF4aXMuaW50ZXJ2YWxzLnBpdm90O1xyXG5cclxuICAgICAgICAgICAgLy8gc2NhbGUgaW5jcmVtZW50IGlmIHNwZWNpZmllZFxyXG4gICAgICAgICAgICBpZiAoIGF4aXMuaW50ZXJ2YWxzLnNjYWxlQnlab29tICkge1xyXG4gICAgICAgICAgICAgICAgLy8gc2NhbGUgaW5jcmVtZW50IGJ5IHpvb21cclxuICAgICAgICAgICAgICAgIGluY3JlbWVudCA9IGluY3JlbWVudCAvIE1hdGgucG93KDIsIE1hdGgubWF4KCBheGlzLm1hcC5nZXRab29tKCkgLSAxLCAwKSApO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBnZXQgc3ViIGluY3JlbWVudCBmb3Igc21hbGwgLyBtZWRpdW0gbGFiZWwtbGVzcyB0aWNrc1xyXG4gICAgICAgICAgICBpbnRlcnZhbHMuc3ViSW5jcmVtZW50ID0gaW5jcmVtZW50IC8gTUFSS0VSX1RZUEVfT1JERVIubGVuZ3RoO1xyXG5cclxuICAgICAgICAgICAgLy8gZ2V0IG1pbmltdW0gYW5kIG1heGltdW0gdmlzaWJsZSBpbmNyZW1lbnRzIG9uIHRoZSBheGlzXHJcbiAgICAgICAgICAgIG1pbkluY3JlbWVudCA9IGdldE1pbkluY3JlbWVudCggYXhpcywgaW50ZXJ2YWxzICk7XHJcbiAgICAgICAgICAgIG1heEluY3JlbWVudCA9IGdldE1heEluY3JlbWVudCggYXhpcywgaW50ZXJ2YWxzICk7XHJcblxyXG4gICAgICAgICAgICAvLyBhZGQgYWxsIHBvaW50cyBiZXR3ZWVuIG1pbmltdW0gdmlzaWJsZSB2YWx1ZSBhbmQgbWF4aW11bSB2aXNpYmxlIHZhbHVlXHJcbiAgICAgICAgICAgIHJldHVybiBmaWxsQXJyYXlCeUluY3JlbWVudCggYXhpcywgbWluSW5jcmVtZW50LCBtYXhJbmNyZW1lbnQsIGludGVydmFscyApO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn0oKSk7XHJcbiIsIi8qXHJcbiAqIENvcHlyaWdodCAoYykgMjAxNCBPY3VsdXMgSW5mbyBJbmMuXHJcbiAqIGh0dHA6Ly93d3cub2N1bHVzaW5mby5jb20vXHJcbiAqXHJcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuICpcclxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weSBvZlxyXG4gKiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluXHJcbiAqIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG9cclxuICogdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXNcclxuICogb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvXHJcbiAqIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcclxuXHJcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbFxyXG4gKiBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxyXG5cclxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxyXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXHJcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcclxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEVcclxuICogU09GVFdBUkUuXHJcbiAqL1xyXG5cclxuKCBmdW5jdGlvbigpIHtcclxuXHJcblx0XCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG5cdHZhciBPcGVuTGF5ZXJzID0gcmVxdWlyZSgnLi4vb3BlbmxheWVycy9PcGVuTGF5ZXJzLm1pbicpLFxyXG4gICAgICAgICQgPSByZXF1aXJlKCdqcXVlcnknKSxcclxuICAgICAgICBfID0gcmVxdWlyZSgnbG9kYXNoJyksXHJcbiAgICAgICAgQXhpcyA9IHJlcXVpcmUoJy4vQXhpcycpLFxyXG4gICAgICAgIE1hcFV0aWwgPSByZXF1aXJlKCcuL01hcFV0aWwnKSxcclxuICAgICAgICBMYXllciA9IHJlcXVpcmUoJy4uL2xheWVyL0xheWVyJyksXHJcbiAgICAgICAgQmFzZUxheWVyID0gcmVxdWlyZSgnLi4vbGF5ZXIvQmFzZUxheWVyJyksXHJcbiAgICAgICAgUHViU3ViID0gcmVxdWlyZSgnLi4vdXRpbC9QdWJTdWInKSxcclxuXHQgICAgQXJlYU9mSW50ZXJlc3RUaWxlUHlyYW1pZCA9IHJlcXVpcmUoJy4uL2Jpbm5pbmcvQXJlYU9mSW50ZXJlc3RUaWxlUHlyYW1pZCcpLFxyXG5cdCAgICBXZWJNZXJjYXRvclRpbGVQeXJhbWlkID0gcmVxdWlyZSgnLi4vYmlubmluZy9XZWJNZXJjYXRvclRpbGVQeXJhbWlkJyksXHJcblx0ICAgIFRpbGVJdGVyYXRvciA9IHJlcXVpcmUoJy4uL2Jpbm5pbmcvVGlsZUl0ZXJhdG9yJyksXHJcblx0ICAgIFRJTEVTSVpFID0gMjU2LFxyXG4gICAgICAgIHNldE1hcENhbGxiYWNrcyxcclxuICAgICAgICBhY3RpdmF0ZUNvbXBvbmVudCxcclxuICAgICAgICBkZWFjdGl2YXRlQ29tcG9uZW50LFxyXG4gICAgICAgIGFjdGl2YXRlRGVmZXJyZWRDb21wb25lbnRzLFxyXG4gICAgICAgIGFkZEJhc2VMYXllcixcclxuICAgICAgICBhZGRMYXllcixcclxuICAgICAgICBhZGRBeGlzLFxyXG4gICAgICAgIHJlbW92ZUJhc2VMYXllcixcclxuICAgICAgICByZW1vdmVMYXllcixcclxuICAgICAgICByZW1vdmVBeGlzO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUHJpdmF0ZTogU2V0IGNhbGxiYWNrcyB0byB1cGRhdGUgdGhlIG1hcHMgdGlsZSBmb2N1cywgaWRlbnRpZnlpbmcgd2hpY2ggdGlsZVxyXG4gICAgICogdGhlIHVzZXIgaXMgY3VycmVudGx5IGhvdmVyaW5nIG92ZXIuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIG1hcCB7TWFwfSBUaGUgbWFwIG9iamVjdC5cclxuICAgICAqL1xyXG4gICAgc2V0TWFwQ2FsbGJhY2tzID0gZnVuY3Rpb24oIG1hcCApIHtcclxuICAgICAgICB2YXIgcHJldmlvdXNNb3VzZSA9IHt9O1xyXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZVRpbGVGb2N1cyggeCwgeSApIHtcclxuICAgICAgICAgICAgdmFyIHRpbGVBbmRCaW4gPSBNYXBVdGlsLmdldFRpbGVBbmRCaW5Gcm9tVmlld3BvcnRQaXhlbCggbWFwLCB4LCB5LCAxLCAxICksXHJcblx0XHRcdCAgICB0aWxla2V5ID0gdGlsZUFuZEJpbi50aWxlLmxldmVsICsgXCIsXCJcclxuICAgICAgICAgICAgICAgICAgICArIHRpbGVBbmRCaW4udGlsZS54SW5kZXggKyBcIixcIlxyXG4gICAgICAgICAgICAgICAgICAgICsgdGlsZUFuZEJpbi50aWxlLnlJbmRleDtcclxuICAgICAgICAgICAgaWYgKCB0aWxla2V5ICE9PSBtYXAudGlsZUZvY3VzICkge1xyXG4gICAgICAgICAgICAgICAgLy8gb25seSB1cGRhdGUgdGlsZWZvY3VzIGlmIGl0IGFjdHVhbGx5IGNoYW5nZXNcclxuICAgICAgICAgICAgICAgIG1hcC5wcmV2aW91c1RpbGVGb2N1cyA9IG1hcC50aWxlRm9jdXM7XHJcbiAgICAgICAgICAgICAgICBtYXAudGlsZUZvY3VzID0gdGlsZWtleTtcclxuICAgICAgICAgICAgICAgIFB1YlN1Yi5wdWJsaXNoKCAnbGF5ZXInLCB7IGZpZWxkOiAndGlsZUZvY3VzJywgdmFsdWU6IHRpbGVrZXkgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gc2V0IHRpbGUgZm9jdXMgY2FsbGJhY2tzXHJcbiAgICAgICAgbWFwLm9uKCdtb3VzZW1vdmUnLCBmdW5jdGlvbiggZXZlbnQgKSB7XHJcbiAgICAgICAgICAgIHVwZGF0ZVRpbGVGb2N1cyggZXZlbnQueHkueCwgZXZlbnQueHkueSApO1xyXG4gICAgICAgICAgICBwcmV2aW91c01vdXNlLnggPSBldmVudC54eS54O1xyXG4gICAgICAgICAgICBwcmV2aW91c01vdXNlLnkgPSBldmVudC54eS55O1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIG1hcC5vbignem9vbWVuZCcsIGZ1bmN0aW9uKCBldmVudCApIHtcclxuICAgICAgICAgICAgdXBkYXRlVGlsZUZvY3VzKCBwcmV2aW91c01vdXNlLngsIHByZXZpb3VzTW91c2UueSApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIGlmIG1vdXNlZG93biB3aGlsZSBtYXAgaXMgcGFubmluZywgaW50ZXJydXB0IHBhblxyXG4gICAgICAgICQoIG1hcC5nZXRFbGVtZW50KCkgKS5tb3VzZWRvd24oIGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIGlmICggbWFwLm9sTWFwLnBhblR3ZWVuICkge1xyXG4gICAgICAgICAgICAgICAgIG1hcC5vbE1hcC5wYW5Ud2Vlbi5jYWxsYmFja3MgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgIG1hcC5vbE1hcC5wYW5Ud2Vlbi5zdG9wKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyBzZXQgcmVzaXplIGNhbGxiYWNrXHJcbiAgICAgICAgJCggd2luZG93ICkucmVzaXplKCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbWFwLm9sTWFwLnVwZGF0ZVNpemUoKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBQcml2YXRlOiBBY3RpdmF0ZXMgYSBjb21wb25lbnQuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIG1hcCAgICAgICB7TWFwfSBUaGUgbWFwIG9iamVjdC5cclxuICAgICAqIEBwYXJhbSBjb21wb25lbnQgeyp9ICAgVGhlIGNvbXBvbmVudCB0byBhY3RpdmF0ZS5cclxuICAgICAqL1xyXG4gICAgYWN0aXZhdGVDb21wb25lbnQgPSBmdW5jdGlvbiggbWFwLCBjb21wb25lbnQgKSB7XHJcbiAgICAgICAgaWYgKCBjb21wb25lbnQgaW5zdGFuY2VvZiBMYXllciApIHtcclxuICAgICAgICAgICAgYWRkTGF5ZXIoIG1hcCwgY29tcG9uZW50ICk7XHJcbiAgICAgICAgfSBlbHNlIGlmICggY29tcG9uZW50IGluc3RhbmNlb2YgQXhpcyApIHtcclxuICAgICAgICAgICAgYWRkQXhpcyggbWFwLCBjb21wb25lbnQgKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUHJpdmF0ZTogRGVhY3RpdmF0ZXMgYSBjb21wb25lbnQuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIG1hcCAgICAgICB7TWFwfSBUaGUgbWFwIG9iamVjdC5cclxuICAgICAqIEBwYXJhbSBjb21wb25lbnQgeyp9ICAgVGhlIGNvbXBvbmVudCB0byBkZWFjdGl2YXRlLlxyXG4gICAgICovXHJcbiAgICBkZWFjdGl2YXRlQ29tcG9uZW50ID0gZnVuY3Rpb24oIG1hcCwgY29tcG9uZW50ICkge1xyXG4gICAgICAgIGlmICggY29tcG9uZW50IGluc3RhbmNlb2YgQmFzZUxheWVyICkge1xyXG4gICAgICAgICAgICByZW1vdmVCYXNlTGF5ZXIoIG1hcCwgY29tcG9uZW50ICk7XHJcbiAgICAgICAgfSBlbHNlIGlmICggY29tcG9uZW50IGluc3RhbmNlb2YgTGF5ZXIgKSB7XHJcbiAgICAgICAgICAgIHJlbW92ZUxheWVyKCBtYXAsIGNvbXBvbmVudCApO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoIGNvbXBvbmVudCBpbnN0YW5jZW9mIEF4aXMgKSB7XHJcbiAgICAgICAgICAgIHJlbW92ZUF4aXMoIG1hcCwgY29tcG9uZW50ICk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFByaXZhdGU6IEFjdGl2YXRlcyBkZWZlcnJlZCBjb21wb25lbnRzIHdoZW4gdGhlIG1hcCBpcyByZWFkeS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gbWFwIHtNYXB9IFRoZSBtYXAgb2JqZWN0LlxyXG4gICAgICovXHJcbiAgICBhY3RpdmF0ZURlZmVycmVkQ29tcG9uZW50cyA9IGZ1bmN0aW9uKCBtYXAgKSB7XHJcbiAgICAgICAgdmFyIGk7XHJcbiAgICAgICAgZm9yICggaT0wOyBpPG1hcC5kZWZlcnJlZHMubGVuZ3RoOyBpKysgKSB7XHJcbiAgICAgICAgICAgIGFjdGl2YXRlQ29tcG9uZW50KCBtYXAsIG1hcC5kZWZlcnJlZHNbaV0gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZGVsZXRlIG1hcC5kZWZlcnJlZHM7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUHJpdmF0ZTogQWRkcyBhIGJhc2UgbGF5ZXIgdG8gdGhlIG1hcC4gSWYgbm8gYmFzZWxheWVyIGlzIGF0dGFjaGVkLCBpdFxyXG4gICAgICogd2lsbCBhbHNvIGFjdGl2YXRlIGl0LCBhbG9uZyB3aXRoIGFueSBkZWZlcnJlZCBjb21wb25lbnRzIHRoYXQgd2VyZSBhdHRhY2hlZFxyXG4gICAgICogZmlyc3QuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIG1hcCAgICAgICB7TWFwfSAgICAgICBUaGUgbWFwIG9iamVjdC5cclxuICAgICAqIEBwYXJhbSBiYXNlbGF5ZXIge0Jhc2VMYXllcn0gVGhlIGJhc2VsYXllciBvYmplY3QuXHJcbiAgICAgKi9cclxuICAgIGFkZEJhc2VMYXllciA9IGZ1bmN0aW9uKCBtYXAsIGJhc2VsYXllciApIHtcclxuICAgICAgICAvLyBhZGQgbWFwIHRvIGJhc2VsYXllclxyXG4gICAgICAgIGJhc2VsYXllci5tYXAgPSBtYXA7XHJcbiAgICAgICAgLy8gYWRkIHRvIGJhc2VsYXllciBhcnJheVxyXG4gICAgICAgIG1hcC5iYXNlbGF5ZXJzID0gbWFwLmJhc2VsYXllcnMgfHwgW107XHJcbiAgICAgICAgbWFwLmJhc2VsYXllcnMucHVzaCggYmFzZWxheWVyICk7XHJcbiAgICAgICAgLy8gaWYgZmlyc3QgYmFzZWxheWVyLCBhY3RpdmF0ZSB0aGUgbWFwXHJcbiAgICAgICAgaWYgKCBtYXAuYmFzZUxheWVySW5kZXggPCAwICkge1xyXG4gICAgICAgICAgICAvLyBvcGVubGF5ZXJzIG1hcHMgcmVxdWlyZSBhIGJhc2VsYXllciB0byBvcGVyYXRlLCBvbmNlXHJcbiAgICAgICAgICAgIC8vIHRoaXMgYmFzZWxheWVyIGlzIHNldCwgYWN0aXZhdGUgdGhlIG1hcFxyXG4gICAgICAgICAgICBtYXAuc2V0QmFzZUxheWVySW5kZXgoIDAgKTtcclxuICAgICAgICAgICAgLy8gc2V0IGluaXRpYWwgdmlld3BvaW50LCByZXF1aXJlZCBieSBvcGVubGF5ZXJzXHJcbiAgICAgICAgICAgIG1hcC5vbE1hcC56b29tVG9NYXhFeHRlbnQoKTtcclxuICAgICAgICAgICAgLy8gc2V0IG1vdXNlIGNhbGxiYWNrc1xyXG4gICAgICAgICAgICBzZXRNYXBDYWxsYmFja3MoIG1hcCApO1xyXG4gICAgICAgICAgICBpZiAoIG1hcC5kZWZlcnJlZHMgKSB7XHJcbiAgICAgICAgICAgICAgICBhY3RpdmF0ZURlZmVycmVkQ29tcG9uZW50cyggbWFwICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUHJpdmF0ZTogQWRkcyBhIGxheWVyIG9iamVjdCB0byB0aGUgbWFwIGFuZCBhY3RpdmF0ZXMgaXQuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIG1hcCAgICAgICB7TWFwfSAgIFRoZSBtYXAgb2JqZWN0LlxyXG4gICAgICogQHBhcmFtIGxheWVyIHtMYXllcn0gVGhlIGxheWVyIG9iamVjdC5cclxuICAgICAqL1xyXG4gICAgYWRkTGF5ZXIgPSBmdW5jdGlvbiggbWFwLCBsYXllciApIHtcclxuICAgICAgICAvLyBhZGQgbWFwIHRvIGxheWVyXHJcbiAgICAgICAgbGF5ZXIubWFwID0gbWFwO1xyXG4gICAgICAgIC8vIGFjdGl2YXRlIHRoZSBsYXllclxyXG4gICAgICAgIGxheWVyLmFjdGl2YXRlKCk7XHJcbiAgICAgICAgLy8gYWRkIGl0IHRvIGxheWVyIG1hcFxyXG4gICAgICAgIG1hcC5sYXllcnMgPSBtYXAubGF5ZXJzIHx8IHt9O1xyXG4gICAgICAgIG1hcC5sYXllcnNbIGxheWVyLmdldFVVSUQoKSBdID0gbGF5ZXI7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUHJpdmF0ZTogQWRkcyBhbiBBeGlzIG9iamVjdCB0byB0aGUgbWFwIGFuZCBhY3RpdmF0ZXMgaXQuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIG1hcCAge01hcH0gICBUaGUgbWFwIG9iamVjdC5cclxuICAgICAqIEBwYXJhbSBheGlzIHtBeGlzfSBUaGUgbGF5ZXIgb2JqZWN0LlxyXG4gICAgICovXHJcbiAgICBhZGRBeGlzID0gZnVuY3Rpb24oIG1hcCwgYXhpcyApIHtcclxuICAgICAgICAvLyBzZXQgbWluL21heCBiYXNlZCBvbiBweXJhbWlkXHJcbiAgICAgICAgaWYgKCBheGlzLnBvc2l0aW9uID09PSAndG9wJyB8fCBheGlzLnBvc2l0aW9uID09PSAnYm90dG9tJyApIHtcclxuICAgICAgICAgICAgYXhpcy5taW4gPSBtYXAucHlyYW1pZC5taW5YO1xyXG4gICAgICAgICAgICBheGlzLm1heCA9IG1hcC5weXJhbWlkLm1heFg7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgYXhpcy5taW4gPSBtYXAucHlyYW1pZC5taW5ZO1xyXG4gICAgICAgICAgICBheGlzLm1heCA9IG1hcC5weXJhbWlkLm1heFk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBhY3RpdmF0ZSBhbmQgYXR0YWNoIHRvIG1hcFxyXG4gICAgICAgIGF4aXMubWFwID0gbWFwO1xyXG4gICAgICAgIGF4aXMuYWN0aXZhdGUoKTtcclxuICAgICAgICBtYXAuYXhlcyA9IG1hcC5heGVzIHx8IHt9O1xyXG4gICAgICAgIG1hcC5heGVzWyBheGlzLnBvc2l0aW9uIF0gPSBheGlzO1xyXG5cclxuICAgICAgICAvLyB1cGRhdGUgZGltZW5zaW9uc1xyXG4gICAgICAgIF8uZm9ySW4oIG1hcC5heGVzLCBmdW5jdGlvbiggdmFsdWUgKSB7XHJcbiAgICAgICAgICAgIHZhbHVlLnNldENvbnRlbnREaW1lbnNpb24oKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gcmVkcmF3XHJcbiAgICAgICAgXy5mb3JJbiggbWFwLmF4ZXMsIGZ1bmN0aW9uKCB2YWx1ZSApIHtcclxuICAgICAgICAgICAgdmFsdWUucmVkcmF3KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUHJpdmF0ZTogUmVtb3ZlcyBhIGJhc2UgbGF5ZXIgZnJvbSB0aGUgbWFwLiBJZiBubyBvdGhlciBiYXNlbGF5ZXIgaXMgYXR0YWNoZWQsIGl0XHJcbiAgICAgKiB3aWxsIHJlZnVzZSB0byBkbyBzby5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gbWFwICAgICAgIHtNYXB9ICAgICAgIFRoZSBtYXAgb2JqZWN0LlxyXG4gICAgICogQHBhcmFtIGJhc2VsYXllciB7QmFzZUxheWVyfSBUaGUgYmFzZWxheWVyIG9iamVjdC5cclxuICAgICAqL1xyXG4gICAgcmVtb3ZlQmFzZUxheWVyID0gZnVuY3Rpb24oIG1hcCwgYmFzZWxheWVyICkge1xyXG4gICAgICAgIHZhciBpbmRleDtcclxuICAgICAgICAvLyBpZiBvbmx5IDEgYmFzZWxheWVyIGF2YWlsYWJsZSwgaWdub3JlXHJcbiAgICAgICAgaWYgKCBtYXAuYmFzZWxheWVycy5sZW5ndGggPT09IDEgKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoICdFcnJvcjogYXR0ZW1wdGluZyB0byByZW1vdmUgb25seSBiYXNlbGF5ZXIgZnJvbSBtYXAsIHRoaXMgZGVzdHJveXMgdGhlIG1hcCwgdXNlIGRlc3Ryb3koKSBpbnN0ZWFkJyApO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGdldCBpbmRleCBvZiBiYXNlbGF5ZXJcclxuICAgICAgICBpbmRleCA9IG1hcC5iYXNlbGF5ZXJzLmluZGV4T2YoIGJhc2VsYXllciApO1xyXG4gICAgICAgIC8vIHJlbW92ZSBiYXNlbGF5ZXIgZnJvbSBhcnJheVxyXG4gICAgICAgIG1hcC5iYXNlbGF5ZXJzLnNwbGljZSggaW5kZXgsIDEgKTtcclxuICAgICAgICAvLyBnZXQgcmVwbGFjZW1lbnQgaW5kZXhcclxuICAgICAgICBpbmRleCA9ICggbWFwLmJhc2VsYXllcnNbIGluZGV4IF0gKSA/IGluZGV4IDogaW5kZXgtMTtcclxuICAgICAgICAvLyByZXBsYWNlIGJhc2VsYXllclxyXG4gICAgICAgIG1hcC5zZXRCYXNlTGF5ZXJJbmRleCggaW5kZXggKTtcclxuICAgICAgICBiYXNlbGF5ZXIubWFwID0gbnVsbDtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBQcml2YXRlOiBSZW1vdmVzIGEgbGF5ZXIgb2JqZWN0IGZyb20gdGhlIG1hcCBhbmQgZGVhY3RpdmF0ZXMgaXQuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIG1hcCAgICAgICB7TWFwfSAgIFRoZSBtYXAgb2JqZWN0LlxyXG4gICAgICogQHBhcmFtIGxheWVyIHtMYXllcn0gVGhlIGxheWVyIG9iamVjdC5cclxuICAgICAqL1xyXG4gICAgcmVtb3ZlTGF5ZXIgPSBmdW5jdGlvbiggbWFwLCBsYXllciApIHtcclxuICAgICAgICAvLyByZW1vdmUgaXQgZnJvbSBsYXllciBtYXBcclxuICAgICAgICBkZWxldGUgbWFwLmxheWVyc1sgbGF5ZXIuZ2V0VVVJRCgpIF07XHJcbiAgICAgICAgLy8gZGVhY3RpdmF0ZSBpdFxyXG4gICAgICAgIGxheWVyLmRlYWN0aXZhdGUoKTtcclxuICAgICAgICBsYXllci5tYXAgPSBudWxsO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFByaXZhdGU6IFJlbW92ZXMgYW4gQXhpcyBvYmplY3QgZnJvbSB0aGUgbWFwIGFuZCBkZWFjdGl2YXRlcyBpdC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gbWFwICB7TWFwfSAgIFRoZSBtYXAgb2JqZWN0LlxyXG4gICAgICogQHBhcmFtIGF4aXMge0F4aXN9IFRoZSBsYXllciBvYmplY3QuXHJcbiAgICAgKi9cclxuICAgIHJlbW92ZUF4aXMgPSBmdW5jdGlvbiggbWFwLCBheGlzICkge1xyXG4gICAgICAgIC8vIHJlbW92ZSBpdCBmcm9tIGF4ZXMgbWFwXHJcbiAgICAgICAgZGVsZXRlIG1hcC5heGVzWyBheGlzLnBvc2l0aW9uIF07XHJcbiAgICAgICAgLy8gZGVhY3RpdmF0ZSBpdFxyXG4gICAgICAgIGF4aXMuZGVhY3RpdmF0ZSgpO1xyXG4gICAgICAgIGF4aXMubWFwID0gbnVsbDtcclxuICAgIH07XHJcblxyXG5cdGZ1bmN0aW9uIE1hcCggaWQsIHNwZWMgKSB7XHJcblxyXG4gICAgICAgIHNwZWMgPSBzcGVjIHx8IHt9O1xyXG4gICAgICAgIHNwZWMub3B0aW9ucyA9IHNwZWMub3B0aW9ucyB8fCB7fTtcclxuICAgICAgICBzcGVjLnB5cmFtaWQgPSBzcGVjLnB5cmFtaWQgfHwge307XHJcblxyXG4gICAgICAgIC8vIGVsZW1lbnQgaWRcclxuICAgICAgICB0aGlzLmlkID0gaWQ7XHJcbiAgICAgICAgLy8gc2V0IG1hcCB0aWxlIHB5cmFtaWRcclxuICAgICAgICBpZiAoIHNwZWMucHlyYW1pZC50eXBlID09PSBcIkFyZWFPZkludGVyZXN0XCIgKSB7XHJcbiAgICAgICAgICAgIHRoaXMucHlyYW1pZCA9IG5ldyBBcmVhT2ZJbnRlcmVzdFRpbGVQeXJhbWlkKCBzcGVjLnB5cmFtaWQgKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnB5cmFtaWQgPSBuZXcgV2ViTWVyY2F0b3JUaWxlUHlyYW1pZCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBpbml0aWFsaXplIGJhc2UgbGF5ZXIgaW5kZXggdG8gLTEgZm9yIG5vIGJhc2VsYXllclxyXG4gICAgICAgIHRoaXMuYmFzZUxheWVySW5kZXggPSAtMTtcclxuXHJcbiAgICAgICAgLy8gY3JlYXRlIG1hcCBvYmplY3RcclxuICAgICAgICB0aGlzLm9sTWFwID0gbmV3IE9wZW5MYXllcnMuTWFwKCB0aGlzLmlkLCB7XHJcbiAgICAgICAgICAgIHByb2plY3Rpb246IG5ldyBPcGVuTGF5ZXJzLlByb2plY3Rpb24oIHNwZWMub3B0aW9ucy5wcm9qZWN0aW9uIHx8IFwiRVBTRzo5MDA5MTNcIiApLFxyXG4gICAgICAgICAgICBkaXNwbGF5UHJvamVjdGlvbjogbmV3IE9wZW5MYXllcnMuUHJvamVjdGlvbiggc3BlYy5vcHRpb25zLmRpc3BsYXlQcm9qZWN0aW9uIHx8IFwiRVBTRzo0MzI2XCIgKSxcclxuICAgICAgICAgICAgbWF4RXh0ZW50OiBPcGVuTGF5ZXJzLkJvdW5kcy5mcm9tQXJyYXkoIHNwZWMub3B0aW9ucy5tYXhFeHRlbnQgfHwgW1xyXG4gICAgICAgICAgICAgICAgLTIwMDM3NTA4LjM0Mjc4OTI0NCxcclxuXHRcdFx0XHQtMjAwMzc1MDguMzQyNzg5MjQ0LFxyXG5cdFx0XHRcdDIwMDM3NTA4LjM0Mjc4OTI0NCxcclxuXHRcdFx0XHQyMDAzNzUwOC4zNDI3ODkyNDRcclxuICAgICAgICAgICAgXSksXHJcbiAgICAgICAgICAgIHVuaXRzOiBzcGVjLm9wdGlvbnMudW5pdHMgfHwgXCJtXCIsXHJcbiAgICAgICAgICAgIG51bVpvb21MZXZlbHM6IHNwZWMub3B0aW9ucy5udW1ab29tTGV2ZWxzIHx8IDE4LFxyXG4gICAgICAgICAgICBjb250cm9sczogW1xyXG4gICAgICAgICAgICAgICAgbmV3IE9wZW5MYXllcnMuQ29udHJvbC5OYXZpZ2F0aW9uKHsgZG9jdW1lbnREcmFnOiB0cnVlIH0pLFxyXG4gICAgICAgICAgICAgICAgbmV3IE9wZW5MYXllcnMuQ29udHJvbC5ab29tKClcclxuICAgICAgICAgICAgXVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIE1hcC5wcm90b3R5cGUgPSB7XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEFkZHMgYSBjb21wb25lbnQgdG8gdGhlIG1hcC5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSBjb21wb25lbnQgeyp9IFRoZSBjb21wb25lbnQgb2JqZWN0LlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGFkZDogZnVuY3Rpb24oIGNvbXBvbmVudCApIHtcclxuICAgICAgICAgICAgaWYgKCBjb21wb25lbnQgaW5zdGFuY2VvZiBCYXNlTGF5ZXIgKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBpZiBhIGJhc2VsYXllciwgYWRkIGl0XHJcbiAgICAgICAgICAgICAgICBhZGRCYXNlTGF5ZXIoIHRoaXMsIGNvbXBvbmVudCApO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICggdGhpcy5iYXNlTGF5ZXJJbmRleCA8IDAgKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBpZiBubyBiYXNlbGF5ZXIgaXMgYXR0YWNoZWQgeWV0LCB3ZSBjYW5ub3QgYWN0aXZhdGUgdGhlIGNvbXBvbmVudFxyXG4gICAgICAgICAgICAgICAgLy8gYWRkIGl0IHRvIGxpc3Qgb2YgZGVmZXJyZWQgYWN0aXZhdGlvbnNcclxuICAgICAgICAgICAgICAgIHRoaXMuZGVmZXJyZWRzID0gdGhpcy5kZWZlcnJlZHMgfHwgW107XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRlZmVycmVkcy5wdXNoKCBjb21wb25lbnQgKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBhY3RpdmF0ZSB0aGUgY29tcG9uZW50XHJcbiAgICAgICAgICAgIGFjdGl2YXRlQ29tcG9uZW50KCB0aGlzLCBjb21wb25lbnQgKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBSZW1vdmVzIGEgY29tcG9uZW50IGZyb20gdGhlIG1hcC5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSBjb21wb25lbnQgeyp9IFRoZSBjb21wb25lbnQgb2JqZWN0LlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHJlbW92ZTogZnVuY3Rpb24oIGNvbXBvbmVudCApIHtcclxuICAgICAgICAgICAgaWYgKCB0aGlzLmJhc2VMYXllckluZGV4IDwgMCApIHtcclxuICAgICAgICAgICAgICAgIC8vIGlmIG5vIGJhc2VsYXllciBpcyBhdHRhY2hlZCB5ZXQsIHdlIGNhbm5vdCBkZWFjdGl2YXRlIHRoZSBjb21wb25lbnRcclxuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBpdCBmcm9tIHRoZSBsaXN0IG9mIGRlZmVycmVkIGFjdGl2YXRpb25zXHJcbiAgICAgICAgICAgICAgICB0aGlzLmRlZmVycmVkcyA9IHRoaXMuZGVmZXJyZWRzIHx8IFtdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kZWZlcnJlZHMuc3BsaWNlKCB0aGlzLmRlZmVycmVkcy5pbmRleE9mKCBjb21wb25lbnQgKSwgMSApO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIGFjdGl2YXRlIHRoZSBjb21wb25lbnRcclxuICAgICAgICAgICAgZGVhY3RpdmF0ZUNvbXBvbmVudCggdGhpcywgY29tcG9uZW50ICk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogUmV0dXJucyB0aGUgdGlsZWtleSBmb3IgdGhlIHRpbGUgY3VycmVudGx5IHVuZGVyIHRoZSBtb3VzZS5cclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRUaWxlRm9jdXM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy50aWxlRm9jdXM7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogSWYgbXVsdGlwbGUgYmFzZWxheWVycyBhcmUgYXR0YWNoZWQgdG8gdGhlIG1hcCwgdGhpcyBmdW5jdGlvbiBpc1xyXG4gICAgICAgICAqIHVzZWQgdG8gY2hhbmdlIHRoZSBpbmRleC5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSBpbmRleCB7aW50fSBUaGUgaW5kZXggb2YgdGhlIGJhc2VsYXllciB0byBzd2l0Y2ggdG8uXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0QmFzZUxheWVySW5kZXg6IGZ1bmN0aW9uKCBpbmRleCApIHtcclxuICAgICAgICAgICAgdmFyIG9sZEJhc2VMYXllciA9IHRoaXMuYmFzZWxheWVyc1sgdGhpcy5iYXNlTGF5ZXJJbmRleCBdLFxyXG4gICAgICAgICAgICAgICAgbmV3QmFzZUxheWVyID0gdGhpcy5iYXNlbGF5ZXJzWyBpbmRleCBdO1xyXG4gICAgICAgICAgICBpZiAoICFuZXdCYXNlTGF5ZXIgKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IsIG5vIGJhc2VsYXllciBmb3Igc3VwcGxpZWQgaW5kZXg6IFwiICsgaW5kZXggKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIG9sZEJhc2VMYXllciApIHtcclxuICAgICAgICAgICAgICAgIG9sZEJhc2VMYXllci5kZWFjdGl2YXRlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbmV3QmFzZUxheWVyLmFjdGl2YXRlKCk7XHJcbiAgICAgICAgICAgIHRoaXMuYmFzZUxheWVySW5kZXggPSBpbmRleDtcclxuICAgICAgICAgICAgUHViU3ViLnB1Ymxpc2goIG5ld0Jhc2VMYXllci5nZXRDaGFubmVsKCksIHsgZmllbGQ6ICdiYXNlTGF5ZXJJbmRleCcsIHZhbHVlOiBpbmRleCB9KTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBSZXR1cm5zIHRoZSBjdXJyZW50bHkgYWN0aXZlIGJhc2VsYXllciBpbmRleC5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZXR1cm5zIHtudW1iZXJ8Kn1cclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRCYXNlTGF5ZXJJbmRleDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJhc2VMYXllckluZGV4O1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFJldHVybnMgdGhlIGN1cnJlbnQgdGhlbWUgb2YgdGhlIG1hcC4gQ3VycmVudGx5IHJlc3RyaWN0ZWQgdG8gXCJkYXJrXCJcclxuICAgICAgICAgKiBhbmQgXCJsaWdodFwiLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJldHVybnMge3N0cmluZ30gVGhlIHRoZW1lIG9mIHRoZSBtYXAuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0VGhlbWU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIFx0cmV0dXJuICQoIHRoaXMub2xNYXAuZGl2ICkuaGFzQ2xhc3MoIFwibGlnaHQtdGhlbWVcIiApID8gJ2xpZ2h0JyA6ICdkYXJrJztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBSZXR1cm5zIHRoZSBtYXAgRE9NIGVsZW1lbnQuIFRoaXMgaXMgdGhlIGVsZW1lbnQgdG8gd2hpY2hcclxuICAgICAgICAgKiB0aGUgbWFwIG9iamVjdCBpcyAnYXR0YWNoZWQnLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJldHVybnMge0hUTUxFbGVtZW50fSBUaGUgbWFwIGRpdiBlbGVtZW50LlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldEVsZW1lbnQ6ICBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMub2xNYXAuZGl2O1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFJldHVybnMgdGhlIG1hcCB2aWV3cG9ydCBET00gZWxlbWVudC4gVGhpcyB0aGUgZWxlbWVudCB0aGF0IG1hdGNoZXNcclxuICAgICAgICAgKiB0aGUgdmlld2FibGUgcG9ydGlvbiBvZiB0aGUgbWFwLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJldHVybnMge0hUTUxFbGVtZW50fSBUaGUgbWFwIHZpZXdwb3J0IGRpdiBlbGVtZW50LlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldFZpZXdwb3J0RWxlbWVudDogIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5vbE1hcC52aWV3UG9ydERpdjtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBSZXR1cm5zIHRoZSBtYXAgY29udGFpbmVyIERPTSBlbGVtZW50LiBUaGlzIGlzIHRoZSBlbGVtZW50IHRvIHdoaWNoIGFsbFxyXG4gICAgICAgICAqICdwYW5uYWJsZScgbGF5ZXJzIGFyZSBhdHRhY2hlZCB0by5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZXR1cm5zIHtIVE1MRWxlbWVudH0gVGhlIG1hcCBjb250YWluZXIgZGl2IGVsZW1lbnQuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0Q29udGFpbmVyRWxlbWVudDogIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5vbE1hcC5sYXllckNvbnRhaW5lckRpdjtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBSZXR1cm5zIHRoZSB0aWxlIHB5cmFtaWQgdXNlZCBmb3IgdGhlIG1hcC5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZXR1cm5zIHsgQXJlYU9mSW50ZXJlc3RUaWxlUHlyYW1pZCB8IFdlYk1lcmNhdG9yVGlsZVB5cmFtaWQgfSBUaWxlUHlyYW1pZCBPYmplY3QuXHJcbiAgICAgICAgICovXHJcblx0XHRnZXRQeXJhbWlkOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMucHlyYW1pZDtcclxuXHRcdH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFJldHVybnMgYSBUaWxlSXRlcmF0b3Igb2JqZWN0LiBUaGlzIFRpbGVJdGVyYXRvciBjb250YWlucyBhbGwgdmlld2FibGVcclxuICAgICAgICAgKiB0aWxlcyBjdXJyZW50bHkgaW4gdGhlIG1hcC5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZXR1cm5zIHtUaWxlSXRlcmF0b3J9IFRpbGVJdGVyYXRvciBvYmplY3QuXHJcbiAgICAgICAgICovXHJcblx0XHRnZXRUaWxlSXRlcmF0b3I6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR2YXIgbGV2ZWwgPSB0aGlzLm9sTWFwLmdldFpvb20oKSxcclxuXHRcdFx0ICAgIC8vIEN1cnJlbnQgbWFwIGJvdW5kcywgaW4gbWV0ZXJzXHJcblx0XHRcdCAgICBib3VuZHMgPSB0aGlzLm9sTWFwLmdldEV4dGVudCgpLFxyXG5cdFx0XHQgICAgLy8gVG90YWwgbWFwIGJvdW5kcywgaW4gbWV0ZXJzXHJcblx0XHRcdCAgICBleHRlbnRzID0gdGhpcy5vbE1hcC5nZXRNYXhFeHRlbnQoKSxcclxuXHRcdFx0ICAgIC8vIFB5cmFtaWQgZm9yIHRoZSB0b3RhbCBtYXAgYm91bmRzXHJcblx0XHRcdCAgICBweXJhbWlkID0gbmV3IEFyZWFPZkludGVyZXN0VGlsZVB5cmFtaWQoe1xyXG4gICAgICAgICAgICAgICAgICAgIG1pblg6IGV4dGVudHMubGVmdCxcclxuICAgICAgICAgICAgICAgICAgICBtaW5ZOiBleHRlbnRzLmJvdHRvbSxcclxuICAgICAgICAgICAgICAgICAgICBtYXhYOiBleHRlbnRzLnJpZ2h0LFxyXG4gICAgICAgICAgICAgICAgICAgIG1heFk6IGV4dGVudHMudG9wXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHRcdFx0Ly8gZGV0ZXJtaW5lIGFsbCB0aWxlcyBpbiB2aWV3XHJcblx0XHRcdHJldHVybiBuZXcgVGlsZUl0ZXJhdG9yKHtcclxuICAgICAgICAgICAgICAgIHB5cmFtaWQ6IHB5cmFtaWQsXHJcbiAgICAgICAgICAgICAgICBsZXZlbDogbGV2ZWwsXHJcbiAgICAgICAgICAgICAgICBtaW5YOiBib3VuZHMubGVmdCxcclxuICAgICAgICAgICAgICAgIG1pblk6IGJvdW5kcy5ib3R0b20sXHJcbiAgICAgICAgICAgICAgICBtYXhYOiBib3VuZHMucmlnaHQsXHJcbiAgICAgICAgICAgICAgICBtYXhZOiBib3VuZHMudG9wXHJcbiAgICAgICAgICAgIH0pO1xyXG5cdFx0fSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogUmV0dXJucyBhbiBhcnJheSBvZiBhbGwgdGlsZWtleXMgY3VycmVudGx5IGluIHZpZXcuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmV0dXJucyB7QXJyYXl9IEFuIGFycmF5IG9mIHRpbGVrZXkgc3RyaW5ncy5cclxuICAgICAgICAgKi9cclxuXHRcdGdldFRpbGVzSW5WaWV3OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHRpbGVzID0gdGhpcy5nZXRUaWxlSXRlcmF0b3IoKS5nZXRSZXN0KCksXHJcbiAgICAgICAgICAgICAgICBjdWxsZWRUaWxlcyA9IFtdLFxyXG4gICAgICAgICAgICAgICAgbWF4VGlsZUluZGV4ID0gTWF0aC5wb3coMiwgdGhpcy5nZXRab29tKCkgKSxcclxuICAgICAgICAgICAgICAgIHRpbGUsXHJcbiAgICAgICAgICAgICAgICBpO1xyXG4gICAgICAgICAgICBmb3IgKGk9MDsgaTx0aWxlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgdGlsZSA9IHRpbGVzW2ldO1xyXG4gICAgICAgICAgICAgICAgaWYgKCB0aWxlLnhJbmRleCA+PSAwICYmIHRpbGUueUluZGV4ID49IDAgJiZcclxuICAgICAgICAgICAgICAgICAgICAgdGlsZS54SW5kZXggPCBtYXhUaWxlSW5kZXggJiYgdGlsZS55SW5kZXggPCBtYXhUaWxlSW5kZXggKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgIGN1bGxlZFRpbGVzLnB1c2goIHRpbGUubGV2ZWwgKyBcIixcIiArIHRpbGUueEluZGV4ICsgXCIsXCIgKyB0aWxlLnlJbmRleCApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBjdWxsZWRUaWxlcztcclxuXHRcdH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFpvb21zIHRoZSBtYXAgdG8gYSBwYXJ0aWN1bGFyIGNvb3JkaW5hdGUsIGFuZCB6b29tIGxldmVsLiBUaGlzXHJcbiAgICAgICAgICogdHJhbnNpdGlvbiBpcyBpbnN0YW50YW5lb3VzLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIHggICAge2Zsb2F0fSB4IGNvb3JkaW5hdGUgKGxvbmdpdHVkZSBmb3IgZ2Vvc3BhdGlhbClcclxuICAgICAgICAgKiBAcGFyYW0geSAgICB7ZmxvYXR9IHkgY29vcmRpbmF0ZSAobGF0aXR1ZGUgZm9yIGdlb3NwYXRpYWwpXHJcbiAgICAgICAgICogQHBhcmFtIHpvb20ge2ludH0gICB6b29tIGxldmVsXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgem9vbVRvOiBmdW5jdGlvbiggeCwgeSwgem9vbSApIHtcclxuICAgICAgICAgICAgdmFyIHByb2plY3Rpb24sXHJcbiAgICAgICAgICAgICAgICB2aWV3cG9ydFB4LFxyXG4gICAgICAgICAgICAgICAgbG9ubGF0O1xyXG4gICAgICAgICAgICBpZiAoIHRoaXMucHlyYW1pZCBpbnN0YW5jZW9mIFdlYk1lcmNhdG9yVGlsZVB5cmFtaWQgKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBnZW8tc3BhdGlhbCBtYXBcclxuICAgICAgICAgICAgICAgIHByb2plY3Rpb24gPSBuZXcgT3BlbkxheWVycy5Qcm9qZWN0aW9uKCdFUFNHOjQzMjYnKTtcclxuICAgICAgICAgICAgICAgIGxvbmxhdCA9IG5ldyBPcGVuTGF5ZXJzLkxvbkxhdCggeCwgeSApO1xyXG4gICAgICAgICAgICAgICAgaWYoIHRoaXMub2xNYXAuZ2V0UHJvamVjdGlvbigpICE9PSBwcm9qZWN0aW9uLnByb2pDb2RlICkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxvbmxhdC50cmFuc2Zvcm0oIHByb2plY3Rpb24sIHRoaXMub2xNYXAucHJvamVjdGlvbiApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5vbE1hcC5zZXRDZW50ZXIoIGxvbmxhdCwgem9vbSApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gbGluZWFyIGJpLXZhcmlhdGUgbWFwXHJcbiAgICAgICAgICAgICAgICB2aWV3cG9ydFB4ID0gdGhpcy5nZXRWaWV3cG9ydFBpeGVsRnJvbUNvb3JkKCB4LCB5ICk7XHJcbiAgICAgICAgICAgICAgICBsb25sYXQgPSB0aGlzLm9sTWFwLmdldExvbkxhdEZyb21WaWV3UG9ydFB4KCB2aWV3cG9ydFB4ICk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9sTWFwLnNldENlbnRlciggbG9ubGF0LCB6b29tICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBQYW5zIHRoZSBtYXAgdG8gYSBwYXJ0aWN1bGFyIGNvb3JkbmlhdGUuIFRoaXNcclxuICAgICAgICAgKiB0cmFuc2l0aW9uIGlzIGdyYWR1YWwuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0geCAgICB7ZmxvYXR9IHggY29vcmRpbmF0ZSAobG9uZ2l0dWRlIGZvciBnZW9zcGF0aWFsKVxyXG4gICAgICAgICAqIEBwYXJhbSB5ICAgIHtmbG9hdH0geSBjb29yZGluYXRlIChsYXRpdHVkZSBmb3IgZ2Vvc3BhdGlhbClcclxuICAgICAgICAgKi9cclxuICAgICAgICBwYW5UbzogZnVuY3Rpb24oIHgsIHkgKSB7XHJcbiAgICAgICAgICAgIHZhciBwcm9qZWN0aW9uLFxyXG4gICAgICAgICAgICAgICAgdmlld3BvcnRQeCxcclxuICAgICAgICAgICAgICAgIGxvbmxhdDtcclxuICAgICAgICAgICAgaWYgKCB0aGlzLnB5cmFtaWQgaW5zdGFuY2VvZiBXZWJNZXJjYXRvclRpbGVQeXJhbWlkICkge1xyXG4gICAgICAgICAgICAgICAgLy8gZ2VvLXNwYXRpYWwgbWFwXHJcbiAgICAgICAgICAgICAgICBwcm9qZWN0aW9uID0gbmV3IE9wZW5MYXllcnMuUHJvamVjdGlvbignRVBTRzo0MzI2Jyk7XHJcbiAgICAgICAgICAgICAgICBsb25sYXQgPSBuZXcgT3BlbkxheWVycy5Mb25MYXQoIHgsIHkgKTtcclxuICAgICAgICAgICAgICAgIGlmKCB0aGlzLm9sTWFwLmdldFByb2plY3Rpb24oKSAhPT0gcHJvamVjdGlvbi5wcm9qQ29kZSApIHtcclxuICAgICAgICAgICAgICAgICAgICBsb25sYXQudHJhbnNmb3JtKCBwcm9qZWN0aW9uLCB0aGlzLm9sTWFwLnByb2plY3Rpb24gKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMub2xNYXAucGFuVG8oIGxvbmxhdCApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gbGluZWFyIGJpLXZhcmlhdGUgbWFwXHJcbiAgICAgICAgICAgICAgICB2aWV3cG9ydFB4ID0gdGhpcy5nZXRWaWV3cG9ydFBpeGVsRnJvbUNvb3JkKCB4LCB5ICk7XHJcbiAgICAgICAgICAgICAgICBsb25sYXQgPSB0aGlzLm9sTWFwLmdldExvbkxhdEZyb21WaWV3UG9ydFB4KCB2aWV3cG9ydFB4ICk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9sTWFwLnBhblRvKCBsb25sYXQgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFJldHVybnMgdGhlIHdpZHRoIG9mIHRoZSBlbnRpcmUgbWFwIGluIHBpeGVscy5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZXR1cm5zIHtudW1iZXJ9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0V2lkdGg6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gVElMRVNJWkUgKiBNYXRoLnBvdyggMiwgdGhpcy5nZXRab29tKCkgKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBSZXR1cm5zIHRoZSBoZWlnaHQgb2YgdGhlIGVudGlyZSBtYXAgaW4gcGl4ZWxzLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJldHVybnMge251bWJlcn1cclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRIZWlnaHQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gVElMRVNJWkUgKiBNYXRoLnBvdyggMiwgdGhpcy5nZXRab29tKCkgKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBSZXR1cm5zIHRoZSB3aWR0aCBvZiB0aGUgdmlld3BvcnQgaW4gcGl4ZWxzLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJldHVybnMge251bWJlcn1cclxuICAgICAgICAgKi9cclxuXHRcdGdldFZpZXdwb3J0V2lkdGg6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRyZXR1cm4gdGhpcy5vbE1hcC52aWV3UG9ydERpdi5jbGllbnRXaWR0aDtcclxuXHRcdH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFJldHVybnMgdGhlIGhlaWdodCBvZiB0aGUgdmlld3BvcnQgaW4gcGl4ZWxzLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJldHVybnMge251bWJlcn1cclxuICAgICAgICAgKi9cclxuXHRcdGdldFZpZXdwb3J0SGVpZ2h0OiBmdW5jdGlvbigpIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMub2xNYXAudmlld1BvcnREaXYuY2xpZW50SGVpZ2h0O1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFJldHVybnMgdGhlIG1hcHMgY3VycmVudCB6b29tIGxldmVsLiBMZXZlbCAwIGlzIHRoZSBoaWdoZXN0IHBvaW50IG9mIGFnZ3JlZ2F0aW9uLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJldHVybnMge2ludH0gVGhlIHpvb20gbGV2ZWwuXHJcbiAgICAgICAgICovXHJcblx0XHRnZXRab29tOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLm9sTWFwLmdldFpvb20oKTtcclxuXHRcdH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFNldCBhIG1hcCBldmVudCBjYWxsYmFjay5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSBldmVudFR5cGUge3N0cmluZ30gICBUaGUgZXZlbnQgdHlwZS5cclxuICAgICAgICAgKiBAcGFyYW0gY2FsbGJhY2sgIHtGdW5jdGlvbn0gVGhlIGNhbGxiYWNrLlxyXG4gICAgICAgICAqL1xyXG5cdFx0b246IGZ1bmN0aW9uKCBldmVudFR5cGUsIGNhbGxiYWNrICkge1xyXG4gICAgICAgICAgICB0aGlzLm9sTWFwLmV2ZW50cy5yZWdpc3RlciggZXZlbnRUeXBlLCB0aGlzLm9sTWFwLCBjYWxsYmFjayApO1xyXG5cdFx0fSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogUmVtb3ZlIGEgbWFwIGV2ZW50IGNhbGxiYWNrLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIGV2ZW50VHlwZSB7c3RyaW5nfSAgIFRoZSBldmVudCB0eXBlLlxyXG4gICAgICAgICAqIEBwYXJhbSBjYWxsYmFjayAge0Z1bmN0aW9ufSBUaGUgY2FsbGJhY2suXHJcbiAgICAgICAgICovXHJcblx0XHRvZmY6IGZ1bmN0aW9uKCBldmVudFR5cGUsIGNhbGxiYWNrICkge1xyXG5cdFx0XHR0aGlzLm9sTWFwLmV2ZW50cy51bnJlZ2lzdGVyKCBldmVudFR5cGUsIHRoaXMub2xNYXAsIGNhbGxiYWNrICk7XHJcblx0XHR9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUcmlnZ2VyIGEgbWFwIGV2ZW50LlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIGV2ZW50VHlwZSB7c3RyaW5nfSBUaGUgZXZlbnQgdHlwZS5cclxuICAgICAgICAgKiBAcGFyYW0gZXZlbnQgICAgIHtPYmplY3R9IFRoZSBldmVudCBvYmplY3QgdG8gYmUgcGFzc2VkIHRvIHRoZSBldmVudC5cclxuICAgICAgICAgKi9cclxuXHRcdHRyaWdnZXI6IGZ1bmN0aW9uKCBldmVudFR5cGUsIGV2ZW50ICkge1xyXG4gICAgICAgICAgICB0aGlzLm9sTWFwLmV2ZW50cy50cmlnZ2VyRXZlbnQoIGV2ZW50VHlwZSwgZXZlbnQgKTtcclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHRtb2R1bGUuZXhwb3J0cyA9IE1hcDtcclxufSgpKTtcclxuIiwiLypcclxuICogQ29weXJpZ2h0IChjKSAyMDE0IE9jdWx1cyBJbmZvIEluYy5cclxuICogaHR0cDovL3d3dy5vY3VsdXNpbmZvLmNvbS9cclxuICpcclxuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKlxyXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5IG9mXHJcbiAqIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW5cclxuICogdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0b1xyXG4gKiB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllc1xyXG4gKiBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG9cclxuICogc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxyXG5cclxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsXHJcbiAqIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXHJcblxyXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXHJcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxyXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcclxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxyXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxyXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRVxyXG4gKiBTT0ZUV0FSRS5cclxuICovXHJcblxyXG4oIGZ1bmN0aW9uKCkge1xyXG5cclxuXHRcInVzZSBzdHJpY3RcIjtcclxuXHJcblx0dmFyIFV0aWwgPSByZXF1aXJlKCcuLi91dGlsL1V0aWwnKSxcclxuICAgICAgICBnZXRNYXBNaW5BbmRNYXhJblZpZXdwb3J0UGl4ZWxzLFxyXG4gICAgICAgIFRJTEVTSVpFID0gMjU2O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUHJpdmF0ZTogUmV0dXJucyB0aGUgbWFwcyBtaW4gYW5kIG1heCBwaXhlbHMgaW4gdmlld3BvcnQgcGl4ZWxzLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBtYXAge01hcH0gVGhlIG1hcCBvYmplY3QuXHJcbiAgICAgKiBOT1RFOiAgICB2aWV3cG9ydCBbMCwwXSBpcyBUT1AtTEVGVFxyXG4gICAgICogICAgICAgICAgbWFwIFswLDBdIGlzIEJPVFRPTS1MRUZUXHJcbiAgICAgKi9cclxuICAgIGdldE1hcE1pbkFuZE1heEluVmlld3BvcnRQaXhlbHMgPSBmdW5jdGlvbiggbWFwICkge1xyXG4gICAgICAgIHZhciBvbE1hcCA9IG1hcC5vbE1hcDtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBtaW4gOiB7XHJcbiAgICAgICAgICAgICAgICB4OiBNYXRoLnJvdW5kKCBvbE1hcC5taW5QeC54ICksXHJcbiAgICAgICAgICAgICAgICB5OiBNYXRoLnJvdW5kKCBvbE1hcC5tYXhQeC55IClcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbWF4IDoge1xyXG4gICAgICAgICAgICAgICAgeDogTWF0aC5yb3VuZCggb2xNYXAubWF4UHgueCApLFxyXG4gICAgICAgICAgICAgICAgeTogTWF0aC5yb3VuZCggb2xNYXAubWluUHgueSApXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuXHJcbiAgICBtb2R1bGUuZXhwb3J0cyA9IHtcclxuXHJcbiAgICAgICAgLyoqXHJcblx0XHQgKiBUcmFuc2Zvcm1zIGEgcG9pbnQgZnJvbSBkYXRhIGNvb3JkaW5hdGVzIHRvIHZpZXdwb3J0IHBpeGVsIGNvb3JkaW5hdGVzXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gbWFwIHtNYXB9ICAgIFRoZSBtYXAgb2JqZWN0LlxyXG4gICAgICAgICAqIEBwYXJhbSB4ICAge251bWJlcn0gVGhlIHggY29vcmRpbmF0ZSBvZiB0aGUgZGF0YS5cclxuICAgICAgICAgKiBAcGFyYW0geSAgIHtudW1iZXJ9IFRoZSB5IGNvb3JkaW5hdGUgb2YgdGhlIGRhdGEuXHJcblx0XHQgKiBOT1RFOiAgICB2aWV3cG9ydCBbMCwwXSBpcyBUT1AtTEVGVFxyXG5cdFx0ICogICAgICAgICAgZGF0YSBbMCwwXSBpcyBCT1RUT00tTEVGVFxyXG5cdFx0ICovXHJcblx0XHRnZXRWaWV3cG9ydFBpeGVsRnJvbUNvb3JkOiBmdW5jdGlvbiggbWFwLCB4LCB5ICkge1xyXG5cdFx0XHR2YXIgbWFwUGl4ZWwgPSB0aGlzLmdldE1hcFBpeGVsRnJvbUNvb3JkKCBtYXAsIHgsIHkgKTtcclxuXHRcdFx0cmV0dXJuIHRoaXMuZ2V0Vmlld3BvcnRQaXhlbEZyb21NYXBQaXhlbCggbWFwLCBtYXBQaXhlbC54LCBtYXBQaXhlbC55ICk7XHJcblx0XHR9LFxyXG5cclxuXHRcdC8qKlxyXG5cdFx0ICogVHJhbnNmb3JtcyBhIHBvaW50IGZyb20gbWFwIHBpeGVsIGNvb3JkaW5hdGVzIHRvIHZpZXdwb3J0IHBpeGVsIGNvb3JkaW5hdGVzXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gbWFwIHtNYXB9ICAgIFRoZSBtYXAgb2JqZWN0LlxyXG4gICAgICAgICAqIEBwYXJhbSBteCAge251bWJlcn0gVGhlIHggcGl4ZWwgY29vcmRpbmF0ZSBvZiB0aGUgbWFwLlxyXG4gICAgICAgICAqIEBwYXJhbSBteSAge251bWJlcn0gVGhlIHkgcGl4ZWwgY29vcmRpbmF0ZSBvZiB0aGUgbWFwLlxyXG5cdFx0ICogTk9URTogICAgdmlld3BvcnQgWzAsMF0gaXMgVE9QLUxFRlRcclxuXHRcdCAqICAgICAgICAgIG1hcCBbMCwwXSBpcyBCT1RUT00tTEVGVFxyXG5cdFx0ICovXHJcblx0XHRnZXRWaWV3cG9ydFBpeGVsRnJvbU1hcFBpeGVsOiBmdW5jdGlvbiggbWFwLCBteCwgbXkgKSB7XHJcblx0XHRcdHZhciB2aWV3cG9ydE1pbk1heCA9IGdldE1hcE1pbkFuZE1heEluVmlld3BvcnRQaXhlbHMoIG1hcCApO1xyXG5cdFx0XHRyZXR1cm4ge1xyXG5cdFx0XHRcdHg6IG14ICsgdmlld3BvcnRNaW5NYXgubWluLngsXHJcblx0XHRcdFx0eTogbWFwLmdldFdpZHRoKCkgLSBteSArIHZpZXdwb3J0TWluTWF4Lm1heC55XHJcblx0XHRcdH07XHJcblx0XHR9LFxyXG5cclxuXHRcdC8qKlxyXG5cdFx0ICogVHJhbnNmb3JtcyBhIHBvaW50IGZyb20gZGF0YSBjb29yZGluYXRlcyB0byBtYXAgcGl4ZWwgY29vcmRpbmF0ZXNcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSBtYXAge01hcH0gVGhlIG1hcCBvYmplY3QuXHJcbiAgICAgICAgICogQHBhcmFtIHggICB7aW50fSBUaGUgeCBjb29yZGluYXRlIG9mIHRoZSBkYXRhLlxyXG4gICAgICAgICAqIEBwYXJhbSB5ICAge2ludH0gVGhlIHkgY29vcmRpbmF0ZSBvZiB0aGUgZGF0YS5cclxuXHRcdCAqIE5PVEU6ICAgIGRhdGEgYW5kIG1hcCBbMCwwXSBhcmUgYm90aCBCT1RUT00tTEVGVFxyXG5cdFx0ICovXHJcblx0XHRnZXRNYXBQaXhlbEZyb21Db29yZDogZnVuY3Rpb24oIG1hcCwgeCwgeSApIHtcclxuXHRcdFx0dmFyIHRpbGUgPSBtYXAucHlyYW1pZC5yb290VG9UaWxlKCB4LCB5LCBtYXAuZ2V0Wm9vbSgpLCBUSUxFU0laRSApLFxyXG5cdFx0XHQgICAgYmluID0gbWFwLnB5cmFtaWQucm9vdFRvQmluKCB4LCB5LCB0aWxlKTtcclxuXHRcdFx0cmV0dXJuIHtcclxuXHRcdFx0XHR4OiB0aWxlLnhJbmRleCAqIFRJTEVTSVpFICsgYmluLngsXHJcblx0XHRcdFx0eTogdGlsZS55SW5kZXggKiBUSUxFU0laRSArIFRJTEVTSVpFIC0gMSAtIGJpbi55XHJcblx0XHRcdH07XHJcblx0XHR9LFxyXG5cclxuXHRcdC8qKlxyXG5cdFx0ICogVHJhbnNmb3JtcyBhIHBvaW50IGZyb20gdmlld3BvcnQgcGl4ZWwgY29vcmRpbmF0ZXMgdG8gbWFwIHBpeGVsIGNvb3JkaW5hdGVzXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gbWFwIHtNYXB9IFRoZSBtYXAgb2JqZWN0LlxyXG4gICAgICAgICAqIEBwYXJhbSB2eCAge2ludH0gVGhlIHggcGl4ZWwgY29vcmRpbmF0ZSBvZiB0aGUgdmlld3BvcnQuXHJcbiAgICAgICAgICogQHBhcmFtIHZ5ICB7aW50fSBUaGUgeSBwaXhlbCBjb29yZGluYXRlIG9mIHRoZSB2aWV3cG9ydC5cclxuXHRcdCAqIE5PVEU6ICAgIHZpZXdwb3J0IFswLDBdIGlzIFRPUC1MRUZUXHJcblx0XHQgKiAgICAgICAgICBtYXAgWzAsMF0gaXMgQk9UVE9NLUxFRlRcclxuXHRcdCAqL1xyXG5cdFx0Z2V0TWFwUGl4ZWxGcm9tVmlld3BvcnRQaXhlbDogZnVuY3Rpb24oIG1hcCwgdngsIHZ5ICkge1xyXG4gICAgICAgICAgICB2YXIgdmlld3BvcnRNaW5NYXggPSBnZXRNYXBNaW5BbmRNYXhJblZpZXdwb3J0UGl4ZWxzKCBtYXAgKSxcclxuXHRcdFx0ICAgIHRvdGFsUGl4ZWxTcGFuID0gbWFwLmdldFdpZHRoKCk7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcblx0XHRcdFx0eDogdG90YWxQaXhlbFNwYW4gKyB2eCAtIHZpZXdwb3J0TWluTWF4Lm1heC54LFxyXG5cdFx0XHRcdHk6IHRvdGFsUGl4ZWxTcGFuIC0gdnkgKyB2aWV3cG9ydE1pbk1heC5tYXgueVxyXG5cdFx0XHR9O1xyXG5cdFx0fSxcclxuXHJcblx0XHQvKipcclxuXHRcdCAqIFRyYW5zZm9ybXMgYSBwb2ludCBmcm9tIG1hcCBwaXhlbCBjb29yZGluYXRlcyB0byBkYXRhIGNvb3JkaW5hdGVzXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gbWFwIHtNYXB9ICAgIFRoZSBtYXAgb2JqZWN0LlxyXG4gICAgICAgICAqIEBwYXJhbSBteCAge251bWJlcn0gVGhlIHggcGl4ZWwgY29vcmRpbmF0ZSBvZiB0aGUgbWFwLlxyXG4gICAgICAgICAqIEBwYXJhbSBteSAge251bWJlcn0gVGhlIHkgcGl4ZWwgY29vcmRpbmF0ZSBvZiB0aGUgbWFwLlxyXG5cdFx0ICogTk9URTogICAgZGF0YSBhbmQgbWFwIFswLDBdIGFyZSBib3RoIEJPVFRPTS1MRUZUXHJcblx0XHQgKi9cclxuXHRcdGdldENvb3JkRnJvbU1hcFBpeGVsOiBmdW5jdGlvbiggbWFwLCBteCwgbXkgKSB7XHJcbiAgICAgICAgICAgIHZhciB0aWxlQW5kQmluID0gdGhpcy5nZXRUaWxlQW5kQmluRnJvbU1hcFBpeGVsKCBtYXAsIG14LCBteSwgVElMRVNJWkUsIFRJTEVTSVpFICksXHJcblx0XHRcdCAgICBib3VuZHMgPSBtYXAucHlyYW1pZC5nZXRCaW5Cb3VuZHMoIHRpbGVBbmRCaW4udGlsZSwgdGlsZUFuZEJpbi5iaW4gKTtcclxuXHRcdFx0cmV0dXJuIHtcclxuXHRcdFx0XHR4OiBib3VuZHMubWluWCxcclxuXHRcdFx0XHR5OiBib3VuZHMubWluWVxyXG5cdFx0XHR9O1xyXG5cdFx0fSxcclxuXHJcblx0XHQvKipcclxuXHRcdCAqIFRyYW5zZm9ybXMgYSBwb2ludCBmcm9tIHZpZXdwb3J0IHBpeGVsIGNvb3JkaW5hdGVzIHRvIGRhdGEgY29vcmRpbmF0ZXNcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSBtYXAge01hcH0gVGhlIG1hcCBvYmplY3QuXHJcbiAgICAgICAgICogQHBhcmFtIHZ4ICB7aW50fSBUaGUgeCBwaXhlbCBjb29yZGluYXRlIG9mIHRoZSB2aWV3cG9ydC5cclxuICAgICAgICAgKiBAcGFyYW0gdnkgIHtpbnR9IFRoZSB5IHBpeGVsIGNvb3JkaW5hdGUgb2YgdGhlIHZpZXdwb3J0LlxyXG5cdFx0ICogTk9URTogICAgdmlld3BvcnQgWzAsMF0gaXMgVE9QLUxFRlRcclxuXHRcdCAqICAgICAgICAgIGRhdGEgWzAsMF0gaXMgQk9UVE9NLUxFRlRcclxuXHRcdCAqL1xyXG5cdFx0Z2V0Q29vcmRGcm9tVmlld3BvcnRQaXhlbDogZnVuY3Rpb24oIG1hcCwgdngsIHZ5ICkge1xyXG5cdFx0XHR2YXIgbWFwUGl4ZWwgPSB0aGlzLmdldE1hcFBpeGVsRnJvbVZpZXdwb3J0UGl4ZWwoIG1hcCwgdngsIHZ5ICk7XHJcblx0XHRcdHJldHVybiB0aGlzLmdldENvb3JkRnJvbU1hcFBpeGVsKCBtYXAsIG1hcFBpeGVsLngsIG1hcFBpeGVsLnkgKTtcclxuXHRcdH0sXHJcblxyXG5cdFx0LyoqXHJcblx0XHQgKiBSZXR1cm5zIHRoZSB0aWxlIGFuZCBiaW4gaW5kZXggY29ycmVzcG9uZGluZyB0byB0aGUgZ2l2ZW4gdmlld3BvcnQgcGl4ZWwgY29vcmRpbmF0ZVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIG1hcCB7TWFwfSBUaGUgbWFwIG9iamVjdC5cclxuICAgICAgICAgKiBAcGFyYW0gdnggIHtpbnR9IFRoZSB4IHBpeGVsIGNvb3JkaW5hdGUgb2YgdGhlIHZpZXdwb3J0LlxyXG4gICAgICAgICAqIEBwYXJhbSB2eSAge2ludH0gVGhlIHkgcGl4ZWwgY29vcmRpbmF0ZSBvZiB0aGUgdmlld3BvcnQuXHJcbiAgICAgICAgICogQHBhcmFtIHhCaW5Db3VudCB7aW50fSBUaGUgbnVtYmVyIG9mIGJpbnMgaW4gdGhlIHggZGltZW5zaW9uIG9mIHRoZSB0aWxlLlxyXG4gICAgICAgICAqIEBwYXJhbSB5QmluQ291bnQge2ludH0gVGhlIG51bWJlciBvZiBiaW5zIGluIHRoZSB5IGRpbWVuc2lvbiBvZiB0aGUgdGlsZS5cclxuXHRcdCAqL1xyXG5cdFx0Z2V0VGlsZUFuZEJpbkZyb21WaWV3cG9ydFBpeGVsOiBmdW5jdGlvbiggbWFwLCB2eCwgdnksIHhCaW5Db3VudCwgeUJpbkNvdW50ICkge1xyXG5cdFx0XHR2YXIgbWFwUGl4ZWwgPSB0aGlzLmdldE1hcFBpeGVsRnJvbVZpZXdwb3J0UGl4ZWwoIG1hcCwgdngsIHZ5ICk7XHJcblx0XHRcdHJldHVybiB0aGlzLmdldFRpbGVBbmRCaW5Gcm9tTWFwUGl4ZWwoIG1hcCwgbWFwUGl4ZWwueCwgbWFwUGl4ZWwueSwgeEJpbkNvdW50LCB5QmluQ291bnQgKTtcclxuXHRcdH0sXHJcblxyXG5cdFx0LyoqXHJcbiAgICAgICAgICogUmV0dXJucyB0aGUgdGlsZSBhbmQgYmluIGluZGV4IGNvcnJlc3BvbmRpbmcgdG8gdGhlIGdpdmVuIG1hcCBwaXhlbCBjb29yZGluYXRlXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gbWFwIHtNYXB9ICAgIFRoZSBtYXAgb2JqZWN0LlxyXG4gICAgICAgICAqIEBwYXJhbSBteCAge251bWJlcn0gVGhlIHggcGl4ZWwgY29vcmRpbmF0ZSBvZiB0aGUgbWFwLlxyXG4gICAgICAgICAqIEBwYXJhbSBteSAge251bWJlcn0gVGhlIHkgcGl4ZWwgY29vcmRpbmF0ZSBvZiB0aGUgbWFwLlxyXG4gICAgICAgICAqIEBwYXJhbSB4QmluQ291bnQge2ludH0gVGhlIG51bWJlciBvZiBiaW5zIGluIHRoZSB4IGRpbWVuc2lvbiBvZiB0aGUgdGlsZS5cclxuICAgICAgICAgKiBAcGFyYW0geUJpbkNvdW50IHtpbnR9IFRoZSBudW1iZXIgb2YgYmlucyBpbiB0aGUgeSBkaW1lbnNpb24gb2YgdGhlIHRpbGUuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0VGlsZUFuZEJpbkZyb21NYXBQaXhlbDogZnVuY3Rpb24oIG1hcCwgbXgsIG15LCB4QmluQ291bnQsIHlCaW5Db3VudCApIHtcclxuICAgICAgICAgICAgdmFyIHRpbGVJbmRleFggPSBNYXRoLmZsb29yKCBteCAvIFRJTEVTSVpFICksXHJcbiAgICAgICAgICAgICAgICB0aWxlSW5kZXhZID0gTWF0aC5mbG9vciggbXkgLyBUSUxFU0laRSApLFxyXG4gICAgICAgICAgICAgICAgdGlsZVBpeGVsWCA9IFV0aWwubW9kKCBteCAsIFRJTEVTSVpFICksXHJcbiAgICAgICAgICAgICAgICB0aWxlUGl4ZWxZID0gVXRpbC5tb2QoIG15LCBUSUxFU0laRSApO1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgdGlsZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldmVsIDogbWFwLmdldFpvb20oKSxcclxuICAgICAgICAgICAgICAgICAgICB4SW5kZXggOiB0aWxlSW5kZXhYLFxyXG4gICAgICAgICAgICAgICAgICAgIHlJbmRleCA6IHRpbGVJbmRleFksXHJcbiAgICAgICAgICAgICAgICAgICAgeEJpbkNvdW50IDogeEJpbkNvdW50LFxyXG4gICAgICAgICAgICAgICAgICAgIHlCaW5Db3VudCA6IHlCaW5Db3VudFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGJpbjoge1xyXG4gICAgICAgICAgICAgICAgICAgIHggOiBNYXRoLmZsb29yKCB0aWxlUGl4ZWxYIC8gKFRJTEVTSVpFIC8geEJpbkNvdW50ICkgKSxcclxuICAgICAgICAgICAgICAgICAgICB5IDogKHlCaW5Db3VudCAtIDEpIC0gTWF0aC5mbG9vciggdGlsZVBpeGVsWSAvIChUSUxFU0laRSAvIHlCaW5Db3VudCkgKSAvLyBiaW4gWzAsMF0gaXMgdG9wIGxlZnRcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuXHRcdCAqIFJldHVybnMgdGhlIHRpbGUgYW5kIGJpbiBpbmRleCBjb3JyZXNwb25kaW5nIHRvIHRoZSBnaXZlbiBkYXRhIGNvb3JkaW5hdGVcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSBtYXAge01hcH0gVGhlIG1hcCBvYmplY3QuXHJcbiAgICAgICAgICogQHBhcmFtIHggICB7aW50fSBUaGUgeCBjb29yZGluYXRlIG9mIHRoZSBkYXRhLlxyXG4gICAgICAgICAqIEBwYXJhbSB5ICAge2ludH0gVGhlIHkgY29vcmRpbmF0ZSBvZiB0aGUgZGF0YS5cclxuICAgICAgICAgKiBAcGFyYW0geEJpbkNvdW50IHtpbnR9IFRoZSBudW1iZXIgb2YgYmlucyBpbiB0aGUgeCBkaW1lbnNpb24gb2YgdGhlIHRpbGUuXHJcbiAgICAgICAgICogQHBhcmFtIHlCaW5Db3VudCB7aW50fSBUaGUgbnVtYmVyIG9mIGJpbnMgaW4gdGhlIHkgZGltZW5zaW9uIG9mIHRoZSB0aWxlLlxyXG5cdFx0ICovXHJcblx0XHRnZXRUaWxlQW5kQmluRnJvbUNvb3JkOiBmdW5jdGlvbiggbWFwLCB4LCB5LCB4QmluQ291bnQsIHlCaW5Db3VudCApIHtcclxuXHRcdFx0dmFyIG1hcFBpeGVsID0gdGhpcy5nZXRNYXBQaXhlbEZyb21Db29yZCggbWFwLCB4LCB5ICk7XHJcblx0XHRcdHJldHVybiB0aGlzLmdldFRpbGVBbmRCaW5Gcm9tTWFwUGl4ZWwoIG1hcCwgbWFwUGl4ZWwueCwgbWFwUGl4ZWwueSwgeEJpbkNvdW50LCB5QmluQ291bnQgKTtcclxuXHRcdH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFJldHVybnMgdGhlIHRvcCBsZWZ0IHBpeGVsIGxvY2F0aW9uIGluIHZpZXdwb3J0IGNvb3JkaW5hdGVzIGZyb20gYSB0aWxla2V5Li5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSBtYXAgICAgIHtNYXB9ICAgIFRoZSBtYXAgb2JqZWN0LlxyXG4gICAgICAgICAqIEBwYXJhbSB0aWxla2V5IHtzdHJpbmd9IFRoZSB0aWxla2V5LlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldFRvcExlZnRWaWV3cG9ydFBpeGVsRm9yVGlsZTogZnVuY3Rpb24oIG1hcCwgdGlsZWtleSApIHtcclxuICAgICAgICAgICAgdmFyIG1hcFBpeGVsID0gdGhpcy5nZXRUb3BMZWZ0TWFwUGl4ZWxGb3JUaWxlKCBtYXAsIHRpbGVrZXkgKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Vmlld3BvcnRQaXhlbEZyb21NYXBQaXhlbCggbWFwLCBtYXBQaXhlbC54LCBtYXBQaXhlbC55ICk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogUmV0dXJucyB0aGUgdG9wIGxlZnQgcGl4ZWwgbG9jYXRpb24gaW4gdmlld3BvcnQgY29vcmQgZnJvbSBhIHRpbGUgaW5kZXguXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gbWFwICAgICB7TWFwfSAgICBUaGUgbWFwIG9iamVjdC5cclxuICAgICAgICAgKiBAcGFyYW0gdGlsZWtleSB7c3RyaW5nfSBUaGUgdGlsZWtleS5cclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRUb3BMZWZ0TWFwUGl4ZWxGb3JUaWxlOiBmdW5jdGlvbiggbWFwLCB0aWxla2V5ICkge1xyXG4gICAgICAgICAgICB2YXIgcGFyc2VkVmFsdWVzID0gdGlsZWtleS5zcGxpdCggJywnICksXHJcbiAgICAgICAgICAgICAgICB4ID0gcGFyc2VJbnQoIHBhcnNlZFZhbHVlc1sxXSwgMTAgKSxcclxuICAgICAgICAgICAgICAgIHkgPSBwYXJzZUludCggcGFyc2VkVmFsdWVzWzJdLCAxMCApLFxyXG4gICAgICAgICAgICAgICAgbXggPSB4ICogVElMRVNJWkUsXHJcbiAgICAgICAgICAgICAgICBteSA9IHkgKiBUSUxFU0laRSArIFRJTEVTSVpFO1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgeCA6IG14LFxyXG4gICAgICAgICAgICAgICAgeSA6IG15XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogUmV0dXJucyB0aGUgZGF0YSBjb29yZGluYXRlIHZhbHVlIGNvcnJlc3BvbmRpbmcgdG8gdGhlIHRvcCBsZWZ0IHBpeGVsIG9mIHRoZSB0aWxlXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gbWFwICAgICB7TWFwfSAgICBUaGUgbWFwIG9iamVjdC5cclxuICAgICAgICAgKiBAcGFyYW0gdGlsZWtleSB7c3RyaW5nfSBUaGUgdGlsZWtleS5cclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRUb3BMZWZ0Q29vcmRGb3JUaWxlOiBmdW5jdGlvbiggbWFwLCB0aWxla2V5ICkge1xyXG4gICAgICAgICAgICB2YXIgbWFwUGl4ZWwgPSB0aGlzLmdldFRvcExlZnRNYXBQaXhlbEZvclRpbGUoIG1hcCwgdGlsZWtleSApO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRDb29yZEZyb21NYXBQaXhlbCggbWFwLCBtYXBQaXhlbC54LCBtYXBQaXhlbC55ICk7XHJcbiAgICAgICAgfVxyXG5cclxuXHR9O1xyXG59KCkpO1xyXG4iLCIvKlxuXG4gIE9wZW5MYXllcnMuanMgLS0gT3BlbkxheWVycyBNYXAgVmlld2VyIExpYnJhcnlcblxuICBDb3B5cmlnaHQgKGMpIDIwMDYtMjAxMiBieSBPcGVuTGF5ZXJzIENvbnRyaWJ1dG9yc1xuICBQdWJsaXNoZWQgdW5kZXIgdGhlIDItY2xhdXNlIEJTRCBsaWNlbnNlLlxuICBTZWUgaHR0cDovL29wZW5sYXllcnMub3JnL2Rldi9saWNlbnNlLnR4dCBmb3IgdGhlIGZ1bGwgdGV4dCBvZiB0aGUgbGljZW5zZSwgYW5kIGh0dHA6Ly9vcGVubGF5ZXJzLm9yZy9kZXYvYXV0aG9ycy50eHQgZm9yIGZ1bGwgbGlzdCBvZiBjb250cmlidXRvcnMuXG5cbiAgSW5jbHVkZXMgY29tcHJlc3NlZCBjb2RlIHVuZGVyIHRoZSBmb2xsb3dpbmcgbGljZW5zZXM6XG5cbiAgKEZvciB1bmNvbXByZXNzZWQgdmVyc2lvbnMgb2YgdGhlIGNvZGUgdXNlZCwgcGxlYXNlIHNlZSB0aGVcbiAgT3BlbkxheWVycyBHaXRodWIgcmVwb3NpdG9yeTogPGh0dHBzOi8vZ2l0aHViLmNvbS9vcGVubGF5ZXJzL29wZW5sYXllcnM+KVxuXG4qL1xuXG4vKipcbiAqIENvbnRhaW5zIFhNTEh0dHBSZXF1ZXN0LmpzIDxodHRwOi8vY29kZS5nb29nbGUuY29tL3AveG1saHR0cHJlcXVlc3QvPlxuICogQ29weXJpZ2h0IDIwMDcgU2VyZ2V5IElsaW5za3kgKGh0dHA6Ly93d3cuaWxpbnNreS5jb20pXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKi9cblxuLyoqXG4gKiBPcGVuTGF5ZXJzLlV0aWwucGFnZVBvc2l0aW9uIGlzIGJhc2VkIG9uIFlhaG9vJ3MgZ2V0WFkgbWV0aG9kLCB3aGljaCBpc1xuICogQ29weXJpZ2h0IChjKSAyMDA2LCBZYWhvbyEgSW5jLlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqIFxuICogUmVkaXN0cmlidXRpb24gYW5kIHVzZSBvZiB0aGlzIHNvZnR3YXJlIGluIHNvdXJjZSBhbmQgYmluYXJ5IGZvcm1zLCB3aXRoIG9yXG4gKiB3aXRob3V0IG1vZGlmaWNhdGlvbiwgYXJlIHBlcm1pdHRlZCBwcm92aWRlZCB0aGF0IHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uc1xuICogYXJlIG1ldDpcbiAqIFxuICogKiBSZWRpc3RyaWJ1dGlvbnMgb2Ygc291cmNlIGNvZGUgbXVzdCByZXRhaW4gdGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UsXG4gKiAgIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIuXG4gKiBcbiAqICogUmVkaXN0cmlidXRpb25zIGluIGJpbmFyeSBmb3JtIG11c3QgcmVwcm9kdWNlIHRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlLFxuICogICB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyIGluIHRoZSBkb2N1bWVudGF0aW9uXG4gKiAgIGFuZC9vciBvdGhlciBtYXRlcmlhbHMgcHJvdmlkZWQgd2l0aCB0aGUgZGlzdHJpYnV0aW9uLlxuICogXG4gKiAqIE5laXRoZXIgdGhlIG5hbWUgb2YgWWFob28hIEluYy4gbm9yIHRoZSBuYW1lcyBvZiBpdHMgY29udHJpYnV0b3JzIG1heSBiZVxuICogICB1c2VkIHRvIGVuZG9yc2Ugb3IgcHJvbW90ZSBwcm9kdWN0cyBkZXJpdmVkIGZyb20gdGhpcyBzb2Z0d2FyZSB3aXRob3V0XG4gKiAgIHNwZWNpZmljIHByaW9yIHdyaXR0ZW4gcGVybWlzc2lvbiBvZiBZYWhvbyEgSW5jLlxuICogXG4gKiBUSElTIFNPRlRXQVJFIElTIFBST1ZJREVEIEJZIFRIRSBDT1BZUklHSFQgSE9MREVSUyBBTkQgQ09OVFJJQlVUT1JTIFwiQVMgSVNcIlxuICogQU5EIEFOWSBFWFBSRVNTIE9SIElNUExJRUQgV0FSUkFOVElFUywgSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFRIRVxuICogSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSBBTkQgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0VcbiAqIEFSRSBESVNDTEFJTUVELiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQ09QWVJJR0hUIE9XTkVSIE9SIENPTlRSSUJVVE9SUyBCRVxuICogTElBQkxFIEZPUiBBTlkgRElSRUNULCBJTkRJUkVDVCwgSU5DSURFTlRBTCwgU1BFQ0lBTCwgRVhFTVBMQVJZLCBPUlxuICogQ09OU0VRVUVOVElBTCBEQU1BR0VTIChJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgUFJPQ1VSRU1FTlQgT0ZcbiAqIFNVQlNUSVRVVEUgR09PRFMgT1IgU0VSVklDRVM7IExPU1MgT0YgVVNFLCBEQVRBLCBPUiBQUk9GSVRTOyBPUiBCVVNJTkVTU1xuICogSU5URVJSVVBUSU9OKSBIT1dFVkVSIENBVVNFRCBBTkQgT04gQU5ZIFRIRU9SWSBPRiBMSUFCSUxJVFksIFdIRVRIRVIgSU5cbiAqIENPTlRSQUNULCBTVFJJQ1QgTElBQklMSVRZLCBPUiBUT1JUIChJTkNMVURJTkcgTkVHTElHRU5DRSBPUiBPVEhFUldJU0UpXG4gKiBBUklTSU5HIElOIEFOWSBXQVkgT1VUIE9GIFRIRSBVU0UgT0YgVEhJUyBTT0ZUV0FSRSwgRVZFTiBJRiBBRFZJU0VEIE9GIFRIRSBcbiAqIFBPU1NJQklMSVRZIE9GIFNVQ0ggREFNQUdFLlxuICovXG4oZnVuY3Rpb24oKXt2YXIgT3BlbkxheWVycz17VkVSU0lPTl9OVU1CRVI6XCJSZWxlYXNlIDIuMTJcIixzaW5nbGVGaWxlOiEwLF9nZXRTY3JpcHRMb2NhdGlvbjpmdW5jdGlvbigpe2Zvcih2YXIgYT0vKF58KC4qP1xcLykpKE9wZW5MYXllcnNbXlxcL10qP1xcLmpzKShcXD98JCkvLGI9ZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzY3JpcHRcIiksYyxkPVwiXCIsZT0wLGY9Yi5sZW5ndGg7ZTxmO2UrKylpZihjPWJbZV0uZ2V0QXR0cmlidXRlKFwic3JjXCIpKWlmKGM9Yy5tYXRjaChhKSl7ZD1jWzFdO2JyZWFrfXJldHVybiBmdW5jdGlvbigpe3JldHVybiBkfX0oKSxJbWdQYXRoOlwiXCJ9O09wZW5MYXllcnMuQ2xhc3M9ZnVuY3Rpb24oKXt2YXIgYT1hcmd1bWVudHMubGVuZ3RoLGI9YXJndW1lbnRzWzBdLGM9YXJndW1lbnRzW2EtMV0sZD1cImZ1bmN0aW9uXCI9PXR5cGVvZiBjLmluaXRpYWxpemU/Yy5pbml0aWFsaXplOmZ1bmN0aW9uKCl7Yi5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9OzE8YT8oYT1bZCxiXS5jb25jYXQoQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKS5zbGljZSgxLGEtMSksYyksT3BlbkxheWVycy5pbmhlcml0LmFwcGx5KG51bGwsYSkpOmQucHJvdG90eXBlPWM7cmV0dXJuIGR9O1xuT3BlbkxheWVycy5pbmhlcml0PWZ1bmN0aW9uKGEsYil7dmFyIGM9ZnVuY3Rpb24oKXt9O2MucHJvdG90eXBlPWIucHJvdG90eXBlO2EucHJvdG90eXBlPW5ldyBjO3ZhciBkLGUsYz0yO2ZvcihkPWFyZ3VtZW50cy5sZW5ndGg7YzxkO2MrKyllPWFyZ3VtZW50c1tjXSxcImZ1bmN0aW9uXCI9PT10eXBlb2YgZSYmKGU9ZS5wcm90b3R5cGUpLE9wZW5MYXllcnMuVXRpbC5leHRlbmQoYS5wcm90b3R5cGUsZSl9O09wZW5MYXllcnMuVXRpbD1PcGVuTGF5ZXJzLlV0aWx8fHt9O09wZW5MYXllcnMuVXRpbC5leHRlbmQ9ZnVuY3Rpb24oYSxiKXthPWF8fHt9O2lmKGIpe2Zvcih2YXIgYyBpbiBiKXt2YXIgZD1iW2NdO3ZvaWQgMCE9PWQmJihhW2NdPWQpfSEoXCJmdW5jdGlvblwiPT10eXBlb2Ygd2luZG93LkV2ZW50JiZiIGluc3RhbmNlb2Ygd2luZG93LkV2ZW50KSYmKGIuaGFzT3duUHJvcGVydHkmJmIuaGFzT3duUHJvcGVydHkoXCJ0b1N0cmluZ1wiKSkmJihhLnRvU3RyaW5nPWIudG9TdHJpbmcpfXJldHVybiBhfTtPcGVuTGF5ZXJzLlN0cmluZz17c3RhcnRzV2l0aDpmdW5jdGlvbihhLGIpe3JldHVybiAwPT1hLmluZGV4T2YoYil9LGNvbnRhaW5zOmZ1bmN0aW9uKGEsYil7cmV0dXJuLTEhPWEuaW5kZXhPZihiKX0sdHJpbTpmdW5jdGlvbihhKXtyZXR1cm4gYS5yZXBsYWNlKC9eXFxzXFxzKi8sXCJcIikucmVwbGFjZSgvXFxzXFxzKiQvLFwiXCIpfSxjYW1lbGl6ZTpmdW5jdGlvbihhKXtmb3IodmFyIGE9YS5zcGxpdChcIi1cIiksYj1hWzBdLGM9MSxkPWEubGVuZ3RoO2M8ZDtjKyspdmFyIGU9YVtjXSxiPWIrKGUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkrZS5zdWJzdHJpbmcoMSkpO3JldHVybiBifSxmb3JtYXQ6ZnVuY3Rpb24oYSxiLGMpe2J8fChiPXdpbmRvdyk7cmV0dXJuIGEucmVwbGFjZShPcGVuTGF5ZXJzLlN0cmluZy50b2tlblJlZ0V4LGZ1bmN0aW9uKGEsZSl7Zm9yKHZhciBmLGc9ZS5zcGxpdCgvXFwuKy8pLGg9MDtoPGcubGVuZ3RoO2grKykwPT1oJiYoZj1iKSxmPWZbZ1toXV07XCJmdW5jdGlvblwiPT1cbnR5cGVvZiBmJiYoZj1jP2YuYXBwbHkobnVsbCxjKTpmKCkpO3JldHVyblwidW5kZWZpbmVkXCI9PXR5cGVvZiBmP1widW5kZWZpbmVkXCI6Zn0pfSx0b2tlblJlZ0V4Oi9cXCRcXHsoW1xcdy5dKz8pXFx9L2csbnVtYmVyUmVnRXg6L14oWystXT8pKD89XFxkfFxcLlxcZClcXGQqKFxcLlxcZCopPyhbRWVdKFsrLV0/XFxkKykpPyQvLGlzTnVtZXJpYzpmdW5jdGlvbihhKXtyZXR1cm4gT3BlbkxheWVycy5TdHJpbmcubnVtYmVyUmVnRXgudGVzdChhKX0sbnVtZXJpY0lmOmZ1bmN0aW9uKGEpe3JldHVybiBPcGVuTGF5ZXJzLlN0cmluZy5pc051bWVyaWMoYSk/cGFyc2VGbG9hdChhKTphfX07XG5PcGVuTGF5ZXJzLk51bWJlcj17ZGVjaW1hbFNlcGFyYXRvcjpcIi5cIix0aG91c2FuZHNTZXBhcmF0b3I6XCIsXCIsbGltaXRTaWdEaWdzOmZ1bmN0aW9uKGEsYil7dmFyIGM9MDswPGImJihjPXBhcnNlRmxvYXQoYS50b1ByZWNpc2lvbihiKSkpO3JldHVybiBjfSxmb3JtYXQ6ZnVuY3Rpb24oYSxiLGMsZCl7Yj1cInVuZGVmaW5lZFwiIT10eXBlb2YgYj9iOjA7Yz1cInVuZGVmaW5lZFwiIT10eXBlb2YgYz9jOk9wZW5MYXllcnMuTnVtYmVyLnRob3VzYW5kc1NlcGFyYXRvcjtkPVwidW5kZWZpbmVkXCIhPXR5cGVvZiBkP2Q6T3BlbkxheWVycy5OdW1iZXIuZGVjaW1hbFNlcGFyYXRvcjtudWxsIT1iJiYoYT1wYXJzZUZsb2F0KGEudG9GaXhlZChiKSkpO3ZhciBlPWEudG9TdHJpbmcoKS5zcGxpdChcIi5cIik7MT09ZS5sZW5ndGgmJm51bGw9PWImJihiPTApO2E9ZVswXTtpZihjKWZvcih2YXIgZj0vKC0/WzAtOV0rKShbMC05XXszfSkvO2YudGVzdChhKTspYT1hLnJlcGxhY2UoZixcIiQxXCIrYytcIiQyXCIpO1xuMD09Yj9iPWE6KGM9MTxlLmxlbmd0aD9lWzFdOlwiMFwiLG51bGwhPWImJihjKz1BcnJheShiLWMubGVuZ3RoKzEpLmpvaW4oXCIwXCIpKSxiPWErZCtjKTtyZXR1cm4gYn19O09wZW5MYXllcnMuRnVuY3Rpb249e2JpbmQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz1BcnJheS5wcm90b3R5cGUuc2xpY2UuYXBwbHkoYXJndW1lbnRzLFsyXSk7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGQ9Yy5jb25jYXQoQXJyYXkucHJvdG90eXBlLnNsaWNlLmFwcGx5KGFyZ3VtZW50cyxbMF0pKTtyZXR1cm4gYS5hcHBseShiLGQpfX0sYmluZEFzRXZlbnRMaXN0ZW5lcjpmdW5jdGlvbihhLGIpe3JldHVybiBmdW5jdGlvbihjKXtyZXR1cm4gYS5jYWxsKGIsY3x8d2luZG93LmV2ZW50KX19LEZhbHNlOmZ1bmN0aW9uKCl7cmV0dXJuITF9LFRydWU6ZnVuY3Rpb24oKXtyZXR1cm4hMH0sVm9pZDpmdW5jdGlvbigpe319O1xuT3BlbkxheWVycy5BcnJheT17ZmlsdGVyOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD1bXTtpZihBcnJheS5wcm90b3R5cGUuZmlsdGVyKWQ9YS5maWx0ZXIoYixjKTtlbHNle3ZhciBlPWEubGVuZ3RoO2lmKFwiZnVuY3Rpb25cIiE9dHlwZW9mIGIpdGhyb3cgbmV3IFR5cGVFcnJvcjtmb3IodmFyIGY9MDtmPGU7ZisrKWlmKGYgaW4gYSl7dmFyIGc9YVtmXTtiLmNhbGwoYyxnLGYsYSkmJmQucHVzaChnKX19cmV0dXJuIGR9fTtPcGVuTGF5ZXJzLkJvdW5kcz1PcGVuTGF5ZXJzLkNsYXNzKHtsZWZ0Om51bGwsYm90dG9tOm51bGwscmlnaHQ6bnVsbCx0b3A6bnVsbCxjZW50ZXJMb25MYXQ6bnVsbCxpbml0aWFsaXplOmZ1bmN0aW9uKGEsYixjLGQpe09wZW5MYXllcnMuVXRpbC5pc0FycmF5KGEpJiYoZD1hWzNdLGM9YVsyXSxiPWFbMV0sYT1hWzBdKTtudWxsIT1hJiYodGhpcy5sZWZ0PU9wZW5MYXllcnMuVXRpbC50b0Zsb2F0KGEpKTtudWxsIT1iJiYodGhpcy5ib3R0b209T3BlbkxheWVycy5VdGlsLnRvRmxvYXQoYikpO251bGwhPWMmJih0aGlzLnJpZ2h0PU9wZW5MYXllcnMuVXRpbC50b0Zsb2F0KGMpKTtudWxsIT1kJiYodGhpcy50b3A9T3BlbkxheWVycy5VdGlsLnRvRmxvYXQoZCkpfSxjbG9uZTpmdW5jdGlvbigpe3JldHVybiBuZXcgT3BlbkxheWVycy5Cb3VuZHModGhpcy5sZWZ0LHRoaXMuYm90dG9tLHRoaXMucmlnaHQsdGhpcy50b3ApfSxlcXVhbHM6ZnVuY3Rpb24oYSl7dmFyIGI9ITE7bnVsbCE9XG5hJiYoYj10aGlzLmxlZnQ9PWEubGVmdCYmdGhpcy5yaWdodD09YS5yaWdodCYmdGhpcy50b3A9PWEudG9wJiZ0aGlzLmJvdHRvbT09YS5ib3R0b20pO3JldHVybiBifSx0b1N0cmluZzpmdW5jdGlvbigpe3JldHVyblt0aGlzLmxlZnQsdGhpcy5ib3R0b20sdGhpcy5yaWdodCx0aGlzLnRvcF0uam9pbigpfSx0b0FycmF5OmZ1bmN0aW9uKGEpe3JldHVybiEwPT09YT9bdGhpcy5ib3R0b20sdGhpcy5sZWZ0LHRoaXMudG9wLHRoaXMucmlnaHRdOlt0aGlzLmxlZnQsdGhpcy5ib3R0b20sdGhpcy5yaWdodCx0aGlzLnRvcF19LHRvQkJPWDpmdW5jdGlvbihhLGIpe251bGw9PWEmJihhPTYpO3ZhciBjPU1hdGgucG93KDEwLGEpLGQ9TWF0aC5yb3VuZCh0aGlzLmxlZnQqYykvYyxlPU1hdGgucm91bmQodGhpcy5ib3R0b20qYykvYyxmPU1hdGgucm91bmQodGhpcy5yaWdodCpjKS9jLGM9TWF0aC5yb3VuZCh0aGlzLnRvcCpjKS9jO3JldHVybiEwPT09Yj9lK1wiLFwiK2QrXCIsXCIrYytcIixcIitmOmQrXG5cIixcIitlK1wiLFwiK2YrXCIsXCIrY30sdG9HZW9tZXRyeTpmdW5jdGlvbigpe3JldHVybiBuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2x5Z29uKFtuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5MaW5lYXJSaW5nKFtuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludCh0aGlzLmxlZnQsdGhpcy5ib3R0b20pLG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KHRoaXMucmlnaHQsdGhpcy5ib3R0b20pLG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KHRoaXMucmlnaHQsdGhpcy50b3ApLG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KHRoaXMubGVmdCx0aGlzLnRvcCldKV0pfSxnZXRXaWR0aDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnJpZ2h0LXRoaXMubGVmdH0sZ2V0SGVpZ2h0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9wLXRoaXMuYm90dG9tfSxnZXRTaXplOmZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBPcGVuTGF5ZXJzLlNpemUodGhpcy5nZXRXaWR0aCgpLHRoaXMuZ2V0SGVpZ2h0KCkpfSxcbmdldENlbnRlclBpeGVsOmZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBPcGVuTGF5ZXJzLlBpeGVsKCh0aGlzLmxlZnQrdGhpcy5yaWdodCkvMiwodGhpcy5ib3R0b20rdGhpcy50b3ApLzIpfSxnZXRDZW50ZXJMb25MYXQ6ZnVuY3Rpb24oKXt0aGlzLmNlbnRlckxvbkxhdHx8KHRoaXMuY2VudGVyTG9uTGF0PW5ldyBPcGVuTGF5ZXJzLkxvbkxhdCgodGhpcy5sZWZ0K3RoaXMucmlnaHQpLzIsKHRoaXMuYm90dG9tK3RoaXMudG9wKS8yKSk7cmV0dXJuIHRoaXMuY2VudGVyTG9uTGF0fSxzY2FsZTpmdW5jdGlvbihhLGIpe251bGw9PWImJihiPXRoaXMuZ2V0Q2VudGVyTG9uTGF0KCkpO3ZhciBjLGQ7XCJPcGVuTGF5ZXJzLkxvbkxhdFwiPT1iLkNMQVNTX05BTUU/KGM9Yi5sb24sZD1iLmxhdCk6KGM9Yi54LGQ9Yi55KTtyZXR1cm4gbmV3IE9wZW5MYXllcnMuQm91bmRzKCh0aGlzLmxlZnQtYykqYStjLCh0aGlzLmJvdHRvbS1kKSphK2QsKHRoaXMucmlnaHQtYykqYStjLCh0aGlzLnRvcC1kKSphK1xuZCl9LGFkZDpmdW5jdGlvbihhLGIpe2lmKG51bGw9PWF8fG51bGw9PWIpdGhyb3cgbmV3IFR5cGVFcnJvcihcIkJvdW5kcy5hZGQgY2Fubm90IHJlY2VpdmUgbnVsbCB2YWx1ZXNcIik7cmV0dXJuIG5ldyBPcGVuTGF5ZXJzLkJvdW5kcyh0aGlzLmxlZnQrYSx0aGlzLmJvdHRvbStiLHRoaXMucmlnaHQrYSx0aGlzLnRvcCtiKX0sZXh0ZW5kOmZ1bmN0aW9uKGEpe3ZhciBiPW51bGw7aWYoYSl7c3dpdGNoKGEuQ0xBU1NfTkFNRSl7Y2FzZSBcIk9wZW5MYXllcnMuTG9uTGF0XCI6Yj1uZXcgT3BlbkxheWVycy5Cb3VuZHMoYS5sb24sYS5sYXQsYS5sb24sYS5sYXQpO2JyZWFrO2Nhc2UgXCJPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50XCI6Yj1uZXcgT3BlbkxheWVycy5Cb3VuZHMoYS54LGEueSxhLngsYS55KTticmVhaztjYXNlIFwiT3BlbkxheWVycy5Cb3VuZHNcIjpiPWF9aWYoYil7dGhpcy5jZW50ZXJMb25MYXQ9bnVsbDtpZihudWxsPT10aGlzLmxlZnR8fGIubGVmdDx0aGlzLmxlZnQpdGhpcy5sZWZ0PVxuYi5sZWZ0O2lmKG51bGw9PXRoaXMuYm90dG9tfHxiLmJvdHRvbTx0aGlzLmJvdHRvbSl0aGlzLmJvdHRvbT1iLmJvdHRvbTtpZihudWxsPT10aGlzLnJpZ2h0fHxiLnJpZ2h0PnRoaXMucmlnaHQpdGhpcy5yaWdodD1iLnJpZ2h0O2lmKG51bGw9PXRoaXMudG9wfHxiLnRvcD50aGlzLnRvcCl0aGlzLnRvcD1iLnRvcH19fSxjb250YWluc0xvbkxhdDpmdW5jdGlvbihhLGIpe1wiYm9vbGVhblwiPT09dHlwZW9mIGImJihiPXtpbmNsdXNpdmU6Yn0pO3ZhciBiPWJ8fHt9LGM9dGhpcy5jb250YWlucyhhLmxvbixhLmxhdCxiLmluY2x1c2l2ZSksZD1iLndvcmxkQm91bmRzO2QmJiFjJiYoYz1kLmdldFdpZHRoKCksZD1NYXRoLnJvdW5kKChhLmxvbi0oZC5sZWZ0K2QucmlnaHQpLzIpL2MpLGM9dGhpcy5jb250YWluc0xvbkxhdCh7bG9uOmEubG9uLWQqYyxsYXQ6YS5sYXR9LHtpbmNsdXNpdmU6Yi5pbmNsdXNpdmV9KSk7cmV0dXJuIGN9LGNvbnRhaW5zUGl4ZWw6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5jb250YWlucyhhLngsXG5hLnksYil9LGNvbnRhaW5zOmZ1bmN0aW9uKGEsYixjKXtudWxsPT1jJiYoYz0hMCk7aWYobnVsbD09YXx8bnVsbD09YilyZXR1cm4hMTt2YXIgYT1PcGVuTGF5ZXJzLlV0aWwudG9GbG9hdChhKSxiPU9wZW5MYXllcnMuVXRpbC50b0Zsb2F0KGIpLGQ9ITE7cmV0dXJuIGQ9Yz9hPj10aGlzLmxlZnQmJmE8PXRoaXMucmlnaHQmJmI+PXRoaXMuYm90dG9tJiZiPD10aGlzLnRvcDphPnRoaXMubGVmdCYmYTx0aGlzLnJpZ2h0JiZiPnRoaXMuYm90dG9tJiZiPHRoaXMudG9wfSxpbnRlcnNlY3RzQm91bmRzOmZ1bmN0aW9uKGEsYil7XCJib29sZWFuXCI9PT10eXBlb2YgYiYmKGI9e2luY2x1c2l2ZTpifSk7Yj1ifHx7fTtpZihiLndvcmxkQm91bmRzKXZhciBjPXRoaXMud3JhcERhdGVMaW5lKGIud29ybGRCb3VuZHMpLGE9YS53cmFwRGF0ZUxpbmUoYi53b3JsZEJvdW5kcyk7ZWxzZSBjPXRoaXM7bnVsbD09Yi5pbmNsdXNpdmUmJihiLmluY2x1c2l2ZT0hMCk7dmFyIGQ9ITEsZT1jLmxlZnQ9PVxuYS5yaWdodHx8Yy5yaWdodD09YS5sZWZ0fHxjLnRvcD09YS5ib3R0b218fGMuYm90dG9tPT1hLnRvcDtpZihiLmluY2x1c2l2ZXx8IWUpdmFyIGQ9YS50b3A+PWMuYm90dG9tJiZhLnRvcDw9Yy50b3B8fGMudG9wPmEuYm90dG9tJiZjLnRvcDxhLnRvcCxlPWEubGVmdD49Yy5sZWZ0JiZhLmxlZnQ8PWMucmlnaHR8fGMubGVmdD49YS5sZWZ0JiZjLmxlZnQ8PWEucmlnaHQsZj1hLnJpZ2h0Pj1jLmxlZnQmJmEucmlnaHQ8PWMucmlnaHR8fGMucmlnaHQ+PWEubGVmdCYmYy5yaWdodDw9YS5yaWdodCxkPShhLmJvdHRvbT49Yy5ib3R0b20mJmEuYm90dG9tPD1jLnRvcHx8Yy5ib3R0b20+PWEuYm90dG9tJiZjLmJvdHRvbTw9YS50b3B8fGQpJiYoZXx8Zik7aWYoYi53b3JsZEJvdW5kcyYmIWQpe3ZhciBnPWIud29ybGRCb3VuZHMsZT1nLmdldFdpZHRoKCksZj0hZy5jb250YWluc0JvdW5kcyhjKSxnPSFnLmNvbnRhaW5zQm91bmRzKGEpO2YmJiFnPyhhPWEuYWRkKC1lLDApLGQ9Yy5pbnRlcnNlY3RzQm91bmRzKGEsXG57aW5jbHVzaXZlOmIuaW5jbHVzaXZlfSkpOmcmJiFmJiYoYz1jLmFkZCgtZSwwKSxkPWEuaW50ZXJzZWN0c0JvdW5kcyhjLHtpbmNsdXNpdmU6Yi5pbmNsdXNpdmV9KSl9cmV0dXJuIGR9LGNvbnRhaW5zQm91bmRzOmZ1bmN0aW9uKGEsYixjKXtudWxsPT1iJiYoYj0hMSk7bnVsbD09YyYmKGM9ITApO3ZhciBkPXRoaXMuY29udGFpbnMoYS5sZWZ0LGEuYm90dG9tLGMpLGU9dGhpcy5jb250YWlucyhhLnJpZ2h0LGEuYm90dG9tLGMpLGY9dGhpcy5jb250YWlucyhhLmxlZnQsYS50b3AsYyksYT10aGlzLmNvbnRhaW5zKGEucmlnaHQsYS50b3AsYyk7cmV0dXJuIGI/ZHx8ZXx8Znx8YTpkJiZlJiZmJiZhfSxkZXRlcm1pbmVRdWFkcmFudDpmdW5jdGlvbihhKXt2YXIgYj1cIlwiLGM9dGhpcy5nZXRDZW50ZXJMb25MYXQoKSxiPWIrKGEubGF0PGMubGF0P1wiYlwiOlwidFwiKTtyZXR1cm4gYis9YS5sb248Yy5sb24/XCJsXCI6XCJyXCJ9LHRyYW5zZm9ybTpmdW5jdGlvbihhLGIpe3RoaXMuY2VudGVyTG9uTGF0PVxubnVsbDt2YXIgYz1PcGVuTGF5ZXJzLlByb2plY3Rpb24udHJhbnNmb3JtKHt4OnRoaXMubGVmdCx5OnRoaXMuYm90dG9tfSxhLGIpLGQ9T3BlbkxheWVycy5Qcm9qZWN0aW9uLnRyYW5zZm9ybSh7eDp0aGlzLnJpZ2h0LHk6dGhpcy5ib3R0b219LGEsYiksZT1PcGVuTGF5ZXJzLlByb2plY3Rpb24udHJhbnNmb3JtKHt4OnRoaXMubGVmdCx5OnRoaXMudG9wfSxhLGIpLGY9T3BlbkxheWVycy5Qcm9qZWN0aW9uLnRyYW5zZm9ybSh7eDp0aGlzLnJpZ2h0LHk6dGhpcy50b3B9LGEsYik7dGhpcy5sZWZ0PU1hdGgubWluKGMueCxlLngpO3RoaXMuYm90dG9tPU1hdGgubWluKGMueSxkLnkpO3RoaXMucmlnaHQ9TWF0aC5tYXgoZC54LGYueCk7dGhpcy50b3A9TWF0aC5tYXgoZS55LGYueSk7cmV0dXJuIHRoaXN9LHdyYXBEYXRlTGluZTpmdW5jdGlvbihhLGIpe3ZhciBiPWJ8fHt9LGM9Yi5sZWZ0VG9sZXJhbmNlfHwwLGQ9Yi5yaWdodFRvbGVyYW5jZXx8MCxlPXRoaXMuY2xvbmUoKTtpZihhKXtmb3IodmFyIGY9XG5hLmdldFdpZHRoKCk7ZS5sZWZ0PGEubGVmdCYmZS5yaWdodC1kPD1hLmxlZnQ7KWU9ZS5hZGQoZiwwKTtmb3IoO2UubGVmdCtjPj1hLnJpZ2h0JiZlLnJpZ2h0PmEucmlnaHQ7KWU9ZS5hZGQoLWYsMCk7Yz1lLmxlZnQrYztjPGEucmlnaHQmJihjPmEubGVmdCYmZS5yaWdodC1kPmEucmlnaHQpJiYoZT1lLmFkZCgtZiwwKSl9cmV0dXJuIGV9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkJvdW5kc1wifSk7T3BlbkxheWVycy5Cb3VuZHMuZnJvbVN0cmluZz1mdW5jdGlvbihhLGIpe3ZhciBjPWEuc3BsaXQoXCIsXCIpO3JldHVybiBPcGVuTGF5ZXJzLkJvdW5kcy5mcm9tQXJyYXkoYyxiKX07T3BlbkxheWVycy5Cb3VuZHMuZnJvbUFycmF5PWZ1bmN0aW9uKGEsYil7cmV0dXJuITA9PT1iP25ldyBPcGVuTGF5ZXJzLkJvdW5kcyhhWzFdLGFbMF0sYVszXSxhWzJdKTpuZXcgT3BlbkxheWVycy5Cb3VuZHMoYVswXSxhWzFdLGFbMl0sYVszXSl9O1xuT3BlbkxheWVycy5Cb3VuZHMuZnJvbVNpemU9ZnVuY3Rpb24oYSl7cmV0dXJuIG5ldyBPcGVuTGF5ZXJzLkJvdW5kcygwLGEuaCxhLncsMCl9O09wZW5MYXllcnMuQm91bmRzLm9wcG9zaXRlUXVhZHJhbnQ9ZnVuY3Rpb24oYSl7dmFyIGI7Yj1cIlwiKyhcInRcIj09YS5jaGFyQXQoMCk/XCJiXCI6XCJ0XCIpO3JldHVybiBiKz1cImxcIj09YS5jaGFyQXQoMSk/XCJyXCI6XCJsXCJ9O09wZW5MYXllcnMuRWxlbWVudD17dmlzaWJsZTpmdW5jdGlvbihhKXtyZXR1cm5cIm5vbmVcIiE9T3BlbkxheWVycy5VdGlsLmdldEVsZW1lbnQoYSkuc3R5bGUuZGlzcGxheX0sdG9nZ2xlOmZ1bmN0aW9uKCl7Zm9yKHZhciBhPTAsYj1hcmd1bWVudHMubGVuZ3RoO2E8YjthKyspe3ZhciBjPU9wZW5MYXllcnMuVXRpbC5nZXRFbGVtZW50KGFyZ3VtZW50c1thXSksZD1PcGVuTGF5ZXJzLkVsZW1lbnQudmlzaWJsZShjKT9cIm5vbmVcIjpcIlwiO2Muc3R5bGUuZGlzcGxheT1kfX0scmVtb3ZlOmZ1bmN0aW9uKGEpe2E9T3BlbkxheWVycy5VdGlsLmdldEVsZW1lbnQoYSk7YS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGEpfSxnZXRIZWlnaHQ6ZnVuY3Rpb24oYSl7YT1PcGVuTGF5ZXJzLlV0aWwuZ2V0RWxlbWVudChhKTtyZXR1cm4gYS5vZmZzZXRIZWlnaHR9LGhhc0NsYXNzOmZ1bmN0aW9uKGEsYil7dmFyIGM9YS5jbGFzc05hbWU7cmV0dXJuISFjJiZSZWdFeHAoXCIoXnxcXFxccylcIitiK1wiKFxcXFxzfCQpXCIpLnRlc3QoYyl9LFxuYWRkQ2xhc3M6ZnVuY3Rpb24oYSxiKXtPcGVuTGF5ZXJzLkVsZW1lbnQuaGFzQ2xhc3MoYSxiKXx8KGEuY2xhc3NOYW1lKz0oYS5jbGFzc05hbWU/XCIgXCI6XCJcIikrYik7cmV0dXJuIGF9LHJlbW92ZUNsYXNzOmZ1bmN0aW9uKGEsYil7dmFyIGM9YS5jbGFzc05hbWU7YyYmKGEuY2xhc3NOYW1lPU9wZW5MYXllcnMuU3RyaW5nLnRyaW0oYy5yZXBsYWNlKFJlZ0V4cChcIihefFxcXFxzKylcIitiK1wiKFxcXFxzK3wkKVwiKSxcIiBcIikpKTtyZXR1cm4gYX0sdG9nZ2xlQ2xhc3M6ZnVuY3Rpb24oYSxiKXtPcGVuTGF5ZXJzLkVsZW1lbnQuaGFzQ2xhc3MoYSxiKT9PcGVuTGF5ZXJzLkVsZW1lbnQucmVtb3ZlQ2xhc3MoYSxiKTpPcGVuTGF5ZXJzLkVsZW1lbnQuYWRkQ2xhc3MoYSxiKTtyZXR1cm4gYX0sZ2V0U3R5bGU6ZnVuY3Rpb24oYSxiKXt2YXIgYT1PcGVuTGF5ZXJzLlV0aWwuZ2V0RWxlbWVudChhKSxjPW51bGw7aWYoYSYmYS5zdHlsZSl7Yz1hLnN0eWxlW09wZW5MYXllcnMuU3RyaW5nLmNhbWVsaXplKGIpXTtcbmN8fChkb2N1bWVudC5kZWZhdWx0VmlldyYmZG9jdW1lbnQuZGVmYXVsdFZpZXcuZ2V0Q29tcHV0ZWRTdHlsZT9jPShjPWRvY3VtZW50LmRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGUoYSxudWxsKSk/Yy5nZXRQcm9wZXJ0eVZhbHVlKGIpOm51bGw6YS5jdXJyZW50U3R5bGUmJihjPWEuY3VycmVudFN0eWxlW09wZW5MYXllcnMuU3RyaW5nLmNhbWVsaXplKGIpXSkpO3ZhciBkPVtcImxlZnRcIixcInRvcFwiLFwicmlnaHRcIixcImJvdHRvbVwiXTt3aW5kb3cub3BlcmEmJigtMSE9T3BlbkxheWVycy5VdGlsLmluZGV4T2YoZCxiKSYmXCJzdGF0aWNcIj09T3BlbkxheWVycy5FbGVtZW50LmdldFN0eWxlKGEsXCJwb3NpdGlvblwiKSkmJihjPVwiYXV0b1wiKX1yZXR1cm5cImF1dG9cIj09Yz9udWxsOmN9fTtPcGVuTGF5ZXJzLkxvbkxhdD1PcGVuTGF5ZXJzLkNsYXNzKHtsb246MCxsYXQ6MCxpbml0aWFsaXplOmZ1bmN0aW9uKGEsYil7T3BlbkxheWVycy5VdGlsLmlzQXJyYXkoYSkmJihiPWFbMV0sYT1hWzBdKTt0aGlzLmxvbj1PcGVuTGF5ZXJzLlV0aWwudG9GbG9hdChhKTt0aGlzLmxhdD1PcGVuTGF5ZXJzLlV0aWwudG9GbG9hdChiKX0sdG9TdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm5cImxvbj1cIit0aGlzLmxvbitcIixsYXQ9XCIrdGhpcy5sYXR9LHRvU2hvcnRTdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sb24rXCIsIFwiK3RoaXMubGF0fSxjbG9uZTpmdW5jdGlvbigpe3JldHVybiBuZXcgT3BlbkxheWVycy5Mb25MYXQodGhpcy5sb24sdGhpcy5sYXQpfSxhZGQ6ZnVuY3Rpb24oYSxiKXtpZihudWxsPT1hfHxudWxsPT1iKXRocm93IG5ldyBUeXBlRXJyb3IoXCJMb25MYXQuYWRkIGNhbm5vdCByZWNlaXZlIG51bGwgdmFsdWVzXCIpO3JldHVybiBuZXcgT3BlbkxheWVycy5Mb25MYXQodGhpcy5sb24rXG5PcGVuTGF5ZXJzLlV0aWwudG9GbG9hdChhKSx0aGlzLmxhdCtPcGVuTGF5ZXJzLlV0aWwudG9GbG9hdChiKSl9LGVxdWFsczpmdW5jdGlvbihhKXt2YXIgYj0hMTtudWxsIT1hJiYoYj10aGlzLmxvbj09YS5sb24mJnRoaXMubGF0PT1hLmxhdHx8aXNOYU4odGhpcy5sb24pJiZpc05hTih0aGlzLmxhdCkmJmlzTmFOKGEubG9uKSYmaXNOYU4oYS5sYXQpKTtyZXR1cm4gYn0sdHJhbnNmb3JtOmZ1bmN0aW9uKGEsYil7dmFyIGM9T3BlbkxheWVycy5Qcm9qZWN0aW9uLnRyYW5zZm9ybSh7eDp0aGlzLmxvbix5OnRoaXMubGF0fSxhLGIpO3RoaXMubG9uPWMueDt0aGlzLmxhdD1jLnk7cmV0dXJuIHRoaXN9LHdyYXBEYXRlTGluZTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNsb25lKCk7aWYoYSl7Zm9yKDtiLmxvbjxhLmxlZnQ7KWIubG9uKz1hLmdldFdpZHRoKCk7Zm9yKDtiLmxvbj5hLnJpZ2h0OyliLmxvbi09YS5nZXRXaWR0aCgpfXJldHVybiBifSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Mb25MYXRcIn0pO1xuT3BlbkxheWVycy5Mb25MYXQuZnJvbVN0cmluZz1mdW5jdGlvbihhKXthPWEuc3BsaXQoXCIsXCIpO3JldHVybiBuZXcgT3BlbkxheWVycy5Mb25MYXQoYVswXSxhWzFdKX07T3BlbkxheWVycy5Mb25MYXQuZnJvbUFycmF5PWZ1bmN0aW9uKGEpe3ZhciBiPU9wZW5MYXllcnMuVXRpbC5pc0FycmF5KGEpO3JldHVybiBuZXcgT3BlbkxheWVycy5Mb25MYXQoYiYmYVswXSxiJiZhWzFdKX07T3BlbkxheWVycy5QaXhlbD1PcGVuTGF5ZXJzLkNsYXNzKHt4OjAseTowLGluaXRpYWxpemU6ZnVuY3Rpb24oYSxiKXt0aGlzLng9cGFyc2VGbG9hdChhKTt0aGlzLnk9cGFyc2VGbG9hdChiKX0sdG9TdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm5cIng9XCIrdGhpcy54K1wiLHk9XCIrdGhpcy55fSxjbG9uZTpmdW5jdGlvbigpe3JldHVybiBuZXcgT3BlbkxheWVycy5QaXhlbCh0aGlzLngsdGhpcy55KX0sZXF1YWxzOmZ1bmN0aW9uKGEpe3ZhciBiPSExO251bGwhPWEmJihiPXRoaXMueD09YS54JiZ0aGlzLnk9PWEueXx8aXNOYU4odGhpcy54KSYmaXNOYU4odGhpcy55KSYmaXNOYU4oYS54KSYmaXNOYU4oYS55KSk7cmV0dXJuIGJ9LGRpc3RhbmNlVG86ZnVuY3Rpb24oYSl7cmV0dXJuIE1hdGguc3FydChNYXRoLnBvdyh0aGlzLngtYS54LDIpK01hdGgucG93KHRoaXMueS1hLnksMikpfSxhZGQ6ZnVuY3Rpb24oYSxiKXtpZihudWxsPT1hfHxudWxsPT1iKXRocm93IG5ldyBUeXBlRXJyb3IoXCJQaXhlbC5hZGQgY2Fubm90IHJlY2VpdmUgbnVsbCB2YWx1ZXNcIik7XG5yZXR1cm4gbmV3IE9wZW5MYXllcnMuUGl4ZWwodGhpcy54K2EsdGhpcy55K2IpfSxvZmZzZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jbG9uZSgpO2EmJihiPXRoaXMuYWRkKGEueCxhLnkpKTtyZXR1cm4gYn0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuUGl4ZWxcIn0pO09wZW5MYXllcnMuU2l6ZT1PcGVuTGF5ZXJzLkNsYXNzKHt3OjAsaDowLGluaXRpYWxpemU6ZnVuY3Rpb24oYSxiKXt0aGlzLnc9cGFyc2VGbG9hdChhKTt0aGlzLmg9cGFyc2VGbG9hdChiKX0sdG9TdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm5cInc9XCIrdGhpcy53K1wiLGg9XCIrdGhpcy5ofSxjbG9uZTpmdW5jdGlvbigpe3JldHVybiBuZXcgT3BlbkxheWVycy5TaXplKHRoaXMudyx0aGlzLmgpfSxlcXVhbHM6ZnVuY3Rpb24oYSl7dmFyIGI9ITE7bnVsbCE9YSYmKGI9dGhpcy53PT1hLncmJnRoaXMuaD09YS5ofHxpc05hTih0aGlzLncpJiZpc05hTih0aGlzLmgpJiZpc05hTihhLncpJiZpc05hTihhLmgpKTtyZXR1cm4gYn0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuU2l6ZVwifSk7T3BlbkxheWVycy5Db25zb2xlPXtsb2c6ZnVuY3Rpb24oKXt9LGRlYnVnOmZ1bmN0aW9uKCl7fSxpbmZvOmZ1bmN0aW9uKCl7fSx3YXJuOmZ1bmN0aW9uKCl7fSxlcnJvcjpmdW5jdGlvbigpe30sdXNlckVycm9yOmZ1bmN0aW9uKGEpe2FsZXJ0KGEpfSxhc3NlcnQ6ZnVuY3Rpb24oKXt9LGRpcjpmdW5jdGlvbigpe30sZGlyeG1sOmZ1bmN0aW9uKCl7fSx0cmFjZTpmdW5jdGlvbigpe30sZ3JvdXA6ZnVuY3Rpb24oKXt9LGdyb3VwRW5kOmZ1bmN0aW9uKCl7fSx0aW1lOmZ1bmN0aW9uKCl7fSx0aW1lRW5kOmZ1bmN0aW9uKCl7fSxwcm9maWxlOmZ1bmN0aW9uKCl7fSxwcm9maWxlRW5kOmZ1bmN0aW9uKCl7fSxjb3VudDpmdW5jdGlvbigpe30sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuQ29uc29sZVwifTtcbihmdW5jdGlvbigpe2Zvcih2YXIgYT1kb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInNjcmlwdFwiKSxiPTAsYz1hLmxlbmd0aDtiPGM7KytiKWlmKC0xIT1hW2JdLnNyYy5pbmRleE9mKFwiZmlyZWJ1Zy5qc1wiKSYmY29uc29sZSl7T3BlbkxheWVycy5VdGlsLmV4dGVuZChPcGVuTGF5ZXJzLkNvbnNvbGUsY29uc29sZSk7YnJlYWt9fSkoKTtPcGVuTGF5ZXJzLkxhbmc9e2NvZGU6bnVsbCxkZWZhdWx0Q29kZTpcImVuXCIsZ2V0Q29kZTpmdW5jdGlvbigpe09wZW5MYXllcnMuTGFuZy5jb2RlfHxPcGVuTGF5ZXJzLkxhbmcuc2V0Q29kZSgpO3JldHVybiBPcGVuTGF5ZXJzLkxhbmcuY29kZX0sc2V0Q29kZTpmdW5jdGlvbihhKXt2YXIgYjthfHwoYT1cIm1zaWVcIj09T3BlbkxheWVycy5CUk9XU0VSX05BTUU/bmF2aWdhdG9yLnVzZXJMYW5ndWFnZTpuYXZpZ2F0b3IubGFuZ3VhZ2UpO2E9YS5zcGxpdChcIi1cIik7YVswXT1hWzBdLnRvTG93ZXJDYXNlKCk7XCJvYmplY3RcIj09dHlwZW9mIE9wZW5MYXllcnMuTGFuZ1thWzBdXSYmKGI9YVswXSk7aWYoYVsxXSl7dmFyIGM9YVswXStcIi1cIithWzFdLnRvVXBwZXJDYXNlKCk7XCJvYmplY3RcIj09dHlwZW9mIE9wZW5MYXllcnMuTGFuZ1tjXSYmKGI9Yyl9Ynx8KE9wZW5MYXllcnMuQ29uc29sZS53YXJuKFwiRmFpbGVkIHRvIGZpbmQgT3BlbkxheWVycy5MYW5nLlwiK2Euam9pbihcIi1cIikrXCIgZGljdGlvbmFyeSwgZmFsbGluZyBiYWNrIHRvIGRlZmF1bHQgbGFuZ3VhZ2VcIiksXG5iPU9wZW5MYXllcnMuTGFuZy5kZWZhdWx0Q29kZSk7T3BlbkxheWVycy5MYW5nLmNvZGU9Yn0sdHJhbnNsYXRlOmZ1bmN0aW9uKGEsYil7dmFyIGM9T3BlbkxheWVycy5MYW5nW09wZW5MYXllcnMuTGFuZy5nZXRDb2RlKCldOyhjPWMmJmNbYV0pfHwoYz1hKTtiJiYoYz1PcGVuTGF5ZXJzLlN0cmluZy5mb3JtYXQoYyxiKSk7cmV0dXJuIGN9fTtPcGVuTGF5ZXJzLmkxOG49T3BlbkxheWVycy5MYW5nLnRyYW5zbGF0ZTtPcGVuTGF5ZXJzLlV0aWw9T3BlbkxheWVycy5VdGlsfHx7fTtPcGVuTGF5ZXJzLlV0aWwuZ2V0RWxlbWVudD1mdW5jdGlvbigpe2Zvcih2YXIgYT1bXSxiPTAsYz1hcmd1bWVudHMubGVuZ3RoO2I8YztiKyspe3ZhciBkPWFyZ3VtZW50c1tiXTtcInN0cmluZ1wiPT10eXBlb2YgZCYmKGQ9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZCkpO2lmKDE9PWFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuIGQ7YS5wdXNoKGQpfXJldHVybiBhfTtPcGVuTGF5ZXJzLlV0aWwuaXNFbGVtZW50PWZ1bmN0aW9uKGEpe3JldHVybiEhKGEmJjE9PT1hLm5vZGVUeXBlKX07T3BlbkxheWVycy5VdGlsLmlzQXJyYXk9ZnVuY3Rpb24oYSl7cmV0dXJuXCJbb2JqZWN0IEFycmF5XVwiPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGEpfTtcInVuZGVmaW5lZFwiPT09dHlwZW9mIHdpbmRvdy4kJiYod2luZG93LiQ9T3BlbkxheWVycy5VdGlsLmdldEVsZW1lbnQpO1xuT3BlbkxheWVycy5VdGlsLnJlbW92ZUl0ZW09ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9YS5sZW5ndGgtMTtjPj0wO2MtLSlhW2NdPT1iJiZhLnNwbGljZShjLDEpO3JldHVybiBhfTtPcGVuTGF5ZXJzLlV0aWwuaW5kZXhPZj1mdW5jdGlvbihhLGIpe2lmKHR5cGVvZiBhLmluZGV4T2Y9PVwiZnVuY3Rpb25cIilyZXR1cm4gYS5pbmRleE9mKGIpO2Zvcih2YXIgYz0wLGQ9YS5sZW5ndGg7YzxkO2MrKylpZihhW2NdPT1iKXJldHVybiBjO3JldHVybi0xfTtcbk9wZW5MYXllcnMuVXRpbC5tb2RpZnlET01FbGVtZW50PWZ1bmN0aW9uKGEsYixjLGQsZSxmLGcsaCl7aWYoYilhLmlkPWI7aWYoYyl7YS5zdHlsZS5sZWZ0PWMueCtcInB4XCI7YS5zdHlsZS50b3A9Yy55K1wicHhcIn1pZihkKXthLnN0eWxlLndpZHRoPWQudytcInB4XCI7YS5zdHlsZS5oZWlnaHQ9ZC5oK1wicHhcIn1pZihlKWEuc3R5bGUucG9zaXRpb249ZTtpZihmKWEuc3R5bGUuYm9yZGVyPWY7aWYoZylhLnN0eWxlLm92ZXJmbG93PWc7aWYocGFyc2VGbG9hdChoKT49MCYmcGFyc2VGbG9hdChoKTwxKXthLnN0eWxlLmZpbHRlcj1cImFscGhhKG9wYWNpdHk9XCIraCoxMDArXCIpXCI7YS5zdHlsZS5vcGFjaXR5PWh9ZWxzZSBpZihwYXJzZUZsb2F0KGgpPT0xKXthLnN0eWxlLmZpbHRlcj1cIlwiO2Euc3R5bGUub3BhY2l0eT1cIlwifX07XG5PcGVuTGF5ZXJzLlV0aWwuY3JlYXRlRGl2PWZ1bmN0aW9uKGEsYixjLGQsZSxmLGcsaCl7dmFyIGk9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtpZihkKWkuc3R5bGUuYmFja2dyb3VuZEltYWdlPVwidXJsKFwiK2QrXCIpXCI7YXx8KGE9T3BlbkxheWVycy5VdGlsLmNyZWF0ZVVuaXF1ZUlEKFwiT3BlbkxheWVyc0RpdlwiKSk7ZXx8KGU9XCJhYnNvbHV0ZVwiKTtPcGVuTGF5ZXJzLlV0aWwubW9kaWZ5RE9NRWxlbWVudChpLGEsYixjLGUsZixnLGgpO3JldHVybiBpfTtcbk9wZW5MYXllcnMuVXRpbC5jcmVhdGVJbWFnZT1mdW5jdGlvbihhLGIsYyxkLGUsZixnLGgpe3ZhciBpPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbWdcIik7YXx8KGE9T3BlbkxheWVycy5VdGlsLmNyZWF0ZVVuaXF1ZUlEKFwiT3BlbkxheWVyc0RpdlwiKSk7ZXx8KGU9XCJyZWxhdGl2ZVwiKTtPcGVuTGF5ZXJzLlV0aWwubW9kaWZ5RE9NRWxlbWVudChpLGEsYixjLGUsZixudWxsLGcpO2lmKGgpe2kuc3R5bGUuZGlzcGxheT1cIm5vbmVcIjtiPWZ1bmN0aW9uKCl7aS5zdHlsZS5kaXNwbGF5PVwiXCI7T3BlbkxheWVycy5FdmVudC5zdG9wT2JzZXJ2aW5nRWxlbWVudChpKX07T3BlbkxheWVycy5FdmVudC5vYnNlcnZlKGksXCJsb2FkXCIsYik7T3BlbkxheWVycy5FdmVudC5vYnNlcnZlKGksXCJlcnJvclwiLGIpfWkuc3R5bGUuYWx0PWE7aS5nYWxsZXJ5SW1nPVwibm9cIjtpZihkKWkuc3JjPWQ7cmV0dXJuIGl9O09wZW5MYXllcnMuSU1BR0VfUkVMT0FEX0FUVEVNUFRTPTA7XG5PcGVuTGF5ZXJzLlV0aWwuYWxwaGFIYWNrTmVlZGVkPW51bGw7T3BlbkxheWVycy5VdGlsLmFscGhhSGFjaz1mdW5jdGlvbigpe2lmKE9wZW5MYXllcnMuVXRpbC5hbHBoYUhhY2tOZWVkZWQ9PW51bGwpe3ZhciBhPW5hdmlnYXRvci5hcHBWZXJzaW9uLnNwbGl0KFwiTVNJRVwiKSxhPXBhcnNlRmxvYXQoYVsxXSksYj1mYWxzZTt0cnl7Yj0hIWRvY3VtZW50LmJvZHkuZmlsdGVyc31jYXRjaChjKXt9T3BlbkxheWVycy5VdGlsLmFscGhhSGFja05lZWRlZD1iJiZhPj01LjUmJmE8N31yZXR1cm4gT3BlbkxheWVycy5VdGlsLmFscGhhSGFja05lZWRlZH07XG5PcGVuTGF5ZXJzLlV0aWwubW9kaWZ5QWxwaGFJbWFnZURpdj1mdW5jdGlvbihhLGIsYyxkLGUsZixnLGgsaSl7T3BlbkxheWVycy5VdGlsLm1vZGlmeURPTUVsZW1lbnQoYSxiLGMsZCxmLG51bGwsbnVsbCxpKTtiPWEuY2hpbGROb2Rlc1swXTtpZihlKWIuc3JjPWU7T3BlbkxheWVycy5VdGlsLm1vZGlmeURPTUVsZW1lbnQoYixhLmlkK1wiX2lubmVySW1hZ2VcIixudWxsLGQsXCJyZWxhdGl2ZVwiLGcpO2lmKE9wZW5MYXllcnMuVXRpbC5hbHBoYUhhY2soKSl7aWYoYS5zdHlsZS5kaXNwbGF5IT1cIm5vbmVcIilhLnN0eWxlLmRpc3BsYXk9XCJpbmxpbmUtYmxvY2tcIjtoPT1udWxsJiYoaD1cInNjYWxlXCIpO2Euc3R5bGUuZmlsdGVyPVwicHJvZ2lkOkRYSW1hZ2VUcmFuc2Zvcm0uTWljcm9zb2Z0LkFscGhhSW1hZ2VMb2FkZXIoc3JjPSdcIitiLnNyYytcIicsIHNpemluZ01ldGhvZD0nXCIraCtcIicpXCI7aWYocGFyc2VGbG9hdChhLnN0eWxlLm9wYWNpdHkpPj0wJiZwYXJzZUZsb2F0KGEuc3R5bGUub3BhY2l0eSk8XG4xKWEuc3R5bGUuZmlsdGVyPWEuc3R5bGUuZmlsdGVyKyhcIiBhbHBoYShvcGFjaXR5PVwiK2Euc3R5bGUub3BhY2l0eSoxMDArXCIpXCIpO2Iuc3R5bGUuZmlsdGVyPVwiYWxwaGEob3BhY2l0eT0wKVwifX07T3BlbkxheWVycy5VdGlsLmNyZWF0ZUFscGhhSW1hZ2VEaXY9ZnVuY3Rpb24oYSxiLGMsZCxlLGYsZyxoLGkpe3ZhciBqPU9wZW5MYXllcnMuVXRpbC5jcmVhdGVEaXYoKSxpPU9wZW5MYXllcnMuVXRpbC5jcmVhdGVJbWFnZShudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLGkpO2kuY2xhc3NOYW1lPVwib2xBbHBoYUltZ1wiO2ouYXBwZW5kQ2hpbGQoaSk7T3BlbkxheWVycy5VdGlsLm1vZGlmeUFscGhhSW1hZ2VEaXYoaixhLGIsYyxkLGUsZixnLGgpO3JldHVybiBqfTtPcGVuTGF5ZXJzLlV0aWwudXBwZXJDYXNlT2JqZWN0PWZ1bmN0aW9uKGEpe3ZhciBiPXt9LGM7Zm9yKGMgaW4gYSliW2MudG9VcHBlckNhc2UoKV09YVtjXTtyZXR1cm4gYn07XG5PcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cz1mdW5jdGlvbihhLGIpe3ZhciBhPWF8fHt9LGM9dHlwZW9mIHdpbmRvdy5FdmVudD09XCJmdW5jdGlvblwiJiZiIGluc3RhbmNlb2Ygd2luZG93LkV2ZW50LGQ7Zm9yKGQgaW4gYilpZihhW2RdPT09dm9pZCAwfHwhYyYmYi5oYXNPd25Qcm9wZXJ0eSYmYi5oYXNPd25Qcm9wZXJ0eShkKSYmIWEuaGFzT3duUHJvcGVydHkoZCkpYVtkXT1iW2RdO2lmKCFjJiZiJiZiLmhhc093blByb3BlcnR5JiZiLmhhc093blByb3BlcnR5KFwidG9TdHJpbmdcIikmJiFhLmhhc093blByb3BlcnR5KFwidG9TdHJpbmdcIikpYS50b1N0cmluZz1iLnRvU3RyaW5nO3JldHVybiBhfTtcbk9wZW5MYXllcnMuVXRpbC5nZXRQYXJhbWV0ZXJTdHJpbmc9ZnVuY3Rpb24oYSl7dmFyIGI9W10sYztmb3IoYyBpbiBhKXt2YXIgZD1hW2NdO2lmKGQhPW51bGwmJnR5cGVvZiBkIT1cImZ1bmN0aW9uXCIpe2lmKHR5cGVvZiBkPT1cIm9iamVjdFwiJiZkLmNvbnN0cnVjdG9yPT1BcnJheSl7Zm9yKHZhciBlPVtdLGYsZz0wLGg9ZC5sZW5ndGg7ZzxoO2crKyl7Zj1kW2ddO2UucHVzaChlbmNvZGVVUklDb21wb25lbnQoZj09PW51bGx8fGY9PT12b2lkIDA/XCJcIjpmKSl9ZD1lLmpvaW4oXCIsXCIpfWVsc2UgZD1lbmNvZGVVUklDb21wb25lbnQoZCk7Yi5wdXNoKGVuY29kZVVSSUNvbXBvbmVudChjKStcIj1cIitkKX19cmV0dXJuIGIuam9pbihcIiZcIil9O09wZW5MYXllcnMuVXRpbC51cmxBcHBlbmQ9ZnVuY3Rpb24oYSxiKXt2YXIgYz1hO2lmKGIpdmFyIGQ9KGErXCIgXCIpLnNwbGl0KC9bPyZdLyksYz1jKyhkLnBvcCgpPT09XCIgXCI/YjpkLmxlbmd0aD9cIiZcIitiOlwiP1wiK2IpO3JldHVybiBjfTtcbk9wZW5MYXllcnMuVXRpbC5nZXRJbWFnZXNMb2NhdGlvbj1mdW5jdGlvbigpe3JldHVybiBPcGVuTGF5ZXJzLkltZ1BhdGh8fE9wZW5MYXllcnMuX2dldFNjcmlwdExvY2F0aW9uKCkrXCJpbWcvXCJ9O09wZW5MYXllcnMuVXRpbC5nZXRJbWFnZUxvY2F0aW9uPWZ1bmN0aW9uKGEpe3JldHVybiBPcGVuTGF5ZXJzLlV0aWwuZ2V0SW1hZ2VzTG9jYXRpb24oKSthfTtPcGVuTGF5ZXJzLlV0aWwuVHJ5PWZ1bmN0aW9uKCl7Zm9yKHZhciBhPW51bGwsYj0wLGM9YXJndW1lbnRzLmxlbmd0aDtiPGM7YisrKXt2YXIgZD1hcmd1bWVudHNbYl07dHJ5e2E9ZCgpO2JyZWFrfWNhdGNoKGUpe319cmV0dXJuIGF9O1xuT3BlbkxheWVycy5VdGlsLmdldFhtbE5vZGVWYWx1ZT1mdW5jdGlvbihhKXt2YXIgYj1udWxsO09wZW5MYXllcnMuVXRpbC5UcnkoZnVuY3Rpb24oKXtiPWEudGV4dDtpZighYiliPWEudGV4dENvbnRlbnQ7aWYoIWIpYj1hLmZpcnN0Q2hpbGQubm9kZVZhbHVlfSxmdW5jdGlvbigpe2I9YS50ZXh0Q29udGVudH0pO3JldHVybiBifTtPcGVuTGF5ZXJzLlV0aWwubW91c2VMZWZ0PWZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPWEucmVsYXRlZFRhcmdldD9hLnJlbGF0ZWRUYXJnZXQ6YS50b0VsZW1lbnQ7YyE9YiYmYyE9bnVsbDspYz1jLnBhcmVudE5vZGU7cmV0dXJuIGMhPWJ9O09wZW5MYXllcnMuVXRpbC5ERUZBVUxUX1BSRUNJU0lPTj0xNDtcbk9wZW5MYXllcnMuVXRpbC50b0Zsb2F0PWZ1bmN0aW9uKGEsYil7aWYoYj09bnVsbCliPU9wZW5MYXllcnMuVXRpbC5ERUZBVUxUX1BSRUNJU0lPTjt0eXBlb2YgYSE9PVwibnVtYmVyXCImJihhPXBhcnNlRmxvYXQoYSkpO3JldHVybiBiPT09MD9hOnBhcnNlRmxvYXQoYS50b1ByZWNpc2lvbihiKSl9O09wZW5MYXllcnMuVXRpbC5yYWQ9ZnVuY3Rpb24oYSl7cmV0dXJuIGEqTWF0aC5QSS8xODB9O09wZW5MYXllcnMuVXRpbC5kZWc9ZnVuY3Rpb24oYSl7cmV0dXJuIGEqMTgwL01hdGguUEl9O09wZW5MYXllcnMuVXRpbC5WaW5jZW50eUNvbnN0YW50cz17YTo2Mzc4MTM3LGI6NjM1Njc1Mi4zMTQyLGY6MS8yOTguMjU3MjIzNTYzfTtcbk9wZW5MYXllcnMuVXRpbC5kaXN0VmluY2VudHk9ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9T3BlbkxheWVycy5VdGlsLlZpbmNlbnR5Q29uc3RhbnRzLGQ9Yy5hLGU9Yy5iLGM9Yy5mLGY9T3BlbkxheWVycy5VdGlsLnJhZChiLmxvbi1hLmxvbiksZz1NYXRoLmF0YW4oKDEtYykqTWF0aC50YW4oT3BlbkxheWVycy5VdGlsLnJhZChhLmxhdCkpKSxoPU1hdGguYXRhbigoMS1jKSpNYXRoLnRhbihPcGVuTGF5ZXJzLlV0aWwucmFkKGIubGF0KSkpLGk9TWF0aC5zaW4oZyksZz1NYXRoLmNvcyhnKSxqPU1hdGguc2luKGgpLGg9TWF0aC5jb3MoaCksaz1mLGw9MipNYXRoLlBJLG09MjA7TWF0aC5hYnMoay1sKT4xLjBFLTEyJiYtLW0+MDspe3ZhciBuPU1hdGguc2luKGspLG89TWF0aC5jb3MoaykscD1NYXRoLnNxcnQoaCpuKmgqbisoZypqLWkqaCpvKSooZypqLWkqaCpvKSk7aWYocD09MClyZXR1cm4gMDt2YXIgbz1pKmorZypoKm8scT1NYXRoLmF0YW4yKHAsbykscj1NYXRoLmFzaW4oZypcbmgqbi9wKSxzPU1hdGguY29zKHIpKk1hdGguY29zKHIpLG49by0yKmkqai9zLHQ9Yy8xNipzKig0K2MqKDQtMypzKSksbD1rLGs9ZisoMS10KSpjKk1hdGguc2luKHIpKihxK3QqcCoobit0Km8qKC0xKzIqbipuKSkpfWlmKG09PTApcmV0dXJuIE5hTjtkPXMqKGQqZC1lKmUpLyhlKmUpO2M9ZC8xMDI0KigyNTYrZCooLTEyOCtkKig3NC00NypkKSkpO3JldHVybihlKigxK2QvMTYzODQqKDQwOTYrZCooLTc2OCtkKigzMjAtMTc1KmQpKSkpKihxLWMqcCoobitjLzQqKG8qKC0xKzIqbipuKS1jLzYqbiooLTMrNCpwKnApKigtMys0Km4qbikpKSkpLnRvRml4ZWQoMykvMUUzfTtcbk9wZW5MYXllcnMuVXRpbC5kZXN0aW5hdGlvblZpbmNlbnR5PWZ1bmN0aW9uKGEsYixjKXtmb3IodmFyIGQ9T3BlbkxheWVycy5VdGlsLGU9ZC5WaW5jZW50eUNvbnN0YW50cyxmPWUuYSxnPWUuYixoPWUuZixlPWEubG9uLGE9YS5sYXQsaT1kLnJhZChiKSxiPU1hdGguc2luKGkpLGk9TWF0aC5jb3MoaSksYT0oMS1oKSpNYXRoLnRhbihkLnJhZChhKSksaj0xL01hdGguc3FydCgxK2EqYSksaz1hKmosbD1NYXRoLmF0YW4yKGEsaSksYT1qKmIsbT0xLWEqYSxmPW0qKGYqZi1nKmcpLyhnKmcpLG49MStmLzE2Mzg0Kig0MDk2K2YqKC03NjgrZiooMzIwLTE3NSpmKSkpLG89Zi8xMDI0KigyNTYrZiooLTEyOCtmKig3NC00NypmKSkpLGY9Yy8oZypuKSxwPTIqTWF0aC5QSTtNYXRoLmFicyhmLXApPjEuMEUtMTI7KXZhciBxPU1hdGguY29zKDIqbCtmKSxyPU1hdGguc2luKGYpLHM9TWF0aC5jb3MoZiksdD1vKnIqKHErby80KihzKigtMSsyKnEqcSktby82KnEqKC0zKzQqcipyKSooLTMrNCpcbnEqcSkpKSxwPWYsZj1jLyhnKm4pK3Q7Yz1rKnItaipzKmk7Zz1NYXRoLmF0YW4yKGsqcytqKnIqaSwoMS1oKSpNYXRoLnNxcnQoYSphK2MqYykpO2I9TWF0aC5hdGFuMihyKmIsaipzLWsqcippKTtpPWgvMTYqbSooNCtoKig0LTMqbSkpO3E9Yi0oMS1pKSpoKmEqKGYraSpyKihxK2kqcyooLTErMipxKnEpKSk7TWF0aC5hdGFuMihhLC1jKTtyZXR1cm4gbmV3IE9wZW5MYXllcnMuTG9uTGF0KGUrZC5kZWcocSksZC5kZWcoZykpfTtcbk9wZW5MYXllcnMuVXRpbC5nZXRQYXJhbWV0ZXJzPWZ1bmN0aW9uKGEpe3ZhciBhPWE9PT1udWxsfHxhPT09dm9pZCAwP3dpbmRvdy5sb2NhdGlvbi5ocmVmOmEsYj1cIlwiO2lmKE9wZW5MYXllcnMuU3RyaW5nLmNvbnRhaW5zKGEsXCI/XCIpKXZhciBiPWEuaW5kZXhPZihcIj9cIikrMSxjPU9wZW5MYXllcnMuU3RyaW5nLmNvbnRhaW5zKGEsXCIjXCIpP2EuaW5kZXhPZihcIiNcIik6YS5sZW5ndGgsYj1hLnN1YnN0cmluZyhiLGMpO2Zvcih2YXIgYT17fSxiPWIuc3BsaXQoL1smO10vKSxjPTAsZD1iLmxlbmd0aDtjPGQ7KytjKXt2YXIgZT1iW2NdLnNwbGl0KFwiPVwiKTtpZihlWzBdKXt2YXIgZj1lWzBdO3RyeXtmPWRlY29kZVVSSUNvbXBvbmVudChmKX1jYXRjaChnKXtmPXVuZXNjYXBlKGYpfWU9KGVbMV18fFwiXCIpLnJlcGxhY2UoL1xcKy9nLFwiIFwiKTt0cnl7ZT1kZWNvZGVVUklDb21wb25lbnQoZSl9Y2F0Y2goaCl7ZT11bmVzY2FwZShlKX1lPWUuc3BsaXQoXCIsXCIpO2UubGVuZ3RoPT0xJiYoZT1lWzBdKTtcbmFbZl09ZX19cmV0dXJuIGF9O09wZW5MYXllcnMuVXRpbC5sYXN0U2VxSUQ9MDtPcGVuTGF5ZXJzLlV0aWwuY3JlYXRlVW5pcXVlSUQ9ZnVuY3Rpb24oYSl7YT09bnVsbCYmKGE9XCJpZF9cIik7T3BlbkxheWVycy5VdGlsLmxhc3RTZXFJRD1PcGVuTGF5ZXJzLlV0aWwubGFzdFNlcUlEKzE7cmV0dXJuIGErT3BlbkxheWVycy5VdGlsLmxhc3RTZXFJRH07T3BlbkxheWVycy5JTkNIRVNfUEVSX1VOSVQ9e2luY2hlczoxLGZ0OjEyLG1pOjYzMzYwLG06MzkuMzcwMSxrbTozOTM3MC4xLGRkOjQzNzQ3NTQseWQ6MzZ9O09wZW5MYXllcnMuSU5DSEVTX1BFUl9VTklUW1wiaW5cIl09T3BlbkxheWVycy5JTkNIRVNfUEVSX1VOSVQuaW5jaGVzO09wZW5MYXllcnMuSU5DSEVTX1BFUl9VTklULmRlZ3JlZXM9T3BlbkxheWVycy5JTkNIRVNfUEVSX1VOSVQuZGQ7T3BlbkxheWVycy5JTkNIRVNfUEVSX1VOSVQubm1pPTE4NTIqT3BlbkxheWVycy5JTkNIRVNfUEVSX1VOSVQubTtcbk9wZW5MYXllcnMuTUVURVJTX1BFUl9JTkNIPTAuMDI1NDAwMDUwODAwMTAxNjtcbk9wZW5MYXllcnMuVXRpbC5leHRlbmQoT3BlbkxheWVycy5JTkNIRVNfUEVSX1VOSVQse0luY2g6T3BlbkxheWVycy5JTkNIRVNfUEVSX1VOSVQuaW5jaGVzLE1ldGVyOjEvT3BlbkxheWVycy5NRVRFUlNfUEVSX0lOQ0gsRm9vdDowLjMwNDgwMDYwOTYwMTIxOTIvT3BlbkxheWVycy5NRVRFUlNfUEVSX0lOQ0gsSUZvb3Q6MC4zMDQ4L09wZW5MYXllcnMuTUVURVJTX1BFUl9JTkNILENsYXJrZUZvb3Q6MC4zMDQ3OTcyNjUxMTUxL09wZW5MYXllcnMuTUVURVJTX1BFUl9JTkNILFNlYXJzRm9vdDowLjMwNDc5OTQ3MTUzODY3NjI2L09wZW5MYXllcnMuTUVURVJTX1BFUl9JTkNILEdvbGRDb2FzdEZvb3Q6MC4zMDQ3OTk3MTAxODE1MDg4L09wZW5MYXllcnMuTUVURVJTX1BFUl9JTkNILElJbmNoOjAuMDI1NC9PcGVuTGF5ZXJzLk1FVEVSU19QRVJfSU5DSCxNaWNyb0luY2g6Mi41NEUtNS9PcGVuTGF5ZXJzLk1FVEVSU19QRVJfSU5DSCxNaWw6Mi41NEUtOC9PcGVuTGF5ZXJzLk1FVEVSU19QRVJfSU5DSCxcbkNlbnRpbWV0ZXI6MC4wMS9PcGVuTGF5ZXJzLk1FVEVSU19QRVJfSU5DSCxLaWxvbWV0ZXI6MUUzL09wZW5MYXllcnMuTUVURVJTX1BFUl9JTkNILFlhcmQ6MC45MTQ0MDE4Mjg4MDM2NTc2L09wZW5MYXllcnMuTUVURVJTX1BFUl9JTkNILFNlYXJzWWFyZDowLjkxNDM5ODQxNDYxNjAyOS9PcGVuTGF5ZXJzLk1FVEVSU19QRVJfSU5DSCxJbmRpYW5ZYXJkOjAuOTE0Mzk4NTMwNzQ0NDQwOC9PcGVuTGF5ZXJzLk1FVEVSU19QRVJfSU5DSCxJbmRpYW5ZZDM3OjAuOTE0Mzk1MjMvT3BlbkxheWVycy5NRVRFUlNfUEVSX0lOQ0gsSW5kaWFuWWQ2MjowLjkxNDM5ODgvT3BlbkxheWVycy5NRVRFUlNfUEVSX0lOQ0gsSW5kaWFuWWQ3NTowLjkxNDM5ODUvT3BlbkxheWVycy5NRVRFUlNfUEVSX0lOQ0gsSW5kaWFuRm9vdDowLjMwNDc5OTUxL09wZW5MYXllcnMuTUVURVJTX1BFUl9JTkNILEluZGlhbkZ0Mzc6MC4zMDQ3OTg0MS9PcGVuTGF5ZXJzLk1FVEVSU19QRVJfSU5DSCxJbmRpYW5GdDYyOjAuMzA0Nzk5Ni9cbk9wZW5MYXllcnMuTUVURVJTX1BFUl9JTkNILEluZGlhbkZ0NzU6MC4zMDQ3OTk1L09wZW5MYXllcnMuTUVURVJTX1BFUl9JTkNILE1pbGU6MTYwOS4zNDcyMTg2OTQ0MzczL09wZW5MYXllcnMuTUVURVJTX1BFUl9JTkNILElZYXJkOjAuOTE0NC9PcGVuTGF5ZXJzLk1FVEVSU19QRVJfSU5DSCxJTWlsZToxNjA5LjM0NC9PcGVuTGF5ZXJzLk1FVEVSU19QRVJfSU5DSCxOYXV0TToxODUyL09wZW5MYXllcnMuTUVURVJTX1BFUl9JTkNILFwiTGF0LTY2XCI6MTEwOTQzLjMxNjQ4ODkzMjczL09wZW5MYXllcnMuTUVURVJTX1BFUl9JTkNILFwiTGF0LTgzXCI6MTEwOTQ2LjI1NzM2ODcyMjM1L09wZW5MYXllcnMuTUVURVJTX1BFUl9JTkNILERlY2ltZXRlcjowLjEvT3BlbkxheWVycy5NRVRFUlNfUEVSX0lOQ0gsTWlsbGltZXRlcjowLjAwMS9PcGVuTGF5ZXJzLk1FVEVSU19QRVJfSU5DSCxEZWthbWV0ZXI6MTAvT3BlbkxheWVycy5NRVRFUlNfUEVSX0lOQ0gsRGVjYW1ldGVyOjEwL09wZW5MYXllcnMuTUVURVJTX1BFUl9JTkNILFxuSGVjdG9tZXRlcjoxMDAvT3BlbkxheWVycy5NRVRFUlNfUEVSX0lOQ0gsR2VybWFuTWV0ZXI6MS4wMDAwMTM1OTY1L09wZW5MYXllcnMuTUVURVJTX1BFUl9JTkNILENhR3JpZDowLjk5OTczOC9PcGVuTGF5ZXJzLk1FVEVSU19QRVJfSU5DSCxDbGFya2VDaGFpbjoyMC4xMTY2MTk0OTc2L09wZW5MYXllcnMuTUVURVJTX1BFUl9JTkNILEd1bnRlckNoYWluOjIwLjExNjg0MDIzMzY4MDQ3L09wZW5MYXllcnMuTUVURVJTX1BFUl9JTkNILEJlbm9pdENoYWluOjIwLjExNjc4MjQ5NDM3NTg3Mi9PcGVuTGF5ZXJzLk1FVEVSU19QRVJfSU5DSCxTZWFyc0NoYWluOjIwLjExNjc2NTEyMTU1L09wZW5MYXllcnMuTUVURVJTX1BFUl9JTkNILENsYXJrZUxpbms6MC4yMDExNjYxOTQ5NzYvT3BlbkxheWVycy5NRVRFUlNfUEVSX0lOQ0gsR3VudGVyTGluazowLjIwMTE2ODQwMjMzNjgwNDcvT3BlbkxheWVycy5NRVRFUlNfUEVSX0lOQ0gsQmVub2l0TGluazowLjIwMTE2NzgyNDk0Mzc1ODczL09wZW5MYXllcnMuTUVURVJTX1BFUl9JTkNILFxuU2VhcnNMaW5rOjAuMjAxMTY3NjUxMjE1NS9PcGVuTGF5ZXJzLk1FVEVSU19QRVJfSU5DSCxSb2Q6NS4wMjkyMTAwNTg0MjAxMi9PcGVuTGF5ZXJzLk1FVEVSU19QRVJfSU5DSCxJbnRubENoYWluOjIwLjExNjgvT3BlbkxheWVycy5NRVRFUlNfUEVSX0lOQ0gsSW50bmxMaW5rOjAuMjAxMTY4L09wZW5MYXllcnMuTUVURVJTX1BFUl9JTkNILFBlcmNoOjUuMDI5MjEwMDU4NDIwMTIvT3BlbkxheWVycy5NRVRFUlNfUEVSX0lOQ0gsUG9sZTo1LjAyOTIxMDA1ODQyMDEyL09wZW5MYXllcnMuTUVURVJTX1BFUl9JTkNILEZ1cmxvbmc6MjAxLjE2ODQwMjMzNjgwNDYvT3BlbkxheWVycy5NRVRFUlNfUEVSX0lOQ0gsUm9vZDozLjc3ODI2Njg5OC9PcGVuTGF5ZXJzLk1FVEVSU19QRVJfSU5DSCxDYXBlRm9vdDowLjMwNDc5NzI2MTUvT3BlbkxheWVycy5NRVRFUlNfUEVSX0lOQ0gsQnJlYWxleTozNzUvT3BlbkxheWVycy5NRVRFUlNfUEVSX0lOQ0gsTW9kQW1GdDowLjMwNDgxMjI1Mjk4NDUwNi9cbk9wZW5MYXllcnMuTUVURVJTX1BFUl9JTkNILEZhdGhvbToxLjgyODgvT3BlbkxheWVycy5NRVRFUlNfUEVSX0lOQ0gsXCJOYXV0TS1VS1wiOjE4NTMuMTg0L09wZW5MYXllcnMuTUVURVJTX1BFUl9JTkNILFwiNTBraWxvbWV0ZXJzXCI6NUU0L09wZW5MYXllcnMuTUVURVJTX1BFUl9JTkNILFwiMTUwa2lsb21ldGVyc1wiOjE1RTQvT3BlbkxheWVycy5NRVRFUlNfUEVSX0lOQ0h9KTtcbk9wZW5MYXllcnMuVXRpbC5leHRlbmQoT3BlbkxheWVycy5JTkNIRVNfUEVSX1VOSVQse21tOk9wZW5MYXllcnMuSU5DSEVTX1BFUl9VTklULk1ldGVyLzFFMyxjbTpPcGVuTGF5ZXJzLklOQ0hFU19QRVJfVU5JVC5NZXRlci8xMDAsZG06MTAwKk9wZW5MYXllcnMuSU5DSEVTX1BFUl9VTklULk1ldGVyLGttOjFFMypPcGVuTGF5ZXJzLklOQ0hFU19QRVJfVU5JVC5NZXRlcixrbWk6T3BlbkxheWVycy5JTkNIRVNfUEVSX1VOSVQubm1pLGZhdGg6T3BlbkxheWVycy5JTkNIRVNfUEVSX1VOSVQuRmF0aG9tLGNoOk9wZW5MYXllcnMuSU5DSEVTX1BFUl9VTklULkludG5sQ2hhaW4sbGluazpPcGVuTGF5ZXJzLklOQ0hFU19QRVJfVU5JVC5JbnRubExpbmssXCJ1cy1pblwiOk9wZW5MYXllcnMuSU5DSEVTX1BFUl9VTklULmluY2hlcyxcInVzLWZ0XCI6T3BlbkxheWVycy5JTkNIRVNfUEVSX1VOSVQuRm9vdCxcInVzLXlkXCI6T3BlbkxheWVycy5JTkNIRVNfUEVSX1VOSVQuWWFyZCxcInVzLWNoXCI6T3BlbkxheWVycy5JTkNIRVNfUEVSX1VOSVQuR3VudGVyQ2hhaW4sXG5cInVzLW1pXCI6T3BlbkxheWVycy5JTkNIRVNfUEVSX1VOSVQuTWlsZSxcImluZC15ZFwiOk9wZW5MYXllcnMuSU5DSEVTX1BFUl9VTklULkluZGlhbllkMzcsXCJpbmQtZnRcIjpPcGVuTGF5ZXJzLklOQ0hFU19QRVJfVU5JVC5JbmRpYW5GdDM3LFwiaW5kLWNoXCI6MjAuMTE2Njk1MDYvT3BlbkxheWVycy5NRVRFUlNfUEVSX0lOQ0h9KTtPcGVuTGF5ZXJzLkRPVFNfUEVSX0lOQ0g9NzI7T3BlbkxheWVycy5VdGlsLm5vcm1hbGl6ZVNjYWxlPWZ1bmN0aW9uKGEpe3JldHVybiBhPjE/MS9hOmF9O09wZW5MYXllcnMuVXRpbC5nZXRSZXNvbHV0aW9uRnJvbVNjYWxlPWZ1bmN0aW9uKGEsYil7dmFyIGM7aWYoYSl7Yj09bnVsbCYmKGI9XCJkZWdyZWVzXCIpO2M9MS8oT3BlbkxheWVycy5VdGlsLm5vcm1hbGl6ZVNjYWxlKGEpKk9wZW5MYXllcnMuSU5DSEVTX1BFUl9VTklUW2JdKk9wZW5MYXllcnMuRE9UU19QRVJfSU5DSCl9cmV0dXJuIGN9O1xuT3BlbkxheWVycy5VdGlsLmdldFNjYWxlRnJvbVJlc29sdXRpb249ZnVuY3Rpb24oYSxiKXtiPT1udWxsJiYoYj1cImRlZ3JlZXNcIik7cmV0dXJuIGEqT3BlbkxheWVycy5JTkNIRVNfUEVSX1VOSVRbYl0qT3BlbkxheWVycy5ET1RTX1BFUl9JTkNIfTtcbk9wZW5MYXllcnMuVXRpbC5wYWdlUG9zaXRpb249ZnVuY3Rpb24oYSl7dmFyIGI9WzAsMF0sYz1PcGVuTGF5ZXJzLlV0aWwuZ2V0Vmlld3BvcnRFbGVtZW50KCk7aWYoIWF8fGE9PXdpbmRvd3x8YT09YylyZXR1cm4gYjt2YXIgZD1PcGVuTGF5ZXJzLklTX0dFQ0tPJiZkb2N1bWVudC5nZXRCb3hPYmplY3RGb3ImJk9wZW5MYXllcnMuRWxlbWVudC5nZXRTdHlsZShhLFwicG9zaXRpb25cIik9PVwiYWJzb2x1dGVcIiYmKGEuc3R5bGUudG9wPT1cIlwifHxhLnN0eWxlLmxlZnQ9PVwiXCIpLGU9bnVsbDtpZihhLmdldEJvdW5kaW5nQ2xpZW50UmVjdCl7YT1hLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO2U9Yy5zY3JvbGxUb3A7YlswXT1hLmxlZnQrYy5zY3JvbGxMZWZ0O2JbMV09YS50b3ArZX1lbHNlIGlmKGRvY3VtZW50LmdldEJveE9iamVjdEZvciYmIWQpe2E9ZG9jdW1lbnQuZ2V0Qm94T2JqZWN0Rm9yKGEpO2M9ZG9jdW1lbnQuZ2V0Qm94T2JqZWN0Rm9yKGMpO2JbMF09YS5zY3JlZW5YLWMuc2NyZWVuWDtcbmJbMV09YS5zY3JlZW5ZLWMuc2NyZWVuWX1lbHNle2JbMF09YS5vZmZzZXRMZWZ0O2JbMV09YS5vZmZzZXRUb3A7ZT1hLm9mZnNldFBhcmVudDtpZihlIT1hKWZvcig7ZTspe2JbMF09YlswXStlLm9mZnNldExlZnQ7YlsxXT1iWzFdK2Uub2Zmc2V0VG9wO2U9ZS5vZmZzZXRQYXJlbnR9Yz1PcGVuTGF5ZXJzLkJST1dTRVJfTkFNRTtpZihjPT1cIm9wZXJhXCJ8fGM9PVwic2FmYXJpXCImJk9wZW5MYXllcnMuRWxlbWVudC5nZXRTdHlsZShhLFwicG9zaXRpb25cIik9PVwiYWJzb2x1dGVcIiliWzFdPWJbMV0tZG9jdW1lbnQuYm9keS5vZmZzZXRUb3A7Zm9yKGU9YS5vZmZzZXRQYXJlbnQ7ZSYmZSE9ZG9jdW1lbnQuYm9keTspe2JbMF09YlswXS1lLnNjcm9sbExlZnQ7aWYoYyE9XCJvcGVyYVwifHxlLnRhZ05hbWUhPVwiVFJcIiliWzFdPWJbMV0tZS5zY3JvbGxUb3A7ZT1lLm9mZnNldFBhcmVudH19cmV0dXJuIGJ9O1xuT3BlbkxheWVycy5VdGlsLmdldFZpZXdwb3J0RWxlbWVudD1mdW5jdGlvbigpe3ZhciBhPWFyZ3VtZW50cy5jYWxsZWUudmlld3BvcnRFbGVtZW50O2lmKGE9PXZvaWQgMCl7YT1PcGVuTGF5ZXJzLkJST1dTRVJfTkFNRT09XCJtc2llXCImJmRvY3VtZW50LmNvbXBhdE1vZGUhPVwiQ1NTMUNvbXBhdFwiP2RvY3VtZW50LmJvZHk6ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50O2FyZ3VtZW50cy5jYWxsZWUudmlld3BvcnRFbGVtZW50PWF9cmV0dXJuIGF9O1xuT3BlbkxheWVycy5VdGlsLmlzRXF1aXZhbGVudFVybD1mdW5jdGlvbihhLGIsYyl7Yz1jfHx7fTtPcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyhjLHtpZ25vcmVDYXNlOnRydWUsaWdub3JlUG9ydDgwOnRydWUsaWdub3JlSGFzaDp0cnVlfSk7dmFyIGE9T3BlbkxheWVycy5VdGlsLmNyZWF0ZVVybE9iamVjdChhLGMpLGI9T3BlbkxheWVycy5VdGlsLmNyZWF0ZVVybE9iamVjdChiLGMpLGQ7Zm9yKGQgaW4gYSlpZihkIT09XCJhcmdzXCImJmFbZF0hPWJbZF0pcmV0dXJuIGZhbHNlO2ZvcihkIGluIGEuYXJncyl7aWYoYS5hcmdzW2RdIT1iLmFyZ3NbZF0pcmV0dXJuIGZhbHNlO2RlbGV0ZSBiLmFyZ3NbZF19Zm9yKGQgaW4gYi5hcmdzKXJldHVybiBmYWxzZTtyZXR1cm4gdHJ1ZX07XG5PcGVuTGF5ZXJzLlV0aWwuY3JlYXRlVXJsT2JqZWN0PWZ1bmN0aW9uKGEsYil7Yj1ifHx7fTtpZighL15cXHcrOlxcL1xcLy8udGVzdChhKSl7dmFyIGM9d2luZG93LmxvY2F0aW9uLGQ9Yy5wb3J0P1wiOlwiK2MucG9ydDpcIlwiLGQ9Yy5wcm90b2NvbCtcIi8vXCIrYy5ob3N0LnNwbGl0KFwiOlwiKS5zaGlmdCgpK2Q7aWYoYS5pbmRleE9mKFwiL1wiKT09PTApYT1kK2E7ZWxzZXtjPWMucGF0aG5hbWUuc3BsaXQoXCIvXCIpO2MucG9wKCk7YT1kK2Muam9pbihcIi9cIikrXCIvXCIrYX19Yi5pZ25vcmVDYXNlJiYoYT1hLnRvTG93ZXJDYXNlKCkpO2M9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIik7Yy5ocmVmPWE7ZD17fTtkLmhvc3Q9Yy5ob3N0LnNwbGl0KFwiOlwiKS5zaGlmdCgpO2QucHJvdG9jb2w9Yy5wcm90b2NvbDtkLnBvcnQ9Yi5pZ25vcmVQb3J0ODA/Yy5wb3J0PT1cIjgwXCJ8fGMucG9ydD09XCIwXCI/XCJcIjpjLnBvcnQ6Yy5wb3J0PT1cIlwifHxjLnBvcnQ9PVwiMFwiP1wiODBcIjpjLnBvcnQ7ZC5oYXNoPWIuaWdub3JlSGFzaHx8XG5jLmhhc2g9PT1cIiNcIj9cIlwiOmMuaGFzaDt2YXIgZT1jLnNlYXJjaDtpZighZSl7ZT1hLmluZGV4T2YoXCI/XCIpO2U9ZSE9LTE/YS5zdWJzdHIoZSk6XCJcIn1kLmFyZ3M9T3BlbkxheWVycy5VdGlsLmdldFBhcmFtZXRlcnMoZSk7ZC5wYXRobmFtZT1jLnBhdGhuYW1lLmNoYXJBdCgwKT09XCIvXCI/Yy5wYXRobmFtZTpcIi9cIitjLnBhdGhuYW1lO3JldHVybiBkfTtPcGVuTGF5ZXJzLlV0aWwucmVtb3ZlVGFpbD1mdW5jdGlvbihhKXt2YXIgYj1udWxsLGI9YS5pbmRleE9mKFwiP1wiKSxjPWEuaW5kZXhPZihcIiNcIik7cmV0dXJuIGI9Yj09LTE/YyE9LTE/YS5zdWJzdHIoMCxjKTphOmMhPS0xP2Euc3Vic3RyKDAsTWF0aC5taW4oYixjKSk6YS5zdWJzdHIoMCxiKX07T3BlbkxheWVycy5JU19HRUNLTz1mdW5jdGlvbigpe3ZhciBhPW5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKTtyZXR1cm4gYS5pbmRleE9mKFwid2Via2l0XCIpPT0tMSYmYS5pbmRleE9mKFwiZ2Vja29cIikhPS0xfSgpO1xuT3BlbkxheWVycy5DQU5WQVNfU1VQUE9SVEVEPWZ1bmN0aW9uKCl7dmFyIGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKTtyZXR1cm4hKCFhLmdldENvbnRleHR8fCFhLmdldENvbnRleHQoXCIyZFwiKSl9KCk7T3BlbkxheWVycy5CUk9XU0VSX05BTUU9ZnVuY3Rpb24oKXt2YXIgYT1cIlwiLGI9bmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpO2IuaW5kZXhPZihcIm9wZXJhXCIpIT0tMT9hPVwib3BlcmFcIjpiLmluZGV4T2YoXCJtc2llXCIpIT0tMT9hPVwibXNpZVwiOmIuaW5kZXhPZihcInNhZmFyaVwiKSE9LTE/YT1cInNhZmFyaVwiOmIuaW5kZXhPZihcIm1vemlsbGFcIikhPS0xJiYoYT1iLmluZGV4T2YoXCJmaXJlZm94XCIpIT0tMT9cImZpcmVmb3hcIjpcIm1vemlsbGFcIik7cmV0dXJuIGF9KCk7T3BlbkxheWVycy5VdGlsLmdldEJyb3dzZXJOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuIE9wZW5MYXllcnMuQlJPV1NFUl9OQU1FfTtcbk9wZW5MYXllcnMuVXRpbC5nZXRSZW5kZXJlZERpbWVuc2lvbnM9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGUsZj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO2Yuc3R5bGUudmlzaWJpbGl0eT1cImhpZGRlblwiO2Zvcih2YXIgZz1jJiZjLmNvbnRhaW5lckVsZW1lbnQ/Yy5jb250YWluZXJFbGVtZW50OmRvY3VtZW50LmJvZHksaD1mYWxzZSxpPW51bGwsaj1nO2omJmoudGFnTmFtZS50b0xvd2VyQ2FzZSgpIT1cImJvZHlcIjspe3ZhciBrPU9wZW5MYXllcnMuRWxlbWVudC5nZXRTdHlsZShqLFwicG9zaXRpb25cIik7aWYoaz09XCJhYnNvbHV0ZVwiKXtoPXRydWU7YnJlYWt9ZWxzZSBpZihrJiZrIT1cInN0YXRpY1wiKWJyZWFrO2o9ai5wYXJlbnROb2RlfWlmKGgmJihnLmNsaWVudEhlaWdodD09PTB8fGcuY2xpZW50V2lkdGg9PT0wKSl7aT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO2kuc3R5bGUudmlzaWJpbGl0eT1cImhpZGRlblwiO2kuc3R5bGUucG9zaXRpb249XCJhYnNvbHV0ZVwiO1xuaS5zdHlsZS5vdmVyZmxvdz1cInZpc2libGVcIjtpLnN0eWxlLndpZHRoPWRvY3VtZW50LmJvZHkuY2xpZW50V2lkdGgrXCJweFwiO2kuc3R5bGUuaGVpZ2h0PWRvY3VtZW50LmJvZHkuY2xpZW50SGVpZ2h0K1wicHhcIjtpLmFwcGVuZENoaWxkKGYpfWYuc3R5bGUucG9zaXRpb249XCJhYnNvbHV0ZVwiO2lmKGIpaWYoYi53KXtkPWIudztmLnN0eWxlLndpZHRoPWQrXCJweFwifWVsc2UgaWYoYi5oKXtlPWIuaDtmLnN0eWxlLmhlaWdodD1lK1wicHhcIn1pZihjJiZjLmRpc3BsYXlDbGFzcylmLmNsYXNzTmFtZT1jLmRpc3BsYXlDbGFzcztiPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7Yi5pbm5lckhUTUw9YTtiLnN0eWxlLm92ZXJmbG93PVwidmlzaWJsZVwiO2lmKGIuY2hpbGROb2Rlcyl7YT0wO2ZvcihjPWIuY2hpbGROb2Rlcy5sZW5ndGg7YTxjO2ErKylpZihiLmNoaWxkTm9kZXNbYV0uc3R5bGUpYi5jaGlsZE5vZGVzW2FdLnN0eWxlLm92ZXJmbG93PVwidmlzaWJsZVwifWYuYXBwZW5kQ2hpbGQoYik7XG5pP2cuYXBwZW5kQ2hpbGQoaSk6Zy5hcHBlbmRDaGlsZChmKTtpZighZCl7ZD1wYXJzZUludChiLnNjcm9sbFdpZHRoKTtmLnN0eWxlLndpZHRoPWQrXCJweFwifWV8fChlPXBhcnNlSW50KGIuc2Nyb2xsSGVpZ2h0KSk7Zi5yZW1vdmVDaGlsZChiKTtpZihpKXtpLnJlbW92ZUNoaWxkKGYpO2cucmVtb3ZlQ2hpbGQoaSl9ZWxzZSBnLnJlbW92ZUNoaWxkKGYpO3JldHVybiBuZXcgT3BlbkxheWVycy5TaXplKGQsZSl9O1xuT3BlbkxheWVycy5VdGlsLmdldFNjcm9sbGJhcldpZHRoPWZ1bmN0aW9uKCl7dmFyIGE9T3BlbkxheWVycy5VdGlsLl9zY3JvbGxiYXJXaWR0aDtpZihhPT1udWxsKXt2YXIgYj1udWxsLGM9bnVsbCxiPWE9MCxiPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7Yi5zdHlsZS5wb3NpdGlvbj1cImFic29sdXRlXCI7Yi5zdHlsZS50b3A9XCItMTAwMHB4XCI7Yi5zdHlsZS5sZWZ0PVwiLTEwMDBweFwiO2Iuc3R5bGUud2lkdGg9XCIxMDBweFwiO2Iuc3R5bGUuaGVpZ2h0PVwiNTBweFwiO2Iuc3R5bGUub3ZlcmZsb3c9XCJoaWRkZW5cIjtjPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7Yy5zdHlsZS53aWR0aD1cIjEwMCVcIjtjLnN0eWxlLmhlaWdodD1cIjIwMHB4XCI7Yi5hcHBlbmRDaGlsZChjKTtkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGIpO2E9Yy5vZmZzZXRXaWR0aDtiLnN0eWxlLm92ZXJmbG93PVwic2Nyb2xsXCI7Yj1jLm9mZnNldFdpZHRoO2RvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZG9jdW1lbnQuYm9keS5sYXN0Q2hpbGQpO1xuT3BlbkxheWVycy5VdGlsLl9zY3JvbGxiYXJXaWR0aD1hLWI7YT1PcGVuTGF5ZXJzLlV0aWwuX3Njcm9sbGJhcldpZHRofXJldHVybiBhfTtcbk9wZW5MYXllcnMuVXRpbC5nZXRGb3JtYXR0ZWRMb25MYXQ9ZnVuY3Rpb24oYSxiLGMpe2N8fChjPVwiZG1zXCIpO3ZhciBhPShhKzU0MCklMzYwLTE4MCxkPU1hdGguYWJzKGEpLGU9TWF0aC5mbG9vcihkKSxmPWQ9KGQtZSkvKDEvNjApLGQ9TWF0aC5mbG9vcihkKSxmPU1hdGgucm91bmQoKGYtZCkvKDEvNjApKjEwKSxmPWYvMTA7aWYoZj49NjApe2Y9Zi02MDtkPWQrMTtpZihkPj02MCl7ZD1kLTYwO2U9ZSsxfX1lPDEwJiYoZT1cIjBcIitlKTtlPWUrXCJcXHUwMGIwXCI7aWYoYy5pbmRleE9mKFwiZG1cIik+PTApe2Q8MTAmJihkPVwiMFwiK2QpO2U9ZSsoZCtcIidcIik7aWYoYy5pbmRleE9mKFwiZG1zXCIpPj0wKXtmPDEwJiYoZj1cIjBcIitmKTtlPWUrKGYrJ1wiJyl9fXJldHVybiBlPWI9PVwibG9uXCI/ZSsoYTwwP09wZW5MYXllcnMuaTE4bihcIldcIik6T3BlbkxheWVycy5pMThuKFwiRVwiKSk6ZSsoYTwwP09wZW5MYXllcnMuaTE4bihcIlNcIik6T3BlbkxheWVycy5pMThuKFwiTlwiKSl9O09wZW5MYXllcnMuRm9ybWF0PU9wZW5MYXllcnMuQ2xhc3Moe29wdGlvbnM6bnVsbCxleHRlcm5hbFByb2plY3Rpb246bnVsbCxpbnRlcm5hbFByb2plY3Rpb246bnVsbCxkYXRhOm51bGwsa2VlcERhdGE6ITEsaW5pdGlhbGl6ZTpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHRoaXMsYSk7dGhpcy5vcHRpb25zPWF9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt9LHJlYWQ6ZnVuY3Rpb24oKXt0aHJvdyBFcnJvcihcIlJlYWQgbm90IGltcGxlbWVudGVkLlwiKTt9LHdyaXRlOmZ1bmN0aW9uKCl7dGhyb3cgRXJyb3IoXCJXcml0ZSBub3QgaW1wbGVtZW50ZWQuXCIpO30sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuRm9ybWF0XCJ9KTtPcGVuTGF5ZXJzLkZvcm1hdC5DU1dHZXRSZWNvcmRzPWZ1bmN0aW9uKGEpe3ZhciBhPU9wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKGEsT3BlbkxheWVycy5Gb3JtYXQuQ1NXR2V0UmVjb3Jkcy5ERUZBVUxUUyksYj1PcGVuTGF5ZXJzLkZvcm1hdC5DU1dHZXRSZWNvcmRzW1widlwiK2EudmVyc2lvbi5yZXBsYWNlKC9cXC4vZyxcIl9cIildO2lmKCFiKXRocm93XCJVbnN1cHBvcnRlZCBDU1dHZXRSZWNvcmRzIHZlcnNpb246IFwiK2EudmVyc2lvbjtyZXR1cm4gbmV3IGIoYSl9O09wZW5MYXllcnMuRm9ybWF0LkNTV0dldFJlY29yZHMuREVGQVVMVFM9e3ZlcnNpb246XCIyLjAuMlwifTtPcGVuTGF5ZXJzLkNvbnRyb2w9T3BlbkxheWVycy5DbGFzcyh7aWQ6bnVsbCxtYXA6bnVsbCxkaXY6bnVsbCx0eXBlOm51bGwsYWxsb3dTZWxlY3Rpb246ITEsZGlzcGxheUNsYXNzOlwiXCIsdGl0bGU6XCJcIixhdXRvQWN0aXZhdGU6ITEsYWN0aXZlOm51bGwsaGFuZGxlcjpudWxsLGV2ZW50TGlzdGVuZXJzOm51bGwsZXZlbnRzOm51bGwsaW5pdGlhbGl6ZTpmdW5jdGlvbihhKXt0aGlzLmRpc3BsYXlDbGFzcz10aGlzLkNMQVNTX05BTUUucmVwbGFjZShcIk9wZW5MYXllcnMuXCIsXCJvbFwiKS5yZXBsYWNlKC9cXC4vZyxcIlwiKTtPcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHRoaXMsYSk7dGhpcy5ldmVudHM9bmV3IE9wZW5MYXllcnMuRXZlbnRzKHRoaXMpO2lmKHRoaXMuZXZlbnRMaXN0ZW5lcnMgaW5zdGFuY2VvZiBPYmplY3QpdGhpcy5ldmVudHMub24odGhpcy5ldmVudExpc3RlbmVycyk7bnVsbD09dGhpcy5pZCYmKHRoaXMuaWQ9T3BlbkxheWVycy5VdGlsLmNyZWF0ZVVuaXF1ZUlEKHRoaXMuQ0xBU1NfTkFNRStcblwiX1wiKSl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLmV2ZW50cyYmKHRoaXMuZXZlbnRMaXN0ZW5lcnMmJnRoaXMuZXZlbnRzLnVuKHRoaXMuZXZlbnRMaXN0ZW5lcnMpLHRoaXMuZXZlbnRzLmRlc3Ryb3koKSx0aGlzLmV2ZW50cz1udWxsKTt0aGlzLmV2ZW50TGlzdGVuZXJzPW51bGw7dGhpcy5oYW5kbGVyJiYodGhpcy5oYW5kbGVyLmRlc3Ryb3koKSx0aGlzLmhhbmRsZXI9bnVsbCk7aWYodGhpcy5oYW5kbGVycyl7Zm9yKHZhciBhIGluIHRoaXMuaGFuZGxlcnMpdGhpcy5oYW5kbGVycy5oYXNPd25Qcm9wZXJ0eShhKSYmXCJmdW5jdGlvblwiPT10eXBlb2YgdGhpcy5oYW5kbGVyc1thXS5kZXN0cm95JiZ0aGlzLmhhbmRsZXJzW2FdLmRlc3Ryb3koKTt0aGlzLmhhbmRsZXJzPW51bGx9dGhpcy5tYXAmJih0aGlzLm1hcC5yZW1vdmVDb250cm9sKHRoaXMpLHRoaXMubWFwPW51bGwpO3RoaXMuZGl2PW51bGx9LHNldE1hcDpmdW5jdGlvbihhKXt0aGlzLm1hcD1hO3RoaXMuaGFuZGxlciYmXG50aGlzLmhhbmRsZXIuc2V0TWFwKGEpfSxkcmF3OmZ1bmN0aW9uKGEpe2lmKG51bGw9PXRoaXMuZGl2JiYodGhpcy5kaXY9T3BlbkxheWVycy5VdGlsLmNyZWF0ZURpdih0aGlzLmlkKSx0aGlzLmRpdi5jbGFzc05hbWU9dGhpcy5kaXNwbGF5Q2xhc3MsdGhpcy5hbGxvd1NlbGVjdGlvbnx8KHRoaXMuZGl2LmNsYXNzTmFtZSs9XCIgb2xDb250cm9sTm9TZWxlY3RcIix0aGlzLmRpdi5zZXRBdHRyaWJ1dGUoXCJ1bnNlbGVjdGFibGVcIixcIm9uXCIsMCksdGhpcy5kaXYub25zZWxlY3RzdGFydD1PcGVuTGF5ZXJzLkZ1bmN0aW9uLkZhbHNlKSxcIlwiIT10aGlzLnRpdGxlKSl0aGlzLmRpdi50aXRsZT10aGlzLnRpdGxlO251bGwhPWEmJih0aGlzLnBvc2l0aW9uPWEuY2xvbmUoKSk7dGhpcy5tb3ZlVG8odGhpcy5wb3NpdGlvbik7cmV0dXJuIHRoaXMuZGl2fSxtb3ZlVG86ZnVuY3Rpb24oYSl7bnVsbCE9YSYmbnVsbCE9dGhpcy5kaXYmJih0aGlzLmRpdi5zdHlsZS5sZWZ0PWEueCtcInB4XCIsdGhpcy5kaXYuc3R5bGUudG9wPVxuYS55K1wicHhcIil9LGFjdGl2YXRlOmZ1bmN0aW9uKCl7aWYodGhpcy5hY3RpdmUpcmV0dXJuITE7dGhpcy5oYW5kbGVyJiZ0aGlzLmhhbmRsZXIuYWN0aXZhdGUoKTt0aGlzLmFjdGl2ZT0hMDt0aGlzLm1hcCYmT3BlbkxheWVycy5FbGVtZW50LmFkZENsYXNzKHRoaXMubWFwLnZpZXdQb3J0RGl2LHRoaXMuZGlzcGxheUNsYXNzLnJlcGxhY2UoLyAvZyxcIlwiKStcIkFjdGl2ZVwiKTt0aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJhY3RpdmF0ZVwiKTtyZXR1cm4hMH0sZGVhY3RpdmF0ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmFjdGl2ZT8odGhpcy5oYW5kbGVyJiZ0aGlzLmhhbmRsZXIuZGVhY3RpdmF0ZSgpLHRoaXMuYWN0aXZlPSExLHRoaXMubWFwJiZPcGVuTGF5ZXJzLkVsZW1lbnQucmVtb3ZlQ2xhc3ModGhpcy5tYXAudmlld1BvcnREaXYsdGhpcy5kaXNwbGF5Q2xhc3MucmVwbGFjZSgvIC9nLFwiXCIpK1wiQWN0aXZlXCIpLHRoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcImRlYWN0aXZhdGVcIiksXG4hMCk6ITF9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkNvbnRyb2xcIn0pO09wZW5MYXllcnMuQ29udHJvbC5UWVBFX0JVVFRPTj0xO09wZW5MYXllcnMuQ29udHJvbC5UWVBFX1RPR0dMRT0yO09wZW5MYXllcnMuQ29udHJvbC5UWVBFX1RPT0w9MztPcGVuTGF5ZXJzLkV2ZW50PXtvYnNlcnZlcnM6ITEsS0VZX1NQQUNFOjMyLEtFWV9CQUNLU1BBQ0U6OCxLRVlfVEFCOjksS0VZX1JFVFVSTjoxMyxLRVlfRVNDOjI3LEtFWV9MRUZUOjM3LEtFWV9VUDozOCxLRVlfUklHSFQ6MzksS0VZX0RPV046NDAsS0VZX0RFTEVURTo0NixlbGVtZW50OmZ1bmN0aW9uKGEpe3JldHVybiBhLnRhcmdldHx8YS5zcmNFbGVtZW50fSxpc1NpbmdsZVRvdWNoOmZ1bmN0aW9uKGEpe3JldHVybiBhLnRvdWNoZXMmJjE9PWEudG91Y2hlcy5sZW5ndGh9LGlzTXVsdGlUb3VjaDpmdW5jdGlvbihhKXtyZXR1cm4gYS50b3VjaGVzJiYxPGEudG91Y2hlcy5sZW5ndGh9LGlzTGVmdENsaWNrOmZ1bmN0aW9uKGEpe3JldHVybiBhLndoaWNoJiYxPT1hLndoaWNofHxhLmJ1dHRvbiYmMT09YS5idXR0b259LGlzUmlnaHRDbGljazpmdW5jdGlvbihhKXtyZXR1cm4gYS53aGljaCYmMz09YS53aGljaHx8YS5idXR0b24mJjI9PWEuYnV0dG9ufSxzdG9wOmZ1bmN0aW9uKGEsXG5iKXtifHwoYS5wcmV2ZW50RGVmYXVsdD9hLnByZXZlbnREZWZhdWx0KCk6YS5yZXR1cm5WYWx1ZT0hMSk7YS5zdG9wUHJvcGFnYXRpb24/YS5zdG9wUHJvcGFnYXRpb24oKTphLmNhbmNlbEJ1YmJsZT0hMH0sZmluZEVsZW1lbnQ6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9T3BlbkxheWVycy5FdmVudC5lbGVtZW50KGEpO2MucGFyZW50Tm9kZSYmKCFjLnRhZ05hbWV8fGMudGFnTmFtZS50b1VwcGVyQ2FzZSgpIT1iLnRvVXBwZXJDYXNlKCkpOyljPWMucGFyZW50Tm9kZTtyZXR1cm4gY30sb2JzZXJ2ZTpmdW5jdGlvbihhLGIsYyxkKXthPU9wZW5MYXllcnMuVXRpbC5nZXRFbGVtZW50KGEpO2Q9ZHx8ITE7aWYoXCJrZXlwcmVzc1wiPT1iJiYobmF2aWdhdG9yLmFwcFZlcnNpb24ubWF0Y2goL0tvbnF1ZXJvcnxTYWZhcml8S0hUTUwvKXx8YS5hdHRhY2hFdmVudCkpYj1cImtleWRvd25cIjt0aGlzLm9ic2VydmVyc3x8KHRoaXMub2JzZXJ2ZXJzPXt9KTtpZighYS5fZXZlbnRDYWNoZUlEKXt2YXIgZT1cblwiZXZlbnRDYWNoZUlEX1wiO2EuaWQmJihlPWEuaWQrXCJfXCIrZSk7YS5fZXZlbnRDYWNoZUlEPU9wZW5MYXllcnMuVXRpbC5jcmVhdGVVbmlxdWVJRChlKX1lPWEuX2V2ZW50Q2FjaGVJRDt0aGlzLm9ic2VydmVyc1tlXXx8KHRoaXMub2JzZXJ2ZXJzW2VdPVtdKTt0aGlzLm9ic2VydmVyc1tlXS5wdXNoKHtlbGVtZW50OmEsbmFtZTpiLG9ic2VydmVyOmMsdXNlQ2FwdHVyZTpkfSk7YS5hZGRFdmVudExpc3RlbmVyP2EuYWRkRXZlbnRMaXN0ZW5lcihiLGMsZCk6YS5hdHRhY2hFdmVudCYmYS5hdHRhY2hFdmVudChcIm9uXCIrYixjKX0sc3RvcE9ic2VydmluZ0VsZW1lbnQ6ZnVuY3Rpb24oYSl7YT1PcGVuTGF5ZXJzLlV0aWwuZ2V0RWxlbWVudChhKS5fZXZlbnRDYWNoZUlEO3RoaXMuX3JlbW92ZUVsZW1lbnRPYnNlcnZlcnMoT3BlbkxheWVycy5FdmVudC5vYnNlcnZlcnNbYV0pfSxfcmVtb3ZlRWxlbWVudE9ic2VydmVyczpmdW5jdGlvbihhKXtpZihhKWZvcih2YXIgYj1hLmxlbmd0aC0xOzA8PVxuYjtiLS0pe3ZhciBjPWFbYl07T3BlbkxheWVycy5FdmVudC5zdG9wT2JzZXJ2aW5nLmFwcGx5KHRoaXMsW2MuZWxlbWVudCxjLm5hbWUsYy5vYnNlcnZlcixjLnVzZUNhcHR1cmVdKX19LHN0b3BPYnNlcnZpbmc6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGQ9ZHx8ITEsYT1PcGVuTGF5ZXJzLlV0aWwuZ2V0RWxlbWVudChhKSxlPWEuX2V2ZW50Q2FjaGVJRDtpZihcImtleXByZXNzXCI9PWImJihuYXZpZ2F0b3IuYXBwVmVyc2lvbi5tYXRjaCgvS29ucXVlcm9yfFNhZmFyaXxLSFRNTC8pfHxhLmRldGFjaEV2ZW50KSliPVwia2V5ZG93blwiO3ZhciBmPSExLGc9T3BlbkxheWVycy5FdmVudC5vYnNlcnZlcnNbZV07aWYoZylmb3IodmFyIGg9MDshZiYmaDxnLmxlbmd0aDspe3ZhciBpPWdbaF07aWYoaS5uYW1lPT1iJiZpLm9ic2VydmVyPT1jJiZpLnVzZUNhcHR1cmU9PWQpe2cuc3BsaWNlKGgsMSk7MD09Zy5sZW5ndGgmJmRlbGV0ZSBPcGVuTGF5ZXJzLkV2ZW50Lm9ic2VydmVyc1tlXTtmPSEwO1xuYnJlYWt9aCsrfWYmJihhLnJlbW92ZUV2ZW50TGlzdGVuZXI/YS5yZW1vdmVFdmVudExpc3RlbmVyKGIsYyxkKTphJiZhLmRldGFjaEV2ZW50JiZhLmRldGFjaEV2ZW50KFwib25cIitiLGMpKTtyZXR1cm4gZn0sdW5sb2FkQ2FjaGU6ZnVuY3Rpb24oKXtpZihPcGVuTGF5ZXJzLkV2ZW50JiZPcGVuTGF5ZXJzLkV2ZW50Lm9ic2VydmVycyl7Zm9yKHZhciBhIGluIE9wZW5MYXllcnMuRXZlbnQub2JzZXJ2ZXJzKU9wZW5MYXllcnMuRXZlbnQuX3JlbW92ZUVsZW1lbnRPYnNlcnZlcnMuYXBwbHkodGhpcyxbT3BlbkxheWVycy5FdmVudC5vYnNlcnZlcnNbYV1dKTtPcGVuTGF5ZXJzLkV2ZW50Lm9ic2VydmVycz0hMX19LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkV2ZW50XCJ9O09wZW5MYXllcnMuRXZlbnQub2JzZXJ2ZSh3aW5kb3csXCJ1bmxvYWRcIixPcGVuTGF5ZXJzLkV2ZW50LnVubG9hZENhY2hlLCExKTtcbk9wZW5MYXllcnMuRXZlbnRzPU9wZW5MYXllcnMuQ2xhc3Moe0JST1dTRVJfRVZFTlRTOlwibW91c2VvdmVyIG1vdXNlb3V0IG1vdXNlZG93biBtb3VzZXVwIG1vdXNlbW92ZSBjbGljayBkYmxjbGljayByaWdodGNsaWNrIGRibHJpZ2h0Y2xpY2sgcmVzaXplIGZvY3VzIGJsdXIgdG91Y2hzdGFydCB0b3VjaG1vdmUgdG91Y2hlbmQga2V5ZG93blwiLnNwbGl0KFwiIFwiKSxsaXN0ZW5lcnM6bnVsbCxvYmplY3Q6bnVsbCxlbGVtZW50Om51bGwsZXZlbnRIYW5kbGVyOm51bGwsZmFsbFRocm91Z2g6bnVsbCxpbmNsdWRlWFk6ITEsZXh0ZW5zaW9uczpudWxsLGV4dGVuc2lvbkNvdW50Om51bGwsY2xlYXJNb3VzZUxpc3RlbmVyOm51bGwsaW5pdGlhbGl6ZTpmdW5jdGlvbihhLGIsYyxkLGUpe09wZW5MYXllcnMuVXRpbC5leHRlbmQodGhpcyxlKTt0aGlzLm9iamVjdD1hO3RoaXMuZmFsbFRocm91Z2g9ZDt0aGlzLmxpc3RlbmVycz17fTt0aGlzLmV4dGVuc2lvbnM9e307dGhpcy5leHRlbnNpb25Db3VudD1cbnt9O251bGwhPWImJnRoaXMuYXR0YWNoVG9FbGVtZW50KGIpfSxkZXN0cm95OmZ1bmN0aW9uKCl7Zm9yKHZhciBhIGluIHRoaXMuZXh0ZW5zaW9ucylcImJvb2xlYW5cIiE9PXR5cGVvZiB0aGlzLmV4dGVuc2lvbnNbYV0mJnRoaXMuZXh0ZW5zaW9uc1thXS5kZXN0cm95KCk7dGhpcy5leHRlbnNpb25zPW51bGw7dGhpcy5lbGVtZW50JiYoT3BlbkxheWVycy5FdmVudC5zdG9wT2JzZXJ2aW5nRWxlbWVudCh0aGlzLmVsZW1lbnQpLHRoaXMuZWxlbWVudC5oYXNTY3JvbGxFdmVudCYmT3BlbkxheWVycy5FdmVudC5zdG9wT2JzZXJ2aW5nKHdpbmRvdyxcInNjcm9sbFwiLHRoaXMuY2xlYXJNb3VzZUxpc3RlbmVyKSk7dGhpcy5ldmVudEhhbmRsZXI9dGhpcy5mYWxsVGhyb3VnaD10aGlzLm9iamVjdD10aGlzLmxpc3RlbmVycz10aGlzLmVsZW1lbnQ9bnVsbH0sYWRkRXZlbnRUeXBlOmZ1bmN0aW9uKCl7fSxhdHRhY2hUb0VsZW1lbnQ6ZnVuY3Rpb24oYSl7dGhpcy5lbGVtZW50P09wZW5MYXllcnMuRXZlbnQuc3RvcE9ic2VydmluZ0VsZW1lbnQodGhpcy5lbGVtZW50KTpcbih0aGlzLmV2ZW50SGFuZGxlcj1PcGVuTGF5ZXJzLkZ1bmN0aW9uLmJpbmRBc0V2ZW50TGlzdGVuZXIodGhpcy5oYW5kbGVCcm93c2VyRXZlbnQsdGhpcyksdGhpcy5jbGVhck1vdXNlTGlzdGVuZXI9T3BlbkxheWVycy5GdW5jdGlvbi5iaW5kKHRoaXMuY2xlYXJNb3VzZUNhY2hlLHRoaXMpKTt0aGlzLmVsZW1lbnQ9YTtmb3IodmFyIGI9MCxjPXRoaXMuQlJPV1NFUl9FVkVOVFMubGVuZ3RoO2I8YztiKyspT3BlbkxheWVycy5FdmVudC5vYnNlcnZlKGEsdGhpcy5CUk9XU0VSX0VWRU5UU1tiXSx0aGlzLmV2ZW50SGFuZGxlcik7T3BlbkxheWVycy5FdmVudC5vYnNlcnZlKGEsXCJkcmFnc3RhcnRcIixPcGVuTGF5ZXJzLkV2ZW50LnN0b3ApfSxvbjpmdW5jdGlvbihhKXtmb3IodmFyIGIgaW4gYSlcInNjb3BlXCIhPWImJmEuaGFzT3duUHJvcGVydHkoYikmJnRoaXMucmVnaXN0ZXIoYixhLnNjb3BlLGFbYl0pfSxyZWdpc3RlcjpmdW5jdGlvbihhLGIsYyxkKXthIGluIE9wZW5MYXllcnMuRXZlbnRzJiZcbiF0aGlzLmV4dGVuc2lvbnNbYV0mJih0aGlzLmV4dGVuc2lvbnNbYV09bmV3IE9wZW5MYXllcnMuRXZlbnRzW2FdKHRoaXMpKTtpZihudWxsIT1jKXtudWxsPT1iJiYoYj10aGlzLm9iamVjdCk7dmFyIGU9dGhpcy5saXN0ZW5lcnNbYV07ZXx8KGU9W10sdGhpcy5saXN0ZW5lcnNbYV09ZSx0aGlzLmV4dGVuc2lvbkNvdW50W2FdPTApO2I9e29iajpiLGZ1bmM6Y307ZD8oZS5zcGxpY2UodGhpcy5leHRlbnNpb25Db3VudFthXSwwLGIpLFwib2JqZWN0XCI9PT10eXBlb2YgZCYmZC5leHRlbnNpb24mJnRoaXMuZXh0ZW5zaW9uQ291bnRbYV0rKyk6ZS5wdXNoKGIpfX0scmVnaXN0ZXJQcmlvcml0eTpmdW5jdGlvbihhLGIsYyl7dGhpcy5yZWdpc3RlcihhLGIsYywhMCl9LHVuOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYiBpbiBhKVwic2NvcGVcIiE9YiYmYS5oYXNPd25Qcm9wZXJ0eShiKSYmdGhpcy51bnJlZ2lzdGVyKGIsYS5zY29wZSxhW2JdKX0sdW5yZWdpc3RlcjpmdW5jdGlvbihhLGIsYyl7bnVsbD09XG5iJiYoYj10aGlzLm9iamVjdCk7YT10aGlzLmxpc3RlbmVyc1thXTtpZihudWxsIT1hKWZvcih2YXIgZD0wLGU9YS5sZW5ndGg7ZDxlO2QrKylpZihhW2RdLm9iaj09YiYmYVtkXS5mdW5jPT1jKXthLnNwbGljZShkLDEpO2JyZWFrfX0scmVtb3ZlOmZ1bmN0aW9uKGEpe251bGwhPXRoaXMubGlzdGVuZXJzW2FdJiYodGhpcy5saXN0ZW5lcnNbYV09W10pfSx0cmlnZ2VyRXZlbnQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmxpc3RlbmVyc1thXTtpZihjJiYwIT1jLmxlbmd0aCl7bnVsbD09YiYmKGI9e30pO2Iub2JqZWN0PXRoaXMub2JqZWN0O2IuZWxlbWVudD10aGlzLmVsZW1lbnQ7Yi50eXBlfHwoYi50eXBlPWEpO2Zvcih2YXIgYz1jLnNsaWNlKCksZCxlPTAsZj1jLmxlbmd0aDtlPGYmJiEoZD1jW2VdLGQ9ZC5mdW5jLmFwcGx5KGQub2JqLFtiXSksdm9pZCAwIT1kJiYhMT09ZCk7ZSsrKTt0aGlzLmZhbGxUaHJvdWdofHxPcGVuTGF5ZXJzLkV2ZW50LnN0b3AoYiwhMCk7cmV0dXJuIGR9fSxcbmhhbmRsZUJyb3dzZXJFdmVudDpmdW5jdGlvbihhKXt2YXIgYj1hLnR5cGUsYz10aGlzLmxpc3RlbmVyc1tiXTtpZihjJiYwIT1jLmxlbmd0aCl7aWYoKGM9YS50b3VjaGVzKSYmY1swXSl7Zm9yKHZhciBkPTAsZT0wLGY9Yy5sZW5ndGgsZyxoPTA7aDxmOysraClnPWNbaF0sZCs9Zy5jbGllbnRYLGUrPWcuY2xpZW50WTthLmNsaWVudFg9ZC9mO2EuY2xpZW50WT1lL2Z9dGhpcy5pbmNsdWRlWFkmJihhLnh5PXRoaXMuZ2V0TW91c2VQb3NpdGlvbihhKSk7dGhpcy50cmlnZ2VyRXZlbnQoYixhKX19LGNsZWFyTW91c2VDYWNoZTpmdW5jdGlvbigpe3RoaXMuZWxlbWVudC5zY3JvbGxzPW51bGw7dGhpcy5lbGVtZW50LmxlZnR0b3A9bnVsbDt2YXIgYT1kb2N1bWVudC5ib2R5O2lmKGEmJighKDAhPWEuc2Nyb2xsVG9wfHwwIT1hLnNjcm9sbExlZnQpfHwhbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvaVBob25lL2kpKSl0aGlzLmVsZW1lbnQub2Zmc2V0cz1udWxsfSxnZXRNb3VzZVBvc2l0aW9uOmZ1bmN0aW9uKGEpe3RoaXMuaW5jbHVkZVhZP1xudGhpcy5lbGVtZW50Lmhhc1Njcm9sbEV2ZW50fHwoT3BlbkxheWVycy5FdmVudC5vYnNlcnZlKHdpbmRvdyxcInNjcm9sbFwiLHRoaXMuY2xlYXJNb3VzZUxpc3RlbmVyKSx0aGlzLmVsZW1lbnQuaGFzU2Nyb2xsRXZlbnQ9ITApOnRoaXMuY2xlYXJNb3VzZUNhY2hlKCk7aWYoIXRoaXMuZWxlbWVudC5zY3JvbGxzKXt2YXIgYj1PcGVuTGF5ZXJzLlV0aWwuZ2V0Vmlld3BvcnRFbGVtZW50KCk7dGhpcy5lbGVtZW50LnNjcm9sbHM9W2Iuc2Nyb2xsTGVmdCxiLnNjcm9sbFRvcF19dGhpcy5lbGVtZW50LmxlZnR0b3B8fCh0aGlzLmVsZW1lbnQubGVmdHRvcD1bZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudExlZnR8fDAsZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFRvcHx8MF0pO3RoaXMuZWxlbWVudC5vZmZzZXRzfHwodGhpcy5lbGVtZW50Lm9mZnNldHM9T3BlbkxheWVycy5VdGlsLnBhZ2VQb3NpdGlvbih0aGlzLmVsZW1lbnQpKTtyZXR1cm4gbmV3IE9wZW5MYXllcnMuUGl4ZWwoYS5jbGllbnRYK1xudGhpcy5lbGVtZW50LnNjcm9sbHNbMF0tdGhpcy5lbGVtZW50Lm9mZnNldHNbMF0tdGhpcy5lbGVtZW50LmxlZnR0b3BbMF0sYS5jbGllbnRZK3RoaXMuZWxlbWVudC5zY3JvbGxzWzFdLXRoaXMuZWxlbWVudC5vZmZzZXRzWzFdLXRoaXMuZWxlbWVudC5sZWZ0dG9wWzFdKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuRXZlbnRzXCJ9KTtPcGVuTGF5ZXJzLkV2ZW50cy5idXR0b25jbGljaz1PcGVuTGF5ZXJzLkNsYXNzKHt0YXJnZXQ6bnVsbCxldmVudHM6XCJtb3VzZWRvd24gbW91c2V1cCBjbGljayBkYmxjbGljayB0b3VjaHN0YXJ0IHRvdWNobW92ZSB0b3VjaGVuZCBrZXlkb3duXCIuc3BsaXQoXCIgXCIpLHN0YXJ0UmVnRXg6L15tb3VzZWRvd258dG91Y2hzdGFydCQvLGNhbmNlbFJlZ0V4Oi9edG91Y2htb3ZlJC8sY29tcGxldGVSZWdFeDovXm1vdXNldXB8dG91Y2hlbmQkLyxpbml0aWFsaXplOmZ1bmN0aW9uKGEpe3RoaXMudGFyZ2V0PWE7Zm9yKGE9dGhpcy5ldmVudHMubGVuZ3RoLTE7MDw9YTstLWEpdGhpcy50YXJnZXQucmVnaXN0ZXIodGhpcy5ldmVudHNbYV0sdGhpcyx0aGlzLmJ1dHRvbkNsaWNrLHtleHRlbnNpb246ITB9KX0sZGVzdHJveTpmdW5jdGlvbigpe2Zvcih2YXIgYT10aGlzLmV2ZW50cy5sZW5ndGgtMTswPD1hOy0tYSl0aGlzLnRhcmdldC51bnJlZ2lzdGVyKHRoaXMuZXZlbnRzW2FdLHRoaXMsdGhpcy5idXR0b25DbGljayk7XG5kZWxldGUgdGhpcy50YXJnZXR9LGdldFByZXNzZWRCdXR0b246ZnVuY3Rpb24oYSl7dmFyIGI9MyxjO2Rve2lmKE9wZW5MYXllcnMuRWxlbWVudC5oYXNDbGFzcyhhLFwib2xCdXR0b25cIikpe2M9YTticmVha31hPWEucGFyZW50Tm9kZX13aGlsZSgwPC0tYiYmYSk7cmV0dXJuIGN9LGJ1dHRvbkNsaWNrOmZ1bmN0aW9uKGEpe3ZhciBiPSEwLGM9T3BlbkxheWVycy5FdmVudC5lbGVtZW50KGEpO2lmKGMmJihPcGVuTGF5ZXJzLkV2ZW50LmlzTGVmdENsaWNrKGEpfHwhfmEudHlwZS5pbmRleE9mKFwibW91c2VcIikpKWlmKGM9dGhpcy5nZXRQcmVzc2VkQnV0dG9uKGMpKXtpZihcImtleWRvd25cIj09PWEudHlwZSlzd2l0Y2goYS5rZXlDb2RlKXtjYXNlIE9wZW5MYXllcnMuRXZlbnQuS0VZX1JFVFVSTjpjYXNlIE9wZW5MYXllcnMuRXZlbnQuS0VZX1NQQUNFOnRoaXMudGFyZ2V0LnRyaWdnZXJFdmVudChcImJ1dHRvbmNsaWNrXCIse2J1dHRvbkVsZW1lbnQ6Y30pLE9wZW5MYXllcnMuRXZlbnQuc3RvcChhKSxcbmI9ITF9ZWxzZSB0aGlzLnN0YXJ0RXZ0JiYodGhpcy5jb21wbGV0ZVJlZ0V4LnRlc3QoYS50eXBlKSYmKGI9T3BlbkxheWVycy5VdGlsLnBhZ2VQb3NpdGlvbihjKSx0aGlzLnRhcmdldC50cmlnZ2VyRXZlbnQoXCJidXR0b25jbGlja1wiLHtidXR0b25FbGVtZW50OmMsYnV0dG9uWFk6e3g6dGhpcy5zdGFydEV2dC5jbGllbnRYLWJbMF0seTp0aGlzLnN0YXJ0RXZ0LmNsaWVudFktYlsxXX19KSksdGhpcy5jYW5jZWxSZWdFeC50ZXN0KGEudHlwZSkmJmRlbGV0ZSB0aGlzLnN0YXJ0RXZ0LE9wZW5MYXllcnMuRXZlbnQuc3RvcChhKSxiPSExKTt0aGlzLnN0YXJ0UmVnRXgudGVzdChhLnR5cGUpJiYodGhpcy5zdGFydEV2dD1hLE9wZW5MYXllcnMuRXZlbnQuc3RvcChhKSxiPSExKX1lbHNlIGRlbGV0ZSB0aGlzLnN0YXJ0RXZ0O3JldHVybiBifX0pO09wZW5MYXllcnMuQ29udHJvbC5PdmVydmlld01hcD1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuQ29udHJvbCx7ZWxlbWVudDpudWxsLG92bWFwOm51bGwsc2l6ZTp7dzoxODAsaDo5MH0sbGF5ZXJzOm51bGwsbWluUmVjdFNpemU6MTUsbWluUmVjdERpc3BsYXlDbGFzczpcIlJlY3RSZXBsYWNlbWVudFwiLG1pblJhdGlvOjgsbWF4UmF0aW86MzIsbWFwT3B0aW9uczpudWxsLGF1dG9QYW46ITEsaGFuZGxlcnM6bnVsbCxyZXNvbHV0aW9uRmFjdG9yOjEsbWF4aW1pemVkOiExLGluaXRpYWxpemU6ZnVuY3Rpb24oYSl7dGhpcy5sYXllcnM9W107dGhpcy5oYW5kbGVycz17fTtPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbYV0pfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5tYXBEaXYmJih0aGlzLmhhbmRsZXJzLmNsaWNrJiZ0aGlzLmhhbmRsZXJzLmNsaWNrLmRlc3Ryb3koKSx0aGlzLmhhbmRsZXJzLmRyYWcmJnRoaXMuaGFuZGxlcnMuZHJhZy5kZXN0cm95KCksXG50aGlzLm92bWFwJiZ0aGlzLm92bWFwLnZpZXdQb3J0RGl2LnJlbW92ZUNoaWxkKHRoaXMuZXh0ZW50UmVjdGFuZ2xlKSx0aGlzLmV4dGVudFJlY3RhbmdsZT1udWxsLHRoaXMucmVjdEV2ZW50cyYmKHRoaXMucmVjdEV2ZW50cy5kZXN0cm95KCksdGhpcy5yZWN0RXZlbnRzPW51bGwpLHRoaXMub3ZtYXAmJih0aGlzLm92bWFwLmRlc3Ryb3koKSx0aGlzLm92bWFwPW51bGwpLHRoaXMuZWxlbWVudC5yZW1vdmVDaGlsZCh0aGlzLm1hcERpdiksdGhpcy5tYXBEaXY9bnVsbCx0aGlzLmRpdi5yZW1vdmVDaGlsZCh0aGlzLmVsZW1lbnQpLHRoaXMuZWxlbWVudD1udWxsLHRoaXMubWF4aW1pemVEaXYmJih0aGlzLmRpdi5yZW1vdmVDaGlsZCh0aGlzLm1heGltaXplRGl2KSx0aGlzLm1heGltaXplRGl2PW51bGwpLHRoaXMubWluaW1pemVEaXYmJih0aGlzLmRpdi5yZW1vdmVDaGlsZCh0aGlzLm1pbmltaXplRGl2KSx0aGlzLm1pbmltaXplRGl2PW51bGwpLHRoaXMubWFwLmV2ZW50cy51bih7YnV0dG9uY2xpY2s6dGhpcy5vbkJ1dHRvbkNsaWNrLFxubW92ZWVuZDp0aGlzLnVwZGF0ZSxjaGFuZ2ViYXNlbGF5ZXI6dGhpcy5iYXNlTGF5ZXJEcmF3LHNjb3BlOnRoaXN9KSxPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmRlc3Ryb3kuYXBwbHkodGhpcyxhcmd1bWVudHMpKX0sZHJhdzpmdW5jdGlvbigpe09wZW5MYXllcnMuQ29udHJvbC5wcm90b3R5cGUuZHJhdy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7aWYoMD09PXRoaXMubGF5ZXJzLmxlbmd0aClpZih0aGlzLm1hcC5iYXNlTGF5ZXIpdGhpcy5sYXllcnM9W3RoaXMubWFwLmJhc2VMYXllci5jbG9uZSgpXTtlbHNlIHJldHVybiB0aGlzLm1hcC5ldmVudHMucmVnaXN0ZXIoXCJjaGFuZ2ViYXNlbGF5ZXJcIix0aGlzLHRoaXMuYmFzZUxheWVyRHJhdyksdGhpcy5kaXY7dGhpcy5lbGVtZW50PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7dGhpcy5lbGVtZW50LmNsYXNzTmFtZT10aGlzLmRpc3BsYXlDbGFzcytcIkVsZW1lbnRcIjt0aGlzLmVsZW1lbnQuc3R5bGUuZGlzcGxheT1cIm5vbmVcIjtcbnRoaXMubWFwRGl2PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7dGhpcy5tYXBEaXYuc3R5bGUud2lkdGg9dGhpcy5zaXplLncrXCJweFwiO3RoaXMubWFwRGl2LnN0eWxlLmhlaWdodD10aGlzLnNpemUuaCtcInB4XCI7dGhpcy5tYXBEaXYuc3R5bGUucG9zaXRpb249XCJyZWxhdGl2ZVwiO3RoaXMubWFwRGl2LnN0eWxlLm92ZXJmbG93PVwiaGlkZGVuXCI7dGhpcy5tYXBEaXYuaWQ9T3BlbkxheWVycy5VdGlsLmNyZWF0ZVVuaXF1ZUlEKFwib3ZlcnZpZXdNYXBcIik7dGhpcy5leHRlbnRSZWN0YW5nbGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTt0aGlzLmV4dGVudFJlY3RhbmdsZS5zdHlsZS5wb3NpdGlvbj1cImFic29sdXRlXCI7dGhpcy5leHRlbnRSZWN0YW5nbGUuc3R5bGUuekluZGV4PTFFMzt0aGlzLmV4dGVudFJlY3RhbmdsZS5jbGFzc05hbWU9dGhpcy5kaXNwbGF5Q2xhc3MrXCJFeHRlbnRSZWN0YW5nbGVcIjt0aGlzLmVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5tYXBEaXYpO1xudGhpcy5kaXYuYXBwZW5kQ2hpbGQodGhpcy5lbGVtZW50KTtpZih0aGlzLm91dHNpZGVWaWV3cG9ydCl0aGlzLmVsZW1lbnQuc3R5bGUuZGlzcGxheT1cIlwiO2Vsc2V7dGhpcy5kaXYuY2xhc3NOYW1lKz1cIiBcIit0aGlzLmRpc3BsYXlDbGFzcytcIkNvbnRhaW5lclwiO3ZhciBhPU9wZW5MYXllcnMuVXRpbC5nZXRJbWFnZUxvY2F0aW9uKFwibGF5ZXItc3dpdGNoZXItbWF4aW1pemUucG5nXCIpO3RoaXMubWF4aW1pemVEaXY9T3BlbkxheWVycy5VdGlsLmNyZWF0ZUFscGhhSW1hZ2VEaXYodGhpcy5kaXNwbGF5Q2xhc3MrXCJNYXhpbWl6ZUJ1dHRvblwiLG51bGwsbnVsbCxhLFwiYWJzb2x1dGVcIik7dGhpcy5tYXhpbWl6ZURpdi5zdHlsZS5kaXNwbGF5PVwibm9uZVwiO3RoaXMubWF4aW1pemVEaXYuY2xhc3NOYW1lPXRoaXMuZGlzcGxheUNsYXNzK1wiTWF4aW1pemVCdXR0b24gb2xCdXR0b25cIjt0aGlzLmRpdi5hcHBlbmRDaGlsZCh0aGlzLm1heGltaXplRGl2KTthPU9wZW5MYXllcnMuVXRpbC5nZXRJbWFnZUxvY2F0aW9uKFwibGF5ZXItc3dpdGNoZXItbWluaW1pemUucG5nXCIpO1xudGhpcy5taW5pbWl6ZURpdj1PcGVuTGF5ZXJzLlV0aWwuY3JlYXRlQWxwaGFJbWFnZURpdihcIk9wZW5MYXllcnNfQ29udHJvbF9taW5pbWl6ZURpdlwiLG51bGwsbnVsbCxhLFwiYWJzb2x1dGVcIik7dGhpcy5taW5pbWl6ZURpdi5zdHlsZS5kaXNwbGF5PVwibm9uZVwiO3RoaXMubWluaW1pemVEaXYuY2xhc3NOYW1lPXRoaXMuZGlzcGxheUNsYXNzK1wiTWluaW1pemVCdXR0b24gb2xCdXR0b25cIjt0aGlzLmRpdi5hcHBlbmRDaGlsZCh0aGlzLm1pbmltaXplRGl2KTt0aGlzLm1pbmltaXplQ29udHJvbCgpfXRoaXMubWFwLmdldEV4dGVudCgpJiZ0aGlzLnVwZGF0ZSgpO3RoaXMubWFwLmV2ZW50cy5vbih7YnV0dG9uY2xpY2s6dGhpcy5vbkJ1dHRvbkNsaWNrLG1vdmVlbmQ6dGhpcy51cGRhdGUsc2NvcGU6dGhpc30pO3RoaXMubWF4aW1pemVkJiZ0aGlzLm1heGltaXplQ29udHJvbCgpO3JldHVybiB0aGlzLmRpdn0sYmFzZUxheWVyRHJhdzpmdW5jdGlvbigpe3RoaXMuZHJhdygpO3RoaXMubWFwLmV2ZW50cy51bnJlZ2lzdGVyKFwiY2hhbmdlYmFzZWxheWVyXCIsXG50aGlzLHRoaXMuYmFzZUxheWVyRHJhdyl9LHJlY3REcmFnOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuaGFuZGxlcnMuZHJhZy5sYXN0LngtYS54LGM9dGhpcy5oYW5kbGVycy5kcmFnLmxhc3QueS1hLnk7aWYoMCE9Ynx8MCE9Yyl7dmFyIGQ9dGhpcy5yZWN0UHhCb3VuZHMudG9wLGU9dGhpcy5yZWN0UHhCb3VuZHMubGVmdCxhPU1hdGguYWJzKHRoaXMucmVjdFB4Qm91bmRzLmdldEhlaWdodCgpKSxmPXRoaXMucmVjdFB4Qm91bmRzLmdldFdpZHRoKCksYz1NYXRoLm1heCgwLGQtYyksYz1NYXRoLm1pbihjLHRoaXMub3ZtYXAuc2l6ZS5oLXRoaXMuaENvbXAtYSksYj1NYXRoLm1heCgwLGUtYiksYj1NYXRoLm1pbihiLHRoaXMub3ZtYXAuc2l6ZS53LXRoaXMud0NvbXAtZik7dGhpcy5zZXRSZWN0UHhCb3VuZHMobmV3IE9wZW5MYXllcnMuQm91bmRzKGIsYythLGIrZixjKSl9fSxtYXBEaXZDbGljazpmdW5jdGlvbihhKXt2YXIgYj10aGlzLnJlY3RQeEJvdW5kcy5nZXRDZW50ZXJQaXhlbCgpLFxuYz1hLnh5LngtYi54LGQ9YS54eS55LWIueSxlPXRoaXMucmVjdFB4Qm91bmRzLnRvcCxmPXRoaXMucmVjdFB4Qm91bmRzLmxlZnQsYT1NYXRoLmFicyh0aGlzLnJlY3RQeEJvdW5kcy5nZXRIZWlnaHQoKSksYj10aGlzLnJlY3RQeEJvdW5kcy5nZXRXaWR0aCgpLGQ9TWF0aC5tYXgoMCxlK2QpLGQ9TWF0aC5taW4oZCx0aGlzLm92bWFwLnNpemUuaC1hKSxjPU1hdGgubWF4KDAsZitjKSxjPU1hdGgubWluKGMsdGhpcy5vdm1hcC5zaXplLnctYik7dGhpcy5zZXRSZWN0UHhCb3VuZHMobmV3IE9wZW5MYXllcnMuQm91bmRzKGMsZCthLGMrYixkKSk7dGhpcy51cGRhdGVNYXBUb1JlY3QoKX0sb25CdXR0b25DbGljazpmdW5jdGlvbihhKXthLmJ1dHRvbkVsZW1lbnQ9PT10aGlzLm1pbmltaXplRGl2P3RoaXMubWluaW1pemVDb250cm9sKCk6YS5idXR0b25FbGVtZW50PT09dGhpcy5tYXhpbWl6ZURpdiYmdGhpcy5tYXhpbWl6ZUNvbnRyb2woKX0sbWF4aW1pemVDb250cm9sOmZ1bmN0aW9uKGEpe3RoaXMuZWxlbWVudC5zdHlsZS5kaXNwbGF5PVxuXCJcIjt0aGlzLnNob3dUb2dnbGUoITEpO251bGwhPWEmJk9wZW5MYXllcnMuRXZlbnQuc3RvcChhKX0sbWluaW1pemVDb250cm9sOmZ1bmN0aW9uKGEpe3RoaXMuZWxlbWVudC5zdHlsZS5kaXNwbGF5PVwibm9uZVwiO3RoaXMuc2hvd1RvZ2dsZSghMCk7bnVsbCE9YSYmT3BlbkxheWVycy5FdmVudC5zdG9wKGEpfSxzaG93VG9nZ2xlOmZ1bmN0aW9uKGEpe3RoaXMubWF4aW1pemVEaXYuc3R5bGUuZGlzcGxheT1hP1wiXCI6XCJub25lXCI7dGhpcy5taW5pbWl6ZURpdi5zdHlsZS5kaXNwbGF5PWE/XCJub25lXCI6XCJcIn0sdXBkYXRlOmZ1bmN0aW9uKCl7bnVsbD09dGhpcy5vdm1hcCYmdGhpcy5jcmVhdGVNYXAoKTsodGhpcy5hdXRvUGFufHwhdGhpcy5pc1N1aXRhYmxlT3ZlcnZpZXcoKSkmJnRoaXMudXBkYXRlT3ZlcnZpZXcoKTt0aGlzLnVwZGF0ZVJlY3RUb01hcCgpfSxpc1N1aXRhYmxlT3ZlcnZpZXc6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm1hcC5nZXRFeHRlbnQoKSxiPXRoaXMubWFwLm1heEV4dGVudCxcbmE9bmV3IE9wZW5MYXllcnMuQm91bmRzKE1hdGgubWF4KGEubGVmdCxiLmxlZnQpLE1hdGgubWF4KGEuYm90dG9tLGIuYm90dG9tKSxNYXRoLm1pbihhLnJpZ2h0LGIucmlnaHQpLE1hdGgubWluKGEudG9wLGIudG9wKSk7dGhpcy5vdm1hcC5nZXRQcm9qZWN0aW9uKCkhPXRoaXMubWFwLmdldFByb2plY3Rpb24oKSYmKGE9YS50cmFuc2Zvcm0odGhpcy5tYXAuZ2V0UHJvamVjdGlvbk9iamVjdCgpLHRoaXMub3ZtYXAuZ2V0UHJvamVjdGlvbk9iamVjdCgpKSk7Yj10aGlzLm92bWFwLmdldFJlc29sdXRpb24oKS90aGlzLm1hcC5nZXRSZXNvbHV0aW9uKCk7cmV0dXJuIGI+dGhpcy5taW5SYXRpbyYmYjw9dGhpcy5tYXhSYXRpbyYmdGhpcy5vdm1hcC5nZXRFeHRlbnQoKS5jb250YWluc0JvdW5kcyhhKX0sdXBkYXRlT3ZlcnZpZXc6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm1hcC5nZXRSZXNvbHV0aW9uKCksYj10aGlzLm92bWFwLmdldFJlc29sdXRpb24oKSxjPWIvYTtjPnRoaXMubWF4UmF0aW8/XG5iPXRoaXMubWluUmF0aW8qYTpjPD10aGlzLm1pblJhdGlvJiYoYj10aGlzLm1heFJhdGlvKmEpO3RoaXMub3ZtYXAuZ2V0UHJvamVjdGlvbigpIT10aGlzLm1hcC5nZXRQcm9qZWN0aW9uKCk/KGE9dGhpcy5tYXAuY2VudGVyLmNsb25lKCksYS50cmFuc2Zvcm0odGhpcy5tYXAuZ2V0UHJvamVjdGlvbk9iamVjdCgpLHRoaXMub3ZtYXAuZ2V0UHJvamVjdGlvbk9iamVjdCgpKSk6YT10aGlzLm1hcC5jZW50ZXI7dGhpcy5vdm1hcC5zZXRDZW50ZXIoYSx0aGlzLm92bWFwLmdldFpvb21Gb3JSZXNvbHV0aW9uKGIqdGhpcy5yZXNvbHV0aW9uRmFjdG9yKSk7dGhpcy51cGRhdGVSZWN0VG9NYXAoKX0sY3JlYXRlTWFwOmZ1bmN0aW9uKCl7dmFyIGE9T3BlbkxheWVycy5VdGlsLmV4dGVuZCh7Y29udHJvbHM6W10sbWF4UmVzb2x1dGlvbjpcImF1dG9cIixmYWxsVGhyb3VnaDohMX0sdGhpcy5tYXBPcHRpb25zKTt0aGlzLm92bWFwPW5ldyBPcGVuTGF5ZXJzLk1hcCh0aGlzLm1hcERpdixhKTt0aGlzLm92bWFwLnZpZXdQb3J0RGl2LmFwcGVuZENoaWxkKHRoaXMuZXh0ZW50UmVjdGFuZ2xlKTtcbk9wZW5MYXllcnMuRXZlbnQuc3RvcE9ic2VydmluZyh3aW5kb3csXCJ1bmxvYWRcIix0aGlzLm92bWFwLnVubG9hZERlc3Ryb3kpO3RoaXMub3ZtYXAuYWRkTGF5ZXJzKHRoaXMubGF5ZXJzKTt0aGlzLm92bWFwLnpvb21Ub01heEV4dGVudCgpO3RoaXMud0NvbXA9KHRoaXMud0NvbXA9cGFyc2VJbnQoT3BlbkxheWVycy5FbGVtZW50LmdldFN0eWxlKHRoaXMuZXh0ZW50UmVjdGFuZ2xlLFwiYm9yZGVyLWxlZnQtd2lkdGhcIikpK3BhcnNlSW50KE9wZW5MYXllcnMuRWxlbWVudC5nZXRTdHlsZSh0aGlzLmV4dGVudFJlY3RhbmdsZSxcImJvcmRlci1yaWdodC13aWR0aFwiKSkpP3RoaXMud0NvbXA6Mjt0aGlzLmhDb21wPSh0aGlzLmhDb21wPXBhcnNlSW50KE9wZW5MYXllcnMuRWxlbWVudC5nZXRTdHlsZSh0aGlzLmV4dGVudFJlY3RhbmdsZSxcImJvcmRlci10b3Atd2lkdGhcIikpK3BhcnNlSW50KE9wZW5MYXllcnMuRWxlbWVudC5nZXRTdHlsZSh0aGlzLmV4dGVudFJlY3RhbmdsZSxcImJvcmRlci1ib3R0b20td2lkdGhcIikpKT9cbnRoaXMuaENvbXA6Mjt0aGlzLmhhbmRsZXJzLmRyYWc9bmV3IE9wZW5MYXllcnMuSGFuZGxlci5EcmFnKHRoaXMse21vdmU6dGhpcy5yZWN0RHJhZyxkb25lOnRoaXMudXBkYXRlTWFwVG9SZWN0fSx7bWFwOnRoaXMub3ZtYXB9KTt0aGlzLmhhbmRsZXJzLmNsaWNrPW5ldyBPcGVuTGF5ZXJzLkhhbmRsZXIuQ2xpY2sodGhpcyx7Y2xpY2s6dGhpcy5tYXBEaXZDbGlja30se3NpbmdsZTohMCxcImRvdWJsZVwiOiExLHN0b3BTaW5nbGU6ITAsc3RvcERvdWJsZTohMCxwaXhlbFRvbGVyYW5jZToxLG1hcDp0aGlzLm92bWFwfSk7dGhpcy5oYW5kbGVycy5jbGljay5hY3RpdmF0ZSgpO3RoaXMucmVjdEV2ZW50cz1uZXcgT3BlbkxheWVycy5FdmVudHModGhpcyx0aGlzLmV4dGVudFJlY3RhbmdsZSxudWxsLCEwKTt0aGlzLnJlY3RFdmVudHMucmVnaXN0ZXIoXCJtb3VzZW92ZXJcIix0aGlzLGZ1bmN0aW9uKCl7IXRoaXMuaGFuZGxlcnMuZHJhZy5hY3RpdmUmJiF0aGlzLm1hcC5kcmFnZ2luZyYmdGhpcy5oYW5kbGVycy5kcmFnLmFjdGl2YXRlKCl9KTtcbnRoaXMucmVjdEV2ZW50cy5yZWdpc3RlcihcIm1vdXNlb3V0XCIsdGhpcyxmdW5jdGlvbigpe3RoaXMuaGFuZGxlcnMuZHJhZy5kcmFnZ2luZ3x8dGhpcy5oYW5kbGVycy5kcmFnLmRlYWN0aXZhdGUoKX0pO2lmKHRoaXMub3ZtYXAuZ2V0UHJvamVjdGlvbigpIT10aGlzLm1hcC5nZXRQcm9qZWN0aW9uKCkpe3ZhciBhPXRoaXMubWFwLmdldFByb2plY3Rpb25PYmplY3QoKS5nZXRVbml0cygpfHx0aGlzLm1hcC51bml0c3x8dGhpcy5tYXAuYmFzZUxheWVyLnVuaXRzLGI9dGhpcy5vdm1hcC5nZXRQcm9qZWN0aW9uT2JqZWN0KCkuZ2V0VW5pdHMoKXx8dGhpcy5vdm1hcC51bml0c3x8dGhpcy5vdm1hcC5iYXNlTGF5ZXIudW5pdHM7dGhpcy5yZXNvbHV0aW9uRmFjdG9yPWEmJmI/T3BlbkxheWVycy5JTkNIRVNfUEVSX1VOSVRbYV0vT3BlbkxheWVycy5JTkNIRVNfUEVSX1VOSVRbYl06MX19LHVwZGF0ZVJlY3RUb01hcDpmdW5jdGlvbigpe3ZhciBhPXRoaXMuZ2V0UmVjdEJvdW5kc0Zyb21NYXBCb3VuZHModGhpcy5vdm1hcC5nZXRQcm9qZWN0aW9uKCkhPVxudGhpcy5tYXAuZ2V0UHJvamVjdGlvbigpP3RoaXMubWFwLmdldEV4dGVudCgpLnRyYW5zZm9ybSh0aGlzLm1hcC5nZXRQcm9qZWN0aW9uT2JqZWN0KCksdGhpcy5vdm1hcC5nZXRQcm9qZWN0aW9uT2JqZWN0KCkpOnRoaXMubWFwLmdldEV4dGVudCgpKTthJiZ0aGlzLnNldFJlY3RQeEJvdW5kcyhhKX0sdXBkYXRlTWFwVG9SZWN0OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5nZXRNYXBCb3VuZHNGcm9tUmVjdEJvdW5kcyh0aGlzLnJlY3RQeEJvdW5kcyk7dGhpcy5vdm1hcC5nZXRQcm9qZWN0aW9uKCkhPXRoaXMubWFwLmdldFByb2plY3Rpb24oKSYmKGE9YS50cmFuc2Zvcm0odGhpcy5vdm1hcC5nZXRQcm9qZWN0aW9uT2JqZWN0KCksdGhpcy5tYXAuZ2V0UHJvamVjdGlvbk9iamVjdCgpKSk7dGhpcy5tYXAucGFuVG8oYS5nZXRDZW50ZXJMb25MYXQoKSl9LHNldFJlY3RQeEJvdW5kczpmdW5jdGlvbihhKXt2YXIgYj1NYXRoLm1heChhLnRvcCwwKSxjPU1hdGgubWF4KGEubGVmdCwwKSxkPVxuTWF0aC5taW4oYS50b3ArTWF0aC5hYnMoYS5nZXRIZWlnaHQoKSksdGhpcy5vdm1hcC5zaXplLmgtdGhpcy5oQ29tcCksYT1NYXRoLm1pbihhLmxlZnQrYS5nZXRXaWR0aCgpLHRoaXMub3ZtYXAuc2l6ZS53LXRoaXMud0NvbXApLGU9TWF0aC5tYXgoYS1jLDApLGY9TWF0aC5tYXgoZC1iLDApO2U8dGhpcy5taW5SZWN0U2l6ZXx8Zjx0aGlzLm1pblJlY3RTaXplPyh0aGlzLmV4dGVudFJlY3RhbmdsZS5jbGFzc05hbWU9dGhpcy5kaXNwbGF5Q2xhc3MrdGhpcy5taW5SZWN0RGlzcGxheUNsYXNzLGU9YytlLzItdGhpcy5taW5SZWN0U2l6ZS8yLHRoaXMuZXh0ZW50UmVjdGFuZ2xlLnN0eWxlLnRvcD1NYXRoLnJvdW5kKGIrZi8yLXRoaXMubWluUmVjdFNpemUvMikrXCJweFwiLHRoaXMuZXh0ZW50UmVjdGFuZ2xlLnN0eWxlLmxlZnQ9TWF0aC5yb3VuZChlKStcInB4XCIsdGhpcy5leHRlbnRSZWN0YW5nbGUuc3R5bGUuaGVpZ2h0PXRoaXMubWluUmVjdFNpemUrXCJweFwiLHRoaXMuZXh0ZW50UmVjdGFuZ2xlLnN0eWxlLndpZHRoPVxudGhpcy5taW5SZWN0U2l6ZStcInB4XCIpOih0aGlzLmV4dGVudFJlY3RhbmdsZS5jbGFzc05hbWU9dGhpcy5kaXNwbGF5Q2xhc3MrXCJFeHRlbnRSZWN0YW5nbGVcIix0aGlzLmV4dGVudFJlY3RhbmdsZS5zdHlsZS50b3A9TWF0aC5yb3VuZChiKStcInB4XCIsdGhpcy5leHRlbnRSZWN0YW5nbGUuc3R5bGUubGVmdD1NYXRoLnJvdW5kKGMpK1wicHhcIix0aGlzLmV4dGVudFJlY3RhbmdsZS5zdHlsZS5oZWlnaHQ9TWF0aC5yb3VuZChmKStcInB4XCIsdGhpcy5leHRlbnRSZWN0YW5nbGUuc3R5bGUud2lkdGg9TWF0aC5yb3VuZChlKStcInB4XCIpO3RoaXMucmVjdFB4Qm91bmRzPW5ldyBPcGVuTGF5ZXJzLkJvdW5kcyhNYXRoLnJvdW5kKGMpLE1hdGgucm91bmQoZCksTWF0aC5yb3VuZChhKSxNYXRoLnJvdW5kKGIpKX0sZ2V0UmVjdEJvdW5kc0Zyb21NYXBCb3VuZHM6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5nZXRPdmVydmlld1B4RnJvbUxvbkxhdCh7bG9uOmEubGVmdCxsYXQ6YS5ib3R0b219KSxhPXRoaXMuZ2V0T3ZlcnZpZXdQeEZyb21Mb25MYXQoe2xvbjphLnJpZ2h0LFxubGF0OmEudG9wfSksYz1udWxsO2ImJmEmJihjPW5ldyBPcGVuTGF5ZXJzLkJvdW5kcyhiLngsYi55LGEueCxhLnkpKTtyZXR1cm4gY30sZ2V0TWFwQm91bmRzRnJvbVJlY3RCb3VuZHM6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5nZXRMb25MYXRGcm9tT3ZlcnZpZXdQeCh7eDphLmxlZnQseTphLmJvdHRvbX0pLGE9dGhpcy5nZXRMb25MYXRGcm9tT3ZlcnZpZXdQeCh7eDphLnJpZ2h0LHk6YS50b3B9KTtyZXR1cm4gbmV3IE9wZW5MYXllcnMuQm91bmRzKGIubG9uLGIubGF0LGEubG9uLGEubGF0KX0sZ2V0TG9uTGF0RnJvbU92ZXJ2aWV3UHg6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5vdm1hcC5zaXplLGM9dGhpcy5vdm1hcC5nZXRSZXNvbHV0aW9uKCksZD10aGlzLm92bWFwLmdldEV4dGVudCgpLmdldENlbnRlckxvbkxhdCgpO3JldHVybntsb246ZC5sb24rKGEueC1iLncvMikqYyxsYXQ6ZC5sYXQtKGEueS1iLmgvMikqY319LGdldE92ZXJ2aWV3UHhGcm9tTG9uTGF0OmZ1bmN0aW9uKGEpe3ZhciBiPVxudGhpcy5vdm1hcC5nZXRSZXNvbHV0aW9uKCksYz10aGlzLm92bWFwLmdldEV4dGVudCgpO2lmKGMpcmV0dXJue3g6TWF0aC5yb3VuZCgxL2IqKGEubG9uLWMubGVmdCkpLHk6TWF0aC5yb3VuZCgxL2IqKGMudG9wLWEubGF0KSl9fSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Db250cm9sLk92ZXJ2aWV3TWFwXCJ9KTtPcGVuTGF5ZXJzLkFuaW1hdGlvbj1mdW5jdGlvbihhKXt2YXIgYj0hKCFhLnJlcXVlc3RBbmltYXRpb25GcmFtZSYmIWEud2Via2l0UmVxdWVzdEFuaW1hdGlvbkZyYW1lJiYhYS5tb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWUmJiFhLm9SZXF1ZXN0QW5pbWF0aW9uRnJhbWUmJiFhLm1zUmVxdWVzdEFuaW1hdGlvbkZyYW1lKSxjPWZ1bmN0aW9uKCl7dmFyIGI9YS5yZXF1ZXN0QW5pbWF0aW9uRnJhbWV8fGEud2Via2l0UmVxdWVzdEFuaW1hdGlvbkZyYW1lfHxhLm1velJlcXVlc3RBbmltYXRpb25GcmFtZXx8YS5vUmVxdWVzdEFuaW1hdGlvbkZyYW1lfHxhLm1zUmVxdWVzdEFuaW1hdGlvbkZyYW1lfHxmdW5jdGlvbihiKXthLnNldFRpbWVvdXQoYiwxNil9O3JldHVybiBmdW5jdGlvbihjLGQpe2IuYXBwbHkoYSxbYyxkXSl9fSgpLGQ9MCxlPXt9O3JldHVybntpc05hdGl2ZTpiLHJlcXVlc3RGcmFtZTpjLHN0YXJ0OmZ1bmN0aW9uKGEsYixoKXt2YXIgYj0wPGI/YjpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksXG5pPSsrZCxqPStuZXcgRGF0ZTtlW2ldPWZ1bmN0aW9uKCl7ZVtpXSYmK25ldyBEYXRlLWo8PWI/KGEoKSxlW2ldJiZjKGVbaV0saCkpOmRlbGV0ZSBlW2ldfTtjKGVbaV0saCk7cmV0dXJuIGl9LHN0b3A6ZnVuY3Rpb24oYSl7ZGVsZXRlIGVbYV19fX0od2luZG93KTtPcGVuTGF5ZXJzLlR3ZWVuPU9wZW5MYXllcnMuQ2xhc3Moe2Vhc2luZzpudWxsLGJlZ2luOm51bGwsZmluaXNoOm51bGwsZHVyYXRpb246bnVsbCxjYWxsYmFja3M6bnVsbCx0aW1lOm51bGwsYW5pbWF0aW9uSWQ6bnVsbCxwbGF5aW5nOiExLGluaXRpYWxpemU6ZnVuY3Rpb24oYSl7dGhpcy5lYXNpbmc9YT9hOk9wZW5MYXllcnMuRWFzaW5nLkV4cG8uZWFzZU91dH0sc3RhcnQ6ZnVuY3Rpb24oYSxiLGMsZCl7dGhpcy5wbGF5aW5nPSEwO3RoaXMuYmVnaW49YTt0aGlzLmZpbmlzaD1iO3RoaXMuZHVyYXRpb249Yzt0aGlzLmNhbGxiYWNrcz1kLmNhbGxiYWNrczt0aGlzLnRpbWU9MDtPcGVuTGF5ZXJzLkFuaW1hdGlvbi5zdG9wKHRoaXMuYW5pbWF0aW9uSWQpO3RoaXMuYW5pbWF0aW9uSWQ9bnVsbDt0aGlzLmNhbGxiYWNrcyYmdGhpcy5jYWxsYmFja3Muc3RhcnQmJnRoaXMuY2FsbGJhY2tzLnN0YXJ0LmNhbGwodGhpcyx0aGlzLmJlZ2luKTt0aGlzLmFuaW1hdGlvbklkPU9wZW5MYXllcnMuQW5pbWF0aW9uLnN0YXJ0KE9wZW5MYXllcnMuRnVuY3Rpb24uYmluZCh0aGlzLnBsYXksXG50aGlzKSl9LHN0b3A6ZnVuY3Rpb24oKXt0aGlzLnBsYXlpbmcmJih0aGlzLmNhbGxiYWNrcyYmdGhpcy5jYWxsYmFja3MuZG9uZSYmdGhpcy5jYWxsYmFja3MuZG9uZS5jYWxsKHRoaXMsdGhpcy5maW5pc2gpLE9wZW5MYXllcnMuQW5pbWF0aW9uLnN0b3AodGhpcy5hbmltYXRpb25JZCksdGhpcy5hbmltYXRpb25JZD1udWxsLHRoaXMucGxheWluZz0hMSl9LHBsYXk6ZnVuY3Rpb24oKXt2YXIgYT17fSxiO2ZvcihiIGluIHRoaXMuYmVnaW4pe3ZhciBjPXRoaXMuYmVnaW5bYl0sZD10aGlzLmZpbmlzaFtiXTtpZihudWxsPT1jfHxudWxsPT1kfHxpc05hTihjKXx8aXNOYU4oZCkpdGhyb3cgbmV3IFR5cGVFcnJvcihcImludmFsaWQgdmFsdWUgZm9yIFR3ZWVuXCIpO2FbYl09dGhpcy5lYXNpbmcuYXBwbHkodGhpcyxbdGhpcy50aW1lLGMsZC1jLHRoaXMuZHVyYXRpb25dKX10aGlzLnRpbWUrKzt0aGlzLmNhbGxiYWNrcyYmdGhpcy5jYWxsYmFja3MuZWFjaFN0ZXAmJnRoaXMuY2FsbGJhY2tzLmVhY2hTdGVwLmNhbGwodGhpcyxcbmEpO3RoaXMudGltZT50aGlzLmR1cmF0aW9uJiZ0aGlzLnN0b3AoKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuVHdlZW5cIn0pO09wZW5MYXllcnMuRWFzaW5nPXtDTEFTU19OQU1FOlwiT3BlbkxheWVycy5FYXNpbmdcIn07T3BlbkxheWVycy5FYXNpbmcuTGluZWFyPXtlYXNlSW46ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIGMqYS9kK2J9LGVhc2VPdXQ6ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIGMqYS9kK2J9LGVhc2VJbk91dDpmdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gYyphL2QrYn0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuRWFzaW5nLkxpbmVhclwifTtcbk9wZW5MYXllcnMuRWFzaW5nLkV4cG89e2Vhc2VJbjpmdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gMD09YT9iOmMqTWF0aC5wb3coMiwxMCooYS9kLTEpKStifSxlYXNlT3V0OmZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiBhPT1kP2IrYzpjKigtTWF0aC5wb3coMiwtMTAqYS9kKSsxKStifSxlYXNlSW5PdXQ6ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIDA9PWE/YjphPT1kP2IrYzoxPihhLz1kLzIpP2MvMipNYXRoLnBvdygyLDEwKihhLTEpKStiOmMvMiooLU1hdGgucG93KDIsLTEwKi0tYSkrMikrYn0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuRWFzaW5nLkV4cG9cIn07XG5PcGVuTGF5ZXJzLkVhc2luZy5RdWFkPXtlYXNlSW46ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIGMqKGEvPWQpKmErYn0sZWFzZU91dDpmdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4tYyooYS89ZCkqKGEtMikrYn0sZWFzZUluT3V0OmZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiAxPihhLz1kLzIpP2MvMiphKmErYjotYy8yKigtLWEqKGEtMiktMSkrYn0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuRWFzaW5nLlF1YWRcIn07T3BlbkxheWVycy5Qcm9qZWN0aW9uPU9wZW5MYXllcnMuQ2xhc3Moe3Byb2o6bnVsbCxwcm9qQ29kZTpudWxsLHRpdGxlUmVnRXg6L1xcK3RpdGxlPVteXFwrXSovLGluaXRpYWxpemU6ZnVuY3Rpb24oYSxiKXtPcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHRoaXMsYik7dGhpcy5wcm9qQ29kZT1hO3dpbmRvdy5Qcm9qNGpzJiYodGhpcy5wcm9qPW5ldyBQcm9qNGpzLlByb2ooYSkpfSxnZXRDb2RlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHJvaj90aGlzLnByb2ouc3JzQ29kZTp0aGlzLnByb2pDb2RlfSxnZXRVbml0czpmdW5jdGlvbigpe3JldHVybiB0aGlzLnByb2o/dGhpcy5wcm9qLnVuaXRzOm51bGx9LHRvU3RyaW5nOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0Q29kZSgpfSxlcXVhbHM6ZnVuY3Rpb24oYSl7dmFyIGI9ITE7YSYmKGEgaW5zdGFuY2VvZiBPcGVuTGF5ZXJzLlByb2plY3Rpb258fChhPW5ldyBPcGVuTGF5ZXJzLlByb2plY3Rpb24oYSkpLHdpbmRvdy5Qcm9qNGpzJiZcbnRoaXMucHJvai5kZWZEYXRhJiZhLnByb2ouZGVmRGF0YT9iPXRoaXMucHJvai5kZWZEYXRhLnJlcGxhY2UodGhpcy50aXRsZVJlZ0V4LFwiXCIpPT1hLnByb2ouZGVmRGF0YS5yZXBsYWNlKHRoaXMudGl0bGVSZWdFeCxcIlwiKTphLmdldENvZGUmJihiPXRoaXMuZ2V0Q29kZSgpLGE9YS5nZXRDb2RlKCksYj1iPT1hfHwhIU9wZW5MYXllcnMuUHJvamVjdGlvbi50cmFuc2Zvcm1zW2JdJiZPcGVuTGF5ZXJzLlByb2plY3Rpb24udHJhbnNmb3Jtc1tiXVthXT09PU9wZW5MYXllcnMuUHJvamVjdGlvbi5udWxsVHJhbnNmb3JtKSk7cmV0dXJuIGJ9LGRlc3Ryb3k6ZnVuY3Rpb24oKXtkZWxldGUgdGhpcy5wcm9qO2RlbGV0ZSB0aGlzLnByb2pDb2RlfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Qcm9qZWN0aW9uXCJ9KTtPcGVuTGF5ZXJzLlByb2plY3Rpb24udHJhbnNmb3Jtcz17fTtcbk9wZW5MYXllcnMuUHJvamVjdGlvbi5kZWZhdWx0cz17XCJFUFNHOjQzMjZcIjp7dW5pdHM6XCJkZWdyZWVzXCIsbWF4RXh0ZW50OlstMTgwLC05MCwxODAsOTBdLHl4OiEwfSxcIkNSUzo4NFwiOnt1bml0czpcImRlZ3JlZXNcIixtYXhFeHRlbnQ6Wy0xODAsLTkwLDE4MCw5MF19LFwiRVBTRzo5MDA5MTNcIjp7dW5pdHM6XCJtXCIsbWF4RXh0ZW50OlstMi4wMDM3NTA4MzRFNywtMi4wMDM3NTA4MzRFNywyLjAwMzc1MDgzNEU3LDIuMDAzNzUwODM0RTddfX07XG5PcGVuTGF5ZXJzLlByb2plY3Rpb24uYWRkVHJhbnNmb3JtPWZ1bmN0aW9uKGEsYixjKXtpZihjPT09T3BlbkxheWVycy5Qcm9qZWN0aW9uLm51bGxUcmFuc2Zvcm0pe3ZhciBkPU9wZW5MYXllcnMuUHJvamVjdGlvbi5kZWZhdWx0c1thXTtkJiYhT3BlbkxheWVycy5Qcm9qZWN0aW9uLmRlZmF1bHRzW2JdJiYoT3BlbkxheWVycy5Qcm9qZWN0aW9uLmRlZmF1bHRzW2JdPWQpfU9wZW5MYXllcnMuUHJvamVjdGlvbi50cmFuc2Zvcm1zW2FdfHwoT3BlbkxheWVycy5Qcm9qZWN0aW9uLnRyYW5zZm9ybXNbYV09e30pO09wZW5MYXllcnMuUHJvamVjdGlvbi50cmFuc2Zvcm1zW2FdW2JdPWN9O1xuT3BlbkxheWVycy5Qcm9qZWN0aW9uLnRyYW5zZm9ybT1mdW5jdGlvbihhLGIsYyl7aWYoYiYmYylpZihiIGluc3RhbmNlb2YgT3BlbkxheWVycy5Qcm9qZWN0aW9ufHwoYj1uZXcgT3BlbkxheWVycy5Qcm9qZWN0aW9uKGIpKSxjIGluc3RhbmNlb2YgT3BlbkxheWVycy5Qcm9qZWN0aW9ufHwoYz1uZXcgT3BlbkxheWVycy5Qcm9qZWN0aW9uKGMpKSxiLnByb2omJmMucHJvailhPVByb2o0anMudHJhbnNmb3JtKGIucHJvaixjLnByb2osYSk7ZWxzZXt2YXIgYj1iLmdldENvZGUoKSxjPWMuZ2V0Q29kZSgpLGQ9T3BlbkxheWVycy5Qcm9qZWN0aW9uLnRyYW5zZm9ybXM7aWYoZFtiXSYmZFtiXVtjXSlkW2JdW2NdKGEpfXJldHVybiBhfTtPcGVuTGF5ZXJzLlByb2plY3Rpb24ubnVsbFRyYW5zZm9ybT1mdW5jdGlvbihhKXtyZXR1cm4gYX07XG4oZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEpe2EueD0xODAqYS54L2Q7YS55PTE4MC9NYXRoLlBJKigyKk1hdGguYXRhbihNYXRoLmV4cChhLnkvZCpNYXRoLlBJKSktTWF0aC5QSS8yKTtyZXR1cm4gYX1mdW5jdGlvbiBiKGEpe2EueD1hLngqZC8xODA7YS55PU1hdGgubG9nKE1hdGgudGFuKCg5MCthLnkpKk1hdGguUEkvMzYwKSkvTWF0aC5QSSpkO3JldHVybiBhfWZ1bmN0aW9uIGMoYyxkKXt2YXIgZT1PcGVuTGF5ZXJzLlByb2plY3Rpb24uYWRkVHJhbnNmb3JtLGY9T3BlbkxheWVycy5Qcm9qZWN0aW9uLm51bGxUcmFuc2Zvcm0sZyxtLG4sbyxwO2c9MDtmb3IobT1kLmxlbmd0aDtnPG07KytnKXtuPWRbZ107ZShjLG4sYik7ZShuLGMsYSk7Zm9yKHA9ZysxO3A8bTsrK3Apbz1kW3BdLGUobixvLGYpLGUobyxuLGYpfX12YXIgZD0yLjAwMzc1MDgzNEU3LGU9W1wiRVBTRzo5MDA5MTNcIixcIkVQU0c6Mzg1N1wiLFwiRVBTRzoxMDIxMTNcIixcIkVQU0c6MTAyMTAwXCJdLGY9W1wiQ1JTOjg0XCIsXCJ1cm46b2djOmRlZjpjcnM6RVBTRzo2LjY6NDMyNlwiLFxuXCJFUFNHOjQzMjZcIl0sZztmb3IoZz1lLmxlbmd0aC0xOzA8PWc7LS1nKWMoZVtnXSxmKTtmb3IoZz1mLmxlbmd0aC0xOzA8PWc7LS1nKWMoZltnXSxlKX0pKCk7T3BlbkxheWVycy5NYXA9T3BlbkxheWVycy5DbGFzcyh7Wl9JTkRFWF9CQVNFOntCYXNlTGF5ZXI6MTAwLE92ZXJsYXk6MzI1LEZlYXR1cmU6NzI1LFBvcHVwOjc1MCxDb250cm9sOjFFM30saWQ6bnVsbCxmcmFjdGlvbmFsWm9vbTohMSxldmVudHM6bnVsbCxhbGxPdmVybGF5czohMSxkaXY6bnVsbCxkcmFnZ2luZzohMSxzaXplOm51bGwsdmlld1BvcnREaXY6bnVsbCxsYXllckNvbnRhaW5lck9yaWdpbjpudWxsLGxheWVyQ29udGFpbmVyRGl2Om51bGwsbGF5ZXJzOm51bGwsY29udHJvbHM6bnVsbCxwb3B1cHM6bnVsbCxiYXNlTGF5ZXI6bnVsbCxjZW50ZXI6bnVsbCxyZXNvbHV0aW9uOm51bGwsem9vbTowLHBhblJhdGlvOjEuNSxvcHRpb25zOm51bGwsdGlsZVNpemU6bnVsbCxwcm9qZWN0aW9uOlwiRVBTRzo0MzI2XCIsdW5pdHM6bnVsbCxyZXNvbHV0aW9uczpudWxsLG1heFJlc29sdXRpb246bnVsbCxtaW5SZXNvbHV0aW9uOm51bGwsbWF4U2NhbGU6bnVsbCxtaW5TY2FsZTpudWxsLFxubWF4RXh0ZW50Om51bGwsbWluRXh0ZW50Om51bGwscmVzdHJpY3RlZEV4dGVudDpudWxsLG51bVpvb21MZXZlbHM6MTYsdGhlbWU6bnVsbCxkaXNwbGF5UHJvamVjdGlvbjpudWxsLGZhbGxUaHJvdWdoOiEwLHBhblR3ZWVuOm51bGwsZXZlbnRMaXN0ZW5lcnM6bnVsbCxwYW5NZXRob2Q6T3BlbkxheWVycy5FYXNpbmcuRXhwby5lYXNlT3V0LHBhbkR1cmF0aW9uOjUwLHBhZGRpbmdGb3JQb3B1cHM6bnVsbCxtaW5QeDpudWxsLG1heFB4Om51bGwsaW5pdGlhbGl6ZTpmdW5jdGlvbihhLGIpezE9PT1hcmd1bWVudHMubGVuZ3RoJiZcIm9iamVjdFwiPT09dHlwZW9mIGEmJihhPShiPWEpJiZiLmRpdik7dGhpcy50aWxlU2l6ZT1uZXcgT3BlbkxheWVycy5TaXplKE9wZW5MYXllcnMuTWFwLlRJTEVfV0lEVEgsT3BlbkxheWVycy5NYXAuVElMRV9IRUlHSFQpO3RoaXMucGFkZGluZ0ZvclBvcHVwcz1uZXcgT3BlbkxheWVycy5Cb3VuZHMoMTUsMTUsMTUsMTUpO3RoaXMudGhlbWU9dW5kZWZpbmVkO3RoaXMub3B0aW9ucz1PcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHt9LGIpO09wZW5MYXllcnMuVXRpbC5leHRlbmQodGhpcyxiKTtPcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyh0aGlzLE9wZW5MYXllcnMuUHJvamVjdGlvbi5kZWZhdWx0c1t0aGlzLnByb2plY3Rpb24gaW5zdGFuY2VvZiBPcGVuTGF5ZXJzLlByb2plY3Rpb24/dGhpcy5wcm9qZWN0aW9uLnByb2pDb2RlOnRoaXMucHJvamVjdGlvbl0pO3RoaXMubWF4RXh0ZW50JiYhKHRoaXMubWF4RXh0ZW50IGluc3RhbmNlb2YgT3BlbkxheWVycy5Cb3VuZHMpJiYodGhpcy5tYXhFeHRlbnQ9bmV3IE9wZW5MYXllcnMuQm91bmRzKHRoaXMubWF4RXh0ZW50KSk7dGhpcy5taW5FeHRlbnQmJiEodGhpcy5taW5FeHRlbnQgaW5zdGFuY2VvZiBPcGVuTGF5ZXJzLkJvdW5kcykmJih0aGlzLm1pbkV4dGVudD1uZXcgT3BlbkxheWVycy5Cb3VuZHModGhpcy5taW5FeHRlbnQpKTt0aGlzLnJlc3RyaWN0ZWRFeHRlbnQmJlxuISh0aGlzLnJlc3RyaWN0ZWRFeHRlbnQgaW5zdGFuY2VvZiBPcGVuTGF5ZXJzLkJvdW5kcykmJih0aGlzLnJlc3RyaWN0ZWRFeHRlbnQ9bmV3IE9wZW5MYXllcnMuQm91bmRzKHRoaXMucmVzdHJpY3RlZEV4dGVudCkpO3RoaXMuY2VudGVyJiYhKHRoaXMuY2VudGVyIGluc3RhbmNlb2YgT3BlbkxheWVycy5Mb25MYXQpJiYodGhpcy5jZW50ZXI9bmV3IE9wZW5MYXllcnMuTG9uTGF0KHRoaXMuY2VudGVyKSk7dGhpcy5sYXllcnM9W107dGhpcy5pZD1PcGVuTGF5ZXJzLlV0aWwuY3JlYXRlVW5pcXVlSUQoXCJPcGVuTGF5ZXJzLk1hcF9cIik7dGhpcy5kaXY9T3BlbkxheWVycy5VdGlsLmdldEVsZW1lbnQoYSk7dGhpcy5kaXZ8fCh0aGlzLmRpdj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLHRoaXMuZGl2LnN0eWxlLmhlaWdodD1cIjFweFwiLHRoaXMuZGl2LnN0eWxlLndpZHRoPVwiMXB4XCIpO09wZW5MYXllcnMuRWxlbWVudC5hZGRDbGFzcyh0aGlzLmRpdixcIm9sTWFwXCIpO3ZhciBjPVxudGhpcy5pZCtcIl9PcGVuTGF5ZXJzX1ZpZXdQb3J0XCI7dGhpcy52aWV3UG9ydERpdj1PcGVuTGF5ZXJzLlV0aWwuY3JlYXRlRGl2KGMsbnVsbCxudWxsLG51bGwsXCJyZWxhdGl2ZVwiLG51bGwsXCJoaWRkZW5cIik7dGhpcy52aWV3UG9ydERpdi5zdHlsZS53aWR0aD1cIjEwMCVcIjt0aGlzLnZpZXdQb3J0RGl2LnN0eWxlLmhlaWdodD1cIjEwMCVcIjt0aGlzLnZpZXdQb3J0RGl2LmNsYXNzTmFtZT1cIm9sTWFwVmlld3BvcnRcIjt0aGlzLmRpdi5hcHBlbmRDaGlsZCh0aGlzLnZpZXdQb3J0RGl2KTt0aGlzLmV2ZW50cz1uZXcgT3BlbkxheWVycy5FdmVudHModGhpcyx0aGlzLnZpZXdQb3J0RGl2LG51bGwsdGhpcy5mYWxsVGhyb3VnaCx7aW5jbHVkZVhZOiEwfSk7Yz10aGlzLmlkK1wiX09wZW5MYXllcnNfQ29udGFpbmVyXCI7dGhpcy5sYXllckNvbnRhaW5lckRpdj1PcGVuTGF5ZXJzLlV0aWwuY3JlYXRlRGl2KGMpO3RoaXMubGF5ZXJDb250YWluZXJEaXYuc3R5bGUud2lkdGg9XCIxMDBweFwiO3RoaXMubGF5ZXJDb250YWluZXJEaXYuc3R5bGUuaGVpZ2h0PVxuXCIxMDBweFwiO3RoaXMubGF5ZXJDb250YWluZXJEaXYuc3R5bGUuekluZGV4PXRoaXMuWl9JTkRFWF9CQVNFLlBvcHVwLTE7dGhpcy52aWV3UG9ydERpdi5hcHBlbmRDaGlsZCh0aGlzLmxheWVyQ29udGFpbmVyRGl2KTt0aGlzLnVwZGF0ZVNpemUoKTtpZih0aGlzLmV2ZW50TGlzdGVuZXJzIGluc3RhbmNlb2YgT2JqZWN0KXRoaXMuZXZlbnRzLm9uKHRoaXMuZXZlbnRMaXN0ZW5lcnMpOzk+cGFyc2VGbG9hdChuYXZpZ2F0b3IuYXBwVmVyc2lvbi5zcGxpdChcIk1TSUVcIilbMV0pP3RoaXMuZXZlbnRzLnJlZ2lzdGVyKFwicmVzaXplXCIsdGhpcyx0aGlzLnVwZGF0ZVNpemUpOih0aGlzLnVwZGF0ZVNpemVEZXN0cm95PU9wZW5MYXllcnMuRnVuY3Rpb24uYmluZCh0aGlzLnVwZGF0ZVNpemUsdGhpcyksT3BlbkxheWVycy5FdmVudC5vYnNlcnZlKHdpbmRvdyxcInJlc2l6ZVwiLHRoaXMudXBkYXRlU2l6ZURlc3Ryb3kpKTtpZih0aGlzLnRoZW1lKXtmb3IodmFyIGM9ITAsZD1kb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImxpbmtcIiksXG5lPTAsZj1kLmxlbmd0aDtlPGY7KytlKWlmKE9wZW5MYXllcnMuVXRpbC5pc0VxdWl2YWxlbnRVcmwoZC5pdGVtKGUpLmhyZWYsdGhpcy50aGVtZSkpe2M9ITE7YnJlYWt9YyYmKGM9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxpbmtcIiksYy5zZXRBdHRyaWJ1dGUoXCJyZWxcIixcInN0eWxlc2hlZXRcIiksYy5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsXCJ0ZXh0L2Nzc1wiKSxjLnNldEF0dHJpYnV0ZShcImhyZWZcIix0aGlzLnRoZW1lKSxkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImhlYWRcIilbMF0uYXBwZW5kQ2hpbGQoYykpfW51bGw9PXRoaXMuY29udHJvbHMmJih0aGlzLmNvbnRyb2xzPVtdLG51bGwhPU9wZW5MYXllcnMuQ29udHJvbCYmKE9wZW5MYXllcnMuQ29udHJvbC5OYXZpZ2F0aW9uP3RoaXMuY29udHJvbHMucHVzaChuZXcgT3BlbkxheWVycy5Db250cm9sLk5hdmlnYXRpb24pOk9wZW5MYXllcnMuQ29udHJvbC5Ub3VjaE5hdmlnYXRpb24mJnRoaXMuY29udHJvbHMucHVzaChuZXcgT3BlbkxheWVycy5Db250cm9sLlRvdWNoTmF2aWdhdGlvbiksXG5PcGVuTGF5ZXJzLkNvbnRyb2wuWm9vbT90aGlzLmNvbnRyb2xzLnB1c2gobmV3IE9wZW5MYXllcnMuQ29udHJvbC5ab29tKTpPcGVuTGF5ZXJzLkNvbnRyb2wuUGFuWm9vbSYmdGhpcy5jb250cm9scy5wdXNoKG5ldyBPcGVuTGF5ZXJzLkNvbnRyb2wuUGFuWm9vbSksT3BlbkxheWVycy5Db250cm9sLkFyZ1BhcnNlciYmdGhpcy5jb250cm9scy5wdXNoKG5ldyBPcGVuTGF5ZXJzLkNvbnRyb2wuQXJnUGFyc2VyKSxPcGVuTGF5ZXJzLkNvbnRyb2wuQXR0cmlidXRpb24mJnRoaXMuY29udHJvbHMucHVzaChuZXcgT3BlbkxheWVycy5Db250cm9sLkF0dHJpYnV0aW9uKSkpO2U9MDtmb3IoZj10aGlzLmNvbnRyb2xzLmxlbmd0aDtlPGY7ZSsrKXRoaXMuYWRkQ29udHJvbFRvTWFwKHRoaXMuY29udHJvbHNbZV0pO3RoaXMucG9wdXBzPVtdO3RoaXMudW5sb2FkRGVzdHJveT1PcGVuTGF5ZXJzLkZ1bmN0aW9uLmJpbmQodGhpcy5kZXN0cm95LHRoaXMpO09wZW5MYXllcnMuRXZlbnQub2JzZXJ2ZSh3aW5kb3csXG5cInVubG9hZFwiLHRoaXMudW5sb2FkRGVzdHJveSk7YiYmYi5sYXllcnMmJihkZWxldGUgdGhpcy5jZW50ZXIsdGhpcy5hZGRMYXllcnMoYi5sYXllcnMpLGIuY2VudGVyJiYhdGhpcy5nZXRDZW50ZXIoKSYmdGhpcy5zZXRDZW50ZXIoYi5jZW50ZXIsYi56b29tKSl9LGdldFZpZXdwb3J0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudmlld1BvcnREaXZ9LHJlbmRlcjpmdW5jdGlvbihhKXt0aGlzLmRpdj1PcGVuTGF5ZXJzLlV0aWwuZ2V0RWxlbWVudChhKTtPcGVuTGF5ZXJzLkVsZW1lbnQuYWRkQ2xhc3ModGhpcy5kaXYsXCJvbE1hcFwiKTt0aGlzLnZpZXdQb3J0RGl2LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy52aWV3UG9ydERpdik7dGhpcy5kaXYuYXBwZW5kQ2hpbGQodGhpcy52aWV3UG9ydERpdik7dGhpcy51cGRhdGVTaXplKCl9LHVubG9hZERlc3Ryb3k6bnVsbCx1cGRhdGVTaXplRGVzdHJveTpudWxsLGRlc3Ryb3k6ZnVuY3Rpb24oKXtpZighdGhpcy51bmxvYWREZXN0cm95KXJldHVybiExO1xudGhpcy5wYW5Ud2VlbiYmKHRoaXMucGFuVHdlZW4uc3RvcCgpLHRoaXMucGFuVHdlZW49bnVsbCk7T3BlbkxheWVycy5FdmVudC5zdG9wT2JzZXJ2aW5nKHdpbmRvdyxcInVubG9hZFwiLHRoaXMudW5sb2FkRGVzdHJveSk7dGhpcy51bmxvYWREZXN0cm95PW51bGw7dGhpcy51cGRhdGVTaXplRGVzdHJveT9PcGVuTGF5ZXJzLkV2ZW50LnN0b3BPYnNlcnZpbmcod2luZG93LFwicmVzaXplXCIsdGhpcy51cGRhdGVTaXplRGVzdHJveSk6dGhpcy5ldmVudHMudW5yZWdpc3RlcihcInJlc2l6ZVwiLHRoaXMsdGhpcy51cGRhdGVTaXplKTt0aGlzLnBhZGRpbmdGb3JQb3B1cHM9bnVsbDtpZihudWxsIT10aGlzLmNvbnRyb2xzKXtmb3IodmFyIGE9dGhpcy5jb250cm9scy5sZW5ndGgtMTswPD1hOy0tYSl0aGlzLmNvbnRyb2xzW2FdLmRlc3Ryb3koKTt0aGlzLmNvbnRyb2xzPW51bGx9aWYobnVsbCE9dGhpcy5sYXllcnMpe2ZvcihhPXRoaXMubGF5ZXJzLmxlbmd0aC0xOzA8PWE7LS1hKXRoaXMubGF5ZXJzW2FdLmRlc3Ryb3koITEpO1xudGhpcy5sYXllcnM9bnVsbH10aGlzLnZpZXdQb3J0RGl2JiZ0aGlzLmRpdi5yZW1vdmVDaGlsZCh0aGlzLnZpZXdQb3J0RGl2KTt0aGlzLnZpZXdQb3J0RGl2PW51bGw7dGhpcy5ldmVudExpc3RlbmVycyYmKHRoaXMuZXZlbnRzLnVuKHRoaXMuZXZlbnRMaXN0ZW5lcnMpLHRoaXMuZXZlbnRMaXN0ZW5lcnM9bnVsbCk7dGhpcy5ldmVudHMuZGVzdHJveSgpO3RoaXMub3B0aW9ucz10aGlzLmV2ZW50cz1udWxsfSxzZXRPcHRpb25zOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMubWluUHgmJmEucmVzdHJpY3RlZEV4dGVudCE9dGhpcy5yZXN0cmljdGVkRXh0ZW50O09wZW5MYXllcnMuVXRpbC5leHRlbmQodGhpcyxhKTtiJiZ0aGlzLm1vdmVUbyh0aGlzLmdldENhY2hlZENlbnRlcigpLHRoaXMuem9vbSx7Zm9yY2Vab29tQ2hhbmdlOiEwfSl9LGdldFRpbGVTaXplOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudGlsZVNpemV9LGdldEJ5OmZ1bmN0aW9uKGEsYixjKXt2YXIgZD1cImZ1bmN0aW9uXCI9PVxudHlwZW9mIGMudGVzdDtyZXR1cm4gT3BlbkxheWVycy5BcnJheS5maWx0ZXIodGhpc1thXSxmdW5jdGlvbihhKXtyZXR1cm4gYVtiXT09Y3x8ZCYmYy50ZXN0KGFbYl0pfSl9LGdldExheWVyc0J5OmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuZ2V0QnkoXCJsYXllcnNcIixhLGIpfSxnZXRMYXllcnNCeU5hbWU6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuZ2V0TGF5ZXJzQnkoXCJuYW1lXCIsYSl9LGdldExheWVyc0J5Q2xhc3M6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuZ2V0TGF5ZXJzQnkoXCJDTEFTU19OQU1FXCIsYSl9LGdldENvbnRyb2xzQnk6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5nZXRCeShcImNvbnRyb2xzXCIsYSxiKX0sZ2V0Q29udHJvbHNCeUNsYXNzOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmdldENvbnRyb2xzQnkoXCJDTEFTU19OQU1FXCIsYSl9LGdldExheWVyOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1udWxsLGM9MCxkPXRoaXMubGF5ZXJzLmxlbmd0aDtjPGQ7YysrKXt2YXIgZT1cbnRoaXMubGF5ZXJzW2NdO2lmKGUuaWQ9PWEpe2I9ZTticmVha319cmV0dXJuIGJ9LHNldExheWVyWkluZGV4OmZ1bmN0aW9uKGEsYil7YS5zZXRaSW5kZXgodGhpcy5aX0lOREVYX0JBU0VbYS5pc0Jhc2VMYXllcj9cIkJhc2VMYXllclwiOlwiT3ZlcmxheVwiXSs1KmIpfSxyZXNldExheWVyc1pJbmRleDpmdW5jdGlvbigpe2Zvcih2YXIgYT0wLGI9dGhpcy5sYXllcnMubGVuZ3RoO2E8YjthKyspdGhpcy5zZXRMYXllclpJbmRleCh0aGlzLmxheWVyc1thXSxhKX0sYWRkTGF5ZXI6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPTAsYz10aGlzLmxheWVycy5sZW5ndGg7YjxjO2IrKylpZih0aGlzLmxheWVyc1tiXT09YSlyZXR1cm4hMTtpZighMT09PXRoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcInByZWFkZGxheWVyXCIse2xheWVyOmF9KSlyZXR1cm4hMTt0aGlzLmFsbE92ZXJsYXlzJiYoYS5pc0Jhc2VMYXllcj0hMSk7YS5kaXYuY2xhc3NOYW1lPVwib2xMYXllckRpdlwiO2EuZGl2LnN0eWxlLm92ZXJmbG93PVxuXCJcIjt0aGlzLnNldExheWVyWkluZGV4KGEsdGhpcy5sYXllcnMubGVuZ3RoKTthLmlzRml4ZWQ/dGhpcy52aWV3UG9ydERpdi5hcHBlbmRDaGlsZChhLmRpdik6dGhpcy5sYXllckNvbnRhaW5lckRpdi5hcHBlbmRDaGlsZChhLmRpdik7dGhpcy5sYXllcnMucHVzaChhKTthLnNldE1hcCh0aGlzKTthLmlzQmFzZUxheWVyfHx0aGlzLmFsbE92ZXJsYXlzJiYhdGhpcy5iYXNlTGF5ZXI/bnVsbD09dGhpcy5iYXNlTGF5ZXI/dGhpcy5zZXRCYXNlTGF5ZXIoYSk6YS5zZXRWaXNpYmlsaXR5KCExKTphLnJlZHJhdygpO3RoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcImFkZGxheWVyXCIse2xheWVyOmF9KTthLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJhZGRlZFwiLHttYXA6dGhpcyxsYXllcjphfSk7YS5hZnRlckFkZCgpO3JldHVybiEwfSxhZGRMYXllcnM6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPTAsYz1hLmxlbmd0aDtiPGM7YisrKXRoaXMuYWRkTGF5ZXIoYVtiXSl9LHJlbW92ZUxheWVyOmZ1bmN0aW9uKGEsXG5iKXtpZighMSE9PXRoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcInByZXJlbW92ZWxheWVyXCIse2xheWVyOmF9KSl7bnVsbD09YiYmKGI9ITApO2EuaXNGaXhlZD90aGlzLnZpZXdQb3J0RGl2LnJlbW92ZUNoaWxkKGEuZGl2KTp0aGlzLmxheWVyQ29udGFpbmVyRGl2LnJlbW92ZUNoaWxkKGEuZGl2KTtPcGVuTGF5ZXJzLlV0aWwucmVtb3ZlSXRlbSh0aGlzLmxheWVycyxhKTthLnJlbW92ZU1hcCh0aGlzKTthLm1hcD1udWxsO2lmKHRoaXMuYmFzZUxheWVyPT1hJiYodGhpcy5iYXNlTGF5ZXI9bnVsbCxiKSlmb3IodmFyIGM9MCxkPXRoaXMubGF5ZXJzLmxlbmd0aDtjPGQ7YysrKXt2YXIgZT10aGlzLmxheWVyc1tjXTtpZihlLmlzQmFzZUxheWVyfHx0aGlzLmFsbE92ZXJsYXlzKXt0aGlzLnNldEJhc2VMYXllcihlKTticmVha319dGhpcy5yZXNldExheWVyc1pJbmRleCgpO3RoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcInJlbW92ZWxheWVyXCIse2xheWVyOmF9KTthLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJyZW1vdmVkXCIsXG57bWFwOnRoaXMsbGF5ZXI6YX0pfX0sZ2V0TnVtTGF5ZXJzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGF5ZXJzLmxlbmd0aH0sZ2V0TGF5ZXJJbmRleDpmdW5jdGlvbihhKXtyZXR1cm4gT3BlbkxheWVycy5VdGlsLmluZGV4T2YodGhpcy5sYXllcnMsYSl9LHNldExheWVySW5kZXg6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmdldExheWVySW5kZXgoYSk7MD5iP2I9MDpiPnRoaXMubGF5ZXJzLmxlbmd0aCYmKGI9dGhpcy5sYXllcnMubGVuZ3RoKTtpZihjIT1iKXt0aGlzLmxheWVycy5zcGxpY2UoYywxKTt0aGlzLmxheWVycy5zcGxpY2UoYiwwLGEpO2Zvcih2YXIgYz0wLGQ9dGhpcy5sYXllcnMubGVuZ3RoO2M8ZDtjKyspdGhpcy5zZXRMYXllclpJbmRleCh0aGlzLmxheWVyc1tjXSxjKTt0aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJjaGFuZ2VsYXllclwiLHtsYXllcjphLHByb3BlcnR5Olwib3JkZXJcIn0pO3RoaXMuYWxsT3ZlcmxheXMmJigwPT09Yj90aGlzLnNldEJhc2VMYXllcihhKTpcbnRoaXMuYmFzZUxheWVyIT09dGhpcy5sYXllcnNbMF0mJnRoaXMuc2V0QmFzZUxheWVyKHRoaXMubGF5ZXJzWzBdKSl9fSxyYWlzZUxheWVyOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5nZXRMYXllckluZGV4KGEpK2I7dGhpcy5zZXRMYXllckluZGV4KGEsYyl9LHNldEJhc2VMYXllcjpmdW5jdGlvbihhKXtpZihhIT10aGlzLmJhc2VMYXllciYmLTEhPU9wZW5MYXllcnMuVXRpbC5pbmRleE9mKHRoaXMubGF5ZXJzLGEpKXt2YXIgYj10aGlzLmdldENhY2hlZENlbnRlcigpLGM9T3BlbkxheWVycy5VdGlsLmdldFJlc29sdXRpb25Gcm9tU2NhbGUodGhpcy5nZXRTY2FsZSgpLGEudW5pdHMpO251bGwhPXRoaXMuYmFzZUxheWVyJiYhdGhpcy5hbGxPdmVybGF5cyYmdGhpcy5iYXNlTGF5ZXIuc2V0VmlzaWJpbGl0eSghMSk7dGhpcy5iYXNlTGF5ZXI9YTtpZighdGhpcy5hbGxPdmVybGF5c3x8dGhpcy5iYXNlTGF5ZXIudmlzaWJpbGl0eSl0aGlzLmJhc2VMYXllci5zZXRWaXNpYmlsaXR5KCEwKSxcbiExPT09dGhpcy5iYXNlTGF5ZXIuaW5SYW5nZSYmdGhpcy5iYXNlTGF5ZXIucmVkcmF3KCk7bnVsbCE9YiYmKGE9dGhpcy5nZXRab29tRm9yUmVzb2x1dGlvbihjfHx0aGlzLnJlc29sdXRpb24sITApLHRoaXMuc2V0Q2VudGVyKGIsYSwhMSwhMCkpO3RoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcImNoYW5nZWJhc2VsYXllclwiLHtsYXllcjp0aGlzLmJhc2VMYXllcn0pfX0sYWRkQ29udHJvbDpmdW5jdGlvbihhLGIpe3RoaXMuY29udHJvbHMucHVzaChhKTt0aGlzLmFkZENvbnRyb2xUb01hcChhLGIpfSxhZGRDb250cm9sczpmdW5jdGlvbihhLGIpe2Zvcih2YXIgYz0xPT09YXJndW1lbnRzLmxlbmd0aD9bXTpiLGQ9MCxlPWEubGVuZ3RoO2Q8ZTtkKyspdGhpcy5hZGRDb250cm9sKGFbZF0sY1tkXT9jW2RdOm51bGwpfSxhZGRDb250cm9sVG9NYXA6ZnVuY3Rpb24oYSxiKXthLm91dHNpZGVWaWV3cG9ydD1udWxsIT1hLmRpdjt0aGlzLmRpc3BsYXlQcm9qZWN0aW9uJiYhYS5kaXNwbGF5UHJvamVjdGlvbiYmXG4oYS5kaXNwbGF5UHJvamVjdGlvbj10aGlzLmRpc3BsYXlQcm9qZWN0aW9uKTthLnNldE1hcCh0aGlzKTt2YXIgYz1hLmRyYXcoYik7YyYmIWEub3V0c2lkZVZpZXdwb3J0JiYoYy5zdHlsZS56SW5kZXg9dGhpcy5aX0lOREVYX0JBU0UuQ29udHJvbCt0aGlzLmNvbnRyb2xzLmxlbmd0aCx0aGlzLnZpZXdQb3J0RGl2LmFwcGVuZENoaWxkKGMpKTthLmF1dG9BY3RpdmF0ZSYmYS5hY3RpdmF0ZSgpfSxnZXRDb250cm9sOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1udWxsLGM9MCxkPXRoaXMuY29udHJvbHMubGVuZ3RoO2M8ZDtjKyspe3ZhciBlPXRoaXMuY29udHJvbHNbY107aWYoZS5pZD09YSl7Yj1lO2JyZWFrfX1yZXR1cm4gYn0scmVtb3ZlQ29udHJvbDpmdW5jdGlvbihhKXthJiZhPT10aGlzLmdldENvbnRyb2woYS5pZCkmJihhLmRpdiYmYS5kaXYucGFyZW50Tm9kZT09dGhpcy52aWV3UG9ydERpdiYmdGhpcy52aWV3UG9ydERpdi5yZW1vdmVDaGlsZChhLmRpdiksT3BlbkxheWVycy5VdGlsLnJlbW92ZUl0ZW0odGhpcy5jb250cm9scyxcbmEpKX0sYWRkUG9wdXA6ZnVuY3Rpb24oYSxiKXtpZihiKWZvcih2YXIgYz10aGlzLnBvcHVwcy5sZW5ndGgtMTswPD1jOy0tYyl0aGlzLnJlbW92ZVBvcHVwKHRoaXMucG9wdXBzW2NdKTthLm1hcD10aGlzO3RoaXMucG9wdXBzLnB1c2goYSk7aWYoYz1hLmRyYXcoKSljLnN0eWxlLnpJbmRleD10aGlzLlpfSU5ERVhfQkFTRS5Qb3B1cCt0aGlzLnBvcHVwcy5sZW5ndGgsdGhpcy5sYXllckNvbnRhaW5lckRpdi5hcHBlbmRDaGlsZChjKX0scmVtb3ZlUG9wdXA6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5VdGlsLnJlbW92ZUl0ZW0odGhpcy5wb3B1cHMsYSk7aWYoYS5kaXYpdHJ5e3RoaXMubGF5ZXJDb250YWluZXJEaXYucmVtb3ZlQ2hpbGQoYS5kaXYpfWNhdGNoKGIpe31hLm1hcD1udWxsfSxnZXRTaXplOmZ1bmN0aW9uKCl7dmFyIGE9bnVsbDtudWxsIT10aGlzLnNpemUmJihhPXRoaXMuc2l6ZS5jbG9uZSgpKTtyZXR1cm4gYX0sdXBkYXRlU2l6ZTpmdW5jdGlvbigpe3ZhciBhPXRoaXMuZ2V0Q3VycmVudFNpemUoKTtcbmlmKGEmJiFpc05hTihhLmgpJiYhaXNOYU4oYS53KSl7dGhpcy5ldmVudHMuY2xlYXJNb3VzZUNhY2hlKCk7dmFyIGI9dGhpcy5nZXRTaXplKCk7bnVsbD09YiYmKHRoaXMuc2l6ZT1iPWEpO2lmKCFhLmVxdWFscyhiKSl7dGhpcy5zaXplPWE7YT0wO2ZvcihiPXRoaXMubGF5ZXJzLmxlbmd0aDthPGI7YSsrKXRoaXMubGF5ZXJzW2FdLm9uTWFwUmVzaXplKCk7YT10aGlzLmdldENhY2hlZENlbnRlcigpO251bGwhPXRoaXMuYmFzZUxheWVyJiZudWxsIT1hJiYoYj10aGlzLmdldFpvb20oKSx0aGlzLnpvb209bnVsbCx0aGlzLnNldENlbnRlcihhLGIpKX19fSxnZXRDdXJyZW50U2l6ZTpmdW5jdGlvbigpe3ZhciBhPW5ldyBPcGVuTGF5ZXJzLlNpemUodGhpcy5kaXYuY2xpZW50V2lkdGgsdGhpcy5kaXYuY2xpZW50SGVpZ2h0KTtpZigwPT1hLncmJjA9PWEuaHx8aXNOYU4oYS53KSYmaXNOYU4oYS5oKSlhLnc9dGhpcy5kaXYub2Zmc2V0V2lkdGgsYS5oPXRoaXMuZGl2Lm9mZnNldEhlaWdodDtcbmlmKDA9PWEudyYmMD09YS5ofHxpc05hTihhLncpJiZpc05hTihhLmgpKWEudz1wYXJzZUludCh0aGlzLmRpdi5zdHlsZS53aWR0aCksYS5oPXBhcnNlSW50KHRoaXMuZGl2LnN0eWxlLmhlaWdodCk7cmV0dXJuIGF9LGNhbGN1bGF0ZUJvdW5kczpmdW5jdGlvbihhLGIpe3ZhciBjPW51bGw7bnVsbD09YSYmKGE9dGhpcy5nZXRDYWNoZWRDZW50ZXIoKSk7bnVsbD09YiYmKGI9dGhpcy5nZXRSZXNvbHV0aW9uKCkpO2lmKG51bGwhPWEmJm51bGwhPWIpdmFyIGM9dGhpcy5zaXplLncqYi8yLGQ9dGhpcy5zaXplLmgqYi8yLGM9bmV3IE9wZW5MYXllcnMuQm91bmRzKGEubG9uLWMsYS5sYXQtZCxhLmxvbitjLGEubGF0K2QpO3JldHVybiBjfSxnZXRDZW50ZXI6ZnVuY3Rpb24oKXt2YXIgYT1udWxsLGI9dGhpcy5nZXRDYWNoZWRDZW50ZXIoKTtiJiYoYT1iLmNsb25lKCkpO3JldHVybiBhfSxnZXRDYWNoZWRDZW50ZXI6ZnVuY3Rpb24oKXshdGhpcy5jZW50ZXImJnRoaXMuc2l6ZSYmKHRoaXMuY2VudGVyPVxudGhpcy5nZXRMb25MYXRGcm9tVmlld1BvcnRQeCh7eDp0aGlzLnNpemUudy8yLHk6dGhpcy5zaXplLmgvMn0pKTtyZXR1cm4gdGhpcy5jZW50ZXJ9LGdldFpvb206ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy56b29tfSxwYW46ZnVuY3Rpb24oYSxiLGMpe2M9T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoYyx7YW5pbWF0ZTohMCxkcmFnZ2luZzohMX0pO2lmKGMuZHJhZ2dpbmcpKDAhPWF8fDAhPWIpJiZ0aGlzLm1vdmVCeVB4KGEsYik7ZWxzZXt2YXIgZD10aGlzLmdldFZpZXdQb3J0UHhGcm9tTG9uTGF0KHRoaXMuZ2V0Q2FjaGVkQ2VudGVyKCkpLGE9ZC5hZGQoYSxiKTtpZih0aGlzLmRyYWdnaW5nfHwhYS5lcXVhbHMoZCkpZD10aGlzLmdldExvbkxhdEZyb21WaWV3UG9ydFB4KGEpLGMuYW5pbWF0ZT90aGlzLnBhblRvKGQpOih0aGlzLm1vdmVUbyhkKSx0aGlzLmRyYWdnaW5nJiYodGhpcy5kcmFnZ2luZz0hMSx0aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJtb3ZlZW5kXCIpKSl9fSxcbnBhblRvOmZ1bmN0aW9uKGEpe2lmKHRoaXMucGFuTWV0aG9kJiZ0aGlzLmdldEV4dGVudCgpLnNjYWxlKHRoaXMucGFuUmF0aW8pLmNvbnRhaW5zTG9uTGF0KGEpKXt0aGlzLnBhblR3ZWVufHwodGhpcy5wYW5Ud2Vlbj1uZXcgT3BlbkxheWVycy5Ud2Vlbih0aGlzLnBhbk1ldGhvZCkpO3ZhciBiPXRoaXMuZ2V0Q2FjaGVkQ2VudGVyKCk7aWYoIWEuZXF1YWxzKGIpKXt2YXIgYj10aGlzLmdldFBpeGVsRnJvbUxvbkxhdChiKSxjPXRoaXMuZ2V0UGl4ZWxGcm9tTG9uTGF0KGEpLGQ9MCxlPTA7dGhpcy5wYW5Ud2Vlbi5zdGFydCh7eDowLHk6MH0se3g6Yy54LWIueCx5OmMueS1iLnl9LHRoaXMucGFuRHVyYXRpb24se2NhbGxiYWNrczp7ZWFjaFN0ZXA6T3BlbkxheWVycy5GdW5jdGlvbi5iaW5kKGZ1bmN0aW9uKGEpe3RoaXMubW92ZUJ5UHgoYS54LWQsYS55LWUpO2Q9TWF0aC5yb3VuZChhLngpO2U9TWF0aC5yb3VuZChhLnkpfSx0aGlzKSxkb25lOk9wZW5MYXllcnMuRnVuY3Rpb24uYmluZChmdW5jdGlvbigpe3RoaXMubW92ZVRvKGEpO1xudGhpcy5kcmFnZ2luZz1mYWxzZTt0aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJtb3ZlZW5kXCIpfSx0aGlzKX19KX19ZWxzZSB0aGlzLnNldENlbnRlcihhKX0sc2V0Q2VudGVyOmZ1bmN0aW9uKGEsYixjLGQpe3RoaXMucGFuVHdlZW4mJnRoaXMucGFuVHdlZW4uc3RvcCgpO3RoaXMubW92ZVRvKGEsYix7ZHJhZ2dpbmc6Yyxmb3JjZVpvb21DaGFuZ2U6ZH0pfSxtb3ZlQnlQeDpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuc2l6ZS53LzIsZD10aGlzLnNpemUuaC8yLGU9YythLGY9ZCtiLGc9dGhpcy5iYXNlTGF5ZXIud3JhcERhdGVMaW5lLGg9MCxpPTA7dGhpcy5yZXN0cmljdGVkRXh0ZW50JiYoaD1jLGk9ZCxnPSExKTthPWd8fGU8PXRoaXMubWF4UHgueC1oJiZlPj10aGlzLm1pblB4LngraD9NYXRoLnJvdW5kKGEpOjA7Yj1mPD10aGlzLm1heFB4LnktaSYmZj49dGhpcy5taW5QeC55K2k/TWF0aC5yb3VuZChiKTowO2lmKGF8fGIpe3RoaXMuZHJhZ2dpbmd8fCh0aGlzLmRyYWdnaW5nPVxuITAsdGhpcy5ldmVudHMudHJpZ2dlckV2ZW50KFwibW92ZXN0YXJ0XCIpKTt0aGlzLmNlbnRlcj1udWxsO2EmJih0aGlzLmxheWVyQ29udGFpbmVyRGl2LnN0eWxlLmxlZnQ9cGFyc2VJbnQodGhpcy5sYXllckNvbnRhaW5lckRpdi5zdHlsZS5sZWZ0KS1hK1wicHhcIix0aGlzLm1pblB4LngtPWEsdGhpcy5tYXhQeC54LT1hKTtiJiYodGhpcy5sYXllckNvbnRhaW5lckRpdi5zdHlsZS50b3A9cGFyc2VJbnQodGhpcy5sYXllckNvbnRhaW5lckRpdi5zdHlsZS50b3ApLWIrXCJweFwiLHRoaXMubWluUHgueS09Yix0aGlzLm1heFB4LnktPWIpO2Q9MDtmb3IoZT10aGlzLmxheWVycy5sZW5ndGg7ZDxlOysrZClpZihjPXRoaXMubGF5ZXJzW2RdLGMudmlzaWJpbGl0eSYmKGM9PT10aGlzLmJhc2VMYXllcnx8Yy5pblJhbmdlKSljLm1vdmVCeVB4KGEsYiksYy5ldmVudHMudHJpZ2dlckV2ZW50KFwibW92ZVwiKTt0aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJtb3ZlXCIpfX0sYWRqdXN0Wm9vbTpmdW5jdGlvbihhKXt2YXIgYj1cbnRoaXMuYmFzZUxheWVyLnJlc29sdXRpb25zLGM9dGhpcy5nZXRNYXhFeHRlbnQoKS5nZXRXaWR0aCgpL3RoaXMuc2l6ZS53O2lmKHRoaXMuZ2V0UmVzb2x1dGlvbkZvclpvb20oYSk+Yylmb3IodmFyIGQ9YXwwLGU9Yi5sZW5ndGg7ZDxlOysrZClpZihiW2RdPD1jKXthPWQ7YnJlYWt9cmV0dXJuIGF9LG1vdmVUbzpmdW5jdGlvbihhLGIsYyl7bnVsbCE9YSYmIShhIGluc3RhbmNlb2YgT3BlbkxheWVycy5Mb25MYXQpJiYoYT1uZXcgT3BlbkxheWVycy5Mb25MYXQoYSkpO2N8fChjPXt9KTtudWxsIT1iJiYoYj1wYXJzZUZsb2F0KGIpLHRoaXMuZnJhY3Rpb25hbFpvb218fChiPU1hdGgucm91bmQoYikpKTtpZih0aGlzLmJhc2VMYXllci53cmFwRGF0ZUxpbmUpe3ZhciBkPWIsYj10aGlzLmFkanVzdFpvb20oYik7YiE9PWQmJihhPXRoaXMuZ2V0Q2VudGVyKCkpfXZhciBkPWMuZHJhZ2dpbmd8fHRoaXMuZHJhZ2dpbmcsZT1jLmZvcmNlWm9vbUNoYW5nZTshdGhpcy5nZXRDYWNoZWRDZW50ZXIoKSYmXG4hdGhpcy5pc1ZhbGlkTG9uTGF0KGEpJiYoYT10aGlzLm1heEV4dGVudC5nZXRDZW50ZXJMb25MYXQoKSx0aGlzLmNlbnRlcj1hLmNsb25lKCkpO2lmKG51bGwhPXRoaXMucmVzdHJpY3RlZEV4dGVudCl7bnVsbD09YSYmKGE9dGhpcy5jZW50ZXIpO251bGw9PWImJihiPXRoaXMuZ2V0Wm9vbSgpKTt2YXIgZj10aGlzLmdldFJlc29sdXRpb25Gb3Jab29tKGIpLGY9dGhpcy5jYWxjdWxhdGVCb3VuZHMoYSxmKTtpZighdGhpcy5yZXN0cmljdGVkRXh0ZW50LmNvbnRhaW5zQm91bmRzKGYpKXt2YXIgZz10aGlzLnJlc3RyaWN0ZWRFeHRlbnQuZ2V0Q2VudGVyTG9uTGF0KCk7Zi5nZXRXaWR0aCgpPnRoaXMucmVzdHJpY3RlZEV4dGVudC5nZXRXaWR0aCgpP2E9bmV3IE9wZW5MYXllcnMuTG9uTGF0KGcubG9uLGEubGF0KTpmLmxlZnQ8dGhpcy5yZXN0cmljdGVkRXh0ZW50LmxlZnQ/YT1hLmFkZCh0aGlzLnJlc3RyaWN0ZWRFeHRlbnQubGVmdC1mLmxlZnQsMCk6Zi5yaWdodD50aGlzLnJlc3RyaWN0ZWRFeHRlbnQucmlnaHQmJlxuKGE9YS5hZGQodGhpcy5yZXN0cmljdGVkRXh0ZW50LnJpZ2h0LWYucmlnaHQsMCkpO2YuZ2V0SGVpZ2h0KCk+dGhpcy5yZXN0cmljdGVkRXh0ZW50LmdldEhlaWdodCgpP2E9bmV3IE9wZW5MYXllcnMuTG9uTGF0KGEubG9uLGcubGF0KTpmLmJvdHRvbTx0aGlzLnJlc3RyaWN0ZWRFeHRlbnQuYm90dG9tP2E9YS5hZGQoMCx0aGlzLnJlc3RyaWN0ZWRFeHRlbnQuYm90dG9tLWYuYm90dG9tKTpmLnRvcD50aGlzLnJlc3RyaWN0ZWRFeHRlbnQudG9wJiYoYT1hLmFkZCgwLHRoaXMucmVzdHJpY3RlZEV4dGVudC50b3AtZi50b3ApKX19ZT1lfHx0aGlzLmlzVmFsaWRab29tTGV2ZWwoYikmJmIhPXRoaXMuZ2V0Wm9vbSgpO2Y9dGhpcy5pc1ZhbGlkTG9uTGF0KGEpJiYhYS5lcXVhbHModGhpcy5jZW50ZXIpO2lmKGV8fGZ8fGQpe2R8fHRoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcIm1vdmVzdGFydFwiKTtmJiYoIWUmJnRoaXMuY2VudGVyJiZ0aGlzLmNlbnRlckxheWVyQ29udGFpbmVyKGEpLHRoaXMuY2VudGVyPVxuYS5jbG9uZSgpKTthPWU/dGhpcy5nZXRSZXNvbHV0aW9uRm9yWm9vbShiKTp0aGlzLmdldFJlc29sdXRpb24oKTtpZihlfHxudWxsPT10aGlzLmxheWVyQ29udGFpbmVyT3JpZ2luKXt0aGlzLmxheWVyQ29udGFpbmVyT3JpZ2luPXRoaXMuZ2V0Q2FjaGVkQ2VudGVyKCk7dGhpcy5sYXllckNvbnRhaW5lckRpdi5zdHlsZS5sZWZ0PVwiMHB4XCI7dGhpcy5sYXllckNvbnRhaW5lckRpdi5zdHlsZS50b3A9XCIwcHhcIjt2YXIgZj10aGlzLmdldE1heEV4dGVudCh7cmVzdHJpY3RlZDohMH0pLGg9Zi5nZXRDZW50ZXJMb25MYXQoKSxnPXRoaXMuY2VudGVyLmxvbi1oLmxvbixoPWgubGF0LXRoaXMuY2VudGVyLmxhdCxpPU1hdGgucm91bmQoZi5nZXRXaWR0aCgpL2EpLGo9TWF0aC5yb3VuZChmLmdldEhlaWdodCgpL2EpO3RoaXMubWluUHg9e3g6KHRoaXMuc2l6ZS53LWkpLzItZy9hLHk6KHRoaXMuc2l6ZS5oLWopLzItaC9hfTt0aGlzLm1heFB4PXt4OnRoaXMubWluUHgueCtNYXRoLnJvdW5kKGYuZ2V0V2lkdGgoKS9cbmEpLHk6dGhpcy5taW5QeC55K01hdGgucm91bmQoZi5nZXRIZWlnaHQoKS9hKX19ZSYmKHRoaXMuem9vbT1iLHRoaXMucmVzb2x1dGlvbj1hKTthPXRoaXMuZ2V0RXh0ZW50KCk7dGhpcy5iYXNlTGF5ZXIudmlzaWJpbGl0eSYmKHRoaXMuYmFzZUxheWVyLm1vdmVUbyhhLGUsYy5kcmFnZ2luZyksYy5kcmFnZ2luZ3x8dGhpcy5iYXNlTGF5ZXIuZXZlbnRzLnRyaWdnZXJFdmVudChcIm1vdmVlbmRcIix7em9vbUNoYW5nZWQ6ZX0pKTthPXRoaXMuYmFzZUxheWVyLmdldEV4dGVudCgpO2ZvcihiPXRoaXMubGF5ZXJzLmxlbmd0aC0xOzA8PWI7LS1iKWlmKGY9dGhpcy5sYXllcnNbYl0sZiE9PXRoaXMuYmFzZUxheWVyJiYhZi5pc0Jhc2VMYXllciYmKGc9Zi5jYWxjdWxhdGVJblJhbmdlKCksZi5pblJhbmdlIT1nJiYoKGYuaW5SYW5nZT1nKXx8Zi5kaXNwbGF5KCExKSx0aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJjaGFuZ2VsYXllclwiLHtsYXllcjpmLHByb3BlcnR5OlwidmlzaWJpbGl0eVwifSkpLFxuZyYmZi52aXNpYmlsaXR5KSlmLm1vdmVUbyhhLGUsYy5kcmFnZ2luZyksYy5kcmFnZ2luZ3x8Zi5ldmVudHMudHJpZ2dlckV2ZW50KFwibW92ZWVuZFwiLHt6b29tQ2hhbmdlZDplfSk7dGhpcy5ldmVudHMudHJpZ2dlckV2ZW50KFwibW92ZVwiKTtkfHx0aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJtb3ZlZW5kXCIpO2lmKGUpe2I9MDtmb3IoYz10aGlzLnBvcHVwcy5sZW5ndGg7YjxjO2IrKyl0aGlzLnBvcHVwc1tiXS51cGRhdGVQb3NpdGlvbigpO3RoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcInpvb21lbmRcIil9fX0sY2VudGVyTGF5ZXJDb250YWluZXI6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5nZXRWaWV3UG9ydFB4RnJvbUxvbkxhdCh0aGlzLmxheWVyQ29udGFpbmVyT3JpZ2luKSxjPXRoaXMuZ2V0Vmlld1BvcnRQeEZyb21Mb25MYXQoYSk7aWYobnVsbCE9YiYmbnVsbCE9Yyl7dmFyIGQ9cGFyc2VJbnQodGhpcy5sYXllckNvbnRhaW5lckRpdi5zdHlsZS5sZWZ0KSxhPXBhcnNlSW50KHRoaXMubGF5ZXJDb250YWluZXJEaXYuc3R5bGUudG9wKSxcbmU9TWF0aC5yb3VuZChiLngtYy54KSxiPU1hdGgucm91bmQoYi55LWMueSk7dGhpcy5sYXllckNvbnRhaW5lckRpdi5zdHlsZS5sZWZ0PWUrXCJweFwiO3RoaXMubGF5ZXJDb250YWluZXJEaXYuc3R5bGUudG9wPWIrXCJweFwiO2QtPWU7YS09Yjt0aGlzLm1pblB4LngtPWQ7dGhpcy5tYXhQeC54LT1kO3RoaXMubWluUHgueS09YTt0aGlzLm1heFB4LnktPWF9fSxpc1ZhbGlkWm9vbUxldmVsOmZ1bmN0aW9uKGEpe3JldHVybiBudWxsIT1hJiYwPD1hJiZhPHRoaXMuZ2V0TnVtWm9vbUxldmVscygpfSxpc1ZhbGlkTG9uTGF0OmZ1bmN0aW9uKGEpe3ZhciBiPSExO251bGwhPWEmJihiPXRoaXMuZ2V0TWF4RXh0ZW50KCksYj1iLmNvbnRhaW5zTG9uTGF0KGEse3dvcmxkQm91bmRzOnRoaXMuYmFzZUxheWVyLndyYXBEYXRlTGluZSYmYn0pKTtyZXR1cm4gYn0sZ2V0UHJvamVjdGlvbjpmdW5jdGlvbigpe3ZhciBhPXRoaXMuZ2V0UHJvamVjdGlvbk9iamVjdCgpO3JldHVybiBhP2EuZ2V0Q29kZSgpOlxubnVsbH0sZ2V0UHJvamVjdGlvbk9iamVjdDpmdW5jdGlvbigpe3ZhciBhPW51bGw7bnVsbCE9dGhpcy5iYXNlTGF5ZXImJihhPXRoaXMuYmFzZUxheWVyLnByb2plY3Rpb24pO3JldHVybiBhfSxnZXRNYXhSZXNvbHV0aW9uOmZ1bmN0aW9uKCl7dmFyIGE9bnVsbDtudWxsIT10aGlzLmJhc2VMYXllciYmKGE9dGhpcy5iYXNlTGF5ZXIubWF4UmVzb2x1dGlvbik7cmV0dXJuIGF9LGdldE1heEV4dGVudDpmdW5jdGlvbihhKXt2YXIgYj1udWxsO2EmJmEucmVzdHJpY3RlZCYmdGhpcy5yZXN0cmljdGVkRXh0ZW50P2I9dGhpcy5yZXN0cmljdGVkRXh0ZW50Om51bGwhPXRoaXMuYmFzZUxheWVyJiYoYj10aGlzLmJhc2VMYXllci5tYXhFeHRlbnQpO3JldHVybiBifSxnZXROdW1ab29tTGV2ZWxzOmZ1bmN0aW9uKCl7dmFyIGE9bnVsbDtudWxsIT10aGlzLmJhc2VMYXllciYmKGE9dGhpcy5iYXNlTGF5ZXIubnVtWm9vbUxldmVscyk7cmV0dXJuIGF9LGdldEV4dGVudDpmdW5jdGlvbigpe3ZhciBhPVxubnVsbDtudWxsIT10aGlzLmJhc2VMYXllciYmKGE9dGhpcy5iYXNlTGF5ZXIuZ2V0RXh0ZW50KCkpO3JldHVybiBhfSxnZXRSZXNvbHV0aW9uOmZ1bmN0aW9uKCl7dmFyIGE9bnVsbDtudWxsIT10aGlzLmJhc2VMYXllcj9hPXRoaXMuYmFzZUxheWVyLmdldFJlc29sdXRpb24oKTohMD09PXRoaXMuYWxsT3ZlcmxheXMmJjA8dGhpcy5sYXllcnMubGVuZ3RoJiYoYT10aGlzLmxheWVyc1swXS5nZXRSZXNvbHV0aW9uKCkpO3JldHVybiBhfSxnZXRVbml0czpmdW5jdGlvbigpe3ZhciBhPW51bGw7bnVsbCE9dGhpcy5iYXNlTGF5ZXImJihhPXRoaXMuYmFzZUxheWVyLnVuaXRzKTtyZXR1cm4gYX0sZ2V0U2NhbGU6ZnVuY3Rpb24oKXt2YXIgYT1udWxsO251bGwhPXRoaXMuYmFzZUxheWVyJiYoYT10aGlzLmdldFJlc29sdXRpb24oKSxhPU9wZW5MYXllcnMuVXRpbC5nZXRTY2FsZUZyb21SZXNvbHV0aW9uKGEsdGhpcy5iYXNlTGF5ZXIudW5pdHMpKTtyZXR1cm4gYX0sZ2V0Wm9vbUZvckV4dGVudDpmdW5jdGlvbihhLFxuYil7dmFyIGM9bnVsbDtudWxsIT10aGlzLmJhc2VMYXllciYmKGM9dGhpcy5iYXNlTGF5ZXIuZ2V0Wm9vbUZvckV4dGVudChhLGIpKTtyZXR1cm4gY30sZ2V0UmVzb2x1dGlvbkZvclpvb206ZnVuY3Rpb24oYSl7dmFyIGI9bnVsbDt0aGlzLmJhc2VMYXllciYmKGI9dGhpcy5iYXNlTGF5ZXIuZ2V0UmVzb2x1dGlvbkZvclpvb20oYSkpO3JldHVybiBifSxnZXRab29tRm9yUmVzb2x1dGlvbjpmdW5jdGlvbihhLGIpe3ZhciBjPW51bGw7bnVsbCE9dGhpcy5iYXNlTGF5ZXImJihjPXRoaXMuYmFzZUxheWVyLmdldFpvb21Gb3JSZXNvbHV0aW9uKGEsYikpO3JldHVybiBjfSx6b29tVG86ZnVuY3Rpb24oYSl7dGhpcy5pc1ZhbGlkWm9vbUxldmVsKGEpJiZ0aGlzLnNldENlbnRlcihudWxsLGEpfSx6b29tSW46ZnVuY3Rpb24oKXt0aGlzLnpvb21Ubyh0aGlzLmdldFpvb20oKSsxKX0sem9vbU91dDpmdW5jdGlvbigpe3RoaXMuem9vbVRvKHRoaXMuZ2V0Wm9vbSgpLTEpfSx6b29tVG9FeHRlbnQ6ZnVuY3Rpb24oYSxcbmIpe2EgaW5zdGFuY2VvZiBPcGVuTGF5ZXJzLkJvdW5kc3x8KGE9bmV3IE9wZW5MYXllcnMuQm91bmRzKGEpKTt2YXIgYz1hLmdldENlbnRlckxvbkxhdCgpO2lmKHRoaXMuYmFzZUxheWVyLndyYXBEYXRlTGluZSl7Yz10aGlzLmdldE1heEV4dGVudCgpO2ZvcihhPWEuY2xvbmUoKTthLnJpZ2h0PGEubGVmdDspYS5yaWdodCs9Yy5nZXRXaWR0aCgpO2M9YS5nZXRDZW50ZXJMb25MYXQoKS53cmFwRGF0ZUxpbmUoYyl9dGhpcy5zZXRDZW50ZXIoYyx0aGlzLmdldFpvb21Gb3JFeHRlbnQoYSxiKSl9LHpvb21Ub01heEV4dGVudDpmdW5jdGlvbihhKXt0aGlzLnpvb21Ub0V4dGVudCh0aGlzLmdldE1heEV4dGVudCh7cmVzdHJpY3RlZDphP2EucmVzdHJpY3RlZDohMH0pKX0sem9vbVRvU2NhbGU6ZnVuY3Rpb24oYSxiKXt2YXIgYz1PcGVuTGF5ZXJzLlV0aWwuZ2V0UmVzb2x1dGlvbkZyb21TY2FsZShhLHRoaXMuYmFzZUxheWVyLnVuaXRzKSxkPXRoaXMuc2l6ZS53KmMvMixjPXRoaXMuc2l6ZS5oKlxuYy8yLGU9dGhpcy5nZXRDYWNoZWRDZW50ZXIoKTt0aGlzLnpvb21Ub0V4dGVudChuZXcgT3BlbkxheWVycy5Cb3VuZHMoZS5sb24tZCxlLmxhdC1jLGUubG9uK2QsZS5sYXQrYyksYil9LGdldExvbkxhdEZyb21WaWV3UG9ydFB4OmZ1bmN0aW9uKGEpe3ZhciBiPW51bGw7bnVsbCE9dGhpcy5iYXNlTGF5ZXImJihiPXRoaXMuYmFzZUxheWVyLmdldExvbkxhdEZyb21WaWV3UG9ydFB4KGEpKTtyZXR1cm4gYn0sZ2V0Vmlld1BvcnRQeEZyb21Mb25MYXQ6ZnVuY3Rpb24oYSl7dmFyIGI9bnVsbDtudWxsIT10aGlzLmJhc2VMYXllciYmKGI9dGhpcy5iYXNlTGF5ZXIuZ2V0Vmlld1BvcnRQeEZyb21Mb25MYXQoYSkpO3JldHVybiBifSxnZXRMb25MYXRGcm9tUGl4ZWw6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuZ2V0TG9uTGF0RnJvbVZpZXdQb3J0UHgoYSl9LGdldFBpeGVsRnJvbUxvbkxhdDpmdW5jdGlvbihhKXthPXRoaXMuZ2V0Vmlld1BvcnRQeEZyb21Mb25MYXQoYSk7YS54PU1hdGgucm91bmQoYS54KTtcbmEueT1NYXRoLnJvdW5kKGEueSk7cmV0dXJuIGF9LGdldEdlb2Rlc2ljUGl4ZWxTaXplOmZ1bmN0aW9uKGEpe3ZhciBiPWE/dGhpcy5nZXRMb25MYXRGcm9tUGl4ZWwoYSk6dGhpcy5nZXRDYWNoZWRDZW50ZXIoKXx8bmV3IE9wZW5MYXllcnMuTG9uTGF0KDAsMCksYz10aGlzLmdldFJlc29sdXRpb24oKSxhPWIuYWRkKC1jLzIsMCksZD1iLmFkZChjLzIsMCksZT1iLmFkZCgwLC1jLzIpLGI9Yi5hZGQoMCxjLzIpLGM9bmV3IE9wZW5MYXllcnMuUHJvamVjdGlvbihcIkVQU0c6NDMyNlwiKSxmPXRoaXMuZ2V0UHJvamVjdGlvbk9iamVjdCgpfHxjO2YuZXF1YWxzKGMpfHwoYS50cmFuc2Zvcm0oZixjKSxkLnRyYW5zZm9ybShmLGMpLGUudHJhbnNmb3JtKGYsYyksYi50cmFuc2Zvcm0oZixjKSk7cmV0dXJuIG5ldyBPcGVuTGF5ZXJzLlNpemUoT3BlbkxheWVycy5VdGlsLmRpc3RWaW5jZW50eShhLGQpLE9wZW5MYXllcnMuVXRpbC5kaXN0VmluY2VudHkoZSxiKSl9LGdldFZpZXdQb3J0UHhGcm9tTGF5ZXJQeDpmdW5jdGlvbihhKXt2YXIgYj1cbm51bGw7aWYobnVsbCE9YSl2YXIgYj1wYXJzZUludCh0aGlzLmxheWVyQ29udGFpbmVyRGl2LnN0eWxlLmxlZnQpLGM9cGFyc2VJbnQodGhpcy5sYXllckNvbnRhaW5lckRpdi5zdHlsZS50b3ApLGI9YS5hZGQoYixjKTtyZXR1cm4gYn0sZ2V0TGF5ZXJQeEZyb21WaWV3UG9ydFB4OmZ1bmN0aW9uKGEpe3ZhciBiPW51bGw7aWYobnVsbCE9YSl7dmFyIGI9LXBhcnNlSW50KHRoaXMubGF5ZXJDb250YWluZXJEaXYuc3R5bGUubGVmdCksYz0tcGFyc2VJbnQodGhpcy5sYXllckNvbnRhaW5lckRpdi5zdHlsZS50b3ApLGI9YS5hZGQoYixjKTtpZihpc05hTihiLngpfHxpc05hTihiLnkpKWI9bnVsbH1yZXR1cm4gYn0sZ2V0TG9uTGF0RnJvbUxheWVyUHg6ZnVuY3Rpb24oYSl7YT10aGlzLmdldFZpZXdQb3J0UHhGcm9tTGF5ZXJQeChhKTtyZXR1cm4gdGhpcy5nZXRMb25MYXRGcm9tVmlld1BvcnRQeChhKX0sZ2V0TGF5ZXJQeEZyb21Mb25MYXQ6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuZ2V0TGF5ZXJQeEZyb21WaWV3UG9ydFB4KHRoaXMuZ2V0UGl4ZWxGcm9tTG9uTGF0KGEpKX0sXG5DTEFTU19OQU1FOlwiT3BlbkxheWVycy5NYXBcIn0pO09wZW5MYXllcnMuTWFwLlRJTEVfV0lEVEg9MjU2O09wZW5MYXllcnMuTWFwLlRJTEVfSEVJR0hUPTI1NjtPcGVuTGF5ZXJzLkxheWVyPU9wZW5MYXllcnMuQ2xhc3Moe2lkOm51bGwsbmFtZTpudWxsLGRpdjpudWxsLG9wYWNpdHk6MSxhbHdheXNJblJhbmdlOm51bGwsUkVTT0xVVElPTl9QUk9QRVJUSUVTOlwic2NhbGVzIHJlc29sdXRpb25zIG1heFNjYWxlIG1pblNjYWxlIG1heFJlc29sdXRpb24gbWluUmVzb2x1dGlvbiBudW1ab29tTGV2ZWxzIG1heFpvb21MZXZlbFwiLnNwbGl0KFwiIFwiKSxldmVudHM6bnVsbCxtYXA6bnVsbCxpc0Jhc2VMYXllcjohMSxhbHBoYTohMSxkaXNwbGF5SW5MYXllclN3aXRjaGVyOiEwLHZpc2liaWxpdHk6ITAsYXR0cmlidXRpb246bnVsbCxpblJhbmdlOiExLGltYWdlU2l6ZTpudWxsLG9wdGlvbnM6bnVsbCxldmVudExpc3RlbmVyczpudWxsLGd1dHRlcjowLHByb2plY3Rpb246bnVsbCx1bml0czpudWxsLHNjYWxlczpudWxsLHJlc29sdXRpb25zOm51bGwsbWF4RXh0ZW50Om51bGwsbWluRXh0ZW50Om51bGwsbWF4UmVzb2x1dGlvbjpudWxsLG1pblJlc29sdXRpb246bnVsbCxcbm51bVpvb21MZXZlbHM6bnVsbCxtaW5TY2FsZTpudWxsLG1heFNjYWxlOm51bGwsZGlzcGxheU91dHNpZGVNYXhFeHRlbnQ6ITEsd3JhcERhdGVMaW5lOiExLG1ldGFkYXRhOm51bGwsaW5pdGlhbGl6ZTpmdW5jdGlvbihhLGIpe3RoaXMubWV0YWRhdGE9e307dGhpcy5hZGRPcHRpb25zKGIpO3RoaXMubmFtZT1hO2lmKG51bGw9PXRoaXMuaWQmJih0aGlzLmlkPU9wZW5MYXllcnMuVXRpbC5jcmVhdGVVbmlxdWVJRCh0aGlzLkNMQVNTX05BTUUrXCJfXCIpLHRoaXMuZGl2PU9wZW5MYXllcnMuVXRpbC5jcmVhdGVEaXYodGhpcy5pZCksdGhpcy5kaXYuc3R5bGUud2lkdGg9XCIxMDAlXCIsdGhpcy5kaXYuc3R5bGUuaGVpZ2h0PVwiMTAwJVwiLHRoaXMuZGl2LmRpcj1cImx0clwiLHRoaXMuZXZlbnRzPW5ldyBPcGVuTGF5ZXJzLkV2ZW50cyh0aGlzLHRoaXMuZGl2KSx0aGlzLmV2ZW50TGlzdGVuZXJzIGluc3RhbmNlb2YgT2JqZWN0KSl0aGlzLmV2ZW50cy5vbih0aGlzLmV2ZW50TGlzdGVuZXJzKX0sXG5kZXN0cm95OmZ1bmN0aW9uKGEpe251bGw9PWEmJihhPSEwKTtudWxsIT10aGlzLm1hcCYmdGhpcy5tYXAucmVtb3ZlTGF5ZXIodGhpcyxhKTt0aGlzLm9wdGlvbnM9dGhpcy5kaXY9dGhpcy5uYW1lPXRoaXMubWFwPXRoaXMucHJvamVjdGlvbj1udWxsO3RoaXMuZXZlbnRzJiYodGhpcy5ldmVudExpc3RlbmVycyYmdGhpcy5ldmVudHMudW4odGhpcy5ldmVudExpc3RlbmVycyksdGhpcy5ldmVudHMuZGVzdHJveSgpKTt0aGlzLmV2ZW50cz10aGlzLmV2ZW50TGlzdGVuZXJzPW51bGx9LGNsb25lOmZ1bmN0aW9uKGEpe251bGw9PWEmJihhPW5ldyBPcGVuTGF5ZXJzLkxheWVyKHRoaXMubmFtZSx0aGlzLmdldE9wdGlvbnMoKSkpO09wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKGEsdGhpcyk7YS5tYXA9bnVsbDtyZXR1cm4gYX0sZ2V0T3B0aW9uczpmdW5jdGlvbigpe3ZhciBhPXt9LGI7Zm9yKGIgaW4gdGhpcy5vcHRpb25zKWFbYl09dGhpc1tiXTtyZXR1cm4gYX0sc2V0TmFtZTpmdW5jdGlvbihhKXthIT1cbnRoaXMubmFtZSYmKHRoaXMubmFtZT1hLG51bGwhPXRoaXMubWFwJiZ0aGlzLm1hcC5ldmVudHMudHJpZ2dlckV2ZW50KFwiY2hhbmdlbGF5ZXJcIix7bGF5ZXI6dGhpcyxwcm9wZXJ0eTpcIm5hbWVcIn0pKX0sYWRkT3B0aW9uczpmdW5jdGlvbihhLGIpe251bGw9PXRoaXMub3B0aW9ucyYmKHRoaXMub3B0aW9ucz17fSk7aWYoYSYmKFwic3RyaW5nXCI9PXR5cGVvZiBhLnByb2plY3Rpb24mJihhLnByb2plY3Rpb249bmV3IE9wZW5MYXllcnMuUHJvamVjdGlvbihhLnByb2plY3Rpb24pKSxhLnByb2plY3Rpb24mJk9wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKGEsT3BlbkxheWVycy5Qcm9qZWN0aW9uLmRlZmF1bHRzW2EucHJvamVjdGlvbi5nZXRDb2RlKCldKSxhLm1heEV4dGVudCYmIShhLm1heEV4dGVudCBpbnN0YW5jZW9mIE9wZW5MYXllcnMuQm91bmRzKSYmKGEubWF4RXh0ZW50PW5ldyBPcGVuTGF5ZXJzLkJvdW5kcyhhLm1heEV4dGVudCkpLGEubWluRXh0ZW50JiYhKGEubWluRXh0ZW50IGluc3RhbmNlb2Zcbk9wZW5MYXllcnMuQm91bmRzKSkpYS5taW5FeHRlbnQ9bmV3IE9wZW5MYXllcnMuQm91bmRzKGEubWluRXh0ZW50KTtPcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHRoaXMub3B0aW9ucyxhKTtPcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHRoaXMsYSk7dGhpcy5wcm9qZWN0aW9uJiZ0aGlzLnByb2plY3Rpb24uZ2V0VW5pdHMoKSYmKHRoaXMudW5pdHM9dGhpcy5wcm9qZWN0aW9uLmdldFVuaXRzKCkpO2lmKHRoaXMubWFwKXt2YXIgYz10aGlzLm1hcC5nZXRSZXNvbHV0aW9uKCksZD10aGlzLlJFU09MVVRJT05fUFJPUEVSVElFUy5jb25jYXQoW1wicHJvamVjdGlvblwiLFwidW5pdHNcIixcIm1pbkV4dGVudFwiLFwibWF4RXh0ZW50XCJdKSxlO2ZvcihlIGluIGEpaWYoYS5oYXNPd25Qcm9wZXJ0eShlKSYmMDw9T3BlbkxheWVycy5VdGlsLmluZGV4T2YoZCxlKSl7dGhpcy5pbml0UmVzb2x1dGlvbnMoKTtiJiZ0aGlzLm1hcC5iYXNlTGF5ZXI9PT10aGlzJiYodGhpcy5tYXAuc2V0Q2VudGVyKHRoaXMubWFwLmdldENlbnRlcigpLFxudGhpcy5tYXAuZ2V0Wm9vbUZvclJlc29sdXRpb24oYyksITEsITApLHRoaXMubWFwLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJjaGFuZ2ViYXNlbGF5ZXJcIix7bGF5ZXI6dGhpc30pKTticmVha319fSxvbk1hcFJlc2l6ZTpmdW5jdGlvbigpe30scmVkcmF3OmZ1bmN0aW9uKCl7dmFyIGE9ITE7aWYodGhpcy5tYXApe3RoaXMuaW5SYW5nZT10aGlzLmNhbGN1bGF0ZUluUmFuZ2UoKTt2YXIgYj10aGlzLmdldEV4dGVudCgpO2ImJih0aGlzLmluUmFuZ2UmJnRoaXMudmlzaWJpbGl0eSkmJih0aGlzLm1vdmVUbyhiLCEwLCExKSx0aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJtb3ZlZW5kXCIse3pvb21DaGFuZ2VkOiEwfSksYT0hMCl9cmV0dXJuIGF9LG1vdmVUbzpmdW5jdGlvbigpe3ZhciBhPXRoaXMudmlzaWJpbGl0eTt0aGlzLmlzQmFzZUxheWVyfHwoYT1hJiZ0aGlzLmluUmFuZ2UpO3RoaXMuZGlzcGxheShhKX0sbW92ZUJ5UHg6ZnVuY3Rpb24oKXt9LHNldE1hcDpmdW5jdGlvbihhKXtudWxsPT1cbnRoaXMubWFwJiYodGhpcy5tYXA9YSx0aGlzLm1heEV4dGVudD10aGlzLm1heEV4dGVudHx8dGhpcy5tYXAubWF4RXh0ZW50LHRoaXMubWluRXh0ZW50PXRoaXMubWluRXh0ZW50fHx0aGlzLm1hcC5taW5FeHRlbnQsdGhpcy5wcm9qZWN0aW9uPXRoaXMucHJvamVjdGlvbnx8dGhpcy5tYXAucHJvamVjdGlvbixcInN0cmluZ1wiPT10eXBlb2YgdGhpcy5wcm9qZWN0aW9uJiYodGhpcy5wcm9qZWN0aW9uPW5ldyBPcGVuTGF5ZXJzLlByb2plY3Rpb24odGhpcy5wcm9qZWN0aW9uKSksdGhpcy51bml0cz10aGlzLnByb2plY3Rpb24uZ2V0VW5pdHMoKXx8dGhpcy51bml0c3x8dGhpcy5tYXAudW5pdHMsdGhpcy5pbml0UmVzb2x1dGlvbnMoKSx0aGlzLmlzQmFzZUxheWVyfHwodGhpcy5pblJhbmdlPXRoaXMuY2FsY3VsYXRlSW5SYW5nZSgpLHRoaXMuZGl2LnN0eWxlLmRpc3BsYXk9dGhpcy52aXNpYmlsaXR5JiZ0aGlzLmluUmFuZ2U/XCJcIjpcIm5vbmVcIiksdGhpcy5zZXRUaWxlU2l6ZSgpKX0sYWZ0ZXJBZGQ6ZnVuY3Rpb24oKXt9LFxucmVtb3ZlTWFwOmZ1bmN0aW9uKCl7fSxnZXRJbWFnZVNpemU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbWFnZVNpemV8fHRoaXMudGlsZVNpemV9LHNldFRpbGVTaXplOmZ1bmN0aW9uKGEpe3RoaXMudGlsZVNpemU9YT1hP2E6dGhpcy50aWxlU2l6ZT90aGlzLnRpbGVTaXplOnRoaXMubWFwLmdldFRpbGVTaXplKCk7dGhpcy5ndXR0ZXImJih0aGlzLmltYWdlU2l6ZT1uZXcgT3BlbkxheWVycy5TaXplKGEudysyKnRoaXMuZ3V0dGVyLGEuaCsyKnRoaXMuZ3V0dGVyKSl9LGdldFZpc2liaWxpdHk6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy52aXNpYmlsaXR5fSxzZXRWaXNpYmlsaXR5OmZ1bmN0aW9uKGEpe2EhPXRoaXMudmlzaWJpbGl0eSYmKHRoaXMudmlzaWJpbGl0eT1hLHRoaXMuZGlzcGxheShhKSx0aGlzLnJlZHJhdygpLG51bGwhPXRoaXMubWFwJiZ0aGlzLm1hcC5ldmVudHMudHJpZ2dlckV2ZW50KFwiY2hhbmdlbGF5ZXJcIix7bGF5ZXI6dGhpcyxwcm9wZXJ0eTpcInZpc2liaWxpdHlcIn0pLFxudGhpcy5ldmVudHMudHJpZ2dlckV2ZW50KFwidmlzaWJpbGl0eWNoYW5nZWRcIikpfSxkaXNwbGF5OmZ1bmN0aW9uKGEpe2EhPShcIm5vbmVcIiE9dGhpcy5kaXYuc3R5bGUuZGlzcGxheSkmJih0aGlzLmRpdi5zdHlsZS5kaXNwbGF5PWEmJnRoaXMuY2FsY3VsYXRlSW5SYW5nZSgpP1wiYmxvY2tcIjpcIm5vbmVcIil9LGNhbGN1bGF0ZUluUmFuZ2U6ZnVuY3Rpb24oKXt2YXIgYT0hMTt0aGlzLmFsd2F5c0luUmFuZ2U/YT0hMDp0aGlzLm1hcCYmKGE9dGhpcy5tYXAuZ2V0UmVzb2x1dGlvbigpLGE9YT49dGhpcy5taW5SZXNvbHV0aW9uJiZhPD10aGlzLm1heFJlc29sdXRpb24pO3JldHVybiBhfSxzZXRJc0Jhc2VMYXllcjpmdW5jdGlvbihhKXthIT10aGlzLmlzQmFzZUxheWVyJiYodGhpcy5pc0Jhc2VMYXllcj1hLG51bGwhPXRoaXMubWFwJiZ0aGlzLm1hcC5ldmVudHMudHJpZ2dlckV2ZW50KFwiY2hhbmdlYmFzZWxheWVyXCIse2xheWVyOnRoaXN9KSl9LGluaXRSZXNvbHV0aW9uczpmdW5jdGlvbigpe3ZhciBhLFxuYixjLGQ9e30sZT0hMDthPTA7Zm9yKGI9dGhpcy5SRVNPTFVUSU9OX1BST1BFUlRJRVMubGVuZ3RoO2E8YjthKyspYz10aGlzLlJFU09MVVRJT05fUFJPUEVSVElFU1thXSxkW2NdPXRoaXMub3B0aW9uc1tjXSxlJiZ0aGlzLm9wdGlvbnNbY10mJihlPSExKTtudWxsPT10aGlzLmFsd2F5c0luUmFuZ2UmJih0aGlzLmFsd2F5c0luUmFuZ2U9ZSk7bnVsbD09ZC5yZXNvbHV0aW9ucyYmKGQucmVzb2x1dGlvbnM9dGhpcy5yZXNvbHV0aW9uc0Zyb21TY2FsZXMoZC5zY2FsZXMpKTtudWxsPT1kLnJlc29sdXRpb25zJiYoZC5yZXNvbHV0aW9ucz10aGlzLmNhbGN1bGF0ZVJlc29sdXRpb25zKGQpKTtpZihudWxsPT1kLnJlc29sdXRpb25zKXthPTA7Zm9yKGI9dGhpcy5SRVNPTFVUSU9OX1BST1BFUlRJRVMubGVuZ3RoO2E8YjthKyspYz10aGlzLlJFU09MVVRJT05fUFJPUEVSVElFU1thXSxkW2NdPW51bGwhPXRoaXMub3B0aW9uc1tjXT90aGlzLm9wdGlvbnNbY106dGhpcy5tYXBbY107bnVsbD09XG5kLnJlc29sdXRpb25zJiYoZC5yZXNvbHV0aW9ucz10aGlzLnJlc29sdXRpb25zRnJvbVNjYWxlcyhkLnNjYWxlcykpO251bGw9PWQucmVzb2x1dGlvbnMmJihkLnJlc29sdXRpb25zPXRoaXMuY2FsY3VsYXRlUmVzb2x1dGlvbnMoZCkpfXZhciBmO3RoaXMub3B0aW9ucy5tYXhSZXNvbHV0aW9uJiZcImF1dG9cIiE9PXRoaXMub3B0aW9ucy5tYXhSZXNvbHV0aW9uJiYoZj10aGlzLm9wdGlvbnMubWF4UmVzb2x1dGlvbik7dGhpcy5vcHRpb25zLm1pblNjYWxlJiYoZj1PcGVuTGF5ZXJzLlV0aWwuZ2V0UmVzb2x1dGlvbkZyb21TY2FsZSh0aGlzLm9wdGlvbnMubWluU2NhbGUsdGhpcy51bml0cykpO3ZhciBnO3RoaXMub3B0aW9ucy5taW5SZXNvbHV0aW9uJiZcImF1dG9cIiE9PXRoaXMub3B0aW9ucy5taW5SZXNvbHV0aW9uJiYoZz10aGlzLm9wdGlvbnMubWluUmVzb2x1dGlvbik7dGhpcy5vcHRpb25zLm1heFNjYWxlJiYoZz1PcGVuTGF5ZXJzLlV0aWwuZ2V0UmVzb2x1dGlvbkZyb21TY2FsZSh0aGlzLm9wdGlvbnMubWF4U2NhbGUsXG50aGlzLnVuaXRzKSk7ZC5yZXNvbHV0aW9ucyYmKGQucmVzb2x1dGlvbnMuc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBiLWF9KSxmfHwoZj1kLnJlc29sdXRpb25zWzBdKSxnfHwoZz1kLnJlc29sdXRpb25zW2QucmVzb2x1dGlvbnMubGVuZ3RoLTFdKSk7aWYodGhpcy5yZXNvbHV0aW9ucz1kLnJlc29sdXRpb25zKXtiPXRoaXMucmVzb2x1dGlvbnMubGVuZ3RoO3RoaXMuc2NhbGVzPUFycmF5KGIpO2ZvcihhPTA7YTxiO2ErKyl0aGlzLnNjYWxlc1thXT1PcGVuTGF5ZXJzLlV0aWwuZ2V0U2NhbGVGcm9tUmVzb2x1dGlvbih0aGlzLnJlc29sdXRpb25zW2FdLHRoaXMudW5pdHMpO3RoaXMubnVtWm9vbUxldmVscz1ifWlmKHRoaXMubWluUmVzb2x1dGlvbj1nKXRoaXMubWF4U2NhbGU9T3BlbkxheWVycy5VdGlsLmdldFNjYWxlRnJvbVJlc29sdXRpb24oZyx0aGlzLnVuaXRzKTtpZih0aGlzLm1heFJlc29sdXRpb249Zil0aGlzLm1pblNjYWxlPU9wZW5MYXllcnMuVXRpbC5nZXRTY2FsZUZyb21SZXNvbHV0aW9uKGYsXG50aGlzLnVuaXRzKX0scmVzb2x1dGlvbnNGcm9tU2NhbGVzOmZ1bmN0aW9uKGEpe2lmKG51bGwhPWEpe3ZhciBiLGMsZDtkPWEubGVuZ3RoO2I9QXJyYXkoZCk7Zm9yKGM9MDtjPGQ7YysrKWJbY109T3BlbkxheWVycy5VdGlsLmdldFJlc29sdXRpb25Gcm9tU2NhbGUoYVtjXSx0aGlzLnVuaXRzKTtyZXR1cm4gYn19LGNhbGN1bGF0ZVJlc29sdXRpb25zOmZ1bmN0aW9uKGEpe3ZhciBiLGMsZD1hLm1heFJlc29sdXRpb247bnVsbCE9YS5taW5TY2FsZT9kPU9wZW5MYXllcnMuVXRpbC5nZXRSZXNvbHV0aW9uRnJvbVNjYWxlKGEubWluU2NhbGUsdGhpcy51bml0cyk6XCJhdXRvXCI9PWQmJm51bGwhPXRoaXMubWF4RXh0ZW50JiYoYj10aGlzLm1hcC5nZXRTaXplKCksYz10aGlzLm1heEV4dGVudC5nZXRXaWR0aCgpL2IudyxiPXRoaXMubWF4RXh0ZW50LmdldEhlaWdodCgpL2IuaCxkPU1hdGgubWF4KGMsYikpO2M9YS5taW5SZXNvbHV0aW9uO251bGwhPWEubWF4U2NhbGU/Yz1PcGVuTGF5ZXJzLlV0aWwuZ2V0UmVzb2x1dGlvbkZyb21TY2FsZShhLm1heFNjYWxlLFxudGhpcy51bml0cyk6XCJhdXRvXCI9PWEubWluUmVzb2x1dGlvbiYmbnVsbCE9dGhpcy5taW5FeHRlbnQmJihiPXRoaXMubWFwLmdldFNpemUoKSxjPXRoaXMubWluRXh0ZW50LmdldFdpZHRoKCkvYi53LGI9dGhpcy5taW5FeHRlbnQuZ2V0SGVpZ2h0KCkvYi5oLGM9TWF0aC5tYXgoYyxiKSk7XCJudW1iZXJcIiE9PXR5cGVvZiBkJiYoXCJudW1iZXJcIiE9PXR5cGVvZiBjJiZudWxsIT10aGlzLm1heEV4dGVudCkmJihkPXRoaXMubWFwLmdldFRpbGVTaXplKCksZD1NYXRoLm1heCh0aGlzLm1heEV4dGVudC5nZXRXaWR0aCgpL2Qudyx0aGlzLm1heEV4dGVudC5nZXRIZWlnaHQoKS9kLmgpKTtiPWEubWF4Wm9vbUxldmVsO2E9YS5udW1ab29tTGV2ZWxzO1wibnVtYmVyXCI9PT10eXBlb2YgYyYmXCJudW1iZXJcIj09PXR5cGVvZiBkJiZ2b2lkIDA9PT1hP2E9TWF0aC5mbG9vcihNYXRoLmxvZyhkL2MpL01hdGgubG9nKDIpKSsxOnZvaWQgMD09PWEmJm51bGwhPWImJihhPWIrMSk7aWYoIShcIm51bWJlclwiIT09XG50eXBlb2YgYXx8MD49YXx8XCJudW1iZXJcIiE9PXR5cGVvZiBkJiZcIm51bWJlclwiIT09dHlwZW9mIGMpKXtiPUFycmF5KGEpO3ZhciBlPTI7XCJudW1iZXJcIj09dHlwZW9mIGMmJlwibnVtYmVyXCI9PXR5cGVvZiBkJiYoZT1NYXRoLnBvdyhkL2MsMS8oYS0xKSkpO3ZhciBmO2lmKFwibnVtYmVyXCI9PT10eXBlb2YgZClmb3IoZj0wO2Y8YTtmKyspYltmXT1kL01hdGgucG93KGUsZik7ZWxzZSBmb3IoZj0wO2Y8YTtmKyspYlthLTEtZl09YypNYXRoLnBvdyhlLGYpO3JldHVybiBifX0sZ2V0UmVzb2x1dGlvbjpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldFJlc29sdXRpb25Gb3Jab29tKHRoaXMubWFwLmdldFpvb20oKSl9LGdldEV4dGVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1hcC5jYWxjdWxhdGVCb3VuZHMoKX0sZ2V0Wm9vbUZvckV4dGVudDpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMubWFwLmdldFNpemUoKTtyZXR1cm4gdGhpcy5nZXRab29tRm9yUmVzb2x1dGlvbihNYXRoLm1heChhLmdldFdpZHRoKCkvXG5jLncsYS5nZXRIZWlnaHQoKS9jLmgpLGIpfSxnZXREYXRhRXh0ZW50OmZ1bmN0aW9uKCl7fSxnZXRSZXNvbHV0aW9uRm9yWm9vbTpmdW5jdGlvbihhKXthPU1hdGgubWF4KDAsTWF0aC5taW4oYSx0aGlzLnJlc29sdXRpb25zLmxlbmd0aC0xKSk7aWYodGhpcy5tYXAuZnJhY3Rpb25hbFpvb20pdmFyIGI9TWF0aC5mbG9vcihhKSxjPU1hdGguY2VpbChhKSxhPXRoaXMucmVzb2x1dGlvbnNbYl0tKGEtYikqKHRoaXMucmVzb2x1dGlvbnNbYl0tdGhpcy5yZXNvbHV0aW9uc1tjXSk7ZWxzZSBhPXRoaXMucmVzb2x1dGlvbnNbTWF0aC5yb3VuZChhKV07cmV0dXJuIGF9LGdldFpvb21Gb3JSZXNvbHV0aW9uOmZ1bmN0aW9uKGEsYil7dmFyIGMsZDtpZih0aGlzLm1hcC5mcmFjdGlvbmFsWm9vbSl7dmFyIGU9MCxmPXRoaXMucmVzb2x1dGlvbnNbZV0sZz10aGlzLnJlc29sdXRpb25zW3RoaXMucmVzb2x1dGlvbnMubGVuZ3RoLTFdLGg7Yz0wO2ZvcihkPXRoaXMucmVzb2x1dGlvbnMubGVuZ3RoO2M8XG5kOysrYylpZihoPXRoaXMucmVzb2x1dGlvbnNbY10saD49YSYmKGY9aCxlPWMpLGg8PWEpe2c9aDticmVha31jPWYtZztjPTA8Yz9lKyhmLWEpL2M6ZX1lbHNle2Y9TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZO2M9MDtmb3IoZD10aGlzLnJlc29sdXRpb25zLmxlbmd0aDtjPGQ7YysrKWlmKGIpe2U9TWF0aC5hYnModGhpcy5yZXNvbHV0aW9uc1tjXS1hKTtpZihlPmYpYnJlYWs7Zj1lfWVsc2UgaWYodGhpcy5yZXNvbHV0aW9uc1tjXTxhKWJyZWFrO2M9TWF0aC5tYXgoMCxjLTEpfXJldHVybiBjfSxnZXRMb25MYXRGcm9tVmlld1BvcnRQeDpmdW5jdGlvbihhKXt2YXIgYj1udWxsLGM9dGhpcy5tYXA7aWYobnVsbCE9YSYmYy5taW5QeCl7dmFyIGI9Yy5nZXRSZXNvbHV0aW9uKCksZD1jLmdldE1heEV4dGVudCh7cmVzdHJpY3RlZDohMH0pLGI9bmV3IE9wZW5MYXllcnMuTG9uTGF0KChhLngtYy5taW5QeC54KSpiK2QubGVmdCwoYy5taW5QeC55LWEueSkqYitkLnRvcCk7dGhpcy53cmFwRGF0ZUxpbmUmJlxuKGI9Yi53cmFwRGF0ZUxpbmUodGhpcy5tYXhFeHRlbnQpKX1yZXR1cm4gYn0sZ2V0Vmlld1BvcnRQeEZyb21Mb25MYXQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz1udWxsO251bGwhPWEmJihiPWJ8fHRoaXMubWFwLmdldFJlc29sdXRpb24oKSxjPXRoaXMubWFwLmNhbGN1bGF0ZUJvdW5kcyhudWxsLGIpLGM9bmV3IE9wZW5MYXllcnMuUGl4ZWwoMS9iKihhLmxvbi1jLmxlZnQpLDEvYiooYy50b3AtYS5sYXQpKSk7cmV0dXJuIGN9LHNldE9wYWNpdHk6ZnVuY3Rpb24oYSl7aWYoYSE9dGhpcy5vcGFjaXR5KXt0aGlzLm9wYWNpdHk9YTtmb3IodmFyIGI9dGhpcy5kaXYuY2hpbGROb2RlcyxjPTAsZD1iLmxlbmd0aDtjPGQ7KytjKXt2YXIgZT1iW2NdLmZpcnN0Q2hpbGR8fGJbY10sZj1iW2NdLmxhc3RDaGlsZDtmJiZcImlmcmFtZVwiPT09Zi5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpJiYoZT1mLnBhcmVudE5vZGUpO09wZW5MYXllcnMuVXRpbC5tb2RpZnlET01FbGVtZW50KGUsbnVsbCxudWxsLG51bGwsXG5udWxsLG51bGwsbnVsbCxhKX1udWxsIT10aGlzLm1hcCYmdGhpcy5tYXAuZXZlbnRzLnRyaWdnZXJFdmVudChcImNoYW5nZWxheWVyXCIse2xheWVyOnRoaXMscHJvcGVydHk6XCJvcGFjaXR5XCJ9KX19LGdldFpJbmRleDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmRpdi5zdHlsZS56SW5kZXh9LHNldFpJbmRleDpmdW5jdGlvbihhKXt0aGlzLmRpdi5zdHlsZS56SW5kZXg9YX0sYWRqdXN0Qm91bmRzOmZ1bmN0aW9uKGEpe2lmKHRoaXMuZ3V0dGVyKXZhciBiPXRoaXMuZ3V0dGVyKnRoaXMubWFwLmdldFJlc29sdXRpb24oKSxhPW5ldyBPcGVuTGF5ZXJzLkJvdW5kcyhhLmxlZnQtYixhLmJvdHRvbS1iLGEucmlnaHQrYixhLnRvcCtiKTt0aGlzLndyYXBEYXRlTGluZSYmKGI9e3JpZ2h0VG9sZXJhbmNlOnRoaXMuZ2V0UmVzb2x1dGlvbigpLGxlZnRUb2xlcmFuY2U6dGhpcy5nZXRSZXNvbHV0aW9uKCl9LGE9YS53cmFwRGF0ZUxpbmUodGhpcy5tYXhFeHRlbnQsYikpO3JldHVybiBhfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5MYXllclwifSk7T3BlbkxheWVycy5MYXllci5TcGhlcmljYWxNZXJjYXRvcj17Z2V0RXh0ZW50OmZ1bmN0aW9uKCl7dmFyIGE9bnVsbDtyZXR1cm4gYT10aGlzLnNwaGVyaWNhbE1lcmNhdG9yP3RoaXMubWFwLmNhbGN1bGF0ZUJvdW5kcygpOk9wZW5MYXllcnMuTGF5ZXIuRml4ZWRab29tTGV2ZWxzLnByb3RvdHlwZS5nZXRFeHRlbnQuYXBwbHkodGhpcyl9LGdldExvbkxhdEZyb21WaWV3UG9ydFB4OmZ1bmN0aW9uKGEpe3JldHVybiBPcGVuTGF5ZXJzLkxheWVyLnByb3RvdHlwZS5nZXRMb25MYXRGcm9tVmlld1BvcnRQeC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGdldFZpZXdQb3J0UHhGcm9tTG9uTGF0OmZ1bmN0aW9uKGEpe3JldHVybiBPcGVuTGF5ZXJzLkxheWVyLnByb3RvdHlwZS5nZXRWaWV3UG9ydFB4RnJvbUxvbkxhdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGluaXRNZXJjYXRvclBhcmFtZXRlcnM6ZnVuY3Rpb24oKXt0aGlzLlJFU09MVVRJT05TPVtdO2Zvcih2YXIgYT0wO2E8PXRoaXMuTUFYX1pPT01fTEVWRUw7KythKXRoaXMuUkVTT0xVVElPTlNbYV09XG4xNTY1NDMuMDMzOTA2MjUvTWF0aC5wb3coMixhKTt0aGlzLnVuaXRzPVwibVwiO3RoaXMucHJvamVjdGlvbj10aGlzLnByb2plY3Rpb258fFwiRVBTRzo5MDA5MTNcIn0sZm9yd2FyZE1lcmNhdG9yOmZ1bmN0aW9uKCl7dmFyIGE9bmV3IE9wZW5MYXllcnMuUHJvamVjdGlvbihcIkVQU0c6NDMyNlwiKSxiPW5ldyBPcGVuTGF5ZXJzLlByb2plY3Rpb24oXCJFUFNHOjkwMDkxM1wiKTtyZXR1cm4gZnVuY3Rpb24oYyxkKXt2YXIgZT1PcGVuTGF5ZXJzLlByb2plY3Rpb24udHJhbnNmb3JtKHt4OmMseTpkfSxhLGIpO3JldHVybiBuZXcgT3BlbkxheWVycy5Mb25MYXQoZS54LGUueSl9fSgpLGludmVyc2VNZXJjYXRvcjpmdW5jdGlvbigpe3ZhciBhPW5ldyBPcGVuTGF5ZXJzLlByb2plY3Rpb24oXCJFUFNHOjQzMjZcIiksYj1uZXcgT3BlbkxheWVycy5Qcm9qZWN0aW9uKFwiRVBTRzo5MDA5MTNcIik7cmV0dXJuIGZ1bmN0aW9uKGMsZCl7dmFyIGU9T3BlbkxheWVycy5Qcm9qZWN0aW9uLnRyYW5zZm9ybSh7eDpjLFxueTpkfSxiLGEpO3JldHVybiBuZXcgT3BlbkxheWVycy5Mb25MYXQoZS54LGUueSl9fSgpfTtPcGVuTGF5ZXJzLkxheWVyLkV2ZW50UGFuZT1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuTGF5ZXIse3Ntb290aERyYWdQYW46ITAsaXNCYXNlTGF5ZXI6ITAsaXNGaXhlZDohMCxwYW5lOm51bGwsbWFwT2JqZWN0Om51bGwsaW5pdGlhbGl6ZTpmdW5jdGlvbihhLGIpe09wZW5MYXllcnMuTGF5ZXIucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpO251bGw9PXRoaXMucGFuZSYmKHRoaXMucGFuZT1PcGVuTGF5ZXJzLlV0aWwuY3JlYXRlRGl2KHRoaXMuZGl2LmlkK1wiX0V2ZW50UGFuZVwiKSl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLnBhbmU9dGhpcy5tYXBPYmplY3Q9bnVsbDtPcGVuTGF5ZXJzLkxheWVyLnByb3RvdHlwZS5kZXN0cm95LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sc2V0TWFwOmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuTGF5ZXIucHJvdG90eXBlLnNldE1hcC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5wYW5lLnN0eWxlLnpJbmRleD1cbnBhcnNlSW50KHRoaXMuZGl2LnN0eWxlLnpJbmRleCkrMTt0aGlzLnBhbmUuc3R5bGUuZGlzcGxheT10aGlzLmRpdi5zdHlsZS5kaXNwbGF5O3RoaXMucGFuZS5zdHlsZS53aWR0aD1cIjEwMCVcIjt0aGlzLnBhbmUuc3R5bGUuaGVpZ2h0PVwiMTAwJVwiO1wibXNpZVwiPT1PcGVuTGF5ZXJzLkJST1dTRVJfTkFNRSYmKHRoaXMucGFuZS5zdHlsZS5iYWNrZ3JvdW5kPVwidXJsKFwiK09wZW5MYXllcnMuVXRpbC5nZXRJbWFnZUxvY2F0aW9uKFwiYmxhbmsuZ2lmXCIpK1wiKVwiKTt0aGlzLmlzRml4ZWQ/dGhpcy5tYXAudmlld1BvcnREaXYuYXBwZW5kQ2hpbGQodGhpcy5wYW5lKTp0aGlzLm1hcC5sYXllckNvbnRhaW5lckRpdi5hcHBlbmRDaGlsZCh0aGlzLnBhbmUpO3RoaXMubG9hZE1hcE9iamVjdCgpO251bGw9PXRoaXMubWFwT2JqZWN0JiZ0aGlzLmxvYWRXYXJuaW5nTWVzc2FnZSgpfSxyZW1vdmVNYXA6ZnVuY3Rpb24oYSl7dGhpcy5wYW5lJiZ0aGlzLnBhbmUucGFyZW50Tm9kZSYmdGhpcy5wYW5lLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5wYW5lKTtcbk9wZW5MYXllcnMuTGF5ZXIucHJvdG90eXBlLnJlbW92ZU1hcC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGxvYWRXYXJuaW5nTWVzc2FnZTpmdW5jdGlvbigpe3RoaXMuZGl2LnN0eWxlLmJhY2tncm91bmRDb2xvcj1cImRhcmtibHVlXCI7dmFyIGE9dGhpcy5tYXAuZ2V0U2l6ZSgpLGI9TWF0aC5taW4oYS53LDMwMCksYz1NYXRoLm1pbihhLmgsMjAwKSxiPW5ldyBPcGVuTGF5ZXJzLlNpemUoYixjKSxhPShuZXcgT3BlbkxheWVycy5QaXhlbChhLncvMixhLmgvMikpLmFkZCgtYi53LzIsLWIuaC8yKSxhPU9wZW5MYXllcnMuVXRpbC5jcmVhdGVEaXYodGhpcy5uYW1lK1wiX3dhcm5pbmdcIixhLGIsbnVsbCxudWxsLG51bGwsXCJhdXRvXCIpO2Euc3R5bGUucGFkZGluZz1cIjdweFwiO2Euc3R5bGUuYmFja2dyb3VuZENvbG9yPVwieWVsbG93XCI7YS5pbm5lckhUTUw9dGhpcy5nZXRXYXJuaW5nSFRNTCgpO3RoaXMuZGl2LmFwcGVuZENoaWxkKGEpfSxnZXRXYXJuaW5nSFRNTDpmdW5jdGlvbigpe3JldHVyblwiXCJ9LFxuZGlzcGxheTpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLkxheWVyLnByb3RvdHlwZS5kaXNwbGF5LmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLnBhbmUuc3R5bGUuZGlzcGxheT10aGlzLmRpdi5zdHlsZS5kaXNwbGF5fSxzZXRaSW5kZXg6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5MYXllci5wcm90b3R5cGUuc2V0WkluZGV4LmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLnBhbmUuc3R5bGUuekluZGV4PXBhcnNlSW50KHRoaXMuZGl2LnN0eWxlLnpJbmRleCkrMX0sbW92ZUJ5UHg6ZnVuY3Rpb24oYSxiKXtPcGVuTGF5ZXJzLkxheWVyLnByb3RvdHlwZS5tb3ZlQnlQeC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5kcmFnUGFuTWFwT2JqZWN0P3RoaXMuZHJhZ1Bhbk1hcE9iamVjdChhLC1iKTp0aGlzLm1vdmVUbyh0aGlzLm1hcC5nZXRDYWNoZWRDZW50ZXIoKSl9LG1vdmVUbzpmdW5jdGlvbihhLGIsYyl7T3BlbkxheWVycy5MYXllci5wcm90b3R5cGUubW92ZVRvLmFwcGx5KHRoaXMsXG5hcmd1bWVudHMpO2lmKG51bGwhPXRoaXMubWFwT2JqZWN0KXt2YXIgZD10aGlzLm1hcC5nZXRDZW50ZXIoKSxlPXRoaXMubWFwLmdldFpvb20oKTtpZihudWxsIT1kKXt2YXIgZj10aGlzLmdldE9MTG9uTGF0RnJvbU1hcE9iamVjdExvbkxhdCh0aGlzLmdldE1hcE9iamVjdENlbnRlcigpKSxnPXRoaXMuZ2V0T0xab29tRnJvbU1hcE9iamVjdFpvb20odGhpcy5nZXRNYXBPYmplY3Rab29tKCkpO2lmKCFkLmVxdWFscyhmKXx8ZSE9ZykhYiYmZiYmdGhpcy5kcmFnUGFuTWFwT2JqZWN0JiZ0aGlzLnNtb290aERyYWdQYW4/KGU9dGhpcy5tYXAuZ2V0Vmlld1BvcnRQeEZyb21Mb25MYXQoZiksZD10aGlzLm1hcC5nZXRWaWV3UG9ydFB4RnJvbUxvbkxhdChkKSx0aGlzLmRyYWdQYW5NYXBPYmplY3QoZC54LWUueCxlLnktZC55KSk6KGQ9dGhpcy5nZXRNYXBPYmplY3RMb25MYXRGcm9tT0xMb25MYXQoZCksZT10aGlzLmdldE1hcE9iamVjdFpvb21Gcm9tT0xab29tKGUpLHRoaXMuc2V0TWFwT2JqZWN0Q2VudGVyKGQsXG5lLGMpKX19fSxnZXRMb25MYXRGcm9tVmlld1BvcnRQeDpmdW5jdGlvbihhKXt2YXIgYj1udWxsO251bGwhPXRoaXMubWFwT2JqZWN0JiZudWxsIT10aGlzLmdldE1hcE9iamVjdENlbnRlcigpJiYoYj10aGlzLmdldE9MTG9uTGF0RnJvbU1hcE9iamVjdExvbkxhdCh0aGlzLmdldE1hcE9iamVjdExvbkxhdEZyb21NYXBPYmplY3RQaXhlbCh0aGlzLmdldE1hcE9iamVjdFBpeGVsRnJvbU9MUGl4ZWwoYSkpKSk7cmV0dXJuIGJ9LGdldFZpZXdQb3J0UHhGcm9tTG9uTGF0OmZ1bmN0aW9uKGEpe3ZhciBiPW51bGw7bnVsbCE9dGhpcy5tYXBPYmplY3QmJm51bGwhPXRoaXMuZ2V0TWFwT2JqZWN0Q2VudGVyKCkmJihiPXRoaXMuZ2V0T0xQaXhlbEZyb21NYXBPYmplY3RQaXhlbCh0aGlzLmdldE1hcE9iamVjdFBpeGVsRnJvbU1hcE9iamVjdExvbkxhdCh0aGlzLmdldE1hcE9iamVjdExvbkxhdEZyb21PTExvbkxhdChhKSkpKTtyZXR1cm4gYn0sZ2V0T0xMb25MYXRGcm9tTWFwT2JqZWN0TG9uTGF0OmZ1bmN0aW9uKGEpe3ZhciBiPVxubnVsbDtudWxsIT1hJiYoYj10aGlzLmdldExvbmdpdHVkZUZyb21NYXBPYmplY3RMb25MYXQoYSksYT10aGlzLmdldExhdGl0dWRlRnJvbU1hcE9iamVjdExvbkxhdChhKSxiPW5ldyBPcGVuTGF5ZXJzLkxvbkxhdChiLGEpKTtyZXR1cm4gYn0sZ2V0TWFwT2JqZWN0TG9uTGF0RnJvbU9MTG9uTGF0OmZ1bmN0aW9uKGEpe3ZhciBiPW51bGw7bnVsbCE9YSYmKGI9dGhpcy5nZXRNYXBPYmplY3RMb25MYXRGcm9tTG9uTGF0KGEubG9uLGEubGF0KSk7cmV0dXJuIGJ9LGdldE9MUGl4ZWxGcm9tTWFwT2JqZWN0UGl4ZWw6ZnVuY3Rpb24oYSl7dmFyIGI9bnVsbDtudWxsIT1hJiYoYj10aGlzLmdldFhGcm9tTWFwT2JqZWN0UGl4ZWwoYSksYT10aGlzLmdldFlGcm9tTWFwT2JqZWN0UGl4ZWwoYSksYj1uZXcgT3BlbkxheWVycy5QaXhlbChiLGEpKTtyZXR1cm4gYn0sZ2V0TWFwT2JqZWN0UGl4ZWxGcm9tT0xQaXhlbDpmdW5jdGlvbihhKXt2YXIgYj1udWxsO251bGwhPWEmJihiPXRoaXMuZ2V0TWFwT2JqZWN0UGl4ZWxGcm9tWFkoYS54LFxuYS55KSk7cmV0dXJuIGJ9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkxheWVyLkV2ZW50UGFuZVwifSk7T3BlbkxheWVycy5MYXllci5GaXhlZFpvb21MZXZlbHM9T3BlbkxheWVycy5DbGFzcyh7aW5pdGlhbGl6ZTpmdW5jdGlvbigpe30saW5pdFJlc29sdXRpb25zOmZ1bmN0aW9uKCl7Zm9yKHZhciBhPVtcIm1pblpvb21MZXZlbFwiLFwibWF4Wm9vbUxldmVsXCIsXCJudW1ab29tTGV2ZWxzXCJdLGI9MCxjPWEubGVuZ3RoO2I8YztiKyspe3ZhciBkPWFbYl07dGhpc1tkXT1udWxsIT10aGlzLm9wdGlvbnNbZF0/dGhpcy5vcHRpb25zW2RdOnRoaXMubWFwW2RdfWlmKG51bGw9PXRoaXMubWluWm9vbUxldmVsfHx0aGlzLm1pblpvb21MZXZlbDx0aGlzLk1JTl9aT09NX0xFVkVMKXRoaXMubWluWm9vbUxldmVsPXRoaXMuTUlOX1pPT01fTEVWRUw7YT10aGlzLk1BWF9aT09NX0xFVkVMLXRoaXMubWluWm9vbUxldmVsKzE7Yj1udWxsPT10aGlzLm9wdGlvbnMubnVtWm9vbUxldmVscyYmbnVsbCE9dGhpcy5vcHRpb25zLm1heFpvb21MZXZlbHx8bnVsbD09dGhpcy5udW1ab29tTGV2ZWxzJiZudWxsIT10aGlzLm1heFpvb21MZXZlbD9cbnRoaXMubWF4Wm9vbUxldmVsLXRoaXMubWluWm9vbUxldmVsKzE6dGhpcy5udW1ab29tTGV2ZWxzO3RoaXMubnVtWm9vbUxldmVscz1udWxsIT1iP01hdGgubWluKGIsYSk6YTt0aGlzLm1heFpvb21MZXZlbD10aGlzLm1pblpvb21MZXZlbCt0aGlzLm51bVpvb21MZXZlbHMtMTtpZihudWxsIT10aGlzLlJFU09MVVRJT05TKXthPTA7dGhpcy5yZXNvbHV0aW9ucz1bXTtmb3IoYj10aGlzLm1pblpvb21MZXZlbDtiPD10aGlzLm1heFpvb21MZXZlbDtiKyspdGhpcy5yZXNvbHV0aW9uc1thKytdPXRoaXMuUkVTT0xVVElPTlNbYl07dGhpcy5tYXhSZXNvbHV0aW9uPXRoaXMucmVzb2x1dGlvbnNbMF07dGhpcy5taW5SZXNvbHV0aW9uPXRoaXMucmVzb2x1dGlvbnNbdGhpcy5yZXNvbHV0aW9ucy5sZW5ndGgtMV19fSxnZXRSZXNvbHV0aW9uOmZ1bmN0aW9uKCl7aWYobnVsbCE9dGhpcy5yZXNvbHV0aW9ucylyZXR1cm4gT3BlbkxheWVycy5MYXllci5wcm90b3R5cGUuZ2V0UmVzb2x1dGlvbi5hcHBseSh0aGlzLFxuYXJndW1lbnRzKTt2YXIgYT1udWxsLGI9dGhpcy5tYXAuZ2V0U2l6ZSgpLGM9dGhpcy5nZXRFeHRlbnQoKTtudWxsIT1iJiZudWxsIT1jJiYoYT1NYXRoLm1heChjLmdldFdpZHRoKCkvYi53LGMuZ2V0SGVpZ2h0KCkvYi5oKSk7cmV0dXJuIGF9LGdldEV4dGVudDpmdW5jdGlvbigpe3ZhciBhPXRoaXMubWFwLmdldFNpemUoKSxiPXRoaXMuZ2V0TG9uTGF0RnJvbVZpZXdQb3J0UHgoe3g6MCx5OjB9KSxhPXRoaXMuZ2V0TG9uTGF0RnJvbVZpZXdQb3J0UHgoe3g6YS53LHk6YS5ofSk7cmV0dXJuIG51bGwhPWImJm51bGwhPWE/bmV3IE9wZW5MYXllcnMuQm91bmRzKGIubG9uLGEubGF0LGEubG9uLGIubGF0KTpudWxsfSxnZXRab29tRm9yUmVzb2x1dGlvbjpmdW5jdGlvbihhKXtyZXR1cm4gbnVsbCE9dGhpcy5yZXNvbHV0aW9ucz9PcGVuTGF5ZXJzLkxheWVyLnByb3RvdHlwZS5nZXRab29tRm9yUmVzb2x1dGlvbi5hcHBseSh0aGlzLGFyZ3VtZW50cyk6dGhpcy5nZXRab29tRm9yRXh0ZW50KE9wZW5MYXllcnMuTGF5ZXIucHJvdG90eXBlLmdldEV4dGVudC5hcHBseSh0aGlzLFxuW10pKX0sZ2V0T0xab29tRnJvbU1hcE9iamVjdFpvb206ZnVuY3Rpb24oYSl7dmFyIGI9bnVsbDtudWxsIT1hJiYoYj1hLXRoaXMubWluWm9vbUxldmVsLHRoaXMubWFwLmJhc2VMYXllciE9PXRoaXMmJihiPXRoaXMubWFwLmJhc2VMYXllci5nZXRab29tRm9yUmVzb2x1dGlvbih0aGlzLmdldFJlc29sdXRpb25Gb3Jab29tKGIpKSkpO3JldHVybiBifSxnZXRNYXBPYmplY3Rab29tRnJvbU9MWm9vbTpmdW5jdGlvbihhKXt2YXIgYj1udWxsO251bGwhPWEmJihiPWErdGhpcy5taW5ab29tTGV2ZWwsdGhpcy5tYXAuYmFzZUxheWVyIT09dGhpcyYmKGI9dGhpcy5nZXRab29tRm9yUmVzb2x1dGlvbih0aGlzLm1hcC5iYXNlTGF5ZXIuZ2V0UmVzb2x1dGlvbkZvclpvb20oYikpKSk7cmV0dXJuIGJ9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkxheWVyLkZpeGVkWm9vbUxldmVsc1wifSk7T3BlbkxheWVycy5MYXllci5Hb29nbGU9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkxheWVyLkV2ZW50UGFuZSxPcGVuTGF5ZXJzLkxheWVyLkZpeGVkWm9vbUxldmVscyx7TUlOX1pPT01fTEVWRUw6MCxNQVhfWk9PTV9MRVZFTDoyMSxSRVNPTFVUSU9OUzpbMS40MDYyNSwwLjcwMzEyNSwwLjM1MTU2MjUsMC4xNzU3ODEyNSwwLjA4Nzg5MDYyNSwwLjA0Mzk0NTMxMjUsMC4wMjE5NzI2NTYyNSwwLjAxMDk4NjMyODEyNSwwLjAwNTQ5MzE2NDA2MjUsMC4wMDI3NDY1ODIwMzEyNSwwLjAwMTM3MzI5MTAxNTYyNSw2Ljg2NjQ1NTA3ODEyNUUtNCwzLjQzMzIyNzUzOTA2MjVFLTQsMS43MTY2MTM3Njk1MzEyNUUtNCw4LjU4MzA2ODg0NzY1NjI1RS01LDQuMjkxNTM0NDIzODI4MTI1RS01LDIuMTQ1NzY3MjExOTE0MDYyRS01LDEuMDcyODgzNjA1OTU3MDMxRS01LDUuMzY0NDE4MDI5Nzg1MTVFLTYsMi42ODIyMDkwMTQ4OTI1N0UtNiwxLjM0MTEwNDUwNzQ0NjI4OUUtNiw2LjcwNTUyMjUzNzIzMTQ0NUUtN10sXG50eXBlOm51bGwsd3JhcERhdGVMaW5lOiEwLHNwaGVyaWNhbE1lcmNhdG9yOiExLHZlcnNpb246bnVsbCxpbml0aWFsaXplOmZ1bmN0aW9uKGEsYil7Yj1ifHx7fTtiLnZlcnNpb258fChiLnZlcnNpb249XCJmdW5jdGlvblwiPT09dHlwZW9mIEdNYXAyP1wiMlwiOlwiM1wiKTt2YXIgYz1PcGVuTGF5ZXJzLkxheWVyLkdvb2dsZVtcInZcIitiLnZlcnNpb24ucmVwbGFjZSgvXFwuL2csXCJfXCIpXTtpZihjKU9wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKGIsYyk7ZWxzZSB0aHJvd1wiVW5zdXBwb3J0ZWQgR29vZ2xlIE1hcHMgQVBJIHZlcnNpb246IFwiK2IudmVyc2lvbjtPcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyhiLGMuREVGQVVMVFMpO2IubWF4RXh0ZW50JiYoYi5tYXhFeHRlbnQ9Yi5tYXhFeHRlbnQuY2xvbmUoKSk7T3BlbkxheWVycy5MYXllci5FdmVudFBhbmUucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbYSxiXSk7T3BlbkxheWVycy5MYXllci5GaXhlZFpvb21MZXZlbHMucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxcblthLGJdKTt0aGlzLnNwaGVyaWNhbE1lcmNhdG9yJiYoT3BlbkxheWVycy5VdGlsLmV4dGVuZCh0aGlzLE9wZW5MYXllcnMuTGF5ZXIuU3BoZXJpY2FsTWVyY2F0b3IpLHRoaXMuaW5pdE1lcmNhdG9yUGFyYW1ldGVycygpKX0sY2xvbmU6ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IE9wZW5MYXllcnMuTGF5ZXIuR29vZ2xlKHRoaXMubmFtZSx0aGlzLmdldE9wdGlvbnMoKSl9LHNldFZpc2liaWxpdHk6ZnVuY3Rpb24oYSl7dmFyIGI9bnVsbD09dGhpcy5vcGFjaXR5PzE6dGhpcy5vcGFjaXR5O09wZW5MYXllcnMuTGF5ZXIuRXZlbnRQYW5lLnByb3RvdHlwZS5zZXRWaXNpYmlsaXR5LmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLnNldE9wYWNpdHkoYil9LGRpc3BsYXk6ZnVuY3Rpb24oYSl7dGhpcy5fZHJhZ2dpbmd8fHRoaXMuc2V0R01hcFZpc2liaWxpdHkoYSk7T3BlbkxheWVycy5MYXllci5FdmVudFBhbmUucHJvdG90eXBlLmRpc3BsYXkuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxtb3ZlVG86ZnVuY3Rpb24oYSxcbmIsYyl7dGhpcy5fZHJhZ2dpbmc9YztPcGVuTGF5ZXJzLkxheWVyLkV2ZW50UGFuZS5wcm90b3R5cGUubW92ZVRvLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtkZWxldGUgdGhpcy5fZHJhZ2dpbmd9LHNldE9wYWNpdHk6ZnVuY3Rpb24oYSl7YSE9PXRoaXMub3BhY2l0eSYmKG51bGwhPXRoaXMubWFwJiZ0aGlzLm1hcC5ldmVudHMudHJpZ2dlckV2ZW50KFwiY2hhbmdlbGF5ZXJcIix7bGF5ZXI6dGhpcyxwcm9wZXJ0eTpcIm9wYWNpdHlcIn0pLHRoaXMub3BhY2l0eT1hKTtpZih0aGlzLmdldFZpc2liaWxpdHkoKSl7dmFyIGI9dGhpcy5nZXRNYXBDb250YWluZXIoKTtPcGVuTGF5ZXJzLlV0aWwubW9kaWZ5RE9NRWxlbWVudChiLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLGEpfX0sZGVzdHJveTpmdW5jdGlvbigpe2lmKHRoaXMubWFwKXt0aGlzLnNldEdNYXBWaXNpYmlsaXR5KCExKTt2YXIgYT1PcGVuTGF5ZXJzLkxheWVyLkdvb2dsZS5jYWNoZVt0aGlzLm1hcC5pZF07YSYmMT49YS5jb3VudCYmXG50aGlzLnJlbW92ZUdNYXBFbGVtZW50cygpfU9wZW5MYXllcnMuTGF5ZXIuRXZlbnRQYW5lLnByb3RvdHlwZS5kZXN0cm95LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0scmVtb3ZlR01hcEVsZW1lbnRzOmZ1bmN0aW9uKCl7dmFyIGE9T3BlbkxheWVycy5MYXllci5Hb29nbGUuY2FjaGVbdGhpcy5tYXAuaWRdO2lmKGEpe3ZhciBiPXRoaXMubWFwT2JqZWN0JiZ0aGlzLmdldE1hcENvbnRhaW5lcigpO2ImJmIucGFyZW50Tm9kZSYmYi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGIpOyhiPWEudGVybXNPZlVzZSkmJmIucGFyZW50Tm9kZSYmYi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGIpOyhhPWEucG93ZXJlZEJ5KSYmYS5wYXJlbnROb2RlJiZhLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoYSl9fSxyZW1vdmVNYXA6ZnVuY3Rpb24oYSl7dGhpcy52aXNpYmlsaXR5JiZ0aGlzLm1hcE9iamVjdCYmdGhpcy5zZXRHTWFwVmlzaWJpbGl0eSghMSk7dmFyIGI9T3BlbkxheWVycy5MYXllci5Hb29nbGUuY2FjaGVbYS5pZF07XG5iJiYoMT49Yi5jb3VudD8odGhpcy5yZW1vdmVHTWFwRWxlbWVudHMoKSxkZWxldGUgT3BlbkxheWVycy5MYXllci5Hb29nbGUuY2FjaGVbYS5pZF0pOi0tYi5jb3VudCk7ZGVsZXRlIHRoaXMudGVybXNPZlVzZTtkZWxldGUgdGhpcy5wb3dlcmVkQnk7ZGVsZXRlIHRoaXMubWFwT2JqZWN0O2RlbGV0ZSB0aGlzLmRyYWdPYmplY3Q7T3BlbkxheWVycy5MYXllci5FdmVudFBhbmUucHJvdG90eXBlLnJlbW92ZU1hcC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGdldE9MQm91bmRzRnJvbU1hcE9iamVjdEJvdW5kczpmdW5jdGlvbihhKXt2YXIgYj1udWxsO251bGwhPWEmJihiPWEuZ2V0U291dGhXZXN0KCksYT1hLmdldE5vcnRoRWFzdCgpLHRoaXMuc3BoZXJpY2FsTWVyY2F0b3I/KGI9dGhpcy5mb3J3YXJkTWVyY2F0b3IoYi5sbmcoKSxiLmxhdCgpKSxhPXRoaXMuZm9yd2FyZE1lcmNhdG9yKGEubG5nKCksYS5sYXQoKSkpOihiPW5ldyBPcGVuTGF5ZXJzLkxvbkxhdChiLmxuZygpLGIubGF0KCkpLFxuYT1uZXcgT3BlbkxheWVycy5Mb25MYXQoYS5sbmcoKSxhLmxhdCgpKSksYj1uZXcgT3BlbkxheWVycy5Cb3VuZHMoYi5sb24sYi5sYXQsYS5sb24sYS5sYXQpKTtyZXR1cm4gYn0sZ2V0V2FybmluZ0hUTUw6ZnVuY3Rpb24oKXtyZXR1cm4gT3BlbkxheWVycy5pMThuKFwiZ29vZ2xlV2FybmluZ1wiKX0sZ2V0TWFwT2JqZWN0Q2VudGVyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWFwT2JqZWN0LmdldENlbnRlcigpfSxnZXRNYXBPYmplY3Rab29tOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWFwT2JqZWN0LmdldFpvb20oKX0sZ2V0TG9uZ2l0dWRlRnJvbU1hcE9iamVjdExvbkxhdDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5zcGhlcmljYWxNZXJjYXRvcj90aGlzLmZvcndhcmRNZXJjYXRvcihhLmxuZygpLGEubGF0KCkpLmxvbjphLmxuZygpfSxnZXRMYXRpdHVkZUZyb21NYXBPYmplY3RMb25MYXQ6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuc3BoZXJpY2FsTWVyY2F0b3I/dGhpcy5mb3J3YXJkTWVyY2F0b3IoYS5sbmcoKSxcbmEubGF0KCkpLmxhdDphLmxhdCgpfSxnZXRYRnJvbU1hcE9iamVjdFBpeGVsOmZ1bmN0aW9uKGEpe3JldHVybiBhLnh9LGdldFlGcm9tTWFwT2JqZWN0UGl4ZWw6ZnVuY3Rpb24oYSl7cmV0dXJuIGEueX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuTGF5ZXIuR29vZ2xlXCJ9KTtPcGVuTGF5ZXJzLkxheWVyLkdvb2dsZS5jYWNoZT17fTtcbk9wZW5MYXllcnMuTGF5ZXIuR29vZ2xlLnYyPXt0ZXJtc09mVXNlOm51bGwscG93ZXJlZEJ5Om51bGwsZHJhZ09iamVjdDpudWxsLGxvYWRNYXBPYmplY3Q6ZnVuY3Rpb24oKXt0aGlzLnR5cGV8fCh0aGlzLnR5cGU9R19OT1JNQUxfTUFQKTt2YXIgYSxiLGMsZD1PcGVuTGF5ZXJzLkxheWVyLkdvb2dsZS5jYWNoZVt0aGlzLm1hcC5pZF07aWYoZClhPWQubWFwT2JqZWN0LGI9ZC50ZXJtc09mVXNlLGM9ZC5wb3dlcmVkQnksKytkLmNvdW50O2Vsc2V7dmFyIGQ9dGhpcy5tYXAudmlld1BvcnREaXYsZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO2UuaWQ9dGhpcy5tYXAuaWQrXCJfR01hcDJDb250YWluZXJcIjtlLnN0eWxlLnBvc2l0aW9uPVwiYWJzb2x1dGVcIjtlLnN0eWxlLndpZHRoPVwiMTAwJVwiO2Uuc3R5bGUuaGVpZ2h0PVwiMTAwJVwiO2QuYXBwZW5kQ2hpbGQoZSk7dHJ5e2E9bmV3IEdNYXAyKGUpLGI9ZS5sYXN0Q2hpbGQsZC5hcHBlbmRDaGlsZChiKSxiLnN0eWxlLnpJbmRleD1cblwiMTEwMFwiLGIuc3R5bGUucmlnaHQ9XCJcIixiLnN0eWxlLmJvdHRvbT1cIlwiLGIuY2xhc3NOYW1lPVwib2xMYXllckdvb2dsZUNvcHlyaWdodFwiLGM9ZS5sYXN0Q2hpbGQsZC5hcHBlbmRDaGlsZChjKSxjLnN0eWxlLnpJbmRleD1cIjExMDBcIixjLnN0eWxlLnJpZ2h0PVwiXCIsYy5zdHlsZS5ib3R0b209XCJcIixjLmNsYXNzTmFtZT1cIm9sTGF5ZXJHb29nbGVQb3dlcmVkQnkgZ21ub3ByaW50XCJ9Y2F0Y2goZil7dGhyb3cgZjt9T3BlbkxheWVycy5MYXllci5Hb29nbGUuY2FjaGVbdGhpcy5tYXAuaWRdPXttYXBPYmplY3Q6YSx0ZXJtc09mVXNlOmIscG93ZXJlZEJ5OmMsY291bnQ6MX19dGhpcy5tYXBPYmplY3Q9YTt0aGlzLnRlcm1zT2ZVc2U9Yjt0aGlzLnBvd2VyZWRCeT1jOy0xPT09T3BlbkxheWVycy5VdGlsLmluZGV4T2YodGhpcy5tYXBPYmplY3QuZ2V0TWFwVHlwZXMoKSx0aGlzLnR5cGUpJiZ0aGlzLm1hcE9iamVjdC5hZGRNYXBUeXBlKHRoaXMudHlwZSk7XCJmdW5jdGlvblwiPT10eXBlb2YgYS5nZXREcmFnT2JqZWN0P1xudGhpcy5kcmFnT2JqZWN0PWEuZ2V0RHJhZ09iamVjdCgpOnRoaXMuZHJhZ1Bhbk1hcE9iamVjdD1udWxsOyExPT09dGhpcy5pc0Jhc2VMYXllciYmdGhpcy5zZXRHTWFwVmlzaWJpbGl0eShcIm5vbmVcIiE9PXRoaXMuZGl2LnN0eWxlLmRpc3BsYXkpfSxvbk1hcFJlc2l6ZTpmdW5jdGlvbigpe2lmKHRoaXMudmlzaWJpbGl0eSYmdGhpcy5tYXBPYmplY3QuaXNMb2FkZWQoKSl0aGlzLm1hcE9iamVjdC5jaGVja1Jlc2l6ZSgpO2Vsc2V7aWYoIXRoaXMuX3Jlc2l6ZWQpdmFyIGE9dGhpcyxiPUdFdmVudC5hZGRMaXN0ZW5lcih0aGlzLm1hcE9iamVjdCxcImxvYWRcIixmdW5jdGlvbigpe0dFdmVudC5yZW1vdmVMaXN0ZW5lcihiKTtkZWxldGUgYS5fcmVzaXplZDthLm1hcE9iamVjdC5jaGVja1Jlc2l6ZSgpO2EubW92ZVRvKGEubWFwLmdldENlbnRlcigpLGEubWFwLmdldFpvb20oKSl9KTt0aGlzLl9yZXNpemVkPSEwfX0sc2V0R01hcFZpc2liaWxpdHk6ZnVuY3Rpb24oYSl7dmFyIGI9T3BlbkxheWVycy5MYXllci5Hb29nbGUuY2FjaGVbdGhpcy5tYXAuaWRdO1xuaWYoYil7dmFyIGM9dGhpcy5tYXBPYmplY3QuZ2V0Q29udGFpbmVyKCk7ITA9PT1hPyh0aGlzLm1hcE9iamVjdC5zZXRNYXBUeXBlKHRoaXMudHlwZSksYy5zdHlsZS5kaXNwbGF5PVwiXCIsdGhpcy50ZXJtc09mVXNlLnN0eWxlLmxlZnQ9XCJcIix0aGlzLnRlcm1zT2ZVc2Uuc3R5bGUuZGlzcGxheT1cIlwiLHRoaXMucG93ZXJlZEJ5LnN0eWxlLmRpc3BsYXk9XCJcIixiLmRpc3BsYXllZD10aGlzLmlkKTooYi5kaXNwbGF5ZWQ9PT10aGlzLmlkJiZkZWxldGUgYi5kaXNwbGF5ZWQsYi5kaXNwbGF5ZWR8fChjLnN0eWxlLmRpc3BsYXk9XCJub25lXCIsdGhpcy50ZXJtc09mVXNlLnN0eWxlLmRpc3BsYXk9XCJub25lXCIsdGhpcy50ZXJtc09mVXNlLnN0eWxlLmxlZnQ9XCItOTk5OXB4XCIsdGhpcy5wb3dlcmVkQnkuc3R5bGUuZGlzcGxheT1cIm5vbmVcIikpfX0sZ2V0TWFwQ29udGFpbmVyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWFwT2JqZWN0LmdldENvbnRhaW5lcigpfSxnZXRNYXBPYmplY3RCb3VuZHNGcm9tT0xCb3VuZHM6ZnVuY3Rpb24oYSl7dmFyIGI9XG5udWxsO251bGwhPWEmJihiPXRoaXMuc3BoZXJpY2FsTWVyY2F0b3I/dGhpcy5pbnZlcnNlTWVyY2F0b3IoYS5ib3R0b20sYS5sZWZ0KTpuZXcgT3BlbkxheWVycy5Mb25MYXQoYS5ib3R0b20sYS5sZWZ0KSxhPXRoaXMuc3BoZXJpY2FsTWVyY2F0b3I/dGhpcy5pbnZlcnNlTWVyY2F0b3IoYS50b3AsYS5yaWdodCk6bmV3IE9wZW5MYXllcnMuTG9uTGF0KGEudG9wLGEucmlnaHQpLGI9bmV3IEdMYXRMbmdCb3VuZHMobmV3IEdMYXRMbmcoYi5sYXQsYi5sb24pLG5ldyBHTGF0TG5nKGEubGF0LGEubG9uKSkpO3JldHVybiBifSxzZXRNYXBPYmplY3RDZW50ZXI6ZnVuY3Rpb24oYSxiKXt0aGlzLm1hcE9iamVjdC5zZXRDZW50ZXIoYSxiKX0sZHJhZ1Bhbk1hcE9iamVjdDpmdW5jdGlvbihhLGIpe3RoaXMuZHJhZ09iamVjdC5tb3ZlQnkobmV3IEdTaXplKC1hLGIpKX0sZ2V0TWFwT2JqZWN0TG9uTGF0RnJvbU1hcE9iamVjdFBpeGVsOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLm1hcE9iamVjdC5mcm9tQ29udGFpbmVyUGl4ZWxUb0xhdExuZyhhKX0sXG5nZXRNYXBPYmplY3RQaXhlbEZyb21NYXBPYmplY3RMb25MYXQ6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMubWFwT2JqZWN0LmZyb21MYXRMbmdUb0NvbnRhaW5lclBpeGVsKGEpfSxnZXRNYXBPYmplY3Rab29tRnJvbU1hcE9iamVjdEJvdW5kczpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5tYXBPYmplY3QuZ2V0Qm91bmRzWm9vbUxldmVsKGEpfSxnZXRNYXBPYmplY3RMb25MYXRGcm9tTG9uTGF0OmZ1bmN0aW9uKGEsYil7dmFyIGM7dGhpcy5zcGhlcmljYWxNZXJjYXRvcj8oYz10aGlzLmludmVyc2VNZXJjYXRvcihhLGIpLGM9bmV3IEdMYXRMbmcoYy5sYXQsYy5sb24pKTpjPW5ldyBHTGF0TG5nKGIsYSk7cmV0dXJuIGN9LGdldE1hcE9iamVjdFBpeGVsRnJvbVhZOmZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBHUG9pbnQoYSxiKX19O09wZW5MYXllcnMuRm9ybWF0LlhNTD1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuRm9ybWF0LHtuYW1lc3BhY2VzOm51bGwsbmFtZXNwYWNlQWxpYXM6bnVsbCxkZWZhdWx0UHJlZml4Om51bGwscmVhZGVyczp7fSx3cml0ZXJzOnt9LHhtbGRvbTpudWxsLGluaXRpYWxpemU6ZnVuY3Rpb24oYSl7d2luZG93LkFjdGl2ZVhPYmplY3QmJih0aGlzLnhtbGRvbT1uZXcgQWN0aXZlWE9iamVjdChcIk1pY3Jvc29mdC5YTUxET01cIikpO09wZW5MYXllcnMuRm9ybWF0LnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsW2FdKTt0aGlzLm5hbWVzcGFjZXM9T3BlbkxheWVycy5VdGlsLmV4dGVuZCh7fSx0aGlzLm5hbWVzcGFjZXMpO3RoaXMubmFtZXNwYWNlQWxpYXM9e307Zm9yKHZhciBiIGluIHRoaXMubmFtZXNwYWNlcyl0aGlzLm5hbWVzcGFjZUFsaWFzW3RoaXMubmFtZXNwYWNlc1tiXV09Yn0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMueG1sZG9tPW51bGw7T3BlbkxheWVycy5Gb3JtYXQucHJvdG90eXBlLmRlc3Ryb3kuYXBwbHkodGhpcyxcbmFyZ3VtZW50cyl9LHNldE5hbWVzcGFjZTpmdW5jdGlvbihhLGIpe3RoaXMubmFtZXNwYWNlc1thXT1iO3RoaXMubmFtZXNwYWNlQWxpYXNbYl09YX0scmVhZDpmdW5jdGlvbihhKXt2YXIgYj1hLmluZGV4T2YoXCI8XCIpOzA8YiYmKGE9YS5zdWJzdHJpbmcoYikpO2I9T3BlbkxheWVycy5VdGlsLlRyeShPcGVuTGF5ZXJzLkZ1bmN0aW9uLmJpbmQoZnVuY3Rpb24oKXt2YXIgYjtiPXdpbmRvdy5BY3RpdmVYT2JqZWN0JiYhdGhpcy54bWxkb20/bmV3IEFjdGl2ZVhPYmplY3QoXCJNaWNyb3NvZnQuWE1MRE9NXCIpOnRoaXMueG1sZG9tO2IubG9hZFhNTChhKTtyZXR1cm4gYn0sdGhpcyksZnVuY3Rpb24oKXtyZXR1cm4obmV3IERPTVBhcnNlcikucGFyc2VGcm9tU3RyaW5nKGEsXCJ0ZXh0L3htbFwiKX0sZnVuY3Rpb24oKXt2YXIgYj1uZXcgWE1MSHR0cFJlcXVlc3Q7Yi5vcGVuKFwiR0VUXCIsXCJkYXRhOnRleHQveG1sO2NoYXJzZXQ9dXRmLTgsXCIrZW5jb2RlVVJJQ29tcG9uZW50KGEpLCExKTtiLm92ZXJyaWRlTWltZVR5cGUmJlxuYi5vdmVycmlkZU1pbWVUeXBlKFwidGV4dC94bWxcIik7Yi5zZW5kKG51bGwpO3JldHVybiBiLnJlc3BvbnNlWE1MfSk7dGhpcy5rZWVwRGF0YSYmKHRoaXMuZGF0YT1iKTtyZXR1cm4gYn0sd3JpdGU6ZnVuY3Rpb24oYSl7aWYodGhpcy54bWxkb20pYT1hLnhtbDtlbHNle3ZhciBiPW5ldyBYTUxTZXJpYWxpemVyO2lmKDE9PWEubm9kZVR5cGUpe3ZhciBjPWRvY3VtZW50LmltcGxlbWVudGF0aW9uLmNyZWF0ZURvY3VtZW50KFwiXCIsXCJcIixudWxsKTtjLmltcG9ydE5vZGUmJihhPWMuaW1wb3J0Tm9kZShhLCEwKSk7Yy5hcHBlbmRDaGlsZChhKTthPWIuc2VyaWFsaXplVG9TdHJpbmcoYyl9ZWxzZSBhPWIuc2VyaWFsaXplVG9TdHJpbmcoYSl9cmV0dXJuIGF9LGNyZWF0ZUVsZW1lbnROUzpmdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLnhtbGRvbT9cInN0cmluZ1wiPT10eXBlb2YgYT90aGlzLnhtbGRvbS5jcmVhdGVOb2RlKDEsYixhKTp0aGlzLnhtbGRvbS5jcmVhdGVOb2RlKDEsYixcIlwiKTpkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoYSxcbmIpfSxjcmVhdGVUZXh0Tm9kZTpmdW5jdGlvbihhKXtcInN0cmluZ1wiIT09dHlwZW9mIGEmJihhPVwiXCIrYSk7cmV0dXJuIHRoaXMueG1sZG9tP3RoaXMueG1sZG9tLmNyZWF0ZVRleHROb2RlKGEpOmRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGEpfSxnZXRFbGVtZW50c0J5VGFnTmFtZU5TOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD1bXTtpZihhLmdldEVsZW1lbnRzQnlUYWdOYW1lTlMpZD1hLmdldEVsZW1lbnRzQnlUYWdOYW1lTlMoYixjKTtlbHNlIGZvcih2YXIgYT1hLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiKlwiKSxlLGYsZz0wLGg9YS5sZW5ndGg7ZzxoOysrZylpZihlPWFbZ10sZj1lLnByZWZpeD9lLnByZWZpeCtcIjpcIitjOmMsXCIqXCI9PWN8fGY9PWUubm9kZU5hbWUpKFwiKlwiPT1ifHxiPT1lLm5hbWVzcGFjZVVSSSkmJmQucHVzaChlKTtyZXR1cm4gZH0sZ2V0QXR0cmlidXRlTm9kZU5TOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD1udWxsO2lmKGEuZ2V0QXR0cmlidXRlTm9kZU5TKWQ9YS5nZXRBdHRyaWJ1dGVOb2RlTlMoYixcbmMpO2Vsc2UgZm9yKHZhciBhPWEuYXR0cmlidXRlcyxlLGYsZz0wLGg9YS5sZW5ndGg7ZzxoOysrZylpZihlPWFbZ10sZS5uYW1lc3BhY2VVUkk9PWImJihmPWUucHJlZml4P2UucHJlZml4K1wiOlwiK2M6YyxmPT1lLm5vZGVOYW1lKSl7ZD1lO2JyZWFrfXJldHVybiBkfSxnZXRBdHRyaWJ1dGVOUzpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9XCJcIjtpZihhLmdldEF0dHJpYnV0ZU5TKWQ9YS5nZXRBdHRyaWJ1dGVOUyhiLGMpfHxcIlwiO2Vsc2UgaWYoYT10aGlzLmdldEF0dHJpYnV0ZU5vZGVOUyhhLGIsYykpZD1hLm5vZGVWYWx1ZTtyZXR1cm4gZH0sZ2V0Q2hpbGRWYWx1ZTpmdW5jdGlvbihhLGIpe3ZhciBjPWJ8fFwiXCI7aWYoYSlmb3IodmFyIGQ9YS5maXJzdENoaWxkO2Q7ZD1kLm5leHRTaWJsaW5nKXN3aXRjaChkLm5vZGVUeXBlKXtjYXNlIDM6Y2FzZSA0OmMrPWQubm9kZVZhbHVlfXJldHVybiBjfSxpc1NpbXBsZUNvbnRlbnQ6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPSEwLGE9YS5maXJzdENoaWxkO2E7YT1cbmEubmV4dFNpYmxpbmcpaWYoMT09PWEubm9kZVR5cGUpe2I9ITE7YnJlYWt9cmV0dXJuIGJ9LGNvbnRlbnRUeXBlOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj0hMSxjPSExLGQ9T3BlbkxheWVycy5Gb3JtYXQuWE1MLkNPTlRFTlRfVFlQRS5FTVBUWSxhPWEuZmlyc3RDaGlsZDthO2E9YS5uZXh0U2libGluZyl7c3dpdGNoKGEubm9kZVR5cGUpe2Nhc2UgMTpjPSEwO2JyZWFrO2Nhc2UgODpicmVhaztkZWZhdWx0OmI9ITB9aWYoYyYmYilicmVha31pZihjJiZiKWQ9T3BlbkxheWVycy5Gb3JtYXQuWE1MLkNPTlRFTlRfVFlQRS5NSVhFRDtlbHNle2lmKGMpcmV0dXJuIE9wZW5MYXllcnMuRm9ybWF0LlhNTC5DT05URU5UX1RZUEUuQ09NUExFWDtpZihiKXJldHVybiBPcGVuTGF5ZXJzLkZvcm1hdC5YTUwuQ09OVEVOVF9UWVBFLlNJTVBMRX1yZXR1cm4gZH0saGFzQXR0cmlidXRlTlM6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPSExO3JldHVybiBkPWEuaGFzQXR0cmlidXRlTlM/YS5oYXNBdHRyaWJ1dGVOUyhiLFxuYyk6ISF0aGlzLmdldEF0dHJpYnV0ZU5vZGVOUyhhLGIsYyl9LHNldEF0dHJpYnV0ZU5TOmZ1bmN0aW9uKGEsYixjLGQpe2lmKGEuc2V0QXR0cmlidXRlTlMpYS5zZXRBdHRyaWJ1dGVOUyhiLGMsZCk7ZWxzZSBpZih0aGlzLnhtbGRvbSliPyhiPWEub3duZXJEb2N1bWVudC5jcmVhdGVOb2RlKDIsYyxiKSxiLm5vZGVWYWx1ZT1kLGEuc2V0QXR0cmlidXRlTm9kZShiKSk6YS5zZXRBdHRyaWJ1dGUoYyxkKTtlbHNlIHRocm93XCJzZXRBdHRyaWJ1dGVOUyBub3QgaW1wbGVtZW50ZWRcIjt9LGNyZWF0ZUVsZW1lbnROU1BsdXM6ZnVuY3Rpb24oYSxiKXt2YXIgYj1ifHx7fSxjPWIudXJpfHx0aGlzLm5hbWVzcGFjZXNbYi5wcmVmaXhdO2N8fChjPWEuaW5kZXhPZihcIjpcIiksYz10aGlzLm5hbWVzcGFjZXNbYS5zdWJzdHJpbmcoMCxjKV0pO2N8fChjPXRoaXMubmFtZXNwYWNlc1t0aGlzLmRlZmF1bHRQcmVmaXhdKTtjPXRoaXMuY3JlYXRlRWxlbWVudE5TKGMsYSk7Yi5hdHRyaWJ1dGVzJiZ0aGlzLnNldEF0dHJpYnV0ZXMoYyxcbmIuYXR0cmlidXRlcyk7dmFyIGQ9Yi52YWx1ZTtudWxsIT1kJiZjLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlVGV4dE5vZGUoZCkpO3JldHVybiBjfSxzZXRBdHRyaWJ1dGVzOmZ1bmN0aW9uKGEsYil7dmFyIGMsZCxlO2ZvcihlIGluIGIpbnVsbCE9YltlXSYmYltlXS50b1N0cmluZyYmKGM9YltlXS50b1N0cmluZygpLGQ9dGhpcy5uYW1lc3BhY2VzW2Uuc3Vic3RyaW5nKDAsZS5pbmRleE9mKFwiOlwiKSldfHxudWxsLHRoaXMuc2V0QXR0cmlidXRlTlMoYSxkLGUsYykpfSxyZWFkTm9kZTpmdW5jdGlvbihhLGIpe2J8fChiPXt9KTt2YXIgYz10aGlzLnJlYWRlcnNbYS5uYW1lc3BhY2VVUkk/dGhpcy5uYW1lc3BhY2VBbGlhc1thLm5hbWVzcGFjZVVSSV06dGhpcy5kZWZhdWx0UHJlZml4XTtpZihjKXt2YXIgZD1hLmxvY2FsTmFtZXx8YS5ub2RlTmFtZS5zcGxpdChcIjpcIikucG9wKCk7KGM9Y1tkXXx8Y1tcIipcIl0pJiZjLmFwcGx5KHRoaXMsW2EsYl0pfXJldHVybiBifSxyZWFkQ2hpbGROb2RlczpmdW5jdGlvbihhLFxuYil7Ynx8KGI9e30pO2Zvcih2YXIgYz1hLmNoaWxkTm9kZXMsZCxlPTAsZj1jLmxlbmd0aDtlPGY7KytlKWQ9Y1tlXSwxPT1kLm5vZGVUeXBlJiZ0aGlzLnJlYWROb2RlKGQsYik7cmV0dXJuIGJ9LHdyaXRlTm9kZTpmdW5jdGlvbihhLGIsYyl7dmFyIGQsZT1hLmluZGV4T2YoXCI6XCIpOzA8ZT8oZD1hLnN1YnN0cmluZygwLGUpLGE9YS5zdWJzdHJpbmcoZSsxKSk6ZD1jP3RoaXMubmFtZXNwYWNlQWxpYXNbYy5uYW1lc3BhY2VVUkldOnRoaXMuZGVmYXVsdFByZWZpeDtiPXRoaXMud3JpdGVyc1tkXVthXS5hcHBseSh0aGlzLFtiXSk7YyYmYy5hcHBlbmRDaGlsZChiKTtyZXR1cm4gYn0sZ2V0Q2hpbGRFbDpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIGEmJnRoaXMuZ2V0VGhpc09yTmV4dEVsKGEuZmlyc3RDaGlsZCxiLGMpfSxnZXROZXh0RWw6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBhJiZ0aGlzLmdldFRoaXNPck5leHRFbChhLm5leHRTaWJsaW5nLGIsYyl9LGdldFRoaXNPck5leHRFbDpmdW5jdGlvbihhLFxuYixjKXthOmZvcig7YTthPWEubmV4dFNpYmxpbmcpc3dpdGNoKGEubm9kZVR5cGUpe2Nhc2UgMTppZigoIWJ8fGI9PT0oYS5sb2NhbE5hbWV8fGEubm9kZU5hbWUuc3BsaXQoXCI6XCIpLnBvcCgpKSkmJighY3x8Yz09PWEubmFtZXNwYWNlVVJJKSlicmVhayBhO2E9bnVsbDticmVhayBhO2Nhc2UgMzppZigvXlxccyokLy50ZXN0KGEubm9kZVZhbHVlKSlicmVhaztjYXNlIDQ6Y2FzZSA2OmNhc2UgMTI6Y2FzZSAxMDpjYXNlIDExOmE9bnVsbDticmVhayBhfXJldHVybiBhfHxudWxsfSxsb29rdXBOYW1lc3BhY2VVUkk6ZnVuY3Rpb24oYSxiKXt2YXIgYz1udWxsO2lmKGEpaWYoYS5sb29rdXBOYW1lc3BhY2VVUkkpYz1hLmxvb2t1cE5hbWVzcGFjZVVSSShiKTtlbHNlIGE6c3dpdGNoKGEubm9kZVR5cGUpe2Nhc2UgMTppZihudWxsIT09YS5uYW1lc3BhY2VVUkkmJmEucHJlZml4PT09Yil7Yz1hLm5hbWVzcGFjZVVSSTticmVhayBhfWlmKGM9YS5hdHRyaWJ1dGVzLmxlbmd0aClmb3IodmFyIGQsXG5lPTA7ZTxjOysrZSlpZihkPWEuYXR0cmlidXRlc1tlXSxcInhtbG5zXCI9PT1kLnByZWZpeCYmZC5uYW1lPT09XCJ4bWxuczpcIitiKXtjPWQudmFsdWV8fG51bGw7YnJlYWsgYX1lbHNlIGlmKFwieG1sbnNcIj09PWQubmFtZSYmbnVsbD09PWIpe2M9ZC52YWx1ZXx8bnVsbDticmVhayBhfWM9dGhpcy5sb29rdXBOYW1lc3BhY2VVUkkoYS5wYXJlbnROb2RlLGIpO2JyZWFrIGE7Y2FzZSAyOmM9dGhpcy5sb29rdXBOYW1lc3BhY2VVUkkoYS5vd25lckVsZW1lbnQsYik7YnJlYWsgYTtjYXNlIDk6Yz10aGlzLmxvb2t1cE5hbWVzcGFjZVVSSShhLmRvY3VtZW50RWxlbWVudCxiKTticmVhayBhO2Nhc2UgNjpjYXNlIDEyOmNhc2UgMTA6Y2FzZSAxMTpicmVhayBhO2RlZmF1bHQ6Yz10aGlzLmxvb2t1cE5hbWVzcGFjZVVSSShhLnBhcmVudE5vZGUsYil9cmV0dXJuIGN9LGdldFhNTERvYzpmdW5jdGlvbigpeyFPcGVuTGF5ZXJzLkZvcm1hdC5YTUwuZG9jdW1lbnQmJiF0aGlzLnhtbGRvbSYmKGRvY3VtZW50LmltcGxlbWVudGF0aW9uJiZcbmRvY3VtZW50LmltcGxlbWVudGF0aW9uLmNyZWF0ZURvY3VtZW50P09wZW5MYXllcnMuRm9ybWF0LlhNTC5kb2N1bWVudD1kb2N1bWVudC5pbXBsZW1lbnRhdGlvbi5jcmVhdGVEb2N1bWVudChcIlwiLFwiXCIsbnVsbCk6IXRoaXMueG1sZG9tJiZ3aW5kb3cuQWN0aXZlWE9iamVjdCYmKHRoaXMueG1sZG9tPW5ldyBBY3RpdmVYT2JqZWN0KFwiTWljcm9zb2Z0LlhNTERPTVwiKSkpO3JldHVybiBPcGVuTGF5ZXJzLkZvcm1hdC5YTUwuZG9jdW1lbnR8fHRoaXMueG1sZG9tfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Gb3JtYXQuWE1MXCJ9KTtPcGVuTGF5ZXJzLkZvcm1hdC5YTUwuQ09OVEVOVF9UWVBFPXtFTVBUWTowLFNJTVBMRToxLENPTVBMRVg6MixNSVhFRDozfTtPcGVuTGF5ZXJzLkZvcm1hdC5YTUwubG9va3VwTmFtZXNwYWNlVVJJPU9wZW5MYXllcnMuRnVuY3Rpb24uYmluZChPcGVuTGF5ZXJzLkZvcm1hdC5YTUwucHJvdG90eXBlLmxvb2t1cE5hbWVzcGFjZVVSSSxPcGVuTGF5ZXJzLkZvcm1hdC5YTUwucHJvdG90eXBlKTtcbk9wZW5MYXllcnMuRm9ybWF0LlhNTC5kb2N1bWVudD1udWxsO09wZW5MYXllcnMuRm9ybWF0LldGU1Q9ZnVuY3Rpb24oYSl7dmFyIGE9T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoYSxPcGVuTGF5ZXJzLkZvcm1hdC5XRlNULkRFRkFVTFRTKSxiPU9wZW5MYXllcnMuRm9ybWF0LldGU1RbXCJ2XCIrYS52ZXJzaW9uLnJlcGxhY2UoL1xcLi9nLFwiX1wiKV07aWYoIWIpdGhyb3dcIlVuc3VwcG9ydGVkIFdGU1QgdmVyc2lvbjogXCIrYS52ZXJzaW9uO3JldHVybiBuZXcgYihhKX07T3BlbkxheWVycy5Gb3JtYXQuV0ZTVC5ERUZBVUxUUz17dmVyc2lvbjpcIjEuMC4wXCJ9O09wZW5MYXllcnMuRm9ybWF0LldGU1QudjE9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkZvcm1hdC5YTUwse25hbWVzcGFjZXM6e3hsaW5rOlwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGlua1wiLHhzaTpcImh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hLWluc3RhbmNlXCIsd2ZzOlwiaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC93ZnNcIixnbWw6XCJodHRwOi8vd3d3Lm9wZW5naXMubmV0L2dtbFwiLG9nYzpcImh0dHA6Ly93d3cub3Blbmdpcy5uZXQvb2djXCIsb3dzOlwiaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC9vd3NcIn0sZGVmYXVsdFByZWZpeDpcIndmc1wiLHZlcnNpb246bnVsbCxzY2hlbWFMb2NhdGlvbnM6bnVsbCxzcnNOYW1lOm51bGwsZXh0cmFjdEF0dHJpYnV0ZXM6ITAseHk6ITAsc3RhdGVOYW1lOm51bGwsaW5pdGlhbGl6ZTpmdW5jdGlvbihhKXt0aGlzLnN0YXRlTmFtZT17fTt0aGlzLnN0YXRlTmFtZVtPcGVuTGF5ZXJzLlN0YXRlLklOU0VSVF09XCJ3ZnM6SW5zZXJ0XCI7dGhpcy5zdGF0ZU5hbWVbT3BlbkxheWVycy5TdGF0ZS5VUERBVEVdPVxuXCJ3ZnM6VXBkYXRlXCI7dGhpcy5zdGF0ZU5hbWVbT3BlbkxheWVycy5TdGF0ZS5ERUxFVEVdPVwid2ZzOkRlbGV0ZVwiO09wZW5MYXllcnMuRm9ybWF0LlhNTC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLFthXSl9LGdldFNyc05hbWU6ZnVuY3Rpb24oYSxiKXt2YXIgYz1iJiZiLnNyc05hbWU7Y3x8KGM9YSYmYS5sYXllcj9hLmxheWVyLnByb2plY3Rpb24uZ2V0Q29kZSgpOnRoaXMuc3JzTmFtZSk7cmV0dXJuIGN9LHJlYWQ6ZnVuY3Rpb24oYSxiKXtiPWJ8fHt9O09wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKGIse291dHB1dDpcImZlYXR1cmVzXCJ9KTtcInN0cmluZ1wiPT10eXBlb2YgYSYmKGE9T3BlbkxheWVycy5Gb3JtYXQuWE1MLnByb3RvdHlwZS5yZWFkLmFwcGx5KHRoaXMsW2FdKSk7YSYmOT09YS5ub2RlVHlwZSYmKGE9YS5kb2N1bWVudEVsZW1lbnQpO3ZhciBjPXt9O2EmJnRoaXMucmVhZE5vZGUoYSxjLCEwKTtjLmZlYXR1cmVzJiZcImZlYXR1cmVzXCI9PT1iLm91dHB1dCYmXG4oYz1jLmZlYXR1cmVzKTtyZXR1cm4gY30scmVhZGVyczp7d2ZzOntGZWF0dXJlQ29sbGVjdGlvbjpmdW5jdGlvbihhLGIpe2IuZmVhdHVyZXM9W107dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIpfX19LHdyaXRlOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy53cml0ZU5vZGUoXCJ3ZnM6VHJhbnNhY3Rpb25cIix7ZmVhdHVyZXM6YSxvcHRpb25zOmJ9KSxkPXRoaXMuc2NoZW1hTG9jYXRpb25BdHRyKCk7ZCYmdGhpcy5zZXRBdHRyaWJ1dGVOUyhjLHRoaXMubmFtZXNwYWNlcy54c2ksXCJ4c2k6c2NoZW1hTG9jYXRpb25cIixkKTtyZXR1cm4gT3BlbkxheWVycy5Gb3JtYXQuWE1MLnByb3RvdHlwZS53cml0ZS5hcHBseSh0aGlzLFtjXSl9LHdyaXRlcnM6e3dmczp7R2V0RmVhdHVyZTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJ3ZnM6R2V0RmVhdHVyZVwiLHthdHRyaWJ1dGVzOntzZXJ2aWNlOlwiV0ZTXCIsdmVyc2lvbjp0aGlzLnZlcnNpb24saGFuZGxlOmEmJmEuaGFuZGxlLFxub3V0cHV0Rm9ybWF0OmEmJmEub3V0cHV0Rm9ybWF0LG1heEZlYXR1cmVzOmEmJmEubWF4RmVhdHVyZXMsXCJ4c2k6c2NoZW1hTG9jYXRpb25cIjp0aGlzLnNjaGVtYUxvY2F0aW9uQXR0cihhKX19KTtpZihcInN0cmluZ1wiPT10eXBlb2YgdGhpcy5mZWF0dXJlVHlwZSl0aGlzLndyaXRlTm9kZShcIlF1ZXJ5XCIsYSxiKTtlbHNlIGZvcih2YXIgYz0wLGQ9dGhpcy5mZWF0dXJlVHlwZS5sZW5ndGg7YzxkO2MrKylhLmZlYXR1cmVUeXBlPXRoaXMuZmVhdHVyZVR5cGVbY10sdGhpcy53cml0ZU5vZGUoXCJRdWVyeVwiLGEsYik7cmV0dXJuIGJ9LFRyYW5zYWN0aW9uOmZ1bmN0aW9uKGEpe3ZhciBhPWF8fHt9LGI9YS5vcHRpb25zfHx7fSxjPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIndmczpUcmFuc2FjdGlvblwiLHthdHRyaWJ1dGVzOntzZXJ2aWNlOlwiV0ZTXCIsdmVyc2lvbjp0aGlzLnZlcnNpb24saGFuZGxlOmIuaGFuZGxlfX0pLGQsZT1hLmZlYXR1cmVzO2lmKGUpeyEwPT09Yi5tdWx0aSYmT3BlbkxheWVycy5VdGlsLmV4dGVuZCh0aGlzLmdlb21ldHJ5VHlwZXMsXG57XCJPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50XCI6XCJNdWx0aVBvaW50XCIsXCJPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVTdHJpbmdcIjohMD09PXRoaXMubXVsdGlDdXJ2ZT9cIk11bHRpQ3VydmVcIjpcIk11bHRpTGluZVN0cmluZ1wiLFwiT3BlbkxheWVycy5HZW9tZXRyeS5Qb2x5Z29uXCI6ITA9PT10aGlzLm11bHRpU3VyZmFjZT9cIk11bHRpU3VyZmFjZVwiOlwiTXVsdGlQb2x5Z29uXCJ9KTt2YXIgZixnLGE9MDtmb3IoZD1lLmxlbmd0aDthPGQ7KythKWc9ZVthXSwoZj10aGlzLnN0YXRlTmFtZVtnLnN0YXRlXSkmJnRoaXMud3JpdGVOb2RlKGYse2ZlYXR1cmU6ZyxvcHRpb25zOmJ9LGMpOyEwPT09Yi5tdWx0aSYmdGhpcy5zZXRHZW9tZXRyeVR5cGVzKCl9aWYoYi5uYXRpdmVFbGVtZW50cyl7YT0wO2ZvcihkPWIubmF0aXZlRWxlbWVudHMubGVuZ3RoO2E8ZDsrK2EpdGhpcy53cml0ZU5vZGUoXCJ3ZnM6TmF0aXZlXCIsYi5uYXRpdmVFbGVtZW50c1thXSxjKX1yZXR1cm4gY30sTmF0aXZlOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJ3ZnM6TmF0aXZlXCIsXG57YXR0cmlidXRlczp7dmVuZG9ySWQ6YS52ZW5kb3JJZCxzYWZlVG9JZ25vcmU6YS5zYWZlVG9JZ25vcmV9LHZhbHVlOmEudmFsdWV9KX0sSW5zZXJ0OmZ1bmN0aW9uKGEpe3ZhciBiPWEuZmVhdHVyZSxhPWEub3B0aW9ucyxhPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIndmczpJbnNlcnRcIix7YXR0cmlidXRlczp7aGFuZGxlOmEmJmEuaGFuZGxlfX0pO3RoaXMuc3JzTmFtZT10aGlzLmdldFNyc05hbWUoYik7dGhpcy53cml0ZU5vZGUoXCJmZWF0dXJlOl90eXBlTmFtZVwiLGIsYSk7cmV0dXJuIGF9LFVwZGF0ZTpmdW5jdGlvbihhKXt2YXIgYj1hLmZlYXR1cmUsYT1hLm9wdGlvbnMsYT10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJ3ZnM6VXBkYXRlXCIse2F0dHJpYnV0ZXM6e2hhbmRsZTphJiZhLmhhbmRsZSx0eXBlTmFtZToodGhpcy5mZWF0dXJlTlM/dGhpcy5mZWF0dXJlUHJlZml4K1wiOlwiOlwiXCIpK3RoaXMuZmVhdHVyZVR5cGV9fSk7dGhpcy5mZWF0dXJlTlMmJmEuc2V0QXR0cmlidXRlKFwieG1sbnM6XCIrXG50aGlzLmZlYXR1cmVQcmVmaXgsdGhpcy5mZWF0dXJlTlMpO3ZhciBjPWIubW9kaWZpZWQ7aWYobnVsbCE9PXRoaXMuZ2VvbWV0cnlOYW1lJiYoIWN8fHZvaWQgMCE9PWMuZ2VvbWV0cnkpKXRoaXMuc3JzTmFtZT10aGlzLmdldFNyc05hbWUoYiksdGhpcy53cml0ZU5vZGUoXCJQcm9wZXJ0eVwiLHtuYW1lOnRoaXMuZ2VvbWV0cnlOYW1lLHZhbHVlOmIuZ2VvbWV0cnl9LGEpO2Zvcih2YXIgZCBpbiBiLmF0dHJpYnV0ZXMpdm9pZCAwIT09Yi5hdHRyaWJ1dGVzW2RdJiYoIWN8fCFjLmF0dHJpYnV0ZXN8fGMuYXR0cmlidXRlcyYmdm9pZCAwIT09Yy5hdHRyaWJ1dGVzW2RdKSYmdGhpcy53cml0ZU5vZGUoXCJQcm9wZXJ0eVwiLHtuYW1lOmQsdmFsdWU6Yi5hdHRyaWJ1dGVzW2RdfSxhKTt0aGlzLndyaXRlTm9kZShcIm9nYzpGaWx0ZXJcIixuZXcgT3BlbkxheWVycy5GaWx0ZXIuRmVhdHVyZUlkKHtmaWRzOltiLmZpZF19KSxhKTtyZXR1cm4gYX0sUHJvcGVydHk6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwid2ZzOlByb3BlcnR5XCIpO1xudGhpcy53cml0ZU5vZGUoXCJOYW1lXCIsYS5uYW1lLGIpO251bGwhPT1hLnZhbHVlJiZ0aGlzLndyaXRlTm9kZShcIlZhbHVlXCIsYS52YWx1ZSxiKTtyZXR1cm4gYn0sTmFtZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwid2ZzOk5hbWVcIix7dmFsdWU6YX0pfSxWYWx1ZTpmdW5jdGlvbihhKXt2YXIgYjthIGluc3RhbmNlb2YgT3BlbkxheWVycy5HZW9tZXRyeT8oYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJ3ZnM6VmFsdWVcIiksYT10aGlzLndyaXRlTm9kZShcImZlYXR1cmU6X2dlb21ldHJ5XCIsYSkuZmlyc3RDaGlsZCxiLmFwcGVuZENoaWxkKGEpKTpiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIndmczpWYWx1ZVwiLHt2YWx1ZTphfSk7cmV0dXJuIGJ9LERlbGV0ZTpmdW5jdGlvbihhKXt2YXIgYj1hLmZlYXR1cmUsYT1hLm9wdGlvbnMsYT10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJ3ZnM6RGVsZXRlXCIse2F0dHJpYnV0ZXM6e2hhbmRsZTphJiZcbmEuaGFuZGxlLHR5cGVOYW1lOih0aGlzLmZlYXR1cmVOUz90aGlzLmZlYXR1cmVQcmVmaXgrXCI6XCI6XCJcIikrdGhpcy5mZWF0dXJlVHlwZX19KTt0aGlzLmZlYXR1cmVOUyYmYS5zZXRBdHRyaWJ1dGUoXCJ4bWxuczpcIit0aGlzLmZlYXR1cmVQcmVmaXgsdGhpcy5mZWF0dXJlTlMpO3RoaXMud3JpdGVOb2RlKFwib2djOkZpbHRlclwiLG5ldyBPcGVuTGF5ZXJzLkZpbHRlci5GZWF0dXJlSWQoe2ZpZHM6W2IuZmlkXX0pLGEpO3JldHVybiBhfX19LHNjaGVtYUxvY2F0aW9uQXR0cjpmdW5jdGlvbihhKXt2YXIgYT1PcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHtmZWF0dXJlUHJlZml4OnRoaXMuZmVhdHVyZVByZWZpeCxzY2hlbWE6dGhpcy5zY2hlbWF9LGEpLGI9T3BlbkxheWVycy5VdGlsLmV4dGVuZCh7fSx0aGlzLnNjaGVtYUxvY2F0aW9ucyk7YS5zY2hlbWEmJihiW2EuZmVhdHVyZVByZWZpeF09YS5zY2hlbWEpO3ZhciBhPVtdLGMsZDtmb3IoZCBpbiBiKShjPXRoaXMubmFtZXNwYWNlc1tkXSkmJlxuYS5wdXNoKGMrXCIgXCIrYltkXSk7cmV0dXJuIGEuam9pbihcIiBcIil8fHZvaWQgMH0sc2V0RmlsdGVyUHJvcGVydHk6ZnVuY3Rpb24oYSl7aWYoYS5maWx0ZXJzKWZvcih2YXIgYj0wLGM9YS5maWx0ZXJzLmxlbmd0aDtiPGM7KytiKU9wZW5MYXllcnMuRm9ybWF0LldGU1QudjEucHJvdG90eXBlLnNldEZpbHRlclByb3BlcnR5LmNhbGwodGhpcyxhLmZpbHRlcnNbYl0pO2Vsc2UgYSBpbnN0YW5jZW9mIE9wZW5MYXllcnMuRmlsdGVyLlNwYXRpYWwmJiFhLnByb3BlcnR5JiYoYS5wcm9wZXJ0eT10aGlzLmdlb21ldHJ5TmFtZSl9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZvcm1hdC5XRlNULnYxXCJ9KTtPcGVuTGF5ZXJzLkZvcm1hdC5PR0NFeGNlcHRpb25SZXBvcnQ9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkZvcm1hdC5YTUwse25hbWVzcGFjZXM6e29nYzpcImh0dHA6Ly93d3cub3Blbmdpcy5uZXQvb2djXCJ9LHJlZ0V4ZXM6e3RyaW1TcGFjZTovXlxccyp8XFxzKiQvZyxyZW1vdmVTcGFjZTovXFxzKi9nLHNwbGl0U3BhY2U6L1xccysvLHRyaW1Db21tYTovXFxzKixcXHMqL2d9LGRlZmF1bHRQcmVmaXg6XCJvZ2NcIixyZWFkOmZ1bmN0aW9uKGEpe1wic3RyaW5nXCI9PXR5cGVvZiBhJiYoYT1PcGVuTGF5ZXJzLkZvcm1hdC5YTUwucHJvdG90eXBlLnJlYWQuYXBwbHkodGhpcyxbYV0pKTt2YXIgYj17ZXhjZXB0aW9uUmVwb3J0Om51bGx9O2EuZG9jdW1lbnRFbGVtZW50JiYodGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIpLG51bGw9PT1iLmV4Y2VwdGlvblJlcG9ydCYmKGI9KG5ldyBPcGVuTGF5ZXJzLkZvcm1hdC5PV1NDb21tb24pLnJlYWQoYSkpKTtyZXR1cm4gYn0scmVhZGVyczp7b2djOntTZXJ2aWNlRXhjZXB0aW9uUmVwb3J0OmZ1bmN0aW9uKGEsXG5iKXtiLmV4Y2VwdGlvblJlcG9ydD17ZXhjZXB0aW9uczpbXX07dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIuZXhjZXB0aW9uUmVwb3J0KX0sU2VydmljZUV4Y2VwdGlvbjpmdW5jdGlvbihhLGIpe3ZhciBjPXtjb2RlOmEuZ2V0QXR0cmlidXRlKFwiY29kZVwiKSxsb2NhdG9yOmEuZ2V0QXR0cmlidXRlKFwibG9jYXRvclwiKSx0ZXh0OnRoaXMuZ2V0Q2hpbGRWYWx1ZShhKX07Yi5leGNlcHRpb25zLnB1c2goYyl9fX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuRm9ybWF0Lk9HQ0V4Y2VwdGlvblJlcG9ydFwifSk7T3BlbkxheWVycy5Gb3JtYXQuWE1MLlZlcnNpb25lZE9HQz1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuRm9ybWF0LlhNTCx7ZGVmYXVsdFZlcnNpb246bnVsbCx2ZXJzaW9uOm51bGwscHJvZmlsZTpudWxsLGVycm9yUHJvcGVydHk6bnVsbCxuYW1lOm51bGwsc3RyaW5naWZ5T3V0cHV0OiExLHBhcnNlcjpudWxsLGluaXRpYWxpemU6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5Gb3JtYXQuWE1MLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsW2FdKTthPXRoaXMuQ0xBU1NfTkFNRTt0aGlzLm5hbWU9YS5zdWJzdHJpbmcoYS5sYXN0SW5kZXhPZihcIi5cIikrMSl9LGdldFZlcnNpb246ZnVuY3Rpb24oYSxiKXt2YXIgYzthPyhjPXRoaXMudmVyc2lvbixjfHwoYz1hLmdldEF0dHJpYnV0ZShcInZlcnNpb25cIiksY3x8KGM9dGhpcy5kZWZhdWx0VmVyc2lvbikpKTpjPWImJmIudmVyc2lvbnx8dGhpcy52ZXJzaW9ufHx0aGlzLmRlZmF1bHRWZXJzaW9uO3JldHVybiBjfSxnZXRQYXJzZXI6ZnVuY3Rpb24oYSl7dmFyIGE9XG5hfHx0aGlzLmRlZmF1bHRWZXJzaW9uLGI9dGhpcy5wcm9maWxlP1wiX1wiK3RoaXMucHJvZmlsZTpcIlwiO2lmKCF0aGlzLnBhcnNlcnx8dGhpcy5wYXJzZXIuVkVSU0lPTiE9YSl7dmFyIGM9T3BlbkxheWVycy5Gb3JtYXRbdGhpcy5uYW1lXVtcInZcIithLnJlcGxhY2UoL1xcLi9nLFwiX1wiKStiXTtpZighYyl0aHJvd1wiQ2FuJ3QgZmluZCBhIFwiK3RoaXMubmFtZStcIiBwYXJzZXIgZm9yIHZlcnNpb24gXCIrYStiO3RoaXMucGFyc2VyPW5ldyBjKHRoaXMub3B0aW9ucyl9cmV0dXJuIHRoaXMucGFyc2VyfSx3cml0ZTpmdW5jdGlvbihhLGIpe3RoaXMucGFyc2VyPXRoaXMuZ2V0UGFyc2VyKHRoaXMuZ2V0VmVyc2lvbihudWxsLGIpKTt2YXIgYz10aGlzLnBhcnNlci53cml0ZShhLGIpO3JldHVybiExPT09dGhpcy5zdHJpbmdpZnlPdXRwdXQ/YzpPcGVuTGF5ZXJzLkZvcm1hdC5YTUwucHJvdG90eXBlLndyaXRlLmFwcGx5KHRoaXMsW2NdKX0scmVhZDpmdW5jdGlvbihhLGIpe1wic3RyaW5nXCI9PXR5cGVvZiBhJiZcbihhPU9wZW5MYXllcnMuRm9ybWF0LlhNTC5wcm90b3R5cGUucmVhZC5hcHBseSh0aGlzLFthXSkpO3ZhciBjPXRoaXMuZ2V0VmVyc2lvbihhLmRvY3VtZW50RWxlbWVudCk7dGhpcy5wYXJzZXI9dGhpcy5nZXRQYXJzZXIoYyk7dmFyIGQ9dGhpcy5wYXJzZXIucmVhZChhLGIpO2lmKG51bGwhPT10aGlzLmVycm9yUHJvcGVydHkmJnZvaWQgMD09PWRbdGhpcy5lcnJvclByb3BlcnR5XSl7dmFyIGU9bmV3IE9wZW5MYXllcnMuRm9ybWF0Lk9HQ0V4Y2VwdGlvblJlcG9ydDtkLmVycm9yPWUucmVhZChhKX1kLnZlcnNpb249YztyZXR1cm4gZH0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuRm9ybWF0LlhNTC5WZXJzaW9uZWRPR0NcIn0pO09wZW5MYXllcnMuRmVhdHVyZT1PcGVuTGF5ZXJzLkNsYXNzKHtsYXllcjpudWxsLGlkOm51bGwsbG9ubGF0Om51bGwsZGF0YTpudWxsLG1hcmtlcjpudWxsLHBvcHVwQ2xhc3M6bnVsbCxwb3B1cDpudWxsLGluaXRpYWxpemU6ZnVuY3Rpb24oYSxiLGMpe3RoaXMubGF5ZXI9YTt0aGlzLmxvbmxhdD1iO3RoaXMuZGF0YT1udWxsIT1jP2M6e307dGhpcy5pZD1PcGVuTGF5ZXJzLlV0aWwuY3JlYXRlVW5pcXVlSUQodGhpcy5DTEFTU19OQU1FK1wiX1wiKX0sZGVzdHJveTpmdW5jdGlvbigpe251bGwhPXRoaXMubGF5ZXImJm51bGwhPXRoaXMubGF5ZXIubWFwJiZudWxsIT10aGlzLnBvcHVwJiZ0aGlzLmxheWVyLm1hcC5yZW1vdmVQb3B1cCh0aGlzLnBvcHVwKTtudWxsIT10aGlzLmxheWVyJiZudWxsIT10aGlzLm1hcmtlciYmdGhpcy5sYXllci5yZW1vdmVNYXJrZXIodGhpcy5tYXJrZXIpO3RoaXMuZGF0YT10aGlzLmxvbmxhdD10aGlzLmlkPXRoaXMubGF5ZXI9bnVsbDtudWxsIT10aGlzLm1hcmtlciYmXG4odGhpcy5kZXN0cm95TWFya2VyKHRoaXMubWFya2VyKSx0aGlzLm1hcmtlcj1udWxsKTtudWxsIT10aGlzLnBvcHVwJiYodGhpcy5kZXN0cm95UG9wdXAodGhpcy5wb3B1cCksdGhpcy5wb3B1cD1udWxsKX0sb25TY3JlZW46ZnVuY3Rpb24oKXt2YXIgYT0hMTtudWxsIT10aGlzLmxheWVyJiZudWxsIT10aGlzLmxheWVyLm1hcCYmKGE9dGhpcy5sYXllci5tYXAuZ2V0RXh0ZW50KCkuY29udGFpbnNMb25MYXQodGhpcy5sb25sYXQpKTtyZXR1cm4gYX0sY3JlYXRlTWFya2VyOmZ1bmN0aW9uKCl7bnVsbCE9dGhpcy5sb25sYXQmJih0aGlzLm1hcmtlcj1uZXcgT3BlbkxheWVycy5NYXJrZXIodGhpcy5sb25sYXQsdGhpcy5kYXRhLmljb24pKTtyZXR1cm4gdGhpcy5tYXJrZXJ9LGRlc3Ryb3lNYXJrZXI6ZnVuY3Rpb24oKXt0aGlzLm1hcmtlci5kZXN0cm95KCl9LGNyZWF0ZVBvcHVwOmZ1bmN0aW9uKGEpe251bGwhPXRoaXMubG9ubGF0JiYodGhpcy5wb3B1cHx8KHRoaXMucG9wdXA9bmV3ICh0aGlzLnBvcHVwQ2xhc3M/XG50aGlzLnBvcHVwQ2xhc3M6T3BlbkxheWVycy5Qb3B1cC5BbmNob3JlZCkodGhpcy5pZCtcIl9wb3B1cFwiLHRoaXMubG9ubGF0LHRoaXMuZGF0YS5wb3B1cFNpemUsdGhpcy5kYXRhLnBvcHVwQ29udGVudEhUTUwsdGhpcy5tYXJrZXI/dGhpcy5tYXJrZXIuaWNvbjpudWxsLGEpKSxudWxsIT10aGlzLmRhdGEub3ZlcmZsb3cmJih0aGlzLnBvcHVwLmNvbnRlbnREaXYuc3R5bGUub3ZlcmZsb3c9dGhpcy5kYXRhLm92ZXJmbG93KSx0aGlzLnBvcHVwLmZlYXR1cmU9dGhpcyk7cmV0dXJuIHRoaXMucG9wdXB9LGRlc3Ryb3lQb3B1cDpmdW5jdGlvbigpe3RoaXMucG9wdXAmJih0aGlzLnBvcHVwLmZlYXR1cmU9bnVsbCx0aGlzLnBvcHVwLmRlc3Ryb3koKSx0aGlzLnBvcHVwPW51bGwpfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5GZWF0dXJlXCJ9KTtPcGVuTGF5ZXJzLlN0YXRlPXtVTktOT1dOOlwiVW5rbm93blwiLElOU0VSVDpcIkluc2VydFwiLFVQREFURTpcIlVwZGF0ZVwiLERFTEVURTpcIkRlbGV0ZVwifTtcbk9wZW5MYXllcnMuRmVhdHVyZS5WZWN0b3I9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkZlYXR1cmUse2ZpZDpudWxsLGdlb21ldHJ5Om51bGwsYXR0cmlidXRlczpudWxsLGJvdW5kczpudWxsLHN0YXRlOm51bGwsc3R5bGU6bnVsbCx1cmw6bnVsbCxyZW5kZXJJbnRlbnQ6XCJkZWZhdWx0XCIsbW9kaWZpZWQ6bnVsbCxpbml0aWFsaXplOmZ1bmN0aW9uKGEsYixjKXtPcGVuTGF5ZXJzLkZlYXR1cmUucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbbnVsbCxudWxsLGJdKTt0aGlzLmxvbmxhdD1udWxsO3RoaXMuZ2VvbWV0cnk9YT9hOm51bGw7dGhpcy5zdGF0ZT1udWxsO3RoaXMuYXR0cmlidXRlcz17fTtiJiYodGhpcy5hdHRyaWJ1dGVzPU9wZW5MYXllcnMuVXRpbC5leHRlbmQodGhpcy5hdHRyaWJ1dGVzLGIpKTt0aGlzLnN0eWxlPWM/YzpudWxsfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5sYXllciYmKHRoaXMubGF5ZXIucmVtb3ZlRmVhdHVyZXModGhpcyksdGhpcy5sYXllcj1cbm51bGwpO3RoaXMubW9kaWZpZWQ9dGhpcy5nZW9tZXRyeT1udWxsO09wZW5MYXllcnMuRmVhdHVyZS5wcm90b3R5cGUuZGVzdHJveS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGNsb25lOmZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBPcGVuTGF5ZXJzLkZlYXR1cmUuVmVjdG9yKHRoaXMuZ2VvbWV0cnk/dGhpcy5nZW9tZXRyeS5jbG9uZSgpOm51bGwsdGhpcy5hdHRyaWJ1dGVzLHRoaXMuc3R5bGUpfSxvblNjcmVlbjpmdW5jdGlvbihhKXt2YXIgYj0hMTt0aGlzLmxheWVyJiZ0aGlzLmxheWVyLm1hcCYmKGI9dGhpcy5sYXllci5tYXAuZ2V0RXh0ZW50KCksYT8oYT10aGlzLmdlb21ldHJ5LmdldEJvdW5kcygpLGI9Yi5pbnRlcnNlY3RzQm91bmRzKGEpKTpiPWIudG9HZW9tZXRyeSgpLmludGVyc2VjdHModGhpcy5nZW9tZXRyeSkpO3JldHVybiBifSxnZXRWaXNpYmlsaXR5OmZ1bmN0aW9uKCl7cmV0dXJuISh0aGlzLnN0eWxlJiZcIm5vbmVcIj09dGhpcy5zdHlsZS5kaXNwbGF5fHwhdGhpcy5sYXllcnx8XG50aGlzLmxheWVyJiZ0aGlzLmxheWVyLnN0eWxlTWFwJiZcIm5vbmVcIj09dGhpcy5sYXllci5zdHlsZU1hcC5jcmVhdGVTeW1ib2xpemVyKHRoaXMsdGhpcy5yZW5kZXJJbnRlbnQpLmRpc3BsYXl8fHRoaXMubGF5ZXImJiF0aGlzLmxheWVyLmdldFZpc2liaWxpdHkoKSl9LGNyZWF0ZU1hcmtlcjpmdW5jdGlvbigpe3JldHVybiBudWxsfSxkZXN0cm95TWFya2VyOmZ1bmN0aW9uKCl7fSxjcmVhdGVQb3B1cDpmdW5jdGlvbigpe3JldHVybiBudWxsfSxhdFBvaW50OmZ1bmN0aW9uKGEsYixjKXt2YXIgZD0hMTt0aGlzLmdlb21ldHJ5JiYoZD10aGlzLmdlb21ldHJ5LmF0UG9pbnQoYSxiLGMpKTtyZXR1cm4gZH0sZGVzdHJveVBvcHVwOmZ1bmN0aW9uKCl7fSxtb3ZlOmZ1bmN0aW9uKGEpe2lmKHRoaXMubGF5ZXImJnRoaXMuZ2VvbWV0cnkubW92ZSl7dmFyIGE9XCJPcGVuTGF5ZXJzLkxvbkxhdFwiPT1hLkNMQVNTX05BTUU/dGhpcy5sYXllci5nZXRWaWV3UG9ydFB4RnJvbUxvbkxhdChhKTphLFxuYj10aGlzLmxheWVyLmdldFZpZXdQb3J0UHhGcm9tTG9uTGF0KHRoaXMuZ2VvbWV0cnkuZ2V0Qm91bmRzKCkuZ2V0Q2VudGVyTG9uTGF0KCkpLGM9dGhpcy5sYXllci5tYXAuZ2V0UmVzb2x1dGlvbigpO3RoaXMuZ2VvbWV0cnkubW92ZShjKihhLngtYi54KSxjKihiLnktYS55KSk7dGhpcy5sYXllci5kcmF3RmVhdHVyZSh0aGlzKTtyZXR1cm4gYn19LHRvU3RhdGU6ZnVuY3Rpb24oYSl7aWYoYT09T3BlbkxheWVycy5TdGF0ZS5VUERBVEUpc3dpdGNoKHRoaXMuc3RhdGUpe2Nhc2UgT3BlbkxheWVycy5TdGF0ZS5VTktOT1dOOmNhc2UgT3BlbkxheWVycy5TdGF0ZS5ERUxFVEU6dGhpcy5zdGF0ZT1hfWVsc2UgaWYoYT09T3BlbkxheWVycy5TdGF0ZS5JTlNFUlQpc3dpdGNoKHRoaXMuc3RhdGUpe2Nhc2UgT3BlbkxheWVycy5TdGF0ZS5VTktOT1dOOmJyZWFrO2RlZmF1bHQ6dGhpcy5zdGF0ZT1hfWVsc2UgaWYoYT09T3BlbkxheWVycy5TdGF0ZS5ERUxFVEUpc3dpdGNoKHRoaXMuc3RhdGUpe2Nhc2UgT3BlbkxheWVycy5TdGF0ZS5VTktOT1dOOmNhc2UgT3BlbkxheWVycy5TdGF0ZS5VUERBVEU6dGhpcy5zdGF0ZT1cbmF9ZWxzZSBhPT1PcGVuTGF5ZXJzLlN0YXRlLlVOS05PV04mJih0aGlzLnN0YXRlPWEpfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5GZWF0dXJlLlZlY3RvclwifSk7XG5PcGVuTGF5ZXJzLkZlYXR1cmUuVmVjdG9yLnN0eWxlPXtcImRlZmF1bHRcIjp7ZmlsbENvbG9yOlwiI2VlOTkwMFwiLGZpbGxPcGFjaXR5OjAuNCxob3ZlckZpbGxDb2xvcjpcIndoaXRlXCIsaG92ZXJGaWxsT3BhY2l0eTowLjgsc3Ryb2tlQ29sb3I6XCIjZWU5OTAwXCIsc3Ryb2tlT3BhY2l0eToxLHN0cm9rZVdpZHRoOjEsc3Ryb2tlTGluZWNhcDpcInJvdW5kXCIsc3Ryb2tlRGFzaHN0eWxlOlwic29saWRcIixob3ZlclN0cm9rZUNvbG9yOlwicmVkXCIsaG92ZXJTdHJva2VPcGFjaXR5OjEsaG92ZXJTdHJva2VXaWR0aDowLjIscG9pbnRSYWRpdXM6Nixob3ZlclBvaW50UmFkaXVzOjEsaG92ZXJQb2ludFVuaXQ6XCIlXCIscG9pbnRlckV2ZW50czpcInZpc2libGVQYWludGVkXCIsY3Vyc29yOlwiaW5oZXJpdFwiLGZvbnRDb2xvcjpcIiMwMDAwMDBcIixsYWJlbEFsaWduOlwiY21cIixsYWJlbE91dGxpbmVDb2xvcjpcIndoaXRlXCIsbGFiZWxPdXRsaW5lV2lkdGg6M30sc2VsZWN0OntmaWxsQ29sb3I6XCJibHVlXCIsZmlsbE9wYWNpdHk6MC40LFxuaG92ZXJGaWxsQ29sb3I6XCJ3aGl0ZVwiLGhvdmVyRmlsbE9wYWNpdHk6MC44LHN0cm9rZUNvbG9yOlwiYmx1ZVwiLHN0cm9rZU9wYWNpdHk6MSxzdHJva2VXaWR0aDoyLHN0cm9rZUxpbmVjYXA6XCJyb3VuZFwiLHN0cm9rZURhc2hzdHlsZTpcInNvbGlkXCIsaG92ZXJTdHJva2VDb2xvcjpcInJlZFwiLGhvdmVyU3Ryb2tlT3BhY2l0eToxLGhvdmVyU3Ryb2tlV2lkdGg6MC4yLHBvaW50UmFkaXVzOjYsaG92ZXJQb2ludFJhZGl1czoxLGhvdmVyUG9pbnRVbml0OlwiJVwiLHBvaW50ZXJFdmVudHM6XCJ2aXNpYmxlUGFpbnRlZFwiLGN1cnNvcjpcInBvaW50ZXJcIixmb250Q29sb3I6XCIjMDAwMDAwXCIsbGFiZWxBbGlnbjpcImNtXCIsbGFiZWxPdXRsaW5lQ29sb3I6XCJ3aGl0ZVwiLGxhYmVsT3V0bGluZVdpZHRoOjN9LHRlbXBvcmFyeTp7ZmlsbENvbG9yOlwiIzY2Y2NjY1wiLGZpbGxPcGFjaXR5OjAuMixob3ZlckZpbGxDb2xvcjpcIndoaXRlXCIsaG92ZXJGaWxsT3BhY2l0eTowLjgsc3Ryb2tlQ29sb3I6XCIjNjZjY2NjXCIsc3Ryb2tlT3BhY2l0eToxLFxuc3Ryb2tlTGluZWNhcDpcInJvdW5kXCIsc3Ryb2tlV2lkdGg6MixzdHJva2VEYXNoc3R5bGU6XCJzb2xpZFwiLGhvdmVyU3Ryb2tlQ29sb3I6XCJyZWRcIixob3ZlclN0cm9rZU9wYWNpdHk6MSxob3ZlclN0cm9rZVdpZHRoOjAuMixwb2ludFJhZGl1czo2LGhvdmVyUG9pbnRSYWRpdXM6MSxob3ZlclBvaW50VW5pdDpcIiVcIixwb2ludGVyRXZlbnRzOlwidmlzaWJsZVBhaW50ZWRcIixjdXJzb3I6XCJpbmhlcml0XCIsZm9udENvbG9yOlwiIzAwMDAwMFwiLGxhYmVsQWxpZ246XCJjbVwiLGxhYmVsT3V0bGluZUNvbG9yOlwid2hpdGVcIixsYWJlbE91dGxpbmVXaWR0aDozfSxcImRlbGV0ZVwiOntkaXNwbGF5Olwibm9uZVwifX07T3BlbkxheWVycy5TdHlsZT1PcGVuTGF5ZXJzLkNsYXNzKHtpZDpudWxsLG5hbWU6bnVsbCx0aXRsZTpudWxsLGRlc2NyaXB0aW9uOm51bGwsbGF5ZXJOYW1lOm51bGwsaXNEZWZhdWx0OiExLHJ1bGVzOm51bGwsY29udGV4dDpudWxsLGRlZmF1bHRTdHlsZTpudWxsLGRlZmF1bHRzUGVyU3ltYm9saXplcjohMSxwcm9wZXJ0eVN0eWxlczpudWxsLGluaXRpYWxpemU6ZnVuY3Rpb24oYSxiKXtPcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHRoaXMsYik7dGhpcy5ydWxlcz1bXTtiJiZiLnJ1bGVzJiZ0aGlzLmFkZFJ1bGVzKGIucnVsZXMpO3RoaXMuc2V0RGVmYXVsdFN0eWxlKGF8fE9wZW5MYXllcnMuRmVhdHVyZS5WZWN0b3Iuc3R5bGVbXCJkZWZhdWx0XCJdKTt0aGlzLmlkPU9wZW5MYXllcnMuVXRpbC5jcmVhdGVVbmlxdWVJRCh0aGlzLkNMQVNTX05BTUUrXCJfXCIpfSxkZXN0cm95OmZ1bmN0aW9uKCl7Zm9yKHZhciBhPTAsYj10aGlzLnJ1bGVzLmxlbmd0aDthPGI7YSsrKXRoaXMucnVsZXNbYV0uZGVzdHJveSgpLFxudGhpcy5ydWxlc1thXT1udWxsO3RoaXMuZGVmYXVsdFN0eWxlPXRoaXMucnVsZXM9bnVsbH0sY3JlYXRlU3ltYm9saXplcjpmdW5jdGlvbihhKXtmb3IodmFyIGI9dGhpcy5kZWZhdWx0c1BlclN5bWJvbGl6ZXI/e306dGhpcy5jcmVhdGVMaXRlcmFscyhPcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHt9LHRoaXMuZGVmYXVsdFN0eWxlKSxhKSxjPXRoaXMucnVsZXMsZCxlPVtdLGY9ITEsZz0wLGg9Yy5sZW5ndGg7ZzxoO2crKylkPWNbZ10sZC5ldmFsdWF0ZShhKSYmKGQgaW5zdGFuY2VvZiBPcGVuTGF5ZXJzLlJ1bGUmJmQuZWxzZUZpbHRlcj9lLnB1c2goZCk6KGY9ITAsdGhpcy5hcHBseVN5bWJvbGl6ZXIoZCxiLGEpKSk7aWYoITE9PWYmJjA8ZS5sZW5ndGgpe2Y9ITA7Zz0wO2ZvcihoPWUubGVuZ3RoO2c8aDtnKyspdGhpcy5hcHBseVN5bWJvbGl6ZXIoZVtnXSxiLGEpfTA8Yy5sZW5ndGgmJiExPT1mJiYoYi5kaXNwbGF5PVwibm9uZVwiKTtudWxsIT1iLmxhYmVsJiZcInN0cmluZ1wiIT09dHlwZW9mIGIubGFiZWwmJlxuKGIubGFiZWw9XCJcIitiLmxhYmVsKTtyZXR1cm4gYn0sYXBwbHlTeW1ib2xpemVyOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD1jLmdlb21ldHJ5P3RoaXMuZ2V0U3ltYm9saXplclByZWZpeChjLmdlb21ldHJ5KTpPcGVuTGF5ZXJzLlN0eWxlLlNZTUJPTElaRVJfUFJFRklYRVNbMF0sYT1hLnN5bWJvbGl6ZXJbZF18fGEuc3ltYm9saXplcjshMD09PXRoaXMuZGVmYXVsdHNQZXJTeW1ib2xpemVyJiYoZD10aGlzLmRlZmF1bHRTdHlsZSxPcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyhhLHtwb2ludFJhZGl1czpkLnBvaW50UmFkaXVzfSksKCEwPT09YS5zdHJva2V8fCEwPT09YS5ncmFwaGljKSYmT3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoYSx7c3Ryb2tlV2lkdGg6ZC5zdHJva2VXaWR0aCxzdHJva2VDb2xvcjpkLnN0cm9rZUNvbG9yLHN0cm9rZU9wYWNpdHk6ZC5zdHJva2VPcGFjaXR5LHN0cm9rZURhc2hzdHlsZTpkLnN0cm9rZURhc2hzdHlsZSxzdHJva2VMaW5lY2FwOmQuc3Ryb2tlTGluZWNhcH0pLFxuKCEwPT09YS5maWxsfHwhMD09PWEuZ3JhcGhpYykmJk9wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKGEse2ZpbGxDb2xvcjpkLmZpbGxDb2xvcixmaWxsT3BhY2l0eTpkLmZpbGxPcGFjaXR5fSksITA9PT1hLmdyYXBoaWMmJk9wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKGEse3BvaW50UmFkaXVzOnRoaXMuZGVmYXVsdFN0eWxlLnBvaW50UmFkaXVzLGV4dGVybmFsR3JhcGhpYzp0aGlzLmRlZmF1bHRTdHlsZS5leHRlcm5hbEdyYXBoaWMsZ3JhcGhpY05hbWU6dGhpcy5kZWZhdWx0U3R5bGUuZ3JhcGhpY05hbWUsZ3JhcGhpY09wYWNpdHk6dGhpcy5kZWZhdWx0U3R5bGUuZ3JhcGhpY09wYWNpdHksZ3JhcGhpY1dpZHRoOnRoaXMuZGVmYXVsdFN0eWxlLmdyYXBoaWNXaWR0aCxncmFwaGljSGVpZ2h0OnRoaXMuZGVmYXVsdFN0eWxlLmdyYXBoaWNIZWlnaHQsZ3JhcGhpY1hPZmZzZXQ6dGhpcy5kZWZhdWx0U3R5bGUuZ3JhcGhpY1hPZmZzZXQsZ3JhcGhpY1lPZmZzZXQ6dGhpcy5kZWZhdWx0U3R5bGUuZ3JhcGhpY1lPZmZzZXR9KSk7XG5yZXR1cm4gdGhpcy5jcmVhdGVMaXRlcmFscyhPcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKGIsYSksYyl9LGNyZWF0ZUxpdGVyYWxzOmZ1bmN0aW9uKGEsYil7dmFyIGM9T3BlbkxheWVycy5VdGlsLmV4dGVuZCh7fSxiLmF0dHJpYnV0ZXN8fGIuZGF0YSk7T3BlbkxheWVycy5VdGlsLmV4dGVuZChjLHRoaXMuY29udGV4dCk7Zm9yKHZhciBkIGluIHRoaXMucHJvcGVydHlTdHlsZXMpYVtkXT1PcGVuTGF5ZXJzLlN0eWxlLmNyZWF0ZUxpdGVyYWwoYVtkXSxjLGIsZCk7cmV0dXJuIGF9LGZpbmRQcm9wZXJ0eVN0eWxlczpmdW5jdGlvbigpe3ZhciBhPXt9O3RoaXMuYWRkUHJvcGVydHlTdHlsZXMoYSx0aGlzLmRlZmF1bHRTdHlsZSk7Zm9yKHZhciBiPXRoaXMucnVsZXMsYyxkLGU9MCxmPWIubGVuZ3RoO2U8ZjtlKyspe2M9YltlXS5zeW1ib2xpemVyO2Zvcih2YXIgZyBpbiBjKWlmKGQ9Y1tnXSxcIm9iamVjdFwiPT10eXBlb2YgZCl0aGlzLmFkZFByb3BlcnR5U3R5bGVzKGEsZCk7ZWxzZXt0aGlzLmFkZFByb3BlcnR5U3R5bGVzKGEsXG5jKTticmVha319cmV0dXJuIGF9LGFkZFByb3BlcnR5U3R5bGVzOmZ1bmN0aW9uKGEsYil7dmFyIGMsZDtmb3IoZCBpbiBiKWM9YltkXSxcInN0cmluZ1wiPT10eXBlb2YgYyYmYy5tYXRjaCgvXFwkXFx7XFx3K1xcfS8pJiYoYVtkXT0hMCk7cmV0dXJuIGF9LGFkZFJ1bGVzOmZ1bmN0aW9uKGEpe0FycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KHRoaXMucnVsZXMsYSk7dGhpcy5wcm9wZXJ0eVN0eWxlcz10aGlzLmZpbmRQcm9wZXJ0eVN0eWxlcygpfSxzZXREZWZhdWx0U3R5bGU6ZnVuY3Rpb24oYSl7dGhpcy5kZWZhdWx0U3R5bGU9YTt0aGlzLnByb3BlcnR5U3R5bGVzPXRoaXMuZmluZFByb3BlcnR5U3R5bGVzKCl9LGdldFN5bWJvbGl6ZXJQcmVmaXg6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPU9wZW5MYXllcnMuU3R5bGUuU1lNQk9MSVpFUl9QUkVGSVhFUyxjPTAsZD1iLmxlbmd0aDtjPGQ7YysrKWlmKC0xIT1hLkNMQVNTX05BTUUuaW5kZXhPZihiW2NdKSlyZXR1cm4gYltjXX0sY2xvbmU6ZnVuY3Rpb24oKXt2YXIgYT1cbk9wZW5MYXllcnMuVXRpbC5leHRlbmQoe30sdGhpcyk7aWYodGhpcy5ydWxlcyl7YS5ydWxlcz1bXTtmb3IodmFyIGI9MCxjPXRoaXMucnVsZXMubGVuZ3RoO2I8YzsrK2IpYS5ydWxlcy5wdXNoKHRoaXMucnVsZXNbYl0uY2xvbmUoKSl9YS5jb250ZXh0PXRoaXMuY29udGV4dCYmT3BlbkxheWVycy5VdGlsLmV4dGVuZCh7fSx0aGlzLmNvbnRleHQpO2I9T3BlbkxheWVycy5VdGlsLmV4dGVuZCh7fSx0aGlzLmRlZmF1bHRTdHlsZSk7cmV0dXJuIG5ldyBPcGVuTGF5ZXJzLlN0eWxlKGIsYSl9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLlN0eWxlXCJ9KTtPcGVuTGF5ZXJzLlN0eWxlLmNyZWF0ZUxpdGVyYWw9ZnVuY3Rpb24oYSxiLGMsZCl7XCJzdHJpbmdcIj09dHlwZW9mIGEmJi0xIT1hLmluZGV4T2YoXCIke1wiKSYmKGE9T3BlbkxheWVycy5TdHJpbmcuZm9ybWF0KGEsYixbYyxkXSksYT1pc05hTihhKXx8IWE/YTpwYXJzZUZsb2F0KGEpKTtyZXR1cm4gYX07XG5PcGVuTGF5ZXJzLlN0eWxlLlNZTUJPTElaRVJfUFJFRklYRVM9W1wiUG9pbnRcIixcIkxpbmVcIixcIlBvbHlnb25cIixcIlRleHRcIixcIlJhc3RlclwiXTtPcGVuTGF5ZXJzLkZpbHRlcj1PcGVuTGF5ZXJzLkNsYXNzKHtpbml0aWFsaXplOmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuVXRpbC5leHRlbmQodGhpcyxhKX0sZGVzdHJveTpmdW5jdGlvbigpe30sZXZhbHVhdGU6ZnVuY3Rpb24oKXtyZXR1cm4hMH0sY2xvbmU6ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH0sdG9TdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm4gT3BlbkxheWVycy5Gb3JtYXQmJk9wZW5MYXllcnMuRm9ybWF0LkNRTD9PcGVuTGF5ZXJzLkZvcm1hdC5DUUwucHJvdG90eXBlLndyaXRlKHRoaXMpOk9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0aGlzKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuRmlsdGVyXCJ9KTtPcGVuTGF5ZXJzLkZpbHRlci5GZWF0dXJlSWQ9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkZpbHRlcix7ZmlkczpudWxsLHR5cGU6XCJGSURcIixpbml0aWFsaXplOmZ1bmN0aW9uKGEpe3RoaXMuZmlkcz1bXTtPcGVuTGF5ZXJzLkZpbHRlci5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLFthXSl9LGV2YWx1YXRlOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj0wLGM9dGhpcy5maWRzLmxlbmd0aDtiPGM7YisrKWlmKChhLmZpZHx8YS5pZCk9PXRoaXMuZmlkc1tiXSlyZXR1cm4hMDtyZXR1cm4hMX0sY2xvbmU6ZnVuY3Rpb24oKXt2YXIgYT1uZXcgT3BlbkxheWVycy5GaWx0ZXIuRmVhdHVyZUlkO09wZW5MYXllcnMuVXRpbC5leHRlbmQoYSx0aGlzKTthLmZpZHM9dGhpcy5maWRzLnNsaWNlKCk7cmV0dXJuIGF9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZpbHRlci5GZWF0dXJlSWRcIn0pO09wZW5MYXllcnMuRmlsdGVyLkxvZ2ljYWw9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkZpbHRlcix7ZmlsdGVyczpudWxsLHR5cGU6bnVsbCxpbml0aWFsaXplOmZ1bmN0aW9uKGEpe3RoaXMuZmlsdGVycz1bXTtPcGVuTGF5ZXJzLkZpbHRlci5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLFthXSl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLmZpbHRlcnM9bnVsbDtPcGVuTGF5ZXJzLkZpbHRlci5wcm90b3R5cGUuZGVzdHJveS5hcHBseSh0aGlzKX0sZXZhbHVhdGU6ZnVuY3Rpb24oYSl7dmFyIGIsYztzd2l0Y2godGhpcy50eXBlKXtjYXNlIE9wZW5MYXllcnMuRmlsdGVyLkxvZ2ljYWwuQU5EOmI9MDtmb3IoYz10aGlzLmZpbHRlcnMubGVuZ3RoO2I8YztiKyspaWYoITE9PXRoaXMuZmlsdGVyc1tiXS5ldmFsdWF0ZShhKSlyZXR1cm4hMTtyZXR1cm4hMDtjYXNlIE9wZW5MYXllcnMuRmlsdGVyLkxvZ2ljYWwuT1I6Yj0wO2ZvcihjPXRoaXMuZmlsdGVycy5sZW5ndGg7YjxcbmM7YisrKWlmKCEwPT10aGlzLmZpbHRlcnNbYl0uZXZhbHVhdGUoYSkpcmV0dXJuITA7cmV0dXJuITE7Y2FzZSBPcGVuTGF5ZXJzLkZpbHRlci5Mb2dpY2FsLk5PVDpyZXR1cm4hdGhpcy5maWx0ZXJzWzBdLmV2YWx1YXRlKGEpfX0sY2xvbmU6ZnVuY3Rpb24oKXtmb3IodmFyIGE9W10sYj0wLGM9dGhpcy5maWx0ZXJzLmxlbmd0aDtiPGM7KytiKWEucHVzaCh0aGlzLmZpbHRlcnNbYl0uY2xvbmUoKSk7cmV0dXJuIG5ldyBPcGVuTGF5ZXJzLkZpbHRlci5Mb2dpY2FsKHt0eXBlOnRoaXMudHlwZSxmaWx0ZXJzOmF9KX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuRmlsdGVyLkxvZ2ljYWxcIn0pO09wZW5MYXllcnMuRmlsdGVyLkxvZ2ljYWwuQU5EPVwiJiZcIjtPcGVuTGF5ZXJzLkZpbHRlci5Mb2dpY2FsLk9SPVwifHxcIjtPcGVuTGF5ZXJzLkZpbHRlci5Mb2dpY2FsLk5PVD1cIiFcIjtPcGVuTGF5ZXJzLkZpbHRlci5Db21wYXJpc29uPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5GaWx0ZXIse3R5cGU6bnVsbCxwcm9wZXJ0eTpudWxsLHZhbHVlOm51bGwsbWF0Y2hDYXNlOiEwLGxvd2VyQm91bmRhcnk6bnVsbCx1cHBlckJvdW5kYXJ5Om51bGwsaW5pdGlhbGl6ZTpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLkZpbHRlci5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLFthXSk7dGhpcy50eXBlPT09T3BlbkxheWVycy5GaWx0ZXIuQ29tcGFyaXNvbi5MSUtFJiZ2b2lkIDA9PT1hLm1hdGNoQ2FzZSYmKHRoaXMubWF0Y2hDYXNlPW51bGwpfSxldmFsdWF0ZTpmdW5jdGlvbihhKXthIGluc3RhbmNlb2YgT3BlbkxheWVycy5GZWF0dXJlLlZlY3RvciYmKGE9YS5hdHRyaWJ1dGVzKTt2YXIgYj0hMSxhPWFbdGhpcy5wcm9wZXJ0eV07c3dpdGNoKHRoaXMudHlwZSl7Y2FzZSBPcGVuTGF5ZXJzLkZpbHRlci5Db21wYXJpc29uLkVRVUFMX1RPOmI9dGhpcy52YWx1ZTtcbmI9IXRoaXMubWF0Y2hDYXNlJiZcInN0cmluZ1wiPT10eXBlb2YgYSYmXCJzdHJpbmdcIj09dHlwZW9mIGI/YS50b1VwcGVyQ2FzZSgpPT1iLnRvVXBwZXJDYXNlKCk6YT09YjticmVhaztjYXNlIE9wZW5MYXllcnMuRmlsdGVyLkNvbXBhcmlzb24uTk9UX0VRVUFMX1RPOmI9dGhpcy52YWx1ZTtiPSF0aGlzLm1hdGNoQ2FzZSYmXCJzdHJpbmdcIj09dHlwZW9mIGEmJlwic3RyaW5nXCI9PXR5cGVvZiBiP2EudG9VcHBlckNhc2UoKSE9Yi50b1VwcGVyQ2FzZSgpOmEhPWI7YnJlYWs7Y2FzZSBPcGVuTGF5ZXJzLkZpbHRlci5Db21wYXJpc29uLkxFU1NfVEhBTjpiPWE8dGhpcy52YWx1ZTticmVhaztjYXNlIE9wZW5MYXllcnMuRmlsdGVyLkNvbXBhcmlzb24uR1JFQVRFUl9USEFOOmI9YT50aGlzLnZhbHVlO2JyZWFrO2Nhc2UgT3BlbkxheWVycy5GaWx0ZXIuQ29tcGFyaXNvbi5MRVNTX1RIQU5fT1JfRVFVQUxfVE86Yj1hPD10aGlzLnZhbHVlO2JyZWFrO2Nhc2UgT3BlbkxheWVycy5GaWx0ZXIuQ29tcGFyaXNvbi5HUkVBVEVSX1RIQU5fT1JfRVFVQUxfVE86Yj1cbmE+PXRoaXMudmFsdWU7YnJlYWs7Y2FzZSBPcGVuTGF5ZXJzLkZpbHRlci5Db21wYXJpc29uLkJFVFdFRU46Yj1hPj10aGlzLmxvd2VyQm91bmRhcnkmJmE8PXRoaXMudXBwZXJCb3VuZGFyeTticmVhaztjYXNlIE9wZW5MYXllcnMuRmlsdGVyLkNvbXBhcmlzb24uTElLRTpiPVJlZ0V4cCh0aGlzLnZhbHVlLFwiZ2lcIikudGVzdChhKX1yZXR1cm4gYn0sdmFsdWUycmVnZXg6ZnVuY3Rpb24oYSxiLGMpe2lmKFwiLlwiPT1hKXRocm93IEVycm9yKFwiJy4nIGlzIGFuIHVuc3VwcG9ydGVkIHdpbGRDYXJkIGNoYXJhY3RlciBmb3IgT3BlbkxheWVycy5GaWx0ZXIuQ29tcGFyaXNvblwiKTthPWE/YTpcIipcIjtiPWI/YjpcIi5cIjt0aGlzLnZhbHVlPXRoaXMudmFsdWUucmVwbGFjZShSZWdFeHAoXCJcXFxcXCIrKGM/YzpcIiFcIikrXCIoLnwkKVwiLFwiZ1wiKSxcIlxcXFwkMVwiKTt0aGlzLnZhbHVlPXRoaXMudmFsdWUucmVwbGFjZShSZWdFeHAoXCJcXFxcXCIrYixcImdcIiksXCIuXCIpO3RoaXMudmFsdWU9dGhpcy52YWx1ZS5yZXBsYWNlKFJlZ0V4cChcIlxcXFxcIitcbmEsXCJnXCIpLFwiLipcIik7dGhpcy52YWx1ZT10aGlzLnZhbHVlLnJlcGxhY2UoUmVnRXhwKFwiXFxcXFxcXFwuXFxcXCpcIixcImdcIiksXCJcXFxcXCIrYSk7cmV0dXJuIHRoaXMudmFsdWU9dGhpcy52YWx1ZS5yZXBsYWNlKFJlZ0V4cChcIlxcXFxcXFxcXFxcXC5cIixcImdcIiksXCJcXFxcXCIrYil9LHJlZ2V4MnZhbHVlOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy52YWx1ZSxhPWEucmVwbGFjZSgvIS9nLFwiISFcIiksYT1hLnJlcGxhY2UoLyhcXFxcKT9cXFxcXFwuL2csZnVuY3Rpb24oYSxjKXtyZXR1cm4gYz9hOlwiIS5cIn0pLGE9YS5yZXBsYWNlKC8oXFxcXCk/XFxcXFxcKi9nLGZ1bmN0aW9uKGEsYyl7cmV0dXJuIGM/YTpcIiEqXCJ9KSxhPWEucmVwbGFjZSgvXFxcXFxcXFwvZyxcIlxcXFxcIik7cmV0dXJuIGE9YS5yZXBsYWNlKC9cXC5cXCovZyxcIipcIil9LGNsb25lOmZ1bmN0aW9uKCl7cmV0dXJuIE9wZW5MYXllcnMuVXRpbC5leHRlbmQobmV3IE9wZW5MYXllcnMuRmlsdGVyLkNvbXBhcmlzb24sdGhpcyl9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZpbHRlci5Db21wYXJpc29uXCJ9KTtcbk9wZW5MYXllcnMuRmlsdGVyLkNvbXBhcmlzb24uRVFVQUxfVE89XCI9PVwiO09wZW5MYXllcnMuRmlsdGVyLkNvbXBhcmlzb24uTk9UX0VRVUFMX1RPPVwiIT1cIjtPcGVuTGF5ZXJzLkZpbHRlci5Db21wYXJpc29uLkxFU1NfVEhBTj1cIjxcIjtPcGVuTGF5ZXJzLkZpbHRlci5Db21wYXJpc29uLkdSRUFURVJfVEhBTj1cIj5cIjtPcGVuTGF5ZXJzLkZpbHRlci5Db21wYXJpc29uLkxFU1NfVEhBTl9PUl9FUVVBTF9UTz1cIjw9XCI7T3BlbkxheWVycy5GaWx0ZXIuQ29tcGFyaXNvbi5HUkVBVEVSX1RIQU5fT1JfRVFVQUxfVE89XCI+PVwiO09wZW5MYXllcnMuRmlsdGVyLkNvbXBhcmlzb24uQkVUV0VFTj1cIi4uXCI7T3BlbkxheWVycy5GaWx0ZXIuQ29tcGFyaXNvbi5MSUtFPVwiflwiO09wZW5MYXllcnMuRm9ybWF0LkZpbHRlcj1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuRm9ybWF0LlhNTC5WZXJzaW9uZWRPR0Mse2RlZmF1bHRWZXJzaW9uOlwiMS4wLjBcIixDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Gb3JtYXQuRmlsdGVyXCJ9KTtPcGVuTGF5ZXJzLkZpbHRlci5GdW5jdGlvbj1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuRmlsdGVyLHtuYW1lOm51bGwscGFyYW1zOm51bGwsQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuRmlsdGVyLkZ1bmN0aW9uXCJ9KTtPcGVuTGF5ZXJzLkZvcm1hdC5GaWx0ZXIudjE9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkZvcm1hdC5YTUwse25hbWVzcGFjZXM6e29nYzpcImh0dHA6Ly93d3cub3Blbmdpcy5uZXQvb2djXCIsZ21sOlwiaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC9nbWxcIix4bGluazpcImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmtcIix4c2k6XCJodHRwOi8vd3d3LnczLm9yZy8yMDAxL1hNTFNjaGVtYS1pbnN0YW5jZVwifSxkZWZhdWx0UHJlZml4Olwib2djXCIsc2NoZW1hTG9jYXRpb246bnVsbCxpbml0aWFsaXplOmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuRm9ybWF0LlhNTC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLFthXSl9LHJlYWQ6ZnVuY3Rpb24oYSl7dmFyIGI9e307dGhpcy5yZWFkZXJzLm9nYy5GaWx0ZXIuYXBwbHkodGhpcyxbYSxiXSk7cmV0dXJuIGIuZmlsdGVyfSxyZWFkZXJzOntvZ2M6e19leHByZXNzaW9uOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1cIlwiLGM9YS5maXJzdENoaWxkO2M7Yz1cbmMubmV4dFNpYmxpbmcpc3dpdGNoKGMubm9kZVR5cGUpe2Nhc2UgMTphPXRoaXMucmVhZE5vZGUoYyk7YS5wcm9wZXJ0eT9iKz1cIiR7XCIrYS5wcm9wZXJ0eStcIn1cIjp2b2lkIDAhPT1hLnZhbHVlJiYoYis9YS52YWx1ZSk7YnJlYWs7Y2FzZSAzOmNhc2UgNDpiKz1jLm5vZGVWYWx1ZX1yZXR1cm4gYn0sRmlsdGVyOmZ1bmN0aW9uKGEsYil7dmFyIGM9e2ZpZHM6W10sZmlsdGVyczpbXX07dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpOzA8Yy5maWRzLmxlbmd0aD9iLmZpbHRlcj1uZXcgT3BlbkxheWVycy5GaWx0ZXIuRmVhdHVyZUlkKHtmaWRzOmMuZmlkc30pOjA8Yy5maWx0ZXJzLmxlbmd0aCYmKGIuZmlsdGVyPWMuZmlsdGVyc1swXSl9LEZlYXR1cmVJZDpmdW5jdGlvbihhLGIpe3ZhciBjPWEuZ2V0QXR0cmlidXRlKFwiZmlkXCIpO2MmJmIuZmlkcy5wdXNoKGMpfSxBbmQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz1uZXcgT3BlbkxheWVycy5GaWx0ZXIuTG9naWNhbCh7dHlwZTpPcGVuTGF5ZXJzLkZpbHRlci5Mb2dpY2FsLkFORH0pO1xudGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpO2IuZmlsdGVycy5wdXNoKGMpfSxPcjpmdW5jdGlvbihhLGIpe3ZhciBjPW5ldyBPcGVuTGF5ZXJzLkZpbHRlci5Mb2dpY2FsKHt0eXBlOk9wZW5MYXllcnMuRmlsdGVyLkxvZ2ljYWwuT1J9KTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYyk7Yi5maWx0ZXJzLnB1c2goYyl9LE5vdDpmdW5jdGlvbihhLGIpe3ZhciBjPW5ldyBPcGVuTGF5ZXJzLkZpbHRlci5Mb2dpY2FsKHt0eXBlOk9wZW5MYXllcnMuRmlsdGVyLkxvZ2ljYWwuTk9UfSk7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpO2IuZmlsdGVycy5wdXNoKGMpfSxQcm9wZXJ0eUlzTGVzc1RoYW46ZnVuY3Rpb24oYSxiKXt2YXIgYz1uZXcgT3BlbkxheWVycy5GaWx0ZXIuQ29tcGFyaXNvbih7dHlwZTpPcGVuTGF5ZXJzLkZpbHRlci5Db21wYXJpc29uLkxFU1NfVEhBTn0pO3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKTtiLmZpbHRlcnMucHVzaChjKX0sUHJvcGVydHlJc0dyZWF0ZXJUaGFuOmZ1bmN0aW9uKGEsXG5iKXt2YXIgYz1uZXcgT3BlbkxheWVycy5GaWx0ZXIuQ29tcGFyaXNvbih7dHlwZTpPcGVuTGF5ZXJzLkZpbHRlci5Db21wYXJpc29uLkdSRUFURVJfVEhBTn0pO3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKTtiLmZpbHRlcnMucHVzaChjKX0sUHJvcGVydHlJc0xlc3NUaGFuT3JFcXVhbFRvOmZ1bmN0aW9uKGEsYil7dmFyIGM9bmV3IE9wZW5MYXllcnMuRmlsdGVyLkNvbXBhcmlzb24oe3R5cGU6T3BlbkxheWVycy5GaWx0ZXIuQ29tcGFyaXNvbi5MRVNTX1RIQU5fT1JfRVFVQUxfVE99KTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYyk7Yi5maWx0ZXJzLnB1c2goYyl9LFByb3BlcnR5SXNHcmVhdGVyVGhhbk9yRXF1YWxUbzpmdW5jdGlvbihhLGIpe3ZhciBjPW5ldyBPcGVuTGF5ZXJzLkZpbHRlci5Db21wYXJpc29uKHt0eXBlOk9wZW5MYXllcnMuRmlsdGVyLkNvbXBhcmlzb24uR1JFQVRFUl9USEFOX09SX0VRVUFMX1RPfSk7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpO2IuZmlsdGVycy5wdXNoKGMpfSxcblByb3BlcnR5SXNCZXR3ZWVuOmZ1bmN0aW9uKGEsYil7dmFyIGM9bmV3IE9wZW5MYXllcnMuRmlsdGVyLkNvbXBhcmlzb24oe3R5cGU6T3BlbkxheWVycy5GaWx0ZXIuQ29tcGFyaXNvbi5CRVRXRUVOfSk7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpO2IuZmlsdGVycy5wdXNoKGMpfSxMaXRlcmFsOmZ1bmN0aW9uKGEsYil7Yi52YWx1ZT1PcGVuTGF5ZXJzLlN0cmluZy5udW1lcmljSWYodGhpcy5nZXRDaGlsZFZhbHVlKGEpKX0sUHJvcGVydHlOYW1lOmZ1bmN0aW9uKGEsYil7Yi5wcm9wZXJ0eT10aGlzLmdldENoaWxkVmFsdWUoYSl9LExvd2VyQm91bmRhcnk6ZnVuY3Rpb24oYSxiKXtiLmxvd2VyQm91bmRhcnk9T3BlbkxheWVycy5TdHJpbmcubnVtZXJpY0lmKHRoaXMucmVhZGVycy5vZ2MuX2V4cHJlc3Npb24uY2FsbCh0aGlzLGEpKX0sVXBwZXJCb3VuZGFyeTpmdW5jdGlvbihhLGIpe2IudXBwZXJCb3VuZGFyeT1PcGVuTGF5ZXJzLlN0cmluZy5udW1lcmljSWYodGhpcy5yZWFkZXJzLm9nYy5fZXhwcmVzc2lvbi5jYWxsKHRoaXMsXG5hKSl9LEludGVyc2VjdHM6ZnVuY3Rpb24oYSxiKXt0aGlzLnJlYWRTcGF0aWFsKGEsYixPcGVuTGF5ZXJzLkZpbHRlci5TcGF0aWFsLklOVEVSU0VDVFMpfSxXaXRoaW46ZnVuY3Rpb24oYSxiKXt0aGlzLnJlYWRTcGF0aWFsKGEsYixPcGVuTGF5ZXJzLkZpbHRlci5TcGF0aWFsLldJVEhJTil9LENvbnRhaW5zOmZ1bmN0aW9uKGEsYil7dGhpcy5yZWFkU3BhdGlhbChhLGIsT3BlbkxheWVycy5GaWx0ZXIuU3BhdGlhbC5DT05UQUlOUyl9LERXaXRoaW46ZnVuY3Rpb24oYSxiKXt0aGlzLnJlYWRTcGF0aWFsKGEsYixPcGVuTGF5ZXJzLkZpbHRlci5TcGF0aWFsLkRXSVRISU4pfSxEaXN0YW5jZTpmdW5jdGlvbihhLGIpe2IuZGlzdGFuY2U9cGFyc2VJbnQodGhpcy5nZXRDaGlsZFZhbHVlKGEpKTtiLmRpc3RhbmNlVW5pdHM9YS5nZXRBdHRyaWJ1dGUoXCJ1bml0c1wiKX0sRnVuY3Rpb246ZnVuY3Rpb24oKXt9fX0scmVhZFNwYXRpYWw6ZnVuY3Rpb24oYSxiLGMpe2M9bmV3IE9wZW5MYXllcnMuRmlsdGVyLlNwYXRpYWwoe3R5cGU6Y30pO1xudGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpO2MudmFsdWU9Yy5jb21wb25lbnRzWzBdO2RlbGV0ZSBjLmNvbXBvbmVudHM7Yi5maWx0ZXJzLnB1c2goYyl9LHdyaXRlT2djRXhwcmVzc2lvbjpmdW5jdGlvbihhLGIpe2lmKGEgaW5zdGFuY2VvZiBPcGVuTGF5ZXJzLkZpbHRlci5GdW5jdGlvbil7dmFyIGM9dGhpcy53cml0ZU5vZGUoXCJGdW5jdGlvblwiLGEsYik7Yi5hcHBlbmRDaGlsZChjKX1lbHNlIHRoaXMud3JpdGVOb2RlKFwiTGl0ZXJhbFwiLGEsYik7cmV0dXJuIGJ9LHdyaXRlOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLndyaXRlcnMub2djLkZpbHRlci5hcHBseSh0aGlzLFthXSl9LHdyaXRlRmVhdHVyZUlkTm9kZXM6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9MCxkPWEuZmlkcy5sZW5ndGg7YzxkOysrYyl0aGlzLndyaXRlTm9kZShcIkZlYXR1cmVJZFwiLGEuZmlkc1tjXSxiKX0sd3JpdGVyczp7b2djOntGaWx0ZXI6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwib2djOkZpbHRlclwiKTtcblwiRklEXCI9PT1hLnR5cGU/T3BlbkxheWVycy5Gb3JtYXQuRmlsdGVyLnYxLnByb3RvdHlwZS53cml0ZUZlYXR1cmVJZE5vZGVzLmNhbGwodGhpcyxhLGIpOnRoaXMud3JpdGVOb2RlKHRoaXMuZ2V0RmlsdGVyVHlwZShhKSxhLGIpO3JldHVybiBifSxGZWF0dXJlSWQ6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIm9nYzpGZWF0dXJlSWRcIix7YXR0cmlidXRlczp7ZmlkOmF9fSl9LEFuZDpmdW5jdGlvbihhKXtmb3IodmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwib2djOkFuZFwiKSxjLGQ9MCxlPWEuZmlsdGVycy5sZW5ndGg7ZDxlOysrZCljPWEuZmlsdGVyc1tkXSxcIkZJRFwiPT09Yy50eXBlP09wZW5MYXllcnMuRm9ybWF0LkZpbHRlci52MS5wcm90b3R5cGUud3JpdGVGZWF0dXJlSWROb2Rlcy5jYWxsKHRoaXMsYyxiKTp0aGlzLndyaXRlTm9kZSh0aGlzLmdldEZpbHRlclR5cGUoYyksYyxiKTtyZXR1cm4gYn0sT3I6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPVxudGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwib2djOk9yXCIpLGMsZD0wLGU9YS5maWx0ZXJzLmxlbmd0aDtkPGU7KytkKWM9YS5maWx0ZXJzW2RdLFwiRklEXCI9PT1jLnR5cGU/T3BlbkxheWVycy5Gb3JtYXQuRmlsdGVyLnYxLnByb3RvdHlwZS53cml0ZUZlYXR1cmVJZE5vZGVzLmNhbGwodGhpcyxjLGIpOnRoaXMud3JpdGVOb2RlKHRoaXMuZ2V0RmlsdGVyVHlwZShjKSxjLGIpO3JldHVybiBifSxOb3Q6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwib2djOk5vdFwiKSxhPWEuZmlsdGVyc1swXTtcIkZJRFwiPT09YS50eXBlP09wZW5MYXllcnMuRm9ybWF0LkZpbHRlci52MS5wcm90b3R5cGUud3JpdGVGZWF0dXJlSWROb2Rlcy5jYWxsKHRoaXMsYSxiKTp0aGlzLndyaXRlTm9kZSh0aGlzLmdldEZpbHRlclR5cGUoYSksYSxiKTtyZXR1cm4gYn0sUHJvcGVydHlJc0xlc3NUaGFuOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIm9nYzpQcm9wZXJ0eUlzTGVzc1RoYW5cIik7XG50aGlzLndyaXRlTm9kZShcIlByb3BlcnR5TmFtZVwiLGEsYik7dGhpcy53cml0ZU9nY0V4cHJlc3Npb24oYS52YWx1ZSxiKTtyZXR1cm4gYn0sUHJvcGVydHlJc0dyZWF0ZXJUaGFuOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIm9nYzpQcm9wZXJ0eUlzR3JlYXRlclRoYW5cIik7dGhpcy53cml0ZU5vZGUoXCJQcm9wZXJ0eU5hbWVcIixhLGIpO3RoaXMud3JpdGVPZ2NFeHByZXNzaW9uKGEudmFsdWUsYik7cmV0dXJuIGJ9LFByb3BlcnR5SXNMZXNzVGhhbk9yRXF1YWxUbzpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJvZ2M6UHJvcGVydHlJc0xlc3NUaGFuT3JFcXVhbFRvXCIpO3RoaXMud3JpdGVOb2RlKFwiUHJvcGVydHlOYW1lXCIsYSxiKTt0aGlzLndyaXRlT2djRXhwcmVzc2lvbihhLnZhbHVlLGIpO3JldHVybiBifSxQcm9wZXJ0eUlzR3JlYXRlclRoYW5PckVxdWFsVG86ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwib2djOlByb3BlcnR5SXNHcmVhdGVyVGhhbk9yRXF1YWxUb1wiKTtcbnRoaXMud3JpdGVOb2RlKFwiUHJvcGVydHlOYW1lXCIsYSxiKTt0aGlzLndyaXRlT2djRXhwcmVzc2lvbihhLnZhbHVlLGIpO3JldHVybiBifSxQcm9wZXJ0eUlzQmV0d2VlbjpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJvZ2M6UHJvcGVydHlJc0JldHdlZW5cIik7dGhpcy53cml0ZU5vZGUoXCJQcm9wZXJ0eU5hbWVcIixhLGIpO3RoaXMud3JpdGVOb2RlKFwiTG93ZXJCb3VuZGFyeVwiLGEsYik7dGhpcy53cml0ZU5vZGUoXCJVcHBlckJvdW5kYXJ5XCIsYSxiKTtyZXR1cm4gYn0sUHJvcGVydHlOYW1lOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJvZ2M6UHJvcGVydHlOYW1lXCIse3ZhbHVlOmEucHJvcGVydHl9KX0sTGl0ZXJhbDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwib2djOkxpdGVyYWxcIix7dmFsdWU6YX0pfSxMb3dlckJvdW5kYXJ5OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIm9nYzpMb3dlckJvdW5kYXJ5XCIpO1xudGhpcy53cml0ZU9nY0V4cHJlc3Npb24oYS5sb3dlckJvdW5kYXJ5LGIpO3JldHVybiBifSxVcHBlckJvdW5kYXJ5OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIm9nYzpVcHBlckJvdW5kYXJ5XCIpO3RoaXMud3JpdGVOb2RlKFwiTGl0ZXJhbFwiLGEudXBwZXJCb3VuZGFyeSxiKTtyZXR1cm4gYn0sSU5URVJTRUNUUzpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy53cml0ZVNwYXRpYWwoYSxcIkludGVyc2VjdHNcIil9LFdJVEhJTjpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy53cml0ZVNwYXRpYWwoYSxcIldpdGhpblwiKX0sQ09OVEFJTlM6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMud3JpdGVTcGF0aWFsKGEsXCJDb250YWluc1wiKX0sRFdJVEhJTjpmdW5jdGlvbihhKXt2YXIgYj10aGlzLndyaXRlU3BhdGlhbChhLFwiRFdpdGhpblwiKTt0aGlzLndyaXRlTm9kZShcIkRpc3RhbmNlXCIsYSxiKTtyZXR1cm4gYn0sRGlzdGFuY2U6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIm9nYzpEaXN0YW5jZVwiLFxue2F0dHJpYnV0ZXM6e3VuaXRzOmEuZGlzdGFuY2VVbml0c30sdmFsdWU6YS5kaXN0YW5jZX0pfSxGdW5jdGlvbjpmdW5jdGlvbihhKXtmb3IodmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwib2djOkZ1bmN0aW9uXCIse2F0dHJpYnV0ZXM6e25hbWU6YS5uYW1lfX0pLGE9YS5wYXJhbXMsYz0wLGQ9YS5sZW5ndGg7YzxkO2MrKyl0aGlzLndyaXRlT2djRXhwcmVzc2lvbihhW2NdLGIpO3JldHVybiBifX19LGdldEZpbHRlclR5cGU6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5maWx0ZXJNYXBbYS50eXBlXTtpZighYil0aHJvd1wiRmlsdGVyIHdyaXRpbmcgbm90IHN1cHBvcnRlZCBmb3IgcnVsZSB0eXBlOiBcIithLnR5cGU7cmV0dXJuIGJ9LGZpbHRlck1hcDp7XCImJlwiOlwiQW5kXCIsXCJ8fFwiOlwiT3JcIixcIiFcIjpcIk5vdFwiLFwiPT1cIjpcIlByb3BlcnR5SXNFcXVhbFRvXCIsXCIhPVwiOlwiUHJvcGVydHlJc05vdEVxdWFsVG9cIixcIjxcIjpcIlByb3BlcnR5SXNMZXNzVGhhblwiLFwiPlwiOlwiUHJvcGVydHlJc0dyZWF0ZXJUaGFuXCIsXG5cIjw9XCI6XCJQcm9wZXJ0eUlzTGVzc1RoYW5PckVxdWFsVG9cIixcIj49XCI6XCJQcm9wZXJ0eUlzR3JlYXRlclRoYW5PckVxdWFsVG9cIixcIi4uXCI6XCJQcm9wZXJ0eUlzQmV0d2VlblwiLFwiflwiOlwiUHJvcGVydHlJc0xpa2VcIixCQk9YOlwiQkJPWFwiLERXSVRISU46XCJEV0lUSElOXCIsV0lUSElOOlwiV0lUSElOXCIsQ09OVEFJTlM6XCJDT05UQUlOU1wiLElOVEVSU0VDVFM6XCJJTlRFUlNFQ1RTXCIsRklEOlwiRmVhdHVyZUlkXCJ9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZvcm1hdC5GaWx0ZXIudjFcIn0pO09wZW5MYXllcnMuR2VvbWV0cnk9T3BlbkxheWVycy5DbGFzcyh7aWQ6bnVsbCxwYXJlbnQ6bnVsbCxib3VuZHM6bnVsbCxpbml0aWFsaXplOmZ1bmN0aW9uKCl7dGhpcy5pZD1PcGVuTGF5ZXJzLlV0aWwuY3JlYXRlVW5pcXVlSUQodGhpcy5DTEFTU19OQU1FK1wiX1wiKX0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMuYm91bmRzPXRoaXMuaWQ9bnVsbH0sY2xvbmU6ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IE9wZW5MYXllcnMuR2VvbWV0cnl9LHNldEJvdW5kczpmdW5jdGlvbihhKXthJiYodGhpcy5ib3VuZHM9YS5jbG9uZSgpKX0sY2xlYXJCb3VuZHM6ZnVuY3Rpb24oKXt0aGlzLmJvdW5kcz1udWxsO3RoaXMucGFyZW50JiZ0aGlzLnBhcmVudC5jbGVhckJvdW5kcygpfSxleHRlbmRCb3VuZHM6ZnVuY3Rpb24oYSl7dGhpcy5nZXRCb3VuZHMoKT90aGlzLmJvdW5kcy5leHRlbmQoYSk6dGhpcy5zZXRCb3VuZHMoYSl9LGdldEJvdW5kczpmdW5jdGlvbigpe251bGw9PXRoaXMuYm91bmRzJiZ0aGlzLmNhbGN1bGF0ZUJvdW5kcygpO1xucmV0dXJuIHRoaXMuYm91bmRzfSxjYWxjdWxhdGVCb3VuZHM6ZnVuY3Rpb24oKXt9LGRpc3RhbmNlVG86ZnVuY3Rpb24oKXt9LGdldFZlcnRpY2VzOmZ1bmN0aW9uKCl7fSxhdFBvaW50OmZ1bmN0aW9uKGEsYixjKXt2YXIgZD0hMTtudWxsIT10aGlzLmdldEJvdW5kcygpJiZudWxsIT1hJiYoYj1udWxsIT1iP2I6MCxjPW51bGwhPWM/YzowLGQ9KG5ldyBPcGVuTGF5ZXJzLkJvdW5kcyh0aGlzLmJvdW5kcy5sZWZ0LWIsdGhpcy5ib3VuZHMuYm90dG9tLWMsdGhpcy5ib3VuZHMucmlnaHQrYix0aGlzLmJvdW5kcy50b3ArYykpLmNvbnRhaW5zTG9uTGF0KGEpKTtyZXR1cm4gZH0sZ2V0TGVuZ3RoOmZ1bmN0aW9uKCl7cmV0dXJuIDB9LGdldEFyZWE6ZnVuY3Rpb24oKXtyZXR1cm4gMH0sZ2V0Q2VudHJvaWQ6ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH0sdG9TdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm4gT3BlbkxheWVycy5Gb3JtYXQmJk9wZW5MYXllcnMuRm9ybWF0LldLVD9PcGVuTGF5ZXJzLkZvcm1hdC5XS1QucHJvdG90eXBlLndyaXRlKG5ldyBPcGVuTGF5ZXJzLkZlYXR1cmUuVmVjdG9yKHRoaXMpKTpcbk9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0aGlzKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuR2VvbWV0cnlcIn0pO09wZW5MYXllcnMuR2VvbWV0cnkuZnJvbVdLVD1mdW5jdGlvbihhKXt2YXIgYjtpZihPcGVuTGF5ZXJzLkZvcm1hdCYmT3BlbkxheWVycy5Gb3JtYXQuV0tUKXt2YXIgYz1PcGVuTGF5ZXJzLkdlb21ldHJ5LmZyb21XS1QuZm9ybWF0O2N8fChjPW5ldyBPcGVuTGF5ZXJzLkZvcm1hdC5XS1QsT3BlbkxheWVycy5HZW9tZXRyeS5mcm9tV0tULmZvcm1hdD1jKTthPWMucmVhZChhKTtpZihhIGluc3RhbmNlb2YgT3BlbkxheWVycy5GZWF0dXJlLlZlY3RvciliPWEuZ2VvbWV0cnk7ZWxzZSBpZihPcGVuTGF5ZXJzLlV0aWwuaXNBcnJheShhKSl7Yj1hLmxlbmd0aDtmb3IodmFyIGM9QXJyYXkoYiksZD0wO2Q8YjsrK2QpY1tkXT1hW2RdLmdlb21ldHJ5O2I9bmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuQ29sbGVjdGlvbihjKX19cmV0dXJuIGJ9O1xuT3BlbkxheWVycy5HZW9tZXRyeS5zZWdtZW50c0ludGVyc2VjdD1mdW5jdGlvbihhLGIsYyl7dmFyIGQ9YyYmYy5wb2ludCxjPWMmJmMudG9sZXJhbmNlLGU9ITEsZj1hLngxLWIueDEsZz1hLnkxLWIueTEsaD1hLngyLWEueDEsaT1hLnkyLWEueTEsaj1iLnkyLWIueTEsaz1iLngyLWIueDEsbD1qKmgtayppLGo9aypnLWoqZixnPWgqZy1pKmY7MD09bD8wPT1qJiYwPT1nJiYoZT0hMCk6KGY9ai9sLGw9Zy9sLDA8PWYmJigxPj1mJiYwPD1sJiYxPj1sKSYmKGQ/KGg9YS54MStmKmgsbD1hLnkxK2YqaSxlPW5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGgsbCkpOmU9ITApKTtpZihjKWlmKGUpe2lmKGQpe2E9W2EsYl07Yj0wO2E6Zm9yKDsyPmI7KytiKXtmPWFbYl07Zm9yKGk9MTszPmk7KytpKWlmKGg9ZltcInhcIitpXSxsPWZbXCJ5XCIraV0sZD1NYXRoLnNxcnQoTWF0aC5wb3coaC1lLngsMikrTWF0aC5wb3cobC1lLnksMikpLGQ8Yyl7ZS54PWg7ZS55PWw7YnJlYWsgYX19fX1lbHNle2E9XG5bYSxiXTtiPTA7YTpmb3IoOzI+YjsrK2Ipe2g9YVtiXTtsPWFbKGIrMSklMl07Zm9yKGk9MTszPmk7KytpKWlmKGY9e3g6aFtcInhcIitpXSx5OmhbXCJ5XCIraV19LGc9T3BlbkxheWVycy5HZW9tZXRyeS5kaXN0YW5jZVRvU2VnbWVudChmLGwpLGcuZGlzdGFuY2U8Yyl7ZT1kP25ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGYueCxmLnkpOiEwO2JyZWFrIGF9fX1yZXR1cm4gZX07T3BlbkxheWVycy5HZW9tZXRyeS5kaXN0YW5jZVRvU2VnbWVudD1mdW5jdGlvbihhLGIpe3ZhciBjPWEueCxkPWEueSxlPWIueDEsZj1iLnkxLGc9Yi54MixoPWIueTIsaT1nLWUsaj1oLWYsaz0oaSooYy1lKStqKihkLWYpKS8oTWF0aC5wb3coaSwyKStNYXRoLnBvdyhqLDIpKTswPj1rfHwoMTw9az8oZT1nLGY9aCk6KGUrPWsqaSxmKz1rKmopKTtyZXR1cm57ZGlzdGFuY2U6TWF0aC5zcXJ0KE1hdGgucG93KGUtYywyKStNYXRoLnBvdyhmLWQsMikpLHg6ZSx5OmZ9fTtPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50PU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5HZW9tZXRyeSx7eDpudWxsLHk6bnVsbCxpbml0aWFsaXplOmZ1bmN0aW9uKGEsYil7T3BlbkxheWVycy5HZW9tZXRyeS5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy54PXBhcnNlRmxvYXQoYSk7dGhpcy55PXBhcnNlRmxvYXQoYil9LGNsb25lOmZ1bmN0aW9uKGEpe251bGw9PWEmJihhPW5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KHRoaXMueCx0aGlzLnkpKTtPcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyhhLHRoaXMpO3JldHVybiBhfSxjYWxjdWxhdGVCb3VuZHM6ZnVuY3Rpb24oKXt0aGlzLmJvdW5kcz1uZXcgT3BlbkxheWVycy5Cb3VuZHModGhpcy54LHRoaXMueSx0aGlzLngsdGhpcy55KX0sZGlzdGFuY2VUbzpmdW5jdGlvbihhLGIpe3ZhciBjPSEoYiYmITE9PT1iLmVkZ2UpJiZiJiZiLmRldGFpbHMsZCxlLGYsZyxoO2EgaW5zdGFuY2VvZlxuT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludD8oZT10aGlzLngsZj10aGlzLnksZz1hLngsaD1hLnksZD1NYXRoLnNxcnQoTWF0aC5wb3coZS1nLDIpK01hdGgucG93KGYtaCwyKSksZD0hYz9kOnt4MDplLHkwOmYseDE6Zyx5MTpoLGRpc3RhbmNlOmR9KTooZD1hLmRpc3RhbmNlVG8odGhpcyxiKSxjJiYoZD17eDA6ZC54MSx5MDpkLnkxLHgxOmQueDAseTE6ZC55MCxkaXN0YW5jZTpkLmRpc3RhbmNlfSkpO3JldHVybiBkfSxlcXVhbHM6ZnVuY3Rpb24oYSl7dmFyIGI9ITE7bnVsbCE9YSYmKGI9dGhpcy54PT1hLngmJnRoaXMueT09YS55fHxpc05hTih0aGlzLngpJiZpc05hTih0aGlzLnkpJiZpc05hTihhLngpJiZpc05hTihhLnkpKTtyZXR1cm4gYn0sdG9TaG9ydFN0cmluZzpmdW5jdGlvbigpe3JldHVybiB0aGlzLngrXCIsIFwiK3RoaXMueX0sbW92ZTpmdW5jdGlvbihhLGIpe3RoaXMueCs9YTt0aGlzLnkrPWI7dGhpcy5jbGVhckJvdW5kcygpfSxyb3RhdGU6ZnVuY3Rpb24oYSxiKXt2YXIgYT1cbmEqKE1hdGguUEkvMTgwKSxjPXRoaXMuZGlzdGFuY2VUbyhiKSxkPWErTWF0aC5hdGFuMih0aGlzLnktYi55LHRoaXMueC1iLngpO3RoaXMueD1iLngrYypNYXRoLmNvcyhkKTt0aGlzLnk9Yi55K2MqTWF0aC5zaW4oZCk7dGhpcy5jbGVhckJvdW5kcygpfSxnZXRDZW50cm9pZDpmdW5jdGlvbigpe3JldHVybiBuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludCh0aGlzLngsdGhpcy55KX0scmVzaXplOmZ1bmN0aW9uKGEsYixjKXt0aGlzLng9Yi54K2EqKHZvaWQgMD09Yz8xOmMpKih0aGlzLngtYi54KTt0aGlzLnk9Yi55K2EqKHRoaXMueS1iLnkpO3RoaXMuY2xlYXJCb3VuZHMoKTtyZXR1cm4gdGhpc30saW50ZXJzZWN0czpmdW5jdGlvbihhKXt2YXIgYj0hMTtyZXR1cm4gYj1cIk9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnRcIj09YS5DTEFTU19OQU1FP3RoaXMuZXF1YWxzKGEpOmEuaW50ZXJzZWN0cyh0aGlzKX0sdHJhbnNmb3JtOmZ1bmN0aW9uKGEsYil7YSYmYiYmKE9wZW5MYXllcnMuUHJvamVjdGlvbi50cmFuc2Zvcm0odGhpcyxcbmEsYiksdGhpcy5ib3VuZHM9bnVsbCk7cmV0dXJuIHRoaXN9LGdldFZlcnRpY2VzOmZ1bmN0aW9uKCl7cmV0dXJuW3RoaXNdfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludFwifSk7T3BlbkxheWVycy5HZW9tZXRyeS5Db2xsZWN0aW9uPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5HZW9tZXRyeSx7Y29tcG9uZW50czpudWxsLGNvbXBvbmVudFR5cGVzOm51bGwsaW5pdGlhbGl6ZTpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLkdlb21ldHJ5LnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmNvbXBvbmVudHM9W107bnVsbCE9YSYmdGhpcy5hZGRDb21wb25lbnRzKGEpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5jb21wb25lbnRzLmxlbmd0aD0wO3RoaXMuY29tcG9uZW50cz1udWxsO09wZW5MYXllcnMuR2VvbWV0cnkucHJvdG90eXBlLmRlc3Ryb3kuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxjbG9uZTpmdW5jdGlvbigpe2Zvcih2YXIgYT1ldmFsKFwibmV3IFwiK3RoaXMuQ0xBU1NfTkFNRStcIigpXCIpLGI9MCxjPXRoaXMuY29tcG9uZW50cy5sZW5ndGg7YjxjO2IrKylhLmFkZENvbXBvbmVudCh0aGlzLmNvbXBvbmVudHNbYl0uY2xvbmUoKSk7XG5PcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyhhLHRoaXMpO3JldHVybiBhfSxnZXRDb21wb25lbnRzU3RyaW5nOmZ1bmN0aW9uKCl7Zm9yKHZhciBhPVtdLGI9MCxjPXRoaXMuY29tcG9uZW50cy5sZW5ndGg7YjxjO2IrKylhLnB1c2godGhpcy5jb21wb25lbnRzW2JdLnRvU2hvcnRTdHJpbmcoKSk7cmV0dXJuIGEuam9pbihcIixcIil9LGNhbGN1bGF0ZUJvdW5kczpmdW5jdGlvbigpe3RoaXMuYm91bmRzPW51bGw7dmFyIGE9bmV3IE9wZW5MYXllcnMuQm91bmRzLGI9dGhpcy5jb21wb25lbnRzO2lmKGIpZm9yKHZhciBjPTAsZD1iLmxlbmd0aDtjPGQ7YysrKWEuZXh0ZW5kKGJbY10uZ2V0Qm91bmRzKCkpO251bGwhPWEubGVmdCYmKG51bGwhPWEuYm90dG9tJiZudWxsIT1hLnJpZ2h0JiZudWxsIT1hLnRvcCkmJnRoaXMuc2V0Qm91bmRzKGEpfSxhZGRDb21wb25lbnRzOmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuVXRpbC5pc0FycmF5KGEpfHwoYT1bYV0pO2Zvcih2YXIgYj0wLGM9YS5sZW5ndGg7YjxcbmM7YisrKXRoaXMuYWRkQ29tcG9uZW50KGFbYl0pfSxhZGRDb21wb25lbnQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz0hMTtpZihhJiYobnVsbD09dGhpcy5jb21wb25lbnRUeXBlc3x8LTE8T3BlbkxheWVycy5VdGlsLmluZGV4T2YodGhpcy5jb21wb25lbnRUeXBlcyxhLkNMQVNTX05BTUUpKSl7aWYobnVsbCE9YiYmYjx0aGlzLmNvbXBvbmVudHMubGVuZ3RoKXt2YXIgYz10aGlzLmNvbXBvbmVudHMuc2xpY2UoMCxiKSxkPXRoaXMuY29tcG9uZW50cy5zbGljZShiLHRoaXMuY29tcG9uZW50cy5sZW5ndGgpO2MucHVzaChhKTt0aGlzLmNvbXBvbmVudHM9Yy5jb25jYXQoZCl9ZWxzZSB0aGlzLmNvbXBvbmVudHMucHVzaChhKTthLnBhcmVudD10aGlzO3RoaXMuY2xlYXJCb3VuZHMoKTtjPSEwfXJldHVybiBjfSxyZW1vdmVDb21wb25lbnRzOmZ1bmN0aW9uKGEpe3ZhciBiPSExO09wZW5MYXllcnMuVXRpbC5pc0FycmF5KGEpfHwoYT1bYV0pO2Zvcih2YXIgYz1hLmxlbmd0aC0xOzA8PWM7LS1jKWI9XG50aGlzLnJlbW92ZUNvbXBvbmVudChhW2NdKXx8YjtyZXR1cm4gYn0scmVtb3ZlQ29tcG9uZW50OmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuVXRpbC5yZW1vdmVJdGVtKHRoaXMuY29tcG9uZW50cyxhKTt0aGlzLmNsZWFyQm91bmRzKCk7cmV0dXJuITB9LGdldExlbmd0aDpmdW5jdGlvbigpe2Zvcih2YXIgYT0wLGI9MCxjPXRoaXMuY29tcG9uZW50cy5sZW5ndGg7YjxjO2IrKylhKz10aGlzLmNvbXBvbmVudHNbYl0uZ2V0TGVuZ3RoKCk7cmV0dXJuIGF9LGdldEFyZWE6ZnVuY3Rpb24oKXtmb3IodmFyIGE9MCxiPTAsYz10aGlzLmNvbXBvbmVudHMubGVuZ3RoO2I8YztiKyspYSs9dGhpcy5jb21wb25lbnRzW2JdLmdldEFyZWEoKTtyZXR1cm4gYX0sZ2V0R2VvZGVzaWNBcmVhOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj0wLGM9MCxkPXRoaXMuY29tcG9uZW50cy5sZW5ndGg7YzxkO2MrKyliKz10aGlzLmNvbXBvbmVudHNbY10uZ2V0R2VvZGVzaWNBcmVhKGEpO3JldHVybiBifSxnZXRDZW50cm9pZDpmdW5jdGlvbihhKXtpZighYSlyZXR1cm4gdGhpcy5jb21wb25lbnRzLmxlbmd0aCYmXG50aGlzLmNvbXBvbmVudHNbMF0uZ2V0Q2VudHJvaWQoKTthPXRoaXMuY29tcG9uZW50cy5sZW5ndGg7aWYoIWEpcmV0dXJuITE7Zm9yKHZhciBiPVtdLGM9W10sZD0wLGU9TnVtYmVyLk1BWF9WQUxVRSxmLGc9MDtnPGE7KytnKXtmPXRoaXMuY29tcG9uZW50c1tnXTt2YXIgaD1mLmdldEFyZWEoKTtmPWYuZ2V0Q2VudHJvaWQoITApOyFpc05hTihoKSYmKCFpc05hTihmLngpJiYhaXNOYU4oZi55KSkmJihiLnB1c2goaCksZCs9aCxlPWg8ZSYmMDxoP2g6ZSxjLnB1c2goZikpfWE9Yi5sZW5ndGg7aWYoMD09PWQpe2ZvcihnPTA7ZzxhOysrZyliW2ddPTE7ZD1iLmxlbmd0aH1lbHNle2ZvcihnPTA7ZzxhOysrZyliW2ddLz1lO2QvPWV9Zm9yKHZhciBpPWU9MCxnPTA7ZzxhOysrZylmPWNbZ10saD1iW2ddLGUrPWYueCpoLGkrPWYueSpoO3JldHVybiBuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChlL2QsaS9kKX0sZ2V0R2VvZGVzaWNMZW5ndGg6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPVxuMCxjPTAsZD10aGlzLmNvbXBvbmVudHMubGVuZ3RoO2M8ZDtjKyspYis9dGhpcy5jb21wb25lbnRzW2NdLmdldEdlb2Rlc2ljTGVuZ3RoKGEpO3JldHVybiBifSxtb3ZlOmZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPTAsZD10aGlzLmNvbXBvbmVudHMubGVuZ3RoO2M8ZDtjKyspdGhpcy5jb21wb25lbnRzW2NdLm1vdmUoYSxiKX0scm90YXRlOmZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPTAsZD10aGlzLmNvbXBvbmVudHMubGVuZ3RoO2M8ZDsrK2MpdGhpcy5jb21wb25lbnRzW2NdLnJvdGF0ZShhLGIpfSxyZXNpemU6ZnVuY3Rpb24oYSxiLGMpe2Zvcih2YXIgZD0wO2Q8dGhpcy5jb21wb25lbnRzLmxlbmd0aDsrK2QpdGhpcy5jb21wb25lbnRzW2RdLnJlc2l6ZShhLGIsYyk7cmV0dXJuIHRoaXN9LGRpc3RhbmNlVG86ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9IShiJiYhMT09PWIuZWRnZSkmJmImJmIuZGV0YWlscyxkLGUsZixnPU51bWJlci5QT1NJVElWRV9JTkZJTklUWSxoPTAsaT10aGlzLmNvbXBvbmVudHMubGVuZ3RoO2g8XG5pJiYhKGQ9dGhpcy5jb21wb25lbnRzW2hdLmRpc3RhbmNlVG8oYSxiKSxmPWM/ZC5kaXN0YW5jZTpkLGY8ZyYmKGc9ZixlPWQsMD09ZykpOysraCk7cmV0dXJuIGV9LGVxdWFsczpmdW5jdGlvbihhKXt2YXIgYj0hMDtpZighYXx8IWEuQ0xBU1NfTkFNRXx8dGhpcy5DTEFTU19OQU1FIT1hLkNMQVNTX05BTUUpYj0hMTtlbHNlIGlmKCFPcGVuTGF5ZXJzLlV0aWwuaXNBcnJheShhLmNvbXBvbmVudHMpfHxhLmNvbXBvbmVudHMubGVuZ3RoIT10aGlzLmNvbXBvbmVudHMubGVuZ3RoKWI9ITE7ZWxzZSBmb3IodmFyIGM9MCxkPXRoaXMuY29tcG9uZW50cy5sZW5ndGg7YzxkOysrYylpZighdGhpcy5jb21wb25lbnRzW2NdLmVxdWFscyhhLmNvbXBvbmVudHNbY10pKXtiPSExO2JyZWFrfXJldHVybiBifSx0cmFuc2Zvcm06ZnVuY3Rpb24oYSxiKXtpZihhJiZiKXtmb3IodmFyIGM9MCxkPXRoaXMuY29tcG9uZW50cy5sZW5ndGg7YzxkO2MrKyl0aGlzLmNvbXBvbmVudHNbY10udHJhbnNmb3JtKGEsXG5iKTt0aGlzLmJvdW5kcz1udWxsfXJldHVybiB0aGlzfSxpbnRlcnNlY3RzOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj0hMSxjPTAsZD10aGlzLmNvbXBvbmVudHMubGVuZ3RoO2M8ZCYmIShiPWEuaW50ZXJzZWN0cyh0aGlzLmNvbXBvbmVudHNbY10pKTsrK2MpO3JldHVybiBifSxnZXRWZXJ0aWNlczpmdW5jdGlvbihhKXtmb3IodmFyIGI9W10sYz0wLGQ9dGhpcy5jb21wb25lbnRzLmxlbmd0aDtjPGQ7KytjKUFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KGIsdGhpcy5jb21wb25lbnRzW2NdLmdldFZlcnRpY2VzKGEpKTtyZXR1cm4gYn0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuR2VvbWV0cnkuQ29sbGVjdGlvblwifSk7T3BlbkxheWVycy5HZW9tZXRyeS5NdWx0aVBvaW50PU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5HZW9tZXRyeS5Db2xsZWN0aW9uLHtjb21wb25lbnRUeXBlczpbXCJPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50XCJdLGFkZFBvaW50OmZ1bmN0aW9uKGEsYil7dGhpcy5hZGRDb21wb25lbnQoYSxiKX0scmVtb3ZlUG9pbnQ6ZnVuY3Rpb24oYSl7dGhpcy5yZW1vdmVDb21wb25lbnQoYSl9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkdlb21ldHJ5Lk11bHRpUG9pbnRcIn0pO09wZW5MYXllcnMuR2VvbWV0cnkuQ3VydmU9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkdlb21ldHJ5Lk11bHRpUG9pbnQse2NvbXBvbmVudFR5cGVzOltcIk9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnRcIl0sZ2V0TGVuZ3RoOmZ1bmN0aW9uKCl7dmFyIGE9MDtpZih0aGlzLmNvbXBvbmVudHMmJjE8dGhpcy5jb21wb25lbnRzLmxlbmd0aClmb3IodmFyIGI9MSxjPXRoaXMuY29tcG9uZW50cy5sZW5ndGg7YjxjO2IrKylhKz10aGlzLmNvbXBvbmVudHNbYi0xXS5kaXN0YW5jZVRvKHRoaXMuY29tcG9uZW50c1tiXSk7cmV0dXJuIGF9LGdldEdlb2Rlc2ljTGVuZ3RoOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7aWYoYSl7dmFyIGM9bmV3IE9wZW5MYXllcnMuUHJvamVjdGlvbihcIkVQU0c6NDMyNlwiKTtjLmVxdWFscyhhKXx8KGI9dGhpcy5jbG9uZSgpLnRyYW5zZm9ybShhLGMpKX1hPTA7aWYoYi5jb21wb25lbnRzJiYxPGIuY29tcG9uZW50cy5sZW5ndGgpZm9yKHZhciBkLGU9MSxmPWIuY29tcG9uZW50cy5sZW5ndGg7ZTxcbmY7ZSsrKWM9Yi5jb21wb25lbnRzW2UtMV0sZD1iLmNvbXBvbmVudHNbZV0sYSs9T3BlbkxheWVycy5VdGlsLmRpc3RWaW5jZW50eSh7bG9uOmMueCxsYXQ6Yy55fSx7bG9uOmQueCxsYXQ6ZC55fSk7cmV0dXJuIDFFMyphfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5HZW9tZXRyeS5DdXJ2ZVwifSk7T3BlbkxheWVycy5HZW9tZXRyeS5MaW5lU3RyaW5nPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5HZW9tZXRyeS5DdXJ2ZSx7cmVtb3ZlQ29tcG9uZW50OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY29tcG9uZW50cyYmMjx0aGlzLmNvbXBvbmVudHMubGVuZ3RoO2ImJk9wZW5MYXllcnMuR2VvbWV0cnkuQ29sbGVjdGlvbi5wcm90b3R5cGUucmVtb3ZlQ29tcG9uZW50LmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm4gYn0saW50ZXJzZWN0czpmdW5jdGlvbihhKXt2YXIgYj0hMSxjPWEuQ0xBU1NfTkFNRTtpZihcIk9wZW5MYXllcnMuR2VvbWV0cnkuTGluZVN0cmluZ1wiPT1jfHxcIk9wZW5MYXllcnMuR2VvbWV0cnkuTGluZWFyUmluZ1wiPT1jfHxcIk9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnRcIj09Yyl7dmFyIGQ9dGhpcy5nZXRTb3J0ZWRTZWdtZW50cygpLGE9XCJPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50XCI9PWM/W3t4MTphLngseTE6YS55LHgyOmEueCx5MjphLnl9XTphLmdldFNvcnRlZFNlZ21lbnRzKCksXG5lLGYsZyxoLGksaixrLGw9MCxtPWQubGVuZ3RoO2E6Zm9yKDtsPG07KytsKXtjPWRbbF07ZT1jLngxO2Y9Yy54MjtnPWMueTE7aD1jLnkyO3ZhciBuPTAsbz1hLmxlbmd0aDtmb3IoO248bzsrK24pe2k9YVtuXTtpZihpLngxPmYpYnJlYWs7aWYoIShpLngyPGUpJiYoaj1pLnkxLGs9aS55MiwhKE1hdGgubWluKGosayk+TWF0aC5tYXgoZyxoKSkmJiEoTWF0aC5tYXgoaixrKTxNYXRoLm1pbihnLGgpKSYmT3BlbkxheWVycy5HZW9tZXRyeS5zZWdtZW50c0ludGVyc2VjdChjLGkpKSl7Yj0hMDticmVhayBhfX19fWVsc2UgYj1hLmludGVyc2VjdHModGhpcyk7cmV0dXJuIGJ9LGdldFNvcnRlZFNlZ21lbnRzOmZ1bmN0aW9uKCl7Zm9yKHZhciBhPXRoaXMuY29tcG9uZW50cy5sZW5ndGgtMSxiPUFycmF5KGEpLGMsZCxlPTA7ZTxhOysrZSljPXRoaXMuY29tcG9uZW50c1tlXSxkPXRoaXMuY29tcG9uZW50c1tlKzFdLGJbZV09Yy54PGQueD97eDE6Yy54LHkxOmMueSx4MjpkLngseTI6ZC55fTpcbnt4MTpkLngseTE6ZC55LHgyOmMueCx5MjpjLnl9O3JldHVybiBiLnNvcnQoZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS54MS1iLngxfSl9LHNwbGl0V2l0aFNlZ21lbnQ6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9IShiJiYhMT09PWIuZWRnZSksZD1iJiZiLnRvbGVyYW5jZSxlPVtdLGY9dGhpcy5nZXRWZXJ0aWNlcygpLGc9W10saD1bXSxpPSExLGosayxsLG09e3BvaW50OiEwLHRvbGVyYW5jZTpkfSxuPW51bGwsbz0wLHA9Zi5sZW5ndGgtMjtvPD1wOysrbylpZihkPWZbb10sZy5wdXNoKGQuY2xvbmUoKSksaj1mW28rMV0saz17eDE6ZC54LHkxOmQueSx4MjpqLngseTI6ai55fSxrPU9wZW5MYXllcnMuR2VvbWV0cnkuc2VnbWVudHNJbnRlcnNlY3QoYSxrLG0pLGsgaW5zdGFuY2VvZiBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50JiYoKGw9ay54PT09YS54MSYmay55PT09YS55MXx8ay54PT09YS54MiYmay55PT09YS55Mnx8ay5lcXVhbHMoZCl8fGsuZXF1YWxzKGopPyEwOiExKXx8Yykpay5lcXVhbHMoaFtoLmxlbmd0aC1cbjFdKXx8aC5wdXNoKGsuY2xvbmUoKSksISgwPT09byYmay5lcXVhbHMoZCkpJiYhay5lcXVhbHMoaikmJihpPSEwLGsuZXF1YWxzKGQpfHxnLnB1c2goayksZS5wdXNoKG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVTdHJpbmcoZykpLGc9W2suY2xvbmUoKV0pO2kmJihnLnB1c2goai5jbG9uZSgpKSxlLnB1c2gobmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuTGluZVN0cmluZyhnKSkpO2lmKDA8aC5sZW5ndGgpdmFyIHE9YS54MTxhLngyPzE6LTEscj1hLnkxPGEueTI/MTotMSxuPXtsaW5lczplLHBvaW50czpoLnNvcnQoZnVuY3Rpb24oYSxiKXtyZXR1cm4gcSphLngtcSpiLnh8fHIqYS55LXIqYi55fSl9O3JldHVybiBufSxzcGxpdDpmdW5jdGlvbihhLGIpe3ZhciBjPW51bGwsZD1iJiZiLm11dHVhbCxlLGYsZyxoO2lmKGEgaW5zdGFuY2VvZiBPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVTdHJpbmcpe3ZhciBpPXRoaXMuZ2V0VmVydGljZXMoKSxqLGssbCxtLG4sbz1bXTtnPVtdO1xuZm9yKHZhciBwPTAscT1pLmxlbmd0aC0yO3A8PXE7KytwKXtqPWlbcF07az1pW3ArMV07bD17eDE6ai54LHkxOmoueSx4MjprLngseTI6ay55fTtoPWh8fFthXTtkJiZvLnB1c2goai5jbG9uZSgpKTtmb3IodmFyIHI9MDtyPGgubGVuZ3RoOysrcilpZihtPWhbcl0uc3BsaXRXaXRoU2VnbWVudChsLGIpKWlmKG49bS5saW5lcywwPG4ubGVuZ3RoJiYobi51bnNoaWZ0KHIsMSksQXJyYXkucHJvdG90eXBlLnNwbGljZS5hcHBseShoLG4pLHIrPW4ubGVuZ3RoLTIpLGQpZm9yKHZhciBzPTAsdD1tLnBvaW50cy5sZW5ndGg7czx0OysrcyluPW0ucG9pbnRzW3NdLG4uZXF1YWxzKGopfHwoby5wdXNoKG4pLGcucHVzaChuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5MaW5lU3RyaW5nKG8pKSxvPW4uZXF1YWxzKGspP1tdOltuLmNsb25lKCldKX1kJiYoMDxnLmxlbmd0aCYmMDxvLmxlbmd0aCkmJihvLnB1c2goay5jbG9uZSgpKSxnLnB1c2gobmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuTGluZVN0cmluZyhvKSkpfWVsc2UgYz1cbmEuc3BsaXRXaXRoKHRoaXMsYik7aCYmMTxoLmxlbmd0aD9mPSEwOmg9W107ZyYmMTxnLmxlbmd0aD9lPSEwOmc9W107aWYoZnx8ZSljPWQ/W2csaF06aDtyZXR1cm4gY30sc3BsaXRXaXRoOmZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuc3BsaXQodGhpcyxiKX0sZ2V0VmVydGljZXM6ZnVuY3Rpb24oYSl7cmV0dXJuITA9PT1hP1t0aGlzLmNvbXBvbmVudHNbMF0sdGhpcy5jb21wb25lbnRzW3RoaXMuY29tcG9uZW50cy5sZW5ndGgtMV1dOiExPT09YT90aGlzLmNvbXBvbmVudHMuc2xpY2UoMSx0aGlzLmNvbXBvbmVudHMubGVuZ3RoLTEpOnRoaXMuY29tcG9uZW50cy5zbGljZSgpfSxkaXN0YW5jZVRvOmZ1bmN0aW9uKGEsYil7dmFyIGM9IShiJiYhMT09PWIuZWRnZSkmJmImJmIuZGV0YWlscyxkLGU9e30sZj1OdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFk7aWYoYSBpbnN0YW5jZW9mIE9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQpe2Zvcih2YXIgZz10aGlzLmdldFNvcnRlZFNlZ21lbnRzKCksXG5oPWEueCxpPWEueSxqLGs9MCxsPWcubGVuZ3RoO2s8bDsrK2spaWYoaj1nW2tdLGQ9T3BlbkxheWVycy5HZW9tZXRyeS5kaXN0YW5jZVRvU2VnbWVudChhLGopLGQuZGlzdGFuY2U8Zil7aWYoZj1kLmRpc3RhbmNlLGU9ZCwwPT09ZilicmVha31lbHNlIGlmKGoueDI+aCYmKGk+ai55MSYmaTxqLnkyfHxpPGoueTEmJmk+ai55MikpYnJlYWs7ZT1jP3tkaXN0YW5jZTplLmRpc3RhbmNlLHgwOmUueCx5MDplLnkseDE6aCx5MTppfTplLmRpc3RhbmNlfWVsc2UgaWYoYSBpbnN0YW5jZW9mIE9wZW5MYXllcnMuR2VvbWV0cnkuTGluZVN0cmluZyl7dmFyIGc9dGhpcy5nZXRTb3J0ZWRTZWdtZW50cygpLGg9YS5nZXRTb3J0ZWRTZWdtZW50cygpLG0sbixvPWgubGVuZ3RoLHA9e3BvaW50OiEwfSxrPTAsbD1nLmxlbmd0aDthOmZvcig7azxsOysrayl7aT1nW2tdO2o9aS54MTtuPWkueTE7Zm9yKHZhciBxPTA7cTxvOysrcSlpZihkPWhbcV0sbT1PcGVuTGF5ZXJzLkdlb21ldHJ5LnNlZ21lbnRzSW50ZXJzZWN0KGksXG5kLHApKXtmPTA7ZT17ZGlzdGFuY2U6MCx4MDptLngseTA6bS55LHgxOm0ueCx5MTptLnl9O2JyZWFrIGF9ZWxzZSBkPU9wZW5MYXllcnMuR2VvbWV0cnkuZGlzdGFuY2VUb1NlZ21lbnQoe3g6aix5Om59LGQpLGQuZGlzdGFuY2U8ZiYmKGY9ZC5kaXN0YW5jZSxlPXtkaXN0YW5jZTpmLHgwOmoseTA6bix4MTpkLngseTE6ZC55fSl9Y3x8KGU9ZS5kaXN0YW5jZSk7MCE9PWYmJmkmJihkPWEuZGlzdGFuY2VUbyhuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChpLngyLGkueTIpLGIpLGs9Yz9kLmRpc3RhbmNlOmQsazxmJiYoZT1jP3tkaXN0YW5jZTpmLHgwOmQueDEseTA6ZC55MSx4MTpkLngwLHkxOmQueTB9OmspKX1lbHNlIGU9YS5kaXN0YW5jZVRvKHRoaXMsYiksYyYmKGU9e2Rpc3RhbmNlOmUuZGlzdGFuY2UseDA6ZS54MSx5MDplLnkxLHgxOmUueDAseTE6ZS55MH0pO3JldHVybiBlfSxzaW1wbGlmeTpmdW5jdGlvbihhKXtpZih0aGlzJiZudWxsIT09dGhpcyl7dmFyIGI9dGhpcy5nZXRWZXJ0aWNlcygpO1xuaWYoMz5iLmxlbmd0aClyZXR1cm4gdGhpczt2YXIgYz1mdW5jdGlvbihhLGIsZCxpKXtmb3IodmFyIGo9MCxrPTAsbD1iLG07bDxkO2wrKyl7bT1hW2JdO3ZhciBuPWFbZF0sbz1hW2xdLG89TWF0aC5hYnMoMC41KihtLngqbi55K24ueCpvLnkrby54Km0ueS1uLngqbS55LW8ueCpuLnktbS54Km8ueSkpO209TWF0aC5zcXJ0KE1hdGgucG93KG0ueC1uLngsMikrTWF0aC5wb3cobS55LW4ueSwyKSk7bT0yKihvL20pO20+aiYmKGo9bSxrPWwpfWo+aSYmayE9YiYmKGUucHVzaChrKSxjKGEsYixrLGkpLGMoYSxrLGQsaSkpfSxkPWIubGVuZ3RoLTEsZT1bXTtlLnB1c2goMCk7Zm9yKGUucHVzaChkKTtiWzBdLmVxdWFscyhiW2RdKTspZC0tLGUucHVzaChkKTtjKGIsMCxkLGEpO2E9W107ZS5zb3J0KGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEtYn0pO2ZvcihkPTA7ZDxlLmxlbmd0aDtkKyspYS5wdXNoKGJbZVtkXV0pO3JldHVybiBuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5MaW5lU3RyaW5nKGEpfXJldHVybiB0aGlzfSxcbkNMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVTdHJpbmdcIn0pO09wZW5MYXllcnMuR2VvbWV0cnkuTXVsdGlMaW5lU3RyaW5nPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5HZW9tZXRyeS5Db2xsZWN0aW9uLHtjb21wb25lbnRUeXBlczpbXCJPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVTdHJpbmdcIl0sc3BsaXQ6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9bnVsbCxkPWImJmIubXV0dWFsLGUsZixnLGgsaT1bXSxqPVthXSxrPTAsbD10aGlzLmNvbXBvbmVudHMubGVuZ3RoO2s8bDsrK2spe2Y9dGhpcy5jb21wb25lbnRzW2tdO2c9ITE7Zm9yKHZhciBtPTA7bTxqLmxlbmd0aDsrK20paWYoZT1mLnNwbGl0KGpbbV0sYikpe2lmKGQpe2c9ZVswXTtmb3IodmFyIG49MCxvPWcubGVuZ3RoO248bzsrK24pMD09PW4mJmkubGVuZ3RoP2lbaS5sZW5ndGgtMV0uYWRkQ29tcG9uZW50KGdbbl0pOmkucHVzaChuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5NdWx0aUxpbmVTdHJpbmcoW2dbbl1dKSk7Zz0hMDtlPWVbMV19aWYoZS5sZW5ndGgpe2UudW5zaGlmdChtLFxuMSk7QXJyYXkucHJvdG90eXBlLnNwbGljZS5hcHBseShqLGUpO2JyZWFrfX1nfHwoaS5sZW5ndGg/aVtpLmxlbmd0aC0xXS5hZGRDb21wb25lbnQoZi5jbG9uZSgpKTppPVtuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5NdWx0aUxpbmVTdHJpbmcoZi5jbG9uZSgpKV0pfWkmJjE8aS5sZW5ndGg/Zz0hMDppPVtdO2omJjE8ai5sZW5ndGg/aD0hMDpqPVtdO2lmKGd8fGgpYz1kP1tpLGpdOmo7cmV0dXJuIGN9LHNwbGl0V2l0aDpmdW5jdGlvbihhLGIpe3ZhciBjPW51bGwsZD1iJiZiLm11dHVhbCxlLGYsZyxoLGksajtpZihhIGluc3RhbmNlb2YgT3BlbkxheWVycy5HZW9tZXRyeS5MaW5lU3RyaW5nKXtqPVtdO2k9W2FdO2Zvcih2YXIgaz0wLGw9dGhpcy5jb21wb25lbnRzLmxlbmd0aDtrPGw7KytrKXtnPSExO2Y9dGhpcy5jb21wb25lbnRzW2tdO2Zvcih2YXIgbT0wO208aS5sZW5ndGg7KyttKWlmKGU9aVttXS5zcGxpdChmLGIpKXtkJiYoZz1lWzBdLGcubGVuZ3RoJiYoZy51bnNoaWZ0KG0sXG4xKSxBcnJheS5wcm90b3R5cGUuc3BsaWNlLmFwcGx5KGksZyksbSs9Zy5sZW5ndGgtMiksZT1lWzFdLDA9PT1lLmxlbmd0aCYmKGU9W2YuY2xvbmUoKV0pKTtnPTA7Zm9yKHZhciBuPWUubGVuZ3RoO2c8bjsrK2cpMD09PWcmJmoubGVuZ3RoP2pbai5sZW5ndGgtMV0uYWRkQ29tcG9uZW50KGVbZ10pOmoucHVzaChuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5NdWx0aUxpbmVTdHJpbmcoW2VbZ11dKSk7Zz0hMH1nfHwoai5sZW5ndGg/altqLmxlbmd0aC0xXS5hZGRDb21wb25lbnQoZi5jbG9uZSgpKTpqPVtuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5NdWx0aUxpbmVTdHJpbmcoW2YuY2xvbmUoKV0pXSl9fWVsc2UgYz1hLnNwbGl0KHRoaXMpO2kmJjE8aS5sZW5ndGg/aD0hMDppPVtdO2omJjE8ai5sZW5ndGg/Zz0hMDpqPVtdO2lmKGh8fGcpYz1kP1tpLGpdOmo7cmV0dXJuIGN9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkdlb21ldHJ5Lk11bHRpTGluZVN0cmluZ1wifSk7T3BlbkxheWVycy5HZW9tZXRyeS5MaW5lYXJSaW5nPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5HZW9tZXRyeS5MaW5lU3RyaW5nLHtjb21wb25lbnRUeXBlczpbXCJPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50XCJdLGFkZENvbXBvbmVudDpmdW5jdGlvbihhLGIpe3ZhciBjPSExLGQ9dGhpcy5jb21wb25lbnRzLnBvcCgpO2lmKG51bGwhPWJ8fCFhLmVxdWFscyhkKSljPU9wZW5MYXllcnMuR2VvbWV0cnkuQ29sbGVjdGlvbi5wcm90b3R5cGUuYWRkQ29tcG9uZW50LmFwcGx5KHRoaXMsYXJndW1lbnRzKTtPcGVuTGF5ZXJzLkdlb21ldHJ5LkNvbGxlY3Rpb24ucHJvdG90eXBlLmFkZENvbXBvbmVudC5hcHBseSh0aGlzLFt0aGlzLmNvbXBvbmVudHNbMF1dKTtyZXR1cm4gY30scmVtb3ZlQ29tcG9uZW50OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY29tcG9uZW50cyYmMzx0aGlzLmNvbXBvbmVudHMubGVuZ3RoO2ImJih0aGlzLmNvbXBvbmVudHMucG9wKCksT3BlbkxheWVycy5HZW9tZXRyeS5Db2xsZWN0aW9uLnByb3RvdHlwZS5yZW1vdmVDb21wb25lbnQuYXBwbHkodGhpcyxcbmFyZ3VtZW50cyksT3BlbkxheWVycy5HZW9tZXRyeS5Db2xsZWN0aW9uLnByb3RvdHlwZS5hZGRDb21wb25lbnQuYXBwbHkodGhpcyxbdGhpcy5jb21wb25lbnRzWzBdXSkpO3JldHVybiBifSxtb3ZlOmZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPTAsZD10aGlzLmNvbXBvbmVudHMubGVuZ3RoO2M8ZC0xO2MrKyl0aGlzLmNvbXBvbmVudHNbY10ubW92ZShhLGIpfSxyb3RhdGU6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9MCxkPXRoaXMuY29tcG9uZW50cy5sZW5ndGg7YzxkLTE7KytjKXRoaXMuY29tcG9uZW50c1tjXS5yb3RhdGUoYSxiKX0scmVzaXplOmZ1bmN0aW9uKGEsYixjKXtmb3IodmFyIGQ9MCxlPXRoaXMuY29tcG9uZW50cy5sZW5ndGg7ZDxlLTE7KytkKXRoaXMuY29tcG9uZW50c1tkXS5yZXNpemUoYSxiLGMpO3JldHVybiB0aGlzfSx0cmFuc2Zvcm06ZnVuY3Rpb24oYSxiKXtpZihhJiZiKXtmb3IodmFyIGM9MCxkPXRoaXMuY29tcG9uZW50cy5sZW5ndGg7YzxkLTE7YysrKXRoaXMuY29tcG9uZW50c1tjXS50cmFuc2Zvcm0oYSxcbmIpO3RoaXMuYm91bmRzPW51bGx9cmV0dXJuIHRoaXN9LGdldENlbnRyb2lkOmZ1bmN0aW9uKCl7aWYodGhpcy5jb21wb25lbnRzJiYyPHRoaXMuY29tcG9uZW50cy5sZW5ndGgpe2Zvcih2YXIgYT0wLGI9MCxjPTA7Yzx0aGlzLmNvbXBvbmVudHMubGVuZ3RoLTE7YysrKXZhciBkPXRoaXMuY29tcG9uZW50c1tjXSxlPXRoaXMuY29tcG9uZW50c1tjKzFdLGE9YSsoZC54K2UueCkqKGQueCplLnktZS54KmQueSksYj1iKyhkLnkrZS55KSooZC54KmUueS1lLngqZC55KTtjPS0xKnRoaXMuZ2V0QXJlYSgpO3JldHVybiBuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChhLyg2KmMpLGIvKDYqYykpfXJldHVybiBudWxsfSxnZXRBcmVhOmZ1bmN0aW9uKCl7dmFyIGE9MDtpZih0aGlzLmNvbXBvbmVudHMmJjI8dGhpcy5jb21wb25lbnRzLmxlbmd0aCl7Zm9yKHZhciBiPWE9MCxjPXRoaXMuY29tcG9uZW50cy5sZW5ndGg7YjxjLTE7YisrKXZhciBkPXRoaXMuY29tcG9uZW50c1tiXSxlPVxudGhpcy5jb21wb25lbnRzW2IrMV0sYT1hKyhkLngrZS54KSooZS55LWQueSk7YT0tYS8yfXJldHVybiBhfSxnZXRHZW9kZXNpY0FyZWE6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcztpZihhKXt2YXIgYz1uZXcgT3BlbkxheWVycy5Qcm9qZWN0aW9uKFwiRVBTRzo0MzI2XCIpO2MuZXF1YWxzKGEpfHwoYj10aGlzLmNsb25lKCkudHJhbnNmb3JtKGEsYykpfWE9MDtjPWIuY29tcG9uZW50cyYmYi5jb21wb25lbnRzLmxlbmd0aDtpZigyPGMpe2Zvcih2YXIgZCxlLGY9MDtmPGMtMTtmKyspZD1iLmNvbXBvbmVudHNbZl0sZT1iLmNvbXBvbmVudHNbZisxXSxhKz1PcGVuTGF5ZXJzLlV0aWwucmFkKGUueC1kLngpKigyK01hdGguc2luKE9wZW5MYXllcnMuVXRpbC5yYWQoZC55KSkrTWF0aC5zaW4oT3BlbkxheWVycy5VdGlsLnJhZChlLnkpKSk7YT00MDY4MDYzMTU5MDc2OSphLzJ9cmV0dXJuIGF9LGNvbnRhaW5zUG9pbnQ6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPU9wZW5MYXllcnMuTnVtYmVyLmxpbWl0U2lnRGlncyxcbmM9YihhLngsMTQpLGE9YihhLnksMTQpLGQ9dGhpcy5jb21wb25lbnRzLmxlbmd0aC0xLGUsZixnLGgsaSxqPTAsaz0wO2s8ZDsrK2spaWYoZT10aGlzLmNvbXBvbmVudHNba10sZz1iKGUueCwxNCksZT1iKGUueSwxNCksZj10aGlzLmNvbXBvbmVudHNbaysxXSxoPWIoZi54LDE0KSxmPWIoZi55LDE0KSxlPT1mKXtpZihhPT1lJiYoZzw9aCYmYz49ZyYmYzw9aHx8Zz49aCYmYzw9ZyYmYz49aCkpe2o9LTE7YnJlYWt9fWVsc2V7aT1iKChhLWYpKigoaC1nKS8oZi1lKSkraCwxNCk7aWYoaT09YyYmKGU8ZiYmYT49ZSYmYTw9Znx8ZT5mJiZhPD1lJiZhPj1mKSl7aj0tMTticmVha31pPD1jfHxnIT1oJiYoaTxNYXRoLm1pbihnLGgpfHxpPk1hdGgubWF4KGcsaCkpfHwoZTxmJiZhPj1lJiZhPGZ8fGU+ZiYmYTxlJiZhPj1mKSYmKytqfXJldHVybi0xPT1qPzE6ISEoaiYxKX0saW50ZXJzZWN0czpmdW5jdGlvbihhKXt2YXIgYj0hMTtpZihcIk9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnRcIj09XG5hLkNMQVNTX05BTUUpYj10aGlzLmNvbnRhaW5zUG9pbnQoYSk7ZWxzZSBpZihcIk9wZW5MYXllcnMuR2VvbWV0cnkuTGluZVN0cmluZ1wiPT1hLkNMQVNTX05BTUUpYj1hLmludGVyc2VjdHModGhpcyk7ZWxzZSBpZihcIk9wZW5MYXllcnMuR2VvbWV0cnkuTGluZWFyUmluZ1wiPT1hLkNMQVNTX05BTUUpYj1PcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVTdHJpbmcucHJvdG90eXBlLmludGVyc2VjdHMuYXBwbHkodGhpcyxbYV0pO2Vsc2UgZm9yKHZhciBjPTAsZD1hLmNvbXBvbmVudHMubGVuZ3RoO2M8ZCYmIShiPWEuY29tcG9uZW50c1tjXS5pbnRlcnNlY3RzKHRoaXMpKTsrK2MpO3JldHVybiBifSxnZXRWZXJ0aWNlczpmdW5jdGlvbihhKXtyZXR1cm4hMD09PWE/W106dGhpcy5jb21wb25lbnRzLnNsaWNlKDAsdGhpcy5jb21wb25lbnRzLmxlbmd0aC0xKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuR2VvbWV0cnkuTGluZWFyUmluZ1wifSk7T3BlbkxheWVycy5HZW9tZXRyeS5Qb2x5Z29uPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5HZW9tZXRyeS5Db2xsZWN0aW9uLHtjb21wb25lbnRUeXBlczpbXCJPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVhclJpbmdcIl0sZ2V0QXJlYTpmdW5jdGlvbigpe3ZhciBhPTA7aWYodGhpcy5jb21wb25lbnRzJiYwPHRoaXMuY29tcG9uZW50cy5sZW5ndGgpZm9yKHZhciBhPWErTWF0aC5hYnModGhpcy5jb21wb25lbnRzWzBdLmdldEFyZWEoKSksYj0xLGM9dGhpcy5jb21wb25lbnRzLmxlbmd0aDtiPGM7YisrKWEtPU1hdGguYWJzKHRoaXMuY29tcG9uZW50c1tiXS5nZXRBcmVhKCkpO3JldHVybiBhfSxnZXRHZW9kZXNpY0FyZWE6ZnVuY3Rpb24oYSl7dmFyIGI9MDtpZih0aGlzLmNvbXBvbmVudHMmJjA8dGhpcy5jb21wb25lbnRzLmxlbmd0aClmb3IodmFyIGI9YitNYXRoLmFicyh0aGlzLmNvbXBvbmVudHNbMF0uZ2V0R2VvZGVzaWNBcmVhKGEpKSxjPTEsZD10aGlzLmNvbXBvbmVudHMubGVuZ3RoO2M8XG5kO2MrKyliLT1NYXRoLmFicyh0aGlzLmNvbXBvbmVudHNbY10uZ2V0R2VvZGVzaWNBcmVhKGEpKTtyZXR1cm4gYn0sY29udGFpbnNQb2ludDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNvbXBvbmVudHMubGVuZ3RoLGM9ITE7aWYoMDxiJiYoYz10aGlzLmNvbXBvbmVudHNbMF0uY29udGFpbnNQb2ludChhKSwxIT09YyYmYyYmMTxiKSlmb3IodmFyIGQsZT0xO2U8YjsrK2UpaWYoZD10aGlzLmNvbXBvbmVudHNbZV0uY29udGFpbnNQb2ludChhKSl7Yz0xPT09ZD8xOiExO2JyZWFrfXJldHVybiBjfSxpbnRlcnNlY3RzOmZ1bmN0aW9uKGEpe3ZhciBiPSExLGMsZDtpZihcIk9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnRcIj09YS5DTEFTU19OQU1FKWI9dGhpcy5jb250YWluc1BvaW50KGEpO2Vsc2UgaWYoXCJPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVTdHJpbmdcIj09YS5DTEFTU19OQU1FfHxcIk9wZW5MYXllcnMuR2VvbWV0cnkuTGluZWFyUmluZ1wiPT1hLkNMQVNTX05BTUUpe2M9MDtmb3IoZD1cbnRoaXMuY29tcG9uZW50cy5sZW5ndGg7YzxkJiYhKGI9YS5pbnRlcnNlY3RzKHRoaXMuY29tcG9uZW50c1tjXSkpOysrYyk7aWYoIWIpe2M9MDtmb3IoZD1hLmNvbXBvbmVudHMubGVuZ3RoO2M8ZCYmIShiPXRoaXMuY29udGFpbnNQb2ludChhLmNvbXBvbmVudHNbY10pKTsrK2MpO319ZWxzZXtjPTA7Zm9yKGQ9YS5jb21wb25lbnRzLmxlbmd0aDtjPGQmJiEoYj10aGlzLmludGVyc2VjdHMoYS5jb21wb25lbnRzW2NdKSk7KytjKTt9aWYoIWImJlwiT3BlbkxheWVycy5HZW9tZXRyeS5Qb2x5Z29uXCI9PWEuQ0xBU1NfTkFNRSl7dmFyIGU9dGhpcy5jb21wb25lbnRzWzBdO2M9MDtmb3IoZD1lLmNvbXBvbmVudHMubGVuZ3RoO2M8ZCYmIShiPWEuY29udGFpbnNQb2ludChlLmNvbXBvbmVudHNbY10pKTsrK2MpO31yZXR1cm4gYn0sZGlzdGFuY2VUbzpmdW5jdGlvbihhLGIpe3JldHVybiBiJiYhMT09PWIuZWRnZSYmdGhpcy5pbnRlcnNlY3RzKGEpPzA6T3BlbkxheWVycy5HZW9tZXRyeS5Db2xsZWN0aW9uLnByb3RvdHlwZS5kaXN0YW5jZVRvLmFwcGx5KHRoaXMsXG5bYSxiXSl9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvbHlnb25cIn0pO09wZW5MYXllcnMuR2VvbWV0cnkuUG9seWdvbi5jcmVhdGVSZWd1bGFyUG9seWdvbj1mdW5jdGlvbihhLGIsYyxkKXt2YXIgZT1NYXRoLlBJKigxL2MtMC41KTtkJiYoZSs9ZC8xODAqTWF0aC5QSSk7Zm9yKHZhciBmLGc9W10saD0wO2g8YzsrK2gpZj1lKzIqaCpNYXRoLlBJL2MsZD1hLngrYipNYXRoLmNvcyhmKSxmPWEueStiKk1hdGguc2luKGYpLGcucHVzaChuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChkLGYpKTthPW5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVhclJpbmcoZyk7cmV0dXJuIG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvbHlnb24oW2FdKX07T3BlbkxheWVycy5HZW9tZXRyeS5NdWx0aVBvbHlnb249T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkdlb21ldHJ5LkNvbGxlY3Rpb24se2NvbXBvbmVudFR5cGVzOltcIk9wZW5MYXllcnMuR2VvbWV0cnkuUG9seWdvblwiXSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5HZW9tZXRyeS5NdWx0aVBvbHlnb25cIn0pO09wZW5MYXllcnMuRm9ybWF0LkdNTD1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuRm9ybWF0LlhNTCx7ZmVhdHVyZU5TOlwiaHR0cDovL21hcHNlcnZlci5naXMudW1uLmVkdS9tYXBzZXJ2ZXJcIixmZWF0dXJlUHJlZml4OlwiZmVhdHVyZVwiLGZlYXR1cmVOYW1lOlwiZmVhdHVyZU1lbWJlclwiLGxheWVyTmFtZTpcImZlYXR1cmVzXCIsZ2VvbWV0cnlOYW1lOlwiZ2VvbWV0cnlcIixjb2xsZWN0aW9uTmFtZTpcIkZlYXR1cmVDb2xsZWN0aW9uXCIsZ21sbnM6XCJodHRwOi8vd3d3Lm9wZW5naXMubmV0L2dtbFwiLGV4dHJhY3RBdHRyaWJ1dGVzOiEwLHh5OiEwLGluaXRpYWxpemU6ZnVuY3Rpb24oYSl7dGhpcy5yZWdFeGVzPXt0cmltU3BhY2U6L15cXHMqfFxccyokL2cscmVtb3ZlU3BhY2U6L1xccyovZyxzcGxpdFNwYWNlOi9cXHMrLyx0cmltQ29tbWE6L1xccyosXFxzKi9nfTtPcGVuTGF5ZXJzLkZvcm1hdC5YTUwucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbYV0pfSxyZWFkOmZ1bmN0aW9uKGEpe1wic3RyaW5nXCI9PVxudHlwZW9mIGEmJihhPU9wZW5MYXllcnMuRm9ybWF0LlhNTC5wcm90b3R5cGUucmVhZC5hcHBseSh0aGlzLFthXSkpO2Zvcih2YXIgYT10aGlzLmdldEVsZW1lbnRzQnlUYWdOYW1lTlMoYS5kb2N1bWVudEVsZW1lbnQsdGhpcy5nbWxucyx0aGlzLmZlYXR1cmVOYW1lKSxiPVtdLGM9MDtjPGEubGVuZ3RoO2MrKyl7dmFyIGQ9dGhpcy5wYXJzZUZlYXR1cmUoYVtjXSk7ZCYmYi5wdXNoKGQpfXJldHVybiBifSxwYXJzZUZlYXR1cmU6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPVwiTXVsdGlQb2x5Z29uIFBvbHlnb24gTXVsdGlMaW5lU3RyaW5nIExpbmVTdHJpbmcgTXVsdGlQb2ludCBQb2ludCBFbnZlbG9wZVwiLnNwbGl0KFwiIFwiKSxjLGQsZSxmPTA7ZjxiLmxlbmd0aDsrK2YpaWYoYz1iW2ZdLGQ9dGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZU5TKGEsdGhpcy5nbWxucyxjKSwwPGQubGVuZ3RoKXtpZihlPXRoaXMucGFyc2VHZW9tZXRyeVtjLnRvTG93ZXJDYXNlKCldKWU9ZS5hcHBseSh0aGlzLFxuW2RbMF1dKSx0aGlzLmludGVybmFsUHJvamVjdGlvbiYmdGhpcy5leHRlcm5hbFByb2plY3Rpb24mJmUudHJhbnNmb3JtKHRoaXMuZXh0ZXJuYWxQcm9qZWN0aW9uLHRoaXMuaW50ZXJuYWxQcm9qZWN0aW9uKTtlbHNlIHRocm93IG5ldyBUeXBlRXJyb3IoXCJVbnN1cHBvcnRlZCBnZW9tZXRyeSB0eXBlOiBcIitjKTticmVha312YXIgZztjPXRoaXMuZ2V0RWxlbWVudHNCeVRhZ05hbWVOUyhhLHRoaXMuZ21sbnMsXCJCb3hcIik7Zm9yKGY9MDtmPGMubGVuZ3RoOysrZiliPWNbZl0sZD10aGlzLnBhcnNlR2VvbWV0cnkuYm94LmFwcGx5KHRoaXMsW2JdKSxiPWIucGFyZW50Tm9kZSxcImJvdW5kZWRCeVwiPT09KGIubG9jYWxOYW1lfHxiLm5vZGVOYW1lLnNwbGl0KFwiOlwiKS5wb3AoKSk/Zz1kOmU9ZC50b0dlb21ldHJ5KCk7dmFyIGg7dGhpcy5leHRyYWN0QXR0cmlidXRlcyYmKGg9dGhpcy5wYXJzZUF0dHJpYnV0ZXMoYSkpO2g9bmV3IE9wZW5MYXllcnMuRmVhdHVyZS5WZWN0b3IoZSxoKTtoLmJvdW5kcz1cbmc7aC5nbWw9e2ZlYXR1cmVUeXBlOmEuZmlyc3RDaGlsZC5ub2RlTmFtZS5zcGxpdChcIjpcIilbMV0sZmVhdHVyZU5TOmEuZmlyc3RDaGlsZC5uYW1lc3BhY2VVUkksZmVhdHVyZU5TUHJlZml4OmEuZmlyc3RDaGlsZC5wcmVmaXh9O2Zvcih2YXIgYT1hLmZpcnN0Q2hpbGQsaTthJiYhKDE9PWEubm9kZVR5cGUmJihpPWEuZ2V0QXR0cmlidXRlKFwiZmlkXCIpfHxhLmdldEF0dHJpYnV0ZShcImlkXCIpKSk7KWE9YS5uZXh0U2libGluZztoLmZpZD1pO3JldHVybiBofSxwYXJzZUdlb21ldHJ5Ontwb2ludDpmdW5jdGlvbihhKXt2YXIgYixjO2M9W107Yj10aGlzLmdldEVsZW1lbnRzQnlUYWdOYW1lTlMoYSx0aGlzLmdtbG5zLFwicG9zXCIpOzA8Yi5sZW5ndGgmJihjPWJbMF0uZmlyc3RDaGlsZC5ub2RlVmFsdWUsYz1jLnJlcGxhY2UodGhpcy5yZWdFeGVzLnRyaW1TcGFjZSxcIlwiKSxjPWMuc3BsaXQodGhpcy5yZWdFeGVzLnNwbGl0U3BhY2UpKTswPT1jLmxlbmd0aCYmKGI9dGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZU5TKGEsXG50aGlzLmdtbG5zLFwiY29vcmRpbmF0ZXNcIiksMDxiLmxlbmd0aCYmKGM9YlswXS5maXJzdENoaWxkLm5vZGVWYWx1ZSxjPWMucmVwbGFjZSh0aGlzLnJlZ0V4ZXMucmVtb3ZlU3BhY2UsXCJcIiksYz1jLnNwbGl0KFwiLFwiKSkpOzA9PWMubGVuZ3RoJiYoYj10aGlzLmdldEVsZW1lbnRzQnlUYWdOYW1lTlMoYSx0aGlzLmdtbG5zLFwiY29vcmRcIiksMDxiLmxlbmd0aCYmKGE9dGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZU5TKGJbMF0sdGhpcy5nbWxucyxcIlhcIiksYj10aGlzLmdldEVsZW1lbnRzQnlUYWdOYW1lTlMoYlswXSx0aGlzLmdtbG5zLFwiWVwiKSwwPGEubGVuZ3RoJiYwPGIubGVuZ3RoJiYoYz1bYVswXS5maXJzdENoaWxkLm5vZGVWYWx1ZSxiWzBdLmZpcnN0Q2hpbGQubm9kZVZhbHVlXSkpKTsyPT1jLmxlbmd0aCYmKGNbMl09bnVsbCk7cmV0dXJuIHRoaXMueHk/bmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQoY1swXSxjWzFdLGNbMl0pOm5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGNbMV0sXG5jWzBdLGNbMl0pfSxtdWx0aXBvaW50OmZ1bmN0aW9uKGEpe3ZhciBhPXRoaXMuZ2V0RWxlbWVudHNCeVRhZ05hbWVOUyhhLHRoaXMuZ21sbnMsXCJQb2ludFwiKSxiPVtdO2lmKDA8YS5sZW5ndGgpZm9yKHZhciBjLGQ9MDtkPGEubGVuZ3RoOysrZCkoYz10aGlzLnBhcnNlR2VvbWV0cnkucG9pbnQuYXBwbHkodGhpcyxbYVtkXV0pKSYmYi5wdXNoKGMpO3JldHVybiBuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5NdWx0aVBvaW50KGIpfSxsaW5lc3RyaW5nOmZ1bmN0aW9uKGEsYil7dmFyIGMsZDtkPVtdO3ZhciBlPVtdO2M9dGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZU5TKGEsdGhpcy5nbWxucyxcInBvc0xpc3RcIik7aWYoMDxjLmxlbmd0aCl7ZD10aGlzLmdldENoaWxkVmFsdWUoY1swXSk7ZD1kLnJlcGxhY2UodGhpcy5yZWdFeGVzLnRyaW1TcGFjZSxcIlwiKTtkPWQuc3BsaXQodGhpcy5yZWdFeGVzLnNwbGl0U3BhY2UpO3ZhciBmPXBhcnNlSW50KGNbMF0uZ2V0QXR0cmlidXRlKFwiZGltZW5zaW9uXCIpKSxcbmcsaCxpO2ZvcihjPTA7YzxkLmxlbmd0aC9mOysrYylnPWMqZixoPWRbZ10saT1kW2crMV0sZz0yPT1mP251bGw6ZFtnKzJdLHRoaXMueHk/ZS5wdXNoKG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGgsaSxnKSk6ZS5wdXNoKG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGksaCxnKSl9aWYoMD09ZC5sZW5ndGgmJihjPXRoaXMuZ2V0RWxlbWVudHNCeVRhZ05hbWVOUyhhLHRoaXMuZ21sbnMsXCJjb29yZGluYXRlc1wiKSwwPGMubGVuZ3RoKSl7ZD10aGlzLmdldENoaWxkVmFsdWUoY1swXSk7ZD1kLnJlcGxhY2UodGhpcy5yZWdFeGVzLnRyaW1TcGFjZSxcIlwiKTtkPWQucmVwbGFjZSh0aGlzLnJlZ0V4ZXMudHJpbUNvbW1hLFwiLFwiKTtmPWQuc3BsaXQodGhpcy5yZWdFeGVzLnNwbGl0U3BhY2UpO2ZvcihjPTA7YzxmLmxlbmd0aDsrK2MpZD1mW2NdLnNwbGl0KFwiLFwiKSwyPT1kLmxlbmd0aCYmKGRbMl09bnVsbCksdGhpcy54eT9lLnB1c2gobmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQoZFswXSxcbmRbMV0sZFsyXSkpOmUucHVzaChuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChkWzFdLGRbMF0sZFsyXSkpfWQ9bnVsbDswIT1lLmxlbmd0aCYmKGQ9Yj9uZXcgT3BlbkxheWVycy5HZW9tZXRyeS5MaW5lYXJSaW5nKGUpOm5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVTdHJpbmcoZSkpO3JldHVybiBkfSxtdWx0aWxpbmVzdHJpbmc6ZnVuY3Rpb24oYSl7dmFyIGE9dGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZU5TKGEsdGhpcy5nbWxucyxcIkxpbmVTdHJpbmdcIiksYj1bXTtpZigwPGEubGVuZ3RoKWZvcih2YXIgYyxkPTA7ZDxhLmxlbmd0aDsrK2QpKGM9dGhpcy5wYXJzZUdlb21ldHJ5LmxpbmVzdHJpbmcuYXBwbHkodGhpcyxbYVtkXV0pKSYmYi5wdXNoKGMpO3JldHVybiBuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5NdWx0aUxpbmVTdHJpbmcoYil9LHBvbHlnb246ZnVuY3Rpb24oYSl7dmFyIGE9dGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZU5TKGEsdGhpcy5nbWxucyxcIkxpbmVhclJpbmdcIiksXG5iPVtdO2lmKDA8YS5sZW5ndGgpZm9yKHZhciBjLGQ9MDtkPGEubGVuZ3RoOysrZCkoYz10aGlzLnBhcnNlR2VvbWV0cnkubGluZXN0cmluZy5hcHBseSh0aGlzLFthW2RdLCEwXSkpJiZiLnB1c2goYyk7cmV0dXJuIG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvbHlnb24oYil9LG11bHRpcG9seWdvbjpmdW5jdGlvbihhKXt2YXIgYT10aGlzLmdldEVsZW1lbnRzQnlUYWdOYW1lTlMoYSx0aGlzLmdtbG5zLFwiUG9seWdvblwiKSxiPVtdO2lmKDA8YS5sZW5ndGgpZm9yKHZhciBjLGQ9MDtkPGEubGVuZ3RoOysrZCkoYz10aGlzLnBhcnNlR2VvbWV0cnkucG9seWdvbi5hcHBseSh0aGlzLFthW2RdXSkpJiZiLnB1c2goYyk7cmV0dXJuIG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5Lk11bHRpUG9seWdvbihiKX0sZW52ZWxvcGU6ZnVuY3Rpb24oYSl7dmFyIGI9W10sYyxkLGU9dGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZU5TKGEsdGhpcy5nbWxucyxcImxvd2VyQ29ybmVyXCIpO2lmKDA8ZS5sZW5ndGgpe2M9XG5bXTswPGUubGVuZ3RoJiYoYz1lWzBdLmZpcnN0Q2hpbGQubm9kZVZhbHVlLGM9Yy5yZXBsYWNlKHRoaXMucmVnRXhlcy50cmltU3BhY2UsXCJcIiksYz1jLnNwbGl0KHRoaXMucmVnRXhlcy5zcGxpdFNwYWNlKSk7Mj09Yy5sZW5ndGgmJihjWzJdPW51bGwpO3ZhciBmPXRoaXMueHk/bmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQoY1swXSxjWzFdLGNbMl0pOm5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGNbMV0sY1swXSxjWzJdKX1hPXRoaXMuZ2V0RWxlbWVudHNCeVRhZ05hbWVOUyhhLHRoaXMuZ21sbnMsXCJ1cHBlckNvcm5lclwiKTtpZigwPGEubGVuZ3RoKXtjPVtdOzA8YS5sZW5ndGgmJihjPWFbMF0uZmlyc3RDaGlsZC5ub2RlVmFsdWUsYz1jLnJlcGxhY2UodGhpcy5yZWdFeGVzLnRyaW1TcGFjZSxcIlwiKSxjPWMuc3BsaXQodGhpcy5yZWdFeGVzLnNwbGl0U3BhY2UpKTsyPT1jLmxlbmd0aCYmKGNbMl09bnVsbCk7dmFyIGc9dGhpcy54eT9uZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChjWzBdLFxuY1sxXSxjWzJdKTpuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChjWzFdLGNbMF0sY1syXSl9ZiYmZyYmKGIucHVzaChuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChmLngsZi55KSksYi5wdXNoKG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGcueCxmLnkpKSxiLnB1c2gobmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQoZy54LGcueSkpLGIucHVzaChuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChmLngsZy55KSksYi5wdXNoKG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGYueCxmLnkpKSxiPW5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVhclJpbmcoYiksZD1uZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2x5Z29uKFtiXSkpO3JldHVybiBkfSxib3g6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZU5TKGEsdGhpcy5nbWxucyxcImNvb3JkaW5hdGVzXCIpLGM9YT1udWxsOzA8Yi5sZW5ndGgmJihiPWJbMF0uZmlyc3RDaGlsZC5ub2RlVmFsdWUsXG5iPWIuc3BsaXQoXCIgXCIpLDI9PWIubGVuZ3RoJiYoYT1iWzBdLnNwbGl0KFwiLFwiKSxjPWJbMV0uc3BsaXQoXCIsXCIpKSk7aWYobnVsbCE9PWEmJm51bGwhPT1jKXJldHVybiBuZXcgT3BlbkxheWVycy5Cb3VuZHMocGFyc2VGbG9hdChhWzBdKSxwYXJzZUZsb2F0KGFbMV0pLHBhcnNlRmxvYXQoY1swXSkscGFyc2VGbG9hdChjWzFdKSl9fSxwYXJzZUF0dHJpYnV0ZXM6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPXt9LGE9YS5maXJzdENoaWxkLGMsZCxlO2E7KXtpZigxPT1hLm5vZGVUeXBlKXthPWEuY2hpbGROb2Rlcztmb3IoYz0wO2M8YS5sZW5ndGg7KytjKWlmKGQ9YVtjXSwxPT1kLm5vZGVUeXBlKWlmKGU9ZC5jaGlsZE5vZGVzLDE9PWUubGVuZ3RoKXtpZihlPWVbMF0sMz09ZS5ub2RlVHlwZXx8ND09ZS5ub2RlVHlwZSlkPWQucHJlZml4P2Qubm9kZU5hbWUuc3BsaXQoXCI6XCIpWzFdOmQubm9kZU5hbWUsZT1lLm5vZGVWYWx1ZS5yZXBsYWNlKHRoaXMucmVnRXhlcy50cmltU3BhY2UsXCJcIiksXG5iW2RdPWV9ZWxzZSBiW2Qubm9kZU5hbWUuc3BsaXQoXCI6XCIpLnBvcCgpXT1udWxsO2JyZWFrfWE9YS5uZXh0U2libGluZ31yZXR1cm4gYn0sd3JpdGU6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5VdGlsLmlzQXJyYXkoYSl8fChhPVthXSk7Zm9yKHZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TKFwiaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC93ZnNcIixcIndmczpcIit0aGlzLmNvbGxlY3Rpb25OYW1lKSxjPTA7YzxhLmxlbmd0aDtjKyspYi5hcHBlbmRDaGlsZCh0aGlzLmNyZWF0ZUZlYXR1cmVYTUwoYVtjXSkpO3JldHVybiBPcGVuTGF5ZXJzLkZvcm1hdC5YTUwucHJvdG90eXBlLndyaXRlLmFwcGx5KHRoaXMsW2JdKX0sY3JlYXRlRmVhdHVyZVhNTDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmJ1aWxkR2VvbWV0cnlOb2RlKGEuZ2VvbWV0cnkpLGM9dGhpcy5jcmVhdGVFbGVtZW50TlModGhpcy5mZWF0dXJlTlMsdGhpcy5mZWF0dXJlUHJlZml4K1wiOlwiK3RoaXMuZ2VvbWV0cnlOYW1lKTtjLmFwcGVuZENoaWxkKGIpO1xudmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlModGhpcy5nbWxucyxcImdtbDpcIit0aGlzLmZlYXR1cmVOYW1lKSxkPXRoaXMuY3JlYXRlRWxlbWVudE5TKHRoaXMuZmVhdHVyZU5TLHRoaXMuZmVhdHVyZVByZWZpeCtcIjpcIit0aGlzLmxheWVyTmFtZSk7ZC5zZXRBdHRyaWJ1dGUoXCJmaWRcIixhLmZpZHx8YS5pZCk7ZC5hcHBlbmRDaGlsZChjKTtmb3IodmFyIGUgaW4gYS5hdHRyaWJ1dGVzKXt2YXIgYz10aGlzLmNyZWF0ZVRleHROb2RlKGEuYXR0cmlidXRlc1tlXSksZj10aGlzLmNyZWF0ZUVsZW1lbnROUyh0aGlzLmZlYXR1cmVOUyx0aGlzLmZlYXR1cmVQcmVmaXgrXCI6XCIrZS5zdWJzdHJpbmcoZS5sYXN0SW5kZXhPZihcIjpcIikrMSkpO2YuYXBwZW5kQ2hpbGQoYyk7ZC5hcHBlbmRDaGlsZChmKX1iLmFwcGVuZENoaWxkKGQpO3JldHVybiBifSxidWlsZEdlb21ldHJ5Tm9kZTpmdW5jdGlvbihhKXt0aGlzLmV4dGVybmFsUHJvamVjdGlvbiYmdGhpcy5pbnRlcm5hbFByb2plY3Rpb24mJihhPVxuYS5jbG9uZSgpLGEudHJhbnNmb3JtKHRoaXMuaW50ZXJuYWxQcm9qZWN0aW9uLHRoaXMuZXh0ZXJuYWxQcm9qZWN0aW9uKSk7dmFyIGI9YS5DTEFTU19OQU1FO3JldHVybiB0aGlzLmJ1aWxkR2VvbWV0cnlbYi5zdWJzdHJpbmcoYi5sYXN0SW5kZXhPZihcIi5cIikrMSkudG9Mb3dlckNhc2UoKV0uYXBwbHkodGhpcyxbYV0pfSxidWlsZEdlb21ldHJ5Ontwb2ludDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROUyh0aGlzLmdtbG5zLFwiZ21sOlBvaW50XCIpO2IuYXBwZW5kQ2hpbGQodGhpcy5idWlsZENvb3JkaW5hdGVzTm9kZShhKSk7cmV0dXJuIGJ9LG11bHRpcG9pbnQ6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TKHRoaXMuZ21sbnMsXCJnbWw6TXVsdGlQb2ludFwiKSxhPWEuY29tcG9uZW50cyxjLGQsZT0wO2U8YS5sZW5ndGg7ZSsrKWM9dGhpcy5jcmVhdGVFbGVtZW50TlModGhpcy5nbWxucyxcImdtbDpwb2ludE1lbWJlclwiKSxkPXRoaXMuYnVpbGRHZW9tZXRyeS5wb2ludC5hcHBseSh0aGlzLFxuW2FbZV1dKSxjLmFwcGVuZENoaWxkKGQpLGIuYXBwZW5kQ2hpbGQoYyk7cmV0dXJuIGJ9LGxpbmVzdHJpbmc6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlModGhpcy5nbWxucyxcImdtbDpMaW5lU3RyaW5nXCIpO2IuYXBwZW5kQ2hpbGQodGhpcy5idWlsZENvb3JkaW5hdGVzTm9kZShhKSk7cmV0dXJuIGJ9LG11bHRpbGluZXN0cmluZzpmdW5jdGlvbihhKXtmb3IodmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlModGhpcy5nbWxucyxcImdtbDpNdWx0aUxpbmVTdHJpbmdcIiksYT1hLmNvbXBvbmVudHMsYyxkLGU9MDtlPGEubGVuZ3RoOysrZSljPXRoaXMuY3JlYXRlRWxlbWVudE5TKHRoaXMuZ21sbnMsXCJnbWw6bGluZVN0cmluZ01lbWJlclwiKSxkPXRoaXMuYnVpbGRHZW9tZXRyeS5saW5lc3RyaW5nLmFwcGx5KHRoaXMsW2FbZV1dKSxjLmFwcGVuZENoaWxkKGQpLGIuYXBwZW5kQ2hpbGQoYyk7cmV0dXJuIGJ9LGxpbmVhcnJpbmc6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlModGhpcy5nbWxucyxcblwiZ21sOkxpbmVhclJpbmdcIik7Yi5hcHBlbmRDaGlsZCh0aGlzLmJ1aWxkQ29vcmRpbmF0ZXNOb2RlKGEpKTtyZXR1cm4gYn0scG9seWdvbjpmdW5jdGlvbihhKXtmb3IodmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlModGhpcy5nbWxucyxcImdtbDpQb2x5Z29uXCIpLGE9YS5jb21wb25lbnRzLGMsZCxlPTA7ZTxhLmxlbmd0aDsrK2UpYz0wPT1lP1wib3V0ZXJCb3VuZGFyeUlzXCI6XCJpbm5lckJvdW5kYXJ5SXNcIixjPXRoaXMuY3JlYXRlRWxlbWVudE5TKHRoaXMuZ21sbnMsXCJnbWw6XCIrYyksZD10aGlzLmJ1aWxkR2VvbWV0cnkubGluZWFycmluZy5hcHBseSh0aGlzLFthW2VdXSksYy5hcHBlbmRDaGlsZChkKSxiLmFwcGVuZENoaWxkKGMpO3JldHVybiBifSxtdWx0aXBvbHlnb246ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TKHRoaXMuZ21sbnMsXCJnbWw6TXVsdGlQb2x5Z29uXCIpLGE9YS5jb21wb25lbnRzLGMsZCxlPTA7ZTxhLmxlbmd0aDsrK2UpYz10aGlzLmNyZWF0ZUVsZW1lbnROUyh0aGlzLmdtbG5zLFxuXCJnbWw6cG9seWdvbk1lbWJlclwiKSxkPXRoaXMuYnVpbGRHZW9tZXRyeS5wb2x5Z29uLmFwcGx5KHRoaXMsW2FbZV1dKSxjLmFwcGVuZENoaWxkKGQpLGIuYXBwZW5kQ2hpbGQoYyk7cmV0dXJuIGJ9LGJvdW5kczpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROUyh0aGlzLmdtbG5zLFwiZ21sOkJveFwiKTtiLmFwcGVuZENoaWxkKHRoaXMuYnVpbGRDb29yZGluYXRlc05vZGUoYSkpO3JldHVybiBifX0sYnVpbGRDb29yZGluYXRlc05vZGU6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlModGhpcy5nbWxucyxcImdtbDpjb29yZGluYXRlc1wiKTtiLnNldEF0dHJpYnV0ZShcImRlY2ltYWxcIixcIi5cIik7Yi5zZXRBdHRyaWJ1dGUoXCJjc1wiLFwiLFwiKTtiLnNldEF0dHJpYnV0ZShcInRzXCIsXCIgXCIpO3ZhciBjPVtdO2lmKGEgaW5zdGFuY2VvZiBPcGVuTGF5ZXJzLkJvdW5kcyljLnB1c2goYS5sZWZ0K1wiLFwiK2EuYm90dG9tKSxjLnB1c2goYS5yaWdodCtcIixcIithLnRvcCk7XG5lbHNlIGZvcih2YXIgYT1hLmNvbXBvbmVudHM/YS5jb21wb25lbnRzOlthXSxkPTA7ZDxhLmxlbmd0aDtkKyspYy5wdXNoKGFbZF0ueCtcIixcIithW2RdLnkpO2M9dGhpcy5jcmVhdGVUZXh0Tm9kZShjLmpvaW4oXCIgXCIpKTtiLmFwcGVuZENoaWxkKGMpO3JldHVybiBifSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Gb3JtYXQuR01MXCJ9KTtPcGVuTGF5ZXJzLkZvcm1hdC5HTUx8fChPcGVuTGF5ZXJzLkZvcm1hdC5HTUw9e30pO1xuT3BlbkxheWVycy5Gb3JtYXQuR01MLkJhc2U9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkZvcm1hdC5YTUwse25hbWVzcGFjZXM6e2dtbDpcImh0dHA6Ly93d3cub3Blbmdpcy5uZXQvZ21sXCIseGxpbms6XCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rXCIseHNpOlwiaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEtaW5zdGFuY2VcIix3ZnM6XCJodHRwOi8vd3d3Lm9wZW5naXMubmV0L3dmc1wifSxkZWZhdWx0UHJlZml4OlwiZ21sXCIsc2NoZW1hTG9jYXRpb246bnVsbCxmZWF0dXJlVHlwZTpudWxsLGZlYXR1cmVOUzpudWxsLGdlb21ldHJ5TmFtZTpcImdlb21ldHJ5XCIsZXh0cmFjdEF0dHJpYnV0ZXM6ITAsc3JzTmFtZTpudWxsLHh5OiEwLGdlb21ldHJ5VHlwZXM6bnVsbCxzaW5nbGVGZWF0dXJlVHlwZTpudWxsLHJlZ0V4ZXM6e3RyaW1TcGFjZTovXlxccyp8XFxzKiQvZyxyZW1vdmVTcGFjZTovXFxzKi9nLHNwbGl0U3BhY2U6L1xccysvLHRyaW1Db21tYTovXFxzKixcXHMqL2csZmVhdHVyZU1lbWJlcjovXiguKjopP2ZlYXR1cmVNZW1iZXJzPyQvfSxcbmluaXRpYWxpemU6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5Gb3JtYXQuWE1MLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsW2FdKTt0aGlzLnNldEdlb21ldHJ5VHlwZXMoKTthJiZhLmZlYXR1cmVOUyYmdGhpcy5zZXROYW1lc3BhY2UoXCJmZWF0dXJlXCIsYS5mZWF0dXJlTlMpO3RoaXMuc2luZ2xlRmVhdHVyZVR5cGU9IWF8fHR5cGVvZiBhLmZlYXR1cmVUeXBlPT09XCJzdHJpbmdcIn0scmVhZDpmdW5jdGlvbihhKXt0eXBlb2YgYT09XCJzdHJpbmdcIiYmKGE9T3BlbkxheWVycy5Gb3JtYXQuWE1MLnByb3RvdHlwZS5yZWFkLmFwcGx5KHRoaXMsW2FdKSk7aWYoYSYmYS5ub2RlVHlwZT09OSlhPWEuZG9jdW1lbnRFbGVtZW50O3ZhciBiPVtdO3RoaXMucmVhZE5vZGUoYSx7ZmVhdHVyZXM6Yn0sdHJ1ZSk7aWYoYi5sZW5ndGg9PTApe3ZhciBjPXRoaXMuZ2V0RWxlbWVudHNCeVRhZ05hbWVOUyhhLHRoaXMubmFtZXNwYWNlcy5nbWwsXCJmZWF0dXJlTWVtYmVyXCIpO2lmKGMubGVuZ3RoKWZvcih2YXIgYT1cbjAsZD1jLmxlbmd0aDthPGQ7KythKXRoaXMucmVhZE5vZGUoY1thXSx7ZmVhdHVyZXM6Yn0sdHJ1ZSk7ZWxzZXtjPXRoaXMuZ2V0RWxlbWVudHNCeVRhZ05hbWVOUyhhLHRoaXMubmFtZXNwYWNlcy5nbWwsXCJmZWF0dXJlTWVtYmVyc1wiKTtjLmxlbmd0aCYmdGhpcy5yZWFkTm9kZShjWzBdLHtmZWF0dXJlczpifSx0cnVlKX19cmV0dXJuIGJ9LHJlYWROb2RlOmZ1bmN0aW9uKGEsYixjKXtpZihjPT09dHJ1ZSYmdGhpcy5hdXRvQ29uZmlnPT09dHJ1ZSl7dGhpcy5mZWF0dXJlVHlwZT1udWxsO2RlbGV0ZSB0aGlzLm5hbWVzcGFjZUFsaWFzW3RoaXMuZmVhdHVyZU5TXTtkZWxldGUgdGhpcy5uYW1lc3BhY2VzLmZlYXR1cmU7dGhpcy5mZWF0dXJlTlM9bnVsbH1pZighdGhpcy5mZWF0dXJlTlMmJiEoYS5wcmVmaXggaW4gdGhpcy5uYW1lc3BhY2VzKSYmYS5wYXJlbnROb2RlLm5hbWVzcGFjZVVSST09dGhpcy5uYW1lc3BhY2VzLmdtbCYmdGhpcy5yZWdFeGVzLmZlYXR1cmVNZW1iZXIudGVzdChhLnBhcmVudE5vZGUubm9kZU5hbWUpKXt0aGlzLmZlYXR1cmVUeXBlPVxuYS5ub2RlTmFtZS5zcGxpdChcIjpcIikucG9wKCk7dGhpcy5zZXROYW1lc3BhY2UoXCJmZWF0dXJlXCIsYS5uYW1lc3BhY2VVUkkpO3RoaXMuZmVhdHVyZU5TPWEubmFtZXNwYWNlVVJJO3RoaXMuYXV0b0NvbmZpZz10cnVlfXJldHVybiBPcGVuTGF5ZXJzLkZvcm1hdC5YTUwucHJvdG90eXBlLnJlYWROb2RlLmFwcGx5KHRoaXMsW2EsYl0pfSxyZWFkZXJzOntnbWw6e2ZlYXR1cmVNZW1iZXI6ZnVuY3Rpb24oYSxiKXt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYil9LGZlYXR1cmVNZW1iZXJzOmZ1bmN0aW9uKGEsYil7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIpfSxuYW1lOmZ1bmN0aW9uKGEsYil7Yi5uYW1lPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKX0sYm91bmRlZEJ5OmZ1bmN0aW9uKGEsYil7dmFyIGM9e307dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpO2lmKGMuY29tcG9uZW50cyYmYy5jb21wb25lbnRzLmxlbmd0aD4wKWIuYm91bmRzPWMuY29tcG9uZW50c1swXX0sUG9pbnQ6ZnVuY3Rpb24oYSxcbmIpe3ZhciBjPXtwb2ludHM6W119O3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKTtpZighYi5jb21wb25lbnRzKWIuY29tcG9uZW50cz1bXTtiLmNvbXBvbmVudHMucHVzaChjLnBvaW50c1swXSl9LGNvb3JkaW5hdGVzOmZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKS5yZXBsYWNlKHRoaXMucmVnRXhlcy50cmltU3BhY2UsXCJcIiksYz1jLnJlcGxhY2UodGhpcy5yZWdFeGVzLnRyaW1Db21tYSxcIixcIiksYz1jLnNwbGl0KHRoaXMucmVnRXhlcy5zcGxpdFNwYWNlKSxkLGU9Yy5sZW5ndGgsZj1BcnJheShlKSxnPTA7ZzxlOysrZyl7ZD1jW2ddLnNwbGl0KFwiLFwiKTtmW2ddPXRoaXMueHk/bmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQoZFswXSxkWzFdLGRbMl0pOm5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGRbMV0sZFswXSxkWzJdKX1iLnBvaW50cz1mfSxjb29yZDpmdW5jdGlvbihhLGIpe3ZhciBjPXt9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxcbmMpO2lmKCFiLnBvaW50cyliLnBvaW50cz1bXTtiLnBvaW50cy5wdXNoKG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGMueCxjLnksYy56KSl9LFg6ZnVuY3Rpb24oYSxiKXtiLng9dGhpcy5nZXRDaGlsZFZhbHVlKGEpfSxZOmZ1bmN0aW9uKGEsYil7Yi55PXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKX0sWjpmdW5jdGlvbihhLGIpe2Iuej10aGlzLmdldENoaWxkVmFsdWUoYSl9LE11bHRpUG9pbnQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz17Y29tcG9uZW50czpbXX07dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpO2IuY29tcG9uZW50cz1bbmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuTXVsdGlQb2ludChjLmNvbXBvbmVudHMpXX0scG9pbnRNZW1iZXI6ZnVuY3Rpb24oYSxiKXt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYil9LExpbmVTdHJpbmc6ZnVuY3Rpb24oYSxiKXt2YXIgYz17fTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYyk7aWYoIWIuY29tcG9uZW50cyliLmNvbXBvbmVudHM9W107Yi5jb21wb25lbnRzLnB1c2gobmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuTGluZVN0cmluZyhjLnBvaW50cykpfSxcbk11bHRpTGluZVN0cmluZzpmdW5jdGlvbihhLGIpe3ZhciBjPXtjb21wb25lbnRzOltdfTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYyk7Yi5jb21wb25lbnRzPVtuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5NdWx0aUxpbmVTdHJpbmcoYy5jb21wb25lbnRzKV19LGxpbmVTdHJpbmdNZW1iZXI6ZnVuY3Rpb24oYSxiKXt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYil9LFBvbHlnb246ZnVuY3Rpb24oYSxiKXt2YXIgYz17b3V0ZXI6bnVsbCxpbm5lcjpbXX07dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpO2MuaW5uZXIudW5zaGlmdChjLm91dGVyKTtpZighYi5jb21wb25lbnRzKWIuY29tcG9uZW50cz1bXTtiLmNvbXBvbmVudHMucHVzaChuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2x5Z29uKGMuaW5uZXIpKX0sTGluZWFyUmluZzpmdW5jdGlvbihhLGIpe3ZhciBjPXt9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKTtiLmNvbXBvbmVudHM9W25ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVhclJpbmcoYy5wb2ludHMpXX0sXG5NdWx0aVBvbHlnb246ZnVuY3Rpb24oYSxiKXt2YXIgYz17Y29tcG9uZW50czpbXX07dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpO2IuY29tcG9uZW50cz1bbmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuTXVsdGlQb2x5Z29uKGMuY29tcG9uZW50cyldfSxwb2x5Z29uTWVtYmVyOmZ1bmN0aW9uKGEsYil7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIpfSxHZW9tZXRyeUNvbGxlY3Rpb246ZnVuY3Rpb24oYSxiKXt2YXIgYz17Y29tcG9uZW50czpbXX07dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpO2IuY29tcG9uZW50cz1bbmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuQ29sbGVjdGlvbihjLmNvbXBvbmVudHMpXX0sZ2VvbWV0cnlNZW1iZXI6ZnVuY3Rpb24oYSxiKXt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYil9fSxmZWF0dXJlOntcIipcIjpmdW5jdGlvbihhLGIpe3ZhciBjLGQ9YS5sb2NhbE5hbWV8fGEubm9kZU5hbWUuc3BsaXQoXCI6XCIpLnBvcCgpO2IuZmVhdHVyZXM/IXRoaXMuc2luZ2xlRmVhdHVyZVR5cGUmJlxuT3BlbkxheWVycy5VdGlsLmluZGV4T2YodGhpcy5mZWF0dXJlVHlwZSxkKSE9PS0xP2M9XCJfdHlwZU5hbWVcIjpkPT09dGhpcy5mZWF0dXJlVHlwZSYmKGM9XCJfdHlwZU5hbWVcIik6YS5jaGlsZE5vZGVzLmxlbmd0aD09MHx8YS5jaGlsZE5vZGVzLmxlbmd0aD09MSYmYS5maXJzdENoaWxkLm5vZGVUeXBlPT0zP3RoaXMuZXh0cmFjdEF0dHJpYnV0ZXMmJihjPVwiX2F0dHJpYnV0ZVwiKTpjPVwiX2dlb21ldHJ5XCI7YyYmdGhpcy5yZWFkZXJzLmZlYXR1cmVbY10uYXBwbHkodGhpcyxbYSxiXSl9LF90eXBlTmFtZTpmdW5jdGlvbihhLGIpe3ZhciBjPXtjb21wb25lbnRzOltdLGF0dHJpYnV0ZXM6e319O3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKTtpZihjLm5hbWUpYy5hdHRyaWJ1dGVzLm5hbWU9Yy5uYW1lO3ZhciBkPW5ldyBPcGVuTGF5ZXJzLkZlYXR1cmUuVmVjdG9yKGMuY29tcG9uZW50c1swXSxjLmF0dHJpYnV0ZXMpO2lmKCF0aGlzLnNpbmdsZUZlYXR1cmVUeXBlKXtkLnR5cGU9YS5ub2RlTmFtZS5zcGxpdChcIjpcIikucG9wKCk7XG5kLm5hbWVzcGFjZT1hLm5hbWVzcGFjZVVSSX12YXIgZT1hLmdldEF0dHJpYnV0ZShcImZpZFwiKXx8dGhpcy5nZXRBdHRyaWJ1dGVOUyhhLHRoaXMubmFtZXNwYWNlcy5nbWwsXCJpZFwiKTtpZihlKWQuZmlkPWU7dGhpcy5pbnRlcm5hbFByb2plY3Rpb24mJih0aGlzLmV4dGVybmFsUHJvamVjdGlvbiYmZC5nZW9tZXRyeSkmJmQuZ2VvbWV0cnkudHJhbnNmb3JtKHRoaXMuZXh0ZXJuYWxQcm9qZWN0aW9uLHRoaXMuaW50ZXJuYWxQcm9qZWN0aW9uKTtpZihjLmJvdW5kcylkLmJvdW5kcz1jLmJvdW5kcztiLmZlYXR1cmVzLnB1c2goZCl9LF9nZW9tZXRyeTpmdW5jdGlvbihhLGIpe2lmKCF0aGlzLmdlb21ldHJ5TmFtZSl0aGlzLmdlb21ldHJ5TmFtZT1hLm5vZGVOYW1lLnNwbGl0KFwiOlwiKS5wb3AoKTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYil9LF9hdHRyaWJ1dGU6ZnVuY3Rpb24oYSxiKXt2YXIgYz1hLmxvY2FsTmFtZXx8YS5ub2RlTmFtZS5zcGxpdChcIjpcIikucG9wKCksZD10aGlzLmdldENoaWxkVmFsdWUoYSk7XG5iLmF0dHJpYnV0ZXNbY109ZH19LHdmczp7RmVhdHVyZUNvbGxlY3Rpb246ZnVuY3Rpb24oYSxiKXt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYil9fX0sd3JpdGU6ZnVuY3Rpb24oYSl7YT10aGlzLndyaXRlTm9kZShcImdtbDpcIisoT3BlbkxheWVycy5VdGlsLmlzQXJyYXkoYSk/XCJmZWF0dXJlTWVtYmVyc1wiOlwiZmVhdHVyZU1lbWJlclwiKSxhKTt0aGlzLnNldEF0dHJpYnV0ZU5TKGEsdGhpcy5uYW1lc3BhY2VzLnhzaSxcInhzaTpzY2hlbWFMb2NhdGlvblwiLHRoaXMuc2NoZW1hTG9jYXRpb24pO3JldHVybiBPcGVuTGF5ZXJzLkZvcm1hdC5YTUwucHJvdG90eXBlLndyaXRlLmFwcGx5KHRoaXMsW2FdKX0sd3JpdGVyczp7Z21sOntmZWF0dXJlTWVtYmVyOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcImdtbDpmZWF0dXJlTWVtYmVyXCIpO3RoaXMud3JpdGVOb2RlKFwiZmVhdHVyZTpfdHlwZU5hbWVcIixhLGIpO3JldHVybiBifSxNdWx0aVBvaW50OmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1cbnRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcImdtbDpNdWx0aVBvaW50XCIpLGE9YS5jb21wb25lbnRzfHxbYV0sYz0wLGQ9YS5sZW5ndGg7YzxkOysrYyl0aGlzLndyaXRlTm9kZShcInBvaW50TWVtYmVyXCIsYVtjXSxiKTtyZXR1cm4gYn0scG9pbnRNZW1iZXI6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiZ21sOnBvaW50TWVtYmVyXCIpO3RoaXMud3JpdGVOb2RlKFwiUG9pbnRcIixhLGIpO3JldHVybiBifSxNdWx0aUxpbmVTdHJpbmc6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcImdtbDpNdWx0aUxpbmVTdHJpbmdcIiksYT1hLmNvbXBvbmVudHN8fFthXSxjPTAsZD1hLmxlbmd0aDtjPGQ7KytjKXRoaXMud3JpdGVOb2RlKFwibGluZVN0cmluZ01lbWJlclwiLGFbY10sYik7cmV0dXJuIGJ9LGxpbmVTdHJpbmdNZW1iZXI6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiZ21sOmxpbmVTdHJpbmdNZW1iZXJcIik7XG50aGlzLndyaXRlTm9kZShcIkxpbmVTdHJpbmdcIixhLGIpO3JldHVybiBifSxNdWx0aVBvbHlnb246ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcImdtbDpNdWx0aVBvbHlnb25cIiksYT1hLmNvbXBvbmVudHN8fFthXSxjPTAsZD1hLmxlbmd0aDtjPGQ7KytjKXRoaXMud3JpdGVOb2RlKFwicG9seWdvbk1lbWJlclwiLGFbY10sYik7cmV0dXJuIGJ9LHBvbHlnb25NZW1iZXI6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiZ21sOnBvbHlnb25NZW1iZXJcIik7dGhpcy53cml0ZU5vZGUoXCJQb2x5Z29uXCIsYSxiKTtyZXR1cm4gYn0sR2VvbWV0cnlDb2xsZWN0aW9uOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJnbWw6R2VvbWV0cnlDb2xsZWN0aW9uXCIpLGM9MCxkPWEuY29tcG9uZW50cy5sZW5ndGg7YzxkOysrYyl0aGlzLndyaXRlTm9kZShcImdlb21ldHJ5TWVtYmVyXCIsYS5jb21wb25lbnRzW2NdLFxuYik7cmV0dXJuIGJ9LGdlb21ldHJ5TWVtYmVyOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcImdtbDpnZW9tZXRyeU1lbWJlclwiKSxhPXRoaXMud3JpdGVOb2RlKFwiZmVhdHVyZTpfZ2VvbWV0cnlcIixhKTtiLmFwcGVuZENoaWxkKGEuZmlyc3RDaGlsZCk7cmV0dXJuIGJ9fSxmZWF0dXJlOntfdHlwZU5hbWU6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiZmVhdHVyZTpcIit0aGlzLmZlYXR1cmVUeXBlLHthdHRyaWJ1dGVzOntmaWQ6YS5maWR9fSk7YS5nZW9tZXRyeSYmdGhpcy53cml0ZU5vZGUoXCJmZWF0dXJlOl9nZW9tZXRyeVwiLGEuZ2VvbWV0cnksYik7Zm9yKHZhciBjIGluIGEuYXR0cmlidXRlcyl7dmFyIGQ9YS5hdHRyaWJ1dGVzW2NdO2QhPW51bGwmJnRoaXMud3JpdGVOb2RlKFwiZmVhdHVyZTpfYXR0cmlidXRlXCIse25hbWU6Yyx2YWx1ZTpkfSxiKX1yZXR1cm4gYn0sX2dlb21ldHJ5OmZ1bmN0aW9uKGEpe3RoaXMuZXh0ZXJuYWxQcm9qZWN0aW9uJiZcbnRoaXMuaW50ZXJuYWxQcm9qZWN0aW9uJiYoYT1hLmNsb25lKCkudHJhbnNmb3JtKHRoaXMuaW50ZXJuYWxQcm9qZWN0aW9uLHRoaXMuZXh0ZXJuYWxQcm9qZWN0aW9uKSk7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiZmVhdHVyZTpcIit0aGlzLmdlb21ldHJ5TmFtZSksYT10aGlzLndyaXRlTm9kZShcImdtbDpcIit0aGlzLmdlb21ldHJ5VHlwZXNbYS5DTEFTU19OQU1FXSxhLGIpO3RoaXMuc3JzTmFtZSYmYS5zZXRBdHRyaWJ1dGUoXCJzcnNOYW1lXCIsdGhpcy5zcnNOYW1lKTtyZXR1cm4gYn0sX2F0dHJpYnV0ZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiZmVhdHVyZTpcIithLm5hbWUse3ZhbHVlOmEudmFsdWV9KX19LHdmczp7RmVhdHVyZUNvbGxlY3Rpb246ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIndmczpGZWF0dXJlQ29sbGVjdGlvblwiKSxjPTAsZD1hLmxlbmd0aDtjPGQ7KytjKXRoaXMud3JpdGVOb2RlKFwiZ21sOmZlYXR1cmVNZW1iZXJcIixcbmFbY10sYik7cmV0dXJuIGJ9fX0sc2V0R2VvbWV0cnlUeXBlczpmdW5jdGlvbigpe3RoaXMuZ2VvbWV0cnlUeXBlcz17XCJPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50XCI6XCJQb2ludFwiLFwiT3BlbkxheWVycy5HZW9tZXRyeS5NdWx0aVBvaW50XCI6XCJNdWx0aVBvaW50XCIsXCJPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVTdHJpbmdcIjpcIkxpbmVTdHJpbmdcIixcIk9wZW5MYXllcnMuR2VvbWV0cnkuTXVsdGlMaW5lU3RyaW5nXCI6XCJNdWx0aUxpbmVTdHJpbmdcIixcIk9wZW5MYXllcnMuR2VvbWV0cnkuUG9seWdvblwiOlwiUG9seWdvblwiLFwiT3BlbkxheWVycy5HZW9tZXRyeS5NdWx0aVBvbHlnb25cIjpcIk11bHRpUG9seWdvblwiLFwiT3BlbkxheWVycy5HZW9tZXRyeS5Db2xsZWN0aW9uXCI6XCJHZW9tZXRyeUNvbGxlY3Rpb25cIn19LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZvcm1hdC5HTUwuQmFzZVwifSk7T3BlbkxheWVycy5Gb3JtYXQuR01MLnYzPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Gb3JtYXQuR01MLkJhc2Use3NjaGVtYUxvY2F0aW9uOlwiaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC9nbWwgaHR0cDovL3NjaGVtYXMub3Blbmdpcy5uZXQvZ21sLzMuMS4xL3Byb2ZpbGVzL2dtbHNmUHJvZmlsZS8xLjAuMC9nbWxzZi54c2RcIixjdXJ2ZTohMSxtdWx0aUN1cnZlOiEwLHN1cmZhY2U6ITEsbXVsdGlTdXJmYWNlOiEwLGluaXRpYWxpemU6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5Gb3JtYXQuR01MLkJhc2UucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbYV0pfSxyZWFkZXJzOntnbWw6T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoe2ZlYXR1cmVNZW1iZXJzOmZ1bmN0aW9uKGEsYil7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIpfSxDdXJ2ZTpmdW5jdGlvbihhLGIpe3ZhciBjPXtwb2ludHM6W119O3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKTtiLmNvbXBvbmVudHN8fFxuKGIuY29tcG9uZW50cz1bXSk7Yi5jb21wb25lbnRzLnB1c2gobmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuTGluZVN0cmluZyhjLnBvaW50cykpfSxzZWdtZW50czpmdW5jdGlvbihhLGIpe3RoaXMucmVhZENoaWxkTm9kZXMoYSxiKX0sTGluZVN0cmluZ1NlZ21lbnQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz17fTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYyk7Yy5wb2ludHMmJkFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KGIucG9pbnRzLGMucG9pbnRzKX0scG9zOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5nZXRDaGlsZFZhbHVlKGEpLnJlcGxhY2UodGhpcy5yZWdFeGVzLnRyaW1TcGFjZSxcIlwiKS5zcGxpdCh0aGlzLnJlZ0V4ZXMuc3BsaXRTcGFjZSksYz10aGlzLnh5P25ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGNbMF0sY1sxXSxjWzJdKTpuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChjWzFdLGNbMF0sY1syXSk7Yi5wb2ludHM9W2NdfSxwb3NMaXN0OmZ1bmN0aW9uKGEsXG5iKXtmb3IodmFyIGM9dGhpcy5nZXRDaGlsZFZhbHVlKGEpLnJlcGxhY2UodGhpcy5yZWdFeGVzLnRyaW1TcGFjZSxcIlwiKS5zcGxpdCh0aGlzLnJlZ0V4ZXMuc3BsaXRTcGFjZSksZD1wYXJzZUludChhLmdldEF0dHJpYnV0ZShcImRpbWVuc2lvblwiKSl8fDIsZSxmLGcsaD1BcnJheShjLmxlbmd0aC9kKSxpPTAsaj1jLmxlbmd0aDtpPGo7aSs9ZCllPWNbaV0sZj1jW2krMV0sZz0yPT1kP3ZvaWQgMDpjW2krMl0saFtpL2RdPXRoaXMueHk/bmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQoZSxmLGcpOm5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGYsZSxnKTtiLnBvaW50cz1ofSxTdXJmYWNlOmZ1bmN0aW9uKGEsYil7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIpfSxwYXRjaGVzOmZ1bmN0aW9uKGEsYil7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIpfSxQb2x5Z29uUGF0Y2g6ZnVuY3Rpb24oYSxiKXt0aGlzLnJlYWRlcnMuZ21sLlBvbHlnb24uYXBwbHkodGhpcyxbYSxiXSl9LGV4dGVyaW9yOmZ1bmN0aW9uKGEsXG5iKXt2YXIgYz17fTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYyk7Yi5vdXRlcj1jLmNvbXBvbmVudHNbMF19LGludGVyaW9yOmZ1bmN0aW9uKGEsYil7dmFyIGM9e307dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpO2IuaW5uZXIucHVzaChjLmNvbXBvbmVudHNbMF0pfSxNdWx0aUN1cnZlOmZ1bmN0aW9uKGEsYil7dmFyIGM9e2NvbXBvbmVudHM6W119O3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKTswPGMuY29tcG9uZW50cy5sZW5ndGgmJihiLmNvbXBvbmVudHM9W25ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5Lk11bHRpTGluZVN0cmluZyhjLmNvbXBvbmVudHMpXSl9LGN1cnZlTWVtYmVyOmZ1bmN0aW9uKGEsYil7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIpfSxNdWx0aVN1cmZhY2U6ZnVuY3Rpb24oYSxiKXt2YXIgYz17Y29tcG9uZW50czpbXX07dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpOzA8Yy5jb21wb25lbnRzLmxlbmd0aCYmKGIuY29tcG9uZW50cz1bbmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuTXVsdGlQb2x5Z29uKGMuY29tcG9uZW50cyldKX0sXG5zdXJmYWNlTWVtYmVyOmZ1bmN0aW9uKGEsYil7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIpfSxzdXJmYWNlTWVtYmVyczpmdW5jdGlvbihhLGIpe3RoaXMucmVhZENoaWxkTm9kZXMoYSxiKX0scG9pbnRNZW1iZXJzOmZ1bmN0aW9uKGEsYil7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIpfSxsaW5lU3RyaW5nTWVtYmVyczpmdW5jdGlvbihhLGIpe3RoaXMucmVhZENoaWxkTm9kZXMoYSxiKX0scG9seWdvbk1lbWJlcnM6ZnVuY3Rpb24oYSxiKXt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYil9LGdlb21ldHJ5TWVtYmVyczpmdW5jdGlvbihhLGIpe3RoaXMucmVhZENoaWxkTm9kZXMoYSxiKX0sRW52ZWxvcGU6ZnVuY3Rpb24oYSxiKXt2YXIgYz17cG9pbnRzOkFycmF5KDIpfTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYyk7Yi5jb21wb25lbnRzfHwoYi5jb21wb25lbnRzPVtdKTt2YXIgZD1jLnBvaW50c1swXSxjPWMucG9pbnRzWzFdO2IuY29tcG9uZW50cy5wdXNoKG5ldyBPcGVuTGF5ZXJzLkJvdW5kcyhkLngsXG5kLnksYy54LGMueSkpfSxsb3dlckNvcm5lcjpmdW5jdGlvbihhLGIpe3ZhciBjPXt9O3RoaXMucmVhZGVycy5nbWwucG9zLmFwcGx5KHRoaXMsW2EsY10pO2IucG9pbnRzWzBdPWMucG9pbnRzWzBdfSx1cHBlckNvcm5lcjpmdW5jdGlvbihhLGIpe3ZhciBjPXt9O3RoaXMucmVhZGVycy5nbWwucG9zLmFwcGx5KHRoaXMsW2EsY10pO2IucG9pbnRzWzFdPWMucG9pbnRzWzBdfX0sT3BlbkxheWVycy5Gb3JtYXQuR01MLkJhc2UucHJvdG90eXBlLnJlYWRlcnMuZ21sKSxmZWF0dXJlOk9wZW5MYXllcnMuRm9ybWF0LkdNTC5CYXNlLnByb3RvdHlwZS5yZWFkZXJzLmZlYXR1cmUsd2ZzOk9wZW5MYXllcnMuRm9ybWF0LkdNTC5CYXNlLnByb3RvdHlwZS5yZWFkZXJzLndmc30sd3JpdGU6ZnVuY3Rpb24oYSl7YT10aGlzLndyaXRlTm9kZShcImdtbDpcIisoT3BlbkxheWVycy5VdGlsLmlzQXJyYXkoYSk/XCJmZWF0dXJlTWVtYmVyc1wiOlwiZmVhdHVyZU1lbWJlclwiKSxhKTt0aGlzLnNldEF0dHJpYnV0ZU5TKGEsXG50aGlzLm5hbWVzcGFjZXMueHNpLFwieHNpOnNjaGVtYUxvY2F0aW9uXCIsdGhpcy5zY2hlbWFMb2NhdGlvbik7cmV0dXJuIE9wZW5MYXllcnMuRm9ybWF0LlhNTC5wcm90b3R5cGUud3JpdGUuYXBwbHkodGhpcyxbYV0pfSx3cml0ZXJzOntnbWw6T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoe2ZlYXR1cmVNZW1iZXJzOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJnbWw6ZmVhdHVyZU1lbWJlcnNcIiksYz0wLGQ9YS5sZW5ndGg7YzxkOysrYyl0aGlzLndyaXRlTm9kZShcImZlYXR1cmU6X3R5cGVOYW1lXCIsYVtjXSxiKTtyZXR1cm4gYn0sUG9pbnQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiZ21sOlBvaW50XCIpO3RoaXMud3JpdGVOb2RlKFwicG9zXCIsYSxiKTtyZXR1cm4gYn0scG9zOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJnbWw6cG9zXCIse3ZhbHVlOnRoaXMueHk/YS54K1xuXCIgXCIrYS55OmEueStcIiBcIithLnh9KX0sTGluZVN0cmluZzpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJnbWw6TGluZVN0cmluZ1wiKTt0aGlzLndyaXRlTm9kZShcInBvc0xpc3RcIixhLmNvbXBvbmVudHMsYik7cmV0dXJuIGJ9LEN1cnZlOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcImdtbDpDdXJ2ZVwiKTt0aGlzLndyaXRlTm9kZShcInNlZ21lbnRzXCIsYSxiKTtyZXR1cm4gYn0sc2VnbWVudHM6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiZ21sOnNlZ21lbnRzXCIpO3RoaXMud3JpdGVOb2RlKFwiTGluZVN0cmluZ1NlZ21lbnRcIixhLGIpO3JldHVybiBifSxMaW5lU3RyaW5nU2VnbWVudDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJnbWw6TGluZVN0cmluZ1NlZ21lbnRcIik7dGhpcy53cml0ZU5vZGUoXCJwb3NMaXN0XCIsYS5jb21wb25lbnRzLGIpO3JldHVybiBifSxcbnBvc0xpc3Q6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPWEubGVuZ3RoLGM9QXJyYXkoYiksZCxlPTA7ZTxiOysrZSlkPWFbZV0sY1tlXT10aGlzLnh5P2QueCtcIiBcIitkLnk6ZC55K1wiIFwiK2QueDtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiZ21sOnBvc0xpc3RcIix7dmFsdWU6Yy5qb2luKFwiIFwiKX0pfSxTdXJmYWNlOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcImdtbDpTdXJmYWNlXCIpO3RoaXMud3JpdGVOb2RlKFwicGF0Y2hlc1wiLGEsYik7cmV0dXJuIGJ9LHBhdGNoZXM6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiZ21sOnBhdGNoZXNcIik7dGhpcy53cml0ZU5vZGUoXCJQb2x5Z29uUGF0Y2hcIixhLGIpO3JldHVybiBifSxQb2x5Z29uUGF0Y2g6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiZ21sOlBvbHlnb25QYXRjaFwiLHthdHRyaWJ1dGVzOntpbnRlcnBvbGF0aW9uOlwicGxhbmFyXCJ9fSk7XG50aGlzLndyaXRlTm9kZShcImV4dGVyaW9yXCIsYS5jb21wb25lbnRzWzBdLGIpO2Zvcih2YXIgYz0xLGQ9YS5jb21wb25lbnRzLmxlbmd0aDtjPGQ7KytjKXRoaXMud3JpdGVOb2RlKFwiaW50ZXJpb3JcIixhLmNvbXBvbmVudHNbY10sYik7cmV0dXJuIGJ9LFBvbHlnb246ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiZ21sOlBvbHlnb25cIik7dGhpcy53cml0ZU5vZGUoXCJleHRlcmlvclwiLGEuY29tcG9uZW50c1swXSxiKTtmb3IodmFyIGM9MSxkPWEuY29tcG9uZW50cy5sZW5ndGg7YzxkOysrYyl0aGlzLndyaXRlTm9kZShcImludGVyaW9yXCIsYS5jb21wb25lbnRzW2NdLGIpO3JldHVybiBifSxleHRlcmlvcjpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJnbWw6ZXh0ZXJpb3JcIik7dGhpcy53cml0ZU5vZGUoXCJMaW5lYXJSaW5nXCIsYSxiKTtyZXR1cm4gYn0saW50ZXJpb3I6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiZ21sOmludGVyaW9yXCIpO1xudGhpcy53cml0ZU5vZGUoXCJMaW5lYXJSaW5nXCIsYSxiKTtyZXR1cm4gYn0sTGluZWFyUmluZzpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJnbWw6TGluZWFyUmluZ1wiKTt0aGlzLndyaXRlTm9kZShcInBvc0xpc3RcIixhLmNvbXBvbmVudHMsYik7cmV0dXJuIGJ9LE11bHRpQ3VydmU6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcImdtbDpNdWx0aUN1cnZlXCIpLGE9YS5jb21wb25lbnRzfHxbYV0sYz0wLGQ9YS5sZW5ndGg7YzxkOysrYyl0aGlzLndyaXRlTm9kZShcImN1cnZlTWVtYmVyXCIsYVtjXSxiKTtyZXR1cm4gYn0sY3VydmVNZW1iZXI6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiZ21sOmN1cnZlTWVtYmVyXCIpO3RoaXMuY3VydmU/dGhpcy53cml0ZU5vZGUoXCJDdXJ2ZVwiLGEsYik6dGhpcy53cml0ZU5vZGUoXCJMaW5lU3RyaW5nXCIsYSxiKTtyZXR1cm4gYn0sTXVsdGlTdXJmYWNlOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1cbnRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcImdtbDpNdWx0aVN1cmZhY2VcIiksYT1hLmNvbXBvbmVudHN8fFthXSxjPTAsZD1hLmxlbmd0aDtjPGQ7KytjKXRoaXMud3JpdGVOb2RlKFwic3VyZmFjZU1lbWJlclwiLGFbY10sYik7cmV0dXJuIGJ9LHN1cmZhY2VNZW1iZXI6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiZ21sOnN1cmZhY2VNZW1iZXJcIik7dGhpcy5zdXJmYWNlP3RoaXMud3JpdGVOb2RlKFwiU3VyZmFjZVwiLGEsYik6dGhpcy53cml0ZU5vZGUoXCJQb2x5Z29uXCIsYSxiKTtyZXR1cm4gYn0sRW52ZWxvcGU6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiZ21sOkVudmVsb3BlXCIpO3RoaXMud3JpdGVOb2RlKFwibG93ZXJDb3JuZXJcIixhLGIpO3RoaXMud3JpdGVOb2RlKFwidXBwZXJDb3JuZXJcIixhLGIpO3RoaXMuc3JzTmFtZSYmYi5zZXRBdHRyaWJ1dGUoXCJzcnNOYW1lXCIsdGhpcy5zcnNOYW1lKTtyZXR1cm4gYn0sbG93ZXJDb3JuZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcImdtbDpsb3dlckNvcm5lclwiLFxue3ZhbHVlOnRoaXMueHk/YS5sZWZ0K1wiIFwiK2EuYm90dG9tOmEuYm90dG9tK1wiIFwiK2EubGVmdH0pfSx1cHBlckNvcm5lcjpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiZ21sOnVwcGVyQ29ybmVyXCIse3ZhbHVlOnRoaXMueHk/YS5yaWdodCtcIiBcIithLnRvcDphLnRvcCtcIiBcIithLnJpZ2h0fSl9fSxPcGVuTGF5ZXJzLkZvcm1hdC5HTUwuQmFzZS5wcm90b3R5cGUud3JpdGVycy5nbWwpLGZlYXR1cmU6T3BlbkxheWVycy5Gb3JtYXQuR01MLkJhc2UucHJvdG90eXBlLndyaXRlcnMuZmVhdHVyZSx3ZnM6T3BlbkxheWVycy5Gb3JtYXQuR01MLkJhc2UucHJvdG90eXBlLndyaXRlcnMud2ZzfSxzZXRHZW9tZXRyeVR5cGVzOmZ1bmN0aW9uKCl7dGhpcy5nZW9tZXRyeVR5cGVzPXtcIk9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnRcIjpcIlBvaW50XCIsXCJPcGVuTGF5ZXJzLkdlb21ldHJ5Lk11bHRpUG9pbnRcIjpcIk11bHRpUG9pbnRcIixcIk9wZW5MYXllcnMuR2VvbWV0cnkuTGluZVN0cmluZ1wiOiEwPT09XG50aGlzLmN1cnZlP1wiQ3VydmVcIjpcIkxpbmVTdHJpbmdcIixcIk9wZW5MYXllcnMuR2VvbWV0cnkuTXVsdGlMaW5lU3RyaW5nXCI6ITE9PT10aGlzLm11bHRpQ3VydmU/XCJNdWx0aUxpbmVTdHJpbmdcIjpcIk11bHRpQ3VydmVcIixcIk9wZW5MYXllcnMuR2VvbWV0cnkuUG9seWdvblwiOiEwPT09dGhpcy5zdXJmYWNlP1wiU3VyZmFjZVwiOlwiUG9seWdvblwiLFwiT3BlbkxheWVycy5HZW9tZXRyeS5NdWx0aVBvbHlnb25cIjohMT09PXRoaXMubXVsdGlTdXJmYWNlP1wiTXVsdGlQb2x5Z29uXCI6XCJNdWx0aVN1cmZhY2VcIixcIk9wZW5MYXllcnMuR2VvbWV0cnkuQ29sbGVjdGlvblwiOlwiR2VvbWV0cnlDb2xsZWN0aW9uXCJ9fSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Gb3JtYXQuR01MLnYzXCJ9KTtPcGVuTGF5ZXJzLkZvcm1hdC5GaWx0ZXIudjFfMV8wPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Gb3JtYXQuR01MLnYzLE9wZW5MYXllcnMuRm9ybWF0LkZpbHRlci52MSx7VkVSU0lPTjpcIjEuMS4wXCIsc2NoZW1hTG9jYXRpb246XCJodHRwOi8vd3d3Lm9wZW5naXMubmV0L29nYy9maWx0ZXIvMS4xLjAvZmlsdGVyLnhzZFwiLGluaXRpYWxpemU6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5Gb3JtYXQuR01MLnYzLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsW2FdKX0scmVhZGVyczp7b2djOk9wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKHtQcm9wZXJ0eUlzRXF1YWxUbzpmdW5jdGlvbihhLGIpe3ZhciBjPWEuZ2V0QXR0cmlidXRlKFwibWF0Y2hDYXNlXCIpLGM9bmV3IE9wZW5MYXllcnMuRmlsdGVyLkNvbXBhcmlzb24oe3R5cGU6T3BlbkxheWVycy5GaWx0ZXIuQ29tcGFyaXNvbi5FUVVBTF9UTyxtYXRjaENhc2U6IShcImZhbHNlXCI9PT1jfHxcIjBcIj09PWMpfSk7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLFxuYyk7Yi5maWx0ZXJzLnB1c2goYyl9LFByb3BlcnR5SXNOb3RFcXVhbFRvOmZ1bmN0aW9uKGEsYil7dmFyIGM9YS5nZXRBdHRyaWJ1dGUoXCJtYXRjaENhc2VcIiksYz1uZXcgT3BlbkxheWVycy5GaWx0ZXIuQ29tcGFyaXNvbih7dHlwZTpPcGVuTGF5ZXJzLkZpbHRlci5Db21wYXJpc29uLk5PVF9FUVVBTF9UTyxtYXRjaENhc2U6IShcImZhbHNlXCI9PT1jfHxcIjBcIj09PWMpfSk7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpO2IuZmlsdGVycy5wdXNoKGMpfSxQcm9wZXJ0eUlzTGlrZTpmdW5jdGlvbihhLGIpe3ZhciBjPW5ldyBPcGVuTGF5ZXJzLkZpbHRlci5Db21wYXJpc29uKHt0eXBlOk9wZW5MYXllcnMuRmlsdGVyLkNvbXBhcmlzb24uTElLRX0pO3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKTt2YXIgZD1hLmdldEF0dHJpYnV0ZShcIndpbGRDYXJkXCIpLGU9YS5nZXRBdHRyaWJ1dGUoXCJzaW5nbGVDaGFyXCIpLGY9YS5nZXRBdHRyaWJ1dGUoXCJlc2NhcGVDaGFyXCIpO2MudmFsdWUycmVnZXgoZCxlLFxuZik7Yi5maWx0ZXJzLnB1c2goYyl9fSxPcGVuTGF5ZXJzLkZvcm1hdC5GaWx0ZXIudjEucHJvdG90eXBlLnJlYWRlcnMub2djKSxnbWw6T3BlbkxheWVycy5Gb3JtYXQuR01MLnYzLnByb3RvdHlwZS5yZWFkZXJzLmdtbCxmZWF0dXJlOk9wZW5MYXllcnMuRm9ybWF0LkdNTC52My5wcm90b3R5cGUucmVhZGVycy5mZWF0dXJlfSx3cml0ZXJzOntvZ2M6T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoe1Byb3BlcnR5SXNFcXVhbFRvOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIm9nYzpQcm9wZXJ0eUlzRXF1YWxUb1wiLHthdHRyaWJ1dGVzOnttYXRjaENhc2U6YS5tYXRjaENhc2V9fSk7dGhpcy53cml0ZU5vZGUoXCJQcm9wZXJ0eU5hbWVcIixhLGIpO3RoaXMud3JpdGVPZ2NFeHByZXNzaW9uKGEudmFsdWUsYik7cmV0dXJuIGJ9LFByb3BlcnR5SXNOb3RFcXVhbFRvOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIm9nYzpQcm9wZXJ0eUlzTm90RXF1YWxUb1wiLFxue2F0dHJpYnV0ZXM6e21hdGNoQ2FzZTphLm1hdGNoQ2FzZX19KTt0aGlzLndyaXRlTm9kZShcIlByb3BlcnR5TmFtZVwiLGEsYik7dGhpcy53cml0ZU9nY0V4cHJlc3Npb24oYS52YWx1ZSxiKTtyZXR1cm4gYn0sUHJvcGVydHlJc0xpa2U6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwib2djOlByb3BlcnR5SXNMaWtlXCIse2F0dHJpYnV0ZXM6e21hdGNoQ2FzZTphLm1hdGNoQ2FzZSx3aWxkQ2FyZDpcIipcIixzaW5nbGVDaGFyOlwiLlwiLGVzY2FwZUNoYXI6XCIhXCJ9fSk7dGhpcy53cml0ZU5vZGUoXCJQcm9wZXJ0eU5hbWVcIixhLGIpO3RoaXMud3JpdGVOb2RlKFwiTGl0ZXJhbFwiLGEucmVnZXgydmFsdWUoKSxiKTtyZXR1cm4gYn0sQkJPWDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJvZ2M6QkJPWFwiKTthLnByb3BlcnR5JiZ0aGlzLndyaXRlTm9kZShcIlByb3BlcnR5TmFtZVwiLGEsYik7dmFyIGM9dGhpcy53cml0ZU5vZGUoXCJnbWw6RW52ZWxvcGVcIixcbmEudmFsdWUpO2EucHJvamVjdGlvbiYmYy5zZXRBdHRyaWJ1dGUoXCJzcnNOYW1lXCIsYS5wcm9qZWN0aW9uKTtiLmFwcGVuZENoaWxkKGMpO3JldHVybiBifSxTb3J0Qnk6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIm9nYzpTb3J0QnlcIiksYz0wLGQ9YS5sZW5ndGg7YzxkO2MrKyl0aGlzLndyaXRlTm9kZShcIm9nYzpTb3J0UHJvcGVydHlcIixhW2NdLGIpO3JldHVybiBifSxTb3J0UHJvcGVydHk6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwib2djOlNvcnRQcm9wZXJ0eVwiKTt0aGlzLndyaXRlTm9kZShcIm9nYzpQcm9wZXJ0eU5hbWVcIixhLGIpO3RoaXMud3JpdGVOb2RlKFwib2djOlNvcnRPcmRlclwiLFwiREVTQ1wiPT1hLm9yZGVyP1wiREVTQ1wiOlwiQVNDXCIsYik7cmV0dXJuIGJ9LFNvcnRPcmRlcjpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwib2djOlNvcnRPcmRlclwiLHt2YWx1ZTphfSl9fSxcbk9wZW5MYXllcnMuRm9ybWF0LkZpbHRlci52MS5wcm90b3R5cGUud3JpdGVycy5vZ2MpLGdtbDpPcGVuTGF5ZXJzLkZvcm1hdC5HTUwudjMucHJvdG90eXBlLndyaXRlcnMuZ21sLGZlYXR1cmU6T3BlbkxheWVycy5Gb3JtYXQuR01MLnYzLnByb3RvdHlwZS53cml0ZXJzLmZlYXR1cmV9LHdyaXRlU3BhdGlhbDpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIm9nYzpcIitiKTt0aGlzLndyaXRlTm9kZShcIlByb3BlcnR5TmFtZVwiLGEsYyk7aWYoYS52YWx1ZSBpbnN0YW5jZW9mIE9wZW5MYXllcnMuRmlsdGVyLkZ1bmN0aW9uKXRoaXMud3JpdGVOb2RlKFwiRnVuY3Rpb25cIixhLnZhbHVlLGMpO2Vsc2V7dmFyIGQ7ZD1hLnZhbHVlIGluc3RhbmNlb2YgT3BlbkxheWVycy5HZW9tZXRyeT90aGlzLndyaXRlTm9kZShcImZlYXR1cmU6X2dlb21ldHJ5XCIsYS52YWx1ZSkuZmlyc3RDaGlsZDp0aGlzLndyaXRlTm9kZShcImdtbDpFbnZlbG9wZVwiLGEudmFsdWUpO2EucHJvamVjdGlvbiYmXG5kLnNldEF0dHJpYnV0ZShcInNyc05hbWVcIixhLnByb2plY3Rpb24pO2MuYXBwZW5kQ2hpbGQoZCl9cmV0dXJuIGN9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZvcm1hdC5GaWx0ZXIudjFfMV8wXCJ9KTtPcGVuTGF5ZXJzLkZvcm1hdC5PV1NDb21tb249T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkZvcm1hdC5YTUwuVmVyc2lvbmVkT0dDLHtkZWZhdWx0VmVyc2lvbjpcIjEuMC4wXCIsZ2V0VmVyc2lvbjpmdW5jdGlvbihhKXt2YXIgYj10aGlzLnZlcnNpb247Ynx8KChhPWEuZ2V0QXR0cmlidXRlKFwieG1sbnM6b3dzXCIpKSYmXCIxLjFcIj09PWEuc3Vic3RyaW5nKGEubGFzdEluZGV4T2YoXCIvXCIpKzEpJiYoYj1cIjEuMS4wXCIpLGJ8fChiPXRoaXMuZGVmYXVsdFZlcnNpb24pKTtyZXR1cm4gYn0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuRm9ybWF0Lk9XU0NvbW1vblwifSk7T3BlbkxheWVycy5Gb3JtYXQuT1dTQ29tbW9uLnYxPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Gb3JtYXQuWE1MLHtyZWdFeGVzOnt0cmltU3BhY2U6L15cXHMqfFxccyokL2cscmVtb3ZlU3BhY2U6L1xccyovZyxzcGxpdFNwYWNlOi9cXHMrLyx0cmltQ29tbWE6L1xccyosXFxzKi9nfSxyZWFkOmZ1bmN0aW9uKGEsYil7T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoYix0aGlzLm9wdGlvbnMpO3ZhciBjPXt9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKTtyZXR1cm4gY30scmVhZGVyczp7b3dzOntFeGNlcHRpb246ZnVuY3Rpb24oYSxiKXt2YXIgYz17Y29kZTphLmdldEF0dHJpYnV0ZShcImV4Y2VwdGlvbkNvZGVcIiksbG9jYXRvcjphLmdldEF0dHJpYnV0ZShcImxvY2F0b3JcIiksdGV4dHM6W119O2IuZXhjZXB0aW9ucy5wdXNoKGMpO3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKX0sRXhjZXB0aW9uVGV4dDpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKTtiLnRleHRzLnB1c2goYyl9LFxuU2VydmljZUlkZW50aWZpY2F0aW9uOmZ1bmN0aW9uKGEsYil7Yi5zZXJ2aWNlSWRlbnRpZmljYXRpb249e307dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIuc2VydmljZUlkZW50aWZpY2F0aW9uKX0sVGl0bGU6ZnVuY3Rpb24oYSxiKXtiLnRpdGxlPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKX0sQWJzdHJhY3Q6ZnVuY3Rpb24oYSxiKXtiW1wiYWJzdHJhY3RcIl09dGhpcy5nZXRDaGlsZFZhbHVlKGEpfSxLZXl3b3JkczpmdW5jdGlvbihhLGIpe2Iua2V5d29yZHM9e307dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIua2V5d29yZHMpfSxLZXl3b3JkOmZ1bmN0aW9uKGEsYil7Ylt0aGlzLmdldENoaWxkVmFsdWUoYSldPSEwfSxTZXJ2aWNlVHlwZTpmdW5jdGlvbihhLGIpe2Iuc2VydmljZVR5cGU9e2NvZGVTcGFjZTphLmdldEF0dHJpYnV0ZShcImNvZGVTcGFjZVwiKSx2YWx1ZTp0aGlzLmdldENoaWxkVmFsdWUoYSl9fSxTZXJ2aWNlVHlwZVZlcnNpb246ZnVuY3Rpb24oYSxiKXtiLnNlcnZpY2VUeXBlVmVyc2lvbj1cbnRoaXMuZ2V0Q2hpbGRWYWx1ZShhKX0sRmVlczpmdW5jdGlvbihhLGIpe2IuZmVlcz10aGlzLmdldENoaWxkVmFsdWUoYSl9LEFjY2Vzc0NvbnN0cmFpbnRzOmZ1bmN0aW9uKGEsYil7Yi5hY2Nlc3NDb25zdHJhaW50cz10aGlzLmdldENoaWxkVmFsdWUoYSl9LFNlcnZpY2VQcm92aWRlcjpmdW5jdGlvbihhLGIpe2Iuc2VydmljZVByb3ZpZGVyPXt9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxiLnNlcnZpY2VQcm92aWRlcil9LFByb3ZpZGVyTmFtZTpmdW5jdGlvbihhLGIpe2IucHJvdmlkZXJOYW1lPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKX0sUHJvdmlkZXJTaXRlOmZ1bmN0aW9uKGEsYil7Yi5wcm92aWRlclNpdGU9dGhpcy5nZXRBdHRyaWJ1dGVOUyhhLHRoaXMubmFtZXNwYWNlcy54bGluayxcImhyZWZcIil9LFNlcnZpY2VDb250YWN0OmZ1bmN0aW9uKGEsYil7Yi5zZXJ2aWNlQ29udGFjdD17fTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYi5zZXJ2aWNlQ29udGFjdCl9LEluZGl2aWR1YWxOYW1lOmZ1bmN0aW9uKGEsXG5iKXtiLmluZGl2aWR1YWxOYW1lPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKX0sUG9zaXRpb25OYW1lOmZ1bmN0aW9uKGEsYil7Yi5wb3NpdGlvbk5hbWU9dGhpcy5nZXRDaGlsZFZhbHVlKGEpfSxDb250YWN0SW5mbzpmdW5jdGlvbihhLGIpe2IuY29udGFjdEluZm89e307dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIuY29udGFjdEluZm8pfSxQaG9uZTpmdW5jdGlvbihhLGIpe2IucGhvbmU9e307dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIucGhvbmUpfSxWb2ljZTpmdW5jdGlvbihhLGIpe2Iudm9pY2U9dGhpcy5nZXRDaGlsZFZhbHVlKGEpfSxBZGRyZXNzOmZ1bmN0aW9uKGEsYil7Yi5hZGRyZXNzPXt9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxiLmFkZHJlc3MpfSxEZWxpdmVyeVBvaW50OmZ1bmN0aW9uKGEsYil7Yi5kZWxpdmVyeVBvaW50PXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKX0sQ2l0eTpmdW5jdGlvbihhLGIpe2IuY2l0eT10aGlzLmdldENoaWxkVmFsdWUoYSl9LEFkbWluaXN0cmF0aXZlQXJlYTpmdW5jdGlvbihhLFxuYil7Yi5hZG1pbmlzdHJhdGl2ZUFyZWE9dGhpcy5nZXRDaGlsZFZhbHVlKGEpfSxQb3N0YWxDb2RlOmZ1bmN0aW9uKGEsYil7Yi5wb3N0YWxDb2RlPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKX0sQ291bnRyeTpmdW5jdGlvbihhLGIpe2IuY291bnRyeT10aGlzLmdldENoaWxkVmFsdWUoYSl9LEVsZWN0cm9uaWNNYWlsQWRkcmVzczpmdW5jdGlvbihhLGIpe2IuZWxlY3Ryb25pY01haWxBZGRyZXNzPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKX0sUm9sZTpmdW5jdGlvbihhLGIpe2Iucm9sZT10aGlzLmdldENoaWxkVmFsdWUoYSl9LE9wZXJhdGlvbnNNZXRhZGF0YTpmdW5jdGlvbihhLGIpe2Iub3BlcmF0aW9uc01ldGFkYXRhPXt9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxiLm9wZXJhdGlvbnNNZXRhZGF0YSl9LE9wZXJhdGlvbjpmdW5jdGlvbihhLGIpe3ZhciBjPWEuZ2V0QXR0cmlidXRlKFwibmFtZVwiKTtiW2NdPXt9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxiW2NdKX0sRENQOmZ1bmN0aW9uKGEsXG5iKXtiLmRjcD17fTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYi5kY3ApfSxIVFRQOmZ1bmN0aW9uKGEsYil7Yi5odHRwPXt9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxiLmh0dHApfSxHZXQ6ZnVuY3Rpb24oYSxiKXtiLmdldHx8KGIuZ2V0PVtdKTt2YXIgYz17dXJsOnRoaXMuZ2V0QXR0cmlidXRlTlMoYSx0aGlzLm5hbWVzcGFjZXMueGxpbmssXCJocmVmXCIpfTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYyk7Yi5nZXQucHVzaChjKX0sUG9zdDpmdW5jdGlvbihhLGIpe2IucG9zdHx8KGIucG9zdD1bXSk7dmFyIGM9e3VybDp0aGlzLmdldEF0dHJpYnV0ZU5TKGEsdGhpcy5uYW1lc3BhY2VzLnhsaW5rLFwiaHJlZlwiKX07dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpO2IucG9zdC5wdXNoKGMpfSxQYXJhbWV0ZXI6ZnVuY3Rpb24oYSxiKXtiLnBhcmFtZXRlcnN8fChiLnBhcmFtZXRlcnM9e30pO3ZhciBjPWEuZ2V0QXR0cmlidXRlKFwibmFtZVwiKTtiLnBhcmFtZXRlcnNbY109e307dGhpcy5yZWFkQ2hpbGROb2RlcyhhLFxuYi5wYXJhbWV0ZXJzW2NdKX0sQ29uc3RyYWludDpmdW5jdGlvbihhLGIpe2IuY29uc3RyYWludHN8fChiLmNvbnN0cmFpbnRzPXt9KTt2YXIgYz1hLmdldEF0dHJpYnV0ZShcIm5hbWVcIik7Yi5jb25zdHJhaW50c1tjXT17fTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYi5jb25zdHJhaW50c1tjXSl9LFZhbHVlOmZ1bmN0aW9uKGEsYil7Ylt0aGlzLmdldENoaWxkVmFsdWUoYSldPSEwfSxPdXRwdXRGb3JtYXQ6ZnVuY3Rpb24oYSxiKXtiLmZvcm1hdHMucHVzaCh7dmFsdWU6dGhpcy5nZXRDaGlsZFZhbHVlKGEpfSk7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIpfSxXR1M4NEJvdW5kaW5nQm94OmZ1bmN0aW9uKGEsYil7dmFyIGM9e307Yy5jcnM9YS5nZXRBdHRyaWJ1dGUoXCJjcnNcIik7Yi5Cb3VuZGluZ0JveD9iLkJvdW5kaW5nQm94LnB1c2goYyk6KGIucHJvamVjdGlvbj1jLmNycyxjPWIpO3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKX0sQm91bmRpbmdCb3g6ZnVuY3Rpb24oYSxiKXt0aGlzLnJlYWRlcnMub3dzLldHUzg0Qm91bmRpbmdCb3guYXBwbHkodGhpcyxcblthLGJdKX0sTG93ZXJDb3JuZXI6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmdldENoaWxkVmFsdWUoYSkucmVwbGFjZSh0aGlzLnJlZ0V4ZXMudHJpbVNwYWNlLFwiXCIpLGM9Yy5yZXBsYWNlKHRoaXMucmVnRXhlcy50cmltQ29tbWEsXCIsXCIpLGM9Yy5zcGxpdCh0aGlzLnJlZ0V4ZXMuc3BsaXRTcGFjZSk7Yi5sZWZ0PWNbMF07Yi5ib3R0b209Y1sxXX0sVXBwZXJDb3JuZXI6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmdldENoaWxkVmFsdWUoYSkucmVwbGFjZSh0aGlzLnJlZ0V4ZXMudHJpbVNwYWNlLFwiXCIpLGM9Yy5yZXBsYWNlKHRoaXMucmVnRXhlcy50cmltQ29tbWEsXCIsXCIpLGM9Yy5zcGxpdCh0aGlzLnJlZ0V4ZXMuc3BsaXRTcGFjZSk7Yi5yaWdodD1jWzBdO2IudG9wPWNbMV07Yi5ib3VuZHM9bmV3IE9wZW5MYXllcnMuQm91bmRzKGIubGVmdCxiLmJvdHRvbSxiLnJpZ2h0LGIudG9wKTtkZWxldGUgYi5sZWZ0O2RlbGV0ZSBiLmJvdHRvbTtkZWxldGUgYi5yaWdodDtkZWxldGUgYi50b3B9LFxuTGFuZ3VhZ2U6ZnVuY3Rpb24oYSxiKXtiLmxhbmd1YWdlPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKX19fSx3cml0ZXJzOntvd3M6e0JvdW5kaW5nQm94OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIm93czpCb3VuZGluZ0JveFwiLHthdHRyaWJ1dGVzOntjcnM6YS5wcm9qZWN0aW9ufX0pO3RoaXMud3JpdGVOb2RlKFwib3dzOkxvd2VyQ29ybmVyXCIsYSxiKTt0aGlzLndyaXRlTm9kZShcIm93czpVcHBlckNvcm5lclwiLGEsYik7cmV0dXJuIGJ9LExvd2VyQ29ybmVyOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJvd3M6TG93ZXJDb3JuZXJcIix7dmFsdWU6YS5ib3VuZHMubGVmdCtcIiBcIithLmJvdW5kcy5ib3R0b219KX0sVXBwZXJDb3JuZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIm93czpVcHBlckNvcm5lclwiLHt2YWx1ZTphLmJvdW5kcy5yaWdodCtcIiBcIithLmJvdW5kcy50b3B9KX0sSWRlbnRpZmllcjpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwib3dzOklkZW50aWZpZXJcIixcbnt2YWx1ZTphfSl9LFRpdGxlOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJvd3M6VGl0bGVcIix7dmFsdWU6YX0pfSxBYnN0cmFjdDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwib3dzOkFic3RyYWN0XCIse3ZhbHVlOmF9KX0sT3V0cHV0Rm9ybWF0OmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJvd3M6T3V0cHV0Rm9ybWF0XCIse3ZhbHVlOmF9KX19fSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Gb3JtYXQuT1dTQ29tbW9uLnYxXCJ9KTtPcGVuTGF5ZXJzLkZvcm1hdC5PV1NDb21tb24udjFfMF8wPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Gb3JtYXQuT1dTQ29tbW9uLnYxLHtuYW1lc3BhY2VzOntvd3M6XCJodHRwOi8vd3d3Lm9wZW5naXMubmV0L293c1wiLHhsaW5rOlwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGlua1wifSxyZWFkZXJzOntvd3M6T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoe0V4Y2VwdGlvblJlcG9ydDpmdW5jdGlvbihhLGIpe2Iuc3VjY2Vzcz0hMTtiLmV4Y2VwdGlvblJlcG9ydD17dmVyc2lvbjphLmdldEF0dHJpYnV0ZShcInZlcnNpb25cIiksbGFuZ3VhZ2U6YS5nZXRBdHRyaWJ1dGUoXCJsYW5ndWFnZVwiKSxleGNlcHRpb25zOltdfTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYi5leGNlcHRpb25SZXBvcnQpfX0sT3BlbkxheWVycy5Gb3JtYXQuT1dTQ29tbW9uLnYxLnByb3RvdHlwZS5yZWFkZXJzLm93cyl9LHdyaXRlcnM6e293czpPcGVuTGF5ZXJzLkZvcm1hdC5PV1NDb21tb24udjEucHJvdG90eXBlLndyaXRlcnMub3dzfSxcbkNMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZvcm1hdC5PV1NDb21tb24udjFfMF8wXCJ9KTtPcGVuTGF5ZXJzLkZvcm1hdC5XRlNULnYxXzFfMD1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuRm9ybWF0LkZpbHRlci52MV8xXzAsT3BlbkxheWVycy5Gb3JtYXQuV0ZTVC52MSx7dmVyc2lvbjpcIjEuMS4wXCIsc2NoZW1hTG9jYXRpb25zOnt3ZnM6XCJodHRwOi8vc2NoZW1hcy5vcGVuZ2lzLm5ldC93ZnMvMS4xLjAvd2ZzLnhzZFwifSxpbml0aWFsaXplOmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuRm9ybWF0LkZpbHRlci52MV8xXzAucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbYV0pO09wZW5MYXllcnMuRm9ybWF0LldGU1QudjEucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbYV0pfSxyZWFkTm9kZTpmdW5jdGlvbihhLGIpe3JldHVybiBPcGVuTGF5ZXJzLkZvcm1hdC5HTUwudjMucHJvdG90eXBlLnJlYWROb2RlLmFwcGx5KHRoaXMsW2EsYl0pfSxyZWFkZXJzOnt3ZnM6T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoe0ZlYXR1cmVDb2xsZWN0aW9uOmZ1bmN0aW9uKGEsXG5iKXtiLm51bWJlck9mRmVhdHVyZXM9cGFyc2VJbnQoYS5nZXRBdHRyaWJ1dGUoXCJudW1iZXJPZkZlYXR1cmVzXCIpKTtPcGVuTGF5ZXJzLkZvcm1hdC5XRlNULnYxLnByb3RvdHlwZS5yZWFkZXJzLndmcy5GZWF0dXJlQ29sbGVjdGlvbi5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LFRyYW5zYWN0aW9uUmVzcG9uc2U6ZnVuY3Rpb24oYSxiKXtiLmluc2VydElkcz1bXTtiLnN1Y2Nlc3M9ITE7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIpfSxUcmFuc2FjdGlvblN1bW1hcnk6ZnVuY3Rpb24oYSxiKXtiLnN1Y2Nlc3M9ITB9LEluc2VydFJlc3VsdHM6ZnVuY3Rpb24oYSxiKXt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYil9LEZlYXR1cmU6ZnVuY3Rpb24oYSxiKXt2YXIgYz17ZmlkczpbXX07dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpO2IuaW5zZXJ0SWRzLnB1c2goYy5maWRzWzBdKX19LE9wZW5MYXllcnMuRm9ybWF0LldGU1QudjEucHJvdG90eXBlLnJlYWRlcnMud2ZzKSxnbWw6T3BlbkxheWVycy5Gb3JtYXQuR01MLnYzLnByb3RvdHlwZS5yZWFkZXJzLmdtbCxcbmZlYXR1cmU6T3BlbkxheWVycy5Gb3JtYXQuR01MLnYzLnByb3RvdHlwZS5yZWFkZXJzLmZlYXR1cmUsb2djOk9wZW5MYXllcnMuRm9ybWF0LkZpbHRlci52MV8xXzAucHJvdG90eXBlLnJlYWRlcnMub2djLG93czpPcGVuTGF5ZXJzLkZvcm1hdC5PV1NDb21tb24udjFfMF8wLnByb3RvdHlwZS5yZWFkZXJzLm93c30sd3JpdGVyczp7d2ZzOk9wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKHtHZXRGZWF0dXJlOmZ1bmN0aW9uKGEpe3ZhciBiPU9wZW5MYXllcnMuRm9ybWF0LldGU1QudjEucHJvdG90eXBlLndyaXRlcnMud2ZzLkdldEZlYXR1cmUuYXBwbHkodGhpcyxhcmd1bWVudHMpO2EmJnRoaXMuc2V0QXR0cmlidXRlcyhiLHtyZXN1bHRUeXBlOmEucmVzdWx0VHlwZSxzdGFydEluZGV4OmEuc3RhcnRJbmRleCxjb3VudDphLmNvdW50fSk7cmV0dXJuIGJ9LFF1ZXJ5OmZ1bmN0aW9uKGEpe3ZhciBhPU9wZW5MYXllcnMuVXRpbC5leHRlbmQoe2ZlYXR1cmVOUzp0aGlzLmZlYXR1cmVOUyxcbmZlYXR1cmVQcmVmaXg6dGhpcy5mZWF0dXJlUHJlZml4LGZlYXR1cmVUeXBlOnRoaXMuZmVhdHVyZVR5cGUsc3JzTmFtZTp0aGlzLnNyc05hbWV9LGEpLGI9YS5mZWF0dXJlUHJlZml4LGM9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwid2ZzOlF1ZXJ5XCIse2F0dHJpYnV0ZXM6e3R5cGVOYW1lOihiP2IrXCI6XCI6XCJcIikrYS5mZWF0dXJlVHlwZSxzcnNOYW1lOmEuc3JzTmFtZX19KTthLmZlYXR1cmVOUyYmYy5zZXRBdHRyaWJ1dGUoXCJ4bWxuczpcIitiLGEuZmVhdHVyZU5TKTtpZihhLnByb3BlcnR5TmFtZXMpZm9yKHZhciBiPTAsZD1hLnByb3BlcnR5TmFtZXMubGVuZ3RoO2I8ZDtiKyspdGhpcy53cml0ZU5vZGUoXCJ3ZnM6UHJvcGVydHlOYW1lXCIse3Byb3BlcnR5OmEucHJvcGVydHlOYW1lc1tiXX0sYyk7YS5maWx0ZXImJihPcGVuTGF5ZXJzLkZvcm1hdC5XRlNULnYxXzFfMC5wcm90b3R5cGUuc2V0RmlsdGVyUHJvcGVydHkuY2FsbCh0aGlzLGEuZmlsdGVyKSx0aGlzLndyaXRlTm9kZShcIm9nYzpGaWx0ZXJcIixcbmEuZmlsdGVyLGMpKTtyZXR1cm4gY30sUHJvcGVydHlOYW1lOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJ3ZnM6UHJvcGVydHlOYW1lXCIse3ZhbHVlOmEucHJvcGVydHl9KX19LE9wZW5MYXllcnMuRm9ybWF0LldGU1QudjEucHJvdG90eXBlLndyaXRlcnMud2ZzKSxnbWw6T3BlbkxheWVycy5Gb3JtYXQuR01MLnYzLnByb3RvdHlwZS53cml0ZXJzLmdtbCxmZWF0dXJlOk9wZW5MYXllcnMuRm9ybWF0LkdNTC52My5wcm90b3R5cGUud3JpdGVycy5mZWF0dXJlLG9nYzpPcGVuTGF5ZXJzLkZvcm1hdC5GaWx0ZXIudjFfMV8wLnByb3RvdHlwZS53cml0ZXJzLm9nY30sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuRm9ybWF0LldGU1QudjFfMV8wXCJ9KTtPcGVuTGF5ZXJzLlByb3RvY29sPU9wZW5MYXllcnMuQ2xhc3Moe2Zvcm1hdDpudWxsLG9wdGlvbnM6bnVsbCxhdXRvRGVzdHJveTohMCxkZWZhdWx0RmlsdGVyOm51bGwsaW5pdGlhbGl6ZTpmdW5jdGlvbihhKXthPWF8fHt9O09wZW5MYXllcnMuVXRpbC5leHRlbmQodGhpcyxhKTt0aGlzLm9wdGlvbnM9YX0sbWVyZ2VXaXRoRGVmYXVsdEZpbHRlcjpmdW5jdGlvbihhKXtyZXR1cm4gYSYmdGhpcy5kZWZhdWx0RmlsdGVyP25ldyBPcGVuTGF5ZXJzLkZpbHRlci5Mb2dpY2FsKHt0eXBlOk9wZW5MYXllcnMuRmlsdGVyLkxvZ2ljYWwuQU5ELGZpbHRlcnM6W3RoaXMuZGVmYXVsdEZpbHRlcixhXX0pOmF8fHRoaXMuZGVmYXVsdEZpbHRlcnx8dm9pZCAwfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5mb3JtYXQ9dGhpcy5vcHRpb25zPW51bGx9LHJlYWQ6ZnVuY3Rpb24oYSl7YT1hfHx7fTthLmZpbHRlcj10aGlzLm1lcmdlV2l0aERlZmF1bHRGaWx0ZXIoYS5maWx0ZXIpfSxjcmVhdGU6ZnVuY3Rpb24oKXt9LFxudXBkYXRlOmZ1bmN0aW9uKCl7fSxcImRlbGV0ZVwiOmZ1bmN0aW9uKCl7fSxjb21taXQ6ZnVuY3Rpb24oKXt9LGFib3J0OmZ1bmN0aW9uKCl7fSxjcmVhdGVDYWxsYmFjazpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIE9wZW5MYXllcnMuRnVuY3Rpb24uYmluZChmdW5jdGlvbigpe2EuYXBwbHkodGhpcyxbYixjXSl9LHRoaXMpfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Qcm90b2NvbFwifSk7T3BlbkxheWVycy5Qcm90b2NvbC5SZXNwb25zZT1PcGVuTGF5ZXJzLkNsYXNzKHtjb2RlOm51bGwscmVxdWVzdFR5cGU6bnVsbCxsYXN0OiEwLGZlYXR1cmVzOm51bGwsZGF0YTpudWxsLHJlcUZlYXR1cmVzOm51bGwscHJpdjpudWxsLGVycm9yOm51bGwsaW5pdGlhbGl6ZTpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHRoaXMsYSl9LHN1Y2Nlc3M6ZnVuY3Rpb24oKXtyZXR1cm4gMDx0aGlzLmNvZGV9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLlByb3RvY29sLlJlc3BvbnNlXCJ9KTtcbk9wZW5MYXllcnMuUHJvdG9jb2wuUmVzcG9uc2UuU1VDQ0VTUz0xO09wZW5MYXllcnMuUHJvdG9jb2wuUmVzcG9uc2UuRkFJTFVSRT0wO09wZW5MYXllcnMuRm9ybWF0LkpTT049T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkZvcm1hdCx7aW5kZW50OlwiICAgIFwiLHNwYWNlOlwiIFwiLG5ld2xpbmU6XCJcXG5cIixsZXZlbDowLHByZXR0eTohMSxuYXRpdmVKU09OOmZ1bmN0aW9uKCl7cmV0dXJuISghd2luZG93LkpTT058fCEoXCJmdW5jdGlvblwiPT10eXBlb2YgSlNPTi5wYXJzZSYmXCJmdW5jdGlvblwiPT10eXBlb2YgSlNPTi5zdHJpbmdpZnkpKX0oKSxyZWFkOmZ1bmN0aW9uKGEsYil7dmFyIGM7aWYodGhpcy5uYXRpdmVKU09OKWM9SlNPTi5wYXJzZShhLGIpO2Vsc2UgdHJ5e2lmKC9eW1xcXSw6e31cXHNdKiQvLnRlc3QoYS5yZXBsYWNlKC9cXFxcW1wiXFxcXFxcL2JmbnJ0dV0vZyxcIkBcIikucmVwbGFjZSgvXCJbXlwiXFxcXFxcblxccl0qXCJ8dHJ1ZXxmYWxzZXxudWxsfC0/XFxkKyg/OlxcLlxcZCopPyg/OltlRV1bK1xcLV0/XFxkKyk/L2csXCJdXCIpLnJlcGxhY2UoLyg/Ol58OnwsKSg/OlxccypcXFspKy9nLFwiXCIpKSYmKGM9ZXZhbChcIihcIithK1wiKVwiKSxcImZ1bmN0aW9uXCI9PT1cbnR5cGVvZiBiKSl7dmFyIGQ9ZnVuY3Rpb24oYSxjKXtpZihjJiZcIm9iamVjdFwiPT09dHlwZW9mIGMpZm9yKHZhciBlIGluIGMpYy5oYXNPd25Qcm9wZXJ0eShlKSYmKGNbZV09ZChlLGNbZV0pKTtyZXR1cm4gYihhLGMpfTtjPWQoXCJcIixjKX19Y2F0Y2goZSl7fXRoaXMua2VlcERhdGEmJih0aGlzLmRhdGE9Yyk7cmV0dXJuIGN9LHdyaXRlOmZ1bmN0aW9uKGEsYil7dGhpcy5wcmV0dHk9ISFiO3ZhciBjPW51bGwsZD10eXBlb2YgYTtpZih0aGlzLnNlcmlhbGl6ZVtkXSl0cnl7Yz0hdGhpcy5wcmV0dHkmJnRoaXMubmF0aXZlSlNPTj9KU09OLnN0cmluZ2lmeShhKTp0aGlzLnNlcmlhbGl6ZVtkXS5hcHBseSh0aGlzLFthXSl9Y2F0Y2goZSl7T3BlbkxheWVycy5Db25zb2xlLmVycm9yKFwiVHJvdWJsZSBzZXJpYWxpemluZzogXCIrZSl9cmV0dXJuIGN9LHdyaXRlSW5kZW50OmZ1bmN0aW9uKCl7dmFyIGE9W107aWYodGhpcy5wcmV0dHkpZm9yKHZhciBiPTA7Yjx0aGlzLmxldmVsOysrYilhLnB1c2godGhpcy5pbmRlbnQpO1xucmV0dXJuIGEuam9pbihcIlwiKX0sd3JpdGVOZXdsaW5lOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHJldHR5P3RoaXMubmV3bGluZTpcIlwifSx3cml0ZVNwYWNlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHJldHR5P3RoaXMuc3BhY2U6XCJcIn0sc2VyaWFsaXplOntvYmplY3Q6ZnVuY3Rpb24oYSl7aWYobnVsbD09YSlyZXR1cm5cIm51bGxcIjtpZihhLmNvbnN0cnVjdG9yPT1EYXRlKXJldHVybiB0aGlzLnNlcmlhbGl6ZS5kYXRlLmFwcGx5KHRoaXMsW2FdKTtpZihhLmNvbnN0cnVjdG9yPT1BcnJheSlyZXR1cm4gdGhpcy5zZXJpYWxpemUuYXJyYXkuYXBwbHkodGhpcyxbYV0pO3ZhciBiPVtcIntcIl07dGhpcy5sZXZlbCs9MTt2YXIgYyxkLGUsZj0hMTtmb3IoYyBpbiBhKWEuaGFzT3duUHJvcGVydHkoYykmJihkPU9wZW5MYXllcnMuRm9ybWF0LkpTT04ucHJvdG90eXBlLndyaXRlLmFwcGx5KHRoaXMsW2MsdGhpcy5wcmV0dHldKSxlPU9wZW5MYXllcnMuRm9ybWF0LkpTT04ucHJvdG90eXBlLndyaXRlLmFwcGx5KHRoaXMsXG5bYVtjXSx0aGlzLnByZXR0eV0pLG51bGwhPWQmJm51bGwhPWUmJihmJiZiLnB1c2goXCIsXCIpLGIucHVzaCh0aGlzLndyaXRlTmV3bGluZSgpLHRoaXMud3JpdGVJbmRlbnQoKSxkLFwiOlwiLHRoaXMud3JpdGVTcGFjZSgpLGUpLGY9ITApKTt0aGlzLmxldmVsLT0xO2IucHVzaCh0aGlzLndyaXRlTmV3bGluZSgpLHRoaXMud3JpdGVJbmRlbnQoKSxcIn1cIik7cmV0dXJuIGIuam9pbihcIlwiKX0sYXJyYXk6ZnVuY3Rpb24oYSl7dmFyIGIsYz1bXCJbXCJdO3RoaXMubGV2ZWwrPTE7Zm9yKHZhciBkPTAsZT1hLmxlbmd0aDtkPGU7KytkKWI9T3BlbkxheWVycy5Gb3JtYXQuSlNPTi5wcm90b3R5cGUud3JpdGUuYXBwbHkodGhpcyxbYVtkXSx0aGlzLnByZXR0eV0pLG51bGwhPWImJigwPGQmJmMucHVzaChcIixcIiksYy5wdXNoKHRoaXMud3JpdGVOZXdsaW5lKCksdGhpcy53cml0ZUluZGVudCgpLGIpKTt0aGlzLmxldmVsLT0xO2MucHVzaCh0aGlzLndyaXRlTmV3bGluZSgpLHRoaXMud3JpdGVJbmRlbnQoKSxcblwiXVwiKTtyZXR1cm4gYy5qb2luKFwiXCIpfSxzdHJpbmc6ZnVuY3Rpb24oYSl7dmFyIGI9e1wiXFx1MDAwOFwiOlwiXFxcXGJcIixcIlxcdFwiOlwiXFxcXHRcIixcIlxcblwiOlwiXFxcXG5cIixcIlxcdTAwMGNcIjpcIlxcXFxmXCIsXCJcXHJcIjpcIlxcXFxyXCIsJ1wiJzonXFxcXFwiJyxcIlxcXFxcIjpcIlxcXFxcXFxcXCJ9O3JldHVybi9bXCJcXFxcXFx4MDAtXFx4MWZdLy50ZXN0KGEpPydcIicrYS5yZXBsYWNlKC8oW1xceDAwLVxceDFmXFxcXFwiXSkvZyxmdW5jdGlvbihhLGQpe3ZhciBlPWJbZF07aWYoZSlyZXR1cm4gZTtlPWQuY2hhckNvZGVBdCgpO3JldHVyblwiXFxcXHUwMFwiK01hdGguZmxvb3IoZS8xNikudG9TdHJpbmcoMTYpKyhlJTE2KS50b1N0cmluZygxNil9KSsnXCInOidcIicrYSsnXCInfSxudW1iZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIGlzRmluaXRlKGEpP1wiXCIrYTpcIm51bGxcIn0sXCJib29sZWFuXCI6ZnVuY3Rpb24oYSl7cmV0dXJuXCJcIithfSxkYXRlOmZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoYSl7cmV0dXJuIDEwPmE/XCIwXCIrYTphfXJldHVybidcIicrYS5nZXRGdWxsWWVhcigpK1wiLVwiK1xuYihhLmdldE1vbnRoKCkrMSkrXCItXCIrYihhLmdldERhdGUoKSkrXCJUXCIrYihhLmdldEhvdXJzKCkpK1wiOlwiK2IoYS5nZXRNaW51dGVzKCkpK1wiOlwiK2IoYS5nZXRTZWNvbmRzKCkpKydcIid9fSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Gb3JtYXQuSlNPTlwifSk7T3BlbkxheWVycy5Gb3JtYXQuR2VvSlNPTj1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuRm9ybWF0LkpTT04se2lnbm9yZUV4dHJhRGltczohMSxyZWFkOmZ1bmN0aW9uKGEsYixjKXt2YXIgYj1iP2I6XCJGZWF0dXJlQ29sbGVjdGlvblwiLGQ9bnVsbCxlPW51bGw7aWYoZT1cInN0cmluZ1wiPT10eXBlb2YgYT9PcGVuTGF5ZXJzLkZvcm1hdC5KU09OLnByb3RvdHlwZS5yZWFkLmFwcGx5KHRoaXMsW2EsY10pOmEpaWYoXCJzdHJpbmdcIiE9dHlwZW9mIGUudHlwZSlPcGVuTGF5ZXJzLkNvbnNvbGUuZXJyb3IoXCJCYWQgR2VvSlNPTiAtIG5vIHR5cGU6IFwiK2EpO2Vsc2V7aWYodGhpcy5pc1ZhbGlkVHlwZShlLGIpKXN3aXRjaChiKXtjYXNlIFwiR2VvbWV0cnlcIjp0cnl7ZD10aGlzLnBhcnNlR2VvbWV0cnkoZSl9Y2F0Y2goZil7T3BlbkxheWVycy5Db25zb2xlLmVycm9yKGYpfWJyZWFrO2Nhc2UgXCJGZWF0dXJlXCI6dHJ5e2Q9dGhpcy5wYXJzZUZlYXR1cmUoZSksZC50eXBlPVwiRmVhdHVyZVwifWNhdGNoKGcpe09wZW5MYXllcnMuQ29uc29sZS5lcnJvcihnKX1icmVhaztcbmNhc2UgXCJGZWF0dXJlQ29sbGVjdGlvblwiOnN3aXRjaChkPVtdLGUudHlwZSl7Y2FzZSBcIkZlYXR1cmVcIjp0cnl7ZC5wdXNoKHRoaXMucGFyc2VGZWF0dXJlKGUpKX1jYXRjaChoKXtkPW51bGwsT3BlbkxheWVycy5Db25zb2xlLmVycm9yKGgpfWJyZWFrO2Nhc2UgXCJGZWF0dXJlQ29sbGVjdGlvblwiOmE9MDtmb3IoYj1lLmZlYXR1cmVzLmxlbmd0aDthPGI7KythKXRyeXtkLnB1c2godGhpcy5wYXJzZUZlYXR1cmUoZS5mZWF0dXJlc1thXSkpfWNhdGNoKGkpe2Q9bnVsbCxPcGVuTGF5ZXJzLkNvbnNvbGUuZXJyb3IoaSl9YnJlYWs7ZGVmYXVsdDp0cnl7dmFyIGo9dGhpcy5wYXJzZUdlb21ldHJ5KGUpO2QucHVzaChuZXcgT3BlbkxheWVycy5GZWF0dXJlLlZlY3RvcihqKSl9Y2F0Y2goayl7ZD1udWxsLE9wZW5MYXllcnMuQ29uc29sZS5lcnJvcihrKX19fX1lbHNlIE9wZW5MYXllcnMuQ29uc29sZS5lcnJvcihcIkJhZCBKU09OOiBcIithKTtyZXR1cm4gZH0saXNWYWxpZFR5cGU6ZnVuY3Rpb24oYSxcbmIpe3ZhciBjPSExO3N3aXRjaChiKXtjYXNlIFwiR2VvbWV0cnlcIjotMT09T3BlbkxheWVycy5VdGlsLmluZGV4T2YoXCJQb2ludCBNdWx0aVBvaW50IExpbmVTdHJpbmcgTXVsdGlMaW5lU3RyaW5nIFBvbHlnb24gTXVsdGlQb2x5Z29uIEJveCBHZW9tZXRyeUNvbGxlY3Rpb25cIi5zcGxpdChcIiBcIiksYS50eXBlKT9PcGVuTGF5ZXJzLkNvbnNvbGUuZXJyb3IoXCJVbnN1cHBvcnRlZCBnZW9tZXRyeSB0eXBlOiBcIithLnR5cGUpOmM9ITA7YnJlYWs7Y2FzZSBcIkZlYXR1cmVDb2xsZWN0aW9uXCI6Yz0hMDticmVhaztkZWZhdWx0OmEudHlwZT09Yj9jPSEwOk9wZW5MYXllcnMuQ29uc29sZS5lcnJvcihcIkNhbm5vdCBjb252ZXJ0IHR5cGVzIGZyb20gXCIrYS50eXBlK1wiIHRvIFwiK2IpfXJldHVybiBjfSxwYXJzZUZlYXR1cmU6ZnVuY3Rpb24oYSl7dmFyIGIsYyxkO2M9YS5wcm9wZXJ0aWVzP2EucHJvcGVydGllczp7fTtkPWEuZ2VvbWV0cnkmJmEuZ2VvbWV0cnkuYmJveHx8YS5iYm94O3RyeXtiPXRoaXMucGFyc2VHZW9tZXRyeShhLmdlb21ldHJ5KX1jYXRjaChlKXt0aHJvdyBlO1xufWI9bmV3IE9wZW5MYXllcnMuRmVhdHVyZS5WZWN0b3IoYixjKTtkJiYoYi5ib3VuZHM9T3BlbkxheWVycy5Cb3VuZHMuZnJvbUFycmF5KGQpKTthLmlkJiYoYi5maWQ9YS5pZCk7cmV0dXJuIGJ9LHBhcnNlR2VvbWV0cnk6ZnVuY3Rpb24oYSl7aWYobnVsbD09YSlyZXR1cm4gbnVsbDt2YXIgYixjPSExO2lmKFwiR2VvbWV0cnlDb2xsZWN0aW9uXCI9PWEudHlwZSl7aWYoIU9wZW5MYXllcnMuVXRpbC5pc0FycmF5KGEuZ2VvbWV0cmllcykpdGhyb3dcIkdlb21ldHJ5Q29sbGVjdGlvbiBtdXN0IGhhdmUgZ2VvbWV0cmllcyBhcnJheTogXCIrYTtiPWEuZ2VvbWV0cmllcy5sZW5ndGg7Zm9yKHZhciBjPUFycmF5KGIpLGQ9MDtkPGI7KytkKWNbZF09dGhpcy5wYXJzZUdlb21ldHJ5LmFwcGx5KHRoaXMsW2EuZ2VvbWV0cmllc1tkXV0pO2I9bmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuQ29sbGVjdGlvbihjKTtjPSEwfWVsc2V7aWYoIU9wZW5MYXllcnMuVXRpbC5pc0FycmF5KGEuY29vcmRpbmF0ZXMpKXRocm93XCJHZW9tZXRyeSBtdXN0IGhhdmUgY29vcmRpbmF0ZXMgYXJyYXk6IFwiK1xuYTtpZighdGhpcy5wYXJzZUNvb3Jkc1thLnR5cGUudG9Mb3dlckNhc2UoKV0pdGhyb3dcIlVuc3VwcG9ydGVkIGdlb21ldHJ5IHR5cGU6IFwiK2EudHlwZTt0cnl7Yj10aGlzLnBhcnNlQ29vcmRzW2EudHlwZS50b0xvd2VyQ2FzZSgpXS5hcHBseSh0aGlzLFthLmNvb3JkaW5hdGVzXSl9Y2F0Y2goZSl7dGhyb3cgZTt9fXRoaXMuaW50ZXJuYWxQcm9qZWN0aW9uJiYodGhpcy5leHRlcm5hbFByb2plY3Rpb24mJiFjKSYmYi50cmFuc2Zvcm0odGhpcy5leHRlcm5hbFByb2plY3Rpb24sdGhpcy5pbnRlcm5hbFByb2plY3Rpb24pO3JldHVybiBifSxwYXJzZUNvb3Jkczp7cG9pbnQ6ZnVuY3Rpb24oYSl7aWYoITE9PXRoaXMuaWdub3JlRXh0cmFEaW1zJiYyIT1hLmxlbmd0aCl0aHJvd1wiT25seSAyRCBwb2ludHMgYXJlIHN1cHBvcnRlZDogXCIrYTtyZXR1cm4gbmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQoYVswXSxhWzFdKX0sbXVsdGlwb2ludDpmdW5jdGlvbihhKXtmb3IodmFyIGI9W10sXG5jPW51bGwsZD0wLGU9YS5sZW5ndGg7ZDxlOysrZCl7dHJ5e2M9dGhpcy5wYXJzZUNvb3Jkcy5wb2ludC5hcHBseSh0aGlzLFthW2RdXSl9Y2F0Y2goZil7dGhyb3cgZjt9Yi5wdXNoKGMpfXJldHVybiBuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5NdWx0aVBvaW50KGIpfSxsaW5lc3RyaW5nOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1bXSxjPW51bGwsZD0wLGU9YS5sZW5ndGg7ZDxlOysrZCl7dHJ5e2M9dGhpcy5wYXJzZUNvb3Jkcy5wb2ludC5hcHBseSh0aGlzLFthW2RdXSl9Y2F0Y2goZil7dGhyb3cgZjt9Yi5wdXNoKGMpfXJldHVybiBuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5MaW5lU3RyaW5nKGIpfSxtdWx0aWxpbmVzdHJpbmc6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPVtdLGM9bnVsbCxkPTAsZT1hLmxlbmd0aDtkPGU7KytkKXt0cnl7Yz10aGlzLnBhcnNlQ29vcmRzLmxpbmVzdHJpbmcuYXBwbHkodGhpcyxbYVtkXV0pfWNhdGNoKGYpe3Rocm93IGY7fWIucHVzaChjKX1yZXR1cm4gbmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuTXVsdGlMaW5lU3RyaW5nKGIpfSxcbnBvbHlnb246ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPVtdLGMsZCxlPTAsZj1hLmxlbmd0aDtlPGY7KytlKXt0cnl7ZD10aGlzLnBhcnNlQ29vcmRzLmxpbmVzdHJpbmcuYXBwbHkodGhpcyxbYVtlXV0pfWNhdGNoKGcpe3Rocm93IGc7fWM9bmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuTGluZWFyUmluZyhkLmNvbXBvbmVudHMpO2IucHVzaChjKX1yZXR1cm4gbmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuUG9seWdvbihiKX0sbXVsdGlwb2x5Z29uOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1bXSxjPW51bGwsZD0wLGU9YS5sZW5ndGg7ZDxlOysrZCl7dHJ5e2M9dGhpcy5wYXJzZUNvb3Jkcy5wb2x5Z29uLmFwcGx5KHRoaXMsW2FbZF1dKX1jYXRjaChmKXt0aHJvdyBmO31iLnB1c2goYyl9cmV0dXJuIG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5Lk11bHRpUG9seWdvbihiKX0sYm94OmZ1bmN0aW9uKGEpe2lmKDIhPWEubGVuZ3RoKXRocm93XCJHZW9KU09OIGJveCBjb29yZGluYXRlcyBtdXN0IGhhdmUgMiBlbGVtZW50c1wiO1xucmV0dXJuIG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvbHlnb24oW25ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVhclJpbmcoW25ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGFbMF1bMF0sYVswXVsxXSksbmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQoYVsxXVswXSxhWzBdWzFdKSxuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChhWzFdWzBdLGFbMV1bMV0pLG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGFbMF1bMF0sYVsxXVsxXSksbmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQoYVswXVswXSxhWzBdWzFdKV0pXSl9fSx3cml0ZTpmdW5jdGlvbihhLGIpe3ZhciBjPXt0eXBlOm51bGx9O2lmKE9wZW5MYXllcnMuVXRpbC5pc0FycmF5KGEpKXtjLnR5cGU9XCJGZWF0dXJlQ29sbGVjdGlvblwiO3ZhciBkPWEubGVuZ3RoO2MuZmVhdHVyZXM9QXJyYXkoZCk7Zm9yKHZhciBlPTA7ZTxkOysrZSl7dmFyIGY9YVtlXTtpZighZiBpbnN0YW5jZW9mIE9wZW5MYXllcnMuRmVhdHVyZS5WZWN0b3IpdGhyb3dcIkZlYXR1cmVDb2xsZWN0aW9uIG9ubHkgc3VwcG9ydHMgY29sbGVjdGlvbnMgb2YgZmVhdHVyZXM6IFwiK1xuZjtjLmZlYXR1cmVzW2VdPXRoaXMuZXh0cmFjdC5mZWF0dXJlLmFwcGx5KHRoaXMsW2ZdKX19ZWxzZSAwPT1hLkNMQVNTX05BTUUuaW5kZXhPZihcIk9wZW5MYXllcnMuR2VvbWV0cnlcIik/Yz10aGlzLmV4dHJhY3QuZ2VvbWV0cnkuYXBwbHkodGhpcyxbYV0pOmEgaW5zdGFuY2VvZiBPcGVuTGF5ZXJzLkZlYXR1cmUuVmVjdG9yJiYoYz10aGlzLmV4dHJhY3QuZmVhdHVyZS5hcHBseSh0aGlzLFthXSksYS5sYXllciYmYS5sYXllci5wcm9qZWN0aW9uJiYoYy5jcnM9dGhpcy5jcmVhdGVDUlNPYmplY3QoYSkpKTtyZXR1cm4gT3BlbkxheWVycy5Gb3JtYXQuSlNPTi5wcm90b3R5cGUud3JpdGUuYXBwbHkodGhpcyxbYyxiXSl9LGNyZWF0ZUNSU09iamVjdDpmdW5jdGlvbihhKXt2YXIgYT1hLmxheWVyLnByb2plY3Rpb24udG9TdHJpbmcoKSxiPXt9O2EubWF0Y2goL2Vwc2c6L2kpJiYoYT1wYXJzZUludChhLnN1YnN0cmluZyhhLmluZGV4T2YoXCI6XCIpKzEpKSxiPTQzMjY9PWE/e3R5cGU6XCJuYW1lXCIsXG5wcm9wZXJ0aWVzOntuYW1lOlwidXJuOm9nYzpkZWY6Y3JzOk9HQzoxLjM6Q1JTODRcIn19Ont0eXBlOlwibmFtZVwiLHByb3BlcnRpZXM6e25hbWU6XCJFUFNHOlwiK2F9fSk7cmV0dXJuIGJ9LGV4dHJhY3Q6e2ZlYXR1cmU6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5leHRyYWN0Lmdlb21ldHJ5LmFwcGx5KHRoaXMsW2EuZ2VvbWV0cnldKSxiPXt0eXBlOlwiRmVhdHVyZVwiLHByb3BlcnRpZXM6YS5hdHRyaWJ1dGVzLGdlb21ldHJ5OmJ9O251bGwhPWEuZmlkJiYoYi5pZD1hLmZpZCk7cmV0dXJuIGJ9LGdlb21ldHJ5OmZ1bmN0aW9uKGEpe2lmKG51bGw9PWEpcmV0dXJuIG51bGw7dGhpcy5pbnRlcm5hbFByb2plY3Rpb24mJnRoaXMuZXh0ZXJuYWxQcm9qZWN0aW9uJiYoYT1hLmNsb25lKCksYS50cmFuc2Zvcm0odGhpcy5pbnRlcm5hbFByb2plY3Rpb24sdGhpcy5leHRlcm5hbFByb2plY3Rpb24pKTt2YXIgYj1hLkNMQVNTX05BTUUuc3BsaXQoXCIuXCIpWzJdLGE9dGhpcy5leHRyYWN0W2IudG9Mb3dlckNhc2UoKV0uYXBwbHkodGhpcyxcblthXSk7cmV0dXJuXCJDb2xsZWN0aW9uXCI9PWI/e3R5cGU6XCJHZW9tZXRyeUNvbGxlY3Rpb25cIixnZW9tZXRyaWVzOmF9Ont0eXBlOmIsY29vcmRpbmF0ZXM6YX19LHBvaW50OmZ1bmN0aW9uKGEpe3JldHVyblthLngsYS55XX0sbXVsdGlwb2ludDpmdW5jdGlvbihhKXtmb3IodmFyIGI9W10sYz0wLGQ9YS5jb21wb25lbnRzLmxlbmd0aDtjPGQ7KytjKWIucHVzaCh0aGlzLmV4dHJhY3QucG9pbnQuYXBwbHkodGhpcyxbYS5jb21wb25lbnRzW2NdXSkpO3JldHVybiBifSxsaW5lc3RyaW5nOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1bXSxjPTAsZD1hLmNvbXBvbmVudHMubGVuZ3RoO2M8ZDsrK2MpYi5wdXNoKHRoaXMuZXh0cmFjdC5wb2ludC5hcHBseSh0aGlzLFthLmNvbXBvbmVudHNbY11dKSk7cmV0dXJuIGJ9LG11bHRpbGluZXN0cmluZzpmdW5jdGlvbihhKXtmb3IodmFyIGI9W10sYz0wLGQ9YS5jb21wb25lbnRzLmxlbmd0aDtjPGQ7KytjKWIucHVzaCh0aGlzLmV4dHJhY3QubGluZXN0cmluZy5hcHBseSh0aGlzLFxuW2EuY29tcG9uZW50c1tjXV0pKTtyZXR1cm4gYn0scG9seWdvbjpmdW5jdGlvbihhKXtmb3IodmFyIGI9W10sYz0wLGQ9YS5jb21wb25lbnRzLmxlbmd0aDtjPGQ7KytjKWIucHVzaCh0aGlzLmV4dHJhY3QubGluZXN0cmluZy5hcHBseSh0aGlzLFthLmNvbXBvbmVudHNbY11dKSk7cmV0dXJuIGJ9LG11bHRpcG9seWdvbjpmdW5jdGlvbihhKXtmb3IodmFyIGI9W10sYz0wLGQ9YS5jb21wb25lbnRzLmxlbmd0aDtjPGQ7KytjKWIucHVzaCh0aGlzLmV4dHJhY3QucG9seWdvbi5hcHBseSh0aGlzLFthLmNvbXBvbmVudHNbY11dKSk7cmV0dXJuIGJ9LGNvbGxlY3Rpb246ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPWEuY29tcG9uZW50cy5sZW5ndGgsYz1BcnJheShiKSxkPTA7ZDxiOysrZCljW2RdPXRoaXMuZXh0cmFjdC5nZW9tZXRyeS5hcHBseSh0aGlzLFthLmNvbXBvbmVudHNbZF1dKTtyZXR1cm4gY319LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZvcm1hdC5HZW9KU09OXCJ9KTtPcGVuTGF5ZXJzLlByb3RvY29sLlNjcmlwdD1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuUHJvdG9jb2wse3VybDpudWxsLHBhcmFtczpudWxsLGNhbGxiYWNrOm51bGwsY2FsbGJhY2tUZW1wbGF0ZTpcIk9wZW5MYXllcnMuUHJvdG9jb2wuU2NyaXB0LnJlZ2lzdHJ5LiR7aWR9XCIsY2FsbGJhY2tLZXk6XCJjYWxsYmFja1wiLGNhbGxiYWNrUHJlZml4OlwiXCIsc2NvcGU6bnVsbCxmb3JtYXQ6bnVsbCxwZW5kaW5nUmVxdWVzdHM6bnVsbCxzcnNJbkJCT1g6ITEsaW5pdGlhbGl6ZTpmdW5jdGlvbihhKXthPWF8fHt9O3RoaXMucGFyYW1zPXt9O3RoaXMucGVuZGluZ1JlcXVlc3RzPXt9O09wZW5MYXllcnMuUHJvdG9jb2wucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuZm9ybWF0fHwodGhpcy5mb3JtYXQ9bmV3IE9wZW5MYXllcnMuRm9ybWF0Lkdlb0pTT04pO2lmKCF0aGlzLmZpbHRlclRvUGFyYW1zJiZPcGVuTGF5ZXJzLkZvcm1hdC5RdWVyeVN0cmluZ0ZpbHRlcil7dmFyIGI9XG5uZXcgT3BlbkxheWVycy5Gb3JtYXQuUXVlcnlTdHJpbmdGaWx0ZXIoe3Nyc0luQkJPWDp0aGlzLnNyc0luQkJPWH0pO3RoaXMuZmlsdGVyVG9QYXJhbXM9ZnVuY3Rpb24oYSxkKXtyZXR1cm4gYi53cml0ZShhLGQpfX19LHJlYWQ6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5Qcm90b2NvbC5wcm90b3R5cGUucmVhZC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7YT1PcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyhhLHRoaXMub3B0aW9ucyk7YS5wYXJhbXM9T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoYS5wYXJhbXMsdGhpcy5vcHRpb25zLnBhcmFtcyk7YS5maWx0ZXImJnRoaXMuZmlsdGVyVG9QYXJhbXMmJihhLnBhcmFtcz10aGlzLmZpbHRlclRvUGFyYW1zKGEuZmlsdGVyLGEucGFyYW1zKSk7dmFyIGI9bmV3IE9wZW5MYXllcnMuUHJvdG9jb2wuUmVzcG9uc2Uoe3JlcXVlc3RUeXBlOlwicmVhZFwifSksYz10aGlzLmNyZWF0ZVJlcXVlc3QoYS51cmwsYS5wYXJhbXMsT3BlbkxheWVycy5GdW5jdGlvbi5iaW5kKGZ1bmN0aW9uKGMpe2IuZGF0YT1cbmM7dGhpcy5oYW5kbGVSZWFkKGIsYSl9LHRoaXMpKTtiLnByaXY9YztyZXR1cm4gYn0sY3JlYXRlUmVxdWVzdDpmdW5jdGlvbihhLGIsYyl7dmFyIGM9T3BlbkxheWVycy5Qcm90b2NvbC5TY3JpcHQucmVnaXN0ZXIoYyksZD1PcGVuTGF5ZXJzLlN0cmluZy5mb3JtYXQodGhpcy5jYWxsYmFja1RlbXBsYXRlLHtpZDpjfSksYj1PcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHt9LGIpO2JbdGhpcy5jYWxsYmFja0tleV09dGhpcy5jYWxsYmFja1ByZWZpeCtkO2E9T3BlbkxheWVycy5VdGlsLnVybEFwcGVuZChhLE9wZW5MYXllcnMuVXRpbC5nZXRQYXJhbWV0ZXJTdHJpbmcoYikpO2I9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKTtiLnR5cGU9XCJ0ZXh0L2phdmFzY3JpcHRcIjtiLnNyYz1hO2IuaWQ9XCJPcGVuTGF5ZXJzX1Byb3RvY29sX1NjcmlwdF9cIitjO3RoaXMucGVuZGluZ1JlcXVlc3RzW2IuaWRdPWI7ZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJoZWFkXCIpWzBdLmFwcGVuZENoaWxkKGIpO1xucmV0dXJuIGJ9LGRlc3Ryb3lSZXF1ZXN0OmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuUHJvdG9jb2wuU2NyaXB0LnVucmVnaXN0ZXIoYS5pZC5zcGxpdChcIl9cIikucG9wKCkpO2RlbGV0ZSB0aGlzLnBlbmRpbmdSZXF1ZXN0c1thLmlkXTthLnBhcmVudE5vZGUmJmEucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChhKX0saGFuZGxlUmVhZDpmdW5jdGlvbihhLGIpe3RoaXMuaGFuZGxlUmVzcG9uc2UoYSxiKX0saGFuZGxlUmVzcG9uc2U6ZnVuY3Rpb24oYSxiKXtiLmNhbGxiYWNrJiYoYS5kYXRhPyhhLmZlYXR1cmVzPXRoaXMucGFyc2VGZWF0dXJlcyhhLmRhdGEpLGEuY29kZT1PcGVuTGF5ZXJzLlByb3RvY29sLlJlc3BvbnNlLlNVQ0NFU1MpOmEuY29kZT1PcGVuTGF5ZXJzLlByb3RvY29sLlJlc3BvbnNlLkZBSUxVUkUsdGhpcy5kZXN0cm95UmVxdWVzdChhLnByaXYpLGIuY2FsbGJhY2suY2FsbChiLnNjb3BlLGEpKX0scGFyc2VGZWF0dXJlczpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5mb3JtYXQucmVhZChhKX0sXG5hYm9ydDpmdW5jdGlvbihhKXtpZihhKXRoaXMuZGVzdHJveVJlcXVlc3QoYS5wcml2KTtlbHNlIGZvcih2YXIgYiBpbiB0aGlzLnBlbmRpbmdSZXF1ZXN0cyl0aGlzLmRlc3Ryb3lSZXF1ZXN0KHRoaXMucGVuZGluZ1JlcXVlc3RzW2JdKX0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMuYWJvcnQoKTtkZWxldGUgdGhpcy5wYXJhbXM7ZGVsZXRlIHRoaXMuZm9ybWF0O09wZW5MYXllcnMuUHJvdG9jb2wucHJvdG90eXBlLmRlc3Ryb3kuYXBwbHkodGhpcyl9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLlByb3RvY29sLlNjcmlwdFwifSk7KGZ1bmN0aW9uKCl7dmFyIGE9T3BlbkxheWVycy5Qcm90b2NvbC5TY3JpcHQsYj0wO2EucmVnaXN0cnk9e307YS5yZWdpc3Rlcj1mdW5jdGlvbihjKXt2YXIgZD1cImNcIisgKytiO2EucmVnaXN0cnlbZF09ZnVuY3Rpb24oKXtjLmFwcGx5KHRoaXMsYXJndW1lbnRzKX07cmV0dXJuIGR9O2EudW5yZWdpc3Rlcj1mdW5jdGlvbihiKXtkZWxldGUgYS5yZWdpc3RyeVtiXX19KSgpO09wZW5MYXllcnMuQ29udHJvbC5QYW5lbD1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuQ29udHJvbCx7Y29udHJvbHM6bnVsbCxhdXRvQWN0aXZhdGU6ITAsZGVmYXVsdENvbnRyb2w6bnVsbCxzYXZlU3RhdGU6ITEsYWxsb3dEZXByZXNzOiExLGFjdGl2ZVN0YXRlOm51bGwsaW5pdGlhbGl6ZTpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbYV0pO3RoaXMuY29udHJvbHM9W107dGhpcy5hY3RpdmVTdGF0ZT17fX0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMubWFwJiZ0aGlzLm1hcC5ldmVudHMudW5yZWdpc3RlcihcImJ1dHRvbmNsaWNrXCIsdGhpcyx0aGlzLm9uQnV0dG9uQ2xpY2spO09wZW5MYXllcnMuQ29udHJvbC5wcm90b3R5cGUuZGVzdHJveS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7Zm9yKHZhciBhLGI9dGhpcy5jb250cm9scy5sZW5ndGgtMTswPD1iO2ItLSlhPXRoaXMuY29udHJvbHNbYl0sYS5ldmVudHMmJlxuYS5ldmVudHMudW4oe2FjdGl2YXRlOnRoaXMuaWNvbk9uLGRlYWN0aXZhdGU6dGhpcy5pY29uT2ZmfSksYS5wYW5lbF9kaXY9bnVsbDt0aGlzLmFjdGl2ZVN0YXRlPW51bGx9LGFjdGl2YXRlOmZ1bmN0aW9uKCl7aWYoT3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5hY3RpdmF0ZS5hcHBseSh0aGlzLGFyZ3VtZW50cykpe2Zvcih2YXIgYSxiPTAsYz10aGlzLmNvbnRyb2xzLmxlbmd0aDtiPGM7YisrKWE9dGhpcy5jb250cm9sc1tiXSwoYT09PXRoaXMuZGVmYXVsdENvbnRyb2x8fHRoaXMuc2F2ZVN0YXRlJiZ0aGlzLmFjdGl2ZVN0YXRlW2EuaWRdKSYmYS5hY3RpdmF0ZSgpOyEwPT09dGhpcy5zYXZlU3RhdGUmJih0aGlzLmRlZmF1bHRDb250cm9sPW51bGwpO3RoaXMucmVkcmF3KCk7cmV0dXJuITB9cmV0dXJuITF9LGRlYWN0aXZhdGU6ZnVuY3Rpb24oKXtpZihPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmRlYWN0aXZhdGUuYXBwbHkodGhpcyxhcmd1bWVudHMpKXtmb3IodmFyIGEsXG5iPTAsYz10aGlzLmNvbnRyb2xzLmxlbmd0aDtiPGM7YisrKWE9dGhpcy5jb250cm9sc1tiXSx0aGlzLmFjdGl2ZVN0YXRlW2EuaWRdPWEuZGVhY3RpdmF0ZSgpO3RoaXMucmVkcmF3KCk7cmV0dXJuITB9cmV0dXJuITF9LGRyYXc6ZnVuY3Rpb24oKXtPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmRyYXcuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMub3V0c2lkZVZpZXdwb3J0Pyh0aGlzLmV2ZW50cy5hdHRhY2hUb0VsZW1lbnQodGhpcy5kaXYpLHRoaXMuZXZlbnRzLnJlZ2lzdGVyKFwiYnV0dG9uY2xpY2tcIix0aGlzLHRoaXMub25CdXR0b25DbGljaykpOnRoaXMubWFwLmV2ZW50cy5yZWdpc3RlcihcImJ1dHRvbmNsaWNrXCIsdGhpcyx0aGlzLm9uQnV0dG9uQ2xpY2spO3RoaXMuYWRkQ29udHJvbHNUb01hcCh0aGlzLmNvbnRyb2xzKTtyZXR1cm4gdGhpcy5kaXZ9LHJlZHJhdzpmdW5jdGlvbigpe2Zvcih2YXIgYT10aGlzLmRpdi5jaGlsZE5vZGVzLmxlbmd0aC0xOzA8PWE7YS0tKXRoaXMuZGl2LnJlbW92ZUNoaWxkKHRoaXMuZGl2LmNoaWxkTm9kZXNbYV0pO1xudGhpcy5kaXYuaW5uZXJIVE1MPVwiXCI7aWYodGhpcy5hY3RpdmUpZm9yKHZhciBhPTAsYj10aGlzLmNvbnRyb2xzLmxlbmd0aDthPGI7YSsrKXRoaXMuZGl2LmFwcGVuZENoaWxkKHRoaXMuY29udHJvbHNbYV0ucGFuZWxfZGl2KX0sYWN0aXZhdGVDb250cm9sOmZ1bmN0aW9uKGEpe2lmKCF0aGlzLmFjdGl2ZSlyZXR1cm4hMTtpZihhLnR5cGU9PU9wZW5MYXllcnMuQ29udHJvbC5UWVBFX0JVVFRPTilhLnRyaWdnZXIoKTtlbHNlIGlmKGEudHlwZT09T3BlbkxheWVycy5Db250cm9sLlRZUEVfVE9HR0xFKWEuYWN0aXZlP2EuZGVhY3RpdmF0ZSgpOmEuYWN0aXZhdGUoKTtlbHNlIGlmKHRoaXMuYWxsb3dEZXByZXNzJiZhLmFjdGl2ZSlhLmRlYWN0aXZhdGUoKTtlbHNle2Zvcih2YXIgYixjPTAsZD10aGlzLmNvbnRyb2xzLmxlbmd0aDtjPGQ7YysrKWI9dGhpcy5jb250cm9sc1tjXSxiIT1hJiYoYi50eXBlPT09T3BlbkxheWVycy5Db250cm9sLlRZUEVfVE9PTHx8bnVsbD09Yi50eXBlKSYmXG5iLmRlYWN0aXZhdGUoKTthLmFjdGl2YXRlKCl9fSxhZGRDb250cm9sczpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLlV0aWwuaXNBcnJheShhKXx8KGE9W2FdKTt0aGlzLmNvbnRyb2xzPXRoaXMuY29udHJvbHMuY29uY2F0KGEpO2Zvcih2YXIgYj0wLGM9YS5sZW5ndGg7YjxjO2IrKyl7dmFyIGQ9YVtiXSxlPXRoaXMuY3JlYXRlQ29udHJvbE1hcmt1cChkKTtPcGVuTGF5ZXJzLkVsZW1lbnQuYWRkQ2xhc3MoZSxkLmRpc3BsYXlDbGFzcytcIkl0ZW1JbmFjdGl2ZVwiKTtPcGVuTGF5ZXJzLkVsZW1lbnQuYWRkQ2xhc3MoZSxcIm9sQnV0dG9uXCIpO1wiXCIhPWQudGl0bGUmJiFlLnRpdGxlJiYoZS50aXRsZT1kLnRpdGxlKTtkLnBhbmVsX2Rpdj1lfXRoaXMubWFwJiYodGhpcy5hZGRDb250cm9sc1RvTWFwKGEpLHRoaXMucmVkcmF3KCkpfSxjcmVhdGVDb250cm9sTWFya3VwOmZ1bmN0aW9uKCl7cmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIil9LGFkZENvbnRyb2xzVG9NYXA6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiLFxuYz0wLGQ9YS5sZW5ndGg7YzxkO2MrKyliPWFbY10sITA9PT1iLmF1dG9BY3RpdmF0ZT8oYi5hdXRvQWN0aXZhdGU9ITEsdGhpcy5tYXAuYWRkQ29udHJvbChiKSxiLmF1dG9BY3RpdmF0ZT0hMCk6KHRoaXMubWFwLmFkZENvbnRyb2woYiksYi5kZWFjdGl2YXRlKCkpLGIuZXZlbnRzLm9uKHthY3RpdmF0ZTp0aGlzLmljb25PbixkZWFjdGl2YXRlOnRoaXMuaWNvbk9mZn0pfSxpY29uT246ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnBhbmVsX2RpdjthLmNsYXNzTmFtZT1hLmNsYXNzTmFtZS5yZXBsYWNlKFJlZ0V4cChcIlxcXFxiKFwiK3RoaXMuZGlzcGxheUNsYXNzK1wiSXRlbSlJbmFjdGl2ZVxcXFxiXCIpLFwiJDFBY3RpdmVcIil9LGljb25PZmY6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnBhbmVsX2RpdjthLmNsYXNzTmFtZT1hLmNsYXNzTmFtZS5yZXBsYWNlKFJlZ0V4cChcIlxcXFxiKFwiK3RoaXMuZGlzcGxheUNsYXNzK1wiSXRlbSlBY3RpdmVcXFxcYlwiKSxcIiQxSW5hY3RpdmVcIil9LG9uQnV0dG9uQ2xpY2s6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPVxudGhpcy5jb250cm9scyxhPWEuYnV0dG9uRWxlbWVudCxjPWIubGVuZ3RoLTE7MDw9YzstLWMpaWYoYltjXS5wYW5lbF9kaXY9PT1hKXt0aGlzLmFjdGl2YXRlQ29udHJvbChiW2NdKTticmVha319LGdldENvbnRyb2xzQnk6ZnVuY3Rpb24oYSxiKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiBiLnRlc3Q7cmV0dXJuIE9wZW5MYXllcnMuQXJyYXkuZmlsdGVyKHRoaXMuY29udHJvbHMsZnVuY3Rpb24oZCl7cmV0dXJuIGRbYV09PWJ8fGMmJmIudGVzdChkW2FdKX0pfSxnZXRDb250cm9sc0J5TmFtZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5nZXRDb250cm9sc0J5KFwibmFtZVwiLGEpfSxnZXRDb250cm9sc0J5Q2xhc3M6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuZ2V0Q29udHJvbHNCeShcIkNMQVNTX05BTUVcIixhKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuQ29udHJvbC5QYW5lbFwifSk7T3BlbkxheWVycy5Db250cm9sLlpvb21Jbj1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuQ29udHJvbCx7dHlwZTpPcGVuTGF5ZXJzLkNvbnRyb2wuVFlQRV9CVVRUT04sdHJpZ2dlcjpmdW5jdGlvbigpe3RoaXMubWFwLnpvb21JbigpfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Db250cm9sLlpvb21JblwifSk7T3BlbkxheWVycy5Db250cm9sLlpvb21PdXQ9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkNvbnRyb2wse3R5cGU6T3BlbkxheWVycy5Db250cm9sLlRZUEVfQlVUVE9OLHRyaWdnZXI6ZnVuY3Rpb24oKXt0aGlzLm1hcC56b29tT3V0KCl9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkNvbnRyb2wuWm9vbU91dFwifSk7T3BlbkxheWVycy5Db250cm9sLlpvb21Ub01heEV4dGVudD1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuQ29udHJvbCx7dHlwZTpPcGVuTGF5ZXJzLkNvbnRyb2wuVFlQRV9CVVRUT04sdHJpZ2dlcjpmdW5jdGlvbigpe3RoaXMubWFwJiZ0aGlzLm1hcC56b29tVG9NYXhFeHRlbnQoKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuQ29udHJvbC5ab29tVG9NYXhFeHRlbnRcIn0pO09wZW5MYXllcnMuQ29udHJvbC5ab29tUGFuZWw9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkNvbnRyb2wuUGFuZWwse2luaXRpYWxpemU6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5Db250cm9sLlBhbmVsLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsW2FdKTt0aGlzLmFkZENvbnRyb2xzKFtuZXcgT3BlbkxheWVycy5Db250cm9sLlpvb21JbixuZXcgT3BlbkxheWVycy5Db250cm9sLlpvb21Ub01heEV4dGVudCxuZXcgT3BlbkxheWVycy5Db250cm9sLlpvb21PdXRdKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuQ29udHJvbC5ab29tUGFuZWxcIn0pO09wZW5MYXllcnMuTGF5ZXIuSFRUUFJlcXVlc3Q9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkxheWVyLHtVUkxfSEFTSF9GQUNUT1I6KE1hdGguc3FydCg1KS0xKS8yLHVybDpudWxsLHBhcmFtczpudWxsLHJlcHJvamVjdDohMSxpbml0aWFsaXplOmZ1bmN0aW9uKGEsYixjLGQpe09wZW5MYXllcnMuTGF5ZXIucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbYSxkXSk7dGhpcy51cmw9Yjt0aGlzLnBhcmFtc3x8KHRoaXMucGFyYW1zPU9wZW5MYXllcnMuVXRpbC5leHRlbmQoe30sYykpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5wYXJhbXM9dGhpcy51cmw9bnVsbDtPcGVuTGF5ZXJzLkxheWVyLnByb3RvdHlwZS5kZXN0cm95LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sY2xvbmU6ZnVuY3Rpb24oYSl7bnVsbD09YSYmKGE9bmV3IE9wZW5MYXllcnMuTGF5ZXIuSFRUUFJlcXVlc3QodGhpcy5uYW1lLHRoaXMudXJsLHRoaXMucGFyYW1zLHRoaXMuZ2V0T3B0aW9ucygpKSk7XG5yZXR1cm4gYT1PcGVuTGF5ZXJzLkxheWVyLnByb3RvdHlwZS5jbG9uZS5hcHBseSh0aGlzLFthXSl9LHNldFVybDpmdW5jdGlvbihhKXt0aGlzLnVybD1hfSxtZXJnZU5ld1BhcmFtczpmdW5jdGlvbihhKXt0aGlzLnBhcmFtcz1PcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHRoaXMucGFyYW1zLGEpO2E9dGhpcy5yZWRyYXcoKTtudWxsIT10aGlzLm1hcCYmdGhpcy5tYXAuZXZlbnRzLnRyaWdnZXJFdmVudChcImNoYW5nZWxheWVyXCIse2xheWVyOnRoaXMscHJvcGVydHk6XCJwYXJhbXNcIn0pO3JldHVybiBhfSxyZWRyYXc6ZnVuY3Rpb24oYSl7cmV0dXJuIGE/dGhpcy5tZXJnZU5ld1BhcmFtcyh7X29sU2FsdDpNYXRoLnJhbmRvbSgpfSk6T3BlbkxheWVycy5MYXllci5wcm90b3R5cGUucmVkcmF3LmFwcGx5KHRoaXMsW10pfSxzZWxlY3RVcmw6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9MSxkPTAsZT1hLmxlbmd0aDtkPGU7ZCsrKWMqPWEuY2hhckNvZGVBdChkKSp0aGlzLlVSTF9IQVNIX0ZBQ1RPUixcbmMtPU1hdGguZmxvb3IoYyk7cmV0dXJuIGJbTWF0aC5mbG9vcihjKmIubGVuZ3RoKV19LGdldEZ1bGxSZXF1ZXN0U3RyaW5nOmZ1bmN0aW9uKGEsYil7dmFyIGM9Ynx8dGhpcy51cmwsZD1PcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHt9LHRoaXMucGFyYW1zKSxkPU9wZW5MYXllcnMuVXRpbC5leHRlbmQoZCxhKSxlPU9wZW5MYXllcnMuVXRpbC5nZXRQYXJhbWV0ZXJTdHJpbmcoZCk7T3BlbkxheWVycy5VdGlsLmlzQXJyYXkoYykmJihjPXRoaXMuc2VsZWN0VXJsKGUsYykpO3ZhciBlPU9wZW5MYXllcnMuVXRpbC51cHBlckNhc2VPYmplY3QoT3BlbkxheWVycy5VdGlsLmdldFBhcmFtZXRlcnMoYykpLGY7Zm9yKGYgaW4gZClmLnRvVXBwZXJDYXNlKClpbiBlJiZkZWxldGUgZFtmXTtlPU9wZW5MYXllcnMuVXRpbC5nZXRQYXJhbWV0ZXJTdHJpbmcoZCk7cmV0dXJuIE9wZW5MYXllcnMuVXRpbC51cmxBcHBlbmQoYyxlKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuTGF5ZXIuSFRUUFJlcXVlc3RcIn0pO09wZW5MYXllcnMuVGlsZT1PcGVuTGF5ZXJzLkNsYXNzKHtldmVudHM6bnVsbCxldmVudExpc3RlbmVyczpudWxsLGlkOm51bGwsbGF5ZXI6bnVsbCx1cmw6bnVsbCxib3VuZHM6bnVsbCxzaXplOm51bGwscG9zaXRpb246bnVsbCxpc0xvYWRpbmc6ITEsaW5pdGlhbGl6ZTpmdW5jdGlvbihhLGIsYyxkLGUsZil7dGhpcy5sYXllcj1hO3RoaXMucG9zaXRpb249Yi5jbG9uZSgpO3RoaXMuc2V0Qm91bmRzKGMpO3RoaXMudXJsPWQ7ZSYmKHRoaXMuc2l6ZT1lLmNsb25lKCkpO3RoaXMuaWQ9T3BlbkxheWVycy5VdGlsLmNyZWF0ZVVuaXF1ZUlEKFwiVGlsZV9cIik7T3BlbkxheWVycy5VdGlsLmV4dGVuZCh0aGlzLGYpO3RoaXMuZXZlbnRzPW5ldyBPcGVuTGF5ZXJzLkV2ZW50cyh0aGlzKTtpZih0aGlzLmV2ZW50TGlzdGVuZXJzIGluc3RhbmNlb2YgT2JqZWN0KXRoaXMuZXZlbnRzLm9uKHRoaXMuZXZlbnRMaXN0ZW5lcnMpfSx1bmxvYWQ6ZnVuY3Rpb24oKXt0aGlzLmlzTG9hZGluZyYmKHRoaXMuaXNMb2FkaW5nPVxuITEsdGhpcy5ldmVudHMudHJpZ2dlckV2ZW50KFwidW5sb2FkXCIpKX0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMucG9zaXRpb249dGhpcy5zaXplPXRoaXMuYm91bmRzPXRoaXMubGF5ZXI9bnVsbDt0aGlzLmV2ZW50TGlzdGVuZXJzJiZ0aGlzLmV2ZW50cy51bih0aGlzLmV2ZW50TGlzdGVuZXJzKTt0aGlzLmV2ZW50cy5kZXN0cm95KCk7dGhpcy5ldmVudHM9dGhpcy5ldmVudExpc3RlbmVycz1udWxsfSxkcmF3OmZ1bmN0aW9uKGEpe2F8fHRoaXMuY2xlYXIoKTt2YXIgYj10aGlzLnNob3VsZERyYXcoKTtiJiYhYSYmKGI9ITEhPT10aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJiZWZvcmVkcmF3XCIpKTtyZXR1cm4gYn0sc2hvdWxkRHJhdzpmdW5jdGlvbigpe3ZhciBhPSExLGI9dGhpcy5sYXllci5tYXhFeHRlbnQ7aWYoYil7dmFyIGM9dGhpcy5sYXllci5tYXAsYz1jLmJhc2VMYXllci53cmFwRGF0ZUxpbmUmJmMuZ2V0TWF4RXh0ZW50KCk7dGhpcy5ib3VuZHMuaW50ZXJzZWN0c0JvdW5kcyhiLFxue2luY2x1c2l2ZTohMSx3b3JsZEJvdW5kczpjfSkmJihhPSEwKX1yZXR1cm4gYXx8dGhpcy5sYXllci5kaXNwbGF5T3V0c2lkZU1heEV4dGVudH0sc2V0Qm91bmRzOmZ1bmN0aW9uKGEpe2E9YS5jbG9uZSgpO2lmKHRoaXMubGF5ZXIubWFwLmJhc2VMYXllci53cmFwRGF0ZUxpbmUpdmFyIGI9dGhpcy5sYXllci5tYXAuZ2V0TWF4RXh0ZW50KCksYz10aGlzLmxheWVyLm1hcC5nZXRSZXNvbHV0aW9uKCksYT1hLndyYXBEYXRlTGluZShiLHtsZWZ0VG9sZXJhbmNlOmMscmlnaHRUb2xlcmFuY2U6Y30pO3RoaXMuYm91bmRzPWF9LG1vdmVUbzpmdW5jdGlvbihhLGIsYyl7bnVsbD09YyYmKGM9ITApO3RoaXMuc2V0Qm91bmRzKGEpO3RoaXMucG9zaXRpb249Yi5jbG9uZSgpO2MmJnRoaXMuZHJhdygpfSxjbGVhcjpmdW5jdGlvbigpe30sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuVGlsZVwifSk7T3BlbkxheWVycy5UaWxlLkltYWdlPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5UaWxlLHt1cmw6bnVsbCxpbWdEaXY6bnVsbCxmcmFtZTpudWxsLGltYWdlUmVsb2FkQXR0ZW1wdHM6bnVsbCxsYXllckFscGhhSGFjazpudWxsLGFzeW5jUmVxdWVzdElkOm51bGwsYmxhbmtJbWFnZVVybDpcImRhdGE6aW1hZ2UvZ2lmO2Jhc2U2NCxSMGxHT0RsaEFRQUJBSUFBQUFBQUFQLy8veUg1QkFFQUFBQUFMQUFBQUFBQkFBRUFRQUlCUkFBN1wiLG1heEdldFVybExlbmd0aDpudWxsLGNhbnZhc0NvbnRleHQ6bnVsbCxjcm9zc09yaWdpbktleXdvcmQ6bnVsbCxpbml0aWFsaXplOmZ1bmN0aW9uKGEsYixjLGQsZSxmKXtPcGVuTGF5ZXJzLlRpbGUucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMudXJsPWQ7dGhpcy5sYXllckFscGhhSGFjaz10aGlzLmxheWVyLmFscGhhJiZPcGVuTGF5ZXJzLlV0aWwuYWxwaGFIYWNrKCk7aWYobnVsbCE9dGhpcy5tYXhHZXRVcmxMZW5ndGh8fFxudGhpcy5sYXllci5ndXR0ZXJ8fHRoaXMubGF5ZXJBbHBoYUhhY2spdGhpcy5mcmFtZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLHRoaXMuZnJhbWUuc3R5bGUucG9zaXRpb249XCJhYnNvbHV0ZVwiLHRoaXMuZnJhbWUuc3R5bGUub3ZlcmZsb3c9XCJoaWRkZW5cIjtudWxsIT10aGlzLm1heEdldFVybExlbmd0aCYmT3BlbkxheWVycy5VdGlsLmV4dGVuZCh0aGlzLE9wZW5MYXllcnMuVGlsZS5JbWFnZS5JRnJhbWUpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5pbWdEaXYmJih0aGlzLmNsZWFyKCksdGhpcy5mcmFtZT10aGlzLmltZ0Rpdj1udWxsKTt0aGlzLmFzeW5jUmVxdWVzdElkPW51bGw7T3BlbkxheWVycy5UaWxlLnByb3RvdHlwZS5kZXN0cm95LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sZHJhdzpmdW5jdGlvbigpe3ZhciBhPU9wZW5MYXllcnMuVGlsZS5wcm90b3R5cGUuZHJhdy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7YT8odGhpcy5sYXllciE9dGhpcy5sYXllci5tYXAuYmFzZUxheWVyJiZcbnRoaXMubGF5ZXIucmVwcm9qZWN0JiYodGhpcy5ib3VuZHM9dGhpcy5nZXRCb3VuZHNGcm9tQmFzZUxheWVyKHRoaXMucG9zaXRpb24pKSx0aGlzLmlzTG9hZGluZz90aGlzLl9sb2FkRXZlbnQ9XCJyZWxvYWRcIjoodGhpcy5pc0xvYWRpbmc9ITAsdGhpcy5fbG9hZEV2ZW50PVwibG9hZHN0YXJ0XCIpLHRoaXMucG9zaXRpb25UaWxlKCksdGhpcy5yZW5kZXJUaWxlKCkpOnRoaXMudW5sb2FkKCk7cmV0dXJuIGF9LHJlbmRlclRpbGU6ZnVuY3Rpb24oKXt0aGlzLmxheWVyLmRpdi5hcHBlbmRDaGlsZCh0aGlzLmdldFRpbGUoKSk7aWYodGhpcy5sYXllci5hc3luYyl7dmFyIGE9dGhpcy5hc3luY1JlcXVlc3RJZD0odGhpcy5hc3luY1JlcXVlc3RJZHx8MCkrMTt0aGlzLmxheWVyLmdldFVSTGFzeW5jKHRoaXMuYm91bmRzLGZ1bmN0aW9uKGIpe2E9PXRoaXMuYXN5bmNSZXF1ZXN0SWQmJih0aGlzLnVybD1iLHRoaXMuaW5pdEltYWdlKCkpfSx0aGlzKX1lbHNlIHRoaXMudXJsPXRoaXMubGF5ZXIuZ2V0VVJMKHRoaXMuYm91bmRzKSxcbnRoaXMuaW5pdEltYWdlKCl9LHBvc2l0aW9uVGlsZTpmdW5jdGlvbigpe3ZhciBhPXRoaXMuZ2V0VGlsZSgpLnN0eWxlLGI9dGhpcy5mcmFtZT90aGlzLnNpemU6dGhpcy5sYXllci5nZXRJbWFnZVNpemUodGhpcy5ib3VuZHMpO2EubGVmdD10aGlzLnBvc2l0aW9uLngrXCIlXCI7YS50b3A9dGhpcy5wb3NpdGlvbi55K1wiJVwiO2Eud2lkdGg9Yi53K1wiJVwiO2EuaGVpZ2h0PWIuaCtcIiVcIn0sY2xlYXI6ZnVuY3Rpb24oKXtPcGVuTGF5ZXJzLlRpbGUucHJvdG90eXBlLmNsZWFyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgYT10aGlzLmltZ0RpdjtpZihhKXtPcGVuTGF5ZXJzLkV2ZW50LnN0b3BPYnNlcnZpbmdFbGVtZW50KGEpO3ZhciBiPXRoaXMuZ2V0VGlsZSgpO2IucGFyZW50Tm9kZT09PXRoaXMubGF5ZXIuZGl2JiZ0aGlzLmxheWVyLmRpdi5yZW1vdmVDaGlsZChiKTt0aGlzLnNldEltZ1NyYygpOyEwPT09dGhpcy5sYXllckFscGhhSGFjayYmKGEuc3R5bGUuZmlsdGVyPVwiXCIpO09wZW5MYXllcnMuRWxlbWVudC5yZW1vdmVDbGFzcyhhLFxuXCJvbEltYWdlTG9hZEVycm9yXCIpfXRoaXMuY2FudmFzQ29udGV4dD1udWxsfSxnZXRJbWFnZTpmdW5jdGlvbigpe2lmKCF0aGlzLmltZ0Rpdil7dGhpcy5pbWdEaXY9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImltZ1wiKTt0aGlzLmltZ0Rpdi5jbGFzc05hbWU9XCJvbFRpbGVJbWFnZVwiO3RoaXMuaW1nRGl2LmdhbGxlcnlJbWc9XCJub1wiO3ZhciBhPXRoaXMuaW1nRGl2LnN0eWxlO2lmKHRoaXMuZnJhbWUpe3ZhciBiPTAsYz0wO3RoaXMubGF5ZXIuZ3V0dGVyJiYoYj0xMDAqKHRoaXMubGF5ZXIuZ3V0dGVyL3RoaXMubGF5ZXIudGlsZVNpemUudyksYz0xMDAqKHRoaXMubGF5ZXIuZ3V0dGVyL3RoaXMubGF5ZXIudGlsZVNpemUuaCkpO2EubGVmdD0tYitcIiVcIjthLnRvcD0tYytcIiVcIjthLndpZHRoPTIqYisxMDArXCIlXCI7YS5oZWlnaHQ9MipjKzEwMCtcIiVcIn1hLnZpc2liaWxpdHk9XCJoaWRkZW5cIjthLm9wYWNpdHk9MDsxPnRoaXMubGF5ZXIub3BhY2l0eSYmKGEuZmlsdGVyPVwiYWxwaGEob3BhY2l0eT1cIitcbjEwMCp0aGlzLmxheWVyLm9wYWNpdHkrXCIpXCIpO2EucG9zaXRpb249XCJhYnNvbHV0ZVwiO3RoaXMubGF5ZXJBbHBoYUhhY2smJihhLnBhZGRpbmdUb3A9YS5oZWlnaHQsYS5oZWlnaHQ9XCIwXCIsYS53aWR0aD1cIjEwMCVcIik7dGhpcy5mcmFtZSYmdGhpcy5mcmFtZS5hcHBlbmRDaGlsZCh0aGlzLmltZ0Rpdil9cmV0dXJuIHRoaXMuaW1nRGl2fSxpbml0SW1hZ2U6ZnVuY3Rpb24oKXt0aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQodGhpcy5fbG9hZEV2ZW50KTt2YXIgYT10aGlzLmdldEltYWdlKCk7aWYodGhpcy51cmwmJmEuZ2V0QXR0cmlidXRlKFwic3JjXCIpPT10aGlzLnVybCl0aGlzLm9uSW1hZ2VMb2FkKCk7ZWxzZXt2YXIgYj1PcGVuTGF5ZXJzLkZ1bmN0aW9uLmJpbmQoZnVuY3Rpb24oKXtPcGVuTGF5ZXJzLkV2ZW50LnN0b3BPYnNlcnZpbmdFbGVtZW50KGEpO09wZW5MYXllcnMuRXZlbnQub2JzZXJ2ZShhLFwibG9hZFwiLE9wZW5MYXllcnMuRnVuY3Rpb24uYmluZCh0aGlzLm9uSW1hZ2VMb2FkLFxudGhpcykpO09wZW5MYXllcnMuRXZlbnQub2JzZXJ2ZShhLFwiZXJyb3JcIixPcGVuTGF5ZXJzLkZ1bmN0aW9uLmJpbmQodGhpcy5vbkltYWdlRXJyb3IsdGhpcykpO3RoaXMuaW1hZ2VSZWxvYWRBdHRlbXB0cz0wO3RoaXMuc2V0SW1nU3JjKHRoaXMudXJsKX0sdGhpcyk7YS5nZXRBdHRyaWJ1dGUoXCJzcmNcIik9PXRoaXMuYmxhbmtJbWFnZVVybD9iKCk6KE9wZW5MYXllcnMuRXZlbnQub2JzZXJ2ZShhLFwibG9hZFwiLGIpLE9wZW5MYXllcnMuRXZlbnQub2JzZXJ2ZShhLFwiZXJyb3JcIixiKSx0aGlzLmNyb3NzT3JpZ2luS2V5d29yZCYmYS5yZW1vdmVBdHRyaWJ1dGUoXCJjcm9zc29yaWdpblwiKSxhLnNyYz10aGlzLmJsYW5rSW1hZ2VVcmwpfX0sc2V0SW1nU3JjOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuaW1nRGl2O2Iuc3R5bGUudmlzaWJpbGl0eT1cImhpZGRlblwiO2Iuc3R5bGUub3BhY2l0eT0wO2EmJih0aGlzLmNyb3NzT3JpZ2luS2V5d29yZCYmKFwiZGF0YTpcIiE9PWEuc3Vic3RyKDAsNSk/Yi5zZXRBdHRyaWJ1dGUoXCJjcm9zc29yaWdpblwiLFxudGhpcy5jcm9zc09yaWdpbktleXdvcmQpOmIucmVtb3ZlQXR0cmlidXRlKFwiY3Jvc3NvcmlnaW5cIikpLGIuc3JjPWEpfSxnZXRUaWxlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZnJhbWU/dGhpcy5mcmFtZTp0aGlzLmdldEltYWdlKCl9LGNyZWF0ZUJhY2tCdWZmZXI6ZnVuY3Rpb24oKXtpZih0aGlzLmltZ0RpdiYmIXRoaXMuaXNMb2FkaW5nKXt2YXIgYTt0aGlzLmZyYW1lPyhhPXRoaXMuZnJhbWUuY2xvbmVOb2RlKCExKSxhLmFwcGVuZENoaWxkKHRoaXMuaW1nRGl2KSk6YT10aGlzLmltZ0Rpdjt0aGlzLmltZ0Rpdj1udWxsO3JldHVybiBhfX0sb25JbWFnZUxvYWQ6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmltZ0RpdjtPcGVuTGF5ZXJzLkV2ZW50LnN0b3BPYnNlcnZpbmdFbGVtZW50KGEpO2Euc3R5bGUudmlzaWJpbGl0eT1cImluaGVyaXRcIjthLnN0eWxlLm9wYWNpdHk9dGhpcy5sYXllci5vcGFjaXR5O3RoaXMuaXNMb2FkaW5nPSExO3RoaXMuY2FudmFzQ29udGV4dD1udWxsO3RoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcImxvYWRlbmRcIik7XG5pZig3PnBhcnNlRmxvYXQobmF2aWdhdG9yLmFwcFZlcnNpb24uc3BsaXQoXCJNU0lFXCIpWzFdKSYmdGhpcy5sYXllciYmdGhpcy5sYXllci5kaXYpe3ZhciBiPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO2Iuc3R5bGUuZGlzcGxheT1cIm5vbmVcIjt2YXIgYz10aGlzLmxheWVyLmRpdjtjLmFwcGVuZENoaWxkKGIpO3dpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7Yi5wYXJlbnROb2RlPT09YyYmYi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGIpfSwwKX0hMD09PXRoaXMubGF5ZXJBbHBoYUhhY2smJihhLnN0eWxlLmZpbHRlcj1cInByb2dpZDpEWEltYWdlVHJhbnNmb3JtLk1pY3Jvc29mdC5BbHBoYUltYWdlTG9hZGVyKHNyYz0nXCIrYS5zcmMrXCInLCBzaXppbmdNZXRob2Q9J3NjYWxlJylcIil9LG9uSW1hZ2VFcnJvcjpmdW5jdGlvbigpe3ZhciBhPXRoaXMuaW1nRGl2O251bGwhPWEuc3JjJiYodGhpcy5pbWFnZVJlbG9hZEF0dGVtcHRzKyssdGhpcy5pbWFnZVJlbG9hZEF0dGVtcHRzPD1cbk9wZW5MYXllcnMuSU1BR0VfUkVMT0FEX0FUVEVNUFRTP3RoaXMuc2V0SW1nU3JjKHRoaXMubGF5ZXIuZ2V0VVJMKHRoaXMuYm91bmRzKSk6KE9wZW5MYXllcnMuRWxlbWVudC5hZGRDbGFzcyhhLFwib2xJbWFnZUxvYWRFcnJvclwiKSx0aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJsb2FkZXJyb3JcIiksdGhpcy5vbkltYWdlTG9hZCgpKSl9LGdldENhbnZhc0NvbnRleHQ6ZnVuY3Rpb24oKXtpZihPcGVuTGF5ZXJzLkNBTlZBU19TVVBQT1JURUQmJnRoaXMuaW1nRGl2JiYhdGhpcy5pc0xvYWRpbmcpe2lmKCF0aGlzLmNhbnZhc0NvbnRleHQpe3ZhciBhPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7YS53aWR0aD10aGlzLnNpemUudzthLmhlaWdodD10aGlzLnNpemUuaDt0aGlzLmNhbnZhc0NvbnRleHQ9YS5nZXRDb250ZXh0KFwiMmRcIik7dGhpcy5jYW52YXNDb250ZXh0LmRyYXdJbWFnZSh0aGlzLmltZ0RpdiwwLDApfXJldHVybiB0aGlzLmNhbnZhc0NvbnRleHR9fSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5UaWxlLkltYWdlXCJ9KTtPcGVuTGF5ZXJzLkxheWVyLkdyaWQ9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkxheWVyLkhUVFBSZXF1ZXN0LHt0aWxlU2l6ZTpudWxsLHRpbGVPcmlnaW5Db3JuZXI6XCJibFwiLHRpbGVPcmlnaW46bnVsbCx0aWxlT3B0aW9uczpudWxsLHRpbGVDbGFzczpPcGVuTGF5ZXJzLlRpbGUuSW1hZ2UsZ3JpZDpudWxsLHNpbmdsZVRpbGU6ITEscmF0aW86MS41LGJ1ZmZlcjowLHRyYW5zaXRpb25FZmZlY3Q6bnVsbCxudW1Mb2FkaW5nVGlsZXM6MCx0aWxlTG9hZGluZ0RlbGF5Ojg1LHNlcnZlclJlc29sdXRpb25zOm51bGwsbW92ZVRpbWVySWQ6bnVsbCxkZWZlck1vdmVHcmlkZGVkVGlsZXM6bnVsbCx0aWxlUXVldWVJZDpudWxsLHRpbGVRdWV1ZTpudWxsLGxvYWRpbmc6ITEsYmFja0J1ZmZlcjpudWxsLGdyaWRSZXNvbHV0aW9uOm51bGwsYmFja0J1ZmZlclJlc29sdXRpb246bnVsbCxiYWNrQnVmZmVyTG9uTGF0Om51bGwsYmFja0J1ZmZlclRpbWVySWQ6bnVsbCxyZW1vdmVCYWNrQnVmZmVyRGVsYXk6bnVsbCxcbmNsYXNzTmFtZTpudWxsLGluaXRpYWxpemU6ZnVuY3Rpb24oYSxiLGMsZCl7T3BlbkxheWVycy5MYXllci5IVFRQUmVxdWVzdC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5ncmlkPVtdO3RoaXMudGlsZVF1ZXVlPVtdO251bGw9PT10aGlzLnJlbW92ZUJhY2tCdWZmZXJEZWxheSYmKHRoaXMucmVtb3ZlQmFja0J1ZmZlckRlbGF5PXRoaXMuc2luZ2xlVGlsZT8wOjI1MDApO251bGw9PT10aGlzLmNsYXNzTmFtZSYmKHRoaXMuY2xhc3NOYW1lPXRoaXMuc2luZ2xlVGlsZT9cIm9sTGF5ZXJHcmlkU2luZ2xlVGlsZVwiOlwib2xMYXllckdyaWRcIik7T3BlbkxheWVycy5BbmltYXRpb24uaXNOYXRpdmV8fCh0aGlzLmRlZmVyTW92ZUdyaWRkZWRUaWxlcz1PcGVuTGF5ZXJzLkZ1bmN0aW9uLmJpbmQoZnVuY3Rpb24oKXt0aGlzLm1vdmVHcmlkZGVkVGlsZXModHJ1ZSk7dGhpcy5tb3ZlVGltZXJJZD1udWxsfSx0aGlzKSl9LHNldE1hcDpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLkxheWVyLkhUVFBSZXF1ZXN0LnByb3RvdHlwZS5zZXRNYXAuY2FsbCh0aGlzLFxuYSk7T3BlbkxheWVycy5FbGVtZW50LmFkZENsYXNzKHRoaXMuZGl2LHRoaXMuY2xhc3NOYW1lKX0scmVtb3ZlTWFwOmZ1bmN0aW9uKCl7bnVsbCE9PXRoaXMubW92ZVRpbWVySWQmJih3aW5kb3cuY2xlYXJUaW1lb3V0KHRoaXMubW92ZVRpbWVySWQpLHRoaXMubW92ZVRpbWVySWQ9bnVsbCk7dGhpcy5jbGVhclRpbGVRdWV1ZSgpO251bGwhPT10aGlzLmJhY2tCdWZmZXJUaW1lcklkJiYod2luZG93LmNsZWFyVGltZW91dCh0aGlzLmJhY2tCdWZmZXJUaW1lcklkKSx0aGlzLmJhY2tCdWZmZXJUaW1lcklkPW51bGwpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5yZW1vdmVCYWNrQnVmZmVyKCk7dGhpcy5jbGVhckdyaWQoKTt0aGlzLnRpbGVTaXplPXRoaXMuZ3JpZD1udWxsO09wZW5MYXllcnMuTGF5ZXIuSFRUUFJlcXVlc3QucHJvdG90eXBlLmRlc3Ryb3kuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxjbGVhckdyaWQ6ZnVuY3Rpb24oKXt0aGlzLmNsZWFyVGlsZVF1ZXVlKCk7aWYodGhpcy5ncmlkKXtmb3IodmFyIGE9XG4wLGI9dGhpcy5ncmlkLmxlbmd0aDthPGI7YSsrKWZvcih2YXIgYz10aGlzLmdyaWRbYV0sZD0wLGU9Yy5sZW5ndGg7ZDxlO2QrKyl0aGlzLmRlc3Ryb3lUaWxlKGNbZF0pO3RoaXMuZ3JpZD1bXTt0aGlzLmdyaWRSZXNvbHV0aW9uPW51bGx9fSxjbG9uZTpmdW5jdGlvbihhKXtudWxsPT1hJiYoYT1uZXcgT3BlbkxheWVycy5MYXllci5HcmlkKHRoaXMubmFtZSx0aGlzLnVybCx0aGlzLnBhcmFtcyx0aGlzLmdldE9wdGlvbnMoKSkpO2E9T3BlbkxheWVycy5MYXllci5IVFRQUmVxdWVzdC5wcm90b3R5cGUuY2xvbmUuYXBwbHkodGhpcyxbYV0pO251bGwhPXRoaXMudGlsZVNpemUmJihhLnRpbGVTaXplPXRoaXMudGlsZVNpemUuY2xvbmUoKSk7YS5ncmlkPVtdO2EuZ3JpZFJlc29sdXRpb249bnVsbDthLmJhY2tCdWZmZXI9bnVsbDthLmJhY2tCdWZmZXJUaW1lcklkPW51bGw7YS50aWxlUXVldWU9W107YS50aWxlUXVldWVJZD1udWxsO2EubG9hZGluZz0hMTthLm1vdmVUaW1lcklkPW51bGw7XG5yZXR1cm4gYX0sbW92ZVRvOmZ1bmN0aW9uKGEsYixjKXtPcGVuTGF5ZXJzLkxheWVyLkhUVFBSZXF1ZXN0LnByb3RvdHlwZS5tb3ZlVG8uYXBwbHkodGhpcyxhcmd1bWVudHMpO2E9YXx8dGhpcy5tYXAuZ2V0RXh0ZW50KCk7aWYobnVsbCE9YSl7dmFyIGQ9IXRoaXMuZ3JpZC5sZW5ndGh8fGIsZT10aGlzLmdldFRpbGVzQm91bmRzKCksZj10aGlzLm1hcC5nZXRSZXNvbHV0aW9uKCksZz10aGlzLmdldFNlcnZlclJlc29sdXRpb24oZik7aWYodGhpcy5zaW5nbGVUaWxlKXtpZihkfHwhYyYmIWUuY29udGFpbnNCb3VuZHMoYSkpYiYmXCJyZXNpemVcIiE9PXRoaXMudHJhbnNpdGlvbkVmZmVjdCYmdGhpcy5yZW1vdmVCYWNrQnVmZmVyKCksKCFifHxcInJlc2l6ZVwiPT09dGhpcy50cmFuc2l0aW9uRWZmZWN0KSYmdGhpcy5hcHBseUJhY2tCdWZmZXIoZyksdGhpcy5pbml0U2luZ2xlVGlsZShhKX1lbHNlKGQ9ZHx8IWUuaW50ZXJzZWN0c0JvdW5kcyhhLHt3b3JsZEJvdW5kczp0aGlzLm1hcC5iYXNlTGF5ZXIud3JhcERhdGVMaW5lJiZcbnRoaXMubWFwLmdldE1heEV4dGVudCgpfSksZiE9PWc/KGE9dGhpcy5tYXAuY2FsY3VsYXRlQm91bmRzKG51bGwsZyksZCYmdGhpcy50cmFuc2Zvcm1EaXYoZy9mKSk6KHRoaXMuZGl2LnN0eWxlLndpZHRoPVwiMTAwJVwiLHRoaXMuZGl2LnN0eWxlLmhlaWdodD1cIjEwMCVcIix0aGlzLmRpdi5zdHlsZS5sZWZ0PVwiMCVcIix0aGlzLmRpdi5zdHlsZS50b3A9XCIwJVwiKSxkKT8oYiYmXCJyZXNpemVcIj09PXRoaXMudHJhbnNpdGlvbkVmZmVjdCYmdGhpcy5hcHBseUJhY2tCdWZmZXIoZyksdGhpcy5pbml0R3JpZGRlZFRpbGVzKGEpKTp0aGlzLm1vdmVHcmlkZGVkVGlsZXMoKX19LGdldFRpbGVEYXRhOmZ1bmN0aW9uKGEpe3ZhciBiPW51bGwsYz1hLmxvbixkPWEubGF0LGU9dGhpcy5ncmlkLmxlbmd0aDtpZih0aGlzLm1hcCYmZSl7dmFyIGY9dGhpcy5tYXAuZ2V0UmVzb2x1dGlvbigpLGE9dGhpcy50aWxlU2l6ZS53LGc9dGhpcy50aWxlU2l6ZS5oLGg9dGhpcy5ncmlkWzBdWzBdLmJvdW5kcyxpPWgubGVmdCxcbmg9aC50b3A7aWYoYzxpJiZ0aGlzLm1hcC5iYXNlTGF5ZXIud3JhcERhdGVMaW5lKXZhciBqPXRoaXMubWFwLmdldE1heEV4dGVudCgpLmdldFdpZHRoKCksaz1NYXRoLmNlaWwoKGktYykvaiksYz1jK2oqaztjPShjLWkpLyhmKmEpO2Q9KGgtZCkvKGYqZyk7Zj1NYXRoLmZsb29yKGMpO2k9TWF0aC5mbG9vcihkKTswPD1pJiZpPGUmJihlPXRoaXMuZ3JpZFtpXVtmXSkmJihiPXt0aWxlOmUsaTpNYXRoLmZsb29yKChjLWYpKmEpLGo6TWF0aC5mbG9vcigoZC1pKSpnKX0pfXJldHVybiBifSxxdWV1ZVRpbGVEcmF3OmZ1bmN0aW9uKGEpe2E9YS5vYmplY3Q7fk9wZW5MYXllcnMuVXRpbC5pbmRleE9mKHRoaXMudGlsZVF1ZXVlLGEpfHx0aGlzLnRpbGVRdWV1ZS5wdXNoKGEpO3RoaXMudGlsZVF1ZXVlSWR8fCh0aGlzLnRpbGVRdWV1ZUlkPU9wZW5MYXllcnMuQW5pbWF0aW9uLnN0YXJ0KE9wZW5MYXllcnMuRnVuY3Rpb24uYmluZCh0aGlzLmRyYXdUaWxlRnJvbVF1ZXVlLHRoaXMpLG51bGwsXG50aGlzLmRpdikpO3JldHVybiExfSxkcmF3VGlsZUZyb21RdWV1ZTpmdW5jdGlvbigpezA9PT10aGlzLnRpbGVRdWV1ZS5sZW5ndGg/dGhpcy5jbGVhclRpbGVRdWV1ZSgpOnRoaXMudGlsZVF1ZXVlLnNoaWZ0KCkuZHJhdyghMCl9LGNsZWFyVGlsZVF1ZXVlOmZ1bmN0aW9uKCl7T3BlbkxheWVycy5BbmltYXRpb24uc3RvcCh0aGlzLnRpbGVRdWV1ZUlkKTt0aGlzLnRpbGVRdWV1ZUlkPW51bGw7dGhpcy50aWxlUXVldWU9W119LGRlc3Ryb3lUaWxlOmZ1bmN0aW9uKGEpe3RoaXMucmVtb3ZlVGlsZU1vbml0b3JpbmdIb29rcyhhKTthLmRlc3Ryb3koKX0sZ2V0U2VydmVyUmVzb2x1dGlvbjpmdW5jdGlvbihhKXthPWF8fHRoaXMubWFwLmdldFJlc29sdXRpb24oKTtpZih0aGlzLnNlcnZlclJlc29sdXRpb25zJiYtMT09PU9wZW5MYXllcnMuVXRpbC5pbmRleE9mKHRoaXMuc2VydmVyUmVzb2x1dGlvbnMsYSkpe3ZhciBiLGM7Zm9yKGI9dGhpcy5zZXJ2ZXJSZXNvbHV0aW9ucy5sZW5ndGgtXG4xOzA8PWI7Yi0tKWlmKGM9dGhpcy5zZXJ2ZXJSZXNvbHV0aW9uc1tiXSxjPmEpe2E9YzticmVha31pZigtMT09PWIpdGhyb3dcIm5vIGFwcHJvcHJpYXRlIHJlc29sdXRpb24gaW4gc2VydmVyUmVzb2x1dGlvbnNcIjt9cmV0dXJuIGF9LGdldFNlcnZlclpvb206ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmdldFNlcnZlclJlc29sdXRpb24oKTtyZXR1cm4gdGhpcy5zZXJ2ZXJSZXNvbHV0aW9ucz9PcGVuTGF5ZXJzLlV0aWwuaW5kZXhPZih0aGlzLnNlcnZlclJlc29sdXRpb25zLGEpOnRoaXMubWFwLmdldFpvb21Gb3JSZXNvbHV0aW9uKGEpKyh0aGlzLnpvb21PZmZzZXR8fDApfSx0cmFuc2Zvcm1EaXY6ZnVuY3Rpb24oYSl7dGhpcy5kaXYuc3R5bGUud2lkdGg9MTAwKmErXCIlXCI7dGhpcy5kaXYuc3R5bGUuaGVpZ2h0PTEwMCphK1wiJVwiO3ZhciBiPXRoaXMubWFwLmdldFNpemUoKSxjPXBhcnNlSW50KHRoaXMubWFwLmxheWVyQ29udGFpbmVyRGl2LnN0eWxlLmxlZnQsMTApLGQ9KHBhcnNlSW50KHRoaXMubWFwLmxheWVyQ29udGFpbmVyRGl2LnN0eWxlLnRvcCxcbjEwKS1iLmgvMikqKGEtMSk7dGhpcy5kaXYuc3R5bGUubGVmdD0oYy1iLncvMikqKGEtMSkrXCIlXCI7dGhpcy5kaXYuc3R5bGUudG9wPWQrXCIlXCJ9LGdldFJlc29sdXRpb25TY2FsZTpmdW5jdGlvbigpe3JldHVybiBwYXJzZUludCh0aGlzLmRpdi5zdHlsZS53aWR0aCwxMCkvMTAwfSxhcHBseUJhY2tCdWZmZXI6ZnVuY3Rpb24oYSl7bnVsbCE9PXRoaXMuYmFja0J1ZmZlclRpbWVySWQmJnRoaXMucmVtb3ZlQmFja0J1ZmZlcigpO3ZhciBiPXRoaXMuYmFja0J1ZmZlcjtpZighYil7Yj10aGlzLmNyZWF0ZUJhY2tCdWZmZXIoKTtpZighYilyZXR1cm47dGhpcy5kaXYuaW5zZXJ0QmVmb3JlKGIsdGhpcy5kaXYuZmlyc3RDaGlsZCk7dGhpcy5iYWNrQnVmZmVyPWI7dmFyIGM9dGhpcy5ncmlkWzBdWzBdLmJvdW5kczt0aGlzLmJhY2tCdWZmZXJMb25MYXQ9e2xvbjpjLmxlZnQsbGF0OmMudG9wfTt0aGlzLmJhY2tCdWZmZXJSZXNvbHV0aW9uPXRoaXMuZ3JpZFJlc29sdXRpb259dmFyIGM9Yi5zdHlsZSxcbmQ9dGhpcy5iYWNrQnVmZmVyUmVzb2x1dGlvbi9hO2Mud2lkdGg9MTAwKmQrXCIlXCI7Yy5oZWlnaHQ9MTAwKmQrXCIlXCI7YT10aGlzLmdldFZpZXdQb3J0UHhGcm9tTG9uTGF0KHRoaXMuYmFja0J1ZmZlckxvbkxhdCxhKTtjPXBhcnNlSW50KHRoaXMubWFwLmxheWVyQ29udGFpbmVyRGl2LnN0eWxlLmxlZnQsMTApO2Q9cGFyc2VJbnQodGhpcy5tYXAubGF5ZXJDb250YWluZXJEaXYuc3R5bGUudG9wLDEwKTtiLnN0eWxlLmxlZnQ9TWF0aC5yb3VuZChhLngtYykrXCIlXCI7Yi5zdHlsZS50b3A9TWF0aC5yb3VuZChhLnktZCkrXCIlXCJ9LGNyZWF0ZUJhY2tCdWZmZXI6ZnVuY3Rpb24oKXt2YXIgYTtpZigwPHRoaXMuZ3JpZC5sZW5ndGgpe2E9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTthLmlkPXRoaXMuZGl2LmlkK1wiX2JiXCI7YS5jbGFzc05hbWU9XCJvbEJhY2tCdWZmZXJcIjthLnN0eWxlLnBvc2l0aW9uPVwiYWJzb2x1dGVcIjthLnN0eWxlLndpZHRoPVwiMTAwJVwiO2Euc3R5bGUuaGVpZ2h0PVxuXCIxMDAlXCI7Zm9yKHZhciBiPTAsYz10aGlzLmdyaWQubGVuZ3RoO2I8YztiKyspZm9yKHZhciBkPTAsZT10aGlzLmdyaWRbYl0ubGVuZ3RoO2Q8ZTtkKyspe3ZhciBmPXRoaXMuZ3JpZFtiXVtkXS5jcmVhdGVCYWNrQnVmZmVyKCk7ZiYmKGYuc3R5bGUudG9wPWIqdGhpcy50aWxlU2l6ZS5oK1wiJVwiLGYuc3R5bGUubGVmdD1kKnRoaXMudGlsZVNpemUudytcIiVcIixhLmFwcGVuZENoaWxkKGYpKX19cmV0dXJuIGF9LHJlbW92ZUJhY2tCdWZmZXI6ZnVuY3Rpb24oKXt0aGlzLmJhY2tCdWZmZXImJih0aGlzLmRpdi5yZW1vdmVDaGlsZCh0aGlzLmJhY2tCdWZmZXIpLHRoaXMuYmFja0J1ZmZlclJlc29sdXRpb249dGhpcy5iYWNrQnVmZmVyPW51bGwsbnVsbCE9PXRoaXMuYmFja0J1ZmZlclRpbWVySWQmJih3aW5kb3cuY2xlYXJUaW1lb3V0KHRoaXMuYmFja0J1ZmZlclRpbWVySWQpLHRoaXMuYmFja0J1ZmZlclRpbWVySWQ9bnVsbCkpfSxtb3ZlQnlQeDpmdW5jdGlvbigpe3RoaXMuc2luZ2xlVGlsZXx8XG50aGlzLm1vdmVHcmlkZGVkVGlsZXMoKX0sc2V0VGlsZVNpemU6ZnVuY3Rpb24oYSl7dGhpcy5zaW5nbGVUaWxlJiYoYT10aGlzLm1hcC5nZXRTaXplKCksYS5oPXBhcnNlSW50KGEuaCp0aGlzLnJhdGlvKSxhLnc9cGFyc2VJbnQoYS53KnRoaXMucmF0aW8pKTtPcGVuTGF5ZXJzLkxheWVyLkhUVFBSZXF1ZXN0LnByb3RvdHlwZS5zZXRUaWxlU2l6ZS5hcHBseSh0aGlzLFthXSl9LGdldFRpbGVzQm91bmRzOmZ1bmN0aW9uKCl7dmFyIGE9bnVsbCxiPXRoaXMuZ3JpZC5sZW5ndGg7aWYoYil2YXIgYT10aGlzLmdyaWRbYi0xXVswXS5ib3VuZHMsYj10aGlzLmdyaWRbMF0ubGVuZ3RoKmEuZ2V0V2lkdGgoKSxjPXRoaXMuZ3JpZC5sZW5ndGgqYS5nZXRIZWlnaHQoKSxhPW5ldyBPcGVuTGF5ZXJzLkJvdW5kcyhhLmxlZnQsYS5ib3R0b20sYS5sZWZ0K2IsYS5ib3R0b20rYyk7cmV0dXJuIGF9LGluaXRTaW5nbGVUaWxlOmZ1bmN0aW9uKGEpe3RoaXMuY2xlYXJUaWxlUXVldWUoKTt2YXIgYj1cbmEuZ2V0Q2VudGVyTG9uTGF0KCksYz1hLmdldFdpZHRoKCkqdGhpcy5yYXRpbyxhPWEuZ2V0SGVpZ2h0KCkqdGhpcy5yYXRpbyxiPW5ldyBPcGVuTGF5ZXJzLkJvdW5kcyhiLmxvbi1jLzIsYi5sYXQtYS8yLGIubG9uK2MvMixiLmxhdCthLzIpLGM9dGhpcy5tYXAuZ2V0TGF5ZXJQeEZyb21Mb25MYXQoe2xvbjpiLmxlZnQsbGF0OmIudG9wfSk7dGhpcy5ncmlkLmxlbmd0aHx8KHRoaXMuZ3JpZFswXT1bXSk7KGE9dGhpcy5ncmlkWzBdWzBdKT9hLm1vdmVUbyhiLGMpOihhPXRoaXMuYWRkVGlsZShiLGMpLHRoaXMuYWRkVGlsZU1vbml0b3JpbmdIb29rcyhhKSxhLmRyYXcoKSx0aGlzLmdyaWRbMF1bMF09YSk7dGhpcy5yZW1vdmVFeGNlc3NUaWxlcygxLDEpO3RoaXMuZ3JpZFJlc29sdXRpb249dGhpcy5nZXRTZXJ2ZXJSZXNvbHV0aW9uKCl9LGNhbGN1bGF0ZUdyaWRMYXlvdXQ6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWMqdGhpcy50aWxlU2l6ZS53LGM9Yyp0aGlzLnRpbGVTaXplLmgsZT1cbmEubGVmdC1iLmxvbixmPU1hdGguZmxvb3IoZS9kKS10aGlzLmJ1ZmZlcixlPS0oZS9kLWYpKnRoaXMudGlsZVNpemUudyxmPWIubG9uK2YqZCxhPWEudG9wLShiLmxhdCtjKSxnPU1hdGguY2VpbChhL2MpK3RoaXMuYnVmZmVyO3JldHVybnt0aWxlbG9uOmQsdGlsZWxhdDpjLHRpbGVvZmZzZXRsb246Zix0aWxlb2Zmc2V0bGF0OmIubGF0K2cqYyx0aWxlb2Zmc2V0eDplLHRpbGVvZmZzZXR5Oi0oZy1hL2MpKnRoaXMudGlsZVNpemUuaH19LGdldFRpbGVPcmlnaW46ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnRpbGVPcmlnaW47aWYoIWEpdmFyIGE9dGhpcy5nZXRNYXhFeHRlbnQoKSxiPXt0bDpbXCJsZWZ0XCIsXCJ0b3BcIl0sdHI6W1wicmlnaHRcIixcInRvcFwiXSxibDpbXCJsZWZ0XCIsXCJib3R0b21cIl0sYnI6W1wicmlnaHRcIixcImJvdHRvbVwiXX1bdGhpcy50aWxlT3JpZ2luQ29ybmVyXSxhPW5ldyBPcGVuTGF5ZXJzLkxvbkxhdChhW2JbMF1dLGFbYlsxXV0pO3JldHVybiBhfSxpbml0R3JpZGRlZFRpbGVzOmZ1bmN0aW9uKGEpe3RoaXMuY2xlYXJUaWxlUXVldWUoKTtcbnZhciBiPXRoaXMubWFwLmdldFNpemUoKSxjPU1hdGguY2VpbChiLmgvdGhpcy50aWxlU2l6ZS5oKStNYXRoLm1heCgxLDIqdGhpcy5idWZmZXIpLGI9TWF0aC5jZWlsKGIudy90aGlzLnRpbGVTaXplLncpK01hdGgubWF4KDEsMip0aGlzLmJ1ZmZlciksZD10aGlzLmdldFRpbGVPcmlnaW4oKSxlPXRoaXMuZ2V0U2VydmVyUmVzb2x1dGlvbigpLGQ9dGhpcy5jYWxjdWxhdGVHcmlkTGF5b3V0KGEsZCxlKSxlPU1hdGgucm91bmQoZC50aWxlb2Zmc2V0eCksZj1NYXRoLnJvdW5kKGQudGlsZW9mZnNldHkpLGc9ZC50aWxlb2Zmc2V0bG9uLGg9ZC50aWxlb2Zmc2V0bGF0LGk9ZC50aWxlbG9uLGo9ZC50aWxlbGF0LGs9ZSxsPWcsbT0wLG49cGFyc2VJbnQodGhpcy5tYXAubGF5ZXJDb250YWluZXJEaXYuc3R5bGUubGVmdCksbz1wYXJzZUludCh0aGlzLm1hcC5sYXllckNvbnRhaW5lckRpdi5zdHlsZS50b3ApLGQ9W10scD10aGlzLm1hcC5nZXRDZW50ZXIoKTtkb3t2YXIgcT10aGlzLmdyaWRbbSsrXTtcbnF8fChxPVtdLHRoaXMuZ3JpZC5wdXNoKHEpKTt2YXIgZz1sLGU9ayxyPTA7ZG97dmFyIHM9bmV3IE9wZW5MYXllcnMuQm91bmRzKGcsaCxnK2ksaCtqKSx0PWUsdD10LW4sdT1mLHU9dS1vLHU9bmV3IE9wZW5MYXllcnMuUGl4ZWwodCx1KTsodD1xW3IrK10pP3QubW92ZVRvKHMsdSwhMSk6KHQ9dGhpcy5hZGRUaWxlKHMsdSksdGhpcy5hZGRUaWxlTW9uaXRvcmluZ0hvb2tzKHQpLHEucHVzaCh0KSk7cz1zLmdldENlbnRlckxvbkxhdCgpO2QucHVzaCh7dGlsZTp0LGRpc3RhbmNlOk1hdGgucG93KHMubG9uLXAubG9uLDIpK01hdGgucG93KHMubGF0LXAubGF0LDIpfSk7Zys9aTtlKz10aGlzLnRpbGVTaXplLnd9d2hpbGUoZzw9YS5yaWdodCtpKnRoaXMuYnVmZmVyfHxyPGIpO2gtPWo7Zis9dGhpcy50aWxlU2l6ZS5ofXdoaWxlKGg+PWEuYm90dG9tLWoqdGhpcy5idWZmZXJ8fG08Yyk7dGhpcy5yZW1vdmVFeGNlc3NUaWxlcyhtLHIpO3RoaXMuZ3JpZFJlc29sdXRpb249dGhpcy5nZXRTZXJ2ZXJSZXNvbHV0aW9uKCk7XG5kLnNvcnQoZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS5kaXN0YW5jZS1iLmRpc3RhbmNlfSk7YT0wO2ZvcihjPWQubGVuZ3RoO2E8YzsrK2EpZFthXS50aWxlLmRyYXcoKX0sZ2V0TWF4RXh0ZW50OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWF4RXh0ZW50fSxhZGRUaWxlOmZ1bmN0aW9uKGEsYil7dmFyIGM9bmV3IHRoaXMudGlsZUNsYXNzKHRoaXMsYixhLG51bGwsdGhpcy50aWxlU2l6ZSx0aGlzLnRpbGVPcHRpb25zKTtjLmV2ZW50cy5yZWdpc3RlcihcImJlZm9yZWRyYXdcIix0aGlzLHRoaXMucXVldWVUaWxlRHJhdyk7cmV0dXJuIGN9LGFkZFRpbGVNb25pdG9yaW5nSG9va3M6ZnVuY3Rpb24oYSl7YS5vbkxvYWRTdGFydD1mdW5jdGlvbigpeyExPT09dGhpcy5sb2FkaW5nJiYodGhpcy5sb2FkaW5nPSEwLHRoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcImxvYWRzdGFydFwiKSk7dGhpcy5ldmVudHMudHJpZ2dlckV2ZW50KFwidGlsZWxvYWRzdGFydFwiLHt0aWxlOmF9KTt0aGlzLm51bUxvYWRpbmdUaWxlcysrfTtcbmEub25Mb2FkRW5kPWZ1bmN0aW9uKCl7dGhpcy5udW1Mb2FkaW5nVGlsZXMtLTt0aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJ0aWxlbG9hZGVkXCIse3RpbGU6YX0pOzA9PT10aGlzLnRpbGVRdWV1ZS5sZW5ndGgmJjA9PT10aGlzLm51bUxvYWRpbmdUaWxlcyYmKHRoaXMubG9hZGluZz0hMSx0aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJsb2FkZW5kXCIpLHRoaXMuYmFja0J1ZmZlciYmKHRoaXMuYmFja0J1ZmZlclRpbWVySWQ9d2luZG93LnNldFRpbWVvdXQoT3BlbkxheWVycy5GdW5jdGlvbi5iaW5kKHRoaXMucmVtb3ZlQmFja0J1ZmZlcix0aGlzKSx0aGlzLnJlbW92ZUJhY2tCdWZmZXJEZWxheSkpKX07YS5vbkxvYWRFcnJvcj1mdW5jdGlvbigpe3RoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcInRpbGVlcnJvclwiLHt0aWxlOmF9KX07YS5ldmVudHMub24oe2xvYWRzdGFydDphLm9uTG9hZFN0YXJ0LGxvYWRlbmQ6YS5vbkxvYWRFbmQsdW5sb2FkOmEub25Mb2FkRW5kLGxvYWRlcnJvcjphLm9uTG9hZEVycm9yLFxuc2NvcGU6dGhpc30pfSxyZW1vdmVUaWxlTW9uaXRvcmluZ0hvb2tzOmZ1bmN0aW9uKGEpe2EudW5sb2FkKCk7YS5ldmVudHMudW4oe2xvYWRzdGFydDphLm9uTG9hZFN0YXJ0LGxvYWRlbmQ6YS5vbkxvYWRFbmQsdW5sb2FkOmEub25Mb2FkRW5kLGxvYWRlcnJvcjphLm9uTG9hZEVycm9yLHNjb3BlOnRoaXN9KX0sbW92ZUdyaWRkZWRUaWxlczpmdW5jdGlvbihhKXtpZighYSYmIU9wZW5MYXllcnMuQW5pbWF0aW9uLmlzTmF0aXZlKW51bGwhPXRoaXMubW92ZVRpbWVySWQmJndpbmRvdy5jbGVhclRpbWVvdXQodGhpcy5tb3ZlVGltZXJJZCksdGhpcy5tb3ZlVGltZXJJZD13aW5kb3cuc2V0VGltZW91dCh0aGlzLmRlZmVyTW92ZUdyaWRkZWRUaWxlcyx0aGlzLnRpbGVMb2FkaW5nRGVsYXkpO2Vsc2UgZm9yKHZhciBhPXRoaXMuYnVmZmVyfHwxLGI9dGhpcy5nZXRSZXNvbHV0aW9uU2NhbGUoKTs7KXt2YXIgYz10aGlzLmdyaWRbMF1bMF0ucG9zaXRpb24ueCpiK3BhcnNlSW50KHRoaXMuZGl2LnN0eWxlLmxlZnQsXG4xMCkrcGFyc2VJbnQodGhpcy5tYXAubGF5ZXJDb250YWluZXJEaXYuc3R5bGUubGVmdCksZD10aGlzLmdyaWRbMF1bMF0ucG9zaXRpb24ueSpiK3BhcnNlSW50KHRoaXMuZGl2LnN0eWxlLnRvcCwxMCkrcGFyc2VJbnQodGhpcy5tYXAubGF5ZXJDb250YWluZXJEaXYuc3R5bGUudG9wKSxlPXRoaXMudGlsZVNpemUudypiLGY9dGhpcy50aWxlU2l6ZS5oKmI7aWYoYz4tZSooYS0xKSl0aGlzLnNoaWZ0Q29sdW1uKCEwKTtlbHNlIGlmKGM8LWUqYSl0aGlzLnNoaWZ0Q29sdW1uKCExKTtlbHNlIGlmKGQ+LWYqKGEtMSkpdGhpcy5zaGlmdFJvdyghMCk7ZWxzZSBpZihkPC1mKmEpdGhpcy5zaGlmdFJvdyghMSk7ZWxzZSBicmVha319LHNoaWZ0Um93OmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj10aGlzLmdyaWQsYz1iW2E/MDp0aGlzLmdyaWQubGVuZ3RoLTFdLGQ9dGhpcy5nZXRTZXJ2ZXJSZXNvbHV0aW9uKCksZT1hPy10aGlzLnRpbGVTaXplLmg6dGhpcy50aWxlU2l6ZS5oLGQ9ZCotZSxmPWE/XG5iLnBvcCgpOmIuc2hpZnQoKSxnPTAsaD1jLmxlbmd0aDtnPGg7ZysrKXt2YXIgaT1jW2ddLGo9aS5ib3VuZHMuY2xvbmUoKSxpPWkucG9zaXRpb24uY2xvbmUoKTtqLmJvdHRvbSs9ZDtqLnRvcCs9ZDtpLnkrPWU7ZltnXS5tb3ZlVG8oaixpKX1hP2IudW5zaGlmdChmKTpiLnB1c2goZil9LHNoaWZ0Q29sdW1uOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1hPy10aGlzLnRpbGVTaXplLnc6dGhpcy50aWxlU2l6ZS53LGM9dGhpcy5nZXRTZXJ2ZXJSZXNvbHV0aW9uKCkqYixkPTAsZT10aGlzLmdyaWQubGVuZ3RoO2Q8ZTtkKyspe3ZhciBmPXRoaXMuZ3JpZFtkXSxnPWZbYT8wOmYubGVuZ3RoLTFdLGg9Zy5ib3VuZHMuY2xvbmUoKSxnPWcucG9zaXRpb24uY2xvbmUoKTtoLmxlZnQrPWM7aC5yaWdodCs9YztnLngrPWI7dmFyIGk9YT90aGlzLmdyaWRbZF0ucG9wKCk6dGhpcy5ncmlkW2RdLnNoaWZ0KCk7aS5tb3ZlVG8oaCxnKTthP2YudW5zaGlmdChpKTpmLnB1c2goaSl9fSxyZW1vdmVFeGNlc3NUaWxlczpmdW5jdGlvbihhLFxuYil7Zm9yKHZhciBjLGQ7dGhpcy5ncmlkLmxlbmd0aD5hOyl7dmFyIGU9dGhpcy5ncmlkLnBvcCgpO2M9MDtmb3IoZD1lLmxlbmd0aDtjPGQ7YysrKXt2YXIgZj1lW2NdO3RoaXMuZGVzdHJveVRpbGUoZil9fWM9MDtmb3IoZD10aGlzLmdyaWQubGVuZ3RoO2M8ZDtjKyspZm9yKDt0aGlzLmdyaWRbY10ubGVuZ3RoPmI7KWU9dGhpcy5ncmlkW2NdLGY9ZS5wb3AoKSx0aGlzLmRlc3Ryb3lUaWxlKGYpfSxvbk1hcFJlc2l6ZTpmdW5jdGlvbigpe3RoaXMuc2luZ2xlVGlsZSYmKHRoaXMuY2xlYXJHcmlkKCksdGhpcy5zZXRUaWxlU2l6ZSgpKX0sZ2V0VGlsZUJvdW5kczpmdW5jdGlvbihhKXt2YXIgYj10aGlzLm1heEV4dGVudCxjPXRoaXMuZ2V0UmVzb2x1dGlvbigpLGQ9Yyp0aGlzLnRpbGVTaXplLncsYz1jKnRoaXMudGlsZVNpemUuaCxlPXRoaXMuZ2V0TG9uTGF0RnJvbVZpZXdQb3J0UHgoYSksYT1iLmxlZnQrZCpNYXRoLmZsb29yKChlLmxvbi1iLmxlZnQpL2QpLGI9Yi5ib3R0b20rXG5jKk1hdGguZmxvb3IoKGUubGF0LWIuYm90dG9tKS9jKTtyZXR1cm4gbmV3IE9wZW5MYXllcnMuQm91bmRzKGEsYixhK2QsYitjKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuTGF5ZXIuR3JpZFwifSk7T3BlbkxheWVycy5Gb3JtYXQuQXJjWE1MPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Gb3JtYXQuWE1MLHtmb250U3R5bGVLZXlzOlwiYW50aWFsaWFzaW5nIGJsb2Nrb3V0IGZvbnQgZm9udGNvbG9yIGZvbnRzaXplIGZvbnRzdHlsZSBnbG93aW5nIGludGVydmFsIG91dGxpbmUgcHJpbnRtb2RlIHNoYWRvdyB0cmFuc3BhcmVuY3lcIi5zcGxpdChcIiBcIikscmVxdWVzdDpudWxsLHJlc3BvbnNlOm51bGwsaW5pdGlhbGl6ZTpmdW5jdGlvbihhKXt0aGlzLnJlcXVlc3Q9bmV3IE9wZW5MYXllcnMuRm9ybWF0LkFyY1hNTC5SZXF1ZXN0O3RoaXMucmVzcG9uc2U9bmV3IE9wZW5MYXllcnMuRm9ybWF0LkFyY1hNTC5SZXNwb25zZTtpZihhKWlmKFwiZmVhdHVyZVwiPT1hLnJlcXVlc3R0eXBlKXt0aGlzLnJlcXVlc3QuZ2V0X2ltYWdlPW51bGw7dmFyIGI9dGhpcy5yZXF1ZXN0LmdldF9mZWF0dXJlLnF1ZXJ5O3RoaXMuYWRkQ29vcmRTeXMoYi5mZWF0dXJlY29vcmRzeXMsYS5mZWF0dXJlQ29vcmRTeXMpO1xudGhpcy5hZGRDb29yZFN5cyhiLmZpbHRlcmNvb3Jkc3lzLGEuZmlsdGVyQ29vcmRTeXMpO2EucG9seWdvbj8oYi5pc3NwYXRpYWw9ITAsYi5zcGF0aWFsZmlsdGVyLnBvbHlnb249YS5wb2x5Z29uKTphLmVudmVsb3BlJiYoYi5pc3NwYXRpYWw9ITAsYi5zcGF0aWFsZmlsdGVyLmVudmVsb3BlPXttaW54OjAsbWlueTowLG1heHg6MCxtYXh5OjB9LHRoaXMucGFyc2VFbnZlbG9wZShiLnNwYXRpYWxmaWx0ZXIuZW52ZWxvcGUsYS5lbnZlbG9wZSkpfWVsc2VcImltYWdlXCI9PWEucmVxdWVzdHR5cGU/KHRoaXMucmVxdWVzdC5nZXRfZmVhdHVyZT1udWxsLGI9dGhpcy5yZXF1ZXN0LmdldF9pbWFnZS5wcm9wZXJ0aWVzLHRoaXMucGFyc2VFbnZlbG9wZShiLmVudmVsb3BlLGEuZW52ZWxvcGUpLHRoaXMuYWRkTGF5ZXJzKGIubGF5ZXJsaXN0LGEubGF5ZXJzKSx0aGlzLmFkZEltYWdlU2l6ZShiLmltYWdlc2l6ZSxhLnRpbGVTaXplKSx0aGlzLmFkZENvb3JkU3lzKGIuZmVhdHVyZWNvb3Jkc3lzLFxuYS5mZWF0dXJlQ29vcmRTeXMpLHRoaXMuYWRkQ29vcmRTeXMoYi5maWx0ZXJjb29yZHN5cyxhLmZpbHRlckNvb3JkU3lzKSk6dGhpcy5yZXF1ZXN0PW51bGw7T3BlbkxheWVycy5Gb3JtYXQuWE1MLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsW2FdKX0scGFyc2VFbnZlbG9wZTpmdW5jdGlvbihhLGIpe2ImJjQ9PWIubGVuZ3RoJiYoYS5taW54PWJbMF0sYS5taW55PWJbMV0sYS5tYXh4PWJbMl0sYS5tYXh5PWJbM10pfSxhZGRMYXllcnM6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9MCxkPWIubGVuZ3RoO2M8ZDtjKyspYS5wdXNoKGJbY10pfSxhZGRJbWFnZVNpemU6ZnVuY3Rpb24oYSxiKXtudWxsIT09YiYmKGEud2lkdGg9Yi53LGEuaGVpZ2h0PWIuaCxhLnByaW50d2lkdGg9Yi53LGEucHJpbnRoZWlnaHQ9Yi5oKX0sYWRkQ29vcmRTeXM6ZnVuY3Rpb24oYSxiKXtcInN0cmluZ1wiPT10eXBlb2YgYj8oYS5pZD1wYXJzZUludChiKSxhLnN0cmluZz1iKTpcIm9iamVjdFwiPT10eXBlb2YgYiYmXG5udWxsIT09Yi5wcm9qJiYoYS5pZD1iLnByb2ouc3JzUHJvak51bWJlcixhLnN0cmluZz1iLnByb2ouc3JzQ29kZSl9LGlzZXJyb3I6ZnVuY3Rpb24oYSl7dmFyIGI9bnVsbDthPyhhPU9wZW5MYXllcnMuRm9ybWF0LlhNTC5wcm90b3R5cGUucmVhZC5hcHBseSh0aGlzLFthXSksYT1hLmRvY3VtZW50RWxlbWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcIkVSUk9SXCIpLGI9bnVsbCE9PWEmJjA8YS5sZW5ndGgpOmI9XCJcIiE9PXRoaXMucmVzcG9uc2UuZXJyb3I7cmV0dXJuIGJ9LHJlYWQ6ZnVuY3Rpb24oYSl7XCJzdHJpbmdcIj09dHlwZW9mIGEmJihhPU9wZW5MYXllcnMuRm9ybWF0LlhNTC5wcm90b3R5cGUucmVhZC5hcHBseSh0aGlzLFthXSkpO3ZhciBiPW51bGw7YSYmYS5kb2N1bWVudEVsZW1lbnQmJihiPVwiQVJDWE1MXCI9PWEuZG9jdW1lbnRFbGVtZW50Lm5vZGVOYW1lP2EuZG9jdW1lbnRFbGVtZW50OmEuZG9jdW1lbnRFbGVtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiQVJDWE1MXCIpWzBdKTtcbmlmKCFifHxcInBhcnNlcmVycm9yXCI9PT1iLmZpcnN0Q2hpbGQubm9kZU5hbWUpe3ZhciBjLGQ7dHJ5e2M9YS5maXJzdENoaWxkLm5vZGVWYWx1ZSxkPWEuZmlyc3RDaGlsZC5jaGlsZE5vZGVzWzFdLmZpcnN0Q2hpbGQubm9kZVZhbHVlfWNhdGNoKGUpe310aHJvd3ttZXNzYWdlOlwiRXJyb3IgcGFyc2luZyB0aGUgQXJjWE1MIHJlcXVlc3RcIixlcnJvcjpjLHNvdXJjZTpkfTt9cmV0dXJuIHRoaXMucGFyc2VSZXNwb25zZShiKX0sd3JpdGU6ZnVuY3Rpb24oYSl7YXx8KGE9dGhpcy5yZXF1ZXN0KTt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROUyhcIlwiLFwiQVJDWE1MXCIpO2Iuc2V0QXR0cmlidXRlKFwidmVyc2lvblwiLFwiMS4xXCIpO3ZhciBjPXRoaXMuY3JlYXRlRWxlbWVudE5TKFwiXCIsXCJSRVFVRVNUXCIpO2lmKG51bGwhPWEuZ2V0X2ltYWdlKXt2YXIgZD10aGlzLmNyZWF0ZUVsZW1lbnROUyhcIlwiLFwiR0VUX0lNQUdFXCIpO2MuYXBwZW5kQ2hpbGQoZCk7dmFyIGU9dGhpcy5jcmVhdGVFbGVtZW50TlMoXCJcIixcblwiUFJPUEVSVElFU1wiKTtkLmFwcGVuZENoaWxkKGUpO2E9YS5nZXRfaW1hZ2UucHJvcGVydGllcztudWxsIT1hLmZlYXR1cmVjb29yZHN5cyYmKGQ9dGhpcy5jcmVhdGVFbGVtZW50TlMoXCJcIixcIkZFQVRVUkVDT09SRFNZU1wiKSxlLmFwcGVuZENoaWxkKGQpLDA9PT1hLmZlYXR1cmVjb29yZHN5cy5pZD9kLnNldEF0dHJpYnV0ZShcInN0cmluZ1wiLGEuZmVhdHVyZWNvb3Jkc3lzLnN0cmluZyk6ZC5zZXRBdHRyaWJ1dGUoXCJpZFwiLGEuZmVhdHVyZWNvb3Jkc3lzLmlkKSk7bnVsbCE9YS5maWx0ZXJjb29yZHN5cyYmKGQ9dGhpcy5jcmVhdGVFbGVtZW50TlMoXCJcIixcIkZJTFRFUkNPT1JEU1lTXCIpLGUuYXBwZW5kQ2hpbGQoZCksMD09PWEuZmlsdGVyY29vcmRzeXMuaWQ/ZC5zZXRBdHRyaWJ1dGUoXCJzdHJpbmdcIixhLmZpbHRlcmNvb3Jkc3lzLnN0cmluZyk6ZC5zZXRBdHRyaWJ1dGUoXCJpZFwiLGEuZmlsdGVyY29vcmRzeXMuaWQpKTtudWxsIT1hLmVudmVsb3BlJiYoZD10aGlzLmNyZWF0ZUVsZW1lbnROUyhcIlwiLFxuXCJFTlZFTE9QRVwiKSxlLmFwcGVuZENoaWxkKGQpLGQuc2V0QXR0cmlidXRlKFwibWlueFwiLGEuZW52ZWxvcGUubWlueCksZC5zZXRBdHRyaWJ1dGUoXCJtaW55XCIsYS5lbnZlbG9wZS5taW55KSxkLnNldEF0dHJpYnV0ZShcIm1heHhcIixhLmVudmVsb3BlLm1heHgpLGQuc2V0QXR0cmlidXRlKFwibWF4eVwiLGEuZW52ZWxvcGUubWF4eSkpO2Q9dGhpcy5jcmVhdGVFbGVtZW50TlMoXCJcIixcIklNQUdFU0laRVwiKTtlLmFwcGVuZENoaWxkKGQpO2Quc2V0QXR0cmlidXRlKFwiaGVpZ2h0XCIsYS5pbWFnZXNpemUuaGVpZ2h0KTtkLnNldEF0dHJpYnV0ZShcIndpZHRoXCIsYS5pbWFnZXNpemUud2lkdGgpO2lmKGEuaW1hZ2VzaXplLmhlaWdodCE9YS5pbWFnZXNpemUucHJpbnRoZWlnaHR8fGEuaW1hZ2VzaXplLndpZHRoIT1hLmltYWdlc2l6ZS5wcmludHdpZHRoKWQuc2V0QXR0cmlidXRlKFwicHJpbnRoZWlnaHRcIixhLmltYWdlc2l6ZS5wcmludGhlaWdodCksZC5zZXRBcnJ0aWJ1dGUoXCJwcmludHdpZHRoXCIsYS5pbWFnZXNpemUucHJpbnR3aWR0aCk7XG5udWxsIT1hLmJhY2tncm91bmQmJihkPXRoaXMuY3JlYXRlRWxlbWVudE5TKFwiXCIsXCJCQUNLR1JPVU5EXCIpLGUuYXBwZW5kQ2hpbGQoZCksZC5zZXRBdHRyaWJ1dGUoXCJjb2xvclwiLGEuYmFja2dyb3VuZC5jb2xvci5yK1wiLFwiK2EuYmFja2dyb3VuZC5jb2xvci5nK1wiLFwiK2EuYmFja2dyb3VuZC5jb2xvci5iKSxudWxsIT09YS5iYWNrZ3JvdW5kLnRyYW5zY29sb3ImJmQuc2V0QXR0cmlidXRlKFwidHJhbnNjb2xvclwiLGEuYmFja2dyb3VuZC50cmFuc2NvbG9yLnIrXCIsXCIrYS5iYWNrZ3JvdW5kLnRyYW5zY29sb3IuZytcIixcIithLmJhY2tncm91bmQudHJhbnNjb2xvci5iKSk7aWYobnVsbCE9YS5sYXllcmxpc3QmJjA8YS5sYXllcmxpc3QubGVuZ3RoKXtkPXRoaXMuY3JlYXRlRWxlbWVudE5TKFwiXCIsXCJMQVlFUkxJU1RcIik7ZS5hcHBlbmRDaGlsZChkKTtmb3IoZT0wO2U8YS5sYXllcmxpc3QubGVuZ3RoO2UrKyl7dmFyIGY9dGhpcy5jcmVhdGVFbGVtZW50TlMoXCJcIixcIkxBWUVSREVGXCIpO2QuYXBwZW5kQ2hpbGQoZik7XG5mLnNldEF0dHJpYnV0ZShcImlkXCIsYS5sYXllcmxpc3RbZV0uaWQpO2Yuc2V0QXR0cmlidXRlKFwidmlzaWJsZVwiLGEubGF5ZXJsaXN0W2VdLnZpc2libGUpO2lmKFwib2JqZWN0XCI9PXR5cGVvZiBhLmxheWVybGlzdFtlXS5xdWVyeSl7dmFyIGc9YS5sYXllcmxpc3RbZV0ucXVlcnk7aWYoMD5nLndoZXJlLmxlbmd0aCljb250aW51ZTt2YXIgaD1udWxsLGg9XCJib29sZWFuXCI9PXR5cGVvZiBnLnNwYXRpYWxmaWx0ZXImJmcuc3BhdGlhbGZpbHRlcj90aGlzLmNyZWF0ZUVsZW1lbnROUyhcIlwiLFwiU1BBVElBTFFVRVJZXCIpOnRoaXMuY3JlYXRlRWxlbWVudE5TKFwiXCIsXCJRVUVSWVwiKTtoLnNldEF0dHJpYnV0ZShcIndoZXJlXCIsZy53aGVyZSk7XCJudW1iZXJcIj09dHlwZW9mIGcuYWNjdXJhY3kmJjA8Zy5hY2N1cmFjeSYmaC5zZXRBdHRyaWJ1dGUoXCJhY2N1cmFjeVwiLGcuYWNjdXJhY3kpO1wibnVtYmVyXCI9PXR5cGVvZiBnLmZlYXR1cmVsaW1pdCYmMkUzPmcuZmVhdHVyZWxpbWl0JiZoLnNldEF0dHJpYnV0ZShcImZlYXR1cmVsaW1pdFwiLFxuZy5mZWF0dXJlbGltaXQpO1wic3RyaW5nXCI9PXR5cGVvZiBnLnN1YmZpZWxkcyYmXCIjQUxMI1wiIT1nLnN1YmZpZWxkcyYmaC5zZXRBdHRyaWJ1dGUoXCJzdWJmaWVsZHNcIixnLnN1YmZpZWxkcyk7XCJzdHJpbmdcIj09dHlwZW9mIGcuam9pbmV4cHJlc3Npb24mJjA8Zy5qb2luZXhwcmVzc2lvbi5sZW5ndGgmJmguc2V0QXR0cmlidXRlKFwiam9pbmV4cHJlc3Npb25cIixnLmpvaW5leHByZXNzaW9uKTtcInN0cmluZ1wiPT10eXBlb2YgZy5qb2ludGFibGVzJiYwPGcuam9pbnRhYmxlcy5sZW5ndGgmJmguc2V0QXR0cmlidXRlKFwiam9pbnRhYmxlc1wiLGcuam9pbnRhYmxlcyk7Zi5hcHBlbmRDaGlsZChoKX1cIm9iamVjdFwiPT10eXBlb2YgYS5sYXllcmxpc3RbZV0ucmVuZGVyZXImJnRoaXMuYWRkUmVuZGVyZXIoZixhLmxheWVybGlzdFtlXS5yZW5kZXJlcil9fX1lbHNlIGlmKG51bGwhPWEuZ2V0X2ZlYXR1cmUmJihkPXRoaXMuY3JlYXRlRWxlbWVudE5TKFwiXCIsXCJHRVRfRkVBVFVSRVNcIiksZC5zZXRBdHRyaWJ1dGUoXCJvdXRwdXRtb2RlXCIsXG5cIm5ld3htbFwiKSxkLnNldEF0dHJpYnV0ZShcImNoZWNrZXNjXCIsXCJ0cnVlXCIpLGEuZ2V0X2ZlYXR1cmUuZ2VvbWV0cnk/ZC5zZXRBdHRyaWJ1dGUoXCJnZW9tZXRyeVwiLGEuZ2V0X2ZlYXR1cmUuZ2VvbWV0cnkpOmQuc2V0QXR0cmlidXRlKFwiZ2VvbWV0cnlcIixcImZhbHNlXCIpLGEuZ2V0X2ZlYXR1cmUuY29tcGFjdCYmZC5zZXRBdHRyaWJ1dGUoXCJjb21wYWN0XCIsYS5nZXRfZmVhdHVyZS5jb21wYWN0KSxcIm51bWJlclwiPT1hLmdldF9mZWF0dXJlLmZlYXR1cmVsaW1pdCYmZC5zZXRBdHRyaWJ1dGUoXCJmZWF0dXJlbGltaXRcIixhLmdldF9mZWF0dXJlLmZlYXR1cmVsaW1pdCksZC5zZXRBdHRyaWJ1dGUoXCJnbG9iYWxlbnZlbG9wZVwiLFwidHJ1ZVwiKSxjLmFwcGVuZENoaWxkKGQpLG51bGwhPWEuZ2V0X2ZlYXR1cmUubGF5ZXImJjA8YS5nZXRfZmVhdHVyZS5sYXllci5sZW5ndGgmJihlPXRoaXMuY3JlYXRlRWxlbWVudE5TKFwiXCIsXCJMQVlFUlwiKSxlLnNldEF0dHJpYnV0ZShcImlkXCIsYS5nZXRfZmVhdHVyZS5sYXllciksXG5kLmFwcGVuZENoaWxkKGUpKSxhPWEuZ2V0X2ZlYXR1cmUucXVlcnksbnVsbCE9YSkpZT1udWxsLGU9YS5pc3NwYXRpYWw/dGhpcy5jcmVhdGVFbGVtZW50TlMoXCJcIixcIlNQQVRJQUxRVUVSWVwiKTp0aGlzLmNyZWF0ZUVsZW1lbnROUyhcIlwiLFwiUVVFUllcIiksZC5hcHBlbmRDaGlsZChlKSxcIm51bWJlclwiPT10eXBlb2YgYS5hY2N1cmFjeSYmZS5zZXRBdHRyaWJ1dGUoXCJhY2N1cmFjeVwiLGEuYWNjdXJhY3kpLG51bGwhPWEuZmVhdHVyZWNvb3Jkc3lzJiYoZD10aGlzLmNyZWF0ZUVsZW1lbnROUyhcIlwiLFwiRkVBVFVSRUNPT1JEU1lTXCIpLDA9PWEuZmVhdHVyZWNvb3Jkc3lzLmlkP2Quc2V0QXR0cmlidXRlKFwic3RyaW5nXCIsYS5mZWF0dXJlY29vcmRzeXMuc3RyaW5nKTpkLnNldEF0dHJpYnV0ZShcImlkXCIsYS5mZWF0dXJlY29vcmRzeXMuaWQpLGUuYXBwZW5kQ2hpbGQoZCkpLG51bGwhPWEuZmlsdGVyY29vcmRzeXMmJihkPXRoaXMuY3JlYXRlRWxlbWVudE5TKFwiXCIsXCJGSUxURVJDT09SRFNZU1wiKSxcbjA9PT1hLmZpbHRlcmNvb3Jkc3lzLmlkP2Quc2V0QXR0cmlidXRlKFwic3RyaW5nXCIsYS5maWx0ZXJjb29yZHN5cy5zdHJpbmcpOmQuc2V0QXR0cmlidXRlKFwiaWRcIixhLmZpbHRlcmNvb3Jkc3lzLmlkKSxlLmFwcGVuZENoaWxkKGQpKSwwPGEuYnVmZmVyJiYoZD10aGlzLmNyZWF0ZUVsZW1lbnROUyhcIlwiLFwiQlVGRkVSXCIpLGQuc2V0QXR0cmlidXRlKFwiZGlzdGFuY2VcIixhLmJ1ZmZlciksZS5hcHBlbmRDaGlsZChkKSksYS5pc3NwYXRpYWwmJihkPXRoaXMuY3JlYXRlRWxlbWVudE5TKFwiXCIsXCJTUEFUSUFMRklMVEVSXCIpLGQuc2V0QXR0cmlidXRlKFwicmVsYXRpb25cIixhLnNwYXRpYWxmaWx0ZXIucmVsYXRpb24pLGUuYXBwZW5kQ2hpbGQoZCksYS5zcGF0aWFsZmlsdGVyLmVudmVsb3BlPyhmPXRoaXMuY3JlYXRlRWxlbWVudE5TKFwiXCIsXCJFTlZFTE9QRVwiKSxmLnNldEF0dHJpYnV0ZShcIm1pbnhcIixhLnNwYXRpYWxmaWx0ZXIuZW52ZWxvcGUubWlueCksZi5zZXRBdHRyaWJ1dGUoXCJtaW55XCIsYS5zcGF0aWFsZmlsdGVyLmVudmVsb3BlLm1pbnkpLFxuZi5zZXRBdHRyaWJ1dGUoXCJtYXh4XCIsYS5zcGF0aWFsZmlsdGVyLmVudmVsb3BlLm1heHgpLGYuc2V0QXR0cmlidXRlKFwibWF4eVwiLGEuc3BhdGlhbGZpbHRlci5lbnZlbG9wZS5tYXh5KSxkLmFwcGVuZENoaWxkKGYpKTpcIm9iamVjdFwiPT10eXBlb2YgYS5zcGF0aWFsZmlsdGVyLnBvbHlnb24mJmQuYXBwZW5kQ2hpbGQodGhpcy53cml0ZVBvbHlnb25HZW9tZXRyeShhLnNwYXRpYWxmaWx0ZXIucG9seWdvbikpKSxudWxsIT1hLndoZXJlJiYwPGEud2hlcmUubGVuZ3RoJiZlLnNldEF0dHJpYnV0ZShcIndoZXJlXCIsYS53aGVyZSk7Yi5hcHBlbmRDaGlsZChjKTtyZXR1cm4gT3BlbkxheWVycy5Gb3JtYXQuWE1MLnByb3RvdHlwZS53cml0ZS5hcHBseSh0aGlzLFtiXSl9LGFkZEdyb3VwUmVuZGVyZXI6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmNyZWF0ZUVsZW1lbnROUyhcIlwiLFwiR1JPVVBSRU5ERVJFUlwiKTthLmFwcGVuZENoaWxkKGMpO2Zvcih2YXIgZD0wO2Q8Yi5sZW5ndGg7ZCsrKXRoaXMuYWRkUmVuZGVyZXIoYyxcbmJbZF0pfSxhZGRSZW5kZXJlcjpmdW5jdGlvbihhLGIpe2lmKE9wZW5MYXllcnMuVXRpbC5pc0FycmF5KGIpKXRoaXMuYWRkR3JvdXBSZW5kZXJlcihhLGIpO2Vsc2V7dmFyIGM9dGhpcy5jcmVhdGVFbGVtZW50TlMoXCJcIixiLnR5cGUudG9VcHBlckNhc2UoKStcIlJFTkRFUkVSXCIpO2EuYXBwZW5kQ2hpbGQoYyk7XCJWQUxVRU1BUFJFTkRFUkVSXCI9PWMudGFnTmFtZT90aGlzLmFkZFZhbHVlTWFwUmVuZGVyZXIoYyxiKTpcIlZBTFVFTUFQTEFCRUxSRU5ERVJFUlwiPT1jLnRhZ05hbWU/dGhpcy5hZGRWYWx1ZU1hcExhYmVsUmVuZGVyZXIoYyxiKTpcIlNJTVBMRUxBQkVMUkVOREVSRVJcIj09Yy50YWdOYW1lP3RoaXMuYWRkU2ltcGxlTGFiZWxSZW5kZXJlcihjLGIpOlwiU0NBTEVERVBFTkRFTlRSRU5ERVJFUlwiPT1jLnRhZ05hbWUmJnRoaXMuYWRkU2NhbGVEZXBlbmRlbnRSZW5kZXJlcihjLGIpfX0sYWRkU2NhbGVEZXBlbmRlbnRSZW5kZXJlcjpmdW5jdGlvbihhLGIpeyhcInN0cmluZ1wiPT10eXBlb2YgYi5sb3dlcnx8XG5cIm51bWJlclwiPT10eXBlb2YgYi5sb3dlcikmJmEuc2V0QXR0cmlidXRlKFwibG93ZXJcIixiLmxvd2VyKTsoXCJzdHJpbmdcIj09dHlwZW9mIGIudXBwZXJ8fFwibnVtYmVyXCI9PXR5cGVvZiBiLnVwcGVyKSYmYS5zZXRBdHRyaWJ1dGUoXCJ1cHBlclwiLGIudXBwZXIpO3RoaXMuYWRkUmVuZGVyZXIoYSxiLnJlbmRlcmVyKX0sYWRkVmFsdWVNYXBMYWJlbFJlbmRlcmVyOmZ1bmN0aW9uKGEsYil7YS5zZXRBdHRyaWJ1dGUoXCJsb29rdXBmaWVsZFwiLGIubG9va3VwZmllbGQpO2Euc2V0QXR0cmlidXRlKFwibGFiZWxmaWVsZFwiLGIubGFiZWxmaWVsZCk7aWYoXCJvYmplY3RcIj09dHlwZW9mIGIuZXhhY3RzKWZvcih2YXIgYz0wLGQ9Yi5leGFjdHMubGVuZ3RoO2M8ZDtjKyspe3ZhciBlPWIuZXhhY3RzW2NdLGY9dGhpcy5jcmVhdGVFbGVtZW50TlMoXCJcIixcIkVYQUNUXCIpO1wic3RyaW5nXCI9PXR5cGVvZiBlLnZhbHVlJiZmLnNldEF0dHJpYnV0ZShcInZhbHVlXCIsZS52YWx1ZSk7XCJzdHJpbmdcIj09dHlwZW9mIGUubGFiZWwmJlxuZi5zZXRBdHRyaWJ1dGUoXCJsYWJlbFwiLGUubGFiZWwpO1wic3RyaW5nXCI9PXR5cGVvZiBlLm1ldGhvZCYmZi5zZXRBdHRyaWJ1dGUoXCJtZXRob2RcIixlLm1ldGhvZCk7YS5hcHBlbmRDaGlsZChmKTtpZihcIm9iamVjdFwiPT10eXBlb2YgZS5zeW1ib2wpe3ZhciBnPW51bGw7XCJ0ZXh0XCI9PWUuc3ltYm9sLnR5cGUmJihnPXRoaXMuY3JlYXRlRWxlbWVudE5TKFwiXCIsXCJURVhUU1lNQk9MXCIpKTtpZihudWxsIT1nKXtmb3IodmFyIGg9dGhpcy5mb250U3R5bGVLZXlzLGk9MCxqPWgubGVuZ3RoO2k8ajtpKyspe3ZhciBrPWhbaV07ZS5zeW1ib2xba10mJmcuc2V0QXR0cmlidXRlKGssZS5zeW1ib2xba10pfWYuYXBwZW5kQ2hpbGQoZyl9fX19LGFkZFZhbHVlTWFwUmVuZGVyZXI6ZnVuY3Rpb24oYSxiKXthLnNldEF0dHJpYnV0ZShcImxvb2t1cGZpZWxkXCIsYi5sb29rdXBmaWVsZCk7aWYoXCJvYmplY3RcIj09dHlwZW9mIGIucmFuZ2VzKWZvcih2YXIgYz0wLGQ9Yi5yYW5nZXMubGVuZ3RoO2M8ZDtjKyspe3ZhciBlPVxuYi5yYW5nZXNbY10sZj10aGlzLmNyZWF0ZUVsZW1lbnROUyhcIlwiLFwiUkFOR0VcIik7Zi5zZXRBdHRyaWJ1dGUoXCJsb3dlclwiLGUubG93ZXIpO2Yuc2V0QXR0cmlidXRlKFwidXBwZXJcIixlLnVwcGVyKTthLmFwcGVuZENoaWxkKGYpO2lmKFwib2JqZWN0XCI9PXR5cGVvZiBlLnN5bWJvbCl7dmFyIGc9bnVsbDtcInNpbXBsZXBvbHlnb25cIj09ZS5zeW1ib2wudHlwZSYmKGc9dGhpcy5jcmVhdGVFbGVtZW50TlMoXCJcIixcIlNJTVBMRVBPTFlHT05TWU1CT0xcIikpO251bGwhPWcmJihcInN0cmluZ1wiPT10eXBlb2YgZS5zeW1ib2wuYm91bmRhcnljb2xvciYmZy5zZXRBdHRyaWJ1dGUoXCJib3VuZGFyeWNvbG9yXCIsZS5zeW1ib2wuYm91bmRhcnljb2xvciksXCJzdHJpbmdcIj09dHlwZW9mIGUuc3ltYm9sLmZpbGxjb2xvciYmZy5zZXRBdHRyaWJ1dGUoXCJmaWxsY29sb3JcIixlLnN5bWJvbC5maWxsY29sb3IpLFwibnVtYmVyXCI9PXR5cGVvZiBlLnN5bWJvbC5maWxsdHJhbnNwYXJlbmN5JiZnLnNldEF0dHJpYnV0ZShcImZpbGx0cmFuc3BhcmVuY3lcIixcbmUuc3ltYm9sLmZpbGx0cmFuc3BhcmVuY3kpLGYuYXBwZW5kQ2hpbGQoZykpfX1lbHNlIGlmKFwib2JqZWN0XCI9PXR5cGVvZiBiLmV4YWN0cyl7Yz0wO2ZvcihkPWIuZXhhY3RzLmxlbmd0aDtjPGQ7YysrKWU9Yi5leGFjdHNbY10sZj10aGlzLmNyZWF0ZUVsZW1lbnROUyhcIlwiLFwiRVhBQ1RcIiksXCJzdHJpbmdcIj09dHlwZW9mIGUudmFsdWUmJmYuc2V0QXR0cmlidXRlKFwidmFsdWVcIixlLnZhbHVlKSxcInN0cmluZ1wiPT10eXBlb2YgZS5sYWJlbCYmZi5zZXRBdHRyaWJ1dGUoXCJsYWJlbFwiLGUubGFiZWwpLFwic3RyaW5nXCI9PXR5cGVvZiBlLm1ldGhvZCYmZi5zZXRBdHRyaWJ1dGUoXCJtZXRob2RcIixlLm1ldGhvZCksYS5hcHBlbmRDaGlsZChmKSxcIm9iamVjdFwiPT10eXBlb2YgZS5zeW1ib2wmJihnPW51bGwsXCJzaW1wbGVtYXJrZXJcIj09ZS5zeW1ib2wudHlwZSYmKGc9dGhpcy5jcmVhdGVFbGVtZW50TlMoXCJcIixcIlNJTVBMRU1BUktFUlNZTUJPTFwiKSksbnVsbCE9ZyYmKFwic3RyaW5nXCI9PXR5cGVvZiBlLnN5bWJvbC5hbnRpYWxpYXNpbmcmJlxuZy5zZXRBdHRyaWJ1dGUoXCJhbnRpYWxpYXNpbmdcIixlLnN5bWJvbC5hbnRpYWxpYXNpbmcpLFwic3RyaW5nXCI9PXR5cGVvZiBlLnN5bWJvbC5jb2xvciYmZy5zZXRBdHRyaWJ1dGUoXCJjb2xvclwiLGUuc3ltYm9sLmNvbG9yKSxcInN0cmluZ1wiPT10eXBlb2YgZS5zeW1ib2wub3V0bGluZSYmZy5zZXRBdHRyaWJ1dGUoXCJvdXRsaW5lXCIsZS5zeW1ib2wub3V0bGluZSksXCJzdHJpbmdcIj09dHlwZW9mIGUuc3ltYm9sLm92ZXJsYXAmJmcuc2V0QXR0cmlidXRlKFwib3ZlcmxhcFwiLGUuc3ltYm9sLm92ZXJsYXApLFwic3RyaW5nXCI9PXR5cGVvZiBlLnN5bWJvbC5zaGFkb3cmJmcuc2V0QXR0cmlidXRlKFwic2hhZG93XCIsZS5zeW1ib2wuc2hhZG93KSxcIm51bWJlclwiPT10eXBlb2YgZS5zeW1ib2wudHJhbnNwYXJlbmN5JiZnLnNldEF0dHJpYnV0ZShcInRyYW5zcGFyZW5jeVwiLGUuc3ltYm9sLnRyYW5zcGFyZW5jeSksXCJzdHJpbmdcIj09dHlwZW9mIGUuc3ltYm9sLnVzZWNlbnRyb2lkJiZnLnNldEF0dHJpYnV0ZShcInVzZWNlbnRyb2lkXCIsXG5lLnN5bWJvbC51c2VjZW50cm9pZCksXCJudW1iZXJcIj09dHlwZW9mIGUuc3ltYm9sLndpZHRoJiZnLnNldEF0dHJpYnV0ZShcIndpZHRoXCIsZS5zeW1ib2wud2lkdGgpLGYuYXBwZW5kQ2hpbGQoZykpKX19LGFkZFNpbXBsZUxhYmVsUmVuZGVyZXI6ZnVuY3Rpb24oYSxiKXthLnNldEF0dHJpYnV0ZShcImZpZWxkXCIsYi5maWVsZCk7Zm9yKHZhciBjPVwiZmVhdHVyZXdlaWdodCBob3dtYW55bGFiZWxzIGxhYmVsYnVmZmVycmF0aW8gbGFiZWxwcmlvcml0aWVzIGxhYmVsd2VpZ2h0IGxpbmVsYWJlbHBvc2l0aW9uIHJvdGF0aW9uYWxhbmdsZXNcIi5zcGxpdChcIiBcIiksZD0wLGU9Yy5sZW5ndGg7ZDxlO2QrKyl7dmFyIGY9Y1tkXTtiW2ZdJiZhLnNldEF0dHJpYnV0ZShmLGJbZl0pfWlmKFwidGV4dFwiPT1iLnN5bWJvbC50eXBlKXt2YXIgZz1iLnN5bWJvbCxoPXRoaXMuY3JlYXRlRWxlbWVudE5TKFwiXCIsXCJURVhUU1lNQk9MXCIpO2EuYXBwZW5kQ2hpbGQoaCk7Yz10aGlzLmZvbnRTdHlsZUtleXM7ZD0wO1xuZm9yKGU9Yy5sZW5ndGg7ZDxlO2QrKylmPWNbZF0sZ1tmXSYmaC5zZXRBdHRyaWJ1dGUoZixiW2ZdKX19LHdyaXRlUG9seWdvbkdlb21ldHJ5OmZ1bmN0aW9uKGEpe2lmKCEoYSBpbnN0YW5jZW9mIE9wZW5MYXllcnMuR2VvbWV0cnkuUG9seWdvbikpdGhyb3d7bWVzc2FnZTpcIkNhbm5vdCB3cml0ZSBwb2x5Z29uIGdlb21ldHJ5IHRvIEFyY1hNTCB3aXRoIGFuIFwiK2EuQ0xBU1NfTkFNRStcIiBvYmplY3QuXCIsZ2VvbWV0cnk6YX07Zm9yKHZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TKFwiXCIsXCJQT0xZR09OXCIpLGM9MCxkPWEuY29tcG9uZW50cy5sZW5ndGg7YzxkO2MrKyl7Zm9yKHZhciBlPWEuY29tcG9uZW50c1tjXSxmPXRoaXMuY3JlYXRlRWxlbWVudE5TKFwiXCIsXCJSSU5HXCIpLGc9MCxoPWUuY29tcG9uZW50cy5sZW5ndGg7ZzxoO2crKyl7dmFyIGk9ZS5jb21wb25lbnRzW2ddLGo9dGhpcy5jcmVhdGVFbGVtZW50TlMoXCJcIixcIlBPSU5UXCIpO2ouc2V0QXR0cmlidXRlKFwieFwiLGkueCk7ai5zZXRBdHRyaWJ1dGUoXCJ5XCIsXG5pLnkpO2YuYXBwZW5kQ2hpbGQoail9Yi5hcHBlbmRDaGlsZChmKX1yZXR1cm4gYn0scGFyc2VSZXNwb25zZTpmdW5jdGlvbihhKXtcInN0cmluZ1wiPT10eXBlb2YgYSYmKGE9KG5ldyBPcGVuTGF5ZXJzLkZvcm1hdC5YTUwpLnJlYWQoYSkpO3ZhciBiPW5ldyBPcGVuTGF5ZXJzLkZvcm1hdC5BcmNYTUwuUmVzcG9uc2UsYz1hLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiRVJST1JcIik7aWYobnVsbCE9YyYmMDxjLmxlbmd0aCliLmVycm9yPXRoaXMuZ2V0Q2hpbGRWYWx1ZShjLFwiVW5rbm93biBlcnJvci5cIik7ZWxzZXtjPWEuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJSRVNQT05TRVwiKTtpZihudWxsPT1jfHwwPT1jLmxlbmd0aClyZXR1cm4gYi5lcnJvcj1cIk5vIFJFU1BPTlNFIHRhZyBmb3VuZCBpbiBBcmNYTUwgcmVzcG9uc2UuXCIsYjt2YXIgZD1jWzBdLmZpcnN0Q2hpbGQubm9kZU5hbWU7XCIjdGV4dFwiPT1kJiYoZD1jWzBdLmZpcnN0Q2hpbGQubmV4dFNpYmxpbmcubm9kZU5hbWUpO2lmKFwiSU1BR0VcIj09XG5kKWM9YS5nZXRFbGVtZW50c0J5VGFnTmFtZShcIkVOVkVMT1BFXCIpLGE9YS5nZXRFbGVtZW50c0J5VGFnTmFtZShcIk9VVFBVVFwiKSxudWxsPT1jfHwwPT1jLmxlbmd0aD9iLmVycm9yPVwiTm8gRU5WRUxPUEUgdGFnIGZvdW5kIGluIEFyY1hNTCByZXNwb25zZS5cIjpudWxsPT1hfHwwPT1hLmxlbmd0aD9iLmVycm9yPVwiTm8gT1VUUFVUIHRhZyBmb3VuZCBpbiBBcmNYTUwgcmVzcG9uc2UuXCI6KGM9dGhpcy5wYXJzZUF0dHJpYnV0ZXMoY1swXSksZD10aGlzLnBhcnNlQXR0cmlidXRlcyhhWzBdKSxiLmltYWdlPVwic3RyaW5nXCI9PXR5cGVvZiBkLnR5cGU/e2VudmVsb3BlOmMsb3V0cHV0Ont0eXBlOmQudHlwZSxkYXRhOnRoaXMuZ2V0Q2hpbGRWYWx1ZShhWzBdKX19OntlbnZlbG9wZTpjLG91dHB1dDpkfSk7ZWxzZSBpZihcIkZFQVRVUkVTXCI9PWQpe2lmKGE9Y1swXS5nZXRFbGVtZW50c0J5VGFnTmFtZShcIkZFQVRVUkVTXCIpLGM9YVswXS5nZXRFbGVtZW50c0J5VGFnTmFtZShcIkZFQVRVUkVDT1VOVFwiKSxcbmIuZmVhdHVyZXMuZmVhdHVyZWNvdW50PWNbMF0uZ2V0QXR0cmlidXRlKFwiY291bnRcIiksMDxiLmZlYXR1cmVzLmZlYXR1cmVjb3VudCl7Yz1hWzBdLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiRU5WRUxPUEVcIik7Yi5mZWF0dXJlcy5lbnZlbG9wZT10aGlzLnBhcnNlQXR0cmlidXRlcyhjWzBdLFwibnVtYmVyXCIpO2E9YVswXS5nZXRFbGVtZW50c0J5VGFnTmFtZShcIkZFQVRVUkVcIik7Zm9yKGM9MDtjPGEubGVuZ3RoO2MrKyl7Zm9yKHZhciBkPW5ldyBPcGVuTGF5ZXJzLkZlYXR1cmUuVmVjdG9yLGU9YVtjXS5nZXRFbGVtZW50c0J5VGFnTmFtZShcIkZJRUxEXCIpLGY9MDtmPGUubGVuZ3RoO2YrKyl7dmFyIGc9ZVtmXS5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpLGg9ZVtmXS5nZXRBdHRyaWJ1dGUoXCJ2YWx1ZVwiKTtkLmF0dHJpYnV0ZXNbZ109aH1lPWFbY10uZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJQT0xZR09OXCIpO2lmKDA8ZS5sZW5ndGgpe2U9ZVswXS5nZXRFbGVtZW50c0J5VGFnTmFtZShcIlJJTkdcIik7XG5mPVtdO2ZvcihnPTA7ZzxlLmxlbmd0aDtnKyspe2g9W107aC5wdXNoKHRoaXMucGFyc2VQb2ludEdlb21ldHJ5KGVbZ10pKTtmb3IodmFyIGk9ZVtnXS5nZXRFbGVtZW50c0J5VGFnTmFtZShcIkhPTEVcIiksaj0wO2o8aS5sZW5ndGg7aisrKWgucHVzaCh0aGlzLnBhcnNlUG9pbnRHZW9tZXRyeShpW2pdKSk7Zi5wdXNoKG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvbHlnb24oaCkpfWQuZ2VvbWV0cnk9MT09Zi5sZW5ndGg/ZlswXTpuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5NdWx0aVBvbHlnb24oZil9Yi5mZWF0dXJlcy5mZWF0dXJlLnB1c2goZCl9fX1lbHNlIGIuZXJyb3I9XCJVbmlkZW50aWZpZWQgcmVzcG9uc2UgdHlwZS5cIn1yZXR1cm4gYn0scGFyc2VBdHRyaWJ1dGVzOmZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPXt9LGQ9MDtkPGEuYXR0cmlidXRlcy5sZW5ndGg7ZCsrKWNbYS5hdHRyaWJ1dGVzW2RdLm5vZGVOYW1lXT1cIm51bWJlclwiPT1iP3BhcnNlRmxvYXQoYS5hdHRyaWJ1dGVzW2RdLm5vZGVWYWx1ZSk6XG5hLmF0dHJpYnV0ZXNbZF0ubm9kZVZhbHVlO3JldHVybiBjfSxwYXJzZVBvaW50R2VvbWV0cnk6ZnVuY3Rpb24oYSl7dmFyIGI9W10sYz1hLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiQ09PUkRTXCIpO2lmKDA8Yy5sZW5ndGgpe2E9dGhpcy5nZXRDaGlsZFZhbHVlKGNbMF0pO2E9YS5zcGxpdCgvOy8pO2ZvcihjPTA7YzxhLmxlbmd0aDtjKyspe3ZhciBkPWFbY10uc3BsaXQoLyAvKTtiLnB1c2gobmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQoZFswXSxkWzFdKSl9fWVsc2UgaWYoYT1hLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiUE9JTlRcIiksMDxhLmxlbmd0aClmb3IoYz0wO2M8YS5sZW5ndGg7YysrKWIucHVzaChuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChwYXJzZUZsb2F0KGFbY10uZ2V0QXR0cmlidXRlKFwieFwiKSkscGFyc2VGbG9hdChhW2NdLmdldEF0dHJpYnV0ZShcInlcIikpKSk7cmV0dXJuIG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVhclJpbmcoYil9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZvcm1hdC5BcmNYTUxcIn0pO1xuT3BlbkxheWVycy5Gb3JtYXQuQXJjWE1MLlJlcXVlc3Q9T3BlbkxheWVycy5DbGFzcyh7aW5pdGlhbGl6ZTpmdW5jdGlvbigpe3JldHVybiBPcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHRoaXMse2dldF9pbWFnZTp7cHJvcGVydGllczp7YmFja2dyb3VuZDpudWxsLGRyYXc6ITAsZW52ZWxvcGU6e21pbng6MCxtaW55OjAsbWF4eDowLG1heHk6MH0sZmVhdHVyZWNvb3Jkc3lzOntpZDowLHN0cmluZzpcIlwiLGRhdHVtdHJhbnNmb3JtaWQ6MCxkYXR1bXRyYW5zZm9ybXN0cmluZzpcIlwifSxmaWx0ZXJjb29yZHN5czp7aWQ6MCxzdHJpbmc6XCJcIixkYXR1bXRyYW5zZm9ybWlkOjAsZGF0dW10cmFuc2Zvcm1zdHJpbmc6XCJcIn0saW1hZ2VzaXplOntoZWlnaHQ6MCx3aWR0aDowLGRwaTo5NixwcmludGhlaWdodDowLHByaW50d2lkdGg6MCxzY2FsZXN5bWJvbHM6ITF9LGxheWVybGlzdDpbXSxvdXRwdXQ6e2Jhc2V1cmw6XCJcIixsZWdlbmRiYXNldXJsOlwiXCIsbGVnZW5kbmFtZTpcIlwiLGxlZ2VuZHBhdGg6XCJcIixcbmxlZ2VuZHVybDpcIlwiLG5hbWU6XCJcIixwYXRoOlwiXCIsdHlwZTpcImpwZ1wiLHVybDpcIlwifX19LGdldF9mZWF0dXJlOntsYXllcjpcIlwiLHF1ZXJ5Ontpc3NwYXRpYWw6ITEsZmVhdHVyZWNvb3Jkc3lzOntpZDowLHN0cmluZzpcIlwiLGRhdHVtdHJhbnNmb3JtaWQ6MCxkYXR1bXRyYW5zZm9ybXN0cmluZzpcIlwifSxmaWx0ZXJjb29yZHN5czp7aWQ6MCxzdHJpbmc6XCJcIixkYXR1bXRyYW5zZm9ybWlkOjAsZGF0dW10cmFuc2Zvcm1zdHJpbmc6XCJcIn0sYnVmZmVyOjAsd2hlcmU6XCJcIixzcGF0aWFsZmlsdGVyOntyZWxhdGlvbjpcImVudmVsb3BlX2ludGVyc2VjdGlvblwiLGVudmVsb3BlOm51bGx9fX0sZW52aXJvbm1lbnQ6e3NlcGFyYXRvcnM6e2NzOlwiIFwiLHRzOlwiO1wifX0sbGF5ZXI6W10sd29ya3NwYWNlczpbXX0pfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Gb3JtYXQuQXJjWE1MLlJlcXVlc3RcIn0pO1xuT3BlbkxheWVycy5Gb3JtYXQuQXJjWE1MLlJlc3BvbnNlPU9wZW5MYXllcnMuQ2xhc3Moe2luaXRpYWxpemU6ZnVuY3Rpb24oKXtyZXR1cm4gT3BlbkxheWVycy5VdGlsLmV4dGVuZCh0aGlzLHtpbWFnZTp7ZW52ZWxvcGU6bnVsbCxvdXRwdXQ6XCJcIn0sZmVhdHVyZXM6e2ZlYXR1cmVjb3VudDowLGVudmVsb3BlOm51bGwsZmVhdHVyZTpbXX0sZXJyb3I6XCJcIn0pfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Gb3JtYXQuQXJjWE1MLlJlc3BvbnNlXCJ9KTtPcGVuTGF5ZXJzLlByb3h5SG9zdD1cIlwiO1xuT3BlbkxheWVycy5SZXF1ZXN0PXtERUZBVUxUX0NPTkZJRzp7bWV0aG9kOlwiR0VUXCIsdXJsOndpbmRvdy5sb2NhdGlvbi5ocmVmLGFzeW5jOiEwLHVzZXI6dm9pZCAwLHBhc3N3b3JkOnZvaWQgMCxwYXJhbXM6bnVsbCxwcm94eTpPcGVuTGF5ZXJzLlByb3h5SG9zdCxoZWFkZXJzOnt9LGRhdGE6bnVsbCxjYWxsYmFjazpmdW5jdGlvbigpe30sc3VjY2VzczpudWxsLGZhaWx1cmU6bnVsbCxzY29wZTpudWxsfSxVUkxfU1BMSVRfUkVHRVg6LyhbXjpdKjopXFwvXFwvKFteOl0qOj9bXkBdKkApPyhbXjpcXC9cXD9dKik6PyhbXlxcL1xcP10qKS8sZXZlbnRzOm5ldyBPcGVuTGF5ZXJzLkV2ZW50cyh0aGlzKSxtYWtlU2FtZU9yaWdpbjpmdW5jdGlvbihhLGIpe3ZhciBjPTAhPT1hLmluZGV4T2YoXCJodHRwXCIpLGQ9IWMmJmEubWF0Y2godGhpcy5VUkxfU1BMSVRfUkVHRVgpO2lmKGQpe3ZhciBlPXdpbmRvdy5sb2NhdGlvbixjPWRbMV09PWUucHJvdG9jb2wmJmRbM109PWUuaG9zdG5hbWUsZD1kWzRdLFxuZT1lLnBvcnQ7aWYoODAhPWQmJlwiXCIhPWR8fFwiODBcIiE9ZSYmXCJcIiE9ZSljPWMmJmQ9PWV9Y3x8KGI/YT1cImZ1bmN0aW9uXCI9PXR5cGVvZiBiP2IoYSk6YitlbmNvZGVVUklDb21wb25lbnQoYSk6T3BlbkxheWVycy5Db25zb2xlLndhcm4oT3BlbkxheWVycy5pMThuKFwicHJveHlOZWVkZWRcIikse3VybDphfSkpO3JldHVybiBhfSxpc3N1ZTpmdW5jdGlvbihhKXt2YXIgYj1PcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHRoaXMuREVGQVVMVF9DT05GSUcse3Byb3h5Ok9wZW5MYXllcnMuUHJveHlIb3N0fSksYT1PcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyhhLGIpLGI9ITEsYztmb3IoYyBpbiBhLmhlYWRlcnMpYS5oZWFkZXJzLmhhc093blByb3BlcnR5KGMpJiZcIngtcmVxdWVzdGVkLXdpdGhcIj09PWMudG9Mb3dlckNhc2UoKSYmKGI9ITApOyExPT09YiYmKGEuaGVhZGVyc1tcIlgtUmVxdWVzdGVkLVdpdGhcIl09XCJYTUxIdHRwUmVxdWVzdFwiKTt2YXIgZD1uZXcgT3BlbkxheWVycy5SZXF1ZXN0LlhNTEh0dHBSZXF1ZXN0LFxuZT1PcGVuTGF5ZXJzLlV0aWwudXJsQXBwZW5kKGEudXJsLE9wZW5MYXllcnMuVXRpbC5nZXRQYXJhbWV0ZXJTdHJpbmcoYS5wYXJhbXN8fHt9KSksZT1PcGVuTGF5ZXJzLlJlcXVlc3QubWFrZVNhbWVPcmlnaW4oZSxhLnByb3h5KTtkLm9wZW4oYS5tZXRob2QsZSxhLmFzeW5jLGEudXNlcixhLnBhc3N3b3JkKTtmb3IodmFyIGYgaW4gYS5oZWFkZXJzKWQuc2V0UmVxdWVzdEhlYWRlcihmLGEuaGVhZGVyc1tmXSk7dmFyIGc9dGhpcy5ldmVudHMsaD10aGlzO2Qub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCl7ZC5yZWFkeVN0YXRlPT1PcGVuTGF5ZXJzLlJlcXVlc3QuWE1MSHR0cFJlcXVlc3QuRE9ORSYmITEhPT1nLnRyaWdnZXJFdmVudChcImNvbXBsZXRlXCIse3JlcXVlc3Q6ZCxjb25maWc6YSxyZXF1ZXN0VXJsOmV9KSYmaC5ydW5DYWxsYmFja3Moe3JlcXVlc3Q6ZCxjb25maWc6YSxyZXF1ZXN0VXJsOmV9KX07ITE9PT1hLmFzeW5jP2Quc2VuZChhLmRhdGEpOndpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7MCE9PVxuZC5yZWFkeVN0YXRlJiZkLnNlbmQoYS5kYXRhKX0sMCk7cmV0dXJuIGR9LHJ1bkNhbGxiYWNrczpmdW5jdGlvbihhKXt2YXIgYj1hLnJlcXVlc3QsYz1hLmNvbmZpZyxkPWMuc2NvcGU/T3BlbkxheWVycy5GdW5jdGlvbi5iaW5kKGMuY2FsbGJhY2ssYy5zY29wZSk6Yy5jYWxsYmFjayxlO2Muc3VjY2VzcyYmKGU9Yy5zY29wZT9PcGVuTGF5ZXJzLkZ1bmN0aW9uLmJpbmQoYy5zdWNjZXNzLGMuc2NvcGUpOmMuc3VjY2Vzcyk7dmFyIGY7Yy5mYWlsdXJlJiYoZj1jLnNjb3BlP09wZW5MYXllcnMuRnVuY3Rpb24uYmluZChjLmZhaWx1cmUsYy5zY29wZSk6Yy5mYWlsdXJlKTtcImZpbGU6XCI9PU9wZW5MYXllcnMuVXRpbC5jcmVhdGVVcmxPYmplY3QoYy51cmwpLnByb3RvY29sJiZiLnJlc3BvbnNlVGV4dCYmKGIuc3RhdHVzPTIwMCk7ZChiKTtpZighYi5zdGF0dXN8fDIwMDw9Yi5zdGF0dXMmJjMwMD5iLnN0YXR1cyl0aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJzdWNjZXNzXCIsYSksZSYmZShiKTtcbmlmKGIuc3RhdHVzJiYoMjAwPmIuc3RhdHVzfHwzMDA8PWIuc3RhdHVzKSl0aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJmYWlsdXJlXCIsYSksZiYmZihiKX0sR0VUOmZ1bmN0aW9uKGEpe2E9T3BlbkxheWVycy5VdGlsLmV4dGVuZChhLHttZXRob2Q6XCJHRVRcIn0pO3JldHVybiBPcGVuTGF5ZXJzLlJlcXVlc3QuaXNzdWUoYSl9LFBPU1Q6ZnVuY3Rpb24oYSl7YT1PcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKGEse21ldGhvZDpcIlBPU1RcIn0pO2EuaGVhZGVycz1hLmhlYWRlcnM/YS5oZWFkZXJzOnt9O1wiQ09OVEVOVC1UWVBFXCJpbiBPcGVuTGF5ZXJzLlV0aWwudXBwZXJDYXNlT2JqZWN0KGEuaGVhZGVycyl8fChhLmhlYWRlcnNbXCJDb250ZW50LVR5cGVcIl09XCJhcHBsaWNhdGlvbi94bWxcIik7cmV0dXJuIE9wZW5MYXllcnMuUmVxdWVzdC5pc3N1ZShhKX0sUFVUOmZ1bmN0aW9uKGEpe2E9T3BlbkxheWVycy5VdGlsLmV4dGVuZChhLHttZXRob2Q6XCJQVVRcIn0pO2EuaGVhZGVycz1hLmhlYWRlcnM/XG5hLmhlYWRlcnM6e307XCJDT05URU5ULVRZUEVcImluIE9wZW5MYXllcnMuVXRpbC51cHBlckNhc2VPYmplY3QoYS5oZWFkZXJzKXx8KGEuaGVhZGVyc1tcIkNvbnRlbnQtVHlwZVwiXT1cImFwcGxpY2F0aW9uL3htbFwiKTtyZXR1cm4gT3BlbkxheWVycy5SZXF1ZXN0Lmlzc3VlKGEpfSxERUxFVEU6ZnVuY3Rpb24oYSl7YT1PcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKGEse21ldGhvZDpcIkRFTEVURVwifSk7cmV0dXJuIE9wZW5MYXllcnMuUmVxdWVzdC5pc3N1ZShhKX0sSEVBRDpmdW5jdGlvbihhKXthPU9wZW5MYXllcnMuVXRpbC5leHRlbmQoYSx7bWV0aG9kOlwiSEVBRFwifSk7cmV0dXJuIE9wZW5MYXllcnMuUmVxdWVzdC5pc3N1ZShhKX0sT1BUSU9OUzpmdW5jdGlvbihhKXthPU9wZW5MYXllcnMuVXRpbC5leHRlbmQoYSx7bWV0aG9kOlwiT1BUSU9OU1wifSk7cmV0dXJuIE9wZW5MYXllcnMuUmVxdWVzdC5pc3N1ZShhKX19O09wZW5MYXllcnMuTGF5ZXIuQXJjSU1TPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5MYXllci5HcmlkLHtERUZBVUxUX1BBUkFNUzp7Q2xpZW50VmVyc2lvbjpcIjkuMlwiLFNlcnZpY2VOYW1lOlwiXCJ9LGZlYXR1cmVDb29yZFN5czpcIjQzMjZcIixmaWx0ZXJDb29yZFN5czpcIjQzMjZcIixsYXllcnM6bnVsbCxhc3luYzohMCxuYW1lOlwiQXJjSU1TXCIsaXNCYXNlTGF5ZXI6ITAsREVGQVVMVF9PUFRJT05TOnt0aWxlU2l6ZTpuZXcgT3BlbkxheWVycy5TaXplKDUxMiw1MTIpLGZlYXR1cmVDb29yZFN5czpcIjQzMjZcIixmaWx0ZXJDb29yZFN5czpcIjQzMjZcIixsYXllcnM6bnVsbCxpc0Jhc2VMYXllcjohMCxhc3luYzohMCxuYW1lOlwiQXJjSU1TXCJ9LGluaXRpYWxpemU6ZnVuY3Rpb24oYSxiLGMpe3RoaXMudGlsZVNpemU9bmV3IE9wZW5MYXllcnMuU2l6ZSg1MTIsNTEyKTt0aGlzLnBhcmFtcz1PcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyh7U2VydmljZU5hbWU6Yy5zZXJ2aWNlTmFtZX0sXG50aGlzLkRFRkFVTFRfUEFSQU1TKTt0aGlzLm9wdGlvbnM9T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoYyx0aGlzLkRFRkFVTFRfT1BUSU9OUyk7T3BlbkxheWVycy5MYXllci5HcmlkLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsW2EsYix0aGlzLnBhcmFtcyxjXSk7aWYodGhpcy50cmFuc3BhcmVudCYmKHRoaXMuaXNCYXNlTGF5ZXJ8fCh0aGlzLmlzQmFzZUxheWVyPSExKSxcImltYWdlL2pwZWdcIj09dGhpcy5mb3JtYXQpKXRoaXMuZm9ybWF0PU9wZW5MYXllcnMuVXRpbC5hbHBoYUhhY2soKT9cImltYWdlL2dpZlwiOlwiaW1hZ2UvcG5nXCI7bnVsbD09PXRoaXMub3B0aW9ucy5sYXllcnMmJih0aGlzLm9wdGlvbnMubGF5ZXJzPVtdKX0sZ2V0VVJMOmZ1bmN0aW9uKGEpe3ZhciBiPVwiXCIsYT10aGlzLmFkanVzdEJvdW5kcyhhKSxhPW5ldyBPcGVuTGF5ZXJzLkZvcm1hdC5BcmNYTUwoT3BlbkxheWVycy5VdGlsLmV4dGVuZCh0aGlzLm9wdGlvbnMse3JlcXVlc3R0eXBlOlwiaW1hZ2VcIixcbmVudmVsb3BlOmEudG9BcnJheSgpLHRpbGVTaXplOnRoaXMudGlsZVNpemV9KSksYT1uZXcgT3BlbkxheWVycy5SZXF1ZXN0LlBPU1Qoe3VybDp0aGlzLmdldEZ1bGxSZXF1ZXN0U3RyaW5nKCksZGF0YTphLndyaXRlKCksYXN5bmM6ITF9KTtpZihudWxsIT1hKXtiPWEucmVzcG9uc2VYTUw7aWYoIWJ8fCFiLmRvY3VtZW50RWxlbWVudCliPWEucmVzcG9uc2VUZXh0O2I9dGhpcy5nZXRVcmxPckltYWdlKChuZXcgT3BlbkxheWVycy5Gb3JtYXQuQXJjWE1MKS5yZWFkKGIpLmltYWdlLm91dHB1dCl9cmV0dXJuIGJ9LGdldFVSTGFzeW5jOmZ1bmN0aW9uKGEsYixjKXthPXRoaXMuYWRqdXN0Qm91bmRzKGEpO2E9bmV3IE9wZW5MYXllcnMuRm9ybWF0LkFyY1hNTChPcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHRoaXMub3B0aW9ucyx7cmVxdWVzdHR5cGU6XCJpbWFnZVwiLGVudmVsb3BlOmEudG9BcnJheSgpLHRpbGVTaXplOnRoaXMudGlsZVNpemV9KSk7T3BlbkxheWVycy5SZXF1ZXN0LlBPU1Qoe3VybDp0aGlzLmdldEZ1bGxSZXF1ZXN0U3RyaW5nKCksXG5hc3luYzohMCxkYXRhOmEud3JpdGUoKSxjYWxsYmFjazpmdW5jdGlvbihhKXt2YXIgZT1hLnJlc3BvbnNlWE1MO2lmKCFlfHwhZS5kb2N1bWVudEVsZW1lbnQpZT1hLnJlc3BvbnNlVGV4dDthPShuZXcgT3BlbkxheWVycy5Gb3JtYXQuQXJjWE1MKS5yZWFkKGUpO2IuY2FsbChjLHRoaXMuZ2V0VXJsT3JJbWFnZShhLmltYWdlLm91dHB1dCkpfSxzY29wZTp0aGlzfSl9LGdldFVybE9ySW1hZ2U6ZnVuY3Rpb24oYSl7dmFyIGI9XCJcIjthLnVybD9iPWEudXJsOmEuZGF0YSYmKGI9XCJkYXRhOmltYWdlL1wiK2EudHlwZStcIjtiYXNlNjQsXCIrYS5kYXRhKTtyZXR1cm4gYn0sc2V0TGF5ZXJRdWVyeTpmdW5jdGlvbihhLGIpe2Zvcih2YXIgYz0wO2M8dGhpcy5vcHRpb25zLmxheWVycy5sZW5ndGg7YysrKWlmKGE9PXRoaXMub3B0aW9ucy5sYXllcnNbY10uaWQpe3RoaXMub3B0aW9ucy5sYXllcnNbY10ucXVlcnk9YjtyZXR1cm59dGhpcy5vcHRpb25zLmxheWVycy5wdXNoKHtpZDphLHZpc2libGU6ITAsXG5xdWVyeTpifSl9LGdldEZlYXR1cmVJbmZvOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD1jLmJ1ZmZlcnx8MSxlPWMuY2FsbGJhY2t8fGZ1bmN0aW9uKCl7fSxmPWMuc2NvcGV8fHdpbmRvdyxnPXt9O09wZW5MYXllcnMuVXRpbC5leHRlbmQoZyx0aGlzLm9wdGlvbnMpO2cucmVxdWVzdHR5cGU9XCJmZWF0dXJlXCI7YSBpbnN0YW5jZW9mIE9wZW5MYXllcnMuTG9uTGF0PyhnLnBvbHlnb249bnVsbCxnLmVudmVsb3BlPVthLmxvbi1kLGEubGF0LWQsYS5sb24rZCxhLmxhdCtkXSk6YSBpbnN0YW5jZW9mIE9wZW5MYXllcnMuR2VvbWV0cnkuUG9seWdvbiYmKGcuZW52ZWxvcGU9bnVsbCxnLnBvbHlnb249YSk7dmFyIGg9bmV3IE9wZW5MYXllcnMuRm9ybWF0LkFyY1hNTChnKTtPcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKGgucmVxdWVzdC5nZXRfZmVhdHVyZSxjKTtoLnJlcXVlc3QuZ2V0X2ZlYXR1cmUubGF5ZXI9Yi5pZDtcIm51bWJlclwiPT10eXBlb2YgYi5xdWVyeS5hY2N1cmFjeT9oLnJlcXVlc3QuZ2V0X2ZlYXR1cmUucXVlcnkuYWNjdXJhY3k9XG5iLnF1ZXJ5LmFjY3VyYWN5OihhPXRoaXMubWFwLmdldENlbnRlcigpLGM9dGhpcy5tYXAuZ2V0Vmlld1BvcnRQeEZyb21Mb25MYXQoYSksYy54KyssYz10aGlzLm1hcC5nZXRMb25MYXRGcm9tUGl4ZWwoYyksaC5yZXF1ZXN0LmdldF9mZWF0dXJlLnF1ZXJ5LmFjY3VyYWN5PWMubG9uLWEubG9uKTtoLnJlcXVlc3QuZ2V0X2ZlYXR1cmUucXVlcnkud2hlcmU9Yi5xdWVyeS53aGVyZTtoLnJlcXVlc3QuZ2V0X2ZlYXR1cmUucXVlcnkuc3BhdGlhbGZpbHRlci5yZWxhdGlvbj1cImFyZWFfaW50ZXJzZWN0aW9uXCI7T3BlbkxheWVycy5SZXF1ZXN0LlBPU1Qoe3VybDp0aGlzLmdldEZ1bGxSZXF1ZXN0U3RyaW5nKHtDdXN0b21TZXJ2aWNlOlwiUXVlcnlcIn0pLGRhdGE6aC53cml0ZSgpLGNhbGxiYWNrOmZ1bmN0aW9uKGEpe2E9aC5wYXJzZVJlc3BvbnNlKGEucmVzcG9uc2VUZXh0KTtoLmlzZXJyb3IoKT9lLmNhbGwoZixudWxsKTplLmNhbGwoZixhLmZlYXR1cmVzKX19KX0sY2xvbmU6ZnVuY3Rpb24oYSl7bnVsbD09XG5hJiYoYT1uZXcgT3BlbkxheWVycy5MYXllci5BcmNJTVModGhpcy5uYW1lLHRoaXMudXJsLHRoaXMuZ2V0T3B0aW9ucygpKSk7cmV0dXJuIGE9T3BlbkxheWVycy5MYXllci5HcmlkLnByb3RvdHlwZS5jbG9uZS5hcHBseSh0aGlzLFthXSl9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkxheWVyLkFyY0lNU1wifSk7T3BlbkxheWVycy5Gb3JtYXQuT1dTQ29tbW9uLnYxXzFfMD1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuRm9ybWF0Lk9XU0NvbW1vbi52MSx7bmFtZXNwYWNlczp7b3dzOlwiaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC9vd3MvMS4xXCIseGxpbms6XCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rXCJ9LHJlYWRlcnM6e293czpPcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyh7RXhjZXB0aW9uUmVwb3J0OmZ1bmN0aW9uKGEsYil7Yi5leGNlcHRpb25SZXBvcnQ9e3ZlcnNpb246YS5nZXRBdHRyaWJ1dGUoXCJ2ZXJzaW9uXCIpLGxhbmd1YWdlOmEuZ2V0QXR0cmlidXRlKFwieG1sOmxhbmdcIiksZXhjZXB0aW9uczpbXX07dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIuZXhjZXB0aW9uUmVwb3J0KX0sQWxsb3dlZFZhbHVlczpmdW5jdGlvbihhLGIpe2IuYWxsb3dlZFZhbHVlcz17fTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYi5hbGxvd2VkVmFsdWVzKX0sQW55VmFsdWU6ZnVuY3Rpb24oYSxiKXtiLmFueVZhbHVlPVxuITB9LERhdGFUeXBlOmZ1bmN0aW9uKGEsYil7Yi5kYXRhVHlwZT10aGlzLmdldENoaWxkVmFsdWUoYSl9LFJhbmdlOmZ1bmN0aW9uKGEsYil7Yi5yYW5nZT17fTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYi5yYW5nZSl9LE1pbmltdW1WYWx1ZTpmdW5jdGlvbihhLGIpe2IubWluVmFsdWU9dGhpcy5nZXRDaGlsZFZhbHVlKGEpfSxNYXhpbXVtVmFsdWU6ZnVuY3Rpb24oYSxiKXtiLm1heFZhbHVlPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKX0sSWRlbnRpZmllcjpmdW5jdGlvbihhLGIpe2IuaWRlbnRpZmllcj10aGlzLmdldENoaWxkVmFsdWUoYSl9LFN1cHBvcnRlZENSUzpmdW5jdGlvbihhLGIpe2Iuc3VwcG9ydGVkQ1JTPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKX19LE9wZW5MYXllcnMuRm9ybWF0Lk9XU0NvbW1vbi52MS5wcm90b3R5cGUucmVhZGVycy5vd3MpfSx3cml0ZXJzOntvd3M6T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoe1JhbmdlOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIm93czpSYW5nZVwiLFxue2F0dHJpYnV0ZXM6e1wib3dzOnJhbmdlQ2xvc3VyZVwiOmEuY2xvc3VyZX19KTt0aGlzLndyaXRlTm9kZShcIm93czpNaW5pbXVtVmFsdWVcIixhLm1pblZhbHVlLGIpO3RoaXMud3JpdGVOb2RlKFwib3dzOk1heGltdW1WYWx1ZVwiLGEubWF4VmFsdWUsYik7cmV0dXJuIGJ9LE1pbmltdW1WYWx1ZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwib3dzOk1pbmltdW1WYWx1ZVwiLHt2YWx1ZTphfSl9LE1heGltdW1WYWx1ZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwib3dzOk1heGltdW1WYWx1ZVwiLHt2YWx1ZTphfSl9LFZhbHVlOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJvd3M6VmFsdWVcIix7dmFsdWU6YX0pfX0sT3BlbkxheWVycy5Gb3JtYXQuT1dTQ29tbW9uLnYxLnByb3RvdHlwZS53cml0ZXJzLm93cyl9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZvcm1hdC5PV1NDb21tb24udjFfMV8wXCJ9KTtPcGVuTGF5ZXJzLkZvcm1hdC5XQ1NHZXRDb3ZlcmFnZT1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuRm9ybWF0LlhNTCx7bmFtZXNwYWNlczp7b3dzOlwiaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC9vd3MvMS4xXCIsd2NzOlwiaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC93Y3MvMS4xXCIseGxpbms6XCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rXCIseHNpOlwiaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEtaW5zdGFuY2VcIn0scmVnRXhlczp7dHJpbVNwYWNlOi9eXFxzKnxcXHMqJC9nLHJlbW92ZVNwYWNlOi9cXHMqL2csc3BsaXRTcGFjZTovXFxzKy8sdHJpbUNvbW1hOi9cXHMqLFxccyovZ30sVkVSU0lPTjpcIjEuMS4yXCIsc2NoZW1hTG9jYXRpb246XCJodHRwOi8vd3d3Lm9wZW5naXMubmV0L3djcy8xLjEgaHR0cDovL3NjaGVtYXMub3Blbmdpcy5uZXQvd2NzLzEuMS93Y3NHZXRDb3ZlcmFnZS54c2RcIix3cml0ZTpmdW5jdGlvbihhKXthPXRoaXMud3JpdGVOb2RlKFwid2NzOkdldENvdmVyYWdlXCIsXG5hKTt0aGlzLnNldEF0dHJpYnV0ZU5TKGEsdGhpcy5uYW1lc3BhY2VzLnhzaSxcInhzaTpzY2hlbWFMb2NhdGlvblwiLHRoaXMuc2NoZW1hTG9jYXRpb24pO3JldHVybiBPcGVuTGF5ZXJzLkZvcm1hdC5YTUwucHJvdG90eXBlLndyaXRlLmFwcGx5KHRoaXMsW2FdKX0sd3JpdGVyczp7d2NzOntHZXRDb3ZlcmFnZTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJ3Y3M6R2V0Q292ZXJhZ2VcIix7YXR0cmlidXRlczp7dmVyc2lvbjphLnZlcnNpb258fHRoaXMuVkVSU0lPTixzZXJ2aWNlOlwiV0NTXCJ9fSk7dGhpcy53cml0ZU5vZGUoXCJvd3M6SWRlbnRpZmllclwiLGEuaWRlbnRpZmllcixiKTt0aGlzLndyaXRlTm9kZShcIndjczpEb21haW5TdWJzZXRcIixhLmRvbWFpblN1YnNldCxiKTt0aGlzLndyaXRlTm9kZShcIndjczpPdXRwdXRcIixhLm91dHB1dCxiKTtyZXR1cm4gYn0sRG9tYWluU3Vic2V0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIndjczpEb21haW5TdWJzZXRcIixcbnt9KTt0aGlzLndyaXRlTm9kZShcIm93czpCb3VuZGluZ0JveFwiLGEuYm91bmRpbmdCb3gsYik7YS50ZW1wb3JhbFN1YnNldCYmdGhpcy53cml0ZU5vZGUoXCJ3Y3M6VGVtcG9yYWxTdWJzZXRcIixhLnRlbXBvcmFsU3Vic2V0LGIpO3JldHVybiBifSxUZW1wb3JhbFN1YnNldDpmdW5jdGlvbihhKXtmb3IodmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwid2NzOlRlbXBvcmFsU3Vic2V0XCIse30pLGM9MCxkPWEudGltZVBlcmlvZHMubGVuZ3RoO2M8ZDsrK2MpdGhpcy53cml0ZU5vZGUoXCJ3Y3M6VGltZVBlcmlvZFwiLGEudGltZVBlcmlvZHNbY10sYik7cmV0dXJuIGJ9LFRpbWVQZXJpb2Q6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwid2NzOlRpbWVQZXJpb2RcIix7fSk7dGhpcy53cml0ZU5vZGUoXCJ3Y3M6QmVnaW5Qb3NpdGlvblwiLGEuYmVnaW4sYik7dGhpcy53cml0ZU5vZGUoXCJ3Y3M6RW5kUG9zaXRpb25cIixhLmVuZCxiKTthLnJlc29sdXRpb24mJnRoaXMud3JpdGVOb2RlKFwid2NzOlRpbWVSZXNvbHV0aW9uXCIsXG5hLnJlc29sdXRpb24sYik7cmV0dXJuIGJ9LEJlZ2luUG9zaXRpb246ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIndjczpCZWdpblBvc2l0aW9uXCIse3ZhbHVlOmF9KX0sRW5kUG9zaXRpb246ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIndjczpFbmRQb3NpdGlvblwiLHt2YWx1ZTphfSl9LFRpbWVSZXNvbHV0aW9uOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJ3Y3M6VGltZVJlc29sdXRpb25cIix7dmFsdWU6YX0pfSxPdXRwdXQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwid2NzOk91dHB1dFwiLHthdHRyaWJ1dGVzOntmb3JtYXQ6YS5mb3JtYXQsc3RvcmU6YS5zdG9yZX19KTthLmdyaWRDUlMmJnRoaXMud3JpdGVOb2RlKFwid2NzOkdyaWRDUlNcIixhLmdyaWRDUlMsYik7cmV0dXJuIGJ9LEdyaWRDUlM6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwid2NzOkdyaWRDUlNcIixcbnt9KTt0aGlzLndyaXRlTm9kZShcIndjczpHcmlkQmFzZUNSU1wiLGEuYmFzZUNSUyxiKTthLnR5cGUmJnRoaXMud3JpdGVOb2RlKFwid2NzOkdyaWRUeXBlXCIsYS50eXBlLGIpO2Eub3JpZ2luJiZ0aGlzLndyaXRlTm9kZShcIndjczpHcmlkT3JpZ2luXCIsYS5vcmlnaW4sYik7dGhpcy53cml0ZU5vZGUoXCJ3Y3M6R3JpZE9mZnNldHNcIixhLm9mZnNldHMsYik7YS5DUyYmdGhpcy53cml0ZU5vZGUoXCJ3Y3M6R3JpZENTXCIsYS5DUyxiKTtyZXR1cm4gYn0sR3JpZEJhc2VDUlM6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIndjczpHcmlkQmFzZUNSU1wiLHt2YWx1ZTphfSl9LEdyaWRPcmlnaW46ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIndjczpHcmlkT3JpZ2luXCIse3ZhbHVlOmF9KX0sR3JpZFR5cGU6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIndjczpHcmlkVHlwZVwiLHt2YWx1ZTphfSl9LEdyaWRPZmZzZXRzOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJ3Y3M6R3JpZE9mZnNldHNcIixcbnt2YWx1ZTphfSl9LEdyaWRDUzpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwid2NzOkdyaWRDU1wiLHt2YWx1ZTphfSl9fSxvd3M6T3BlbkxheWVycy5Gb3JtYXQuT1dTQ29tbW9uLnYxXzFfMC5wcm90b3R5cGUud3JpdGVycy5vd3N9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZvcm1hdC5XQ1NHZXRDb3ZlcmFnZVwifSk7T3BlbkxheWVycy5Gb3JtYXQuV1BTRXhlY3V0ZT1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuRm9ybWF0LlhNTCx7bmFtZXNwYWNlczp7b3dzOlwiaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC9vd3MvMS4xXCIsZ21sOlwiaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC9nbWxcIix3cHM6XCJodHRwOi8vd3d3Lm9wZW5naXMubmV0L3dwcy8xLjAuMFwiLHdmczpcImh0dHA6Ly93d3cub3Blbmdpcy5uZXQvd2ZzXCIsb2djOlwiaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC9vZ2NcIix3Y3M6XCJodHRwOi8vd3d3Lm9wZW5naXMubmV0L3djc1wiLHhsaW5rOlwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGlua1wiLHhzaTpcImh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hLWluc3RhbmNlXCJ9LHJlZ0V4ZXM6e3RyaW1TcGFjZTovXlxccyp8XFxzKiQvZyxyZW1vdmVTcGFjZTovXFxzKi9nLHNwbGl0U3BhY2U6L1xccysvLHRyaW1Db21tYTovXFxzKixcXHMqL2d9LFZFUlNJT046XCIxLjAuMFwiLHNjaGVtYUxvY2F0aW9uOlwiaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC93cHMvMS4wLjAgaHR0cDovL3NjaGVtYXMub3Blbmdpcy5uZXQvd3BzLzEuMC4wL3dwc0FsbC54c2RcIixcbnNjaGVtYUxvY2F0aW9uQXR0cjpmdW5jdGlvbigpe30sd3JpdGU6ZnVuY3Rpb24oYSl7dmFyIGI7d2luZG93LkFjdGl2ZVhPYmplY3Q/dGhpcy54bWxkb209Yj1uZXcgQWN0aXZlWE9iamVjdChcIk1pY3Jvc29mdC5YTUxET01cIik6Yj1kb2N1bWVudC5pbXBsZW1lbnRhdGlvbi5jcmVhdGVEb2N1bWVudChcIlwiLFwiXCIsbnVsbCk7YT10aGlzLndyaXRlTm9kZShcIndwczpFeGVjdXRlXCIsYSxiKTt0aGlzLnNldEF0dHJpYnV0ZU5TKGEsdGhpcy5uYW1lc3BhY2VzLnhzaSxcInhzaTpzY2hlbWFMb2NhdGlvblwiLHRoaXMuc2NoZW1hTG9jYXRpb24pO3JldHVybiBPcGVuTGF5ZXJzLkZvcm1hdC5YTUwucHJvdG90eXBlLndyaXRlLmFwcGx5KHRoaXMsW2FdKX0sd3JpdGVyczp7d3BzOntFeGVjdXRlOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIndwczpFeGVjdXRlXCIse2F0dHJpYnV0ZXM6e3ZlcnNpb246dGhpcy5WRVJTSU9OLHNlcnZpY2U6XCJXUFNcIn19KTt0aGlzLndyaXRlTm9kZShcIm93czpJZGVudGlmaWVyXCIsXG5hLmlkZW50aWZpZXIsYik7dGhpcy53cml0ZU5vZGUoXCJ3cHM6RGF0YUlucHV0c1wiLGEuZGF0YUlucHV0cyxiKTt0aGlzLndyaXRlTm9kZShcIndwczpSZXNwb25zZUZvcm1cIixhLnJlc3BvbnNlRm9ybSxiKTtyZXR1cm4gYn0sUmVzcG9uc2VGb3JtOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIndwczpSZXNwb25zZUZvcm1cIix7fSk7YS5yYXdEYXRhT3V0cHV0JiZ0aGlzLndyaXRlTm9kZShcIndwczpSYXdEYXRhT3V0cHV0XCIsYS5yYXdEYXRhT3V0cHV0LGIpO2EucmVzcG9uc2VEb2N1bWVudCYmdGhpcy53cml0ZU5vZGUoXCJ3cHM6UmVzcG9uc2VEb2N1bWVudFwiLGEucmVzcG9uc2VEb2N1bWVudCxiKTtyZXR1cm4gYn0sUmVzcG9uc2VEb2N1bWVudDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJ3cHM6UmVzcG9uc2VEb2N1bWVudFwiLHthdHRyaWJ1dGVzOntzdG9yZUV4ZWN1dGVSZXNwb25zZTphLnN0b3JlRXhlY3V0ZVJlc3BvbnNlLFxubGluZWFnZTphLmxpbmVhZ2Usc3RhdHVzOmEuc3RhdHVzfX0pO2Eub3V0cHV0JiZ0aGlzLndyaXRlTm9kZShcIndwczpPdXRwdXRcIixhLm91dHB1dCxiKTtyZXR1cm4gYn0sT3V0cHV0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIndwczpPdXRwdXRcIix7YXR0cmlidXRlczp7YXNSZWZlcmVuY2U6YS5hc1JlZmVyZW5jZX19KTt0aGlzLndyaXRlTm9kZShcIm93czpJZGVudGlmaWVyXCIsYS5pZGVudGlmaWVyLGIpO3RoaXMud3JpdGVOb2RlKFwib3dzOlRpdGxlXCIsYS50aXRsZSxiKTt0aGlzLndyaXRlTm9kZShcIm93czpBYnN0cmFjdFwiLGFbXCJhYnN0cmFjdFwiXSxiKTtyZXR1cm4gYn0sUmF3RGF0YU91dHB1dDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJ3cHM6UmF3RGF0YU91dHB1dFwiLHthdHRyaWJ1dGVzOnttaW1lVHlwZTphLm1pbWVUeXBlfX0pO3RoaXMud3JpdGVOb2RlKFwib3dzOklkZW50aWZpZXJcIixhLmlkZW50aWZpZXIsXG5iKTtyZXR1cm4gYn0sRGF0YUlucHV0czpmdW5jdGlvbihhKXtmb3IodmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwid3BzOkRhdGFJbnB1dHNcIix7fSksYz0wLGQ9YS5sZW5ndGg7YzxkOysrYyl0aGlzLndyaXRlTm9kZShcIndwczpJbnB1dFwiLGFbY10sYik7cmV0dXJuIGJ9LElucHV0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIndwczpJbnB1dFwiLHt9KTt0aGlzLndyaXRlTm9kZShcIm93czpJZGVudGlmaWVyXCIsYS5pZGVudGlmaWVyLGIpO2EudGl0bGUmJnRoaXMud3JpdGVOb2RlKFwib3dzOlRpdGxlXCIsYS50aXRsZSxiKTthLmRhdGEmJnRoaXMud3JpdGVOb2RlKFwid3BzOkRhdGFcIixhLmRhdGEsYik7YS5yZWZlcmVuY2UmJnRoaXMud3JpdGVOb2RlKFwid3BzOlJlZmVyZW5jZVwiLGEucmVmZXJlbmNlLGIpO3JldHVybiBifSxEYXRhOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIndwczpEYXRhXCIse30pO2EubGl0ZXJhbERhdGE/XG50aGlzLndyaXRlTm9kZShcIndwczpMaXRlcmFsRGF0YVwiLGEubGl0ZXJhbERhdGEsYik6YS5jb21wbGV4RGF0YSYmdGhpcy53cml0ZU5vZGUoXCJ3cHM6Q29tcGxleERhdGFcIixhLmNvbXBsZXhEYXRhLGIpO3JldHVybiBifSxMaXRlcmFsRGF0YTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwid3BzOkxpdGVyYWxEYXRhXCIse2F0dHJpYnV0ZXM6e3VvbTphLnVvbX0sdmFsdWU6YS52YWx1ZX0pfSxDb21wbGV4RGF0YTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJ3cHM6Q29tcGxleERhdGFcIix7YXR0cmlidXRlczp7bWltZVR5cGU6YS5taW1lVHlwZSxlbmNvZGluZzphLmVuY29kaW5nLHNjaGVtYTphLnNjaGVtYX19KSxjPWEudmFsdWU7XCJzdHJpbmdcIj09PXR5cGVvZiBjP2IuYXBwZW5kQ2hpbGQodGhpcy5nZXRYTUxEb2MoKS5jcmVhdGVDREFUQVNlY3Rpb24oYS52YWx1ZSkpOmIuYXBwZW5kQ2hpbGQoYyk7cmV0dXJuIGJ9LFxuUmVmZXJlbmNlOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIndwczpSZWZlcmVuY2VcIix7YXR0cmlidXRlczp7bWltZVR5cGU6YS5taW1lVHlwZSxcInhsaW5rOmhyZWZcIjphLmhyZWYsbWV0aG9kOmEubWV0aG9kLGVuY29kaW5nOmEuZW5jb2Rpbmcsc2NoZW1hOmEuc2NoZW1hfX0pO2EuYm9keSYmdGhpcy53cml0ZU5vZGUoXCJ3cHM6Qm9keVwiLGEuYm9keSxiKTtyZXR1cm4gYn0sQm9keTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJ3cHM6Qm9keVwiLHt9KTthLndjcz90aGlzLndyaXRlTm9kZShcIndjczpHZXRDb3ZlcmFnZVwiLGEud2NzLGIpOmEud2ZzPyh0aGlzLmZlYXR1cmVUeXBlPWEud2ZzLmZlYXR1cmVUeXBlLHRoaXMudmVyc2lvbj1hLndmcy52ZXJzaW9uLHRoaXMud3JpdGVOb2RlKFwid2ZzOkdldEZlYXR1cmVcIixhLndmcyxiKSk6dGhpcy53cml0ZU5vZGUoXCJ3cHM6RXhlY3V0ZVwiLGEsYik7cmV0dXJuIGJ9fSx3Y3M6T3BlbkxheWVycy5Gb3JtYXQuV0NTR2V0Q292ZXJhZ2UucHJvdG90eXBlLndyaXRlcnMud2NzLFxud2ZzOk9wZW5MYXllcnMuRm9ybWF0LldGU1QudjFfMV8wLnByb3RvdHlwZS53cml0ZXJzLndmcyxvZ2M6T3BlbkxheWVycy5Gb3JtYXQuRmlsdGVyLnYxXzFfMC5wcm90b3R5cGUud3JpdGVycy5vZ2Msb3dzOk9wZW5MYXllcnMuRm9ybWF0Lk9XU0NvbW1vbi52MV8xXzAucHJvdG90eXBlLndyaXRlcnMub3dzfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Gb3JtYXQuV1BTRXhlY3V0ZVwifSk7T3BlbkxheWVycy5Db250cm9sLlBhblpvb209T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkNvbnRyb2wse3NsaWRlRmFjdG9yOjUwLHNsaWRlUmF0aW86bnVsbCxidXR0b25zOm51bGwscG9zaXRpb246bnVsbCxpbml0aWFsaXplOmZ1bmN0aW9uKGEpe3RoaXMucG9zaXRpb249bmV3IE9wZW5MYXllcnMuUGl4ZWwoT3BlbkxheWVycy5Db250cm9sLlBhblpvb20uWCxPcGVuTGF5ZXJzLkNvbnRyb2wuUGFuWm9vbS5ZKTtPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5tYXAmJnRoaXMubWFwLmV2ZW50cy51bnJlZ2lzdGVyKFwiYnV0dG9uY2xpY2tcIix0aGlzLHRoaXMub25CdXR0b25DbGljayk7dGhpcy5yZW1vdmVCdXR0b25zKCk7dGhpcy5wb3NpdGlvbj10aGlzLmJ1dHRvbnM9bnVsbDtPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmRlc3Ryb3kuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxcbnNldE1hcDpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLnNldE1hcC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5tYXAuZXZlbnRzLnJlZ2lzdGVyKFwiYnV0dG9uY2xpY2tcIix0aGlzLHRoaXMub25CdXR0b25DbGljayl9LGRyYXc6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5kcmF3LmFwcGx5KHRoaXMsYXJndW1lbnRzKTthPXRoaXMucG9zaXRpb247dGhpcy5idXR0b25zPVtdO3ZhciBiPXt3OjE4LGg6MTh9LGM9bmV3IE9wZW5MYXllcnMuUGl4ZWwoYS54K2Iudy8yLGEueSk7dGhpcy5fYWRkQnV0dG9uKFwicGFudXBcIixcIm5vcnRoLW1pbmkucG5nXCIsYyxiKTthLnk9Yy55K2IuaDt0aGlzLl9hZGRCdXR0b24oXCJwYW5sZWZ0XCIsXCJ3ZXN0LW1pbmkucG5nXCIsYSxiKTt0aGlzLl9hZGRCdXR0b24oXCJwYW5yaWdodFwiLFwiZWFzdC1taW5pLnBuZ1wiLGEuYWRkKGIudywwKSxiKTt0aGlzLl9hZGRCdXR0b24oXCJwYW5kb3duXCIsXCJzb3V0aC1taW5pLnBuZ1wiLFxuYy5hZGQoMCwyKmIuaCksYik7dGhpcy5fYWRkQnV0dG9uKFwiem9vbWluXCIsXCJ6b29tLXBsdXMtbWluaS5wbmdcIixjLmFkZCgwLDMqYi5oKzUpLGIpO3RoaXMuX2FkZEJ1dHRvbihcInpvb213b3JsZFwiLFwiem9vbS13b3JsZC1taW5pLnBuZ1wiLGMuYWRkKDAsNCpiLmgrNSksYik7dGhpcy5fYWRkQnV0dG9uKFwiem9vbW91dFwiLFwiem9vbS1taW51cy1taW5pLnBuZ1wiLGMuYWRkKDAsNSpiLmgrNSksYik7cmV0dXJuIHRoaXMuZGl2fSxfYWRkQnV0dG9uOmZ1bmN0aW9uKGEsYixjLGQpe2I9T3BlbkxheWVycy5VdGlsLmdldEltYWdlTG9jYXRpb24oYik7Yz1PcGVuTGF5ZXJzLlV0aWwuY3JlYXRlQWxwaGFJbWFnZURpdih0aGlzLmlkK1wiX1wiK2EsYyxkLGIsXCJhYnNvbHV0ZVwiKTtjLnN0eWxlLmN1cnNvcj1cInBvaW50ZXJcIjt0aGlzLmRpdi5hcHBlbmRDaGlsZChjKTtjLmFjdGlvbj1hO2MuY2xhc3NOYW1lPVwib2xCdXR0b25cIjt0aGlzLmJ1dHRvbnMucHVzaChjKTtyZXR1cm4gY30sX3JlbW92ZUJ1dHRvbjpmdW5jdGlvbihhKXt0aGlzLmRpdi5yZW1vdmVDaGlsZChhKTtcbk9wZW5MYXllcnMuVXRpbC5yZW1vdmVJdGVtKHRoaXMuYnV0dG9ucyxhKX0scmVtb3ZlQnV0dG9uczpmdW5jdGlvbigpe2Zvcih2YXIgYT10aGlzLmJ1dHRvbnMubGVuZ3RoLTE7MDw9YTstLWEpdGhpcy5fcmVtb3ZlQnV0dG9uKHRoaXMuYnV0dG9uc1thXSl9LG9uQnV0dG9uQ2xpY2s6ZnVuY3Rpb24oYSl7c3dpdGNoKGEuYnV0dG9uRWxlbWVudC5hY3Rpb24pe2Nhc2UgXCJwYW51cFwiOnRoaXMubWFwLnBhbigwLC10aGlzLmdldFNsaWRlRmFjdG9yKFwiaFwiKSk7YnJlYWs7Y2FzZSBcInBhbmRvd25cIjp0aGlzLm1hcC5wYW4oMCx0aGlzLmdldFNsaWRlRmFjdG9yKFwiaFwiKSk7YnJlYWs7Y2FzZSBcInBhbmxlZnRcIjp0aGlzLm1hcC5wYW4oLXRoaXMuZ2V0U2xpZGVGYWN0b3IoXCJ3XCIpLDApO2JyZWFrO2Nhc2UgXCJwYW5yaWdodFwiOnRoaXMubWFwLnBhbih0aGlzLmdldFNsaWRlRmFjdG9yKFwid1wiKSwwKTticmVhaztjYXNlIFwiem9vbWluXCI6dGhpcy5tYXAuem9vbUluKCk7YnJlYWs7Y2FzZSBcInpvb21vdXRcIjp0aGlzLm1hcC56b29tT3V0KCk7XG5icmVhaztjYXNlIFwiem9vbXdvcmxkXCI6dGhpcy5tYXAuem9vbVRvTWF4RXh0ZW50KCl9fSxnZXRTbGlkZUZhY3RvcjpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5zbGlkZVJhdGlvP3RoaXMubWFwLmdldFNpemUoKVthXSp0aGlzLnNsaWRlUmF0aW86dGhpcy5zbGlkZUZhY3Rvcn0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuQ29udHJvbC5QYW5ab29tXCJ9KTtPcGVuTGF5ZXJzLkNvbnRyb2wuUGFuWm9vbS5YPTQ7T3BlbkxheWVycy5Db250cm9sLlBhblpvb20uWT00O09wZW5MYXllcnMuQ29udHJvbC5QYW5ab29tQmFyPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Db250cm9sLlBhblpvb20se3pvb21TdG9wV2lkdGg6MTgsem9vbVN0b3BIZWlnaHQ6MTEsc2xpZGVyOm51bGwsc2xpZGVyRXZlbnRzOm51bGwsem9vbWJhckRpdjpudWxsLHpvb21Xb3JsZEljb246ITEscGFuSWNvbnM6ITAsZm9yY2VGaXhlZFpvb21MZXZlbDohMSxtb3VzZURyYWdTdGFydDpudWxsLGRlbHRhWTpudWxsLHpvb21TdGFydDpudWxsLGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLl9yZW1vdmVab29tQmFyKCk7dGhpcy5tYXAuZXZlbnRzLnVuKHtjaGFuZ2ViYXNlbGF5ZXI6dGhpcy5yZWRyYXcsc2NvcGU6dGhpc30pO09wZW5MYXllcnMuQ29udHJvbC5QYW5ab29tLnByb3RvdHlwZS5kZXN0cm95LmFwcGx5KHRoaXMsYXJndW1lbnRzKTtkZWxldGUgdGhpcy5tb3VzZURyYWdTdGFydDtkZWxldGUgdGhpcy56b29tU3RhcnR9LHNldE1hcDpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLkNvbnRyb2wuUGFuWm9vbS5wcm90b3R5cGUuc2V0TWFwLmFwcGx5KHRoaXMsXG5hcmd1bWVudHMpO3RoaXMubWFwLmV2ZW50cy5yZWdpc3RlcihcImNoYW5nZWJhc2VsYXllclwiLHRoaXMsdGhpcy5yZWRyYXcpfSxyZWRyYXc6ZnVuY3Rpb24oKXtudWxsIT10aGlzLmRpdiYmKHRoaXMucmVtb3ZlQnV0dG9ucygpLHRoaXMuX3JlbW92ZVpvb21CYXIoKSk7dGhpcy5kcmF3KCl9LGRyYXc6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5kcmF3LmFwcGx5KHRoaXMsYXJndW1lbnRzKTthPXRoaXMucG9zaXRpb24uY2xvbmUoKTt0aGlzLmJ1dHRvbnM9W107dmFyIGI9e3c6MTgsaDoxOH07aWYodGhpcy5wYW5JY29ucyl7dmFyIGM9bmV3IE9wZW5MYXllcnMuUGl4ZWwoYS54K2Iudy8yLGEueSksZD1iLnc7dGhpcy56b29tV29ybGRJY29uJiYoYz1uZXcgT3BlbkxheWVycy5QaXhlbChhLngrYi53LGEueSkpO3RoaXMuX2FkZEJ1dHRvbihcInBhbnVwXCIsXCJub3J0aC1taW5pLnBuZ1wiLGMsYik7YS55PWMueStiLmg7dGhpcy5fYWRkQnV0dG9uKFwicGFubGVmdFwiLFxuXCJ3ZXN0LW1pbmkucG5nXCIsYSxiKTt0aGlzLnpvb21Xb3JsZEljb24mJih0aGlzLl9hZGRCdXR0b24oXCJ6b29td29ybGRcIixcInpvb20td29ybGQtbWluaS5wbmdcIixhLmFkZChiLncsMCksYiksZCo9Mik7dGhpcy5fYWRkQnV0dG9uKFwicGFucmlnaHRcIixcImVhc3QtbWluaS5wbmdcIixhLmFkZChkLDApLGIpO3RoaXMuX2FkZEJ1dHRvbihcInBhbmRvd25cIixcInNvdXRoLW1pbmkucG5nXCIsYy5hZGQoMCwyKmIuaCksYik7dGhpcy5fYWRkQnV0dG9uKFwiem9vbWluXCIsXCJ6b29tLXBsdXMtbWluaS5wbmdcIixjLmFkZCgwLDMqYi5oKzUpLGIpO2M9dGhpcy5fYWRkWm9vbUJhcihjLmFkZCgwLDQqYi5oKzUpKTt0aGlzLl9hZGRCdXR0b24oXCJ6b29tb3V0XCIsXCJ6b29tLW1pbnVzLW1pbmkucG5nXCIsYyxiKX1lbHNlIHRoaXMuX2FkZEJ1dHRvbihcInpvb21pblwiLFwiem9vbS1wbHVzLW1pbmkucG5nXCIsYSxiKSxjPXRoaXMuX2FkZFpvb21CYXIoYS5hZGQoMCxiLmgpKSx0aGlzLl9hZGRCdXR0b24oXCJ6b29tb3V0XCIsXG5cInpvb20tbWludXMtbWluaS5wbmdcIixjLGIpLHRoaXMuem9vbVdvcmxkSWNvbiYmKGM9Yy5hZGQoMCxiLmgrMyksdGhpcy5fYWRkQnV0dG9uKFwiem9vbXdvcmxkXCIsXCJ6b29tLXdvcmxkLW1pbmkucG5nXCIsYyxiKSk7cmV0dXJuIHRoaXMuZGl2fSxfYWRkWm9vbUJhcjpmdW5jdGlvbihhKXt2YXIgYj1PcGVuTGF5ZXJzLlV0aWwuZ2V0SW1hZ2VMb2NhdGlvbihcInNsaWRlci5wbmdcIiksYz10aGlzLmlkK1wiX1wiK3RoaXMubWFwLmlkLGQ9dGhpcy5tYXAuZ2V0TnVtWm9vbUxldmVscygpLTEtdGhpcy5tYXAuZ2V0Wm9vbSgpLGQ9T3BlbkxheWVycy5VdGlsLmNyZWF0ZUFscGhhSW1hZ2VEaXYoYyxhLmFkZCgtMSxkKnRoaXMuem9vbVN0b3BIZWlnaHQpLHt3OjIwLGg6OX0sYixcImFic29sdXRlXCIpO2Quc3R5bGUuY3Vyc29yPVwibW92ZVwiO3RoaXMuc2xpZGVyPWQ7dGhpcy5zbGlkZXJFdmVudHM9bmV3IE9wZW5MYXllcnMuRXZlbnRzKHRoaXMsZCxudWxsLCEwLHtpbmNsdWRlWFk6ITB9KTt0aGlzLnNsaWRlckV2ZW50cy5vbih7dG91Y2hzdGFydDp0aGlzLnpvb21CYXJEb3duLFxudG91Y2htb3ZlOnRoaXMuem9vbUJhckRyYWcsdG91Y2hlbmQ6dGhpcy56b29tQmFyVXAsbW91c2Vkb3duOnRoaXMuem9vbUJhckRvd24sbW91c2Vtb3ZlOnRoaXMuem9vbUJhckRyYWcsbW91c2V1cDp0aGlzLnpvb21CYXJVcH0pO3ZhciBlPXt3OnRoaXMuem9vbVN0b3BXaWR0aCxoOnRoaXMuem9vbVN0b3BIZWlnaHQqdGhpcy5tYXAuZ2V0TnVtWm9vbUxldmVscygpfSxiPU9wZW5MYXllcnMuVXRpbC5nZXRJbWFnZUxvY2F0aW9uKFwiem9vbWJhci5wbmdcIiksYz1udWxsO09wZW5MYXllcnMuVXRpbC5hbHBoYUhhY2soKT8oYz10aGlzLmlkK1wiX1wiK3RoaXMubWFwLmlkLGM9T3BlbkxheWVycy5VdGlsLmNyZWF0ZUFscGhhSW1hZ2VEaXYoYyxhLHt3OmUudyxoOnRoaXMuem9vbVN0b3BIZWlnaHR9LGIsXCJhYnNvbHV0ZVwiLG51bGwsXCJjcm9wXCIpLGMuc3R5bGUuaGVpZ2h0PWUuaCtcInB4XCIpOmM9T3BlbkxheWVycy5VdGlsLmNyZWF0ZURpdihcIk9wZW5MYXllcnNfQ29udHJvbF9QYW5ab29tQmFyX1pvb21iYXJcIitcbnRoaXMubWFwLmlkLGEsZSxiKTtjLnN0eWxlLmN1cnNvcj1cInBvaW50ZXJcIjtjLmNsYXNzTmFtZT1cIm9sQnV0dG9uXCI7dGhpcy56b29tYmFyRGl2PWM7dGhpcy5kaXYuYXBwZW5kQ2hpbGQoYyk7dGhpcy5zdGFydFRvcD1wYXJzZUludChjLnN0eWxlLnRvcCk7dGhpcy5kaXYuYXBwZW5kQ2hpbGQoZCk7dGhpcy5tYXAuZXZlbnRzLnJlZ2lzdGVyKFwiem9vbWVuZFwiLHRoaXMsdGhpcy5tb3ZlWm9vbUJhcik7cmV0dXJuIGE9YS5hZGQoMCx0aGlzLnpvb21TdG9wSGVpZ2h0KnRoaXMubWFwLmdldE51bVpvb21MZXZlbHMoKSl9LF9yZW1vdmVab29tQmFyOmZ1bmN0aW9uKCl7dGhpcy5zbGlkZXJFdmVudHMudW4oe3RvdWNoc3RhcnQ6dGhpcy56b29tQmFyRG93bix0b3VjaG1vdmU6dGhpcy56b29tQmFyRHJhZyx0b3VjaGVuZDp0aGlzLnpvb21CYXJVcCxtb3VzZWRvd246dGhpcy56b29tQmFyRG93bixtb3VzZW1vdmU6dGhpcy56b29tQmFyRHJhZyxtb3VzZXVwOnRoaXMuem9vbUJhclVwfSk7dGhpcy5zbGlkZXJFdmVudHMuZGVzdHJveSgpO1xudGhpcy5kaXYucmVtb3ZlQ2hpbGQodGhpcy56b29tYmFyRGl2KTt0aGlzLnpvb21iYXJEaXY9bnVsbDt0aGlzLmRpdi5yZW1vdmVDaGlsZCh0aGlzLnNsaWRlcik7dGhpcy5zbGlkZXI9bnVsbDt0aGlzLm1hcC5ldmVudHMudW5yZWdpc3RlcihcInpvb21lbmRcIix0aGlzLHRoaXMubW92ZVpvb21CYXIpfSxvbkJ1dHRvbkNsaWNrOmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuQ29udHJvbC5QYW5ab29tLnByb3RvdHlwZS5vbkJ1dHRvbkNsaWNrLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtpZihhLmJ1dHRvbkVsZW1lbnQ9PT10aGlzLnpvb21iYXJEaXYpe3ZhciBiPWEuYnV0dG9uWFkueS90aGlzLnpvb21TdG9wSGVpZ2h0O2lmKHRoaXMuZm9yY2VGaXhlZFpvb21MZXZlbHx8IXRoaXMubWFwLmZyYWN0aW9uYWxab29tKWI9TWF0aC5mbG9vcihiKTtiPXRoaXMubWFwLmdldE51bVpvb21MZXZlbHMoKS0xLWI7Yj1NYXRoLm1pbihNYXRoLm1heChiLDApLHRoaXMubWFwLmdldE51bVpvb21MZXZlbHMoKS1cbjEpO3RoaXMubWFwLnpvb21UbyhiKX19LHBhc3NFdmVudFRvU2xpZGVyOmZ1bmN0aW9uKGEpe3RoaXMuc2xpZGVyRXZlbnRzLmhhbmRsZUJyb3dzZXJFdmVudChhKX0sem9vbUJhckRvd246ZnVuY3Rpb24oYSl7aWYoT3BlbkxheWVycy5FdmVudC5pc0xlZnRDbGljayhhKXx8T3BlbkxheWVycy5FdmVudC5pc1NpbmdsZVRvdWNoKGEpKXRoaXMubWFwLmV2ZW50cy5vbih7dG91Y2htb3ZlOnRoaXMucGFzc0V2ZW50VG9TbGlkZXIsbW91c2Vtb3ZlOnRoaXMucGFzc0V2ZW50VG9TbGlkZXIsbW91c2V1cDp0aGlzLnBhc3NFdmVudFRvU2xpZGVyLHNjb3BlOnRoaXN9KSx0aGlzLm1vdXNlRHJhZ1N0YXJ0PWEueHkuY2xvbmUoKSx0aGlzLnpvb21TdGFydD1hLnh5LmNsb25lKCksdGhpcy5kaXYuc3R5bGUuY3Vyc29yPVwibW92ZVwiLHRoaXMuem9vbWJhckRpdi5vZmZzZXRzPW51bGwsT3BlbkxheWVycy5FdmVudC5zdG9wKGEpfSx6b29tQmFyRHJhZzpmdW5jdGlvbihhKXtpZihudWxsIT10aGlzLm1vdXNlRHJhZ1N0YXJ0KXt2YXIgYj1cbnRoaXMubW91c2VEcmFnU3RhcnQueS1hLnh5LnksYz1PcGVuTGF5ZXJzLlV0aWwucGFnZVBvc2l0aW9uKHRoaXMuem9vbWJhckRpdik7MDxhLmNsaWVudFktY1sxXSYmYS5jbGllbnRZLWNbMV08cGFyc2VJbnQodGhpcy56b29tYmFyRGl2LnN0eWxlLmhlaWdodCktMiYmKHRoaXMuc2xpZGVyLnN0eWxlLnRvcD1wYXJzZUludCh0aGlzLnNsaWRlci5zdHlsZS50b3ApLWIrXCJweFwiLHRoaXMubW91c2VEcmFnU3RhcnQ9YS54eS5jbG9uZSgpKTt0aGlzLmRlbHRhWT10aGlzLnpvb21TdGFydC55LWEueHkueTtPcGVuTGF5ZXJzLkV2ZW50LnN0b3AoYSl9fSx6b29tQmFyVXA6ZnVuY3Rpb24oYSl7aWYoKE9wZW5MYXllcnMuRXZlbnQuaXNMZWZ0Q2xpY2soYSl8fFwidG91Y2hlbmRcIj09PWEudHlwZSkmJnRoaXMubW91c2VEcmFnU3RhcnQpe3RoaXMuZGl2LnN0eWxlLmN1cnNvcj1cIlwiO3RoaXMubWFwLmV2ZW50cy51bih7dG91Y2htb3ZlOnRoaXMucGFzc0V2ZW50VG9TbGlkZXIsbW91c2V1cDp0aGlzLnBhc3NFdmVudFRvU2xpZGVyLFxubW91c2Vtb3ZlOnRoaXMucGFzc0V2ZW50VG9TbGlkZXIsc2NvcGU6dGhpc30pO3ZhciBiPXRoaXMubWFwLnpvb207IXRoaXMuZm9yY2VGaXhlZFpvb21MZXZlbCYmdGhpcy5tYXAuZnJhY3Rpb25hbFpvb20/KGIrPXRoaXMuZGVsdGFZL3RoaXMuem9vbVN0b3BIZWlnaHQsYj1NYXRoLm1pbihNYXRoLm1heChiLDApLHRoaXMubWFwLmdldE51bVpvb21MZXZlbHMoKS0xKSk6KGIrPXRoaXMuZGVsdGFZL3RoaXMuem9vbVN0b3BIZWlnaHQsYj1NYXRoLm1heChNYXRoLnJvdW5kKGIpLDApKTt0aGlzLm1hcC56b29tVG8oYik7dGhpcy56b29tU3RhcnQ9dGhpcy5tb3VzZURyYWdTdGFydD1udWxsO3RoaXMuZGVsdGFZPTA7T3BlbkxheWVycy5FdmVudC5zdG9wKGEpfX0sbW92ZVpvb21CYXI6ZnVuY3Rpb24oKXt0aGlzLnNsaWRlci5zdHlsZS50b3A9KHRoaXMubWFwLmdldE51bVpvb21MZXZlbHMoKS0xLXRoaXMubWFwLmdldFpvb20oKSkqdGhpcy56b29tU3RvcEhlaWdodCt0aGlzLnN0YXJ0VG9wK1xuMStcInB4XCJ9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkNvbnRyb2wuUGFuWm9vbUJhclwifSk7T3BlbkxheWVycy5Gb3JtYXQuV0ZTQ2FwYWJpbGl0aWVzPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Gb3JtYXQuWE1MLlZlcnNpb25lZE9HQyx7ZGVmYXVsdFZlcnNpb246XCIxLjEuMFwiLGVycm9yUHJvcGVydHk6XCJzZXJ2aWNlXCIsQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuRm9ybWF0LldGU0NhcGFiaWxpdGllc1wifSk7T3BlbkxheWVycy5Gb3JtYXQuV0ZTQ2FwYWJpbGl0aWVzLnYxPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Gb3JtYXQuWE1MLHtuYW1lc3BhY2VzOnt3ZnM6XCJodHRwOi8vd3d3Lm9wZW5naXMubmV0L3dmc1wiLHhsaW5rOlwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGlua1wiLHhzaTpcImh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hLWluc3RhbmNlXCIsb3dzOlwiaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC9vd3NcIn0sZGVmYXVsdFByZWZpeDpcIndmc1wiLHJlYWQ6ZnVuY3Rpb24oYSl7XCJzdHJpbmdcIj09dHlwZW9mIGEmJihhPU9wZW5MYXllcnMuRm9ybWF0LlhNTC5wcm90b3R5cGUucmVhZC5hcHBseSh0aGlzLFthXSkpO2EmJjk9PWEubm9kZVR5cGUmJihhPWEuZG9jdW1lbnRFbGVtZW50KTt2YXIgYj17fTt0aGlzLnJlYWROb2RlKGEsYik7cmV0dXJuIGJ9LHJlYWRlcnM6e3dmczp7V0ZTX0NhcGFiaWxpdGllczpmdW5jdGlvbihhLGIpe3RoaXMucmVhZENoaWxkTm9kZXMoYSxiKX0sXG5GZWF0dXJlVHlwZUxpc3Q6ZnVuY3Rpb24oYSxiKXtiLmZlYXR1cmVUeXBlTGlzdD17ZmVhdHVyZVR5cGVzOltdfTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYi5mZWF0dXJlVHlwZUxpc3QpfSxGZWF0dXJlVHlwZTpmdW5jdGlvbihhLGIpe3ZhciBjPXt9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKTtiLmZlYXR1cmVUeXBlcy5wdXNoKGMpfSxOYW1lOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5nZXRDaGlsZFZhbHVlKGEpO2MmJihjPWMuc3BsaXQoXCI6XCIpLGIubmFtZT1jLnBvcCgpLDA8Yy5sZW5ndGgmJihiLmZlYXR1cmVOUz10aGlzLmxvb2t1cE5hbWVzcGFjZVVSSShhLGNbMF0pKSl9LFRpdGxlOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5nZXRDaGlsZFZhbHVlKGEpO2MmJihiLnRpdGxlPWMpfSxBYnN0cmFjdDpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKTtjJiYoYltcImFic3RyYWN0XCJdPWMpfX19LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZvcm1hdC5XRlNDYXBhYmlsaXRpZXMudjFcIn0pO09wZW5MYXllcnMuRm9ybWF0LldGU0NhcGFiaWxpdGllcy52MV8xXzA9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkZvcm1hdC5XRlNDYXBhYmlsaXRpZXMudjEse3JlZ0V4ZXM6e3RyaW1TcGFjZTovXlxccyp8XFxzKiQvZyxyZW1vdmVTcGFjZTovXFxzKi9nLHNwbGl0U3BhY2U6L1xccysvLHRyaW1Db21tYTovXFxzKixcXHMqL2d9LHJlYWRlcnM6e3dmczpPcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyh7RGVmYXVsdFNSUzpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKTtjJiYoYi5zcnM9Yyl9fSxPcGVuTGF5ZXJzLkZvcm1hdC5XRlNDYXBhYmlsaXRpZXMudjEucHJvdG90eXBlLnJlYWRlcnMud2ZzKSxvd3M6T3BlbkxheWVycy5Gb3JtYXQuT1dTQ29tbW9uLnYxLnByb3RvdHlwZS5yZWFkZXJzLm93c30sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuRm9ybWF0LldGU0NhcGFiaWxpdGllcy52MV8xXzBcIn0pO09wZW5MYXllcnMuTGF5ZXIuSW1hZ2U9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkxheWVyLHtpc0Jhc2VMYXllcjohMCx1cmw6bnVsbCxleHRlbnQ6bnVsbCxzaXplOm51bGwsdGlsZTpudWxsLGFzcGVjdFJhdGlvOm51bGwsaW5pdGlhbGl6ZTpmdW5jdGlvbihhLGIsYyxkLGUpe3RoaXMudXJsPWI7dGhpcy5tYXhFeHRlbnQ9dGhpcy5leHRlbnQ9Yzt0aGlzLnNpemU9ZDtPcGVuTGF5ZXJzLkxheWVyLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsW2EsZV0pO3RoaXMuYXNwZWN0UmF0aW89dGhpcy5leHRlbnQuZ2V0SGVpZ2h0KCkvdGhpcy5zaXplLmgvKHRoaXMuZXh0ZW50LmdldFdpZHRoKCkvdGhpcy5zaXplLncpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy50aWxlJiYodGhpcy5yZW1vdmVUaWxlTW9uaXRvcmluZ0hvb2tzKHRoaXMudGlsZSksdGhpcy50aWxlLmRlc3Ryb3koKSx0aGlzLnRpbGU9bnVsbCk7T3BlbkxheWVycy5MYXllci5wcm90b3R5cGUuZGVzdHJveS5hcHBseSh0aGlzLFxuYXJndW1lbnRzKX0sY2xvbmU6ZnVuY3Rpb24oYSl7bnVsbD09YSYmKGE9bmV3IE9wZW5MYXllcnMuTGF5ZXIuSW1hZ2UodGhpcy5uYW1lLHRoaXMudXJsLHRoaXMuZXh0ZW50LHRoaXMuc2l6ZSx0aGlzLmdldE9wdGlvbnMoKSkpO3JldHVybiBhPU9wZW5MYXllcnMuTGF5ZXIucHJvdG90eXBlLmNsb25lLmFwcGx5KHRoaXMsW2FdKX0sc2V0TWFwOmZ1bmN0aW9uKGEpe251bGw9PXRoaXMub3B0aW9ucy5tYXhSZXNvbHV0aW9uJiYodGhpcy5vcHRpb25zLm1heFJlc29sdXRpb249dGhpcy5hc3BlY3RSYXRpbyp0aGlzLmV4dGVudC5nZXRXaWR0aCgpL3RoaXMuc2l6ZS53KTtPcGVuTGF5ZXJzLkxheWVyLnByb3RvdHlwZS5zZXRNYXAuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxtb3ZlVG86ZnVuY3Rpb24oYSxiLGMpe09wZW5MYXllcnMuTGF5ZXIucHJvdG90eXBlLm1vdmVUby5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIGQ9bnVsbD09dGhpcy50aWxlO2lmKGJ8fGQpe3RoaXMuc2V0VGlsZVNpemUoKTtcbnZhciBlPXRoaXMubWFwLmdldExheWVyUHhGcm9tTG9uTGF0KHtsb246dGhpcy5leHRlbnQubGVmdCxsYXQ6dGhpcy5leHRlbnQudG9wfSk7ZD8odGhpcy50aWxlPW5ldyBPcGVuTGF5ZXJzLlRpbGUuSW1hZ2UodGhpcyxlLHRoaXMuZXh0ZW50LG51bGwsdGhpcy50aWxlU2l6ZSksdGhpcy5hZGRUaWxlTW9uaXRvcmluZ0hvb2tzKHRoaXMudGlsZSkpOih0aGlzLnRpbGUuc2l6ZT10aGlzLnRpbGVTaXplLmNsb25lKCksdGhpcy50aWxlLnBvc2l0aW9uPWUuY2xvbmUoKSk7dGhpcy50aWxlLmRyYXcoKX19LHNldFRpbGVTaXplOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5leHRlbnQuZ2V0V2lkdGgoKS90aGlzLm1hcC5nZXRSZXNvbHV0aW9uKCksYj10aGlzLmV4dGVudC5nZXRIZWlnaHQoKS90aGlzLm1hcC5nZXRSZXNvbHV0aW9uKCk7dGhpcy50aWxlU2l6ZT1uZXcgT3BlbkxheWVycy5TaXplKGEsYil9LGFkZFRpbGVNb25pdG9yaW5nSG9va3M6ZnVuY3Rpb24oYSl7YS5vbkxvYWRTdGFydD1cbmZ1bmN0aW9uKCl7dGhpcy5ldmVudHMudHJpZ2dlckV2ZW50KFwibG9hZHN0YXJ0XCIpfTthLmV2ZW50cy5yZWdpc3RlcihcImxvYWRzdGFydFwiLHRoaXMsYS5vbkxvYWRTdGFydCk7YS5vbkxvYWRFbmQ9ZnVuY3Rpb24oKXt0aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJsb2FkZW5kXCIpfTthLmV2ZW50cy5yZWdpc3RlcihcImxvYWRlbmRcIix0aGlzLGEub25Mb2FkRW5kKTthLmV2ZW50cy5yZWdpc3RlcihcInVubG9hZFwiLHRoaXMsYS5vbkxvYWRFbmQpfSxyZW1vdmVUaWxlTW9uaXRvcmluZ0hvb2tzOmZ1bmN0aW9uKGEpe2EudW5sb2FkKCk7YS5ldmVudHMudW4oe2xvYWRzdGFydDphLm9uTG9hZFN0YXJ0LGxvYWRlbmQ6YS5vbkxvYWRFbmQsdW5sb2FkOmEub25Mb2FkRW5kLHNjb3BlOnRoaXN9KX0sc2V0VXJsOmZ1bmN0aW9uKGEpe3RoaXMudXJsPWE7dGhpcy50aWxlLmRyYXcoKX0sZ2V0VVJMOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudXJsfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5MYXllci5JbWFnZVwifSk7T3BlbkxheWVycy5TdHJhdGVneT1PcGVuTGF5ZXJzLkNsYXNzKHtsYXllcjpudWxsLG9wdGlvbnM6bnVsbCxhY3RpdmU6bnVsbCxhdXRvQWN0aXZhdGU6ITAsYXV0b0Rlc3Ryb3k6ITAsaW5pdGlhbGl6ZTpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHRoaXMsYSk7dGhpcy5vcHRpb25zPWE7dGhpcy5hY3RpdmU9ITF9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLmRlYWN0aXZhdGUoKTt0aGlzLm9wdGlvbnM9dGhpcy5sYXllcj1udWxsfSxzZXRMYXllcjpmdW5jdGlvbihhKXt0aGlzLmxheWVyPWF9LGFjdGl2YXRlOmZ1bmN0aW9uKCl7cmV0dXJuIXRoaXMuYWN0aXZlP3RoaXMuYWN0aXZlPSEwOiExfSxkZWFjdGl2YXRlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYWN0aXZlPyh0aGlzLmFjdGl2ZT0hMSwhMCk6ITF9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLlN0cmF0ZWd5XCJ9KTtPcGVuTGF5ZXJzLlN0cmF0ZWd5LlNhdmU9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLlN0cmF0ZWd5LHtldmVudHM6bnVsbCxhdXRvOiExLHRpbWVyOm51bGwsaW5pdGlhbGl6ZTpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLlN0cmF0ZWd5LnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsW2FdKTt0aGlzLmV2ZW50cz1uZXcgT3BlbkxheWVycy5FdmVudHModGhpcyl9LGFjdGl2YXRlOmZ1bmN0aW9uKCl7dmFyIGE9T3BlbkxheWVycy5TdHJhdGVneS5wcm90b3R5cGUuYWN0aXZhdGUuY2FsbCh0aGlzKTtpZihhJiZ0aGlzLmF1dG8paWYoXCJudW1iZXJcIj09PXR5cGVvZiB0aGlzLmF1dG8pdGhpcy50aW1lcj13aW5kb3cuc2V0SW50ZXJ2YWwoT3BlbkxheWVycy5GdW5jdGlvbi5iaW5kKHRoaXMuc2F2ZSx0aGlzKSwxRTMqdGhpcy5hdXRvKTtlbHNlIHRoaXMubGF5ZXIuZXZlbnRzLm9uKHtmZWF0dXJlYWRkZWQ6dGhpcy50cmlnZ2VyU2F2ZSxhZnRlcmZlYXR1cmVtb2RpZmllZDp0aGlzLnRyaWdnZXJTYXZlLFxuc2NvcGU6dGhpc30pO3JldHVybiBhfSxkZWFjdGl2YXRlOmZ1bmN0aW9uKCl7dmFyIGE9T3BlbkxheWVycy5TdHJhdGVneS5wcm90b3R5cGUuZGVhY3RpdmF0ZS5jYWxsKHRoaXMpO2EmJnRoaXMuYXV0byYmKFwibnVtYmVyXCI9PT10eXBlb2YgdGhpcy5hdXRvP3dpbmRvdy5jbGVhckludGVydmFsKHRoaXMudGltZXIpOnRoaXMubGF5ZXIuZXZlbnRzLnVuKHtmZWF0dXJlYWRkZWQ6dGhpcy50cmlnZ2VyU2F2ZSxhZnRlcmZlYXR1cmVtb2RpZmllZDp0aGlzLnRyaWdnZXJTYXZlLHNjb3BlOnRoaXN9KSk7cmV0dXJuIGF9LHRyaWdnZXJTYXZlOmZ1bmN0aW9uKGEpe3ZhciBiPWEuZmVhdHVyZTsoYi5zdGF0ZT09PU9wZW5MYXllcnMuU3RhdGUuSU5TRVJUfHxiLnN0YXRlPT09T3BlbkxheWVycy5TdGF0ZS5VUERBVEV8fGIuc3RhdGU9PT1PcGVuTGF5ZXJzLlN0YXRlLkRFTEVURSkmJnRoaXMuc2F2ZShbYS5mZWF0dXJlXSl9LHNhdmU6ZnVuY3Rpb24oYSl7YXx8KGE9dGhpcy5sYXllci5mZWF0dXJlcyk7XG50aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJzdGFydFwiLHtmZWF0dXJlczphfSk7dmFyIGI9dGhpcy5sYXllci5wcm9qZWN0aW9uLGM9dGhpcy5sYXllci5tYXAuZ2V0UHJvamVjdGlvbk9iamVjdCgpO2lmKCFjLmVxdWFscyhiKSl7Zm9yKHZhciBkPWEubGVuZ3RoLGU9QXJyYXkoZCksZixnLGg9MDtoPGQ7KytoKWY9YVtoXSxnPWYuY2xvbmUoKSxnLmZpZD1mLmZpZCxnLnN0YXRlPWYuc3RhdGUsZi51cmwmJihnLnVybD1mLnVybCksZy5fb3JpZ2luYWw9ZixnLmdlb21ldHJ5LnRyYW5zZm9ybShjLGIpLGVbaF09ZzthPWV9dGhpcy5sYXllci5wcm90b2NvbC5jb21taXQoYSx7Y2FsbGJhY2s6dGhpcy5vbkNvbW1pdCxzY29wZTp0aGlzfSl9LG9uQ29tbWl0OmZ1bmN0aW9uKGEpe3ZhciBiPXtyZXNwb25zZTphfTtpZihhLnN1Y2Nlc3MoKSl7Zm9yKHZhciBjPWEucmVxRmVhdHVyZXMsZCxlPVtdLGY9YS5pbnNlcnRJZHN8fFtdLGc9MCxoPTAsaT1jLmxlbmd0aDtoPGk7KytoKWlmKGQ9Y1toXSxcbmQ9ZC5fb3JpZ2luYWx8fGQsYT1kLnN0YXRlKWE9PU9wZW5MYXllcnMuU3RhdGUuREVMRVRFP2UucHVzaChkKTphPT1PcGVuTGF5ZXJzLlN0YXRlLklOU0VSVCYmKGQuZmlkPWZbZ10sKytnKSxkLnN0YXRlPW51bGw7MDxlLmxlbmd0aCYmdGhpcy5sYXllci5kZXN0cm95RmVhdHVyZXMoZSk7dGhpcy5ldmVudHMudHJpZ2dlckV2ZW50KFwic3VjY2Vzc1wiLGIpfWVsc2UgdGhpcy5ldmVudHMudHJpZ2dlckV2ZW50KFwiZmFpbFwiLGIpfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5TdHJhdGVneS5TYXZlXCJ9KTtPcGVuTGF5ZXJzLkZvcm1hdC5HUFg9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkZvcm1hdC5YTUwse2RlZmF1bHREZXNjOlwiTm8gZGVzY3JpcHRpb24gYXZhaWxhYmxlXCIsZXh0cmFjdFdheXBvaW50czohMCxleHRyYWN0VHJhY2tzOiEwLGV4dHJhY3RSb3V0ZXM6ITAsZXh0cmFjdEF0dHJpYnV0ZXM6ITAsbmFtZXNwYWNlczp7Z3B4OlwiaHR0cDovL3d3dy50b3BvZ3JhZml4LmNvbS9HUFgvMS8xXCIseHNpOlwiaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEtaW5zdGFuY2VcIn0sc2NoZW1hTG9jYXRpb246XCJodHRwOi8vd3d3LnRvcG9ncmFmaXguY29tL0dQWC8xLzEgaHR0cDovL3d3dy50b3BvZ3JhZml4LmNvbS9HUFgvMS8xL2dweC54c2RcIixjcmVhdG9yOlwiT3BlbkxheWVyc1wiLGluaXRpYWxpemU6ZnVuY3Rpb24oYSl7dGhpcy5leHRlcm5hbFByb2plY3Rpb249bmV3IE9wZW5MYXllcnMuUHJvamVjdGlvbihcIkVQU0c6NDMyNlwiKTtPcGVuTGF5ZXJzLkZvcm1hdC5YTUwucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxcblthXSl9LHJlYWQ6ZnVuY3Rpb24oYSl7XCJzdHJpbmdcIj09dHlwZW9mIGEmJihhPU9wZW5MYXllcnMuRm9ybWF0LlhNTC5wcm90b3R5cGUucmVhZC5hcHBseSh0aGlzLFthXSkpO3ZhciBiPVtdO2lmKHRoaXMuZXh0cmFjdFRyYWNrcylmb3IodmFyIGM9YS5nZXRFbGVtZW50c0J5VGFnTmFtZShcInRya1wiKSxkPTAsZT1jLmxlbmd0aDtkPGU7ZCsrKXt2YXIgZj17fTt0aGlzLmV4dHJhY3RBdHRyaWJ1dGVzJiYoZj10aGlzLnBhcnNlQXR0cmlidXRlcyhjW2RdKSk7Zm9yKHZhciBnPXRoaXMuZ2V0RWxlbWVudHNCeVRhZ05hbWVOUyhjW2RdLGNbZF0ubmFtZXNwYWNlVVJJLFwidHJrc2VnXCIpLGg9MCxpPWcubGVuZ3RoO2g8aTtoKyspe3ZhciBqPXRoaXMuZXh0cmFjdFNlZ21lbnQoZ1toXSxcInRya3B0XCIpO2IucHVzaChuZXcgT3BlbkxheWVycy5GZWF0dXJlLlZlY3RvcihqLGYpKX19aWYodGhpcy5leHRyYWN0Um91dGVzKXtlPWEuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJydGVcIik7Yz0wO2ZvcihkPVxuZS5sZW5ndGg7YzxkO2MrKylmPXt9LHRoaXMuZXh0cmFjdEF0dHJpYnV0ZXMmJihmPXRoaXMucGFyc2VBdHRyaWJ1dGVzKGVbY10pKSxnPXRoaXMuZXh0cmFjdFNlZ21lbnQoZVtjXSxcInJ0ZXB0XCIpLGIucHVzaChuZXcgT3BlbkxheWVycy5GZWF0dXJlLlZlY3RvcihnLGYpKX1pZih0aGlzLmV4dHJhY3RXYXlwb2ludHMpe2E9YS5nZXRFbGVtZW50c0J5VGFnTmFtZShcIndwdFwiKTtjPTA7Zm9yKGU9YS5sZW5ndGg7YzxlO2MrKylmPXt9LHRoaXMuZXh0cmFjdEF0dHJpYnV0ZXMmJihmPXRoaXMucGFyc2VBdHRyaWJ1dGVzKGFbY10pKSxkPW5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGFbY10uZ2V0QXR0cmlidXRlKFwibG9uXCIpLGFbY10uZ2V0QXR0cmlidXRlKFwibGF0XCIpKSxiLnB1c2gobmV3IE9wZW5MYXllcnMuRmVhdHVyZS5WZWN0b3IoZCxmKSl9aWYodGhpcy5pbnRlcm5hbFByb2plY3Rpb24mJnRoaXMuZXh0ZXJuYWxQcm9qZWN0aW9uKXtmPTA7Zm9yKGE9Yi5sZW5ndGg7ZjxcbmE7ZisrKWJbZl0uZ2VvbWV0cnkudHJhbnNmb3JtKHRoaXMuZXh0ZXJuYWxQcm9qZWN0aW9uLHRoaXMuaW50ZXJuYWxQcm9qZWN0aW9uKX1yZXR1cm4gYn0sZXh0cmFjdFNlZ21lbnQ6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9dGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZU5TKGEsYS5uYW1lc3BhY2VVUkksYiksZD1bXSxlPTAsZj1jLmxlbmd0aDtlPGY7ZSsrKWQucHVzaChuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChjW2VdLmdldEF0dHJpYnV0ZShcImxvblwiKSxjW2VdLmdldEF0dHJpYnV0ZShcImxhdFwiKSkpO3JldHVybiBuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5MaW5lU3RyaW5nKGQpfSxwYXJzZUF0dHJpYnV0ZXM6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPXt9LGE9YS5maXJzdENoaWxkLGMsZDthOyl7aWYoMT09YS5ub2RlVHlwZSYmYS5maXJzdENoaWxkJiYoYz1hLmZpcnN0Q2hpbGQsMz09Yy5ub2RlVHlwZXx8ND09Yy5ub2RlVHlwZSkpZD1hLnByZWZpeD9hLm5vZGVOYW1lLnNwbGl0KFwiOlwiKVsxXTpcbmEubm9kZU5hbWUsXCJ0cmtzZWdcIiE9ZCYmXCJydGVwdFwiIT1kJiYoYltkXT1jLm5vZGVWYWx1ZSk7YT1hLm5leHRTaWJsaW5nfXJldHVybiBifSx3cml0ZTpmdW5jdGlvbihhLGIpe3ZhciBhPU9wZW5MYXllcnMuVXRpbC5pc0FycmF5KGEpP2E6W2FdLGM9dGhpcy5jcmVhdGVFbGVtZW50TlModGhpcy5uYW1lc3BhY2VzLmdweCxcImdweFwiKTtjLnNldEF0dHJpYnV0ZShcInZlcnNpb25cIixcIjEuMVwiKTtjLnNldEF0dHJpYnV0ZShcImNyZWF0b3JcIix0aGlzLmNyZWF0b3IpO3RoaXMuc2V0QXR0cmlidXRlcyhjLHtcInhzaTpzY2hlbWFMb2NhdGlvblwiOnRoaXMuc2NoZW1hTG9jYXRpb259KTtiJiZcIm9iamVjdFwiPT10eXBlb2YgYiYmYy5hcHBlbmRDaGlsZCh0aGlzLmJ1aWxkTWV0YWRhdGFOb2RlKGIpKTtmb3IodmFyIGQ9MCxlPWEubGVuZ3RoO2Q8ZTtkKyspYy5hcHBlbmRDaGlsZCh0aGlzLmJ1aWxkRmVhdHVyZU5vZGUoYVtkXSkpO3JldHVybiBPcGVuTGF5ZXJzLkZvcm1hdC5YTUwucHJvdG90eXBlLndyaXRlLmFwcGx5KHRoaXMsXG5bY10pfSxidWlsZE1ldGFkYXRhTm9kZTpmdW5jdGlvbihhKXtmb3IodmFyIGI9W1wibmFtZVwiLFwiZGVzY1wiLFwiYXV0aG9yXCJdLGM9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiZ3B4Om1ldGFkYXRhXCIpLGQ9MDtkPGIubGVuZ3RoO2QrKyl7dmFyIGU9YltkXTtpZihhW2VdKXt2YXIgZj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJncHg6XCIrZSk7Zi5hcHBlbmRDaGlsZCh0aGlzLmNyZWF0ZVRleHROb2RlKGFbZV0pKTtjLmFwcGVuZENoaWxkKGYpfX1yZXR1cm4gY30sYnVpbGRGZWF0dXJlTm9kZTpmdW5jdGlvbihhKXt2YXIgYj1hLmdlb21ldHJ5LGI9Yi5jbG9uZSgpO3RoaXMuaW50ZXJuYWxQcm9qZWN0aW9uJiZ0aGlzLmV4dGVybmFsUHJvamVjdGlvbiYmYi50cmFuc2Zvcm0odGhpcy5pbnRlcm5hbFByb2plY3Rpb24sdGhpcy5leHRlcm5hbFByb2plY3Rpb24pO2lmKFwiT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludFwiPT1iLkNMQVNTX05BTUUpe3ZhciBjPXRoaXMuYnVpbGRXcHROb2RlKGIpO1xudGhpcy5hcHBlbmRBdHRyaWJ1dGVzTm9kZShjLGEpO3JldHVybiBjfWM9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiZ3B4OnRya1wiKTt0aGlzLmFwcGVuZEF0dHJpYnV0ZXNOb2RlKGMsYSk7Zm9yKHZhciBhPXRoaXMuYnVpbGRUcmtTZWdOb2RlKGIpLGE9T3BlbkxheWVycy5VdGlsLmlzQXJyYXkoYSk/YTpbYV0sYj0wLGQ9YS5sZW5ndGg7YjxkO2IrKyljLmFwcGVuZENoaWxkKGFbYl0pO3JldHVybiBjfSxidWlsZFRya1NlZ05vZGU6ZnVuY3Rpb24oYSl7dmFyIGIsYyxkLGU7aWYoXCJPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVTdHJpbmdcIj09YS5DTEFTU19OQU1FfHxcIk9wZW5MYXllcnMuR2VvbWV0cnkuTGluZWFyUmluZ1wiPT1hLkNMQVNTX05BTUUpe2I9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiZ3B4OnRya3NlZ1wiKTtjPTA7Zm9yKGQ9YS5jb21wb25lbnRzLmxlbmd0aDtjPGQ7YysrKWU9YS5jb21wb25lbnRzW2NdLGIuYXBwZW5kQ2hpbGQodGhpcy5idWlsZFRya1B0Tm9kZShlKSk7XG5yZXR1cm4gYn1iPVtdO2M9MDtmb3IoZD1hLmNvbXBvbmVudHMubGVuZ3RoO2M8ZDtjKyspYi5wdXNoKHRoaXMuYnVpbGRUcmtTZWdOb2RlKGEuY29tcG9uZW50c1tjXSkpO3JldHVybiBifSxidWlsZFRya1B0Tm9kZTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJncHg6dHJrcHRcIik7Yi5zZXRBdHRyaWJ1dGUoXCJsb25cIixhLngpO2Iuc2V0QXR0cmlidXRlKFwibGF0XCIsYS55KTtyZXR1cm4gYn0sYnVpbGRXcHROb2RlOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcImdweDp3cHRcIik7Yi5zZXRBdHRyaWJ1dGUoXCJsb25cIixhLngpO2Iuc2V0QXR0cmlidXRlKFwibGF0XCIsYS55KTtyZXR1cm4gYn0sYXBwZW5kQXR0cmlidXRlc05vZGU6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJncHg6bmFtZVwiKTtjLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlVGV4dE5vZGUoYi5hdHRyaWJ1dGVzLm5hbWV8fFxuYi5pZCkpO2EuYXBwZW5kQ2hpbGQoYyk7Yz10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJncHg6ZGVzY1wiKTtjLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlVGV4dE5vZGUoYi5hdHRyaWJ1dGVzLmRlc2NyaXB0aW9ufHx0aGlzLmRlZmF1bHREZXNjKSk7YS5hcHBlbmRDaGlsZChjKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuRm9ybWF0LkdQWFwifSk7T3BlbkxheWVycy5Gb3JtYXQuV01TRGVzY3JpYmVMYXllcj1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuRm9ybWF0LlhNTC5WZXJzaW9uZWRPR0Mse2RlZmF1bHRWZXJzaW9uOlwiMS4xLjFcIixnZXRWZXJzaW9uOmZ1bmN0aW9uKGEsYil7dmFyIGM9T3BlbkxheWVycy5Gb3JtYXQuWE1MLlZlcnNpb25lZE9HQy5wcm90b3R5cGUuZ2V0VmVyc2lvbi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7aWYoXCIxLjEuMVwiPT1jfHxcIjEuMS4wXCI9PWMpYz1cIjEuMVwiO3JldHVybiBjfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Gb3JtYXQuV01TRGVzY3JpYmVMYXllclwifSk7T3BlbkxheWVycy5Gb3JtYXQuV01TRGVzY3JpYmVMYXllci52MV8xPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Gb3JtYXQuV01TRGVzY3JpYmVMYXllcix7aW5pdGlhbGl6ZTpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLkZvcm1hdC5XTVNEZXNjcmliZUxheWVyLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsW2FdKX0scmVhZDpmdW5jdGlvbihhKXtcInN0cmluZ1wiPT10eXBlb2YgYSYmKGE9T3BlbkxheWVycy5Gb3JtYXQuWE1MLnByb3RvdHlwZS5yZWFkLmFwcGx5KHRoaXMsW2FdKSk7Zm9yKHZhciBhPWEuZG9jdW1lbnRFbGVtZW50LmNoaWxkTm9kZXMsYj1bXSxjLGQsZT0wO2U8YS5sZW5ndGg7KytlKWlmKGM9YVtlXSxkPWMubm9kZU5hbWUsXCJMYXllckRlc2NyaXB0aW9uXCI9PWQpe2Q9Yy5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpO3ZhciBmPVwiXCIsZz1cIlwiLGg9XCJcIjtjLmdldEF0dHJpYnV0ZShcIm93c1R5cGVcIik/KGY9Yy5nZXRBdHRyaWJ1dGUoXCJvd3NUeXBlXCIpLGc9Yy5nZXRBdHRyaWJ1dGUoXCJvd3NVUkxcIikpOlxuXCJcIiE9Yy5nZXRBdHRyaWJ1dGUoXCJ3ZnNcIik/KGY9XCJXRlNcIixnPWMuZ2V0QXR0cmlidXRlKFwid2ZzXCIpKTpcIlwiIT1jLmdldEF0dHJpYnV0ZShcIndjc1wiKSYmKGY9XCJXQ1NcIixnPWMuZ2V0QXR0cmlidXRlKFwid2NzXCIpKTtjPWMuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJRdWVyeVwiKTswPGMubGVuZ3RoJiYoKGg9Y1swXS5nZXRBdHRyaWJ1dGUoXCJ0eXBlTmFtZVwiKSl8fChoPWNbMF0uZ2V0QXR0cmlidXRlKFwidHlwZW5hbWVcIikpKTtiLnB1c2goe2xheWVyTmFtZTpkLG93c1R5cGU6Zixvd3NVUkw6Zyx0eXBlTmFtZTpofSl9cmV0dXJuIGJ9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZvcm1hdC5XTVNEZXNjcmliZUxheWVyLnYxXzFcIn0pO09wZW5MYXllcnMuTGF5ZXIuWFlaPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5MYXllci5HcmlkLHtpc0Jhc2VMYXllcjohMCxzcGhlcmljYWxNZXJjYXRvcjohMSx6b29tT2Zmc2V0OjAsc2VydmVyUmVzb2x1dGlvbnM6bnVsbCxpbml0aWFsaXplOmZ1bmN0aW9uKGEsYixjKXtpZihjJiZjLnNwaGVyaWNhbE1lcmNhdG9yfHx0aGlzLnNwaGVyaWNhbE1lcmNhdG9yKWM9T3BlbkxheWVycy5VdGlsLmV4dGVuZCh7cHJvamVjdGlvbjpcIkVQU0c6OTAwOTEzXCIsbnVtWm9vbUxldmVsczoxOX0sYyk7T3BlbkxheWVycy5MYXllci5HcmlkLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsW2F8fHRoaXMubmFtZSxifHx0aGlzLnVybCx7fSxjXSl9LGNsb25lOmZ1bmN0aW9uKGEpe251bGw9PWEmJihhPW5ldyBPcGVuTGF5ZXJzLkxheWVyLlhZWih0aGlzLm5hbWUsdGhpcy51cmwsdGhpcy5nZXRPcHRpb25zKCkpKTtyZXR1cm4gYT1PcGVuTGF5ZXJzLkxheWVyLkdyaWQucHJvdG90eXBlLmNsb25lLmFwcGx5KHRoaXMsXG5bYV0pfSxnZXRVUkw6ZnVuY3Rpb24oYSl7dmFyIGE9dGhpcy5nZXRYWVooYSksYj10aGlzLnVybDtPcGVuTGF5ZXJzLlV0aWwuaXNBcnJheShiKSYmKGI9dGhpcy5zZWxlY3RVcmwoXCJcIithLngrYS55K2EueixiKSk7cmV0dXJuIE9wZW5MYXllcnMuU3RyaW5nLmZvcm1hdChiLGEpfSxnZXRYWVo6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5nZXRTZXJ2ZXJSZXNvbHV0aW9uKCksYz1NYXRoLnJvdW5kKChhLmxlZnQtdGhpcy5tYXhFeHRlbnQubGVmdCkvKGIqdGhpcy50aWxlU2l6ZS53KSksYT1NYXRoLnJvdW5kKCh0aGlzLm1heEV4dGVudC50b3AtYS50b3ApLyhiKnRoaXMudGlsZVNpemUuaCkpLGI9dGhpcy5nZXRTZXJ2ZXJab29tKCk7aWYodGhpcy53cmFwRGF0ZUxpbmUpdmFyIGQ9TWF0aC5wb3coMixiKSxjPShjJWQrZCklZDtyZXR1cm57eDpjLHk6YSx6OmJ9fSxzZXRNYXA6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5MYXllci5HcmlkLnByb3RvdHlwZS5zZXRNYXAuYXBwbHkodGhpcyxcbmFyZ3VtZW50cyk7dGhpcy50aWxlT3JpZ2lufHwodGhpcy50aWxlT3JpZ2luPW5ldyBPcGVuTGF5ZXJzLkxvbkxhdCh0aGlzLm1heEV4dGVudC5sZWZ0LHRoaXMubWF4RXh0ZW50LmJvdHRvbSkpfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5MYXllci5YWVpcIn0pO09wZW5MYXllcnMuTGF5ZXIuT1NNPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5MYXllci5YWVose25hbWU6XCJPcGVuU3RyZWV0TWFwXCIsdXJsOltcImh0dHA6Ly9hLnRpbGUub3BlbnN0cmVldG1hcC5vcmcvJHt6fS8ke3h9LyR7eX0ucG5nXCIsXCJodHRwOi8vYi50aWxlLm9wZW5zdHJlZXRtYXAub3JnLyR7en0vJHt4fS8ke3l9LnBuZ1wiLFwiaHR0cDovL2MudGlsZS5vcGVuc3RyZWV0bWFwLm9yZy8ke3p9LyR7eH0vJHt5fS5wbmdcIl0sYXR0cmlidXRpb246XCJEYXRhIENDLUJ5LVNBIGJ5IDxhIGhyZWY9J2h0dHA6Ly9vcGVuc3RyZWV0bWFwLm9yZy8nPk9wZW5TdHJlZXRNYXA8L2E+XCIsc3BoZXJpY2FsTWVyY2F0b3I6ITAsd3JhcERhdGVMaW5lOiEwLHRpbGVPcHRpb25zOm51bGwsaW5pdGlhbGl6ZTpmdW5jdGlvbihhLGIsYyl7T3BlbkxheWVycy5MYXllci5YWVoucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMudGlsZU9wdGlvbnM9T3BlbkxheWVycy5VdGlsLmV4dGVuZCh7Y3Jvc3NPcmlnaW5LZXl3b3JkOlwiYW5vbnltb3VzXCJ9LFxudGhpcy5vcHRpb25zJiZ0aGlzLm9wdGlvbnMudGlsZU9wdGlvbnMpfSxjbG9uZTpmdW5jdGlvbihhKXtudWxsPT1hJiYoYT1uZXcgT3BlbkxheWVycy5MYXllci5PU00odGhpcy5uYW1lLHRoaXMudXJsLHRoaXMuZ2V0T3B0aW9ucygpKSk7cmV0dXJuIGE9T3BlbkxheWVycy5MYXllci5YWVoucHJvdG90eXBlLmNsb25lLmFwcGx5KHRoaXMsW2FdKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuTGF5ZXIuT1NNXCJ9KTtPcGVuTGF5ZXJzLlJlbmRlcmVyPU9wZW5MYXllcnMuQ2xhc3Moe2NvbnRhaW5lcjpudWxsLHJvb3Q6bnVsbCxleHRlbnQ6bnVsbCxsb2NrZWQ6ITEsc2l6ZTpudWxsLHJlc29sdXRpb246bnVsbCxtYXA6bnVsbCxmZWF0dXJlRHg6MCxpbml0aWFsaXplOmZ1bmN0aW9uKGEsYil7dGhpcy5jb250YWluZXI9T3BlbkxheWVycy5VdGlsLmdldEVsZW1lbnQoYSk7T3BlbkxheWVycy5VdGlsLmV4dGVuZCh0aGlzLGIpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5tYXA9dGhpcy5yZXNvbHV0aW9uPXRoaXMuc2l6ZT10aGlzLmV4dGVudD10aGlzLmNvbnRhaW5lcj1udWxsfSxzdXBwb3J0ZWQ6ZnVuY3Rpb24oKXtyZXR1cm4hMX0sc2V0RXh0ZW50OmZ1bmN0aW9uKGEsYil7dGhpcy5leHRlbnQ9YS5jbG9uZSgpO2lmKHRoaXMubWFwLmJhc2VMYXllciYmdGhpcy5tYXAuYmFzZUxheWVyLndyYXBEYXRlTGluZSl7dmFyIGM9YS5nZXRXaWR0aCgpL3RoaXMubWFwLmdldEV4dGVudCgpLmdldFdpZHRoKCksXG5hPWEuc2NhbGUoMS9jKTt0aGlzLmV4dGVudD1hLndyYXBEYXRlTGluZSh0aGlzLm1hcC5nZXRNYXhFeHRlbnQoKSkuc2NhbGUoYyl9YiYmKHRoaXMucmVzb2x1dGlvbj1udWxsKTtyZXR1cm4hMH0sc2V0U2l6ZTpmdW5jdGlvbihhKXt0aGlzLnNpemU9YS5jbG9uZSgpO3RoaXMucmVzb2x1dGlvbj1udWxsfSxnZXRSZXNvbHV0aW9uOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVzb2x1dGlvbj10aGlzLnJlc29sdXRpb258fHRoaXMubWFwLmdldFJlc29sdXRpb24oKX0sZHJhd0ZlYXR1cmU6ZnVuY3Rpb24oYSxiKXtudWxsPT1iJiYoYj1hLnN0eWxlKTtpZihhLmdlb21ldHJ5KXt2YXIgYz1hLmdlb21ldHJ5LmdldEJvdW5kcygpO2lmKGMpe3ZhciBkO3RoaXMubWFwLmJhc2VMYXllciYmdGhpcy5tYXAuYmFzZUxheWVyLndyYXBEYXRlTGluZSYmKGQ9dGhpcy5tYXAuZ2V0TWF4RXh0ZW50KCkpO2MuaW50ZXJzZWN0c0JvdW5kcyh0aGlzLmV4dGVudCx7d29ybGRCb3VuZHM6ZH0pP3RoaXMuY2FsY3VsYXRlRmVhdHVyZUR4KGMsXG5kKTpiPXtkaXNwbGF5Olwibm9uZVwifTtjPXRoaXMuZHJhd0dlb21ldHJ5KGEuZ2VvbWV0cnksYixhLmlkKTtpZihcIm5vbmVcIiE9Yi5kaXNwbGF5JiZiLmxhYmVsJiYhMSE9PWMpe2Q9YS5nZW9tZXRyeS5nZXRDZW50cm9pZCgpO2lmKGIubGFiZWxYT2Zmc2V0fHxiLmxhYmVsWU9mZnNldCl7dmFyIGU9aXNOYU4oYi5sYWJlbFhPZmZzZXQpPzA6Yi5sYWJlbFhPZmZzZXQsZj1pc05hTihiLmxhYmVsWU9mZnNldCk/MDpiLmxhYmVsWU9mZnNldCxnPXRoaXMuZ2V0UmVzb2x1dGlvbigpO2QubW92ZShlKmcsZipnKX10aGlzLmRyYXdUZXh0KGEuaWQsYixkKX1lbHNlIHRoaXMucmVtb3ZlVGV4dChhLmlkKTtyZXR1cm4gY319fSxjYWxjdWxhdGVGZWF0dXJlRHg6ZnVuY3Rpb24oYSxiKXt0aGlzLmZlYXR1cmVEeD0wO2lmKGIpe3ZhciBjPWIuZ2V0V2lkdGgoKTt0aGlzLmZlYXR1cmVEeD1NYXRoLnJvdW5kKCgoYS5sZWZ0K2EucmlnaHQpLzItKHRoaXMuZXh0ZW50LmxlZnQrdGhpcy5leHRlbnQucmlnaHQpL1xuMikvYykqY319LGRyYXdHZW9tZXRyeTpmdW5jdGlvbigpe30sZHJhd1RleHQ6ZnVuY3Rpb24oKXt9LHJlbW92ZVRleHQ6ZnVuY3Rpb24oKXt9LGNsZWFyOmZ1bmN0aW9uKCl7fSxnZXRGZWF0dXJlSWRGcm9tRXZlbnQ6ZnVuY3Rpb24oKXt9LGVyYXNlRmVhdHVyZXM6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5VdGlsLmlzQXJyYXkoYSl8fChhPVthXSk7Zm9yKHZhciBiPTAsYz1hLmxlbmd0aDtiPGM7KytiKXt2YXIgZD1hW2JdO3RoaXMuZXJhc2VHZW9tZXRyeShkLmdlb21ldHJ5LGQuaWQpO3RoaXMucmVtb3ZlVGV4dChkLmlkKX19LGVyYXNlR2VvbWV0cnk6ZnVuY3Rpb24oKXt9LG1vdmVSb290OmZ1bmN0aW9uKCl7fSxnZXRSZW5kZXJMYXllcklkOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29udGFpbmVyLmlkfSxhcHBseURlZmF1bHRTeW1ib2xpemVyOmZ1bmN0aW9uKGEpe3ZhciBiPU9wZW5MYXllcnMuVXRpbC5leHRlbmQoe30sT3BlbkxheWVycy5SZW5kZXJlci5kZWZhdWx0U3ltYm9saXplcik7XG4hMT09PWEuc3Ryb2tlJiYoZGVsZXRlIGIuc3Ryb2tlV2lkdGgsZGVsZXRlIGIuc3Ryb2tlQ29sb3IpOyExPT09YS5maWxsJiZkZWxldGUgYi5maWxsQ29sb3I7T3BlbkxheWVycy5VdGlsLmV4dGVuZChiLGEpO3JldHVybiBifSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5SZW5kZXJlclwifSk7T3BlbkxheWVycy5SZW5kZXJlci5kZWZhdWx0U3ltYm9saXplcj17ZmlsbENvbG9yOlwiIzAwMDAwMFwiLHN0cm9rZUNvbG9yOlwiIzAwMDAwMFwiLHN0cm9rZVdpZHRoOjIsZmlsbE9wYWNpdHk6MSxzdHJva2VPcGFjaXR5OjEscG9pbnRSYWRpdXM6MCxsYWJlbEFsaWduOlwiY21cIn07XG5PcGVuTGF5ZXJzLlJlbmRlcmVyLnN5bWJvbD17c3RhcjpbMzUwLDc1LDM3OSwxNjEsNDY5LDE2MSwzOTcsMjE1LDQyMywzMDEsMzUwLDI1MCwyNzcsMzAxLDMwMywyMTUsMjMxLDE2MSwzMjEsMTYxLDM1MCw3NV0sY3Jvc3M6WzQsMCw2LDAsNiw0LDEwLDQsMTAsNiw2LDYsNiwxMCw0LDEwLDQsNiwwLDYsMCw0LDQsNCw0LDBdLHg6WzAsMCwyNSwwLDUwLDM1LDc1LDAsMTAwLDAsNjUsNTAsMTAwLDEwMCw3NSwxMDAsNTAsNjUsMjUsMTAwLDAsMTAwLDM1LDUwLDAsMF0sc3F1YXJlOlswLDAsMCwxLDEsMSwxLDAsMCwwXSx0cmlhbmdsZTpbMCwxMCwxMCwxMCw1LDAsMCwxMF19O09wZW5MYXllcnMuUmVuZGVyZXIuQ2FudmFzPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5SZW5kZXJlcix7aGl0RGV0ZWN0aW9uOiEwLGhpdE92ZXJmbG93OjAsY2FudmFzOm51bGwsZmVhdHVyZXM6bnVsbCxwZW5kaW5nUmVkcmF3OiExLGNhY2hlZFN5bWJvbEJvdW5kczp7fSxpbml0aWFsaXplOmZ1bmN0aW9uKGEsYil7T3BlbkxheWVycy5SZW5kZXJlci5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5yb290PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7dGhpcy5jb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5yb290KTt0aGlzLmNhbnZhcz10aGlzLnJvb3QuZ2V0Q29udGV4dChcIjJkXCIpO3RoaXMuZmVhdHVyZXM9e307dGhpcy5oaXREZXRlY3Rpb24mJih0aGlzLmhpdENhbnZhcz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpLHRoaXMuaGl0Q29udGV4dD10aGlzLmhpdENhbnZhcy5nZXRDb250ZXh0KFwiMmRcIikpfSxcbnNldEV4dGVudDpmdW5jdGlvbigpe09wZW5MYXllcnMuUmVuZGVyZXIucHJvdG90eXBlLnNldEV4dGVudC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuITF9LGVyYXNlR2VvbWV0cnk6ZnVuY3Rpb24oYSxiKXt0aGlzLmVyYXNlRmVhdHVyZXModGhpcy5mZWF0dXJlc1tiXVswXSl9LHN1cHBvcnRlZDpmdW5jdGlvbigpe3JldHVybiBPcGVuTGF5ZXJzLkNBTlZBU19TVVBQT1JURUR9LHNldFNpemU6ZnVuY3Rpb24oYSl7dGhpcy5zaXplPWEuY2xvbmUoKTt2YXIgYj10aGlzLnJvb3Q7Yi5zdHlsZS53aWR0aD1hLncrXCJweFwiO2Iuc3R5bGUuaGVpZ2h0PWEuaCtcInB4XCI7Yi53aWR0aD1hLnc7Yi5oZWlnaHQ9YS5oO3RoaXMucmVzb2x1dGlvbj1udWxsO3RoaXMuaGl0RGV0ZWN0aW9uJiYoYj10aGlzLmhpdENhbnZhcyxiLnN0eWxlLndpZHRoPWEudytcInB4XCIsYi5zdHlsZS5oZWlnaHQ9YS5oK1wicHhcIixiLndpZHRoPWEudyxiLmhlaWdodD1hLmgpfSxkcmF3RmVhdHVyZTpmdW5jdGlvbihhLFxuYil7dmFyIGM7aWYoYS5nZW9tZXRyeSl7Yj10aGlzLmFwcGx5RGVmYXVsdFN5bWJvbGl6ZXIoYnx8YS5zdHlsZSk7Yz1hLmdlb21ldHJ5LmdldEJvdW5kcygpO3ZhciBkO3RoaXMubWFwLmJhc2VMYXllciYmdGhpcy5tYXAuYmFzZUxheWVyLndyYXBEYXRlTGluZSYmKGQ9dGhpcy5tYXAuZ2V0TWF4RXh0ZW50KCkpO2Q9YyYmYy5pbnRlcnNlY3RzQm91bmRzKHRoaXMuZXh0ZW50LHt3b3JsZEJvdW5kczpkfSk7KGM9XCJub25lXCIhPT1iLmRpc3BsYXkmJiEhYyYmZCk/dGhpcy5mZWF0dXJlc1thLmlkXT1bYSxiXTpkZWxldGUgdGhpcy5mZWF0dXJlc1thLmlkXTt0aGlzLnBlbmRpbmdSZWRyYXc9ITB9dGhpcy5wZW5kaW5nUmVkcmF3JiYhdGhpcy5sb2NrZWQmJih0aGlzLnJlZHJhdygpLHRoaXMucGVuZGluZ1JlZHJhdz0hMSk7cmV0dXJuIGN9LGRyYXdHZW9tZXRyeTpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9YS5DTEFTU19OQU1FO2lmKFwiT3BlbkxheWVycy5HZW9tZXRyeS5Db2xsZWN0aW9uXCI9PVxuZHx8XCJPcGVuTGF5ZXJzLkdlb21ldHJ5Lk11bHRpUG9pbnRcIj09ZHx8XCJPcGVuTGF5ZXJzLkdlb21ldHJ5Lk11bHRpTGluZVN0cmluZ1wiPT1kfHxcIk9wZW5MYXllcnMuR2VvbWV0cnkuTXVsdGlQb2x5Z29uXCI9PWQpZm9yKGQ9MDtkPGEuY29tcG9uZW50cy5sZW5ndGg7ZCsrKXRoaXMuZHJhd0dlb21ldHJ5KGEuY29tcG9uZW50c1tkXSxiLGMpO2Vsc2Ugc3dpdGNoKGEuQ0xBU1NfTkFNRSl7Y2FzZSBcIk9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnRcIjp0aGlzLmRyYXdQb2ludChhLGIsYyk7YnJlYWs7Y2FzZSBcIk9wZW5MYXllcnMuR2VvbWV0cnkuTGluZVN0cmluZ1wiOnRoaXMuZHJhd0xpbmVTdHJpbmcoYSxiLGMpO2JyZWFrO2Nhc2UgXCJPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVhclJpbmdcIjp0aGlzLmRyYXdMaW5lYXJSaW5nKGEsYixjKTticmVhaztjYXNlIFwiT3BlbkxheWVycy5HZW9tZXRyeS5Qb2x5Z29uXCI6dGhpcy5kcmF3UG9seWdvbihhLGIsYyl9fSxkcmF3RXh0ZXJuYWxHcmFwaGljOmZ1bmN0aW9uKGEsXG5iLGMpe3ZhciBkPW5ldyBJbWFnZTtiLmdyYXBoaWNUaXRsZSYmKGQudGl0bGU9Yi5ncmFwaGljVGl0bGUpO3ZhciBlPWIuZ3JhcGhpY1dpZHRofHxiLmdyYXBoaWNIZWlnaHQsZj1iLmdyYXBoaWNIZWlnaHR8fGIuZ3JhcGhpY1dpZHRoLGU9ZT9lOjIqYi5wb2ludFJhZGl1cyxmPWY/ZjoyKmIucG9pbnRSYWRpdXMsZz12b2lkIDAhPWIuZ3JhcGhpY1hPZmZzZXQ/Yi5ncmFwaGljWE9mZnNldDotKDAuNSplKSxoPXZvaWQgMCE9Yi5ncmFwaGljWU9mZnNldD9iLmdyYXBoaWNZT2Zmc2V0Oi0oMC41KmYpLGk9Yi5ncmFwaGljT3BhY2l0eXx8Yi5maWxsT3BhY2l0eTtkLm9ubG9hZD1PcGVuTGF5ZXJzLkZ1bmN0aW9uLmJpbmQoZnVuY3Rpb24oKXtpZih0aGlzLmZlYXR1cmVzW2NdKXt2YXIgYj10aGlzLmdldExvY2FsWFkoYSksaz1iWzBdLGI9YlsxXTtpZighaXNOYU4oaykmJiFpc05hTihiKSl7dmFyIGs9aytnfDAsYj1iK2h8MCxsPXRoaXMuY2FudmFzO2wuZ2xvYmFsQWxwaGE9aTt2YXIgbT1cbk9wZW5MYXllcnMuUmVuZGVyZXIuQ2FudmFzLmRyYXdJbWFnZVNjYWxlRmFjdG9yfHwoT3BlbkxheWVycy5SZW5kZXJlci5DYW52YXMuZHJhd0ltYWdlU2NhbGVGYWN0b3I9L2FuZHJvaWQgMi4xLy50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKSk/MzIwL3dpbmRvdy5zY3JlZW4ud2lkdGg6MSk7bC5kcmF3SW1hZ2UoZCxrKm0sYiptLGUqbSxmKm0pO2lmKHRoaXMuaGl0RGV0ZWN0aW9uKXt0aGlzLnNldEhpdENvbnRleHRTdHlsZShcImZpbGxcIixjKTt0aGlzLmhpdENvbnRleHQuZmlsbFJlY3QoayxiLGUsZil9fX19LHRoaXMpO2Quc3JjPWIuZXh0ZXJuYWxHcmFwaGljfSxkcmF3TmFtZWRTeW1ib2w6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGUsZixnO2Y9TWF0aC5QSS8xODA7dmFyIGg9T3BlbkxheWVycy5SZW5kZXJlci5zeW1ib2xbYi5ncmFwaGljTmFtZV07aWYoIWgpdGhyb3cgRXJyb3IoYi5ncmFwaGljTmFtZStcIiBpcyBub3QgYSB2YWxpZCBzeW1ib2wgbmFtZVwiKTtcbmlmKGgubGVuZ3RoJiYhKDI+aC5sZW5ndGgpJiYoYT10aGlzLmdldExvY2FsWFkoYSksZT1hWzBdLGc9YVsxXSwhaXNOYU4oZSkmJiFpc05hTihnKSkpe3RoaXMuY2FudmFzLmxpbmVDYXA9XCJyb3VuZFwiO3RoaXMuY2FudmFzLmxpbmVKb2luPVwicm91bmRcIjt0aGlzLmhpdERldGVjdGlvbiYmKHRoaXMuaGl0Q29udGV4dC5saW5lQ2FwPVwicm91bmRcIix0aGlzLmhpdENvbnRleHQubGluZUpvaW49XCJyb3VuZFwiKTtpZihiLmdyYXBoaWNOYW1lIGluIHRoaXMuY2FjaGVkU3ltYm9sQm91bmRzKWQ9dGhpcy5jYWNoZWRTeW1ib2xCb3VuZHNbYi5ncmFwaGljTmFtZV07ZWxzZXtkPW5ldyBPcGVuTGF5ZXJzLkJvdW5kcztmb3IoYT0wO2E8aC5sZW5ndGg7YSs9MilkLmV4dGVuZChuZXcgT3BlbkxheWVycy5Mb25MYXQoaFthXSxoW2ErMV0pKTt0aGlzLmNhY2hlZFN5bWJvbEJvdW5kc1tiLmdyYXBoaWNOYW1lXT1kfXRoaXMuY2FudmFzLnNhdmUoKTt0aGlzLmhpdERldGVjdGlvbiYmdGhpcy5oaXRDb250ZXh0LnNhdmUoKTtcbnRoaXMuY2FudmFzLnRyYW5zbGF0ZShlLGcpO3RoaXMuaGl0RGV0ZWN0aW9uJiZ0aGlzLmhpdENvbnRleHQudHJhbnNsYXRlKGUsZyk7YT1mKmIucm90YXRpb247aXNOYU4oYSl8fCh0aGlzLmNhbnZhcy5yb3RhdGUoYSksdGhpcy5oaXREZXRlY3Rpb24mJnRoaXMuaGl0Q29udGV4dC5yb3RhdGUoYSkpO2Y9MipiLnBvaW50UmFkaXVzL01hdGgubWF4KGQuZ2V0V2lkdGgoKSxkLmdldEhlaWdodCgpKTt0aGlzLmNhbnZhcy5zY2FsZShmLGYpO3RoaXMuaGl0RGV0ZWN0aW9uJiZ0aGlzLmhpdENvbnRleHQuc2NhbGUoZixmKTthPWQuZ2V0Q2VudGVyTG9uTGF0KCkubG9uO2Q9ZC5nZXRDZW50ZXJMb25MYXQoKS5sYXQ7dGhpcy5jYW52YXMudHJhbnNsYXRlKC1hLC1kKTt0aGlzLmhpdERldGVjdGlvbiYmdGhpcy5oaXRDb250ZXh0LnRyYW5zbGF0ZSgtYSwtZCk7Zz1iLnN0cm9rZVdpZHRoO2Iuc3Ryb2tlV2lkdGg9Zy9mO2lmKCExIT09Yi5maWxsKXt0aGlzLnNldENhbnZhc1N0eWxlKFwiZmlsbFwiLFxuYik7dGhpcy5jYW52YXMuYmVnaW5QYXRoKCk7Zm9yKGE9MDthPGgubGVuZ3RoO2ErPTIpZD1oW2FdLGU9aFthKzFdLDA9PWEmJnRoaXMuY2FudmFzLm1vdmVUbyhkLGUpLHRoaXMuY2FudmFzLmxpbmVUbyhkLGUpO3RoaXMuY2FudmFzLmNsb3NlUGF0aCgpO3RoaXMuY2FudmFzLmZpbGwoKTtpZih0aGlzLmhpdERldGVjdGlvbil7dGhpcy5zZXRIaXRDb250ZXh0U3R5bGUoXCJmaWxsXCIsYyxiKTt0aGlzLmhpdENvbnRleHQuYmVnaW5QYXRoKCk7Zm9yKGE9MDthPGgubGVuZ3RoO2ErPTIpZD1oW2FdLGU9aFthKzFdLDA9PWEmJnRoaXMuY2FudmFzLm1vdmVUbyhkLGUpLHRoaXMuaGl0Q29udGV4dC5saW5lVG8oZCxlKTt0aGlzLmhpdENvbnRleHQuY2xvc2VQYXRoKCk7dGhpcy5oaXRDb250ZXh0LmZpbGwoKX19aWYoITEhPT1iLnN0cm9rZSl7dGhpcy5zZXRDYW52YXNTdHlsZShcInN0cm9rZVwiLGIpO3RoaXMuY2FudmFzLmJlZ2luUGF0aCgpO2ZvcihhPTA7YTxoLmxlbmd0aDthKz0yKWQ9aFthXSxcbmU9aFthKzFdLDA9PWEmJnRoaXMuY2FudmFzLm1vdmVUbyhkLGUpLHRoaXMuY2FudmFzLmxpbmVUbyhkLGUpO3RoaXMuY2FudmFzLmNsb3NlUGF0aCgpO3RoaXMuY2FudmFzLnN0cm9rZSgpO2lmKHRoaXMuaGl0RGV0ZWN0aW9uKXt0aGlzLnNldEhpdENvbnRleHRTdHlsZShcInN0cm9rZVwiLGMsYixmKTt0aGlzLmhpdENvbnRleHQuYmVnaW5QYXRoKCk7Zm9yKGE9MDthPGgubGVuZ3RoO2ErPTIpZD1oW2FdLGU9aFthKzFdLDA9PWEmJnRoaXMuaGl0Q29udGV4dC5tb3ZlVG8oZCxlKSx0aGlzLmhpdENvbnRleHQubGluZVRvKGQsZSk7dGhpcy5oaXRDb250ZXh0LmNsb3NlUGF0aCgpO3RoaXMuaGl0Q29udGV4dC5zdHJva2UoKX19Yi5zdHJva2VXaWR0aD1nO3RoaXMuY2FudmFzLnJlc3RvcmUoKTt0aGlzLmhpdERldGVjdGlvbiYmdGhpcy5oaXRDb250ZXh0LnJlc3RvcmUoKTt0aGlzLnNldENhbnZhc1N0eWxlKFwicmVzZXRcIil9fSxzZXRDYW52YXNTdHlsZTpmdW5jdGlvbihhLGIpe1wiZmlsbFwiPT09XG5hPyh0aGlzLmNhbnZhcy5nbG9iYWxBbHBoYT1iLmZpbGxPcGFjaXR5LHRoaXMuY2FudmFzLmZpbGxTdHlsZT1iLmZpbGxDb2xvcik6XCJzdHJva2VcIj09PWE/KHRoaXMuY2FudmFzLmdsb2JhbEFscGhhPWIuc3Ryb2tlT3BhY2l0eSx0aGlzLmNhbnZhcy5zdHJva2VTdHlsZT1iLnN0cm9rZUNvbG9yLHRoaXMuY2FudmFzLmxpbmVXaWR0aD1iLnN0cm9rZVdpZHRoKToodGhpcy5jYW52YXMuZ2xvYmFsQWxwaGE9MCx0aGlzLmNhbnZhcy5saW5lV2lkdGg9MSl9LGZlYXR1cmVJZFRvSGV4OmZ1bmN0aW9uKGEpe2E9TnVtYmVyKGEuc3BsaXQoXCJfXCIpLnBvcCgpKSsxOzE2Nzc3MjE2PD1hJiYodGhpcy5oaXRPdmVyZmxvdz1hLTE2Nzc3MjE1LGE9YSUxNjc3NzIxNisxKTt2YXIgYT1cIjAwMDAwMFwiK2EudG9TdHJpbmcoMTYpLGI9YS5sZW5ndGg7cmV0dXJuIGE9XCIjXCIrYS5zdWJzdHJpbmcoYi02LGIpfSxzZXRIaXRDb250ZXh0U3R5bGU6ZnVuY3Rpb24oYSxiLGMsZCl7Yj10aGlzLmZlYXR1cmVJZFRvSGV4KGIpO1xuXCJmaWxsXCI9PWE/KHRoaXMuaGl0Q29udGV4dC5nbG9iYWxBbHBoYT0xLHRoaXMuaGl0Q29udGV4dC5maWxsU3R5bGU9Yik6XCJzdHJva2VcIj09YT8odGhpcy5oaXRDb250ZXh0Lmdsb2JhbEFscGhhPTEsdGhpcy5oaXRDb250ZXh0LnN0cm9rZVN0eWxlPWIsXCJ1bmRlZmluZWRcIj09PXR5cGVvZiBkP3RoaXMuaGl0Q29udGV4dC5saW5lV2lkdGg9Yy5zdHJva2VXaWR0aCsyOmlzTmFOKGQpfHwodGhpcy5oaXRDb250ZXh0LmxpbmVXaWR0aD1jLnN0cm9rZVdpZHRoKzIvZCkpOih0aGlzLmhpdENvbnRleHQuZ2xvYmFsQWxwaGE9MCx0aGlzLmhpdENvbnRleHQubGluZVdpZHRoPTEpfSxkcmF3UG9pbnQ6ZnVuY3Rpb24oYSxiLGMpe2lmKCExIT09Yi5ncmFwaGljKWlmKGIuZXh0ZXJuYWxHcmFwaGljKXRoaXMuZHJhd0V4dGVybmFsR3JhcGhpYyhhLGIsYyk7ZWxzZSBpZihiLmdyYXBoaWNOYW1lJiZcImNpcmNsZVwiIT1iLmdyYXBoaWNOYW1lKXRoaXMuZHJhd05hbWVkU3ltYm9sKGEsYixjKTtlbHNle3ZhciBkPVxudGhpcy5nZXRMb2NhbFhZKGEpLGE9ZFswXSxkPWRbMV07aWYoIWlzTmFOKGEpJiYhaXNOYU4oZCkpe3ZhciBlPTIqTWF0aC5QSSxmPWIucG9pbnRSYWRpdXM7ITEhPT1iLmZpbGwmJih0aGlzLnNldENhbnZhc1N0eWxlKFwiZmlsbFwiLGIpLHRoaXMuY2FudmFzLmJlZ2luUGF0aCgpLHRoaXMuY2FudmFzLmFyYyhhLGQsZiwwLGUsITApLHRoaXMuY2FudmFzLmZpbGwoKSx0aGlzLmhpdERldGVjdGlvbiYmKHRoaXMuc2V0SGl0Q29udGV4dFN0eWxlKFwiZmlsbFwiLGMsYiksdGhpcy5oaXRDb250ZXh0LmJlZ2luUGF0aCgpLHRoaXMuaGl0Q29udGV4dC5hcmMoYSxkLGYsMCxlLCEwKSx0aGlzLmhpdENvbnRleHQuZmlsbCgpKSk7ITEhPT1iLnN0cm9rZSYmKHRoaXMuc2V0Q2FudmFzU3R5bGUoXCJzdHJva2VcIixiKSx0aGlzLmNhbnZhcy5iZWdpblBhdGgoKSx0aGlzLmNhbnZhcy5hcmMoYSxkLGYsMCxlLCEwKSx0aGlzLmNhbnZhcy5zdHJva2UoKSx0aGlzLmhpdERldGVjdGlvbiYmKHRoaXMuc2V0SGl0Q29udGV4dFN0eWxlKFwic3Ryb2tlXCIsXG5jLGIpLHRoaXMuaGl0Q29udGV4dC5iZWdpblBhdGgoKSx0aGlzLmhpdENvbnRleHQuYXJjKGEsZCxmLDAsZSwhMCksdGhpcy5oaXRDb250ZXh0LnN0cm9rZSgpKSx0aGlzLnNldENhbnZhc1N0eWxlKFwicmVzZXRcIikpfX19LGRyYXdMaW5lU3RyaW5nOmZ1bmN0aW9uKGEsYixjKXtiPU9wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKHtmaWxsOiExfSxiKTt0aGlzLmRyYXdMaW5lYXJSaW5nKGEsYixjKX0sZHJhd0xpbmVhclJpbmc6ZnVuY3Rpb24oYSxiLGMpeyExIT09Yi5maWxsJiYodGhpcy5zZXRDYW52YXNTdHlsZShcImZpbGxcIixiKSx0aGlzLnJlbmRlclBhdGgodGhpcy5jYW52YXMsYSxiLGMsXCJmaWxsXCIpLHRoaXMuaGl0RGV0ZWN0aW9uJiYodGhpcy5zZXRIaXRDb250ZXh0U3R5bGUoXCJmaWxsXCIsYyxiKSx0aGlzLnJlbmRlclBhdGgodGhpcy5oaXRDb250ZXh0LGEsYixjLFwiZmlsbFwiKSkpOyExIT09Yi5zdHJva2UmJih0aGlzLnNldENhbnZhc1N0eWxlKFwic3Ryb2tlXCIsYiksdGhpcy5yZW5kZXJQYXRoKHRoaXMuY2FudmFzLFxuYSxiLGMsXCJzdHJva2VcIiksdGhpcy5oaXREZXRlY3Rpb24mJih0aGlzLnNldEhpdENvbnRleHRTdHlsZShcInN0cm9rZVwiLGMsYiksdGhpcy5yZW5kZXJQYXRoKHRoaXMuaGl0Q29udGV4dCxhLGIsYyxcInN0cm9rZVwiKSkpO3RoaXMuc2V0Q2FudmFzU3R5bGUoXCJyZXNldFwiKX0scmVuZGVyUGF0aDpmdW5jdGlvbihhLGIsYyxkLGUpe2I9Yi5jb21wb25lbnRzO2M9Yi5sZW5ndGg7YS5iZWdpblBhdGgoKTt2YXIgZD10aGlzLmdldExvY2FsWFkoYlswXSksZj1kWzFdO2lmKCFpc05hTihkWzBdKSYmIWlzTmFOKGYpKXthLm1vdmVUbyhkWzBdLGRbMV0pO2ZvcihkPTE7ZDxjOysrZClmPXRoaXMuZ2V0TG9jYWxYWShiW2RdKSxhLmxpbmVUbyhmWzBdLGZbMV0pO1wiZmlsbFwiPT09ZT9hLmZpbGwoKTphLnN0cm9rZSgpfX0sZHJhd1BvbHlnb246ZnVuY3Rpb24oYSxiLGMpe3ZhciBhPWEuY29tcG9uZW50cyxkPWEubGVuZ3RoO3RoaXMuZHJhd0xpbmVhclJpbmcoYVswXSxiLGMpO2Zvcih2YXIgZT0xO2U8XG5kOysrZSl0aGlzLmNhbnZhcy5nbG9iYWxDb21wb3NpdGVPcGVyYXRpb249XCJkZXN0aW5hdGlvbi1vdXRcIix0aGlzLmhpdERldGVjdGlvbiYmKHRoaXMuaGl0Q29udGV4dC5nbG9iYWxDb21wb3NpdGVPcGVyYXRpb249XCJkZXN0aW5hdGlvbi1vdXRcIiksdGhpcy5kcmF3TGluZWFyUmluZyhhW2VdLE9wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKHtzdHJva2U6ITEsZmlsbE9wYWNpdHk6MX0sYiksYyksdGhpcy5jYW52YXMuZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uPVwic291cmNlLW92ZXJcIix0aGlzLmhpdERldGVjdGlvbiYmKHRoaXMuaGl0Q29udGV4dC5nbG9iYWxDb21wb3NpdGVPcGVyYXRpb249XCJzb3VyY2Utb3ZlclwiKSx0aGlzLmRyYXdMaW5lYXJSaW5nKGFbZV0sT3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoe2ZpbGw6ITF9LGIpLGMpfSxkcmF3VGV4dDpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuZ2V0TG9jYWxYWShhKTt0aGlzLnNldENhbnZhc1N0eWxlKFwicmVzZXRcIik7XG50aGlzLmNhbnZhcy5maWxsU3R5bGU9Yi5mb250Q29sb3I7dGhpcy5jYW52YXMuZ2xvYmFsQWxwaGE9Yi5mb250T3BhY2l0eXx8MTt2YXIgZD1bYi5mb250U3R5bGU/Yi5mb250U3R5bGU6XCJub3JtYWxcIixcIm5vcm1hbFwiLGIuZm9udFdlaWdodD9iLmZvbnRXZWlnaHQ6XCJub3JtYWxcIixiLmZvbnRTaXplP2IuZm9udFNpemU6XCIxZW1cIixiLmZvbnRGYW1pbHk/Yi5mb250RmFtaWx5Olwic2Fucy1zZXJpZlwiXS5qb2luKFwiIFwiKSxlPWIubGFiZWwuc3BsaXQoXCJcXG5cIiksZj1lLmxlbmd0aDtpZih0aGlzLmNhbnZhcy5maWxsVGV4dCl7dGhpcy5jYW52YXMuZm9udD1kO3RoaXMuY2FudmFzLnRleHRBbGlnbj1PcGVuTGF5ZXJzLlJlbmRlcmVyLkNhbnZhcy5MQUJFTF9BTElHTltiLmxhYmVsQWxpZ25bMF1dfHxcImNlbnRlclwiO3RoaXMuY2FudmFzLnRleHRCYXNlbGluZT1PcGVuTGF5ZXJzLlJlbmRlcmVyLkNhbnZhcy5MQUJFTF9BTElHTltiLmxhYmVsQWxpZ25bMV1dfHxcIm1pZGRsZVwiO3ZhciBnPU9wZW5MYXllcnMuUmVuZGVyZXIuQ2FudmFzLkxBQkVMX0ZBQ1RPUltiLmxhYmVsQWxpZ25bMV1dO1xubnVsbD09ZyYmKGc9LTAuNSk7ZD10aGlzLmNhbnZhcy5tZWFzdXJlVGV4dChcIk1nXCIpLmhlaWdodHx8dGhpcy5jYW52YXMubWVhc3VyZVRleHQoXCJ4eFwiKS53aWR0aDtjWzFdKz1kKmcqKGYtMSk7Zm9yKGc9MDtnPGY7ZysrKWIubGFiZWxPdXRsaW5lV2lkdGgmJih0aGlzLmNhbnZhcy5zYXZlKCksdGhpcy5jYW52YXMuc3Ryb2tlU3R5bGU9Yi5sYWJlbE91dGxpbmVDb2xvcix0aGlzLmNhbnZhcy5saW5lV2lkdGg9Yi5sYWJlbE91dGxpbmVXaWR0aCx0aGlzLmNhbnZhcy5zdHJva2VUZXh0KGVbZ10sY1swXSxjWzFdK2QqZysxKSx0aGlzLmNhbnZhcy5yZXN0b3JlKCkpLHRoaXMuY2FudmFzLmZpbGxUZXh0KGVbZ10sY1swXSxjWzFdK2QqZyl9ZWxzZSBpZih0aGlzLmNhbnZhcy5tb3pEcmF3VGV4dCl7dGhpcy5jYW52YXMubW96VGV4dFN0eWxlPWQ7dmFyIGg9T3BlbkxheWVycy5SZW5kZXJlci5DYW52YXMuTEFCRUxfRkFDVE9SW2IubGFiZWxBbGlnblswXV07bnVsbD09aCYmKGg9LTAuNSk7XG5nPU9wZW5MYXllcnMuUmVuZGVyZXIuQ2FudmFzLkxBQkVMX0ZBQ1RPUltiLmxhYmVsQWxpZ25bMV1dO251bGw9PWcmJihnPS0wLjUpO2Q9dGhpcy5jYW52YXMubW96TWVhc3VyZVRleHQoXCJ4eFwiKTtjWzFdKz1kKigxK2cqZik7Zm9yKGc9MDtnPGY7ZysrKXt2YXIgaT1jWzBdK2gqdGhpcy5jYW52YXMubW96TWVhc3VyZVRleHQoZVtnXSksaj1jWzFdK2cqZDt0aGlzLmNhbnZhcy50cmFuc2xhdGUoaSxqKTt0aGlzLmNhbnZhcy5tb3pEcmF3VGV4dChlW2ddKTt0aGlzLmNhbnZhcy50cmFuc2xhdGUoLWksLWopfX10aGlzLnNldENhbnZhc1N0eWxlKFwicmVzZXRcIil9LGdldExvY2FsWFk6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5nZXRSZXNvbHV0aW9uKCksYz10aGlzLmV4dGVudDtyZXR1cm5bKGEueC10aGlzLmZlYXR1cmVEeCkvYistYy5sZWZ0L2IsYy50b3AvYi1hLnkvYl19LGNsZWFyOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5yb290LmhlaWdodCxiPXRoaXMucm9vdC53aWR0aDt0aGlzLmNhbnZhcy5jbGVhclJlY3QoMCxcbjAsYixhKTt0aGlzLmZlYXR1cmVzPXt9O3RoaXMuaGl0RGV0ZWN0aW9uJiZ0aGlzLmhpdENvbnRleHQuY2xlYXJSZWN0KDAsMCxiLGEpfSxnZXRGZWF0dXJlSWRGcm9tRXZlbnQ6ZnVuY3Rpb24oYSl7dmFyIGI7aWYodGhpcy5oaXREZXRlY3Rpb24mJlwibm9uZVwiIT09dGhpcy5yb290LnN0eWxlLmRpc3BsYXkmJiF0aGlzLm1hcC5kcmFnZ2luZyYmKGE9YS54eSxhPXRoaXMuaGl0Q29udGV4dC5nZXRJbWFnZURhdGEoYS54fDAsYS55fDAsMSwxKS5kYXRhLDI1NT09PWFbM10mJihhPWFbMl0rMjU2KihhWzFdKzI1NiphWzBdKSkpKXthPVwiT3BlbkxheWVycy5GZWF0dXJlLlZlY3Rvcl9cIisoYS0xK3RoaXMuaGl0T3ZlcmZsb3cpO3RyeXtiPXRoaXMuZmVhdHVyZXNbYV1bMF19Y2F0Y2goYyl7fX1yZXR1cm4gYn0sZXJhc2VGZWF0dXJlczpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLlV0aWwuaXNBcnJheShhKXx8KGE9W2FdKTtmb3IodmFyIGI9MDtiPGEubGVuZ3RoOysrYilkZWxldGUgdGhpcy5mZWF0dXJlc1thW2JdLmlkXTtcbnRoaXMucmVkcmF3KCl9LHJlZHJhdzpmdW5jdGlvbigpe2lmKCF0aGlzLmxvY2tlZCl7dmFyIGE9dGhpcy5yb290LmhlaWdodCxiPXRoaXMucm9vdC53aWR0aDt0aGlzLmNhbnZhcy5jbGVhclJlY3QoMCwwLGIsYSk7dGhpcy5oaXREZXRlY3Rpb24mJnRoaXMuaGl0Q29udGV4dC5jbGVhclJlY3QoMCwwLGIsYSk7dmFyIGE9W10sYyxkLGU9dGhpcy5tYXAuYmFzZUxheWVyJiZ0aGlzLm1hcC5iYXNlTGF5ZXIud3JhcERhdGVMaW5lJiZ0aGlzLm1hcC5nZXRNYXhFeHRlbnQoKSxmO2ZvcihmIGluIHRoaXMuZmVhdHVyZXMpdGhpcy5mZWF0dXJlcy5oYXNPd25Qcm9wZXJ0eShmKSYmKGI9dGhpcy5mZWF0dXJlc1tmXVswXSxjPWIuZ2VvbWV0cnksdGhpcy5jYWxjdWxhdGVGZWF0dXJlRHgoYy5nZXRCb3VuZHMoKSxlKSxkPXRoaXMuZmVhdHVyZXNbZl1bMV0sdGhpcy5kcmF3R2VvbWV0cnkoYyxkLGIuaWQpLGQubGFiZWwmJmEucHVzaChbYixkXSkpO2I9MDtmb3IoYz1hLmxlbmd0aDtiPGM7KytiKWY9XG5hW2JdLHRoaXMuZHJhd1RleHQoZlswXS5nZW9tZXRyeS5nZXRDZW50cm9pZCgpLGZbMV0pfX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuUmVuZGVyZXIuQ2FudmFzXCJ9KTtPcGVuTGF5ZXJzLlJlbmRlcmVyLkNhbnZhcy5MQUJFTF9BTElHTj17bDpcImxlZnRcIixyOlwicmlnaHRcIix0OlwidG9wXCIsYjpcImJvdHRvbVwifTtPcGVuTGF5ZXJzLlJlbmRlcmVyLkNhbnZhcy5MQUJFTF9GQUNUT1I9e2w6MCxyOi0xLHQ6MCxiOi0xfTtPcGVuTGF5ZXJzLlJlbmRlcmVyLkNhbnZhcy5kcmF3SW1hZ2VTY2FsZUZhY3Rvcj1udWxsO09wZW5MYXllcnMuRm9ybWF0Lk9TTT1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuRm9ybWF0LlhNTCx7Y2hlY2tUYWdzOiExLGludGVyZXN0aW5nVGFnc0V4Y2x1ZGU6bnVsbCxhcmVhVGFnczpudWxsLGluaXRpYWxpemU6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPXtpbnRlcmVzdGluZ1RhZ3NFeGNsdWRlOlwic291cmNlIHNvdXJjZV9yZWYgc291cmNlOnJlZiBoaXN0b3J5IGF0dHJpYnV0aW9uIGNyZWF0ZWRfYnlcIi5zcGxpdChcIiBcIiksYXJlYVRhZ3M6XCJhcmVhIGJ1aWxkaW5nIGxlaXN1cmUgdG91cmlzbSBydWlucyBoaXN0b3JpYyBsYW5kdXNlIG1pbGl0YXJ5IG5hdHVyYWwgc3BvcnRcIi5zcGxpdChcIiBcIil9LGI9T3BlbkxheWVycy5VdGlsLmV4dGVuZChiLGEpLGM9e30sYT0wO2E8Yi5pbnRlcmVzdGluZ1RhZ3NFeGNsdWRlLmxlbmd0aDthKyspY1tiLmludGVyZXN0aW5nVGFnc0V4Y2x1ZGVbYV1dPSEwO2IuaW50ZXJlc3RpbmdUYWdzRXhjbHVkZT1jO2M9e307Zm9yKGE9MDthPGIuYXJlYVRhZ3MubGVuZ3RoO2ErKyljW2IuYXJlYVRhZ3NbYV1dPVxuITA7Yi5hcmVhVGFncz1jO3RoaXMuZXh0ZXJuYWxQcm9qZWN0aW9uPW5ldyBPcGVuTGF5ZXJzLlByb2plY3Rpb24oXCJFUFNHOjQzMjZcIik7T3BlbkxheWVycy5Gb3JtYXQuWE1MLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsW2JdKX0scmVhZDpmdW5jdGlvbihhKXtcInN0cmluZ1wiPT10eXBlb2YgYSYmKGE9T3BlbkxheWVycy5Gb3JtYXQuWE1MLnByb3RvdHlwZS5yZWFkLmFwcGx5KHRoaXMsW2FdKSk7Zm9yKHZhciBiPXRoaXMuZ2V0Tm9kZXMoYSksYz10aGlzLmdldFdheXMoYSksYT1BcnJheShjLmxlbmd0aCksZD0wO2Q8Yy5sZW5ndGg7ZCsrKXtmb3IodmFyIGU9QXJyYXkoY1tkXS5ub2Rlcy5sZW5ndGgpLGY9dGhpcy5pc1dheUFyZWEoY1tkXSk/MTowLGc9MDtnPGNbZF0ubm9kZXMubGVuZ3RoO2crKyl7dmFyIGg9YltjW2RdLm5vZGVzW2ddXSxpPW5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGgubG9uLGgubGF0KTtpLm9zbV9pZD1wYXJzZUludChjW2RdLm5vZGVzW2ddKTtcbmVbZ109aTtoLnVzZWQ9ITB9aD1udWxsO2g9Zj9uZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2x5Z29uKG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVhclJpbmcoZSkpOm5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVTdHJpbmcoZSk7dGhpcy5pbnRlcm5hbFByb2plY3Rpb24mJnRoaXMuZXh0ZXJuYWxQcm9qZWN0aW9uJiZoLnRyYW5zZm9ybSh0aGlzLmV4dGVybmFsUHJvamVjdGlvbix0aGlzLmludGVybmFsUHJvamVjdGlvbik7ZT1uZXcgT3BlbkxheWVycy5GZWF0dXJlLlZlY3RvcihoLGNbZF0udGFncyk7ZS5vc21faWQ9cGFyc2VJbnQoY1tkXS5pZCk7ZS5maWQ9XCJ3YXkuXCIrZS5vc21faWQ7YVtkXT1lfWZvcih2YXIgaiBpbiBiKXtoPWJbal07aWYoIWgudXNlZHx8dGhpcy5jaGVja1RhZ3Mpe2M9bnVsbDtpZih0aGlzLmNoZWNrVGFncyl7Yz10aGlzLmdldFRhZ3MoaC5ub2RlLCEwKTtpZihoLnVzZWQmJiFjWzFdKWNvbnRpbnVlO2M9Y1swXX1lbHNlIGM9dGhpcy5nZXRUYWdzKGgubm9kZSk7XG5lPW5ldyBPcGVuTGF5ZXJzLkZlYXR1cmUuVmVjdG9yKG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGgubG9uLGgubGF0KSxjKTt0aGlzLmludGVybmFsUHJvamVjdGlvbiYmdGhpcy5leHRlcm5hbFByb2plY3Rpb24mJmUuZ2VvbWV0cnkudHJhbnNmb3JtKHRoaXMuZXh0ZXJuYWxQcm9qZWN0aW9uLHRoaXMuaW50ZXJuYWxQcm9qZWN0aW9uKTtlLm9zbV9pZD1wYXJzZUludChqKTtlLmZpZD1cIm5vZGUuXCIrZS5vc21faWQ7YS5wdXNoKGUpfWgubm9kZT1udWxsfXJldHVybiBhfSxnZXROb2RlczpmdW5jdGlvbihhKXtmb3IodmFyIGE9YS5nZXRFbGVtZW50c0J5VGFnTmFtZShcIm5vZGVcIiksYj17fSxjPTA7YzxhLmxlbmd0aDtjKyspe3ZhciBkPWFbY10sZT1kLmdldEF0dHJpYnV0ZShcImlkXCIpO2JbZV09e2xhdDpkLmdldEF0dHJpYnV0ZShcImxhdFwiKSxsb246ZC5nZXRBdHRyaWJ1dGUoXCJsb25cIiksbm9kZTpkfX1yZXR1cm4gYn0sZ2V0V2F5czpmdW5jdGlvbihhKXtmb3IodmFyIGE9XG5hLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwid2F5XCIpLGI9W10sYz0wO2M8YS5sZW5ndGg7YysrKXt2YXIgZD1hW2NdLGU9e2lkOmQuZ2V0QXR0cmlidXRlKFwiaWRcIil9O2UudGFncz10aGlzLmdldFRhZ3MoZCk7ZD1kLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwibmRcIik7ZS5ub2Rlcz1BcnJheShkLmxlbmd0aCk7Zm9yKHZhciBmPTA7ZjxkLmxlbmd0aDtmKyspZS5ub2Rlc1tmXT1kW2ZdLmdldEF0dHJpYnV0ZShcInJlZlwiKTtiLnB1c2goZSl9cmV0dXJuIGJ9LGdldFRhZ3M6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9YS5nZXRFbGVtZW50c0J5VGFnTmFtZShcInRhZ1wiKSxkPXt9LGU9ITEsZj0wO2Y8Yy5sZW5ndGg7ZisrKXt2YXIgZz1jW2ZdLmdldEF0dHJpYnV0ZShcImtcIik7ZFtnXT1jW2ZdLmdldEF0dHJpYnV0ZShcInZcIik7YiYmKHRoaXMuaW50ZXJlc3RpbmdUYWdzRXhjbHVkZVtnXXx8KGU9ITApKX1yZXR1cm4gYj9bZCxlXTpkfSxpc1dheUFyZWE6ZnVuY3Rpb24oYSl7dmFyIGI9ITEsYz0hMTtcbmEubm9kZXNbMF09PWEubm9kZXNbYS5ub2Rlcy5sZW5ndGgtMV0mJihiPSEwKTtpZih0aGlzLmNoZWNrVGFncylmb3IodmFyIGQgaW4gYS50YWdzKWlmKHRoaXMuYXJlYVRhZ3NbZF0pe2M9ITA7YnJlYWt9cmV0dXJuIGImJih0aGlzLmNoZWNrVGFncz9jOiEwKX0sd3JpdGU6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5VdGlsLmlzQXJyYXkoYSl8fChhPVthXSk7dGhpcy5vc21faWQ9MTt0aGlzLmNyZWF0ZWRfbm9kZXM9e307dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlMobnVsbCxcIm9zbVwiKTtiLnNldEF0dHJpYnV0ZShcInZlcnNpb25cIixcIjAuNVwiKTtiLnNldEF0dHJpYnV0ZShcImdlbmVyYXRvclwiLFwiT3BlbkxheWVycyBcIitPcGVuTGF5ZXJzLlZFUlNJT05fTlVNQkVSKTtmb3IodmFyIGM9YS5sZW5ndGgtMTswPD1jO2MtLSlmb3IodmFyIGQ9dGhpcy5jcmVhdGVGZWF0dXJlTm9kZXMoYVtjXSksZT0wO2U8ZC5sZW5ndGg7ZSsrKWIuYXBwZW5kQ2hpbGQoZFtlXSk7cmV0dXJuIE9wZW5MYXllcnMuRm9ybWF0LlhNTC5wcm90b3R5cGUud3JpdGUuYXBwbHkodGhpcyxcbltiXSl9LGNyZWF0ZUZlYXR1cmVOb2RlczpmdW5jdGlvbihhKXt2YXIgYj1bXSxjPWEuZ2VvbWV0cnkuQ0xBU1NfTkFNRSxjPWMuc3Vic3RyaW5nKGMubGFzdEluZGV4T2YoXCIuXCIpKzEpLGM9Yy50b0xvd2VyQ2FzZSgpOyhjPXRoaXMuY3JlYXRlWE1MW2NdKSYmKGI9Yy5hcHBseSh0aGlzLFthXSkpO3JldHVybiBifSxjcmVhdGVYTUw6e3BvaW50OmZ1bmN0aW9uKGEpe3ZhciBiPW51bGwsYz1hLmdlb21ldHJ5P2EuZ2VvbWV0cnk6YTt0aGlzLmludGVybmFsUHJvamVjdGlvbiYmdGhpcy5leHRlcm5hbFByb2plY3Rpb24mJihjPWMuY2xvbmUoKSxjLnRyYW5zZm9ybSh0aGlzLmludGVybmFsUHJvamVjdGlvbix0aGlzLmV4dGVybmFsUHJvamVjdGlvbikpO3ZhciBkPSExO2Eub3NtX2lkPyhiPWEub3NtX2lkLHRoaXMuY3JlYXRlZF9ub2Rlc1tiXSYmKGQ9ITApKTooYj0tdGhpcy5vc21faWQsdGhpcy5vc21faWQrKyk7dmFyIGU9ZD90aGlzLmNyZWF0ZWRfbm9kZXNbYl06dGhpcy5jcmVhdGVFbGVtZW50TlMobnVsbCxcblwibm9kZVwiKTt0aGlzLmNyZWF0ZWRfbm9kZXNbYl09ZTtlLnNldEF0dHJpYnV0ZShcImlkXCIsYik7ZS5zZXRBdHRyaWJ1dGUoXCJsb25cIixjLngpO2Uuc2V0QXR0cmlidXRlKFwibGF0XCIsYy55KTthLmF0dHJpYnV0ZXMmJnRoaXMuc2VyaWFsaXplVGFncyhhLGUpO3RoaXMuc2V0U3RhdGUoYSxlKTtyZXR1cm4gZD9bXTpbZV19LGxpbmVzdHJpbmc6ZnVuY3Rpb24oYSl7dmFyIGIsYz1bXSxkPWEuZ2VvbWV0cnk7YS5vc21faWQ/Yj1hLm9zbV9pZDooYj0tdGhpcy5vc21faWQsdGhpcy5vc21faWQrKyk7dmFyIGU9dGhpcy5jcmVhdGVFbGVtZW50TlMobnVsbCxcIndheVwiKTtlLnNldEF0dHJpYnV0ZShcImlkXCIsYik7Zm9yKGI9MDtiPGQuY29tcG9uZW50cy5sZW5ndGg7YisrKXt2YXIgZj10aGlzLmNyZWF0ZVhNTC5wb2ludC5hcHBseSh0aGlzLFtkLmNvbXBvbmVudHNbYl1dKTtpZihmLmxlbmd0aCl7dmFyIGY9ZlswXSxnPWYuZ2V0QXR0cmlidXRlKFwiaWRcIik7Yy5wdXNoKGYpfWVsc2UgZz1kLmNvbXBvbmVudHNbYl0ub3NtX2lkLFxuZj10aGlzLmNyZWF0ZWRfbm9kZXNbZ107dGhpcy5zZXRTdGF0ZShhLGYpO2Y9dGhpcy5jcmVhdGVFbGVtZW50TlMobnVsbCxcIm5kXCIpO2Yuc2V0QXR0cmlidXRlKFwicmVmXCIsZyk7ZS5hcHBlbmRDaGlsZChmKX10aGlzLnNlcmlhbGl6ZVRhZ3MoYSxlKTtjLnB1c2goZSk7cmV0dXJuIGN9LHBvbHlnb246ZnVuY3Rpb24oYSl7dmFyIGI9T3BlbkxheWVycy5VdGlsLmV4dGVuZCh7YXJlYTpcInllc1wifSxhLmF0dHJpYnV0ZXMpLGI9bmV3IE9wZW5MYXllcnMuRmVhdHVyZS5WZWN0b3IoYS5nZW9tZXRyeS5jb21wb25lbnRzWzBdLGIpO2Iub3NtX2lkPWEub3NtX2lkO3JldHVybiB0aGlzLmNyZWF0ZVhNTC5saW5lc3RyaW5nLmFwcGx5KHRoaXMsW2JdKX19LHNlcmlhbGl6ZVRhZ3M6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGMgaW4gYS5hdHRyaWJ1dGVzKXt2YXIgZD10aGlzLmNyZWF0ZUVsZW1lbnROUyhudWxsLFwidGFnXCIpO2Quc2V0QXR0cmlidXRlKFwia1wiLGMpO2Quc2V0QXR0cmlidXRlKFwidlwiLFxuYS5hdHRyaWJ1dGVzW2NdKTtiLmFwcGVuZENoaWxkKGQpfX0sc2V0U3RhdGU6ZnVuY3Rpb24oYSxiKXtpZihhLnN0YXRlKXt2YXIgYz1udWxsO3N3aXRjaChhLnN0YXRlKXtjYXNlIE9wZW5MYXllcnMuU3RhdGUuVVBEQVRFOmNhc2UgT3BlbkxheWVycy5TdGF0ZS5ERUxFVEU6Yz1cImRlbGV0ZVwifWMmJmIuc2V0QXR0cmlidXRlKFwiYWN0aW9uXCIsYyl9fSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Gb3JtYXQuT1NNXCJ9KTtPcGVuTGF5ZXJzLkhhbmRsZXI9T3BlbkxheWVycy5DbGFzcyh7aWQ6bnVsbCxjb250cm9sOm51bGwsbWFwOm51bGwsa2V5TWFzazpudWxsLGFjdGl2ZTohMSxldnQ6bnVsbCxpbml0aWFsaXplOmZ1bmN0aW9uKGEsYixjKXtPcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHRoaXMsYyk7dGhpcy5jb250cm9sPWE7dGhpcy5jYWxsYmFja3M9YjsoYT10aGlzLm1hcHx8YS5tYXApJiZ0aGlzLnNldE1hcChhKTt0aGlzLmlkPU9wZW5MYXllcnMuVXRpbC5jcmVhdGVVbmlxdWVJRCh0aGlzLkNMQVNTX05BTUUrXCJfXCIpfSxzZXRNYXA6ZnVuY3Rpb24oYSl7dGhpcy5tYXA9YX0sY2hlY2tNb2RpZmllcnM6ZnVuY3Rpb24oYSl7cmV0dXJuIG51bGw9PXRoaXMua2V5TWFzaz8hMDooKGEuc2hpZnRLZXk/T3BlbkxheWVycy5IYW5kbGVyLk1PRF9TSElGVDowKXwoYS5jdHJsS2V5P09wZW5MYXllcnMuSGFuZGxlci5NT0RfQ1RSTDowKXwoYS5hbHRLZXk/T3BlbkxheWVycy5IYW5kbGVyLk1PRF9BTFQ6MCkpPT1cbnRoaXMua2V5TWFza30sYWN0aXZhdGU6ZnVuY3Rpb24oKXtpZih0aGlzLmFjdGl2ZSlyZXR1cm4hMTtmb3IodmFyIGE9T3BlbkxheWVycy5FdmVudHMucHJvdG90eXBlLkJST1dTRVJfRVZFTlRTLGI9MCxjPWEubGVuZ3RoO2I8YztiKyspdGhpc1thW2JdXSYmdGhpcy5yZWdpc3RlcihhW2JdLHRoaXNbYVtiXV0pO3JldHVybiB0aGlzLmFjdGl2ZT0hMH0sZGVhY3RpdmF0ZTpmdW5jdGlvbigpe2lmKCF0aGlzLmFjdGl2ZSlyZXR1cm4hMTtmb3IodmFyIGE9T3BlbkxheWVycy5FdmVudHMucHJvdG90eXBlLkJST1dTRVJfRVZFTlRTLGI9MCxjPWEubGVuZ3RoO2I8YztiKyspdGhpc1thW2JdXSYmdGhpcy51bnJlZ2lzdGVyKGFbYl0sdGhpc1thW2JdXSk7dGhpcy5hY3RpdmU9ITE7cmV0dXJuITB9LGNhbGxiYWNrOmZ1bmN0aW9uKGEsYil7YSYmdGhpcy5jYWxsYmFja3NbYV0mJnRoaXMuY2FsbGJhY2tzW2FdLmFwcGx5KHRoaXMuY29udHJvbCxiKX0scmVnaXN0ZXI6ZnVuY3Rpb24oYSxiKXt0aGlzLm1hcC5ldmVudHMucmVnaXN0ZXJQcmlvcml0eShhLFxudGhpcyxiKTt0aGlzLm1hcC5ldmVudHMucmVnaXN0ZXJQcmlvcml0eShhLHRoaXMsdGhpcy5zZXRFdmVudCl9LHVucmVnaXN0ZXI6ZnVuY3Rpb24oYSxiKXt0aGlzLm1hcC5ldmVudHMudW5yZWdpc3RlcihhLHRoaXMsYik7dGhpcy5tYXAuZXZlbnRzLnVucmVnaXN0ZXIoYSx0aGlzLHRoaXMuc2V0RXZlbnQpfSxzZXRFdmVudDpmdW5jdGlvbihhKXt0aGlzLmV2dD1hO3JldHVybiEwfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5kZWFjdGl2YXRlKCk7dGhpcy5jb250cm9sPXRoaXMubWFwPW51bGx9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkhhbmRsZXJcIn0pO09wZW5MYXllcnMuSGFuZGxlci5NT0RfTk9ORT0wO09wZW5MYXllcnMuSGFuZGxlci5NT0RfU0hJRlQ9MTtPcGVuTGF5ZXJzLkhhbmRsZXIuTU9EX0NUUkw9MjtPcGVuTGF5ZXJzLkhhbmRsZXIuTU9EX0FMVD00O09wZW5MYXllcnMuSGFuZGxlci5EcmFnPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5IYW5kbGVyLHtzdGFydGVkOiExLHN0b3BEb3duOiEwLGRyYWdnaW5nOiExLHRvdWNoOiExLGxhc3Q6bnVsbCxzdGFydDpudWxsLGxhc3RNb3ZlRXZ0Om51bGwsb2xkT25zZWxlY3RzdGFydDpudWxsLGludGVydmFsOjAsdGltZW91dElkOm51bGwsZG9jdW1lbnREcmFnOiExLGRvY3VtZW50RXZlbnRzOm51bGwsaW5pdGlhbGl6ZTpmdW5jdGlvbihhLGIsYyl7T3BlbkxheWVycy5IYW5kbGVyLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtpZighMD09PXRoaXMuZG9jdW1lbnREcmFnKXt2YXIgZD10aGlzO3RoaXMuX2RvY01vdmU9ZnVuY3Rpb24oYSl7ZC5tb3VzZW1vdmUoe3h5Ont4OmEuY2xpZW50WCx5OmEuY2xpZW50WX0sZWxlbWVudDpkb2N1bWVudH0pfTt0aGlzLl9kb2NVcD1mdW5jdGlvbihhKXtkLm1vdXNldXAoe3h5Ont4OmEuY2xpZW50WCx5OmEuY2xpZW50WX19KX19fSxcbmRyYWdzdGFydDpmdW5jdGlvbihhKXt2YXIgYj0hMDt0aGlzLmRyYWdnaW5nPSExO3RoaXMuY2hlY2tNb2RpZmllcnMoYSkmJihPcGVuTGF5ZXJzLkV2ZW50LmlzTGVmdENsaWNrKGEpfHxPcGVuTGF5ZXJzLkV2ZW50LmlzU2luZ2xlVG91Y2goYSkpPyh0aGlzLnN0YXJ0ZWQ9ITAsdGhpcy5sYXN0PXRoaXMuc3RhcnQ9YS54eSxPcGVuTGF5ZXJzLkVsZW1lbnQuYWRkQ2xhc3ModGhpcy5tYXAudmlld1BvcnREaXYsXCJvbERyYWdEb3duXCIpLHRoaXMuZG93bihhKSx0aGlzLmNhbGxiYWNrKFwiZG93blwiLFthLnh5XSksT3BlbkxheWVycy5FdmVudC5zdG9wKGEpLHRoaXMub2xkT25zZWxlY3RzdGFydHx8KHRoaXMub2xkT25zZWxlY3RzdGFydD1kb2N1bWVudC5vbnNlbGVjdHN0YXJ0P2RvY3VtZW50Lm9uc2VsZWN0c3RhcnQ6T3BlbkxheWVycy5GdW5jdGlvbi5UcnVlKSxkb2N1bWVudC5vbnNlbGVjdHN0YXJ0PU9wZW5MYXllcnMuRnVuY3Rpb24uRmFsc2UsYj0hdGhpcy5zdG9wRG93bik6KHRoaXMuc3RhcnRlZD1cbiExLHRoaXMubGFzdD10aGlzLnN0YXJ0PW51bGwpO3JldHVybiBifSxkcmFnbW92ZTpmdW5jdGlvbihhKXt0aGlzLmxhc3RNb3ZlRXZ0PWE7aWYodGhpcy5zdGFydGVkJiYhdGhpcy50aW1lb3V0SWQmJihhLnh5LnghPXRoaXMubGFzdC54fHxhLnh5LnkhPXRoaXMubGFzdC55KSkhMD09PXRoaXMuZG9jdW1lbnREcmFnJiZ0aGlzLmRvY3VtZW50RXZlbnRzJiYoYS5lbGVtZW50PT09ZG9jdW1lbnQ/KHRoaXMuYWRqdXN0WFkoYSksdGhpcy5zZXRFdmVudChhKSk6dGhpcy5yZW1vdmVEb2N1bWVudEV2ZW50cygpKSwwPHRoaXMuaW50ZXJ2YWwmJih0aGlzLnRpbWVvdXRJZD1zZXRUaW1lb3V0KE9wZW5MYXllcnMuRnVuY3Rpb24uYmluZCh0aGlzLnJlbW92ZVRpbWVvdXQsdGhpcyksdGhpcy5pbnRlcnZhbCkpLHRoaXMuZHJhZ2dpbmc9ITAsdGhpcy5tb3ZlKGEpLHRoaXMuY2FsbGJhY2soXCJtb3ZlXCIsW2EueHldKSx0aGlzLm9sZE9uc2VsZWN0c3RhcnR8fCh0aGlzLm9sZE9uc2VsZWN0c3RhcnQ9XG5kb2N1bWVudC5vbnNlbGVjdHN0YXJ0LGRvY3VtZW50Lm9uc2VsZWN0c3RhcnQ9T3BlbkxheWVycy5GdW5jdGlvbi5GYWxzZSksdGhpcy5sYXN0PWEueHk7cmV0dXJuITB9LGRyYWdlbmQ6ZnVuY3Rpb24oYSl7aWYodGhpcy5zdGFydGVkKXshMD09PXRoaXMuZG9jdW1lbnREcmFnJiZ0aGlzLmRvY3VtZW50RXZlbnRzJiYodGhpcy5hZGp1c3RYWShhKSx0aGlzLnJlbW92ZURvY3VtZW50RXZlbnRzKCkpO3ZhciBiPXRoaXMuc3RhcnQhPXRoaXMubGFzdDt0aGlzLmRyYWdnaW5nPXRoaXMuc3RhcnRlZD0hMTtPcGVuTGF5ZXJzLkVsZW1lbnQucmVtb3ZlQ2xhc3ModGhpcy5tYXAudmlld1BvcnREaXYsXCJvbERyYWdEb3duXCIpO3RoaXMudXAoYSk7dGhpcy5jYWxsYmFjayhcInVwXCIsW2EueHldKTtiJiZ0aGlzLmNhbGxiYWNrKFwiZG9uZVwiLFthLnh5XSk7ZG9jdW1lbnQub25zZWxlY3RzdGFydD10aGlzLm9sZE9uc2VsZWN0c3RhcnR9cmV0dXJuITB9LGRvd246ZnVuY3Rpb24oKXt9LG1vdmU6ZnVuY3Rpb24oKXt9LFxudXA6ZnVuY3Rpb24oKXt9LG91dDpmdW5jdGlvbigpe30sbW91c2Vkb3duOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmRyYWdzdGFydChhKX0sdG91Y2hzdGFydDpmdW5jdGlvbihhKXt0aGlzLnRvdWNofHwodGhpcy50b3VjaD0hMCx0aGlzLm1hcC5ldmVudHMudW4oe21vdXNlZG93bjp0aGlzLm1vdXNlZG93bixtb3VzZXVwOnRoaXMubW91c2V1cCxtb3VzZW1vdmU6dGhpcy5tb3VzZW1vdmUsY2xpY2s6dGhpcy5jbGljayxzY29wZTp0aGlzfSkpO3JldHVybiB0aGlzLmRyYWdzdGFydChhKX0sbW91c2Vtb3ZlOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmRyYWdtb3ZlKGEpfSx0b3VjaG1vdmU6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuZHJhZ21vdmUoYSl9LHJlbW92ZVRpbWVvdXQ6ZnVuY3Rpb24oKXt0aGlzLnRpbWVvdXRJZD1udWxsO3RoaXMuZHJhZ2dpbmcmJnRoaXMubW91c2Vtb3ZlKHRoaXMubGFzdE1vdmVFdnQpfSxtb3VzZXVwOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmRyYWdlbmQoYSl9LFxudG91Y2hlbmQ6ZnVuY3Rpb24oYSl7YS54eT10aGlzLmxhc3Q7cmV0dXJuIHRoaXMuZHJhZ2VuZChhKX0sbW91c2VvdXQ6ZnVuY3Rpb24oYSl7aWYodGhpcy5zdGFydGVkJiZPcGVuTGF5ZXJzLlV0aWwubW91c2VMZWZ0KGEsdGhpcy5tYXAudmlld1BvcnREaXYpKWlmKCEwPT09dGhpcy5kb2N1bWVudERyYWcpdGhpcy5hZGREb2N1bWVudEV2ZW50cygpO2Vsc2V7dmFyIGI9dGhpcy5zdGFydCE9dGhpcy5sYXN0O3RoaXMuZHJhZ2dpbmc9dGhpcy5zdGFydGVkPSExO09wZW5MYXllcnMuRWxlbWVudC5yZW1vdmVDbGFzcyh0aGlzLm1hcC52aWV3UG9ydERpdixcIm9sRHJhZ0Rvd25cIik7dGhpcy5vdXQoYSk7dGhpcy5jYWxsYmFjayhcIm91dFwiLFtdKTtiJiZ0aGlzLmNhbGxiYWNrKFwiZG9uZVwiLFthLnh5XSk7ZG9jdW1lbnQub25zZWxlY3RzdGFydCYmKGRvY3VtZW50Lm9uc2VsZWN0c3RhcnQ9dGhpcy5vbGRPbnNlbGVjdHN0YXJ0KX1yZXR1cm4hMH0sY2xpY2s6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zdGFydD09XG50aGlzLmxhc3R9LGFjdGl2YXRlOmZ1bmN0aW9uKCl7dmFyIGE9ITE7T3BlbkxheWVycy5IYW5kbGVyLnByb3RvdHlwZS5hY3RpdmF0ZS5hcHBseSh0aGlzLGFyZ3VtZW50cykmJih0aGlzLmRyYWdnaW5nPSExLGE9ITApO3JldHVybiBhfSxkZWFjdGl2YXRlOmZ1bmN0aW9uKCl7dmFyIGE9ITE7T3BlbkxheWVycy5IYW5kbGVyLnByb3RvdHlwZS5kZWFjdGl2YXRlLmFwcGx5KHRoaXMsYXJndW1lbnRzKSYmKHRoaXMuZHJhZ2dpbmc9dGhpcy5zdGFydGVkPXRoaXMudG91Y2g9ITEsdGhpcy5sYXN0PXRoaXMuc3RhcnQ9bnVsbCxhPSEwLE9wZW5MYXllcnMuRWxlbWVudC5yZW1vdmVDbGFzcyh0aGlzLm1hcC52aWV3UG9ydERpdixcIm9sRHJhZ0Rvd25cIikpO3JldHVybiBhfSxhZGp1c3RYWTpmdW5jdGlvbihhKXt2YXIgYj1PcGVuTGF5ZXJzLlV0aWwucGFnZVBvc2l0aW9uKHRoaXMubWFwLnZpZXdQb3J0RGl2KTthLnh5LngtPWJbMF07YS54eS55LT1iWzFdfSxhZGREb2N1bWVudEV2ZW50czpmdW5jdGlvbigpe09wZW5MYXllcnMuRWxlbWVudC5hZGRDbGFzcyhkb2N1bWVudC5ib2R5LFxuXCJvbERyYWdEb3duXCIpO3RoaXMuZG9jdW1lbnRFdmVudHM9ITA7T3BlbkxheWVycy5FdmVudC5vYnNlcnZlKGRvY3VtZW50LFwibW91c2Vtb3ZlXCIsdGhpcy5fZG9jTW92ZSk7T3BlbkxheWVycy5FdmVudC5vYnNlcnZlKGRvY3VtZW50LFwibW91c2V1cFwiLHRoaXMuX2RvY1VwKX0scmVtb3ZlRG9jdW1lbnRFdmVudHM6ZnVuY3Rpb24oKXtPcGVuTGF5ZXJzLkVsZW1lbnQucmVtb3ZlQ2xhc3MoZG9jdW1lbnQuYm9keSxcIm9sRHJhZ0Rvd25cIik7dGhpcy5kb2N1bWVudEV2ZW50cz0hMTtPcGVuTGF5ZXJzLkV2ZW50LnN0b3BPYnNlcnZpbmcoZG9jdW1lbnQsXCJtb3VzZW1vdmVcIix0aGlzLl9kb2NNb3ZlKTtPcGVuTGF5ZXJzLkV2ZW50LnN0b3BPYnNlcnZpbmcoZG9jdW1lbnQsXCJtb3VzZXVwXCIsdGhpcy5fZG9jVXApfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5IYW5kbGVyLkRyYWdcIn0pO09wZW5MYXllcnMuSGFuZGxlci5GZWF0dXJlPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5IYW5kbGVyLHtFVkVOVE1BUDp7Y2xpY2s6e1wiaW5cIjpcImNsaWNrXCIsb3V0OlwiY2xpY2tvdXRcIn0sbW91c2Vtb3ZlOntcImluXCI6XCJvdmVyXCIsb3V0Olwib3V0XCJ9LGRibGNsaWNrOntcImluXCI6XCJkYmxjbGlja1wiLG91dDpudWxsfSxtb3VzZWRvd246e1wiaW5cIjpudWxsLG91dDpudWxsfSxtb3VzZXVwOntcImluXCI6bnVsbCxvdXQ6bnVsbH0sdG91Y2hzdGFydDp7XCJpblwiOlwiY2xpY2tcIixvdXQ6XCJjbGlja291dFwifX0sZmVhdHVyZTpudWxsLGxhc3RGZWF0dXJlOm51bGwsZG93bjpudWxsLHVwOm51bGwsdG91Y2g6ITEsY2xpY2tUb2xlcmFuY2U6NCxnZW9tZXRyeVR5cGVzOm51bGwsc3RvcENsaWNrOiEwLHN0b3BEb3duOiEwLHN0b3BVcDohMSxpbml0aWFsaXplOmZ1bmN0aW9uKGEsYixjLGQpe09wZW5MYXllcnMuSGFuZGxlci5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLFthLGMsZF0pO3RoaXMubGF5ZXI9XG5ifSx0b3VjaHN0YXJ0OmZ1bmN0aW9uKGEpe3RoaXMudG91Y2h8fCh0aGlzLnRvdWNoPSEwLHRoaXMubWFwLmV2ZW50cy51bih7bW91c2Vkb3duOnRoaXMubW91c2Vkb3duLG1vdXNldXA6dGhpcy5tb3VzZXVwLG1vdXNlbW92ZTp0aGlzLm1vdXNlbW92ZSxjbGljazp0aGlzLmNsaWNrLGRibGNsaWNrOnRoaXMuZGJsY2xpY2ssc2NvcGU6dGhpc30pKTtyZXR1cm4gT3BlbkxheWVycy5FdmVudC5pc011bHRpVG91Y2goYSk/ITA6dGhpcy5tb3VzZWRvd24oYSl9LHRvdWNobW92ZTpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLkV2ZW50LnN0b3AoYSl9LG1vdXNlZG93bjpmdW5jdGlvbihhKXtpZihPcGVuTGF5ZXJzLkV2ZW50LmlzTGVmdENsaWNrKGEpfHxPcGVuTGF5ZXJzLkV2ZW50LmlzU2luZ2xlVG91Y2goYSkpdGhpcy5kb3duPWEueHk7cmV0dXJuIHRoaXMuaGFuZGxlKGEpPyF0aGlzLnN0b3BEb3duOiEwfSxtb3VzZXVwOmZ1bmN0aW9uKGEpe3RoaXMudXA9YS54eTtyZXR1cm4gdGhpcy5oYW5kbGUoYSk/XG4hdGhpcy5zdG9wVXA6ITB9LGNsaWNrOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmhhbmRsZShhKT8hdGhpcy5zdG9wQ2xpY2s6ITB9LG1vdXNlbW92ZTpmdW5jdGlvbihhKXtpZighdGhpcy5jYWxsYmFja3Mub3ZlciYmIXRoaXMuY2FsbGJhY2tzLm91dClyZXR1cm4hMDt0aGlzLmhhbmRsZShhKTtyZXR1cm4hMH0sZGJsY2xpY2s6ZnVuY3Rpb24oYSl7cmV0dXJuIXRoaXMuaGFuZGxlKGEpfSxnZW9tZXRyeVR5cGVNYXRjaGVzOmZ1bmN0aW9uKGEpe3JldHVybiBudWxsPT10aGlzLmdlb21ldHJ5VHlwZXN8fC0xPE9wZW5MYXllcnMuVXRpbC5pbmRleE9mKHRoaXMuZ2VvbWV0cnlUeXBlcyxhLmdlb21ldHJ5LkNMQVNTX05BTUUpfSxoYW5kbGU6ZnVuY3Rpb24oYSl7dGhpcy5mZWF0dXJlJiYhdGhpcy5mZWF0dXJlLmxheWVyJiYodGhpcy5mZWF0dXJlPW51bGwpO3ZhciBiPWEudHlwZSxjPSExLGQ9ISF0aGlzLmZlYXR1cmUsZT1cImNsaWNrXCI9PWJ8fFwiZGJsY2xpY2tcIj09Ynx8XCJ0b3VjaHN0YXJ0XCI9PVxuYjtpZigodGhpcy5mZWF0dXJlPXRoaXMubGF5ZXIuZ2V0RmVhdHVyZUZyb21FdmVudChhKSkmJiF0aGlzLmZlYXR1cmUubGF5ZXIpdGhpcy5mZWF0dXJlPW51bGw7dGhpcy5sYXN0RmVhdHVyZSYmIXRoaXMubGFzdEZlYXR1cmUubGF5ZXImJih0aGlzLmxhc3RGZWF0dXJlPW51bGwpO3RoaXMuZmVhdHVyZT8oXCJ0b3VjaHN0YXJ0XCI9PT1iJiZPcGVuTGF5ZXJzLkV2ZW50LnN0b3AoYSksYT10aGlzLmZlYXR1cmUhPXRoaXMubGFzdEZlYXR1cmUsdGhpcy5nZW9tZXRyeVR5cGVNYXRjaGVzKHRoaXMuZmVhdHVyZSk/KGQmJmE/KHRoaXMubGFzdEZlYXR1cmUmJnRoaXMudHJpZ2dlckNhbGxiYWNrKGIsXCJvdXRcIixbdGhpcy5sYXN0RmVhdHVyZV0pLHRoaXMudHJpZ2dlckNhbGxiYWNrKGIsXCJpblwiLFt0aGlzLmZlYXR1cmVdKSk6KCFkfHxlKSYmdGhpcy50cmlnZ2VyQ2FsbGJhY2soYixcImluXCIsW3RoaXMuZmVhdHVyZV0pLHRoaXMubGFzdEZlYXR1cmU9dGhpcy5mZWF0dXJlLGM9ITApOih0aGlzLmxhc3RGZWF0dXJlJiZcbihkJiZhfHxlKSYmdGhpcy50cmlnZ2VyQ2FsbGJhY2soYixcIm91dFwiLFt0aGlzLmxhc3RGZWF0dXJlXSksdGhpcy5mZWF0dXJlPW51bGwpKTp0aGlzLmxhc3RGZWF0dXJlJiYoZHx8ZSkmJnRoaXMudHJpZ2dlckNhbGxiYWNrKGIsXCJvdXRcIixbdGhpcy5sYXN0RmVhdHVyZV0pO3JldHVybiBjfSx0cmlnZ2VyQ2FsbGJhY2s6ZnVuY3Rpb24oYSxiLGMpeyhiPXRoaXMuRVZFTlRNQVBbYV1bYl0pJiYoXCJjbGlja1wiPT1hJiZ0aGlzLnVwJiZ0aGlzLmRvd24/TWF0aC5zcXJ0KE1hdGgucG93KHRoaXMudXAueC10aGlzLmRvd24ueCwyKStNYXRoLnBvdyh0aGlzLnVwLnktdGhpcy5kb3duLnksMikpPD10aGlzLmNsaWNrVG9sZXJhbmNlJiZ0aGlzLmNhbGxiYWNrKGIsYyk6dGhpcy5jYWxsYmFjayhiLGMpKX0sYWN0aXZhdGU6ZnVuY3Rpb24oKXt2YXIgYT0hMTtPcGVuTGF5ZXJzLkhhbmRsZXIucHJvdG90eXBlLmFjdGl2YXRlLmFwcGx5KHRoaXMsYXJndW1lbnRzKSYmKHRoaXMubW92ZUxheWVyVG9Ub3AoKSxcbnRoaXMubWFwLmV2ZW50cy5vbih7cmVtb3ZlbGF5ZXI6dGhpcy5oYW5kbGVNYXBFdmVudHMsY2hhbmdlbGF5ZXI6dGhpcy5oYW5kbGVNYXBFdmVudHMsc2NvcGU6dGhpc30pLGE9ITApO3JldHVybiBhfSxkZWFjdGl2YXRlOmZ1bmN0aW9uKCl7dmFyIGE9ITE7T3BlbkxheWVycy5IYW5kbGVyLnByb3RvdHlwZS5kZWFjdGl2YXRlLmFwcGx5KHRoaXMsYXJndW1lbnRzKSYmKHRoaXMubW92ZUxheWVyQmFjaygpLHRoaXMudXA9dGhpcy5kb3duPXRoaXMubGFzdEZlYXR1cmU9dGhpcy5mZWF0dXJlPW51bGwsdGhpcy50b3VjaD0hMSx0aGlzLm1hcC5ldmVudHMudW4oe3JlbW92ZWxheWVyOnRoaXMuaGFuZGxlTWFwRXZlbnRzLGNoYW5nZWxheWVyOnRoaXMuaGFuZGxlTWFwRXZlbnRzLHNjb3BlOnRoaXN9KSxhPSEwKTtyZXR1cm4gYX0saGFuZGxlTWFwRXZlbnRzOmZ1bmN0aW9uKGEpeyhcInJlbW92ZWxheWVyXCI9PWEudHlwZXx8XCJvcmRlclwiPT1hLnByb3BlcnR5KSYmdGhpcy5tb3ZlTGF5ZXJUb1RvcCgpfSxcbm1vdmVMYXllclRvVG9wOmZ1bmN0aW9uKCl7dGhpcy5sYXllci5zZXRaSW5kZXgoTWF0aC5tYXgodGhpcy5tYXAuWl9JTkRFWF9CQVNFLkZlYXR1cmUtMSx0aGlzLmxheWVyLmdldFpJbmRleCgpKSsxKX0sbW92ZUxheWVyQmFjazpmdW5jdGlvbigpe3ZhciBhPXRoaXMubGF5ZXIuZ2V0WkluZGV4KCktMTthPj10aGlzLm1hcC5aX0lOREVYX0JBU0UuRmVhdHVyZT90aGlzLmxheWVyLnNldFpJbmRleChhKTp0aGlzLm1hcC5zZXRMYXllclpJbmRleCh0aGlzLmxheWVyLHRoaXMubWFwLmdldExheWVySW5kZXgodGhpcy5sYXllcikpfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5IYW5kbGVyLkZlYXR1cmVcIn0pO09wZW5MYXllcnMuQ29udHJvbC5EcmFnRmVhdHVyZT1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuQ29udHJvbCx7Z2VvbWV0cnlUeXBlczpudWxsLG9uU3RhcnQ6ZnVuY3Rpb24oKXt9LG9uRHJhZzpmdW5jdGlvbigpe30sb25Db21wbGV0ZTpmdW5jdGlvbigpe30sb25FbnRlcjpmdW5jdGlvbigpe30sb25MZWF2ZTpmdW5jdGlvbigpe30sZG9jdW1lbnREcmFnOiExLGxheWVyOm51bGwsZmVhdHVyZTpudWxsLGRyYWdDYWxsYmFja3M6e30sZmVhdHVyZUNhbGxiYWNrczp7fSxsYXN0UGl4ZWw6bnVsbCxpbml0aWFsaXplOmZ1bmN0aW9uKGEsYil7T3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsW2JdKTt0aGlzLmxheWVyPWE7dGhpcy5oYW5kbGVycz17ZHJhZzpuZXcgT3BlbkxheWVycy5IYW5kbGVyLkRyYWcodGhpcyxPcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHtkb3duOnRoaXMuZG93bkZlYXR1cmUsbW92ZTp0aGlzLm1vdmVGZWF0dXJlLFxudXA6dGhpcy51cEZlYXR1cmUsb3V0OnRoaXMuY2FuY2VsLGRvbmU6dGhpcy5kb25lRHJhZ2dpbmd9LHRoaXMuZHJhZ0NhbGxiYWNrcykse2RvY3VtZW50RHJhZzp0aGlzLmRvY3VtZW50RHJhZ30pLGZlYXR1cmU6bmV3IE9wZW5MYXllcnMuSGFuZGxlci5GZWF0dXJlKHRoaXMsdGhpcy5sYXllcixPcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHtjbGljazp0aGlzLmNsaWNrRmVhdHVyZSxjbGlja291dDp0aGlzLmNsaWNrb3V0RmVhdHVyZSxvdmVyOnRoaXMub3ZlckZlYXR1cmUsb3V0OnRoaXMub3V0RmVhdHVyZX0sdGhpcy5mZWF0dXJlQ2FsbGJhY2tzKSx7Z2VvbWV0cnlUeXBlczp0aGlzLmdlb21ldHJ5VHlwZXN9KX19LGNsaWNrRmVhdHVyZTpmdW5jdGlvbihhKXt0aGlzLmhhbmRsZXJzLmZlYXR1cmUudG91Y2gmJighdGhpcy5vdmVyJiZ0aGlzLm92ZXJGZWF0dXJlKGEpKSYmKHRoaXMuaGFuZGxlcnMuZHJhZy5kcmFnc3RhcnQodGhpcy5oYW5kbGVycy5mZWF0dXJlLmV2dCksdGhpcy5oYW5kbGVycy5kcmFnLnN0b3BEb3duPVxuITEpfSxjbGlja291dEZlYXR1cmU6ZnVuY3Rpb24oYSl7dGhpcy5oYW5kbGVycy5mZWF0dXJlLnRvdWNoJiZ0aGlzLm92ZXImJih0aGlzLm91dEZlYXR1cmUoYSksdGhpcy5oYW5kbGVycy5kcmFnLnN0b3BEb3duPSEwKX0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMubGF5ZXI9bnVsbDtPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmRlc3Ryb3kuYXBwbHkodGhpcyxbXSl9LGFjdGl2YXRlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaGFuZGxlcnMuZmVhdHVyZS5hY3RpdmF0ZSgpJiZPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmFjdGl2YXRlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sZGVhY3RpdmF0ZTpmdW5jdGlvbigpe3RoaXMuaGFuZGxlcnMuZHJhZy5kZWFjdGl2YXRlKCk7dGhpcy5oYW5kbGVycy5mZWF0dXJlLmRlYWN0aXZhdGUoKTt0aGlzLmZlYXR1cmU9bnVsbDt0aGlzLmRyYWdnaW5nPSExO3RoaXMubGFzdFBpeGVsPW51bGw7T3BlbkxheWVycy5FbGVtZW50LnJlbW92ZUNsYXNzKHRoaXMubWFwLnZpZXdQb3J0RGl2LFxudGhpcy5kaXNwbGF5Q2xhc3MrXCJPdmVyXCIpO3JldHVybiBPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmRlYWN0aXZhdGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxvdmVyRmVhdHVyZTpmdW5jdGlvbihhKXt2YXIgYj0hMTt0aGlzLmhhbmRsZXJzLmRyYWcuZHJhZ2dpbmc/dGhpcy5vdmVyPXRoaXMuZmVhdHVyZS5pZD09YS5pZD8hMDohMToodGhpcy5mZWF0dXJlPWEsdGhpcy5oYW5kbGVycy5kcmFnLmFjdGl2YXRlKCksdGhpcy5vdmVyPWI9ITAsT3BlbkxheWVycy5FbGVtZW50LmFkZENsYXNzKHRoaXMubWFwLnZpZXdQb3J0RGl2LHRoaXMuZGlzcGxheUNsYXNzK1wiT3ZlclwiKSx0aGlzLm9uRW50ZXIoYSkpO3JldHVybiBifSxkb3duRmVhdHVyZTpmdW5jdGlvbihhKXt0aGlzLmxhc3RQaXhlbD1hO3RoaXMub25TdGFydCh0aGlzLmZlYXR1cmUsYSl9LG1vdmVGZWF0dXJlOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMubWFwLmdldFJlc29sdXRpb24oKTt0aGlzLmZlYXR1cmUuZ2VvbWV0cnkubW92ZShiKlxuKGEueC10aGlzLmxhc3RQaXhlbC54KSxiKih0aGlzLmxhc3RQaXhlbC55LWEueSkpO3RoaXMubGF5ZXIuZHJhd0ZlYXR1cmUodGhpcy5mZWF0dXJlKTt0aGlzLmxhc3RQaXhlbD1hO3RoaXMub25EcmFnKHRoaXMuZmVhdHVyZSxhKX0sdXBGZWF0dXJlOmZ1bmN0aW9uKCl7dGhpcy5vdmVyfHx0aGlzLmhhbmRsZXJzLmRyYWcuZGVhY3RpdmF0ZSgpfSxkb25lRHJhZ2dpbmc6ZnVuY3Rpb24oYSl7dGhpcy5vbkNvbXBsZXRlKHRoaXMuZmVhdHVyZSxhKX0sb3V0RmVhdHVyZTpmdW5jdGlvbihhKXt0aGlzLmhhbmRsZXJzLmRyYWcuZHJhZ2dpbmc/dGhpcy5mZWF0dXJlLmlkPT1hLmlkJiYodGhpcy5vdmVyPSExKToodGhpcy5vdmVyPSExLHRoaXMuaGFuZGxlcnMuZHJhZy5kZWFjdGl2YXRlKCksT3BlbkxheWVycy5FbGVtZW50LnJlbW92ZUNsYXNzKHRoaXMubWFwLnZpZXdQb3J0RGl2LHRoaXMuZGlzcGxheUNsYXNzK1wiT3ZlclwiKSx0aGlzLm9uTGVhdmUoYSksdGhpcy5mZWF0dXJlPW51bGwpfSxcbmNhbmNlbDpmdW5jdGlvbigpe3RoaXMuaGFuZGxlcnMuZHJhZy5kZWFjdGl2YXRlKCk7dGhpcy5vdmVyPSExfSxzZXRNYXA6ZnVuY3Rpb24oYSl7dGhpcy5oYW5kbGVycy5kcmFnLnNldE1hcChhKTt0aGlzLmhhbmRsZXJzLmZlYXR1cmUuc2V0TWFwKGEpO09wZW5MYXllcnMuQ29udHJvbC5wcm90b3R5cGUuc2V0TWFwLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuQ29udHJvbC5EcmFnRmVhdHVyZVwifSk7T3BlbkxheWVycy5TdHlsZU1hcD1PcGVuTGF5ZXJzLkNsYXNzKHtzdHlsZXM6bnVsbCxleHRlbmREZWZhdWx0OiEwLGluaXRpYWxpemU6ZnVuY3Rpb24oYSxiKXt0aGlzLnN0eWxlcz17XCJkZWZhdWx0XCI6bmV3IE9wZW5MYXllcnMuU3R5bGUoT3BlbkxheWVycy5GZWF0dXJlLlZlY3Rvci5zdHlsZVtcImRlZmF1bHRcIl0pLHNlbGVjdDpuZXcgT3BlbkxheWVycy5TdHlsZShPcGVuTGF5ZXJzLkZlYXR1cmUuVmVjdG9yLnN0eWxlLnNlbGVjdCksdGVtcG9yYXJ5Om5ldyBPcGVuTGF5ZXJzLlN0eWxlKE9wZW5MYXllcnMuRmVhdHVyZS5WZWN0b3Iuc3R5bGUudGVtcG9yYXJ5KSxcImRlbGV0ZVwiOm5ldyBPcGVuTGF5ZXJzLlN0eWxlKE9wZW5MYXllcnMuRmVhdHVyZS5WZWN0b3Iuc3R5bGVbXCJkZWxldGVcIl0pfTtpZihhIGluc3RhbmNlb2YgT3BlbkxheWVycy5TdHlsZSl0aGlzLnN0eWxlc1tcImRlZmF1bHRcIl09YSx0aGlzLnN0eWxlcy5zZWxlY3Q9YSx0aGlzLnN0eWxlcy50ZW1wb3Jhcnk9YSx0aGlzLnN0eWxlc1tcImRlbGV0ZVwiXT1cbmE7ZWxzZSBpZihcIm9iamVjdFwiPT10eXBlb2YgYSlmb3IodmFyIGMgaW4gYSlpZihhW2NdaW5zdGFuY2VvZiBPcGVuTGF5ZXJzLlN0eWxlKXRoaXMuc3R5bGVzW2NdPWFbY107ZWxzZSBpZihcIm9iamVjdFwiPT10eXBlb2YgYVtjXSl0aGlzLnN0eWxlc1tjXT1uZXcgT3BlbkxheWVycy5TdHlsZShhW2NdKTtlbHNle3RoaXMuc3R5bGVzW1wiZGVmYXVsdFwiXT1uZXcgT3BlbkxheWVycy5TdHlsZShhKTt0aGlzLnN0eWxlcy5zZWxlY3Q9bmV3IE9wZW5MYXllcnMuU3R5bGUoYSk7dGhpcy5zdHlsZXMudGVtcG9yYXJ5PW5ldyBPcGVuTGF5ZXJzLlN0eWxlKGEpO3RoaXMuc3R5bGVzW1wiZGVsZXRlXCJdPW5ldyBPcGVuTGF5ZXJzLlN0eWxlKGEpO2JyZWFrfU9wZW5MYXllcnMuVXRpbC5leHRlbmQodGhpcyxiKX0sZGVzdHJveTpmdW5jdGlvbigpe2Zvcih2YXIgYSBpbiB0aGlzLnN0eWxlcyl0aGlzLnN0eWxlc1thXS5kZXN0cm95KCk7dGhpcy5zdHlsZXM9bnVsbH0sY3JlYXRlU3ltYm9saXplcjpmdW5jdGlvbihhLFxuYil7YXx8KGE9bmV3IE9wZW5MYXllcnMuRmVhdHVyZS5WZWN0b3IpO3RoaXMuc3R5bGVzW2JdfHwoYj1cImRlZmF1bHRcIik7YS5yZW5kZXJJbnRlbnQ9Yjt2YXIgYz17fTt0aGlzLmV4dGVuZERlZmF1bHQmJlwiZGVmYXVsdFwiIT1iJiYoYz10aGlzLnN0eWxlc1tcImRlZmF1bHRcIl0uY3JlYXRlU3ltYm9saXplcihhKSk7cmV0dXJuIE9wZW5MYXllcnMuVXRpbC5leHRlbmQoYyx0aGlzLnN0eWxlc1tiXS5jcmVhdGVTeW1ib2xpemVyKGEpKX0sYWRkVW5pcXVlVmFsdWVSdWxlczpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZT1bXSxmO2ZvcihmIGluIGMpZS5wdXNoKG5ldyBPcGVuTGF5ZXJzLlJ1bGUoe3N5bWJvbGl6ZXI6Y1tmXSxjb250ZXh0OmQsZmlsdGVyOm5ldyBPcGVuTGF5ZXJzLkZpbHRlci5Db21wYXJpc29uKHt0eXBlOk9wZW5MYXllcnMuRmlsdGVyLkNvbXBhcmlzb24uRVFVQUxfVE8scHJvcGVydHk6Yix2YWx1ZTpmfSl9KSk7dGhpcy5zdHlsZXNbYV0uYWRkUnVsZXMoZSl9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLlN0eWxlTWFwXCJ9KTtPcGVuTGF5ZXJzLkxheWVyLlZlY3Rvcj1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuTGF5ZXIse2lzQmFzZUxheWVyOiExLGlzRml4ZWQ6ITEsZmVhdHVyZXM6bnVsbCxmaWx0ZXI6bnVsbCxzZWxlY3RlZEZlYXR1cmVzOm51bGwsdW5yZW5kZXJlZEZlYXR1cmVzOm51bGwscmVwb3J0RXJyb3I6ITAsc3R5bGU6bnVsbCxzdHlsZU1hcDpudWxsLHN0cmF0ZWdpZXM6bnVsbCxwcm90b2NvbDpudWxsLHJlbmRlcmVyczpbXCJTVkdcIixcIlZNTFwiLFwiQ2FudmFzXCJdLHJlbmRlcmVyOm51bGwscmVuZGVyZXJPcHRpb25zOm51bGwsZ2VvbWV0cnlUeXBlOm51bGwsZHJhd246ITEscmF0aW86MSxpbml0aWFsaXplOmZ1bmN0aW9uKGEsYil7T3BlbkxheWVycy5MYXllci5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7KCF0aGlzLnJlbmRlcmVyfHwhdGhpcy5yZW5kZXJlci5zdXBwb3J0ZWQoKSkmJnRoaXMuYXNzaWduUmVuZGVyZXIoKTtpZighdGhpcy5yZW5kZXJlcnx8XG4hdGhpcy5yZW5kZXJlci5zdXBwb3J0ZWQoKSl0aGlzLnJlbmRlcmVyPW51bGwsdGhpcy5kaXNwbGF5RXJyb3IoKTt0aGlzLnN0eWxlTWFwfHwodGhpcy5zdHlsZU1hcD1uZXcgT3BlbkxheWVycy5TdHlsZU1hcCk7dGhpcy5mZWF0dXJlcz1bXTt0aGlzLnNlbGVjdGVkRmVhdHVyZXM9W107dGhpcy51bnJlbmRlcmVkRmVhdHVyZXM9e307aWYodGhpcy5zdHJhdGVnaWVzKWZvcih2YXIgYz0wLGQ9dGhpcy5zdHJhdGVnaWVzLmxlbmd0aDtjPGQ7YysrKXRoaXMuc3RyYXRlZ2llc1tjXS5zZXRMYXllcih0aGlzKX0sZGVzdHJveTpmdW5jdGlvbigpe2lmKHRoaXMuc3RyYXRlZ2llcyl7dmFyIGEsYixjO2I9MDtmb3IoYz10aGlzLnN0cmF0ZWdpZXMubGVuZ3RoO2I8YztiKyspYT10aGlzLnN0cmF0ZWdpZXNbYl0sYS5hdXRvRGVzdHJveSYmYS5kZXN0cm95KCk7dGhpcy5zdHJhdGVnaWVzPW51bGx9dGhpcy5wcm90b2NvbCYmKHRoaXMucHJvdG9jb2wuYXV0b0Rlc3Ryb3kmJnRoaXMucHJvdG9jb2wuZGVzdHJveSgpLFxudGhpcy5wcm90b2NvbD1udWxsKTt0aGlzLmRlc3Ryb3lGZWF0dXJlcygpO3RoaXMudW5yZW5kZXJlZEZlYXR1cmVzPXRoaXMuc2VsZWN0ZWRGZWF0dXJlcz10aGlzLmZlYXR1cmVzPW51bGw7dGhpcy5yZW5kZXJlciYmdGhpcy5yZW5kZXJlci5kZXN0cm95KCk7dGhpcy5kcmF3bj10aGlzLmdlb21ldHJ5VHlwZT10aGlzLnJlbmRlcmVyPW51bGw7T3BlbkxheWVycy5MYXllci5wcm90b3R5cGUuZGVzdHJveS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGNsb25lOmZ1bmN0aW9uKGEpe251bGw9PWEmJihhPW5ldyBPcGVuTGF5ZXJzLkxheWVyLlZlY3Rvcih0aGlzLm5hbWUsdGhpcy5nZXRPcHRpb25zKCkpKTtmb3IodmFyIGE9T3BlbkxheWVycy5MYXllci5wcm90b3R5cGUuY2xvbmUuYXBwbHkodGhpcyxbYV0pLGI9dGhpcy5mZWF0dXJlcyxjPWIubGVuZ3RoLGQ9QXJyYXkoYyksZT0wO2U8YzsrK2UpZFtlXT1iW2VdLmNsb25lKCk7YS5mZWF0dXJlcz1kO3JldHVybiBhfSxyZWZyZXNoOmZ1bmN0aW9uKGEpe3RoaXMuY2FsY3VsYXRlSW5SYW5nZSgpJiZcbnRoaXMudmlzaWJpbGl0eSYmdGhpcy5ldmVudHMudHJpZ2dlckV2ZW50KFwicmVmcmVzaFwiLGEpfSxhc3NpZ25SZW5kZXJlcjpmdW5jdGlvbigpe2Zvcih2YXIgYT0wLGI9dGhpcy5yZW5kZXJlcnMubGVuZ3RoO2E8YjthKyspe3ZhciBjPXRoaXMucmVuZGVyZXJzW2FdO2lmKChjPVwiZnVuY3Rpb25cIj09dHlwZW9mIGM/YzpPcGVuTGF5ZXJzLlJlbmRlcmVyW2NdKSYmYy5wcm90b3R5cGUuc3VwcG9ydGVkKCkpe3RoaXMucmVuZGVyZXI9bmV3IGModGhpcy5kaXYsdGhpcy5yZW5kZXJlck9wdGlvbnMpO2JyZWFrfX19LGRpc3BsYXlFcnJvcjpmdW5jdGlvbigpe3RoaXMucmVwb3J0RXJyb3ImJk9wZW5MYXllcnMuQ29uc29sZS51c2VyRXJyb3IoT3BlbkxheWVycy5pMThuKFwiYnJvd3Nlck5vdFN1cHBvcnRlZFwiLHtyZW5kZXJlcnM6dGhpcy5yZW5kZXJlcnMuam9pbihcIlxcblwiKX0pKX0sc2V0TWFwOmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuTGF5ZXIucHJvdG90eXBlLnNldE1hcC5hcHBseSh0aGlzLFxuYXJndW1lbnRzKTtpZih0aGlzLnJlbmRlcmVyKXt0aGlzLnJlbmRlcmVyLm1hcD10aGlzLm1hcDt2YXIgYj10aGlzLm1hcC5nZXRTaXplKCk7Yi53Kj10aGlzLnJhdGlvO2IuaCo9dGhpcy5yYXRpbzt0aGlzLnJlbmRlcmVyLnNldFNpemUoYil9ZWxzZSB0aGlzLm1hcC5yZW1vdmVMYXllcih0aGlzKX0sYWZ0ZXJBZGQ6ZnVuY3Rpb24oKXtpZih0aGlzLnN0cmF0ZWdpZXMpe3ZhciBhLGIsYztiPTA7Zm9yKGM9dGhpcy5zdHJhdGVnaWVzLmxlbmd0aDtiPGM7YisrKWE9dGhpcy5zdHJhdGVnaWVzW2JdLGEuYXV0b0FjdGl2YXRlJiZhLmFjdGl2YXRlKCl9fSxyZW1vdmVNYXA6ZnVuY3Rpb24oKXt0aGlzLmRyYXduPSExO2lmKHRoaXMuc3RyYXRlZ2llcyl7dmFyIGEsYixjO2I9MDtmb3IoYz10aGlzLnN0cmF0ZWdpZXMubGVuZ3RoO2I8YztiKyspYT10aGlzLnN0cmF0ZWdpZXNbYl0sYS5hdXRvQWN0aXZhdGUmJmEuZGVhY3RpdmF0ZSgpfX0sb25NYXBSZXNpemU6ZnVuY3Rpb24oKXtPcGVuTGF5ZXJzLkxheWVyLnByb3RvdHlwZS5vbk1hcFJlc2l6ZS5hcHBseSh0aGlzLFxuYXJndW1lbnRzKTt2YXIgYT10aGlzLm1hcC5nZXRTaXplKCk7YS53Kj10aGlzLnJhdGlvO2EuaCo9dGhpcy5yYXRpbzt0aGlzLnJlbmRlcmVyLnNldFNpemUoYSl9LG1vdmVUbzpmdW5jdGlvbihhLGIsYyl7T3BlbkxheWVycy5MYXllci5wcm90b3R5cGUubW92ZVRvLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgZD0hMDtpZighYyl7dGhpcy5yZW5kZXJlci5yb290LnN0eWxlLnZpc2liaWxpdHk9XCJoaWRkZW5cIjt2YXIgZD10aGlzLm1hcC5nZXRTaXplKCksZT1kLncsZD1kLmgsZT1lLzIqdGhpcy5yYXRpby1lLzIsZD1kLzIqdGhpcy5yYXRpby1kLzIsZT1lK3BhcnNlSW50KHRoaXMubWFwLmxheWVyQ29udGFpbmVyRGl2LnN0eWxlLmxlZnQsMTApLGU9LU1hdGgucm91bmQoZSksZD1kK3BhcnNlSW50KHRoaXMubWFwLmxheWVyQ29udGFpbmVyRGl2LnN0eWxlLnRvcCwxMCksZD0tTWF0aC5yb3VuZChkKTt0aGlzLmRpdi5zdHlsZS5sZWZ0PWUrXCJweFwiO3RoaXMuZGl2LnN0eWxlLnRvcD1cbmQrXCJweFwiO2Q9dGhpcy5yZW5kZXJlci5zZXRFeHRlbnQodGhpcy5tYXAuZ2V0RXh0ZW50KCkuc2NhbGUodGhpcy5yYXRpbyksYik7dGhpcy5yZW5kZXJlci5yb290LnN0eWxlLnZpc2liaWxpdHk9XCJ2aXNpYmxlXCI7ITA9PT1PcGVuTGF5ZXJzLklTX0dFQ0tPJiYodGhpcy5kaXYuc2Nyb2xsTGVmdD10aGlzLmRpdi5zY3JvbGxMZWZ0KTtpZighYiYmZClmb3IodmFyIGYgaW4gdGhpcy51bnJlbmRlcmVkRmVhdHVyZXMpZT10aGlzLnVucmVuZGVyZWRGZWF0dXJlc1tmXSx0aGlzLmRyYXdGZWF0dXJlKGUpfWlmKCF0aGlzLmRyYXdufHxifHwhZCl7dGhpcy5kcmF3bj0hMDtmPTA7Zm9yKGQ9dGhpcy5mZWF0dXJlcy5sZW5ndGg7ZjxkO2YrKyl0aGlzLnJlbmRlcmVyLmxvY2tlZD1mIT09ZC0xLGU9dGhpcy5mZWF0dXJlc1tmXSx0aGlzLmRyYXdGZWF0dXJlKGUpfX0sZGlzcGxheTpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLkxheWVyLnByb3RvdHlwZS5kaXNwbGF5LmFwcGx5KHRoaXMsYXJndW1lbnRzKTtcbnZhciBiPXRoaXMuZGl2LnN0eWxlLmRpc3BsYXk7YiE9dGhpcy5yZW5kZXJlci5yb290LnN0eWxlLmRpc3BsYXkmJih0aGlzLnJlbmRlcmVyLnJvb3Quc3R5bGUuZGlzcGxheT1iKX0sYWRkRmVhdHVyZXM6ZnVuY3Rpb24oYSxiKXtPcGVuTGF5ZXJzLlV0aWwuaXNBcnJheShhKXx8KGE9W2FdKTt2YXIgYz0hYnx8IWIuc2lsZW50O2lmKGMpe3ZhciBkPXtmZWF0dXJlczphfTtpZighMT09PXRoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcImJlZm9yZWZlYXR1cmVzYWRkZWRcIixkKSlyZXR1cm47YT1kLmZlYXR1cmVzfWZvcih2YXIgZD1bXSxlPTAsZj1hLmxlbmd0aDtlPGY7ZSsrKXt0aGlzLnJlbmRlcmVyLmxvY2tlZD1lIT1hLmxlbmd0aC0xPyEwOiExO3ZhciBnPWFbZV07aWYodGhpcy5nZW9tZXRyeVR5cGUmJiEoZy5nZW9tZXRyeSBpbnN0YW5jZW9mIHRoaXMuZ2VvbWV0cnlUeXBlKSl0aHJvdyBuZXcgVHlwZUVycm9yKFwiYWRkRmVhdHVyZXM6IGNvbXBvbmVudCBzaG91bGQgYmUgYW4gXCIrXG50aGlzLmdlb21ldHJ5VHlwZS5wcm90b3R5cGUuQ0xBU1NfTkFNRSk7Zy5sYXllcj10aGlzOyFnLnN0eWxlJiZ0aGlzLnN0eWxlJiYoZy5zdHlsZT1PcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHt9LHRoaXMuc3R5bGUpKTtpZihjKXtpZighMT09PXRoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcImJlZm9yZWZlYXR1cmVhZGRlZFwiLHtmZWF0dXJlOmd9KSljb250aW51ZTt0aGlzLnByZUZlYXR1cmVJbnNlcnQoZyl9ZC5wdXNoKGcpO3RoaXMuZmVhdHVyZXMucHVzaChnKTt0aGlzLmRyYXdGZWF0dXJlKGcpO2MmJih0aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJmZWF0dXJlYWRkZWRcIix7ZmVhdHVyZTpnfSksdGhpcy5vbkZlYXR1cmVJbnNlcnQoZykpfWMmJnRoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcImZlYXR1cmVzYWRkZWRcIix7ZmVhdHVyZXM6ZH0pfSxyZW1vdmVGZWF0dXJlczpmdW5jdGlvbihhLGIpe2lmKGEmJjAhPT1hLmxlbmd0aCl7aWYoYT09PXRoaXMuZmVhdHVyZXMpcmV0dXJuIHRoaXMucmVtb3ZlQWxsRmVhdHVyZXMoYik7XG5PcGVuTGF5ZXJzLlV0aWwuaXNBcnJheShhKXx8KGE9W2FdKTthPT09dGhpcy5zZWxlY3RlZEZlYXR1cmVzJiYoYT1hLnNsaWNlKCkpO3ZhciBjPSFifHwhYi5zaWxlbnQ7YyYmdGhpcy5ldmVudHMudHJpZ2dlckV2ZW50KFwiYmVmb3JlZmVhdHVyZXNyZW1vdmVkXCIse2ZlYXR1cmVzOmF9KTtmb3IodmFyIGQ9YS5sZW5ndGgtMTswPD1kO2QtLSl7dGhpcy5yZW5kZXJlci5sb2NrZWQ9MCE9ZCYmYVtkLTFdLmdlb21ldHJ5PyEwOiExO3ZhciBlPWFbZF07ZGVsZXRlIHRoaXMudW5yZW5kZXJlZEZlYXR1cmVzW2UuaWRdO2MmJnRoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcImJlZm9yZWZlYXR1cmVyZW1vdmVkXCIse2ZlYXR1cmU6ZX0pO3RoaXMuZmVhdHVyZXM9T3BlbkxheWVycy5VdGlsLnJlbW92ZUl0ZW0odGhpcy5mZWF0dXJlcyxlKTtlLmxheWVyPW51bGw7ZS5nZW9tZXRyeSYmdGhpcy5yZW5kZXJlci5lcmFzZUZlYXR1cmVzKGUpOy0xIT1PcGVuTGF5ZXJzLlV0aWwuaW5kZXhPZih0aGlzLnNlbGVjdGVkRmVhdHVyZXMsXG5lKSYmT3BlbkxheWVycy5VdGlsLnJlbW92ZUl0ZW0odGhpcy5zZWxlY3RlZEZlYXR1cmVzLGUpO2MmJnRoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcImZlYXR1cmVyZW1vdmVkXCIse2ZlYXR1cmU6ZX0pfWMmJnRoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcImZlYXR1cmVzcmVtb3ZlZFwiLHtmZWF0dXJlczphfSl9fSxyZW1vdmVBbGxGZWF0dXJlczpmdW5jdGlvbihhKXt2YXIgYT0hYXx8IWEuc2lsZW50LGI9dGhpcy5mZWF0dXJlczthJiZ0aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJiZWZvcmVmZWF0dXJlc3JlbW92ZWRcIix7ZmVhdHVyZXM6Yn0pO2Zvcih2YXIgYyxkPWIubGVuZ3RoLTE7MDw9ZDtkLS0pYz1iW2RdLGEmJnRoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcImJlZm9yZWZlYXR1cmVyZW1vdmVkXCIse2ZlYXR1cmU6Y30pLGMubGF5ZXI9bnVsbCxhJiZ0aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJmZWF0dXJlcmVtb3ZlZFwiLHtmZWF0dXJlOmN9KTt0aGlzLnJlbmRlcmVyLmNsZWFyKCk7XG50aGlzLmZlYXR1cmVzPVtdO3RoaXMudW5yZW5kZXJlZEZlYXR1cmVzPXt9O3RoaXMuc2VsZWN0ZWRGZWF0dXJlcz1bXTthJiZ0aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJmZWF0dXJlc3JlbW92ZWRcIix7ZmVhdHVyZXM6Yn0pfSxkZXN0cm95RmVhdHVyZXM6ZnVuY3Rpb24oYSxiKXt2b2lkIDA9PWEmJihhPXRoaXMuZmVhdHVyZXMpO2lmKGEpe3RoaXMucmVtb3ZlRmVhdHVyZXMoYSxiKTtmb3IodmFyIGM9YS5sZW5ndGgtMTswPD1jO2MtLSlhW2NdLmRlc3Ryb3koKX19LGRyYXdGZWF0dXJlOmZ1bmN0aW9uKGEsYil7aWYodGhpcy5kcmF3bil7aWYoXCJvYmplY3RcIiE9dHlwZW9mIGIpeyFiJiZhLnN0YXRlPT09T3BlbkxheWVycy5TdGF0ZS5ERUxFVEUmJihiPVwiZGVsZXRlXCIpO3ZhciBjPWJ8fGEucmVuZGVySW50ZW50OyhiPWEuc3R5bGV8fHRoaXMuc3R5bGUpfHwoYj10aGlzLnN0eWxlTWFwLmNyZWF0ZVN5bWJvbGl6ZXIoYSxjKSl9Yz10aGlzLnJlbmRlcmVyLmRyYXdGZWF0dXJlKGEsXG5iKTshMT09PWN8fG51bGw9PT1jP3RoaXMudW5yZW5kZXJlZEZlYXR1cmVzW2EuaWRdPWE6ZGVsZXRlIHRoaXMudW5yZW5kZXJlZEZlYXR1cmVzW2EuaWRdfX0sZXJhc2VGZWF0dXJlczpmdW5jdGlvbihhKXt0aGlzLnJlbmRlcmVyLmVyYXNlRmVhdHVyZXMoYSl9LGdldEZlYXR1cmVGcm9tRXZlbnQ6ZnVuY3Rpb24oYSl7aWYoIXRoaXMucmVuZGVyZXIpdGhyb3cgRXJyb3IoXCJnZXRGZWF0dXJlRnJvbUV2ZW50IGNhbGxlZCBvbiBsYXllciB3aXRoIG5vIHJlbmRlcmVyLiBUaGlzIHVzdWFsbHkgbWVhbnMgeW91IGRlc3Ryb3llZCBhIGxheWVyLCBidXQgbm90IHNvbWUgaGFuZGxlciB3aGljaCBpcyBhc3NvY2lhdGVkIHdpdGggaXQuXCIpO3ZhciBiPW51bGw7KGE9dGhpcy5yZW5kZXJlci5nZXRGZWF0dXJlSWRGcm9tRXZlbnQoYSkpJiYoYj1cInN0cmluZ1wiPT09dHlwZW9mIGE/dGhpcy5nZXRGZWF0dXJlQnlJZChhKTphKTtyZXR1cm4gYn0sZ2V0RmVhdHVyZUJ5OmZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPVxubnVsbCxkPTAsZT10aGlzLmZlYXR1cmVzLmxlbmd0aDtkPGU7KytkKWlmKHRoaXMuZmVhdHVyZXNbZF1bYV09PWIpe2M9dGhpcy5mZWF0dXJlc1tkXTticmVha31yZXR1cm4gY30sZ2V0RmVhdHVyZUJ5SWQ6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuZ2V0RmVhdHVyZUJ5KFwiaWRcIixhKX0sZ2V0RmVhdHVyZUJ5RmlkOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmdldEZlYXR1cmVCeShcImZpZFwiLGEpfSxnZXRGZWF0dXJlc0J5QXR0cmlidXRlOmZ1bmN0aW9uKGEsYil7dmFyIGMsZCxlPXRoaXMuZmVhdHVyZXMubGVuZ3RoLGY9W107Zm9yKGM9MDtjPGU7YysrKShkPXRoaXMuZmVhdHVyZXNbY10pJiZkLmF0dHJpYnV0ZXMmJmQuYXR0cmlidXRlc1thXT09PWImJmYucHVzaChkKTtyZXR1cm4gZn0sb25GZWF0dXJlSW5zZXJ0OmZ1bmN0aW9uKCl7fSxwcmVGZWF0dXJlSW5zZXJ0OmZ1bmN0aW9uKCl7fSxnZXREYXRhRXh0ZW50OmZ1bmN0aW9uKCl7dmFyIGE9bnVsbCxiPXRoaXMuZmVhdHVyZXM7XG5pZihiJiYwPGIubGVuZ3RoKWZvcih2YXIgYz1udWxsLGQ9MCxlPWIubGVuZ3RoO2Q8ZTtkKyspaWYoYz1iW2RdLmdlb21ldHJ5KW51bGw9PT1hJiYoYT1uZXcgT3BlbkxheWVycy5Cb3VuZHMpLGEuZXh0ZW5kKGMuZ2V0Qm91bmRzKCkpO3JldHVybiBhfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5MYXllci5WZWN0b3JcIn0pO09wZW5MYXllcnMuTGF5ZXIuVmVjdG9yLlJvb3RDb250YWluZXI9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkxheWVyLlZlY3Rvcix7ZGlzcGxheUluTGF5ZXJTd2l0Y2hlcjohMSxsYXllcnM6bnVsbCxkaXNwbGF5OmZ1bmN0aW9uKCl7fSxnZXRGZWF0dXJlRnJvbUV2ZW50OmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj10aGlzLmxheWVycyxjLGQ9MDtkPGIubGVuZ3RoO2QrKylpZihjPWJbZF0uZ2V0RmVhdHVyZUZyb21FdmVudChhKSlyZXR1cm4gY30sc2V0TWFwOmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuTGF5ZXIuVmVjdG9yLnByb3RvdHlwZS5zZXRNYXAuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuY29sbGVjdFJvb3RzKCk7YS5ldmVudHMucmVnaXN0ZXIoXCJjaGFuZ2VsYXllclwiLHRoaXMsdGhpcy5oYW5kbGVDaGFuZ2VMYXllcil9LHJlbW92ZU1hcDpmdW5jdGlvbihhKXthLmV2ZW50cy51bnJlZ2lzdGVyKFwiY2hhbmdlbGF5ZXJcIix0aGlzLHRoaXMuaGFuZGxlQ2hhbmdlTGF5ZXIpO1xudGhpcy5yZXNldFJvb3RzKCk7T3BlbkxheWVycy5MYXllci5WZWN0b3IucHJvdG90eXBlLnJlbW92ZU1hcC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGNvbGxlY3RSb290czpmdW5jdGlvbigpe2Zvcih2YXIgYSxiPTA7Yjx0aGlzLm1hcC5sYXllcnMubGVuZ3RoOysrYilhPXRoaXMubWFwLmxheWVyc1tiXSwtMSE9T3BlbkxheWVycy5VdGlsLmluZGV4T2YodGhpcy5sYXllcnMsYSkmJmEucmVuZGVyZXIubW92ZVJvb3QodGhpcy5yZW5kZXJlcil9LHJlc2V0Um9vdHM6ZnVuY3Rpb24oKXtmb3IodmFyIGEsYj0wO2I8dGhpcy5sYXllcnMubGVuZ3RoOysrYilhPXRoaXMubGF5ZXJzW2JdLHRoaXMucmVuZGVyZXImJmEucmVuZGVyZXIuZ2V0UmVuZGVyTGF5ZXJJZCgpPT10aGlzLmlkJiZ0aGlzLnJlbmRlcmVyLm1vdmVSb290KGEucmVuZGVyZXIpfSxoYW5kbGVDaGFuZ2VMYXllcjpmdW5jdGlvbihhKXt2YXIgYj1hLmxheWVyO1wib3JkZXJcIj09YS5wcm9wZXJ0eSYmLTEhPU9wZW5MYXllcnMuVXRpbC5pbmRleE9mKHRoaXMubGF5ZXJzLFxuYikmJih0aGlzLnJlc2V0Um9vdHMoKSx0aGlzLmNvbGxlY3RSb290cygpKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuTGF5ZXIuVmVjdG9yLlJvb3RDb250YWluZXJcIn0pO09wZW5MYXllcnMuQ29udHJvbC5TZWxlY3RGZWF0dXJlPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Db250cm9sLHttdWx0aXBsZUtleTpudWxsLHRvZ2dsZUtleTpudWxsLG11bHRpcGxlOiExLGNsaWNrb3V0OiEwLHRvZ2dsZTohMSxob3ZlcjohMSxoaWdobGlnaHRPbmx5OiExLGJveDohMSxvbkJlZm9yZVNlbGVjdDpmdW5jdGlvbigpe30sb25TZWxlY3Q6ZnVuY3Rpb24oKXt9LG9uVW5zZWxlY3Q6ZnVuY3Rpb24oKXt9LHNjb3BlOm51bGwsZ2VvbWV0cnlUeXBlczpudWxsLGxheWVyOm51bGwsbGF5ZXJzOm51bGwsY2FsbGJhY2tzOm51bGwsc2VsZWN0U3R5bGU6bnVsbCxyZW5kZXJJbnRlbnQ6XCJzZWxlY3RcIixoYW5kbGVyczpudWxsLGluaXRpYWxpemU6ZnVuY3Rpb24oYSxiKXtPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbYl0pO251bGw9PT10aGlzLnNjb3BlJiYodGhpcy5zY29wZT10aGlzKTt0aGlzLmluaXRMYXllcihhKTt2YXIgYz1cbntjbGljazp0aGlzLmNsaWNrRmVhdHVyZSxjbGlja291dDp0aGlzLmNsaWNrb3V0RmVhdHVyZX07dGhpcy5ob3ZlciYmKGMub3Zlcj10aGlzLm92ZXJGZWF0dXJlLGMub3V0PXRoaXMub3V0RmVhdHVyZSk7dGhpcy5jYWxsYmFja3M9T3BlbkxheWVycy5VdGlsLmV4dGVuZChjLHRoaXMuY2FsbGJhY2tzKTt0aGlzLmhhbmRsZXJzPXtmZWF0dXJlOm5ldyBPcGVuTGF5ZXJzLkhhbmRsZXIuRmVhdHVyZSh0aGlzLHRoaXMubGF5ZXIsdGhpcy5jYWxsYmFja3Mse2dlb21ldHJ5VHlwZXM6dGhpcy5nZW9tZXRyeVR5cGVzfSl9O3RoaXMuYm94JiYodGhpcy5oYW5kbGVycy5ib3g9bmV3IE9wZW5MYXllcnMuSGFuZGxlci5Cb3godGhpcyx7ZG9uZTp0aGlzLnNlbGVjdEJveH0se2JveERpdkNsYXNzTmFtZTpcIm9sSGFuZGxlckJveFNlbGVjdEZlYXR1cmVcIn0pKX0saW5pdExheWVyOmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuVXRpbC5pc0FycmF5KGEpPyh0aGlzLmxheWVycz1hLHRoaXMubGF5ZXI9XG5uZXcgT3BlbkxheWVycy5MYXllci5WZWN0b3IuUm9vdENvbnRhaW5lcih0aGlzLmlkK1wiX2NvbnRhaW5lclwiLHtsYXllcnM6YX0pKTp0aGlzLmxheWVyPWF9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLmFjdGl2ZSYmdGhpcy5sYXllcnMmJnRoaXMubWFwLnJlbW92ZUxheWVyKHRoaXMubGF5ZXIpO09wZW5MYXllcnMuQ29udHJvbC5wcm90b3R5cGUuZGVzdHJveS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5sYXllcnMmJnRoaXMubGF5ZXIuZGVzdHJveSgpfSxhY3RpdmF0ZTpmdW5jdGlvbigpe3RoaXMuYWN0aXZlfHwodGhpcy5sYXllcnMmJnRoaXMubWFwLmFkZExheWVyKHRoaXMubGF5ZXIpLHRoaXMuaGFuZGxlcnMuZmVhdHVyZS5hY3RpdmF0ZSgpLHRoaXMuYm94JiZ0aGlzLmhhbmRsZXJzLmJveCYmdGhpcy5oYW5kbGVycy5ib3guYWN0aXZhdGUoKSk7cmV0dXJuIE9wZW5MYXllcnMuQ29udHJvbC5wcm90b3R5cGUuYWN0aXZhdGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxkZWFjdGl2YXRlOmZ1bmN0aW9uKCl7dGhpcy5hY3RpdmUmJlxuKHRoaXMuaGFuZGxlcnMuZmVhdHVyZS5kZWFjdGl2YXRlKCksdGhpcy5oYW5kbGVycy5ib3gmJnRoaXMuaGFuZGxlcnMuYm94LmRlYWN0aXZhdGUoKSx0aGlzLmxheWVycyYmdGhpcy5tYXAucmVtb3ZlTGF5ZXIodGhpcy5sYXllcikpO3JldHVybiBPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmRlYWN0aXZhdGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfSx1bnNlbGVjdEFsbDpmdW5jdGlvbihhKXtmb3IodmFyIGI9dGhpcy5sYXllcnN8fFt0aGlzLmxheWVyXSxjLGQsZT0wO2U8Yi5sZW5ndGg7KytlKXtjPWJbZV07Zm9yKHZhciBmPWMuc2VsZWN0ZWRGZWF0dXJlcy5sZW5ndGgtMTswPD1mOy0tZilkPWMuc2VsZWN0ZWRGZWF0dXJlc1tmXSwoIWF8fGEuZXhjZXB0IT1kKSYmdGhpcy51bnNlbGVjdChkKX19LGNsaWNrRmVhdHVyZTpmdW5jdGlvbihhKXt0aGlzLmhvdmVyfHwoLTE8T3BlbkxheWVycy5VdGlsLmluZGV4T2YoYS5sYXllci5zZWxlY3RlZEZlYXR1cmVzLGEpP3RoaXMudG9nZ2xlU2VsZWN0KCk/XG50aGlzLnVuc2VsZWN0KGEpOnRoaXMubXVsdGlwbGVTZWxlY3QoKXx8dGhpcy51bnNlbGVjdEFsbCh7ZXhjZXB0OmF9KToodGhpcy5tdWx0aXBsZVNlbGVjdCgpfHx0aGlzLnVuc2VsZWN0QWxsKHtleGNlcHQ6YX0pLHRoaXMuc2VsZWN0KGEpKSl9LG11bHRpcGxlU2VsZWN0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubXVsdGlwbGV8fHRoaXMuaGFuZGxlcnMuZmVhdHVyZS5ldnQmJnRoaXMuaGFuZGxlcnMuZmVhdHVyZS5ldnRbdGhpcy5tdWx0aXBsZUtleV19LHRvZ2dsZVNlbGVjdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnRvZ2dsZXx8dGhpcy5oYW5kbGVycy5mZWF0dXJlLmV2dCYmdGhpcy5oYW5kbGVycy5mZWF0dXJlLmV2dFt0aGlzLnRvZ2dsZUtleV19LGNsaWNrb3V0RmVhdHVyZTpmdW5jdGlvbigpeyF0aGlzLmhvdmVyJiZ0aGlzLmNsaWNrb3V0JiZ0aGlzLnVuc2VsZWN0QWxsKCl9LG92ZXJGZWF0dXJlOmZ1bmN0aW9uKGEpe3ZhciBiPWEubGF5ZXI7dGhpcy5ob3ZlciYmKHRoaXMuaGlnaGxpZ2h0T25seT9cbnRoaXMuaGlnaGxpZ2h0KGEpOi0xPT1PcGVuTGF5ZXJzLlV0aWwuaW5kZXhPZihiLnNlbGVjdGVkRmVhdHVyZXMsYSkmJnRoaXMuc2VsZWN0KGEpKX0sb3V0RmVhdHVyZTpmdW5jdGlvbihhKXtpZih0aGlzLmhvdmVyKWlmKHRoaXMuaGlnaGxpZ2h0T25seSl7aWYoYS5fbGFzdEhpZ2hsaWdodGVyPT10aGlzLmlkKWlmKGEuX3ByZXZIaWdobGlnaHRlciYmYS5fcHJldkhpZ2hsaWdodGVyIT10aGlzLmlkKXtkZWxldGUgYS5fbGFzdEhpZ2hsaWdodGVyO3ZhciBiPXRoaXMubWFwLmdldENvbnRyb2woYS5fcHJldkhpZ2hsaWdodGVyKTtiJiZiLmhpZ2hsaWdodChhKX1lbHNlIHRoaXMudW5oaWdobGlnaHQoYSl9ZWxzZSB0aGlzLnVuc2VsZWN0KGEpfSxoaWdobGlnaHQ6ZnVuY3Rpb24oYSl7dmFyIGI9YS5sYXllcjshMSE9PXRoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcImJlZm9yZWZlYXR1cmVoaWdobGlnaHRlZFwiLHtmZWF0dXJlOmF9KSYmKGEuX3ByZXZIaWdobGlnaHRlcj1hLl9sYXN0SGlnaGxpZ2h0ZXIsXG5hLl9sYXN0SGlnaGxpZ2h0ZXI9dGhpcy5pZCxiLmRyYXdGZWF0dXJlKGEsdGhpcy5zZWxlY3RTdHlsZXx8dGhpcy5yZW5kZXJJbnRlbnQpLHRoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcImZlYXR1cmVoaWdobGlnaHRlZFwiLHtmZWF0dXJlOmF9KSl9LHVuaGlnaGxpZ2h0OmZ1bmN0aW9uKGEpe3ZhciBiPWEubGF5ZXI7dm9pZCAwPT1hLl9wcmV2SGlnaGxpZ2h0ZXI/ZGVsZXRlIGEuX2xhc3RIaWdobGlnaHRlcjooYS5fcHJldkhpZ2hsaWdodGVyIT10aGlzLmlkJiYoYS5fbGFzdEhpZ2hsaWdodGVyPWEuX3ByZXZIaWdobGlnaHRlciksZGVsZXRlIGEuX3ByZXZIaWdobGlnaHRlcik7Yi5kcmF3RmVhdHVyZShhLGEuc3R5bGV8fGEubGF5ZXIuc3R5bGV8fFwiZGVmYXVsdFwiKTt0aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJmZWF0dXJldW5oaWdobGlnaHRlZFwiLHtmZWF0dXJlOmF9KX0sc2VsZWN0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMub25CZWZvcmVTZWxlY3QuY2FsbCh0aGlzLnNjb3BlLFxuYSksYz1hLmxheWVyOyExIT09YiYmKGI9Yy5ldmVudHMudHJpZ2dlckV2ZW50KFwiYmVmb3JlZmVhdHVyZXNlbGVjdGVkXCIse2ZlYXR1cmU6YX0pLCExIT09YiYmKGMuc2VsZWN0ZWRGZWF0dXJlcy5wdXNoKGEpLHRoaXMuaGlnaGxpZ2h0KGEpLHRoaXMuaGFuZGxlcnMuZmVhdHVyZS5sYXN0RmVhdHVyZXx8KHRoaXMuaGFuZGxlcnMuZmVhdHVyZS5sYXN0RmVhdHVyZT1jLnNlbGVjdGVkRmVhdHVyZXNbMF0pLGMuZXZlbnRzLnRyaWdnZXJFdmVudChcImZlYXR1cmVzZWxlY3RlZFwiLHtmZWF0dXJlOmF9KSx0aGlzLm9uU2VsZWN0LmNhbGwodGhpcy5zY29wZSxhKSkpfSx1bnNlbGVjdDpmdW5jdGlvbihhKXt2YXIgYj1hLmxheWVyO3RoaXMudW5oaWdobGlnaHQoYSk7T3BlbkxheWVycy5VdGlsLnJlbW92ZUl0ZW0oYi5zZWxlY3RlZEZlYXR1cmVzLGEpO2IuZXZlbnRzLnRyaWdnZXJFdmVudChcImZlYXR1cmV1bnNlbGVjdGVkXCIse2ZlYXR1cmU6YX0pO3RoaXMub25VbnNlbGVjdC5jYWxsKHRoaXMuc2NvcGUsXG5hKX0sc2VsZWN0Qm94OmZ1bmN0aW9uKGEpe2lmKGEgaW5zdGFuY2VvZiBPcGVuTGF5ZXJzLkJvdW5kcyl7dmFyIGI9dGhpcy5tYXAuZ2V0TG9uTGF0RnJvbVBpeGVsKHt4OmEubGVmdCx5OmEuYm90dG9tfSksYT10aGlzLm1hcC5nZXRMb25MYXRGcm9tUGl4ZWwoe3g6YS5yaWdodCx5OmEudG9wfSksYj1uZXcgT3BlbkxheWVycy5Cb3VuZHMoYi5sb24sYi5sYXQsYS5sb24sYS5sYXQpO3RoaXMubXVsdGlwbGVTZWxlY3QoKXx8dGhpcy51bnNlbGVjdEFsbCgpO2E9dGhpcy5tdWx0aXBsZTt0aGlzLm11bHRpcGxlPSEwO3ZhciBjPXRoaXMubGF5ZXJzfHxbdGhpcy5sYXllcl07dGhpcy5ldmVudHMudHJpZ2dlckV2ZW50KFwiYm94c2VsZWN0aW9uc3RhcnRcIix7bGF5ZXJzOmN9KTtmb3IodmFyIGQsZT0wO2U8Yy5sZW5ndGg7KytlKXtkPWNbZV07Zm9yKHZhciBmPTAsZz1kLmZlYXR1cmVzLmxlbmd0aDtmPGc7KytmKXt2YXIgaD1kLmZlYXR1cmVzW2ZdO2guZ2V0VmlzaWJpbGl0eSgpJiYobnVsbD09XG50aGlzLmdlb21ldHJ5VHlwZXN8fC0xPE9wZW5MYXllcnMuVXRpbC5pbmRleE9mKHRoaXMuZ2VvbWV0cnlUeXBlcyxoLmdlb21ldHJ5LkNMQVNTX05BTUUpKSYmYi50b0dlb21ldHJ5KCkuaW50ZXJzZWN0cyhoLmdlb21ldHJ5KSYmLTE9PU9wZW5MYXllcnMuVXRpbC5pbmRleE9mKGQuc2VsZWN0ZWRGZWF0dXJlcyxoKSYmdGhpcy5zZWxlY3QoaCl9fXRoaXMubXVsdGlwbGU9YTt0aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJib3hzZWxlY3Rpb25lbmRcIix7bGF5ZXJzOmN9KX19LHNldE1hcDpmdW5jdGlvbihhKXt0aGlzLmhhbmRsZXJzLmZlYXR1cmUuc2V0TWFwKGEpO3RoaXMuYm94JiZ0aGlzLmhhbmRsZXJzLmJveC5zZXRNYXAoYSk7T3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5zZXRNYXAuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxzZXRMYXllcjpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmFjdGl2ZTt0aGlzLnVuc2VsZWN0QWxsKCk7dGhpcy5kZWFjdGl2YXRlKCk7dGhpcy5sYXllcnMmJlxuKHRoaXMubGF5ZXIuZGVzdHJveSgpLHRoaXMubGF5ZXJzPW51bGwpO3RoaXMuaW5pdExheWVyKGEpO3RoaXMuaGFuZGxlcnMuZmVhdHVyZS5sYXllcj10aGlzLmxheWVyO2ImJnRoaXMuYWN0aXZhdGUoKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuQ29udHJvbC5TZWxlY3RGZWF0dXJlXCJ9KTtPcGVuTGF5ZXJzLkhhbmRsZXIuS2V5Ym9hcmQ9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkhhbmRsZXIse0tFWV9FVkVOVFM6W1wia2V5ZG93blwiLFwia2V5dXBcIl0sZXZlbnRMaXN0ZW5lcjpudWxsLG9ic2VydmVFbGVtZW50Om51bGwsaW5pdGlhbGl6ZTpmdW5jdGlvbihhLGIsYyl7T3BlbkxheWVycy5IYW5kbGVyLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmV2ZW50TGlzdGVuZXI9T3BlbkxheWVycy5GdW5jdGlvbi5iaW5kQXNFdmVudExpc3RlbmVyKHRoaXMuaGFuZGxlS2V5RXZlbnQsdGhpcyl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLmRlYWN0aXZhdGUoKTt0aGlzLmV2ZW50TGlzdGVuZXI9bnVsbDtPcGVuTGF5ZXJzLkhhbmRsZXIucHJvdG90eXBlLmRlc3Ryb3kuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxhY3RpdmF0ZTpmdW5jdGlvbigpe2lmKE9wZW5MYXllcnMuSGFuZGxlci5wcm90b3R5cGUuYWN0aXZhdGUuYXBwbHkodGhpcyxcbmFyZ3VtZW50cykpe3RoaXMub2JzZXJ2ZUVsZW1lbnQ9dGhpcy5vYnNlcnZlRWxlbWVudHx8ZG9jdW1lbnQ7Zm9yKHZhciBhPTAsYj10aGlzLktFWV9FVkVOVFMubGVuZ3RoO2E8YjthKyspT3BlbkxheWVycy5FdmVudC5vYnNlcnZlKHRoaXMub2JzZXJ2ZUVsZW1lbnQsdGhpcy5LRVlfRVZFTlRTW2FdLHRoaXMuZXZlbnRMaXN0ZW5lcik7cmV0dXJuITB9cmV0dXJuITF9LGRlYWN0aXZhdGU6ZnVuY3Rpb24oKXt2YXIgYT0hMTtpZihPcGVuTGF5ZXJzLkhhbmRsZXIucHJvdG90eXBlLmRlYWN0aXZhdGUuYXBwbHkodGhpcyxhcmd1bWVudHMpKXtmb3IodmFyIGE9MCxiPXRoaXMuS0VZX0VWRU5UUy5sZW5ndGg7YTxiO2ErKylPcGVuTGF5ZXJzLkV2ZW50LnN0b3BPYnNlcnZpbmcodGhpcy5vYnNlcnZlRWxlbWVudCx0aGlzLktFWV9FVkVOVFNbYV0sdGhpcy5ldmVudExpc3RlbmVyKTthPSEwfXJldHVybiBhfSxoYW5kbGVLZXlFdmVudDpmdW5jdGlvbihhKXt0aGlzLmNoZWNrTW9kaWZpZXJzKGEpJiZcbnRoaXMuY2FsbGJhY2soYS50eXBlLFthXSl9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkhhbmRsZXIuS2V5Ym9hcmRcIn0pO09wZW5MYXllcnMuQ29udHJvbC5Nb2RpZnlGZWF0dXJlPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Db250cm9sLHtnZW9tZXRyeVR5cGVzOm51bGwsY2xpY2tvdXQ6ITAsdG9nZ2xlOiEwLHN0YW5kYWxvbmU6ITEsbGF5ZXI6bnVsbCxmZWF0dXJlOm51bGwsdmVydGljZXM6bnVsbCx2aXJ0dWFsVmVydGljZXM6bnVsbCxzZWxlY3RDb250cm9sOm51bGwsZHJhZ0NvbnRyb2w6bnVsbCxoYW5kbGVyczpudWxsLGRlbGV0ZUNvZGVzOm51bGwsdmlydHVhbFN0eWxlOm51bGwsdmVydGV4UmVuZGVySW50ZW50Om51bGwsbW9kZTpudWxsLGNyZWF0ZVZlcnRpY2VzOiEwLG1vZGlmaWVkOiExLHJhZGl1c0hhbmRsZTpudWxsLGRyYWdIYW5kbGU6bnVsbCxvbk1vZGlmaWNhdGlvblN0YXJ0OmZ1bmN0aW9uKCl7fSxvbk1vZGlmaWNhdGlvbjpmdW5jdGlvbigpe30sb25Nb2RpZmljYXRpb25FbmQ6ZnVuY3Rpb24oKXt9LGluaXRpYWxpemU6ZnVuY3Rpb24oYSxiKXtiPWJ8fHt9O3RoaXMubGF5ZXI9XG5hO3RoaXMudmVydGljZXM9W107dGhpcy52aXJ0dWFsVmVydGljZXM9W107dGhpcy52aXJ0dWFsU3R5bGU9T3BlbkxheWVycy5VdGlsLmV4dGVuZCh7fSx0aGlzLmxheWVyLnN0eWxlfHx0aGlzLmxheWVyLnN0eWxlTWFwLmNyZWF0ZVN5bWJvbGl6ZXIobnVsbCxiLnZlcnRleFJlbmRlckludGVudCkpO3RoaXMudmlydHVhbFN0eWxlLmZpbGxPcGFjaXR5PTAuMzt0aGlzLnZpcnR1YWxTdHlsZS5zdHJva2VPcGFjaXR5PTAuMzt0aGlzLmRlbGV0ZUNvZGVzPVs0Niw2OF07dGhpcy5tb2RlPU9wZW5MYXllcnMuQ29udHJvbC5Nb2RpZnlGZWF0dXJlLlJFU0hBUEU7T3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsW2JdKTtPcGVuTGF5ZXJzLlV0aWwuaXNBcnJheSh0aGlzLmRlbGV0ZUNvZGVzKXx8KHRoaXMuZGVsZXRlQ29kZXM9W3RoaXMuZGVsZXRlQ29kZXNdKTt2YXIgYz10aGlzLGQ9e2dlb21ldHJ5VHlwZXM6dGhpcy5nZW9tZXRyeVR5cGVzLGNsaWNrb3V0OnRoaXMuY2xpY2tvdXQsXG50b2dnbGU6dGhpcy50b2dnbGUsb25CZWZvcmVTZWxlY3Q6dGhpcy5iZWZvcmVTZWxlY3RGZWF0dXJlLG9uU2VsZWN0OnRoaXMuc2VsZWN0RmVhdHVyZSxvblVuc2VsZWN0OnRoaXMudW5zZWxlY3RGZWF0dXJlLHNjb3BlOnRoaXN9OyExPT09dGhpcy5zdGFuZGFsb25lJiYodGhpcy5zZWxlY3RDb250cm9sPW5ldyBPcGVuTGF5ZXJzLkNvbnRyb2wuU2VsZWN0RmVhdHVyZShhLGQpKTt0aGlzLmRyYWdDb250cm9sPW5ldyBPcGVuTGF5ZXJzLkNvbnRyb2wuRHJhZ0ZlYXR1cmUoYSx7Z2VvbWV0cnlUeXBlczpbXCJPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50XCJdLG9uU3RhcnQ6ZnVuY3Rpb24oYSxiKXtjLmRyYWdTdGFydC5hcHBseShjLFthLGJdKX0sb25EcmFnOmZ1bmN0aW9uKGEsYil7Yy5kcmFnVmVydGV4LmFwcGx5KGMsW2EsYl0pfSxvbkNvbXBsZXRlOmZ1bmN0aW9uKGEpe2MuZHJhZ0NvbXBsZXRlLmFwcGx5KGMsW2FdKX0sZmVhdHVyZUNhbGxiYWNrczp7b3ZlcjpmdW5jdGlvbihhKXsoYy5zdGFuZGFsb25lIT09XG50cnVlfHxhLl9za2V0Y2h8fGMuZmVhdHVyZT09PWEpJiZjLmRyYWdDb250cm9sLm92ZXJGZWF0dXJlLmFwcGx5KGMuZHJhZ0NvbnRyb2wsW2FdKX19fSk7dGhpcy5oYW5kbGVycz17a2V5Ym9hcmQ6bmV3IE9wZW5MYXllcnMuSGFuZGxlci5LZXlib2FyZCh0aGlzLHtrZXlkb3duOnRoaXMuaGFuZGxlS2V5cHJlc3N9KX19LGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLmxheWVyPW51bGw7dGhpcy5zdGFuZGFsb25lfHx0aGlzLnNlbGVjdENvbnRyb2wuZGVzdHJveSgpO3RoaXMuZHJhZ0NvbnRyb2wuZGVzdHJveSgpO09wZW5MYXllcnMuQ29udHJvbC5wcm90b3R5cGUuZGVzdHJveS5hcHBseSh0aGlzLFtdKX0sYWN0aXZhdGU6ZnVuY3Rpb24oKXtyZXR1cm4odGhpcy5zdGFuZGFsb25lfHx0aGlzLnNlbGVjdENvbnRyb2wuYWN0aXZhdGUoKSkmJnRoaXMuaGFuZGxlcnMua2V5Ym9hcmQuYWN0aXZhdGUoKSYmT3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5hY3RpdmF0ZS5hcHBseSh0aGlzLFxuYXJndW1lbnRzKX0sZGVhY3RpdmF0ZTpmdW5jdGlvbigpe3ZhciBhPSExO2lmKE9wZW5MYXllcnMuQ29udHJvbC5wcm90b3R5cGUuZGVhY3RpdmF0ZS5hcHBseSh0aGlzLGFyZ3VtZW50cykpe3RoaXMubGF5ZXIucmVtb3ZlRmVhdHVyZXModGhpcy52ZXJ0aWNlcyx7c2lsZW50OiEwfSk7dGhpcy5sYXllci5yZW1vdmVGZWF0dXJlcyh0aGlzLnZpcnR1YWxWZXJ0aWNlcyx7c2lsZW50OiEwfSk7dGhpcy52ZXJ0aWNlcz1bXTt0aGlzLmRyYWdDb250cm9sLmRlYWN0aXZhdGUoKTt2YXIgYj0oYT10aGlzLmZlYXR1cmUpJiZhLmdlb21ldHJ5JiZhLmxheWVyOyExPT09dGhpcy5zdGFuZGFsb25lPyhiJiZ0aGlzLnNlbGVjdENvbnRyb2wudW5zZWxlY3QuYXBwbHkodGhpcy5zZWxlY3RDb250cm9sLFthXSksdGhpcy5zZWxlY3RDb250cm9sLmRlYWN0aXZhdGUoKSk6YiYmdGhpcy51bnNlbGVjdEZlYXR1cmUoYSk7dGhpcy5oYW5kbGVycy5rZXlib2FyZC5kZWFjdGl2YXRlKCk7YT0hMH1yZXR1cm4gYX0sXG5iZWZvcmVTZWxlY3RGZWF0dXJlOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmxheWVyLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJiZWZvcmVmZWF0dXJlbW9kaWZpZWRcIix7ZmVhdHVyZTphfSl9LHNlbGVjdEZlYXR1cmU6ZnVuY3Rpb24oYSl7aWYoIXRoaXMuc3RhbmRhbG9uZXx8ITEhPT10aGlzLmJlZm9yZVNlbGVjdEZlYXR1cmUoYSkpdGhpcy5mZWF0dXJlPWEsdGhpcy5tb2RpZmllZD0hMSx0aGlzLnJlc2V0VmVydGljZXMoKSx0aGlzLmRyYWdDb250cm9sLmFjdGl2YXRlKCksdGhpcy5vbk1vZGlmaWNhdGlvblN0YXJ0KHRoaXMuZmVhdHVyZSk7dmFyIGI9YS5tb2RpZmllZDtpZihhLmdlb21ldHJ5JiYoIWJ8fCFiLmdlb21ldHJ5KSl0aGlzLl9vcmlnaW5hbEdlb21ldHJ5PWEuZ2VvbWV0cnkuY2xvbmUoKX0sdW5zZWxlY3RGZWF0dXJlOmZ1bmN0aW9uKGEpe3RoaXMubGF5ZXIucmVtb3ZlRmVhdHVyZXModGhpcy52ZXJ0aWNlcyx7c2lsZW50OiEwfSk7dGhpcy52ZXJ0aWNlcz1bXTt0aGlzLmxheWVyLmRlc3Ryb3lGZWF0dXJlcyh0aGlzLnZpcnR1YWxWZXJ0aWNlcyxcbntzaWxlbnQ6ITB9KTt0aGlzLnZpcnR1YWxWZXJ0aWNlcz1bXTt0aGlzLmRyYWdIYW5kbGUmJih0aGlzLmxheWVyLmRlc3Ryb3lGZWF0dXJlcyhbdGhpcy5kcmFnSGFuZGxlXSx7c2lsZW50OiEwfSksZGVsZXRlIHRoaXMuZHJhZ0hhbmRsZSk7dGhpcy5yYWRpdXNIYW5kbGUmJih0aGlzLmxheWVyLmRlc3Ryb3lGZWF0dXJlcyhbdGhpcy5yYWRpdXNIYW5kbGVdLHtzaWxlbnQ6ITB9KSxkZWxldGUgdGhpcy5yYWRpdXNIYW5kbGUpO3RoaXMuZmVhdHVyZT1udWxsO3RoaXMuZHJhZ0NvbnRyb2wuZGVhY3RpdmF0ZSgpO3RoaXMub25Nb2RpZmljYXRpb25FbmQoYSk7dGhpcy5sYXllci5ldmVudHMudHJpZ2dlckV2ZW50KFwiYWZ0ZXJmZWF0dXJlbW9kaWZpZWRcIix7ZmVhdHVyZTphLG1vZGlmaWVkOnRoaXMubW9kaWZpZWR9KTt0aGlzLm1vZGlmaWVkPSExfSxkcmFnU3RhcnQ6ZnVuY3Rpb24oYSxiKXtpZihhIT10aGlzLmZlYXR1cmUmJighYS5nZW9tZXRyeS5wYXJlbnQmJmEhPXRoaXMuZHJhZ0hhbmRsZSYmXG5hIT10aGlzLnJhZGl1c0hhbmRsZSkmJighMT09PXRoaXMuc3RhbmRhbG9uZSYmdGhpcy5mZWF0dXJlJiZ0aGlzLnNlbGVjdENvbnRyb2wuY2xpY2tGZWF0dXJlLmFwcGx5KHRoaXMuc2VsZWN0Q29udHJvbCxbdGhpcy5mZWF0dXJlXSksbnVsbD09dGhpcy5nZW9tZXRyeVR5cGVzfHwtMSE9T3BlbkxheWVycy5VdGlsLmluZGV4T2YodGhpcy5nZW9tZXRyeVR5cGVzLGEuZ2VvbWV0cnkuQ0xBU1NfTkFNRSkpKXRoaXMuc3RhbmRhbG9uZXx8dGhpcy5zZWxlY3RDb250cm9sLmNsaWNrRmVhdHVyZS5hcHBseSh0aGlzLnNlbGVjdENvbnRyb2wsW2FdKSx0aGlzLmRyYWdDb250cm9sLm92ZXJGZWF0dXJlLmFwcGx5KHRoaXMuZHJhZ0NvbnRyb2wsW2FdKSx0aGlzLmRyYWdDb250cm9sLmxhc3RQaXhlbD1iLHRoaXMuZHJhZ0NvbnRyb2wuaGFuZGxlcnMuZHJhZy5zdGFydGVkPSEwLHRoaXMuZHJhZ0NvbnRyb2wuaGFuZGxlcnMuZHJhZy5zdGFydD1iLHRoaXMuZHJhZ0NvbnRyb2wuaGFuZGxlcnMuZHJhZy5sYXN0PVxuYn0sZHJhZ1ZlcnRleDpmdW5jdGlvbihhLGIpe3RoaXMubW9kaWZpZWQ9ITA7XCJPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50XCI9PXRoaXMuZmVhdHVyZS5nZW9tZXRyeS5DTEFTU19OQU1FPyh0aGlzLmZlYXR1cmUhPWEmJih0aGlzLmZlYXR1cmU9YSksdGhpcy5sYXllci5ldmVudHMudHJpZ2dlckV2ZW50KFwidmVydGV4bW9kaWZpZWRcIix7dmVydGV4OmEuZ2VvbWV0cnksZmVhdHVyZTp0aGlzLmZlYXR1cmUscGl4ZWw6Yn0pKTooYS5faW5kZXg/KGEuZ2VvbWV0cnkucGFyZW50LmFkZENvbXBvbmVudChhLmdlb21ldHJ5LGEuX2luZGV4KSxkZWxldGUgYS5faW5kZXgsT3BlbkxheWVycy5VdGlsLnJlbW92ZUl0ZW0odGhpcy52aXJ0dWFsVmVydGljZXMsYSksdGhpcy52ZXJ0aWNlcy5wdXNoKGEpKTphPT10aGlzLmRyYWdIYW5kbGU/KHRoaXMubGF5ZXIucmVtb3ZlRmVhdHVyZXModGhpcy52ZXJ0aWNlcyx7c2lsZW50OiEwfSksdGhpcy52ZXJ0aWNlcz1bXSx0aGlzLnJhZGl1c0hhbmRsZSYmXG4odGhpcy5sYXllci5kZXN0cm95RmVhdHVyZXMoW3RoaXMucmFkaXVzSGFuZGxlXSx7c2lsZW50OiEwfSksdGhpcy5yYWRpdXNIYW5kbGU9bnVsbCkpOmEhPT10aGlzLnJhZGl1c0hhbmRsZSYmdGhpcy5sYXllci5ldmVudHMudHJpZ2dlckV2ZW50KFwidmVydGV4bW9kaWZpZWRcIix7dmVydGV4OmEuZ2VvbWV0cnksZmVhdHVyZTp0aGlzLmZlYXR1cmUscGl4ZWw6Yn0pLDA8dGhpcy52aXJ0dWFsVmVydGljZXMubGVuZ3RoJiYodGhpcy5sYXllci5kZXN0cm95RmVhdHVyZXModGhpcy52aXJ0dWFsVmVydGljZXMse3NpbGVudDohMH0pLHRoaXMudmlydHVhbFZlcnRpY2VzPVtdKSx0aGlzLmxheWVyLmRyYXdGZWF0dXJlKHRoaXMuZmVhdHVyZSx0aGlzLnN0YW5kYWxvbmU/dm9pZCAwOnRoaXMuc2VsZWN0Q29udHJvbC5yZW5kZXJJbnRlbnQpKTt0aGlzLmxheWVyLmRyYXdGZWF0dXJlKGEpfSxkcmFnQ29tcGxldGU6ZnVuY3Rpb24oKXt0aGlzLnJlc2V0VmVydGljZXMoKTt0aGlzLnNldEZlYXR1cmVTdGF0ZSgpO1xudGhpcy5vbk1vZGlmaWNhdGlvbih0aGlzLmZlYXR1cmUpO3RoaXMubGF5ZXIuZXZlbnRzLnRyaWdnZXJFdmVudChcImZlYXR1cmVtb2RpZmllZFwiLHtmZWF0dXJlOnRoaXMuZmVhdHVyZX0pfSxzZXRGZWF0dXJlU3RhdGU6ZnVuY3Rpb24oKXtpZih0aGlzLmZlYXR1cmUuc3RhdGUhPU9wZW5MYXllcnMuU3RhdGUuSU5TRVJUJiZ0aGlzLmZlYXR1cmUuc3RhdGUhPU9wZW5MYXllcnMuU3RhdGUuREVMRVRFJiYodGhpcy5mZWF0dXJlLnN0YXRlPU9wZW5MYXllcnMuU3RhdGUuVVBEQVRFLHRoaXMubW9kaWZpZWQmJnRoaXMuX29yaWdpbmFsR2VvbWV0cnkpKXt2YXIgYT10aGlzLmZlYXR1cmU7YS5tb2RpZmllZD1PcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKGEubW9kaWZpZWQse2dlb21ldHJ5OnRoaXMuX29yaWdpbmFsR2VvbWV0cnl9KTtkZWxldGUgdGhpcy5fb3JpZ2luYWxHZW9tZXRyeX19LHJlc2V0VmVydGljZXM6ZnVuY3Rpb24oKXt0aGlzLmRyYWdDb250cm9sLmZlYXR1cmUmJnRoaXMuZHJhZ0NvbnRyb2wub3V0RmVhdHVyZSh0aGlzLmRyYWdDb250cm9sLmZlYXR1cmUpO1xuMDx0aGlzLnZlcnRpY2VzLmxlbmd0aCYmKHRoaXMubGF5ZXIucmVtb3ZlRmVhdHVyZXModGhpcy52ZXJ0aWNlcyx7c2lsZW50OiEwfSksdGhpcy52ZXJ0aWNlcz1bXSk7MDx0aGlzLnZpcnR1YWxWZXJ0aWNlcy5sZW5ndGgmJih0aGlzLmxheWVyLnJlbW92ZUZlYXR1cmVzKHRoaXMudmlydHVhbFZlcnRpY2VzLHtzaWxlbnQ6ITB9KSx0aGlzLnZpcnR1YWxWZXJ0aWNlcz1bXSk7dGhpcy5kcmFnSGFuZGxlJiYodGhpcy5sYXllci5kZXN0cm95RmVhdHVyZXMoW3RoaXMuZHJhZ0hhbmRsZV0se3NpbGVudDohMH0pLHRoaXMuZHJhZ0hhbmRsZT1udWxsKTt0aGlzLnJhZGl1c0hhbmRsZSYmKHRoaXMubGF5ZXIuZGVzdHJveUZlYXR1cmVzKFt0aGlzLnJhZGl1c0hhbmRsZV0se3NpbGVudDohMH0pLHRoaXMucmFkaXVzSGFuZGxlPW51bGwpO3RoaXMuZmVhdHVyZSYmXCJPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50XCIhPXRoaXMuZmVhdHVyZS5nZW9tZXRyeS5DTEFTU19OQU1FJiYodGhpcy5tb2RlJlxuT3BlbkxheWVycy5Db250cm9sLk1vZGlmeUZlYXR1cmUuRFJBRyYmdGhpcy5jb2xsZWN0RHJhZ0hhbmRsZSgpLHRoaXMubW9kZSYoT3BlbkxheWVycy5Db250cm9sLk1vZGlmeUZlYXR1cmUuUk9UQVRFfE9wZW5MYXllcnMuQ29udHJvbC5Nb2RpZnlGZWF0dXJlLlJFU0laRSkmJnRoaXMuY29sbGVjdFJhZGl1c0hhbmRsZSgpLHRoaXMubW9kZSZPcGVuTGF5ZXJzLkNvbnRyb2wuTW9kaWZ5RmVhdHVyZS5SRVNIQVBFJiYodGhpcy5tb2RlJk9wZW5MYXllcnMuQ29udHJvbC5Nb2RpZnlGZWF0dXJlLlJFU0laRXx8dGhpcy5jb2xsZWN0VmVydGljZXMoKSkpfSxoYW5kbGVLZXlwcmVzczpmdW5jdGlvbihhKXt2YXIgYj1hLmtleUNvZGU7aWYodGhpcy5mZWF0dXJlJiYtMSE9T3BlbkxheWVycy5VdGlsLmluZGV4T2YodGhpcy5kZWxldGVDb2RlcyxiKSYmKGI9dGhpcy5kcmFnQ29udHJvbC5mZWF0dXJlKSYmLTEhPU9wZW5MYXllcnMuVXRpbC5pbmRleE9mKHRoaXMudmVydGljZXMsYikmJiF0aGlzLmRyYWdDb250cm9sLmhhbmRsZXJzLmRyYWcuZHJhZ2dpbmcmJlxuYi5nZW9tZXRyeS5wYXJlbnQpYi5nZW9tZXRyeS5wYXJlbnQucmVtb3ZlQ29tcG9uZW50KGIuZ2VvbWV0cnkpLHRoaXMubGF5ZXIuZXZlbnRzLnRyaWdnZXJFdmVudChcInZlcnRleHJlbW92ZWRcIix7dmVydGV4OmIuZ2VvbWV0cnksZmVhdHVyZTp0aGlzLmZlYXR1cmUscGl4ZWw6YS54eX0pLHRoaXMubGF5ZXIuZHJhd0ZlYXR1cmUodGhpcy5mZWF0dXJlLHRoaXMuc3RhbmRhbG9uZT92b2lkIDA6dGhpcy5zZWxlY3RDb250cm9sLnJlbmRlckludGVudCksdGhpcy5tb2RpZmllZD0hMCx0aGlzLnJlc2V0VmVydGljZXMoKSx0aGlzLnNldEZlYXR1cmVTdGF0ZSgpLHRoaXMub25Nb2RpZmljYXRpb24odGhpcy5mZWF0dXJlKSx0aGlzLmxheWVyLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJmZWF0dXJlbW9kaWZpZWRcIix7ZmVhdHVyZTp0aGlzLmZlYXR1cmV9KX0sY29sbGVjdFZlcnRpY2VzOmZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjKXt2YXIgZCxlLGY7aWYoXCJPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50XCI9PVxuYy5DTEFTU19OQU1FKWU9bmV3IE9wZW5MYXllcnMuRmVhdHVyZS5WZWN0b3IoYyksZS5fc2tldGNoPSEwLGUucmVuZGVySW50ZW50PWIudmVydGV4UmVuZGVySW50ZW50LGIudmVydGljZXMucHVzaChlKTtlbHNle2Y9Yy5jb21wb25lbnRzLmxlbmd0aDtcIk9wZW5MYXllcnMuR2VvbWV0cnkuTGluZWFyUmluZ1wiPT1jLkNMQVNTX05BTUUmJihmLT0xKTtmb3IoZD0wO2Q8ZjsrK2QpZT1jLmNvbXBvbmVudHNbZF0sXCJPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50XCI9PWUuQ0xBU1NfTkFNRT8oZT1uZXcgT3BlbkxheWVycy5GZWF0dXJlLlZlY3RvcihlKSxlLl9za2V0Y2g9ITAsZS5yZW5kZXJJbnRlbnQ9Yi52ZXJ0ZXhSZW5kZXJJbnRlbnQsYi52ZXJ0aWNlcy5wdXNoKGUpKTphKGUpO2lmKGIuY3JlYXRlVmVydGljZXMmJlwiT3BlbkxheWVycy5HZW9tZXRyeS5NdWx0aVBvaW50XCIhPWMuQ0xBU1NfTkFNRSl7ZD0wO2ZvcihmPWMuY29tcG9uZW50cy5sZW5ndGg7ZDxmLTE7KytkKXtlPWMuY29tcG9uZW50c1tkXTtcbnZhciBnPWMuY29tcG9uZW50c1tkKzFdO1wiT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludFwiPT1lLkNMQVNTX05BTUUmJlwiT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludFwiPT1nLkNMQVNTX05BTUUmJihlPW5ldyBPcGVuTGF5ZXJzLkZlYXR1cmUuVmVjdG9yKG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KChlLngrZy54KS8yLChlLnkrZy55KS8yKSxudWxsLGIudmlydHVhbFN0eWxlKSxlLmdlb21ldHJ5LnBhcmVudD1jLGUuX2luZGV4PWQrMSxlLl9za2V0Y2g9ITAsYi52aXJ0dWFsVmVydGljZXMucHVzaChlKSl9fX19dGhpcy52ZXJ0aWNlcz1bXTt0aGlzLnZpcnR1YWxWZXJ0aWNlcz1bXTt2YXIgYj10aGlzO2EuY2FsbCh0aGlzLHRoaXMuZmVhdHVyZS5nZW9tZXRyeSk7dGhpcy5sYXllci5hZGRGZWF0dXJlcyh0aGlzLnZpcnR1YWxWZXJ0aWNlcyx7c2lsZW50OiEwfSk7dGhpcy5sYXllci5hZGRGZWF0dXJlcyh0aGlzLnZlcnRpY2VzLHtzaWxlbnQ6ITB9KX0sY29sbGVjdERyYWdIYW5kbGU6ZnVuY3Rpb24oKXt2YXIgYT1cbnRoaXMuZmVhdHVyZS5nZW9tZXRyeSxiPWEuZ2V0Qm91bmRzKCkuZ2V0Q2VudGVyTG9uTGF0KCksYj1uZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChiLmxvbixiLmxhdCksYz1uZXcgT3BlbkxheWVycy5GZWF0dXJlLlZlY3RvcihiKTtiLm1vdmU9ZnVuY3Rpb24oYixjKXtPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50LnByb3RvdHlwZS5tb3ZlLmNhbGwodGhpcyxiLGMpO2EubW92ZShiLGMpfTtjLl9za2V0Y2g9ITA7dGhpcy5kcmFnSGFuZGxlPWM7dGhpcy5kcmFnSGFuZGxlLnJlbmRlckludGVudD10aGlzLnZlcnRleFJlbmRlckludGVudDt0aGlzLmxheWVyLmFkZEZlYXR1cmVzKFt0aGlzLmRyYWdIYW5kbGVdLHtzaWxlbnQ6ITB9KX0sY29sbGVjdFJhZGl1c0hhbmRsZTpmdW5jdGlvbigpe3ZhciBhPXRoaXMuZmVhdHVyZS5nZW9tZXRyeSxiPWEuZ2V0Qm91bmRzKCksYz1iLmdldENlbnRlckxvbkxhdCgpLGQ9bmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQoYy5sb24sYy5sYXQpLFxuYj1uZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChiLnJpZ2h0LGIuYm90dG9tKSxjPW5ldyBPcGVuTGF5ZXJzLkZlYXR1cmUuVmVjdG9yKGIpLGU9dGhpcy5tb2RlJk9wZW5MYXllcnMuQ29udHJvbC5Nb2RpZnlGZWF0dXJlLlJFU0laRSxmPXRoaXMubW9kZSZPcGVuTGF5ZXJzLkNvbnRyb2wuTW9kaWZ5RmVhdHVyZS5SRVNIQVBFLGc9dGhpcy5tb2RlJk9wZW5MYXllcnMuQ29udHJvbC5Nb2RpZnlGZWF0dXJlLlJPVEFURTtiLm1vdmU9ZnVuY3Rpb24oYixjKXtPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50LnByb3RvdHlwZS5tb3ZlLmNhbGwodGhpcyxiLGMpO3ZhciBqPXRoaXMueC1kLngsaz10aGlzLnktZC55LGw9ai1iLG09ay1jO2lmKGcpe3ZhciBuPU1hdGguYXRhbjIobSxsKSxuPU1hdGguYXRhbjIoayxqKS1uLG49biooMTgwL01hdGguUEkpO2Eucm90YXRlKG4sZCl9aWYoZSl7dmFyIG87Zj8oay89bSxvPWovbC9rKToobD1NYXRoLnNxcnQobCpsK20qbSksaz1NYXRoLnNxcnQoaipcbmorayprKS9sKTthLnJlc2l6ZShrLGQsbyl9fTtjLl9za2V0Y2g9ITA7dGhpcy5yYWRpdXNIYW5kbGU9Yzt0aGlzLnJhZGl1c0hhbmRsZS5yZW5kZXJJbnRlbnQ9dGhpcy52ZXJ0ZXhSZW5kZXJJbnRlbnQ7dGhpcy5sYXllci5hZGRGZWF0dXJlcyhbdGhpcy5yYWRpdXNIYW5kbGVdLHtzaWxlbnQ6ITB9KX0sc2V0TWFwOmZ1bmN0aW9uKGEpe3RoaXMuc3RhbmRhbG9uZXx8dGhpcy5zZWxlY3RDb250cm9sLnNldE1hcChhKTt0aGlzLmRyYWdDb250cm9sLnNldE1hcChhKTtPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLnNldE1hcC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkNvbnRyb2wuTW9kaWZ5RmVhdHVyZVwifSk7T3BlbkxheWVycy5Db250cm9sLk1vZGlmeUZlYXR1cmUuUkVTSEFQRT0xO09wZW5MYXllcnMuQ29udHJvbC5Nb2RpZnlGZWF0dXJlLlJFU0laRT0yO09wZW5MYXllcnMuQ29udHJvbC5Nb2RpZnlGZWF0dXJlLlJPVEFURT00O1xuT3BlbkxheWVycy5Db250cm9sLk1vZGlmeUZlYXR1cmUuRFJBRz04O09wZW5MYXllcnMuTGF5ZXIuQmluZz1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuTGF5ZXIuWFlaLHtrZXk6bnVsbCxzZXJ2ZXJSZXNvbHV0aW9uczpbMTU2NTQzLjAzMzkwNjI1LDc4MjcxLjUxNjk1MzEyNSwzOTEzNS43NTg0NzY1NjI1LDE5NTY3Ljg3OTIzODI4MTI1LDk3ODMuOTM5NjE5MTQwNjI1LDQ4OTEuOTY5ODA5NTcwMzEyNSwyNDQ1Ljk4NDkwNDc4NTE1NjIsMTIyMi45OTI0NTIzOTI1NzgxLDYxMS40OTYyMjYxOTYyODkxLDMwNS43NDgxMTMwOTgxNDQ1MywxNTIuODc0MDU2NTQ5MDcyMjYsNzYuNDM3MDI4Mjc0NTM2MTMsMzguMjE4NTE0MTM3MjY4MDY2LDE5LjEwOTI1NzA2ODYzNDAzMyw5LjU1NDYyODUzNDMxNzAxNyw0Ljc3NzMxNDI2NzE1ODUwOCwyLjM4ODY1NzEzMzU3OTI1NCwxLjE5NDMyODU2Njc4OTYyNywwLjU5NzE2NDI4MzM5NDgxMzUsMC4yOTg1ODIxNDE2OTc0MDY3NywwLjE0OTI5MTA3MDg0ODcwMzM4LDAuMDc0NjQ1NTM1NDI0MzUxNjldLGF0dHJpYnV0aW9uVGVtcGxhdGU6JzxzcGFuIGNsYXNzPVwib2xCaW5nQXR0cmlidXRpb24gJHt0eXBlfVwiPjxkaXY+PGEgdGFyZ2V0PVwiX2JsYW5rXCIgaHJlZj1cImh0dHA6Ly93d3cuYmluZy5jb20vbWFwcy9cIj48aW1nIHNyYz1cIiR7bG9nb31cIiAvPjwvYT48L2Rpdj4ke2NvcHlyaWdodHN9PGEgc3R5bGU9XCJ3aGl0ZS1zcGFjZTogbm93cmFwXCIgdGFyZ2V0PVwiX2JsYW5rXCIgaHJlZj1cImh0dHA6Ly93d3cubWljcm9zb2Z0LmNvbS9tYXBzL3Byb2R1Y3QvdGVybXMuaHRtbFwiPlRlcm1zIG9mIFVzZTwvYT48L3NwYW4+Jyxcbm1ldGFkYXRhOm51bGwsdHlwZTpcIlJvYWRcIixjdWx0dXJlOlwiZW4tVVNcIixtZXRhZGF0YVBhcmFtczpudWxsLHRpbGVPcHRpb25zOm51bGwsaW5pdGlhbGl6ZTpmdW5jdGlvbihhKXthPU9wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKHtzcGhlcmljYWxNZXJjYXRvcjohMH0sYSk7T3BlbkxheWVycy5MYXllci5YWVoucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbYS5uYW1lfHxcIkJpbmcgXCIrKGEudHlwZXx8dGhpcy50eXBlKSxudWxsLGFdKTt0aGlzLnRpbGVPcHRpb25zPU9wZW5MYXllcnMuVXRpbC5leHRlbmQoe2Nyb3NzT3JpZ2luS2V5d29yZDpcImFub255bW91c1wifSx0aGlzLm9wdGlvbnMudGlsZU9wdGlvbnMpO3RoaXMubG9hZE1ldGFkYXRhKCl9LGxvYWRNZXRhZGF0YTpmdW5jdGlvbigpe3RoaXMuX2NhbGxiYWNrSWQ9XCJfY2FsbGJhY2tfXCIrdGhpcy5pZC5yZXBsYWNlKC9cXC4vZyxcIl9cIik7d2luZG93W3RoaXMuX2NhbGxiYWNrSWRdPU9wZW5MYXllcnMuRnVuY3Rpb24uYmluZChPcGVuTGF5ZXJzLkxheWVyLkJpbmcucHJvY2Vzc01ldGFkYXRhLFxudGhpcyk7dmFyIGE9T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoe2tleTp0aGlzLmtleSxqc29ucDp0aGlzLl9jYWxsYmFja0lkLGluY2x1ZGU6XCJJbWFnZXJ5UHJvdmlkZXJzXCJ9LHRoaXMubWV0YWRhdGFQYXJhbXMpLGE9XCJodHRwOi8vZGV2LnZpcnR1YWxlYXJ0aC5uZXQvUkVTVC92MS9JbWFnZXJ5L01ldGFkYXRhL1wiK3RoaXMudHlwZStcIj9cIitPcGVuTGF5ZXJzLlV0aWwuZ2V0UGFyYW1ldGVyU3RyaW5nKGEpLGI9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKTtiLnR5cGU9XCJ0ZXh0L2phdmFzY3JpcHRcIjtiLnNyYz1hO2IuaWQ9dGhpcy5fY2FsbGJhY2tJZDtkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImhlYWRcIilbMF0uYXBwZW5kQ2hpbGQoYil9LGluaXRMYXllcjpmdW5jdGlvbigpe3ZhciBhPXRoaXMubWV0YWRhdGEucmVzb3VyY2VTZXRzWzBdLnJlc291cmNlc1swXSxiPWEuaW1hZ2VVcmwucmVwbGFjZShcIntxdWFka2V5fVwiLFwiJHtxdWFka2V5fVwiKSxcbmI9Yi5yZXBsYWNlKFwie2N1bHR1cmV9XCIsdGhpcy5jdWx0dXJlKTt0aGlzLnVybD1bXTtmb3IodmFyIGM9MDtjPGEuaW1hZ2VVcmxTdWJkb21haW5zLmxlbmd0aDsrK2MpdGhpcy51cmwucHVzaChiLnJlcGxhY2UoXCJ7c3ViZG9tYWlufVwiLGEuaW1hZ2VVcmxTdWJkb21haW5zW2NdKSk7dGhpcy5hZGRPcHRpb25zKHttYXhSZXNvbHV0aW9uOk1hdGgubWluKHRoaXMuc2VydmVyUmVzb2x1dGlvbnNbYS56b29tTWluXSx0aGlzLm1heFJlc29sdXRpb258fE51bWJlci5QT1NJVElWRV9JTkZJTklUWSksbnVtWm9vbUxldmVsczpNYXRoLm1pbihhLnpvb21NYXgrMS1hLnpvb21NaW4sdGhpcy5udW1ab29tTGV2ZWxzKX0sITApfSxnZXRVUkw6ZnVuY3Rpb24oYSl7aWYodGhpcy51cmwpe2Zvcih2YXIgYj10aGlzLmdldFhZWihhKSxhPWIueCxjPWIueSxiPWIueixkPVtdLGU9YjswPGU7LS1lKXt2YXIgZj1cIjBcIixnPTE8PGUtMTswIT0oYSZnKSYmZisrOzAhPShjJmcpJiYoZisrLGYrKyk7ZC5wdXNoKGYpfWQ9XG5kLmpvaW4oXCJcIik7YT10aGlzLnNlbGVjdFVybChcIlwiK2ErYytiLHRoaXMudXJsKTtyZXR1cm4gT3BlbkxheWVycy5TdHJpbmcuZm9ybWF0KGEse3F1YWRrZXk6ZH0pfX0sdXBkYXRlQXR0cmlidXRpb246ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm1ldGFkYXRhO2lmKGEucmVzb3VyY2VTZXRzJiZ0aGlzLm1hcCYmdGhpcy5tYXAuY2VudGVyKXt2YXIgYj1hLnJlc291cmNlU2V0c1swXS5yZXNvdXJjZXNbMF0sYz10aGlzLm1hcC5nZXRFeHRlbnQoKS50cmFuc2Zvcm0odGhpcy5tYXAuZ2V0UHJvamVjdGlvbk9iamVjdCgpLG5ldyBPcGVuTGF5ZXJzLlByb2plY3Rpb24oXCJFUFNHOjQzMjZcIikpLGI9Yi5pbWFnZXJ5UHJvdmlkZXJzLGQ9T3BlbkxheWVycy5VdGlsLmluZGV4T2YodGhpcy5zZXJ2ZXJSZXNvbHV0aW9ucyx0aGlzLmdldFNlcnZlclJlc29sdXRpb24oKSksZT1cIlwiLGYsZyxoLGksaixrLGw7Zz0wO2ZvcihoPWIubGVuZ3RoO2c8aDsrK2cpe2Y9YltnXTtpPTA7Zm9yKGo9Zi5jb3ZlcmFnZUFyZWFzLmxlbmd0aDtpPFxuajsrK2kpbD1mLmNvdmVyYWdlQXJlYXNbaV0saz1PcGVuTGF5ZXJzLkJvdW5kcy5mcm9tQXJyYXkobC5iYm94LCEwKSxjLmludGVyc2VjdHNCb3VuZHMoaykmJihkPD1sLnpvb21NYXgmJmQ+PWwuem9vbU1pbikmJihlKz1mLmF0dHJpYnV0aW9uK1wiIFwiKX10aGlzLmF0dHJpYnV0aW9uPU9wZW5MYXllcnMuU3RyaW5nLmZvcm1hdCh0aGlzLmF0dHJpYnV0aW9uVGVtcGxhdGUse3R5cGU6dGhpcy50eXBlLnRvTG93ZXJDYXNlKCksbG9nbzphLmJyYW5kTG9nb1VyaSxjb3B5cmlnaHRzOmV9KTt0aGlzLm1hcCYmdGhpcy5tYXAuZXZlbnRzLnRyaWdnZXJFdmVudChcImNoYW5nZWxheWVyXCIse2xheWVyOnRoaXMscHJvcGVydHk6XCJhdHRyaWJ1dGlvblwifSl9fSxzZXRNYXA6ZnVuY3Rpb24oKXtPcGVuTGF5ZXJzLkxheWVyLlhZWi5wcm90b3R5cGUuc2V0TWFwLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLnVwZGF0ZUF0dHJpYnV0aW9uKCk7dGhpcy5tYXAuZXZlbnRzLnJlZ2lzdGVyKFwibW92ZWVuZFwiLFxudGhpcyx0aGlzLnVwZGF0ZUF0dHJpYnV0aW9uKX0sY2xvbmU6ZnVuY3Rpb24oYSl7bnVsbD09YSYmKGE9bmV3IE9wZW5MYXllcnMuTGF5ZXIuQmluZyh0aGlzLm9wdGlvbnMpKTtyZXR1cm4gYT1PcGVuTGF5ZXJzLkxheWVyLlhZWi5wcm90b3R5cGUuY2xvbmUuYXBwbHkodGhpcyxbYV0pfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5tYXAmJnRoaXMubWFwLmV2ZW50cy51bnJlZ2lzdGVyKFwibW92ZWVuZFwiLHRoaXMsdGhpcy51cGRhdGVBdHRyaWJ1dGlvbik7T3BlbkxheWVycy5MYXllci5YWVoucHJvdG90eXBlLmRlc3Ryb3kuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5MYXllci5CaW5nXCJ9KTtcbk9wZW5MYXllcnMuTGF5ZXIuQmluZy5wcm9jZXNzTWV0YWRhdGE9ZnVuY3Rpb24oYSl7dGhpcy5tZXRhZGF0YT1hO3RoaXMuaW5pdExheWVyKCk7YT1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLl9jYWxsYmFja0lkKTthLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoYSk7d2luZG93W3RoaXMuX2NhbGxiYWNrSWRdPXZvaWQgMDtkZWxldGUgdGhpcy5fY2FsbGJhY2tJZH07T3BlbkxheWVycy5MYXllci5Qb2ludEdyaWQ9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkxheWVyLlZlY3Rvcix7ZHg6bnVsbCxkeTpudWxsLHJhdGlvOjEuNSxtYXhGZWF0dXJlczoyNTAscm90YXRpb246MCxvcmlnaW46bnVsbCxncmlkQm91bmRzOm51bGwsaW5pdGlhbGl6ZTpmdW5jdGlvbihhKXthPWF8fHt9O09wZW5MYXllcnMuTGF5ZXIuVmVjdG9yLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsW2EubmFtZSxhXSl9LHNldE1hcDpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLkxheWVyLlZlY3Rvci5wcm90b3R5cGUuc2V0TWFwLmFwcGx5KHRoaXMsYXJndW1lbnRzKTthLmV2ZW50cy5yZWdpc3RlcihcIm1vdmVlbmRcIix0aGlzLHRoaXMub25Nb3ZlRW5kKX0scmVtb3ZlTWFwOmZ1bmN0aW9uKGEpe2EuZXZlbnRzLnVucmVnaXN0ZXIoXCJtb3ZlZW5kXCIsdGhpcyx0aGlzLm9uTW92ZUVuZCk7T3BlbkxheWVycy5MYXllci5WZWN0b3IucHJvdG90eXBlLnJlbW92ZU1hcC5hcHBseSh0aGlzLFxuYXJndW1lbnRzKX0sc2V0UmF0aW86ZnVuY3Rpb24oYSl7dGhpcy5yYXRpbz1hO3RoaXMudXBkYXRlR3JpZCghMCl9LHNldE1heEZlYXR1cmVzOmZ1bmN0aW9uKGEpe3RoaXMubWF4RmVhdHVyZXM9YTt0aGlzLnVwZGF0ZUdyaWQoITApfSxzZXRTcGFjaW5nOmZ1bmN0aW9uKGEsYil7dGhpcy5keD1hO3RoaXMuZHk9Ynx8YTt0aGlzLnVwZGF0ZUdyaWQoITApfSxzZXRPcmlnaW46ZnVuY3Rpb24oYSl7dGhpcy5vcmlnaW49YTt0aGlzLnVwZGF0ZUdyaWQoITApfSxnZXRPcmlnaW46ZnVuY3Rpb24oKXt0aGlzLm9yaWdpbnx8KHRoaXMub3JpZ2luPXRoaXMubWFwLmdldEV4dGVudCgpLmdldENlbnRlckxvbkxhdCgpKTtyZXR1cm4gdGhpcy5vcmlnaW59LHNldFJvdGF0aW9uOmZ1bmN0aW9uKGEpe3RoaXMucm90YXRpb249YTt0aGlzLnVwZGF0ZUdyaWQoITApfSxvbk1vdmVFbmQ6ZnVuY3Rpb24oKXt0aGlzLnVwZGF0ZUdyaWQoKX0sZ2V0Vmlld0JvdW5kczpmdW5jdGlvbigpe3ZhciBhPXRoaXMubWFwLmdldEV4dGVudCgpO1xuaWYodGhpcy5yb3RhdGlvbil7dmFyIGI9dGhpcy5nZXRPcmlnaW4oKSxiPW5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGIubG9uLGIubGF0KSxhPWEudG9HZW9tZXRyeSgpO2Eucm90YXRlKC10aGlzLnJvdGF0aW9uLGIpO2E9YS5nZXRCb3VuZHMoKX1yZXR1cm4gYX0sdXBkYXRlR3JpZDpmdW5jdGlvbihhKXtpZihhfHx0aGlzLmludmFsaWRCb3VuZHMoKSl7dmFyIGI9dGhpcy5nZXRWaWV3Qm91bmRzKCksYz10aGlzLmdldE9yaWdpbigpLGE9bmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQoYy5sb24sYy5sYXQpLGQ9Yi5nZXRXaWR0aCgpLGU9Yi5nZXRIZWlnaHQoKSxmPWQvZSxnPU1hdGguc3FydCh0aGlzLmR4KnRoaXMuZHkqdGhpcy5tYXhGZWF0dXJlcy9mKSxkPU1hdGgubWluKGQqdGhpcy5yYXRpbyxnKmYpLGU9TWF0aC5taW4oZSp0aGlzLnJhdGlvLGcpLGI9Yi5nZXRDZW50ZXJMb25MYXQoKTt0aGlzLmdyaWRCb3VuZHM9bmV3IE9wZW5MYXllcnMuQm91bmRzKGIubG9uLVxuZC8yLGIubGF0LWUvMixiLmxvbitkLzIsYi5sYXQrZS8yKTtmb3IodmFyIGI9TWF0aC5mbG9vcihlL3RoaXMuZHkpLGQ9TWF0aC5mbG9vcihkL3RoaXMuZHgpLGU9Yy5sb24rdGhpcy5keCpNYXRoLmNlaWwoKHRoaXMuZ3JpZEJvdW5kcy5sZWZ0LWMubG9uKS90aGlzLmR4KSxjPWMubGF0K3RoaXMuZHkqTWF0aC5jZWlsKCh0aGlzLmdyaWRCb3VuZHMuYm90dG9tLWMubGF0KS90aGlzLmR5KSxnPUFycmF5KGIqZCksaCxpPTA7aTxkOysraSlmb3IodmFyIGY9ZStpKnRoaXMuZHgsaj0wO2o8YjsrK2opaD1jK2oqdGhpcy5keSxoPW5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGYsaCksdGhpcy5yb3RhdGlvbiYmaC5yb3RhdGUodGhpcy5yb3RhdGlvbixhKSxnW2kqYitqXT1uZXcgT3BlbkxheWVycy5GZWF0dXJlLlZlY3RvcihoKTt0aGlzLmRlc3Ryb3lGZWF0dXJlcyh0aGlzLmZlYXR1cmVzLHtzaWxlbnQ6ITB9KTt0aGlzLmFkZEZlYXR1cmVzKGcse3NpbGVudDohMH0pfX0saW52YWxpZEJvdW5kczpmdW5jdGlvbigpe3JldHVybiF0aGlzLmdyaWRCb3VuZHN8fFxuIXRoaXMuZ3JpZEJvdW5kcy5jb250YWluc0JvdW5kcyh0aGlzLmdldFZpZXdCb3VuZHMoKSl9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkxheWVyLlBvaW50R3JpZFwifSk7T3BlbkxheWVycy5IYW5kbGVyLk1vdXNlV2hlZWw9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkhhbmRsZXIse3doZWVsTGlzdGVuZXI6bnVsbCxtb3VzZVBvc2l0aW9uOm51bGwsaW50ZXJ2YWw6MCxkZWx0YTowLGN1bXVsYXRpdmU6ITAsaW5pdGlhbGl6ZTpmdW5jdGlvbihhLGIsYyl7T3BlbkxheWVycy5IYW5kbGVyLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLndoZWVsTGlzdGVuZXI9T3BlbkxheWVycy5GdW5jdGlvbi5iaW5kQXNFdmVudExpc3RlbmVyKHRoaXMub25XaGVlbEV2ZW50LHRoaXMpfSxkZXN0cm95OmZ1bmN0aW9uKCl7T3BlbkxheWVycy5IYW5kbGVyLnByb3RvdHlwZS5kZXN0cm95LmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLndoZWVsTGlzdGVuZXI9bnVsbH0sb25XaGVlbEV2ZW50OmZ1bmN0aW9uKGEpe2lmKHRoaXMubWFwJiZ0aGlzLmNoZWNrTW9kaWZpZXJzKGEpKXtmb3IodmFyIGI9ITEsYz0hMSxkPSExLGU9XG5PcGVuTGF5ZXJzLkV2ZW50LmVsZW1lbnQoYSk7bnVsbCE9ZSYmIWQmJiFiOyl7aWYoIWIpdHJ5e3ZhciBmPWUuY3VycmVudFN0eWxlP2UuY3VycmVudFN0eWxlLm92ZXJmbG93OmRvY3VtZW50LmRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGUoZSxudWxsKS5nZXRQcm9wZXJ0eVZhbHVlKFwib3ZlcmZsb3dcIiksYj1mJiZcImF1dG9cIj09Znx8XCJzY3JvbGxcIj09Zn1jYXRjaChnKXt9aWYoIWMpZm9yKHZhciBkPTAsaD10aGlzLm1hcC5sYXllcnMubGVuZ3RoO2Q8aDtkKyspaWYoZT09dGhpcy5tYXAubGF5ZXJzW2RdLmRpdnx8ZT09dGhpcy5tYXAubGF5ZXJzW2RdLnBhbmUpe2M9ITA7YnJlYWt9ZD1lPT10aGlzLm1hcC5kaXY7ZT1lLnBhcmVudE5vZGV9IWImJmQmJihjJiYoKGI9MCxhfHwoYT13aW5kb3cuZXZlbnQpLGEud2hlZWxEZWx0YT8oYj1hLndoZWVsRGVsdGEvMTIwLHdpbmRvdy5vcGVyYSYmOS4yPndpbmRvdy5vcGVyYS52ZXJzaW9uKCkmJihiPS1iKSk6YS5kZXRhaWwmJihiPS1hLmRldGFpbC9cbjMpLHRoaXMuZGVsdGErPWIsdGhpcy5pbnRlcnZhbCk/KHdpbmRvdy5jbGVhclRpbWVvdXQodGhpcy5fdGltZW91dElkKSx0aGlzLl90aW1lb3V0SWQ9d2luZG93LnNldFRpbWVvdXQoT3BlbkxheWVycy5GdW5jdGlvbi5iaW5kKGZ1bmN0aW9uKCl7dGhpcy53aGVlbFpvb20oYSl9LHRoaXMpLHRoaXMuaW50ZXJ2YWwpKTp0aGlzLndoZWVsWm9vbShhKSksT3BlbkxheWVycy5FdmVudC5zdG9wKGEpKX19LHdoZWVsWm9vbTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmRlbHRhO3RoaXMuZGVsdGE9MDtiJiYodGhpcy5tb3VzZVBvc2l0aW9uJiYoYS54eT10aGlzLm1vdXNlUG9zaXRpb24pLGEueHl8fChhLnh5PXRoaXMubWFwLmdldFBpeGVsRnJvbUxvbkxhdCh0aGlzLm1hcC5nZXRDZW50ZXIoKSkpLDA+Yj90aGlzLmNhbGxiYWNrKFwiZG93blwiLFthLHRoaXMuY3VtdWxhdGl2ZT9iOi0xXSk6dGhpcy5jYWxsYmFjayhcInVwXCIsW2EsdGhpcy5jdW11bGF0aXZlP2I6MV0pKX0sbW91c2Vtb3ZlOmZ1bmN0aW9uKGEpe3RoaXMubW91c2VQb3NpdGlvbj1cbmEueHl9LGFjdGl2YXRlOmZ1bmN0aW9uKGEpe2lmKE9wZW5MYXllcnMuSGFuZGxlci5wcm90b3R5cGUuYWN0aXZhdGUuYXBwbHkodGhpcyxhcmd1bWVudHMpKXt2YXIgYj10aGlzLndoZWVsTGlzdGVuZXI7T3BlbkxheWVycy5FdmVudC5vYnNlcnZlKHdpbmRvdyxcIkRPTU1vdXNlU2Nyb2xsXCIsYik7T3BlbkxheWVycy5FdmVudC5vYnNlcnZlKHdpbmRvdyxcIm1vdXNld2hlZWxcIixiKTtPcGVuTGF5ZXJzLkV2ZW50Lm9ic2VydmUoZG9jdW1lbnQsXCJtb3VzZXdoZWVsXCIsYik7cmV0dXJuITB9cmV0dXJuITF9LGRlYWN0aXZhdGU6ZnVuY3Rpb24oYSl7aWYoT3BlbkxheWVycy5IYW5kbGVyLnByb3RvdHlwZS5kZWFjdGl2YXRlLmFwcGx5KHRoaXMsYXJndW1lbnRzKSl7dmFyIGI9dGhpcy53aGVlbExpc3RlbmVyO09wZW5MYXllcnMuRXZlbnQuc3RvcE9ic2VydmluZyh3aW5kb3csXCJET01Nb3VzZVNjcm9sbFwiLGIpO09wZW5MYXllcnMuRXZlbnQuc3RvcE9ic2VydmluZyh3aW5kb3csXCJtb3VzZXdoZWVsXCIsXG5iKTtPcGVuTGF5ZXJzLkV2ZW50LnN0b3BPYnNlcnZpbmcoZG9jdW1lbnQsXCJtb3VzZXdoZWVsXCIsYik7cmV0dXJuITB9cmV0dXJuITF9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkhhbmRsZXIuTW91c2VXaGVlbFwifSk7T3BlbkxheWVycy5TeW1ib2xpemVyPU9wZW5MYXllcnMuQ2xhc3Moe3pJbmRleDowLGluaXRpYWxpemU6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5VdGlsLmV4dGVuZCh0aGlzLGEpfSxjbG9uZTpmdW5jdGlvbigpe3JldHVybiBuZXcgKGV2YWwodGhpcy5DTEFTU19OQU1FKSkoT3BlbkxheWVycy5VdGlsLmV4dGVuZCh7fSx0aGlzKSl9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLlN5bWJvbGl6ZXJcIn0pO09wZW5MYXllcnMuU3ltYm9saXplci5SYXN0ZXI9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLlN5bWJvbGl6ZXIse2luaXRpYWxpemU6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5TeW1ib2xpemVyLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuU3ltYm9saXplci5SYXN0ZXJcIn0pO09wZW5MYXllcnMuUnVsZT1PcGVuTGF5ZXJzLkNsYXNzKHtpZDpudWxsLG5hbWU6bnVsbCx0aXRsZTpudWxsLGRlc2NyaXB0aW9uOm51bGwsY29udGV4dDpudWxsLGZpbHRlcjpudWxsLGVsc2VGaWx0ZXI6ITEsc3ltYm9saXplcjpudWxsLHN5bWJvbGl6ZXJzOm51bGwsbWluU2NhbGVEZW5vbWluYXRvcjpudWxsLG1heFNjYWxlRGVub21pbmF0b3I6bnVsbCxpbml0aWFsaXplOmZ1bmN0aW9uKGEpe3RoaXMuc3ltYm9saXplcj17fTtPcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHRoaXMsYSk7dGhpcy5zeW1ib2xpemVycyYmZGVsZXRlIHRoaXMuc3ltYm9saXplcjt0aGlzLmlkPU9wZW5MYXllcnMuVXRpbC5jcmVhdGVVbmlxdWVJRCh0aGlzLkNMQVNTX05BTUUrXCJfXCIpfSxkZXN0cm95OmZ1bmN0aW9uKCl7Zm9yKHZhciBhIGluIHRoaXMuc3ltYm9saXplcil0aGlzLnN5bWJvbGl6ZXJbYV09bnVsbDt0aGlzLnN5bWJvbGl6ZXI9bnVsbDtkZWxldGUgdGhpcy5zeW1ib2xpemVyc30sZXZhbHVhdGU6ZnVuY3Rpb24oYSl7dmFyIGI9XG50aGlzLmdldENvbnRleHQoYSksYz0hMDtpZih0aGlzLm1pblNjYWxlRGVub21pbmF0b3J8fHRoaXMubWF4U2NhbGVEZW5vbWluYXRvcil2YXIgZD1hLmxheWVyLm1hcC5nZXRTY2FsZSgpO3RoaXMubWluU2NhbGVEZW5vbWluYXRvciYmKGM9ZD49T3BlbkxheWVycy5TdHlsZS5jcmVhdGVMaXRlcmFsKHRoaXMubWluU2NhbGVEZW5vbWluYXRvcixiKSk7YyYmdGhpcy5tYXhTY2FsZURlbm9taW5hdG9yJiYoYz1kPE9wZW5MYXllcnMuU3R5bGUuY3JlYXRlTGl0ZXJhbCh0aGlzLm1heFNjYWxlRGVub21pbmF0b3IsYikpO2MmJnRoaXMuZmlsdGVyJiYoYz1cIk9wZW5MYXllcnMuRmlsdGVyLkZlYXR1cmVJZFwiPT10aGlzLmZpbHRlci5DTEFTU19OQU1FP3RoaXMuZmlsdGVyLmV2YWx1YXRlKGEpOnRoaXMuZmlsdGVyLmV2YWx1YXRlKGIpKTtyZXR1cm4gY30sZ2V0Q29udGV4dDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNvbnRleHQ7Ynx8KGI9YS5hdHRyaWJ1dGVzfHxhLmRhdGEpO1wiZnVuY3Rpb25cIj09XG50eXBlb2YgdGhpcy5jb250ZXh0JiYoYj10aGlzLmNvbnRleHQoYSkpO3JldHVybiBifSxjbG9uZTpmdW5jdGlvbigpe3ZhciBhPU9wZW5MYXllcnMuVXRpbC5leHRlbmQoe30sdGhpcyk7aWYodGhpcy5zeW1ib2xpemVycyl7dmFyIGI9dGhpcy5zeW1ib2xpemVycy5sZW5ndGg7YS5zeW1ib2xpemVycz1BcnJheShiKTtmb3IodmFyIGM9MDtjPGI7KytjKWEuc3ltYm9saXplcnNbY109dGhpcy5zeW1ib2xpemVyc1tjXS5jbG9uZSgpfWVsc2V7YS5zeW1ib2xpemVyPXt9O2Zvcih2YXIgZCBpbiB0aGlzLnN5bWJvbGl6ZXIpYj10aGlzLnN5bWJvbGl6ZXJbZF0sYz10eXBlb2YgYixcIm9iamVjdFwiPT09Yz9hLnN5bWJvbGl6ZXJbZF09T3BlbkxheWVycy5VdGlsLmV4dGVuZCh7fSxiKTpcInN0cmluZ1wiPT09YyYmKGEuc3ltYm9saXplcltkXT1iKX1hLmZpbHRlcj10aGlzLmZpbHRlciYmdGhpcy5maWx0ZXIuY2xvbmUoKTthLmNvbnRleHQ9dGhpcy5jb250ZXh0JiZPcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHt9LFxudGhpcy5jb250ZXh0KTtyZXR1cm4gbmV3IE9wZW5MYXllcnMuUnVsZShhKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuUnVsZVwifSk7T3BlbkxheWVycy5GaWx0ZXIuU3BhdGlhbD1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuRmlsdGVyLHt0eXBlOm51bGwscHJvcGVydHk6bnVsbCx2YWx1ZTpudWxsLGRpc3RhbmNlOm51bGwsZGlzdGFuY2VVbml0czpudWxsLGV2YWx1YXRlOmZ1bmN0aW9uKGEpe3ZhciBiPSExO3N3aXRjaCh0aGlzLnR5cGUpe2Nhc2UgT3BlbkxheWVycy5GaWx0ZXIuU3BhdGlhbC5CQk9YOmNhc2UgT3BlbkxheWVycy5GaWx0ZXIuU3BhdGlhbC5JTlRFUlNFQ1RTOmlmKGEuZ2VvbWV0cnkpe3ZhciBjPXRoaXMudmFsdWU7XCJPcGVuTGF5ZXJzLkJvdW5kc1wiPT10aGlzLnZhbHVlLkNMQVNTX05BTUUmJihjPXRoaXMudmFsdWUudG9HZW9tZXRyeSgpKTthLmdlb21ldHJ5LmludGVyc2VjdHMoYykmJihiPSEwKX1icmVhaztkZWZhdWx0OnRocm93IEVycm9yKFwiZXZhbHVhdGUgaXMgbm90IGltcGxlbWVudGVkIGZvciB0aGlzIGZpbHRlciB0eXBlLlwiKTt9cmV0dXJuIGJ9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIGE9XG5PcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyh7dmFsdWU6dGhpcy52YWx1ZSYmdGhpcy52YWx1ZS5jbG9uZSYmdGhpcy52YWx1ZS5jbG9uZSgpfSx0aGlzKTtyZXR1cm4gbmV3IE9wZW5MYXllcnMuRmlsdGVyLlNwYXRpYWwoYSl9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZpbHRlci5TcGF0aWFsXCJ9KTtPcGVuTGF5ZXJzLkZpbHRlci5TcGF0aWFsLkJCT1g9XCJCQk9YXCI7T3BlbkxheWVycy5GaWx0ZXIuU3BhdGlhbC5JTlRFUlNFQ1RTPVwiSU5URVJTRUNUU1wiO09wZW5MYXllcnMuRmlsdGVyLlNwYXRpYWwuRFdJVEhJTj1cIkRXSVRISU5cIjtPcGVuTGF5ZXJzLkZpbHRlci5TcGF0aWFsLldJVEhJTj1cIldJVEhJTlwiO09wZW5MYXllcnMuRmlsdGVyLlNwYXRpYWwuQ09OVEFJTlM9XCJDT05UQUlOU1wiO09wZW5MYXllcnMuRm9ybWF0LlNMRD1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuRm9ybWF0LlhNTC5WZXJzaW9uZWRPR0Mse3Byb2ZpbGU6bnVsbCxkZWZhdWx0VmVyc2lvbjpcIjEuMC4wXCIsc3RyaW5naWZ5T3V0cHV0OiEwLG5hbWVkTGF5ZXJzQXNBcnJheTohMSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Gb3JtYXQuU0xEXCJ9KTtPcGVuTGF5ZXJzLlN5bWJvbGl6ZXIuUG9seWdvbj1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuU3ltYm9saXplcix7aW5pdGlhbGl6ZTpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLlN5bWJvbGl6ZXIucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5TeW1ib2xpemVyLlBvbHlnb25cIn0pO09wZW5MYXllcnMuRm9ybWF0LkdNTC52Mj1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuRm9ybWF0LkdNTC5CYXNlLHtzY2hlbWFMb2NhdGlvbjpcImh0dHA6Ly93d3cub3Blbmdpcy5uZXQvZ21sIGh0dHA6Ly9zY2hlbWFzLm9wZW5naXMubmV0L2dtbC8yLjEuMi9mZWF0dXJlLnhzZFwiLGluaXRpYWxpemU6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5Gb3JtYXQuR01MLkJhc2UucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbYV0pfSxyZWFkZXJzOntnbWw6T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoe291dGVyQm91bmRhcnlJczpmdW5jdGlvbihhLGIpe3ZhciBjPXt9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKTtiLm91dGVyPWMuY29tcG9uZW50c1swXX0saW5uZXJCb3VuZGFyeUlzOmZ1bmN0aW9uKGEsYil7dmFyIGM9e307dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpO2IuaW5uZXIucHVzaChjLmNvbXBvbmVudHNbMF0pfSxCb3g6ZnVuY3Rpb24oYSxiKXt2YXIgYz1cbnt9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKTtiLmNvbXBvbmVudHN8fChiLmNvbXBvbmVudHM9W10pO3ZhciBkPWMucG9pbnRzWzBdLGM9Yy5wb2ludHNbMV07Yi5jb21wb25lbnRzLnB1c2gobmV3IE9wZW5MYXllcnMuQm91bmRzKGQueCxkLnksYy54LGMueSkpfX0sT3BlbkxheWVycy5Gb3JtYXQuR01MLkJhc2UucHJvdG90eXBlLnJlYWRlcnMuZ21sKSxmZWF0dXJlOk9wZW5MYXllcnMuRm9ybWF0LkdNTC5CYXNlLnByb3RvdHlwZS5yZWFkZXJzLmZlYXR1cmUsd2ZzOk9wZW5MYXllcnMuRm9ybWF0LkdNTC5CYXNlLnByb3RvdHlwZS5yZWFkZXJzLndmc30sd3JpdGU6ZnVuY3Rpb24oYSl7YT10aGlzLndyaXRlTm9kZShPcGVuTGF5ZXJzLlV0aWwuaXNBcnJheShhKT9cIndmczpGZWF0dXJlQ29sbGVjdGlvblwiOlwiZ21sOmZlYXR1cmVNZW1iZXJcIixhKTt0aGlzLnNldEF0dHJpYnV0ZU5TKGEsdGhpcy5uYW1lc3BhY2VzLnhzaSxcInhzaTpzY2hlbWFMb2NhdGlvblwiLHRoaXMuc2NoZW1hTG9jYXRpb24pO1xucmV0dXJuIE9wZW5MYXllcnMuRm9ybWF0LlhNTC5wcm90b3R5cGUud3JpdGUuYXBwbHkodGhpcyxbYV0pfSx3cml0ZXJzOntnbWw6T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoe1BvaW50OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcImdtbDpQb2ludFwiKTt0aGlzLndyaXRlTm9kZShcImNvb3JkaW5hdGVzXCIsW2FdLGIpO3JldHVybiBifSxjb29yZGluYXRlczpmdW5jdGlvbihhKXtmb3IodmFyIGI9YS5sZW5ndGgsYz1BcnJheShiKSxkLGU9MDtlPGI7KytlKWQ9YVtlXSxjW2VdPXRoaXMueHk/ZC54K1wiLFwiK2QueTpkLnkrXCIsXCIrZC54LHZvaWQgMCE9ZC56JiYoY1tlXSs9XCIsXCIrZC56KTtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiZ21sOmNvb3JkaW5hdGVzXCIse2F0dHJpYnV0ZXM6e2RlY2ltYWw6XCIuXCIsY3M6XCIsXCIsdHM6XCIgXCJ9LHZhbHVlOjE9PWI/Y1swXTpjLmpvaW4oXCIgXCIpfSl9LExpbmVTdHJpbmc6ZnVuY3Rpb24oYSl7dmFyIGI9XG50aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJnbWw6TGluZVN0cmluZ1wiKTt0aGlzLndyaXRlTm9kZShcImNvb3JkaW5hdGVzXCIsYS5jb21wb25lbnRzLGIpO3JldHVybiBifSxQb2x5Z29uOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcImdtbDpQb2x5Z29uXCIpO3RoaXMud3JpdGVOb2RlKFwib3V0ZXJCb3VuZGFyeUlzXCIsYS5jb21wb25lbnRzWzBdLGIpO2Zvcih2YXIgYz0xO2M8YS5jb21wb25lbnRzLmxlbmd0aDsrK2MpdGhpcy53cml0ZU5vZGUoXCJpbm5lckJvdW5kYXJ5SXNcIixhLmNvbXBvbmVudHNbY10sYik7cmV0dXJuIGJ9LG91dGVyQm91bmRhcnlJczpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJnbWw6b3V0ZXJCb3VuZGFyeUlzXCIpO3RoaXMud3JpdGVOb2RlKFwiTGluZWFyUmluZ1wiLGEsYik7cmV0dXJuIGJ9LGlubmVyQm91bmRhcnlJczpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJnbWw6aW5uZXJCb3VuZGFyeUlzXCIpO1xudGhpcy53cml0ZU5vZGUoXCJMaW5lYXJSaW5nXCIsYSxiKTtyZXR1cm4gYn0sTGluZWFyUmluZzpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJnbWw6TGluZWFyUmluZ1wiKTt0aGlzLndyaXRlTm9kZShcImNvb3JkaW5hdGVzXCIsYS5jb21wb25lbnRzLGIpO3JldHVybiBifSxCb3g6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiZ21sOkJveFwiKTt0aGlzLndyaXRlTm9kZShcImNvb3JkaW5hdGVzXCIsW3t4OmEubGVmdCx5OmEuYm90dG9tfSx7eDphLnJpZ2h0LHk6YS50b3B9XSxiKTt0aGlzLnNyc05hbWUmJmIuc2V0QXR0cmlidXRlKFwic3JzTmFtZVwiLHRoaXMuc3JzTmFtZSk7cmV0dXJuIGJ9fSxPcGVuTGF5ZXJzLkZvcm1hdC5HTUwuQmFzZS5wcm90b3R5cGUud3JpdGVycy5nbWwpLGZlYXR1cmU6T3BlbkxheWVycy5Gb3JtYXQuR01MLkJhc2UucHJvdG90eXBlLndyaXRlcnMuZmVhdHVyZSx3ZnM6T3BlbkxheWVycy5Gb3JtYXQuR01MLkJhc2UucHJvdG90eXBlLndyaXRlcnMud2ZzfSxcbkNMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZvcm1hdC5HTUwudjJcIn0pO09wZW5MYXllcnMuRm9ybWF0LkZpbHRlci52MV8wXzA9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkZvcm1hdC5HTUwudjIsT3BlbkxheWVycy5Gb3JtYXQuRmlsdGVyLnYxLHtWRVJTSU9OOlwiMS4wLjBcIixzY2hlbWFMb2NhdGlvbjpcImh0dHA6Ly93d3cub3Blbmdpcy5uZXQvb2djL2ZpbHRlci8xLjAuMC9maWx0ZXIueHNkXCIsaW5pdGlhbGl6ZTpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLkZvcm1hdC5HTUwudjIucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbYV0pfSxyZWFkZXJzOntvZ2M6T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoe1Byb3BlcnR5SXNFcXVhbFRvOmZ1bmN0aW9uKGEsYil7dmFyIGM9bmV3IE9wZW5MYXllcnMuRmlsdGVyLkNvbXBhcmlzb24oe3R5cGU6T3BlbkxheWVycy5GaWx0ZXIuQ29tcGFyaXNvbi5FUVVBTF9UT30pO3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKTtiLmZpbHRlcnMucHVzaChjKX0sUHJvcGVydHlJc05vdEVxdWFsVG86ZnVuY3Rpb24oYSxcbmIpe3ZhciBjPW5ldyBPcGVuTGF5ZXJzLkZpbHRlci5Db21wYXJpc29uKHt0eXBlOk9wZW5MYXllcnMuRmlsdGVyLkNvbXBhcmlzb24uTk9UX0VRVUFMX1RPfSk7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpO2IuZmlsdGVycy5wdXNoKGMpfSxQcm9wZXJ0eUlzTGlrZTpmdW5jdGlvbihhLGIpe3ZhciBjPW5ldyBPcGVuTGF5ZXJzLkZpbHRlci5Db21wYXJpc29uKHt0eXBlOk9wZW5MYXllcnMuRmlsdGVyLkNvbXBhcmlzb24uTElLRX0pO3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKTt2YXIgZD1hLmdldEF0dHJpYnV0ZShcIndpbGRDYXJkXCIpLGU9YS5nZXRBdHRyaWJ1dGUoXCJzaW5nbGVDaGFyXCIpLGY9YS5nZXRBdHRyaWJ1dGUoXCJlc2NhcGVcIik7Yy52YWx1ZTJyZWdleChkLGUsZik7Yi5maWx0ZXJzLnB1c2goYyl9fSxPcGVuTGF5ZXJzLkZvcm1hdC5GaWx0ZXIudjEucHJvdG90eXBlLnJlYWRlcnMub2djKSxnbWw6T3BlbkxheWVycy5Gb3JtYXQuR01MLnYyLnByb3RvdHlwZS5yZWFkZXJzLmdtbCxcbmZlYXR1cmU6T3BlbkxheWVycy5Gb3JtYXQuR01MLnYyLnByb3RvdHlwZS5yZWFkZXJzLmZlYXR1cmV9LHdyaXRlcnM6e29nYzpPcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyh7UHJvcGVydHlJc0VxdWFsVG86ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwib2djOlByb3BlcnR5SXNFcXVhbFRvXCIpO3RoaXMud3JpdGVOb2RlKFwiUHJvcGVydHlOYW1lXCIsYSxiKTt0aGlzLndyaXRlT2djRXhwcmVzc2lvbihhLnZhbHVlLGIpO3JldHVybiBifSxQcm9wZXJ0eUlzTm90RXF1YWxUbzpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJvZ2M6UHJvcGVydHlJc05vdEVxdWFsVG9cIik7dGhpcy53cml0ZU5vZGUoXCJQcm9wZXJ0eU5hbWVcIixhLGIpO3RoaXMud3JpdGVPZ2NFeHByZXNzaW9uKGEudmFsdWUsYik7cmV0dXJuIGJ9LFByb3BlcnR5SXNMaWtlOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIm9nYzpQcm9wZXJ0eUlzTGlrZVwiLFxue2F0dHJpYnV0ZXM6e3dpbGRDYXJkOlwiKlwiLHNpbmdsZUNoYXI6XCIuXCIsZXNjYXBlOlwiIVwifX0pO3RoaXMud3JpdGVOb2RlKFwiUHJvcGVydHlOYW1lXCIsYSxiKTt0aGlzLndyaXRlTm9kZShcIkxpdGVyYWxcIixhLnJlZ2V4MnZhbHVlKCksYik7cmV0dXJuIGJ9LEJCT1g6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwib2djOkJCT1hcIik7YS5wcm9wZXJ0eSYmdGhpcy53cml0ZU5vZGUoXCJQcm9wZXJ0eU5hbWVcIixhLGIpO3ZhciBjPXRoaXMud3JpdGVOb2RlKFwiZ21sOkJveFwiLGEudmFsdWUsYik7YS5wcm9qZWN0aW9uJiZjLnNldEF0dHJpYnV0ZShcInNyc05hbWVcIixhLnByb2plY3Rpb24pO3JldHVybiBifX0sT3BlbkxheWVycy5Gb3JtYXQuRmlsdGVyLnYxLnByb3RvdHlwZS53cml0ZXJzLm9nYyksZ21sOk9wZW5MYXllcnMuRm9ybWF0LkdNTC52Mi5wcm90b3R5cGUud3JpdGVycy5nbWwsZmVhdHVyZTpPcGVuTGF5ZXJzLkZvcm1hdC5HTUwudjIucHJvdG90eXBlLndyaXRlcnMuZmVhdHVyZX0sXG53cml0ZVNwYXRpYWw6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJvZ2M6XCIrYik7dGhpcy53cml0ZU5vZGUoXCJQcm9wZXJ0eU5hbWVcIixhLGMpO2lmKGEudmFsdWUgaW5zdGFuY2VvZiBPcGVuTGF5ZXJzLkZpbHRlci5GdW5jdGlvbil0aGlzLndyaXRlTm9kZShcIkZ1bmN0aW9uXCIsYS52YWx1ZSxjKTtlbHNle3ZhciBkO2Q9YS52YWx1ZSBpbnN0YW5jZW9mIE9wZW5MYXllcnMuR2VvbWV0cnk/dGhpcy53cml0ZU5vZGUoXCJmZWF0dXJlOl9nZW9tZXRyeVwiLGEudmFsdWUpLmZpcnN0Q2hpbGQ6dGhpcy53cml0ZU5vZGUoXCJnbWw6Qm94XCIsYS52YWx1ZSk7YS5wcm9qZWN0aW9uJiZkLnNldEF0dHJpYnV0ZShcInNyc05hbWVcIixhLnByb2plY3Rpb24pO2MuYXBwZW5kQ2hpbGQoZCl9cmV0dXJuIGN9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZvcm1hdC5GaWx0ZXIudjFfMF8wXCJ9KTtPcGVuTGF5ZXJzLkZvcm1hdC5XRlNULnYxXzBfMD1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuRm9ybWF0LkZpbHRlci52MV8wXzAsT3BlbkxheWVycy5Gb3JtYXQuV0ZTVC52MSx7dmVyc2lvbjpcIjEuMC4wXCIsc3JzTmFtZUluUXVlcnk6ITEsc2NoZW1hTG9jYXRpb25zOnt3ZnM6XCJodHRwOi8vc2NoZW1hcy5vcGVuZ2lzLm5ldC93ZnMvMS4wLjAvV0ZTLXRyYW5zYWN0aW9uLnhzZFwifSxpbml0aWFsaXplOmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuRm9ybWF0LkZpbHRlci52MV8wXzAucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbYV0pO09wZW5MYXllcnMuRm9ybWF0LldGU1QudjEucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbYV0pfSxyZWFkTm9kZTpmdW5jdGlvbihhLGIpe3JldHVybiBPcGVuTGF5ZXJzLkZvcm1hdC5HTUwudjIucHJvdG90eXBlLnJlYWROb2RlLmFwcGx5KHRoaXMsW2EsYl0pfSxyZWFkZXJzOnt3ZnM6T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoe1dGU19UcmFuc2FjdGlvblJlc3BvbnNlOmZ1bmN0aW9uKGEsXG5iKXtiLmluc2VydElkcz1bXTtiLnN1Y2Nlc3M9ITE7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIpfSxJbnNlcnRSZXN1bHQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz17ZmlkczpbXX07dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpO2IuaW5zZXJ0SWRzLnB1c2goYy5maWRzWzBdKX0sVHJhbnNhY3Rpb25SZXN1bHQ6ZnVuY3Rpb24oYSxiKXt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYil9LFN0YXR1czpmdW5jdGlvbihhLGIpe3RoaXMucmVhZENoaWxkTm9kZXMoYSxiKX0sU1VDQ0VTUzpmdW5jdGlvbihhLGIpe2Iuc3VjY2Vzcz0hMH19LE9wZW5MYXllcnMuRm9ybWF0LldGU1QudjEucHJvdG90eXBlLnJlYWRlcnMud2ZzKSxnbWw6T3BlbkxheWVycy5Gb3JtYXQuR01MLnYyLnByb3RvdHlwZS5yZWFkZXJzLmdtbCxmZWF0dXJlOk9wZW5MYXllcnMuRm9ybWF0LkdNTC52Mi5wcm90b3R5cGUucmVhZGVycy5mZWF0dXJlLG9nYzpPcGVuTGF5ZXJzLkZvcm1hdC5GaWx0ZXIudjFfMF8wLnByb3RvdHlwZS5yZWFkZXJzLm9nY30sXG53cml0ZXJzOnt3ZnM6T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoe1F1ZXJ5OmZ1bmN0aW9uKGEpe3ZhciBhPU9wZW5MYXllcnMuVXRpbC5leHRlbmQoe2ZlYXR1cmVOUzp0aGlzLmZlYXR1cmVOUyxmZWF0dXJlUHJlZml4OnRoaXMuZmVhdHVyZVByZWZpeCxmZWF0dXJlVHlwZTp0aGlzLmZlYXR1cmVUeXBlLHNyc05hbWU6dGhpcy5zcnNOYW1lLHNyc05hbWVJblF1ZXJ5OnRoaXMuc3JzTmFtZUluUXVlcnl9LGEpLGI9YS5mZWF0dXJlUHJlZml4LGM9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwid2ZzOlF1ZXJ5XCIse2F0dHJpYnV0ZXM6e3R5cGVOYW1lOihiP2IrXCI6XCI6XCJcIikrYS5mZWF0dXJlVHlwZX19KTthLnNyc05hbWVJblF1ZXJ5JiZhLnNyc05hbWUmJmMuc2V0QXR0cmlidXRlKFwic3JzTmFtZVwiLGEuc3JzTmFtZSk7YS5mZWF0dXJlTlMmJmMuc2V0QXR0cmlidXRlKFwieG1sbnM6XCIrYixhLmZlYXR1cmVOUyk7aWYoYS5wcm9wZXJ0eU5hbWVzKWZvcih2YXIgYj0wLGQ9YS5wcm9wZXJ0eU5hbWVzLmxlbmd0aDtiPFxuZDtiKyspdGhpcy53cml0ZU5vZGUoXCJvZ2M6UHJvcGVydHlOYW1lXCIse3Byb3BlcnR5OmEucHJvcGVydHlOYW1lc1tiXX0sYyk7YS5maWx0ZXImJih0aGlzLnNldEZpbHRlclByb3BlcnR5KGEuZmlsdGVyKSx0aGlzLndyaXRlTm9kZShcIm9nYzpGaWx0ZXJcIixhLmZpbHRlcixjKSk7cmV0dXJuIGN9fSxPcGVuTGF5ZXJzLkZvcm1hdC5XRlNULnYxLnByb3RvdHlwZS53cml0ZXJzLndmcyksZ21sOk9wZW5MYXllcnMuRm9ybWF0LkdNTC52Mi5wcm90b3R5cGUud3JpdGVycy5nbWwsZmVhdHVyZTpPcGVuTGF5ZXJzLkZvcm1hdC5HTUwudjIucHJvdG90eXBlLndyaXRlcnMuZmVhdHVyZSxvZ2M6T3BlbkxheWVycy5Gb3JtYXQuRmlsdGVyLnYxXzBfMC5wcm90b3R5cGUud3JpdGVycy5vZ2N9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZvcm1hdC5XRlNULnYxXzBfMFwifSk7T3BlbkxheWVycy5FbGVtZW50c0luZGV4ZXI9T3BlbkxheWVycy5DbGFzcyh7bWF4WkluZGV4Om51bGwsb3JkZXI6bnVsbCxpbmRpY2VzOm51bGwsY29tcGFyZTpudWxsLGluaXRpYWxpemU6ZnVuY3Rpb24oYSl7dGhpcy5jb21wYXJlPWE/T3BlbkxheWVycy5FbGVtZW50c0luZGV4ZXIuSW5kZXhpbmdNZXRob2RzLlpfT1JERVJfWV9PUkRFUjpPcGVuTGF5ZXJzLkVsZW1lbnRzSW5kZXhlci5JbmRleGluZ01ldGhvZHMuWl9PUkRFUl9EUkFXSU5HX09SREVSO3RoaXMuY2xlYXIoKX0saW5zZXJ0OmZ1bmN0aW9uKGEpe3RoaXMuZXhpc3RzKGEpJiZ0aGlzLnJlbW92ZShhKTt2YXIgYj1hLmlkO3RoaXMuZGV0ZXJtaW5lWkluZGV4KGEpO2Zvcih2YXIgYz0tMSxkPXRoaXMub3JkZXIubGVuZ3RoLGU7MTxkLWM7KWU9cGFyc2VJbnQoKGMrZCkvMiksMDx0aGlzLmNvbXBhcmUodGhpcyxhLE9wZW5MYXllcnMuVXRpbC5nZXRFbGVtZW50KHRoaXMub3JkZXJbZV0pKT9jPWU6ZD1lO3RoaXMub3JkZXIuc3BsaWNlKGQsXG4wLGIpO3RoaXMuaW5kaWNlc1tiXT10aGlzLmdldFpJbmRleChhKTtyZXR1cm4gdGhpcy5nZXROZXh0RWxlbWVudChkKX0scmVtb3ZlOmZ1bmN0aW9uKGEpe3ZhciBhPWEuaWQsYj1PcGVuTGF5ZXJzLlV0aWwuaW5kZXhPZih0aGlzLm9yZGVyLGEpOzA8PWImJih0aGlzLm9yZGVyLnNwbGljZShiLDEpLGRlbGV0ZSB0aGlzLmluZGljZXNbYV0sdGhpcy5tYXhaSW5kZXg9MDx0aGlzLm9yZGVyLmxlbmd0aD90aGlzLmluZGljZXNbdGhpcy5vcmRlclt0aGlzLm9yZGVyLmxlbmd0aC0xXV06MCl9LGNsZWFyOmZ1bmN0aW9uKCl7dGhpcy5vcmRlcj1bXTt0aGlzLmluZGljZXM9e307dGhpcy5tYXhaSW5kZXg9MH0sZXhpc3RzOmZ1bmN0aW9uKGEpe3JldHVybiBudWxsIT10aGlzLmluZGljZXNbYS5pZF19LGdldFpJbmRleDpmdW5jdGlvbihhKXtyZXR1cm4gYS5fc3R5bGUuZ3JhcGhpY1pJbmRleH0sZGV0ZXJtaW5lWkluZGV4OmZ1bmN0aW9uKGEpe3ZhciBiPWEuX3N0eWxlLmdyYXBoaWNaSW5kZXg7XG5udWxsPT1iPyhiPXRoaXMubWF4WkluZGV4LGEuX3N0eWxlLmdyYXBoaWNaSW5kZXg9Yik6Yj50aGlzLm1heFpJbmRleCYmKHRoaXMubWF4WkluZGV4PWIpfSxnZXROZXh0RWxlbWVudDpmdW5jdGlvbihhKXthKz0xO2lmKGE8dGhpcy5vcmRlci5sZW5ndGgpe3ZhciBiPU9wZW5MYXllcnMuVXRpbC5nZXRFbGVtZW50KHRoaXMub3JkZXJbYV0pO3ZvaWQgMD09YiYmKGI9dGhpcy5nZXROZXh0RWxlbWVudChhKSk7cmV0dXJuIGJ9cmV0dXJuIG51bGx9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkVsZW1lbnRzSW5kZXhlclwifSk7XG5PcGVuTGF5ZXJzLkVsZW1lbnRzSW5kZXhlci5JbmRleGluZ01ldGhvZHM9e1pfT1JERVI6ZnVuY3Rpb24oYSxiLGMpe3ZhciBiPWEuZ2V0WkluZGV4KGIpLGQ9MDtjJiYoYT1hLmdldFpJbmRleChjKSxkPWItYSk7cmV0dXJuIGR9LFpfT1JERVJfRFJBV0lOR19PUkRFUjpmdW5jdGlvbihhLGIsYyl7YT1PcGVuTGF5ZXJzLkVsZW1lbnRzSW5kZXhlci5JbmRleGluZ01ldGhvZHMuWl9PUkRFUihhLGIsYyk7YyYmMD09YSYmKGE9MSk7cmV0dXJuIGF9LFpfT1JERVJfWV9PUkRFUjpmdW5jdGlvbihhLGIsYyl7YT1PcGVuTGF5ZXJzLkVsZW1lbnRzSW5kZXhlci5JbmRleGluZ01ldGhvZHMuWl9PUkRFUihhLGIsYyk7YyYmMD09PWEmJihiPWMuX2JvdW5kc0JvdHRvbS1iLl9ib3VuZHNCb3R0b20sYT0wPT09Yj8xOmIpO3JldHVybiBhfX07XG5PcGVuTGF5ZXJzLlJlbmRlcmVyLkVsZW1lbnRzPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5SZW5kZXJlcix7cmVuZGVyZXJSb290Om51bGwscm9vdDpudWxsLHZlY3RvclJvb3Q6bnVsbCx0ZXh0Um9vdDpudWxsLHhtbG5zOm51bGwseE9mZnNldDowLGluZGV4ZXI6bnVsbCxCQUNLR1JPVU5EX0lEX1NVRkZJWDpcIl9iYWNrZ3JvdW5kXCIsTEFCRUxfSURfU1VGRklYOlwiX2xhYmVsXCIsTEFCRUxfT1VUTElORV9TVUZGSVg6XCJfb3V0bGluZVwiLGluaXRpYWxpemU6ZnVuY3Rpb24oYSxiKXtPcGVuTGF5ZXJzLlJlbmRlcmVyLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLnJlbmRlcmVyUm9vdD10aGlzLmNyZWF0ZVJlbmRlclJvb3QoKTt0aGlzLnJvb3Q9dGhpcy5jcmVhdGVSb290KFwiX3Jvb3RcIik7dGhpcy52ZWN0b3JSb290PXRoaXMuY3JlYXRlUm9vdChcIl92cm9vdFwiKTt0aGlzLnRleHRSb290PXRoaXMuY3JlYXRlUm9vdChcIl90cm9vdFwiKTt0aGlzLnJvb3QuYXBwZW5kQ2hpbGQodGhpcy52ZWN0b3JSb290KTtcbnRoaXMucm9vdC5hcHBlbmRDaGlsZCh0aGlzLnRleHRSb290KTt0aGlzLnJlbmRlcmVyUm9vdC5hcHBlbmRDaGlsZCh0aGlzLnJvb3QpO3RoaXMuY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMucmVuZGVyZXJSb290KTtpZihiJiYoYi56SW5kZXhpbmd8fGIueU9yZGVyaW5nKSl0aGlzLmluZGV4ZXI9bmV3IE9wZW5MYXllcnMuRWxlbWVudHNJbmRleGVyKGIueU9yZGVyaW5nKX0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMuY2xlYXIoKTt0aGlzLnhtbG5zPXRoaXMucm9vdD10aGlzLnJlbmRlcmVyUm9vdD1udWxsO09wZW5MYXllcnMuUmVuZGVyZXIucHJvdG90eXBlLmRlc3Ryb3kuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxjbGVhcjpmdW5jdGlvbigpe3ZhciBhLGI9dGhpcy52ZWN0b3JSb290O2lmKGIpZm9yKDthPWIuZmlyc3RDaGlsZDspYi5yZW1vdmVDaGlsZChhKTtpZihiPXRoaXMudGV4dFJvb3QpZm9yKDthPWIuZmlyc3RDaGlsZDspYi5yZW1vdmVDaGlsZChhKTt0aGlzLmluZGV4ZXImJlxudGhpcy5pbmRleGVyLmNsZWFyKCl9LHNldEV4dGVudDpmdW5jdGlvbihhLGIpe3ZhciBjPU9wZW5MYXllcnMuUmVuZGVyZXIucHJvdG90eXBlLnNldEV4dGVudC5hcHBseSh0aGlzLGFyZ3VtZW50cyksZD10aGlzLmdldFJlc29sdXRpb24oKTtpZih0aGlzLm1hcC5iYXNlTGF5ZXImJnRoaXMubWFwLmJhc2VMYXllci53cmFwRGF0ZUxpbmUpe3ZhciBlLGY9YS5nZXRXaWR0aCgpL3RoaXMubWFwLmdldEV4dGVudCgpLmdldFdpZHRoKCksYT1hLnNjYWxlKDEvZiksZj10aGlzLm1hcC5nZXRNYXhFeHRlbnQoKTtmLnJpZ2h0PmEubGVmdCYmZi5yaWdodDxhLnJpZ2h0P2U9ITA6Zi5sZWZ0PmEubGVmdCYmZi5sZWZ0PGEucmlnaHQmJihlPSExKTtpZihlIT09dGhpcy5yaWdodE9mRGF0ZUxpbmV8fGIpYz0hMSx0aGlzLnhPZmZzZXQ9ITA9PT1lP2YuZ2V0V2lkdGgoKS9kOjA7dGhpcy5yaWdodE9mRGF0ZUxpbmU9ZX1yZXR1cm4gY30sZ2V0Tm9kZVR5cGU6ZnVuY3Rpb24oKXt9LGRyYXdHZW9tZXRyeTpmdW5jdGlvbihhLFxuYixjKXt2YXIgZD1hLkNMQVNTX05BTUUsZT0hMDtpZihcIk9wZW5MYXllcnMuR2VvbWV0cnkuQ29sbGVjdGlvblwiPT1kfHxcIk9wZW5MYXllcnMuR2VvbWV0cnkuTXVsdGlQb2ludFwiPT1kfHxcIk9wZW5MYXllcnMuR2VvbWV0cnkuTXVsdGlMaW5lU3RyaW5nXCI9PWR8fFwiT3BlbkxheWVycy5HZW9tZXRyeS5NdWx0aVBvbHlnb25cIj09ZCl7Zm9yKHZhciBkPTAsZj1hLmNvbXBvbmVudHMubGVuZ3RoO2Q8ZjtkKyspZT10aGlzLmRyYXdHZW9tZXRyeShhLmNvbXBvbmVudHNbZF0sYixjKSYmZTtyZXR1cm4gZX1kPWU9ITE7XCJub25lXCIhPWIuZGlzcGxheSYmKGIuYmFja2dyb3VuZEdyYXBoaWM/dGhpcy5yZWRyYXdCYWNrZ3JvdW5kTm9kZShhLmlkLGEsYixjKTpkPSEwLGU9dGhpcy5yZWRyYXdOb2RlKGEuaWQsYSxiLGMpKTtpZighMT09ZSYmKGI9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYS5pZCkpKWIuX3N0eWxlLmJhY2tncm91bmRHcmFwaGljJiYoZD0hMCksYi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGIpO1xuZCYmKGI9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYS5pZCt0aGlzLkJBQ0tHUk9VTkRfSURfU1VGRklYKSkmJmIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChiKTtyZXR1cm4gZX0scmVkcmF3Tm9kZTpmdW5jdGlvbihhLGIsYyxkKXtjPXRoaXMuYXBwbHlEZWZhdWx0U3ltYm9saXplcihjKTthPXRoaXMubm9kZUZhY3RvcnkoYSx0aGlzLmdldE5vZGVUeXBlKGIsYykpO2EuX2ZlYXR1cmVJZD1kO2EuX2JvdW5kc0JvdHRvbT1iLmdldEJvdW5kcygpLmJvdHRvbTthLl9nZW9tZXRyeUNsYXNzPWIuQ0xBU1NfTkFNRTthLl9zdHlsZT1jO2I9dGhpcy5kcmF3R2VvbWV0cnlOb2RlKGEsYixjKTtpZighMT09PWIpcmV0dXJuITE7YT1iLm5vZGU7dGhpcy5pbmRleGVyPyhjPXRoaXMuaW5kZXhlci5pbnNlcnQoYSkpP3RoaXMudmVjdG9yUm9vdC5pbnNlcnRCZWZvcmUoYSxjKTp0aGlzLnZlY3RvclJvb3QuYXBwZW5kQ2hpbGQoYSk6YS5wYXJlbnROb2RlIT09dGhpcy52ZWN0b3JSb290JiZ0aGlzLnZlY3RvclJvb3QuYXBwZW5kQ2hpbGQoYSk7XG50aGlzLnBvc3REcmF3KGEpO3JldHVybiBiLmNvbXBsZXRlfSxyZWRyYXdCYWNrZ3JvdW5kTm9kZTpmdW5jdGlvbihhLGIsYyl7Yz1PcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHt9LGMpO2MuZXh0ZXJuYWxHcmFwaGljPWMuYmFja2dyb3VuZEdyYXBoaWM7Yy5ncmFwaGljWE9mZnNldD1jLmJhY2tncm91bmRYT2Zmc2V0O2MuZ3JhcGhpY1lPZmZzZXQ9Yy5iYWNrZ3JvdW5kWU9mZnNldDtjLmdyYXBoaWNaSW5kZXg9Yy5iYWNrZ3JvdW5kR3JhcGhpY1pJbmRleDtjLmdyYXBoaWNXaWR0aD1jLmJhY2tncm91bmRXaWR0aHx8Yy5ncmFwaGljV2lkdGg7Yy5ncmFwaGljSGVpZ2h0PWMuYmFja2dyb3VuZEhlaWdodHx8Yy5ncmFwaGljSGVpZ2h0O2MuYmFja2dyb3VuZEdyYXBoaWM9bnVsbDtjLmJhY2tncm91bmRYT2Zmc2V0PW51bGw7Yy5iYWNrZ3JvdW5kWU9mZnNldD1udWxsO2MuYmFja2dyb3VuZEdyYXBoaWNaSW5kZXg9bnVsbDtyZXR1cm4gdGhpcy5yZWRyYXdOb2RlKGErdGhpcy5CQUNLR1JPVU5EX0lEX1NVRkZJWCxcbmIsYyxudWxsKX0sZHJhd0dlb21ldHJ5Tm9kZTpmdW5jdGlvbihhLGIsYyl7dmFyIGM9Y3x8YS5fc3R5bGUsZD17aXNGaWxsZWQ6dm9pZCAwPT09Yy5maWxsPyEwOmMuZmlsbCxpc1N0cm9rZWQ6dm9pZCAwPT09Yy5zdHJva2U/ISFjLnN0cm9rZVdpZHRoOmMuc3Ryb2tlfSxlO3N3aXRjaChiLkNMQVNTX05BTUUpe2Nhc2UgXCJPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50XCI6ITE9PT1jLmdyYXBoaWMmJihkLmlzRmlsbGVkPSExLGQuaXNTdHJva2VkPSExKTtlPXRoaXMuZHJhd1BvaW50KGEsYik7YnJlYWs7Y2FzZSBcIk9wZW5MYXllcnMuR2VvbWV0cnkuTGluZVN0cmluZ1wiOmQuaXNGaWxsZWQ9ITE7ZT10aGlzLmRyYXdMaW5lU3RyaW5nKGEsYik7YnJlYWs7Y2FzZSBcIk9wZW5MYXllcnMuR2VvbWV0cnkuTGluZWFyUmluZ1wiOmU9dGhpcy5kcmF3TGluZWFyUmluZyhhLGIpO2JyZWFrO2Nhc2UgXCJPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvbHlnb25cIjplPXRoaXMuZHJhd1BvbHlnb24oYSxiKTticmVhaztcbmNhc2UgXCJPcGVuTGF5ZXJzLkdlb21ldHJ5LlJlY3RhbmdsZVwiOmU9dGhpcy5kcmF3UmVjdGFuZ2xlKGEsYil9YS5fb3B0aW9ucz1kO3JldHVybiExIT1lP3tub2RlOnRoaXMuc2V0U3R5bGUoYSxjLGQsYiksY29tcGxldGU6ZX06ITF9LHBvc3REcmF3OmZ1bmN0aW9uKCl7fSxkcmF3UG9pbnQ6ZnVuY3Rpb24oKXt9LGRyYXdMaW5lU3RyaW5nOmZ1bmN0aW9uKCl7fSxkcmF3TGluZWFyUmluZzpmdW5jdGlvbigpe30sZHJhd1BvbHlnb246ZnVuY3Rpb24oKXt9LGRyYXdSZWN0YW5nbGU6ZnVuY3Rpb24oKXt9LGRyYXdDaXJjbGU6ZnVuY3Rpb24oKXt9LHJlbW92ZVRleHQ6ZnVuY3Rpb24oYSl7dmFyIGI9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYSt0aGlzLkxBQkVMX0lEX1NVRkZJWCk7YiYmdGhpcy50ZXh0Um9vdC5yZW1vdmVDaGlsZChiKTsoYT1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChhK3RoaXMuTEFCRUxfT1VUTElORV9TVUZGSVgpKSYmdGhpcy50ZXh0Um9vdC5yZW1vdmVDaGlsZChhKX0sXG5nZXRGZWF0dXJlSWRGcm9tRXZlbnQ6ZnVuY3Rpb24oYSl7dmFyIGI9YS50YXJnZXQsYz1iJiZiLmNvcnJlc3BvbmRpbmdVc2VFbGVtZW50O3JldHVybihjP2M6Ynx8YS5zcmNFbGVtZW50KS5fZmVhdHVyZUlkfSxlcmFzZUdlb21ldHJ5OmZ1bmN0aW9uKGEsYil7aWYoXCJPcGVuTGF5ZXJzLkdlb21ldHJ5Lk11bHRpUG9pbnRcIj09YS5DTEFTU19OQU1FfHxcIk9wZW5MYXllcnMuR2VvbWV0cnkuTXVsdGlMaW5lU3RyaW5nXCI9PWEuQ0xBU1NfTkFNRXx8XCJPcGVuTGF5ZXJzLkdlb21ldHJ5Lk11bHRpUG9seWdvblwiPT1hLkNMQVNTX05BTUV8fFwiT3BlbkxheWVycy5HZW9tZXRyeS5Db2xsZWN0aW9uXCI9PWEuQ0xBU1NfTkFNRSlmb3IodmFyIGM9MCxkPWEuY29tcG9uZW50cy5sZW5ndGg7YzxkO2MrKyl0aGlzLmVyYXNlR2VvbWV0cnkoYS5jb21wb25lbnRzW2NdLGIpO2Vsc2UgaWYoKGM9T3BlbkxheWVycy5VdGlsLmdldEVsZW1lbnQoYS5pZCkpJiZjLnBhcmVudE5vZGUpaWYoYy5nZW9tZXRyeSYmXG4oYy5nZW9tZXRyeS5kZXN0cm95KCksYy5nZW9tZXRyeT1udWxsKSxjLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoYyksdGhpcy5pbmRleGVyJiZ0aGlzLmluZGV4ZXIucmVtb3ZlKGMpLGMuX3N0eWxlLmJhY2tncm91bmRHcmFwaGljKShjPU9wZW5MYXllcnMuVXRpbC5nZXRFbGVtZW50KGEuaWQrdGhpcy5CQUNLR1JPVU5EX0lEX1NVRkZJWCkpJiZjLnBhcmVudE5vZGUmJmMucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChjKX0sbm9kZUZhY3Rvcnk6ZnVuY3Rpb24oYSxiKXt2YXIgYz1PcGVuTGF5ZXJzLlV0aWwuZ2V0RWxlbWVudChhKTtjP3RoaXMubm9kZVR5cGVDb21wYXJlKGMsYil8fChjLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoYyksYz10aGlzLm5vZGVGYWN0b3J5KGEsYikpOmM9dGhpcy5jcmVhdGVOb2RlKGIsYSk7cmV0dXJuIGN9LG5vZGVUeXBlQ29tcGFyZTpmdW5jdGlvbigpe30sY3JlYXRlTm9kZTpmdW5jdGlvbigpe30sbW92ZVJvb3Q6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5yb290O1xuYS5yb290LnBhcmVudE5vZGU9PXRoaXMucmVuZGVyZXJSb290JiYoYj1hLnJvb3QpO2IucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChiKTthLnJlbmRlcmVyUm9vdC5hcHBlbmRDaGlsZChiKX0sZ2V0UmVuZGVyTGF5ZXJJZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnJvb3QucGFyZW50Tm9kZS5wYXJlbnROb2RlLmlkfSxpc0NvbXBsZXhTeW1ib2w6ZnVuY3Rpb24oYSl7cmV0dXJuXCJjaXJjbGVcIiE9YSYmISFhfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5SZW5kZXJlci5FbGVtZW50c1wifSk7T3BlbkxheWVycy5Db250cm9sLkFyZ1BhcnNlcj1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuQ29udHJvbCx7Y2VudGVyOm51bGwsem9vbTpudWxsLGxheWVyczpudWxsLGRpc3BsYXlQcm9qZWN0aW9uOm51bGwsZ2V0UGFyYW1ldGVyczpmdW5jdGlvbihhKXt2YXIgYT1hfHx3aW5kb3cubG9jYXRpb24uaHJlZixiPU9wZW5MYXllcnMuVXRpbC5nZXRQYXJhbWV0ZXJzKGEpLGM9YS5pbmRleE9mKFwiI1wiKTswPGMmJihhPVwiP1wiK2Euc3Vic3RyaW5nKGMrMSxhLmxlbmd0aCksT3BlbkxheWVycy5VdGlsLmV4dGVuZChiLE9wZW5MYXllcnMuVXRpbC5nZXRQYXJhbWV0ZXJzKGEpKSk7cmV0dXJuIGJ9LHNldE1hcDpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLnNldE1hcC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7Zm9yKHZhciBiPTAsYz10aGlzLm1hcC5jb250cm9scy5sZW5ndGg7YjxjO2IrKyl7dmFyIGQ9dGhpcy5tYXAuY29udHJvbHNbYl07aWYoZCE9dGhpcyYmXG5cIk9wZW5MYXllcnMuQ29udHJvbC5BcmdQYXJzZXJcIj09ZC5DTEFTU19OQU1FKXtkLmRpc3BsYXlQcm9qZWN0aW9uIT10aGlzLmRpc3BsYXlQcm9qZWN0aW9uJiYodGhpcy5kaXNwbGF5UHJvamVjdGlvbj1kLmRpc3BsYXlQcm9qZWN0aW9uKTticmVha319aWYoYj09dGhpcy5tYXAuY29udHJvbHMubGVuZ3RoJiYoYj10aGlzLmdldFBhcmFtZXRlcnMoKSxiLmxheWVycyYmKHRoaXMubGF5ZXJzPWIubGF5ZXJzLHRoaXMubWFwLmV2ZW50cy5yZWdpc3RlcihcImFkZGxheWVyXCIsdGhpcyx0aGlzLmNvbmZpZ3VyZUxheWVycyksdGhpcy5jb25maWd1cmVMYXllcnMoKSksYi5sYXQmJmIubG9uKSl0aGlzLmNlbnRlcj1uZXcgT3BlbkxheWVycy5Mb25MYXQocGFyc2VGbG9hdChiLmxvbikscGFyc2VGbG9hdChiLmxhdCkpLGIuem9vbSYmKHRoaXMuem9vbT1wYXJzZUZsb2F0KGIuem9vbSkpLHRoaXMubWFwLmV2ZW50cy5yZWdpc3RlcihcImNoYW5nZWJhc2VsYXllclwiLHRoaXMsdGhpcy5zZXRDZW50ZXIpLFxudGhpcy5zZXRDZW50ZXIoKX0sc2V0Q2VudGVyOmZ1bmN0aW9uKCl7dGhpcy5tYXAuYmFzZUxheWVyJiYodGhpcy5tYXAuZXZlbnRzLnVucmVnaXN0ZXIoXCJjaGFuZ2ViYXNlbGF5ZXJcIix0aGlzLHRoaXMuc2V0Q2VudGVyKSx0aGlzLmRpc3BsYXlQcm9qZWN0aW9uJiZ0aGlzLmNlbnRlci50cmFuc2Zvcm0odGhpcy5kaXNwbGF5UHJvamVjdGlvbix0aGlzLm1hcC5nZXRQcm9qZWN0aW9uT2JqZWN0KCkpLHRoaXMubWFwLnNldENlbnRlcih0aGlzLmNlbnRlcix0aGlzLnpvb20pKX0sY29uZmlndXJlTGF5ZXJzOmZ1bmN0aW9uKCl7aWYodGhpcy5sYXllcnMubGVuZ3RoPT10aGlzLm1hcC5sYXllcnMubGVuZ3RoKXt0aGlzLm1hcC5ldmVudHMudW5yZWdpc3RlcihcImFkZGxheWVyXCIsdGhpcyx0aGlzLmNvbmZpZ3VyZUxheWVycyk7Zm9yKHZhciBhPTAsYj10aGlzLmxheWVycy5sZW5ndGg7YTxiO2ErKyl7dmFyIGM9dGhpcy5tYXAubGF5ZXJzW2FdLGQ9dGhpcy5sYXllcnMuY2hhckF0KGEpO1xuXCJCXCI9PWQ/dGhpcy5tYXAuc2V0QmFzZUxheWVyKGMpOihcIlRcIj09ZHx8XCJGXCI9PWQpJiZjLnNldFZpc2liaWxpdHkoXCJUXCI9PWQpfX19LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkNvbnRyb2wuQXJnUGFyc2VyXCJ9KTtPcGVuTGF5ZXJzLkNvbnRyb2wuUGVybWFsaW5rPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Db250cm9sLHthcmdQYXJzZXJDbGFzczpPcGVuTGF5ZXJzLkNvbnRyb2wuQXJnUGFyc2VyLGVsZW1lbnQ6bnVsbCxhbmNob3I6ITEsYmFzZTpcIlwiLGRpc3BsYXlQcm9qZWN0aW9uOm51bGwsaW5pdGlhbGl6ZTpmdW5jdGlvbihhLGIsYyl7bnVsbCE9PWEmJlwib2JqZWN0XCI9PXR5cGVvZiBhJiYhT3BlbkxheWVycy5VdGlsLmlzRWxlbWVudChhKT8odGhpcy5iYXNlPWRvY3VtZW50LmxvY2F0aW9uLmhyZWYsT3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsW2FdKSxudWxsIT10aGlzLmVsZW1lbnQmJih0aGlzLmVsZW1lbnQ9T3BlbkxheWVycy5VdGlsLmdldEVsZW1lbnQodGhpcy5lbGVtZW50KSkpOihPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbY10pLHRoaXMuZWxlbWVudD1PcGVuTGF5ZXJzLlV0aWwuZ2V0RWxlbWVudChhKSxcbnRoaXMuYmFzZT1ifHxkb2N1bWVudC5sb2NhdGlvbi5ocmVmKX0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMuZWxlbWVudCYmdGhpcy5lbGVtZW50LnBhcmVudE5vZGU9PXRoaXMuZGl2JiYodGhpcy5kaXYucmVtb3ZlQ2hpbGQodGhpcy5lbGVtZW50KSx0aGlzLmVsZW1lbnQ9bnVsbCk7dGhpcy5tYXAmJnRoaXMubWFwLmV2ZW50cy51bnJlZ2lzdGVyKFwibW92ZWVuZFwiLHRoaXMsdGhpcy51cGRhdGVMaW5rKTtPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmRlc3Ryb3kuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxzZXRNYXA6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5zZXRNYXAuYXBwbHkodGhpcyxhcmd1bWVudHMpO2Zvcih2YXIgYj0wLGM9dGhpcy5tYXAuY29udHJvbHMubGVuZ3RoO2I8YztiKyspe3ZhciBkPXRoaXMubWFwLmNvbnRyb2xzW2JdO2lmKGQuQ0xBU1NfTkFNRT09dGhpcy5hcmdQYXJzZXJDbGFzcy5DTEFTU19OQU1FKXtkLmRpc3BsYXlQcm9qZWN0aW9uIT1cbnRoaXMuZGlzcGxheVByb2plY3Rpb24mJih0aGlzLmRpc3BsYXlQcm9qZWN0aW9uPWQuZGlzcGxheVByb2plY3Rpb24pO2JyZWFrfX1iPT10aGlzLm1hcC5jb250cm9scy5sZW5ndGgmJnRoaXMubWFwLmFkZENvbnRyb2wobmV3IHRoaXMuYXJnUGFyc2VyQ2xhc3Moe2Rpc3BsYXlQcm9qZWN0aW9uOnRoaXMuZGlzcGxheVByb2plY3Rpb259KSl9LGRyYXc6ZnVuY3Rpb24oKXtPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmRyYXcuYXBwbHkodGhpcyxhcmd1bWVudHMpOyF0aGlzLmVsZW1lbnQmJiF0aGlzLmFuY2hvciYmKHRoaXMuZWxlbWVudD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYVwiKSx0aGlzLmVsZW1lbnQuaW5uZXJIVE1MPU9wZW5MYXllcnMuaTE4bihcIlBlcm1hbGlua1wiKSx0aGlzLmVsZW1lbnQuaHJlZj1cIlwiLHRoaXMuZGl2LmFwcGVuZENoaWxkKHRoaXMuZWxlbWVudCkpO3RoaXMubWFwLmV2ZW50cy5vbih7bW92ZWVuZDp0aGlzLnVwZGF0ZUxpbmssY2hhbmdlbGF5ZXI6dGhpcy51cGRhdGVMaW5rLFxuY2hhbmdlYmFzZWxheWVyOnRoaXMudXBkYXRlTGluayxzY29wZTp0aGlzfSk7dGhpcy51cGRhdGVMaW5rKCk7cmV0dXJuIHRoaXMuZGl2fSx1cGRhdGVMaW5rOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5hbmNob3I/XCIjXCI6XCI/XCIsYj10aGlzLmJhc2U7LTEhPWIuaW5kZXhPZihhKSYmKGI9Yi5zdWJzdHJpbmcoMCxiLmluZGV4T2YoYSkpKTtiKz1hK09wZW5MYXllcnMuVXRpbC5nZXRQYXJhbWV0ZXJTdHJpbmcodGhpcy5jcmVhdGVQYXJhbXMoKSk7dGhpcy5hbmNob3ImJiF0aGlzLmVsZW1lbnQ/d2luZG93LmxvY2F0aW9uLmhyZWY9Yjp0aGlzLmVsZW1lbnQuaHJlZj1ifSxjcmVhdGVQYXJhbXM6ZnVuY3Rpb24oYSxiLGMpe3ZhciBhPWF8fHRoaXMubWFwLmdldENlbnRlcigpLGQ9T3BlbkxheWVycy5VdGlsLmdldFBhcmFtZXRlcnModGhpcy5iYXNlKTtpZihhKXtkLnpvb209Ynx8dGhpcy5tYXAuZ2V0Wm9vbSgpO2I9YS5sYXQ7YT1hLmxvbjt0aGlzLmRpc3BsYXlQcm9qZWN0aW9uJiYoYj1cbk9wZW5MYXllcnMuUHJvamVjdGlvbi50cmFuc2Zvcm0oe3g6YSx5OmJ9LHRoaXMubWFwLmdldFByb2plY3Rpb25PYmplY3QoKSx0aGlzLmRpc3BsYXlQcm9qZWN0aW9uKSxhPWIueCxiPWIueSk7ZC5sYXQ9TWF0aC5yb3VuZCgxRTUqYikvMUU1O2QubG9uPU1hdGgucm91bmQoMUU1KmEpLzFFNTtjPWN8fHRoaXMubWFwLmxheWVycztkLmxheWVycz1cIlwiO2E9MDtmb3IoYj1jLmxlbmd0aDthPGI7YSsrKXt2YXIgZT1jW2FdO2QubGF5ZXJzPWUuaXNCYXNlTGF5ZXI/ZC5sYXllcnMrKGU9PXRoaXMubWFwLmJhc2VMYXllcj9cIkJcIjpcIjBcIik6ZC5sYXllcnMrKGUuZ2V0VmlzaWJpbGl0eSgpP1wiVFwiOlwiRlwiKX19cmV0dXJuIGR9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkNvbnRyb2wuUGVybWFsaW5rXCJ9KTtPcGVuTGF5ZXJzLkxheWVyLlRNUz1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuTGF5ZXIuR3JpZCx7c2VydmljZVZlcnNpb246XCIxLjAuMFwiLGxheWVybmFtZTpudWxsLHR5cGU6bnVsbCxpc0Jhc2VMYXllcjohMCx0aWxlT3JpZ2luOm51bGwsc2VydmVyUmVzb2x1dGlvbnM6bnVsbCx6b29tT2Zmc2V0OjAsaW5pdGlhbGl6ZTpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9W107ZC5wdXNoKGEsYix7fSxjKTtPcGVuTGF5ZXJzLkxheWVyLkdyaWQucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxkKX0sY2xvbmU6ZnVuY3Rpb24oYSl7bnVsbD09YSYmKGE9bmV3IE9wZW5MYXllcnMuTGF5ZXIuVE1TKHRoaXMubmFtZSx0aGlzLnVybCx0aGlzLmdldE9wdGlvbnMoKSkpO3JldHVybiBhPU9wZW5MYXllcnMuTGF5ZXIuR3JpZC5wcm90b3R5cGUuY2xvbmUuYXBwbHkodGhpcyxbYV0pfSxnZXRVUkw6ZnVuY3Rpb24oYSl7dmFyIGE9dGhpcy5hZGp1c3RCb3VuZHMoYSksYj10aGlzLmdldFNlcnZlclJlc29sdXRpb24oKSxcbmM9TWF0aC5yb3VuZCgoYS5sZWZ0LXRoaXMudGlsZU9yaWdpbi5sb24pLyhiKnRoaXMudGlsZVNpemUudykpLGE9TWF0aC5yb3VuZCgoYS5ib3R0b20tdGhpcy50aWxlT3JpZ2luLmxhdCkvKGIqdGhpcy50aWxlU2l6ZS5oKSksYz10aGlzLnNlcnZpY2VWZXJzaW9uK1wiL1wiK3RoaXMubGF5ZXJuYW1lK1wiL1wiK3RoaXMuZ2V0U2VydmVyWm9vbSgpK1wiL1wiK2MrXCIvXCIrYStcIi5cIit0aGlzLnR5cGUsYT10aGlzLnVybDtPcGVuTGF5ZXJzLlV0aWwuaXNBcnJheShhKSYmKGE9dGhpcy5zZWxlY3RVcmwoYyxhKSk7cmV0dXJuIGErY30sc2V0TWFwOmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuTGF5ZXIuR3JpZC5wcm90b3R5cGUuc2V0TWFwLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLnRpbGVPcmlnaW58fCh0aGlzLnRpbGVPcmlnaW49bmV3IE9wZW5MYXllcnMuTG9uTGF0KHRoaXMubWFwLm1heEV4dGVudC5sZWZ0LHRoaXMubWFwLm1heEV4dGVudC5ib3R0b20pKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuTGF5ZXIuVE1TXCJ9KTtPcGVuTGF5ZXJzLlN0cmF0ZWd5LkZpeGVkPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5TdHJhdGVneSx7cHJlbG9hZDohMSxhY3RpdmF0ZTpmdW5jdGlvbigpe2lmKE9wZW5MYXllcnMuU3RyYXRlZ3kucHJvdG90eXBlLmFjdGl2YXRlLmFwcGx5KHRoaXMsYXJndW1lbnRzKSl7dGhpcy5sYXllci5ldmVudHMub24oe3JlZnJlc2g6dGhpcy5sb2FkLHNjb3BlOnRoaXN9KTtpZighMD09dGhpcy5sYXllci52aXNpYmlsaXR5fHx0aGlzLnByZWxvYWQpdGhpcy5sb2FkKCk7ZWxzZSB0aGlzLmxheWVyLmV2ZW50cy5vbih7dmlzaWJpbGl0eWNoYW5nZWQ6dGhpcy5sb2FkLHNjb3BlOnRoaXN9KTtyZXR1cm4hMH1yZXR1cm4hMX0sZGVhY3RpdmF0ZTpmdW5jdGlvbigpe3ZhciBhPU9wZW5MYXllcnMuU3RyYXRlZ3kucHJvdG90eXBlLmRlYWN0aXZhdGUuY2FsbCh0aGlzKTthJiZ0aGlzLmxheWVyLmV2ZW50cy51bih7cmVmcmVzaDp0aGlzLmxvYWQsdmlzaWJpbGl0eWNoYW5nZWQ6dGhpcy5sb2FkLFxuc2NvcGU6dGhpc30pO3JldHVybiBhfSxsb2FkOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMubGF5ZXI7Yi5ldmVudHMudHJpZ2dlckV2ZW50KFwibG9hZHN0YXJ0XCIpO2IucHJvdG9jb2wucmVhZChPcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyh7Y2FsbGJhY2s6T3BlbkxheWVycy5GdW5jdGlvbi5iaW5kKHRoaXMubWVyZ2UsdGhpcyxiLm1hcC5nZXRQcm9qZWN0aW9uT2JqZWN0KCkpLGZpbHRlcjpiLmZpbHRlcn0sYSkpO2IuZXZlbnRzLnVuKHt2aXNpYmlsaXR5Y2hhbmdlZDp0aGlzLmxvYWQsc2NvcGU6dGhpc30pfSxtZXJnZTpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMubGF5ZXI7Yy5kZXN0cm95RmVhdHVyZXMoKTt2YXIgZD1iLmZlYXR1cmVzO2lmKGQmJjA8ZC5sZW5ndGgpe2lmKCFhLmVxdWFscyhjLnByb2plY3Rpb24pKWZvcih2YXIgZSxmPTAsZz1kLmxlbmd0aDtmPGc7KytmKShlPWRbZl0uZ2VvbWV0cnkpJiZlLnRyYW5zZm9ybShjLnByb2plY3Rpb24sYSk7Yy5hZGRGZWF0dXJlcyhkKX1jLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJsb2FkZW5kXCIpfSxcbkNMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLlN0cmF0ZWd5LkZpeGVkXCJ9KTtPcGVuTGF5ZXJzLkNvbnRyb2wuWm9vbT1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuQ29udHJvbCx7em9vbUluVGV4dDpcIitcIix6b29tSW5JZDpcIm9sWm9vbUluTGlua1wiLHpvb21PdXRUZXh0OlwiLVwiLHpvb21PdXRJZDpcIm9sWm9vbU91dExpbmtcIixkcmF3OmZ1bmN0aW9uKCl7dmFyIGE9T3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5kcmF3LmFwcGx5KHRoaXMpLGI9dGhpcy5nZXRPckNyZWF0ZUxpbmtzKGEpLGM9Yi56b29tSW4sYj1iLnpvb21PdXQsZD10aGlzLm1hcC5ldmVudHM7Yi5wYXJlbnROb2RlIT09YSYmKGQ9dGhpcy5ldmVudHMsZC5hdHRhY2hUb0VsZW1lbnQoYi5wYXJlbnROb2RlKSk7ZC5yZWdpc3RlcihcImJ1dHRvbmNsaWNrXCIsdGhpcyx0aGlzLm9uWm9vbUNsaWNrKTt0aGlzLnpvb21Jbkxpbms9Yzt0aGlzLnpvb21PdXRMaW5rPWI7cmV0dXJuIGF9LGdldE9yQ3JlYXRlTGlua3M6ZnVuY3Rpb24oYSl7dmFyIGI9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy56b29tSW5JZCksXG5jPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuem9vbU91dElkKTtifHwoYj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYVwiKSxiLmhyZWY9XCIjem9vbUluXCIsYi5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0aGlzLnpvb21JblRleHQpKSxiLmNsYXNzTmFtZT1cIm9sQ29udHJvbFpvb21JblwiLGEuYXBwZW5kQ2hpbGQoYikpO09wZW5MYXllcnMuRWxlbWVudC5hZGRDbGFzcyhiLFwib2xCdXR0b25cIik7Y3x8KGM9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIiksYy5ocmVmPVwiI3pvb21PdXRcIixjLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHRoaXMuem9vbU91dFRleHQpKSxjLmNsYXNzTmFtZT1cIm9sQ29udHJvbFpvb21PdXRcIixhLmFwcGVuZENoaWxkKGMpKTtPcGVuTGF5ZXJzLkVsZW1lbnQuYWRkQ2xhc3MoYyxcIm9sQnV0dG9uXCIpO3JldHVybnt6b29tSW46Yix6b29tT3V0OmN9fSxvblpvb21DbGljazpmdW5jdGlvbihhKXthPWEuYnV0dG9uRWxlbWVudDtcbmE9PT10aGlzLnpvb21Jbkxpbms/dGhpcy5tYXAuem9vbUluKCk6YT09PXRoaXMuem9vbU91dExpbmsmJnRoaXMubWFwLnpvb21PdXQoKX0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMubWFwJiZ0aGlzLm1hcC5ldmVudHMudW5yZWdpc3RlcihcImJ1dHRvbmNsaWNrXCIsdGhpcyx0aGlzLm9uWm9vbUNsaWNrKTtkZWxldGUgdGhpcy56b29tSW5MaW5rO2RlbGV0ZSB0aGlzLnpvb21PdXRMaW5rO09wZW5MYXllcnMuQ29udHJvbC5wcm90b3R5cGUuZGVzdHJveS5hcHBseSh0aGlzKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuQ29udHJvbC5ab29tXCJ9KTtPcGVuTGF5ZXJzLkxheWVyLlBvaW50VHJhY2s9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkxheWVyLlZlY3Rvcix7ZGF0YUZyb206bnVsbCxzdHlsZUZyb206bnVsbCxhZGROb2RlczpmdW5jdGlvbihhLGIpe2lmKDI+YS5sZW5ndGgpdGhyb3cgRXJyb3IoXCJBdCBsZWFzdCB0d28gcG9pbnQgZmVhdHVyZXMgaGF2ZSB0byBiZSBhZGRlZCB0byBjcmVhdGUgYSBsaW5lIGZyb21cIik7Zm9yKHZhciBjPUFycmF5KGEubGVuZ3RoLTEpLGQsZSxmLGc9MCxoPWEubGVuZ3RoO2c8aDtnKyspe2Q9YVtnXTtpZihmPWQuZ2VvbWV0cnkpe2lmKFwiT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludFwiIT1mLkNMQVNTX05BTUUpdGhyb3cgbmV3IFR5cGVFcnJvcihcIk9ubHkgZmVhdHVyZXMgd2l0aCBwb2ludCBnZW9tZXRyaWVzIGFyZSBzdXBwb3J0ZWQuXCIpO31lbHNlIGY9ZC5sb25sYXQsZj1uZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChmLmxvbixmLmxhdCk7aWYoMDxnKXtkPW51bGwhPXRoaXMuZGF0YUZyb20/XG5hW2crdGhpcy5kYXRhRnJvbV0uZGF0YXx8YVtnK3RoaXMuZGF0YUZyb21dLmF0dHJpYnV0ZXM6bnVsbDt2YXIgaT1udWxsIT10aGlzLnN0eWxlRnJvbT9hW2crdGhpcy5zdHlsZUZyb21dLnN0eWxlOm51bGw7ZT1uZXcgT3BlbkxheWVycy5HZW9tZXRyeS5MaW5lU3RyaW5nKFtlLGZdKTtjW2ctMV09bmV3IE9wZW5MYXllcnMuRmVhdHVyZS5WZWN0b3IoZSxkLGkpfWU9Zn10aGlzLmFkZEZlYXR1cmVzKGMsYil9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkxheWVyLlBvaW50VHJhY2tcIn0pO09wZW5MYXllcnMuTGF5ZXIuUG9pbnRUcmFjay5TT1VSQ0VfTk9ERT0tMTtPcGVuTGF5ZXJzLkxheWVyLlBvaW50VHJhY2suVEFSR0VUX05PREU9MDtPcGVuTGF5ZXJzLkxheWVyLlBvaW50VHJhY2suZGF0YUZyb209e1NPVVJDRV9OT0RFOi0xLFRBUkdFVF9OT0RFOjB9O09wZW5MYXllcnMuUHJvdG9jb2wuV0ZTPWZ1bmN0aW9uKGEpe3ZhciBhPU9wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKGEsT3BlbkxheWVycy5Qcm90b2NvbC5XRlMuREVGQVVMVFMpLGI9T3BlbkxheWVycy5Qcm90b2NvbC5XRlNbXCJ2XCIrYS52ZXJzaW9uLnJlcGxhY2UoL1xcLi9nLFwiX1wiKV07aWYoIWIpdGhyb3dcIlVuc3VwcG9ydGVkIFdGUyB2ZXJzaW9uOiBcIithLnZlcnNpb247cmV0dXJuIG5ldyBiKGEpfTtcbk9wZW5MYXllcnMuUHJvdG9jb2wuV0ZTLmZyb21XTVNMYXllcj1mdW5jdGlvbihhLGIpe3ZhciBjLGQ7Yz1hLnBhcmFtcy5MQVlFUlM7Yz0oT3BlbkxheWVycy5VdGlsLmlzQXJyYXkoYyk/Y1swXTpjKS5zcGxpdChcIjpcIik7MTxjLmxlbmd0aCYmKGQ9Y1swXSk7Yz1jLnBvcCgpO2Q9e3VybDphLnVybCxmZWF0dXJlVHlwZTpjLGZlYXR1cmVQcmVmaXg6ZCxzcnNOYW1lOmEucHJvamVjdGlvbiYmYS5wcm9qZWN0aW9uLmdldENvZGUoKXx8YS5tYXAmJmEubWFwLmdldFByb2plY3Rpb25PYmplY3QoKS5nZXRDb2RlKCksdmVyc2lvbjpcIjEuMS4wXCJ9O3JldHVybiBuZXcgT3BlbkxheWVycy5Qcm90b2NvbC5XRlMoT3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoYixkKSl9O09wZW5MYXllcnMuUHJvdG9jb2wuV0ZTLkRFRkFVTFRTPXt2ZXJzaW9uOlwiMS4wLjBcIn07T3BlbkxheWVycy5MYXllci5NYXJrZXJzPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5MYXllcix7aXNCYXNlTGF5ZXI6ITEsbWFya2VyczpudWxsLGRyYXduOiExLGluaXRpYWxpemU6ZnVuY3Rpb24oYSxiKXtPcGVuTGF5ZXJzLkxheWVyLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLm1hcmtlcnM9W119LGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLmNsZWFyTWFya2VycygpO3RoaXMubWFya2Vycz1udWxsO09wZW5MYXllcnMuTGF5ZXIucHJvdG90eXBlLmRlc3Ryb3kuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxzZXRPcGFjaXR5OmZ1bmN0aW9uKGEpe2lmKGEhPXRoaXMub3BhY2l0eSl7dGhpcy5vcGFjaXR5PWE7Zm9yKHZhciBhPTAsYj10aGlzLm1hcmtlcnMubGVuZ3RoO2E8YjthKyspdGhpcy5tYXJrZXJzW2FdLnNldE9wYWNpdHkodGhpcy5vcGFjaXR5KX19LG1vdmVUbzpmdW5jdGlvbihhLGIsYyl7T3BlbkxheWVycy5MYXllci5wcm90b3R5cGUubW92ZVRvLmFwcGx5KHRoaXMsXG5hcmd1bWVudHMpO2lmKGJ8fCF0aGlzLmRyYXduKXtmb3IodmFyIGQ9MCxlPXRoaXMubWFya2Vycy5sZW5ndGg7ZDxlO2QrKyl0aGlzLmRyYXdNYXJrZXIodGhpcy5tYXJrZXJzW2RdKTt0aGlzLmRyYXduPSEwfX0sYWRkTWFya2VyOmZ1bmN0aW9uKGEpe3RoaXMubWFya2Vycy5wdXNoKGEpOzE+dGhpcy5vcGFjaXR5JiZhLnNldE9wYWNpdHkodGhpcy5vcGFjaXR5KTt0aGlzLm1hcCYmdGhpcy5tYXAuZ2V0RXh0ZW50KCkmJihhLm1hcD10aGlzLm1hcCx0aGlzLmRyYXdNYXJrZXIoYSkpfSxyZW1vdmVNYXJrZXI6ZnVuY3Rpb24oYSl7dGhpcy5tYXJrZXJzJiZ0aGlzLm1hcmtlcnMubGVuZ3RoJiYoT3BlbkxheWVycy5VdGlsLnJlbW92ZUl0ZW0odGhpcy5tYXJrZXJzLGEpLGEuZXJhc2UoKSl9LGNsZWFyTWFya2VyczpmdW5jdGlvbigpe2lmKG51bGwhPXRoaXMubWFya2Vycylmb3IoOzA8dGhpcy5tYXJrZXJzLmxlbmd0aDspdGhpcy5yZW1vdmVNYXJrZXIodGhpcy5tYXJrZXJzWzBdKX0sXG5kcmF3TWFya2VyOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMubWFwLmdldExheWVyUHhGcm9tTG9uTGF0KGEubG9ubGF0KTtudWxsPT1iP2EuZGlzcGxheSghMSk6YS5pc0RyYXduKCk/YS5pY29uJiZhLmljb24ubW92ZVRvKGIpOnRoaXMuZGl2LmFwcGVuZENoaWxkKGEuZHJhdyhiKSl9LGdldERhdGFFeHRlbnQ6ZnVuY3Rpb24oKXt2YXIgYT1udWxsO2lmKHRoaXMubWFya2VycyYmMDx0aGlzLm1hcmtlcnMubGVuZ3RoKWZvcih2YXIgYT1uZXcgT3BlbkxheWVycy5Cb3VuZHMsYj0wLGM9dGhpcy5tYXJrZXJzLmxlbmd0aDtiPGM7YisrKWEuZXh0ZW5kKHRoaXMubWFya2Vyc1tiXS5sb25sYXQpO3JldHVybiBhfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5MYXllci5NYXJrZXJzXCJ9KTtPcGVuTGF5ZXJzLkNvbnRyb2wuUGFuPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Db250cm9sLHtzbGlkZUZhY3Rvcjo1MCxzbGlkZVJhdGlvOm51bGwsZGlyZWN0aW9uOm51bGwsdHlwZTpPcGVuTGF5ZXJzLkNvbnRyb2wuVFlQRV9CVVRUT04saW5pdGlhbGl6ZTpmdW5jdGlvbihhLGIpe3RoaXMuZGlyZWN0aW9uPWE7dGhpcy5DTEFTU19OQU1FKz10aGlzLmRpcmVjdGlvbjtPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbYl0pfSx0cmlnZ2VyOmZ1bmN0aW9uKCl7dmFyIGE9T3BlbkxheWVycy5GdW5jdGlvbi5iaW5kKGZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnNsaWRlUmF0aW8/dGhpcy5tYXAuZ2V0U2l6ZSgpW2FdKnRoaXMuc2xpZGVSYXRpbzp0aGlzLnNsaWRlRmFjdG9yfSx0aGlzKTtzd2l0Y2godGhpcy5kaXJlY3Rpb24pe2Nhc2UgT3BlbkxheWVycy5Db250cm9sLlBhbi5OT1JUSDp0aGlzLm1hcC5wYW4oMCwtYShcImhcIikpO1xuYnJlYWs7Y2FzZSBPcGVuTGF5ZXJzLkNvbnRyb2wuUGFuLlNPVVRIOnRoaXMubWFwLnBhbigwLGEoXCJoXCIpKTticmVhaztjYXNlIE9wZW5MYXllcnMuQ29udHJvbC5QYW4uV0VTVDp0aGlzLm1hcC5wYW4oLWEoXCJ3XCIpLDApO2JyZWFrO2Nhc2UgT3BlbkxheWVycy5Db250cm9sLlBhbi5FQVNUOnRoaXMubWFwLnBhbihhKFwid1wiKSwwKX19LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkNvbnRyb2wuUGFuXCJ9KTtPcGVuTGF5ZXJzLkNvbnRyb2wuUGFuLk5PUlRIPVwiTm9ydGhcIjtPcGVuTGF5ZXJzLkNvbnRyb2wuUGFuLlNPVVRIPVwiU291dGhcIjtPcGVuTGF5ZXJzLkNvbnRyb2wuUGFuLkVBU1Q9XCJFYXN0XCI7T3BlbkxheWVycy5Db250cm9sLlBhbi5XRVNUPVwiV2VzdFwiO09wZW5MYXllcnMuRm9ybWF0LkNTV0dldERvbWFpbj1mdW5jdGlvbihhKXt2YXIgYT1PcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyhhLE9wZW5MYXllcnMuRm9ybWF0LkNTV0dldERvbWFpbi5ERUZBVUxUUyksYj1PcGVuTGF5ZXJzLkZvcm1hdC5DU1dHZXREb21haW5bXCJ2XCIrYS52ZXJzaW9uLnJlcGxhY2UoL1xcLi9nLFwiX1wiKV07aWYoIWIpdGhyb3dcIlVuc3VwcG9ydGVkIENTV0dldERvbWFpbiB2ZXJzaW9uOiBcIithLnZlcnNpb247cmV0dXJuIG5ldyBiKGEpfTtPcGVuTGF5ZXJzLkZvcm1hdC5DU1dHZXREb21haW4uREVGQVVMVFM9e3ZlcnNpb246XCIyLjAuMlwifTtPcGVuTGF5ZXJzLkZvcm1hdC5DU1dHZXREb21haW4udjJfMF8yPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Gb3JtYXQuWE1MLHtuYW1lc3BhY2VzOnt4bGluazpcImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmtcIix4c2k6XCJodHRwOi8vd3d3LnczLm9yZy8yMDAxL1hNTFNjaGVtYS1pbnN0YW5jZVwiLGNzdzpcImh0dHA6Ly93d3cub3Blbmdpcy5uZXQvY2F0L2Nzdy8yLjAuMlwifSxkZWZhdWx0UHJlZml4OlwiY3N3XCIsdmVyc2lvbjpcIjIuMC4yXCIsc2NoZW1hTG9jYXRpb246XCJodHRwOi8vd3d3Lm9wZW5naXMubmV0L2NhdC9jc3cvMi4wLjIgaHR0cDovL3NjaGVtYXMub3Blbmdpcy5uZXQvY3N3LzIuMC4yL0NTVy1kaXNjb3ZlcnkueHNkXCIsUHJvcGVydHlOYW1lOm51bGwsUGFyYW1ldGVyTmFtZTpudWxsLHJlYWQ6ZnVuY3Rpb24oYSl7XCJzdHJpbmdcIj09dHlwZW9mIGEmJihhPU9wZW5MYXllcnMuRm9ybWF0LlhNTC5wcm90b3R5cGUucmVhZC5hcHBseSh0aGlzLFthXSkpO2EmJjk9PVxuYS5ub2RlVHlwZSYmKGE9YS5kb2N1bWVudEVsZW1lbnQpO3ZhciBiPXt9O3RoaXMucmVhZE5vZGUoYSxiKTtyZXR1cm4gYn0scmVhZGVyczp7Y3N3OntHZXREb21haW5SZXNwb25zZTpmdW5jdGlvbihhLGIpe3RoaXMucmVhZENoaWxkTm9kZXMoYSxiKX0sRG9tYWluVmFsdWVzOmZ1bmN0aW9uKGEsYil7T3BlbkxheWVycy5VdGlsLmlzQXJyYXkoYi5Eb21haW5WYWx1ZXMpfHwoYi5Eb21haW5WYWx1ZXM9W10pO2Zvcih2YXIgYz1hLmF0dHJpYnV0ZXMsZD17fSxlPTAsZj1jLmxlbmd0aDtlPGY7KytlKWRbY1tlXS5uYW1lXT1jW2VdLm5vZGVWYWx1ZTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsZCk7Yi5Eb21haW5WYWx1ZXMucHVzaChkKX0sUHJvcGVydHlOYW1lOmZ1bmN0aW9uKGEsYil7Yi5Qcm9wZXJ0eU5hbWU9dGhpcy5nZXRDaGlsZFZhbHVlKGEpfSxQYXJhbWV0ZXJOYW1lOmZ1bmN0aW9uKGEsYil7Yi5QYXJhbWV0ZXJOYW1lPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKX0sTGlzdE9mVmFsdWVzOmZ1bmN0aW9uKGEsXG5iKXtPcGVuTGF5ZXJzLlV0aWwuaXNBcnJheShiLkxpc3RPZlZhbHVlcyl8fChiLkxpc3RPZlZhbHVlcz1bXSk7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIuTGlzdE9mVmFsdWVzKX0sVmFsdWU6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9YS5hdHRyaWJ1dGVzLGQ9e30sZT0wLGY9Yy5sZW5ndGg7ZTxmOysrZSlkW2NbZV0ubmFtZV09Y1tlXS5ub2RlVmFsdWU7ZC52YWx1ZT10aGlzLmdldENoaWxkVmFsdWUoYSk7Yi5wdXNoKHtWYWx1ZTpkfSl9LENvbmNlcHR1YWxTY2hlbWU6ZnVuY3Rpb24oYSxiKXtiLkNvbmNlcHR1YWxTY2hlbWU9e307dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIuQ29uY2VwdHVhbFNjaGVtZSl9LE5hbWU6ZnVuY3Rpb24oYSxiKXtiLk5hbWU9dGhpcy5nZXRDaGlsZFZhbHVlKGEpfSxEb2N1bWVudDpmdW5jdGlvbihhLGIpe2IuRG9jdW1lbnQ9dGhpcy5nZXRDaGlsZFZhbHVlKGEpfSxBdXRob3JpdHk6ZnVuY3Rpb24oYSxiKXtiLkF1dGhvcml0eT10aGlzLmdldENoaWxkVmFsdWUoYSl9LFxuUmFuZ2VPZlZhbHVlczpmdW5jdGlvbihhLGIpe2IuUmFuZ2VPZlZhbHVlcz17fTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYi5SYW5nZU9mVmFsdWVzKX0sTWluVmFsdWU6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9YS5hdHRyaWJ1dGVzLGQ9e30sZT0wLGY9Yy5sZW5ndGg7ZTxmOysrZSlkW2NbZV0ubmFtZV09Y1tlXS5ub2RlVmFsdWU7ZC52YWx1ZT10aGlzLmdldENoaWxkVmFsdWUoYSk7Yi5NaW5WYWx1ZT1kfSxNYXhWYWx1ZTpmdW5jdGlvbihhLGIpe2Zvcih2YXIgYz1hLmF0dHJpYnV0ZXMsZD17fSxlPTAsZj1jLmxlbmd0aDtlPGY7KytlKWRbY1tlXS5uYW1lXT1jW2VdLm5vZGVWYWx1ZTtkLnZhbHVlPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKTtiLk1heFZhbHVlPWR9fX0sd3JpdGU6ZnVuY3Rpb24oYSl7YT10aGlzLndyaXRlTm9kZShcImNzdzpHZXREb21haW5cIixhKTtyZXR1cm4gT3BlbkxheWVycy5Gb3JtYXQuWE1MLnByb3RvdHlwZS53cml0ZS5hcHBseSh0aGlzLFthXSl9LHdyaXRlcnM6e2Nzdzp7R2V0RG9tYWluOmZ1bmN0aW9uKGEpe3ZhciBiPVxudGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiY3N3OkdldERvbWFpblwiLHthdHRyaWJ1dGVzOntzZXJ2aWNlOlwiQ1NXXCIsdmVyc2lvbjp0aGlzLnZlcnNpb259fSk7aWYoYS5Qcm9wZXJ0eU5hbWV8fHRoaXMuUHJvcGVydHlOYW1lKXRoaXMud3JpdGVOb2RlKFwiY3N3OlByb3BlcnR5TmFtZVwiLGEuUHJvcGVydHlOYW1lfHx0aGlzLlByb3BlcnR5TmFtZSxiKTtlbHNlIGlmKGEuUGFyYW1ldGVyTmFtZXx8dGhpcy5QYXJhbWV0ZXJOYW1lKXRoaXMud3JpdGVOb2RlKFwiY3N3OlBhcmFtZXRlck5hbWVcIixhLlBhcmFtZXRlck5hbWV8fHRoaXMuUGFyYW1ldGVyTmFtZSxiKTt0aGlzLnJlYWRDaGlsZE5vZGVzKGIsYSk7cmV0dXJuIGJ9LFByb3BlcnR5TmFtZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiY3N3OlByb3BlcnR5TmFtZVwiLHt2YWx1ZTphfSl9LFBhcmFtZXRlck5hbWU6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcImNzdzpQYXJhbWV0ZXJOYW1lXCIsXG57dmFsdWU6YX0pfX19LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZvcm1hdC5DU1dHZXREb21haW4udjJfMF8yXCJ9KTtPcGVuTGF5ZXJzLkZvcm1hdC5BcmNYTUwuRmVhdHVyZXM9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkZvcm1hdC5YTUwse3JlYWQ6ZnVuY3Rpb24oYSl7cmV0dXJuKG5ldyBPcGVuTGF5ZXJzLkZvcm1hdC5BcmNYTUwpLnJlYWQoYSkuZmVhdHVyZXMuZmVhdHVyZX19KTtPcGVuTGF5ZXJzLkNvbnRyb2wuU25hcHBpbmc9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkNvbnRyb2wse0RFRkFVTFRTOnt0b2xlcmFuY2U6MTAsbm9kZTohMCxlZGdlOiEwLHZlcnRleDohMH0sZ3JlZWR5OiEwLHByZWNlZGVuY2U6W1wibm9kZVwiLFwidmVydGV4XCIsXCJlZGdlXCJdLHJlc29sdXRpb246bnVsbCxnZW9Ub2xlcmFuY2VDYWNoZTpudWxsLGxheWVyOm51bGwsZmVhdHVyZTpudWxsLHBvaW50Om51bGwsaW5pdGlhbGl6ZTpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbYV0pO3RoaXMub3B0aW9ucz1hfHx7fTt0aGlzLm9wdGlvbnMubGF5ZXImJnRoaXMuc2V0TGF5ZXIodGhpcy5vcHRpb25zLmxheWVyKTthPU9wZW5MYXllcnMuVXRpbC5leHRlbmQoe30sdGhpcy5vcHRpb25zLmRlZmF1bHRzKTt0aGlzLmRlZmF1bHRzPU9wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKGEsdGhpcy5ERUZBVUxUUyk7dGhpcy5zZXRUYXJnZXRzKHRoaXMub3B0aW9ucy50YXJnZXRzKTtcbjA9PT10aGlzLnRhcmdldHMubGVuZ3RoJiZ0aGlzLmxheWVyJiZ0aGlzLmFkZFRhcmdldExheWVyKHRoaXMubGF5ZXIpO3RoaXMuZ2VvVG9sZXJhbmNlQ2FjaGU9e319LHNldExheWVyOmZ1bmN0aW9uKGEpe3RoaXMuYWN0aXZlPyh0aGlzLmRlYWN0aXZhdGUoKSx0aGlzLmxheWVyPWEsdGhpcy5hY3RpdmF0ZSgpKTp0aGlzLmxheWVyPWF9LHNldFRhcmdldHM6ZnVuY3Rpb24oYSl7dGhpcy50YXJnZXRzPVtdO2lmKGEmJmEubGVuZ3RoKWZvcih2YXIgYixjPTAsZD1hLmxlbmd0aDtjPGQ7KytjKWI9YVtjXSxiIGluc3RhbmNlb2YgT3BlbkxheWVycy5MYXllci5WZWN0b3I/dGhpcy5hZGRUYXJnZXRMYXllcihiKTp0aGlzLmFkZFRhcmdldChiKX0sYWRkVGFyZ2V0TGF5ZXI6ZnVuY3Rpb24oYSl7dGhpcy5hZGRUYXJnZXQoe2xheWVyOmF9KX0sYWRkVGFyZ2V0OmZ1bmN0aW9uKGEpe2E9T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoYSx0aGlzLmRlZmF1bHRzKTthLm5vZGVUb2xlcmFuY2U9XG5hLm5vZGVUb2xlcmFuY2V8fGEudG9sZXJhbmNlO2EudmVydGV4VG9sZXJhbmNlPWEudmVydGV4VG9sZXJhbmNlfHxhLnRvbGVyYW5jZTthLmVkZ2VUb2xlcmFuY2U9YS5lZGdlVG9sZXJhbmNlfHxhLnRvbGVyYW5jZTt0aGlzLnRhcmdldHMucHVzaChhKX0scmVtb3ZlVGFyZ2V0TGF5ZXI6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiLGM9dGhpcy50YXJnZXRzLmxlbmd0aC0xOzA8PWM7LS1jKWI9dGhpcy50YXJnZXRzW2NdLGIubGF5ZXI9PT1hJiZ0aGlzLnJlbW92ZVRhcmdldChiKX0scmVtb3ZlVGFyZ2V0OmZ1bmN0aW9uKGEpe3JldHVybiBPcGVuTGF5ZXJzLlV0aWwucmVtb3ZlSXRlbSh0aGlzLnRhcmdldHMsYSl9LGFjdGl2YXRlOmZ1bmN0aW9uKCl7dmFyIGE9T3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5hY3RpdmF0ZS5jYWxsKHRoaXMpO2lmKGEmJnRoaXMubGF5ZXImJnRoaXMubGF5ZXIuZXZlbnRzKXRoaXMubGF5ZXIuZXZlbnRzLm9uKHtza2V0Y2hzdGFydGVkOnRoaXMub25Ta2V0Y2hNb2RpZmllZCxcbnNrZXRjaG1vZGlmaWVkOnRoaXMub25Ta2V0Y2hNb2RpZmllZCx2ZXJ0ZXhtb2RpZmllZDp0aGlzLm9uVmVydGV4TW9kaWZpZWQsc2NvcGU6dGhpc30pO3JldHVybiBhfSxkZWFjdGl2YXRlOmZ1bmN0aW9uKCl7dmFyIGE9T3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5kZWFjdGl2YXRlLmNhbGwodGhpcyk7YSYmdGhpcy5sYXllciYmdGhpcy5sYXllci5ldmVudHMmJnRoaXMubGF5ZXIuZXZlbnRzLnVuKHtza2V0Y2hzdGFydGVkOnRoaXMub25Ta2V0Y2hNb2RpZmllZCxza2V0Y2htb2RpZmllZDp0aGlzLm9uU2tldGNoTW9kaWZpZWQsdmVydGV4bW9kaWZpZWQ6dGhpcy5vblZlcnRleE1vZGlmaWVkLHNjb3BlOnRoaXN9KTt0aGlzLnBvaW50PXRoaXMuZmVhdHVyZT1udWxsO3JldHVybiBhfSxvblNrZXRjaE1vZGlmaWVkOmZ1bmN0aW9uKGEpe3RoaXMuZmVhdHVyZT1hLmZlYXR1cmU7dGhpcy5jb25zaWRlclNuYXBwaW5nKGEudmVydGV4LGEudmVydGV4KX0sb25WZXJ0ZXhNb2RpZmllZDpmdW5jdGlvbihhKXt0aGlzLmZlYXR1cmU9XG5hLmZlYXR1cmU7dmFyIGI9dGhpcy5sYXllci5tYXAuZ2V0TG9uTGF0RnJvbVZpZXdQb3J0UHgoYS5waXhlbCk7dGhpcy5jb25zaWRlclNuYXBwaW5nKGEudmVydGV4LG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGIubG9uLGIubGF0KSl9LGNvbnNpZGVyU25hcHBpbmc6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9e3Jhbms6TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLGRpc3Q6TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLHg6bnVsbCx5Om51bGx9LGQ9ITEsZSxmLGc9MCxoPXRoaXMudGFyZ2V0cy5sZW5ndGg7ZzxoOysrZylpZihmPXRoaXMudGFyZ2V0c1tnXSxlPXRoaXMudGVzdFRhcmdldChmLGIpKWlmKHRoaXMuZ3JlZWR5KXtjPWU7Yy50YXJnZXQ9ZjtkPSEwO2JyZWFrfWVsc2UgaWYoZS5yYW5rPGMucmFua3x8ZS5yYW5rPT09Yy5yYW5rJiZlLmRpc3Q8Yy5kaXN0KWM9ZSxjLnRhcmdldD1mLGQ9ITA7ZCYmKCExIT09dGhpcy5ldmVudHMudHJpZ2dlckV2ZW50KFwiYmVmb3Jlc25hcFwiLFxue3BvaW50OmEseDpjLngseTpjLnksZGlzdGFuY2U6Yy5kaXN0LGxheWVyOmMudGFyZ2V0LmxheWVyLHNuYXBUeXBlOnRoaXMucHJlY2VkZW5jZVtjLnJhbmtdfSk/KGEueD1jLngsYS55PWMueSx0aGlzLnBvaW50PWEsdGhpcy5ldmVudHMudHJpZ2dlckV2ZW50KFwic25hcFwiLHtwb2ludDphLHNuYXBUeXBlOnRoaXMucHJlY2VkZW5jZVtjLnJhbmtdLGxheWVyOmMudGFyZ2V0LmxheWVyLGRpc3RhbmNlOmMuZGlzdH0pKTpkPSExKTt0aGlzLnBvaW50JiYhZCYmKGEueD1iLngsYS55PWIueSx0aGlzLnBvaW50PW51bGwsdGhpcy5ldmVudHMudHJpZ2dlckV2ZW50KFwidW5zbmFwXCIse3BvaW50OmF9KSl9LHRlc3RUYXJnZXQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmxheWVyLm1hcC5nZXRSZXNvbHV0aW9uKCk7aWYoXCJtaW5SZXNvbHV0aW9uXCJpbiBhJiZjPGEubWluUmVzb2x1dGlvbnx8XCJtYXhSZXNvbHV0aW9uXCJpbiBhJiZjPj1hLm1heFJlc29sdXRpb24pcmV0dXJuIG51bGw7Zm9yKHZhciBjPVxue25vZGU6dGhpcy5nZXRHZW9Ub2xlcmFuY2UoYS5ub2RlVG9sZXJhbmNlLGMpLHZlcnRleDp0aGlzLmdldEdlb1RvbGVyYW5jZShhLnZlcnRleFRvbGVyYW5jZSxjKSxlZGdlOnRoaXMuZ2V0R2VvVG9sZXJhbmNlKGEuZWRnZVRvbGVyYW5jZSxjKX0sZD1NYXRoLm1heChjLm5vZGUsYy52ZXJ0ZXgsYy5lZGdlKSxlPXtyYW5rOk51bWJlci5QT1NJVElWRV9JTkZJTklUWSxkaXN0Ok51bWJlci5QT1NJVElWRV9JTkZJTklUWX0sZj0hMSxnPWEubGF5ZXIuZmVhdHVyZXMsaCxpLGosayxsLG0sbj10aGlzLnByZWNlZGVuY2UubGVuZ3RoLG89bmV3IE9wZW5MYXllcnMuTG9uTGF0KGIueCxiLnkpLHA9MCxxPWcubGVuZ3RoO3A8cTsrK3ApaWYoaD1nW3BdLGghPT10aGlzLmZlYXR1cmUmJighaC5fc2tldGNoJiZoLnN0YXRlIT09T3BlbkxheWVycy5TdGF0ZS5ERUxFVEUmJighYS5maWx0ZXJ8fGEuZmlsdGVyLmV2YWx1YXRlKGgpKSkmJmguYXRQb2ludChvLGQsZCkpZm9yKHZhciByPTAscz1NYXRoLm1pbihlLnJhbmsrXG4xLG4pO3I8czsrK3IpaWYoaT10aGlzLnByZWNlZGVuY2Vbcl0sYVtpXSlpZihcImVkZ2VcIj09PWkpe2lmKGo9aC5nZW9tZXRyeS5kaXN0YW5jZVRvKGIse2RldGFpbHM6ITB9KSxsPWouZGlzdGFuY2UsbDw9Y1tpXSYmbDxlLmRpc3Qpe2U9e3Jhbms6cixkaXN0OmwseDpqLngwLHk6ai55MH07Zj0hMDticmVha319ZWxzZXtqPWguZ2VvbWV0cnkuZ2V0VmVydGljZXMoXCJub2RlXCI9PT1pKTttPSExO2Zvcih2YXIgdD0wLHU9ai5sZW5ndGg7dDx1OysrdClpZihrPWpbdF0sbD1rLmRpc3RhbmNlVG8oYiksbDw9Y1tpXSYmKHI8ZS5yYW5rfHxyPT09ZS5yYW5rJiZsPGUuZGlzdCkpZT17cmFuazpyLGRpc3Q6bCx4OmsueCx5OmsueX0sbT1mPSEwO2lmKG0pYnJlYWt9cmV0dXJuIGY/ZTpudWxsfSxnZXRHZW9Ub2xlcmFuY2U6ZnVuY3Rpb24oYSxiKXtiIT09dGhpcy5yZXNvbHV0aW9uJiYodGhpcy5yZXNvbHV0aW9uPWIsdGhpcy5nZW9Ub2xlcmFuY2VDYWNoZT17fSk7dmFyIGM9dGhpcy5nZW9Ub2xlcmFuY2VDYWNoZVthXTtcbnZvaWQgMD09PWMmJihjPWEqYix0aGlzLmdlb1RvbGVyYW5jZUNhY2hlW2FdPWMpO3JldHVybiBjfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5hY3RpdmUmJnRoaXMuZGVhY3RpdmF0ZSgpO2RlbGV0ZSB0aGlzLmxheWVyO2RlbGV0ZSB0aGlzLnRhcmdldHM7T3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5kZXN0cm95LmNhbGwodGhpcyl9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkNvbnRyb2wuU25hcHBpbmdcIn0pO09wZW5MYXllcnMuRGF0ZT17dG9JU09TdHJpbmc6ZnVuY3Rpb24oKXtpZihcInRvSVNPU3RyaW5nXCJpbiBEYXRlLnByb3RvdHlwZSlyZXR1cm4gZnVuY3Rpb24oYSl7cmV0dXJuIGEudG9JU09TdHJpbmcoKX07dmFyIGE9ZnVuY3Rpb24oYSxjKXtmb3IodmFyIGQ9YStcIlwiO2QubGVuZ3RoPGM7KWQ9XCIwXCIrZDtyZXR1cm4gZH07cmV0dXJuIGZ1bmN0aW9uKGIpe3JldHVybiBpc05hTihiLmdldFRpbWUoKSk/XCJJbnZhbGlkIERhdGVcIjpiLmdldFVUQ0Z1bGxZZWFyKCkrXCItXCIrYShiLmdldFVUQ01vbnRoKCkrMSwyKStcIi1cIithKGIuZ2V0VVRDRGF0ZSgpLDIpK1wiVFwiK2EoYi5nZXRVVENIb3VycygpLDIpK1wiOlwiK2EoYi5nZXRVVENNaW51dGVzKCksMikrXCI6XCIrYShiLmdldFVUQ1NlY29uZHMoKSwyKStcIi5cIithKGIuZ2V0VVRDTWlsbGlzZWNvbmRzKCksMykrXCJaXCJ9fSgpLHBhcnNlOmZ1bmN0aW9uKGEpe3ZhciBiO2lmKChhPWEubWF0Y2goL14oPzooXFxkezR9KSg/Oi0oXFxkezJ9KSg/Oi0oXFxkezJ9KSk/KT8pPyg/Oig/OlQoXFxkezEsMn0pOihcXGR7Mn0pOihcXGR7Mn0oPzpcXC5cXGQrKT8pKFp8KD86WystXVxcZHsxLDJ9KD86OihcXGR7Mn0pKT8pKSl8Wik/JC8pKSYmXG4oYVsxXXx8YVs3XSkpe2I9cGFyc2VJbnQoYVsxXSwxMCl8fDA7dmFyIGM9cGFyc2VJbnQoYVsyXSwxMCktMXx8MCxkPXBhcnNlSW50KGFbM10sMTApfHwxO2I9bmV3IERhdGUoRGF0ZS5VVEMoYixjLGQpKTtpZihjPWFbN10pe3ZhciBkPXBhcnNlSW50KGFbNF0sMTApLGU9cGFyc2VJbnQoYVs1XSwxMCksZj1wYXJzZUZsb2F0KGFbNl0pLGc9ZnwwLGY9TWF0aC5yb3VuZCgxRTMqKGYtZykpO2Iuc2V0VVRDSG91cnMoZCxlLGcsZik7XCJaXCIhPT1jJiYoYz1wYXJzZUludChjLDEwKSxhPXBhcnNlSW50KGFbOF0sMTApfHwwLGI9bmV3IERhdGUoYi5nZXRUaW1lKCkrLTFFMyooNjAqNjAqYys2MCphKSkpfX1lbHNlIGI9bmV3IERhdGUoXCJpbnZhbGlkXCIpO3JldHVybiBifX07KGZ1bmN0aW9uKCl7ZnVuY3Rpb24gYSgpe3RoaXMuX29iamVjdD1mJiYhaT9uZXcgZjpuZXcgd2luZG93LkFjdGl2ZVhPYmplY3QoXCJNaWNyb3NvZnQuWE1MSFRUUFwiKTt0aGlzLl9saXN0ZW5lcnM9W119ZnVuY3Rpb24gYigpe3JldHVybiBuZXcgYX1mdW5jdGlvbiBjKGEpe2Iub25yZWFkeXN0YXRlY2hhbmdlJiZiLm9ucmVhZHlzdGF0ZWNoYW5nZS5hcHBseShhKTthLmRpc3BhdGNoRXZlbnQoe3R5cGU6XCJyZWFkeXN0YXRlY2hhbmdlXCIsYnViYmxlczohMSxjYW5jZWxhYmxlOiExLHRpbWVTdGFtcDpuZXcgRGF0ZSswfSl9ZnVuY3Rpb24gZChhKXt0cnl7YS5yZXNwb25zZVRleHQ9YS5fb2JqZWN0LnJlc3BvbnNlVGV4dH1jYXRjaChiKXt9dHJ5e3ZhciBjO3ZhciBkPWEuX29iamVjdCxlPWQucmVzcG9uc2VYTUwsZj1kLnJlc3BvbnNlVGV4dDtoJiYoZiYmZSYmIWUuZG9jdW1lbnRFbGVtZW50JiZkLmdldFJlc3BvbnNlSGVhZGVyKFwiQ29udGVudC1UeXBlXCIpLm1hdGNoKC9bXlxcL10rXFwvW15cXCtdK1xcK3htbC8pKSYmXG4oZT1uZXcgd2luZG93LkFjdGl2ZVhPYmplY3QoXCJNaWNyb3NvZnQuWE1MRE9NXCIpLGUuYXN5bmM9ITEsZS52YWxpZGF0ZU9uUGFyc2U9ITEsZS5sb2FkWE1MKGYpKTtjPWUmJihoJiYwIT1lLnBhcnNlRXJyb3J8fCFlLmRvY3VtZW50RWxlbWVudHx8ZS5kb2N1bWVudEVsZW1lbnQmJlwicGFyc2VyZXJyb3JcIj09ZS5kb2N1bWVudEVsZW1lbnQudGFnTmFtZSk/bnVsbDplO2EucmVzcG9uc2VYTUw9Y31jYXRjaChnKXt9dHJ5e2Euc3RhdHVzPWEuX29iamVjdC5zdGF0dXN9Y2F0Y2goaSl7fXRyeXthLnN0YXR1c1RleHQ9YS5fb2JqZWN0LnN0YXR1c1RleHR9Y2F0Y2gocil7fX1mdW5jdGlvbiBlKGEpe2EuX29iamVjdC5vbnJlYWR5c3RhdGVjaGFuZ2U9bmV3IHdpbmRvdy5GdW5jdGlvbn12YXIgZj13aW5kb3cuWE1MSHR0cFJlcXVlc3QsZz0hIXdpbmRvdy5jb250cm9sbGVycyxoPXdpbmRvdy5kb2N1bWVudC5hbGwmJiF3aW5kb3cub3BlcmEsaT1oJiZ3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvTVNJRSA3LjAvKTtcbmIucHJvdG90eXBlPWEucHJvdG90eXBlO2cmJmYud3JhcHBlZCYmKGIud3JhcHBlZD1mLndyYXBwZWQpO2IuVU5TRU5UPTA7Yi5PUEVORUQ9MTtiLkhFQURFUlNfUkVDRUlWRUQ9MjtiLkxPQURJTkc9MztiLkRPTkU9NDtiLnByb3RvdHlwZS5yZWFkeVN0YXRlPWIuVU5TRU5UO2IucHJvdG90eXBlLnJlc3BvbnNlVGV4dD1cIlwiO2IucHJvdG90eXBlLnJlc3BvbnNlWE1MPW51bGw7Yi5wcm90b3R5cGUuc3RhdHVzPTA7Yi5wcm90b3R5cGUuc3RhdHVzVGV4dD1cIlwiO2IucHJvdG90eXBlLnByaW9yaXR5PVwiTk9STUFMXCI7Yi5wcm90b3R5cGUub25yZWFkeXN0YXRlY2hhbmdlPW51bGw7Yi5vbnJlYWR5c3RhdGVjaGFuZ2U9bnVsbDtiLm9ub3Blbj1udWxsO2Iub25zZW5kPW51bGw7Yi5vbmFib3J0PW51bGw7Yi5wcm90b3R5cGUub3Blbj1mdW5jdGlvbihhLGYsaSxtLG4pe2RlbGV0ZSB0aGlzLl9oZWFkZXJzO2FyZ3VtZW50cy5sZW5ndGg8MyYmKGk9dHJ1ZSk7dGhpcy5fYXN5bmM9aTt2YXIgbz1cbnRoaXMscD10aGlzLnJlYWR5U3RhdGUscTtpZihoJiZpKXtxPWZ1bmN0aW9uKCl7aWYocCE9Yi5ET05FKXtlKG8pO28uYWJvcnQoKX19O3dpbmRvdy5hdHRhY2hFdmVudChcIm9udW5sb2FkXCIscSl9Yi5vbm9wZW4mJmIub25vcGVuLmFwcGx5KHRoaXMsYXJndW1lbnRzKTthcmd1bWVudHMubGVuZ3RoPjQ/dGhpcy5fb2JqZWN0Lm9wZW4oYSxmLGksbSxuKTphcmd1bWVudHMubGVuZ3RoPjM/dGhpcy5fb2JqZWN0Lm9wZW4oYSxmLGksbSk6dGhpcy5fb2JqZWN0Lm9wZW4oYSxmLGkpO3RoaXMucmVhZHlTdGF0ZT1iLk9QRU5FRDtjKHRoaXMpO3RoaXMuX29iamVjdC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKXtpZighZ3x8aSl7by5yZWFkeVN0YXRlPW8uX29iamVjdC5yZWFkeVN0YXRlO2Qobyk7aWYoby5fYWJvcnRlZClvLnJlYWR5U3RhdGU9Yi5VTlNFTlQ7ZWxzZXtpZihvLnJlYWR5U3RhdGU9PWIuRE9ORSl7ZGVsZXRlIG8uX2RhdGE7ZShvKTtoJiZpJiZ3aW5kb3cuZGV0YWNoRXZlbnQoXCJvbnVubG9hZFwiLFxucSl9cCE9by5yZWFkeVN0YXRlJiZjKG8pO3A9by5yZWFkeVN0YXRlfX19fTtiLnByb3RvdHlwZS5zZW5kPWZ1bmN0aW9uKGEpe2Iub25zZW5kJiZiLm9uc2VuZC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7YXJndW1lbnRzLmxlbmd0aHx8KGE9bnVsbCk7aWYoYSYmYS5ub2RlVHlwZSl7YT13aW5kb3cuWE1MU2VyaWFsaXplcj8obmV3IHdpbmRvdy5YTUxTZXJpYWxpemVyKS5zZXJpYWxpemVUb1N0cmluZyhhKTphLnhtbDt0aGlzLl9oZWFkZXJzW1wiQ29udGVudC1UeXBlXCJdfHx0aGlzLl9vYmplY3Quc2V0UmVxdWVzdEhlYWRlcihcIkNvbnRlbnQtVHlwZVwiLFwiYXBwbGljYXRpb24veG1sXCIpfXRoaXMuX2RhdGE9YTthOnt0aGlzLl9vYmplY3Quc2VuZCh0aGlzLl9kYXRhKTtpZihnJiYhdGhpcy5fYXN5bmMpe3RoaXMucmVhZHlTdGF0ZT1iLk9QRU5FRDtmb3IoZCh0aGlzKTt0aGlzLnJlYWR5U3RhdGU8Yi5ET05FOyl7dGhpcy5yZWFkeVN0YXRlKys7Yyh0aGlzKTtpZih0aGlzLl9hYm9ydGVkKWJyZWFrIGF9fX19O1xuYi5wcm90b3R5cGUuYWJvcnQ9ZnVuY3Rpb24oKXtiLm9uYWJvcnQmJmIub25hYm9ydC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7aWYodGhpcy5yZWFkeVN0YXRlPmIuVU5TRU5UKXRoaXMuX2Fib3J0ZWQ9dHJ1ZTt0aGlzLl9vYmplY3QuYWJvcnQoKTtlKHRoaXMpO3RoaXMucmVhZHlTdGF0ZT1iLlVOU0VOVDtkZWxldGUgdGhpcy5fZGF0YX07Yi5wcm90b3R5cGUuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX29iamVjdC5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKX07Yi5wcm90b3R5cGUuZ2V0UmVzcG9uc2VIZWFkZXI9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuX29iamVjdC5nZXRSZXNwb25zZUhlYWRlcihhKX07Yi5wcm90b3R5cGUuc2V0UmVxdWVzdEhlYWRlcj1mdW5jdGlvbihhLGIpe2lmKCF0aGlzLl9oZWFkZXJzKXRoaXMuX2hlYWRlcnM9e307dGhpcy5faGVhZGVyc1thXT1iO3JldHVybiB0aGlzLl9vYmplY3Quc2V0UmVxdWVzdEhlYWRlcihhLFxuYil9O2IucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXI9ZnVuY3Rpb24oYSxiLGMpe2Zvcih2YXIgZD0wLGU7ZT10aGlzLl9saXN0ZW5lcnNbZF07ZCsrKWlmKGVbMF09PWEmJmVbMV09PWImJmVbMl09PWMpcmV0dXJuO3RoaXMuX2xpc3RlbmVycy5wdXNoKFthLGIsY10pfTtiLnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVyPWZ1bmN0aW9uKGEsYixjKXtmb3IodmFyIGQ9MCxlO2U9dGhpcy5fbGlzdGVuZXJzW2RdO2QrKylpZihlWzBdPT1hJiZlWzFdPT1iJiZlWzJdPT1jKWJyZWFrO2UmJnRoaXMuX2xpc3RlbmVycy5zcGxpY2UoZCwxKX07Yi5wcm90b3R5cGUuZGlzcGF0Y2hFdmVudD1mdW5jdGlvbihhKXthPXt0eXBlOmEudHlwZSx0YXJnZXQ6dGhpcyxjdXJyZW50VGFyZ2V0OnRoaXMsZXZlbnRQaGFzZToyLGJ1YmJsZXM6YS5idWJibGVzLGNhbmNlbGFibGU6YS5jYW5jZWxhYmxlLHRpbWVTdGFtcDphLnRpbWVTdGFtcCxzdG9wUHJvcGFnYXRpb246ZnVuY3Rpb24oKXt9LHByZXZlbnREZWZhdWx0OmZ1bmN0aW9uKCl7fSxcbmluaXRFdmVudDpmdW5jdGlvbigpe319O2EudHlwZT09XCJyZWFkeXN0YXRlY2hhbmdlXCImJnRoaXMub25yZWFkeXN0YXRlY2hhbmdlJiYodGhpcy5vbnJlYWR5c3RhdGVjaGFuZ2UuaGFuZGxlRXZlbnR8fHRoaXMub25yZWFkeXN0YXRlY2hhbmdlKS5hcHBseSh0aGlzLFthXSk7Zm9yKHZhciBiPTAsYztjPXRoaXMuX2xpc3RlbmVyc1tiXTtiKyspY1swXT09YS50eXBlJiYhY1syXSYmKGNbMV0uaGFuZGxlRXZlbnR8fGNbMV0pLmFwcGx5KHRoaXMsW2FdKX07Yi5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm5cIltvYmplY3QgWE1MSHR0cFJlcXVlc3RdXCJ9O2IudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm5cIltYTUxIdHRwUmVxdWVzdF1cIn07d2luZG93LkZ1bmN0aW9uLnByb3RvdHlwZS5hcHBseXx8KHdpbmRvdy5GdW5jdGlvbi5wcm90b3R5cGUuYXBwbHk9ZnVuY3Rpb24oYSxiKXtifHwoYj1bXSk7YS5fX2Z1bmM9dGhpczthLl9fZnVuYyhiWzBdLGJbMV0sYlsyXSxiWzNdLFxuYls0XSk7ZGVsZXRlIGEuX19mdW5jfSk7T3BlbkxheWVycy5SZXF1ZXN0LlhNTEh0dHBSZXF1ZXN0PWJ9KSgpO09wZW5MYXllcnMuRm9ybWF0LktNTD1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuRm9ybWF0LlhNTCx7bmFtZXNwYWNlczp7a21sOlwiaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC9rbWwvMi4yXCIsZ3g6XCJodHRwOi8vd3d3Lmdvb2dsZS5jb20va21sL2V4dC8yLjJcIn0sa21sbnM6XCJodHRwOi8vZWFydGguZ29vZ2xlLmNvbS9rbWwvMi4wXCIscGxhY2VtYXJrc0Rlc2M6XCJObyBkZXNjcmlwdGlvbiBhdmFpbGFibGVcIixmb2xkZXJzTmFtZTpcIk9wZW5MYXllcnMgZXhwb3J0XCIsZm9sZGVyc0Rlc2M6XCJFeHBvcnRlZCBvbiBcIituZXcgRGF0ZSxleHRyYWN0QXR0cmlidXRlczohMCxrdnBBdHRyaWJ1dGVzOiExLGV4dHJhY3RTdHlsZXM6ITEsZXh0cmFjdFRyYWNrczohMSx0cmFja0F0dHJpYnV0ZXM6bnVsbCxpbnRlcm5hbG5zOm51bGwsZmVhdHVyZXM6bnVsbCxzdHlsZXM6bnVsbCxzdHlsZUJhc2VVcmw6XCJcIixmZXRjaGVkOm51bGwsbWF4RGVwdGg6MCxpbml0aWFsaXplOmZ1bmN0aW9uKGEpe3RoaXMucmVnRXhlcz1cbnt0cmltU3BhY2U6L15cXHMqfFxccyokL2cscmVtb3ZlU3BhY2U6L1xccyovZyxzcGxpdFNwYWNlOi9cXHMrLyx0cmltQ29tbWE6L1xccyosXFxzKi9nLGttbENvbG9yOi8oXFx3ezJ9KShcXHd7Mn0pKFxcd3syfSkoXFx3ezJ9KS8sa21sSWNvblBhbGV0dGU6L3Jvb3Q6XFwvXFwvaWNvbnNcXC9wYWxldHRlLShcXGQrKShcXC5cXHcrKS8sc3RyYWlnaHRCcmFja2V0Oi9cXCRcXFsoLio/KVxcXS9nfTt0aGlzLmV4dGVybmFsUHJvamVjdGlvbj1uZXcgT3BlbkxheWVycy5Qcm9qZWN0aW9uKFwiRVBTRzo0MzI2XCIpO09wZW5MYXllcnMuRm9ybWF0LlhNTC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLFthXSl9LHJlYWQ6ZnVuY3Rpb24oYSl7dGhpcy5mZWF0dXJlcz1bXTt0aGlzLnN0eWxlcz17fTt0aGlzLmZldGNoZWQ9e307cmV0dXJuIHRoaXMucGFyc2VEYXRhKGEse2RlcHRoOjAsc3R5bGVCYXNlVXJsOnRoaXMuc3R5bGVCYXNlVXJsfSl9LHBhcnNlRGF0YTpmdW5jdGlvbihhLGIpe1wic3RyaW5nXCI9PXR5cGVvZiBhJiZcbihhPU9wZW5MYXllcnMuRm9ybWF0LlhNTC5wcm90b3R5cGUucmVhZC5hcHBseSh0aGlzLFthXSkpO2Zvcih2YXIgYz1bXCJMaW5rXCIsXCJOZXR3b3JrTGlua1wiLFwiU3R5bGVcIixcIlN0eWxlTWFwXCIsXCJQbGFjZW1hcmtcIl0sZD0wLGU9Yy5sZW5ndGg7ZDxlOysrZCl7dmFyIGY9Y1tkXSxnPXRoaXMuZ2V0RWxlbWVudHNCeVRhZ05hbWVOUyhhLFwiKlwiLGYpO2lmKDAhPWcubGVuZ3RoKXN3aXRjaChmLnRvTG93ZXJDYXNlKCkpe2Nhc2UgXCJsaW5rXCI6Y2FzZSBcIm5ldHdvcmtsaW5rXCI6dGhpcy5wYXJzZUxpbmtzKGcsYik7YnJlYWs7Y2FzZSBcInN0eWxlXCI6dGhpcy5leHRyYWN0U3R5bGVzJiZ0aGlzLnBhcnNlU3R5bGVzKGcsYik7YnJlYWs7Y2FzZSBcInN0eWxlbWFwXCI6dGhpcy5leHRyYWN0U3R5bGVzJiZ0aGlzLnBhcnNlU3R5bGVNYXBzKGcsYik7YnJlYWs7Y2FzZSBcInBsYWNlbWFya1wiOnRoaXMucGFyc2VGZWF0dXJlcyhnLGIpfX1yZXR1cm4gdGhpcy5mZWF0dXJlc30scGFyc2VMaW5rczpmdW5jdGlvbihhLFxuYil7aWYoYi5kZXB0aD49dGhpcy5tYXhEZXB0aClyZXR1cm4hMTt2YXIgYz1PcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHt9LGIpO2MuZGVwdGgrKztmb3IodmFyIGQ9MCxlPWEubGVuZ3RoO2Q8ZTtkKyspe3ZhciBmPXRoaXMucGFyc2VQcm9wZXJ0eShhW2RdLFwiKlwiLFwiaHJlZlwiKTtmJiYhdGhpcy5mZXRjaGVkW2ZdJiYodGhpcy5mZXRjaGVkW2ZdPSEwLChmPXRoaXMuZmV0Y2hMaW5rKGYpKSYmdGhpcy5wYXJzZURhdGEoZixjKSl9fSxmZXRjaExpbms6ZnVuY3Rpb24oYSl7aWYoYT1PcGVuTGF5ZXJzLlJlcXVlc3QuR0VUKHt1cmw6YSxhc3luYzohMX0pKXJldHVybiBhLnJlc3BvbnNlVGV4dH0scGFyc2VTdHlsZXM6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9MCxkPWEubGVuZ3RoO2M8ZDtjKyspe3ZhciBlPXRoaXMucGFyc2VTdHlsZShhW2NdKTtlJiYodGhpcy5zdHlsZXNbKGIuc3R5bGVCYXNlVXJsfHxcIlwiKStcIiNcIitlLmlkXT1lKX19LHBhcnNlS21sQ29sb3I6ZnVuY3Rpb24oYSl7dmFyIGI9XG5udWxsO2EmJihhPWEubWF0Y2godGhpcy5yZWdFeGVzLmttbENvbG9yKSkmJihiPXtjb2xvcjpcIiNcIithWzRdK2FbM10rYVsyXSxvcGFjaXR5OnBhcnNlSW50KGFbMV0sMTYpLzI1NX0pO3JldHVybiBifSxwYXJzZVN0eWxlOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj17fSxjPVtcIkxpbmVTdHlsZVwiLFwiUG9seVN0eWxlXCIsXCJJY29uU3R5bGVcIixcIkJhbGxvb25TdHlsZVwiLFwiTGFiZWxTdHlsZVwiXSxkLGUsZj0wLGc9Yy5sZW5ndGg7ZjxnOysrZilpZihkPWNbZl0sZT10aGlzLmdldEVsZW1lbnRzQnlUYWdOYW1lTlMoYSxcIipcIixkKVswXSlzd2l0Y2goZC50b0xvd2VyQ2FzZSgpKXtjYXNlIFwibGluZXN0eWxlXCI6ZD10aGlzLnBhcnNlUHJvcGVydHkoZSxcIipcIixcImNvbG9yXCIpO2lmKGQ9dGhpcy5wYXJzZUttbENvbG9yKGQpKWIuc3Ryb2tlQ29sb3I9ZC5jb2xvcixiLnN0cm9rZU9wYWNpdHk9ZC5vcGFjaXR5OyhkPXRoaXMucGFyc2VQcm9wZXJ0eShlLFwiKlwiLFwid2lkdGhcIikpJiYoYi5zdHJva2VXaWR0aD1cbmQpO2JyZWFrO2Nhc2UgXCJwb2x5c3R5bGVcIjpkPXRoaXMucGFyc2VQcm9wZXJ0eShlLFwiKlwiLFwiY29sb3JcIik7aWYoZD10aGlzLnBhcnNlS21sQ29sb3IoZCkpYi5maWxsT3BhY2l0eT1kLm9wYWNpdHksYi5maWxsQ29sb3I9ZC5jb2xvcjtcIjBcIj09dGhpcy5wYXJzZVByb3BlcnR5KGUsXCIqXCIsXCJmaWxsXCIpJiYoYi5maWxsQ29sb3I9XCJub25lXCIpO1wiMFwiPT10aGlzLnBhcnNlUHJvcGVydHkoZSxcIipcIixcIm91dGxpbmVcIikmJihiLnN0cm9rZVdpZHRoPVwiMFwiKTticmVhaztjYXNlIFwiaWNvbnN0eWxlXCI6dmFyIGg9cGFyc2VGbG9hdCh0aGlzLnBhcnNlUHJvcGVydHkoZSxcIipcIixcInNjYWxlXCIpfHwxKTtkPTMyKmg7dmFyIGk9MzIqaCxqPXRoaXMuZ2V0RWxlbWVudHNCeVRhZ05hbWVOUyhlLFwiKlwiLFwiSWNvblwiKVswXTtpZihqKXt2YXIgaz10aGlzLnBhcnNlUHJvcGVydHkoaixcIipcIixcImhyZWZcIik7aWYoayl7dmFyIGw9dGhpcy5wYXJzZVByb3BlcnR5KGosXCIqXCIsXCJ3XCIpLG09dGhpcy5wYXJzZVByb3BlcnR5KGosXG5cIipcIixcImhcIik7T3BlbkxheWVycy5TdHJpbmcuc3RhcnRzV2l0aChrLFwiaHR0cDovL21hcHMuZ29vZ2xlLmNvbS9tYXBmaWxlcy9rbWxcIikmJighbCYmIW0pJiYobT1sPTY0LGgvPTIpO2w9bHx8bTttPW18fGw7bCYmKGQ9cGFyc2VJbnQobCkqaCk7bSYmKGk9cGFyc2VJbnQobSkqaCk7aWYobT1rLm1hdGNoKHRoaXMucmVnRXhlcy5rbWxJY29uUGFsZXR0ZSkpbD1tWzFdLG09bVsyXSxrPXRoaXMucGFyc2VQcm9wZXJ0eShqLFwiKlwiLFwieFwiKSxqPXRoaXMucGFyc2VQcm9wZXJ0eShqLFwiKlwiLFwieVwiKSxrPVwiaHR0cDovL21hcHMuZ29vZ2xlLmNvbS9tYXBmaWxlcy9rbWwvcGFsXCIrbCtcIi9pY29uXCIrKDgqKGo/Ny1qLzMyOjcpKyhrP2svMzI6MCkpK207Yi5ncmFwaGljT3BhY2l0eT0xO2IuZXh0ZXJuYWxHcmFwaGljPWt9fWlmKGU9dGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZU5TKGUsXCIqXCIsXCJob3RTcG90XCIpWzBdKWs9cGFyc2VGbG9hdChlLmdldEF0dHJpYnV0ZShcInhcIikpLGo9cGFyc2VGbG9hdChlLmdldEF0dHJpYnV0ZShcInlcIikpLFxubD1lLmdldEF0dHJpYnV0ZShcInh1bml0c1wiKSxcInBpeGVsc1wiPT1sP2IuZ3JhcGhpY1hPZmZzZXQ9LWsqaDpcImluc2V0UGl4ZWxzXCI9PWw/Yi5ncmFwaGljWE9mZnNldD0tZCtrKmg6XCJmcmFjdGlvblwiPT1sJiYoYi5ncmFwaGljWE9mZnNldD0tZCprKSxlPWUuZ2V0QXR0cmlidXRlKFwieXVuaXRzXCIpLFwicGl4ZWxzXCI9PWU/Yi5ncmFwaGljWU9mZnNldD0taStqKmgrMTpcImluc2V0UGl4ZWxzXCI9PWU/Yi5ncmFwaGljWU9mZnNldD0tKGoqaCkrMTpcImZyYWN0aW9uXCI9PWUmJihiLmdyYXBoaWNZT2Zmc2V0PS1pKigxLWopKzEpO2IuZ3JhcGhpY1dpZHRoPWQ7Yi5ncmFwaGljSGVpZ2h0PWk7YnJlYWs7Y2FzZSBcImJhbGxvb25zdHlsZVwiOihlPU9wZW5MYXllcnMuVXRpbC5nZXRYbWxOb2RlVmFsdWUoZSkpJiYoYi5iYWxsb29uU3R5bGU9ZS5yZXBsYWNlKHRoaXMucmVnRXhlcy5zdHJhaWdodEJyYWNrZXQsXCIkeyQxfVwiKSk7YnJlYWs7Y2FzZSBcImxhYmVsc3R5bGVcIjppZihkPXRoaXMucGFyc2VQcm9wZXJ0eShlLFxuXCIqXCIsXCJjb2xvclwiKSxkPXRoaXMucGFyc2VLbWxDb2xvcihkKSliLmZvbnRDb2xvcj1kLmNvbG9yLGIuZm9udE9wYWNpdHk9ZC5vcGFjaXR5fSFiLnN0cm9rZUNvbG9yJiZiLmZpbGxDb2xvciYmKGIuc3Ryb2tlQ29sb3I9Yi5maWxsQ29sb3IpO2lmKChhPWEuZ2V0QXR0cmlidXRlKFwiaWRcIikpJiZiKWIuaWQ9YTtyZXR1cm4gYn0scGFyc2VTdHlsZU1hcHM6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9MCxkPWEubGVuZ3RoO2M8ZDtjKyspZm9yKHZhciBlPWFbY10sZj10aGlzLmdldEVsZW1lbnRzQnlUYWdOYW1lTlMoZSxcIipcIixcIlBhaXJcIiksZT1lLmdldEF0dHJpYnV0ZShcImlkXCIpLGc9MCxoPWYubGVuZ3RoO2c8aDtnKyspe3ZhciBpPWZbZ10saj10aGlzLnBhcnNlUHJvcGVydHkoaSxcIipcIixcImtleVwiKTsoaT10aGlzLnBhcnNlUHJvcGVydHkoaSxcIipcIixcInN0eWxlVXJsXCIpKSYmXCJub3JtYWxcIj09aiYmKHRoaXMuc3R5bGVzWyhiLnN0eWxlQmFzZVVybHx8XCJcIikrXCIjXCIrZV09dGhpcy5zdHlsZXNbKGIuc3R5bGVCYXNlVXJsfHxcblwiXCIpK2ldKX19LHBhcnNlRmVhdHVyZXM6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9W10sZD0wLGU9YS5sZW5ndGg7ZDxlO2QrKyl7dmFyIGY9YVtkXSxnPXRoaXMucGFyc2VGZWF0dXJlLmFwcGx5KHRoaXMsW2ZdKTtpZihnKXt0aGlzLmV4dHJhY3RTdHlsZXMmJihnLmF0dHJpYnV0ZXMmJmcuYXR0cmlidXRlcy5zdHlsZVVybCkmJihnLnN0eWxlPXRoaXMuZ2V0U3R5bGUoZy5hdHRyaWJ1dGVzLnN0eWxlVXJsLGIpKTtpZih0aGlzLmV4dHJhY3RTdHlsZXMpe3ZhciBoPXRoaXMuZ2V0RWxlbWVudHNCeVRhZ05hbWVOUyhmLFwiKlwiLFwiU3R5bGVcIilbMF07aWYoaCYmKGg9dGhpcy5wYXJzZVN0eWxlKGgpKSlnLnN0eWxlPU9wZW5MYXllcnMuVXRpbC5leHRlbmQoZy5zdHlsZSxoKX1pZih0aGlzLmV4dHJhY3RUcmFja3Mpe2lmKChmPXRoaXMuZ2V0RWxlbWVudHNCeVRhZ05hbWVOUyhmLHRoaXMubmFtZXNwYWNlcy5neCxcIlRyYWNrXCIpKSYmMDxmLmxlbmd0aClnPXtmZWF0dXJlczpbXSxmZWF0dXJlOmd9LFxudGhpcy5yZWFkTm9kZShmWzBdLGcpLDA8Zy5mZWF0dXJlcy5sZW5ndGgmJmMucHVzaC5hcHBseShjLGcuZmVhdHVyZXMpfWVsc2UgYy5wdXNoKGcpfWVsc2UgdGhyb3dcIkJhZCBQbGFjZW1hcms6IFwiK2Q7fXRoaXMuZmVhdHVyZXM9dGhpcy5mZWF0dXJlcy5jb25jYXQoYyl9LHJlYWRlcnM6e2ttbDp7d2hlbjpmdW5jdGlvbihhLGIpe2Iud2hlbnMucHVzaChPcGVuTGF5ZXJzLkRhdGUucGFyc2UodGhpcy5nZXRDaGlsZFZhbHVlKGEpKSl9LF90cmFja1BvaW50QXR0cmlidXRlOmZ1bmN0aW9uKGEsYil7dmFyIGM9YS5ub2RlTmFtZS5zcGxpdChcIjpcIikucG9wKCk7Yi5hdHRyaWJ1dGVzW2NdLnB1c2godGhpcy5nZXRDaGlsZFZhbHVlKGEpKX19LGd4OntUcmFjazpmdW5jdGlvbihhLGIpe3ZhciBjPXt3aGVuczpbXSxwb2ludHM6W10sYW5nbGVzOltdfTtpZih0aGlzLnRyYWNrQXR0cmlidXRlcyl7dmFyIGQ7Yy5hdHRyaWJ1dGVzPXt9O2Zvcih2YXIgZT0wLGY9dGhpcy50cmFja0F0dHJpYnV0ZXMubGVuZ3RoO2U8XG5mOysrZSlkPXRoaXMudHJhY2tBdHRyaWJ1dGVzW2VdLGMuYXR0cmlidXRlc1tkXT1bXSxkIGluIHRoaXMucmVhZGVycy5rbWx8fCh0aGlzLnJlYWRlcnMua21sW2RdPXRoaXMucmVhZGVycy5rbWwuX3RyYWNrUG9pbnRBdHRyaWJ1dGUpfXRoaXMucmVhZENoaWxkTm9kZXMoYSxjKTtpZihjLndoZW5zLmxlbmd0aCE9PWMucG9pbnRzLmxlbmd0aCl0aHJvdyBFcnJvcihcImd4OlRyYWNrIHdpdGggdW5lcXVhbCBudW1iZXIgb2Ygd2hlbiAoXCIrYy53aGVucy5sZW5ndGgrXCIpIGFuZCBneDpjb29yZCAoXCIrYy5wb2ludHMubGVuZ3RoK1wiKSBlbGVtZW50cy5cIik7dmFyIGc9MDxjLmFuZ2xlcy5sZW5ndGg7aWYoZyYmYy53aGVucy5sZW5ndGghPT1jLmFuZ2xlcy5sZW5ndGgpdGhyb3cgRXJyb3IoXCJneDpUcmFjayB3aXRoIHVuZXF1YWwgbnVtYmVyIG9mIHdoZW4gKFwiK2Mud2hlbnMubGVuZ3RoK1wiKSBhbmQgZ3g6YW5nbGVzIChcIitjLmFuZ2xlcy5sZW5ndGgrXCIpIGVsZW1lbnRzLlwiKTtmb3IodmFyIGgsXG5pLGU9MCxmPWMud2hlbnMubGVuZ3RoO2U8ZjsrK2Upe2g9Yi5mZWF0dXJlLmNsb25lKCk7aC5maWQ9Yi5mZWF0dXJlLmZpZHx8Yi5mZWF0dXJlLmlkO2k9Yy5wb2ludHNbZV07aC5nZW9tZXRyeT1pO1wielwiaW4gaSYmKGguYXR0cmlidXRlcy5hbHRpdHVkZT1pLnopO3RoaXMuaW50ZXJuYWxQcm9qZWN0aW9uJiZ0aGlzLmV4dGVybmFsUHJvamVjdGlvbiYmaC5nZW9tZXRyeS50cmFuc2Zvcm0odGhpcy5leHRlcm5hbFByb2plY3Rpb24sdGhpcy5pbnRlcm5hbFByb2plY3Rpb24pO2lmKHRoaXMudHJhY2tBdHRyaWJ1dGVzKXtpPTA7Zm9yKHZhciBqPXRoaXMudHJhY2tBdHRyaWJ1dGVzLmxlbmd0aDtpPGo7KytpKWguYXR0cmlidXRlc1tkXT1jLmF0dHJpYnV0ZXNbdGhpcy50cmFja0F0dHJpYnV0ZXNbaV1dW2VdfWguYXR0cmlidXRlcy53aGVuPWMud2hlbnNbZV07aC5hdHRyaWJ1dGVzLnRyYWNrSWQ9Yi5mZWF0dXJlLmlkO2cmJihpPWMuYW5nbGVzW2VdLGguYXR0cmlidXRlcy5oZWFkaW5nPVxucGFyc2VGbG9hdChpWzBdKSxoLmF0dHJpYnV0ZXMudGlsdD1wYXJzZUZsb2F0KGlbMV0pLGguYXR0cmlidXRlcy5yb2xsPXBhcnNlRmxvYXQoaVsyXSkpO2IuZmVhdHVyZXMucHVzaChoKX19LGNvb3JkOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5nZXRDaGlsZFZhbHVlKGEpLnJlcGxhY2UodGhpcy5yZWdFeGVzLnRyaW1TcGFjZSxcIlwiKS5zcGxpdCgvXFxzKy8pLGQ9bmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQoY1swXSxjWzFdKTsyPGMubGVuZ3RoJiYoZC56PXBhcnNlRmxvYXQoY1syXSkpO2IucG9pbnRzLnB1c2goZCl9LGFuZ2xlczpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKS5yZXBsYWNlKHRoaXMucmVnRXhlcy50cmltU3BhY2UsXCJcIikuc3BsaXQoL1xccysvKTtiLmFuZ2xlcy5wdXNoKGMpfX19LHBhcnNlRmVhdHVyZTpmdW5jdGlvbihhKXtmb3IodmFyIGI9W1wiTXVsdGlHZW9tZXRyeVwiLFwiUG9seWdvblwiLFwiTGluZVN0cmluZ1wiLFwiUG9pbnRcIl0sXG5jLGQsZSxmPTAsZz1iLmxlbmd0aDtmPGc7KytmKWlmKGM9YltmXSx0aGlzLmludGVybmFsbnM9YS5uYW1lc3BhY2VVUkk/YS5uYW1lc3BhY2VVUkk6dGhpcy5rbWxucyxkPXRoaXMuZ2V0RWxlbWVudHNCeVRhZ05hbWVOUyhhLHRoaXMuaW50ZXJuYWxucyxjKSwwPGQubGVuZ3RoKXtpZihiPXRoaXMucGFyc2VHZW9tZXRyeVtjLnRvTG93ZXJDYXNlKCldKWU9Yi5hcHBseSh0aGlzLFtkWzBdXSksdGhpcy5pbnRlcm5hbFByb2plY3Rpb24mJnRoaXMuZXh0ZXJuYWxQcm9qZWN0aW9uJiZlLnRyYW5zZm9ybSh0aGlzLmV4dGVybmFsUHJvamVjdGlvbix0aGlzLmludGVybmFsUHJvamVjdGlvbik7ZWxzZSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiVW5zdXBwb3J0ZWQgZ2VvbWV0cnkgdHlwZTogXCIrYyk7YnJlYWt9dmFyIGg7dGhpcy5leHRyYWN0QXR0cmlidXRlcyYmKGg9dGhpcy5wYXJzZUF0dHJpYnV0ZXMoYSkpO2M9bmV3IE9wZW5MYXllcnMuRmVhdHVyZS5WZWN0b3IoZSxoKTthPWEuZ2V0QXR0cmlidXRlKFwiaWRcIil8fFxuYS5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpO251bGwhPWEmJihjLmZpZD1hKTtyZXR1cm4gY30sZ2V0U3R5bGU6ZnVuY3Rpb24oYSxiKXt2YXIgYz1PcGVuTGF5ZXJzLlV0aWwucmVtb3ZlVGFpbChhKSxkPU9wZW5MYXllcnMuVXRpbC5leHRlbmQoe30sYik7ZC5kZXB0aCsrO2Quc3R5bGVCYXNlVXJsPWM7IXRoaXMuc3R5bGVzW2FdJiYhT3BlbkxheWVycy5TdHJpbmcuc3RhcnRzV2l0aChhLFwiI1wiKSYmZC5kZXB0aDw9dGhpcy5tYXhEZXB0aCYmIXRoaXMuZmV0Y2hlZFtjXSYmKGM9dGhpcy5mZXRjaExpbmsoYykpJiZ0aGlzLnBhcnNlRGF0YShjLGQpO3JldHVybiBPcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHt9LHRoaXMuc3R5bGVzW2FdKX0scGFyc2VHZW9tZXRyeTp7cG9pbnQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZU5TKGEsdGhpcy5pbnRlcm5hbG5zLFwiY29vcmRpbmF0ZXNcIiksYT1bXTtpZigwPGIubGVuZ3RoKXZhciBjPWJbMF0uZmlyc3RDaGlsZC5ub2RlVmFsdWUsXG5jPWMucmVwbGFjZSh0aGlzLnJlZ0V4ZXMucmVtb3ZlU3BhY2UsXCJcIiksYT1jLnNwbGl0KFwiLFwiKTtiPW51bGw7aWYoMTxhLmxlbmd0aCkyPT1hLmxlbmd0aCYmKGFbMl09bnVsbCksYj1uZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChhWzBdLGFbMV0sYVsyXSk7ZWxzZSB0aHJvd1wiQmFkIGNvb3JkaW5hdGUgc3RyaW5nOiBcIitjO3JldHVybiBifSxsaW5lc3RyaW5nOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZU5TKGEsdGhpcy5pbnRlcm5hbG5zLFwiY29vcmRpbmF0ZXNcIiksZD1udWxsO2lmKDA8Yy5sZW5ndGgpe2Zvcih2YXIgYz10aGlzLmdldENoaWxkVmFsdWUoY1swXSksYz1jLnJlcGxhY2UodGhpcy5yZWdFeGVzLnRyaW1TcGFjZSxcIlwiKSxjPWMucmVwbGFjZSh0aGlzLnJlZ0V4ZXMudHJpbUNvbW1hLFwiLFwiKSxkPWMuc3BsaXQodGhpcy5yZWdFeGVzLnNwbGl0U3BhY2UpLGU9ZC5sZW5ndGgsZj1BcnJheShlKSxnLGgsaT0wO2k8ZTsrK2kpaWYoZz1cbmRbaV0uc3BsaXQoXCIsXCIpLGg9Zy5sZW5ndGgsMTxoKTI9PWcubGVuZ3RoJiYoZ1syXT1udWxsKSxmW2ldPW5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGdbMF0sZ1sxXSxnWzJdKTtlbHNlIHRocm93XCJCYWQgTGluZVN0cmluZyBwb2ludCBjb29yZGluYXRlczogXCIrZFtpXTtpZihlKWQ9Yj9uZXcgT3BlbkxheWVycy5HZW9tZXRyeS5MaW5lYXJSaW5nKGYpOm5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVTdHJpbmcoZik7ZWxzZSB0aHJvd1wiQmFkIExpbmVTdHJpbmcgY29vcmRpbmF0ZXM6IFwiK2M7fXJldHVybiBkfSxwb2x5Z29uOmZ1bmN0aW9uKGEpe3ZhciBhPXRoaXMuZ2V0RWxlbWVudHNCeVRhZ05hbWVOUyhhLHRoaXMuaW50ZXJuYWxucyxcIkxpbmVhclJpbmdcIiksYj1hLmxlbmd0aCxjPUFycmF5KGIpO2lmKDA8Yilmb3IodmFyIGQ9MCxlPWEubGVuZ3RoO2Q8ZTsrK2QpaWYoYj10aGlzLnBhcnNlR2VvbWV0cnkubGluZXN0cmluZy5hcHBseSh0aGlzLFthW2RdLCEwXSkpY1tkXT1cbmI7ZWxzZSB0aHJvd1wiQmFkIExpbmVhclJpbmcgZ2VvbWV0cnk6IFwiK2Q7cmV0dXJuIG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvbHlnb24oYyl9LG11bHRpZ2VvbWV0cnk6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiLGM9W10sZD1hLmNoaWxkTm9kZXMsZT0wLGY9ZC5sZW5ndGg7ZTxmOysrZSlhPWRbZV0sMT09YS5ub2RlVHlwZSYmKGI9dGhpcy5wYXJzZUdlb21ldHJ5WyhhLnByZWZpeD9hLm5vZGVOYW1lLnNwbGl0KFwiOlwiKVsxXTphLm5vZGVOYW1lKS50b0xvd2VyQ2FzZSgpXSkmJmMucHVzaChiLmFwcGx5KHRoaXMsW2FdKSk7cmV0dXJuIG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LkNvbGxlY3Rpb24oYyl9fSxwYXJzZUF0dHJpYnV0ZXM6ZnVuY3Rpb24oYSl7dmFyIGI9e30sYz1hLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiRXh0ZW5kZWREYXRhXCIpO2MubGVuZ3RoJiYoYj10aGlzLnBhcnNlRXh0ZW5kZWREYXRhKGNbMF0pKTtmb3IodmFyIGQsZSxmLGE9YS5jaGlsZE5vZGVzLGM9MCxnPVxuYS5sZW5ndGg7YzxnOysrYylpZihkPWFbY10sMT09ZC5ub2RlVHlwZSYmKGU9ZC5jaGlsZE5vZGVzLDE8PWUubGVuZ3RoJiYzPj1lLmxlbmd0aCkpe3N3aXRjaChlLmxlbmd0aCl7Y2FzZSAxOmY9ZVswXTticmVhaztjYXNlIDI6Zj1lWzBdO2U9ZVsxXTtmPTM9PWYubm9kZVR5cGV8fDQ9PWYubm9kZVR5cGU/ZjplO2JyZWFrO2RlZmF1bHQ6Zj1lWzFdfWlmKDM9PWYubm9kZVR5cGV8fDQ9PWYubm9kZVR5cGUpaWYoZD1kLnByZWZpeD9kLm5vZGVOYW1lLnNwbGl0KFwiOlwiKVsxXTpkLm5vZGVOYW1lLGY9T3BlbkxheWVycy5VdGlsLmdldFhtbE5vZGVWYWx1ZShmKSlmPWYucmVwbGFjZSh0aGlzLnJlZ0V4ZXMudHJpbVNwYWNlLFwiXCIpLGJbZF09Zn1yZXR1cm4gYn0scGFyc2VFeHRlbmRlZERhdGE6ZnVuY3Rpb24oYSl7dmFyIGI9e30sYyxkLGUsZixnPWEuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJEYXRhXCIpO2M9MDtmb3IoZD1nLmxlbmd0aDtjPGQ7YysrKXtlPWdbY107Zj1lLmdldEF0dHJpYnV0ZShcIm5hbWVcIik7XG52YXIgaD17fSxpPWUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJ2YWx1ZVwiKTtpLmxlbmd0aCYmKGgudmFsdWU9dGhpcy5nZXRDaGlsZFZhbHVlKGlbMF0pKTt0aGlzLmt2cEF0dHJpYnV0ZXM/YltmXT1oLnZhbHVlOihlPWUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJkaXNwbGF5TmFtZVwiKSxlLmxlbmd0aCYmKGguZGlzcGxheU5hbWU9dGhpcy5nZXRDaGlsZFZhbHVlKGVbMF0pKSxiW2ZdPWgpfWE9YS5nZXRFbGVtZW50c0J5VGFnTmFtZShcIlNpbXBsZURhdGFcIik7Yz0wO2ZvcihkPWEubGVuZ3RoO2M8ZDtjKyspaD17fSxlPWFbY10sZj1lLmdldEF0dHJpYnV0ZShcIm5hbWVcIiksaC52YWx1ZT10aGlzLmdldENoaWxkVmFsdWUoZSksdGhpcy5rdnBBdHRyaWJ1dGVzP2JbZl09aC52YWx1ZTooaC5kaXNwbGF5TmFtZT1mLGJbZl09aCk7cmV0dXJuIGJ9LHBhcnNlUHJvcGVydHk6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGE9dGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZU5TKGEsYixjKTt0cnl7ZD1PcGVuTGF5ZXJzLlV0aWwuZ2V0WG1sTm9kZVZhbHVlKGFbMF0pfWNhdGNoKGUpe2Q9XG5udWxsfXJldHVybiBkfSx3cml0ZTpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLlV0aWwuaXNBcnJheShhKXx8KGE9W2FdKTtmb3IodmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlModGhpcy5rbWxucyxcImttbFwiKSxjPXRoaXMuY3JlYXRlRm9sZGVyWE1MKCksZD0wLGU9YS5sZW5ndGg7ZDxlOysrZCljLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlUGxhY2VtYXJrWE1MKGFbZF0pKTtiLmFwcGVuZENoaWxkKGMpO3JldHVybiBPcGVuTGF5ZXJzLkZvcm1hdC5YTUwucHJvdG90eXBlLndyaXRlLmFwcGx5KHRoaXMsW2JdKX0sY3JlYXRlRm9sZGVyWE1MOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5jcmVhdGVFbGVtZW50TlModGhpcy5rbWxucyxcIkZvbGRlclwiKTtpZih0aGlzLmZvbGRlcnNOYW1lKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROUyh0aGlzLmttbG5zLFwibmFtZVwiKSxjPXRoaXMuY3JlYXRlVGV4dE5vZGUodGhpcy5mb2xkZXJzTmFtZSk7Yi5hcHBlbmRDaGlsZChjKTthLmFwcGVuZENoaWxkKGIpfXRoaXMuZm9sZGVyc0Rlc2MmJlxuKGI9dGhpcy5jcmVhdGVFbGVtZW50TlModGhpcy5rbWxucyxcImRlc2NyaXB0aW9uXCIpLGM9dGhpcy5jcmVhdGVUZXh0Tm9kZSh0aGlzLmZvbGRlcnNEZXNjKSxiLmFwcGVuZENoaWxkKGMpLGEuYXBwZW5kQ2hpbGQoYikpO3JldHVybiBhfSxjcmVhdGVQbGFjZW1hcmtYTUw6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlModGhpcy5rbWxucyxcIm5hbWVcIik7Yi5hcHBlbmRDaGlsZCh0aGlzLmNyZWF0ZVRleHROb2RlKGEuc3R5bGUmJmEuc3R5bGUubGFiZWw/YS5zdHlsZS5sYWJlbDphLmF0dHJpYnV0ZXMubmFtZXx8YS5pZCkpO3ZhciBjPXRoaXMuY3JlYXRlRWxlbWVudE5TKHRoaXMua21sbnMsXCJkZXNjcmlwdGlvblwiKTtjLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlVGV4dE5vZGUoYS5hdHRyaWJ1dGVzLmRlc2NyaXB0aW9ufHx0aGlzLnBsYWNlbWFya3NEZXNjKSk7dmFyIGQ9dGhpcy5jcmVhdGVFbGVtZW50TlModGhpcy5rbWxucyxcIlBsYWNlbWFya1wiKTtudWxsIT1cbmEuZmlkJiZkLnNldEF0dHJpYnV0ZShcImlkXCIsYS5maWQpO2QuYXBwZW5kQ2hpbGQoYik7ZC5hcHBlbmRDaGlsZChjKTtiPXRoaXMuYnVpbGRHZW9tZXRyeU5vZGUoYS5nZW9tZXRyeSk7ZC5hcHBlbmRDaGlsZChiKTthLmF0dHJpYnV0ZXMmJihhPXRoaXMuYnVpbGRFeHRlbmRlZERhdGEoYS5hdHRyaWJ1dGVzKSkmJmQuYXBwZW5kQ2hpbGQoYSk7cmV0dXJuIGR9LGJ1aWxkR2VvbWV0cnlOb2RlOmZ1bmN0aW9uKGEpe3ZhciBiPWEuQ0xBU1NfTkFNRSxiPXRoaXMuYnVpbGRHZW9tZXRyeVtiLnN1YnN0cmluZyhiLmxhc3RJbmRleE9mKFwiLlwiKSsxKS50b0xvd2VyQ2FzZSgpXSxjPW51bGw7YiYmKGM9Yi5hcHBseSh0aGlzLFthXSkpO3JldHVybiBjfSxidWlsZEdlb21ldHJ5Ontwb2ludDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROUyh0aGlzLmttbG5zLFwiUG9pbnRcIik7Yi5hcHBlbmRDaGlsZCh0aGlzLmJ1aWxkQ29vcmRpbmF0ZXNOb2RlKGEpKTtyZXR1cm4gYn0sbXVsdGlwb2ludDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5idWlsZEdlb21ldHJ5LmNvbGxlY3Rpb24uYXBwbHkodGhpcyxcblthXSl9LGxpbmVzdHJpbmc6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlModGhpcy5rbWxucyxcIkxpbmVTdHJpbmdcIik7Yi5hcHBlbmRDaGlsZCh0aGlzLmJ1aWxkQ29vcmRpbmF0ZXNOb2RlKGEpKTtyZXR1cm4gYn0sbXVsdGlsaW5lc3RyaW5nOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmJ1aWxkR2VvbWV0cnkuY29sbGVjdGlvbi5hcHBseSh0aGlzLFthXSl9LGxpbmVhcnJpbmc6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlModGhpcy5rbWxucyxcIkxpbmVhclJpbmdcIik7Yi5hcHBlbmRDaGlsZCh0aGlzLmJ1aWxkQ29vcmRpbmF0ZXNOb2RlKGEpKTtyZXR1cm4gYn0scG9seWdvbjpmdW5jdGlvbihhKXtmb3IodmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlModGhpcy5rbWxucyxcIlBvbHlnb25cIiksYT1hLmNvbXBvbmVudHMsYyxkLGU9MCxmPWEubGVuZ3RoO2U8ZjsrK2UpYz0wPT1lP1wib3V0ZXJCb3VuZGFyeUlzXCI6XCJpbm5lckJvdW5kYXJ5SXNcIixcbmM9dGhpcy5jcmVhdGVFbGVtZW50TlModGhpcy5rbWxucyxjKSxkPXRoaXMuYnVpbGRHZW9tZXRyeS5saW5lYXJyaW5nLmFwcGx5KHRoaXMsW2FbZV1dKSxjLmFwcGVuZENoaWxkKGQpLGIuYXBwZW5kQ2hpbGQoYyk7cmV0dXJuIGJ9LG11bHRpcG9seWdvbjpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5idWlsZEdlb21ldHJ5LmNvbGxlY3Rpb24uYXBwbHkodGhpcyxbYV0pfSxjb2xsZWN0aW9uOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROUyh0aGlzLmttbG5zLFwiTXVsdGlHZW9tZXRyeVwiKSxjLGQ9MCxlPWEuY29tcG9uZW50cy5sZW5ndGg7ZDxlOysrZCkoYz10aGlzLmJ1aWxkR2VvbWV0cnlOb2RlLmFwcGx5KHRoaXMsW2EuY29tcG9uZW50c1tkXV0pKSYmYi5hcHBlbmRDaGlsZChjKTtyZXR1cm4gYn19LGJ1aWxkQ29vcmRpbmF0ZXNOb2RlOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TKHRoaXMua21sbnMsXCJjb29yZGluYXRlc1wiKSxcbmM7aWYoYz1hLmNvbXBvbmVudHMpe2Zvcih2YXIgZD1jLmxlbmd0aCxlPUFycmF5KGQpLGY9MDtmPGQ7KytmKWE9Y1tmXSxlW2ZdPXRoaXMuYnVpbGRDb29yZGluYXRlcyhhKTtjPWUuam9pbihcIiBcIil9ZWxzZSBjPXRoaXMuYnVpbGRDb29yZGluYXRlcyhhKTtjPXRoaXMuY3JlYXRlVGV4dE5vZGUoYyk7Yi5hcHBlbmRDaGlsZChjKTtyZXR1cm4gYn0sYnVpbGRDb29yZGluYXRlczpmdW5jdGlvbihhKXt0aGlzLmludGVybmFsUHJvamVjdGlvbiYmdGhpcy5leHRlcm5hbFByb2plY3Rpb24mJihhPWEuY2xvbmUoKSxhLnRyYW5zZm9ybSh0aGlzLmludGVybmFsUHJvamVjdGlvbix0aGlzLmV4dGVybmFsUHJvamVjdGlvbikpO3JldHVybiBhLngrXCIsXCIrYS55fSxidWlsZEV4dGVuZGVkRGF0YTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROUyh0aGlzLmttbG5zLFwiRXh0ZW5kZWREYXRhXCIpLGM7Zm9yKGMgaW4gYSlpZihhW2NdJiZcIm5hbWVcIiE9YyYmXCJkZXNjcmlwdGlvblwiIT1cbmMmJlwic3R5bGVVcmxcIiE9Yyl7dmFyIGQ9dGhpcy5jcmVhdGVFbGVtZW50TlModGhpcy5rbWxucyxcIkRhdGFcIik7ZC5zZXRBdHRyaWJ1dGUoXCJuYW1lXCIsYyk7dmFyIGU9dGhpcy5jcmVhdGVFbGVtZW50TlModGhpcy5rbWxucyxcInZhbHVlXCIpO2lmKFwib2JqZWN0XCI9PXR5cGVvZiBhW2NdKXtpZihhW2NdLnZhbHVlJiZlLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlVGV4dE5vZGUoYVtjXS52YWx1ZSkpLGFbY10uZGlzcGxheU5hbWUpe3ZhciBmPXRoaXMuY3JlYXRlRWxlbWVudE5TKHRoaXMua21sbnMsXCJkaXNwbGF5TmFtZVwiKTtmLmFwcGVuZENoaWxkKHRoaXMuZ2V0WE1MRG9jKCkuY3JlYXRlQ0RBVEFTZWN0aW9uKGFbY10uZGlzcGxheU5hbWUpKTtkLmFwcGVuZENoaWxkKGYpfX1lbHNlIGUuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVUZXh0Tm9kZShhW2NdKSk7ZC5hcHBlbmRDaGlsZChlKTtiLmFwcGVuZENoaWxkKGQpfXJldHVybiB0aGlzLmlzU2ltcGxlQ29udGVudChiKT9udWxsOmJ9LFxuQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuRm9ybWF0LktNTFwifSk7T3BlbkxheWVycy5Qb3B1cD1PcGVuTGF5ZXJzLkNsYXNzKHtldmVudHM6bnVsbCxpZDpcIlwiLGxvbmxhdDpudWxsLGRpdjpudWxsLGNvbnRlbnRTaXplOm51bGwsc2l6ZTpudWxsLGNvbnRlbnRIVE1MOm51bGwsYmFja2dyb3VuZENvbG9yOlwiXCIsb3BhY2l0eTpcIlwiLGJvcmRlcjpcIlwiLGNvbnRlbnREaXY6bnVsbCxncm91cERpdjpudWxsLGNsb3NlRGl2Om51bGwsYXV0b1NpemU6ITEsbWluU2l6ZTpudWxsLG1heFNpemU6bnVsbCxkaXNwbGF5Q2xhc3M6XCJvbFBvcHVwXCIsY29udGVudERpc3BsYXlDbGFzczpcIm9sUG9wdXBDb250ZW50XCIscGFkZGluZzowLGRpc2FibGVGaXJlZm94T3ZlcmZsb3dIYWNrOiExLGZpeFBhZGRpbmc6ZnVuY3Rpb24oKXtcIm51bWJlclwiPT10eXBlb2YgdGhpcy5wYWRkaW5nJiYodGhpcy5wYWRkaW5nPW5ldyBPcGVuTGF5ZXJzLkJvdW5kcyh0aGlzLnBhZGRpbmcsdGhpcy5wYWRkaW5nLHRoaXMucGFkZGluZyx0aGlzLnBhZGRpbmcpKX0scGFuTWFwSWZPdXRPZlZpZXc6ITEsXG5rZWVwSW5NYXA6ITEsY2xvc2VPbk1vdmU6ITEsbWFwOm51bGwsaW5pdGlhbGl6ZTpmdW5jdGlvbihhLGIsYyxkLGUsZil7bnVsbD09YSYmKGE9T3BlbkxheWVycy5VdGlsLmNyZWF0ZVVuaXF1ZUlEKHRoaXMuQ0xBU1NfTkFNRStcIl9cIikpO3RoaXMuaWQ9YTt0aGlzLmxvbmxhdD1iO3RoaXMuY29udGVudFNpemU9bnVsbCE9Yz9jOm5ldyBPcGVuTGF5ZXJzLlNpemUoT3BlbkxheWVycy5Qb3B1cC5XSURUSCxPcGVuTGF5ZXJzLlBvcHVwLkhFSUdIVCk7bnVsbCE9ZCYmKHRoaXMuY29udGVudEhUTUw9ZCk7dGhpcy5iYWNrZ3JvdW5kQ29sb3I9T3BlbkxheWVycy5Qb3B1cC5DT0xPUjt0aGlzLm9wYWNpdHk9T3BlbkxheWVycy5Qb3B1cC5PUEFDSVRZO3RoaXMuYm9yZGVyPU9wZW5MYXllcnMuUG9wdXAuQk9SREVSO3RoaXMuZGl2PU9wZW5MYXllcnMuVXRpbC5jcmVhdGVEaXYodGhpcy5pZCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsXCJoaWRkZW5cIik7dGhpcy5kaXYuY2xhc3NOYW1lPXRoaXMuZGlzcGxheUNsYXNzO1xudGhpcy5ncm91cERpdj1PcGVuTGF5ZXJzLlV0aWwuY3JlYXRlRGl2KHRoaXMuaWQrXCJfR3JvdXBEaXZcIixudWxsLG51bGwsbnVsbCxcInJlbGF0aXZlXCIsbnVsbCxcImhpZGRlblwiKTthPXRoaXMuZGl2LmlkK1wiX2NvbnRlbnREaXZcIjt0aGlzLmNvbnRlbnREaXY9T3BlbkxheWVycy5VdGlsLmNyZWF0ZURpdihhLG51bGwsdGhpcy5jb250ZW50U2l6ZS5jbG9uZSgpLG51bGwsXCJyZWxhdGl2ZVwiKTt0aGlzLmNvbnRlbnREaXYuY2xhc3NOYW1lPXRoaXMuY29udGVudERpc3BsYXlDbGFzczt0aGlzLmdyb3VwRGl2LmFwcGVuZENoaWxkKHRoaXMuY29udGVudERpdik7dGhpcy5kaXYuYXBwZW5kQ2hpbGQodGhpcy5ncm91cERpdik7ZSYmdGhpcy5hZGRDbG9zZUJveChmKTt0aGlzLnJlZ2lzdGVyRXZlbnRzKCl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLmJvcmRlcj10aGlzLm9wYWNpdHk9dGhpcy5iYWNrZ3JvdW5kQ29sb3I9dGhpcy5jb250ZW50SFRNTD10aGlzLnNpemU9dGhpcy5sb25sYXQ9dGhpcy5pZD1cbm51bGw7dGhpcy5jbG9zZU9uTW92ZSYmdGhpcy5tYXAmJnRoaXMubWFwLmV2ZW50cy51bnJlZ2lzdGVyKFwibW92ZXN0YXJ0XCIsdGhpcyx0aGlzLmhpZGUpO3RoaXMuZXZlbnRzLmRlc3Ryb3koKTt0aGlzLmV2ZW50cz1udWxsO3RoaXMuY2xvc2VEaXYmJihPcGVuTGF5ZXJzLkV2ZW50LnN0b3BPYnNlcnZpbmdFbGVtZW50KHRoaXMuY2xvc2VEaXYpLHRoaXMuZ3JvdXBEaXYucmVtb3ZlQ2hpbGQodGhpcy5jbG9zZURpdikpO3RoaXMuY2xvc2VEaXY9bnVsbDt0aGlzLmRpdi5yZW1vdmVDaGlsZCh0aGlzLmdyb3VwRGl2KTt0aGlzLmdyb3VwRGl2PW51bGw7bnVsbCE9dGhpcy5tYXAmJnRoaXMubWFwLnJlbW92ZVBvcHVwKHRoaXMpO3RoaXMucGFuTWFwSWZPdXRPZlZpZXc9dGhpcy5wYWRkaW5nPXRoaXMubWF4U2l6ZT10aGlzLm1pblNpemU9dGhpcy5hdXRvU2l6ZT10aGlzLmRpdj10aGlzLm1hcD1udWxsfSxkcmF3OmZ1bmN0aW9uKGEpe251bGw9PWEmJm51bGwhPXRoaXMubG9ubGF0JiZudWxsIT1cbnRoaXMubWFwJiYoYT10aGlzLm1hcC5nZXRMYXllclB4RnJvbUxvbkxhdCh0aGlzLmxvbmxhdCkpO3RoaXMuY2xvc2VPbk1vdmUmJnRoaXMubWFwLmV2ZW50cy5yZWdpc3RlcihcIm1vdmVzdGFydFwiLHRoaXMsdGhpcy5oaWRlKTshdGhpcy5kaXNhYmxlRmlyZWZveE92ZXJmbG93SGFjayYmXCJmaXJlZm94XCI9PU9wZW5MYXllcnMuQlJPV1NFUl9OQU1FJiYodGhpcy5tYXAuZXZlbnRzLnJlZ2lzdGVyKFwibW92ZXN0YXJ0XCIsdGhpcyxmdW5jdGlvbigpe3ZhciBhPWRvY3VtZW50LmRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGUodGhpcy5jb250ZW50RGl2LG51bGwpLmdldFByb3BlcnR5VmFsdWUoXCJvdmVyZmxvd1wiKTtcImhpZGRlblwiIT1hJiYodGhpcy5jb250ZW50RGl2Ll9vbGRPdmVyZmxvdz1hLHRoaXMuY29udGVudERpdi5zdHlsZS5vdmVyZmxvdz1cImhpZGRlblwiKX0pLHRoaXMubWFwLmV2ZW50cy5yZWdpc3RlcihcIm1vdmVlbmRcIix0aGlzLGZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5jb250ZW50RGl2Ll9vbGRPdmVyZmxvdztcbmEmJih0aGlzLmNvbnRlbnREaXYuc3R5bGUub3ZlcmZsb3c9YSx0aGlzLmNvbnRlbnREaXYuX29sZE92ZXJmbG93PW51bGwpfSkpO3RoaXMubW92ZVRvKGEpOyF0aGlzLmF1dG9TaXplJiYhdGhpcy5zaXplJiZ0aGlzLnNldFNpemUodGhpcy5jb250ZW50U2l6ZSk7dGhpcy5zZXRCYWNrZ3JvdW5kQ29sb3IoKTt0aGlzLnNldE9wYWNpdHkoKTt0aGlzLnNldEJvcmRlcigpO3RoaXMuc2V0Q29udGVudEhUTUwoKTt0aGlzLnBhbk1hcElmT3V0T2ZWaWV3JiZ0aGlzLnBhbkludG9WaWV3KCk7cmV0dXJuIHRoaXMuZGl2fSx1cGRhdGVQb3NpdGlvbjpmdW5jdGlvbigpe2lmKHRoaXMubG9ubGF0JiZ0aGlzLm1hcCl7dmFyIGE9dGhpcy5tYXAuZ2V0TGF5ZXJQeEZyb21Mb25MYXQodGhpcy5sb25sYXQpO2EmJnRoaXMubW92ZVRvKGEpfX0sbW92ZVRvOmZ1bmN0aW9uKGEpe251bGwhPWEmJm51bGwhPXRoaXMuZGl2JiYodGhpcy5kaXYuc3R5bGUubGVmdD1hLngrXCJweFwiLHRoaXMuZGl2LnN0eWxlLnRvcD1cbmEueStcInB4XCIpfSx2aXNpYmxlOmZ1bmN0aW9uKCl7cmV0dXJuIE9wZW5MYXllcnMuRWxlbWVudC52aXNpYmxlKHRoaXMuZGl2KX0sdG9nZ2xlOmZ1bmN0aW9uKCl7dGhpcy52aXNpYmxlKCk/dGhpcy5oaWRlKCk6dGhpcy5zaG93KCl9LHNob3c6ZnVuY3Rpb24oKXt0aGlzLmRpdi5zdHlsZS5kaXNwbGF5PVwiXCI7dGhpcy5wYW5NYXBJZk91dE9mVmlldyYmdGhpcy5wYW5JbnRvVmlldygpfSxoaWRlOmZ1bmN0aW9uKCl7dGhpcy5kaXYuc3R5bGUuZGlzcGxheT1cIm5vbmVcIn0sc2V0U2l6ZTpmdW5jdGlvbihhKXt0aGlzLnNpemU9YS5jbG9uZSgpO3ZhciBiPXRoaXMuZ2V0Q29udGVudERpdlBhZGRpbmcoKSxjPWIubGVmdCtiLnJpZ2h0LGQ9Yi50b3ArYi5ib3R0b207dGhpcy5maXhQYWRkaW5nKCk7Yys9dGhpcy5wYWRkaW5nLmxlZnQrdGhpcy5wYWRkaW5nLnJpZ2h0O2QrPXRoaXMucGFkZGluZy50b3ArdGhpcy5wYWRkaW5nLmJvdHRvbTtpZih0aGlzLmNsb3NlRGl2KXZhciBlPXBhcnNlSW50KHRoaXMuY2xvc2VEaXYuc3R5bGUud2lkdGgpLFxuYz1jKyhlK2IucmlnaHQpO3RoaXMuc2l6ZS53Kz1jO3RoaXMuc2l6ZS5oKz1kO1wibXNpZVwiPT1PcGVuTGF5ZXJzLkJST1dTRVJfTkFNRSYmKHRoaXMuY29udGVudFNpemUudys9Yi5sZWZ0K2IucmlnaHQsdGhpcy5jb250ZW50U2l6ZS5oKz1iLmJvdHRvbStiLnRvcCk7bnVsbCE9dGhpcy5kaXYmJih0aGlzLmRpdi5zdHlsZS53aWR0aD10aGlzLnNpemUudytcInB4XCIsdGhpcy5kaXYuc3R5bGUuaGVpZ2h0PXRoaXMuc2l6ZS5oK1wicHhcIik7bnVsbCE9dGhpcy5jb250ZW50RGl2JiYodGhpcy5jb250ZW50RGl2LnN0eWxlLndpZHRoPWEudytcInB4XCIsdGhpcy5jb250ZW50RGl2LnN0eWxlLmhlaWdodD1hLmgrXCJweFwiKX0sdXBkYXRlU2l6ZTpmdW5jdGlvbigpe3ZhciBhPVwiPGRpdiBjbGFzcz0nXCIrdGhpcy5jb250ZW50RGlzcGxheUNsYXNzK1wiJz5cIit0aGlzLmNvbnRlbnREaXYuaW5uZXJIVE1MK1wiPC9kaXY+XCIsYj10aGlzLm1hcD90aGlzLm1hcC5kaXY6ZG9jdW1lbnQuYm9keSxjPU9wZW5MYXllcnMuVXRpbC5nZXRSZW5kZXJlZERpbWVuc2lvbnMoYSxcbm51bGwse2Rpc3BsYXlDbGFzczp0aGlzLmRpc3BsYXlDbGFzcyxjb250YWluZXJFbGVtZW50OmJ9KSxkPXRoaXMuZ2V0U2FmZUNvbnRlbnRTaXplKGMpLGU9bnVsbDtkLmVxdWFscyhjKT9lPWM6KGM9e3c6ZC53PGMudz9kLnc6bnVsbCxoOmQuaDxjLmg/ZC5oOm51bGx9LGMudyYmYy5oP2U9ZDooYT1PcGVuTGF5ZXJzLlV0aWwuZ2V0UmVuZGVyZWREaW1lbnNpb25zKGEsYyx7ZGlzcGxheUNsYXNzOnRoaXMuY29udGVudERpc3BsYXlDbGFzcyxjb250YWluZXJFbGVtZW50OmJ9KSxcImhpZGRlblwiIT1PcGVuTGF5ZXJzLkVsZW1lbnQuZ2V0U3R5bGUodGhpcy5jb250ZW50RGl2LFwib3ZlcmZsb3dcIikmJmEuZXF1YWxzKGQpJiYoZD1PcGVuTGF5ZXJzLlV0aWwuZ2V0U2Nyb2xsYmFyV2lkdGgoKSxjLnc/YS5oKz1kOmEudys9ZCksZT10aGlzLmdldFNhZmVDb250ZW50U2l6ZShhKSkpO3RoaXMuc2V0U2l6ZShlKX0sc2V0QmFja2dyb3VuZENvbG9yOmZ1bmN0aW9uKGEpe3ZvaWQgMCE9YSYmKHRoaXMuYmFja2dyb3VuZENvbG9yPVxuYSk7bnVsbCE9dGhpcy5kaXYmJih0aGlzLmRpdi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3I9dGhpcy5iYWNrZ3JvdW5kQ29sb3IpfSxzZXRPcGFjaXR5OmZ1bmN0aW9uKGEpe3ZvaWQgMCE9YSYmKHRoaXMub3BhY2l0eT1hKTtudWxsIT10aGlzLmRpdiYmKHRoaXMuZGl2LnN0eWxlLm9wYWNpdHk9dGhpcy5vcGFjaXR5LHRoaXMuZGl2LnN0eWxlLmZpbHRlcj1cImFscGhhKG9wYWNpdHk9XCIrMTAwKnRoaXMub3BhY2l0eStcIilcIil9LHNldEJvcmRlcjpmdW5jdGlvbihhKXt2b2lkIDAhPWEmJih0aGlzLmJvcmRlcj1hKTtudWxsIT10aGlzLmRpdiYmKHRoaXMuZGl2LnN0eWxlLmJvcmRlcj10aGlzLmJvcmRlcil9LHNldENvbnRlbnRIVE1MOmZ1bmN0aW9uKGEpe251bGwhPWEmJih0aGlzLmNvbnRlbnRIVE1MPWEpO251bGwhPXRoaXMuY29udGVudERpdiYmKG51bGwhPXRoaXMuY29udGVudEhUTUwmJnRoaXMuY29udGVudEhUTUwhPXRoaXMuY29udGVudERpdi5pbm5lckhUTUwpJiYodGhpcy5jb250ZW50RGl2LmlubmVySFRNTD1cbnRoaXMuY29udGVudEhUTUwsdGhpcy5hdXRvU2l6ZSYmKHRoaXMucmVnaXN0ZXJJbWFnZUxpc3RlbmVycygpLHRoaXMudXBkYXRlU2l6ZSgpKSl9LHJlZ2lzdGVySW1hZ2VMaXN0ZW5lcnM6ZnVuY3Rpb24oKXtmb3IodmFyIGE9ZnVuY3Rpb24oKXtudWxsIT09dGhpcy5wb3B1cC5pZCYmKHRoaXMucG9wdXAudXBkYXRlU2l6ZSgpLHRoaXMucG9wdXAudmlzaWJsZSgpJiZ0aGlzLnBvcHVwLnBhbk1hcElmT3V0T2ZWaWV3JiZ0aGlzLnBvcHVwLnBhbkludG9WaWV3KCksT3BlbkxheWVycy5FdmVudC5zdG9wT2JzZXJ2aW5nKHRoaXMuaW1nLFwibG9hZFwiLHRoaXMuaW1nLl9vbkltYWdlTG9hZCkpfSxiPXRoaXMuY29udGVudERpdi5nZXRFbGVtZW50c0J5VGFnTmFtZShcImltZ1wiKSxjPTAsZD1iLmxlbmd0aDtjPGQ7YysrKXt2YXIgZT1iW2NdO2lmKDA9PWUud2lkdGh8fDA9PWUuaGVpZ2h0KWUuX29uSW1nTG9hZD1PcGVuTGF5ZXJzLkZ1bmN0aW9uLmJpbmQoYSx7cG9wdXA6dGhpcyxpbWc6ZX0pLFxuT3BlbkxheWVycy5FdmVudC5vYnNlcnZlKGUsXCJsb2FkXCIsZS5fb25JbWdMb2FkKX19LGdldFNhZmVDb250ZW50U2l6ZTpmdW5jdGlvbihhKXt2YXIgYT1hLmNsb25lKCksYj10aGlzLmdldENvbnRlbnREaXZQYWRkaW5nKCksYz1iLmxlZnQrYi5yaWdodCxkPWIudG9wK2IuYm90dG9tO3RoaXMuZml4UGFkZGluZygpO2MrPXRoaXMucGFkZGluZy5sZWZ0K3RoaXMucGFkZGluZy5yaWdodDtkKz10aGlzLnBhZGRpbmcudG9wK3RoaXMucGFkZGluZy5ib3R0b207aWYodGhpcy5jbG9zZURpdil2YXIgZT1wYXJzZUludCh0aGlzLmNsb3NlRGl2LnN0eWxlLndpZHRoKSxjPWMrKGUrYi5yaWdodCk7dGhpcy5taW5TaXplJiYoYS53PU1hdGgubWF4KGEudyx0aGlzLm1pblNpemUudy1jKSxhLmg9TWF0aC5tYXgoYS5oLHRoaXMubWluU2l6ZS5oLWQpKTt0aGlzLm1heFNpemUmJihhLnc9TWF0aC5taW4oYS53LHRoaXMubWF4U2l6ZS53LWMpLGEuaD1NYXRoLm1pbihhLmgsdGhpcy5tYXhTaXplLmgtXG5kKSk7aWYodGhpcy5tYXAmJnRoaXMubWFwLnNpemUpe2U9Yj0wO2lmKHRoaXMua2VlcEluTWFwJiYhdGhpcy5wYW5NYXBJZk91dE9mVmlldylzd2l0Y2goZT10aGlzLm1hcC5nZXRQaXhlbEZyb21Mb25MYXQodGhpcy5sb25sYXQpLHRoaXMucmVsYXRpdmVQb3NpdGlvbil7Y2FzZSBcInRyXCI6Yj1lLng7ZT10aGlzLm1hcC5zaXplLmgtZS55O2JyZWFrO2Nhc2UgXCJ0bFwiOmI9dGhpcy5tYXAuc2l6ZS53LWUueDtlPXRoaXMubWFwLnNpemUuaC1lLnk7YnJlYWs7Y2FzZSBcImJsXCI6Yj10aGlzLm1hcC5zaXplLnctZS54O2U9ZS55O2JyZWFrO2Nhc2UgXCJiclwiOmI9ZS54O2U9ZS55O2JyZWFrO2RlZmF1bHQ6Yj1lLngsZT10aGlzLm1hcC5zaXplLmgtZS55fWQ9dGhpcy5tYXAuc2l6ZS5oLXRoaXMubWFwLnBhZGRpbmdGb3JQb3B1cHMudG9wLXRoaXMubWFwLnBhZGRpbmdGb3JQb3B1cHMuYm90dG9tLWQtZTthLnc9TWF0aC5taW4oYS53LHRoaXMubWFwLnNpemUudy10aGlzLm1hcC5wYWRkaW5nRm9yUG9wdXBzLmxlZnQtXG50aGlzLm1hcC5wYWRkaW5nRm9yUG9wdXBzLnJpZ2h0LWMtYik7YS5oPU1hdGgubWluKGEuaCxkKX1yZXR1cm4gYX0sZ2V0Q29udGVudERpdlBhZGRpbmc6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLl9jb250ZW50RGl2UGFkZGluZztpZighYSYmKG51bGw9PXRoaXMuZGl2LnBhcmVudE5vZGUmJih0aGlzLmRpdi5zdHlsZS5kaXNwbGF5PVwibm9uZVwiLGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy5kaXYpKSx0aGlzLl9jb250ZW50RGl2UGFkZGluZz1hPW5ldyBPcGVuTGF5ZXJzLkJvdW5kcyhPcGVuTGF5ZXJzLkVsZW1lbnQuZ2V0U3R5bGUodGhpcy5jb250ZW50RGl2LFwicGFkZGluZy1sZWZ0XCIpLE9wZW5MYXllcnMuRWxlbWVudC5nZXRTdHlsZSh0aGlzLmNvbnRlbnREaXYsXCJwYWRkaW5nLWJvdHRvbVwiKSxPcGVuTGF5ZXJzLkVsZW1lbnQuZ2V0U3R5bGUodGhpcy5jb250ZW50RGl2LFwicGFkZGluZy1yaWdodFwiKSxPcGVuTGF5ZXJzLkVsZW1lbnQuZ2V0U3R5bGUodGhpcy5jb250ZW50RGl2LFxuXCJwYWRkaW5nLXRvcFwiKSksdGhpcy5kaXYucGFyZW50Tm9kZT09ZG9jdW1lbnQuYm9keSkpZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZCh0aGlzLmRpdiksdGhpcy5kaXYuc3R5bGUuZGlzcGxheT1cIlwiO3JldHVybiBhfSxhZGRDbG9zZUJveDpmdW5jdGlvbihhKXt0aGlzLmNsb3NlRGl2PU9wZW5MYXllcnMuVXRpbC5jcmVhdGVEaXYodGhpcy5pZCtcIl9jbG9zZVwiLG51bGwse3c6MTcsaDoxN30pO3RoaXMuY2xvc2VEaXYuY2xhc3NOYW1lPVwib2xQb3B1cENsb3NlQm94XCI7dmFyIGI9dGhpcy5nZXRDb250ZW50RGl2UGFkZGluZygpO3RoaXMuY2xvc2VEaXYuc3R5bGUucmlnaHQ9Yi5yaWdodCtcInB4XCI7dGhpcy5jbG9zZURpdi5zdHlsZS50b3A9Yi50b3ArXCJweFwiO3RoaXMuZ3JvdXBEaXYuYXBwZW5kQ2hpbGQodGhpcy5jbG9zZURpdik7YT1hfHxmdW5jdGlvbihhKXt0aGlzLmhpZGUoKTtPcGVuTGF5ZXJzLkV2ZW50LnN0b3AoYSl9O09wZW5MYXllcnMuRXZlbnQub2JzZXJ2ZSh0aGlzLmNsb3NlRGl2LFxuXCJ0b3VjaGVuZFwiLE9wZW5MYXllcnMuRnVuY3Rpb24uYmluZEFzRXZlbnRMaXN0ZW5lcihhLHRoaXMpKTtPcGVuTGF5ZXJzLkV2ZW50Lm9ic2VydmUodGhpcy5jbG9zZURpdixcImNsaWNrXCIsT3BlbkxheWVycy5GdW5jdGlvbi5iaW5kQXNFdmVudExpc3RlbmVyKGEsdGhpcykpfSxwYW5JbnRvVmlldzpmdW5jdGlvbigpe3ZhciBhPXRoaXMubWFwLmdldFNpemUoKSxiPXRoaXMubWFwLmdldFZpZXdQb3J0UHhGcm9tTGF5ZXJQeChuZXcgT3BlbkxheWVycy5QaXhlbChwYXJzZUludCh0aGlzLmRpdi5zdHlsZS5sZWZ0KSxwYXJzZUludCh0aGlzLmRpdi5zdHlsZS50b3ApKSksYz1iLmNsb25lKCk7Yi54PHRoaXMubWFwLnBhZGRpbmdGb3JQb3B1cHMubGVmdD9jLng9dGhpcy5tYXAucGFkZGluZ0ZvclBvcHVwcy5sZWZ0OmIueCt0aGlzLnNpemUudz5hLnctdGhpcy5tYXAucGFkZGluZ0ZvclBvcHVwcy5yaWdodCYmKGMueD1hLnctdGhpcy5tYXAucGFkZGluZ0ZvclBvcHVwcy5yaWdodC10aGlzLnNpemUudyk7XG5iLnk8dGhpcy5tYXAucGFkZGluZ0ZvclBvcHVwcy50b3A/Yy55PXRoaXMubWFwLnBhZGRpbmdGb3JQb3B1cHMudG9wOmIueSt0aGlzLnNpemUuaD5hLmgtdGhpcy5tYXAucGFkZGluZ0ZvclBvcHVwcy5ib3R0b20mJihjLnk9YS5oLXRoaXMubWFwLnBhZGRpbmdGb3JQb3B1cHMuYm90dG9tLXRoaXMuc2l6ZS5oKTt0aGlzLm1hcC5wYW4oYi54LWMueCxiLnktYy55KX0scmVnaXN0ZXJFdmVudHM6ZnVuY3Rpb24oKXt0aGlzLmV2ZW50cz1uZXcgT3BlbkxheWVycy5FdmVudHModGhpcyx0aGlzLmRpdixudWxsLCEwKTt0aGlzLmV2ZW50cy5vbih7bW91c2Vkb3duOnRoaXMub25tb3VzZWRvd24sbW91c2Vtb3ZlOnRoaXMub25tb3VzZW1vdmUsbW91c2V1cDp0aGlzLm9ubW91c2V1cCxjbGljazp0aGlzLm9uY2xpY2ssbW91c2VvdXQ6dGhpcy5vbm1vdXNlb3V0LGRibGNsaWNrOnRoaXMub25kYmxjbGljayx0b3VjaHN0YXJ0OmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuRXZlbnQuc3RvcChhLCEwKX0sXG5zY29wZTp0aGlzfSl9LG9ubW91c2Vkb3duOmZ1bmN0aW9uKGEpe3RoaXMubW91c2Vkb3duPSEwO09wZW5MYXllcnMuRXZlbnQuc3RvcChhLCEwKX0sb25tb3VzZW1vdmU6ZnVuY3Rpb24oYSl7dGhpcy5tb3VzZWRvd24mJk9wZW5MYXllcnMuRXZlbnQuc3RvcChhLCEwKX0sb25tb3VzZXVwOmZ1bmN0aW9uKGEpe3RoaXMubW91c2Vkb3duJiYodGhpcy5tb3VzZWRvd249ITEsT3BlbkxheWVycy5FdmVudC5zdG9wKGEsITApKX0sb25jbGljazpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLkV2ZW50LnN0b3AoYSwhMCl9LG9ubW91c2VvdXQ6ZnVuY3Rpb24oKXt0aGlzLm1vdXNlZG93bj0hMX0sb25kYmxjbGljazpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLkV2ZW50LnN0b3AoYSwhMCl9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLlBvcHVwXCJ9KTtPcGVuTGF5ZXJzLlBvcHVwLldJRFRIPTIwMDtPcGVuTGF5ZXJzLlBvcHVwLkhFSUdIVD0yMDA7T3BlbkxheWVycy5Qb3B1cC5DT0xPUj1cIndoaXRlXCI7XG5PcGVuTGF5ZXJzLlBvcHVwLk9QQUNJVFk9MTtPcGVuTGF5ZXJzLlBvcHVwLkJPUkRFUj1cIjBweFwiO09wZW5MYXllcnMuUG9wdXAuQW5jaG9yZWQ9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLlBvcHVwLHtyZWxhdGl2ZVBvc2l0aW9uOm51bGwsa2VlcEluTWFwOiEwLGFuY2hvcjpudWxsLGluaXRpYWxpemU6ZnVuY3Rpb24oYSxiLGMsZCxlLGYsZyl7T3BlbkxheWVycy5Qb3B1cC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLFthLGIsYyxkLGYsZ10pO3RoaXMuYW5jaG9yPW51bGwhPWU/ZTp7c2l6ZTpuZXcgT3BlbkxheWVycy5TaXplKDAsMCksb2Zmc2V0Om5ldyBPcGVuTGF5ZXJzLlBpeGVsKDAsMCl9fSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5yZWxhdGl2ZVBvc2l0aW9uPXRoaXMuYW5jaG9yPW51bGw7T3BlbkxheWVycy5Qb3B1cC5wcm90b3R5cGUuZGVzdHJveS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LHNob3c6ZnVuY3Rpb24oKXt0aGlzLnVwZGF0ZVBvc2l0aW9uKCk7T3BlbkxheWVycy5Qb3B1cC5wcm90b3R5cGUuc2hvdy5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LFxubW92ZVRvOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMucmVsYXRpdmVQb3NpdGlvbjt0aGlzLnJlbGF0aXZlUG9zaXRpb249dGhpcy5jYWxjdWxhdGVSZWxhdGl2ZVBvc2l0aW9uKGEpO2E9dGhpcy5jYWxjdWxhdGVOZXdQeChhKTtPcGVuTGF5ZXJzLlBvcHVwLnByb3RvdHlwZS5tb3ZlVG8uYXBwbHkodGhpcyxBcnJheShhKSk7dGhpcy5yZWxhdGl2ZVBvc2l0aW9uIT1iJiZ0aGlzLnVwZGF0ZVJlbGF0aXZlUG9zaXRpb24oKX0sc2V0U2l6ZTpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLlBvcHVwLnByb3RvdHlwZS5zZXRTaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmxvbmxhdCYmdGhpcy5tYXAmJnRoaXMubW92ZVRvKHRoaXMubWFwLmdldExheWVyUHhGcm9tTG9uTGF0KHRoaXMubG9ubGF0KSl9LGNhbGN1bGF0ZVJlbGF0aXZlUG9zaXRpb246ZnVuY3Rpb24oYSl7YT10aGlzLm1hcC5nZXRMb25MYXRGcm9tTGF5ZXJQeChhKTthPXRoaXMubWFwLmdldEV4dGVudCgpLmRldGVybWluZVF1YWRyYW50KGEpO1xucmV0dXJuIE9wZW5MYXllcnMuQm91bmRzLm9wcG9zaXRlUXVhZHJhbnQoYSl9LHVwZGF0ZVJlbGF0aXZlUG9zaXRpb246ZnVuY3Rpb24oKXt9LGNhbGN1bGF0ZU5ld1B4OmZ1bmN0aW9uKGEpe3ZhciBhPWEub2Zmc2V0KHRoaXMuYW5jaG9yLm9mZnNldCksYj10aGlzLnNpemV8fHRoaXMuY29udGVudFNpemUsYz1cInRcIj09dGhpcy5yZWxhdGl2ZVBvc2l0aW9uLmNoYXJBdCgwKTthLnkrPWM/LWIuaDp0aGlzLmFuY2hvci5zaXplLmg7Yz1cImxcIj09dGhpcy5yZWxhdGl2ZVBvc2l0aW9uLmNoYXJBdCgxKTthLngrPWM/LWIudzp0aGlzLmFuY2hvci5zaXplLnc7cmV0dXJuIGF9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLlBvcHVwLkFuY2hvcmVkXCJ9KTsvKlxuIEFwYWNoZSAyIFxuXG4gQ29udGFpbnMgcG9ydGlvbnMgb2YgUmljbyA8aHR0cDovL29wZW5yaWNvLm9yZy8+XG5cbiBDb3B5cmlnaHQgMjAwNSBTYWJyZSBBaXJsaW5lIFNvbHV0aW9ucyAgXG5cbiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpOyB5b3VcbiBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91XG4gbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcblxuICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAgIFxuXG4gVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3JcbiBpbXBsaWVkLiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmdcbiBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuIFxuKi9cbk9wZW5MYXllcnMuQ29uc29sZS53YXJuKFwiT3BlbkxheWVycy5SaWNvIGlzIGRlcHJlY2F0ZWRcIik7T3BlbkxheWVycy5SaWNvPU9wZW5MYXllcnMuUmljb3x8e307XG5PcGVuTGF5ZXJzLlJpY28uQ29sb3I9T3BlbkxheWVycy5DbGFzcyh7aW5pdGlhbGl6ZTpmdW5jdGlvbihhLGIsYyl7dGhpcy5yZ2I9e3I6YSxnOmIsYjpjfX0sc2V0UmVkOmZ1bmN0aW9uKGEpe3RoaXMucmdiLnI9YX0sc2V0R3JlZW46ZnVuY3Rpb24oYSl7dGhpcy5yZ2IuZz1hfSxzZXRCbHVlOmZ1bmN0aW9uKGEpe3RoaXMucmdiLmI9YX0sc2V0SHVlOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuYXNIU0IoKTtiLmg9YTt0aGlzLnJnYj1PcGVuTGF5ZXJzLlJpY28uQ29sb3IuSFNCdG9SR0IoYi5oLGIucyxiLmIpfSxzZXRTYXR1cmF0aW9uOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuYXNIU0IoKTtiLnM9YTt0aGlzLnJnYj1PcGVuTGF5ZXJzLlJpY28uQ29sb3IuSFNCdG9SR0IoYi5oLGIucyxiLmIpfSxzZXRCcmlnaHRuZXNzOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuYXNIU0IoKTtiLmI9YTt0aGlzLnJnYj1PcGVuTGF5ZXJzLlJpY28uQ29sb3IuSFNCdG9SR0IoYi5oLGIucyxiLmIpfSxcbmRhcmtlbjpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmFzSFNCKCk7dGhpcy5yZ2I9T3BlbkxheWVycy5SaWNvLkNvbG9yLkhTQnRvUkdCKGIuaCxiLnMsTWF0aC5tYXgoYi5iLWEsMCkpfSxicmlnaHRlbjpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmFzSFNCKCk7dGhpcy5yZ2I9T3BlbkxheWVycy5SaWNvLkNvbG9yLkhTQnRvUkdCKGIuaCxiLnMsTWF0aC5taW4oYi5iK2EsMSkpfSxibGVuZDpmdW5jdGlvbihhKXt0aGlzLnJnYi5yPU1hdGguZmxvb3IoKHRoaXMucmdiLnIrYS5yZ2IucikvMik7dGhpcy5yZ2IuZz1NYXRoLmZsb29yKCh0aGlzLnJnYi5nK2EucmdiLmcpLzIpO3RoaXMucmdiLmI9TWF0aC5mbG9vcigodGhpcy5yZ2IuYithLnJnYi5iKS8yKX0saXNCcmlnaHQ6ZnVuY3Rpb24oKXt0aGlzLmFzSFNCKCk7cmV0dXJuIDAuNTx0aGlzLmFzSFNCKCkuYn0saXNEYXJrOmZ1bmN0aW9uKCl7cmV0dXJuIXRoaXMuaXNCcmlnaHQoKX0sYXNSR0I6ZnVuY3Rpb24oKXtyZXR1cm5cInJnYihcIitcbnRoaXMucmdiLnIrXCIsXCIrdGhpcy5yZ2IuZytcIixcIit0aGlzLnJnYi5iK1wiKVwifSxhc0hleDpmdW5jdGlvbigpe3JldHVyblwiI1wiK3RoaXMucmdiLnIudG9Db2xvclBhcnQoKSt0aGlzLnJnYi5nLnRvQ29sb3JQYXJ0KCkrdGhpcy5yZ2IuYi50b0NvbG9yUGFydCgpfSxhc0hTQjpmdW5jdGlvbigpe3JldHVybiBPcGVuTGF5ZXJzLlJpY28uQ29sb3IuUkdCdG9IU0IodGhpcy5yZ2Iucix0aGlzLnJnYi5nLHRoaXMucmdiLmIpfSx0b1N0cmluZzpmdW5jdGlvbigpe3JldHVybiB0aGlzLmFzSGV4KCl9fSk7XG5PcGVuTGF5ZXJzLlJpY28uQ29sb3IuY3JlYXRlRnJvbUhleD1mdW5jdGlvbihhKXtpZig0PT1hLmxlbmd0aClmb3IodmFyIGI9YSxhPVwiI1wiLGM9MTs0PmM7YysrKWErPWIuY2hhckF0KGMpK2IuY2hhckF0KGMpOzA9PWEuaW5kZXhPZihcIiNcIikmJihhPWEuc3Vic3RyaW5nKDEpKTtiPWEuc3Vic3RyaW5nKDAsMik7Yz1hLnN1YnN0cmluZygyLDQpO2E9YS5zdWJzdHJpbmcoNCw2KTtyZXR1cm4gbmV3IE9wZW5MYXllcnMuUmljby5Db2xvcihwYXJzZUludChiLDE2KSxwYXJzZUludChjLDE2KSxwYXJzZUludChhLDE2KSl9O1xuT3BlbkxheWVycy5SaWNvLkNvbG9yLmNyZWF0ZUNvbG9yRnJvbUJhY2tncm91bmQ9ZnVuY3Rpb24oYSl7dmFyIGI9T3BlbkxheWVycy5FbGVtZW50LmdldFN0eWxlKE9wZW5MYXllcnMuVXRpbC5nZXRFbGVtZW50KGEpLFwiYmFja2dyb3VuZENvbG9yXCIpO3JldHVyblwidHJhbnNwYXJlbnRcIj09YiYmYS5wYXJlbnROb2RlP09wZW5MYXllcnMuUmljby5Db2xvci5jcmVhdGVDb2xvckZyb21CYWNrZ3JvdW5kKGEucGFyZW50Tm9kZSk6bnVsbD09Yj9uZXcgT3BlbkxheWVycy5SaWNvLkNvbG9yKDI1NSwyNTUsMjU1KTowPT1iLmluZGV4T2YoXCJyZ2IoXCIpPyhhPWIuc3Vic3RyaW5nKDQsYi5sZW5ndGgtMSkuc3BsaXQoXCIsXCIpLG5ldyBPcGVuTGF5ZXJzLlJpY28uQ29sb3IocGFyc2VJbnQoYVswXSkscGFyc2VJbnQoYVsxXSkscGFyc2VJbnQoYVsyXSkpKTowPT1iLmluZGV4T2YoXCIjXCIpP09wZW5MYXllcnMuUmljby5Db2xvci5jcmVhdGVGcm9tSGV4KGIpOm5ldyBPcGVuTGF5ZXJzLlJpY28uQ29sb3IoMjU1LFxuMjU1LDI1NSl9O1xuT3BlbkxheWVycy5SaWNvLkNvbG9yLkhTQnRvUkdCPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD0wLGU9MCxmPTA7aWYoMD09YilmPWU9ZD1wYXJzZUludCgyNTUqYyswLjUpO2Vsc2V7dmFyIGE9NiooYS1NYXRoLmZsb29yKGEpKSxnPWEtTWF0aC5mbG9vcihhKSxoPWMqKDEtYiksaT1jKigxLWIqZyksYj1jKigxLWIqKDEtZykpO3N3aXRjaChwYXJzZUludChhKSl7Y2FzZSAwOmQ9MjU1KmMrMC41O2U9MjU1KmIrMC41O2Y9MjU1KmgrMC41O2JyZWFrO2Nhc2UgMTpkPTI1NSppKzAuNTtlPTI1NSpjKzAuNTtmPTI1NSpoKzAuNTticmVhaztjYXNlIDI6ZD0yNTUqaCswLjU7ZT0yNTUqYyswLjU7Zj0yNTUqYiswLjU7YnJlYWs7Y2FzZSAzOmQ9MjU1KmgrMC41O2U9MjU1KmkrMC41O2Y9MjU1KmMrMC41O2JyZWFrO2Nhc2UgNDpkPTI1NSpiKzAuNTtlPTI1NSpoKzAuNTtmPTI1NSpjKzAuNTticmVhaztjYXNlIDU6ZD0yNTUqYyswLjUsZT0yNTUqaCswLjUsZj0yNTUqaSswLjV9fXJldHVybntyOnBhcnNlSW50KGQpLGc6cGFyc2VJbnQoZSksXG5iOnBhcnNlSW50KGYpfX07T3BlbkxheWVycy5SaWNvLkNvbG9yLlJHQnRvSFNCPWZ1bmN0aW9uKGEsYixjKXt2YXIgZCxlPWE+Yj9hOmI7Yz5lJiYoZT1jKTt2YXIgZj1hPGI/YTpiO2M8ZiYmKGY9Yyk7ZD0wIT1lPyhlLWYpL2U6MDtpZigwPT1kKWE9MDtlbHNle3ZhciBnPShlLWEpLyhlLWYpLGg9KGUtYikvKGUtZiksYz0oZS1jKS8oZS1mKSxhPShhPT1lP2MtaDpiPT1lPzIrZy1jOjQraC1nKS82OzA+YSYmKGErPTEpfXJldHVybntoOmEsczpkLGI6ZS8yNTV9fTtPcGVuTGF5ZXJzLkNvbnNvbGUud2FybihcIk9wZW5MYXllcnMuUmljbyBpcyBkZXByZWNhdGVkXCIpO09wZW5MYXllcnMuUmljbz1PcGVuTGF5ZXJzLlJpY298fHt9O1xuT3BlbkxheWVycy5SaWNvLkNvcm5lcj17cm91bmQ6ZnVuY3Rpb24oYSxiKXthPU9wZW5MYXllcnMuVXRpbC5nZXRFbGVtZW50KGEpO3RoaXMuX3NldE9wdGlvbnMoYik7dmFyIGM9dGhpcy5vcHRpb25zLmNvbG9yO1wiZnJvbUVsZW1lbnRcIj09dGhpcy5vcHRpb25zLmNvbG9yJiYoYz10aGlzLl9iYWNrZ3JvdW5kKGEpKTt2YXIgZD10aGlzLm9wdGlvbnMuYmdDb2xvcjtcImZyb21QYXJlbnRcIj09dGhpcy5vcHRpb25zLmJnQ29sb3ImJihkPXRoaXMuX2JhY2tncm91bmQoYS5vZmZzZXRQYXJlbnQpKTt0aGlzLl9yb3VuZENvcm5lcnNJbXBsKGEsYyxkKX0sY2hhbmdlQ29sb3I6ZnVuY3Rpb24oYSxiKXthLnN0eWxlLmJhY2tncm91bmRDb2xvcj1iO2Zvcih2YXIgYz1hLnBhcmVudE5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzcGFuXCIpLGQ9MDtkPGMubGVuZ3RoO2QrKyljW2RdLnN0eWxlLmJhY2tncm91bmRDb2xvcj1ifSxjaGFuZ2VPcGFjaXR5OmZ1bmN0aW9uKGEsYil7dmFyIGM9XCJhbHBoYShvcGFjaXR5PVwiK1xuMTAwKmIrXCIpXCI7YS5zdHlsZS5vcGFjaXR5PWI7YS5zdHlsZS5maWx0ZXI9Yztmb3IodmFyIGQ9YS5wYXJlbnROb2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic3BhblwiKSxlPTA7ZTxkLmxlbmd0aDtlKyspZFtlXS5zdHlsZS5vcGFjaXR5PWIsZFtlXS5zdHlsZS5maWx0ZXI9Y30scmVSb3VuZDpmdW5jdGlvbihhLGIpe3ZhciBjPWEucGFyZW50Tm9kZS5jaGlsZE5vZGVzWzJdO2EucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChhLnBhcmVudE5vZGUuY2hpbGROb2Rlc1swXSk7YS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGMpO3RoaXMucm91bmQoYS5wYXJlbnROb2RlLGIpfSxfcm91bmRDb3JuZXJzSW1wbDpmdW5jdGlvbihhLGIsYyl7dGhpcy5vcHRpb25zLmJvcmRlciYmdGhpcy5fcmVuZGVyQm9yZGVyKGEsYyk7dGhpcy5faXNUb3BSb3VuZGVkKCkmJnRoaXMuX3JvdW5kVG9wQ29ybmVycyhhLGIsYyk7dGhpcy5faXNCb3R0b21Sb3VuZGVkKCkmJnRoaXMuX3JvdW5kQm90dG9tQ29ybmVycyhhLFxuYixjKX0sX3JlbmRlckJvcmRlcjpmdW5jdGlvbihhLGIpe3ZhciBjPVwiMXB4IHNvbGlkIFwiK3RoaXMuX2JvcmRlckNvbG9yKGIpO2EuaW5uZXJIVE1MPVwiPGRpdiBcIisoXCJzdHlsZT0nYm9yZGVyLWxlZnQ6IFwiK2MrXCI7XCIrKFwiYm9yZGVyLXJpZ2h0OiBcIitjKStcIidcIikrXCI+XCIrYS5pbm5lckhUTUwrXCI8L2Rpdj5cIn0sX3JvdW5kVG9wQ29ybmVyczpmdW5jdGlvbihhLGIsYyl7Zm9yKHZhciBkPXRoaXMuX2NyZWF0ZUNvcm5lcihjKSxlPTA7ZTx0aGlzLm9wdGlvbnMubnVtU2xpY2VzO2UrKylkLmFwcGVuZENoaWxkKHRoaXMuX2NyZWF0ZUNvcm5lclNsaWNlKGIsYyxlLFwidG9wXCIpKTthLnN0eWxlLnBhZGRpbmdUb3A9MDthLmluc2VydEJlZm9yZShkLGEuZmlyc3RDaGlsZCl9LF9yb3VuZEJvdHRvbUNvcm5lcnM6ZnVuY3Rpb24oYSxiLGMpe2Zvcih2YXIgZD10aGlzLl9jcmVhdGVDb3JuZXIoYyksZT10aGlzLm9wdGlvbnMubnVtU2xpY2VzLTE7MDw9ZTtlLS0pZC5hcHBlbmRDaGlsZCh0aGlzLl9jcmVhdGVDb3JuZXJTbGljZShiLFxuYyxlLFwiYm90dG9tXCIpKTthLnN0eWxlLnBhZGRpbmdCb3R0b209MDthLmFwcGVuZENoaWxkKGQpfSxfY3JlYXRlQ29ybmVyOmZ1bmN0aW9uKGEpe3ZhciBiPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7Yi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3I9dGhpcy5faXNUcmFuc3BhcmVudCgpP1widHJhbnNwYXJlbnRcIjphO3JldHVybiBifSxfY3JlYXRlQ29ybmVyU2xpY2U6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIiksZj1lLnN0eWxlO2YuYmFja2dyb3VuZENvbG9yPWE7Zi5kaXNwbGF5PVwiYmxvY2tcIjtmLmhlaWdodD1cIjFweFwiO2Yub3ZlcmZsb3c9XCJoaWRkZW5cIjtmLmZvbnRTaXplPVwiMXB4XCI7YT10aGlzLl9ib3JkZXJDb2xvcihhLGIpO3RoaXMub3B0aW9ucy5ib3JkZXImJjA9PWM/KGYuYm9yZGVyVG9wU3R5bGU9XCJzb2xpZFwiLGYuYm9yZGVyVG9wV2lkdGg9XCIxcHhcIixmLmJvcmRlckxlZnRXaWR0aD1cIjBweFwiLGYuYm9yZGVyUmlnaHRXaWR0aD1cblwiMHB4XCIsZi5ib3JkZXJCb3R0b21XaWR0aD1cIjBweFwiLGYuaGVpZ2h0PVwiMHB4XCIsZi5ib3JkZXJDb2xvcj1hKTphJiYoZi5ib3JkZXJDb2xvcj1hLGYuYm9yZGVyU3R5bGU9XCJzb2xpZFwiLGYuYm9yZGVyV2lkdGg9XCIwcHggMXB4XCIpOyF0aGlzLm9wdGlvbnMuY29tcGFjdCYmYz09dGhpcy5vcHRpb25zLm51bVNsaWNlcy0xJiYoZi5oZWlnaHQ9XCIycHhcIik7dGhpcy5fc2V0TWFyZ2luKGUsYyxkKTt0aGlzLl9zZXRCb3JkZXIoZSxjLGQpO3JldHVybiBlfSxfc2V0T3B0aW9uczpmdW5jdGlvbihhKXt0aGlzLm9wdGlvbnM9e2Nvcm5lcnM6XCJhbGxcIixjb2xvcjpcImZyb21FbGVtZW50XCIsYmdDb2xvcjpcImZyb21QYXJlbnRcIixibGVuZDohMCxib3JkZXI6ITEsY29tcGFjdDohMX07T3BlbkxheWVycy5VdGlsLmV4dGVuZCh0aGlzLm9wdGlvbnMsYXx8e30pO3RoaXMub3B0aW9ucy5udW1TbGljZXM9dGhpcy5vcHRpb25zLmNvbXBhY3Q/Mjo0O3RoaXMuX2lzVHJhbnNwYXJlbnQoKSYmKHRoaXMub3B0aW9ucy5ibGVuZD1cbiExKX0sX3doaWNoU2lkZVRvcDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9oYXNTdHJpbmcodGhpcy5vcHRpb25zLmNvcm5lcnMsXCJhbGxcIixcInRvcFwiKXx8MDw9dGhpcy5vcHRpb25zLmNvcm5lcnMuaW5kZXhPZihcInRsXCIpJiYwPD10aGlzLm9wdGlvbnMuY29ybmVycy5pbmRleE9mKFwidHJcIik/XCJcIjowPD10aGlzLm9wdGlvbnMuY29ybmVycy5pbmRleE9mKFwidGxcIik/XCJsZWZ0XCI6MDw9dGhpcy5vcHRpb25zLmNvcm5lcnMuaW5kZXhPZihcInRyXCIpP1wicmlnaHRcIjpcIlwifSxfd2hpY2hTaWRlQm90dG9tOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2hhc1N0cmluZyh0aGlzLm9wdGlvbnMuY29ybmVycyxcImFsbFwiLFwiYm90dG9tXCIpfHwwPD10aGlzLm9wdGlvbnMuY29ybmVycy5pbmRleE9mKFwiYmxcIikmJjA8PXRoaXMub3B0aW9ucy5jb3JuZXJzLmluZGV4T2YoXCJiclwiKT9cIlwiOjA8PXRoaXMub3B0aW9ucy5jb3JuZXJzLmluZGV4T2YoXCJibFwiKT9cImxlZnRcIjowPD10aGlzLm9wdGlvbnMuY29ybmVycy5pbmRleE9mKFwiYnJcIik/XG5cInJpZ2h0XCI6XCJcIn0sX2JvcmRlckNvbG9yOmZ1bmN0aW9uKGEsYil7cmV0dXJuXCJ0cmFuc3BhcmVudFwiPT1hP2I6dGhpcy5vcHRpb25zLmJvcmRlcj90aGlzLm9wdGlvbnMuYm9yZGVyOnRoaXMub3B0aW9ucy5ibGVuZD90aGlzLl9ibGVuZChiLGEpOlwiXCJ9LF9zZXRNYXJnaW46ZnVuY3Rpb24oYSxiLGMpe2I9dGhpcy5fbWFyZ2luU2l6ZShiKTtjPVwidG9wXCI9PWM/dGhpcy5fd2hpY2hTaWRlVG9wKCk6dGhpcy5fd2hpY2hTaWRlQm90dG9tKCk7XCJsZWZ0XCI9PWM/KGEuc3R5bGUubWFyZ2luTGVmdD1iK1wicHhcIixhLnN0eWxlLm1hcmdpblJpZ2h0PVwiMHB4XCIpOlwicmlnaHRcIj09Yz8oYS5zdHlsZS5tYXJnaW5SaWdodD1iK1wicHhcIixhLnN0eWxlLm1hcmdpbkxlZnQ9XCIwcHhcIik6KGEuc3R5bGUubWFyZ2luTGVmdD1iK1wicHhcIixhLnN0eWxlLm1hcmdpblJpZ2h0PWIrXCJweFwiKX0sX3NldEJvcmRlcjpmdW5jdGlvbihhLGIsYyl7Yj10aGlzLl9ib3JkZXJTaXplKGIpO2M9XCJ0b3BcIj09Yz90aGlzLl93aGljaFNpZGVUb3AoKTpcbnRoaXMuX3doaWNoU2lkZUJvdHRvbSgpO1wibGVmdFwiPT1jPyhhLnN0eWxlLmJvcmRlckxlZnRXaWR0aD1iK1wicHhcIixhLnN0eWxlLmJvcmRlclJpZ2h0V2lkdGg9XCIwcHhcIik6XCJyaWdodFwiPT1jPyhhLnN0eWxlLmJvcmRlclJpZ2h0V2lkdGg9YitcInB4XCIsYS5zdHlsZS5ib3JkZXJMZWZ0V2lkdGg9XCIwcHhcIik6KGEuc3R5bGUuYm9yZGVyTGVmdFdpZHRoPWIrXCJweFwiLGEuc3R5bGUuYm9yZGVyUmlnaHRXaWR0aD1iK1wicHhcIik7ITEhPXRoaXMub3B0aW9ucy5ib3JkZXImJihhLnN0eWxlLmJvcmRlckxlZnRXaWR0aD1iK1wicHhcIixhLnN0eWxlLmJvcmRlclJpZ2h0V2lkdGg9YitcInB4XCIpfSxfbWFyZ2luU2l6ZTpmdW5jdGlvbihhKXtpZih0aGlzLl9pc1RyYW5zcGFyZW50KCkpcmV0dXJuIDA7dmFyIGI9WzUsMywyLDFdLGM9WzMsMiwxLDBdLGQ9WzIsMV0sZT1bMSwwXTtyZXR1cm4gdGhpcy5vcHRpb25zLmNvbXBhY3QmJnRoaXMub3B0aW9ucy5ibGVuZD9lW2FdOnRoaXMub3B0aW9ucy5jb21wYWN0P1xuZFthXTp0aGlzLm9wdGlvbnMuYmxlbmQ/Y1thXTpiW2FdfSxfYm9yZGVyU2l6ZTpmdW5jdGlvbihhKXt2YXIgYj1bNSwzLDIsMV0sYz1bMiwxLDEsMV0sZD1bMSwwXSxlPVswLDIsMCwwXTtyZXR1cm4gdGhpcy5vcHRpb25zLmNvbXBhY3QmJih0aGlzLm9wdGlvbnMuYmxlbmR8fHRoaXMuX2lzVHJhbnNwYXJlbnQoKSk/MTp0aGlzLm9wdGlvbnMuY29tcGFjdD9kW2FdOnRoaXMub3B0aW9ucy5ibGVuZD9jW2FdOnRoaXMub3B0aW9ucy5ib3JkZXI/ZVthXTp0aGlzLl9pc1RyYW5zcGFyZW50KCk/YlthXTowfSxfaGFzU3RyaW5nOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj0xO2I8YXJndW1lbnRzLmxlbmd0aDtiKyspaWYoMDw9YS5pbmRleE9mKGFyZ3VtZW50c1tiXSkpcmV0dXJuITA7cmV0dXJuITF9LF9ibGVuZDpmdW5jdGlvbihhLGIpe3ZhciBjPU9wZW5MYXllcnMuUmljby5Db2xvci5jcmVhdGVGcm9tSGV4KGEpO2MuYmxlbmQoT3BlbkxheWVycy5SaWNvLkNvbG9yLmNyZWF0ZUZyb21IZXgoYikpO1xucmV0dXJuIGN9LF9iYWNrZ3JvdW5kOmZ1bmN0aW9uKGEpe3RyeXtyZXR1cm4gT3BlbkxheWVycy5SaWNvLkNvbG9yLmNyZWF0ZUNvbG9yRnJvbUJhY2tncm91bmQoYSkuYXNIZXgoKX1jYXRjaChiKXtyZXR1cm5cIiNmZmZmZmZcIn19LF9pc1RyYW5zcGFyZW50OmZ1bmN0aW9uKCl7cmV0dXJuXCJ0cmFuc3BhcmVudFwiPT10aGlzLm9wdGlvbnMuY29sb3J9LF9pc1RvcFJvdW5kZWQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faGFzU3RyaW5nKHRoaXMub3B0aW9ucy5jb3JuZXJzLFwiYWxsXCIsXCJ0b3BcIixcInRsXCIsXCJ0clwiKX0sX2lzQm90dG9tUm91bmRlZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9oYXNTdHJpbmcodGhpcy5vcHRpb25zLmNvcm5lcnMsXCJhbGxcIixcImJvdHRvbVwiLFwiYmxcIixcImJyXCIpfSxfaGFzU2luZ2xlVGV4dENoaWxkOmZ1bmN0aW9uKGEpe3JldHVybiAxPT1hLmNoaWxkTm9kZXMubGVuZ3RoJiYzPT1hLmNoaWxkTm9kZXNbMF0ubm9kZVR5cGV9fTtPcGVuTGF5ZXJzLlBvcHVwLkFuY2hvcmVkQnViYmxlPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Qb3B1cC5BbmNob3JlZCx7cm91bmRlZDohMSxpbml0aWFsaXplOmZ1bmN0aW9uKGEsYixjLGQsZSxmLGcpe09wZW5MYXllcnMuQ29uc29sZS53YXJuKFwiQW5jaG9yZWRCdWJibGUgaXMgZGVwcmVjYXRlZFwiKTt0aGlzLnBhZGRpbmc9bmV3IE9wZW5MYXllcnMuQm91bmRzKDAsT3BlbkxheWVycy5Qb3B1cC5BbmNob3JlZEJ1YmJsZS5DT1JORVJfU0laRSwwLE9wZW5MYXllcnMuUG9wdXAuQW5jaG9yZWRCdWJibGUuQ09STkVSX1NJWkUpO09wZW5MYXllcnMuUG9wdXAuQW5jaG9yZWQucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxkcmF3OmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuUG9wdXAuQW5jaG9yZWQucHJvdG90eXBlLmRyYXcuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuc2V0Q29udGVudEhUTUwoKTt0aGlzLnNldEJhY2tncm91bmRDb2xvcigpO1xudGhpcy5zZXRPcGFjaXR5KCk7cmV0dXJuIHRoaXMuZGl2fSx1cGRhdGVSZWxhdGl2ZVBvc2l0aW9uOmZ1bmN0aW9uKCl7dGhpcy5zZXRSaWNvQ29ybmVycygpfSxzZXRTaXplOmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuUG9wdXAuQW5jaG9yZWQucHJvdG90eXBlLnNldFNpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuc2V0Umljb0Nvcm5lcnMoKX0sc2V0QmFja2dyb3VuZENvbG9yOmZ1bmN0aW9uKGEpe3ZvaWQgMCE9YSYmKHRoaXMuYmFja2dyb3VuZENvbG9yPWEpO251bGwhPXRoaXMuZGl2JiZudWxsIT10aGlzLmNvbnRlbnREaXYmJih0aGlzLmRpdi5zdHlsZS5iYWNrZ3JvdW5kPVwidHJhbnNwYXJlbnRcIixPcGVuTGF5ZXJzLlJpY28uQ29ybmVyLmNoYW5nZUNvbG9yKHRoaXMuZ3JvdXBEaXYsdGhpcy5iYWNrZ3JvdW5kQ29sb3IpKX0sc2V0T3BhY2l0eTpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLlBvcHVwLkFuY2hvcmVkLnByb3RvdHlwZS5zZXRPcGFjaXR5LmNhbGwodGhpcyxcbmEpO251bGwhPXRoaXMuZGl2JiZudWxsIT10aGlzLmdyb3VwRGl2JiZPcGVuTGF5ZXJzLlJpY28uQ29ybmVyLmNoYW5nZU9wYWNpdHkodGhpcy5ncm91cERpdix0aGlzLm9wYWNpdHkpfSxzZXRCb3JkZXI6ZnVuY3Rpb24oKXt0aGlzLmJvcmRlcj0wfSxzZXRSaWNvQ29ybmVyczpmdW5jdGlvbigpe3ZhciBhPXtjb3JuZXJzOnRoaXMuZ2V0Q29ybmVyc1RvUm91bmQodGhpcy5yZWxhdGl2ZVBvc2l0aW9uKSxjb2xvcjp0aGlzLmJhY2tncm91bmRDb2xvcixiZ0NvbG9yOlwidHJhbnNwYXJlbnRcIixibGVuZDohMX07dGhpcy5yb3VuZGVkPyhPcGVuTGF5ZXJzLlJpY28uQ29ybmVyLnJlUm91bmQodGhpcy5ncm91cERpdixhKSx0aGlzLnNldEJhY2tncm91bmRDb2xvcigpLHRoaXMuc2V0T3BhY2l0eSgpKTooT3BlbkxheWVycy5SaWNvLkNvcm5lci5yb3VuZCh0aGlzLmRpdixhKSx0aGlzLnJvdW5kZWQ9ITApfSxnZXRDb3JuZXJzVG9Sb3VuZDpmdW5jdGlvbigpe3ZhciBhPVtcInRsXCIsXCJ0clwiLFxuXCJibFwiLFwiYnJcIl0sYj1PcGVuTGF5ZXJzLkJvdW5kcy5vcHBvc2l0ZVF1YWRyYW50KHRoaXMucmVsYXRpdmVQb3NpdGlvbik7T3BlbkxheWVycy5VdGlsLnJlbW92ZUl0ZW0oYSxiKTtyZXR1cm4gYS5qb2luKFwiIFwiKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuUG9wdXAuQW5jaG9yZWRCdWJibGVcIn0pO09wZW5MYXllcnMuUG9wdXAuQW5jaG9yZWRCdWJibGUuQ09STkVSX1NJWkU9NTtPcGVuTGF5ZXJzLlByb3RvY29sLldGUy52MT1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuUHJvdG9jb2wse3ZlcnNpb246bnVsbCxzcnNOYW1lOlwiRVBTRzo0MzI2XCIsZmVhdHVyZVR5cGU6bnVsbCxmZWF0dXJlTlM6bnVsbCxnZW9tZXRyeU5hbWU6XCJ0aGVfZ2VvbVwiLHNjaGVtYTpudWxsLGZlYXR1cmVQcmVmaXg6XCJmZWF0dXJlXCIsZm9ybWF0T3B0aW9uczpudWxsLHJlYWRGb3JtYXQ6bnVsbCxyZWFkT3B0aW9uczpudWxsLGluaXRpYWxpemU6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5Qcm90b2NvbC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLFthXSk7YS5mb3JtYXR8fCh0aGlzLmZvcm1hdD1PcGVuTGF5ZXJzLkZvcm1hdC5XRlNUKE9wZW5MYXllcnMuVXRpbC5leHRlbmQoe3ZlcnNpb246dGhpcy52ZXJzaW9uLGZlYXR1cmVUeXBlOnRoaXMuZmVhdHVyZVR5cGUsZmVhdHVyZU5TOnRoaXMuZmVhdHVyZU5TLGZlYXR1cmVQcmVmaXg6dGhpcy5mZWF0dXJlUHJlZml4LGdlb21ldHJ5TmFtZTp0aGlzLmdlb21ldHJ5TmFtZSxcbnNyc05hbWU6dGhpcy5zcnNOYW1lLHNjaGVtYTp0aGlzLnNjaGVtYX0sdGhpcy5mb3JtYXRPcHRpb25zKSkpOyFhLmdlb21ldHJ5TmFtZSYmMTxwYXJzZUZsb2F0KHRoaXMuZm9ybWF0LnZlcnNpb24pJiZ0aGlzLnNldEdlb21ldHJ5TmFtZShudWxsKX0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMub3B0aW9ucyYmIXRoaXMub3B0aW9ucy5mb3JtYXQmJnRoaXMuZm9ybWF0LmRlc3Ryb3koKTt0aGlzLmZvcm1hdD1udWxsO09wZW5MYXllcnMuUHJvdG9jb2wucHJvdG90eXBlLmRlc3Ryb3kuYXBwbHkodGhpcyl9LHJlYWQ6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5Qcm90b2NvbC5wcm90b3R5cGUucmVhZC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7YT1PcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHt9LGEpO09wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKGEsdGhpcy5vcHRpb25zfHx7fSk7dmFyIGI9bmV3IE9wZW5MYXllcnMuUHJvdG9jb2wuUmVzcG9uc2Uoe3JlcXVlc3RUeXBlOlwicmVhZFwifSksXG5jPU9wZW5MYXllcnMuRm9ybWF0LlhNTC5wcm90b3R5cGUud3JpdGUuYXBwbHkodGhpcy5mb3JtYXQsW3RoaXMuZm9ybWF0LndyaXRlTm9kZShcIndmczpHZXRGZWF0dXJlXCIsYSldKTtiLnByaXY9T3BlbkxheWVycy5SZXF1ZXN0LlBPU1Qoe3VybDphLnVybCxjYWxsYmFjazp0aGlzLmNyZWF0ZUNhbGxiYWNrKHRoaXMuaGFuZGxlUmVhZCxiLGEpLHBhcmFtczphLnBhcmFtcyxoZWFkZXJzOmEuaGVhZGVycyxkYXRhOmN9KTtyZXR1cm4gYn0sc2V0RmVhdHVyZVR5cGU6ZnVuY3Rpb24oYSl7dGhpcy5mZWF0dXJlVHlwZT1hO3RoaXMuZm9ybWF0LmZlYXR1cmVUeXBlPWF9LHNldEdlb21ldHJ5TmFtZTpmdW5jdGlvbihhKXt0aGlzLmdlb21ldHJ5TmFtZT1hO3RoaXMuZm9ybWF0Lmdlb21ldHJ5TmFtZT1hfSxoYW5kbGVSZWFkOmZ1bmN0aW9uKGEsYil7Yj1PcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHt9LGIpO09wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKGIsdGhpcy5vcHRpb25zKTtpZihiLmNhbGxiYWNrKXt2YXIgYz1cbmEucHJpdjsyMDA8PWMuc3RhdHVzJiYzMDA+Yy5zdGF0dXM/KGM9dGhpcy5wYXJzZVJlc3BvbnNlKGMsYi5yZWFkT3B0aW9ucykpJiYhMSE9PWMuc3VjY2Vzcz8oYi5yZWFkT3B0aW9ucyYmXCJvYmplY3RcIj09Yi5yZWFkT3B0aW9ucy5vdXRwdXQ/T3BlbkxheWVycy5VdGlsLmV4dGVuZChhLGMpOmEuZmVhdHVyZXM9YyxhLmNvZGU9T3BlbkxheWVycy5Qcm90b2NvbC5SZXNwb25zZS5TVUNDRVNTKTooYS5jb2RlPU9wZW5MYXllcnMuUHJvdG9jb2wuUmVzcG9uc2UuRkFJTFVSRSxhLmVycm9yPWMpOmEuY29kZT1PcGVuTGF5ZXJzLlByb3RvY29sLlJlc3BvbnNlLkZBSUxVUkU7Yi5jYWxsYmFjay5jYWxsKGIuc2NvcGUsYSl9fSxwYXJzZVJlc3BvbnNlOmZ1bmN0aW9uKGEsYil7dmFyIGM9YS5yZXNwb25zZVhNTDtpZighY3x8IWMuZG9jdW1lbnRFbGVtZW50KWM9YS5yZXNwb25zZVRleHQ7aWYoIWN8fDA+PWMubGVuZ3RoKXJldHVybiBudWxsO2M9bnVsbCE9PXRoaXMucmVhZEZvcm1hdD90aGlzLnJlYWRGb3JtYXQucmVhZChjKTpcbnRoaXMuZm9ybWF0LnJlYWQoYyxiKTtpZighdGhpcy5mZWF0dXJlTlMpe3ZhciBkPXRoaXMucmVhZEZvcm1hdHx8dGhpcy5mb3JtYXQ7dGhpcy5mZWF0dXJlTlM9ZC5mZWF0dXJlTlM7ZC5hdXRvQ29uZmlnPSExO3RoaXMuZ2VvbWV0cnlOYW1lfHx0aGlzLnNldEdlb21ldHJ5TmFtZShkLmdlb21ldHJ5TmFtZSl9cmV0dXJuIGN9LGNvbW1pdDpmdW5jdGlvbihhLGIpe2I9T3BlbkxheWVycy5VdGlsLmV4dGVuZCh7fSxiKTtPcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyhiLHRoaXMub3B0aW9ucyk7dmFyIGM9bmV3IE9wZW5MYXllcnMuUHJvdG9jb2wuUmVzcG9uc2Uoe3JlcXVlc3RUeXBlOlwiY29tbWl0XCIscmVxRmVhdHVyZXM6YX0pO2MucHJpdj1PcGVuTGF5ZXJzLlJlcXVlc3QuUE9TVCh7dXJsOmIudXJsLGhlYWRlcnM6Yi5oZWFkZXJzLGRhdGE6dGhpcy5mb3JtYXQud3JpdGUoYSxiKSxjYWxsYmFjazp0aGlzLmNyZWF0ZUNhbGxiYWNrKHRoaXMuaGFuZGxlQ29tbWl0LGMsYil9KTtcbnJldHVybiBjfSxoYW5kbGVDb21taXQ6ZnVuY3Rpb24oYSxiKXtpZihiLmNhbGxiYWNrKXt2YXIgYz1hLnByaXYsZD1jLnJlc3BvbnNlWE1MO2lmKCFkfHwhZC5kb2N1bWVudEVsZW1lbnQpZD1jLnJlc3BvbnNlVGV4dDtjPXRoaXMuZm9ybWF0LnJlYWQoZCl8fHt9O2EuaW5zZXJ0SWRzPWMuaW5zZXJ0SWRzfHxbXTtjLnN1Y2Nlc3M/YS5jb2RlPU9wZW5MYXllcnMuUHJvdG9jb2wuUmVzcG9uc2UuU1VDQ0VTUzooYS5jb2RlPU9wZW5MYXllcnMuUHJvdG9jb2wuUmVzcG9uc2UuRkFJTFVSRSxhLmVycm9yPWMpO2IuY2FsbGJhY2suY2FsbChiLnNjb3BlLGEpfX0sZmlsdGVyRGVsZXRlOmZ1bmN0aW9uKGEsYil7Yj1PcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHt9LGIpO09wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKGIsdGhpcy5vcHRpb25zKTtuZXcgT3BlbkxheWVycy5Qcm90b2NvbC5SZXNwb25zZSh7cmVxdWVzdFR5cGU6XCJjb21taXRcIn0pO3ZhciBjPXRoaXMuZm9ybWF0LmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJ3ZnM6VHJhbnNhY3Rpb25cIixcbnthdHRyaWJ1dGVzOntzZXJ2aWNlOlwiV0ZTXCIsdmVyc2lvbjp0aGlzLnZlcnNpb259fSksZD10aGlzLmZvcm1hdC5jcmVhdGVFbGVtZW50TlNQbHVzKFwid2ZzOkRlbGV0ZVwiLHthdHRyaWJ1dGVzOnt0eXBlTmFtZTooYi5mZWF0dXJlTlM/dGhpcy5mZWF0dXJlUHJlZml4K1wiOlwiOlwiXCIpK2IuZmVhdHVyZVR5cGV9fSk7Yi5mZWF0dXJlTlMmJmQuc2V0QXR0cmlidXRlKFwieG1sbnM6XCIrdGhpcy5mZWF0dXJlUHJlZml4LGIuZmVhdHVyZU5TKTt2YXIgZT10aGlzLmZvcm1hdC53cml0ZU5vZGUoXCJvZ2M6RmlsdGVyXCIsYSk7ZC5hcHBlbmRDaGlsZChlKTtjLmFwcGVuZENoaWxkKGQpO2M9T3BlbkxheWVycy5Gb3JtYXQuWE1MLnByb3RvdHlwZS53cml0ZS5hcHBseSh0aGlzLmZvcm1hdCxbY10pO3JldHVybiBPcGVuTGF5ZXJzLlJlcXVlc3QuUE9TVCh7dXJsOnRoaXMudXJsLGNhbGxiYWNrOmIuY2FsbGJhY2t8fGZ1bmN0aW9uKCl7fSxkYXRhOmN9KX0sYWJvcnQ6ZnVuY3Rpb24oYSl7YSYmYS5wcml2LmFib3J0KCl9LFxuQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuUHJvdG9jb2wuV0ZTLnYxXCJ9KTtPcGVuTGF5ZXJzLkhhbmRsZXIuUG9pbnQ9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkhhbmRsZXIse3BvaW50Om51bGwsbGF5ZXI6bnVsbCxtdWx0aTohMSxjaXRlQ29tcGxpYW50OiExLG1vdXNlRG93bjohMSxzdG9wcGVkRG93bjpudWxsLGxhc3REb3duOm51bGwsbGFzdFVwOm51bGwscGVyc2lzdDohMSxzdG9wRG93bjohMSxzdG9wVXA6ITEsbGF5ZXJPcHRpb25zOm51bGwscGl4ZWxUb2xlcmFuY2U6NSx0b3VjaDohMSxsYXN0VG91Y2hQeDpudWxsLGluaXRpYWxpemU6ZnVuY3Rpb24oYSxiLGMpe2lmKCFjfHwhYy5sYXllck9wdGlvbnN8fCFjLmxheWVyT3B0aW9ucy5zdHlsZU1hcCl0aGlzLnN0eWxlPU9wZW5MYXllcnMuVXRpbC5leHRlbmQoT3BlbkxheWVycy5GZWF0dXJlLlZlY3Rvci5zdHlsZVtcImRlZmF1bHRcIl0se30pO09wZW5MYXllcnMuSGFuZGxlci5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGFjdGl2YXRlOmZ1bmN0aW9uKCl7aWYoIU9wZW5MYXllcnMuSGFuZGxlci5wcm90b3R5cGUuYWN0aXZhdGUuYXBwbHkodGhpcyxcbmFyZ3VtZW50cykpcmV0dXJuITE7dmFyIGE9T3BlbkxheWVycy5VdGlsLmV4dGVuZCh7ZGlzcGxheUluTGF5ZXJTd2l0Y2hlcjohMSxjYWxjdWxhdGVJblJhbmdlOk9wZW5MYXllcnMuRnVuY3Rpb24uVHJ1ZSx3cmFwRGF0ZUxpbmU6dGhpcy5jaXRlQ29tcGxpYW50fSx0aGlzLmxheWVyT3B0aW9ucyk7dGhpcy5sYXllcj1uZXcgT3BlbkxheWVycy5MYXllci5WZWN0b3IodGhpcy5DTEFTU19OQU1FLGEpO3RoaXMubWFwLmFkZExheWVyKHRoaXMubGF5ZXIpO3JldHVybiEwfSxjcmVhdGVGZWF0dXJlOmZ1bmN0aW9uKGEpe2E9dGhpcy5sYXllci5nZXRMb25MYXRGcm9tVmlld1BvcnRQeChhKTthPW5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGEubG9uLGEubGF0KTt0aGlzLnBvaW50PW5ldyBPcGVuTGF5ZXJzLkZlYXR1cmUuVmVjdG9yKGEpO3RoaXMuY2FsbGJhY2soXCJjcmVhdGVcIixbdGhpcy5wb2ludC5nZW9tZXRyeSx0aGlzLnBvaW50XSk7dGhpcy5wb2ludC5nZW9tZXRyeS5jbGVhckJvdW5kcygpO1xudGhpcy5sYXllci5hZGRGZWF0dXJlcyhbdGhpcy5wb2ludF0se3NpbGVudDohMH0pfSxkZWFjdGl2YXRlOmZ1bmN0aW9uKCl7aWYoIU9wZW5MYXllcnMuSGFuZGxlci5wcm90b3R5cGUuZGVhY3RpdmF0ZS5hcHBseSh0aGlzLGFyZ3VtZW50cykpcmV0dXJuITE7dGhpcy5jYW5jZWwoKTtudWxsIT10aGlzLmxheWVyLm1hcCYmKHRoaXMuZGVzdHJveUZlYXR1cmUoITApLHRoaXMubGF5ZXIuZGVzdHJveSghMSkpO3RoaXMubGF5ZXI9bnVsbDt0aGlzLnRvdWNoPSExO3JldHVybiEwfSxkZXN0cm95RmVhdHVyZTpmdW5jdGlvbihhKXt0aGlzLmxheWVyJiYoYXx8IXRoaXMucGVyc2lzdCkmJnRoaXMubGF5ZXIuZGVzdHJveUZlYXR1cmVzKCk7dGhpcy5wb2ludD1udWxsfSxkZXN0cm95UGVyc2lzdGVkRmVhdHVyZTpmdW5jdGlvbigpe3ZhciBhPXRoaXMubGF5ZXI7YSYmMTxhLmZlYXR1cmVzLmxlbmd0aCYmdGhpcy5sYXllci5mZWF0dXJlc1swXS5kZXN0cm95KCl9LGZpbmFsaXplOmZ1bmN0aW9uKGEpe3RoaXMubW91c2VEb3duPVxuITE7dGhpcy5sYXN0VG91Y2hQeD10aGlzLmxhc3RVcD10aGlzLmxhc3REb3duPW51bGw7dGhpcy5jYWxsYmFjayhhP1wiY2FuY2VsXCI6XCJkb25lXCIsW3RoaXMuZ2VvbWV0cnlDbG9uZSgpXSk7dGhpcy5kZXN0cm95RmVhdHVyZShhKX0sY2FuY2VsOmZ1bmN0aW9uKCl7dGhpcy5maW5hbGl6ZSghMCl9LGNsaWNrOmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuRXZlbnQuc3RvcChhKTtyZXR1cm4hMX0sZGJsY2xpY2s6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5FdmVudC5zdG9wKGEpO3JldHVybiExfSxtb2RpZnlGZWF0dXJlOmZ1bmN0aW9uKGEpe3RoaXMucG9pbnR8fHRoaXMuY3JlYXRlRmVhdHVyZShhKTthPXRoaXMubGF5ZXIuZ2V0TG9uTGF0RnJvbVZpZXdQb3J0UHgoYSk7dGhpcy5wb2ludC5nZW9tZXRyeS54PWEubG9uO3RoaXMucG9pbnQuZ2VvbWV0cnkueT1hLmxhdDt0aGlzLmNhbGxiYWNrKFwibW9kaWZ5XCIsW3RoaXMucG9pbnQuZ2VvbWV0cnksdGhpcy5wb2ludCwhMV0pO3RoaXMucG9pbnQuZ2VvbWV0cnkuY2xlYXJCb3VuZHMoKTtcbnRoaXMuZHJhd0ZlYXR1cmUoKX0sZHJhd0ZlYXR1cmU6ZnVuY3Rpb24oKXt0aGlzLmxheWVyLmRyYXdGZWF0dXJlKHRoaXMucG9pbnQsdGhpcy5zdHlsZSl9LGdldEdlb21ldHJ5OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5wb2ludCYmdGhpcy5wb2ludC5nZW9tZXRyeTthJiZ0aGlzLm11bHRpJiYoYT1uZXcgT3BlbkxheWVycy5HZW9tZXRyeS5NdWx0aVBvaW50KFthXSkpO3JldHVybiBhfSxnZW9tZXRyeUNsb25lOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5nZXRHZW9tZXRyeSgpO3JldHVybiBhJiZhLmNsb25lKCl9LG1vdXNlZG93bjpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5kb3duKGEpfSx0b3VjaHN0YXJ0OmZ1bmN0aW9uKGEpe3RoaXMudG91Y2h8fCh0aGlzLnRvdWNoPSEwLHRoaXMubWFwLmV2ZW50cy51bih7bW91c2Vkb3duOnRoaXMubW91c2Vkb3duLG1vdXNldXA6dGhpcy5tb3VzZXVwLG1vdXNlbW92ZTp0aGlzLm1vdXNlbW92ZSxjbGljazp0aGlzLmNsaWNrLGRibGNsaWNrOnRoaXMuZGJsY2xpY2ssXG5zY29wZTp0aGlzfSkpO3RoaXMubGFzdFRvdWNoUHg9YS54eTtyZXR1cm4gdGhpcy5kb3duKGEpfSxtb3VzZW1vdmU6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMubW92ZShhKX0sdG91Y2htb3ZlOmZ1bmN0aW9uKGEpe3RoaXMubGFzdFRvdWNoUHg9YS54eTtyZXR1cm4gdGhpcy5tb3ZlKGEpfSxtb3VzZXVwOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnVwKGEpfSx0b3VjaGVuZDpmdW5jdGlvbihhKXthLnh5PXRoaXMubGFzdFRvdWNoUHg7cmV0dXJuIHRoaXMudXAoYSl9LGRvd246ZnVuY3Rpb24oYSl7dGhpcy5tb3VzZURvd249ITA7dGhpcy5sYXN0RG93bj1hLnh5O3RoaXMudG91Y2h8fHRoaXMubW9kaWZ5RmVhdHVyZShhLnh5KTt0aGlzLnN0b3BwZWREb3duPXRoaXMuc3RvcERvd247cmV0dXJuIXRoaXMuc3RvcERvd259LG1vdmU6ZnVuY3Rpb24oYSl7IXRoaXMudG91Y2gmJighdGhpcy5tb3VzZURvd258fHRoaXMuc3RvcHBlZERvd24pJiZ0aGlzLm1vZGlmeUZlYXR1cmUoYS54eSk7XG5yZXR1cm4hMH0sdXA6ZnVuY3Rpb24oYSl7dGhpcy5tb3VzZURvd249ITE7dGhpcy5zdG9wcGVkRG93bj10aGlzLnN0b3BEb3duO3JldHVybiB0aGlzLmNoZWNrTW9kaWZpZXJzKGEpJiYoIXRoaXMubGFzdFVwfHwhdGhpcy5sYXN0VXAuZXF1YWxzKGEueHkpKSYmdGhpcy5sYXN0RG93biYmdGhpcy5wYXNzZXNUb2xlcmFuY2UodGhpcy5sYXN0RG93bixhLnh5LHRoaXMucGl4ZWxUb2xlcmFuY2UpPyh0aGlzLnRvdWNoJiZ0aGlzLm1vZGlmeUZlYXR1cmUoYS54eSksdGhpcy5wZXJzaXN0JiZ0aGlzLmRlc3Ryb3lQZXJzaXN0ZWRGZWF0dXJlKCksdGhpcy5sYXN0VXA9YS54eSx0aGlzLmZpbmFsaXplKCksIXRoaXMuc3RvcFVwKTohMH0sbW91c2VvdXQ6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5VdGlsLm1vdXNlTGVmdChhLHRoaXMubWFwLnZpZXdQb3J0RGl2KSYmKHRoaXMuc3RvcHBlZERvd249dGhpcy5zdG9wRG93bix0aGlzLm1vdXNlRG93bj0hMSl9LHBhc3Nlc1RvbGVyYW5jZTpmdW5jdGlvbihhLFxuYixjKXt2YXIgZD0hMDtudWxsIT1jJiZhJiZiJiZhLmRpc3RhbmNlVG8oYik+YyYmKGQ9ITEpO3JldHVybiBkfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5IYW5kbGVyLlBvaW50XCJ9KTtPcGVuTGF5ZXJzLkhhbmRsZXIuUGF0aD1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuSGFuZGxlci5Qb2ludCx7bGluZTpudWxsLG1heFZlcnRpY2VzOm51bGwsZG91YmxlVG91Y2hUb2xlcmFuY2U6MjAsZnJlZWhhbmQ6ITEsZnJlZWhhbmRUb2dnbGU6XCJzaGlmdEtleVwiLHRpbWVySWQ6bnVsbCxyZWRvU3RhY2s6bnVsbCxjcmVhdGVGZWF0dXJlOmZ1bmN0aW9uKGEpe2E9dGhpcy5sYXllci5nZXRMb25MYXRGcm9tVmlld1BvcnRQeChhKTthPW5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGEubG9uLGEubGF0KTt0aGlzLnBvaW50PW5ldyBPcGVuTGF5ZXJzLkZlYXR1cmUuVmVjdG9yKGEpO3RoaXMubGluZT1uZXcgT3BlbkxheWVycy5GZWF0dXJlLlZlY3RvcihuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5MaW5lU3RyaW5nKFt0aGlzLnBvaW50Lmdlb21ldHJ5XSkpO3RoaXMuY2FsbGJhY2soXCJjcmVhdGVcIixbdGhpcy5wb2ludC5nZW9tZXRyeSx0aGlzLmdldFNrZXRjaCgpXSk7XG50aGlzLnBvaW50Lmdlb21ldHJ5LmNsZWFyQm91bmRzKCk7dGhpcy5sYXllci5hZGRGZWF0dXJlcyhbdGhpcy5saW5lLHRoaXMucG9pbnRdLHtzaWxlbnQ6ITB9KX0sZGVzdHJveUZlYXR1cmU6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5IYW5kbGVyLlBvaW50LnByb3RvdHlwZS5kZXN0cm95RmVhdHVyZS5jYWxsKHRoaXMsYSk7dGhpcy5saW5lPW51bGx9LGRlc3Ryb3lQZXJzaXN0ZWRGZWF0dXJlOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5sYXllcjthJiYyPGEuZmVhdHVyZXMubGVuZ3RoJiZ0aGlzLmxheWVyLmZlYXR1cmVzWzBdLmRlc3Ryb3koKX0scmVtb3ZlUG9pbnQ6ZnVuY3Rpb24oKXt0aGlzLnBvaW50JiZ0aGlzLmxheWVyLnJlbW92ZUZlYXR1cmVzKFt0aGlzLnBvaW50XSl9LGFkZFBvaW50OmZ1bmN0aW9uKGEpe3RoaXMubGF5ZXIucmVtb3ZlRmVhdHVyZXMoW3RoaXMucG9pbnRdKTthPXRoaXMubGF5ZXIuZ2V0TG9uTGF0RnJvbVZpZXdQb3J0UHgoYSk7dGhpcy5wb2ludD1uZXcgT3BlbkxheWVycy5GZWF0dXJlLlZlY3RvcihuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChhLmxvbixcbmEubGF0KSk7dGhpcy5saW5lLmdlb21ldHJ5LmFkZENvbXBvbmVudCh0aGlzLnBvaW50Lmdlb21ldHJ5LHRoaXMubGluZS5nZW9tZXRyeS5jb21wb25lbnRzLmxlbmd0aCk7dGhpcy5sYXllci5hZGRGZWF0dXJlcyhbdGhpcy5wb2ludF0pO3RoaXMuY2FsbGJhY2soXCJwb2ludFwiLFt0aGlzLnBvaW50Lmdlb21ldHJ5LHRoaXMuZ2V0R2VvbWV0cnkoKV0pO3RoaXMuY2FsbGJhY2soXCJtb2RpZnlcIixbdGhpcy5wb2ludC5nZW9tZXRyeSx0aGlzLmdldFNrZXRjaCgpXSk7dGhpcy5kcmF3RmVhdHVyZSgpO2RlbGV0ZSB0aGlzLnJlZG9TdGFja30saW5zZXJ0WFk6ZnVuY3Rpb24oYSxiKXt0aGlzLmxpbmUuZ2VvbWV0cnkuYWRkQ29tcG9uZW50KG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGEsYiksdGhpcy5nZXRDdXJyZW50UG9pbnRJbmRleCgpKTt0aGlzLmRyYXdGZWF0dXJlKCk7ZGVsZXRlIHRoaXMucmVkb1N0YWNrfSxpbnNlcnREZWx0YVhZOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5saW5lLmdlb21ldHJ5LmNvbXBvbmVudHNbdGhpcy5nZXRDdXJyZW50UG9pbnRJbmRleCgpLVxuMV07YyYmKCFpc05hTihjLngpJiYhaXNOYU4oYy55KSkmJnRoaXMuaW5zZXJ0WFkoYy54K2EsYy55K2IpfSxpbnNlcnREaXJlY3Rpb25MZW5ndGg6ZnVuY3Rpb24oYSxiKXt2YXIgYT1hKihNYXRoLlBJLzE4MCksYz1iKk1hdGguY29zKGEpLGQ9YipNYXRoLnNpbihhKTt0aGlzLmluc2VydERlbHRhWFkoYyxkKX0saW5zZXJ0RGVmbGVjdGlvbkxlbmd0aDpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuZ2V0Q3VycmVudFBvaW50SW5kZXgoKS0xO2lmKDA8Yyl7dmFyIGQ9dGhpcy5saW5lLmdlb21ldHJ5LmNvbXBvbmVudHNbY10sYz10aGlzLmxpbmUuZ2VvbWV0cnkuY29tcG9uZW50c1tjLTFdO3RoaXMuaW5zZXJ0RGlyZWN0aW9uTGVuZ3RoKDE4MCpNYXRoLmF0YW4yKGQueS1jLnksZC54LWMueCkvTWF0aC5QSSthLGIpfX0sZ2V0Q3VycmVudFBvaW50SW5kZXg6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5saW5lLmdlb21ldHJ5LmNvbXBvbmVudHMubGVuZ3RoLTF9LHVuZG86ZnVuY3Rpb24oKXt2YXIgYT1cbnRoaXMubGluZS5nZW9tZXRyeSxiPWEuY29tcG9uZW50cyxjPXRoaXMuZ2V0Q3VycmVudFBvaW50SW5kZXgoKS0xLGI9YltjXTtpZihhPWEucmVtb3ZlQ29tcG9uZW50KGIpKXRoaXMucmVkb1N0YWNrfHwodGhpcy5yZWRvU3RhY2s9W10pLHRoaXMucmVkb1N0YWNrLnB1c2goYiksdGhpcy5kcmF3RmVhdHVyZSgpO3JldHVybiBhfSxyZWRvOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5yZWRvU3RhY2smJnRoaXMucmVkb1N0YWNrLnBvcCgpO2EmJih0aGlzLmxpbmUuZ2VvbWV0cnkuYWRkQ29tcG9uZW50KGEsdGhpcy5nZXRDdXJyZW50UG9pbnRJbmRleCgpKSx0aGlzLmRyYXdGZWF0dXJlKCkpO3JldHVybiEhYX0sZnJlZWhhbmRNb2RlOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmZyZWVoYW5kVG9nZ2xlJiZhW3RoaXMuZnJlZWhhbmRUb2dnbGVdPyF0aGlzLmZyZWVoYW5kOnRoaXMuZnJlZWhhbmR9LG1vZGlmeUZlYXR1cmU6ZnVuY3Rpb24oYSxiKXt0aGlzLmxpbmV8fHRoaXMuY3JlYXRlRmVhdHVyZShhKTtcbnZhciBjPXRoaXMubGF5ZXIuZ2V0TG9uTGF0RnJvbVZpZXdQb3J0UHgoYSk7dGhpcy5wb2ludC5nZW9tZXRyeS54PWMubG9uO3RoaXMucG9pbnQuZ2VvbWV0cnkueT1jLmxhdDt0aGlzLmNhbGxiYWNrKFwibW9kaWZ5XCIsW3RoaXMucG9pbnQuZ2VvbWV0cnksdGhpcy5nZXRTa2V0Y2goKSxiXSk7dGhpcy5wb2ludC5nZW9tZXRyeS5jbGVhckJvdW5kcygpO3RoaXMuZHJhd0ZlYXR1cmUoKX0sZHJhd0ZlYXR1cmU6ZnVuY3Rpb24oKXt0aGlzLmxheWVyLmRyYXdGZWF0dXJlKHRoaXMubGluZSx0aGlzLnN0eWxlKTt0aGlzLmxheWVyLmRyYXdGZWF0dXJlKHRoaXMucG9pbnQsdGhpcy5zdHlsZSl9LGdldFNrZXRjaDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmxpbmV9LGdldEdlb21ldHJ5OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5saW5lJiZ0aGlzLmxpbmUuZ2VvbWV0cnk7YSYmdGhpcy5tdWx0aSYmKGE9bmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuTXVsdGlMaW5lU3RyaW5nKFthXSkpO3JldHVybiBhfSxcbnRvdWNoc3RhcnQ6ZnVuY3Rpb24oYSl7aWYodGhpcy50aW1lcklkJiZ0aGlzLnBhc3Nlc1RvbGVyYW5jZSh0aGlzLmxhc3RUb3VjaFB4LGEueHksdGhpcy5kb3VibGVUb3VjaFRvbGVyYW5jZSkpcmV0dXJuIHRoaXMuZmluaXNoR2VvbWV0cnkoKSx3aW5kb3cuY2xlYXJUaW1lb3V0KHRoaXMudGltZXJJZCksdGhpcy50aW1lcklkPW51bGwsITE7dGhpcy50aW1lcklkJiYod2luZG93LmNsZWFyVGltZW91dCh0aGlzLnRpbWVySWQpLHRoaXMudGltZXJJZD1udWxsKTt0aGlzLnRpbWVySWQ9d2luZG93LnNldFRpbWVvdXQoT3BlbkxheWVycy5GdW5jdGlvbi5iaW5kKGZ1bmN0aW9uKCl7dGhpcy50aW1lcklkPW51bGx9LHRoaXMpLDMwMCk7cmV0dXJuIE9wZW5MYXllcnMuSGFuZGxlci5Qb2ludC5wcm90b3R5cGUudG91Y2hzdGFydC5jYWxsKHRoaXMsYSl9LGRvd246ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5zdG9wRG93bjt0aGlzLmZyZWVoYW5kTW9kZShhKSYmKGI9ITAsdGhpcy50b3VjaCYmXG4odGhpcy5tb2RpZnlGZWF0dXJlKGEueHksISF0aGlzLmxhc3RVcCksT3BlbkxheWVycy5FdmVudC5zdG9wKGEpKSk7IXRoaXMudG91Y2gmJighdGhpcy5sYXN0RG93bnx8IXRoaXMucGFzc2VzVG9sZXJhbmNlKHRoaXMubGFzdERvd24sYS54eSx0aGlzLnBpeGVsVG9sZXJhbmNlKSkmJnRoaXMubW9kaWZ5RmVhdHVyZShhLnh5LCEhdGhpcy5sYXN0VXApO3RoaXMubW91c2VEb3duPSEwO3RoaXMubGFzdERvd249YS54eTt0aGlzLnN0b3BwZWREb3duPWI7cmV0dXJuIWJ9LG1vdmU6ZnVuY3Rpb24oYSl7aWYodGhpcy5zdG9wcGVkRG93biYmdGhpcy5mcmVlaGFuZE1vZGUoYSkpcmV0dXJuIHRoaXMucGVyc2lzdCYmdGhpcy5kZXN0cm95UGVyc2lzdGVkRmVhdHVyZSgpLHRoaXMubWF4VmVydGljZXMmJnRoaXMubGluZSYmdGhpcy5saW5lLmdlb21ldHJ5LmNvbXBvbmVudHMubGVuZ3RoPT09dGhpcy5tYXhWZXJ0aWNlcz8odGhpcy5yZW1vdmVQb2ludCgpLHRoaXMuZmluYWxpemUoKSk6dGhpcy5hZGRQb2ludChhLnh5KSxcbiExOyF0aGlzLnRvdWNoJiYoIXRoaXMubW91c2VEb3dufHx0aGlzLnN0b3BwZWREb3duKSYmdGhpcy5tb2RpZnlGZWF0dXJlKGEueHksISF0aGlzLmxhc3RVcCk7cmV0dXJuITB9LHVwOmZ1bmN0aW9uKGEpe2lmKHRoaXMubW91c2VEb3duJiYoIXRoaXMubGFzdFVwfHwhdGhpcy5sYXN0VXAuZXF1YWxzKGEueHkpKSl0aGlzLnN0b3BwZWREb3duJiZ0aGlzLmZyZWVoYW5kTW9kZShhKT8odGhpcy5wZXJzaXN0JiZ0aGlzLmRlc3Ryb3lQZXJzaXN0ZWRGZWF0dXJlKCksdGhpcy5yZW1vdmVQb2ludCgpLHRoaXMuZmluYWxpemUoKSk6dGhpcy5wYXNzZXNUb2xlcmFuY2UodGhpcy5sYXN0RG93bixhLnh5LHRoaXMucGl4ZWxUb2xlcmFuY2UpJiYodGhpcy50b3VjaCYmdGhpcy5tb2RpZnlGZWF0dXJlKGEueHkpLG51bGw9PXRoaXMubGFzdFVwJiZ0aGlzLnBlcnNpc3QmJnRoaXMuZGVzdHJveVBlcnNpc3RlZEZlYXR1cmUoKSx0aGlzLmFkZFBvaW50KGEueHkpLHRoaXMubGFzdFVwPWEueHksdGhpcy5saW5lLmdlb21ldHJ5LmNvbXBvbmVudHMubGVuZ3RoPT09XG50aGlzLm1heFZlcnRpY2VzKzEmJnRoaXMuZmluaXNoR2VvbWV0cnkoKSk7dGhpcy5zdG9wcGVkRG93bj10aGlzLnN0b3BEb3duO3RoaXMubW91c2VEb3duPSExO3JldHVybiF0aGlzLnN0b3BVcH0sZmluaXNoR2VvbWV0cnk6ZnVuY3Rpb24oKXt0aGlzLmxpbmUuZ2VvbWV0cnkucmVtb3ZlQ29tcG9uZW50KHRoaXMubGluZS5nZW9tZXRyeS5jb21wb25lbnRzW3RoaXMubGluZS5nZW9tZXRyeS5jb21wb25lbnRzLmxlbmd0aC0xXSk7dGhpcy5yZW1vdmVQb2ludCgpO3RoaXMuZmluYWxpemUoKX0sZGJsY2xpY2s6ZnVuY3Rpb24oYSl7dGhpcy5mcmVlaGFuZE1vZGUoYSl8fHRoaXMuZmluaXNoR2VvbWV0cnkoKTtyZXR1cm4hMX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuSGFuZGxlci5QYXRoXCJ9KTtPcGVuTGF5ZXJzLlNwaGVyaWNhbD1PcGVuTGF5ZXJzLlNwaGVyaWNhbHx8e307T3BlbkxheWVycy5TcGhlcmljYWwuREVGQVVMVF9SQURJVVM9NjM3ODEzNztPcGVuTGF5ZXJzLlNwaGVyaWNhbC5jb21wdXRlRGlzdGFuY2VCZXR3ZWVuPWZ1bmN0aW9uKGEsYixjKXt2YXIgYz1jfHxPcGVuTGF5ZXJzLlNwaGVyaWNhbC5ERUZBVUxUX1JBRElVUyxkPU1hdGguc2luKE1hdGguUEkqKGIubG9uLWEubG9uKS8zNjApLGU9TWF0aC5zaW4oTWF0aC5QSSooYi5sYXQtYS5sYXQpLzM2MCksYT1lKmUrZCpkKk1hdGguY29zKE1hdGguUEkqYS5sYXQvMTgwKSpNYXRoLmNvcyhNYXRoLlBJKmIubGF0LzE4MCk7cmV0dXJuIDIqYypNYXRoLmF0YW4yKE1hdGguc3FydChhKSxNYXRoLnNxcnQoMS1hKSl9O1xuT3BlbkxheWVycy5TcGhlcmljYWwuY29tcHV0ZUhlYWRpbmc9ZnVuY3Rpb24oYSxiKXt2YXIgYz1NYXRoLnNpbihNYXRoLlBJKihhLmxvbi1iLmxvbikvMTgwKSpNYXRoLmNvcyhNYXRoLlBJKmIubGF0LzE4MCksZD1NYXRoLmNvcyhNYXRoLlBJKmEubGF0LzE4MCkqTWF0aC5zaW4oTWF0aC5QSSpiLmxhdC8xODApLU1hdGguc2luKE1hdGguUEkqYS5sYXQvMTgwKSpNYXRoLmNvcyhNYXRoLlBJKmIubGF0LzE4MCkqTWF0aC5jb3MoTWF0aC5QSSooYS5sb24tYi5sb24pLzE4MCk7cmV0dXJuIDE4MCpNYXRoLmF0YW4yKGMsZCkvTWF0aC5QSX07T3BlbkxheWVycy5Db250cm9sLkNhY2hlV3JpdGU9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkNvbnRyb2wse2xheWVyczpudWxsLGltYWdlRm9ybWF0OlwiaW1hZ2UvcG5nXCIscXVvdGFSZWdFeDovcXVvdGEvaSxzZXRNYXA6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5zZXRNYXAuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciBiLGM9dGhpcy5sYXllcnN8fGEubGF5ZXJzO2ZvcihiPWMubGVuZ3RoLTE7MDw9YjstLWIpdGhpcy5hZGRMYXllcih7bGF5ZXI6Y1tiXX0pO2lmKCF0aGlzLmxheWVycylhLmV2ZW50cy5vbih7YWRkbGF5ZXI6dGhpcy5hZGRMYXllcixyZW1vdmVMYXllcjp0aGlzLnJlbW92ZUxheWVyLHNjb3BlOnRoaXN9KX0sYWRkTGF5ZXI6ZnVuY3Rpb24oYSl7YS5sYXllci5ldmVudHMub24oe3RpbGVsb2Fkc3RhcnQ6dGhpcy5tYWtlU2FtZU9yaWdpbix0aWxlbG9hZGVkOnRoaXMuY2FjaGUsc2NvcGU6dGhpc30pfSxyZW1vdmVMYXllcjpmdW5jdGlvbihhKXthLmxheWVyLmV2ZW50cy51bih7dGlsZWxvYWRzdGFydDp0aGlzLm1ha2VTYW1lT3JpZ2luLFxudGlsZWxvYWRlZDp0aGlzLmNhY2hlLHNjb3BlOnRoaXN9KX0sbWFrZVNhbWVPcmlnaW46ZnVuY3Rpb24oYSl7aWYodGhpcy5hY3RpdmUmJihhPWEudGlsZSxhIGluc3RhbmNlb2YgT3BlbkxheWVycy5UaWxlLkltYWdlJiYhYS5jcm9zc09yaWdpbktleXdvcmQmJlwiZGF0YTpcIiE9PWEudXJsLnN1YnN0cigwLDUpKSl7dmFyIGI9T3BlbkxheWVycy5SZXF1ZXN0Lm1ha2VTYW1lT3JpZ2luKGEudXJsLE9wZW5MYXllcnMuUHJveHlIb3N0KTtPcGVuTGF5ZXJzLkNvbnRyb2wuQ2FjaGVXcml0ZS51cmxNYXBbYl09YS51cmw7YS51cmw9Yn19LGNhY2hlOmZ1bmN0aW9uKGEpe2lmKHRoaXMuYWN0aXZlJiZ3aW5kb3cubG9jYWxTdG9yYWdlJiYoYT1hLnRpbGUsYSBpbnN0YW5jZW9mIE9wZW5MYXllcnMuVGlsZS5JbWFnZSYmXCJkYXRhOlwiIT09YS51cmwuc3Vic3RyKDAsNSkpKXRyeXt2YXIgYj1hLmdldENhbnZhc0NvbnRleHQoKTtpZihiKXt2YXIgYz1PcGVuTGF5ZXJzLkNvbnRyb2wuQ2FjaGVXcml0ZS51cmxNYXA7XG53aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJvbENhY2hlX1wiKyhjW2EudXJsXXx8YS51cmwpLGIuY2FudmFzLnRvRGF0YVVSTCh0aGlzLmltYWdlRm9ybWF0KSk7ZGVsZXRlIGNbYS51cmxdfX1jYXRjaChkKXsoYj1kLm5hbWV8fGQubWVzc2FnZSkmJnRoaXMucXVvdGFSZWdFeC50ZXN0KGIpP3RoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcImNhY2hlZnVsbFwiLHt0aWxlOmF9KTpPcGVuTGF5ZXJzLkNvbnNvbGUuZXJyb3IoZC50b1N0cmluZygpKX19LGRlc3Ryb3k6ZnVuY3Rpb24oKXtpZih0aGlzLmxheWVyc3x8dGhpcy5tYXApe3ZhciBhLGI9dGhpcy5sYXllcnN8fHRoaXMubWFwLmxheWVycztmb3IoYT1iLmxlbmd0aC0xOzA8PWE7LS1hKXRoaXMucmVtb3ZlTGF5ZXIoe2xheWVyOmJbYV19KX10aGlzLm1hcCYmdGhpcy5tYXAuZXZlbnRzLnVuKHthZGRsYXllcjp0aGlzLmFkZExheWVyLHJlbW92ZUxheWVyOnRoaXMucmVtb3ZlTGF5ZXIsc2NvcGU6dGhpc30pO09wZW5MYXllcnMuQ29udHJvbC5wcm90b3R5cGUuZGVzdHJveS5hcHBseSh0aGlzLFxuYXJndW1lbnRzKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuQ29udHJvbC5DYWNoZVdyaXRlXCJ9KTtPcGVuTGF5ZXJzLkNvbnRyb2wuQ2FjaGVXcml0ZS5jbGVhckNhY2hlPWZ1bmN0aW9uKCl7aWYod2luZG93LmxvY2FsU3RvcmFnZSl7dmFyIGEsYjtmb3IoYT13aW5kb3cubG9jYWxTdG9yYWdlLmxlbmd0aC0xOzA8PWE7LS1hKWI9d2luZG93LmxvY2FsU3RvcmFnZS5rZXkoYSksXCJvbENhY2hlX1wiPT09Yi5zdWJzdHIoMCw4KSYmd2luZG93LmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKGIpfX07T3BlbkxheWVycy5Db250cm9sLkNhY2hlV3JpdGUudXJsTWFwPXt9O09wZW5MYXllcnMuRm9ybWF0LkNvbnRleHQ9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkZvcm1hdC5YTUwuVmVyc2lvbmVkT0dDLHtsYXllck9wdGlvbnM6bnVsbCxsYXllclBhcmFtczpudWxsLHJlYWQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz1PcGVuTGF5ZXJzLkZvcm1hdC5YTUwuVmVyc2lvbmVkT0dDLnByb3RvdHlwZS5yZWFkLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtpZihiJiZiLm1hcClpZih0aGlzLmNvbnRleHQ9YyxiLm1hcCBpbnN0YW5jZW9mIE9wZW5MYXllcnMuTWFwKWM9dGhpcy5tZXJnZUNvbnRleHRUb01hcChjLGIubWFwKTtlbHNle3ZhciBkPWIubWFwO2lmKE9wZW5MYXllcnMuVXRpbC5pc0VsZW1lbnQoZCl8fFwic3RyaW5nXCI9PXR5cGVvZiBkKWQ9e2RpdjpkfTtjPXRoaXMuY29udGV4dFRvTWFwKGMsZCl9cmV0dXJuIGN9LGdldExheWVyRnJvbUNvbnRleHQ6ZnVuY3Rpb24oYSl7dmFyIGIsYyxkPXtxdWVyeWFibGU6YS5xdWVyeWFibGUsdmlzaWJpbGl0eTphLnZpc2liaWxpdHksXG5tYXhFeHRlbnQ6YS5tYXhFeHRlbnQsbWV0YWRhdGE6T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoYS5tZXRhZGF0YSx7c3R5bGVzOmEuc3R5bGVzLGZvcm1hdHM6YS5mb3JtYXRzLFwiYWJzdHJhY3RcIjphW1wiYWJzdHJhY3RcIl0sZGF0YVVSTDphLmRhdGFVUkx9KSxudW1ab29tTGV2ZWxzOmEubnVtWm9vbUxldmVscyx1bml0czphLnVuaXRzLGlzQmFzZUxheWVyOmEuaXNCYXNlTGF5ZXIsb3BhY2l0eTphLm9wYWNpdHksZGlzcGxheUluTGF5ZXJTd2l0Y2hlcjphLmRpc3BsYXlJbkxheWVyU3dpdGNoZXIsc2luZ2xlVGlsZTphLnNpbmdsZVRpbGUsdGlsZVNpemU6YS50aWxlU2l6ZT9uZXcgT3BlbkxheWVycy5TaXplKGEudGlsZVNpemUud2lkdGgsYS50aWxlU2l6ZS5oZWlnaHQpOnZvaWQgMCxtaW5TY2FsZTphLm1pblNjYWxlfHxhLm1heFNjYWxlRGVub21pbmF0b3IsbWF4U2NhbGU6YS5tYXhTY2FsZXx8YS5taW5TY2FsZURlbm9taW5hdG9yLHNyczphLnNycyxkaW1lbnNpb25zOmEuZGltZW5zaW9ucyxcbm1ldGFkYXRhVVJMOmEubWV0YWRhdGFVUkx9O3RoaXMubGF5ZXJPcHRpb25zJiZPcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyhkLHRoaXMubGF5ZXJPcHRpb25zKTt2YXIgZT17bGF5ZXJzOmEubmFtZSx0cmFuc3BhcmVudDphLnRyYW5zcGFyZW50LHZlcnNpb246YS52ZXJzaW9ufTtpZihhLmZvcm1hdHMmJjA8YS5mb3JtYXRzLmxlbmd0aCl7ZS5mb3JtYXQ9YS5mb3JtYXRzWzBdLnZhbHVlO2I9MDtmb3IoYz1hLmZvcm1hdHMubGVuZ3RoO2I8YztiKyspe3ZhciBmPWEuZm9ybWF0c1tiXTtpZighMD09Zi5jdXJyZW50KXtlLmZvcm1hdD1mLnZhbHVlO2JyZWFrfX19aWYoYS5zdHlsZXMmJjA8YS5zdHlsZXMubGVuZ3RoKXtiPTA7Zm9yKGM9YS5zdHlsZXMubGVuZ3RoO2I8YztiKyspaWYoZj1hLnN0eWxlc1tiXSwhMD09Zi5jdXJyZW50KXtmLmhyZWY/ZS5zbGQ9Zi5ocmVmOmYuYm9keT9lLnNsZF9ib2R5PWYuYm9keTplLnN0eWxlcz1mLm5hbWU7YnJlYWt9fXRoaXMubGF5ZXJQYXJhbXMmJlxuT3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoZSx0aGlzLmxheWVyUGFyYW1zKTtiPW51bGw7Yz1hLnNlcnZpY2U7Yz09T3BlbkxheWVycy5Gb3JtYXQuQ29udGV4dC5zZXJ2aWNlVHlwZXMuV0ZTPyhkLnN0cmF0ZWdpZXM9W25ldyBPcGVuTGF5ZXJzLlN0cmF0ZWd5LkJCT1hdLGQucHJvdG9jb2w9bmV3IE9wZW5MYXllcnMuUHJvdG9jb2wuV0ZTKHt1cmw6YS51cmwsZmVhdHVyZVByZWZpeDphLm5hbWUuc3BsaXQoXCI6XCIpWzBdLGZlYXR1cmVUeXBlOmEubmFtZS5zcGxpdChcIjpcIikucG9wKCl9KSxiPW5ldyBPcGVuTGF5ZXJzLkxheWVyLlZlY3RvcihhLnRpdGxlfHxhLm5hbWUsZCkpOmM9PU9wZW5MYXllcnMuRm9ybWF0LkNvbnRleHQuc2VydmljZVR5cGVzLktNTD8oZC5zdHJhdGVnaWVzPVtuZXcgT3BlbkxheWVycy5TdHJhdGVneS5GaXhlZF0sZC5wcm90b2NvbD1uZXcgT3BlbkxheWVycy5Qcm90b2NvbC5IVFRQKHt1cmw6YS51cmwsZm9ybWF0Om5ldyBPcGVuTGF5ZXJzLkZvcm1hdC5LTUx9KSxcbmI9bmV3IE9wZW5MYXllcnMuTGF5ZXIuVmVjdG9yKGEudGl0bGV8fGEubmFtZSxkKSk6Yz09T3BlbkxheWVycy5Gb3JtYXQuQ29udGV4dC5zZXJ2aWNlVHlwZXMuR01MPyhkLnN0cmF0ZWdpZXM9W25ldyBPcGVuTGF5ZXJzLlN0cmF0ZWd5LkZpeGVkXSxkLnByb3RvY29sPW5ldyBPcGVuTGF5ZXJzLlByb3RvY29sLkhUVFAoe3VybDphLnVybCxmb3JtYXQ6bmV3IE9wZW5MYXllcnMuRm9ybWF0LkdNTH0pLGI9bmV3IE9wZW5MYXllcnMuTGF5ZXIuVmVjdG9yKGEudGl0bGV8fGEubmFtZSxkKSk6YS5mZWF0dXJlcz8oYj1uZXcgT3BlbkxheWVycy5MYXllci5WZWN0b3IoYS50aXRsZXx8YS5uYW1lLGQpLGIuYWRkRmVhdHVyZXMoYS5mZWF0dXJlcykpOiEwIT09YS5jYXRlZ29yeUxheWVyJiYoYj1uZXcgT3BlbkxheWVycy5MYXllci5XTVMoYS50aXRsZXx8YS5uYW1lLGEudXJsLGUsZCkpO3JldHVybiBifSxnZXRMYXllcnNGcm9tQ29udGV4dDpmdW5jdGlvbihhKXtmb3IodmFyIGI9W10sYz1cbjAsZD1hLmxlbmd0aDtjPGQ7YysrKXt2YXIgZT10aGlzLmdldExheWVyRnJvbUNvbnRleHQoYVtjXSk7bnVsbCE9PWUmJmIucHVzaChlKX1yZXR1cm4gYn0sY29udGV4dFRvTWFwOmZ1bmN0aW9uKGEsYil7Yj1PcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyh7bWF4RXh0ZW50OmEubWF4RXh0ZW50LHByb2plY3Rpb246YS5wcm9qZWN0aW9uLHVuaXRzOmEudW5pdHN9LGIpO2IubWF4RXh0ZW50JiYoYi5tYXhSZXNvbHV0aW9uPWIubWF4RXh0ZW50LmdldFdpZHRoKCkvT3BlbkxheWVycy5NYXAuVElMRV9XSURUSCk7Yi5tZXRhZGF0YT17Y29udGFjdEluZm9ybWF0aW9uOmEuY29udGFjdEluZm9ybWF0aW9uLFwiYWJzdHJhY3RcIjphW1wiYWJzdHJhY3RcIl0sa2V5d29yZHM6YS5rZXl3b3Jkcyxsb2dvOmEubG9nbyxkZXNjcmlwdGlvblVSTDphLmRlc2NyaXB0aW9uVVJMfTt2YXIgYz1uZXcgT3BlbkxheWVycy5NYXAoYik7Yy5hZGRMYXllcnModGhpcy5nZXRMYXllcnNGcm9tQ29udGV4dChhLmxheWVyc0NvbnRleHQpKTtcbmMuc2V0Q2VudGVyKGEuYm91bmRzLmdldENlbnRlckxvbkxhdCgpLGMuZ2V0Wm9vbUZvckV4dGVudChhLmJvdW5kcywhMCkpO3JldHVybiBjfSxtZXJnZUNvbnRleHRUb01hcDpmdW5jdGlvbihhLGIpe2IuYWRkTGF5ZXJzKHRoaXMuZ2V0TGF5ZXJzRnJvbUNvbnRleHQoYS5sYXllcnNDb250ZXh0KSk7cmV0dXJuIGJ9LHdyaXRlOmZ1bmN0aW9uKGEsYil7YT10aGlzLnRvQ29udGV4dChhKTtyZXR1cm4gT3BlbkxheWVycy5Gb3JtYXQuWE1MLlZlcnNpb25lZE9HQy5wcm90b3R5cGUud3JpdGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Gb3JtYXQuQ29udGV4dFwifSk7XG5PcGVuTGF5ZXJzLkZvcm1hdC5Db250ZXh0LnNlcnZpY2VUeXBlcz17V01TOlwidXJuOm9nYzpzZXJ2aWNlVHlwZTpXTVNcIixXRlM6XCJ1cm46b2djOnNlcnZpY2VUeXBlOldGU1wiLFdDUzpcInVybjpvZ2M6c2VydmljZVR5cGU6V0NTXCIsR01MOlwidXJuOm9nYzpzZXJ2aWNlVHlwZTpHTUxcIixTTEQ6XCJ1cm46b2djOnNlcnZpY2VUeXBlOlNMRFwiLEZFUzpcInVybjpvZ2M6c2VydmljZVR5cGU6RkVTXCIsS01MOlwidXJuOm9nYzpzZXJ2aWNlVHlwZTpLTUxcIn07T3BlbkxheWVycy5Gb3JtYXQuV01DPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Gb3JtYXQuQ29udGV4dCx7ZGVmYXVsdFZlcnNpb246XCIxLjEuMFwiLGxheWVyVG9Db250ZXh0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuZ2V0UGFyc2VyKCksYz17cXVlcnlhYmxlOmEucXVlcnlhYmxlLHZpc2liaWxpdHk6YS52aXNpYmlsaXR5LG5hbWU6YS5wYXJhbXMuTEFZRVJTLHRpdGxlOmEubmFtZSxcImFic3RyYWN0XCI6YS5tZXRhZGF0YVtcImFic3RyYWN0XCJdLGRhdGFVUkw6YS5tZXRhZGF0YS5kYXRhVVJMLG1ldGFkYXRhVVJMOmEubWV0YWRhdGFVUkwsc2VydmVyOnt2ZXJzaW9uOmEucGFyYW1zLlZFUlNJT04sdXJsOmEudXJsfSxtYXhFeHRlbnQ6YS5tYXhFeHRlbnQsdHJhbnNwYXJlbnQ6YS5wYXJhbXMuVFJBTlNQQVJFTlQsbnVtWm9vbUxldmVsczphLm51bVpvb21MZXZlbHMsdW5pdHM6YS51bml0cyxpc0Jhc2VMYXllcjphLmlzQmFzZUxheWVyLG9wYWNpdHk6MT09YS5vcGFjaXR5P3ZvaWQgMDpcbmEub3BhY2l0eSxkaXNwbGF5SW5MYXllclN3aXRjaGVyOmEuZGlzcGxheUluTGF5ZXJTd2l0Y2hlcixzaW5nbGVUaWxlOmEuc2luZ2xlVGlsZSx0aWxlU2l6ZTphLnNpbmdsZVRpbGV8fCFhLnRpbGVTaXplP3ZvaWQgMDp7d2lkdGg6YS50aWxlU2l6ZS53LGhlaWdodDphLnRpbGVTaXplLmh9LG1pblNjYWxlOmEub3B0aW9ucy5yZXNvbHV0aW9uc3x8YS5vcHRpb25zLnNjYWxlc3x8YS5vcHRpb25zLm1heFJlc29sdXRpb258fGEub3B0aW9ucy5taW5TY2FsZT9hLm1pblNjYWxlOnZvaWQgMCxtYXhTY2FsZTphLm9wdGlvbnMucmVzb2x1dGlvbnN8fGEub3B0aW9ucy5zY2FsZXN8fGEub3B0aW9ucy5taW5SZXNvbHV0aW9ufHxhLm9wdGlvbnMubWF4U2NhbGU/YS5tYXhTY2FsZTp2b2lkIDAsZm9ybWF0czpbXSxzdHlsZXM6W10sc3JzOmEuc3JzLGRpbWVuc2lvbnM6YS5kaW1lbnNpb25zfTthLm1ldGFkYXRhLnNlcnZlcnRpdGxlJiYoYy5zZXJ2ZXIudGl0bGU9YS5tZXRhZGF0YS5zZXJ2ZXJ0aXRsZSk7XG5pZihhLm1ldGFkYXRhLmZvcm1hdHMmJjA8YS5tZXRhZGF0YS5mb3JtYXRzLmxlbmd0aClmb3IodmFyIGQ9MCxlPWEubWV0YWRhdGEuZm9ybWF0cy5sZW5ndGg7ZDxlO2QrKyl7dmFyIGY9YS5tZXRhZGF0YS5mb3JtYXRzW2RdO2MuZm9ybWF0cy5wdXNoKHt2YWx1ZTpmLnZhbHVlLGN1cnJlbnQ6Zi52YWx1ZT09YS5wYXJhbXMuRk9STUFUfSl9ZWxzZSBjLmZvcm1hdHMucHVzaCh7dmFsdWU6YS5wYXJhbXMuRk9STUFULGN1cnJlbnQ6ITB9KTtpZihhLm1ldGFkYXRhLnN0eWxlcyYmMDxhLm1ldGFkYXRhLnN0eWxlcy5sZW5ndGgpe2Q9MDtmb3IoZT1hLm1ldGFkYXRhLnN0eWxlcy5sZW5ndGg7ZDxlO2QrKyliPWEubWV0YWRhdGEuc3R5bGVzW2RdLGIuY3VycmVudD1iLmhyZWY9PWEucGFyYW1zLlNMRHx8Yi5ib2R5PT1hLnBhcmFtcy5TTERfQk9EWXx8Yi5uYW1lPT1hLnBhcmFtcy5TVFlMRVM/ITA6ITEsYy5zdHlsZXMucHVzaChiKX1lbHNlIGMuc3R5bGVzLnB1c2goe2hyZWY6YS5wYXJhbXMuU0xELFxuYm9keTphLnBhcmFtcy5TTERfQk9EWSxuYW1lOmEucGFyYW1zLlNUWUxFU3x8Yi5kZWZhdWx0U3R5bGVOYW1lLHRpdGxlOmIuZGVmYXVsdFN0eWxlVGl0bGUsY3VycmVudDohMH0pO3JldHVybiBjfSx0b0NvbnRleHQ6ZnVuY3Rpb24oYSl7dmFyIGI9e30sYz1hLmxheWVycztpZihcIk9wZW5MYXllcnMuTWFwXCI9PWEuQ0xBU1NfTkFNRSl7dmFyIGQ9YS5tZXRhZGF0YXx8e307Yi5zaXplPWEuZ2V0U2l6ZSgpO2IuYm91bmRzPWEuZ2V0RXh0ZW50KCk7Yi5wcm9qZWN0aW9uPWEucHJvamVjdGlvbjtiLnRpdGxlPWEudGl0bGU7Yi5rZXl3b3Jkcz1kLmtleXdvcmRzO2JbXCJhYnN0cmFjdFwiXT1kW1wiYWJzdHJhY3RcIl07Yi5sb2dvPWQubG9nbztiLmRlc2NyaXB0aW9uVVJMPWQuZGVzY3JpcHRpb25VUkw7Yi5jb250YWN0SW5mb3JtYXRpb249ZC5jb250YWN0SW5mb3JtYXRpb247Yi5tYXhFeHRlbnQ9YS5tYXhFeHRlbnR9ZWxzZSBPcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyhiLGEpLHZvaWQgMCE9XG5iLmxheWVycyYmZGVsZXRlIGIubGF5ZXJzO3ZvaWQgMD09Yi5sYXllcnNDb250ZXh0JiYoYi5sYXllcnNDb250ZXh0PVtdKTtpZih2b2lkIDAhPWMmJk9wZW5MYXllcnMuVXRpbC5pc0FycmF5KGMpKXthPTA7Zm9yKGQ9Yy5sZW5ndGg7YTxkO2ErKyl7dmFyIGU9Y1thXTtlIGluc3RhbmNlb2YgT3BlbkxheWVycy5MYXllci5XTVMmJmIubGF5ZXJzQ29udGV4dC5wdXNoKHRoaXMubGF5ZXJUb0NvbnRleHQoZSkpfX1yZXR1cm4gYn0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuRm9ybWF0LldNQ1wifSk7T3BlbkxheWVycy5Gb3JtYXQuV01DLnYxPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Gb3JtYXQuWE1MLHtuYW1lc3BhY2VzOntvbDpcImh0dHA6Ly9vcGVubGF5ZXJzLm9yZy9jb250ZXh0XCIsd21jOlwiaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC9jb250ZXh0XCIsc2xkOlwiaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC9zbGRcIix4bGluazpcImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmtcIix4c2k6XCJodHRwOi8vd3d3LnczLm9yZy8yMDAxL1hNTFNjaGVtYS1pbnN0YW5jZVwifSxzY2hlbWFMb2NhdGlvbjpcIlwiLGdldE5hbWVzcGFjZVByZWZpeDpmdW5jdGlvbihhKXt2YXIgYj1udWxsO2lmKG51bGw9PWEpYj10aGlzLm5hbWVzcGFjZXNbdGhpcy5kZWZhdWx0UHJlZml4XTtlbHNlIGZvcihiIGluIHRoaXMubmFtZXNwYWNlcylpZih0aGlzLm5hbWVzcGFjZXNbYl09PWEpYnJlYWs7cmV0dXJuIGJ9LGRlZmF1bHRQcmVmaXg6XCJ3bWNcIixyb290UHJlZml4Om51bGwsZGVmYXVsdFN0eWxlTmFtZTpcIlwiLFxuZGVmYXVsdFN0eWxlVGl0bGU6XCJEZWZhdWx0XCIsaW5pdGlhbGl6ZTpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLkZvcm1hdC5YTUwucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbYV0pfSxyZWFkOmZ1bmN0aW9uKGEpe1wic3RyaW5nXCI9PXR5cGVvZiBhJiYoYT1PcGVuTGF5ZXJzLkZvcm1hdC5YTUwucHJvdG90eXBlLnJlYWQuYXBwbHkodGhpcyxbYV0pKTthPWEuZG9jdW1lbnRFbGVtZW50O3RoaXMucm9vdFByZWZpeD1hLnByZWZpeDt2YXIgYj17dmVyc2lvbjphLmdldEF0dHJpYnV0ZShcInZlcnNpb25cIil9O3RoaXMucnVuQ2hpbGROb2RlcyhiLGEpO3JldHVybiBifSxydW5DaGlsZE5vZGVzOmZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPWIuY2hpbGROb2RlcyxkLGUsZixnPTAsaD1jLmxlbmd0aDtnPGg7KytnKWQ9Y1tnXSwxPT1kLm5vZGVUeXBlJiYoZT10aGlzLmdldE5hbWVzcGFjZVByZWZpeChkLm5hbWVzcGFjZVVSSSksZj1kLm5vZGVOYW1lLnNwbGl0KFwiOlwiKS5wb3AoKSxcbihlPXRoaXNbXCJyZWFkX1wiK2UrXCJfXCIrZl0pJiZlLmFwcGx5KHRoaXMsW2EsZF0pKX0scmVhZF93bWNfR2VuZXJhbDpmdW5jdGlvbihhLGIpe3RoaXMucnVuQ2hpbGROb2RlcyhhLGIpfSxyZWFkX3dtY19Cb3VuZGluZ0JveDpmdW5jdGlvbihhLGIpe2EucHJvamVjdGlvbj1iLmdldEF0dHJpYnV0ZShcIlNSU1wiKTthLmJvdW5kcz1uZXcgT3BlbkxheWVycy5Cb3VuZHMoYi5nZXRBdHRyaWJ1dGUoXCJtaW54XCIpLGIuZ2V0QXR0cmlidXRlKFwibWlueVwiKSxiLmdldEF0dHJpYnV0ZShcIm1heHhcIiksYi5nZXRBdHRyaWJ1dGUoXCJtYXh5XCIpKX0scmVhZF93bWNfTGF5ZXJMaXN0OmZ1bmN0aW9uKGEsYil7YS5sYXllcnNDb250ZXh0PVtdO3RoaXMucnVuQ2hpbGROb2RlcyhhLGIpfSxyZWFkX3dtY19MYXllcjpmdW5jdGlvbihhLGIpe3ZhciBjPXt2aXNpYmlsaXR5OlwiMVwiIT1iLmdldEF0dHJpYnV0ZShcImhpZGRlblwiKSxxdWVyeWFibGU6XCIxXCI9PWIuZ2V0QXR0cmlidXRlKFwicXVlcnlhYmxlXCIpLGZvcm1hdHM6W10sXG5zdHlsZXM6W10sbWV0YWRhdGE6e319O3RoaXMucnVuQ2hpbGROb2RlcyhjLGIpO2EubGF5ZXJzQ29udGV4dC5wdXNoKGMpfSxyZWFkX3dtY19FeHRlbnNpb246ZnVuY3Rpb24oYSxiKXt0aGlzLnJ1bkNoaWxkTm9kZXMoYSxiKX0scmVhZF9vbF91bml0czpmdW5jdGlvbihhLGIpe2EudW5pdHM9dGhpcy5nZXRDaGlsZFZhbHVlKGIpfSxyZWFkX29sX21heEV4dGVudDpmdW5jdGlvbihhLGIpe3ZhciBjPW5ldyBPcGVuTGF5ZXJzLkJvdW5kcyhiLmdldEF0dHJpYnV0ZShcIm1pbnhcIiksYi5nZXRBdHRyaWJ1dGUoXCJtaW55XCIpLGIuZ2V0QXR0cmlidXRlKFwibWF4eFwiKSxiLmdldEF0dHJpYnV0ZShcIm1heHlcIikpO2EubWF4RXh0ZW50PWN9LHJlYWRfb2xfdHJhbnNwYXJlbnQ6ZnVuY3Rpb24oYSxiKXthLnRyYW5zcGFyZW50PXRoaXMuZ2V0Q2hpbGRWYWx1ZShiKX0scmVhZF9vbF9udW1ab29tTGV2ZWxzOmZ1bmN0aW9uKGEsYil7YS5udW1ab29tTGV2ZWxzPXBhcnNlSW50KHRoaXMuZ2V0Q2hpbGRWYWx1ZShiKSl9LFxucmVhZF9vbF9vcGFjaXR5OmZ1bmN0aW9uKGEsYil7YS5vcGFjaXR5PXBhcnNlRmxvYXQodGhpcy5nZXRDaGlsZFZhbHVlKGIpKX0scmVhZF9vbF9zaW5nbGVUaWxlOmZ1bmN0aW9uKGEsYil7YS5zaW5nbGVUaWxlPVwidHJ1ZVwiPT10aGlzLmdldENoaWxkVmFsdWUoYil9LHJlYWRfb2xfdGlsZVNpemU6ZnVuY3Rpb24oYSxiKXt2YXIgYz17d2lkdGg6Yi5nZXRBdHRyaWJ1dGUoXCJ3aWR0aFwiKSxoZWlnaHQ6Yi5nZXRBdHRyaWJ1dGUoXCJoZWlnaHRcIil9O2EudGlsZVNpemU9Y30scmVhZF9vbF9pc0Jhc2VMYXllcjpmdW5jdGlvbihhLGIpe2EuaXNCYXNlTGF5ZXI9XCJ0cnVlXCI9PXRoaXMuZ2V0Q2hpbGRWYWx1ZShiKX0scmVhZF9vbF9kaXNwbGF5SW5MYXllclN3aXRjaGVyOmZ1bmN0aW9uKGEsYil7YS5kaXNwbGF5SW5MYXllclN3aXRjaGVyPVwidHJ1ZVwiPT10aGlzLmdldENoaWxkVmFsdWUoYil9LHJlYWRfd21jX1NlcnZlcjpmdW5jdGlvbihhLGIpe2EudmVyc2lvbj1iLmdldEF0dHJpYnV0ZShcInZlcnNpb25cIik7XG5hLnVybD10aGlzLmdldE9ubGluZVJlc291cmNlX2hyZWYoYik7YS5tZXRhZGF0YS5zZXJ2ZXJ0aXRsZT1iLmdldEF0dHJpYnV0ZShcInRpdGxlXCIpfSxyZWFkX3dtY19Gb3JtYXRMaXN0OmZ1bmN0aW9uKGEsYil7dGhpcy5ydW5DaGlsZE5vZGVzKGEsYil9LHJlYWRfd21jX0Zvcm1hdDpmdW5jdGlvbihhLGIpe3ZhciBjPXt2YWx1ZTp0aGlzLmdldENoaWxkVmFsdWUoYil9O1wiMVwiPT1iLmdldEF0dHJpYnV0ZShcImN1cnJlbnRcIikmJihjLmN1cnJlbnQ9ITApO2EuZm9ybWF0cy5wdXNoKGMpfSxyZWFkX3dtY19TdHlsZUxpc3Q6ZnVuY3Rpb24oYSxiKXt0aGlzLnJ1bkNoaWxkTm9kZXMoYSxiKX0scmVhZF93bWNfU3R5bGU6ZnVuY3Rpb24oYSxiKXt2YXIgYz17fTt0aGlzLnJ1bkNoaWxkTm9kZXMoYyxiKTtcIjFcIj09Yi5nZXRBdHRyaWJ1dGUoXCJjdXJyZW50XCIpJiYoYy5jdXJyZW50PSEwKTthLnN0eWxlcy5wdXNoKGMpfSxyZWFkX3dtY19TTEQ6ZnVuY3Rpb24oYSxiKXt0aGlzLnJ1bkNoaWxkTm9kZXMoYSxcbmIpfSxyZWFkX3NsZF9TdHlsZWRMYXllckRlc2NyaXB0b3I6ZnVuY3Rpb24oYSxiKXt2YXIgYz1PcGVuTGF5ZXJzLkZvcm1hdC5YTUwucHJvdG90eXBlLndyaXRlLmFwcGx5KHRoaXMsW2JdKTthLmJvZHk9Y30scmVhZF9zbGRfRmVhdHVyZVR5cGVTdHlsZTpmdW5jdGlvbihhLGIpe3ZhciBjPU9wZW5MYXllcnMuRm9ybWF0LlhNTC5wcm90b3R5cGUud3JpdGUuYXBwbHkodGhpcyxbYl0pO2EuYm9keT1jfSxyZWFkX3dtY19PbmxpbmVSZXNvdXJjZTpmdW5jdGlvbihhLGIpe2EuaHJlZj10aGlzLmdldEF0dHJpYnV0ZU5TKGIsdGhpcy5uYW1lc3BhY2VzLnhsaW5rLFwiaHJlZlwiKX0scmVhZF93bWNfTmFtZTpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuZ2V0Q2hpbGRWYWx1ZShiKTtjJiYoYS5uYW1lPWMpfSxyZWFkX3dtY19UaXRsZTpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuZ2V0Q2hpbGRWYWx1ZShiKTtjJiYoYS50aXRsZT1jKX0scmVhZF93bWNfTWV0YWRhdGFVUkw6ZnVuY3Rpb24oYSxcbmIpe2EubWV0YWRhdGFVUkw9dGhpcy5nZXRPbmxpbmVSZXNvdXJjZV9ocmVmKGIpfSxyZWFkX3dtY19LZXl3b3JkTGlzdDpmdW5jdGlvbihhLGIpe2Eua2V5d29yZHM9W107dGhpcy5ydW5DaGlsZE5vZGVzKGEua2V5d29yZHMsYil9LHJlYWRfd21jX0tleXdvcmQ6ZnVuY3Rpb24oYSxiKXthLnB1c2godGhpcy5nZXRDaGlsZFZhbHVlKGIpKX0scmVhZF93bWNfQWJzdHJhY3Q6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmdldENoaWxkVmFsdWUoYik7YyYmKGFbXCJhYnN0cmFjdFwiXT1jKX0scmVhZF93bWNfTG9nb1VSTDpmdW5jdGlvbihhLGIpe2EubG9nbz17d2lkdGg6Yi5nZXRBdHRyaWJ1dGUoXCJ3aWR0aFwiKSxoZWlnaHQ6Yi5nZXRBdHRyaWJ1dGUoXCJoZWlnaHRcIiksZm9ybWF0OmIuZ2V0QXR0cmlidXRlKFwiZm9ybWF0XCIpLGhyZWY6dGhpcy5nZXRPbmxpbmVSZXNvdXJjZV9ocmVmKGIpfX0scmVhZF93bWNfRGVzY3JpcHRpb25VUkw6ZnVuY3Rpb24oYSxiKXthLmRlc2NyaXB0aW9uVVJMPVxudGhpcy5nZXRPbmxpbmVSZXNvdXJjZV9ocmVmKGIpfSxyZWFkX3dtY19Db250YWN0SW5mb3JtYXRpb246ZnVuY3Rpb24oYSxiKXt2YXIgYz17fTt0aGlzLnJ1bkNoaWxkTm9kZXMoYyxiKTthLmNvbnRhY3RJbmZvcm1hdGlvbj1jfSxyZWFkX3dtY19Db250YWN0UGVyc29uUHJpbWFyeTpmdW5jdGlvbihhLGIpe3ZhciBjPXt9O3RoaXMucnVuQ2hpbGROb2RlcyhjLGIpO2EucGVyc29uUHJpbWFyeT1jfSxyZWFkX3dtY19Db250YWN0UGVyc29uOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5nZXRDaGlsZFZhbHVlKGIpO2MmJihhLnBlcnNvbj1jKX0scmVhZF93bWNfQ29udGFjdE9yZ2FuaXphdGlvbjpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuZ2V0Q2hpbGRWYWx1ZShiKTtjJiYoYS5vcmdhbml6YXRpb249Yyl9LHJlYWRfd21jX0NvbnRhY3RQb3NpdGlvbjpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuZ2V0Q2hpbGRWYWx1ZShiKTtjJiYoYS5wb3NpdGlvbj1jKX0scmVhZF93bWNfQ29udGFjdEFkZHJlc3M6ZnVuY3Rpb24oYSxcbmIpe3ZhciBjPXt9O3RoaXMucnVuQ2hpbGROb2RlcyhjLGIpO2EuY29udGFjdEFkZHJlc3M9Y30scmVhZF93bWNfQWRkcmVzc1R5cGU6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmdldENoaWxkVmFsdWUoYik7YyYmKGEudHlwZT1jKX0scmVhZF93bWNfQWRkcmVzczpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuZ2V0Q2hpbGRWYWx1ZShiKTtjJiYoYS5hZGRyZXNzPWMpfSxyZWFkX3dtY19DaXR5OmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5nZXRDaGlsZFZhbHVlKGIpO2MmJihhLmNpdHk9Yyl9LHJlYWRfd21jX1N0YXRlT3JQcm92aW5jZTpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuZ2V0Q2hpbGRWYWx1ZShiKTtjJiYoYS5zdGF0ZU9yUHJvdmluY2U9Yyl9LHJlYWRfd21jX1Bvc3RDb2RlOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5nZXRDaGlsZFZhbHVlKGIpO2MmJihhLnBvc3Rjb2RlPWMpfSxyZWFkX3dtY19Db3VudHJ5OmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5nZXRDaGlsZFZhbHVlKGIpO1xuYyYmKGEuY291bnRyeT1jKX0scmVhZF93bWNfQ29udGFjdFZvaWNlVGVsZXBob25lOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5nZXRDaGlsZFZhbHVlKGIpO2MmJihhLnBob25lPWMpfSxyZWFkX3dtY19Db250YWN0RmFjc2ltaWxlVGVsZXBob25lOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5nZXRDaGlsZFZhbHVlKGIpO2MmJihhLmZheD1jKX0scmVhZF93bWNfQ29udGFjdEVsZWN0cm9uaWNNYWlsQWRkcmVzczpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuZ2V0Q2hpbGRWYWx1ZShiKTtjJiYoYS5lbWFpbD1jKX0scmVhZF93bWNfRGF0YVVSTDpmdW5jdGlvbihhLGIpe2EuZGF0YVVSTD10aGlzLmdldE9ubGluZVJlc291cmNlX2hyZWYoYil9LHJlYWRfd21jX0xlZ2VuZFVSTDpmdW5jdGlvbihhLGIpe3ZhciBjPXt3aWR0aDpiLmdldEF0dHJpYnV0ZShcIndpZHRoXCIpLGhlaWdodDpiLmdldEF0dHJpYnV0ZShcImhlaWdodFwiKSxmb3JtYXQ6Yi5nZXRBdHRyaWJ1dGUoXCJmb3JtYXRcIiksXG5ocmVmOnRoaXMuZ2V0T25saW5lUmVzb3VyY2VfaHJlZihiKX07YS5sZWdlbmQ9Y30scmVhZF93bWNfRGltZW5zaW9uTGlzdDpmdW5jdGlvbihhLGIpe2EuZGltZW5zaW9ucz17fTt0aGlzLnJ1bkNoaWxkTm9kZXMoYS5kaW1lbnNpb25zLGIpfSxyZWFkX3dtY19EaW1lbnNpb246ZnVuY3Rpb24oYSxiKXt2YXIgYz17bmFtZTpiLmdldEF0dHJpYnV0ZShcIm5hbWVcIikudG9Mb3dlckNhc2UoKSx1bml0czpiLmdldEF0dHJpYnV0ZShcInVuaXRzXCIpfHxcIlwiLHVuaXRTeW1ib2w6Yi5nZXRBdHRyaWJ1dGUoXCJ1bml0U3ltYm9sXCIpfHxcIlwiLHVzZXJWYWx1ZTpiLmdldEF0dHJpYnV0ZShcInVzZXJWYWx1ZVwiKXx8XCJcIixuZWFyZXN0VmFsdWU6XCIxXCI9PT1iLmdldEF0dHJpYnV0ZShcIm5lYXJlc3RWYWx1ZVwiKSxtdWx0aXBsZVZhbHVlczpcIjFcIj09PWIuZ2V0QXR0cmlidXRlKFwibXVsdGlwbGVWYWx1ZXNcIiksY3VycmVudDpcIjFcIj09PWIuZ2V0QXR0cmlidXRlKFwiY3VycmVudFwiKSxcImRlZmF1bHRcIjpiLmdldEF0dHJpYnV0ZShcImRlZmF1bHRcIil8fFxuXCJcIn0sZD10aGlzLmdldENoaWxkVmFsdWUoYik7Yy52YWx1ZXM9ZC5zcGxpdChcIixcIik7YVtjLm5hbWVdPWN9LHdyaXRlOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5jcmVhdGVFbGVtZW50RGVmYXVsdE5TKFwiVmlld0NvbnRleHRcIik7dGhpcy5zZXRBdHRyaWJ1dGVzKGMse3ZlcnNpb246dGhpcy5WRVJTSU9OLGlkOmImJlwic3RyaW5nXCI9PXR5cGVvZiBiLmlkP2IuaWQ6T3BlbkxheWVycy5VdGlsLmNyZWF0ZVVuaXF1ZUlEKFwiT3BlbkxheWVyc19Db250ZXh0X1wiKX0pO3RoaXMuc2V0QXR0cmlidXRlTlMoYyx0aGlzLm5hbWVzcGFjZXMueHNpLFwieHNpOnNjaGVtYUxvY2F0aW9uXCIsdGhpcy5zY2hlbWFMb2NhdGlvbik7Yy5hcHBlbmRDaGlsZCh0aGlzLndyaXRlX3dtY19HZW5lcmFsKGEpKTtjLmFwcGVuZENoaWxkKHRoaXMud3JpdGVfd21jX0xheWVyTGlzdChhKSk7cmV0dXJuIE9wZW5MYXllcnMuRm9ybWF0LlhNTC5wcm90b3R5cGUud3JpdGUuYXBwbHkodGhpcyxbY10pfSxjcmVhdGVFbGVtZW50RGVmYXVsdE5TOmZ1bmN0aW9uKGEsXG5iLGMpe2E9dGhpcy5jcmVhdGVFbGVtZW50TlModGhpcy5uYW1lc3BhY2VzW3RoaXMuZGVmYXVsdFByZWZpeF0sYSk7YiYmYS5hcHBlbmRDaGlsZCh0aGlzLmNyZWF0ZVRleHROb2RlKGIpKTtjJiZ0aGlzLnNldEF0dHJpYnV0ZXMoYSxjKTtyZXR1cm4gYX0sc2V0QXR0cmlidXRlczpmdW5jdGlvbihhLGIpe3ZhciBjLGQ7Zm9yKGQgaW4gYiljPWJbZF0udG9TdHJpbmcoKSxjLm1hdGNoKC9bQS1aXS8pP3RoaXMuc2V0QXR0cmlidXRlTlMoYSxudWxsLGQsYyk6YS5zZXRBdHRyaWJ1dGUoZCxjKX0sd3JpdGVfd21jX0dlbmVyYWw6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50RGVmYXVsdE5TKFwiR2VuZXJhbFwiKTthLnNpemUmJmIuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVFbGVtZW50RGVmYXVsdE5TKFwiV2luZG93XCIsbnVsbCx7d2lkdGg6YS5zaXplLncsaGVpZ2h0OmEuc2l6ZS5ofSkpO3ZhciBjPWEuYm91bmRzO2IuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVFbGVtZW50RGVmYXVsdE5TKFwiQm91bmRpbmdCb3hcIixcbm51bGwse21pbng6Yy5sZWZ0LnRvUHJlY2lzaW9uKDE4KSxtaW55OmMuYm90dG9tLnRvUHJlY2lzaW9uKDE4KSxtYXh4OmMucmlnaHQudG9QcmVjaXNpb24oMTgpLG1heHk6Yy50b3AudG9QcmVjaXNpb24oMTgpLFNSUzphLnByb2plY3Rpb259KSk7Yi5hcHBlbmRDaGlsZCh0aGlzLmNyZWF0ZUVsZW1lbnREZWZhdWx0TlMoXCJUaXRsZVwiLGEudGl0bGUpKTthLmtleXdvcmRzJiZiLmFwcGVuZENoaWxkKHRoaXMud3JpdGVfd21jX0tleXdvcmRMaXN0KGEua2V5d29yZHMpKTthW1wiYWJzdHJhY3RcIl0mJmIuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVFbGVtZW50RGVmYXVsdE5TKFwiQWJzdHJhY3RcIixhW1wiYWJzdHJhY3RcIl0pKTthLmxvZ28mJmIuYXBwZW5kQ2hpbGQodGhpcy53cml0ZV93bWNfVVJMVHlwZShcIkxvZ29VUkxcIixhLmxvZ28uaHJlZixhLmxvZ28pKTthLmRlc2NyaXB0aW9uVVJMJiZiLmFwcGVuZENoaWxkKHRoaXMud3JpdGVfd21jX1VSTFR5cGUoXCJEZXNjcmlwdGlvblVSTFwiLGEuZGVzY3JpcHRpb25VUkwpKTtcbmEuY29udGFjdEluZm9ybWF0aW9uJiZiLmFwcGVuZENoaWxkKHRoaXMud3JpdGVfd21jX0NvbnRhY3RJbmZvcm1hdGlvbihhLmNvbnRhY3RJbmZvcm1hdGlvbikpO2IuYXBwZW5kQ2hpbGQodGhpcy53cml0ZV9vbF9NYXBFeHRlbnNpb24oYSkpO3JldHVybiBifSx3cml0ZV93bWNfS2V5d29yZExpc3Q6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPXRoaXMuY3JlYXRlRWxlbWVudERlZmF1bHROUyhcIktleXdvcmRMaXN0XCIpLGM9MCxkPWEubGVuZ3RoO2M8ZDtjKyspYi5hcHBlbmRDaGlsZCh0aGlzLmNyZWF0ZUVsZW1lbnREZWZhdWx0TlMoXCJLZXl3b3JkXCIsYVtjXSkpO3JldHVybiBifSx3cml0ZV93bWNfQ29udGFjdEluZm9ybWF0aW9uOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudERlZmF1bHROUyhcIkNvbnRhY3RJbmZvcm1hdGlvblwiKTthLnBlcnNvblByaW1hcnkmJmIuYXBwZW5kQ2hpbGQodGhpcy53cml0ZV93bWNfQ29udGFjdFBlcnNvblByaW1hcnkoYS5wZXJzb25QcmltYXJ5KSk7XG5hLnBvc2l0aW9uJiZiLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlRWxlbWVudERlZmF1bHROUyhcIkNvbnRhY3RQb3NpdGlvblwiLGEucG9zaXRpb24pKTthLmNvbnRhY3RBZGRyZXNzJiZiLmFwcGVuZENoaWxkKHRoaXMud3JpdGVfd21jX0NvbnRhY3RBZGRyZXNzKGEuY29udGFjdEFkZHJlc3MpKTthLnBob25lJiZiLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlRWxlbWVudERlZmF1bHROUyhcIkNvbnRhY3RWb2ljZVRlbGVwaG9uZVwiLGEucGhvbmUpKTthLmZheCYmYi5hcHBlbmRDaGlsZCh0aGlzLmNyZWF0ZUVsZW1lbnREZWZhdWx0TlMoXCJDb250YWN0RmFjc2ltaWxlVGVsZXBob25lXCIsYS5mYXgpKTthLmVtYWlsJiZiLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlRWxlbWVudERlZmF1bHROUyhcIkNvbnRhY3RFbGVjdHJvbmljTWFpbEFkZHJlc3NcIixhLmVtYWlsKSk7cmV0dXJuIGJ9LHdyaXRlX3dtY19Db250YWN0UGVyc29uUHJpbWFyeTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnREZWZhdWx0TlMoXCJDb250YWN0UGVyc29uUHJpbWFyeVwiKTtcbmEucGVyc29uJiZiLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlRWxlbWVudERlZmF1bHROUyhcIkNvbnRhY3RQZXJzb25cIixhLnBlcnNvbikpO2Eub3JnYW5pemF0aW9uJiZiLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlRWxlbWVudERlZmF1bHROUyhcIkNvbnRhY3RPcmdhbml6YXRpb25cIixhLm9yZ2FuaXphdGlvbikpO3JldHVybiBifSx3cml0ZV93bWNfQ29udGFjdEFkZHJlc3M6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50RGVmYXVsdE5TKFwiQ29udGFjdEFkZHJlc3NcIik7YS50eXBlJiZiLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlRWxlbWVudERlZmF1bHROUyhcIkFkZHJlc3NUeXBlXCIsYS50eXBlKSk7YS5hZGRyZXNzJiZiLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlRWxlbWVudERlZmF1bHROUyhcIkFkZHJlc3NcIixhLmFkZHJlc3MpKTthLmNpdHkmJmIuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVFbGVtZW50RGVmYXVsdE5TKFwiQ2l0eVwiLGEuY2l0eSkpO2Euc3RhdGVPclByb3ZpbmNlJiZcbmIuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVFbGVtZW50RGVmYXVsdE5TKFwiU3RhdGVPclByb3ZpbmNlXCIsYS5zdGF0ZU9yUHJvdmluY2UpKTthLnBvc3Rjb2RlJiZiLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlRWxlbWVudERlZmF1bHROUyhcIlBvc3RDb2RlXCIsYS5wb3N0Y29kZSkpO2EuY291bnRyeSYmYi5hcHBlbmRDaGlsZCh0aGlzLmNyZWF0ZUVsZW1lbnREZWZhdWx0TlMoXCJDb3VudHJ5XCIsYS5jb3VudHJ5KSk7cmV0dXJuIGJ9LHdyaXRlX29sX01hcEV4dGVuc2lvbjpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnREZWZhdWx0TlMoXCJFeHRlbnNpb25cIik7aWYoYT1hLm1heEV4dGVudCl7dmFyIGM9dGhpcy5jcmVhdGVFbGVtZW50TlModGhpcy5uYW1lc3BhY2VzLm9sLFwib2w6bWF4RXh0ZW50XCIpO3RoaXMuc2V0QXR0cmlidXRlcyhjLHttaW54OmEubGVmdC50b1ByZWNpc2lvbigxOCksbWlueTphLmJvdHRvbS50b1ByZWNpc2lvbigxOCksbWF4eDphLnJpZ2h0LnRvUHJlY2lzaW9uKDE4KSxcbm1heHk6YS50b3AudG9QcmVjaXNpb24oMTgpfSk7Yi5hcHBlbmRDaGlsZChjKX1yZXR1cm4gYn0sd3JpdGVfd21jX0xheWVyTGlzdDpmdW5jdGlvbihhKXtmb3IodmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50RGVmYXVsdE5TKFwiTGF5ZXJMaXN0XCIpLGM9MCxkPWEubGF5ZXJzQ29udGV4dC5sZW5ndGg7YzxkOysrYyliLmFwcGVuZENoaWxkKHRoaXMud3JpdGVfd21jX0xheWVyKGEubGF5ZXJzQ29udGV4dFtjXSkpO3JldHVybiBifSx3cml0ZV93bWNfTGF5ZXI6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50RGVmYXVsdE5TKFwiTGF5ZXJcIixudWxsLHtxdWVyeWFibGU6YS5xdWVyeWFibGU/XCIxXCI6XCIwXCIsaGlkZGVuOmEudmlzaWJpbGl0eT9cIjBcIjpcIjFcIn0pO2IuYXBwZW5kQ2hpbGQodGhpcy53cml0ZV93bWNfU2VydmVyKGEpKTtiLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlRWxlbWVudERlZmF1bHROUyhcIk5hbWVcIixhLm5hbWUpKTtiLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlRWxlbWVudERlZmF1bHROUyhcIlRpdGxlXCIsXG5hLnRpdGxlKSk7YVtcImFic3RyYWN0XCJdJiZiLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlRWxlbWVudERlZmF1bHROUyhcIkFic3RyYWN0XCIsYVtcImFic3RyYWN0XCJdKSk7YS5kYXRhVVJMJiZiLmFwcGVuZENoaWxkKHRoaXMud3JpdGVfd21jX1VSTFR5cGUoXCJEYXRhVVJMXCIsYS5kYXRhVVJMKSk7YS5tZXRhZGF0YVVSTCYmYi5hcHBlbmRDaGlsZCh0aGlzLndyaXRlX3dtY19VUkxUeXBlKFwiTWV0YWRhdGFVUkxcIixhLm1ldGFkYXRhVVJMKSk7cmV0dXJuIGJ9LHdyaXRlX3dtY19MYXllckV4dGVuc2lvbjpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnREZWZhdWx0TlMoXCJFeHRlbnNpb25cIiksYz1hLm1heEV4dGVudCxkPXRoaXMuY3JlYXRlRWxlbWVudE5TKHRoaXMubmFtZXNwYWNlcy5vbCxcIm9sOm1heEV4dGVudFwiKTt0aGlzLnNldEF0dHJpYnV0ZXMoZCx7bWlueDpjLmxlZnQudG9QcmVjaXNpb24oMTgpLG1pbnk6Yy5ib3R0b20udG9QcmVjaXNpb24oMTgpLG1heHg6Yy5yaWdodC50b1ByZWNpc2lvbigxOCksXG5tYXh5OmMudG9wLnRvUHJlY2lzaW9uKDE4KX0pO2IuYXBwZW5kQ2hpbGQoZCk7YS50aWxlU2l6ZSYmIWEuc2luZ2xlVGlsZSYmKGM9dGhpcy5jcmVhdGVFbGVtZW50TlModGhpcy5uYW1lc3BhY2VzLm9sLFwib2w6dGlsZVNpemVcIiksdGhpcy5zZXRBdHRyaWJ1dGVzKGMsYS50aWxlU2l6ZSksYi5hcHBlbmRDaGlsZChjKSk7Zm9yKHZhciBjPVwidHJhbnNwYXJlbnQgbnVtWm9vbUxldmVscyB1bml0cyBpc0Jhc2VMYXllciBvcGFjaXR5IGRpc3BsYXlJbkxheWVyU3dpdGNoZXIgc2luZ2xlVGlsZVwiLnNwbGl0KFwiIFwiKSxlPTAsZj1jLmxlbmd0aDtlPGY7KytlKShkPXRoaXMuY3JlYXRlT0xQcm9wZXJ0eU5vZGUoYSxjW2VdKSkmJmIuYXBwZW5kQ2hpbGQoZCk7cmV0dXJuIGJ9LGNyZWF0ZU9MUHJvcGVydHlOb2RlOmZ1bmN0aW9uKGEsYil7dmFyIGM9bnVsbDtudWxsIT1hW2JdJiYoYz10aGlzLmNyZWF0ZUVsZW1lbnROUyh0aGlzLm5hbWVzcGFjZXMub2wsXCJvbDpcIitiKSxjLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlVGV4dE5vZGUoYVtiXS50b1N0cmluZygpKSkpO1xucmV0dXJuIGN9LHdyaXRlX3dtY19TZXJ2ZXI6ZnVuY3Rpb24oYSl7dmFyIGE9YS5zZXJ2ZXIsYj10aGlzLmNyZWF0ZUVsZW1lbnREZWZhdWx0TlMoXCJTZXJ2ZXJcIiksYz17c2VydmljZTpcIk9HQzpXTVNcIix2ZXJzaW9uOmEudmVyc2lvbn07YS50aXRsZSYmKGMudGl0bGU9YS50aXRsZSk7dGhpcy5zZXRBdHRyaWJ1dGVzKGIsYyk7Yi5hcHBlbmRDaGlsZCh0aGlzLndyaXRlX3dtY19PbmxpbmVSZXNvdXJjZShhLnVybCkpO3JldHVybiBifSx3cml0ZV93bWNfVVJMVHlwZTpmdW5jdGlvbihhLGIsYyl7YT10aGlzLmNyZWF0ZUVsZW1lbnREZWZhdWx0TlMoYSk7YS5hcHBlbmRDaGlsZCh0aGlzLndyaXRlX3dtY19PbmxpbmVSZXNvdXJjZShiKSk7aWYoYylmb3IodmFyIGI9W1wid2lkdGhcIixcImhlaWdodFwiLFwiZm9ybWF0XCJdLGQ9MDtkPGIubGVuZ3RoO2QrKyliW2RdaW4gYyYmYS5zZXRBdHRyaWJ1dGUoYltkXSxjW2JbZF1dKTtyZXR1cm4gYX0sd3JpdGVfd21jX0RpbWVuc2lvbkxpc3Q6ZnVuY3Rpb24oYSl7dmFyIGI9XG50aGlzLmNyZWF0ZUVsZW1lbnREZWZhdWx0TlMoXCJEaW1lbnNpb25MaXN0XCIpLGM7Zm9yKGMgaW4gYS5kaW1lbnNpb25zKXt2YXIgZD17fSxlPWEuZGltZW5zaW9uc1tjXSxmO2ZvcihmIGluIGUpZFtmXT1cImJvb2xlYW5cIj09dHlwZW9mIGVbZl0/TnVtYmVyKGVbZl0pOmVbZl07ZT1cIlwiO2QudmFsdWVzJiYoZT1kLnZhbHVlcy5qb2luKFwiLFwiKSxkZWxldGUgZC52YWx1ZXMpO2IuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVFbGVtZW50RGVmYXVsdE5TKFwiRGltZW5zaW9uXCIsZSxkKSl9cmV0dXJuIGJ9LHdyaXRlX3dtY19Gb3JtYXRMaXN0OmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnREZWZhdWx0TlMoXCJGb3JtYXRMaXN0XCIpLGM9MCxkPWEuZm9ybWF0cy5sZW5ndGg7YzxkO2MrKyl7dmFyIGU9YS5mb3JtYXRzW2NdO2IuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVFbGVtZW50RGVmYXVsdE5TKFwiRm9ybWF0XCIsZS52YWx1ZSxlLmN1cnJlbnQmJiEwPT1lLmN1cnJlbnQ/e2N1cnJlbnQ6XCIxXCJ9OlxubnVsbCkpfXJldHVybiBifSx3cml0ZV93bWNfU3R5bGVMaXN0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudERlZmF1bHROUyhcIlN0eWxlTGlzdFwiKTtpZigoYT1hLnN0eWxlcykmJk9wZW5MYXllcnMuVXRpbC5pc0FycmF5KGEpKWZvcih2YXIgYyxkPTAsZT1hLmxlbmd0aDtkPGU7ZCsrKXt2YXIgZj1hW2RdLGc9dGhpcy5jcmVhdGVFbGVtZW50RGVmYXVsdE5TKFwiU3R5bGVcIixudWxsLGYuY3VycmVudCYmITA9PWYuY3VycmVudD97Y3VycmVudDpcIjFcIn06bnVsbCk7Zi5ocmVmPyhjPXRoaXMuY3JlYXRlRWxlbWVudERlZmF1bHROUyhcIlNMRFwiKSxmLm5hbWUmJmMuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVFbGVtZW50RGVmYXVsdE5TKFwiTmFtZVwiLGYubmFtZSkpLGYudGl0bGUmJmMuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVFbGVtZW50RGVmYXVsdE5TKFwiVGl0bGVcIixmLnRpdGxlKSksZi5sZWdlbmQmJmMuYXBwZW5kQ2hpbGQodGhpcy53cml0ZV93bWNfVVJMVHlwZShcIkxlZ2VuZFVSTFwiLFxuZi5sZWdlbmQuaHJlZixmLmxlZ2VuZCkpLGY9dGhpcy53cml0ZV93bWNfT25saW5lUmVzb3VyY2UoZi5ocmVmKSxjLmFwcGVuZENoaWxkKGYpLGcuYXBwZW5kQ2hpbGQoYykpOmYuYm9keT8oYz10aGlzLmNyZWF0ZUVsZW1lbnREZWZhdWx0TlMoXCJTTERcIiksZi5uYW1lJiZjLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlRWxlbWVudERlZmF1bHROUyhcIk5hbWVcIixmLm5hbWUpKSxmLnRpdGxlJiZjLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlRWxlbWVudERlZmF1bHROUyhcIlRpdGxlXCIsZi50aXRsZSkpLGYubGVnZW5kJiZjLmFwcGVuZENoaWxkKHRoaXMud3JpdGVfd21jX1VSTFR5cGUoXCJMZWdlbmRVUkxcIixmLmxlZ2VuZC5ocmVmLGYubGVnZW5kKSksZj1PcGVuTGF5ZXJzLkZvcm1hdC5YTUwucHJvdG90eXBlLnJlYWQuYXBwbHkodGhpcyxbZi5ib2R5XSkuZG9jdW1lbnRFbGVtZW50LGMub3duZXJEb2N1bWVudCYmYy5vd25lckRvY3VtZW50LmltcG9ydE5vZGUmJihmPWMub3duZXJEb2N1bWVudC5pbXBvcnROb2RlKGYsXG4hMCkpLGMuYXBwZW5kQ2hpbGQoZiksZy5hcHBlbmRDaGlsZChjKSk6KGcuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVFbGVtZW50RGVmYXVsdE5TKFwiTmFtZVwiLGYubmFtZSkpLGcuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVFbGVtZW50RGVmYXVsdE5TKFwiVGl0bGVcIixmLnRpdGxlKSksZltcImFic3RyYWN0XCJdJiZnLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlRWxlbWVudERlZmF1bHROUyhcIkFic3RyYWN0XCIsZltcImFic3RyYWN0XCJdKSksZi5sZWdlbmQmJmcuYXBwZW5kQ2hpbGQodGhpcy53cml0ZV93bWNfVVJMVHlwZShcIkxlZ2VuZFVSTFwiLGYubGVnZW5kLmhyZWYsZi5sZWdlbmQpKSk7Yi5hcHBlbmRDaGlsZChnKX1yZXR1cm4gYn0sd3JpdGVfd21jX09ubGluZVJlc291cmNlOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudERlZmF1bHROUyhcIk9ubGluZVJlc291cmNlXCIpO3RoaXMuc2V0QXR0cmlidXRlTlMoYix0aGlzLm5hbWVzcGFjZXMueGxpbmssXCJ4bGluazp0eXBlXCIsXG5cInNpbXBsZVwiKTt0aGlzLnNldEF0dHJpYnV0ZU5TKGIsdGhpcy5uYW1lc3BhY2VzLnhsaW5rLFwieGxpbms6aHJlZlwiLGEpO3JldHVybiBifSxnZXRPbmxpbmVSZXNvdXJjZV9ocmVmOmZ1bmN0aW9uKGEpe3ZhciBiPXt9LGE9YS5nZXRFbGVtZW50c0J5VGFnTmFtZShcIk9ubGluZVJlc291cmNlXCIpOzA8YS5sZW5ndGgmJnRoaXMucmVhZF93bWNfT25saW5lUmVzb3VyY2UoYixhWzBdKTtyZXR1cm4gYi5ocmVmfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Gb3JtYXQuV01DLnYxXCJ9KTtPcGVuTGF5ZXJzLkNvbnRyb2wuUGFuUGFuZWw9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkNvbnRyb2wuUGFuZWwse3NsaWRlRmFjdG9yOjUwLHNsaWRlUmF0aW86bnVsbCxpbml0aWFsaXplOmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuQ29udHJvbC5QYW5lbC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLFthXSk7YT17c2xpZGVGYWN0b3I6dGhpcy5zbGlkZUZhY3RvcixzbGlkZVJhdGlvOnRoaXMuc2xpZGVSYXRpb307dGhpcy5hZGRDb250cm9scyhbbmV3IE9wZW5MYXllcnMuQ29udHJvbC5QYW4oT3BlbkxheWVycy5Db250cm9sLlBhbi5OT1JUSCxhKSxuZXcgT3BlbkxheWVycy5Db250cm9sLlBhbihPcGVuTGF5ZXJzLkNvbnRyb2wuUGFuLlNPVVRILGEpLG5ldyBPcGVuTGF5ZXJzLkNvbnRyb2wuUGFuKE9wZW5MYXllcnMuQ29udHJvbC5QYW4uRUFTVCxhKSxuZXcgT3BlbkxheWVycy5Db250cm9sLlBhbihPcGVuTGF5ZXJzLkNvbnRyb2wuUGFuLldFU1QsYSldKX0sXG5DTEFTU19OQU1FOlwiT3BlbkxheWVycy5Db250cm9sLlBhblBhbmVsXCJ9KTtPcGVuTGF5ZXJzLkNvbnRyb2wuQXR0cmlidXRpb249T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkNvbnRyb2wse3NlcGFyYXRvcjpcIiwgXCIsdGVtcGxhdGU6XCIke2xheWVyc31cIixkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5tYXAuZXZlbnRzLnVuKHtyZW1vdmVsYXllcjp0aGlzLnVwZGF0ZUF0dHJpYnV0aW9uLGFkZGxheWVyOnRoaXMudXBkYXRlQXR0cmlidXRpb24sY2hhbmdlbGF5ZXI6dGhpcy51cGRhdGVBdHRyaWJ1dGlvbixjaGFuZ2ViYXNlbGF5ZXI6dGhpcy51cGRhdGVBdHRyaWJ1dGlvbixzY29wZTp0aGlzfSk7T3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5kZXN0cm95LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sZHJhdzpmdW5jdGlvbigpe09wZW5MYXllcnMuQ29udHJvbC5wcm90b3R5cGUuZHJhdy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5tYXAuZXZlbnRzLm9uKHtjaGFuZ2ViYXNlbGF5ZXI6dGhpcy51cGRhdGVBdHRyaWJ1dGlvbixjaGFuZ2VsYXllcjp0aGlzLnVwZGF0ZUF0dHJpYnV0aW9uLFxuYWRkbGF5ZXI6dGhpcy51cGRhdGVBdHRyaWJ1dGlvbixyZW1vdmVsYXllcjp0aGlzLnVwZGF0ZUF0dHJpYnV0aW9uLHNjb3BlOnRoaXN9KTt0aGlzLnVwZGF0ZUF0dHJpYnV0aW9uKCk7cmV0dXJuIHRoaXMuZGl2fSx1cGRhdGVBdHRyaWJ1dGlvbjpmdW5jdGlvbigpe3ZhciBhPVtdO2lmKHRoaXMubWFwJiZ0aGlzLm1hcC5sYXllcnMpe2Zvcih2YXIgYj0wLGM9dGhpcy5tYXAubGF5ZXJzLmxlbmd0aDtiPGM7YisrKXt2YXIgZD10aGlzLm1hcC5sYXllcnNbYl07ZC5hdHRyaWJ1dGlvbiYmZC5nZXRWaXNpYmlsaXR5KCkmJi0xPT09T3BlbkxheWVycy5VdGlsLmluZGV4T2YoYSxkLmF0dHJpYnV0aW9uKSYmYS5wdXNoKGQuYXR0cmlidXRpb24pfXRoaXMuZGl2LmlubmVySFRNTD1PcGVuTGF5ZXJzLlN0cmluZy5mb3JtYXQodGhpcy50ZW1wbGF0ZSx7bGF5ZXJzOmEuam9pbih0aGlzLnNlcGFyYXRvcil9KX19LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkNvbnRyb2wuQXR0cmlidXRpb25cIn0pO09wZW5MYXllcnMuS2luZXRpYz1PcGVuTGF5ZXJzLkNsYXNzKHt0aHJlc2hvbGQ6MCxkZWNlbGVyYXRpb246MC4wMDM1LG5iUG9pbnRzOjEwMCxkZWxheToyMDAscG9pbnRzOnZvaWQgMCx0aW1lcklkOnZvaWQgMCxpbml0aWFsaXplOmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuVXRpbC5leHRlbmQodGhpcyxhKX0sYmVnaW46ZnVuY3Rpb24oKXtPcGVuTGF5ZXJzLkFuaW1hdGlvbi5zdG9wKHRoaXMudGltZXJJZCk7dGhpcy50aW1lcklkPXZvaWQgMDt0aGlzLnBvaW50cz1bXX0sdXBkYXRlOmZ1bmN0aW9uKGEpe3RoaXMucG9pbnRzLnVuc2hpZnQoe3h5OmEsdGljazoobmV3IERhdGUpLmdldFRpbWUoKX0pO3RoaXMucG9pbnRzLmxlbmd0aD50aGlzLm5iUG9pbnRzJiZ0aGlzLnBvaW50cy5wb3AoKX0sZW5kOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYixjPShuZXcgRGF0ZSkuZ2V0VGltZSgpLGQ9MCxlPXRoaXMucG9pbnRzLmxlbmd0aCxmO2Q8ZTtkKyspe2Y9dGhpcy5wb2ludHNbZF07aWYoYy1cbmYudGljaz50aGlzLmRlbGF5KWJyZWFrO2I9Zn1pZihiJiYoZD0obmV3IERhdGUpLmdldFRpbWUoKS1iLnRpY2ssYz1NYXRoLnNxcnQoTWF0aC5wb3coYS54LWIueHkueCwyKStNYXRoLnBvdyhhLnktYi54eS55LDIpKSxkPWMvZCwhKDA9PWR8fGQ8dGhpcy50aHJlc2hvbGQpKSlyZXR1cm4gYz1NYXRoLmFzaW4oKGEueS1iLnh5LnkpL2MpLGIueHkueDw9YS54JiYoYz1NYXRoLlBJLWMpLHtzcGVlZDpkLHRoZXRhOmN9fSxtb3ZlOmZ1bmN0aW9uKGEsYil7dmFyIGM9YS5zcGVlZCxkPU1hdGguY29zKGEudGhldGEpLGU9LU1hdGguc2luKGEudGhldGEpLGY9KG5ldyBEYXRlKS5nZXRUaW1lKCksZz0wLGg9MDt0aGlzLnRpbWVySWQ9T3BlbkxheWVycy5BbmltYXRpb24uc3RhcnQoT3BlbkxheWVycy5GdW5jdGlvbi5iaW5kKGZ1bmN0aW9uKCl7aWYobnVsbCE9dGhpcy50aW1lcklkKXt2YXIgYT0obmV3IERhdGUpLmdldFRpbWUoKS1mLGo9LXRoaXMuZGVjZWxlcmF0aW9uKk1hdGgucG93KGEsXG4yKS8yK2MqYSxrPWoqZCxqPWoqZSxsLG07bD0hMTswPj0tdGhpcy5kZWNlbGVyYXRpb24qYStjJiYoT3BlbkxheWVycy5BbmltYXRpb24uc3RvcCh0aGlzLnRpbWVySWQpLHRoaXMudGltZXJJZD1udWxsLGw9ITApO2E9ay1nO209ai1oO2c9aztoPWo7YihhLG0sbCl9fSx0aGlzKSl9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLktpbmV0aWNcIn0pO09wZW5MYXllcnMuTGF5ZXIuR2VvUlNTPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5MYXllci5NYXJrZXJzLHtsb2NhdGlvbjpudWxsLGZlYXR1cmVzOm51bGwsZm9ybWF0T3B0aW9uczpudWxsLHNlbGVjdGVkRmVhdHVyZTpudWxsLGljb246bnVsbCxwb3B1cFNpemU6bnVsbCx1c2VGZWVkVGl0bGU6ITAsaW5pdGlhbGl6ZTpmdW5jdGlvbihhLGIsYyl7T3BlbkxheWVycy5MYXllci5NYXJrZXJzLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsW2EsY10pO3RoaXMubG9jYXRpb249Yjt0aGlzLmZlYXR1cmVzPVtdfSxkZXN0cm95OmZ1bmN0aW9uKCl7T3BlbkxheWVycy5MYXllci5NYXJrZXJzLnByb3RvdHlwZS5kZXN0cm95LmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmNsZWFyRmVhdHVyZXMoKTt0aGlzLmZlYXR1cmVzPW51bGx9LGxvYWRSU1M6ZnVuY3Rpb24oKXt0aGlzLmxvYWRlZHx8KHRoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcImxvYWRzdGFydFwiKSxPcGVuTGF5ZXJzLlJlcXVlc3QuR0VUKHt1cmw6dGhpcy5sb2NhdGlvbixcbnN1Y2Nlc3M6dGhpcy5wYXJzZURhdGEsc2NvcGU6dGhpc30pLHRoaXMubG9hZGVkPSEwKX0sbW92ZVRvOmZ1bmN0aW9uKGEsYixjKXtPcGVuTGF5ZXJzLkxheWVyLk1hcmtlcnMucHJvdG90eXBlLm1vdmVUby5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy52aXNpYmlsaXR5JiYhdGhpcy5sb2FkZWQmJnRoaXMubG9hZFJTUygpfSxwYXJzZURhdGE6ZnVuY3Rpb24oYSl7dmFyIGI9YS5yZXNwb25zZVhNTDtpZighYnx8IWIuZG9jdW1lbnRFbGVtZW50KWI9T3BlbkxheWVycy5Gb3JtYXQuWE1MLnByb3RvdHlwZS5yZWFkKGEucmVzcG9uc2VUZXh0KTtpZih0aGlzLnVzZUZlZWRUaXRsZSl7YT1udWxsO3RyeXthPWIuZ2V0RWxlbWVudHNCeVRhZ05hbWVOUyhcIipcIixcInRpdGxlXCIpWzBdLmZpcnN0Q2hpbGQubm9kZVZhbHVlfWNhdGNoKGMpe2E9Yi5nZXRFbGVtZW50c0J5VGFnTmFtZShcInRpdGxlXCIpWzBdLmZpcnN0Q2hpbGQubm9kZVZhbHVlfWEmJnRoaXMuc2V0TmFtZShhKX1hPXt9O09wZW5MYXllcnMuVXRpbC5leHRlbmQoYSxcbnRoaXMuZm9ybWF0T3B0aW9ucyk7dGhpcy5tYXAmJiF0aGlzLnByb2plY3Rpb24uZXF1YWxzKHRoaXMubWFwLmdldFByb2plY3Rpb25PYmplY3QoKSkmJihhLmV4dGVybmFsUHJvamVjdGlvbj10aGlzLnByb2plY3Rpb24sYS5pbnRlcm5hbFByb2plY3Rpb249dGhpcy5tYXAuZ2V0UHJvamVjdGlvbk9iamVjdCgpKTtmb3IodmFyIGI9KG5ldyBPcGVuTGF5ZXJzLkZvcm1hdC5HZW9SU1MoYSkpLnJlYWQoYiksYT0wLGQ9Yi5sZW5ndGg7YTxkO2ErKyl7dmFyIGU9e30sZj1iW2FdO2lmKGYuZ2VvbWV0cnkpe3ZhciBnPWYuYXR0cmlidXRlcy50aXRsZT9mLmF0dHJpYnV0ZXMudGl0bGU6XCJVbnRpdGxlZFwiLGg9Zi5hdHRyaWJ1dGVzLmRlc2NyaXB0aW9uP2YuYXR0cmlidXRlcy5kZXNjcmlwdGlvbjpcIk5vIGRlc2NyaXB0aW9uLlwiLGk9Zi5hdHRyaWJ1dGVzLmxpbms/Zi5hdHRyaWJ1dGVzLmxpbms6XCJcIixmPWYuZ2VvbWV0cnkuZ2V0Qm91bmRzKCkuZ2V0Q2VudGVyTG9uTGF0KCk7ZS5pY29uPVxubnVsbD09dGhpcy5pY29uP09wZW5MYXllcnMuTWFya2VyLmRlZmF1bHRJY29uKCk6dGhpcy5pY29uLmNsb25lKCk7ZS5wb3B1cFNpemU9dGhpcy5wb3B1cFNpemU/dGhpcy5wb3B1cFNpemUuY2xvbmUoKTpuZXcgT3BlbkxheWVycy5TaXplKDI1MCwxMjApO2lmKGd8fGgpe2UudGl0bGU9ZztlLmRlc2NyaXB0aW9uPWg7dmFyIGo9JzxkaXYgY2xhc3M9XCJvbExheWVyR2VvUlNTQ2xvc2VcIj5beF08L2Rpdj4nLGo9aisnPGRpdiBjbGFzcz1cIm9sTGF5ZXJHZW9SU1NUaXRsZVwiPic7aSYmKGorPSc8YSBjbGFzcz1cImxpbmtcIiBocmVmPVwiJytpKydcIiB0YXJnZXQ9XCJfYmxhbmtcIj4nKTtqKz1nO2kmJihqKz1cIjwvYT5cIik7ais9XCI8L2Rpdj5cIjtqKz0nPGRpdiBzdHlsZT1cIlwiIGNsYXNzPVwib2xMYXllckdlb1JTU0Rlc2NyaXB0aW9uXCI+JztqKz1oO2orPVwiPC9kaXY+XCI7ZS5wb3B1cENvbnRlbnRIVE1MPWp9Zj1uZXcgT3BlbkxheWVycy5GZWF0dXJlKHRoaXMsZixlKTt0aGlzLmZlYXR1cmVzLnB1c2goZik7XG5lPWYuY3JlYXRlTWFya2VyKCk7ZS5ldmVudHMucmVnaXN0ZXIoXCJjbGlja1wiLGYsdGhpcy5tYXJrZXJDbGljayk7dGhpcy5hZGRNYXJrZXIoZSl9fXRoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcImxvYWRlbmRcIil9LG1hcmtlckNsaWNrOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM9PXRoaXMubGF5ZXIuc2VsZWN0ZWRGZWF0dXJlO3RoaXMubGF5ZXIuc2VsZWN0ZWRGZWF0dXJlPSFiP3RoaXM6bnVsbDtmb3IodmFyIGM9MCxkPXRoaXMubGF5ZXIubWFwLnBvcHVwcy5sZW5ndGg7YzxkO2MrKyl0aGlzLmxheWVyLm1hcC5yZW1vdmVQb3B1cCh0aGlzLmxheWVyLm1hcC5wb3B1cHNbY10pO2J8fChiPXRoaXMuY3JlYXRlUG9wdXAoKSxPcGVuTGF5ZXJzLkV2ZW50Lm9ic2VydmUoYi5kaXYsXCJjbGlja1wiLE9wZW5MYXllcnMuRnVuY3Rpb24uYmluZChmdW5jdGlvbigpe2Zvcih2YXIgYT0wLGI9dGhpcy5sYXllci5tYXAucG9wdXBzLmxlbmd0aDthPGI7YSsrKXRoaXMubGF5ZXIubWFwLnJlbW92ZVBvcHVwKHRoaXMubGF5ZXIubWFwLnBvcHVwc1thXSl9LFxudGhpcykpLHRoaXMubGF5ZXIubWFwLmFkZFBvcHVwKGIpKTtPcGVuTGF5ZXJzLkV2ZW50LnN0b3AoYSl9LGNsZWFyRmVhdHVyZXM6ZnVuY3Rpb24oKXtpZihudWxsIT10aGlzLmZlYXR1cmVzKWZvcig7MDx0aGlzLmZlYXR1cmVzLmxlbmd0aDspe3ZhciBhPXRoaXMuZmVhdHVyZXNbMF07T3BlbkxheWVycy5VdGlsLnJlbW92ZUl0ZW0odGhpcy5mZWF0dXJlcyxhKTthLmRlc3Ryb3koKX19LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkxheWVyLkdlb1JTU1wifSk7T3BlbkxheWVycy5TeW1ib2xpemVyLlBvaW50PU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5TeW1ib2xpemVyLHtpbml0aWFsaXplOmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuU3ltYm9saXplci5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLlN5bWJvbGl6ZXIuUG9pbnRcIn0pO09wZW5MYXllcnMuU3ltYm9saXplci5MaW5lPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5TeW1ib2xpemVyLHtpbml0aWFsaXplOmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuU3ltYm9saXplci5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLlN5bWJvbGl6ZXIuTGluZVwifSk7T3BlbkxheWVycy5TeW1ib2xpemVyLlRleHQ9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLlN5bWJvbGl6ZXIse2luaXRpYWxpemU6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5TeW1ib2xpemVyLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuU3ltYm9saXplci5UZXh0XCJ9KTtPcGVuTGF5ZXJzLkZvcm1hdC5TTEQudjE9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkZvcm1hdC5GaWx0ZXIudjFfMF8wLHtuYW1lc3BhY2VzOntzbGQ6XCJodHRwOi8vd3d3Lm9wZW5naXMubmV0L3NsZFwiLG9nYzpcImh0dHA6Ly93d3cub3Blbmdpcy5uZXQvb2djXCIsZ21sOlwiaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC9nbWxcIix4bGluazpcImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmtcIix4c2k6XCJodHRwOi8vd3d3LnczLm9yZy8yMDAxL1hNTFNjaGVtYS1pbnN0YW5jZVwifSxkZWZhdWx0UHJlZml4Olwic2xkXCIsc2NoZW1hTG9jYXRpb246bnVsbCxtdWx0aXBsZVN5bWJvbGl6ZXJzOiExLGZlYXR1cmVUeXBlQ291bnRlcjpudWxsLGRlZmF1bHRTeW1ib2xpemVyOntmaWxsQ29sb3I6XCIjODA4MDgwXCIsZmlsbE9wYWNpdHk6MSxzdHJva2VDb2xvcjpcIiMwMDAwMDBcIixzdHJva2VPcGFjaXR5OjEsc3Ryb2tlV2lkdGg6MSxzdHJva2VEYXNoc3R5bGU6XCJzb2xpZFwiLHBvaW50UmFkaXVzOjMsXG5ncmFwaGljTmFtZTpcInNxdWFyZVwifSxyZWFkOmZ1bmN0aW9uKGEsYil7dmFyIGI9T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoYix0aGlzLm9wdGlvbnMpLGM9e25hbWVkTGF5ZXJzOiEwPT09Yi5uYW1lZExheWVyc0FzQXJyYXk/W106e319O3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKTtyZXR1cm4gY30scmVhZGVyczpPcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyh7c2xkOntTdHlsZWRMYXllckRlc2NyaXB0b3I6ZnVuY3Rpb24oYSxiKXtiLnZlcnNpb249YS5nZXRBdHRyaWJ1dGUoXCJ2ZXJzaW9uXCIpO3RoaXMucmVhZENoaWxkTm9kZXMoYSxiKX0sTmFtZTpmdW5jdGlvbihhLGIpe2IubmFtZT10aGlzLmdldENoaWxkVmFsdWUoYSl9LFRpdGxlOmZ1bmN0aW9uKGEsYil7Yi50aXRsZT10aGlzLmdldENoaWxkVmFsdWUoYSl9LEFic3RyYWN0OmZ1bmN0aW9uKGEsYil7Yi5kZXNjcmlwdGlvbj10aGlzLmdldENoaWxkVmFsdWUoYSl9LE5hbWVkTGF5ZXI6ZnVuY3Rpb24oYSxiKXt2YXIgYz1cbnt1c2VyU3R5bGVzOltdLG5hbWVkU3R5bGVzOltdfTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYyk7Zm9yKHZhciBkPTAsZT1jLnVzZXJTdHlsZXMubGVuZ3RoO2Q8ZTsrK2QpYy51c2VyU3R5bGVzW2RdLmxheWVyTmFtZT1jLm5hbWU7T3BlbkxheWVycy5VdGlsLmlzQXJyYXkoYi5uYW1lZExheWVycyk/Yi5uYW1lZExheWVycy5wdXNoKGMpOmIubmFtZWRMYXllcnNbYy5uYW1lXT1jfSxOYW1lZFN0eWxlOmZ1bmN0aW9uKGEsYil7Yi5uYW1lZFN0eWxlcy5wdXNoKHRoaXMuZ2V0Q2hpbGROYW1lKGEuZmlyc3RDaGlsZCkpfSxVc2VyU3R5bGU6ZnVuY3Rpb24oYSxiKXt2YXIgYz17ZGVmYXVsdHNQZXJTeW1ib2xpemVyOiEwLHJ1bGVzOltdfTt0aGlzLmZlYXR1cmVUeXBlQ291bnRlcj0tMTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYyk7dGhpcy5tdWx0aXBsZVN5bWJvbGl6ZXJzPyhkZWxldGUgYy5kZWZhdWx0c1BlclN5bWJvbGl6ZXIsYz1uZXcgT3BlbkxheWVycy5TdHlsZTIoYykpOmM9bmV3IE9wZW5MYXllcnMuU3R5bGUodGhpcy5kZWZhdWx0U3ltYm9saXplcixcbmMpO2IudXNlclN0eWxlcy5wdXNoKGMpfSxJc0RlZmF1bHQ6ZnVuY3Rpb24oYSxiKXtcIjFcIj09dGhpcy5nZXRDaGlsZFZhbHVlKGEpJiYoYi5pc0RlZmF1bHQ9ITApfSxGZWF0dXJlVHlwZVN0eWxlOmZ1bmN0aW9uKGEsYil7Kyt0aGlzLmZlYXR1cmVUeXBlQ291bnRlcjt2YXIgYz17cnVsZXM6dGhpcy5tdWx0aXBsZVN5bWJvbGl6ZXJzP2IucnVsZXM6W119O3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKTt0aGlzLm11bHRpcGxlU3ltYm9saXplcnN8fChiLnJ1bGVzPWMucnVsZXMpfSxSdWxlOmZ1bmN0aW9uKGEsYil7dmFyIGM7dGhpcy5tdWx0aXBsZVN5bWJvbGl6ZXJzJiYoYz17c3ltYm9saXplcnM6W119KTtjPW5ldyBPcGVuTGF5ZXJzLlJ1bGUoYyk7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpO2IucnVsZXMucHVzaChjKX0sRWxzZUZpbHRlcjpmdW5jdGlvbihhLGIpe2IuZWxzZUZpbHRlcj0hMH0sTWluU2NhbGVEZW5vbWluYXRvcjpmdW5jdGlvbihhLGIpe2IubWluU2NhbGVEZW5vbWluYXRvcj1cbnBhcnNlRmxvYXQodGhpcy5nZXRDaGlsZFZhbHVlKGEpKX0sTWF4U2NhbGVEZW5vbWluYXRvcjpmdW5jdGlvbihhLGIpe2IubWF4U2NhbGVEZW5vbWluYXRvcj1wYXJzZUZsb2F0KHRoaXMuZ2V0Q2hpbGRWYWx1ZShhKSl9LFRleHRTeW1ib2xpemVyOmZ1bmN0aW9uKGEsYil7dmFyIGM9e307dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpO3RoaXMubXVsdGlwbGVTeW1ib2xpemVycz8oYy56SW5kZXg9dGhpcy5mZWF0dXJlVHlwZUNvdW50ZXIsYi5zeW1ib2xpemVycy5wdXNoKG5ldyBPcGVuTGF5ZXJzLlN5bWJvbGl6ZXIuVGV4dChjKSkpOmIuc3ltYm9saXplci5UZXh0PU9wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKGMsYi5zeW1ib2xpemVyLlRleHQpfSxMYWJlbFBsYWNlbWVudDpmdW5jdGlvbihhLGIpe3RoaXMucmVhZENoaWxkTm9kZXMoYSxiKX0sUG9pbnRQbGFjZW1lbnQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz17fTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYyk7Yy5sYWJlbFJvdGF0aW9uPVxuYy5yb3RhdGlvbjtkZWxldGUgYy5yb3RhdGlvbjt2YXIgZCxlPWIubGFiZWxBbmNob3JQb2ludFgsZj1iLmxhYmVsQW5jaG9yUG9pbnRZO2U8PTEvMz9kPVwibFwiOmU+MS8zJiZlPDIvMz9kPVwiY1wiOmU+PTIvMyYmKGQ9XCJyXCIpO2Y8PTEvMz9kKz1cImJcIjpmPjEvMyYmZjwyLzM/ZCs9XCJtXCI6Zj49Mi8zJiYoZCs9XCJ0XCIpO2MubGFiZWxBbGlnbj1kO09wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKGIsYyl9LEFuY2hvclBvaW50OmZ1bmN0aW9uKGEsYil7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIpfSxBbmNob3JQb2ludFg6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLnJlYWRlcnMub2djLl9leHByZXNzaW9uLmNhbGwodGhpcyxhKTtjJiYoYi5sYWJlbEFuY2hvclBvaW50WD1jKX0sQW5jaG9yUG9pbnRZOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5yZWFkZXJzLm9nYy5fZXhwcmVzc2lvbi5jYWxsKHRoaXMsYSk7YyYmKGIubGFiZWxBbmNob3JQb2ludFk9Yyl9LERpc3BsYWNlbWVudDpmdW5jdGlvbihhLFxuYil7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIpfSxEaXNwbGFjZW1lbnRYOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5yZWFkZXJzLm9nYy5fZXhwcmVzc2lvbi5jYWxsKHRoaXMsYSk7YyYmKGIubGFiZWxYT2Zmc2V0PWMpfSxEaXNwbGFjZW1lbnRZOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5yZWFkZXJzLm9nYy5fZXhwcmVzc2lvbi5jYWxsKHRoaXMsYSk7YyYmKGIubGFiZWxZT2Zmc2V0PWMpfSxMaW5lUGxhY2VtZW50OmZ1bmN0aW9uKGEsYil7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIpfSxQZXJwZW5kaWN1bGFyT2Zmc2V0OmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5yZWFkZXJzLm9nYy5fZXhwcmVzc2lvbi5jYWxsKHRoaXMsYSk7YyYmKGIubGFiZWxQZXJwZW5kaWN1bGFyT2Zmc2V0PWMpfSxMYWJlbDpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMucmVhZGVycy5vZ2MuX2V4cHJlc3Npb24uY2FsbCh0aGlzLGEpO2MmJihiLmxhYmVsPWMpfSxGb250OmZ1bmN0aW9uKGEsYil7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLFxuYil9LEhhbG86ZnVuY3Rpb24oYSxiKXt2YXIgYz17fTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYyk7Yi5oYWxvUmFkaXVzPWMuaGFsb1JhZGl1cztiLmhhbG9Db2xvcj1jLmZpbGxDb2xvcjtiLmhhbG9PcGFjaXR5PWMuZmlsbE9wYWNpdHl9LFJhZGl1czpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMucmVhZGVycy5vZ2MuX2V4cHJlc3Npb24uY2FsbCh0aGlzLGEpO251bGwhPWMmJihiLmhhbG9SYWRpdXM9Yyl9LFJhc3RlclN5bWJvbGl6ZXI6ZnVuY3Rpb24oYSxiKXt2YXIgYz17fTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYyk7dGhpcy5tdWx0aXBsZVN5bWJvbGl6ZXJzPyhjLnpJbmRleD10aGlzLmZlYXR1cmVUeXBlQ291bnRlcixiLnN5bWJvbGl6ZXJzLnB1c2gobmV3IE9wZW5MYXllcnMuU3ltYm9saXplci5SYXN0ZXIoYykpKTpiLnN5bWJvbGl6ZXIuUmFzdGVyPU9wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKGMsYi5zeW1ib2xpemVyLlJhc3Rlcil9LEdlb21ldHJ5OmZ1bmN0aW9uKGEsXG5iKXtiLmdlb21ldHJ5PXt9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxiLmdlb21ldHJ5KX0sQ29sb3JNYXA6ZnVuY3Rpb24oYSxiKXtiLmNvbG9yTWFwPVtdO3RoaXMucmVhZENoaWxkTm9kZXMoYSxiLmNvbG9yTWFwKX0sQ29sb3JNYXBFbnRyeTpmdW5jdGlvbihhLGIpe3ZhciBjPWEuZ2V0QXR0cmlidXRlKFwicXVhbnRpdHlcIiksZD1hLmdldEF0dHJpYnV0ZShcIm9wYWNpdHlcIik7Yi5wdXNoKHtjb2xvcjphLmdldEF0dHJpYnV0ZShcImNvbG9yXCIpLHF1YW50aXR5Om51bGwhPT1jP3BhcnNlRmxvYXQoYyk6dm9pZCAwLGxhYmVsOmEuZ2V0QXR0cmlidXRlKFwibGFiZWxcIil8fHZvaWQgMCxvcGFjaXR5Om51bGwhPT1kP3BhcnNlRmxvYXQoZCk6dm9pZCAwfSl9LExpbmVTeW1ib2xpemVyOmZ1bmN0aW9uKGEsYil7dmFyIGM9e307dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpO3RoaXMubXVsdGlwbGVTeW1ib2xpemVycz8oYy56SW5kZXg9dGhpcy5mZWF0dXJlVHlwZUNvdW50ZXIsYi5zeW1ib2xpemVycy5wdXNoKG5ldyBPcGVuTGF5ZXJzLlN5bWJvbGl6ZXIuTGluZShjKSkpOlxuYi5zeW1ib2xpemVyLkxpbmU9T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoYyxiLnN5bWJvbGl6ZXIuTGluZSl9LFBvbHlnb25TeW1ib2xpemVyOmZ1bmN0aW9uKGEsYil7dmFyIGM9e2ZpbGw6ITEsc3Ryb2tlOiExfTt0aGlzLm11bHRpcGxlU3ltYm9saXplcnN8fChjPWIuc3ltYm9saXplci5Qb2x5Z29ufHxjKTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYyk7dGhpcy5tdWx0aXBsZVN5bWJvbGl6ZXJzPyhjLnpJbmRleD10aGlzLmZlYXR1cmVUeXBlQ291bnRlcixiLnN5bWJvbGl6ZXJzLnB1c2gobmV3IE9wZW5MYXllcnMuU3ltYm9saXplci5Qb2x5Z29uKGMpKSk6Yi5zeW1ib2xpemVyLlBvbHlnb249Y30sUG9pbnRTeW1ib2xpemVyOmZ1bmN0aW9uKGEsYil7dmFyIGM9e2ZpbGw6ITEsc3Ryb2tlOiExLGdyYXBoaWM6ITF9O3RoaXMubXVsdGlwbGVTeW1ib2xpemVyc3x8KGM9Yi5zeW1ib2xpemVyLlBvaW50fHxjKTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYyk7dGhpcy5tdWx0aXBsZVN5bWJvbGl6ZXJzP1xuKGMuekluZGV4PXRoaXMuZmVhdHVyZVR5cGVDb3VudGVyLGIuc3ltYm9saXplcnMucHVzaChuZXcgT3BlbkxheWVycy5TeW1ib2xpemVyLlBvaW50KGMpKSk6Yi5zeW1ib2xpemVyLlBvaW50PWN9LFN0cm9rZTpmdW5jdGlvbihhLGIpe2Iuc3Ryb2tlPSEwO3RoaXMucmVhZENoaWxkTm9kZXMoYSxiKX0sRmlsbDpmdW5jdGlvbihhLGIpe2IuZmlsbD0hMDt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYil9LENzc1BhcmFtZXRlcjpmdW5jdGlvbihhLGIpe3ZhciBjPWEuZ2V0QXR0cmlidXRlKFwibmFtZVwiKSxkPXRoaXMuY3NzTWFwW2NdO2IubGFiZWwmJihcImZpbGxcIj09PWM/ZD1cImZvbnRDb2xvclwiOlwiZmlsbC1vcGFjaXR5XCI9PT1jJiYoZD1cImZvbnRPcGFjaXR5XCIpKTtkJiYoYz10aGlzLnJlYWRlcnMub2djLl9leHByZXNzaW9uLmNhbGwodGhpcyxhKSkmJihiW2RdPWMpfSxHcmFwaGljOmZ1bmN0aW9uKGEsYil7Yi5ncmFwaGljPSEwO3ZhciBjPXt9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKTtcbmZvcih2YXIgZD1cInN0cm9rZSBzdHJva2VDb2xvciBzdHJva2VXaWR0aCBzdHJva2VPcGFjaXR5IHN0cm9rZUxpbmVjYXAgZmlsbCBmaWxsQ29sb3IgZmlsbE9wYWNpdHkgZ3JhcGhpY05hbWUgcm90YXRpb24gZ3JhcGhpY0Zvcm1hdFwiLnNwbGl0KFwiIFwiKSxlLGYsZz0wLGg9ZC5sZW5ndGg7ZzxoOysrZyllPWRbZ10sZj1jW2VdLHZvaWQgMCE9ZiYmKGJbZV09Zik7dm9pZCAwIT1jLm9wYWNpdHkmJihiLmdyYXBoaWNPcGFjaXR5PWMub3BhY2l0eSk7dm9pZCAwIT1jLnNpemUmJihpc05hTihjLnNpemUvMik/Yi5ncmFwaGljV2lkdGg9Yy5zaXplOmIucG9pbnRSYWRpdXM9Yy5zaXplLzIpO3ZvaWQgMCE9Yy5ocmVmJiYoYi5leHRlcm5hbEdyYXBoaWM9Yy5ocmVmKTt2b2lkIDAhPWMucm90YXRpb24mJihiLnJvdGF0aW9uPWMucm90YXRpb24pfSxFeHRlcm5hbEdyYXBoaWM6ZnVuY3Rpb24oYSxiKXt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYil9LE1hcms6ZnVuY3Rpb24oYSxiKXt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsXG5iKX0sV2VsbEtub3duTmFtZTpmdW5jdGlvbihhLGIpe2IuZ3JhcGhpY05hbWU9dGhpcy5nZXRDaGlsZFZhbHVlKGEpfSxPcGFjaXR5OmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5yZWFkZXJzLm9nYy5fZXhwcmVzc2lvbi5jYWxsKHRoaXMsYSk7YyYmKGIub3BhY2l0eT1jKX0sU2l6ZTpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMucmVhZGVycy5vZ2MuX2V4cHJlc3Npb24uY2FsbCh0aGlzLGEpO2MmJihiLnNpemU9Yyl9LFJvdGF0aW9uOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5yZWFkZXJzLm9nYy5fZXhwcmVzc2lvbi5jYWxsKHRoaXMsYSk7YyYmKGIucm90YXRpb249Yyl9LE9ubGluZVJlc291cmNlOmZ1bmN0aW9uKGEsYil7Yi5ocmVmPXRoaXMuZ2V0QXR0cmlidXRlTlMoYSx0aGlzLm5hbWVzcGFjZXMueGxpbmssXCJocmVmXCIpfSxGb3JtYXQ6ZnVuY3Rpb24oYSxiKXtiLmdyYXBoaWNGb3JtYXQ9dGhpcy5nZXRDaGlsZFZhbHVlKGEpfX19LE9wZW5MYXllcnMuRm9ybWF0LkZpbHRlci52MV8wXzAucHJvdG90eXBlLnJlYWRlcnMpLFxuY3NzTWFwOntzdHJva2U6XCJzdHJva2VDb2xvclwiLFwic3Ryb2tlLW9wYWNpdHlcIjpcInN0cm9rZU9wYWNpdHlcIixcInN0cm9rZS13aWR0aFwiOlwic3Ryb2tlV2lkdGhcIixcInN0cm9rZS1saW5lY2FwXCI6XCJzdHJva2VMaW5lY2FwXCIsXCJzdHJva2UtZGFzaGFycmF5XCI6XCJzdHJva2VEYXNoc3R5bGVcIixmaWxsOlwiZmlsbENvbG9yXCIsXCJmaWxsLW9wYWNpdHlcIjpcImZpbGxPcGFjaXR5XCIsXCJmb250LWZhbWlseVwiOlwiZm9udEZhbWlseVwiLFwiZm9udC1zaXplXCI6XCJmb250U2l6ZVwiLFwiZm9udC13ZWlnaHRcIjpcImZvbnRXZWlnaHRcIixcImZvbnQtc3R5bGVcIjpcImZvbnRTdHlsZVwifSxnZXRDc3NQcm9wZXJ0eTpmdW5jdGlvbihhKXt2YXIgYj1udWxsLGM7Zm9yKGMgaW4gdGhpcy5jc3NNYXApaWYodGhpcy5jc3NNYXBbY109PWEpe2I9YzticmVha31yZXR1cm4gYn0sZ2V0R3JhcGhpY0Zvcm1hdDpmdW5jdGlvbihhKXt2YXIgYixjO2ZvcihjIGluIHRoaXMuZ3JhcGhpY0Zvcm1hdHMpaWYodGhpcy5ncmFwaGljRm9ybWF0c1tjXS50ZXN0KGEpKXtiPVxuYzticmVha31yZXR1cm4gYnx8dGhpcy5kZWZhdWx0R3JhcGhpY0Zvcm1hdH0sZGVmYXVsdEdyYXBoaWNGb3JtYXQ6XCJpbWFnZS9wbmdcIixncmFwaGljRm9ybWF0czp7XCJpbWFnZS9qcGVnXCI6L1xcLmpwZT9nJC9pLFwiaW1hZ2UvZ2lmXCI6L1xcLmdpZiQvaSxcImltYWdlL3BuZ1wiOi9cXC5wbmckL2l9LHdyaXRlOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLndyaXRlcnMuc2xkLlN0eWxlZExheWVyRGVzY3JpcHRvci5hcHBseSh0aGlzLFthXSl9LHdyaXRlcnM6T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoe3NsZDp7X09HQ0V4cHJlc3Npb246ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoYSksZD1cInN0cmluZ1wiPT10eXBlb2YgYj9iLnNwbGl0KFwiJHtcIik6W2JdO2MuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVUZXh0Tm9kZShkWzBdKSk7Zm9yKHZhciBlLGYsZz0xLGg9ZC5sZW5ndGg7ZzxoO2crKyllPWRbZ10sZj1lLmluZGV4T2YoXCJ9XCIpLDA8Zj8odGhpcy53cml0ZU5vZGUoXCJvZ2M6UHJvcGVydHlOYW1lXCIsXG57cHJvcGVydHk6ZS5zdWJzdHJpbmcoMCxmKX0sYyksYy5hcHBlbmRDaGlsZCh0aGlzLmNyZWF0ZVRleHROb2RlKGUuc3Vic3RyaW5nKCsrZikpKSk6Yy5hcHBlbmRDaGlsZCh0aGlzLmNyZWF0ZVRleHROb2RlKFwiJHtcIitlKSk7cmV0dXJuIGN9LFN0eWxlZExheWVyRGVzY3JpcHRvcjpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJzbGQ6U3R5bGVkTGF5ZXJEZXNjcmlwdG9yXCIse2F0dHJpYnV0ZXM6e3ZlcnNpb246dGhpcy5WRVJTSU9OLFwieHNpOnNjaGVtYUxvY2F0aW9uXCI6dGhpcy5zY2hlbWFMb2NhdGlvbn19KTtiLnNldEF0dHJpYnV0ZShcInhtbG5zOm9nY1wiLHRoaXMubmFtZXNwYWNlcy5vZ2MpO2Iuc2V0QXR0cmlidXRlKFwieG1sbnM6Z21sXCIsdGhpcy5uYW1lc3BhY2VzLmdtbCk7YS5uYW1lJiZ0aGlzLndyaXRlTm9kZShcIk5hbWVcIixhLm5hbWUsYik7YS50aXRsZSYmdGhpcy53cml0ZU5vZGUoXCJUaXRsZVwiLGEudGl0bGUsYik7YS5kZXNjcmlwdGlvbiYmXG50aGlzLndyaXRlTm9kZShcIkFic3RyYWN0XCIsYS5kZXNjcmlwdGlvbixiKTtpZihPcGVuTGF5ZXJzLlV0aWwuaXNBcnJheShhLm5hbWVkTGF5ZXJzKSlmb3IodmFyIGM9MCxkPWEubmFtZWRMYXllcnMubGVuZ3RoO2M8ZDsrK2MpdGhpcy53cml0ZU5vZGUoXCJOYW1lZExheWVyXCIsYS5uYW1lZExheWVyc1tjXSxiKTtlbHNlIGZvcihjIGluIGEubmFtZWRMYXllcnMpdGhpcy53cml0ZU5vZGUoXCJOYW1lZExheWVyXCIsYS5uYW1lZExheWVyc1tjXSxiKTtyZXR1cm4gYn0sTmFtZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwic2xkOk5hbWVcIix7dmFsdWU6YX0pfSxUaXRsZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwic2xkOlRpdGxlXCIse3ZhbHVlOmF9KX0sQWJzdHJhY3Q6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcInNsZDpBYnN0cmFjdFwiLHt2YWx1ZTphfSl9LE5hbWVkTGF5ZXI6ZnVuY3Rpb24oYSl7dmFyIGI9XG50aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJzbGQ6TmFtZWRMYXllclwiKTt0aGlzLndyaXRlTm9kZShcIk5hbWVcIixhLm5hbWUsYik7aWYoYS5uYW1lZFN0eWxlcylmb3IodmFyIGM9MCxkPWEubmFtZWRTdHlsZXMubGVuZ3RoO2M8ZDsrK2MpdGhpcy53cml0ZU5vZGUoXCJOYW1lZFN0eWxlXCIsYS5uYW1lZFN0eWxlc1tjXSxiKTtpZihhLnVzZXJTdHlsZXMpe2M9MDtmb3IoZD1hLnVzZXJTdHlsZXMubGVuZ3RoO2M8ZDsrK2MpdGhpcy53cml0ZU5vZGUoXCJVc2VyU3R5bGVcIixhLnVzZXJTdHlsZXNbY10sYil9cmV0dXJuIGJ9LE5hbWVkU3R5bGU6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwic2xkOk5hbWVkU3R5bGVcIik7dGhpcy53cml0ZU5vZGUoXCJOYW1lXCIsYSxiKTtyZXR1cm4gYn0sVXNlclN0eWxlOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcInNsZDpVc2VyU3R5bGVcIik7YS5uYW1lJiZ0aGlzLndyaXRlTm9kZShcIk5hbWVcIixcbmEubmFtZSxiKTthLnRpdGxlJiZ0aGlzLndyaXRlTm9kZShcIlRpdGxlXCIsYS50aXRsZSxiKTthLmRlc2NyaXB0aW9uJiZ0aGlzLndyaXRlTm9kZShcIkFic3RyYWN0XCIsYS5kZXNjcmlwdGlvbixiKTthLmlzRGVmYXVsdCYmdGhpcy53cml0ZU5vZGUoXCJJc0RlZmF1bHRcIixhLmlzRGVmYXVsdCxiKTtpZih0aGlzLm11bHRpcGxlU3ltYm9saXplcnMmJmEucnVsZXMpe2Zvcih2YXIgYz17XCIwXCI6W119LGQ9WzBdLGUsZixnLGgsaSxqPTAsaz1hLnJ1bGVzLmxlbmd0aDtqPGs7KytqKWlmKGU9YS5ydWxlc1tqXSxlLnN5bWJvbGl6ZXJzKXtmPXt9O2Zvcih2YXIgbD0wLG09ZS5zeW1ib2xpemVycy5sZW5ndGg7bDxtOysrbClnPWUuc3ltYm9saXplcnNbbF0saD1nLnpJbmRleCxoIGluIGZ8fChpPWUuY2xvbmUoKSxpLnN5bWJvbGl6ZXJzPVtdLGZbaF09aSksZltoXS5zeW1ib2xpemVycy5wdXNoKGcuY2xvbmUoKSk7Zm9yKGggaW4gZiloIGluIGN8fChkLnB1c2goaCksY1toXT1bXSksY1toXS5wdXNoKGZbaF0pfWVsc2UgY1swXS5wdXNoKGUuY2xvbmUoKSk7XG5kLnNvcnQoKTtqPTA7Zm9yKGs9ZC5sZW5ndGg7ajxrOysraillPWNbZFtqXV0sMDxlLmxlbmd0aCYmKGk9YS5jbG9uZSgpLGkucnVsZXM9Y1tkW2pdXSx0aGlzLndyaXRlTm9kZShcIkZlYXR1cmVUeXBlU3R5bGVcIixpLGIpKX1lbHNlIHRoaXMud3JpdGVOb2RlKFwiRmVhdHVyZVR5cGVTdHlsZVwiLGEsYik7cmV0dXJuIGJ9LElzRGVmYXVsdDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwic2xkOklzRGVmYXVsdFwiLHt2YWx1ZTphP1wiMVwiOlwiMFwifSl9LEZlYXR1cmVUeXBlU3R5bGU6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcInNsZDpGZWF0dXJlVHlwZVN0eWxlXCIpLGM9MCxkPWEucnVsZXMubGVuZ3RoO2M8ZDsrK2MpdGhpcy53cml0ZU5vZGUoXCJSdWxlXCIsYS5ydWxlc1tjXSxiKTtyZXR1cm4gYn0sUnVsZTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJzbGQ6UnVsZVwiKTthLm5hbWUmJlxudGhpcy53cml0ZU5vZGUoXCJOYW1lXCIsYS5uYW1lLGIpO2EudGl0bGUmJnRoaXMud3JpdGVOb2RlKFwiVGl0bGVcIixhLnRpdGxlLGIpO2EuZGVzY3JpcHRpb24mJnRoaXMud3JpdGVOb2RlKFwiQWJzdHJhY3RcIixhLmRlc2NyaXB0aW9uLGIpO2EuZWxzZUZpbHRlcj90aGlzLndyaXRlTm9kZShcIkVsc2VGaWx0ZXJcIixudWxsLGIpOmEuZmlsdGVyJiZ0aGlzLndyaXRlTm9kZShcIm9nYzpGaWx0ZXJcIixhLmZpbHRlcixiKTt2b2lkIDAhPWEubWluU2NhbGVEZW5vbWluYXRvciYmdGhpcy53cml0ZU5vZGUoXCJNaW5TY2FsZURlbm9taW5hdG9yXCIsYS5taW5TY2FsZURlbm9taW5hdG9yLGIpO3ZvaWQgMCE9YS5tYXhTY2FsZURlbm9taW5hdG9yJiZ0aGlzLndyaXRlTm9kZShcIk1heFNjYWxlRGVub21pbmF0b3JcIixhLm1heFNjYWxlRGVub21pbmF0b3IsYik7dmFyIGMsZDtpZih0aGlzLm11bHRpcGxlU3ltYm9saXplcnMmJmEuc3ltYm9saXplcnMpZm9yKHZhciBlPTAsZj1hLnN5bWJvbGl6ZXJzLmxlbmd0aDtlPFxuZjsrK2UpZD1hLnN5bWJvbGl6ZXJzW2VdLGM9ZC5DTEFTU19OQU1FLnNwbGl0KFwiLlwiKS5wb3AoKSx0aGlzLndyaXRlTm9kZShjK1wiU3ltYm9saXplclwiLGQsYik7ZWxzZSBmb3IodmFyIGY9T3BlbkxheWVycy5TdHlsZS5TWU1CT0xJWkVSX1BSRUZJWEVTLGU9MCxnPWYubGVuZ3RoO2U8ZzsrK2UpYz1mW2VdLChkPWEuc3ltYm9saXplcltjXSkmJnRoaXMud3JpdGVOb2RlKGMrXCJTeW1ib2xpemVyXCIsZCxiKTtyZXR1cm4gYn0sRWxzZUZpbHRlcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJzbGQ6RWxzZUZpbHRlclwiKX0sTWluU2NhbGVEZW5vbWluYXRvcjpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwic2xkOk1pblNjYWxlRGVub21pbmF0b3JcIix7dmFsdWU6YX0pfSxNYXhTY2FsZURlbm9taW5hdG9yOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJzbGQ6TWF4U2NhbGVEZW5vbWluYXRvclwiLFxue3ZhbHVlOmF9KX0sTGluZVN5bWJvbGl6ZXI6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwic2xkOkxpbmVTeW1ib2xpemVyXCIpO3RoaXMud3JpdGVOb2RlKFwiU3Ryb2tlXCIsYSxiKTtyZXR1cm4gYn0sU3Ryb2tlOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcInNsZDpTdHJva2VcIik7dm9pZCAwIT1hLnN0cm9rZUNvbG9yJiZ0aGlzLndyaXRlTm9kZShcIkNzc1BhcmFtZXRlclwiLHtzeW1ib2xpemVyOmEsa2V5Olwic3Ryb2tlQ29sb3JcIn0sYik7dm9pZCAwIT1hLnN0cm9rZU9wYWNpdHkmJnRoaXMud3JpdGVOb2RlKFwiQ3NzUGFyYW1ldGVyXCIse3N5bWJvbGl6ZXI6YSxrZXk6XCJzdHJva2VPcGFjaXR5XCJ9LGIpO3ZvaWQgMCE9YS5zdHJva2VXaWR0aCYmdGhpcy53cml0ZU5vZGUoXCJDc3NQYXJhbWV0ZXJcIix7c3ltYm9saXplcjphLGtleTpcInN0cm9rZVdpZHRoXCJ9LGIpO3ZvaWQgMCE9YS5zdHJva2VEYXNoc3R5bGUmJlwic29saWRcIiE9PVxuYS5zdHJva2VEYXNoc3R5bGUmJnRoaXMud3JpdGVOb2RlKFwiQ3NzUGFyYW1ldGVyXCIse3N5bWJvbGl6ZXI6YSxrZXk6XCJzdHJva2VEYXNoc3R5bGVcIn0sYik7dm9pZCAwIT1hLnN0cm9rZUxpbmVjYXAmJnRoaXMud3JpdGVOb2RlKFwiQ3NzUGFyYW1ldGVyXCIse3N5bWJvbGl6ZXI6YSxrZXk6XCJzdHJva2VMaW5lY2FwXCJ9LGIpO3JldHVybiBifSxDc3NQYXJhbWV0ZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcInNsZDpDc3NQYXJhbWV0ZXJcIix7YXR0cmlidXRlczp7bmFtZTp0aGlzLmdldENzc1Byb3BlcnR5KGEua2V5KX0sdmFsdWU6YS5zeW1ib2xpemVyW2Eua2V5XX0pfSxUZXh0U3ltYm9saXplcjpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJzbGQ6VGV4dFN5bWJvbGl6ZXJcIik7bnVsbCE9YS5sYWJlbCYmdGhpcy53cml0ZU5vZGUoXCJMYWJlbFwiLGEubGFiZWwsYik7KG51bGwhPWEuZm9udEZhbWlseXx8bnVsbCE9YS5mb250U2l6ZXx8XG5udWxsIT1hLmZvbnRXZWlnaHR8fG51bGwhPWEuZm9udFN0eWxlKSYmdGhpcy53cml0ZU5vZGUoXCJGb250XCIsYSxiKTsobnVsbCE9YS5sYWJlbEFuY2hvclBvaW50WHx8bnVsbCE9YS5sYWJlbEFuY2hvclBvaW50WXx8bnVsbCE9YS5sYWJlbEFsaWdufHxudWxsIT1hLmxhYmVsWE9mZnNldHx8bnVsbCE9YS5sYWJlbFlPZmZzZXR8fG51bGwhPWEubGFiZWxSb3RhdGlvbnx8bnVsbCE9YS5sYWJlbFBlcnBlbmRpY3VsYXJPZmZzZXQpJiZ0aGlzLndyaXRlTm9kZShcIkxhYmVsUGxhY2VtZW50XCIsYSxiKTsobnVsbCE9YS5oYWxvUmFkaXVzfHxudWxsIT1hLmhhbG9Db2xvcnx8bnVsbCE9YS5oYWxvT3BhY2l0eSkmJnRoaXMud3JpdGVOb2RlKFwiSGFsb1wiLGEsYik7KG51bGwhPWEuZm9udENvbG9yfHxudWxsIT1hLmZvbnRPcGFjaXR5KSYmdGhpcy53cml0ZU5vZGUoXCJGaWxsXCIse2ZpbGxDb2xvcjphLmZvbnRDb2xvcixmaWxsT3BhY2l0eTphLmZvbnRPcGFjaXR5fSxiKTtyZXR1cm4gYn0sTGFiZWxQbGFjZW1lbnQ6ZnVuY3Rpb24oYSl7dmFyIGI9XG50aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJzbGQ6TGFiZWxQbGFjZW1lbnRcIik7KG51bGwhPWEubGFiZWxBbmNob3JQb2ludFh8fG51bGwhPWEubGFiZWxBbmNob3JQb2ludFl8fG51bGwhPWEubGFiZWxBbGlnbnx8bnVsbCE9YS5sYWJlbFhPZmZzZXR8fG51bGwhPWEubGFiZWxZT2Zmc2V0fHxudWxsIT1hLmxhYmVsUm90YXRpb24pJiZudWxsPT1hLmxhYmVsUGVycGVuZGljdWxhck9mZnNldCYmdGhpcy53cml0ZU5vZGUoXCJQb2ludFBsYWNlbWVudFwiLGEsYik7bnVsbCE9YS5sYWJlbFBlcnBlbmRpY3VsYXJPZmZzZXQmJnRoaXMud3JpdGVOb2RlKFwiTGluZVBsYWNlbWVudFwiLGEsYik7cmV0dXJuIGJ9LExpbmVQbGFjZW1lbnQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwic2xkOkxpbmVQbGFjZW1lbnRcIik7dGhpcy53cml0ZU5vZGUoXCJQZXJwZW5kaWN1bGFyT2Zmc2V0XCIsYS5sYWJlbFBlcnBlbmRpY3VsYXJPZmZzZXQsYik7cmV0dXJuIGJ9LFBlcnBlbmRpY3VsYXJPZmZzZXQ6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcInNsZDpQZXJwZW5kaWN1bGFyT2Zmc2V0XCIsXG57dmFsdWU6YX0pfSxQb2ludFBsYWNlbWVudDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJzbGQ6UG9pbnRQbGFjZW1lbnRcIik7KG51bGwhPWEubGFiZWxBbmNob3JQb2ludFh8fG51bGwhPWEubGFiZWxBbmNob3JQb2ludFl8fG51bGwhPWEubGFiZWxBbGlnbikmJnRoaXMud3JpdGVOb2RlKFwiQW5jaG9yUG9pbnRcIixhLGIpOyhudWxsIT1hLmxhYmVsWE9mZnNldHx8bnVsbCE9YS5sYWJlbFlPZmZzZXQpJiZ0aGlzLndyaXRlTm9kZShcIkRpc3BsYWNlbWVudFwiLGEsYik7bnVsbCE9YS5sYWJlbFJvdGF0aW9uJiZ0aGlzLndyaXRlTm9kZShcIlJvdGF0aW9uXCIsYS5sYWJlbFJvdGF0aW9uLGIpO3JldHVybiBifSxBbmNob3JQb2ludDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJzbGQ6QW5jaG9yUG9pbnRcIiksYz1hLmxhYmVsQW5jaG9yUG9pbnRYLGQ9YS5sYWJlbEFuY2hvclBvaW50WTtudWxsIT1jJiZ0aGlzLndyaXRlTm9kZShcIkFuY2hvclBvaW50WFwiLFxuYyxiKTtudWxsIT1kJiZ0aGlzLndyaXRlTm9kZShcIkFuY2hvclBvaW50WVwiLGQsYik7aWYobnVsbD09YyYmbnVsbD09ZCl7dmFyIGU9YS5sYWJlbEFsaWduLnN1YnN0cigwLDEpLGE9YS5sYWJlbEFsaWduLnN1YnN0cigxLDEpO1wibFwiPT09ZT9jPTA6XCJjXCI9PT1lP2M9MC41OlwiclwiPT09ZSYmKGM9MSk7XCJiXCI9PT1hP2Q9MDpcIm1cIj09PWE/ZD0wLjU6XCJ0XCI9PT1hJiYoZD0xKTt0aGlzLndyaXRlTm9kZShcIkFuY2hvclBvaW50WFwiLGMsYik7dGhpcy53cml0ZU5vZGUoXCJBbmNob3JQb2ludFlcIixkLGIpfXJldHVybiBifSxBbmNob3JQb2ludFg6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcInNsZDpBbmNob3JQb2ludFhcIix7dmFsdWU6YX0pfSxBbmNob3JQb2ludFk6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcInNsZDpBbmNob3JQb2ludFlcIix7dmFsdWU6YX0pfSxEaXNwbGFjZW1lbnQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwic2xkOkRpc3BsYWNlbWVudFwiKTtcbm51bGwhPWEubGFiZWxYT2Zmc2V0JiZ0aGlzLndyaXRlTm9kZShcIkRpc3BsYWNlbWVudFhcIixhLmxhYmVsWE9mZnNldCxiKTtudWxsIT1hLmxhYmVsWU9mZnNldCYmdGhpcy53cml0ZU5vZGUoXCJEaXNwbGFjZW1lbnRZXCIsYS5sYWJlbFlPZmZzZXQsYik7cmV0dXJuIGJ9LERpc3BsYWNlbWVudFg6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcInNsZDpEaXNwbGFjZW1lbnRYXCIse3ZhbHVlOmF9KX0sRGlzcGxhY2VtZW50WTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwic2xkOkRpc3BsYWNlbWVudFlcIix7dmFsdWU6YX0pfSxGb250OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcInNsZDpGb250XCIpO2EuZm9udEZhbWlseSYmdGhpcy53cml0ZU5vZGUoXCJDc3NQYXJhbWV0ZXJcIix7c3ltYm9saXplcjphLGtleTpcImZvbnRGYW1pbHlcIn0sYik7YS5mb250U2l6ZSYmdGhpcy53cml0ZU5vZGUoXCJDc3NQYXJhbWV0ZXJcIixcbntzeW1ib2xpemVyOmEsa2V5OlwiZm9udFNpemVcIn0sYik7YS5mb250V2VpZ2h0JiZ0aGlzLndyaXRlTm9kZShcIkNzc1BhcmFtZXRlclwiLHtzeW1ib2xpemVyOmEsa2V5OlwiZm9udFdlaWdodFwifSxiKTthLmZvbnRTdHlsZSYmdGhpcy53cml0ZU5vZGUoXCJDc3NQYXJhbWV0ZXJcIix7c3ltYm9saXplcjphLGtleTpcImZvbnRTdHlsZVwifSxiKTtyZXR1cm4gYn0sTGFiZWw6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMud3JpdGVycy5zbGQuX09HQ0V4cHJlc3Npb24uY2FsbCh0aGlzLFwic2xkOkxhYmVsXCIsYSl9LEhhbG86ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwic2xkOkhhbG9cIik7YS5oYWxvUmFkaXVzJiZ0aGlzLndyaXRlTm9kZShcIlJhZGl1c1wiLGEuaGFsb1JhZGl1cyxiKTsoYS5oYWxvQ29sb3J8fGEuaGFsb09wYWNpdHkpJiZ0aGlzLndyaXRlTm9kZShcIkZpbGxcIix7ZmlsbENvbG9yOmEuaGFsb0NvbG9yLGZpbGxPcGFjaXR5OmEuaGFsb09wYWNpdHl9LGIpO1xucmV0dXJuIGJ9LFJhZGl1czpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwic2xkOlJhZGl1c1wiLHt2YWx1ZTphfSl9LFJhc3RlclN5bWJvbGl6ZXI6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwic2xkOlJhc3RlclN5bWJvbGl6ZXJcIik7YS5nZW9tZXRyeSYmdGhpcy53cml0ZU5vZGUoXCJHZW9tZXRyeVwiLGEuZ2VvbWV0cnksYik7YS5vcGFjaXR5JiZ0aGlzLndyaXRlTm9kZShcIk9wYWNpdHlcIixhLm9wYWNpdHksYik7YS5jb2xvck1hcCYmdGhpcy53cml0ZU5vZGUoXCJDb2xvck1hcFwiLGEuY29sb3JNYXAsYik7cmV0dXJuIGJ9LEdlb21ldHJ5OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcInNsZDpHZW9tZXRyeVwiKTthLnByb3BlcnR5JiZ0aGlzLndyaXRlTm9kZShcIm9nYzpQcm9wZXJ0eU5hbWVcIixhLGIpO3JldHVybiBifSxDb2xvck1hcDpmdW5jdGlvbihhKXtmb3IodmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwic2xkOkNvbG9yTWFwXCIpLFxuYz0wLGQ9YS5sZW5ndGg7YzxkOysrYyl0aGlzLndyaXRlTm9kZShcIkNvbG9yTWFwRW50cnlcIixhW2NdLGIpO3JldHVybiBifSxDb2xvck1hcEVudHJ5OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcInNsZDpDb2xvck1hcEVudHJ5XCIpO2Iuc2V0QXR0cmlidXRlKFwiY29sb3JcIixhLmNvbG9yKTt2b2lkIDAhPT1hLm9wYWNpdHkmJmIuc2V0QXR0cmlidXRlKFwib3BhY2l0eVwiLHBhcnNlRmxvYXQoYS5vcGFjaXR5KSk7dm9pZCAwIT09YS5xdWFudGl0eSYmYi5zZXRBdHRyaWJ1dGUoXCJxdWFudGl0eVwiLHBhcnNlRmxvYXQoYS5xdWFudGl0eSkpO3ZvaWQgMCE9PWEubGFiZWwmJmIuc2V0QXR0cmlidXRlKFwibGFiZWxcIixhLmxhYmVsKTtyZXR1cm4gYn0sUG9seWdvblN5bWJvbGl6ZXI6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwic2xkOlBvbHlnb25TeW1ib2xpemVyXCIpOyExIT09YS5maWxsJiZ0aGlzLndyaXRlTm9kZShcIkZpbGxcIixcbmEsYik7ITEhPT1hLnN0cm9rZSYmdGhpcy53cml0ZU5vZGUoXCJTdHJva2VcIixhLGIpO3JldHVybiBifSxGaWxsOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcInNsZDpGaWxsXCIpO2EuZmlsbENvbG9yJiZ0aGlzLndyaXRlTm9kZShcIkNzc1BhcmFtZXRlclwiLHtzeW1ib2xpemVyOmEsa2V5OlwiZmlsbENvbG9yXCJ9LGIpO251bGwhPWEuZmlsbE9wYWNpdHkmJnRoaXMud3JpdGVOb2RlKFwiQ3NzUGFyYW1ldGVyXCIse3N5bWJvbGl6ZXI6YSxrZXk6XCJmaWxsT3BhY2l0eVwifSxiKTtyZXR1cm4gYn0sUG9pbnRTeW1ib2xpemVyOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcInNsZDpQb2ludFN5bWJvbGl6ZXJcIik7dGhpcy53cml0ZU5vZGUoXCJHcmFwaGljXCIsYSxiKTtyZXR1cm4gYn0sR3JhcGhpYzpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJzbGQ6R3JhcGhpY1wiKTt2b2lkIDAhPWEuZXh0ZXJuYWxHcmFwaGljP1xudGhpcy53cml0ZU5vZGUoXCJFeHRlcm5hbEdyYXBoaWNcIixhLGIpOnRoaXMud3JpdGVOb2RlKFwiTWFya1wiLGEsYik7dm9pZCAwIT1hLmdyYXBoaWNPcGFjaXR5JiZ0aGlzLndyaXRlTm9kZShcIk9wYWNpdHlcIixhLmdyYXBoaWNPcGFjaXR5LGIpO3ZvaWQgMCE9YS5wb2ludFJhZGl1cz90aGlzLndyaXRlTm9kZShcIlNpemVcIiwyKmEucG9pbnRSYWRpdXMsYik6dm9pZCAwIT1hLmdyYXBoaWNXaWR0aCYmdGhpcy53cml0ZU5vZGUoXCJTaXplXCIsYS5ncmFwaGljV2lkdGgsYik7dm9pZCAwIT1hLnJvdGF0aW9uJiZ0aGlzLndyaXRlTm9kZShcIlJvdGF0aW9uXCIsYS5yb3RhdGlvbixiKTtyZXR1cm4gYn0sRXh0ZXJuYWxHcmFwaGljOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcInNsZDpFeHRlcm5hbEdyYXBoaWNcIik7dGhpcy53cml0ZU5vZGUoXCJPbmxpbmVSZXNvdXJjZVwiLGEuZXh0ZXJuYWxHcmFwaGljLGIpO3RoaXMud3JpdGVOb2RlKFwiRm9ybWF0XCIsYS5ncmFwaGljRm9ybWF0fHxcbnRoaXMuZ2V0R3JhcGhpY0Zvcm1hdChhLmV4dGVybmFsR3JhcGhpYyksYik7cmV0dXJuIGJ9LE1hcms6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwic2xkOk1hcmtcIik7YS5ncmFwaGljTmFtZSYmdGhpcy53cml0ZU5vZGUoXCJXZWxsS25vd25OYW1lXCIsYS5ncmFwaGljTmFtZSxiKTshMSE9PWEuZmlsbCYmdGhpcy53cml0ZU5vZGUoXCJGaWxsXCIsYSxiKTshMSE9PWEuc3Ryb2tlJiZ0aGlzLndyaXRlTm9kZShcIlN0cm9rZVwiLGEsYik7cmV0dXJuIGJ9LFdlbGxLbm93bk5hbWU6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcInNsZDpXZWxsS25vd25OYW1lXCIse3ZhbHVlOmF9KX0sT3BhY2l0eTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwic2xkOk9wYWNpdHlcIix7dmFsdWU6YX0pfSxTaXplOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLndyaXRlcnMuc2xkLl9PR0NFeHByZXNzaW9uLmNhbGwodGhpcyxcblwic2xkOlNpemVcIixhKX0sUm90YXRpb246ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcInNsZDpSb3RhdGlvblwiLHt2YWx1ZTphfSl9LE9ubGluZVJlc291cmNlOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJzbGQ6T25saW5lUmVzb3VyY2VcIix7YXR0cmlidXRlczp7XCJ4bGluazp0eXBlXCI6XCJzaW1wbGVcIixcInhsaW5rOmhyZWZcIjphfX0pfSxGb3JtYXQ6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcInNsZDpGb3JtYXRcIix7dmFsdWU6YX0pfX19LE9wZW5MYXllcnMuRm9ybWF0LkZpbHRlci52MV8wXzAucHJvdG90eXBlLndyaXRlcnMpLENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZvcm1hdC5TTEQudjFcIn0pO09wZW5MYXllcnMuTGF5ZXIuV01TPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5MYXllci5HcmlkLHtERUZBVUxUX1BBUkFNUzp7c2VydmljZTpcIldNU1wiLHZlcnNpb246XCIxLjEuMVwiLHJlcXVlc3Q6XCJHZXRNYXBcIixzdHlsZXM6XCJcIixmb3JtYXQ6XCJpbWFnZS9qcGVnXCJ9LGlzQmFzZUxheWVyOiEwLGVuY29kZUJCT1g6ITEsbm9NYWdpYzohMSx5eDp7fSxpbml0aWFsaXplOmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPVtdLGM9T3BlbkxheWVycy5VdGlsLnVwcGVyQ2FzZU9iamVjdChjKTsxLjM8PXBhcnNlRmxvYXQoYy5WRVJTSU9OKSYmIWMuRVhDRVBUSU9OUyYmKGMuRVhDRVBUSU9OUz1cIklOSU1BR0VcIik7ZS5wdXNoKGEsYixjLGQpO09wZW5MYXllcnMuTGF5ZXIuR3JpZC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLGUpO09wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKHRoaXMucGFyYW1zLE9wZW5MYXllcnMuVXRpbC51cHBlckNhc2VPYmplY3QodGhpcy5ERUZBVUxUX1BBUkFNUykpO1xuaWYoIXRoaXMubm9NYWdpYyYmdGhpcy5wYXJhbXMuVFJBTlNQQVJFTlQmJlwidHJ1ZVwiPT10aGlzLnBhcmFtcy5UUkFOU1BBUkVOVC50b1N0cmluZygpLnRvTG93ZXJDYXNlKCkpe2lmKG51bGw9PWR8fCFkLmlzQmFzZUxheWVyKXRoaXMuaXNCYXNlTGF5ZXI9ITE7XCJpbWFnZS9qcGVnXCI9PXRoaXMucGFyYW1zLkZPUk1BVCYmKHRoaXMucGFyYW1zLkZPUk1BVD1PcGVuTGF5ZXJzLlV0aWwuYWxwaGFIYWNrKCk/XCJpbWFnZS9naWZcIjpcImltYWdlL3BuZ1wiKX19LGNsb25lOmZ1bmN0aW9uKGEpe251bGw9PWEmJihhPW5ldyBPcGVuTGF5ZXJzLkxheWVyLldNUyh0aGlzLm5hbWUsdGhpcy51cmwsdGhpcy5wYXJhbXMsdGhpcy5nZXRPcHRpb25zKCkpKTtyZXR1cm4gYT1PcGVuTGF5ZXJzLkxheWVyLkdyaWQucHJvdG90eXBlLmNsb25lLmFwcGx5KHRoaXMsW2FdKX0scmV2ZXJzZUF4aXNPcmRlcjpmdW5jdGlvbigpe3ZhciBhPXRoaXMucHJvamVjdGlvbi5nZXRDb2RlKCk7cmV0dXJuIDEuMzw9cGFyc2VGbG9hdCh0aGlzLnBhcmFtcy5WRVJTSU9OKSYmXG4hKCF0aGlzLnl4W2FdJiYhT3BlbkxheWVycy5Qcm9qZWN0aW9uLmRlZmF1bHRzW2FdLnl4KX0sZ2V0VVJMOmZ1bmN0aW9uKGEpe3ZhciBhPXRoaXMuYWRqdXN0Qm91bmRzKGEpLGI9dGhpcy5nZXRJbWFnZVNpemUoKSxjPXt9LGQ9dGhpcy5yZXZlcnNlQXhpc09yZGVyKCk7Yy5CQk9YPXRoaXMuZW5jb2RlQkJPWD9hLnRvQkJPWChudWxsLGQpOmEudG9BcnJheShkKTtjLldJRFRIPWIudztjLkhFSUdIVD1iLmg7cmV0dXJuIHRoaXMuZ2V0RnVsbFJlcXVlc3RTdHJpbmcoYyl9LG1lcmdlTmV3UGFyYW1zOmZ1bmN0aW9uKGEpe2E9W09wZW5MYXllcnMuVXRpbC51cHBlckNhc2VPYmplY3QoYSldO3JldHVybiBPcGVuTGF5ZXJzLkxheWVyLkdyaWQucHJvdG90eXBlLm1lcmdlTmV3UGFyYW1zLmFwcGx5KHRoaXMsYSl9LGdldEZ1bGxSZXF1ZXN0U3RyaW5nOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5tYXAuZ2V0UHJvamVjdGlvbk9iamVjdCgpLGM9dGhpcy5wcm9qZWN0aW9uJiZ0aGlzLnByb2plY3Rpb24uZXF1YWxzKGMpP1xudGhpcy5wcm9qZWN0aW9uLmdldENvZGUoKTpjLmdldENvZGUoKSxjPVwibm9uZVwiPT1jP251bGw6YzsxLjM8PXBhcnNlRmxvYXQodGhpcy5wYXJhbXMuVkVSU0lPTik/dGhpcy5wYXJhbXMuQ1JTPWM6dGhpcy5wYXJhbXMuU1JTPWM7XCJib29sZWFuXCI9PXR5cGVvZiB0aGlzLnBhcmFtcy5UUkFOU1BBUkVOVCYmKGEuVFJBTlNQQVJFTlQ9dGhpcy5wYXJhbXMuVFJBTlNQQVJFTlQ/XCJUUlVFXCI6XCJGQUxTRVwiKTtyZXR1cm4gT3BlbkxheWVycy5MYXllci5HcmlkLnByb3RvdHlwZS5nZXRGdWxsUmVxdWVzdFN0cmluZy5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkxheWVyLldNU1wifSk7T3BlbkxheWVycy5Gb3JtYXQuV01DLnYxXzFfMD1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuRm9ybWF0LldNQy52MSx7VkVSU0lPTjpcIjEuMS4wXCIsc2NoZW1hTG9jYXRpb246XCJodHRwOi8vd3d3Lm9wZW5naXMubmV0L2NvbnRleHQgaHR0cDovL3NjaGVtYXMub3Blbmdpcy5uZXQvY29udGV4dC8xLjEuMC9jb250ZXh0LnhzZFwiLGluaXRpYWxpemU6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5Gb3JtYXQuV01DLnYxLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsW2FdKX0scmVhZF9zbGRfTWluU2NhbGVEZW5vbWluYXRvcjpmdW5jdGlvbihhLGIpe3ZhciBjPXBhcnNlRmxvYXQodGhpcy5nZXRDaGlsZFZhbHVlKGIpKTswPGMmJihhLm1heFNjYWxlPWMpfSxyZWFkX3NsZF9NYXhTY2FsZURlbm9taW5hdG9yOmZ1bmN0aW9uKGEsYil7YS5taW5TY2FsZT1wYXJzZUZsb2F0KHRoaXMuZ2V0Q2hpbGRWYWx1ZShiKSl9LHJlYWRfd21jX1NSUzpmdW5jdGlvbihhLGIpe1wic3JzXCJpblxuYXx8KGEuc3JzPXt9KTthLnNyc1t0aGlzLmdldENoaWxkVmFsdWUoYildPSEwfSx3cml0ZV93bWNfTGF5ZXI6ZnVuY3Rpb24oYSl7dmFyIGI9T3BlbkxheWVycy5Gb3JtYXQuV01DLnYxLnByb3RvdHlwZS53cml0ZV93bWNfTGF5ZXIuYXBwbHkodGhpcyxbYV0pO2lmKGEubWF4U2NhbGUpe3ZhciBjPXRoaXMuY3JlYXRlRWxlbWVudE5TKHRoaXMubmFtZXNwYWNlcy5zbGQsXCJzbGQ6TWluU2NhbGVEZW5vbWluYXRvclwiKTtjLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlVGV4dE5vZGUoYS5tYXhTY2FsZS50b1ByZWNpc2lvbigxNikpKTtiLmFwcGVuZENoaWxkKGMpfWEubWluU2NhbGUmJihjPXRoaXMuY3JlYXRlRWxlbWVudE5TKHRoaXMubmFtZXNwYWNlcy5zbGQsXCJzbGQ6TWF4U2NhbGVEZW5vbWluYXRvclwiKSxjLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlVGV4dE5vZGUoYS5taW5TY2FsZS50b1ByZWNpc2lvbigxNikpKSxiLmFwcGVuZENoaWxkKGMpKTtpZihhLnNycylmb3IodmFyIGQgaW4gYS5zcnMpYi5hcHBlbmRDaGlsZCh0aGlzLmNyZWF0ZUVsZW1lbnREZWZhdWx0TlMoXCJTUlNcIixcbmQpKTtiLmFwcGVuZENoaWxkKHRoaXMud3JpdGVfd21jX0Zvcm1hdExpc3QoYSkpO2IuYXBwZW5kQ2hpbGQodGhpcy53cml0ZV93bWNfU3R5bGVMaXN0KGEpKTthLmRpbWVuc2lvbnMmJmIuYXBwZW5kQ2hpbGQodGhpcy53cml0ZV93bWNfRGltZW5zaW9uTGlzdChhKSk7Yi5hcHBlbmRDaGlsZCh0aGlzLndyaXRlX3dtY19MYXllckV4dGVuc2lvbihhKSk7cmV0dXJuIGJ9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZvcm1hdC5XTUMudjFfMV8wXCJ9KTtPcGVuTGF5ZXJzLkZvcm1hdC5YTFM9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkZvcm1hdC5YTUwuVmVyc2lvbmVkT0dDLHtkZWZhdWx0VmVyc2lvbjpcIjEuMS4wXCIsc3RyaW5naWZ5T3V0cHV0OiEwLENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZvcm1hdC5YTFNcIn0pO09wZW5MYXllcnMuRm9ybWF0LlhMUy52MT1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuRm9ybWF0LlhNTCx7bmFtZXNwYWNlczp7eGxzOlwiaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC94bHNcIixnbWw6XCJodHRwOi8vd3d3Lm9wZW5naXMubmV0L2dtbFwiLHhzaTpcImh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hLWluc3RhbmNlXCJ9LHJlZ0V4ZXM6e3RyaW1TcGFjZTovXlxccyp8XFxzKiQvZyxyZW1vdmVTcGFjZTovXFxzKi9nLHNwbGl0U3BhY2U6L1xccysvLHRyaW1Db21tYTovXFxzKixcXHMqL2d9LHh5OiEwLGRlZmF1bHRQcmVmaXg6XCJ4bHNcIixzY2hlbWFMb2NhdGlvbjpudWxsLHJlYWQ6ZnVuY3Rpb24oYSxiKXtPcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyhiLHRoaXMub3B0aW9ucyk7dmFyIGM9e307dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpO3JldHVybiBjfSxyZWFkZXJzOnt4bHM6e1hMUzpmdW5jdGlvbihhLGIpe2IudmVyc2lvbj1hLmdldEF0dHJpYnV0ZShcInZlcnNpb25cIik7XG50aGlzLnJlYWRDaGlsZE5vZGVzKGEsYil9LFJlc3BvbnNlOmZ1bmN0aW9uKGEsYil7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIpfSxHZW9jb2RlUmVzcG9uc2U6ZnVuY3Rpb24oYSxiKXtiLnJlc3BvbnNlTGlzdHM9W107dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIpfSxHZW9jb2RlUmVzcG9uc2VMaXN0OmZ1bmN0aW9uKGEsYil7dmFyIGM9e2ZlYXR1cmVzOltdLG51bWJlck9mR2VvY29kZWRBZGRyZXNzZXM6cGFyc2VJbnQoYS5nZXRBdHRyaWJ1dGUoXCJudW1iZXJPZkdlb2NvZGVkQWRkcmVzc2VzXCIpKX07Yi5yZXNwb25zZUxpc3RzLnB1c2goYyk7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpfSxHZW9jb2RlZEFkZHJlc3M6ZnVuY3Rpb24oYSxiKXt2YXIgYz1uZXcgT3BlbkxheWVycy5GZWF0dXJlLlZlY3RvcjtiLmZlYXR1cmVzLnB1c2goYyk7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpO2MuZ2VvbWV0cnk9Yy5jb21wb25lbnRzWzBdfSxHZW9jb2RlTWF0Y2hDb2RlOmZ1bmN0aW9uKGEsYil7Yi5hdHRyaWJ1dGVzLm1hdGNoQ29kZT1cbnthY2N1cmFjeTpwYXJzZUZsb2F0KGEuZ2V0QXR0cmlidXRlKFwiYWNjdXJhY3lcIikpLG1hdGNoVHlwZTphLmdldEF0dHJpYnV0ZShcIm1hdGNoVHlwZVwiKX19LEFkZHJlc3M6ZnVuY3Rpb24oYSxiKXt2YXIgYz17Y291bnRyeUNvZGU6YS5nZXRBdHRyaWJ1dGUoXCJjb3VudHJ5Q29kZVwiKSxhZGRyZXNzZWU6YS5nZXRBdHRyaWJ1dGUoXCJhZGRyZXNzZWVcIiksc3RyZWV0OltdLHBsYWNlOltdfTtiLmF0dHJpYnV0ZXMuYWRkcmVzcz1jO3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKX0sZnJlZUZvcm1BZGRyZXNzOmZ1bmN0aW9uKGEsYil7Yi5mcmVlRm9ybUFkZHJlc3M9dGhpcy5nZXRDaGlsZFZhbHVlKGEpfSxTdHJlZXRBZGRyZXNzOmZ1bmN0aW9uKGEsYil7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIpfSxCdWlsZGluZzpmdW5jdGlvbihhLGIpe2IuYnVpbGRpbmc9e251bWJlcjphLmdldEF0dHJpYnV0ZShcIm51bWJlclwiKSxzdWJkaXZpc2lvbjphLmdldEF0dHJpYnV0ZShcInN1YmRpdmlzaW9uXCIpLFxuYnVpbGRpbmdOYW1lOmEuZ2V0QXR0cmlidXRlKFwiYnVpbGRpbmdOYW1lXCIpfX0sU3RyZWV0OmZ1bmN0aW9uKGEsYil7Yi5zdHJlZXQucHVzaCh0aGlzLmdldENoaWxkVmFsdWUoYSkpfSxQbGFjZTpmdW5jdGlvbihhLGIpe2IucGxhY2VbYS5nZXRBdHRyaWJ1dGUoXCJ0eXBlXCIpXT10aGlzLmdldENoaWxkVmFsdWUoYSl9LFBvc3RhbENvZGU6ZnVuY3Rpb24oYSxiKXtiLnBvc3RhbENvZGU9dGhpcy5nZXRDaGlsZFZhbHVlKGEpfX0sZ21sOk9wZW5MYXllcnMuRm9ybWF0LkdNTC52My5wcm90b3R5cGUucmVhZGVycy5nbWx9LHdyaXRlOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLndyaXRlcnMueGxzLlhMUy5hcHBseSh0aGlzLFthXSl9LHdyaXRlcnM6e3hsczp7WExTOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcInhsczpYTFNcIix7YXR0cmlidXRlczp7dmVyc2lvbjp0aGlzLlZFUlNJT04sXCJ4c2k6c2NoZW1hTG9jYXRpb25cIjp0aGlzLnNjaGVtYUxvY2F0aW9ufX0pO1xudGhpcy53cml0ZU5vZGUoXCJSZXF1ZXN0SGVhZGVyXCIsYS5oZWFkZXIsYik7dGhpcy53cml0ZU5vZGUoXCJSZXF1ZXN0XCIsYSxiKTtyZXR1cm4gYn0sUmVxdWVzdEhlYWRlcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJ4bHM6UmVxdWVzdEhlYWRlclwiKX0sUmVxdWVzdDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJ4bHM6UmVxdWVzdFwiLHthdHRyaWJ1dGVzOnttZXRob2ROYW1lOlwiR2VvY29kZVJlcXVlc3RcIixyZXF1ZXN0SUQ6YS5yZXF1ZXN0SUR8fFwiXCIsdmVyc2lvbjp0aGlzLlZFUlNJT059fSk7dGhpcy53cml0ZU5vZGUoXCJHZW9jb2RlUmVxdWVzdFwiLGEuYWRkcmVzc2VzLGIpO3JldHVybiBifSxHZW9jb2RlUmVxdWVzdDpmdW5jdGlvbihhKXtmb3IodmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwieGxzOkdlb2NvZGVSZXF1ZXN0XCIpLGM9MCxkPWEubGVuZ3RoO2M8ZDtjKyspdGhpcy53cml0ZU5vZGUoXCJBZGRyZXNzXCIsXG5hW2NdLGIpO3JldHVybiBifSxBZGRyZXNzOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcInhsczpBZGRyZXNzXCIse2F0dHJpYnV0ZXM6e2NvdW50cnlDb2RlOmEuY291bnRyeUNvZGV9fSk7YS5mcmVlRm9ybUFkZHJlc3M/dGhpcy53cml0ZU5vZGUoXCJmcmVlRm9ybUFkZHJlc3NcIixhLmZyZWVGb3JtQWRkcmVzcyxiKTooYS5zdHJlZXQmJnRoaXMud3JpdGVOb2RlKFwiU3RyZWV0QWRkcmVzc1wiLGEsYiksYS5tdW5pY2lwYWxpdHkmJnRoaXMud3JpdGVOb2RlKFwiTXVuaWNpcGFsaXR5XCIsYS5tdW5pY2lwYWxpdHksYiksYS5jb3VudHJ5U3ViZGl2aXNpb24mJnRoaXMud3JpdGVOb2RlKFwiQ291bnRyeVN1YmRpdmlzaW9uXCIsYS5jb3VudHJ5U3ViZGl2aXNpb24sYiksYS5wb3N0YWxDb2RlJiZ0aGlzLndyaXRlTm9kZShcIlBvc3RhbENvZGVcIixhLnBvc3RhbENvZGUsYikpO3JldHVybiBifSxmcmVlRm9ybUFkZHJlc3M6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcImZyZWVGb3JtQWRkcmVzc1wiLFxue3ZhbHVlOmF9KX0sU3RyZWV0QWRkcmVzczpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJ4bHM6U3RyZWV0QWRkcmVzc1wiKTthLmJ1aWxkaW5nJiZ0aGlzLndyaXRlTm9kZShiLFwiQnVpbGRpbmdcIixhLmJ1aWxkaW5nKTthPWEuc3RyZWV0O09wZW5MYXllcnMuVXRpbC5pc0FycmF5KGEpfHwoYT1bYV0pO2Zvcih2YXIgYz0wLGQ9YS5sZW5ndGg7YzxkO2MrKyl0aGlzLndyaXRlTm9kZShcIlN0cmVldFwiLGFbY10sYik7cmV0dXJuIGJ9LEJ1aWxkaW5nOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJ4bHM6QnVpbGRpbmdcIix7YXR0cmlidXRlczp7bnVtYmVyOmEubnVtYmVyLHN1YmRpdmlzaW9uOmEuc3ViZGl2aXNpb24sYnVpbGRpbmdOYW1lOmEuYnVpbGRpbmdOYW1lfX0pfSxTdHJlZXQ6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcInhsczpTdHJlZXRcIix7dmFsdWU6YX0pfSxNdW5pY2lwYWxpdHk6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcInhsczpQbGFjZVwiLFxue2F0dHJpYnV0ZXM6e3R5cGU6XCJNdW5pY2lwYWxpdHlcIn0sdmFsdWU6YX0pfSxDb3VudHJ5U3ViZGl2aXNpb246ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcInhsczpQbGFjZVwiLHthdHRyaWJ1dGVzOnt0eXBlOlwiQ291bnRyeVN1YmRpdmlzaW9uXCJ9LHZhbHVlOmF9KX0sUG9zdGFsQ29kZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwieGxzOlBvc3RhbENvZGVcIix7dmFsdWU6YX0pfX19LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZvcm1hdC5YTFMudjFcIn0pO09wZW5MYXllcnMuRm9ybWF0LlhMUy52MV8xXzA9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkZvcm1hdC5YTFMudjEse1ZFUlNJT046XCIxLjFcIixzY2hlbWFMb2NhdGlvbjpcImh0dHA6Ly93d3cub3Blbmdpcy5uZXQveGxzIGh0dHA6Ly9zY2hlbWFzLm9wZW5naXMubmV0L29scy8xLjEuMC9Mb2NhdGlvblV0aWxpdHlTZXJ2aWNlLnhzZFwiLENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZvcm1hdC5YTFMudjFfMV8wXCJ9KTtPcGVuTGF5ZXJzLkZvcm1hdC5YTFMudjFfMT1PcGVuTGF5ZXJzLkZvcm1hdC5YTFMudjFfMV8wO09wZW5MYXllcnMuUmVuZGVyZXIuU1ZHPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5SZW5kZXJlci5FbGVtZW50cyx7eG1sbnM6XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiLHhsaW5rbnM6XCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rXCIsTUFYX1BJWEVMOjE1RTMsdHJhbnNsYXRpb25QYXJhbWV0ZXJzOm51bGwsc3ltYm9sTWV0cmljczpudWxsLGluaXRpYWxpemU6ZnVuY3Rpb24oYSl7dGhpcy5zdXBwb3J0ZWQoKSYmKE9wZW5MYXllcnMuUmVuZGVyZXIuRWxlbWVudHMucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMudHJhbnNsYXRpb25QYXJhbWV0ZXJzPXt4OjAseTowfSx0aGlzLnN5bWJvbE1ldHJpY3M9e30pfSxzdXBwb3J0ZWQ6ZnVuY3Rpb24oKXtyZXR1cm4gZG9jdW1lbnQuaW1wbGVtZW50YXRpb24mJihkb2N1bWVudC5pbXBsZW1lbnRhdGlvbi5oYXNGZWF0dXJlKFwib3JnLnczYy5zdmdcIixcIjEuMFwiKXx8ZG9jdW1lbnQuaW1wbGVtZW50YXRpb24uaGFzRmVhdHVyZShcImh0dHA6Ly93d3cudzMub3JnL1RSL1NWRzExL2ZlYXR1cmUjU1ZHXCIsXG5cIjEuMVwiKXx8ZG9jdW1lbnQuaW1wbGVtZW50YXRpb24uaGFzRmVhdHVyZShcImh0dHA6Ly93d3cudzMub3JnL1RSL1NWRzExL2ZlYXR1cmUjQmFzaWNTdHJ1Y3R1cmVcIixcIjEuMVwiKSl9LGluVmFsaWRSYW5nZTpmdW5jdGlvbihhLGIsYyl7YSs9Yz8wOnRoaXMudHJhbnNsYXRpb25QYXJhbWV0ZXJzLng7Yis9Yz8wOnRoaXMudHJhbnNsYXRpb25QYXJhbWV0ZXJzLnk7cmV0dXJuIGE+PS10aGlzLk1BWF9QSVhFTCYmYTw9dGhpcy5NQVhfUElYRUwmJmI+PS10aGlzLk1BWF9QSVhFTCYmYjw9dGhpcy5NQVhfUElYRUx9LHNldEV4dGVudDpmdW5jdGlvbihhLGIpe3ZhciBjPU9wZW5MYXllcnMuUmVuZGVyZXIuRWxlbWVudHMucHJvdG90eXBlLnNldEV4dGVudC5hcHBseSh0aGlzLGFyZ3VtZW50cyksZD10aGlzLmdldFJlc29sdXRpb24oKSxlPS1hLmxlZnQvZCxkPWEudG9wL2Q7aWYoYilyZXR1cm4gdGhpcy5sZWZ0PWUsdGhpcy50b3A9ZCx0aGlzLnJlbmRlcmVyUm9vdC5zZXRBdHRyaWJ1dGVOUyhudWxsLFxuXCJ2aWV3Qm94XCIsXCIwIDAgXCIrdGhpcy5zaXplLncrXCIgXCIrdGhpcy5zaXplLmgpLHRoaXMudHJhbnNsYXRlKHRoaXMueE9mZnNldCwwKSwhMDsoZT10aGlzLnRyYW5zbGF0ZShlLXRoaXMubGVmdCt0aGlzLnhPZmZzZXQsZC10aGlzLnRvcCkpfHx0aGlzLnNldEV4dGVudChhLCEwKTtyZXR1cm4gYyYmZX0sdHJhbnNsYXRlOmZ1bmN0aW9uKGEsYil7aWYodGhpcy5pblZhbGlkUmFuZ2UoYSxiLCEwKSl7dmFyIGM9XCJcIjtpZihhfHxiKWM9XCJ0cmFuc2xhdGUoXCIrYStcIixcIitiK1wiKVwiO3RoaXMucm9vdC5zZXRBdHRyaWJ1dGVOUyhudWxsLFwidHJhbnNmb3JtXCIsYyk7dGhpcy50cmFuc2xhdGlvblBhcmFtZXRlcnM9e3g6YSx5OmJ9O3JldHVybiEwfXJldHVybiExfSxzZXRTaXplOmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuUmVuZGVyZXIucHJvdG90eXBlLnNldFNpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMucmVuZGVyZXJSb290LnNldEF0dHJpYnV0ZU5TKG51bGwsXCJ3aWR0aFwiLHRoaXMuc2l6ZS53KTtcbnRoaXMucmVuZGVyZXJSb290LnNldEF0dHJpYnV0ZU5TKG51bGwsXCJoZWlnaHRcIix0aGlzLnNpemUuaCl9LGdldE5vZGVUeXBlOmZ1bmN0aW9uKGEsYil7dmFyIGM9bnVsbDtzd2l0Y2goYS5DTEFTU19OQU1FKXtjYXNlIFwiT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludFwiOmM9Yi5leHRlcm5hbEdyYXBoaWM/XCJpbWFnZVwiOnRoaXMuaXNDb21wbGV4U3ltYm9sKGIuZ3JhcGhpY05hbWUpP1wic3ZnXCI6XCJjaXJjbGVcIjticmVhaztjYXNlIFwiT3BlbkxheWVycy5HZW9tZXRyeS5SZWN0YW5nbGVcIjpjPVwicmVjdFwiO2JyZWFrO2Nhc2UgXCJPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVTdHJpbmdcIjpjPVwicG9seWxpbmVcIjticmVhaztjYXNlIFwiT3BlbkxheWVycy5HZW9tZXRyeS5MaW5lYXJSaW5nXCI6Yz1cInBvbHlnb25cIjticmVhaztjYXNlIFwiT3BlbkxheWVycy5HZW9tZXRyeS5Qb2x5Z29uXCI6Y2FzZSBcIk9wZW5MYXllcnMuR2VvbWV0cnkuQ3VydmVcIjpjPVwicGF0aFwifXJldHVybiBjfSxzZXRTdHlsZTpmdW5jdGlvbihhLFxuYixjKXt2YXIgYj1ifHxhLl9zdHlsZSxjPWN8fGEuX29wdGlvbnMsZD1wYXJzZUZsb2F0KGEuZ2V0QXR0cmlidXRlTlMobnVsbCxcInJcIikpLGU9MSxmO2lmKFwiT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludFwiPT1hLl9nZW9tZXRyeUNsYXNzJiZkKXthLnN0eWxlLnZpc2liaWxpdHk9XCJcIjtpZighMT09PWIuZ3JhcGhpYylhLnN0eWxlLnZpc2liaWxpdHk9XCJoaWRkZW5cIjtlbHNlIGlmKGIuZXh0ZXJuYWxHcmFwaGljKXtmPXRoaXMuZ2V0UG9zaXRpb24oYSk7Yi5ncmFwaGljVGl0bGUmJihhLnNldEF0dHJpYnV0ZU5TKG51bGwsXCJ0aXRsZVwiLGIuZ3JhcGhpY1RpdGxlKSxkPWEuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJ0aXRsZVwiKSwwPGQubGVuZ3RoP2RbMF0uZmlyc3RDaGlsZC50ZXh0Q29udGVudD1iLmdyYXBoaWNUaXRsZTooZD10aGlzLm5vZGVGYWN0b3J5KG51bGwsXCJ0aXRsZVwiKSxkLnRleHRDb250ZW50PWIuZ3JhcGhpY1RpdGxlLGEuYXBwZW5kQ2hpbGQoZCkpKTtiLmdyYXBoaWNXaWR0aCYmXG5iLmdyYXBoaWNIZWlnaHQmJmEuc2V0QXR0cmlidXRlTlMobnVsbCxcInByZXNlcnZlQXNwZWN0UmF0aW9cIixcIm5vbmVcIik7dmFyIGQ9Yi5ncmFwaGljV2lkdGh8fGIuZ3JhcGhpY0hlaWdodCxnPWIuZ3JhcGhpY0hlaWdodHx8Yi5ncmFwaGljV2lkdGgsZD1kP2Q6MipiLnBvaW50UmFkaXVzLGc9Zz9nOjIqYi5wb2ludFJhZGl1cyxoPXZvaWQgMCE9Yi5ncmFwaGljWU9mZnNldD9iLmdyYXBoaWNZT2Zmc2V0Oi0oMC41KmcpLGk9Yi5ncmFwaGljT3BhY2l0eXx8Yi5maWxsT3BhY2l0eTthLnNldEF0dHJpYnV0ZU5TKG51bGwsXCJ4XCIsKGYueCsodm9pZCAwIT1iLmdyYXBoaWNYT2Zmc2V0P2IuZ3JhcGhpY1hPZmZzZXQ6LSgwLjUqZCkpKS50b0ZpeGVkKCkpO2Euc2V0QXR0cmlidXRlTlMobnVsbCxcInlcIiwoZi55K2gpLnRvRml4ZWQoKSk7YS5zZXRBdHRyaWJ1dGVOUyhudWxsLFwid2lkdGhcIixkKTthLnNldEF0dHJpYnV0ZU5TKG51bGwsXCJoZWlnaHRcIixnKTthLnNldEF0dHJpYnV0ZU5TKHRoaXMueGxpbmtucyxcblwiaHJlZlwiLGIuZXh0ZXJuYWxHcmFwaGljKTthLnNldEF0dHJpYnV0ZU5TKG51bGwsXCJzdHlsZVwiLFwib3BhY2l0eTogXCIraSk7YS5vbmNsaWNrPU9wZW5MYXllcnMuUmVuZGVyZXIuU1ZHLnByZXZlbnREZWZhdWx0fWVsc2UgaWYodGhpcy5pc0NvbXBsZXhTeW1ib2woYi5ncmFwaGljTmFtZSkpe3ZhciBkPTMqYi5wb2ludFJhZGl1cyxnPTIqZCxqPXRoaXMuaW1wb3J0U3ltYm9sKGIuZ3JhcGhpY05hbWUpO2Y9dGhpcy5nZXRQb3NpdGlvbihhKTtlPTMqdGhpcy5zeW1ib2xNZXRyaWNzW2ouaWRdWzBdL2c7aD1hLnBhcmVudE5vZGU7aT1hLm5leHRTaWJsaW5nO2gmJmgucmVtb3ZlQ2hpbGQoYSk7YS5maXJzdENoaWxkJiZhLnJlbW92ZUNoaWxkKGEuZmlyc3RDaGlsZCk7YS5hcHBlbmRDaGlsZChqLmZpcnN0Q2hpbGQuY2xvbmVOb2RlKCEwKSk7YS5zZXRBdHRyaWJ1dGVOUyhudWxsLFwidmlld0JveFwiLGouZ2V0QXR0cmlidXRlTlMobnVsbCxcInZpZXdCb3hcIikpO2Euc2V0QXR0cmlidXRlTlMobnVsbCxcblwid2lkdGhcIixnKTthLnNldEF0dHJpYnV0ZU5TKG51bGwsXCJoZWlnaHRcIixnKTthLnNldEF0dHJpYnV0ZU5TKG51bGwsXCJ4XCIsZi54LWQpO2Euc2V0QXR0cmlidXRlTlMobnVsbCxcInlcIixmLnktZCk7aT9oLmluc2VydEJlZm9yZShhLGkpOmgmJmguYXBwZW5kQ2hpbGQoYSl9ZWxzZSBhLnNldEF0dHJpYnV0ZU5TKG51bGwsXCJyXCIsYi5wb2ludFJhZGl1cyk7ZD1iLnJvdGF0aW9uO2lmKCh2b2lkIDAhPT1kfHx2b2lkIDAhPT1hLl9yb3RhdGlvbikmJmYpYS5fcm90YXRpb249ZCxkfD0wLFwic3ZnXCIhPT1hLm5vZGVOYW1lP2Euc2V0QXR0cmlidXRlTlMobnVsbCxcInRyYW5zZm9ybVwiLFwicm90YXRlKFwiK2QrXCIgXCIrZi54K1wiIFwiK2YueStcIilcIik6KGY9dGhpcy5zeW1ib2xNZXRyaWNzW2ouaWRdLGEuZmlyc3RDaGlsZC5zZXRBdHRyaWJ1dGVOUyhudWxsLFwidHJhbnNmb3JtXCIsXCJyb3RhdGUoXCIrZCtcIiBcIitmWzFdK1wiIFwiK2ZbMl0rXCIpXCIpKX1jLmlzRmlsbGVkPyhhLnNldEF0dHJpYnV0ZU5TKG51bGwsXG5cImZpbGxcIixiLmZpbGxDb2xvciksYS5zZXRBdHRyaWJ1dGVOUyhudWxsLFwiZmlsbC1vcGFjaXR5XCIsYi5maWxsT3BhY2l0eSkpOmEuc2V0QXR0cmlidXRlTlMobnVsbCxcImZpbGxcIixcIm5vbmVcIik7Yy5pc1N0cm9rZWQ/KGEuc2V0QXR0cmlidXRlTlMobnVsbCxcInN0cm9rZVwiLGIuc3Ryb2tlQ29sb3IpLGEuc2V0QXR0cmlidXRlTlMobnVsbCxcInN0cm9rZS1vcGFjaXR5XCIsYi5zdHJva2VPcGFjaXR5KSxhLnNldEF0dHJpYnV0ZU5TKG51bGwsXCJzdHJva2Utd2lkdGhcIixiLnN0cm9rZVdpZHRoKmUpLGEuc2V0QXR0cmlidXRlTlMobnVsbCxcInN0cm9rZS1saW5lY2FwXCIsYi5zdHJva2VMaW5lY2FwfHxcInJvdW5kXCIpLGEuc2V0QXR0cmlidXRlTlMobnVsbCxcInN0cm9rZS1saW5lam9pblwiLFwicm91bmRcIiksYi5zdHJva2VEYXNoc3R5bGUmJmEuc2V0QXR0cmlidXRlTlMobnVsbCxcInN0cm9rZS1kYXNoYXJyYXlcIix0aGlzLmRhc2hTdHlsZShiLGUpKSk6YS5zZXRBdHRyaWJ1dGVOUyhudWxsLFwic3Ryb2tlXCIsXG5cIm5vbmVcIik7Yi5wb2ludGVyRXZlbnRzJiZhLnNldEF0dHJpYnV0ZU5TKG51bGwsXCJwb2ludGVyLWV2ZW50c1wiLGIucG9pbnRlckV2ZW50cyk7bnVsbCE9Yi5jdXJzb3ImJmEuc2V0QXR0cmlidXRlTlMobnVsbCxcImN1cnNvclwiLGIuY3Vyc29yKTtyZXR1cm4gYX0sZGFzaFN0eWxlOmZ1bmN0aW9uKGEsYil7dmFyIGM9YS5zdHJva2VXaWR0aCpiLGQ9YS5zdHJva2VEYXNoc3R5bGU7c3dpdGNoKGQpe2Nhc2UgXCJzb2xpZFwiOnJldHVyblwibm9uZVwiO2Nhc2UgXCJkb3RcIjpyZXR1cm5bMSw0KmNdLmpvaW4oKTtjYXNlIFwiZGFzaFwiOnJldHVybls0KmMsNCpjXS5qb2luKCk7Y2FzZSBcImRhc2hkb3RcIjpyZXR1cm5bNCpjLDQqYywxLDQqY10uam9pbigpO2Nhc2UgXCJsb25nZGFzaFwiOnJldHVybls4KmMsNCpjXS5qb2luKCk7Y2FzZSBcImxvbmdkYXNoZG90XCI6cmV0dXJuWzgqYyw0KmMsMSw0KmNdLmpvaW4oKTtkZWZhdWx0OnJldHVybiBPcGVuTGF5ZXJzLlN0cmluZy50cmltKGQpLnJlcGxhY2UoL1xccysvZyxcblwiLFwiKX19LGNyZWF0ZU5vZGU6ZnVuY3Rpb24oYSxiKXt2YXIgYz1kb2N1bWVudC5jcmVhdGVFbGVtZW50TlModGhpcy54bWxucyxhKTtiJiZjLnNldEF0dHJpYnV0ZU5TKG51bGwsXCJpZFwiLGIpO3JldHVybiBjfSxub2RlVHlwZUNvbXBhcmU6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYj09YS5ub2RlTmFtZX0sY3JlYXRlUmVuZGVyUm9vdDpmdW5jdGlvbigpe3ZhciBhPXRoaXMubm9kZUZhY3RvcnkodGhpcy5jb250YWluZXIuaWQrXCJfc3ZnUm9vdFwiLFwic3ZnXCIpO2Euc3R5bGUuZGlzcGxheT1cImJsb2NrXCI7cmV0dXJuIGF9LGNyZWF0ZVJvb3Q6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMubm9kZUZhY3RvcnkodGhpcy5jb250YWluZXIuaWQrYSxcImdcIil9LGNyZWF0ZURlZnM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm5vZGVGYWN0b3J5KHRoaXMuY29udGFpbmVyLmlkK1wiX2RlZnNcIixcImRlZnNcIik7dGhpcy5yZW5kZXJlclJvb3QuYXBwZW5kQ2hpbGQoYSk7cmV0dXJuIGF9LGRyYXdQb2ludDpmdW5jdGlvbihhLFxuYil7cmV0dXJuIHRoaXMuZHJhd0NpcmNsZShhLGIsMSl9LGRyYXdDaXJjbGU6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXMuZ2V0UmVzb2x1dGlvbigpLGU9KGIueC10aGlzLmZlYXR1cmVEeCkvZCt0aGlzLmxlZnQsYj10aGlzLnRvcC1iLnkvZDtyZXR1cm4gdGhpcy5pblZhbGlkUmFuZ2UoZSxiKT8oYS5zZXRBdHRyaWJ1dGVOUyhudWxsLFwiY3hcIixlKSxhLnNldEF0dHJpYnV0ZU5TKG51bGwsXCJjeVwiLGIpLGEuc2V0QXR0cmlidXRlTlMobnVsbCxcInJcIixjKSxhKTohMX0sZHJhd0xpbmVTdHJpbmc6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmdldENvbXBvbmVudHNTdHJpbmcoYi5jb21wb25lbnRzKTtyZXR1cm4gYy5wYXRoPyhhLnNldEF0dHJpYnV0ZU5TKG51bGwsXCJwb2ludHNcIixjLnBhdGgpLGMuY29tcGxldGU/YTpudWxsKTohMX0sZHJhd0xpbmVhclJpbmc6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmdldENvbXBvbmVudHNTdHJpbmcoYi5jb21wb25lbnRzKTtyZXR1cm4gYy5wYXRoP1xuKGEuc2V0QXR0cmlidXRlTlMobnVsbCxcInBvaW50c1wiLGMucGF0aCksYy5jb21wbGV0ZT9hOm51bGwpOiExfSxkcmF3UG9seWdvbjpmdW5jdGlvbihhLGIpe2Zvcih2YXIgYz1cIlwiLGQ9ITAsZT0hMCxmLGcsaD0wLGk9Yi5jb21wb25lbnRzLmxlbmd0aDtoPGk7aCsrKWMrPVwiIE1cIixmPXRoaXMuZ2V0Q29tcG9uZW50c1N0cmluZyhiLmNvbXBvbmVudHNbaF0uY29tcG9uZW50cyxcIiBcIiksKGc9Zi5wYXRoKT8oYys9XCIgXCIrZyxlPWYuY29tcGxldGUmJmUpOmQ9ITE7cmV0dXJuIGQ/KGEuc2V0QXR0cmlidXRlTlMobnVsbCxcImRcIixjK1wiIHpcIiksYS5zZXRBdHRyaWJ1dGVOUyhudWxsLFwiZmlsbC1ydWxlXCIsXCJldmVub2RkXCIpLGU/YTpudWxsKTohMX0sZHJhd1JlY3RhbmdsZTpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuZ2V0UmVzb2x1dGlvbigpLGQ9KGIueC10aGlzLmZlYXR1cmVEeCkvYyt0aGlzLmxlZnQsZT10aGlzLnRvcC1iLnkvYztyZXR1cm4gdGhpcy5pblZhbGlkUmFuZ2UoZCxlKT8oYS5zZXRBdHRyaWJ1dGVOUyhudWxsLFxuXCJ4XCIsZCksYS5zZXRBdHRyaWJ1dGVOUyhudWxsLFwieVwiLGUpLGEuc2V0QXR0cmlidXRlTlMobnVsbCxcIndpZHRoXCIsYi53aWR0aC9jKSxhLnNldEF0dHJpYnV0ZU5TKG51bGwsXCJoZWlnaHRcIixiLmhlaWdodC9jKSxhKTohMX0sZHJhd1RleHQ6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPSEhYi5sYWJlbE91dGxpbmVXaWR0aDtpZihkKXt2YXIgZT1PcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHt9LGIpO2UuZm9udENvbG9yPWUubGFiZWxPdXRsaW5lQ29sb3I7ZS5mb250U3Ryb2tlQ29sb3I9ZS5sYWJlbE91dGxpbmVDb2xvcjtlLmZvbnRTdHJva2VXaWR0aD1iLmxhYmVsT3V0bGluZVdpZHRoO2RlbGV0ZSBlLmxhYmVsT3V0bGluZVdpZHRoO3RoaXMuZHJhd1RleHQoYSxlLGMpfXZhciBmPXRoaXMuZ2V0UmVzb2x1dGlvbigpLGU9KGMueC10aGlzLmZlYXR1cmVEeCkvZit0aGlzLmxlZnQsZz1jLnkvZi10aGlzLnRvcCxkPWQ/dGhpcy5MQUJFTF9PVVRMSU5FX1NVRkZJWDp0aGlzLkxBQkVMX0lEX1NVRkZJWCxcbmY9dGhpcy5ub2RlRmFjdG9yeShhK2QsXCJ0ZXh0XCIpO2Yuc2V0QXR0cmlidXRlTlMobnVsbCxcInhcIixlKTtmLnNldEF0dHJpYnV0ZU5TKG51bGwsXCJ5XCIsLWcpO2IuZm9udENvbG9yJiZmLnNldEF0dHJpYnV0ZU5TKG51bGwsXCJmaWxsXCIsYi5mb250Q29sb3IpO2IuZm9udFN0cm9rZUNvbG9yJiZmLnNldEF0dHJpYnV0ZU5TKG51bGwsXCJzdHJva2VcIixiLmZvbnRTdHJva2VDb2xvcik7Yi5mb250U3Ryb2tlV2lkdGgmJmYuc2V0QXR0cmlidXRlTlMobnVsbCxcInN0cm9rZS13aWR0aFwiLGIuZm9udFN0cm9rZVdpZHRoKTtiLmZvbnRPcGFjaXR5JiZmLnNldEF0dHJpYnV0ZU5TKG51bGwsXCJvcGFjaXR5XCIsYi5mb250T3BhY2l0eSk7Yi5mb250RmFtaWx5JiZmLnNldEF0dHJpYnV0ZU5TKG51bGwsXCJmb250LWZhbWlseVwiLGIuZm9udEZhbWlseSk7Yi5mb250U2l6ZSYmZi5zZXRBdHRyaWJ1dGVOUyhudWxsLFwiZm9udC1zaXplXCIsYi5mb250U2l6ZSk7Yi5mb250V2VpZ2h0JiZmLnNldEF0dHJpYnV0ZU5TKG51bGwsXG5cImZvbnQtd2VpZ2h0XCIsYi5mb250V2VpZ2h0KTtiLmZvbnRTdHlsZSYmZi5zZXRBdHRyaWJ1dGVOUyhudWxsLFwiZm9udC1zdHlsZVwiLGIuZm9udFN0eWxlKTshMD09PWIubGFiZWxTZWxlY3Q/KGYuc2V0QXR0cmlidXRlTlMobnVsbCxcInBvaW50ZXItZXZlbnRzXCIsXCJ2aXNpYmxlXCIpLGYuX2ZlYXR1cmVJZD1hKTpmLnNldEF0dHJpYnV0ZU5TKG51bGwsXCJwb2ludGVyLWV2ZW50c1wiLFwibm9uZVwiKTtnPWIubGFiZWxBbGlnbnx8T3BlbkxheWVycy5SZW5kZXJlci5kZWZhdWx0U3ltYm9saXplci5sYWJlbEFsaWduO2Yuc2V0QXR0cmlidXRlTlMobnVsbCxcInRleHQtYW5jaG9yXCIsT3BlbkxheWVycy5SZW5kZXJlci5TVkcuTEFCRUxfQUxJR05bZ1swXV18fFwibWlkZGxlXCIpOyEwPT09T3BlbkxheWVycy5JU19HRUNLTyYmZi5zZXRBdHRyaWJ1dGVOUyhudWxsLFwiZG9taW5hbnQtYmFzZWxpbmVcIixPcGVuTGF5ZXJzLlJlbmRlcmVyLlNWRy5MQUJFTF9BTElHTltnWzFdXXx8XCJjZW50cmFsXCIpO2Zvcih2YXIgaD1cbmIubGFiZWwuc3BsaXQoXCJcXG5cIiksaT1oLmxlbmd0aDtmLmNoaWxkTm9kZXMubGVuZ3RoPmk7KWYucmVtb3ZlQ2hpbGQoZi5sYXN0Q2hpbGQpO2Zvcih2YXIgaj0wO2o8aTtqKyspe3ZhciBrPXRoaXMubm9kZUZhY3RvcnkoYStkK1wiX3RzcGFuX1wiK2osXCJ0c3BhblwiKTshMD09PWIubGFiZWxTZWxlY3QmJihrLl9mZWF0dXJlSWQ9YSxrLl9nZW9tZXRyeT1jLGsuX2dlb21ldHJ5Q2xhc3M9Yy5DTEFTU19OQU1FKTshMT09PU9wZW5MYXllcnMuSVNfR0VDS08mJmsuc2V0QXR0cmlidXRlTlMobnVsbCxcImJhc2VsaW5lLXNoaWZ0XCIsT3BlbkxheWVycy5SZW5kZXJlci5TVkcuTEFCRUxfVlNISUZUW2dbMV1dfHxcIi0zNSVcIik7ay5zZXRBdHRyaWJ1dGUoXCJ4XCIsZSk7aWYoMD09ail7dmFyIGw9T3BlbkxheWVycy5SZW5kZXJlci5TVkcuTEFCRUxfVkZBQ1RPUltnWzFdXTtudWxsPT1sJiYobD0tMC41KTtrLnNldEF0dHJpYnV0ZShcImR5XCIsbCooaS0xKStcImVtXCIpfWVsc2Ugay5zZXRBdHRyaWJ1dGUoXCJkeVwiLFxuXCIxZW1cIik7ay50ZXh0Q29udGVudD1cIlwiPT09aFtqXT9cIiBcIjpoW2pdO2sucGFyZW50Tm9kZXx8Zi5hcHBlbmRDaGlsZChrKX1mLnBhcmVudE5vZGV8fHRoaXMudGV4dFJvb3QuYXBwZW5kQ2hpbGQoZil9LGdldENvbXBvbmVudHNTdHJpbmc6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9W10sZD0hMCxlPWEubGVuZ3RoLGY9W10sZyxoPTA7aDxlO2grKylnPWFbaF0sYy5wdXNoKGcpLChnPXRoaXMuZ2V0U2hvcnRTdHJpbmcoZykpP2YucHVzaChnKTooMDxoJiZ0aGlzLmdldFNob3J0U3RyaW5nKGFbaC0xXSkmJmYucHVzaCh0aGlzLmNsaXBMaW5lKGFbaF0sYVtoLTFdKSksaDxlLTEmJnRoaXMuZ2V0U2hvcnRTdHJpbmcoYVtoKzFdKSYmZi5wdXNoKHRoaXMuY2xpcExpbmUoYVtoXSxhW2grMV0pKSxkPSExKTtyZXR1cm57cGF0aDpmLmpvaW4oYnx8XCIsXCIpLGNvbXBsZXRlOmR9fSxjbGlwTGluZTpmdW5jdGlvbihhLGIpe2lmKGIuZXF1YWxzKGEpKXJldHVyblwiXCI7dmFyIGM9dGhpcy5nZXRSZXNvbHV0aW9uKCksXG5kPXRoaXMuTUFYX1BJWEVMLXRoaXMudHJhbnNsYXRpb25QYXJhbWV0ZXJzLngsZT10aGlzLk1BWF9QSVhFTC10aGlzLnRyYW5zbGF0aW9uUGFyYW1ldGVycy55LGY9KGIueC10aGlzLmZlYXR1cmVEeCkvYyt0aGlzLmxlZnQsZz10aGlzLnRvcC1iLnkvYyxoPShhLngtdGhpcy5mZWF0dXJlRHgpL2MrdGhpcy5sZWZ0LGM9dGhpcy50b3AtYS55L2MsaTtpZihoPC1kfHxoPmQpaT0oYy1nKS8oaC1mKSxoPTA+aD8tZDpkLGM9ZysoaC1mKSppO2lmKGM8LWV8fGM+ZSlpPShoLWYpLyhjLWcpLGM9MD5jPy1lOmUsaD1mKyhjLWcpKmk7cmV0dXJuIGgrXCIsXCIrY30sZ2V0U2hvcnRTdHJpbmc6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5nZXRSZXNvbHV0aW9uKCksYz0oYS54LXRoaXMuZmVhdHVyZUR4KS9iK3RoaXMubGVmdCxhPXRoaXMudG9wLWEueS9iO3JldHVybiB0aGlzLmluVmFsaWRSYW5nZShjLGEpP2MrXCIsXCIrYTohMX0sZ2V0UG9zaXRpb246ZnVuY3Rpb24oYSl7cmV0dXJue3g6cGFyc2VGbG9hdChhLmdldEF0dHJpYnV0ZU5TKG51bGwsXG5cImN4XCIpKSx5OnBhcnNlRmxvYXQoYS5nZXRBdHRyaWJ1dGVOUyhudWxsLFwiY3lcIikpfX0saW1wb3J0U3ltYm9sOmZ1bmN0aW9uKGEpe3RoaXMuZGVmc3x8KHRoaXMuZGVmcz10aGlzLmNyZWF0ZURlZnMoKSk7dmFyIGI9dGhpcy5jb250YWluZXIuaWQrXCItXCIrYSxjPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGIpO2lmKG51bGwhPWMpcmV0dXJuIGM7dmFyIGQ9T3BlbkxheWVycy5SZW5kZXJlci5zeW1ib2xbYV07aWYoIWQpdGhyb3cgRXJyb3IoYStcIiBpcyBub3QgYSB2YWxpZCBzeW1ib2wgbmFtZVwiKTt2YXIgYT10aGlzLm5vZGVGYWN0b3J5KGIsXCJzeW1ib2xcIiksZT10aGlzLm5vZGVGYWN0b3J5KG51bGwsXCJwb2x5Z29uXCIpO2EuYXBwZW5kQ2hpbGQoZSk7Zm9yKHZhciBjPW5ldyBPcGVuTGF5ZXJzLkJvdW5kcyhOdW1iZXIuTUFYX1ZBTFVFLE51bWJlci5NQVhfVkFMVUUsMCwwKSxmPVtdLGcsaCxpPTA7aTxkLmxlbmd0aDtpKz0yKWc9ZFtpXSxoPWRbaSsxXSxjLmxlZnQ9TWF0aC5taW4oYy5sZWZ0LFxuZyksYy5ib3R0b209TWF0aC5taW4oYy5ib3R0b20saCksYy5yaWdodD1NYXRoLm1heChjLnJpZ2h0LGcpLGMudG9wPU1hdGgubWF4KGMudG9wLGgpLGYucHVzaChnLFwiLFwiLGgpO2Uuc2V0QXR0cmlidXRlTlMobnVsbCxcInBvaW50c1wiLGYuam9pbihcIiBcIikpO2Q9Yy5nZXRXaWR0aCgpO2U9Yy5nZXRIZWlnaHQoKTthLnNldEF0dHJpYnV0ZU5TKG51bGwsXCJ2aWV3Qm94XCIsW2MubGVmdC1kLGMuYm90dG9tLWUsMypkLDMqZV0uam9pbihcIiBcIikpO3RoaXMuc3ltYm9sTWV0cmljc1tiXT1bTWF0aC5tYXgoZCxlKSxjLmdldENlbnRlckxvbkxhdCgpLmxvbixjLmdldENlbnRlckxvbkxhdCgpLmxhdF07dGhpcy5kZWZzLmFwcGVuZENoaWxkKGEpO3JldHVybiBhfSxnZXRGZWF0dXJlSWRGcm9tRXZlbnQ6ZnVuY3Rpb24oYSl7dmFyIGI9T3BlbkxheWVycy5SZW5kZXJlci5FbGVtZW50cy5wcm90b3R5cGUuZ2V0RmVhdHVyZUlkRnJvbUV2ZW50LmFwcGx5KHRoaXMsYXJndW1lbnRzKTtifHwoYj1hLnRhcmdldCxcbmI9Yi5wYXJlbnROb2RlJiZiIT10aGlzLnJlbmRlcmVyUm9vdD9iLnBhcmVudE5vZGUuX2ZlYXR1cmVJZDp2b2lkIDApO3JldHVybiBifSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5SZW5kZXJlci5TVkdcIn0pO09wZW5MYXllcnMuUmVuZGVyZXIuU1ZHLkxBQkVMX0FMSUdOPXtsOlwic3RhcnRcIixyOlwiZW5kXCIsYjpcImJvdHRvbVwiLHQ6XCJoYW5naW5nXCJ9O09wZW5MYXllcnMuUmVuZGVyZXIuU1ZHLkxBQkVMX1ZTSElGVD17dDpcIi03MCVcIixiOlwiMFwifTtPcGVuTGF5ZXJzLlJlbmRlcmVyLlNWRy5MQUJFTF9WRkFDVE9SPXt0OjAsYjotMX07T3BlbkxheWVycy5SZW5kZXJlci5TVkcucHJldmVudERlZmF1bHQ9ZnVuY3Rpb24oYSl7YS5wcmV2ZW50RGVmYXVsdCYmYS5wcmV2ZW50RGVmYXVsdCgpfTtPcGVuTGF5ZXJzLkZvcm1hdC5TTEQudjFfMF8wPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Gb3JtYXQuU0xELnYxLHtWRVJTSU9OOlwiMS4wLjBcIixzY2hlbWFMb2NhdGlvbjpcImh0dHA6Ly93d3cub3Blbmdpcy5uZXQvc2xkIGh0dHA6Ly9zY2hlbWFzLm9wZW5naXMubmV0L3NsZC8xLjAuMC9TdHlsZWRMYXllckRlc2NyaXB0b3IueHNkXCIsQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuRm9ybWF0LlNMRC52MV8wXzBcIn0pO09wZW5MYXllcnMuRm9ybWF0Lk9XU0NvbnRleHQ9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkZvcm1hdC5Db250ZXh0LHtkZWZhdWx0VmVyc2lvbjpcIjAuMy4xXCIsZ2V0VmVyc2lvbjpmdW5jdGlvbihhLGIpe3ZhciBjPU9wZW5MYXllcnMuRm9ybWF0LlhNTC5WZXJzaW9uZWRPR0MucHJvdG90eXBlLmdldFZlcnNpb24uYXBwbHkodGhpcyxhcmd1bWVudHMpO1wiMC4zLjBcIj09PWMmJihjPXRoaXMuZGVmYXVsdFZlcnNpb24pO3JldHVybiBjfSx0b0NvbnRleHQ6ZnVuY3Rpb24oYSl7dmFyIGI9e307XCJPcGVuTGF5ZXJzLk1hcFwiPT1hLkNMQVNTX05BTUUmJihiLmJvdW5kcz1hLmdldEV4dGVudCgpLGIubWF4RXh0ZW50PWEubWF4RXh0ZW50LGIucHJvamVjdGlvbj1hLnByb2plY3Rpb24sYi5zaXplPWEuZ2V0U2l6ZSgpLGIubGF5ZXJzPWEubGF5ZXJzKTtyZXR1cm4gYn0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuRm9ybWF0Lk9XU0NvbnRleHRcIn0pO09wZW5MYXllcnMuRm9ybWF0Lk9XU0NvbnRleHQudjBfM18xPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Gb3JtYXQuWE1MLHtuYW1lc3BhY2VzOntvd2M6XCJodHRwOi8vd3d3Lm9wZW5naXMubmV0L293cy1jb250ZXh0XCIsZ21sOlwiaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC9nbWxcIixrbWw6XCJodHRwOi8vd3d3Lm9wZW5naXMubmV0L2ttbC8yLjJcIixvZ2M6XCJodHRwOi8vd3d3Lm9wZW5naXMubmV0L29nY1wiLG93czpcImh0dHA6Ly93d3cub3Blbmdpcy5uZXQvb3dzXCIsc2xkOlwiaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC9zbGRcIix4bGluazpcImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmtcIix4c2k6XCJodHRwOi8vd3d3LnczLm9yZy8yMDAxL1hNTFNjaGVtYS1pbnN0YW5jZVwifSxWRVJTSU9OOlwiMC4zLjFcIixzY2hlbWFMb2NhdGlvbjpcImh0dHA6Ly93d3cub3Blbmdpcy5uZXQvb3dzLWNvbnRleHQgaHR0cDovL3d3dy5vZ2NuZXR3b3JrLm5ldC9zY2hlbWFzL293Yy8wLjMuMS9vd3NDb250ZXh0LnhzZFwiLFxuZGVmYXVsdFByZWZpeDpcIm93Y1wiLGV4dHJhY3RBdHRyaWJ1dGVzOiEwLHh5OiEwLHJlZ0V4ZXM6e3RyaW1TcGFjZTovXlxccyp8XFxzKiQvZyxyZW1vdmVTcGFjZTovXFxzKi9nLHNwbGl0U3BhY2U6L1xccysvLHRyaW1Db21tYTovXFxzKixcXHMqL2d9LGZlYXR1cmVOUzpcImh0dHA6Ly9tYXBzZXJ2ZXIuZ2lzLnVtbi5lZHUvbWFwc2VydmVyXCIsZmVhdHVyZVR5cGU6XCJ2ZWN0b3JcIixnZW9tZXRyeU5hbWU6XCJnZW9tZXRyeVwiLG5lc3RpbmdMYXllckxvb2t1cDpudWxsLGluaXRpYWxpemU6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5Gb3JtYXQuWE1MLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsW2FdKTtPcGVuTGF5ZXJzLkZvcm1hdC5HTUwudjIucHJvdG90eXBlLnNldEdlb21ldHJ5VHlwZXMuY2FsbCh0aGlzKX0sc2V0TmVzdGluZ1BhdGg6ZnVuY3Rpb24oYSl7aWYoYS5sYXllcnNDb250ZXh0KWZvcih2YXIgYj0wLGM9YS5sYXllcnNDb250ZXh0Lmxlbmd0aDtiPGM7YisrKXt2YXIgZD1cbmEubGF5ZXJzQ29udGV4dFtiXSxlPVtdLGY9YS50aXRsZXx8XCJcIjthLm1ldGFkYXRhJiZhLm1ldGFkYXRhLm5lc3RpbmdQYXRoJiYoZT1hLm1ldGFkYXRhLm5lc3RpbmdQYXRoLnNsaWNlKCkpO1wiXCIhPWYmJmUucHVzaChmKTtkLm1ldGFkYXRhLm5lc3RpbmdQYXRoPWU7ZC5sYXllcnNDb250ZXh0JiZ0aGlzLnNldE5lc3RpbmdQYXRoKGQpfX0sZGVjb21wb3NlTmVzdGluZ1BhdGg6ZnVuY3Rpb24oYSl7dmFyIGI9W107aWYoT3BlbkxheWVycy5VdGlsLmlzQXJyYXkoYSkpe2ZvcihhPWEuc2xpY2UoKTswPGEubGVuZ3RoOyliLnB1c2goYS5zbGljZSgpKSxhLnBvcCgpO2IucmV2ZXJzZSgpfXJldHVybiBifSxyZWFkOmZ1bmN0aW9uKGEpe1wic3RyaW5nXCI9PXR5cGVvZiBhJiYoYT1PcGVuTGF5ZXJzLkZvcm1hdC5YTUwucHJvdG90eXBlLnJlYWQuYXBwbHkodGhpcyxbYV0pKTthJiY5PT1hLm5vZGVUeXBlJiYoYT1hLmRvY3VtZW50RWxlbWVudCk7dmFyIGI9e307dGhpcy5yZWFkTm9kZShhLFxuYik7dGhpcy5zZXROZXN0aW5nUGF0aCh7bGF5ZXJzQ29udGV4dDpiLmxheWVyc0NvbnRleHR9KTthPVtdO3RoaXMucHJvY2Vzc0xheWVyKGEsYik7ZGVsZXRlIGIubGF5ZXJzQ29udGV4dDtiLmxheWVyc0NvbnRleHQ9YTtyZXR1cm4gYn0scHJvY2Vzc0xheWVyOmZ1bmN0aW9uKGEsYil7aWYoYi5sYXllcnNDb250ZXh0KWZvcih2YXIgYz0wLGQ9Yi5sYXllcnNDb250ZXh0Lmxlbmd0aDtjPGQ7YysrKXt2YXIgZT1iLmxheWVyc0NvbnRleHRbY107YS5wdXNoKGUpO2UubGF5ZXJzQ29udGV4dCYmdGhpcy5wcm9jZXNzTGF5ZXIoYSxlKX19LHdyaXRlOmZ1bmN0aW9uKGEsYil7dGhpcy5uZXN0aW5nTGF5ZXJMb29rdXA9e307Yj1ifHx7fTtPcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyhiLGEpO3ZhciBjPXRoaXMud3JpdGVOb2RlKFwiT1dTQ29udGV4dFwiLGIpO3RoaXMubmVzdGluZ0xheWVyTG9va3VwPW51bGw7dGhpcy5zZXRBdHRyaWJ1dGVOUyhjLHRoaXMubmFtZXNwYWNlcy54c2ksXG5cInhzaTpzY2hlbWFMb2NhdGlvblwiLHRoaXMuc2NoZW1hTG9jYXRpb24pO3JldHVybiBPcGVuTGF5ZXJzLkZvcm1hdC5YTUwucHJvdG90eXBlLndyaXRlLmFwcGx5KHRoaXMsW2NdKX0scmVhZGVyczp7a21sOntEb2N1bWVudDpmdW5jdGlvbihhLGIpe2IuZmVhdHVyZXM9KG5ldyBPcGVuTGF5ZXJzLkZvcm1hdC5LTUwoe2ttbG5zOnRoaXMubmFtZXNwYWNlcy5rbWwsZXh0cmFjdFN0eWxlczohMH0pKS5yZWFkKGEpfX0sb3djOntPV1NDb250ZXh0OmZ1bmN0aW9uKGEsYil7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIpfSxHZW5lcmFsOmZ1bmN0aW9uKGEsYil7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIpfSxSZXNvdXJjZUxpc3Q6ZnVuY3Rpb24oYSxiKXt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYil9LExheWVyOmZ1bmN0aW9uKGEsYil7dmFyIGM9e21ldGFkYXRhOnt9LHZpc2liaWxpdHk6XCIxXCIhPWEuZ2V0QXR0cmlidXRlKFwiaGlkZGVuXCIpLHF1ZXJ5YWJsZTpcIjFcIj09YS5nZXRBdHRyaWJ1dGUoXCJxdWVyeWFibGVcIiksXG5vcGFjaXR5Om51bGwhPWEuZ2V0QXR0cmlidXRlKFwib3BhY2l0eVwiKT9wYXJzZUZsb2F0KGEuZ2V0QXR0cmlidXRlKFwib3BhY2l0eVwiKSk6bnVsbCxuYW1lOmEuZ2V0QXR0cmlidXRlKFwibmFtZVwiKSxjYXRlZ29yeUxheWVyOm51bGw9PWEuZ2V0QXR0cmlidXRlKFwibmFtZVwiKSxmb3JtYXRzOltdLHN0eWxlczpbXX07Yi5sYXllcnNDb250ZXh0fHwoYi5sYXllcnNDb250ZXh0PVtdKTtiLmxheWVyc0NvbnRleHQucHVzaChjKTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYyl9LElubGluZUdlb21ldHJ5OmZ1bmN0aW9uKGEsYil7Yi5mZWF0dXJlcz1bXTt2YXIgYz10aGlzLmdldEVsZW1lbnRzQnlUYWdOYW1lTlMoYSx0aGlzLm5hbWVzcGFjZXMuZ21sLFwiZmVhdHVyZU1lbWJlclwiKSxkOzE8PWMubGVuZ3RoJiYoZD1jWzBdKTtkJiZkLmZpcnN0Q2hpbGQmJihjPWQuZmlyc3RDaGlsZC5uZXh0U2libGluZz9kLmZpcnN0Q2hpbGQubmV4dFNpYmxpbmc6ZC5maXJzdENoaWxkLHRoaXMuc2V0TmFtZXNwYWNlKFwiZmVhdHVyZVwiLFxuYy5uYW1lc3BhY2VVUkkpLHRoaXMuZmVhdHVyZVR5cGU9Yy5sb2NhbE5hbWV8fGMubm9kZU5hbWUuc3BsaXQoXCI6XCIpLnBvcCgpLHRoaXMucmVhZENoaWxkTm9kZXMoYSxiKSl9LFNlcnZlcjpmdW5jdGlvbihhLGIpe2lmKCFiLnNlcnZpY2UmJiFiLnZlcnNpb258fGIuc2VydmljZSE9T3BlbkxheWVycy5Gb3JtYXQuQ29udGV4dC5zZXJ2aWNlVHlwZXMuV01TKWIuc2VydmljZT1hLmdldEF0dHJpYnV0ZShcInNlcnZpY2VcIiksYi52ZXJzaW9uPWEuZ2V0QXR0cmlidXRlKFwidmVyc2lvblwiKSx0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYil9LE5hbWU6ZnVuY3Rpb24oYSxiKXtiLm5hbWU9dGhpcy5nZXRDaGlsZFZhbHVlKGEpO3RoaXMucmVhZENoaWxkTm9kZXMoYSxiKX0sVGl0bGU6ZnVuY3Rpb24oYSxiKXtiLnRpdGxlPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYil9LFN0eWxlTGlzdDpmdW5jdGlvbihhLGIpe3RoaXMucmVhZENoaWxkTm9kZXMoYSxiLnN0eWxlcyl9LFxuU3R5bGU6ZnVuY3Rpb24oYSxiKXt2YXIgYz17fTtiLnB1c2goYyk7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpfSxMZWdlbmRVUkw6ZnVuY3Rpb24oYSxiKXt2YXIgYz17fTtiLmxlZ2VuZD1jO3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKX0sT25saW5lUmVzb3VyY2U6ZnVuY3Rpb24oYSxiKXtiLnVybD10aGlzLmdldEF0dHJpYnV0ZU5TKGEsdGhpcy5uYW1lc3BhY2VzLnhsaW5rLFwiaHJlZlwiKTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYil9fSxvd3M6T3BlbkxheWVycy5Gb3JtYXQuT1dTQ29tbW9uLnYxXzBfMC5wcm90b3R5cGUucmVhZGVycy5vd3MsZ21sOk9wZW5MYXllcnMuRm9ybWF0LkdNTC52Mi5wcm90b3R5cGUucmVhZGVycy5nbWwsc2xkOk9wZW5MYXllcnMuRm9ybWF0LlNMRC52MV8wXzAucHJvdG90eXBlLnJlYWRlcnMuc2xkLGZlYXR1cmU6T3BlbkxheWVycy5Gb3JtYXQuR01MLnYyLnByb3RvdHlwZS5yZWFkZXJzLmZlYXR1cmV9LHdyaXRlcnM6e293Yzp7T1dTQ29udGV4dDpmdW5jdGlvbihhKXt2YXIgYj1cbnRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIk9XU0NvbnRleHRcIix7YXR0cmlidXRlczp7dmVyc2lvbjp0aGlzLlZFUlNJT04saWQ6YS5pZHx8T3BlbkxheWVycy5VdGlsLmNyZWF0ZVVuaXF1ZUlEKFwiT3BlbkxheWVyc19PV1NDb250ZXh0X1wiKX19KTt0aGlzLndyaXRlTm9kZShcIkdlbmVyYWxcIixhLGIpO3RoaXMud3JpdGVOb2RlKFwiUmVzb3VyY2VMaXN0XCIsYSxiKTtyZXR1cm4gYn0sR2VuZXJhbDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJHZW5lcmFsXCIpO3RoaXMud3JpdGVOb2RlKFwib3dzOkJvdW5kaW5nQm94XCIsYSxiKTt0aGlzLndyaXRlTm9kZShcIm93czpUaXRsZVwiLGEudGl0bGV8fFwiT3BlbkxheWVycyBPV1NDb250ZXh0XCIsYik7cmV0dXJuIGJ9LFJlc291cmNlTGlzdDpmdW5jdGlvbihhKXtmb3IodmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiUmVzb3VyY2VMaXN0XCIpLGM9MCxkPWEubGF5ZXJzLmxlbmd0aDtjPGQ7YysrKXt2YXIgZT1cbmEubGF5ZXJzW2NdLGY9dGhpcy5kZWNvbXBvc2VOZXN0aW5nUGF0aChlLm1ldGFkYXRhLm5lc3RpbmdQYXRoKTt0aGlzLndyaXRlTm9kZShcIl9MYXllclwiLHtsYXllcjplLHN1YlBhdGhzOmZ9LGIpfXJldHVybiBifSxTZXJ2ZXI6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiU2VydmVyXCIse2F0dHJpYnV0ZXM6e3ZlcnNpb246YS52ZXJzaW9uLHNlcnZpY2U6YS5zZXJ2aWNlfX0pO3RoaXMud3JpdGVOb2RlKFwiT25saW5lUmVzb3VyY2VcIixhLGIpO3JldHVybiBifSxPbmxpbmVSZXNvdXJjZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiT25saW5lUmVzb3VyY2VcIix7YXR0cmlidXRlczp7XCJ4bGluazpocmVmXCI6YS51cmx9fSl9LElubGluZUdlb21ldHJ5OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIklubGluZUdlb21ldHJ5XCIpO3RoaXMud3JpdGVOb2RlKFwiZ21sOmJvdW5kZWRCeVwiLGEuZ2V0RGF0YUV4dGVudCgpLFxuYik7Zm9yKHZhciBjPTAsZD1hLmZlYXR1cmVzLmxlbmd0aDtjPGQ7YysrKXRoaXMud3JpdGVOb2RlKFwiZ21sOmZlYXR1cmVNZW1iZXJcIixhLmZlYXR1cmVzW2NdLGIpO3JldHVybiBifSxTdHlsZUxpc3Q6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIlN0eWxlTGlzdFwiKSxjPTAsZD1hLmxlbmd0aDtjPGQ7YysrKXRoaXMud3JpdGVOb2RlKFwiU3R5bGVcIixhW2NdLGIpO3JldHVybiBifSxTdHlsZTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJTdHlsZVwiKTt0aGlzLndyaXRlTm9kZShcIk5hbWVcIixhLGIpO3RoaXMud3JpdGVOb2RlKFwiVGl0bGVcIixhLGIpO2EubGVnZW5kJiZ0aGlzLndyaXRlTm9kZShcIkxlZ2VuZFVSTFwiLGEsYik7cmV0dXJuIGJ9LE5hbWU6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIk5hbWVcIix7dmFsdWU6YS5uYW1lfSl9LFRpdGxlOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJUaXRsZVwiLFxue3ZhbHVlOmEudGl0bGV9KX0sTGVnZW5kVVJMOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIkxlZ2VuZFVSTFwiKTt0aGlzLndyaXRlTm9kZShcIk9ubGluZVJlc291cmNlXCIsYS5sZWdlbmQsYik7cmV0dXJuIGJ9LF9XTVM6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiTGF5ZXJcIix7YXR0cmlidXRlczp7bmFtZTphLnBhcmFtcy5MQVlFUlMscXVlcnlhYmxlOmEucXVlcnlhYmxlP1wiMVwiOlwiMFwiLGhpZGRlbjphLnZpc2liaWxpdHk/XCIwXCI6XCIxXCIsb3BhY2l0eTphLmhhc093blByb3BlcnR5KFwib3BhY2l0eVwiKT9hLm9wYWNpdHk6bnVsbH19KTt0aGlzLndyaXRlTm9kZShcIm93czpUaXRsZVwiLGEubmFtZSxiKTt0aGlzLndyaXRlTm9kZShcIm93czpPdXRwdXRGb3JtYXRcIixhLnBhcmFtcy5GT1JNQVQsYik7dGhpcy53cml0ZU5vZGUoXCJTZXJ2ZXJcIix7c2VydmljZTpPcGVuTGF5ZXJzLkZvcm1hdC5Db250ZXh0LnNlcnZpY2VUeXBlcy5XTVMsXG52ZXJzaW9uOmEucGFyYW1zLlZFUlNJT04sdXJsOmEudXJsfSxiKTthLm1ldGFkYXRhLnN0eWxlcyYmMDxhLm1ldGFkYXRhLnN0eWxlcy5sZW5ndGgmJnRoaXMud3JpdGVOb2RlKFwiU3R5bGVMaXN0XCIsYS5tZXRhZGF0YS5zdHlsZXMsYik7cmV0dXJuIGJ9LF9MYXllcjpmdW5jdGlvbihhKXt2YXIgYixjLGQ7Yj1hLmxheWVyO2M9YS5zdWJQYXRocztkPW51bGw7MDxjLmxlbmd0aD8oYj1jWzBdLmpvaW4oXCIvXCIpLGM9Yi5sYXN0SW5kZXhPZihcIi9cIiksZD10aGlzLm5lc3RpbmdMYXllckxvb2t1cFtiXSxjPTA8Yz9iLnN1YnN0cmluZyhjKzEsYi5sZW5ndGgpOmIsZHx8KGQ9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiTGF5ZXJcIiksdGhpcy53cml0ZU5vZGUoXCJvd3M6VGl0bGVcIixjLGQpLHRoaXMubmVzdGluZ0xheWVyTG9va3VwW2JdPWQpLGEuc3ViUGF0aHMuc2hpZnQoKSx0aGlzLndyaXRlTm9kZShcIl9MYXllclwiLGEsZCkpOihiIGluc3RhbmNlb2YgT3BlbkxheWVycy5MYXllci5XTVM/XG5kPXRoaXMud3JpdGVOb2RlKFwiX1dNU1wiLGIpOmIgaW5zdGFuY2VvZiBPcGVuTGF5ZXJzLkxheWVyLlZlY3RvciYmKGIucHJvdG9jb2wgaW5zdGFuY2VvZiBPcGVuTGF5ZXJzLlByb3RvY29sLldGUy52MT9kPXRoaXMud3JpdGVOb2RlKFwiX1dGU1wiLGIpOmIucHJvdG9jb2wgaW5zdGFuY2VvZiBPcGVuTGF5ZXJzLlByb3RvY29sLkhUVFA/Yi5wcm90b2NvbC5mb3JtYXQgaW5zdGFuY2VvZiBPcGVuTGF5ZXJzLkZvcm1hdC5HTUw/KGIucHJvdG9jb2wuZm9ybWF0LnZlcnNpb249XCIyLjEuMlwiLGQ9dGhpcy53cml0ZU5vZGUoXCJfR01MXCIsYikpOmIucHJvdG9jb2wuZm9ybWF0IGluc3RhbmNlb2YgT3BlbkxheWVycy5Gb3JtYXQuS01MJiYoYi5wcm90b2NvbC5mb3JtYXQudmVyc2lvbj1cIjIuMlwiLGQ9dGhpcy53cml0ZU5vZGUoXCJfS01MXCIsYikpOih0aGlzLnNldE5hbWVzcGFjZShcImZlYXR1cmVcIix0aGlzLmZlYXR1cmVOUyksZD10aGlzLndyaXRlTm9kZShcIl9JbmxpbmVHZW9tZXRyeVwiLGIpKSksXG5iLm9wdGlvbnMubWF4U2NhbGUmJnRoaXMud3JpdGVOb2RlKFwic2xkOk1pblNjYWxlRGVub21pbmF0b3JcIixiLm9wdGlvbnMubWF4U2NhbGUsZCksYi5vcHRpb25zLm1pblNjYWxlJiZ0aGlzLndyaXRlTm9kZShcInNsZDpNYXhTY2FsZURlbm9taW5hdG9yXCIsYi5vcHRpb25zLm1pblNjYWxlLGQpLHRoaXMubmVzdGluZ0xheWVyTG9va3VwW2IubmFtZV09ZCk7cmV0dXJuIGR9LF9XRlM6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiTGF5ZXJcIix7YXR0cmlidXRlczp7bmFtZTphLnByb3RvY29sLmZlYXR1cmVQcmVmaXgrXCI6XCIrYS5wcm90b2NvbC5mZWF0dXJlVHlwZSxoaWRkZW46YS52aXNpYmlsaXR5P1wiMFwiOlwiMVwifX0pO3RoaXMud3JpdGVOb2RlKFwib3dzOlRpdGxlXCIsYS5uYW1lLGIpO3RoaXMud3JpdGVOb2RlKFwiU2VydmVyXCIse3NlcnZpY2U6T3BlbkxheWVycy5Gb3JtYXQuQ29udGV4dC5zZXJ2aWNlVHlwZXMuV0ZTLHZlcnNpb246YS5wcm90b2NvbC52ZXJzaW9uLFxudXJsOmEucHJvdG9jb2wudXJsfSxiKTtyZXR1cm4gYn0sX0lubGluZUdlb21ldHJ5OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIkxheWVyXCIse2F0dHJpYnV0ZXM6e25hbWU6dGhpcy5mZWF0dXJlVHlwZSxoaWRkZW46YS52aXNpYmlsaXR5P1wiMFwiOlwiMVwifX0pO3RoaXMud3JpdGVOb2RlKFwib3dzOlRpdGxlXCIsYS5uYW1lLGIpO3RoaXMud3JpdGVOb2RlKFwiSW5saW5lR2VvbWV0cnlcIixhLGIpO3JldHVybiBifSxfR01MOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIkxheWVyXCIpO3RoaXMud3JpdGVOb2RlKFwib3dzOlRpdGxlXCIsYS5uYW1lLGIpO3RoaXMud3JpdGVOb2RlKFwiU2VydmVyXCIse3NlcnZpY2U6T3BlbkxheWVycy5Gb3JtYXQuQ29udGV4dC5zZXJ2aWNlVHlwZXMuR01MLHVybDphLnByb3RvY29sLnVybCx2ZXJzaW9uOmEucHJvdG9jb2wuZm9ybWF0LnZlcnNpb259LGIpO3JldHVybiBifSxfS01MOmZ1bmN0aW9uKGEpe3ZhciBiPVxudGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiTGF5ZXJcIik7dGhpcy53cml0ZU5vZGUoXCJvd3M6VGl0bGVcIixhLm5hbWUsYik7dGhpcy53cml0ZU5vZGUoXCJTZXJ2ZXJcIix7c2VydmljZTpPcGVuTGF5ZXJzLkZvcm1hdC5Db250ZXh0LnNlcnZpY2VUeXBlcy5LTUwsdmVyc2lvbjphLnByb3RvY29sLmZvcm1hdC52ZXJzaW9uLHVybDphLnByb3RvY29sLnVybH0sYik7cmV0dXJuIGJ9fSxnbWw6T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoe2JvdW5kZWRCeTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJnbWw6Ym91bmRlZEJ5XCIpO3RoaXMud3JpdGVOb2RlKFwiZ21sOkJveFwiLGEsYik7cmV0dXJuIGJ9fSxPcGVuTGF5ZXJzLkZvcm1hdC5HTUwudjIucHJvdG90eXBlLndyaXRlcnMuZ21sKSxvd3M6T3BlbkxheWVycy5Gb3JtYXQuT1dTQ29tbW9uLnYxXzBfMC5wcm90b3R5cGUud3JpdGVycy5vd3Msc2xkOk9wZW5MYXllcnMuRm9ybWF0LlNMRC52MV8wXzAucHJvdG90eXBlLndyaXRlcnMuc2xkLFxuZmVhdHVyZTpPcGVuTGF5ZXJzLkZvcm1hdC5HTUwudjIucHJvdG90eXBlLndyaXRlcnMuZmVhdHVyZX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuRm9ybWF0Lk9XU0NvbnRleHQudjBfM18xXCJ9KTtPcGVuTGF5ZXJzLkNvbnRyb2wuU2NhbGVMaW5lPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Db250cm9sLHttYXhXaWR0aDoxMDAsdG9wT3V0VW5pdHM6XCJrbVwiLHRvcEluVW5pdHM6XCJtXCIsYm90dG9tT3V0VW5pdHM6XCJtaVwiLGJvdHRvbUluVW5pdHM6XCJmdFwiLGVUb3A6bnVsbCxlQm90dG9tOm51bGwsZ2VvZGVzaWM6ITEsZHJhdzpmdW5jdGlvbigpe09wZW5MYXllcnMuQ29udHJvbC5wcm90b3R5cGUuZHJhdy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5lVG9wfHwodGhpcy5lVG9wPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksdGhpcy5lVG9wLmNsYXNzTmFtZT10aGlzLmRpc3BsYXlDbGFzcytcIlRvcFwiLHRoaXMuZGl2LmFwcGVuZENoaWxkKHRoaXMuZVRvcCksdGhpcy5lVG9wLnN0eWxlLnZpc2liaWxpdHk9XCJcIj09dGhpcy50b3BPdXRVbml0c3x8XCJcIj09dGhpcy50b3BJblVuaXRzP1wiaGlkZGVuXCI6XCJ2aXNpYmxlXCIsdGhpcy5lQm90dG9tPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksXG50aGlzLmVCb3R0b20uY2xhc3NOYW1lPXRoaXMuZGlzcGxheUNsYXNzK1wiQm90dG9tXCIsdGhpcy5kaXYuYXBwZW5kQ2hpbGQodGhpcy5lQm90dG9tKSx0aGlzLmVCb3R0b20uc3R5bGUudmlzaWJpbGl0eT1cIlwiPT10aGlzLmJvdHRvbU91dFVuaXRzfHxcIlwiPT10aGlzLmJvdHRvbUluVW5pdHM/XCJoaWRkZW5cIjpcInZpc2libGVcIik7dGhpcy5tYXAuZXZlbnRzLnJlZ2lzdGVyKFwibW92ZWVuZFwiLHRoaXMsdGhpcy51cGRhdGUpO3RoaXMudXBkYXRlKCk7cmV0dXJuIHRoaXMuZGl2fSxnZXRCYXJMZW46ZnVuY3Rpb24oYSl7dmFyIGI9cGFyc2VJbnQoTWF0aC5sb2coYSkvTWF0aC5sb2coMTApKSxiPU1hdGgucG93KDEwLGIpLGE9cGFyc2VJbnQoYS9iKTtyZXR1cm4oNTxhPzU6MjxhPzI6MSkqYn0sdXBkYXRlOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tYXAuZ2V0UmVzb2x1dGlvbigpO2lmKGEpe3ZhciBiPXRoaXMubWFwLmdldFVuaXRzKCksYz1PcGVuTGF5ZXJzLklOQ0hFU19QRVJfVU5JVCxkPXRoaXMubWF4V2lkdGgqXG5hKmNbYl0sZT0xOyEwPT09dGhpcy5nZW9kZXNpYyYmKGU9KHRoaXMubWFwLmdldEdlb2Rlc2ljUGl4ZWxTaXplKCkud3x8MS4wRS02KSp0aGlzLm1heFdpZHRoLyhkL2Mua20pLGQqPWUpO3ZhciBmLGc7MUU1PGQ/KGY9dGhpcy50b3BPdXRVbml0cyxnPXRoaXMuYm90dG9tT3V0VW5pdHMpOihmPXRoaXMudG9wSW5Vbml0cyxnPXRoaXMuYm90dG9tSW5Vbml0cyk7dmFyIGg9ZC9jW2ZdLGk9ZC9jW2ddLGQ9dGhpcy5nZXRCYXJMZW4oaCksaj10aGlzLmdldEJhckxlbihpKSxoPWQvY1tiXSpjW2ZdLGk9ai9jW2JdKmNbZ10sYj1oL2EvZSxhPWkvYS9lO1widmlzaWJsZVwiPT10aGlzLmVCb3R0b20uc3R5bGUudmlzaWJpbGl0eSYmKHRoaXMuZUJvdHRvbS5zdHlsZS53aWR0aD1NYXRoLnJvdW5kKGEpK1wicHhcIix0aGlzLmVCb3R0b20uaW5uZXJIVE1MPWorXCIgXCIrZyk7XCJ2aXNpYmxlXCI9PXRoaXMuZVRvcC5zdHlsZS52aXNpYmlsaXR5JiYodGhpcy5lVG9wLnN0eWxlLndpZHRoPU1hdGgucm91bmQoYikrXG5cInB4XCIsdGhpcy5lVG9wLmlubmVySFRNTD1kK1wiIFwiK2YpfX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuQ29udHJvbC5TY2FsZUxpbmVcIn0pO09wZW5MYXllcnMuSWNvbj1PcGVuTGF5ZXJzLkNsYXNzKHt1cmw6bnVsbCxzaXplOm51bGwsb2Zmc2V0Om51bGwsY2FsY3VsYXRlT2Zmc2V0Om51bGwsaW1hZ2VEaXY6bnVsbCxweDpudWxsLGluaXRpYWxpemU6ZnVuY3Rpb24oYSxiLGMsZCl7dGhpcy51cmw9YTt0aGlzLnNpemU9Ynx8e3c6MjAsaDoyMH07dGhpcy5vZmZzZXQ9Y3x8e3g6LSh0aGlzLnNpemUudy8yKSx5Oi0odGhpcy5zaXplLmgvMil9O3RoaXMuY2FsY3VsYXRlT2Zmc2V0PWQ7YT1PcGVuTGF5ZXJzLlV0aWwuY3JlYXRlVW5pcXVlSUQoXCJPTF9JY29uX1wiKTt0aGlzLmltYWdlRGl2PU9wZW5MYXllcnMuVXRpbC5jcmVhdGVBbHBoYUltYWdlRGl2KGEpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5lcmFzZSgpO09wZW5MYXllcnMuRXZlbnQuc3RvcE9ic2VydmluZ0VsZW1lbnQodGhpcy5pbWFnZURpdi5maXJzdENoaWxkKTt0aGlzLmltYWdlRGl2LmlubmVySFRNTD1cIlwiO3RoaXMuaW1hZ2VEaXY9bnVsbH0sY2xvbmU6ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IE9wZW5MYXllcnMuSWNvbih0aGlzLnVybCxcbnRoaXMuc2l6ZSx0aGlzLm9mZnNldCx0aGlzLmNhbGN1bGF0ZU9mZnNldCl9LHNldFNpemU6ZnVuY3Rpb24oYSl7bnVsbCE9YSYmKHRoaXMuc2l6ZT1hKTt0aGlzLmRyYXcoKX0sc2V0VXJsOmZ1bmN0aW9uKGEpe251bGwhPWEmJih0aGlzLnVybD1hKTt0aGlzLmRyYXcoKX0sZHJhdzpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLlV0aWwubW9kaWZ5QWxwaGFJbWFnZURpdih0aGlzLmltYWdlRGl2LG51bGwsbnVsbCx0aGlzLnNpemUsdGhpcy51cmwsXCJhYnNvbHV0ZVwiKTt0aGlzLm1vdmVUbyhhKTtyZXR1cm4gdGhpcy5pbWFnZURpdn0sZXJhc2U6ZnVuY3Rpb24oKXtudWxsIT10aGlzLmltYWdlRGl2JiZudWxsIT10aGlzLmltYWdlRGl2LnBhcmVudE5vZGUmJk9wZW5MYXllcnMuRWxlbWVudC5yZW1vdmUodGhpcy5pbWFnZURpdil9LHNldE9wYWNpdHk6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5VdGlsLm1vZGlmeUFscGhhSW1hZ2VEaXYodGhpcy5pbWFnZURpdixudWxsLG51bGwsbnVsbCxudWxsLFxubnVsbCxudWxsLG51bGwsYSl9LG1vdmVUbzpmdW5jdGlvbihhKXtudWxsIT1hJiYodGhpcy5weD1hKTtudWxsIT10aGlzLmltYWdlRGl2JiYobnVsbD09dGhpcy5weD90aGlzLmRpc3BsYXkoITEpOih0aGlzLmNhbGN1bGF0ZU9mZnNldCYmKHRoaXMub2Zmc2V0PXRoaXMuY2FsY3VsYXRlT2Zmc2V0KHRoaXMuc2l6ZSkpLE9wZW5MYXllcnMuVXRpbC5tb2RpZnlBbHBoYUltYWdlRGl2KHRoaXMuaW1hZ2VEaXYsbnVsbCx7eDp0aGlzLnB4LngrdGhpcy5vZmZzZXQueCx5OnRoaXMucHgueSt0aGlzLm9mZnNldC55fSkpKX0sZGlzcGxheTpmdW5jdGlvbihhKXt0aGlzLmltYWdlRGl2LnN0eWxlLmRpc3BsYXk9YT9cIlwiOlwibm9uZVwifSxpc0RyYXduOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW1hZ2VEaXYmJnRoaXMuaW1hZ2VEaXYucGFyZW50Tm9kZSYmMTEhPXRoaXMuaW1hZ2VEaXYucGFyZW50Tm9kZS5ub2RlVHlwZX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuSWNvblwifSk7T3BlbkxheWVycy5NYXJrZXI9T3BlbkxheWVycy5DbGFzcyh7aWNvbjpudWxsLGxvbmxhdDpudWxsLGV2ZW50czpudWxsLG1hcDpudWxsLGluaXRpYWxpemU6ZnVuY3Rpb24oYSxiKXt0aGlzLmxvbmxhdD1hO3ZhciBjPWI/YjpPcGVuTGF5ZXJzLk1hcmtlci5kZWZhdWx0SWNvbigpO251bGw9PXRoaXMuaWNvbj90aGlzLmljb249YzoodGhpcy5pY29uLnVybD1jLnVybCx0aGlzLmljb24uc2l6ZT1jLnNpemUsdGhpcy5pY29uLm9mZnNldD1jLm9mZnNldCx0aGlzLmljb24uY2FsY3VsYXRlT2Zmc2V0PWMuY2FsY3VsYXRlT2Zmc2V0KTt0aGlzLmV2ZW50cz1uZXcgT3BlbkxheWVycy5FdmVudHModGhpcyx0aGlzLmljb24uaW1hZ2VEaXYpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5lcmFzZSgpO3RoaXMubWFwPW51bGw7dGhpcy5ldmVudHMuZGVzdHJveSgpO3RoaXMuZXZlbnRzPW51bGw7bnVsbCE9dGhpcy5pY29uJiYodGhpcy5pY29uLmRlc3Ryb3koKSx0aGlzLmljb249bnVsbCl9LFxuZHJhdzpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5pY29uLmRyYXcoYSl9LGVyYXNlOmZ1bmN0aW9uKCl7bnVsbCE9dGhpcy5pY29uJiZ0aGlzLmljb24uZXJhc2UoKX0sbW92ZVRvOmZ1bmN0aW9uKGEpe251bGwhPWEmJm51bGwhPXRoaXMuaWNvbiYmdGhpcy5pY29uLm1vdmVUbyhhKTt0aGlzLmxvbmxhdD10aGlzLm1hcC5nZXRMb25MYXRGcm9tTGF5ZXJQeChhKX0saXNEcmF3bjpmdW5jdGlvbigpe3JldHVybiB0aGlzLmljb24mJnRoaXMuaWNvbi5pc0RyYXduKCl9LG9uU2NyZWVuOmZ1bmN0aW9uKCl7dmFyIGE9ITE7dGhpcy5tYXAmJihhPXRoaXMubWFwLmdldEV4dGVudCgpLmNvbnRhaW5zTG9uTGF0KHRoaXMubG9ubGF0KSk7cmV0dXJuIGF9LGluZmxhdGU6ZnVuY3Rpb24oYSl7dGhpcy5pY29uJiZ0aGlzLmljb24uc2V0U2l6ZSh7dzp0aGlzLmljb24uc2l6ZS53KmEsaDp0aGlzLmljb24uc2l6ZS5oKmF9KX0sc2V0T3BhY2l0eTpmdW5jdGlvbihhKXt0aGlzLmljb24uc2V0T3BhY2l0eShhKX0sXG5zZXRVcmw6ZnVuY3Rpb24oYSl7dGhpcy5pY29uLnNldFVybChhKX0sZGlzcGxheTpmdW5jdGlvbihhKXt0aGlzLmljb24uZGlzcGxheShhKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuTWFya2VyXCJ9KTtPcGVuTGF5ZXJzLk1hcmtlci5kZWZhdWx0SWNvbj1mdW5jdGlvbigpe3JldHVybiBuZXcgT3BlbkxheWVycy5JY29uKE9wZW5MYXllcnMuVXRpbC5nZXRJbWFnZUxvY2F0aW9uKFwibWFya2VyLnBuZ1wiKSx7dzoyMSxoOjI1fSx7eDotMTAuNSx5Oi0yNX0pfTtPcGVuTGF5ZXJzLkxheWVyLlRpbGVDYWNoZT1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuTGF5ZXIuR3JpZCx7aXNCYXNlTGF5ZXI6ITAsZm9ybWF0OlwiaW1hZ2UvcG5nXCIsc2VydmVyUmVzb2x1dGlvbnM6bnVsbCxpbml0aWFsaXplOmZ1bmN0aW9uKGEsYixjLGQpe3RoaXMubGF5ZXJuYW1lPWM7T3BlbkxheWVycy5MYXllci5HcmlkLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsW2EsYix7fSxkXSk7dGhpcy5leHRlbnNpb249dGhpcy5mb3JtYXQuc3BsaXQoXCIvXCIpWzFdLnRvTG93ZXJDYXNlKCk7dGhpcy5leHRlbnNpb249XCJqcGdcIj09dGhpcy5leHRlbnNpb24/XCJqcGVnXCI6dGhpcy5leHRlbnNpb259LGNsb25lOmZ1bmN0aW9uKGEpe251bGw9PWEmJihhPW5ldyBPcGVuTGF5ZXJzLkxheWVyLlRpbGVDYWNoZSh0aGlzLm5hbWUsdGhpcy51cmwsdGhpcy5sYXllcm5hbWUsdGhpcy5nZXRPcHRpb25zKCkpKTtyZXR1cm4gYT1PcGVuTGF5ZXJzLkxheWVyLkdyaWQucHJvdG90eXBlLmNsb25lLmFwcGx5KHRoaXMsXG5bYV0pfSxnZXRVUkw6ZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYihhLGIpe2Zvcih2YXIgYT1cIlwiK2EsYz1bXSxkPTA7ZDxiOysrZCljLnB1c2goXCIwXCIpO3JldHVybiBjLmpvaW4oXCJcIikuc3Vic3RyaW5nKDAsYi1hLmxlbmd0aCkrYX12YXIgYz10aGlzLmdldFNlcnZlclJlc29sdXRpb24oKSxkPXRoaXMubWF4RXh0ZW50LGU9dGhpcy50aWxlU2l6ZSxmPU1hdGgucm91bmQoKGEubGVmdC1kLmxlZnQpLyhjKmUudykpLGE9TWF0aC5yb3VuZCgoYS5ib3R0b20tZC5ib3R0b20pLyhjKmUuaCkpLGM9bnVsbCE9dGhpcy5zZXJ2ZXJSZXNvbHV0aW9ucz9PcGVuTGF5ZXJzLlV0aWwuaW5kZXhPZih0aGlzLnNlcnZlclJlc29sdXRpb25zLGMpOnRoaXMubWFwLmdldFpvb20oKSxmPVt0aGlzLmxheWVybmFtZSxiKGMsMiksYihwYXJzZUludChmLzFFNiksMyksYihwYXJzZUludChmLzFFMyklMUUzLDMpLGIocGFyc2VJbnQoZiklMUUzLDMpLGIocGFyc2VJbnQoYS8xRTYpLDMpLGIocGFyc2VJbnQoYS9cbjFFMyklMUUzLDMpLGIocGFyc2VJbnQoYSklMUUzLDMpK1wiLlwiK3RoaXMuZXh0ZW5zaW9uXS5qb2luKFwiL1wiKSxjPXRoaXMudXJsO09wZW5MYXllcnMuVXRpbC5pc0FycmF5KGMpJiYoYz10aGlzLnNlbGVjdFVybChmLGMpKTtjPVwiL1wiPT1jLmNoYXJBdChjLmxlbmd0aC0xKT9jOmMrXCIvXCI7cmV0dXJuIGMrZn0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuTGF5ZXIuVGlsZUNhY2hlXCJ9KTtPcGVuTGF5ZXJzLkxheWVyLkthTWFwPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5MYXllci5HcmlkLHtpc0Jhc2VMYXllcjohMCxERUZBVUxUX1BBUkFNUzp7aTpcImpwZWdcIixtYXA6XCJcIn0saW5pdGlhbGl6ZTpmdW5jdGlvbihhLGIsYyxkKXtPcGVuTGF5ZXJzLkxheWVyLkdyaWQucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMucGFyYW1zPU9wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKHRoaXMucGFyYW1zLHRoaXMuREVGQVVMVF9QQVJBTVMpfSxnZXRVUkw6ZnVuY3Rpb24oYSl7dmFyIGE9dGhpcy5hZGp1c3RCb3VuZHMoYSksYj10aGlzLm1hcC5nZXRSZXNvbHV0aW9uKCksYz1NYXRoLnJvdW5kKDFFNCp0aGlzLm1hcC5nZXRTY2FsZSgpKS8xRTQsZD1NYXRoLnJvdW5kKGEubGVmdC9iKTtyZXR1cm4gdGhpcy5nZXRGdWxsUmVxdWVzdFN0cmluZyh7dDotTWF0aC5yb3VuZChhLnRvcC9iKSxsOmQsczpjfSl9LGNhbGN1bGF0ZUdyaWRMYXlvdXQ6ZnVuY3Rpb24oYSxcbmIsYyl7dmFyIGI9Yyp0aGlzLnRpbGVTaXplLncsYz1jKnRoaXMudGlsZVNpemUuaCxkPWEubGVmdCxlPU1hdGguZmxvb3IoZC9iKS10aGlzLmJ1ZmZlcixkPS0oZC9iLWUpKnRoaXMudGlsZVNpemUudyxlPWUqYixhPWEudG9wLGY9TWF0aC5jZWlsKGEvYykrdGhpcy5idWZmZXI7cmV0dXJue3RpbGVsb246Yix0aWxlbGF0OmMsdGlsZW9mZnNldGxvbjplLHRpbGVvZmZzZXRsYXQ6ZipjLHRpbGVvZmZzZXR4OmQsdGlsZW9mZnNldHk6LShmLWEvYysxKSp0aGlzLnRpbGVTaXplLmh9fSxjbG9uZTpmdW5jdGlvbihhKXtudWxsPT1hJiYoYT1uZXcgT3BlbkxheWVycy5MYXllci5LYU1hcCh0aGlzLm5hbWUsdGhpcy51cmwsdGhpcy5wYXJhbXMsdGhpcy5nZXRPcHRpb25zKCkpKTthPU9wZW5MYXllcnMuTGF5ZXIuR3JpZC5wcm90b3R5cGUuY2xvbmUuYXBwbHkodGhpcyxbYV0pO251bGwhPXRoaXMudGlsZVNpemUmJihhLnRpbGVTaXplPXRoaXMudGlsZVNpemUuY2xvbmUoKSk7YS5ncmlkPVxuW107cmV0dXJuIGF9LGdldFRpbGVCb3VuZHM6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5nZXRSZXNvbHV0aW9uKCksYz1iKnRoaXMudGlsZVNpemUudyxiPWIqdGhpcy50aWxlU2l6ZS5oLGQ9dGhpcy5nZXRMb25MYXRGcm9tVmlld1BvcnRQeChhKSxhPWMqTWF0aC5mbG9vcihkLmxvbi9jKSxkPWIqTWF0aC5mbG9vcihkLmxhdC9iKTtyZXR1cm4gbmV3IE9wZW5MYXllcnMuQm91bmRzKGEsZCxhK2MsZCtiKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuTGF5ZXIuS2FNYXBcIn0pO09wZW5MYXllcnMuQ29udHJvbC5UcmFuc2Zvcm1GZWF0dXJlPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Db250cm9sLHtnZW9tZXRyeVR5cGVzOm51bGwsbGF5ZXI6bnVsbCxwcmVzZXJ2ZUFzcGVjdFJhdGlvOiExLHJvdGF0ZTohMCxmZWF0dXJlOm51bGwscmVuZGVySW50ZW50OlwidGVtcG9yYXJ5XCIscm90YXRpb25IYW5kbGVTeW1ib2xpemVyOm51bGwsYm94Om51bGwsY2VudGVyOm51bGwsc2NhbGU6MSxyYXRpbzoxLHJvdGF0aW9uOjAsaGFuZGxlczpudWxsLHJvdGF0aW9uSGFuZGxlczpudWxsLGRyYWdDb250cm9sOm51bGwsaXJyZWd1bGFyOiExLGluaXRpYWxpemU6ZnVuY3Rpb24oYSxiKXtPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbYl0pO3RoaXMubGF5ZXI9YTt0aGlzLnJvdGF0aW9uSGFuZGxlU3ltYm9saXplcnx8KHRoaXMucm90YXRpb25IYW5kbGVTeW1ib2xpemVyPXtzdHJva2U6ITEscG9pbnRSYWRpdXM6MTAsZmlsbE9wYWNpdHk6MCxcbmN1cnNvcjpcInBvaW50ZXJcIn0pO3RoaXMuY3JlYXRlQm94KCk7dGhpcy5jcmVhdGVDb250cm9sKCl9LGFjdGl2YXRlOmZ1bmN0aW9uKCl7dmFyIGE9ITE7T3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5hY3RpdmF0ZS5hcHBseSh0aGlzLGFyZ3VtZW50cykmJih0aGlzLmRyYWdDb250cm9sLmFjdGl2YXRlKCksdGhpcy5sYXllci5hZGRGZWF0dXJlcyhbdGhpcy5ib3hdKSx0aGlzLnJvdGF0ZSYmdGhpcy5sYXllci5hZGRGZWF0dXJlcyh0aGlzLnJvdGF0aW9uSGFuZGxlcyksdGhpcy5sYXllci5hZGRGZWF0dXJlcyh0aGlzLmhhbmRsZXMpLGE9ITApO3JldHVybiBhfSxkZWFjdGl2YXRlOmZ1bmN0aW9uKCl7dmFyIGE9ITE7T3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5kZWFjdGl2YXRlLmFwcGx5KHRoaXMsYXJndW1lbnRzKSYmKHRoaXMubGF5ZXIucmVtb3ZlRmVhdHVyZXModGhpcy5oYW5kbGVzKSx0aGlzLnJvdGF0ZSYmdGhpcy5sYXllci5yZW1vdmVGZWF0dXJlcyh0aGlzLnJvdGF0aW9uSGFuZGxlcyksXG50aGlzLmxheWVyLnJlbW92ZUZlYXR1cmVzKFt0aGlzLmJveF0pLHRoaXMuZHJhZ0NvbnRyb2wuZGVhY3RpdmF0ZSgpLGE9ITApO3JldHVybiBhfSxzZXRNYXA6ZnVuY3Rpb24oYSl7dGhpcy5kcmFnQ29udHJvbC5zZXRNYXAoYSk7T3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5zZXRNYXAuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxzZXRGZWF0dXJlOmZ1bmN0aW9uKGEsYil7dmFyIGI9T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoYix7cm90YXRpb246MCxzY2FsZToxLHJhdGlvOjF9KSxjPXRoaXMucm90YXRpb24sZD10aGlzLmNlbnRlcjtPcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHRoaXMsYik7aWYoITEhPT10aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJiZWZvcmVzZXRmZWF0dXJlXCIse2ZlYXR1cmU6YX0pKXt0aGlzLmZlYXR1cmU9YTt0aGlzLmFjdGl2YXRlKCk7dGhpcy5fc2V0ZmVhdHVyZT0hMDt2YXIgZT10aGlzLmZlYXR1cmUuZ2VvbWV0cnkuZ2V0Qm91bmRzKCk7dGhpcy5ib3gubW92ZShlLmdldENlbnRlckxvbkxhdCgpKTtcbnRoaXMuYm94Lmdlb21ldHJ5LnJvdGF0ZSgtYyxkKTt0aGlzLl9hbmdsZT0wO3RoaXMucm90YXRpb24/KGM9YS5nZW9tZXRyeS5jbG9uZSgpLGMucm90YXRlKC10aGlzLnJvdGF0aW9uLHRoaXMuY2VudGVyKSxjPW5ldyBPcGVuTGF5ZXJzLkZlYXR1cmUuVmVjdG9yKGMuZ2V0Qm91bmRzKCkudG9HZW9tZXRyeSgpKSxjLmdlb21ldHJ5LnJvdGF0ZSh0aGlzLnJvdGF0aW9uLHRoaXMuY2VudGVyKSx0aGlzLmJveC5nZW9tZXRyeS5yb3RhdGUodGhpcy5yb3RhdGlvbix0aGlzLmNlbnRlciksdGhpcy5ib3gubW92ZShjLmdlb21ldHJ5LmdldEJvdW5kcygpLmdldENlbnRlckxvbkxhdCgpKSxjPWMuZ2VvbWV0cnkuY29tcG9uZW50c1swXS5jb21wb25lbnRzWzBdLmdldEJvdW5kcygpLmdldENlbnRlckxvbkxhdCgpKTpjPW5ldyBPcGVuTGF5ZXJzLkxvbkxhdChlLmxlZnQsZS5ib3R0b20pO3RoaXMuaGFuZGxlc1swXS5tb3ZlKGMpO2RlbGV0ZSB0aGlzLl9zZXRmZWF0dXJlO3RoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcInNldGZlYXR1cmVcIixcbntmZWF0dXJlOmF9KX19LHVuc2V0RmVhdHVyZTpmdW5jdGlvbigpe3RoaXMuYWN0aXZlP3RoaXMuZGVhY3RpdmF0ZSgpOih0aGlzLmZlYXR1cmU9bnVsbCx0aGlzLnJvdGF0aW9uPTAsdGhpcy5yYXRpbz10aGlzLnNjYWxlPTEpfSxjcmVhdGVCb3g6ZnVuY3Rpb24oKXt2YXIgYT10aGlzO3RoaXMuY2VudGVyPW5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KDAsMCk7dGhpcy5ib3g9bmV3IE9wZW5MYXllcnMuRmVhdHVyZS5WZWN0b3IobmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuTGluZVN0cmluZyhbbmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQoLTEsLTEpLG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KDAsLTEpLG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KDEsLTEpLG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KDEsMCksbmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQoMSwxKSxuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludCgwLDEpLG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KC0xLFxuMSksbmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQoLTEsMCksbmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQoLTEsLTEpXSksbnVsbCxcInN0cmluZ1wiPT10eXBlb2YgdGhpcy5yZW5kZXJJbnRlbnQ/bnVsbDp0aGlzLnJlbmRlckludGVudCk7dGhpcy5ib3guZ2VvbWV0cnkubW92ZT1mdW5jdGlvbihiLGMpe2EuX21vdmluZz0hMDtPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVTdHJpbmcucHJvdG90eXBlLm1vdmUuYXBwbHkodGhpcyxhcmd1bWVudHMpO2EuY2VudGVyLm1vdmUoYixjKTtkZWxldGUgYS5fbW92aW5nfTtmb3IodmFyIGI9ZnVuY3Rpb24oYSxiKXtPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50LnByb3RvdHlwZS5tb3ZlLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLl9yb3RhdGlvbkhhbmRsZSYmdGhpcy5fcm90YXRpb25IYW5kbGUuZ2VvbWV0cnkubW92ZShhLGIpO3RoaXMuX2hhbmRsZS5nZW9tZXRyeS5tb3ZlKGEsYil9LGM9ZnVuY3Rpb24oYSxiLGMpe09wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQucHJvdG90eXBlLnJlc2l6ZS5hcHBseSh0aGlzLFxuYXJndW1lbnRzKTt0aGlzLl9yb3RhdGlvbkhhbmRsZSYmdGhpcy5fcm90YXRpb25IYW5kbGUuZ2VvbWV0cnkucmVzaXplKGEsYixjKTt0aGlzLl9oYW5kbGUuZ2VvbWV0cnkucmVzaXplKGEsYixjKX0sZD1mdW5jdGlvbihhLGIpe09wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQucHJvdG90eXBlLnJvdGF0ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5fcm90YXRpb25IYW5kbGUmJnRoaXMuX3JvdGF0aW9uSGFuZGxlLmdlb21ldHJ5LnJvdGF0ZShhLGIpO3RoaXMuX2hhbmRsZS5nZW9tZXRyeS5yb3RhdGUoYSxiKX0sZT1mdW5jdGlvbihiLGMpe3ZhciBkPXRoaXMueCxlPXRoaXMueTtPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50LnByb3RvdHlwZS5tb3ZlLmNhbGwodGhpcyxiLGMpO2lmKCFhLl9tb3Zpbmcpe3ZhciBmPWEuZHJhZ0NvbnRyb2wuaGFuZGxlcnMuZHJhZy5ldnQsZz0hKCFhLl9zZXRmZWF0dXJlJiZhLnByZXNlcnZlQXNwZWN0UmF0aW8pJiYhKGYmJmYuc2hpZnRLZXkpLFxuaD1uZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChkLGUpLGY9YS5jZW50ZXI7dGhpcy5yb3RhdGUoLWEucm90YXRpb24sZik7aC5yb3RhdGUoLWEucm90YXRpb24sZik7dmFyIGk9dGhpcy54LWYueCxqPXRoaXMueS1mLnksaz1pLSh0aGlzLngtaC54KSxsPWotKHRoaXMueS1oLnkpO2EuaXJyZWd1bGFyJiYhYS5fc2V0ZmVhdHVyZSYmKGktPSh0aGlzLngtaC54KS8yLGotPSh0aGlzLnktaC55KS8yKTt0aGlzLng9ZDt0aGlzLnk9ZTtoPTE7Zz8oaj0xLjBFLTU+TWF0aC5hYnMobCk/MTpqL2wsaD0oMS4wRS01Pk1hdGguYWJzKGspPzE6aS9rKS9qKTooaz1NYXRoLnNxcnQoayprK2wqbCksaj1NYXRoLnNxcnQoaSppK2oqaikvayk7YS5fbW92aW5nPSEwO2EuYm94Lmdlb21ldHJ5LnJvdGF0ZSgtYS5yb3RhdGlvbixmKTtkZWxldGUgYS5fbW92aW5nO2EuYm94Lmdlb21ldHJ5LnJlc2l6ZShqLGYsaCk7YS5ib3guZ2VvbWV0cnkucm90YXRlKGEucm90YXRpb24sZik7YS50cmFuc2Zvcm1GZWF0dXJlKHtzY2FsZTpqLFxucmF0aW86aH0pO2EuaXJyZWd1bGFyJiYhYS5fc2V0ZmVhdHVyZSYmKGk9Zi5jbG9uZSgpLGkueCs9MS4wRS01Pk1hdGguYWJzKGQtZi54KT8wOnRoaXMueC1kLGkueSs9MS4wRS01Pk1hdGguYWJzKGUtZi55KT8wOnRoaXMueS1lLGEuYm94Lmdlb21ldHJ5Lm1vdmUodGhpcy54LWQsdGhpcy55LWUpLGEudHJhbnNmb3JtRmVhdHVyZSh7Y2VudGVyOml9KSl9fSxmPWZ1bmN0aW9uKGIsYyl7dmFyIGQ9dGhpcy54LGU9dGhpcy55O09wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQucHJvdG90eXBlLm1vdmUuY2FsbCh0aGlzLGIsYyk7aWYoIWEuX21vdmluZyl7dmFyIGY9YS5kcmFnQ29udHJvbC5oYW5kbGVycy5kcmFnLmV2dCxmPWYmJmYuc2hpZnRLZXk/NDU6MSxnPWEuY2VudGVyLGg9dGhpcy54LWcueCxpPXRoaXMueS1nLnk7dGhpcy54PWQ7dGhpcy55PWU7ZD1NYXRoLmF0YW4yKGktYyxoLWIpO2Q9TWF0aC5hdGFuMihpLGgpLWQ7ZCo9MTgwL01hdGguUEk7YS5fYW5nbGU9KGEuX2FuZ2xlK1xuZCklMzYwO2Q9YS5yb3RhdGlvbiVmO2lmKE1hdGguYWJzKGEuX2FuZ2xlKT49Znx8MCE9PWQpZD1NYXRoLnJvdW5kKGEuX2FuZ2xlL2YpKmYtZCxhLl9hbmdsZT0wLGEuYm94Lmdlb21ldHJ5LnJvdGF0ZShkLGcpLGEudHJhbnNmb3JtRmVhdHVyZSh7cm90YXRpb246ZH0pfX0sZz1BcnJheSg4KSxoPUFycmF5KDQpLGksaixrLGw9XCJzdyBzIHNlIGUgbmUgbiBudyB3XCIuc3BsaXQoXCIgXCIpLG09MDs4Pm07KyttKWk9dGhpcy5ib3guZ2VvbWV0cnkuY29tcG9uZW50c1ttXSxqPW5ldyBPcGVuTGF5ZXJzLkZlYXR1cmUuVmVjdG9yKGkuY2xvbmUoKSx7cm9sZTpsW21dK1wiLXJlc2l6ZVwifSxcInN0cmluZ1wiPT10eXBlb2YgdGhpcy5yZW5kZXJJbnRlbnQ/bnVsbDp0aGlzLnJlbmRlckludGVudCksMD09bSUyJiYoaz1uZXcgT3BlbkxheWVycy5GZWF0dXJlLlZlY3RvcihpLmNsb25lKCkse3JvbGU6bFttXStcIi1yb3RhdGVcIn0sXCJzdHJpbmdcIj09dHlwZW9mIHRoaXMucm90YXRpb25IYW5kbGVTeW1ib2xpemVyP1xubnVsbDp0aGlzLnJvdGF0aW9uSGFuZGxlU3ltYm9saXplciksay5nZW9tZXRyeS5tb3ZlPWYsaS5fcm90YXRpb25IYW5kbGU9ayxoW20vMl09ayksaS5tb3ZlPWIsaS5yZXNpemU9YyxpLnJvdGF0ZT1kLGouZ2VvbWV0cnkubW92ZT1lLGkuX2hhbmRsZT1qLGdbbV09ajt0aGlzLnJvdGF0aW9uSGFuZGxlcz1oO3RoaXMuaGFuZGxlcz1nfSxjcmVhdGVDb250cm9sOmZ1bmN0aW9uKCl7dmFyIGE9dGhpczt0aGlzLmRyYWdDb250cm9sPW5ldyBPcGVuTGF5ZXJzLkNvbnRyb2wuRHJhZ0ZlYXR1cmUodGhpcy5sYXllcix7ZG9jdW1lbnREcmFnOiEwLG1vdmVGZWF0dXJlOmZ1bmN0aW9uKGIpe3RoaXMuZmVhdHVyZT09PWEuZmVhdHVyZSYmKHRoaXMuZmVhdHVyZT1hLmJveCk7T3BlbkxheWVycy5Db250cm9sLkRyYWdGZWF0dXJlLnByb3RvdHlwZS5tb3ZlRmVhdHVyZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LG9uRHJhZzpmdW5jdGlvbihiKXtiPT09YS5ib3gmJmEudHJhbnNmb3JtRmVhdHVyZSh7Y2VudGVyOmEuY2VudGVyfSl9LFxub25TdGFydDpmdW5jdGlvbihiKXt2YXIgYz0hYS5nZW9tZXRyeVR5cGVzfHwtMSE9PU9wZW5MYXllcnMuVXRpbC5pbmRleE9mKGEuZ2VvbWV0cnlUeXBlcyxiLmdlb21ldHJ5LkNMQVNTX05BTUUpLGQ9T3BlbkxheWVycy5VdGlsLmluZGV4T2YoYS5oYW5kbGVzLGIpLGQ9ZCtPcGVuTGF5ZXJzLlV0aWwuaW5kZXhPZihhLnJvdGF0aW9uSGFuZGxlcyxiKTtiIT09YS5mZWF0dXJlJiYoYiE9PWEuYm94JiYtMj09ZCYmYykmJmEuc2V0RmVhdHVyZShiKX0sb25Db21wbGV0ZTpmdW5jdGlvbigpe2EuZXZlbnRzLnRyaWdnZXJFdmVudChcInRyYW5zZm9ybWNvbXBsZXRlXCIse2ZlYXR1cmU6YS5mZWF0dXJlfSl9fSl9LGRyYXdIYW5kbGVzOmZ1bmN0aW9uKCl7Zm9yKHZhciBhPXRoaXMubGF5ZXIsYj0wOzg+YjsrK2IpdGhpcy5yb3RhdGUmJjA9PT1iJTImJmEuZHJhd0ZlYXR1cmUodGhpcy5yb3RhdGlvbkhhbmRsZXNbYi8yXSx0aGlzLnJvdGF0aW9uSGFuZGxlU3ltYm9saXplciksYS5kcmF3RmVhdHVyZSh0aGlzLmhhbmRsZXNbYl0sXG50aGlzLnJlbmRlckludGVudCl9LHRyYW5zZm9ybUZlYXR1cmU6ZnVuY3Rpb24oYSl7aWYoIXRoaXMuX3NldGZlYXR1cmUpe3RoaXMuc2NhbGUqPWEuc2NhbGV8fDE7dGhpcy5yYXRpbyo9YS5yYXRpb3x8MTt2YXIgYj10aGlzLnJvdGF0aW9uO3RoaXMucm90YXRpb249KHRoaXMucm90YXRpb24rKGEucm90YXRpb258fDApKSUzNjA7aWYoITEhPT10aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJiZWZvcmV0cmFuc2Zvcm1cIixhKSl7dmFyIGM9dGhpcy5mZWF0dXJlLGQ9Yy5nZW9tZXRyeSxlPXRoaXMuY2VudGVyO2Qucm90YXRlKC1iLGUpO2Euc2NhbGV8fGEucmF0aW8/ZC5yZXNpemUoYS5zY2FsZSxlLGEucmF0aW8pOmEuY2VudGVyJiZjLm1vdmUoYS5jZW50ZXIuZ2V0Qm91bmRzKCkuZ2V0Q2VudGVyTG9uTGF0KCkpO2Qucm90YXRlKHRoaXMucm90YXRpb24sZSk7dGhpcy5sYXllci5kcmF3RmVhdHVyZShjKTtjLnRvU3RhdGUoT3BlbkxheWVycy5TdGF0ZS5VUERBVEUpO3RoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcInRyYW5zZm9ybVwiLFxuYSl9fXRoaXMubGF5ZXIuZHJhd0ZlYXR1cmUodGhpcy5ib3gsdGhpcy5yZW5kZXJJbnRlbnQpO3RoaXMuZHJhd0hhbmRsZXMoKX0sZGVzdHJveTpmdW5jdGlvbigpe2Zvcih2YXIgYSxiPTA7OD5iOysrYilhPXRoaXMuYm94Lmdlb21ldHJ5LmNvbXBvbmVudHNbYl0sYS5faGFuZGxlLmRlc3Ryb3koKSxhLl9oYW5kbGU9bnVsbCxhLl9yb3RhdGlvbkhhbmRsZSYmYS5fcm90YXRpb25IYW5kbGUuZGVzdHJveSgpLGEuX3JvdGF0aW9uSGFuZGxlPW51bGw7dGhpcy5yb3RhdGlvbkhhbmRsZXM9dGhpcy5yb3RhdGlvbkhhbmRsZVN5bWJvbGl6ZXI9dGhpcy5oYW5kbGVzPXRoaXMuZmVhdHVyZT10aGlzLmNlbnRlcj1udWxsO3RoaXMuYm94LmRlc3Ryb3koKTt0aGlzLmxheWVyPXRoaXMuYm94PW51bGw7dGhpcy5kcmFnQ29udHJvbC5kZXN0cm95KCk7dGhpcy5kcmFnQ29udHJvbD1udWxsO09wZW5MYXllcnMuQ29udHJvbC5wcm90b3R5cGUuZGVzdHJveS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LFxuQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuQ29udHJvbC5UcmFuc2Zvcm1GZWF0dXJlXCJ9KTtPcGVuTGF5ZXJzLkhhbmRsZXIuQm94PU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5IYW5kbGVyLHtkcmFnSGFuZGxlcjpudWxsLGJveERpdkNsYXNzTmFtZTpcIm9sSGFuZGxlckJveFpvb21Cb3hcIixib3hPZmZzZXRzOm51bGwsaW5pdGlhbGl6ZTpmdW5jdGlvbihhLGIsYyl7T3BlbkxheWVycy5IYW5kbGVyLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmRyYWdIYW5kbGVyPW5ldyBPcGVuTGF5ZXJzLkhhbmRsZXIuRHJhZyh0aGlzLHtkb3duOnRoaXMuc3RhcnRCb3gsbW92ZTp0aGlzLm1vdmVCb3gsb3V0OnRoaXMucmVtb3ZlQm94LHVwOnRoaXMuZW5kQm94fSx7a2V5TWFzazp0aGlzLmtleU1hc2t9KX0sZGVzdHJveTpmdW5jdGlvbigpe09wZW5MYXllcnMuSGFuZGxlci5wcm90b3R5cGUuZGVzdHJveS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5kcmFnSGFuZGxlciYmKHRoaXMuZHJhZ0hhbmRsZXIuZGVzdHJveSgpLHRoaXMuZHJhZ0hhbmRsZXI9XG5udWxsKX0sc2V0TWFwOmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuSGFuZGxlci5wcm90b3R5cGUuc2V0TWFwLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmRyYWdIYW5kbGVyJiZ0aGlzLmRyYWdIYW5kbGVyLnNldE1hcChhKX0sc3RhcnRCb3g6ZnVuY3Rpb24oKXt0aGlzLmNhbGxiYWNrKFwic3RhcnRcIixbXSk7dGhpcy56b29tQm94PU9wZW5MYXllcnMuVXRpbC5jcmVhdGVEaXYoXCJ6b29tQm94XCIse3g6LTk5OTkseTotOTk5OX0pO3RoaXMuem9vbUJveC5jbGFzc05hbWU9dGhpcy5ib3hEaXZDbGFzc05hbWU7dGhpcy56b29tQm94LnN0eWxlLnpJbmRleD10aGlzLm1hcC5aX0lOREVYX0JBU0UuUG9wdXAtMTt0aGlzLm1hcC52aWV3UG9ydERpdi5hcHBlbmRDaGlsZCh0aGlzLnpvb21Cb3gpO09wZW5MYXllcnMuRWxlbWVudC5hZGRDbGFzcyh0aGlzLm1hcC52aWV3UG9ydERpdixcIm9sRHJhd0JveFwiKX0sbW92ZUJveDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmRyYWdIYW5kbGVyLnN0YXJ0LngsXG5jPXRoaXMuZHJhZ0hhbmRsZXIuc3RhcnQueSxkPU1hdGguYWJzKGItYS54KSxlPU1hdGguYWJzKGMtYS55KSxmPXRoaXMuZ2V0Qm94T2Zmc2V0cygpO3RoaXMuem9vbUJveC5zdHlsZS53aWR0aD1kK2Yud2lkdGgrMStcInB4XCI7dGhpcy56b29tQm94LnN0eWxlLmhlaWdodD1lK2YuaGVpZ2h0KzErXCJweFwiO3RoaXMuem9vbUJveC5zdHlsZS5sZWZ0PShhLng8Yj9iLWQtZi5sZWZ0OmItZi5sZWZ0KStcInB4XCI7dGhpcy56b29tQm94LnN0eWxlLnRvcD0oYS55PGM/Yy1lLWYudG9wOmMtZi50b3ApK1wicHhcIn0sZW5kQm94OmZ1bmN0aW9uKGEpe3ZhciBiO2lmKDU8TWF0aC5hYnModGhpcy5kcmFnSGFuZGxlci5zdGFydC54LWEueCl8fDU8TWF0aC5hYnModGhpcy5kcmFnSGFuZGxlci5zdGFydC55LWEueSkpe3ZhciBjPXRoaXMuZHJhZ0hhbmRsZXIuc3RhcnQ7Yj1NYXRoLm1pbihjLnksYS55KTt2YXIgZD1NYXRoLm1heChjLnksYS55KSxlPU1hdGgubWluKGMueCxhLngpLGE9TWF0aC5tYXgoYy54LFxuYS54KTtiPW5ldyBPcGVuTGF5ZXJzLkJvdW5kcyhlLGQsYSxiKX1lbHNlIGI9dGhpcy5kcmFnSGFuZGxlci5zdGFydC5jbG9uZSgpO3RoaXMucmVtb3ZlQm94KCk7dGhpcy5jYWxsYmFjayhcImRvbmVcIixbYl0pfSxyZW1vdmVCb3g6ZnVuY3Rpb24oKXt0aGlzLm1hcC52aWV3UG9ydERpdi5yZW1vdmVDaGlsZCh0aGlzLnpvb21Cb3gpO3RoaXMuYm94T2Zmc2V0cz10aGlzLnpvb21Cb3g9bnVsbDtPcGVuTGF5ZXJzLkVsZW1lbnQucmVtb3ZlQ2xhc3ModGhpcy5tYXAudmlld1BvcnREaXYsXCJvbERyYXdCb3hcIil9LGFjdGl2YXRlOmZ1bmN0aW9uKCl7cmV0dXJuIE9wZW5MYXllcnMuSGFuZGxlci5wcm90b3R5cGUuYWN0aXZhdGUuYXBwbHkodGhpcyxhcmd1bWVudHMpPyh0aGlzLmRyYWdIYW5kbGVyLmFjdGl2YXRlKCksITApOiExfSxkZWFjdGl2YXRlOmZ1bmN0aW9uKCl7cmV0dXJuIE9wZW5MYXllcnMuSGFuZGxlci5wcm90b3R5cGUuZGVhY3RpdmF0ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk/XG4odGhpcy5kcmFnSGFuZGxlci5kZWFjdGl2YXRlKCkmJnRoaXMuem9vbUJveCYmdGhpcy5yZW1vdmVCb3goKSwhMCk6ITF9LGdldEJveE9mZnNldHM6ZnVuY3Rpb24oKXtpZighdGhpcy5ib3hPZmZzZXRzKXt2YXIgYT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO2Euc3R5bGUucG9zaXRpb249XCJhYnNvbHV0ZVwiO2Euc3R5bGUuYm9yZGVyPVwiMXB4IHNvbGlkIGJsYWNrXCI7YS5zdHlsZS53aWR0aD1cIjNweFwiO2RvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYSk7dmFyIGI9Mz09YS5jbGllbnRXaWR0aDtkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGEpO3ZhciBhPXBhcnNlSW50KE9wZW5MYXllcnMuRWxlbWVudC5nZXRTdHlsZSh0aGlzLnpvb21Cb3gsXCJib3JkZXItbGVmdC13aWR0aFwiKSksYz1wYXJzZUludChPcGVuTGF5ZXJzLkVsZW1lbnQuZ2V0U3R5bGUodGhpcy56b29tQm94LFwiYm9yZGVyLXJpZ2h0LXdpZHRoXCIpKSxkPXBhcnNlSW50KE9wZW5MYXllcnMuRWxlbWVudC5nZXRTdHlsZSh0aGlzLnpvb21Cb3gsXG5cImJvcmRlci10b3Atd2lkdGhcIikpLGU9cGFyc2VJbnQoT3BlbkxheWVycy5FbGVtZW50LmdldFN0eWxlKHRoaXMuem9vbUJveCxcImJvcmRlci1ib3R0b20td2lkdGhcIikpO3RoaXMuYm94T2Zmc2V0cz17bGVmdDphLHJpZ2h0OmMsdG9wOmQsYm90dG9tOmUsd2lkdGg6ITE9PT1iP2ErYzowLGhlaWdodDohMT09PWI/ZCtlOjB9fXJldHVybiB0aGlzLmJveE9mZnNldHN9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkhhbmRsZXIuQm94XCJ9KTtPcGVuTGF5ZXJzLkNvbnRyb2wuWm9vbUJveD1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuQ29udHJvbCx7dHlwZTpPcGVuTGF5ZXJzLkNvbnRyb2wuVFlQRV9UT09MLG91dDohMSxrZXlNYXNrOm51bGwsYWx3YXlzWm9vbTohMSxkcmF3OmZ1bmN0aW9uKCl7dGhpcy5oYW5kbGVyPW5ldyBPcGVuTGF5ZXJzLkhhbmRsZXIuQm94KHRoaXMse2RvbmU6dGhpcy56b29tQm94fSx7a2V5TWFzazp0aGlzLmtleU1hc2t9KX0sem9vbUJveDpmdW5jdGlvbihhKXtpZihhIGluc3RhbmNlb2YgT3BlbkxheWVycy5Cb3VuZHMpe3ZhciBiO2lmKHRoaXMub3V0KXtiPU1hdGguYWJzKGEucmlnaHQtYS5sZWZ0KTt2YXIgYz1NYXRoLmFicyhhLnRvcC1hLmJvdHRvbSk7Yj1NYXRoLm1pbih0aGlzLm1hcC5zaXplLmgvYyx0aGlzLm1hcC5zaXplLncvYik7dmFyIGM9dGhpcy5tYXAuZ2V0RXh0ZW50KCksZD10aGlzLm1hcC5nZXRMb25MYXRGcm9tUGl4ZWwoYS5nZXRDZW50ZXJQaXhlbCgpKSxhPWQubG9uLVxuYy5nZXRXaWR0aCgpLzIqYixlPWQubG9uK2MuZ2V0V2lkdGgoKS8yKmIsZj1kLmxhdC1jLmdldEhlaWdodCgpLzIqYjtiPWQubGF0K2MuZ2V0SGVpZ2h0KCkvMipiO2I9bmV3IE9wZW5MYXllcnMuQm91bmRzKGEsZixlLGIpfWVsc2UgYj10aGlzLm1hcC5nZXRMb25MYXRGcm9tUGl4ZWwoe3g6YS5sZWZ0LHk6YS5ib3R0b219KSxjPXRoaXMubWFwLmdldExvbkxhdEZyb21QaXhlbCh7eDphLnJpZ2h0LHk6YS50b3B9KSxiPW5ldyBPcGVuTGF5ZXJzLkJvdW5kcyhiLmxvbixiLmxhdCxjLmxvbixjLmxhdCk7Yz10aGlzLm1hcC5nZXRab29tKCk7dGhpcy5tYXAuem9vbVRvRXh0ZW50KGIpO2M9PXRoaXMubWFwLmdldFpvb20oKSYmITA9PXRoaXMuYWx3YXlzWm9vbSYmdGhpcy5tYXAuem9vbVRvKGMrKHRoaXMub3V0Py0xOjEpKX1lbHNlIHRoaXMub3V0P3RoaXMubWFwLnNldENlbnRlcih0aGlzLm1hcC5nZXRMb25MYXRGcm9tUGl4ZWwoYSksdGhpcy5tYXAuZ2V0Wm9vbSgpLTEpOnRoaXMubWFwLnNldENlbnRlcih0aGlzLm1hcC5nZXRMb25MYXRGcm9tUGl4ZWwoYSksXG50aGlzLm1hcC5nZXRab29tKCkrMSl9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkNvbnRyb2wuWm9vbUJveFwifSk7T3BlbkxheWVycy5Db250cm9sLkRyYWdQYW49T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkNvbnRyb2wse3R5cGU6T3BlbkxheWVycy5Db250cm9sLlRZUEVfVE9PTCxwYW5uZWQ6ITEsaW50ZXJ2YWw6MSxkb2N1bWVudERyYWc6ITEsa2luZXRpYzpudWxsLGVuYWJsZUtpbmV0aWM6ITEsa2luZXRpY0ludGVydmFsOjEwLGRyYXc6ZnVuY3Rpb24oKXtpZih0aGlzLmVuYWJsZUtpbmV0aWMpe3ZhciBhPXtpbnRlcnZhbDp0aGlzLmtpbmV0aWNJbnRlcnZhbH07XCJvYmplY3RcIj09PXR5cGVvZiB0aGlzLmVuYWJsZUtpbmV0aWMmJihhPU9wZW5MYXllcnMuVXRpbC5leHRlbmQoYSx0aGlzLmVuYWJsZUtpbmV0aWMpKTt0aGlzLmtpbmV0aWM9bmV3IE9wZW5MYXllcnMuS2luZXRpYyhhKX10aGlzLmhhbmRsZXI9bmV3IE9wZW5MYXllcnMuSGFuZGxlci5EcmFnKHRoaXMse21vdmU6dGhpcy5wYW5NYXAsZG9uZTp0aGlzLnBhbk1hcERvbmUsZG93bjp0aGlzLnBhbk1hcFN0YXJ0fSx7aW50ZXJ2YWw6dGhpcy5pbnRlcnZhbCxcbmRvY3VtZW50RHJhZzp0aGlzLmRvY3VtZW50RHJhZ30pfSxwYW5NYXBTdGFydDpmdW5jdGlvbigpe3RoaXMua2luZXRpYyYmdGhpcy5raW5ldGljLmJlZ2luKCl9LHBhbk1hcDpmdW5jdGlvbihhKXt0aGlzLmtpbmV0aWMmJnRoaXMua2luZXRpYy51cGRhdGUoYSk7dGhpcy5wYW5uZWQ9ITA7dGhpcy5tYXAucGFuKHRoaXMuaGFuZGxlci5sYXN0LngtYS54LHRoaXMuaGFuZGxlci5sYXN0LnktYS55LHtkcmFnZ2luZzohMCxhbmltYXRlOiExfSl9LHBhbk1hcERvbmU6ZnVuY3Rpb24oYSl7aWYodGhpcy5wYW5uZWQpe3ZhciBiPW51bGw7dGhpcy5raW5ldGljJiYoYj10aGlzLmtpbmV0aWMuZW5kKGEpKTt0aGlzLm1hcC5wYW4odGhpcy5oYW5kbGVyLmxhc3QueC1hLngsdGhpcy5oYW5kbGVyLmxhc3QueS1hLnkse2RyYWdnaW5nOiEhYixhbmltYXRlOiExfSk7aWYoYil7dmFyIGM9dGhpczt0aGlzLmtpbmV0aWMubW92ZShiLGZ1bmN0aW9uKGEsYixmKXtjLm1hcC5wYW4oYSxiLHtkcmFnZ2luZzohZixcbmFuaW1hdGU6ITF9KX0pfXRoaXMucGFubmVkPSExfX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuQ29udHJvbC5EcmFnUGFuXCJ9KTtPcGVuTGF5ZXJzLkhhbmRsZXIuQ2xpY2s9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkhhbmRsZXIse2RlbGF5OjMwMCxzaW5nbGU6ITAsXCJkb3VibGVcIjohMSxwaXhlbFRvbGVyYW5jZTowLGRibGNsaWNrVG9sZXJhbmNlOjEzLHN0b3BTaW5nbGU6ITEsc3RvcERvdWJsZTohMSx0aW1lcklkOm51bGwsdG91Y2g6ITEsZG93bjpudWxsLGxhc3Q6bnVsbCxmaXJzdDpudWxsLHJpZ2h0Y2xpY2tUaW1lcklkOm51bGwsdG91Y2hzdGFydDpmdW5jdGlvbihhKXt0aGlzLnRvdWNofHwodGhpcy51bnJlZ2lzdGVyTW91c2VMaXN0ZW5lcnMoKSx0aGlzLnRvdWNoPSEwKTt0aGlzLmRvd249dGhpcy5nZXRFdmVudEluZm8oYSk7dGhpcy5sYXN0PXRoaXMuZ2V0RXZlbnRJbmZvKGEpO3JldHVybiEwfSx0b3VjaG1vdmU6ZnVuY3Rpb24oYSl7dGhpcy5sYXN0PXRoaXMuZ2V0RXZlbnRJbmZvKGEpO3JldHVybiEwfSx0b3VjaGVuZDpmdW5jdGlvbihhKXt0aGlzLmRvd24mJihhLnh5PXRoaXMubGFzdC54eSxcbmEubGFzdFRvdWNoZXM9dGhpcy5sYXN0LnRvdWNoZXMsdGhpcy5oYW5kbGVTaW5nbGUoYSksdGhpcy5kb3duPW51bGwpO3JldHVybiEwfSx1bnJlZ2lzdGVyTW91c2VMaXN0ZW5lcnM6ZnVuY3Rpb24oKXt0aGlzLm1hcC5ldmVudHMudW4oe21vdXNlZG93bjp0aGlzLm1vdXNlZG93bixtb3VzZXVwOnRoaXMubW91c2V1cCxjbGljazp0aGlzLmNsaWNrLGRibGNsaWNrOnRoaXMuZGJsY2xpY2ssc2NvcGU6dGhpc30pfSxtb3VzZWRvd246ZnVuY3Rpb24oYSl7dGhpcy5kb3duPXRoaXMuZ2V0RXZlbnRJbmZvKGEpO3RoaXMubGFzdD10aGlzLmdldEV2ZW50SW5mbyhhKTtyZXR1cm4hMH0sbW91c2V1cDpmdW5jdGlvbihhKXt2YXIgYj0hMDt0aGlzLmNoZWNrTW9kaWZpZXJzKGEpJiYodGhpcy5jb250cm9sLmhhbmRsZVJpZ2h0Q2xpY2tzJiZPcGVuTGF5ZXJzLkV2ZW50LmlzUmlnaHRDbGljayhhKSkmJihiPXRoaXMucmlnaHRjbGljayhhKSk7cmV0dXJuIGJ9LHJpZ2h0Y2xpY2s6ZnVuY3Rpb24oYSl7aWYodGhpcy5wYXNzZXNUb2xlcmFuY2UoYSkpe2lmKG51bGwhPVxudGhpcy5yaWdodGNsaWNrVGltZXJJZClyZXR1cm4gdGhpcy5jbGVhclRpbWVyKCksdGhpcy5jYWxsYmFjayhcImRibHJpZ2h0Y2xpY2tcIixbYV0pLCF0aGlzLnN0b3BEb3VibGU7YT10aGlzW1wiZG91YmxlXCJdP09wZW5MYXllcnMuVXRpbC5leHRlbmQoe30sYSk6dGhpcy5jYWxsYmFjayhcInJpZ2h0Y2xpY2tcIixbYV0pO2E9T3BlbkxheWVycy5GdW5jdGlvbi5iaW5kKHRoaXMuZGVsYXllZFJpZ2h0Q2FsbCx0aGlzLGEpO3RoaXMucmlnaHRjbGlja1RpbWVySWQ9d2luZG93LnNldFRpbWVvdXQoYSx0aGlzLmRlbGF5KX1yZXR1cm4hdGhpcy5zdG9wU2luZ2xlfSxkZWxheWVkUmlnaHRDYWxsOmZ1bmN0aW9uKGEpe3RoaXMucmlnaHRjbGlja1RpbWVySWQ9bnVsbDthJiZ0aGlzLmNhbGxiYWNrKFwicmlnaHRjbGlja1wiLFthXSl9LGNsaWNrOmZ1bmN0aW9uKGEpe3RoaXMubGFzdHx8KHRoaXMubGFzdD10aGlzLmdldEV2ZW50SW5mbyhhKSk7dGhpcy5oYW5kbGVTaW5nbGUoYSk7cmV0dXJuIXRoaXMuc3RvcFNpbmdsZX0sXG5kYmxjbGljazpmdW5jdGlvbihhKXt0aGlzLmhhbmRsZURvdWJsZShhKTtyZXR1cm4hdGhpcy5zdG9wRG91YmxlfSxoYW5kbGVEb3VibGU6ZnVuY3Rpb24oYSl7dGhpcy5wYXNzZXNEYmxjbGlja1RvbGVyYW5jZShhKSYmKHRoaXNbXCJkb3VibGVcIl0mJnRoaXMuY2FsbGJhY2soXCJkYmxjbGlja1wiLFthXSksdGhpcy5jbGVhclRpbWVyKCkpfSxoYW5kbGVTaW5nbGU6ZnVuY3Rpb24oYSl7dGhpcy5wYXNzZXNUb2xlcmFuY2UoYSkmJihudWxsIT10aGlzLnRpbWVySWQ/KHRoaXMubGFzdC50b3VjaGVzJiYxPT09dGhpcy5sYXN0LnRvdWNoZXMubGVuZ3RoJiYodGhpc1tcImRvdWJsZVwiXSYmT3BlbkxheWVycy5FdmVudC5zdG9wKGEpLHRoaXMuaGFuZGxlRG91YmxlKGEpKSwoIXRoaXMubGFzdC50b3VjaGVzfHwyIT09dGhpcy5sYXN0LnRvdWNoZXMubGVuZ3RoKSYmdGhpcy5jbGVhclRpbWVyKCkpOih0aGlzLmZpcnN0PXRoaXMuZ2V0RXZlbnRJbmZvKGEpLHRoaXMucXVldWVQb3RlbnRpYWxDbGljayh0aGlzLnNpbmdsZT9cbk9wZW5MYXllcnMuVXRpbC5leHRlbmQoe30sYSk6bnVsbCkpKX0scXVldWVQb3RlbnRpYWxDbGljazpmdW5jdGlvbihhKXt0aGlzLnRpbWVySWQ9d2luZG93LnNldFRpbWVvdXQoT3BlbkxheWVycy5GdW5jdGlvbi5iaW5kKHRoaXMuZGVsYXllZENhbGwsdGhpcyxhKSx0aGlzLmRlbGF5KX0scGFzc2VzVG9sZXJhbmNlOmZ1bmN0aW9uKGEpe3ZhciBiPSEwO2lmKG51bGwhPXRoaXMucGl4ZWxUb2xlcmFuY2UmJnRoaXMuZG93biYmdGhpcy5kb3duLnh5JiYoYj10aGlzLnBpeGVsVG9sZXJhbmNlPj10aGlzLmRvd24ueHkuZGlzdGFuY2VUbyhhLnh5KSkmJnRoaXMudG91Y2gmJnRoaXMuZG93bi50b3VjaGVzLmxlbmd0aD09PXRoaXMubGFzdC50b3VjaGVzLmxlbmd0aClmb3IodmFyIGE9MCxjPXRoaXMuZG93bi50b3VjaGVzLmxlbmd0aDthPGM7KythKWlmKHRoaXMuZ2V0VG91Y2hEaXN0YW5jZSh0aGlzLmRvd24udG91Y2hlc1thXSx0aGlzLmxhc3QudG91Y2hlc1thXSk+dGhpcy5waXhlbFRvbGVyYW5jZSl7Yj1cbiExO2JyZWFrfXJldHVybiBifSxnZXRUb3VjaERpc3RhbmNlOmZ1bmN0aW9uKGEsYil7cmV0dXJuIE1hdGguc3FydChNYXRoLnBvdyhhLmNsaWVudFgtYi5jbGllbnRYLDIpK01hdGgucG93KGEuY2xpZW50WS1iLmNsaWVudFksMikpfSxwYXNzZXNEYmxjbGlja1RvbGVyYW5jZTpmdW5jdGlvbigpe3ZhciBhPSEwO3RoaXMuZG93biYmdGhpcy5maXJzdCYmKGE9dGhpcy5kb3duLnh5LmRpc3RhbmNlVG8odGhpcy5maXJzdC54eSk8PXRoaXMuZGJsY2xpY2tUb2xlcmFuY2UpO3JldHVybiBhfSxjbGVhclRpbWVyOmZ1bmN0aW9uKCl7bnVsbCE9dGhpcy50aW1lcklkJiYod2luZG93LmNsZWFyVGltZW91dCh0aGlzLnRpbWVySWQpLHRoaXMudGltZXJJZD1udWxsKTtudWxsIT10aGlzLnJpZ2h0Y2xpY2tUaW1lcklkJiYod2luZG93LmNsZWFyVGltZW91dCh0aGlzLnJpZ2h0Y2xpY2tUaW1lcklkKSx0aGlzLnJpZ2h0Y2xpY2tUaW1lcklkPW51bGwpfSxkZWxheWVkQ2FsbDpmdW5jdGlvbihhKXt0aGlzLnRpbWVySWQ9XG5udWxsO2EmJnRoaXMuY2FsbGJhY2soXCJjbGlja1wiLFthXSl9LGdldEV2ZW50SW5mbzpmdW5jdGlvbihhKXt2YXIgYjtpZihhLnRvdWNoZXMpe3ZhciBjPWEudG91Y2hlcy5sZW5ndGg7Yj1BcnJheShjKTtmb3IodmFyIGQsZT0wO2U8YztlKyspZD1hLnRvdWNoZXNbZV0sYltlXT17Y2xpZW50WDpkLmNsaWVudFgsY2xpZW50WTpkLmNsaWVudFl9fXJldHVybnt4eTphLnh5LHRvdWNoZXM6Yn19LGRlYWN0aXZhdGU6ZnVuY3Rpb24oKXt2YXIgYT0hMTtPcGVuTGF5ZXJzLkhhbmRsZXIucHJvdG90eXBlLmRlYWN0aXZhdGUuYXBwbHkodGhpcyxhcmd1bWVudHMpJiYodGhpcy5jbGVhclRpbWVyKCksdGhpcy5sYXN0PXRoaXMuZmlyc3Q9dGhpcy5kb3duPW51bGwsdGhpcy50b3VjaD0hMSxhPSEwKTtyZXR1cm4gYX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuSGFuZGxlci5DbGlja1wifSk7T3BlbkxheWVycy5Db250cm9sLk5hdmlnYXRpb249T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkNvbnRyb2wse2RyYWdQYW46bnVsbCxkcmFnUGFuT3B0aW9uczpudWxsLHBpbmNoWm9vbTpudWxsLHBpbmNoWm9vbU9wdGlvbnM6bnVsbCxkb2N1bWVudERyYWc6ITEsem9vbUJveDpudWxsLHpvb21Cb3hFbmFibGVkOiEwLHpvb21XaGVlbEVuYWJsZWQ6ITAsbW91c2VXaGVlbE9wdGlvbnM6bnVsbCxoYW5kbGVSaWdodENsaWNrczohMSx6b29tQm94S2V5TWFzazpPcGVuTGF5ZXJzLkhhbmRsZXIuTU9EX1NISUZULGF1dG9BY3RpdmF0ZTohMCxpbml0aWFsaXplOmZ1bmN0aW9uKGEpe3RoaXMuaGFuZGxlcnM9e307T3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMuZGVhY3RpdmF0ZSgpO3RoaXMuZHJhZ1BhbiYmdGhpcy5kcmFnUGFuLmRlc3Ryb3koKTt0aGlzLmRyYWdQYW49bnVsbDtcbnRoaXMuem9vbUJveCYmdGhpcy56b29tQm94LmRlc3Ryb3koKTt0aGlzLnpvb21Cb3g9bnVsbDt0aGlzLnBpbmNoWm9vbSYmdGhpcy5waW5jaFpvb20uZGVzdHJveSgpO3RoaXMucGluY2hab29tPW51bGw7T3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5kZXN0cm95LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sYWN0aXZhdGU6ZnVuY3Rpb24oKXt0aGlzLmRyYWdQYW4uYWN0aXZhdGUoKTt0aGlzLnpvb21XaGVlbEVuYWJsZWQmJnRoaXMuaGFuZGxlcnMud2hlZWwuYWN0aXZhdGUoKTt0aGlzLmhhbmRsZXJzLmNsaWNrLmFjdGl2YXRlKCk7dGhpcy56b29tQm94RW5hYmxlZCYmdGhpcy56b29tQm94LmFjdGl2YXRlKCk7dGhpcy5waW5jaFpvb20mJnRoaXMucGluY2hab29tLmFjdGl2YXRlKCk7cmV0dXJuIE9wZW5MYXllcnMuQ29udHJvbC5wcm90b3R5cGUuYWN0aXZhdGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxkZWFjdGl2YXRlOmZ1bmN0aW9uKCl7dGhpcy5waW5jaFpvb20mJnRoaXMucGluY2hab29tLmRlYWN0aXZhdGUoKTtcbnRoaXMuem9vbUJveC5kZWFjdGl2YXRlKCk7dGhpcy5kcmFnUGFuLmRlYWN0aXZhdGUoKTt0aGlzLmhhbmRsZXJzLmNsaWNrLmRlYWN0aXZhdGUoKTt0aGlzLmhhbmRsZXJzLndoZWVsLmRlYWN0aXZhdGUoKTtyZXR1cm4gT3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5kZWFjdGl2YXRlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sZHJhdzpmdW5jdGlvbigpe3RoaXMuaGFuZGxlUmlnaHRDbGlja3MmJih0aGlzLm1hcC52aWV3UG9ydERpdi5vbmNvbnRleHRtZW51PU9wZW5MYXllcnMuRnVuY3Rpb24uRmFsc2UpO3RoaXMuaGFuZGxlcnMuY2xpY2s9bmV3IE9wZW5MYXllcnMuSGFuZGxlci5DbGljayh0aGlzLHtjbGljazp0aGlzLmRlZmF1bHRDbGljayxkYmxjbGljazp0aGlzLmRlZmF1bHREYmxDbGljayxkYmxyaWdodGNsaWNrOnRoaXMuZGVmYXVsdERibFJpZ2h0Q2xpY2t9LHtcImRvdWJsZVwiOiEwLHN0b3BEb3VibGU6ITB9KTt0aGlzLmRyYWdQYW49bmV3IE9wZW5MYXllcnMuQ29udHJvbC5EcmFnUGFuKE9wZW5MYXllcnMuVXRpbC5leHRlbmQoe21hcDp0aGlzLm1hcCxcbmRvY3VtZW50RHJhZzp0aGlzLmRvY3VtZW50RHJhZ30sdGhpcy5kcmFnUGFuT3B0aW9ucykpO3RoaXMuem9vbUJveD1uZXcgT3BlbkxheWVycy5Db250cm9sLlpvb21Cb3goe21hcDp0aGlzLm1hcCxrZXlNYXNrOnRoaXMuem9vbUJveEtleU1hc2t9KTt0aGlzLmRyYWdQYW4uZHJhdygpO3RoaXMuem9vbUJveC5kcmF3KCk7dGhpcy5oYW5kbGVycy53aGVlbD1uZXcgT3BlbkxheWVycy5IYW5kbGVyLk1vdXNlV2hlZWwodGhpcyx7dXA6dGhpcy53aGVlbFVwLGRvd246dGhpcy53aGVlbERvd259LHRoaXMubW91c2VXaGVlbE9wdGlvbnMpO09wZW5MYXllcnMuQ29udHJvbC5QaW5jaFpvb20mJih0aGlzLnBpbmNoWm9vbT1uZXcgT3BlbkxheWVycy5Db250cm9sLlBpbmNoWm9vbShPcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHttYXA6dGhpcy5tYXB9LHRoaXMucGluY2hab29tT3B0aW9ucykpKX0sZGVmYXVsdENsaWNrOmZ1bmN0aW9uKGEpe2EubGFzdFRvdWNoZXMmJjI9PWEubGFzdFRvdWNoZXMubGVuZ3RoJiZcbnRoaXMubWFwLnpvb21PdXQoKX0sZGVmYXVsdERibENsaWNrOmZ1bmN0aW9uKGEpe3RoaXMubWFwLnNldENlbnRlcih0aGlzLm1hcC5nZXRMb25MYXRGcm9tVmlld1BvcnRQeChhLnh5KSx0aGlzLm1hcC56b29tKzEpfSxkZWZhdWx0RGJsUmlnaHRDbGljazpmdW5jdGlvbihhKXt0aGlzLm1hcC5zZXRDZW50ZXIodGhpcy5tYXAuZ2V0TG9uTGF0RnJvbVZpZXdQb3J0UHgoYS54eSksdGhpcy5tYXAuem9vbS0xKX0sd2hlZWxDaGFuZ2U6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLm1hcC5nZXRab29tKCksZD10aGlzLm1hcC5nZXRab29tKCkrTWF0aC5yb3VuZChiKSxkPU1hdGgubWF4KGQsMCksZD1NYXRoLm1pbihkLHRoaXMubWFwLmdldE51bVpvb21MZXZlbHMoKSk7aWYoZCE9PWMpe3ZhciBlPXRoaXMubWFwLmdldFNpemUoKSxjPWUudy8yLWEueHkueCxlPWEueHkueS1lLmgvMixmPXRoaXMubWFwLmJhc2VMYXllci5nZXRSZXNvbHV0aW9uRm9yWm9vbShkKSxnPXRoaXMubWFwLmdldExvbkxhdEZyb21QaXhlbChhLnh5KTtcbnRoaXMubWFwLnNldENlbnRlcihuZXcgT3BlbkxheWVycy5Mb25MYXQoZy5sb24rYypmLGcubGF0K2UqZiksZCl9fSx3aGVlbFVwOmZ1bmN0aW9uKGEsYil7dGhpcy53aGVlbENoYW5nZShhLGJ8fDEpfSx3aGVlbERvd246ZnVuY3Rpb24oYSxiKXt0aGlzLndoZWVsQ2hhbmdlKGEsYnx8LTEpfSxkaXNhYmxlWm9vbUJveDpmdW5jdGlvbigpe3RoaXMuem9vbUJveEVuYWJsZWQ9ITE7dGhpcy56b29tQm94LmRlYWN0aXZhdGUoKX0sZW5hYmxlWm9vbUJveDpmdW5jdGlvbigpe3RoaXMuem9vbUJveEVuYWJsZWQ9ITA7dGhpcy5hY3RpdmUmJnRoaXMuem9vbUJveC5hY3RpdmF0ZSgpfSxkaXNhYmxlWm9vbVdoZWVsOmZ1bmN0aW9uKCl7dGhpcy56b29tV2hlZWxFbmFibGVkPSExO3RoaXMuaGFuZGxlcnMud2hlZWwuZGVhY3RpdmF0ZSgpfSxlbmFibGVab29tV2hlZWw6ZnVuY3Rpb24oKXt0aGlzLnpvb21XaGVlbEVuYWJsZWQ9ITA7dGhpcy5hY3RpdmUmJnRoaXMuaGFuZGxlcnMud2hlZWwuYWN0aXZhdGUoKX0sXG5DTEFTU19OQU1FOlwiT3BlbkxheWVycy5Db250cm9sLk5hdmlnYXRpb25cIn0pO09wZW5MYXllcnMuQ29udHJvbC5EcmF3RmVhdHVyZT1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuQ29udHJvbCx7bGF5ZXI6bnVsbCxjYWxsYmFja3M6bnVsbCxtdWx0aTohMSxmZWF0dXJlQWRkZWQ6ZnVuY3Rpb24oKXt9LGhhbmRsZXJPcHRpb25zOm51bGwsaW5pdGlhbGl6ZTpmdW5jdGlvbihhLGIsYyl7T3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsW2NdKTt0aGlzLmNhbGxiYWNrcz1PcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHtkb25lOnRoaXMuZHJhd0ZlYXR1cmUsbW9kaWZ5OmZ1bmN0aW9uKGEsYil7dGhpcy5sYXllci5ldmVudHMudHJpZ2dlckV2ZW50KFwic2tldGNobW9kaWZpZWRcIix7dmVydGV4OmEsZmVhdHVyZTpifSl9LGNyZWF0ZTpmdW5jdGlvbihhLGIpe3RoaXMubGF5ZXIuZXZlbnRzLnRyaWdnZXJFdmVudChcInNrZXRjaHN0YXJ0ZWRcIix7dmVydGV4OmEsZmVhdHVyZTpifSl9fSx0aGlzLmNhbGxiYWNrcyk7dGhpcy5sYXllcj1cbmE7dGhpcy5oYW5kbGVyT3B0aW9ucz10aGlzLmhhbmRsZXJPcHRpb25zfHx7fTt0aGlzLmhhbmRsZXJPcHRpb25zLmxheWVyT3B0aW9ucz1PcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyh0aGlzLmhhbmRsZXJPcHRpb25zLmxheWVyT3B0aW9ucyx7cmVuZGVyZXJzOmEucmVuZGVyZXJzLHJlbmRlcmVyT3B0aW9uczphLnJlbmRlcmVyT3B0aW9uc30pO1wibXVsdGlcImluIHRoaXMuaGFuZGxlck9wdGlvbnN8fCh0aGlzLmhhbmRsZXJPcHRpb25zLm11bHRpPXRoaXMubXVsdGkpO2lmKGE9dGhpcy5sYXllci5zdHlsZU1hcCYmdGhpcy5sYXllci5zdHlsZU1hcC5zdHlsZXMudGVtcG9yYXJ5KXRoaXMuaGFuZGxlck9wdGlvbnMubGF5ZXJPcHRpb25zPU9wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKHRoaXMuaGFuZGxlck9wdGlvbnMubGF5ZXJPcHRpb25zLHtzdHlsZU1hcDpuZXcgT3BlbkxheWVycy5TdHlsZU1hcCh7XCJkZWZhdWx0XCI6YX0pfSk7dGhpcy5oYW5kbGVyPW5ldyBiKHRoaXMsXG50aGlzLmNhbGxiYWNrcyx0aGlzLmhhbmRsZXJPcHRpb25zKX0sZHJhd0ZlYXR1cmU6ZnVuY3Rpb24oYSl7YT1uZXcgT3BlbkxheWVycy5GZWF0dXJlLlZlY3RvcihhKTshMSE9PXRoaXMubGF5ZXIuZXZlbnRzLnRyaWdnZXJFdmVudChcInNrZXRjaGNvbXBsZXRlXCIse2ZlYXR1cmU6YX0pJiYoYS5zdGF0ZT1PcGVuTGF5ZXJzLlN0YXRlLklOU0VSVCx0aGlzLmxheWVyLmFkZEZlYXR1cmVzKFthXSksdGhpcy5mZWF0dXJlQWRkZWQoYSksdGhpcy5ldmVudHMudHJpZ2dlckV2ZW50KFwiZmVhdHVyZWFkZGVkXCIse2ZlYXR1cmU6YX0pKX0saW5zZXJ0WFk6ZnVuY3Rpb24oYSxiKXt0aGlzLmhhbmRsZXImJnRoaXMuaGFuZGxlci5saW5lJiZ0aGlzLmhhbmRsZXIuaW5zZXJ0WFkoYSxiKX0saW5zZXJ0RGVsdGFYWTpmdW5jdGlvbihhLGIpe3RoaXMuaGFuZGxlciYmdGhpcy5oYW5kbGVyLmxpbmUmJnRoaXMuaGFuZGxlci5pbnNlcnREZWx0YVhZKGEsYil9LGluc2VydERpcmVjdGlvbkxlbmd0aDpmdW5jdGlvbihhLFxuYil7dGhpcy5oYW5kbGVyJiZ0aGlzLmhhbmRsZXIubGluZSYmdGhpcy5oYW5kbGVyLmluc2VydERpcmVjdGlvbkxlbmd0aChhLGIpfSxpbnNlcnREZWZsZWN0aW9uTGVuZ3RoOmZ1bmN0aW9uKGEsYil7dGhpcy5oYW5kbGVyJiZ0aGlzLmhhbmRsZXIubGluZSYmdGhpcy5oYW5kbGVyLmluc2VydERlZmxlY3Rpb25MZW5ndGgoYSxiKX0sdW5kbzpmdW5jdGlvbigpe3JldHVybiB0aGlzLmhhbmRsZXIudW5kbyYmdGhpcy5oYW5kbGVyLnVuZG8oKX0scmVkbzpmdW5jdGlvbigpe3JldHVybiB0aGlzLmhhbmRsZXIucmVkbyYmdGhpcy5oYW5kbGVyLnJlZG8oKX0sZmluaXNoU2tldGNoOmZ1bmN0aW9uKCl7dGhpcy5oYW5kbGVyLmZpbmlzaEdlb21ldHJ5KCl9LGNhbmNlbDpmdW5jdGlvbigpe3RoaXMuaGFuZGxlci5jYW5jZWwoKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuQ29udHJvbC5EcmF3RmVhdHVyZVwifSk7T3BlbkxheWVycy5IYW5kbGVyLlBvbHlnb249T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkhhbmRsZXIuUGF0aCx7aG9sZU1vZGlmaWVyOm51bGwsZHJhd2luZ0hvbGU6ITEscG9seWdvbjpudWxsLGNyZWF0ZUZlYXR1cmU6ZnVuY3Rpb24oYSl7YT10aGlzLmxheWVyLmdldExvbkxhdEZyb21WaWV3UG9ydFB4KGEpO2E9bmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQoYS5sb24sYS5sYXQpO3RoaXMucG9pbnQ9bmV3IE9wZW5MYXllcnMuRmVhdHVyZS5WZWN0b3IoYSk7dGhpcy5saW5lPW5ldyBPcGVuTGF5ZXJzLkZlYXR1cmUuVmVjdG9yKG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVhclJpbmcoW3RoaXMucG9pbnQuZ2VvbWV0cnldKSk7dGhpcy5wb2x5Z29uPW5ldyBPcGVuTGF5ZXJzLkZlYXR1cmUuVmVjdG9yKG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvbHlnb24oW3RoaXMubGluZS5nZW9tZXRyeV0pKTt0aGlzLmNhbGxiYWNrKFwiY3JlYXRlXCIsW3RoaXMucG9pbnQuZ2VvbWV0cnksXG50aGlzLmdldFNrZXRjaCgpXSk7dGhpcy5wb2ludC5nZW9tZXRyeS5jbGVhckJvdW5kcygpO3RoaXMubGF5ZXIuYWRkRmVhdHVyZXMoW3RoaXMucG9seWdvbix0aGlzLnBvaW50XSx7c2lsZW50OiEwfSl9LGFkZFBvaW50OmZ1bmN0aW9uKGEpe2lmKCF0aGlzLmRyYXdpbmdIb2xlJiZ0aGlzLmhvbGVNb2RpZmllciYmdGhpcy5ldnQmJnRoaXMuZXZ0W3RoaXMuaG9sZU1vZGlmaWVyXSlmb3IodmFyIGI9dGhpcy5wb2ludC5nZW9tZXRyeSxjPXRoaXMuY29udHJvbC5sYXllci5mZWF0dXJlcyxkLGU9Yy5sZW5ndGgtMTswPD1lOy0tZSlpZihkPWNbZV0uZ2VvbWV0cnksKGQgaW5zdGFuY2VvZiBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvbHlnb258fGQgaW5zdGFuY2VvZiBPcGVuTGF5ZXJzLkdlb21ldHJ5Lk11bHRpUG9seWdvbikmJmQuaW50ZXJzZWN0cyhiKSl7Yj1jW2VdO3RoaXMuY29udHJvbC5sYXllci5yZW1vdmVGZWF0dXJlcyhbYl0se3NpbGVudDohMH0pO3RoaXMuY29udHJvbC5sYXllci5ldmVudHMucmVnaXN0ZXJQcmlvcml0eShcInNrZXRjaGNvbXBsZXRlXCIsXG50aGlzLHRoaXMuZmluYWxpemVJbnRlcmlvclJpbmcpO3RoaXMuY29udHJvbC5sYXllci5ldmVudHMucmVnaXN0ZXJQcmlvcml0eShcInNrZXRjaG1vZGlmaWVkXCIsdGhpcyx0aGlzLmVuZm9yY2VUb3BvbG9neSk7Yi5nZW9tZXRyeS5hZGRDb21wb25lbnQodGhpcy5saW5lLmdlb21ldHJ5KTt0aGlzLnBvbHlnb249Yjt0aGlzLmRyYXdpbmdIb2xlPSEwO2JyZWFrfU9wZW5MYXllcnMuSGFuZGxlci5QYXRoLnByb3RvdHlwZS5hZGRQb2ludC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGdldEN1cnJlbnRQb2ludEluZGV4OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGluZS5nZW9tZXRyeS5jb21wb25lbnRzLmxlbmd0aC0yfSxlbmZvcmNlVG9wb2xvZ3k6ZnVuY3Rpb24oYSl7dmFyIGE9YS52ZXJ0ZXgsYj10aGlzLmxpbmUuZ2VvbWV0cnkuY29tcG9uZW50czt0aGlzLnBvbHlnb24uZ2VvbWV0cnkuaW50ZXJzZWN0cyhhKXx8KGI9YltiLmxlbmd0aC0zXSxhLng9Yi54LGEueT1iLnkpfSxmaW5pc2hHZW9tZXRyeTpmdW5jdGlvbigpe3RoaXMubGluZS5nZW9tZXRyeS5yZW1vdmVDb21wb25lbnQodGhpcy5saW5lLmdlb21ldHJ5LmNvbXBvbmVudHNbdGhpcy5saW5lLmdlb21ldHJ5LmNvbXBvbmVudHMubGVuZ3RoLVxuMl0pO3RoaXMucmVtb3ZlUG9pbnQoKTt0aGlzLmZpbmFsaXplKCl9LGZpbmFsaXplSW50ZXJpb3JSaW5nOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5saW5lLmdlb21ldHJ5LGI9MCE9PWEuZ2V0QXJlYSgpO2lmKGIpe2Zvcih2YXIgYz10aGlzLnBvbHlnb24uZ2VvbWV0cnkuY29tcG9uZW50cyxkPWMubGVuZ3RoLTI7MDw9ZDstLWQpaWYoYS5pbnRlcnNlY3RzKGNbZF0pKXtiPSExO2JyZWFrfWlmKGIpe2Q9Yy5sZW5ndGgtMjthOmZvcig7MDxkOy0tZClmb3IodmFyIGU9Y1tkXS5jb21wb25lbnRzLGY9MCxnPWUubGVuZ3RoO2Y8ZzsrK2YpaWYoYS5jb250YWluc1BvaW50KGVbZl0pKXtiPSExO2JyZWFrIGF9fX1iP3RoaXMucG9seWdvbi5zdGF0ZSE9PU9wZW5MYXllcnMuU3RhdGUuSU5TRVJUJiYodGhpcy5wb2x5Z29uLnN0YXRlPU9wZW5MYXllcnMuU3RhdGUuVVBEQVRFKTp0aGlzLnBvbHlnb24uZ2VvbWV0cnkucmVtb3ZlQ29tcG9uZW50KGEpO3RoaXMucmVzdG9yZUZlYXR1cmUoKTtyZXR1cm4hMX0sXG5jYW5jZWw6ZnVuY3Rpb24oKXt0aGlzLmRyYXdpbmdIb2xlJiYodGhpcy5wb2x5Z29uLmdlb21ldHJ5LnJlbW92ZUNvbXBvbmVudCh0aGlzLmxpbmUuZ2VvbWV0cnkpLHRoaXMucmVzdG9yZUZlYXR1cmUoITApKTtyZXR1cm4gT3BlbkxheWVycy5IYW5kbGVyLlBhdGgucHJvdG90eXBlLmNhbmNlbC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LHJlc3RvcmVGZWF0dXJlOmZ1bmN0aW9uKGEpe3RoaXMuY29udHJvbC5sYXllci5ldmVudHMudW5yZWdpc3RlcihcInNrZXRjaGNvbXBsZXRlXCIsdGhpcyx0aGlzLmZpbmFsaXplSW50ZXJpb3JSaW5nKTt0aGlzLmNvbnRyb2wubGF5ZXIuZXZlbnRzLnVucmVnaXN0ZXIoXCJza2V0Y2htb2RpZmllZFwiLHRoaXMsdGhpcy5lbmZvcmNlVG9wb2xvZ3kpO3RoaXMubGF5ZXIucmVtb3ZlRmVhdHVyZXMoW3RoaXMucG9seWdvbl0se3NpbGVudDohMH0pO3RoaXMuY29udHJvbC5sYXllci5hZGRGZWF0dXJlcyhbdGhpcy5wb2x5Z29uXSx7c2lsZW50OiEwfSk7dGhpcy5kcmF3aW5nSG9sZT1cbiExO2F8fHRoaXMuY29udHJvbC5sYXllci5ldmVudHMudHJpZ2dlckV2ZW50KFwic2tldGNoY29tcGxldGVcIix7ZmVhdHVyZTp0aGlzLnBvbHlnb259KX0sZGVzdHJveUZlYXR1cmU6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5IYW5kbGVyLlBhdGgucHJvdG90eXBlLmRlc3Ryb3lGZWF0dXJlLmNhbGwodGhpcyxhKTt0aGlzLnBvbHlnb249bnVsbH0sZHJhd0ZlYXR1cmU6ZnVuY3Rpb24oKXt0aGlzLmxheWVyLmRyYXdGZWF0dXJlKHRoaXMucG9seWdvbix0aGlzLnN0eWxlKTt0aGlzLmxheWVyLmRyYXdGZWF0dXJlKHRoaXMucG9pbnQsdGhpcy5zdHlsZSl9LGdldFNrZXRjaDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnBvbHlnb259LGdldEdlb21ldHJ5OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5wb2x5Z29uJiZ0aGlzLnBvbHlnb24uZ2VvbWV0cnk7YSYmdGhpcy5tdWx0aSYmKGE9bmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuTXVsdGlQb2x5Z29uKFthXSkpO3JldHVybiBhfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5IYW5kbGVyLlBvbHlnb25cIn0pO09wZW5MYXllcnMuQ29udHJvbC5FZGl0aW5nVG9vbGJhcj1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuQ29udHJvbC5QYW5lbCx7Y2l0ZUNvbXBsaWFudDohMSxpbml0aWFsaXplOmZ1bmN0aW9uKGEsYil7T3BlbkxheWVycy5Db250cm9sLlBhbmVsLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsW2JdKTt0aGlzLmFkZENvbnRyb2xzKFtuZXcgT3BlbkxheWVycy5Db250cm9sLk5hdmlnYXRpb25dKTt0aGlzLmFkZENvbnRyb2xzKFtuZXcgT3BlbkxheWVycy5Db250cm9sLkRyYXdGZWF0dXJlKGEsT3BlbkxheWVycy5IYW5kbGVyLlBvaW50LHtkaXNwbGF5Q2xhc3M6XCJvbENvbnRyb2xEcmF3RmVhdHVyZVBvaW50XCIsaGFuZGxlck9wdGlvbnM6e2NpdGVDb21wbGlhbnQ6dGhpcy5jaXRlQ29tcGxpYW50fX0pLG5ldyBPcGVuTGF5ZXJzLkNvbnRyb2wuRHJhd0ZlYXR1cmUoYSxPcGVuTGF5ZXJzLkhhbmRsZXIuUGF0aCx7ZGlzcGxheUNsYXNzOlwib2xDb250cm9sRHJhd0ZlYXR1cmVQYXRoXCIsXG5oYW5kbGVyT3B0aW9uczp7Y2l0ZUNvbXBsaWFudDp0aGlzLmNpdGVDb21wbGlhbnR9fSksbmV3IE9wZW5MYXllcnMuQ29udHJvbC5EcmF3RmVhdHVyZShhLE9wZW5MYXllcnMuSGFuZGxlci5Qb2x5Z29uLHtkaXNwbGF5Q2xhc3M6XCJvbENvbnRyb2xEcmF3RmVhdHVyZVBvbHlnb25cIixoYW5kbGVyT3B0aW9uczp7Y2l0ZUNvbXBsaWFudDp0aGlzLmNpdGVDb21wbGlhbnR9fSldKX0sZHJhdzpmdW5jdGlvbigpe3ZhciBhPU9wZW5MYXllcnMuQ29udHJvbC5QYW5lbC5wcm90b3R5cGUuZHJhdy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7bnVsbD09PXRoaXMuZGVmYXVsdENvbnRyb2wmJih0aGlzLmRlZmF1bHRDb250cm9sPXRoaXMuY29udHJvbHNbMF0pO3JldHVybiBhfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Db250cm9sLkVkaXRpbmdUb29sYmFyXCJ9KTtPcGVuTGF5ZXJzLlN0cmF0ZWd5LkJCT1g9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLlN0cmF0ZWd5LHtib3VuZHM6bnVsbCxyZXNvbHV0aW9uOm51bGwscmF0aW86MixyZXNGYWN0b3I6bnVsbCxyZXNwb25zZTpudWxsLGFjdGl2YXRlOmZ1bmN0aW9uKCl7dmFyIGE9T3BlbkxheWVycy5TdHJhdGVneS5wcm90b3R5cGUuYWN0aXZhdGUuY2FsbCh0aGlzKTthJiYodGhpcy5sYXllci5ldmVudHMub24oe21vdmVlbmQ6dGhpcy51cGRhdGUscmVmcmVzaDp0aGlzLnVwZGF0ZSx2aXNpYmlsaXR5Y2hhbmdlZDp0aGlzLnVwZGF0ZSxzY29wZTp0aGlzfSksdGhpcy51cGRhdGUoKSk7cmV0dXJuIGF9LGRlYWN0aXZhdGU6ZnVuY3Rpb24oKXt2YXIgYT1PcGVuTGF5ZXJzLlN0cmF0ZWd5LnByb3RvdHlwZS5kZWFjdGl2YXRlLmNhbGwodGhpcyk7YSYmdGhpcy5sYXllci5ldmVudHMudW4oe21vdmVlbmQ6dGhpcy51cGRhdGUscmVmcmVzaDp0aGlzLnVwZGF0ZSx2aXNpYmlsaXR5Y2hhbmdlZDp0aGlzLnVwZGF0ZSxcbnNjb3BlOnRoaXN9KTtyZXR1cm4gYX0sdXBkYXRlOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuZ2V0TWFwQm91bmRzKCk7aWYobnVsbCE9PWImJihhJiZhLmZvcmNlfHx0aGlzLmxheWVyLnZpc2liaWxpdHkmJnRoaXMubGF5ZXIuY2FsY3VsYXRlSW5SYW5nZSgpJiZ0aGlzLmludmFsaWRCb3VuZHMoYikpKXRoaXMuY2FsY3VsYXRlQm91bmRzKGIpLHRoaXMucmVzb2x1dGlvbj10aGlzLmxheWVyLm1hcC5nZXRSZXNvbHV0aW9uKCksdGhpcy50cmlnZ2VyUmVhZChhKX0sZ2V0TWFwQm91bmRzOmZ1bmN0aW9uKCl7aWYobnVsbD09PXRoaXMubGF5ZXIubWFwKXJldHVybiBudWxsO3ZhciBhPXRoaXMubGF5ZXIubWFwLmdldEV4dGVudCgpO2EmJiF0aGlzLmxheWVyLnByb2plY3Rpb24uZXF1YWxzKHRoaXMubGF5ZXIubWFwLmdldFByb2plY3Rpb25PYmplY3QoKSkmJihhPWEuY2xvbmUoKS50cmFuc2Zvcm0odGhpcy5sYXllci5tYXAuZ2V0UHJvamVjdGlvbk9iamVjdCgpLHRoaXMubGF5ZXIucHJvamVjdGlvbikpO1xucmV0dXJuIGF9LGludmFsaWRCb3VuZHM6ZnVuY3Rpb24oYSl7YXx8KGE9dGhpcy5nZXRNYXBCb3VuZHMoKSk7YT0hdGhpcy5ib3VuZHN8fCF0aGlzLmJvdW5kcy5jb250YWluc0JvdW5kcyhhKTshYSYmdGhpcy5yZXNGYWN0b3ImJihhPXRoaXMucmVzb2x1dGlvbi90aGlzLmxheWVyLm1hcC5nZXRSZXNvbHV0aW9uKCksYT1hPj10aGlzLnJlc0ZhY3Rvcnx8YTw9MS90aGlzLnJlc0ZhY3Rvcik7cmV0dXJuIGF9LGNhbGN1bGF0ZUJvdW5kczpmdW5jdGlvbihhKXthfHwoYT10aGlzLmdldE1hcEJvdW5kcygpKTt2YXIgYj1hLmdldENlbnRlckxvbkxhdCgpLGM9YS5nZXRXaWR0aCgpKnRoaXMucmF0aW8sYT1hLmdldEhlaWdodCgpKnRoaXMucmF0aW87dGhpcy5ib3VuZHM9bmV3IE9wZW5MYXllcnMuQm91bmRzKGIubG9uLWMvMixiLmxhdC1hLzIsYi5sb24rYy8yLGIubGF0K2EvMil9LHRyaWdnZXJSZWFkOmZ1bmN0aW9uKGEpe3RoaXMucmVzcG9uc2UmJiEoYSYmITA9PT1hLm5vQWJvcnQpJiZcbih0aGlzLmxheWVyLnByb3RvY29sLmFib3J0KHRoaXMucmVzcG9uc2UpLHRoaXMubGF5ZXIuZXZlbnRzLnRyaWdnZXJFdmVudChcImxvYWRlbmRcIikpO3RoaXMubGF5ZXIuZXZlbnRzLnRyaWdnZXJFdmVudChcImxvYWRzdGFydFwiKTt0aGlzLnJlc3BvbnNlPXRoaXMubGF5ZXIucHJvdG9jb2wucmVhZChPcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyh7ZmlsdGVyOnRoaXMuY3JlYXRlRmlsdGVyKCksY2FsbGJhY2s6dGhpcy5tZXJnZSxzY29wZTp0aGlzfSxhKSl9LGNyZWF0ZUZpbHRlcjpmdW5jdGlvbigpe3ZhciBhPW5ldyBPcGVuTGF5ZXJzLkZpbHRlci5TcGF0aWFsKHt0eXBlOk9wZW5MYXllcnMuRmlsdGVyLlNwYXRpYWwuQkJPWCx2YWx1ZTp0aGlzLmJvdW5kcyxwcm9qZWN0aW9uOnRoaXMubGF5ZXIucHJvamVjdGlvbn0pO3RoaXMubGF5ZXIuZmlsdGVyJiYoYT1uZXcgT3BlbkxheWVycy5GaWx0ZXIuTG9naWNhbCh7dHlwZTpPcGVuTGF5ZXJzLkZpbHRlci5Mb2dpY2FsLkFORCxcbmZpbHRlcnM6W3RoaXMubGF5ZXIuZmlsdGVyLGFdfSkpO3JldHVybiBhfSxtZXJnZTpmdW5jdGlvbihhKXt0aGlzLmxheWVyLmRlc3Ryb3lGZWF0dXJlcygpO2lmKChhPWEuZmVhdHVyZXMpJiYwPGEubGVuZ3RoKXt2YXIgYj10aGlzLmxheWVyLnByb2plY3Rpb24sYz10aGlzLmxheWVyLm1hcC5nZXRQcm9qZWN0aW9uT2JqZWN0KCk7aWYoIWMuZXF1YWxzKGIpKWZvcih2YXIgZCxlPTAsZj1hLmxlbmd0aDtlPGY7KytlKShkPWFbZV0uZ2VvbWV0cnkpJiZkLnRyYW5zZm9ybShiLGMpO3RoaXMubGF5ZXIuYWRkRmVhdHVyZXMoYSl9dGhpcy5yZXNwb25zZT1udWxsO3RoaXMubGF5ZXIuZXZlbnRzLnRyaWdnZXJFdmVudChcImxvYWRlbmRcIil9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLlN0cmF0ZWd5LkJCT1hcIn0pO09wZW5MYXllcnMuTGF5ZXIuV29ybGRXaW5kPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5MYXllci5HcmlkLHtERUZBVUxUX1BBUkFNUzp7fSxpc0Jhc2VMYXllcjohMCxsemQ6bnVsbCx6b29tTGV2ZWxzOm51bGwsaW5pdGlhbGl6ZTpmdW5jdGlvbihhLGIsYyxkLGUsZil7dGhpcy5semQ9Yzt0aGlzLnpvb21MZXZlbHM9ZDtjPVtdO2MucHVzaChhLGIsZSxmKTtPcGVuTGF5ZXJzLkxheWVyLkdyaWQucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxjKTt0aGlzLnBhcmFtcz1PcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyh0aGlzLnBhcmFtcyx0aGlzLkRFRkFVTFRfUEFSQU1TKX0sZ2V0Wm9vbTpmdW5jdGlvbigpe3ZhciBhPXRoaXMubWFwLmdldFpvb20oKTt0aGlzLm1hcC5nZXRNYXhFeHRlbnQoKTtyZXR1cm4gYS09TWF0aC5sb2codGhpcy5tYXhSZXNvbHV0aW9uLyh0aGlzLmx6ZC81MTIpKS9NYXRoLmxvZygyKX0sZ2V0VVJMOmZ1bmN0aW9uKGEpe3ZhciBhPVxudGhpcy5hZGp1c3RCb3VuZHMoYSksYj10aGlzLmdldFpvb20oKSxjPXRoaXMubWFwLmdldE1heEV4dGVudCgpLGQ9dGhpcy5semQvTWF0aC5wb3coMix0aGlzLmdldFpvb20oKSksZT1NYXRoLmZsb29yKChhLmxlZnQtYy5sZWZ0KS9kKSxhPU1hdGguZmxvb3IoKGEuYm90dG9tLWMuYm90dG9tKS9kKTtyZXR1cm4gdGhpcy5tYXAuZ2V0UmVzb2x1dGlvbigpPD10aGlzLmx6ZC81MTImJnRoaXMuZ2V0Wm9vbSgpPD10aGlzLnpvb21MZXZlbHM/dGhpcy5nZXRGdWxsUmVxdWVzdFN0cmluZyh7TDpiLFg6ZSxZOmF9KTpPcGVuTGF5ZXJzLlV0aWwuZ2V0SW1hZ2VMb2NhdGlvbihcImJsYW5rLmdpZlwiKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuTGF5ZXIuV29ybGRXaW5kXCJ9KTtPcGVuTGF5ZXJzLlByb3RvY29sLkNTVz1mdW5jdGlvbihhKXt2YXIgYT1PcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyhhLE9wZW5MYXllcnMuUHJvdG9jb2wuQ1NXLkRFRkFVTFRTKSxiPU9wZW5MYXllcnMuUHJvdG9jb2wuQ1NXW1widlwiK2EudmVyc2lvbi5yZXBsYWNlKC9cXC4vZyxcIl9cIildO2lmKCFiKXRocm93XCJVbnN1cHBvcnRlZCBDU1cgdmVyc2lvbjogXCIrYS52ZXJzaW9uO3JldHVybiBuZXcgYihhKX07T3BlbkxheWVycy5Qcm90b2NvbC5DU1cuREVGQVVMVFM9e3ZlcnNpb246XCIyLjAuMlwifTtPcGVuTGF5ZXJzLkZvcm1hdC5XTVRTQ2FwYWJpbGl0aWVzPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Gb3JtYXQuWE1MLlZlcnNpb25lZE9HQyx7ZGVmYXVsdFZlcnNpb246XCIxLjAuMFwiLHl4OntcInVybjpvZ2M6ZGVmOmNyczpFUFNHOjo0MzI2XCI6ITB9LGNyZWF0ZUxheWVyOmZ1bmN0aW9uKGEsYil7dmFyIGMsZD17bGF5ZXI6ITAsbWF0cml4U2V0OiEwfSxlO2ZvcihlIGluIGQpaWYoIShlIGluIGIpKXRocm93IEVycm9yKFwiTWlzc2luZyBwcm9wZXJ0eSAnXCIrZStcIicgaW4gbGF5ZXIgY29uZmlndXJhdGlvbi5cIik7ZD1hLmNvbnRlbnRzO2U9ZC50aWxlTWF0cml4U2V0c1tiLm1hdHJpeFNldF07Zm9yKHZhciBmLGc9MCxoPWQubGF5ZXJzLmxlbmd0aDtnPGg7KytnKWlmKGQubGF5ZXJzW2ddLmlkZW50aWZpZXI9PT1iLmxheWVyKXtmPWQubGF5ZXJzW2ddO2JyZWFrfWlmKGYmJmUpe2Zvcih2YXIgaSxnPTAsaD1mLnN0eWxlcy5sZW5ndGg7ZzxoJiYhKGk9Zi5zdHlsZXNbZ10saS5pc0RlZmF1bHQpOysrZyk7XG5jPW5ldyBPcGVuTGF5ZXJzLkxheWVyLldNVFMoT3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoYix7dXJsOlwiUkVTVFwiPT09Yi5yZXF1ZXN0RW5jb2RpbmcmJmYucmVzb3VyY2VVcmw/Zi5yZXNvdXJjZVVybC50aWxlLnRlbXBsYXRlOmEub3BlcmF0aW9uc01ldGFkYXRhLkdldFRpbGUuZGNwLmh0dHAuZ2V0WzBdLnVybCxuYW1lOmYudGl0bGUsc3R5bGU6aS5pZGVudGlmaWVyLG1hdHJpeElkczplLm1hdHJpeElkcyx0aWxlRnVsbEV4dGVudDplLmJvdW5kc30pKX1yZXR1cm4gY30sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuRm9ybWF0LldNVFNDYXBhYmlsaXRpZXNcIn0pO09wZW5MYXllcnMuTGF5ZXIuR29vZ2xlLnYzPXtERUZBVUxUUzp7c3BoZXJpY2FsTWVyY2F0b3I6ITAscHJvamVjdGlvbjpcIkVQU0c6OTAwOTEzXCJ9LGFuaW1hdGlvbkVuYWJsZWQ6ITAsbG9hZE1hcE9iamVjdDpmdW5jdGlvbigpe3RoaXMudHlwZXx8KHRoaXMudHlwZT1nb29nbGUubWFwcy5NYXBUeXBlSWQuUk9BRE1BUCk7dmFyIGEsYj1PcGVuTGF5ZXJzLkxheWVyLkdvb2dsZS5jYWNoZVt0aGlzLm1hcC5pZF07Yj8oYT1iLm1hcE9iamVjdCwrK2IuY291bnQpOihiPXRoaXMubWFwLnZpZXdQb3J0RGl2LGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSxhLmlkPXRoaXMubWFwLmlkK1wiX0dNYXBDb250YWluZXJcIixhLnN0eWxlLnBvc2l0aW9uPVwiYWJzb2x1dGVcIixhLnN0eWxlLndpZHRoPVwiMTAwJVwiLGEuc3R5bGUuaGVpZ2h0PVwiMTAwJVwiLGIuYXBwZW5kQ2hpbGQoYSksYj10aGlzLm1hcC5nZXRDZW50ZXIoKSxhPW5ldyBnb29nbGUubWFwcy5NYXAoYSx7Y2VudGVyOmI/bmV3IGdvb2dsZS5tYXBzLkxhdExuZyhiLmxhdCxcbmIubG9uKTpuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKDAsMCksem9vbTp0aGlzLm1hcC5nZXRab29tKCl8fDAsbWFwVHlwZUlkOnRoaXMudHlwZSxkaXNhYmxlRGVmYXVsdFVJOiEwLGtleWJvYXJkU2hvcnRjdXRzOiExLGRyYWdnYWJsZTohMSxkaXNhYmxlRG91YmxlQ2xpY2tab29tOiEwLHNjcm9sbHdoZWVsOiExLHN0cmVldFZpZXdDb250cm9sOiExfSksYj17bWFwT2JqZWN0OmEsY291bnQ6MX0sT3BlbkxheWVycy5MYXllci5Hb29nbGUuY2FjaGVbdGhpcy5tYXAuaWRdPWIsdGhpcy5yZXBvc2l0aW9uTGlzdGVuZXI9Z29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXJPbmNlKGEsXCJjZW50ZXJfY2hhbmdlZFwiLE9wZW5MYXllcnMuRnVuY3Rpb24uYmluZCh0aGlzLnJlcG9zaXRpb25NYXBFbGVtZW50cyx0aGlzKSkpO3RoaXMubWFwT2JqZWN0PWE7dGhpcy5zZXRHTWFwVmlzaWJpbGl0eSh0aGlzLnZpc2liaWxpdHkpfSxyZXBvc2l0aW9uTWFwRWxlbWVudHM6ZnVuY3Rpb24oKXtnb29nbGUubWFwcy5ldmVudC50cmlnZ2VyKHRoaXMubWFwT2JqZWN0LFxuXCJyZXNpemVcIik7dmFyIGE9dGhpcy5tYXBPYmplY3QuZ2V0RGl2KCkuZmlyc3RDaGlsZDtpZighYXx8Mz5hLmNoaWxkTm9kZXMubGVuZ3RoKXJldHVybiB0aGlzLnJlcG9zaXRpb25UaW1lcj13aW5kb3cuc2V0VGltZW91dChPcGVuTGF5ZXJzLkZ1bmN0aW9uLmJpbmQodGhpcy5yZXBvc2l0aW9uTWFwRWxlbWVudHMsdGhpcyksMjUwKSwhMTtmb3IodmFyIGI9T3BlbkxheWVycy5MYXllci5Hb29nbGUuY2FjaGVbdGhpcy5tYXAuaWRdLGM9dGhpcy5tYXAudmlld1BvcnREaXYsZD1hLmNoaWxkcmVuLmxlbmd0aC0xOzA8PWQ7LS1kKXtpZigxMDAwMDAxPT1hLmNoaWxkcmVuW2RdLnN0eWxlLnpJbmRleCl7dmFyIGU9YS5jaGlsZHJlbltkXTtjLmFwcGVuZENoaWxkKGUpO2Uuc3R5bGUuekluZGV4PVwiMTEwMFwiO2Uuc3R5bGUuYm90dG9tPVwiXCI7ZS5jbGFzc05hbWU9XCJvbExheWVyR29vZ2xlQ29weXJpZ2h0IG9sTGF5ZXJHb29nbGVWM1wiO2Uuc3R5bGUuZGlzcGxheT1cIlwiO2IudGVybXNPZlVzZT1cbmV9MUU2PT1hLmNoaWxkcmVuW2RdLnN0eWxlLnpJbmRleCYmKGU9YS5jaGlsZHJlbltkXSxjLmFwcGVuZENoaWxkKGUpLGUuc3R5bGUuekluZGV4PVwiMTEwMFwiLGUuc3R5bGUuYm90dG9tPVwiXCIsZS5jbGFzc05hbWU9XCJvbExheWVyR29vZ2xlUG93ZXJlZEJ5IG9sTGF5ZXJHb29nbGVWMyBnbW5vcHJpbnRcIixlLnN0eWxlLmRpc3BsYXk9XCJcIixiLnBvd2VyZWRCeT1lKTsxMDAwMDAwMj09YS5jaGlsZHJlbltkXS5zdHlsZS56SW5kZXgmJmMuYXBwZW5kQ2hpbGQoYS5jaGlsZHJlbltkXSl9dGhpcy5zZXRHTWFwVmlzaWJpbGl0eSh0aGlzLnZpc2liaWxpdHkpfSxvbk1hcFJlc2l6ZTpmdW5jdGlvbigpe2lmKHRoaXMudmlzaWJpbGl0eSlnb29nbGUubWFwcy5ldmVudC50cmlnZ2VyKHRoaXMubWFwT2JqZWN0LFwicmVzaXplXCIpO2Vsc2V7dmFyIGE9T3BlbkxheWVycy5MYXllci5Hb29nbGUuY2FjaGVbdGhpcy5tYXAuaWRdO2lmKCFhLnJlc2l6ZWQpe3ZhciBiPXRoaXM7Z29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXJPbmNlKHRoaXMubWFwT2JqZWN0LFxuXCJ0aWxlc2xvYWRlZFwiLGZ1bmN0aW9uKCl7Z29vZ2xlLm1hcHMuZXZlbnQudHJpZ2dlcihiLm1hcE9iamVjdCxcInJlc2l6ZVwiKTtiLm1vdmVUbyhiLm1hcC5nZXRDZW50ZXIoKSxiLm1hcC5nZXRab29tKCkpO2RlbGV0ZSBhLnJlc2l6ZWR9KX1hLnJlc2l6ZWQ9ITB9fSxzZXRHTWFwVmlzaWJpbGl0eTpmdW5jdGlvbihhKXt2YXIgYj1PcGVuTGF5ZXJzLkxheWVyLkdvb2dsZS5jYWNoZVt0aGlzLm1hcC5pZF07aWYoYil7Zm9yKHZhciBjPXRoaXMudHlwZSxkPXRoaXMubWFwLmxheWVycyxlLGY9ZC5sZW5ndGgtMTswPD1mOy0tZilpZihlPWRbZl0sZSBpbnN0YW5jZW9mIE9wZW5MYXllcnMuTGF5ZXIuR29vZ2xlJiYhMD09PWUudmlzaWJpbGl0eSYmITA9PT1lLmluUmFuZ2Upe2M9ZS50eXBlO2E9ITA7YnJlYWt9ZD10aGlzLm1hcE9iamVjdC5nZXREaXYoKTshMD09PWE/KHRoaXMubWFwT2JqZWN0LnNldE1hcFR5cGVJZChjKSxkLnN0eWxlLmxlZnQ9XCJcIixiLnRlcm1zT2ZVc2UmJmIudGVybXNPZlVzZS5zdHlsZSYmXG4oYi50ZXJtc09mVXNlLnN0eWxlLmxlZnQ9XCJcIixiLnRlcm1zT2ZVc2Uuc3R5bGUuZGlzcGxheT1cIlwiLGIucG93ZXJlZEJ5LnN0eWxlLmRpc3BsYXk9XCJcIiksYi5kaXNwbGF5ZWQ9dGhpcy5pZCk6KGRlbGV0ZSBiLmRpc3BsYXllZCxkLnN0eWxlLmxlZnQ9XCItOTk5OXB4XCIsYi50ZXJtc09mVXNlJiZiLnRlcm1zT2ZVc2Uuc3R5bGUmJihiLnRlcm1zT2ZVc2Uuc3R5bGUuZGlzcGxheT1cIm5vbmVcIixiLnRlcm1zT2ZVc2Uuc3R5bGUubGVmdD1cIi05OTk5cHhcIixiLnBvd2VyZWRCeS5zdHlsZS5kaXNwbGF5PVwibm9uZVwiKSl9fSxnZXRNYXBDb250YWluZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXBPYmplY3QuZ2V0RGl2KCl9LGdldE1hcE9iamVjdEJvdW5kc0Zyb21PTEJvdW5kczpmdW5jdGlvbihhKXt2YXIgYj1udWxsO251bGwhPWEmJihiPXRoaXMuc3BoZXJpY2FsTWVyY2F0b3I/dGhpcy5pbnZlcnNlTWVyY2F0b3IoYS5ib3R0b20sYS5sZWZ0KTpuZXcgT3BlbkxheWVycy5Mb25MYXQoYS5ib3R0b20sXG5hLmxlZnQpLGE9dGhpcy5zcGhlcmljYWxNZXJjYXRvcj90aGlzLmludmVyc2VNZXJjYXRvcihhLnRvcCxhLnJpZ2h0KTpuZXcgT3BlbkxheWVycy5Mb25MYXQoYS50b3AsYS5yaWdodCksYj1uZXcgZ29vZ2xlLm1hcHMuTGF0TG5nQm91bmRzKG5ldyBnb29nbGUubWFwcy5MYXRMbmcoYi5sYXQsYi5sb24pLG5ldyBnb29nbGUubWFwcy5MYXRMbmcoYS5sYXQsYS5sb24pKSk7cmV0dXJuIGJ9LGdldE1hcE9iamVjdExvbkxhdEZyb21NYXBPYmplY3RQaXhlbDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLm1hcC5nZXRTaXplKCksYz10aGlzLmdldExvbmdpdHVkZUZyb21NYXBPYmplY3RMb25MYXQodGhpcy5tYXBPYmplY3QuY2VudGVyKSxkPXRoaXMuZ2V0TGF0aXR1ZGVGcm9tTWFwT2JqZWN0TG9uTGF0KHRoaXMubWFwT2JqZWN0LmNlbnRlciksZT10aGlzLm1hcC5nZXRSZXNvbHV0aW9uKCksYT1uZXcgT3BlbkxheWVycy5Mb25MYXQoYysoYS54LWIudy8yKSplLGQtKGEueS1iLmgvMikqZSk7XG50aGlzLndyYXBEYXRlTGluZSYmKGE9YS53cmFwRGF0ZUxpbmUodGhpcy5tYXhFeHRlbnQpKTtyZXR1cm4gdGhpcy5nZXRNYXBPYmplY3RMb25MYXRGcm9tTG9uTGF0KGEubG9uLGEubGF0KX0sZ2V0TWFwT2JqZWN0UGl4ZWxGcm9tTWFwT2JqZWN0TG9uTGF0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuZ2V0TG9uZ2l0dWRlRnJvbU1hcE9iamVjdExvbkxhdChhKSxhPXRoaXMuZ2V0TGF0aXR1ZGVGcm9tTWFwT2JqZWN0TG9uTGF0KGEpLGM9dGhpcy5tYXAuZ2V0UmVzb2x1dGlvbigpLGQ9dGhpcy5tYXAuZ2V0RXh0ZW50KCk7cmV0dXJuIHRoaXMuZ2V0TWFwT2JqZWN0UGl4ZWxGcm9tWFkoMS9jKihiLWQubGVmdCksMS9jKihkLnRvcC1hKSl9LHNldE1hcE9iamVjdENlbnRlcjpmdW5jdGlvbihhLGIpe2lmKCExPT09dGhpcy5hbmltYXRpb25FbmFibGVkJiZiIT10aGlzLm1hcE9iamVjdC56b29tKXt2YXIgYz10aGlzLmdldE1hcENvbnRhaW5lcigpO2dvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyT25jZSh0aGlzLm1hcE9iamVjdCxcblwiaWRsZVwiLGZ1bmN0aW9uKCl7Yy5zdHlsZS52aXNpYmlsaXR5PVwiXCJ9KTtjLnN0eWxlLnZpc2liaWxpdHk9XCJoaWRkZW5cIn10aGlzLm1hcE9iamVjdC5zZXRPcHRpb25zKHtjZW50ZXI6YSx6b29tOmJ9KX0sZ2V0TWFwT2JqZWN0Wm9vbUZyb21NYXBPYmplY3RCb3VuZHM6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMubWFwT2JqZWN0LmdldEJvdW5kc1pvb21MZXZlbChhKX0sZ2V0TWFwT2JqZWN0TG9uTGF0RnJvbUxvbkxhdDpmdW5jdGlvbihhLGIpe3ZhciBjO3RoaXMuc3BoZXJpY2FsTWVyY2F0b3I/KGM9dGhpcy5pbnZlcnNlTWVyY2F0b3IoYSxiKSxjPW5ldyBnb29nbGUubWFwcy5MYXRMbmcoYy5sYXQsYy5sb24pKTpjPW5ldyBnb29nbGUubWFwcy5MYXRMbmcoYixhKTtyZXR1cm4gY30sZ2V0TWFwT2JqZWN0UGl4ZWxGcm9tWFk6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IGdvb2dsZS5tYXBzLlBvaW50KGEsYil9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLnJlcG9zaXRpb25MaXN0ZW5lciYmXG5nb29nbGUubWFwcy5ldmVudC5yZW1vdmVMaXN0ZW5lcih0aGlzLnJlcG9zaXRpb25MaXN0ZW5lcik7dGhpcy5yZXBvc2l0aW9uVGltZXImJndpbmRvdy5jbGVhclRpbWVvdXQodGhpcy5yZXBvc2l0aW9uVGltZXIpO09wZW5MYXllcnMuTGF5ZXIuR29vZ2xlLnByb3RvdHlwZS5kZXN0cm95LmFwcGx5KHRoaXMsYXJndW1lbnRzKX19O09wZW5MYXllcnMuRm9ybWF0LldQU0Rlc2NyaWJlUHJvY2Vzcz1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuRm9ybWF0LlhNTCx7VkVSU0lPTjpcIjEuMC4wXCIsbmFtZXNwYWNlczp7d3BzOlwiaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC93cHMvMS4wLjBcIixvd3M6XCJodHRwOi8vd3d3Lm9wZW5naXMubmV0L293cy8xLjFcIix4c2k6XCJodHRwOi8vd3d3LnczLm9yZy8yMDAxL1hNTFNjaGVtYS1pbnN0YW5jZVwifSxzY2hlbWFMb2NhdGlvbjpcImh0dHA6Ly93d3cub3Blbmdpcy5uZXQvd3BzLzEuMC4wIGh0dHA6Ly9zY2hlbWFzLm9wZW5naXMubmV0L3dwcy8xLjAuMC93cHNBbGwueHNkXCIsZGVmYXVsdFByZWZpeDpcIndwc1wiLHJlZ0V4ZXM6e3RyaW1TcGFjZTovXlxccyp8XFxzKiQvZyxyZW1vdmVTcGFjZTovXFxzKi9nLHNwbGl0U3BhY2U6L1xccysvLHRyaW1Db21tYTovXFxzKixcXHMqL2d9LHJlYWQ6ZnVuY3Rpb24oYSl7XCJzdHJpbmdcIj09dHlwZW9mIGEmJihhPU9wZW5MYXllcnMuRm9ybWF0LlhNTC5wcm90b3R5cGUucmVhZC5hcHBseSh0aGlzLFxuW2FdKSk7YSYmOT09YS5ub2RlVHlwZSYmKGE9YS5kb2N1bWVudEVsZW1lbnQpO3ZhciBiPXt9O3RoaXMucmVhZE5vZGUoYSxiKTtyZXR1cm4gYn0scmVhZGVyczp7d3BzOntQcm9jZXNzRGVzY3JpcHRpb25zOmZ1bmN0aW9uKGEsYil7Yi5wcm9jZXNzRGVzY3JpcHRpb25zPXt9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxiLnByb2Nlc3NEZXNjcmlwdGlvbnMpfSxQcm9jZXNzRGVzY3JpcHRpb246ZnVuY3Rpb24oYSxiKXt2YXIgYz17cHJvY2Vzc1ZlcnNpb246dGhpcy5nZXRBdHRyaWJ1dGVOUyhhLHRoaXMubmFtZXNwYWNlcy53cHMsXCJwcm9jZXNzVmVyc2lvblwiKSxzdGF0dXNTdXBwb3J0ZWQ6XCJ0cnVlXCI9PT1hLmdldEF0dHJpYnV0ZShcInN0YXR1c1N1cHBvcnRlZFwiKSxzdG9yZVN1cHBvcnRlZDpcInRydWVcIj09PWEuZ2V0QXR0cmlidXRlKFwic3RvcmVTdXBwb3J0ZWRcIil9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKTtiW2MuaWRlbnRpZmllcl09Y30sRGF0YUlucHV0czpmdW5jdGlvbihhLFxuYil7Yi5kYXRhSW5wdXRzPVtdO3RoaXMucmVhZENoaWxkTm9kZXMoYSxiLmRhdGFJbnB1dHMpfSxQcm9jZXNzT3V0cHV0czpmdW5jdGlvbihhLGIpe2IucHJvY2Vzc091dHB1dHM9W107dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIucHJvY2Vzc091dHB1dHMpfSxPdXRwdXQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz17fTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYyk7Yi5wdXNoKGMpfSxDb21wbGV4T3V0cHV0OmZ1bmN0aW9uKGEsYil7Yi5jb21wbGV4T3V0cHV0PXt9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxiLmNvbXBsZXhPdXRwdXQpfSxJbnB1dDpmdW5jdGlvbihhLGIpe3ZhciBjPXttYXhPY2N1cnM6cGFyc2VJbnQoYS5nZXRBdHRyaWJ1dGUoXCJtYXhPY2N1cnNcIikpLG1pbk9jY3VyczpwYXJzZUludChhLmdldEF0dHJpYnV0ZShcIm1pbk9jY3Vyc1wiKSl9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKTtiLnB1c2goYyl9LEJvdW5kaW5nQm94RGF0YTpmdW5jdGlvbihhLGIpe2IuYm91bmRpbmdCb3hEYXRhPVxue307dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIuYm91bmRpbmdCb3hEYXRhKX0sQ1JTOmZ1bmN0aW9uKGEsYil7Yi5DUlNzfHwoYi5DUlNzPXt9KTtiLkNSU3NbdGhpcy5nZXRDaGlsZFZhbHVlKGEpXT0hMH0sTGl0ZXJhbERhdGE6ZnVuY3Rpb24oYSxiKXtiLmxpdGVyYWxEYXRhPXt9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxiLmxpdGVyYWxEYXRhKX0sQ29tcGxleERhdGE6ZnVuY3Rpb24oYSxiKXtiLmNvbXBsZXhEYXRhPXt9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxiLmNvbXBsZXhEYXRhKX0sRGVmYXVsdDpmdW5jdGlvbihhLGIpe2JbXCJkZWZhdWx0XCJdPXt9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxiW1wiZGVmYXVsdFwiXSl9LFN1cHBvcnRlZDpmdW5jdGlvbihhLGIpe2Iuc3VwcG9ydGVkPXt9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxiLnN1cHBvcnRlZCl9LEZvcm1hdDpmdW5jdGlvbihhLGIpe3ZhciBjPXt9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKTtiLmZvcm1hdHN8fChiLmZvcm1hdHM9XG57fSk7Yi5mb3JtYXRzW2MubWltZVR5cGVdPSEwfSxNaW1lVHlwZTpmdW5jdGlvbihhLGIpe2IubWltZVR5cGU9dGhpcy5nZXRDaGlsZFZhbHVlKGEpfX0sb3dzOk9wZW5MYXllcnMuRm9ybWF0Lk9XU0NvbW1vbi52MV8xXzAucHJvdG90eXBlLnJlYWRlcnMub3dzfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Gb3JtYXQuV1BTRGVzY3JpYmVQcm9jZXNzXCJ9KTtPcGVuTGF5ZXJzLkZvcm1hdC5DU1dHZXRSZWNvcmRzLnYyXzBfMj1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuRm9ybWF0LlhNTCx7bmFtZXNwYWNlczp7Y3N3OlwiaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC9jYXQvY3N3LzIuMC4yXCIsZGM6XCJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xL1wiLGRjdDpcImh0dHA6Ly9wdXJsLm9yZy9kYy90ZXJtcy9cIixnbWQ6XCJodHRwOi8vd3d3Lmlzb3RjMjExLm9yZy8yMDA1L2dtZFwiLGdlb25ldDpcImh0dHA6Ly93d3cuZmFvLm9yZy9nZW9uZXR3b3JrXCIsb2djOlwiaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC9vZ2NcIixvd3M6XCJodHRwOi8vd3d3Lm9wZW5naXMubmV0L293c1wiLHhsaW5rOlwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGlua1wiLHhzaTpcImh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hLWluc3RhbmNlXCJ9LGRlZmF1bHRQcmVmaXg6XCJjc3dcIix2ZXJzaW9uOlwiMi4wLjJcIixzY2hlbWFMb2NhdGlvbjpcImh0dHA6Ly93d3cub3Blbmdpcy5uZXQvY2F0L2Nzdy8yLjAuMiBodHRwOi8vc2NoZW1hcy5vcGVuZ2lzLm5ldC9jc3cvMi4wLjIvQ1NXLWRpc2NvdmVyeS54c2RcIixcbnJlcXVlc3RJZDpudWxsLHJlc3VsdFR5cGU6bnVsbCxvdXRwdXRGb3JtYXQ6bnVsbCxvdXRwdXRTY2hlbWE6bnVsbCxzdGFydFBvc2l0aW9uOm51bGwsbWF4UmVjb3JkczpudWxsLERpc3RyaWJ1dGVkU2VhcmNoOm51bGwsUmVzcG9uc2VIYW5kbGVyOm51bGwsUXVlcnk6bnVsbCxyZWdFeGVzOnt0cmltU3BhY2U6L15cXHMqfFxccyokL2cscmVtb3ZlU3BhY2U6L1xccyovZyxzcGxpdFNwYWNlOi9cXHMrLyx0cmltQ29tbWE6L1xccyosXFxzKi9nfSxpbml0aWFsaXplOmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuRm9ybWF0LlhNTC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLFthXSl9LHJlYWQ6ZnVuY3Rpb24oYSl7XCJzdHJpbmdcIj09dHlwZW9mIGEmJihhPU9wZW5MYXllcnMuRm9ybWF0LlhNTC5wcm90b3R5cGUucmVhZC5hcHBseSh0aGlzLFthXSkpO2EmJjk9PWEubm9kZVR5cGUmJihhPWEuZG9jdW1lbnRFbGVtZW50KTt2YXIgYj17fTt0aGlzLnJlYWROb2RlKGEsYik7cmV0dXJuIGJ9LFxucmVhZGVyczp7Y3N3OntHZXRSZWNvcmRzUmVzcG9uc2U6ZnVuY3Rpb24oYSxiKXtiLnJlY29yZHM9W107dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIpO3ZhciBjPXRoaXMuZ2V0QXR0cmlidXRlTlMoYSxcIlwiLFwidmVyc2lvblwiKTtcIlwiIT1jJiYoYi52ZXJzaW9uPWMpfSxSZXF1ZXN0SWQ6ZnVuY3Rpb24oYSxiKXtiLlJlcXVlc3RJZD10aGlzLmdldENoaWxkVmFsdWUoYSl9LFNlYXJjaFN0YXR1czpmdW5jdGlvbihhLGIpe2IuU2VhcmNoU3RhdHVzPXt9O3ZhciBjPXRoaXMuZ2V0QXR0cmlidXRlTlMoYSxcIlwiLFwidGltZXN0YW1wXCIpO1wiXCIhPWMmJihiLlNlYXJjaFN0YXR1cy50aW1lc3RhbXA9Yyl9LFNlYXJjaFJlc3VsdHM6ZnVuY3Rpb24oYSxiKXt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYik7Zm9yKHZhciBjPWEuYXR0cmlidXRlcyxkPXt9LGU9MCxmPWMubGVuZ3RoO2U8ZjsrK2UpZFtjW2VdLm5hbWVdPVwibnVtYmVyT2ZSZWNvcmRzTWF0Y2hlZFwiPT1jW2VdLm5hbWV8fFwibnVtYmVyT2ZSZWNvcmRzUmV0dXJuZWRcIj09XG5jW2VdLm5hbWV8fFwibmV4dFJlY29yZFwiPT1jW2VdLm5hbWU/cGFyc2VJbnQoY1tlXS5ub2RlVmFsdWUpOmNbZV0ubm9kZVZhbHVlO2IuU2VhcmNoUmVzdWx0cz1kfSxTdW1tYXJ5UmVjb3JkOmZ1bmN0aW9uKGEsYil7dmFyIGM9e3R5cGU6XCJTdW1tYXJ5UmVjb3JkXCJ9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKTtiLnJlY29yZHMucHVzaChjKX0sQnJpZWZSZWNvcmQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz17dHlwZTpcIkJyaWVmUmVjb3JkXCJ9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKTtiLnJlY29yZHMucHVzaChjKX0sRENNSVJlY29yZDpmdW5jdGlvbihhLGIpe3ZhciBjPXt0eXBlOlwiRENNSVJlY29yZFwifTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYyk7Yi5yZWNvcmRzLnB1c2goYyl9LFJlY29yZDpmdW5jdGlvbihhLGIpe3ZhciBjPXt0eXBlOlwiUmVjb3JkXCJ9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKTtiLnJlY29yZHMucHVzaChjKX0sXCIqXCI6ZnVuY3Rpb24oYSxiKXt2YXIgYz1hLmxvY2FsTmFtZXx8XG5hLm5vZGVOYW1lLnNwbGl0KFwiOlwiKS5wb3AoKTtiW2NdPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKX19LGdlb25ldDp7aW5mbzpmdW5jdGlvbihhLGIpe3ZhciBjPXt9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKTtiLmduaW5mbz1jfX0sZGM6e1wiKlwiOmZ1bmN0aW9uKGEsYil7dmFyIGM9YS5sb2NhbE5hbWV8fGEubm9kZU5hbWUuc3BsaXQoXCI6XCIpLnBvcCgpO09wZW5MYXllcnMuVXRpbC5pc0FycmF5KGJbY10pfHwoYltjXT1bXSk7Zm9yKHZhciBkPXt9LGU9YS5hdHRyaWJ1dGVzLGY9MCxnPWUubGVuZ3RoO2Y8ZzsrK2YpZFtlW2ZdLm5hbWVdPWVbZl0ubm9kZVZhbHVlO2QudmFsdWU9dGhpcy5nZXRDaGlsZFZhbHVlKGEpO1wiXCIhPWQudmFsdWUmJmJbY10ucHVzaChkKX19LGRjdDp7XCIqXCI6ZnVuY3Rpb24oYSxiKXt2YXIgYz1hLmxvY2FsTmFtZXx8YS5ub2RlTmFtZS5zcGxpdChcIjpcIikucG9wKCk7T3BlbkxheWVycy5VdGlsLmlzQXJyYXkoYltjXSl8fChiW2NdPVtdKTtiW2NdLnB1c2godGhpcy5nZXRDaGlsZFZhbHVlKGEpKX19LFxub3dzOk9wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKHtCb3VuZGluZ0JveDpmdW5jdGlvbihhLGIpe2IuYm91bmRzJiYoYi5Cb3VuZGluZ0JveD1be2NyczpiLnByb2plY3Rpb24sdmFsdWU6W2IuYm91bmRzLmxlZnQsYi5ib3VuZHMuYm90dG9tLGIuYm91bmRzLnJpZ2h0LGIuYm91bmRzLnRvcF19XSxkZWxldGUgYi5wcm9qZWN0aW9uLGRlbGV0ZSBiLmJvdW5kcyk7T3BlbkxheWVycy5Gb3JtYXQuT1dTQ29tbW9uLnYxXzBfMC5wcm90b3R5cGUucmVhZGVycy5vd3MuQm91bmRpbmdCb3guYXBwbHkodGhpcyxhcmd1bWVudHMpfX0sT3BlbkxheWVycy5Gb3JtYXQuT1dTQ29tbW9uLnYxXzBfMC5wcm90b3R5cGUucmVhZGVycy5vd3MpfSx3cml0ZTpmdW5jdGlvbihhKXthPXRoaXMud3JpdGVOb2RlKFwiY3N3OkdldFJlY29yZHNcIixhKTthLnNldEF0dHJpYnV0ZShcInhtbG5zOmdtZFwiLHRoaXMubmFtZXNwYWNlcy5nbWQpO3JldHVybiBPcGVuTGF5ZXJzLkZvcm1hdC5YTUwucHJvdG90eXBlLndyaXRlLmFwcGx5KHRoaXMsXG5bYV0pfSx3cml0ZXJzOntjc3c6e0dldFJlY29yZHM6ZnVuY3Rpb24oYSl7YXx8KGE9e30pO3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcImNzdzpHZXRSZWNvcmRzXCIse2F0dHJpYnV0ZXM6e3NlcnZpY2U6XCJDU1dcIix2ZXJzaW9uOnRoaXMudmVyc2lvbixyZXF1ZXN0SWQ6YS5yZXF1ZXN0SWR8fHRoaXMucmVxdWVzdElkLHJlc3VsdFR5cGU6YS5yZXN1bHRUeXBlfHx0aGlzLnJlc3VsdFR5cGUsb3V0cHV0Rm9ybWF0OmEub3V0cHV0Rm9ybWF0fHx0aGlzLm91dHB1dEZvcm1hdCxvdXRwdXRTY2hlbWE6YS5vdXRwdXRTY2hlbWF8fHRoaXMub3V0cHV0U2NoZW1hLHN0YXJ0UG9zaXRpb246YS5zdGFydFBvc2l0aW9ufHx0aGlzLnN0YXJ0UG9zaXRpb24sbWF4UmVjb3JkczphLm1heFJlY29yZHN8fHRoaXMubWF4UmVjb3Jkc319KTtpZihhLkRpc3RyaWJ1dGVkU2VhcmNofHx0aGlzLkRpc3RyaWJ1dGVkU2VhcmNoKXRoaXMud3JpdGVOb2RlKFwiY3N3OkRpc3RyaWJ1dGVkU2VhcmNoXCIsXG5hLkRpc3RyaWJ1dGVkU2VhcmNofHx0aGlzLkRpc3RyaWJ1dGVkU2VhcmNoLGIpO3ZhciBjPWEuUmVzcG9uc2VIYW5kbGVyfHx0aGlzLlJlc3BvbnNlSGFuZGxlcjtpZihPcGVuTGF5ZXJzLlV0aWwuaXNBcnJheShjKSYmMDxjLmxlbmd0aClmb3IodmFyIGQ9MCxlPWMubGVuZ3RoO2Q8ZTtkKyspdGhpcy53cml0ZU5vZGUoXCJjc3c6UmVzcG9uc2VIYW5kbGVyXCIsY1tkXSxiKTt0aGlzLndyaXRlTm9kZShcIlF1ZXJ5XCIsYS5RdWVyeXx8dGhpcy5RdWVyeSxiKTtyZXR1cm4gYn0sRGlzdHJpYnV0ZWRTZWFyY2g6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcImNzdzpEaXN0cmlidXRlZFNlYXJjaFwiLHthdHRyaWJ1dGVzOntob3BDb3VudDphLmhvcENvdW50fX0pfSxSZXNwb25zZUhhbmRsZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcImNzdzpSZXNwb25zZUhhbmRsZXJcIix7dmFsdWU6YS52YWx1ZX0pfSxRdWVyeTpmdW5jdGlvbihhKXthfHxcbihhPXt9KTt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJjc3c6UXVlcnlcIix7YXR0cmlidXRlczp7dHlwZU5hbWVzOmEudHlwZU5hbWVzfHxcImNzdzpSZWNvcmRcIn19KSxjPWEuRWxlbWVudE5hbWU7aWYoT3BlbkxheWVycy5VdGlsLmlzQXJyYXkoYykmJjA8Yy5sZW5ndGgpZm9yKHZhciBkPTAsZT1jLmxlbmd0aDtkPGU7ZCsrKXRoaXMud3JpdGVOb2RlKFwiY3N3OkVsZW1lbnROYW1lXCIsY1tkXSxiKTtlbHNlIHRoaXMud3JpdGVOb2RlKFwiY3N3OkVsZW1lbnRTZXROYW1lXCIsYS5FbGVtZW50U2V0TmFtZXx8e3ZhbHVlOlwic3VtbWFyeVwifSxiKTthLkNvbnN0cmFpbnQmJnRoaXMud3JpdGVOb2RlKFwiY3N3OkNvbnN0cmFpbnRcIixhLkNvbnN0cmFpbnQsYik7YS5Tb3J0QnkmJnRoaXMud3JpdGVOb2RlKFwib2djOlNvcnRCeVwiLGEuU29ydEJ5LGIpO3JldHVybiBifSxFbGVtZW50TmFtZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiY3N3OkVsZW1lbnROYW1lXCIsXG57dmFsdWU6YS52YWx1ZX0pfSxFbGVtZW50U2V0TmFtZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiY3N3OkVsZW1lbnRTZXROYW1lXCIse2F0dHJpYnV0ZXM6e3R5cGVOYW1lczphLnR5cGVOYW1lc30sdmFsdWU6YS52YWx1ZX0pfSxDb25zdHJhaW50OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcImNzdzpDb25zdHJhaW50XCIse2F0dHJpYnV0ZXM6e3ZlcnNpb246YS52ZXJzaW9ufX0pO2lmKGEuRmlsdGVyKXt2YXIgYz1uZXcgT3BlbkxheWVycy5Gb3JtYXQuRmlsdGVyKHt2ZXJzaW9uOmEudmVyc2lvbn0pO2IuYXBwZW5kQ2hpbGQoYy53cml0ZShhLkZpbHRlcikpfWVsc2UgYS5DcWxUZXh0JiYoYT10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJDcWxUZXh0XCIse3ZhbHVlOmEuQ3FsVGV4dC52YWx1ZX0pLGIuYXBwZW5kQ2hpbGQoYSkpO3JldHVybiBifX0sb2djOk9wZW5MYXllcnMuRm9ybWF0LkZpbHRlci52MV8xXzAucHJvdG90eXBlLndyaXRlcnMub2djfSxcbkNMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZvcm1hdC5DU1dHZXRSZWNvcmRzLnYyXzBfMlwifSk7T3BlbkxheWVycy5NYXJrZXIuQm94PU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5NYXJrZXIse2JvdW5kczpudWxsLGRpdjpudWxsLGluaXRpYWxpemU6ZnVuY3Rpb24oYSxiLGMpe3RoaXMuYm91bmRzPWE7dGhpcy5kaXY9T3BlbkxheWVycy5VdGlsLmNyZWF0ZURpdigpO3RoaXMuZGl2LnN0eWxlLm92ZXJmbG93PVwiaGlkZGVuXCI7dGhpcy5ldmVudHM9bmV3IE9wZW5MYXllcnMuRXZlbnRzKHRoaXMsdGhpcy5kaXYpO3RoaXMuc2V0Qm9yZGVyKGIsYyl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLmRpdj10aGlzLmJvdW5kcz1udWxsO09wZW5MYXllcnMuTWFya2VyLnByb3RvdHlwZS5kZXN0cm95LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sc2V0Qm9yZGVyOmZ1bmN0aW9uKGEsYil7YXx8KGE9XCJyZWRcIik7Ynx8KGI9Mik7dGhpcy5kaXYuc3R5bGUuYm9yZGVyPWIrXCJweCBzb2xpZCBcIithfSxkcmF3OmZ1bmN0aW9uKGEsYil7T3BlbkxheWVycy5VdGlsLm1vZGlmeURPTUVsZW1lbnQodGhpcy5kaXYsXG5udWxsLGEsYik7cmV0dXJuIHRoaXMuZGl2fSxvblNjcmVlbjpmdW5jdGlvbigpe3ZhciBhPSExO3RoaXMubWFwJiYoYT10aGlzLm1hcC5nZXRFeHRlbnQoKS5jb250YWluc0JvdW5kcyh0aGlzLmJvdW5kcywhMCwhMCkpO3JldHVybiBhfSxkaXNwbGF5OmZ1bmN0aW9uKGEpe3RoaXMuZGl2LnN0eWxlLmRpc3BsYXk9YT9cIlwiOlwibm9uZVwifSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5NYXJrZXIuQm94XCJ9KTtPcGVuTGF5ZXJzLkZvcm1hdC5UZXh0PU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Gb3JtYXQse2RlZmF1bHRTdHlsZTpudWxsLGV4dHJhY3RTdHlsZXM6ITAsaW5pdGlhbGl6ZTpmdW5jdGlvbihhKXthPWF8fHt9OyExIT09YS5leHRyYWN0U3R5bGVzJiYoYS5kZWZhdWx0U3R5bGU9e2V4dGVybmFsR3JhcGhpYzpPcGVuTGF5ZXJzLlV0aWwuZ2V0SW1hZ2VMb2NhdGlvbihcIm1hcmtlci5wbmdcIiksZ3JhcGhpY1dpZHRoOjIxLGdyYXBoaWNIZWlnaHQ6MjUsZ3JhcGhpY1hPZmZzZXQ6LTEwLjUsZ3JhcGhpY1lPZmZzZXQ6LTEyLjV9KTtPcGVuTGF5ZXJzLkZvcm1hdC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLFthXSl9LHJlYWQ6ZnVuY3Rpb24oYSl7Zm9yKHZhciBhPWEuc3BsaXQoXCJcXG5cIiksYixjPVtdLGQ9MDtkPGEubGVuZ3RoLTE7ZCsrKXt2YXIgZT1hW2RdLnJlcGxhY2UoL15cXHMqLyxcIlwiKS5yZXBsYWNlKC9cXHMqJC8sXCJcIik7aWYoXCIjXCIhPWUuY2hhckF0KDApKWlmKGIpe2Zvcih2YXIgZT1cbmUuc3BsaXQoXCJcXHRcIiksZj1uZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludCgwLDApLGc9e30saD10aGlzLmRlZmF1bHRTdHlsZT9PcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyh7fSx0aGlzLmRlZmF1bHRTdHlsZSk6bnVsbCxpPSExLGo9MDtqPGUubGVuZ3RoO2orKylpZihlW2pdKWlmKFwicG9pbnRcIj09YltqXSlpPWVbal0uc3BsaXQoXCIsXCIpLGYueT1wYXJzZUZsb2F0KGlbMF0pLGYueD1wYXJzZUZsb2F0KGlbMV0pLGk9ITA7ZWxzZSBpZihcImxhdFwiPT1iW2pdKWYueT1wYXJzZUZsb2F0KGVbal0pLGk9ITA7ZWxzZSBpZihcImxvblwiPT1iW2pdKWYueD1wYXJzZUZsb2F0KGVbal0pLGk9ITA7ZWxzZSBpZihcInRpdGxlXCI9PWJbal0pZy50aXRsZT1lW2pdO2Vsc2UgaWYoXCJpbWFnZVwiPT1iW2pdfHxcImljb25cIj09YltqXSYmaCloLmV4dGVybmFsR3JhcGhpYz1lW2pdO2Vsc2UgaWYoXCJpY29uU2l6ZVwiPT1iW2pdJiZoKXt2YXIgaz1lW2pdLnNwbGl0KFwiLFwiKTtoLmdyYXBoaWNXaWR0aD1cbnBhcnNlRmxvYXQoa1swXSk7aC5ncmFwaGljSGVpZ2h0PXBhcnNlRmxvYXQoa1sxXSl9ZWxzZVwiaWNvbk9mZnNldFwiPT1iW2pdJiZoPyhrPWVbal0uc3BsaXQoXCIsXCIpLGguZ3JhcGhpY1hPZmZzZXQ9cGFyc2VGbG9hdChrWzBdKSxoLmdyYXBoaWNZT2Zmc2V0PXBhcnNlRmxvYXQoa1sxXSkpOlwiZGVzY3JpcHRpb25cIj09YltqXT9nLmRlc2NyaXB0aW9uPWVbal06XCJvdmVyZmxvd1wiPT1iW2pdP2cub3ZlcmZsb3c9ZVtqXTpnW2Jbal1dPWVbal07aSYmKHRoaXMuaW50ZXJuYWxQcm9qZWN0aW9uJiZ0aGlzLmV4dGVybmFsUHJvamVjdGlvbiYmZi50cmFuc2Zvcm0odGhpcy5leHRlcm5hbFByb2plY3Rpb24sdGhpcy5pbnRlcm5hbFByb2plY3Rpb24pLGU9bmV3IE9wZW5MYXllcnMuRmVhdHVyZS5WZWN0b3IoZixnLGgpLGMucHVzaChlKSl9ZWxzZSBiPWUuc3BsaXQoXCJcXHRcIil9cmV0dXJuIGN9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZvcm1hdC5UZXh0XCJ9KTtPcGVuTGF5ZXJzLkxheWVyLlRleHQ9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkxheWVyLk1hcmtlcnMse2xvY2F0aW9uOm51bGwsZmVhdHVyZXM6bnVsbCxmb3JtYXRPcHRpb25zOm51bGwsc2VsZWN0ZWRGZWF0dXJlOm51bGwsaW5pdGlhbGl6ZTpmdW5jdGlvbihhLGIpe09wZW5MYXllcnMuTGF5ZXIuTWFya2Vycy5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5mZWF0dXJlcz1bXX0sZGVzdHJveTpmdW5jdGlvbigpe09wZW5MYXllcnMuTGF5ZXIuTWFya2Vycy5wcm90b3R5cGUuZGVzdHJveS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5jbGVhckZlYXR1cmVzKCk7dGhpcy5mZWF0dXJlcz1udWxsfSxsb2FkVGV4dDpmdW5jdGlvbigpeyF0aGlzLmxvYWRlZCYmbnVsbCE9dGhpcy5sb2NhdGlvbiYmKHRoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcImxvYWRzdGFydFwiKSxPcGVuTGF5ZXJzLlJlcXVlc3QuR0VUKHt1cmw6dGhpcy5sb2NhdGlvbixcbnN1Y2Nlc3M6dGhpcy5wYXJzZURhdGEsZmFpbHVyZTpmdW5jdGlvbigpe3RoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcImxvYWRlbmRcIil9LHNjb3BlOnRoaXN9KSx0aGlzLmxvYWRlZD0hMCl9LG1vdmVUbzpmdW5jdGlvbihhLGIsYyl7T3BlbkxheWVycy5MYXllci5NYXJrZXJzLnByb3RvdHlwZS5tb3ZlVG8uYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMudmlzaWJpbGl0eSYmIXRoaXMubG9hZGVkJiZ0aGlzLmxvYWRUZXh0KCl9LHBhcnNlRGF0YTpmdW5jdGlvbihhKXt2YXIgYT1hLnJlc3BvbnNlVGV4dCxiPXt9O09wZW5MYXllcnMuVXRpbC5leHRlbmQoYix0aGlzLmZvcm1hdE9wdGlvbnMpO3RoaXMubWFwJiYhdGhpcy5wcm9qZWN0aW9uLmVxdWFscyh0aGlzLm1hcC5nZXRQcm9qZWN0aW9uT2JqZWN0KCkpJiYoYi5leHRlcm5hbFByb2plY3Rpb249dGhpcy5wcm9qZWN0aW9uLGIuaW50ZXJuYWxQcm9qZWN0aW9uPXRoaXMubWFwLmdldFByb2plY3Rpb25PYmplY3QoKSk7Zm9yKHZhciBhPVxuKG5ldyBPcGVuTGF5ZXJzLkZvcm1hdC5UZXh0KGIpKS5yZWFkKGEpLGI9MCxjPWEubGVuZ3RoO2I8YztiKyspe3ZhciBkPXt9LGU9YVtiXSxmLGcsaDtmPW5ldyBPcGVuTGF5ZXJzLkxvbkxhdChlLmdlb21ldHJ5LngsZS5nZW9tZXRyeS55KTtlLnN0eWxlLmdyYXBoaWNXaWR0aCYmZS5zdHlsZS5ncmFwaGljSGVpZ2h0JiYoZz1uZXcgT3BlbkxheWVycy5TaXplKGUuc3R5bGUuZ3JhcGhpY1dpZHRoLGUuc3R5bGUuZ3JhcGhpY0hlaWdodCkpO3ZvaWQgMCE9PWUuc3R5bGUuZ3JhcGhpY1hPZmZzZXQmJnZvaWQgMCE9PWUuc3R5bGUuZ3JhcGhpY1lPZmZzZXQmJihoPW5ldyBPcGVuTGF5ZXJzLlBpeGVsKGUuc3R5bGUuZ3JhcGhpY1hPZmZzZXQsZS5zdHlsZS5ncmFwaGljWU9mZnNldCkpO251bGwhPWUuc3R5bGUuZXh0ZXJuYWxHcmFwaGljP2QuaWNvbj1uZXcgT3BlbkxheWVycy5JY29uKGUuc3R5bGUuZXh0ZXJuYWxHcmFwaGljLGcsaCk6KGQuaWNvbj1PcGVuTGF5ZXJzLk1hcmtlci5kZWZhdWx0SWNvbigpLFxubnVsbCE9ZyYmZC5pY29uLnNldFNpemUoZykpO251bGwhPWUuYXR0cmlidXRlcy50aXRsZSYmbnVsbCE9ZS5hdHRyaWJ1dGVzLmRlc2NyaXB0aW9uJiYoZC5wb3B1cENvbnRlbnRIVE1MPVwiPGgyPlwiK2UuYXR0cmlidXRlcy50aXRsZStcIjwvaDI+PHA+XCIrZS5hdHRyaWJ1dGVzLmRlc2NyaXB0aW9uK1wiPC9wPlwiKTtkLm92ZXJmbG93PWUuYXR0cmlidXRlcy5vdmVyZmxvd3x8XCJhdXRvXCI7ZD1uZXcgT3BlbkxheWVycy5GZWF0dXJlKHRoaXMsZixkKTt0aGlzLmZlYXR1cmVzLnB1c2goZCk7Zj1kLmNyZWF0ZU1hcmtlcigpO251bGwhPWUuYXR0cmlidXRlcy50aXRsZSYmbnVsbCE9ZS5hdHRyaWJ1dGVzLmRlc2NyaXB0aW9uJiZmLmV2ZW50cy5yZWdpc3RlcihcImNsaWNrXCIsZCx0aGlzLm1hcmtlckNsaWNrKTt0aGlzLmFkZE1hcmtlcihmKX10aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJsb2FkZW5kXCIpfSxtYXJrZXJDbGljazpmdW5jdGlvbihhKXt2YXIgYj10aGlzPT10aGlzLmxheWVyLnNlbGVjdGVkRmVhdHVyZTtcbnRoaXMubGF5ZXIuc2VsZWN0ZWRGZWF0dXJlPSFiP3RoaXM6bnVsbDtmb3IodmFyIGM9MCxkPXRoaXMubGF5ZXIubWFwLnBvcHVwcy5sZW5ndGg7YzxkO2MrKyl0aGlzLmxheWVyLm1hcC5yZW1vdmVQb3B1cCh0aGlzLmxheWVyLm1hcC5wb3B1cHNbY10pO2J8fHRoaXMubGF5ZXIubWFwLmFkZFBvcHVwKHRoaXMuY3JlYXRlUG9wdXAoKSk7T3BlbkxheWVycy5FdmVudC5zdG9wKGEpfSxjbGVhckZlYXR1cmVzOmZ1bmN0aW9uKCl7aWYobnVsbCE9dGhpcy5mZWF0dXJlcylmb3IoOzA8dGhpcy5mZWF0dXJlcy5sZW5ndGg7KXt2YXIgYT10aGlzLmZlYXR1cmVzWzBdO09wZW5MYXllcnMuVXRpbC5yZW1vdmVJdGVtKHRoaXMuZmVhdHVyZXMsYSk7YS5kZXN0cm95KCl9fSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5MYXllci5UZXh0XCJ9KTtPcGVuTGF5ZXJzLkhhbmRsZXIuUmVndWxhclBvbHlnb249T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkhhbmRsZXIuRHJhZyx7c2lkZXM6NCxyYWRpdXM6bnVsbCxzbmFwQW5nbGU6bnVsbCxzbmFwVG9nZ2xlOlwic2hpZnRLZXlcIixsYXllck9wdGlvbnM6bnVsbCxwZXJzaXN0OiExLGlycmVndWxhcjohMSxjaXRlQ29tcGxpYW50OiExLGFuZ2xlOm51bGwsZml4ZWRSYWRpdXM6ITEsZmVhdHVyZTpudWxsLGxheWVyOm51bGwsb3JpZ2luOm51bGwsaW5pdGlhbGl6ZTpmdW5jdGlvbihhLGIsYyl7aWYoIWN8fCFjLmxheWVyT3B0aW9uc3x8IWMubGF5ZXJPcHRpb25zLnN0eWxlTWFwKXRoaXMuc3R5bGU9T3BlbkxheWVycy5VdGlsLmV4dGVuZChPcGVuTGF5ZXJzLkZlYXR1cmUuVmVjdG9yLnN0eWxlW1wiZGVmYXVsdFwiXSx7fSk7T3BlbkxheWVycy5IYW5kbGVyLkRyYWcucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbYSxiLGNdKTt0aGlzLm9wdGlvbnM9Yz9jOnt9fSxzZXRPcHRpb25zOmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuVXRpbC5leHRlbmQodGhpcy5vcHRpb25zLFxuYSk7T3BlbkxheWVycy5VdGlsLmV4dGVuZCh0aGlzLGEpfSxhY3RpdmF0ZTpmdW5jdGlvbigpe3ZhciBhPSExO09wZW5MYXllcnMuSGFuZGxlci5EcmFnLnByb3RvdHlwZS5hY3RpdmF0ZS5hcHBseSh0aGlzLGFyZ3VtZW50cykmJihhPU9wZW5MYXllcnMuVXRpbC5leHRlbmQoe2Rpc3BsYXlJbkxheWVyU3dpdGNoZXI6ITEsY2FsY3VsYXRlSW5SYW5nZTpPcGVuTGF5ZXJzLkZ1bmN0aW9uLlRydWUsd3JhcERhdGVMaW5lOnRoaXMuY2l0ZUNvbXBsaWFudH0sdGhpcy5sYXllck9wdGlvbnMpLHRoaXMubGF5ZXI9bmV3IE9wZW5MYXllcnMuTGF5ZXIuVmVjdG9yKHRoaXMuQ0xBU1NfTkFNRSxhKSx0aGlzLm1hcC5hZGRMYXllcih0aGlzLmxheWVyKSxhPSEwKTtyZXR1cm4gYX0sZGVhY3RpdmF0ZTpmdW5jdGlvbigpe3ZhciBhPSExO09wZW5MYXllcnMuSGFuZGxlci5EcmFnLnByb3RvdHlwZS5kZWFjdGl2YXRlLmFwcGx5KHRoaXMsYXJndW1lbnRzKSYmKHRoaXMuZHJhZ2dpbmcmJnRoaXMuY2FuY2VsKCksXG5udWxsIT10aGlzLmxheWVyLm1hcCYmKHRoaXMubGF5ZXIuZGVzdHJveSghMSksdGhpcy5mZWF0dXJlJiZ0aGlzLmZlYXR1cmUuZGVzdHJveSgpKSx0aGlzLmZlYXR1cmU9dGhpcy5sYXllcj1udWxsLGE9ITApO3JldHVybiBhfSxkb3duOmZ1bmN0aW9uKGEpe3RoaXMuZml4ZWRSYWRpdXM9ISF0aGlzLnJhZGl1czthPXRoaXMubGF5ZXIuZ2V0TG9uTGF0RnJvbVZpZXdQb3J0UHgoYS54eSk7dGhpcy5vcmlnaW49bmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQoYS5sb24sYS5sYXQpO2lmKCF0aGlzLmZpeGVkUmFkaXVzfHx0aGlzLmlycmVndWxhcil0aGlzLnJhZGl1cz10aGlzLm1hcC5nZXRSZXNvbHV0aW9uKCk7dGhpcy5wZXJzaXN0JiZ0aGlzLmNsZWFyKCk7dGhpcy5mZWF0dXJlPW5ldyBPcGVuTGF5ZXJzLkZlYXR1cmUuVmVjdG9yO3RoaXMuY3JlYXRlR2VvbWV0cnkoKTt0aGlzLmNhbGxiYWNrKFwiY3JlYXRlXCIsW3RoaXMub3JpZ2luLHRoaXMuZmVhdHVyZV0pO3RoaXMubGF5ZXIuYWRkRmVhdHVyZXMoW3RoaXMuZmVhdHVyZV0sXG57c2lsZW50OiEwfSk7dGhpcy5sYXllci5kcmF3RmVhdHVyZSh0aGlzLmZlYXR1cmUsdGhpcy5zdHlsZSl9LG1vdmU6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5sYXllci5nZXRMb25MYXRGcm9tVmlld1BvcnRQeChhLnh5KSxiPW5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGIubG9uLGIubGF0KTt0aGlzLmlycmVndWxhcj8oYT1NYXRoLnNxcnQoMikqTWF0aC5hYnMoYi55LXRoaXMub3JpZ2luLnkpLzIsdGhpcy5yYWRpdXM9TWF0aC5tYXgodGhpcy5tYXAuZ2V0UmVzb2x1dGlvbigpLzIsYSkpOnRoaXMuZml4ZWRSYWRpdXM/dGhpcy5vcmlnaW49YjoodGhpcy5jYWxjdWxhdGVBbmdsZShiLGEpLHRoaXMucmFkaXVzPU1hdGgubWF4KHRoaXMubWFwLmdldFJlc29sdXRpb24oKS8yLGIuZGlzdGFuY2VUbyh0aGlzLm9yaWdpbikpKTt0aGlzLm1vZGlmeUdlb21ldHJ5KCk7dGhpcy5pcnJlZ3VsYXImJihhPWIueC10aGlzLm9yaWdpbi54LGI9Yi55LXRoaXMub3JpZ2luLnksdGhpcy5mZWF0dXJlLmdlb21ldHJ5LnJlc2l6ZSgxLFxudGhpcy5vcmlnaW4sMD09Yj9hLyh0aGlzLnJhZGl1cypNYXRoLnNxcnQoMikpOmEvYiksdGhpcy5mZWF0dXJlLmdlb21ldHJ5Lm1vdmUoYS8yLGIvMikpO3RoaXMubGF5ZXIuZHJhd0ZlYXR1cmUodGhpcy5mZWF0dXJlLHRoaXMuc3R5bGUpfSx1cDpmdW5jdGlvbihhKXt0aGlzLmZpbmFsaXplKCk7dGhpcy5zdGFydD09dGhpcy5sYXN0JiZ0aGlzLmNhbGxiYWNrKFwiZG9uZVwiLFthLnh5XSl9LG91dDpmdW5jdGlvbigpe3RoaXMuZmluYWxpemUoKX0sY3JlYXRlR2VvbWV0cnk6ZnVuY3Rpb24oKXt0aGlzLmFuZ2xlPU1hdGguUEkqKDEvdGhpcy5zaWRlcy0wLjUpO3RoaXMuc25hcEFuZ2xlJiYodGhpcy5hbmdsZSs9dGhpcy5zbmFwQW5nbGUqKE1hdGguUEkvMTgwKSk7dGhpcy5mZWF0dXJlLmdlb21ldHJ5PU9wZW5MYXllcnMuR2VvbWV0cnkuUG9seWdvbi5jcmVhdGVSZWd1bGFyUG9seWdvbih0aGlzLm9yaWdpbix0aGlzLnJhZGl1cyx0aGlzLnNpZGVzLHRoaXMuc25hcEFuZ2xlKX0sbW9kaWZ5R2VvbWV0cnk6ZnVuY3Rpb24oKXt2YXIgYSxcbmIsYz10aGlzLmZlYXR1cmUuZ2VvbWV0cnkuY29tcG9uZW50c1swXTtjLmNvbXBvbmVudHMubGVuZ3RoIT10aGlzLnNpZGVzKzEmJih0aGlzLmNyZWF0ZUdlb21ldHJ5KCksYz10aGlzLmZlYXR1cmUuZ2VvbWV0cnkuY29tcG9uZW50c1swXSk7Zm9yKHZhciBkPTA7ZDx0aGlzLnNpZGVzOysrZCliPWMuY29tcG9uZW50c1tkXSxhPXRoaXMuYW5nbGUrMipkKk1hdGguUEkvdGhpcy5zaWRlcyxiLng9dGhpcy5vcmlnaW4ueCt0aGlzLnJhZGl1cypNYXRoLmNvcyhhKSxiLnk9dGhpcy5vcmlnaW4ueSt0aGlzLnJhZGl1cypNYXRoLnNpbihhKSxiLmNsZWFyQm91bmRzKCl9LGNhbGN1bGF0ZUFuZ2xlOmZ1bmN0aW9uKGEsYil7dmFyIGM9TWF0aC5hdGFuMihhLnktdGhpcy5vcmlnaW4ueSxhLngtdGhpcy5vcmlnaW4ueCk7aWYodGhpcy5zbmFwQW5nbGUmJnRoaXMuc25hcFRvZ2dsZSYmIWJbdGhpcy5zbmFwVG9nZ2xlXSl7dmFyIGQ9TWF0aC5QSS8xODAqdGhpcy5zbmFwQW5nbGU7dGhpcy5hbmdsZT1cbk1hdGgucm91bmQoYy9kKSpkfWVsc2UgdGhpcy5hbmdsZT1jfSxjYW5jZWw6ZnVuY3Rpb24oKXt0aGlzLmNhbGxiYWNrKFwiY2FuY2VsXCIsbnVsbCk7dGhpcy5maW5hbGl6ZSgpfSxmaW5hbGl6ZTpmdW5jdGlvbigpe3RoaXMub3JpZ2luPW51bGw7dGhpcy5yYWRpdXM9dGhpcy5vcHRpb25zLnJhZGl1c30sY2xlYXI6ZnVuY3Rpb24oKXt0aGlzLmxheWVyJiYodGhpcy5sYXllci5yZW5kZXJlci5jbGVhcigpLHRoaXMubGF5ZXIuZGVzdHJveUZlYXR1cmVzKCkpfSxjYWxsYmFjazpmdW5jdGlvbihhKXt0aGlzLmNhbGxiYWNrc1thXSYmdGhpcy5jYWxsYmFja3NbYV0uYXBwbHkodGhpcy5jb250cm9sLFt0aGlzLmZlYXR1cmUuZ2VvbWV0cnkuY2xvbmUoKV0pOyF0aGlzLnBlcnNpc3QmJihcImRvbmVcIj09YXx8XCJjYW5jZWxcIj09YSkmJnRoaXMuY2xlYXIoKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuSGFuZGxlci5SZWd1bGFyUG9seWdvblwifSk7T3BlbkxheWVycy5Db250cm9sLlNMRFNlbGVjdD1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuQ29udHJvbCx7Y2xlYXJPbkRlYWN0aXZhdGU6ITEsbGF5ZXJzOm51bGwsY2FsbGJhY2tzOm51bGwsc2VsZWN0aW9uU3ltYm9saXplcjp7UG9seWdvbjp7ZmlsbENvbG9yOlwiI0ZGMDAwMFwiLHN0cm9rZTohMX0sTGluZTp7c3Ryb2tlQ29sb3I6XCIjRkYwMDAwXCIsc3Ryb2tlV2lkdGg6Mn0sUG9pbnQ6e2dyYXBoaWNOYW1lOlwic3F1YXJlXCIsZmlsbENvbG9yOlwiI0ZGMDAwMFwiLHBvaW50UmFkaXVzOjV9fSxsYXllck9wdGlvbnM6bnVsbCxoYW5kbGVyT3B0aW9uczpudWxsLHNrZXRjaFN0eWxlOm51bGwsd2ZzQ2FjaGU6e30sbGF5ZXJDYWNoZTp7fSxpbml0aWFsaXplOmZ1bmN0aW9uKGEsYil7T3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsW2JdKTt0aGlzLmNhbGxiYWNrcz1PcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHtkb25lOnRoaXMuc2VsZWN0LGNsaWNrOnRoaXMuc2VsZWN0fSxcbnRoaXMuY2FsbGJhY2tzKTt0aGlzLmhhbmRsZXJPcHRpb25zPXRoaXMuaGFuZGxlck9wdGlvbnN8fHt9O3RoaXMubGF5ZXJPcHRpb25zPU9wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKHRoaXMubGF5ZXJPcHRpb25zLHtkaXNwbGF5SW5MYXllclN3aXRjaGVyOiExLHRpbGVPcHRpb25zOnttYXhHZXRVcmxMZW5ndGg6MjA0OH19KTt0aGlzLnNrZXRjaFN0eWxlJiYodGhpcy5oYW5kbGVyT3B0aW9ucy5sYXllck9wdGlvbnM9T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHModGhpcy5oYW5kbGVyT3B0aW9ucy5sYXllck9wdGlvbnMse3N0eWxlTWFwOm5ldyBPcGVuTGF5ZXJzLlN0eWxlTWFwKHtcImRlZmF1bHRcIjp0aGlzLnNrZXRjaFN0eWxlfSl9KSk7dGhpcy5oYW5kbGVyPW5ldyBhKHRoaXMsdGhpcy5jYWxsYmFja3MsdGhpcy5oYW5kbGVyT3B0aW9ucyl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXtmb3IodmFyIGEgaW4gdGhpcy5sYXllckNhY2hlKWRlbGV0ZSB0aGlzLmxheWVyQ2FjaGVbYV07XG5mb3IoYSBpbiB0aGlzLndmc0NhY2hlKWRlbGV0ZSB0aGlzLndmc0NhY2hlW2FdO09wZW5MYXllcnMuQ29udHJvbC5wcm90b3R5cGUuZGVzdHJveS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGNvdXBsZUxheWVyVmlzaWJsaXR5OmZ1bmN0aW9uKGEpe3RoaXMuc2V0VmlzaWJpbGl0eShhLm9iamVjdC5nZXRWaXNpYmlsaXR5KCkpfSxjcmVhdGVTZWxlY3Rpb25MYXllcjpmdW5jdGlvbihhKXt2YXIgYjtpZih0aGlzLmxheWVyQ2FjaGVbYS5pZF0pYj10aGlzLmxheWVyQ2FjaGVbYS5pZF07ZWxzZXtiPW5ldyBPcGVuTGF5ZXJzLkxheWVyLldNUyhhLm5hbWUsYS51cmwsYS5wYXJhbXMsT3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHModGhpcy5sYXllck9wdGlvbnMsYS5nZXRPcHRpb25zKCkpKTt0aGlzLmxheWVyQ2FjaGVbYS5pZF09YjtpZighMT09PXRoaXMubGF5ZXJPcHRpb25zLmRpc3BsYXlJbkxheWVyU3dpdGNoZXIpYS5ldmVudHMub24oe3Zpc2liaWxpdHljaGFuZ2VkOnRoaXMuY291cGxlTGF5ZXJWaXNpYmxpdHksXG5zY29wZTpifSk7dGhpcy5tYXAuYWRkTGF5ZXIoYil9cmV0dXJuIGJ9LGNyZWF0ZVNMRDpmdW5jdGlvbihhLGIsYyl7Zm9yKHZhciBkPXt2ZXJzaW9uOlwiMS4wLjBcIixuYW1lZExheWVyczp7fX0sZT0oXCJcIithLnBhcmFtcy5MQVlFUlMpLnNwbGl0KFwiLFwiKSxmPTAsZz1lLmxlbmd0aDtmPGc7ZisrKXt2YXIgaD1lW2ZdO2QubmFtZWRMYXllcnNbaF09e25hbWU6aCx1c2VyU3R5bGVzOltdfTt2YXIgaT10aGlzLnNlbGVjdGlvblN5bWJvbGl6ZXIsaj1jW2ZdOzA8PWoudHlwZS5pbmRleE9mKFwiUG9seWdvblwiKT9pPXtQb2x5Z29uOnRoaXMuc2VsZWN0aW9uU3ltYm9saXplci5Qb2x5Z29ufTowPD1qLnR5cGUuaW5kZXhPZihcIkxpbmVTdHJpbmdcIik/aT17TGluZTp0aGlzLnNlbGVjdGlvblN5bWJvbGl6ZXIuTGluZX06MDw9ai50eXBlLmluZGV4T2YoXCJQb2ludFwiKSYmKGk9e1BvaW50OnRoaXMuc2VsZWN0aW9uU3ltYm9saXplci5Qb2ludH0pO2QubmFtZWRMYXllcnNbaF0udXNlclN0eWxlcy5wdXNoKHtuYW1lOlwiZGVmYXVsdFwiLFxucnVsZXM6W25ldyBPcGVuTGF5ZXJzLlJ1bGUoe3N5bWJvbGl6ZXI6aSxmaWx0ZXI6YltmXSxtYXhTY2FsZURlbm9taW5hdG9yOmEub3B0aW9ucy5taW5TY2FsZX0pXX0pfXJldHVybihuZXcgT3BlbkxheWVycy5Gb3JtYXQuU0xEKHtzcnNOYW1lOnRoaXMubWFwLmdldFByb2plY3Rpb24oKX0pKS53cml0ZShkKX0scGFyc2VEZXNjcmliZUxheWVyOmZ1bmN0aW9uKGEpe3ZhciBiPW5ldyBPcGVuTGF5ZXJzLkZvcm1hdC5XTVNEZXNjcmliZUxheWVyLGM9YS5yZXNwb25zZVhNTDtpZighY3x8IWMuZG9jdW1lbnRFbGVtZW50KWM9YS5yZXNwb25zZVRleHQ7Zm9yKHZhciBhPWIucmVhZChjKSxiPVtdLGM9bnVsbCxkPTAsZT1hLmxlbmd0aDtkPGU7ZCsrKVwiV0ZTXCI9PWFbZF0ub3dzVHlwZSYmKGIucHVzaChhW2RdLnR5cGVOYW1lKSxjPWFbZF0ub3dzVVJMKTtPcGVuTGF5ZXJzLlJlcXVlc3QuR0VUKHt1cmw6YyxwYXJhbXM6e1NFUlZJQ0U6XCJXRlNcIixUWVBFTkFNRTpiLnRvU3RyaW5nKCksUkVRVUVTVDpcIkRlc2NyaWJlRmVhdHVyZVR5cGVcIixcblZFUlNJT046XCIxLjAuMFwifSxjYWxsYmFjazpmdW5jdGlvbihhKXt2YXIgYj1uZXcgT3BlbkxheWVycy5Gb3JtYXQuV0ZTRGVzY3JpYmVGZWF0dXJlVHlwZSxjPWEucmVzcG9uc2VYTUw7aWYoIWN8fCFjLmRvY3VtZW50RWxlbWVudCljPWEucmVzcG9uc2VUZXh0O3RoaXMuY29udHJvbC53ZnNDYWNoZVt0aGlzLmxheWVyLmlkXT1iLnJlYWQoYyk7dGhpcy5jb250cm9sLl9xdWV1ZSYmdGhpcy5jb250cm9sLmFwcGx5U2VsZWN0aW9uKCl9LHNjb3BlOnRoaXN9KX0sZ2V0R2VvbWV0cnlBdHRyaWJ1dGVzOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1bXSxhPXRoaXMud2ZzQ2FjaGVbYS5pZF0sYz0wLGQ9YS5mZWF0dXJlVHlwZXMubGVuZ3RoO2M8ZDtjKyspZm9yKHZhciBlPWEuZmVhdHVyZVR5cGVzW2NdLnByb3BlcnRpZXMsZj0wLGc9ZS5sZW5ndGg7ZjxnO2YrKyl7dmFyIGg9ZVtmXSxpPWgudHlwZTsoMDw9aS5pbmRleE9mKFwiTGluZVN0cmluZ1wiKXx8MDw9aS5pbmRleE9mKFwiR2VvbWV0cnlBc3NvY2lhdGlvblR5cGVcIil8fFxuMDw9aS5pbmRleE9mKFwiR2VvbWV0cnlQcm9wZXJ0eVR5cGVcIil8fDA8PWkuaW5kZXhPZihcIlBvaW50XCIpfHwwPD1pLmluZGV4T2YoXCJQb2x5Z29uXCIpKSYmYi5wdXNoKGgpfXJldHVybiBifSxhY3RpdmF0ZTpmdW5jdGlvbigpe3ZhciBhPU9wZW5MYXllcnMuQ29udHJvbC5wcm90b3R5cGUuYWN0aXZhdGUuY2FsbCh0aGlzKTtpZihhKWZvcih2YXIgYj0wLGM9dGhpcy5sYXllcnMubGVuZ3RoO2I8YztiKyspe3ZhciBkPXRoaXMubGF5ZXJzW2JdO2QmJiF0aGlzLndmc0NhY2hlW2QuaWRdJiZPcGVuTGF5ZXJzLlJlcXVlc3QuR0VUKHt1cmw6ZC51cmwscGFyYW1zOntTRVJWSUNFOlwiV01TXCIsVkVSU0lPTjpkLnBhcmFtcy5WRVJTSU9OLExBWUVSUzpkLnBhcmFtcy5MQVlFUlMsUkVRVUVTVDpcIkRlc2NyaWJlTGF5ZXJcIn0sY2FsbGJhY2s6dGhpcy5wYXJzZURlc2NyaWJlTGF5ZXIsc2NvcGU6e2xheWVyOmQsY29udHJvbDp0aGlzfX0pfXJldHVybiBhfSxkZWFjdGl2YXRlOmZ1bmN0aW9uKCl7dmFyIGE9XG5PcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmRlYWN0aXZhdGUuY2FsbCh0aGlzKTtpZihhKWZvcih2YXIgYj0wLGM9dGhpcy5sYXllcnMubGVuZ3RoO2I8YztiKyspe3ZhciBkPXRoaXMubGF5ZXJzW2JdO2lmKGQmJiEwPT09dGhpcy5jbGVhck9uRGVhY3RpdmF0ZSl7dmFyIGU9dGhpcy5sYXllckNhY2hlLGY9ZVtkLmlkXTtmJiYoZC5ldmVudHMudW4oe3Zpc2liaWxpdHljaGFuZ2VkOnRoaXMuY291cGxlTGF5ZXJWaXNpYmxpdHksc2NvcGU6Zn0pLGYuZGVzdHJveSgpLGRlbGV0ZSBlW2QuaWRdKX19cmV0dXJuIGF9LHNldExheWVyczpmdW5jdGlvbihhKXt0aGlzLmFjdGl2ZT8odGhpcy5kZWFjdGl2YXRlKCksdGhpcy5sYXllcnM9YSx0aGlzLmFjdGl2YXRlKCkpOnRoaXMubGF5ZXJzPWF9LGNyZWF0ZUZpbHRlcjpmdW5jdGlvbihhLGIpe3ZhciBjPW51bGw7dGhpcy5oYW5kbGVyIGluc3RhbmNlb2YgT3BlbkxheWVycy5IYW5kbGVyLlJlZ3VsYXJQb2x5Z29uP2M9ITA9PT10aGlzLmhhbmRsZXIuaXJyZWd1bGFyP1xubmV3IE9wZW5MYXllcnMuRmlsdGVyLlNwYXRpYWwoe3R5cGU6T3BlbkxheWVycy5GaWx0ZXIuU3BhdGlhbC5CQk9YLHByb3BlcnR5OmEubmFtZSx2YWx1ZTpiLmdldEJvdW5kcygpfSk6bmV3IE9wZW5MYXllcnMuRmlsdGVyLlNwYXRpYWwoe3R5cGU6T3BlbkxheWVycy5GaWx0ZXIuU3BhdGlhbC5JTlRFUlNFQ1RTLHByb3BlcnR5OmEubmFtZSx2YWx1ZTpifSk6dGhpcy5oYW5kbGVyIGluc3RhbmNlb2YgT3BlbkxheWVycy5IYW5kbGVyLlBvbHlnb24/Yz1uZXcgT3BlbkxheWVycy5GaWx0ZXIuU3BhdGlhbCh7dHlwZTpPcGVuTGF5ZXJzLkZpbHRlci5TcGF0aWFsLklOVEVSU0VDVFMscHJvcGVydHk6YS5uYW1lLHZhbHVlOmJ9KTp0aGlzLmhhbmRsZXIgaW5zdGFuY2VvZiBPcGVuTGF5ZXJzLkhhbmRsZXIuUGF0aD9jPTA8PWEudHlwZS5pbmRleE9mKFwiUG9pbnRcIik/bmV3IE9wZW5MYXllcnMuRmlsdGVyLlNwYXRpYWwoe3R5cGU6T3BlbkxheWVycy5GaWx0ZXIuU3BhdGlhbC5EV0lUSElOLFxucHJvcGVydHk6YS5uYW1lLGRpc3RhbmNlOjAuMDEqdGhpcy5tYXAuZ2V0RXh0ZW50KCkuZ2V0V2lkdGgoKSxkaXN0YW5jZVVuaXRzOnRoaXMubWFwLmdldFVuaXRzKCksdmFsdWU6Yn0pOm5ldyBPcGVuTGF5ZXJzLkZpbHRlci5TcGF0aWFsKHt0eXBlOk9wZW5MYXllcnMuRmlsdGVyLlNwYXRpYWwuSU5URVJTRUNUUyxwcm9wZXJ0eTphLm5hbWUsdmFsdWU6Yn0pOnRoaXMuaGFuZGxlciBpbnN0YW5jZW9mIE9wZW5MYXllcnMuSGFuZGxlci5DbGljayYmKGM9MDw9YS50eXBlLmluZGV4T2YoXCJQb2x5Z29uXCIpP25ldyBPcGVuTGF5ZXJzLkZpbHRlci5TcGF0aWFsKHt0eXBlOk9wZW5MYXllcnMuRmlsdGVyLlNwYXRpYWwuSU5URVJTRUNUUyxwcm9wZXJ0eTphLm5hbWUsdmFsdWU6Yn0pOm5ldyBPcGVuTGF5ZXJzLkZpbHRlci5TcGF0aWFsKHt0eXBlOk9wZW5MYXllcnMuRmlsdGVyLlNwYXRpYWwuRFdJVEhJTixwcm9wZXJ0eTphLm5hbWUsZGlzdGFuY2U6MC4wMSp0aGlzLm1hcC5nZXRFeHRlbnQoKS5nZXRXaWR0aCgpLFxuZGlzdGFuY2VVbml0czp0aGlzLm1hcC5nZXRVbml0cygpLHZhbHVlOmJ9KSk7cmV0dXJuIGN9LHNlbGVjdDpmdW5jdGlvbihhKXt0aGlzLl9xdWV1ZT1mdW5jdGlvbigpe2Zvcih2YXIgYj0wLGM9dGhpcy5sYXllcnMubGVuZ3RoO2I8YztiKyspe2Zvcih2YXIgZD10aGlzLmxheWVyc1tiXSxlPXRoaXMuZ2V0R2VvbWV0cnlBdHRyaWJ1dGVzKGQpLGY9W10sZz0wLGg9ZS5sZW5ndGg7ZzxoO2crKyl7dmFyIGk9ZVtnXTtpZihudWxsIT09aSl7aWYoIShhIGluc3RhbmNlb2YgT3BlbkxheWVycy5HZW9tZXRyeSkpe3ZhciBqPXRoaXMubWFwLmdldExvbkxhdEZyb21QaXhlbChhLnh5KTthPW5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGoubG9uLGoubGF0KX1pPXRoaXMuY3JlYXRlRmlsdGVyKGksYSk7bnVsbCE9PWkmJmYucHVzaChpKX19Zz10aGlzLmNyZWF0ZVNlbGVjdGlvbkxheWVyKGQpO2U9dGhpcy5jcmVhdGVTTEQoZCxmLGUpO3RoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcInNlbGVjdGVkXCIsXG57bGF5ZXI6ZCxmaWx0ZXJzOmZ9KTtnLm1lcmdlTmV3UGFyYW1zKHtTTERfQk9EWTplfSk7ZGVsZXRlIHRoaXMuX3F1ZXVlfX07dGhpcy5hcHBseVNlbGVjdGlvbigpfSxhcHBseVNlbGVjdGlvbjpmdW5jdGlvbigpe2Zvcih2YXIgYT0hMCxiPTAsYz10aGlzLmxheWVycy5sZW5ndGg7YjxjO2IrKylpZighdGhpcy53ZnNDYWNoZVt0aGlzLmxheWVyc1tiXS5pZF0pe2E9ITE7YnJlYWt9YSYmdGhpcy5fcXVldWUuY2FsbCh0aGlzKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuQ29udHJvbC5TTERTZWxlY3RcIn0pO09wZW5MYXllcnMuQ29udHJvbC5TY2FsZT1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuQ29udHJvbCx7ZWxlbWVudDpudWxsLGdlb2Rlc2ljOiExLGluaXRpYWxpemU6ZnVuY3Rpb24oYSxiKXtPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbYl0pO3RoaXMuZWxlbWVudD1PcGVuTGF5ZXJzLlV0aWwuZ2V0RWxlbWVudChhKX0sZHJhdzpmdW5jdGlvbigpe09wZW5MYXllcnMuQ29udHJvbC5wcm90b3R5cGUuZHJhdy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5lbGVtZW50fHwodGhpcy5lbGVtZW50PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksdGhpcy5kaXYuYXBwZW5kQ2hpbGQodGhpcy5lbGVtZW50KSk7dGhpcy5tYXAuZXZlbnRzLnJlZ2lzdGVyKFwibW92ZWVuZFwiLHRoaXMsdGhpcy51cGRhdGVTY2FsZSk7dGhpcy51cGRhdGVTY2FsZSgpO3JldHVybiB0aGlzLmRpdn0sdXBkYXRlU2NhbGU6ZnVuY3Rpb24oKXt2YXIgYTtcbmlmKCEwPT09dGhpcy5nZW9kZXNpYyl7aWYoIXRoaXMubWFwLmdldFVuaXRzKCkpcmV0dXJuO2E9T3BlbkxheWVycy5JTkNIRVNfUEVSX1VOSVQ7YT0odGhpcy5tYXAuZ2V0R2VvZGVzaWNQaXhlbFNpemUoKS53fHwxLjBFLTYpKmEua20qT3BlbkxheWVycy5ET1RTX1BFUl9JTkNIfWVsc2UgYT10aGlzLm1hcC5nZXRTY2FsZSgpO2EmJihhPTk1MDA8PWEmJjk1RTQ+PWE/TWF0aC5yb3VuZChhLzFFMykrXCJLXCI6OTVFNDw9YT9NYXRoLnJvdW5kKGEvMUU2KStcIk1cIjpNYXRoLnJvdW5kKGEpLHRoaXMuZWxlbWVudC5pbm5lckhUTUw9T3BlbkxheWVycy5pMThuKFwiU2NhbGUgPSAxIDogJHtzY2FsZURlbm9tfVwiLHtzY2FsZURlbm9tOmF9KSl9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkNvbnRyb2wuU2NhbGVcIn0pO09wZW5MYXllcnMuQ29udHJvbC5CdXR0b249T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkNvbnRyb2wse3R5cGU6T3BlbkxheWVycy5Db250cm9sLlRZUEVfQlVUVE9OLHRyaWdnZXI6ZnVuY3Rpb24oKXt9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkNvbnRyb2wuQnV0dG9uXCJ9KTtPcGVuTGF5ZXJzLkxheWVyLk1hcEd1aWRlPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5MYXllci5HcmlkLHtpc0Jhc2VMYXllcjohMCx1c2VIdHRwVGlsZTohMSxzaW5nbGVUaWxlOiExLHVzZU92ZXJsYXk6ITEsdXNlQXN5bmNPdmVybGF5OiEwLFRJTEVfUEFSQU1TOntvcGVyYXRpb246XCJHRVRUSUxFSU1BR0VcIix2ZXJzaW9uOlwiMS4yLjBcIn0sU0lOR0xFX1RJTEVfUEFSQU1TOntvcGVyYXRpb246XCJHRVRNQVBJTUFHRVwiLGZvcm1hdDpcIlBOR1wiLGxvY2FsZTpcImVuXCIsY2xpcDpcIjFcIix2ZXJzaW9uOlwiMS4wLjBcIn0sT1ZFUkxBWV9QQVJBTVM6e29wZXJhdGlvbjpcIkdFVERZTkFNSUNNQVBPVkVSTEFZSU1BR0VcIixmb3JtYXQ6XCJQTkdcIixsb2NhbGU6XCJlblwiLGNsaXA6XCIxXCIsdmVyc2lvbjpcIjIuMC4wXCJ9LEZPTERFUl9QQVJBTVM6e3RpbGVDb2x1bW5zUGVyRm9sZGVyOjMwLHRpbGVSb3dzUGVyRm9sZGVyOjMwLGZvcm1hdDpcInBuZ1wiLHF1ZXJ5c3RyaW5nOm51bGx9LGRlZmF1bHRTaXplOm5ldyBPcGVuTGF5ZXJzLlNpemUoMzAwLFxuMzAwKSx0aWxlT3JpZ2luQ29ybmVyOlwidGxcIixpbml0aWFsaXplOmZ1bmN0aW9uKGEsYixjLGQpe09wZW5MYXllcnMuTGF5ZXIuR3JpZC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7aWYobnVsbD09ZHx8bnVsbD09ZC5pc0Jhc2VMYXllcil0aGlzLmlzQmFzZUxheWVyPVwidHJ1ZVwiIT10aGlzLnRyYW5zcGFyZW50JiYhMCE9dGhpcy50cmFuc3BhcmVudDtkJiZudWxsIT1kLnVzZU92ZXJsYXkmJih0aGlzLnVzZU92ZXJsYXk9ZC51c2VPdmVybGF5KTt0aGlzLnNpbmdsZVRpbGU/dGhpcy51c2VPdmVybGF5PyhPcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyh0aGlzLnBhcmFtcyx0aGlzLk9WRVJMQVlfUEFSQU1TKSx0aGlzLnVzZUFzeW5jT3ZlcmxheXx8KHRoaXMucGFyYW1zLnZlcnNpb249XCIxLjAuMFwiKSk6T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHModGhpcy5wYXJhbXMsdGhpcy5TSU5HTEVfVElMRV9QQVJBTVMpOih0aGlzLnVzZUh0dHBUaWxlP1xuT3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHModGhpcy5wYXJhbXMsdGhpcy5GT0xERVJfUEFSQU1TKTpPcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyh0aGlzLnBhcmFtcyx0aGlzLlRJTEVfUEFSQU1TKSx0aGlzLnNldFRpbGVTaXplKHRoaXMuZGVmYXVsdFNpemUpKX0sY2xvbmU6ZnVuY3Rpb24oYSl7bnVsbD09YSYmKGE9bmV3IE9wZW5MYXllcnMuTGF5ZXIuTWFwR3VpZGUodGhpcy5uYW1lLHRoaXMudXJsLHRoaXMucGFyYW1zLHRoaXMuZ2V0T3B0aW9ucygpKSk7cmV0dXJuIGE9T3BlbkxheWVycy5MYXllci5HcmlkLnByb3RvdHlwZS5jbG9uZS5hcHBseSh0aGlzLFthXSl9LGdldFVSTDpmdW5jdGlvbihhKXt2YXIgYjtiPWEuZ2V0Q2VudGVyTG9uTGF0KCk7dmFyIGM9dGhpcy5tYXAuZ2V0U2l6ZSgpO3RoaXMuc2luZ2xlVGlsZT8oYT17c2V0ZGlzcGxheWRwaTpPcGVuTGF5ZXJzLkRPVFNfUEVSX0lOQ0gsc2V0ZGlzcGxheWhlaWdodDpjLmgqdGhpcy5yYXRpbyxzZXRkaXNwbGF5d2lkdGg6Yy53KlxudGhpcy5yYXRpbyxzZXR2aWV3Y2VudGVyeDpiLmxvbixzZXR2aWV3Y2VudGVyeTpiLmxhdCxzZXR2aWV3c2NhbGU6dGhpcy5tYXAuZ2V0U2NhbGUoKX0sdGhpcy51c2VPdmVybGF5JiYhdGhpcy51c2VBc3luY092ZXJsYXkmJihiPXt9LGI9T3BlbkxheWVycy5VdGlsLmV4dGVuZChiLGEpLGIub3BlcmF0aW9uPVwiR0VUVklTSUJMRU1BUEVYVEVOVFwiLGIudmVyc2lvbj1cIjEuMC4wXCIsYi5zZXNzaW9uPXRoaXMucGFyYW1zLnNlc3Npb24sYi5tYXBOYW1lPXRoaXMucGFyYW1zLm1hcE5hbWUsYi5mb3JtYXQ9XCJ0ZXh0L3htbFwiLGI9dGhpcy5nZXRGdWxsUmVxdWVzdFN0cmluZyhiKSxPcGVuTGF5ZXJzLlJlcXVlc3QuR0VUKHt1cmw6Yixhc3luYzohMX0pKSxiPXRoaXMuZ2V0RnVsbFJlcXVlc3RTdHJpbmcoYSkpOihjPXRoaXMubWFwLmdldFJlc29sdXRpb24oKSxiPU1hdGguZmxvb3IoKGEubGVmdC10aGlzLm1heEV4dGVudC5sZWZ0KS9jKSxiPU1hdGgucm91bmQoYi90aGlzLnRpbGVTaXplLncpLFxuYT1NYXRoLmZsb29yKCh0aGlzLm1heEV4dGVudC50b3AtYS50b3ApL2MpLGE9TWF0aC5yb3VuZChhL3RoaXMudGlsZVNpemUuaCksYj10aGlzLnVzZUh0dHBUaWxlP3RoaXMuZ2V0SW1hZ2VGaWxlUGF0aCh7dGlsZWNvbDpiLHRpbGVyb3c6YSxzY2FsZWluZGV4OnRoaXMucmVzb2x1dGlvbnMubGVuZ3RoLXRoaXMubWFwLnpvb20tMX0pOnRoaXMuZ2V0RnVsbFJlcXVlc3RTdHJpbmcoe3RpbGVjb2w6Yix0aWxlcm93OmEsc2NhbGVpbmRleDp0aGlzLnJlc29sdXRpb25zLmxlbmd0aC10aGlzLm1hcC56b29tLTF9KSk7cmV0dXJuIGJ9LGdldEZ1bGxSZXF1ZXN0U3RyaW5nOmZ1bmN0aW9uKGEsYil7dmFyIGM9bnVsbD09Yj90aGlzLnVybDpiO1wib2JqZWN0XCI9PXR5cGVvZiBjJiYoYz1jW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSpjLmxlbmd0aCldKTt2YXIgZD1jLGU9T3BlbkxheWVycy5VdGlsLmV4dGVuZCh7fSx0aGlzLnBhcmFtcyksZT1PcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKGUsYSksXG5mPU9wZW5MYXllcnMuVXRpbC51cHBlckNhc2VPYmplY3QoT3BlbkxheWVycy5VdGlsLmdldFBhcmFtZXRlcnMoYykpLGc7Zm9yKGcgaW4gZSlnLnRvVXBwZXJDYXNlKClpbiBmJiZkZWxldGUgZVtnXTtlPU9wZW5MYXllcnMuVXRpbC5nZXRQYXJhbWV0ZXJTdHJpbmcoZSk7ZT1lLnJlcGxhY2UoLywvZyxcIitcIik7XCJcIiE9ZSYmKGY9Yy5jaGFyQXQoYy5sZW5ndGgtMSksZD1cIiZcIj09Znx8XCI/XCI9PWY/ZCtlOi0xPT1jLmluZGV4T2YoXCI/XCIpP2QrKFwiP1wiK2UpOmQrKFwiJlwiK2UpKTtyZXR1cm4gZH0sZ2V0SW1hZ2VGaWxlUGF0aDpmdW5jdGlvbihhLGIpe3ZhciBjPW51bGw9PWI/dGhpcy51cmw6YjtcIm9iamVjdFwiPT10eXBlb2YgYyYmKGM9Y1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqYy5sZW5ndGgpXSk7dmFyIGQ9XCJcIixlPVwiXCI7MD5hLnRpbGVyb3cmJihkPVwiLVwiKTtkPTA9PWEudGlsZXJvdz9kK1wiMFwiOmQrTWF0aC5mbG9vcihNYXRoLmFicyhhLnRpbGVyb3cvdGhpcy5wYXJhbXMudGlsZVJvd3NQZXJGb2xkZXIpKSpcbnRoaXMucGFyYW1zLnRpbGVSb3dzUGVyRm9sZGVyOzA+YS50aWxlY29sJiYoZT1cIi1cIik7ZT0wPT1hLnRpbGVjb2w/ZStcIjBcIjplK01hdGguZmxvb3IoTWF0aC5hYnMoYS50aWxlY29sL3RoaXMucGFyYW1zLnRpbGVDb2x1bW5zUGVyRm9sZGVyKSkqdGhpcy5wYXJhbXMudGlsZUNvbHVtbnNQZXJGb2xkZXI7ZD1cIi9TXCIrTWF0aC5mbG9vcihhLnNjYWxlaW5kZXgpK1wiL1wiK3RoaXMucGFyYW1zLmJhc2VtYXBsYXllcmdyb3VwbmFtZStcIi9SXCIrZCtcIi9DXCIrZStcIi9cIithLnRpbGVyb3cldGhpcy5wYXJhbXMudGlsZVJvd3NQZXJGb2xkZXIrXCJfXCIrYS50aWxlY29sJXRoaXMucGFyYW1zLnRpbGVDb2x1bW5zUGVyRm9sZGVyK1wiLlwiK3RoaXMucGFyYW1zLmZvcm1hdDt0aGlzLnBhcmFtcy5xdWVyeXN0cmluZyYmKGQrPVwiP1wiK3RoaXMucGFyYW1zLnF1ZXJ5c3RyaW5nKTtyZXR1cm4gYytkfSxjYWxjdWxhdGVHcmlkTGF5b3V0OmZ1bmN0aW9uKGEsYixjKXt2YXIgZD1jKnRoaXMudGlsZVNpemUudyxjPVxuYyp0aGlzLnRpbGVTaXplLmgsZT1hLmxlZnQtYi5sb24sZj1NYXRoLmZsb29yKGUvZCktdGhpcy5idWZmZXIsYT1iLmxhdC1hLnRvcCtjLGc9TWF0aC5mbG9vcihhL2MpLXRoaXMuYnVmZmVyO3JldHVybnt0aWxlbG9uOmQsdGlsZWxhdDpjLHRpbGVvZmZzZXRsb246Yi5sb24rZipkLHRpbGVvZmZzZXRsYXQ6Yi5sYXQtYypnLHRpbGVvZmZzZXR4Oi0oZS9kLWYpKnRoaXMudGlsZVNpemUudyx0aWxlb2Zmc2V0eTooZy1hL2MpKnRoaXMudGlsZVNpemUuaH19LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkxheWVyLk1hcEd1aWRlXCJ9KTtPcGVuTGF5ZXJzLkNvbnRyb2wuTWVhc3VyZT1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuQ29udHJvbCx7aGFuZGxlck9wdGlvbnM6bnVsbCxjYWxsYmFja3M6bnVsbCxkaXNwbGF5U3lzdGVtOlwibWV0cmljXCIsZ2VvZGVzaWM6ITEsZGlzcGxheVN5c3RlbVVuaXRzOntnZW9ncmFwaGljOltcImRkXCJdLGVuZ2xpc2g6W1wibWlcIixcImZ0XCIsXCJpblwiXSxtZXRyaWM6W1wia21cIixcIm1cIl19LHBhcnRpYWxEZWxheTozMDAsZGVsYXllZFRyaWdnZXI6bnVsbCxwZXJzaXN0OiExLGltbWVkaWF0ZTohMSxpbml0aWFsaXplOmZ1bmN0aW9uKGEsYil7T3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsW2JdKTt2YXIgYz17ZG9uZTp0aGlzLm1lYXN1cmVDb21wbGV0ZSxwb2ludDp0aGlzLm1lYXN1cmVQYXJ0aWFsfTt0aGlzLmltbWVkaWF0ZSYmKGMubW9kaWZ5PXRoaXMubWVhc3VyZUltbWVkaWF0ZSk7dGhpcy5jYWxsYmFja3M9T3BlbkxheWVycy5VdGlsLmV4dGVuZChjLFxudGhpcy5jYWxsYmFja3MpO3RoaXMuaGFuZGxlck9wdGlvbnM9T3BlbkxheWVycy5VdGlsLmV4dGVuZCh7cGVyc2lzdDp0aGlzLnBlcnNpc3R9LHRoaXMuaGFuZGxlck9wdGlvbnMpO3RoaXMuaGFuZGxlcj1uZXcgYSh0aGlzLHRoaXMuY2FsbGJhY2tzLHRoaXMuaGFuZGxlck9wdGlvbnMpfSxkZWFjdGl2YXRlOmZ1bmN0aW9uKCl7dGhpcy5jYW5jZWxEZWxheSgpO3JldHVybiBPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmRlYWN0aXZhdGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxjYW5jZWw6ZnVuY3Rpb24oKXt0aGlzLmNhbmNlbERlbGF5KCk7dGhpcy5oYW5kbGVyLmNhbmNlbCgpfSxzZXRJbW1lZGlhdGU6ZnVuY3Rpb24oYSl7KHRoaXMuaW1tZWRpYXRlPWEpP3RoaXMuY2FsbGJhY2tzLm1vZGlmeT10aGlzLm1lYXN1cmVJbW1lZGlhdGU6ZGVsZXRlIHRoaXMuY2FsbGJhY2tzLm1vZGlmeX0sdXBkYXRlSGFuZGxlcjpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuYWN0aXZlO2MmJlxudGhpcy5kZWFjdGl2YXRlKCk7dGhpcy5oYW5kbGVyPW5ldyBhKHRoaXMsdGhpcy5jYWxsYmFja3MsYik7YyYmdGhpcy5hY3RpdmF0ZSgpfSxtZWFzdXJlQ29tcGxldGU6ZnVuY3Rpb24oYSl7dGhpcy5jYW5jZWxEZWxheSgpO3RoaXMubWVhc3VyZShhLFwibWVhc3VyZVwiKX0sbWVhc3VyZVBhcnRpYWw6ZnVuY3Rpb24oYSxiKXt0aGlzLmNhbmNlbERlbGF5KCk7Yj1iLmNsb25lKCk7dGhpcy5oYW5kbGVyLmZyZWVoYW5kTW9kZSh0aGlzLmhhbmRsZXIuZXZ0KT90aGlzLm1lYXN1cmUoYixcIm1lYXN1cmVwYXJ0aWFsXCIpOnRoaXMuZGVsYXllZFRyaWdnZXI9d2luZG93LnNldFRpbWVvdXQoT3BlbkxheWVycy5GdW5jdGlvbi5iaW5kKGZ1bmN0aW9uKCl7dGhpcy5kZWxheWVkVHJpZ2dlcj1udWxsO3RoaXMubWVhc3VyZShiLFwibWVhc3VyZXBhcnRpYWxcIil9LHRoaXMpLHRoaXMucGFydGlhbERlbGF5KX0sbWVhc3VyZUltbWVkaWF0ZTpmdW5jdGlvbihhLGIsYyl7YyYmIXRoaXMuaGFuZGxlci5mcmVlaGFuZE1vZGUodGhpcy5oYW5kbGVyLmV2dCkmJlxuKHRoaXMuY2FuY2VsRGVsYXkoKSx0aGlzLm1lYXN1cmUoYi5nZW9tZXRyeSxcIm1lYXN1cmVwYXJ0aWFsXCIpKX0sY2FuY2VsRGVsYXk6ZnVuY3Rpb24oKXtudWxsIT09dGhpcy5kZWxheWVkVHJpZ2dlciYmKHdpbmRvdy5jbGVhclRpbWVvdXQodGhpcy5kZWxheWVkVHJpZ2dlciksdGhpcy5kZWxheWVkVHJpZ2dlcj1udWxsKX0sbWVhc3VyZTpmdW5jdGlvbihhLGIpe3ZhciBjLGQ7LTE8YS5DTEFTU19OQU1FLmluZGV4T2YoXCJMaW5lU3RyaW5nXCIpPyhjPXRoaXMuZ2V0QmVzdExlbmd0aChhKSxkPTEpOihjPXRoaXMuZ2V0QmVzdEFyZWEoYSksZD0yKTt0aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoYix7bWVhc3VyZTpjWzBdLHVuaXRzOmNbMV0sb3JkZXI6ZCxnZW9tZXRyeTphfSl9LGdldEJlc3RBcmVhOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj10aGlzLmRpc3BsYXlTeXN0ZW1Vbml0c1t0aGlzLmRpc3BsYXlTeXN0ZW1dLGMsZCxlPTAsZj1iLmxlbmd0aDtlPGYmJiEoYz1iW2VdLGQ9dGhpcy5nZXRBcmVhKGEsXG5jKSwxPGQpOysrZSk7cmV0dXJuW2QsY119LGdldEFyZWE6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkO3RoaXMuZ2VvZGVzaWM/KGM9YS5nZXRHZW9kZXNpY0FyZWEodGhpcy5tYXAuZ2V0UHJvamVjdGlvbk9iamVjdCgpKSxkPVwibVwiKTooYz1hLmdldEFyZWEoKSxkPXRoaXMubWFwLmdldFVuaXRzKCkpO3ZhciBlPU9wZW5MYXllcnMuSU5DSEVTX1BFUl9VTklUW2JdO2UmJihjKj1NYXRoLnBvdyhPcGVuTGF5ZXJzLklOQ0hFU19QRVJfVU5JVFtkXS9lLDIpKTtyZXR1cm4gY30sZ2V0QmVzdExlbmd0aDpmdW5jdGlvbihhKXtmb3IodmFyIGI9dGhpcy5kaXNwbGF5U3lzdGVtVW5pdHNbdGhpcy5kaXNwbGF5U3lzdGVtXSxjLGQsZT0wLGY9Yi5sZW5ndGg7ZTxmJiYhKGM9YltlXSxkPXRoaXMuZ2V0TGVuZ3RoKGEsYyksMTxkKTsrK2UpO3JldHVybltkLGNdfSxnZXRMZW5ndGg6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkO3RoaXMuZ2VvZGVzaWM/KGM9YS5nZXRHZW9kZXNpY0xlbmd0aCh0aGlzLm1hcC5nZXRQcm9qZWN0aW9uT2JqZWN0KCkpLFxuZD1cIm1cIik6KGM9YS5nZXRMZW5ndGgoKSxkPXRoaXMubWFwLmdldFVuaXRzKCkpO3ZhciBlPU9wZW5MYXllcnMuSU5DSEVTX1BFUl9VTklUW2JdO2UmJihjKj1PcGVuTGF5ZXJzLklOQ0hFU19QRVJfVU5JVFtkXS9lKTtyZXR1cm4gY30sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuQ29udHJvbC5NZWFzdXJlXCJ9KTtPcGVuTGF5ZXJzLkZvcm1hdC5XTUMudjFfMF8wPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Gb3JtYXQuV01DLnYxLHtWRVJTSU9OOlwiMS4wLjBcIixzY2hlbWFMb2NhdGlvbjpcImh0dHA6Ly93d3cub3Blbmdpcy5uZXQvY29udGV4dCBodHRwOi8vc2NoZW1hcy5vcGVuZ2lzLm5ldC9jb250ZXh0LzEuMC4wL2NvbnRleHQueHNkXCIsaW5pdGlhbGl6ZTpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLkZvcm1hdC5XTUMudjEucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbYV0pfSxyZWFkX3dtY19TUlM6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmdldENoaWxkVmFsdWUoYik7XCJvYmplY3RcIiE9dHlwZW9mIGEucHJvamVjdGlvbnMmJihhLnByb2plY3Rpb25zPXt9KTtmb3IodmFyIGM9Yy5zcGxpdCgvICsvKSxkPTAsZT1jLmxlbmd0aDtkPGU7ZCsrKWEucHJvamVjdGlvbnNbY1tkXV09ITB9LHdyaXRlX3dtY19MYXllcjpmdW5jdGlvbihhKXt2YXIgYj1PcGVuTGF5ZXJzLkZvcm1hdC5XTUMudjEucHJvdG90eXBlLndyaXRlX3dtY19MYXllci5hcHBseSh0aGlzLFxuW2FdKTtpZihhLnNycyl7dmFyIGM9W10sZDtmb3IoZCBpbiBhLnNycyljLnB1c2goZCk7Yi5hcHBlbmRDaGlsZCh0aGlzLmNyZWF0ZUVsZW1lbnREZWZhdWx0TlMoXCJTUlNcIixjLmpvaW4oXCIgXCIpKSl9Yi5hcHBlbmRDaGlsZCh0aGlzLndyaXRlX3dtY19Gb3JtYXRMaXN0KGEpKTtiLmFwcGVuZENoaWxkKHRoaXMud3JpdGVfd21jX1N0eWxlTGlzdChhKSk7YS5kaW1lbnNpb25zJiZiLmFwcGVuZENoaWxkKHRoaXMud3JpdGVfd21jX0RpbWVuc2lvbkxpc3QoYSkpO2IuYXBwZW5kQ2hpbGQodGhpcy53cml0ZV93bWNfTGF5ZXJFeHRlbnNpb24oYSkpfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Gb3JtYXQuV01DLnYxXzBfMFwifSk7T3BlbkxheWVycy5Qb3B1cC5GcmFtZWQ9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLlBvcHVwLkFuY2hvcmVkLHtpbWFnZVNyYzpudWxsLGltYWdlU2l6ZTpudWxsLGlzQWxwaGFJbWFnZTohMSxwb3NpdGlvbkJsb2NrczpudWxsLGJsb2NrczpudWxsLGZpeGVkUmVsYXRpdmVQb3NpdGlvbjohMSxpbml0aWFsaXplOmZ1bmN0aW9uKGEsYixjLGQsZSxmLGcpe09wZW5MYXllcnMuUG9wdXAuQW5jaG9yZWQucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuZml4ZWRSZWxhdGl2ZVBvc2l0aW9uJiYodGhpcy51cGRhdGVSZWxhdGl2ZVBvc2l0aW9uKCksdGhpcy5jYWxjdWxhdGVSZWxhdGl2ZVBvc2l0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVsYXRpdmVQb3NpdGlvbn0pO3RoaXMuY29udGVudERpdi5zdHlsZS5wb3NpdGlvbj1cImFic29sdXRlXCI7dGhpcy5jb250ZW50RGl2LnN0eWxlLnpJbmRleD0xO2YmJih0aGlzLmNsb3NlRGl2LnN0eWxlLnpJbmRleD1cbjEpO3RoaXMuZ3JvdXBEaXYuc3R5bGUucG9zaXRpb249XCJhYnNvbHV0ZVwiO3RoaXMuZ3JvdXBEaXYuc3R5bGUudG9wPVwiMHB4XCI7dGhpcy5ncm91cERpdi5zdHlsZS5sZWZ0PVwiMHB4XCI7dGhpcy5ncm91cERpdi5zdHlsZS5oZWlnaHQ9XCIxMDAlXCI7dGhpcy5ncm91cERpdi5zdHlsZS53aWR0aD1cIjEwMCVcIn0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMuaXNBbHBoYUltYWdlPXRoaXMuaW1hZ2VTaXplPXRoaXMuaW1hZ2VTcmM9bnVsbDt0aGlzLmZpeGVkUmVsYXRpdmVQb3NpdGlvbj0hMTt0aGlzLnBvc2l0aW9uQmxvY2tzPW51bGw7Zm9yKHZhciBhPTA7YTx0aGlzLmJsb2Nrcy5sZW5ndGg7YSsrKXt2YXIgYj10aGlzLmJsb2Nrc1thXTtiLmltYWdlJiZiLmRpdi5yZW1vdmVDaGlsZChiLmltYWdlKTtiLmltYWdlPW51bGw7Yi5kaXYmJnRoaXMuZ3JvdXBEaXYucmVtb3ZlQ2hpbGQoYi5kaXYpO2IuZGl2PW51bGx9dGhpcy5ibG9ja3M9bnVsbDtPcGVuTGF5ZXJzLlBvcHVwLkFuY2hvcmVkLnByb3RvdHlwZS5kZXN0cm95LmFwcGx5KHRoaXMsXG5hcmd1bWVudHMpfSxzZXRCYWNrZ3JvdW5kQ29sb3I6ZnVuY3Rpb24oKXt9LHNldEJvcmRlcjpmdW5jdGlvbigpe30sc2V0T3BhY2l0eTpmdW5jdGlvbigpe30sc2V0U2l6ZTpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLlBvcHVwLkFuY2hvcmVkLnByb3RvdHlwZS5zZXRTaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLnVwZGF0ZUJsb2NrcygpfSx1cGRhdGVSZWxhdGl2ZVBvc2l0aW9uOmZ1bmN0aW9uKCl7dGhpcy5wYWRkaW5nPXRoaXMucG9zaXRpb25CbG9ja3NbdGhpcy5yZWxhdGl2ZVBvc2l0aW9uXS5wYWRkaW5nO2lmKHRoaXMuY2xvc2VEaXYpe3ZhciBhPXRoaXMuZ2V0Q29udGVudERpdlBhZGRpbmcoKTt0aGlzLmNsb3NlRGl2LnN0eWxlLnJpZ2h0PWEucmlnaHQrdGhpcy5wYWRkaW5nLnJpZ2h0K1wicHhcIjt0aGlzLmNsb3NlRGl2LnN0eWxlLnRvcD1hLnRvcCt0aGlzLnBhZGRpbmcudG9wK1wicHhcIn10aGlzLnVwZGF0ZUJsb2NrcygpfSxjYWxjdWxhdGVOZXdQeDpmdW5jdGlvbihhKXt2YXIgYj1cbk9wZW5MYXllcnMuUG9wdXAuQW5jaG9yZWQucHJvdG90eXBlLmNhbGN1bGF0ZU5ld1B4LmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm4gYj1iLm9mZnNldCh0aGlzLnBvc2l0aW9uQmxvY2tzW3RoaXMucmVsYXRpdmVQb3NpdGlvbl0ub2Zmc2V0KX0sY3JlYXRlQmxvY2tzOmZ1bmN0aW9uKCl7dGhpcy5ibG9ja3M9W107dmFyIGE9bnVsbCxiO2ZvcihiIGluIHRoaXMucG9zaXRpb25CbG9ja3Mpe2E9YjticmVha31hPXRoaXMucG9zaXRpb25CbG9ja3NbYV07Zm9yKGI9MDtiPGEuYmxvY2tzLmxlbmd0aDtiKyspe3ZhciBjPXt9O3RoaXMuYmxvY2tzLnB1c2goYyk7Yy5kaXY9T3BlbkxheWVycy5VdGlsLmNyZWF0ZURpdih0aGlzLmlkK1wiX0ZyYW1lRGVjb3JhdGlvbkRpdl9cIitiLG51bGwsbnVsbCxudWxsLFwiYWJzb2x1dGVcIixudWxsLFwiaGlkZGVuXCIsbnVsbCk7Yy5pbWFnZT0odGhpcy5pc0FscGhhSW1hZ2U/T3BlbkxheWVycy5VdGlsLmNyZWF0ZUFscGhhSW1hZ2VEaXY6T3BlbkxheWVycy5VdGlsLmNyZWF0ZUltYWdlKSh0aGlzLmlkK1xuXCJfRnJhbWVEZWNvcmF0aW9uSW1nX1wiK2IsbnVsbCx0aGlzLmltYWdlU2l6ZSx0aGlzLmltYWdlU3JjLFwiYWJzb2x1dGVcIixudWxsLG51bGwsbnVsbCk7Yy5kaXYuYXBwZW5kQ2hpbGQoYy5pbWFnZSk7dGhpcy5ncm91cERpdi5hcHBlbmRDaGlsZChjLmRpdil9fSx1cGRhdGVCbG9ja3M6ZnVuY3Rpb24oKXt0aGlzLmJsb2Nrc3x8dGhpcy5jcmVhdGVCbG9ja3MoKTtpZih0aGlzLnNpemUmJnRoaXMucmVsYXRpdmVQb3NpdGlvbil7Zm9yKHZhciBhPXRoaXMucG9zaXRpb25CbG9ja3NbdGhpcy5yZWxhdGl2ZVBvc2l0aW9uXSxiPTA7YjxhLmJsb2Nrcy5sZW5ndGg7YisrKXt2YXIgYz1hLmJsb2Nrc1tiXSxkPXRoaXMuYmxvY2tzW2JdLGU9Yy5hbmNob3IubGVmdCxmPWMuYW5jaG9yLmJvdHRvbSxnPWMuYW5jaG9yLnJpZ2h0LGg9Yy5hbmNob3IudG9wLGk9aXNOYU4oYy5zaXplLncpP3RoaXMuc2l6ZS53LShnK2UpOmMuc2l6ZS53LGo9aXNOYU4oYy5zaXplLmgpP3RoaXMuc2l6ZS5oLShmK1xuaCk6Yy5zaXplLmg7ZC5kaXYuc3R5bGUud2lkdGg9KDA+aT8wOmkpK1wicHhcIjtkLmRpdi5zdHlsZS5oZWlnaHQ9KDA+aj8wOmopK1wicHhcIjtkLmRpdi5zdHlsZS5sZWZ0PW51bGwhPWU/ZStcInB4XCI6XCJcIjtkLmRpdi5zdHlsZS5ib3R0b209bnVsbCE9Zj9mK1wicHhcIjpcIlwiO2QuZGl2LnN0eWxlLnJpZ2h0PW51bGwhPWc/ZytcInB4XCI6XCJcIjtkLmRpdi5zdHlsZS50b3A9bnVsbCE9aD9oK1wicHhcIjpcIlwiO2QuaW1hZ2Uuc3R5bGUubGVmdD1jLnBvc2l0aW9uLngrXCJweFwiO2QuaW1hZ2Uuc3R5bGUudG9wPWMucG9zaXRpb24ueStcInB4XCJ9dGhpcy5jb250ZW50RGl2LnN0eWxlLmxlZnQ9dGhpcy5wYWRkaW5nLmxlZnQrXCJweFwiO3RoaXMuY29udGVudERpdi5zdHlsZS50b3A9dGhpcy5wYWRkaW5nLnRvcCtcInB4XCJ9fSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Qb3B1cC5GcmFtZWRcIn0pO09wZW5MYXllcnMuUG9wdXAuRnJhbWVkQ2xvdWQ9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLlBvcHVwLkZyYW1lZCx7Y29udGVudERpc3BsYXlDbGFzczpcIm9sRnJhbWVkQ2xvdWRQb3B1cENvbnRlbnRcIixhdXRvU2l6ZTohMCxwYW5NYXBJZk91dE9mVmlldzohMCxpbWFnZVNpemU6bmV3IE9wZW5MYXllcnMuU2l6ZSgxMjc2LDczNiksaXNBbHBoYUltYWdlOiExLGZpeGVkUmVsYXRpdmVQb3NpdGlvbjohMSxwb3NpdGlvbkJsb2Nrczp7dGw6e29mZnNldDpuZXcgT3BlbkxheWVycy5QaXhlbCg0NCwwKSxwYWRkaW5nOm5ldyBPcGVuTGF5ZXJzLkJvdW5kcyg4LDQwLDgsOSksYmxvY2tzOlt7c2l6ZTpuZXcgT3BlbkxheWVycy5TaXplKFwiYXV0b1wiLFwiYXV0b1wiKSxhbmNob3I6bmV3IE9wZW5MYXllcnMuQm91bmRzKDAsNTEsMjIsMCkscG9zaXRpb246bmV3IE9wZW5MYXllcnMuUGl4ZWwoMCwwKX0se3NpemU6bmV3IE9wZW5MYXllcnMuU2l6ZSgyMixcImF1dG9cIiksYW5jaG9yOm5ldyBPcGVuTGF5ZXJzLkJvdW5kcyhudWxsLFxuNTAsMCwwKSxwb3NpdGlvbjpuZXcgT3BlbkxheWVycy5QaXhlbCgtMTIzOCwwKX0se3NpemU6bmV3IE9wZW5MYXllcnMuU2l6ZShcImF1dG9cIiwxOSksYW5jaG9yOm5ldyBPcGVuTGF5ZXJzLkJvdW5kcygwLDMyLDIyLG51bGwpLHBvc2l0aW9uOm5ldyBPcGVuTGF5ZXJzLlBpeGVsKDAsLTYzMSl9LHtzaXplOm5ldyBPcGVuTGF5ZXJzLlNpemUoMjIsMTgpLGFuY2hvcjpuZXcgT3BlbkxheWVycy5Cb3VuZHMobnVsbCwzMiwwLG51bGwpLHBvc2l0aW9uOm5ldyBPcGVuTGF5ZXJzLlBpeGVsKC0xMjM4LC02MzIpfSx7c2l6ZTpuZXcgT3BlbkxheWVycy5TaXplKDgxLDM1KSxhbmNob3I6bmV3IE9wZW5MYXllcnMuQm91bmRzKG51bGwsMCwwLG51bGwpLHBvc2l0aW9uOm5ldyBPcGVuTGF5ZXJzLlBpeGVsKDAsLTY4OCl9XX0sdHI6e29mZnNldDpuZXcgT3BlbkxheWVycy5QaXhlbCgtNDUsMCkscGFkZGluZzpuZXcgT3BlbkxheWVycy5Cb3VuZHMoOCw0MCw4LDkpLGJsb2Nrczpbe3NpemU6bmV3IE9wZW5MYXllcnMuU2l6ZShcImF1dG9cIixcblwiYXV0b1wiKSxhbmNob3I6bmV3IE9wZW5MYXllcnMuQm91bmRzKDAsNTEsMjIsMCkscG9zaXRpb246bmV3IE9wZW5MYXllcnMuUGl4ZWwoMCwwKX0se3NpemU6bmV3IE9wZW5MYXllcnMuU2l6ZSgyMixcImF1dG9cIiksYW5jaG9yOm5ldyBPcGVuTGF5ZXJzLkJvdW5kcyhudWxsLDUwLDAsMCkscG9zaXRpb246bmV3IE9wZW5MYXllcnMuUGl4ZWwoLTEyMzgsMCl9LHtzaXplOm5ldyBPcGVuTGF5ZXJzLlNpemUoXCJhdXRvXCIsMTkpLGFuY2hvcjpuZXcgT3BlbkxheWVycy5Cb3VuZHMoMCwzMiwyMixudWxsKSxwb3NpdGlvbjpuZXcgT3BlbkxheWVycy5QaXhlbCgwLC02MzEpfSx7c2l6ZTpuZXcgT3BlbkxheWVycy5TaXplKDIyLDE5KSxhbmNob3I6bmV3IE9wZW5MYXllcnMuQm91bmRzKG51bGwsMzIsMCxudWxsKSxwb3NpdGlvbjpuZXcgT3BlbkxheWVycy5QaXhlbCgtMTIzOCwtNjMxKX0se3NpemU6bmV3IE9wZW5MYXllcnMuU2l6ZSg4MSwzNSksYW5jaG9yOm5ldyBPcGVuTGF5ZXJzLkJvdW5kcygwLFxuMCxudWxsLG51bGwpLHBvc2l0aW9uOm5ldyBPcGVuTGF5ZXJzLlBpeGVsKC0yMTUsLTY4Nyl9XX0sYmw6e29mZnNldDpuZXcgT3BlbkxheWVycy5QaXhlbCg0NSwwKSxwYWRkaW5nOm5ldyBPcGVuTGF5ZXJzLkJvdW5kcyg4LDksOCw0MCksYmxvY2tzOlt7c2l6ZTpuZXcgT3BlbkxheWVycy5TaXplKFwiYXV0b1wiLFwiYXV0b1wiKSxhbmNob3I6bmV3IE9wZW5MYXllcnMuQm91bmRzKDAsMjEsMjIsMzIpLHBvc2l0aW9uOm5ldyBPcGVuTGF5ZXJzLlBpeGVsKDAsMCl9LHtzaXplOm5ldyBPcGVuTGF5ZXJzLlNpemUoMjIsXCJhdXRvXCIpLGFuY2hvcjpuZXcgT3BlbkxheWVycy5Cb3VuZHMobnVsbCwyMSwwLDMyKSxwb3NpdGlvbjpuZXcgT3BlbkxheWVycy5QaXhlbCgtMTIzOCwwKX0se3NpemU6bmV3IE9wZW5MYXllcnMuU2l6ZShcImF1dG9cIiwyMSksYW5jaG9yOm5ldyBPcGVuTGF5ZXJzLkJvdW5kcygwLDAsMjIsbnVsbCkscG9zaXRpb246bmV3IE9wZW5MYXllcnMuUGl4ZWwoMCwtNjI5KX0se3NpemU6bmV3IE9wZW5MYXllcnMuU2l6ZSgyMixcbjIxKSxhbmNob3I6bmV3IE9wZW5MYXllcnMuQm91bmRzKG51bGwsMCwwLG51bGwpLHBvc2l0aW9uOm5ldyBPcGVuTGF5ZXJzLlBpeGVsKC0xMjM4LC02MjkpfSx7c2l6ZTpuZXcgT3BlbkxheWVycy5TaXplKDgxLDMzKSxhbmNob3I6bmV3IE9wZW5MYXllcnMuQm91bmRzKG51bGwsbnVsbCwwLDApLHBvc2l0aW9uOm5ldyBPcGVuTGF5ZXJzLlBpeGVsKC0xMDEsLTY3NCl9XX0sYnI6e29mZnNldDpuZXcgT3BlbkxheWVycy5QaXhlbCgtNDQsMCkscGFkZGluZzpuZXcgT3BlbkxheWVycy5Cb3VuZHMoOCw5LDgsNDApLGJsb2Nrczpbe3NpemU6bmV3IE9wZW5MYXllcnMuU2l6ZShcImF1dG9cIixcImF1dG9cIiksYW5jaG9yOm5ldyBPcGVuTGF5ZXJzLkJvdW5kcygwLDIxLDIyLDMyKSxwb3NpdGlvbjpuZXcgT3BlbkxheWVycy5QaXhlbCgwLDApfSx7c2l6ZTpuZXcgT3BlbkxheWVycy5TaXplKDIyLFwiYXV0b1wiKSxhbmNob3I6bmV3IE9wZW5MYXllcnMuQm91bmRzKG51bGwsMjEsMCwzMikscG9zaXRpb246bmV3IE9wZW5MYXllcnMuUGl4ZWwoLTEyMzgsXG4wKX0se3NpemU6bmV3IE9wZW5MYXllcnMuU2l6ZShcImF1dG9cIiwyMSksYW5jaG9yOm5ldyBPcGVuTGF5ZXJzLkJvdW5kcygwLDAsMjIsbnVsbCkscG9zaXRpb246bmV3IE9wZW5MYXllcnMuUGl4ZWwoMCwtNjI5KX0se3NpemU6bmV3IE9wZW5MYXllcnMuU2l6ZSgyMiwyMSksYW5jaG9yOm5ldyBPcGVuTGF5ZXJzLkJvdW5kcyhudWxsLDAsMCxudWxsKSxwb3NpdGlvbjpuZXcgT3BlbkxheWVycy5QaXhlbCgtMTIzOCwtNjI5KX0se3NpemU6bmV3IE9wZW5MYXllcnMuU2l6ZSg4MSwzMyksYW5jaG9yOm5ldyBPcGVuTGF5ZXJzLkJvdW5kcygwLG51bGwsbnVsbCwwKSxwb3NpdGlvbjpuZXcgT3BlbkxheWVycy5QaXhlbCgtMzExLC02NzQpfV19fSxtaW5TaXplOm5ldyBPcGVuTGF5ZXJzLlNpemUoMTA1LDEwKSxtYXhTaXplOm5ldyBPcGVuTGF5ZXJzLlNpemUoMTIwMCw2NjApLGluaXRpYWxpemU6ZnVuY3Rpb24oYSxiLGMsZCxlLGYsZyl7dGhpcy5pbWFnZVNyYz1PcGVuTGF5ZXJzLlV0aWwuZ2V0SW1hZ2VMb2NhdGlvbihcImNsb3VkLXBvcHVwLXJlbGF0aXZlLnBuZ1wiKTtcbk9wZW5MYXllcnMuUG9wdXAuRnJhbWVkLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmNvbnRlbnREaXYuY2xhc3NOYW1lPXRoaXMuY29udGVudERpc3BsYXlDbGFzc30sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuUG9wdXAuRnJhbWVkQ2xvdWRcIn0pO09wZW5MYXllcnMuVGlsZS5JbWFnZS5JRnJhbWU9e3VzZUlGcmFtZTpudWxsLGRyYXc6ZnVuY3Rpb24oKXtpZihPcGVuTGF5ZXJzLlRpbGUuSW1hZ2UucHJvdG90eXBlLnNob3VsZERyYXcuY2FsbCh0aGlzKSl7dmFyIGE9dGhpcy5sYXllci5nZXRVUkwodGhpcy5ib3VuZHMpLGI9dGhpcy51c2VJRnJhbWU7dGhpcy51c2VJRnJhbWU9bnVsbCE9PXRoaXMubWF4R2V0VXJsTGVuZ3RoJiYhdGhpcy5sYXllci5hc3luYyYmYS5sZW5ndGg+dGhpcy5tYXhHZXRVcmxMZW5ndGg7YT1iJiYhdGhpcy51c2VJRnJhbWU7Yj0hYiYmdGhpcy51c2VJRnJhbWU7aWYoYXx8Yil0aGlzLmltZ0RpdiYmdGhpcy5pbWdEaXYucGFyZW50Tm9kZT09PXRoaXMuZnJhbWUmJnRoaXMuZnJhbWUucmVtb3ZlQ2hpbGQodGhpcy5pbWdEaXYpLHRoaXMuaW1nRGl2PW51bGwsYT8odGhpcy5ibGFua0ltYWdlVXJsPXRoaXMuX2JsYW5rSW1hZ2VVcmwsdGhpcy5mcmFtZS5yZW1vdmVDaGlsZCh0aGlzLmZyYW1lLmZpcnN0Q2hpbGQpKTpcbih0aGlzLl9ibGFua0ltYWdlVXJsPXRoaXMuYmxhbmtJbWFnZVVybCx0aGlzLmJsYW5rSW1hZ2VVcmw9XCJhYm91dDpibGFua1wiKX1yZXR1cm4gT3BlbkxheWVycy5UaWxlLkltYWdlLnByb3RvdHlwZS5kcmF3LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sZ2V0SW1hZ2U6ZnVuY3Rpb24oKXtpZighMD09PXRoaXMudXNlSUZyYW1lKXtpZighdGhpcy5mcmFtZS5jaGlsZE5vZGVzLmxlbmd0aCl7dmFyIGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSxiPWEuc3R5bGU7Yi5wb3NpdGlvbj1cImFic29sdXRlXCI7Yi53aWR0aD1cIjEwMCVcIjtiLmhlaWdodD1cIjEwMCVcIjtiLnpJbmRleD0xO2IuYmFja2dyb3VuZEltYWdlPVwidXJsKFwiK3RoaXMuX2JsYW5rSW1hZ2VVcmwrXCIpXCI7dGhpcy5mcmFtZS5hcHBlbmRDaGlsZChhKX1hPXRoaXMuaWQrXCJfaUZyYW1lXCI7OT5wYXJzZUZsb2F0KG5hdmlnYXRvci5hcHBWZXJzaW9uLnNwbGl0KFwiTVNJRVwiKVsxXSk/KGI9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnPGlmcmFtZSBuYW1lPVwiJytcbmErJ1wiPicpLGIuc3R5bGUuYmFja2dyb3VuZENvbG9yPVwiI0ZGRkZGRlwiLGIuc3R5bGUuZmlsdGVyPVwiY2hyb21hKGNvbG9yPSNGRkZGRkYpXCIpOihiPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpZnJhbWVcIiksYi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3I9XCJ0cmFuc3BhcmVudFwiLGIubmFtZT1hKTtiLnNjcm9sbGluZz1cIm5vXCI7Yi5tYXJnaW5XaWR0aD1cIjBweFwiO2IubWFyZ2luSGVpZ2h0PVwiMHB4XCI7Yi5mcmFtZUJvcmRlcj1cIjBcIjtiLnN0eWxlLnBvc2l0aW9uPVwiYWJzb2x1dGVcIjtiLnN0eWxlLndpZHRoPVwiMTAwJVwiO2Iuc3R5bGUuaGVpZ2h0PVwiMTAwJVwiOzE+dGhpcy5sYXllci5vcGFjaXR5JiZPcGVuTGF5ZXJzLlV0aWwubW9kaWZ5RE9NRWxlbWVudChiLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLHRoaXMubGF5ZXIub3BhY2l0eSk7dGhpcy5mcmFtZS5hcHBlbmRDaGlsZChiKTtyZXR1cm4gdGhpcy5pbWdEaXY9Yn1yZXR1cm4gT3BlbkxheWVycy5UaWxlLkltYWdlLnByb3RvdHlwZS5nZXRJbWFnZS5hcHBseSh0aGlzLFxuYXJndW1lbnRzKX0sY3JlYXRlUmVxdWVzdEZvcm06ZnVuY3Rpb24oKXt2YXIgYT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZm9ybVwiKTthLm1ldGhvZD1cIlBPU1RcIjt2YXIgYj10aGlzLmxheWVyLnBhcmFtcy5fT0xTQUxULGI9KGI/YitcIl9cIjpcIlwiKSt0aGlzLmJvdW5kcy50b0JCT1goKTthLmFjdGlvbj1PcGVuTGF5ZXJzLlV0aWwudXJsQXBwZW5kKHRoaXMubGF5ZXIudXJsLGIpO2EudGFyZ2V0PXRoaXMuaWQrXCJfaUZyYW1lXCI7dGhpcy5sYXllci5nZXRJbWFnZVNpemUoKTt2YXIgYj1PcGVuTGF5ZXJzLlV0aWwuZ2V0UGFyYW1ldGVycyh0aGlzLnVybCksYyxkO2ZvcihkIGluIGIpYz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIiksYy50eXBlPVwiaGlkZGVuXCIsYy5uYW1lPWQsYy52YWx1ZT1iW2RdLGEuYXBwZW5kQ2hpbGQoYyk7cmV0dXJuIGF9LHNldEltZ1NyYzpmdW5jdGlvbihhKXtpZighMD09PXRoaXMudXNlSUZyYW1lKWlmKGEpe3ZhciBiPXRoaXMuY3JlYXRlUmVxdWVzdEZvcm0oKTtcbnRoaXMuZnJhbWUuYXBwZW5kQ2hpbGQoYik7Yi5zdWJtaXQoKTt0aGlzLmZyYW1lLnJlbW92ZUNoaWxkKGIpfWVsc2UgdGhpcy5pbWdEaXYucGFyZW50Tm9kZT09PXRoaXMuZnJhbWUmJih0aGlzLmZyYW1lLnJlbW92ZUNoaWxkKHRoaXMuaW1nRGl2KSx0aGlzLmltZ0Rpdj1udWxsKTtlbHNlIE9wZW5MYXllcnMuVGlsZS5JbWFnZS5wcm90b3R5cGUuc2V0SW1nU3JjLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sb25JbWFnZUxvYWQ6ZnVuY3Rpb24oKXtPcGVuTGF5ZXJzLlRpbGUuSW1hZ2UucHJvdG90eXBlLm9uSW1hZ2VMb2FkLmFwcGx5KHRoaXMsYXJndW1lbnRzKTshMD09PXRoaXMudXNlSUZyYW1lJiYodGhpcy5pbWdEaXYuc3R5bGUub3BhY2l0eT0xLHRoaXMuZnJhbWUuc3R5bGUub3BhY2l0eT10aGlzLmxheWVyLm9wYWNpdHkpfSxjcmVhdGVCYWNrQnVmZmVyOmZ1bmN0aW9uKCl7dmFyIGE7ITE9PT10aGlzLnVzZUlGcmFtZSYmKGE9T3BlbkxheWVycy5UaWxlLkltYWdlLnByb3RvdHlwZS5jcmVhdGVCYWNrQnVmZmVyLmNhbGwodGhpcykpO1xucmV0dXJuIGF9fTtPcGVuTGF5ZXJzLkZvcm1hdC5TT1NDYXBhYmlsaXRpZXM9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkZvcm1hdC5YTUwuVmVyc2lvbmVkT0dDLHtkZWZhdWx0VmVyc2lvbjpcIjEuMC4wXCIsQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuRm9ybWF0LlNPU0NhcGFiaWxpdGllc1wifSk7T3BlbkxheWVycy5Gb3JtYXQuU09TQ2FwYWJpbGl0aWVzLnYxXzBfMD1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuRm9ybWF0LlNPU0NhcGFiaWxpdGllcyx7bmFtZXNwYWNlczp7b3dzOlwiaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC9vd3MvMS4xXCIsc29zOlwiaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC9zb3MvMS4wXCIsZ21sOlwiaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC9nbWxcIix4bGluazpcImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmtcIn0scmVnRXhlczp7dHJpbVNwYWNlOi9eXFxzKnxcXHMqJC9nLHJlbW92ZVNwYWNlOi9cXHMqL2csc3BsaXRTcGFjZTovXFxzKy8sdHJpbUNvbW1hOi9cXHMqLFxccyovZ30saW5pdGlhbGl6ZTpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLkZvcm1hdC5YTUwucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbYV0pO3RoaXMub3B0aW9ucz1hfSxyZWFkOmZ1bmN0aW9uKGEpe1wic3RyaW5nXCI9PXR5cGVvZiBhJiYoYT1PcGVuTGF5ZXJzLkZvcm1hdC5YTUwucHJvdG90eXBlLnJlYWQuYXBwbHkodGhpcyxcblthXSkpO2EmJjk9PWEubm9kZVR5cGUmJihhPWEuZG9jdW1lbnRFbGVtZW50KTt2YXIgYj17fTt0aGlzLnJlYWROb2RlKGEsYik7cmV0dXJuIGJ9LHJlYWRlcnM6e2dtbDpPcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyh7bmFtZTpmdW5jdGlvbihhLGIpe2IubmFtZT10aGlzLmdldENoaWxkVmFsdWUoYSl9LFRpbWVQZXJpb2Q6ZnVuY3Rpb24oYSxiKXtiLnRpbWVQZXJpb2Q9e307dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIudGltZVBlcmlvZCl9LGJlZ2luUG9zaXRpb246ZnVuY3Rpb24oYSxiKXtiLmJlZ2luUG9zaXRpb249dGhpcy5nZXRDaGlsZFZhbHVlKGEpfSxlbmRQb3NpdGlvbjpmdW5jdGlvbihhLGIpe2IuZW5kUG9zaXRpb249dGhpcy5nZXRDaGlsZFZhbHVlKGEpfX0sT3BlbkxheWVycy5Gb3JtYXQuR01MLnYzLnByb3RvdHlwZS5yZWFkZXJzLmdtbCksc29zOntDYXBhYmlsaXRpZXM6ZnVuY3Rpb24oYSxiKXt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYil9LENvbnRlbnRzOmZ1bmN0aW9uKGEsXG5iKXtiLmNvbnRlbnRzPXt9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxiLmNvbnRlbnRzKX0sT2JzZXJ2YXRpb25PZmZlcmluZ0xpc3Q6ZnVuY3Rpb24oYSxiKXtiLm9mZmVyaW5nTGlzdD17fTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYi5vZmZlcmluZ0xpc3QpfSxPYnNlcnZhdGlvbk9mZmVyaW5nOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5nZXRBdHRyaWJ1dGVOUyhhLHRoaXMubmFtZXNwYWNlcy5nbWwsXCJpZFwiKTtiW2NdPXtwcm9jZWR1cmVzOltdLG9ic2VydmVkUHJvcGVydGllczpbXSxmZWF0dXJlT2ZJbnRlcmVzdElkczpbXSxyZXNwb25zZUZvcm1hdHM6W10scmVzdWx0TW9kZWxzOltdLHJlc3BvbnNlTW9kZXM6W119O3RoaXMucmVhZENoaWxkTm9kZXMoYSxiW2NdKX0sdGltZTpmdW5jdGlvbihhLGIpe2IudGltZT17fTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYi50aW1lKX0scHJvY2VkdXJlOmZ1bmN0aW9uKGEsYil7Yi5wcm9jZWR1cmVzLnB1c2godGhpcy5nZXRBdHRyaWJ1dGVOUyhhLFxudGhpcy5uYW1lc3BhY2VzLnhsaW5rLFwiaHJlZlwiKSl9LG9ic2VydmVkUHJvcGVydHk6ZnVuY3Rpb24oYSxiKXtiLm9ic2VydmVkUHJvcGVydGllcy5wdXNoKHRoaXMuZ2V0QXR0cmlidXRlTlMoYSx0aGlzLm5hbWVzcGFjZXMueGxpbmssXCJocmVmXCIpKX0sZmVhdHVyZU9mSW50ZXJlc3Q6ZnVuY3Rpb24oYSxiKXtiLmZlYXR1cmVPZkludGVyZXN0SWRzLnB1c2godGhpcy5nZXRBdHRyaWJ1dGVOUyhhLHRoaXMubmFtZXNwYWNlcy54bGluayxcImhyZWZcIikpfSxyZXNwb25zZUZvcm1hdDpmdW5jdGlvbihhLGIpe2IucmVzcG9uc2VGb3JtYXRzLnB1c2godGhpcy5nZXRDaGlsZFZhbHVlKGEpKX0scmVzdWx0TW9kZWw6ZnVuY3Rpb24oYSxiKXtiLnJlc3VsdE1vZGVscy5wdXNoKHRoaXMuZ2V0Q2hpbGRWYWx1ZShhKSl9LHJlc3BvbnNlTW9kZTpmdW5jdGlvbihhLGIpe2IucmVzcG9uc2VNb2Rlcy5wdXNoKHRoaXMuZ2V0Q2hpbGRWYWx1ZShhKSl9fSxvd3M6T3BlbkxheWVycy5Gb3JtYXQuT1dTQ29tbW9uLnYxXzFfMC5wcm90b3R5cGUucmVhZGVycy5vd3N9LFxuQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuRm9ybWF0LlNPU0NhcGFiaWxpdGllcy52MV8wXzBcIn0pO09wZW5MYXllcnMuSGFuZGxlci5QaW5jaD1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuSGFuZGxlcix7c3RhcnRlZDohMSxzdG9wRG93bjohMSxwaW5jaGluZzohMSxsYXN0Om51bGwsc3RhcnQ6bnVsbCx0b3VjaHN0YXJ0OmZ1bmN0aW9uKGEpe3ZhciBiPSEwO3RoaXMucGluY2hpbmc9ITE7T3BlbkxheWVycy5FdmVudC5pc011bHRpVG91Y2goYSk/KHRoaXMuc3RhcnRlZD0hMCx0aGlzLmxhc3Q9dGhpcy5zdGFydD17ZGlzdGFuY2U6dGhpcy5nZXREaXN0YW5jZShhLnRvdWNoZXMpLGRlbHRhOjAsc2NhbGU6MX0sdGhpcy5jYWxsYmFjayhcInN0YXJ0XCIsW2EsdGhpcy5zdGFydF0pLGI9IXRoaXMuc3RvcERvd24pOih0aGlzLnN0YXJ0ZWQ9ITEsdGhpcy5sYXN0PXRoaXMuc3RhcnQ9bnVsbCk7T3BlbkxheWVycy5FdmVudC5zdG9wKGEpO3JldHVybiBifSx0b3VjaG1vdmU6ZnVuY3Rpb24oYSl7aWYodGhpcy5zdGFydGVkJiZPcGVuTGF5ZXJzLkV2ZW50LmlzTXVsdGlUb3VjaChhKSl7dGhpcy5waW5jaGluZz1cbiEwO3ZhciBiPXRoaXMuZ2V0UGluY2hEYXRhKGEpO3RoaXMuY2FsbGJhY2soXCJtb3ZlXCIsW2EsYl0pO3RoaXMubGFzdD1iO09wZW5MYXllcnMuRXZlbnQuc3RvcChhKX1yZXR1cm4hMH0sdG91Y2hlbmQ6ZnVuY3Rpb24oYSl7dGhpcy5zdGFydGVkJiYodGhpcy5waW5jaGluZz10aGlzLnN0YXJ0ZWQ9ITEsdGhpcy5jYWxsYmFjayhcImRvbmVcIixbYSx0aGlzLnN0YXJ0LHRoaXMubGFzdF0pLHRoaXMubGFzdD10aGlzLnN0YXJ0PW51bGwpO3JldHVybiEwfSxhY3RpdmF0ZTpmdW5jdGlvbigpe3ZhciBhPSExO09wZW5MYXllcnMuSGFuZGxlci5wcm90b3R5cGUuYWN0aXZhdGUuYXBwbHkodGhpcyxhcmd1bWVudHMpJiYodGhpcy5waW5jaGluZz0hMSxhPSEwKTtyZXR1cm4gYX0sZGVhY3RpdmF0ZTpmdW5jdGlvbigpe3ZhciBhPSExO09wZW5MYXllcnMuSGFuZGxlci5wcm90b3R5cGUuZGVhY3RpdmF0ZS5hcHBseSh0aGlzLGFyZ3VtZW50cykmJih0aGlzLnBpbmNoaW5nPXRoaXMuc3RhcnRlZD1cbiExLHRoaXMubGFzdD10aGlzLnN0YXJ0PW51bGwsYT0hMCk7cmV0dXJuIGF9LGdldERpc3RhbmNlOmZ1bmN0aW9uKGEpe3ZhciBiPWFbMF0sYT1hWzFdO3JldHVybiBNYXRoLnNxcnQoTWF0aC5wb3coYi5jbGllbnRYLWEuY2xpZW50WCwyKStNYXRoLnBvdyhiLmNsaWVudFktYS5jbGllbnRZLDIpKX0sZ2V0UGluY2hEYXRhOmZ1bmN0aW9uKGEpe2E9dGhpcy5nZXREaXN0YW5jZShhLnRvdWNoZXMpO3JldHVybntkaXN0YW5jZTphLGRlbHRhOnRoaXMubGFzdC5kaXN0YW5jZS1hLHNjYWxlOmEvdGhpcy5zdGFydC5kaXN0YW5jZX19LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkhhbmRsZXIuUGluY2hcIn0pO09wZW5MYXllcnMuQ29udHJvbC5OYXZUb29sYmFyPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Db250cm9sLlBhbmVsLHtpbml0aWFsaXplOmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuQ29udHJvbC5QYW5lbC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLFthXSk7dGhpcy5hZGRDb250cm9scyhbbmV3IE9wZW5MYXllcnMuQ29udHJvbC5OYXZpZ2F0aW9uLG5ldyBPcGVuTGF5ZXJzLkNvbnRyb2wuWm9vbUJveF0pfSxkcmF3OmZ1bmN0aW9uKCl7dmFyIGE9T3BlbkxheWVycy5Db250cm9sLlBhbmVsLnByb3RvdHlwZS5kcmF3LmFwcGx5KHRoaXMsYXJndW1lbnRzKTtudWxsPT09dGhpcy5kZWZhdWx0Q29udHJvbCYmKHRoaXMuZGVmYXVsdENvbnRyb2w9dGhpcy5jb250cm9sc1swXSk7cmV0dXJuIGF9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkNvbnRyb2wuTmF2VG9vbGJhclwifSk7T3BlbkxheWVycy5TdHJhdGVneS5SZWZyZXNoPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5TdHJhdGVneSx7Zm9yY2U6ITEsaW50ZXJ2YWw6MCx0aW1lcjpudWxsLGFjdGl2YXRlOmZ1bmN0aW9uKCl7dmFyIGE9T3BlbkxheWVycy5TdHJhdGVneS5wcm90b3R5cGUuYWN0aXZhdGUuY2FsbCh0aGlzKTthJiYoITA9PT10aGlzLmxheWVyLnZpc2liaWxpdHkmJnRoaXMuc3RhcnQoKSx0aGlzLmxheWVyLmV2ZW50cy5vbih7dmlzaWJpbGl0eWNoYW5nZWQ6dGhpcy5yZXNldCxzY29wZTp0aGlzfSkpO3JldHVybiBhfSxkZWFjdGl2YXRlOmZ1bmN0aW9uKCl7dmFyIGE9T3BlbkxheWVycy5TdHJhdGVneS5wcm90b3R5cGUuZGVhY3RpdmF0ZS5jYWxsKHRoaXMpO2EmJnRoaXMuc3RvcCgpO3JldHVybiBhfSxyZXNldDpmdW5jdGlvbigpeyEwPT09dGhpcy5sYXllci52aXNpYmlsaXR5P3RoaXMuc3RhcnQoKTp0aGlzLnN0b3AoKX0sc3RhcnQ6ZnVuY3Rpb24oKXt0aGlzLmludGVydmFsJiYoXCJudW1iZXJcIj09PVxudHlwZW9mIHRoaXMuaW50ZXJ2YWwmJjA8dGhpcy5pbnRlcnZhbCkmJih0aGlzLnRpbWVyPXdpbmRvdy5zZXRJbnRlcnZhbChPcGVuTGF5ZXJzLkZ1bmN0aW9uLmJpbmQodGhpcy5yZWZyZXNoLHRoaXMpLHRoaXMuaW50ZXJ2YWwpKX0scmVmcmVzaDpmdW5jdGlvbigpe3RoaXMubGF5ZXImJih0aGlzLmxheWVyLnJlZnJlc2gmJlwiZnVuY3Rpb25cIj09dHlwZW9mIHRoaXMubGF5ZXIucmVmcmVzaCkmJnRoaXMubGF5ZXIucmVmcmVzaCh7Zm9yY2U6dGhpcy5mb3JjZX0pfSxzdG9wOmZ1bmN0aW9uKCl7bnVsbCE9PXRoaXMudGltZXImJih3aW5kb3cuY2xlYXJJbnRlcnZhbCh0aGlzLnRpbWVyKSx0aGlzLnRpbWVyPW51bGwpfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5TdHJhdGVneS5SZWZyZXNoXCJ9KTtPcGVuTGF5ZXJzLkxheWVyLkFyY0dJUzkzUmVzdD1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuTGF5ZXIuR3JpZCx7REVGQVVMVF9QQVJBTVM6e2Zvcm1hdDpcInBuZ1wifSxpc0Jhc2VMYXllcjohMCxpbml0aWFsaXplOmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPVtdLGM9T3BlbkxheWVycy5VdGlsLnVwcGVyQ2FzZU9iamVjdChjKTtlLnB1c2goYSxiLGMsZCk7T3BlbkxheWVycy5MYXllci5HcmlkLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsZSk7T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHModGhpcy5wYXJhbXMsT3BlbkxheWVycy5VdGlsLnVwcGVyQ2FzZU9iamVjdCh0aGlzLkRFRkFVTFRfUEFSQU1TKSk7aWYodGhpcy5wYXJhbXMuVFJBTlNQQVJFTlQmJlwidHJ1ZVwiPT10aGlzLnBhcmFtcy5UUkFOU1BBUkVOVC50b1N0cmluZygpLnRvTG93ZXJDYXNlKCkpe2lmKG51bGw9PWR8fCFkLmlzQmFzZUxheWVyKXRoaXMuaXNCYXNlTGF5ZXI9ITE7XCJqcGdcIj09dGhpcy5wYXJhbXMuRk9STUFUJiZcbih0aGlzLnBhcmFtcy5GT1JNQVQ9T3BlbkxheWVycy5VdGlsLmFscGhhSGFjaygpP1wiZ2lmXCI6XCJwbmdcIil9fSxjbG9uZTpmdW5jdGlvbihhKXtudWxsPT1hJiYoYT1uZXcgT3BlbkxheWVycy5MYXllci5BcmNHSVM5M1Jlc3QodGhpcy5uYW1lLHRoaXMudXJsLHRoaXMucGFyYW1zLHRoaXMuZ2V0T3B0aW9ucygpKSk7cmV0dXJuIGE9T3BlbkxheWVycy5MYXllci5HcmlkLnByb3RvdHlwZS5jbG9uZS5hcHBseSh0aGlzLFthXSl9LGdldFVSTDpmdW5jdGlvbihhKXt2YXIgYT10aGlzLmFkanVzdEJvdW5kcyhhKSxiPXRoaXMucHJvamVjdGlvbi5nZXRDb2RlKCkuc3BsaXQoXCI6XCIpLGI9YltiLmxlbmd0aC0xXSxjPXRoaXMuZ2V0SW1hZ2VTaXplKCksYT17QkJPWDphLnRvQkJPWCgpLFNJWkU6Yy53K1wiLFwiK2MuaCxGOlwiaW1hZ2VcIixCQk9YU1I6YixJTUFHRVNSOmJ9O2lmKHRoaXMubGF5ZXJEZWZzKXt2YXIgYj1bXSxkO2ZvcihkIGluIHRoaXMubGF5ZXJEZWZzKXRoaXMubGF5ZXJEZWZzLmhhc093blByb3BlcnR5KGQpJiZcbnRoaXMubGF5ZXJEZWZzW2RdJiYoYi5wdXNoKGQpLGIucHVzaChcIjpcIiksYi5wdXNoKHRoaXMubGF5ZXJEZWZzW2RdKSxiLnB1c2goXCI7XCIpKTswPGIubGVuZ3RoJiYoYS5MQVlFUkRFRlM9Yi5qb2luKFwiXCIpKX1yZXR1cm4gdGhpcy5nZXRGdWxsUmVxdWVzdFN0cmluZyhhKX0sc2V0TGF5ZXJGaWx0ZXI6ZnVuY3Rpb24oYSxiKXt0aGlzLmxheWVyRGVmc3x8KHRoaXMubGF5ZXJEZWZzPXt9KTtiP3RoaXMubGF5ZXJEZWZzW2FdPWI6ZGVsZXRlIHRoaXMubGF5ZXJEZWZzW2FdfSxjbGVhckxheWVyRmlsdGVyOmZ1bmN0aW9uKGEpe2E/ZGVsZXRlIHRoaXMubGF5ZXJEZWZzW2FdOmRlbGV0ZSB0aGlzLmxheWVyRGVmc30sbWVyZ2VOZXdQYXJhbXM6ZnVuY3Rpb24oYSl7YT1bT3BlbkxheWVycy5VdGlsLnVwcGVyQ2FzZU9iamVjdChhKV07cmV0dXJuIE9wZW5MYXllcnMuTGF5ZXIuR3JpZC5wcm90b3R5cGUubWVyZ2VOZXdQYXJhbXMuYXBwbHkodGhpcyxhKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuTGF5ZXIuQXJjR0lTOTNSZXN0XCJ9KTtPcGVuTGF5ZXJzLkZvcm1hdC5XS1Q9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkZvcm1hdCx7aW5pdGlhbGl6ZTpmdW5jdGlvbihhKXt0aGlzLnJlZ0V4ZXM9e3R5cGVTdHI6L15cXHMqKFxcdyspXFxzKlxcKFxccyooLiopXFxzKlxcKVxccyokLyxzcGFjZXM6L1xccysvLHBhcmVuQ29tbWE6L1xcKVxccyosXFxzKlxcKC8sZG91YmxlUGFyZW5Db21tYTovXFwpXFxzKlxcKVxccyosXFxzKlxcKFxccypcXCgvLHRyaW1QYXJlbnM6L15cXHMqXFwoPyguKj8pXFwpP1xccyokL307T3BlbkxheWVycy5Gb3JtYXQucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbYV0pfSxyZWFkOmZ1bmN0aW9uKGEpe3ZhciBiLGMsYT1hLnJlcGxhY2UoL1tcXG5cXHJdL2csXCIgXCIpO2lmKGM9dGhpcy5yZWdFeGVzLnR5cGVTdHIuZXhlYyhhKSlpZihhPWNbMV0udG9Mb3dlckNhc2UoKSxjPWNbMl0sdGhpcy5wYXJzZVthXSYmKGI9dGhpcy5wYXJzZVthXS5hcHBseSh0aGlzLFtjXSkpLHRoaXMuaW50ZXJuYWxQcm9qZWN0aW9uJiZ0aGlzLmV4dGVybmFsUHJvamVjdGlvbilpZihiJiZcblwiT3BlbkxheWVycy5GZWF0dXJlLlZlY3RvclwiPT1iLkNMQVNTX05BTUUpYi5nZW9tZXRyeS50cmFuc2Zvcm0odGhpcy5leHRlcm5hbFByb2plY3Rpb24sdGhpcy5pbnRlcm5hbFByb2plY3Rpb24pO2Vsc2UgaWYoYiYmXCJnZW9tZXRyeWNvbGxlY3Rpb25cIiE9YSYmXCJvYmplY3RcIj09dHlwZW9mIGIpe2E9MDtmb3IoYz1iLmxlbmd0aDthPGM7YSsrKWJbYV0uZ2VvbWV0cnkudHJhbnNmb3JtKHRoaXMuZXh0ZXJuYWxQcm9qZWN0aW9uLHRoaXMuaW50ZXJuYWxQcm9qZWN0aW9uKX1yZXR1cm4gYn0sd3JpdGU6ZnVuY3Rpb24oYSl7dmFyIGIsYzthLmNvbnN0cnVjdG9yPT1BcnJheT9jPSEwOihhPVthXSxjPSExKTt2YXIgZD1bXTtjJiZkLnB1c2goXCJHRU9NRVRSWUNPTExFQ1RJT04oXCIpO2Zvcih2YXIgZT0wLGY9YS5sZW5ndGg7ZTxmOysrZSljJiYwPGUmJmQucHVzaChcIixcIiksYj1hW2VdLmdlb21ldHJ5LGQucHVzaCh0aGlzLmV4dHJhY3RHZW9tZXRyeShiKSk7YyYmZC5wdXNoKFwiKVwiKTtyZXR1cm4gZC5qb2luKFwiXCIpfSxcbmV4dHJhY3RHZW9tZXRyeTpmdW5jdGlvbihhKXt2YXIgYj1hLkNMQVNTX05BTUUuc3BsaXQoXCIuXCIpWzJdLnRvTG93ZXJDYXNlKCk7aWYoIXRoaXMuZXh0cmFjdFtiXSlyZXR1cm4gbnVsbDt0aGlzLmludGVybmFsUHJvamVjdGlvbiYmdGhpcy5leHRlcm5hbFByb2plY3Rpb24mJihhPWEuY2xvbmUoKSxhLnRyYW5zZm9ybSh0aGlzLmludGVybmFsUHJvamVjdGlvbix0aGlzLmV4dGVybmFsUHJvamVjdGlvbikpO3JldHVybihcImNvbGxlY3Rpb25cIj09Yj9cIkdFT01FVFJZQ09MTEVDVElPTlwiOmIudG9VcHBlckNhc2UoKSkrXCIoXCIrdGhpcy5leHRyYWN0W2JdLmFwcGx5KHRoaXMsW2FdKStcIilcIn0sZXh0cmFjdDp7cG9pbnQ6ZnVuY3Rpb24oYSl7cmV0dXJuIGEueCtcIiBcIithLnl9LG11bHRpcG9pbnQ6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPVtdLGM9MCxkPWEuY29tcG9uZW50cy5sZW5ndGg7YzxkOysrYyliLnB1c2goXCIoXCIrdGhpcy5leHRyYWN0LnBvaW50LmFwcGx5KHRoaXMsW2EuY29tcG9uZW50c1tjXV0pK1xuXCIpXCIpO3JldHVybiBiLmpvaW4oXCIsXCIpfSxsaW5lc3RyaW5nOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1bXSxjPTAsZD1hLmNvbXBvbmVudHMubGVuZ3RoO2M8ZDsrK2MpYi5wdXNoKHRoaXMuZXh0cmFjdC5wb2ludC5hcHBseSh0aGlzLFthLmNvbXBvbmVudHNbY11dKSk7cmV0dXJuIGIuam9pbihcIixcIil9LG11bHRpbGluZXN0cmluZzpmdW5jdGlvbihhKXtmb3IodmFyIGI9W10sYz0wLGQ9YS5jb21wb25lbnRzLmxlbmd0aDtjPGQ7KytjKWIucHVzaChcIihcIit0aGlzLmV4dHJhY3QubGluZXN0cmluZy5hcHBseSh0aGlzLFthLmNvbXBvbmVudHNbY11dKStcIilcIik7cmV0dXJuIGIuam9pbihcIixcIil9LHBvbHlnb246ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPVtdLGM9MCxkPWEuY29tcG9uZW50cy5sZW5ndGg7YzxkOysrYyliLnB1c2goXCIoXCIrdGhpcy5leHRyYWN0LmxpbmVzdHJpbmcuYXBwbHkodGhpcyxbYS5jb21wb25lbnRzW2NdXSkrXCIpXCIpO3JldHVybiBiLmpvaW4oXCIsXCIpfSxtdWx0aXBvbHlnb246ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPVxuW10sYz0wLGQ9YS5jb21wb25lbnRzLmxlbmd0aDtjPGQ7KytjKWIucHVzaChcIihcIit0aGlzLmV4dHJhY3QucG9seWdvbi5hcHBseSh0aGlzLFthLmNvbXBvbmVudHNbY11dKStcIilcIik7cmV0dXJuIGIuam9pbihcIixcIil9LGNvbGxlY3Rpb246ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPVtdLGM9MCxkPWEuY29tcG9uZW50cy5sZW5ndGg7YzxkOysrYyliLnB1c2godGhpcy5leHRyYWN0R2VvbWV0cnkuYXBwbHkodGhpcyxbYS5jb21wb25lbnRzW2NdXSkpO3JldHVybiBiLmpvaW4oXCIsXCIpfX0scGFyc2U6e3BvaW50OmZ1bmN0aW9uKGEpe2E9T3BlbkxheWVycy5TdHJpbmcudHJpbShhKS5zcGxpdCh0aGlzLnJlZ0V4ZXMuc3BhY2VzKTtyZXR1cm4gbmV3IE9wZW5MYXllcnMuRmVhdHVyZS5WZWN0b3IobmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQoYVswXSxhWzFdKSl9LG11bHRpcG9pbnQ6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPU9wZW5MYXllcnMuU3RyaW5nLnRyaW0oYSkuc3BsaXQoXCIsXCIpLFxuYz1bXSxkPTAsZT1iLmxlbmd0aDtkPGU7KytkKWE9YltkXS5yZXBsYWNlKHRoaXMucmVnRXhlcy50cmltUGFyZW5zLFwiJDFcIiksYy5wdXNoKHRoaXMucGFyc2UucG9pbnQuYXBwbHkodGhpcyxbYV0pLmdlb21ldHJ5KTtyZXR1cm4gbmV3IE9wZW5MYXllcnMuRmVhdHVyZS5WZWN0b3IobmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuTXVsdGlQb2ludChjKSl9LGxpbmVzdHJpbmc6ZnVuY3Rpb24oYSl7Zm9yKHZhciBhPU9wZW5MYXllcnMuU3RyaW5nLnRyaW0oYSkuc3BsaXQoXCIsXCIpLGI9W10sYz0wLGQ9YS5sZW5ndGg7YzxkOysrYyliLnB1c2godGhpcy5wYXJzZS5wb2ludC5hcHBseSh0aGlzLFthW2NdXSkuZ2VvbWV0cnkpO3JldHVybiBuZXcgT3BlbkxheWVycy5GZWF0dXJlLlZlY3RvcihuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5MaW5lU3RyaW5nKGIpKX0sbXVsdGlsaW5lc3RyaW5nOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1PcGVuTGF5ZXJzLlN0cmluZy50cmltKGEpLnNwbGl0KHRoaXMucmVnRXhlcy5wYXJlbkNvbW1hKSxcbmM9W10sZD0wLGU9Yi5sZW5ndGg7ZDxlOysrZClhPWJbZF0ucmVwbGFjZSh0aGlzLnJlZ0V4ZXMudHJpbVBhcmVucyxcIiQxXCIpLGMucHVzaCh0aGlzLnBhcnNlLmxpbmVzdHJpbmcuYXBwbHkodGhpcyxbYV0pLmdlb21ldHJ5KTtyZXR1cm4gbmV3IE9wZW5MYXllcnMuRmVhdHVyZS5WZWN0b3IobmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuTXVsdGlMaW5lU3RyaW5nKGMpKX0scG9seWdvbjpmdW5jdGlvbihhKXtmb3IodmFyIGIsYT1PcGVuTGF5ZXJzLlN0cmluZy50cmltKGEpLnNwbGl0KHRoaXMucmVnRXhlcy5wYXJlbkNvbW1hKSxjPVtdLGQ9MCxlPWEubGVuZ3RoO2Q8ZTsrK2QpYj1hW2RdLnJlcGxhY2UodGhpcy5yZWdFeGVzLnRyaW1QYXJlbnMsXCIkMVwiKSxiPXRoaXMucGFyc2UubGluZXN0cmluZy5hcHBseSh0aGlzLFtiXSkuZ2VvbWV0cnksYj1uZXcgT3BlbkxheWVycy5HZW9tZXRyeS5MaW5lYXJSaW5nKGIuY29tcG9uZW50cyksYy5wdXNoKGIpO3JldHVybiBuZXcgT3BlbkxheWVycy5GZWF0dXJlLlZlY3RvcihuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2x5Z29uKGMpKX0sXG5tdWx0aXBvbHlnb246ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPU9wZW5MYXllcnMuU3RyaW5nLnRyaW0oYSkuc3BsaXQodGhpcy5yZWdFeGVzLmRvdWJsZVBhcmVuQ29tbWEpLGM9W10sZD0wLGU9Yi5sZW5ndGg7ZDxlOysrZClhPWJbZF0ucmVwbGFjZSh0aGlzLnJlZ0V4ZXMudHJpbVBhcmVucyxcIiQxXCIpLGMucHVzaCh0aGlzLnBhcnNlLnBvbHlnb24uYXBwbHkodGhpcyxbYV0pLmdlb21ldHJ5KTtyZXR1cm4gbmV3IE9wZW5MYXllcnMuRmVhdHVyZS5WZWN0b3IobmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuTXVsdGlQb2x5Z29uKGMpKX0sZ2VvbWV0cnljb2xsZWN0aW9uOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYT1hLnJlcGxhY2UoLyxcXHMqKFtBLVphLXpdKS9nLFwifCQxXCIpLGE9T3BlbkxheWVycy5TdHJpbmcudHJpbShhKS5zcGxpdChcInxcIiksYj1bXSxjPTAsZD1hLmxlbmd0aDtjPGQ7KytjKWIucHVzaChPcGVuTGF5ZXJzLkZvcm1hdC5XS1QucHJvdG90eXBlLnJlYWQuYXBwbHkodGhpcyxbYVtjXV0pKTtcbnJldHVybiBifX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuRm9ybWF0LldLVFwifSk7T3BlbkxheWVycy5IYW5kbGVyLkhvdmVyPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5IYW5kbGVyLHtkZWxheTo1MDAscGl4ZWxUb2xlcmFuY2U6bnVsbCxzdG9wTW92ZTohMSxweDpudWxsLHRpbWVySWQ6bnVsbCxtb3VzZW1vdmU6ZnVuY3Rpb24oYSl7dGhpcy5wYXNzZXNUb2xlcmFuY2UoYS54eSkmJih0aGlzLmNsZWFyVGltZXIoKSx0aGlzLmNhbGxiYWNrKFwibW92ZVwiLFthXSksdGhpcy5weD1hLnh5LGE9T3BlbkxheWVycy5VdGlsLmV4dGVuZCh7fSxhKSx0aGlzLnRpbWVySWQ9d2luZG93LnNldFRpbWVvdXQoT3BlbkxheWVycy5GdW5jdGlvbi5iaW5kKHRoaXMuZGVsYXllZENhbGwsdGhpcyxhKSx0aGlzLmRlbGF5KSk7cmV0dXJuIXRoaXMuc3RvcE1vdmV9LG1vdXNlb3V0OmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuVXRpbC5tb3VzZUxlZnQoYSx0aGlzLm1hcC52aWV3UG9ydERpdikmJih0aGlzLmNsZWFyVGltZXIoKSx0aGlzLmNhbGxiYWNrKFwibW92ZVwiLFthXSkpO3JldHVybiEwfSxcbnBhc3Nlc1RvbGVyYW5jZTpmdW5jdGlvbihhKXt2YXIgYj0hMDt0aGlzLnBpeGVsVG9sZXJhbmNlJiZ0aGlzLnB4JiZNYXRoLnNxcnQoTWF0aC5wb3codGhpcy5weC54LWEueCwyKStNYXRoLnBvdyh0aGlzLnB4LnktYS55LDIpKTx0aGlzLnBpeGVsVG9sZXJhbmNlJiYoYj0hMSk7cmV0dXJuIGJ9LGNsZWFyVGltZXI6ZnVuY3Rpb24oKXtudWxsIT10aGlzLnRpbWVySWQmJih3aW5kb3cuY2xlYXJUaW1lb3V0KHRoaXMudGltZXJJZCksdGhpcy50aW1lcklkPW51bGwpfSxkZWxheWVkQ2FsbDpmdW5jdGlvbihhKXt0aGlzLmNhbGxiYWNrKFwicGF1c2VcIixbYV0pfSxkZWFjdGl2YXRlOmZ1bmN0aW9uKCl7dmFyIGE9ITE7T3BlbkxheWVycy5IYW5kbGVyLnByb3RvdHlwZS5kZWFjdGl2YXRlLmFwcGx5KHRoaXMsYXJndW1lbnRzKSYmKHRoaXMuY2xlYXJUaW1lcigpLGE9ITApO3JldHVybiBhfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5IYW5kbGVyLkhvdmVyXCJ9KTtPcGVuTGF5ZXJzLkNvbnRyb2wuR2V0RmVhdHVyZT1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuQ29udHJvbCx7cHJvdG9jb2w6bnVsbCxtdWx0aXBsZUtleTpudWxsLHRvZ2dsZUtleTpudWxsLG1vZGlmaWVyczpudWxsLG11bHRpcGxlOiExLGNsaWNrOiEwLHNpbmdsZTohMCxjbGlja291dDohMCx0b2dnbGU6ITEsY2xpY2tUb2xlcmFuY2U6NSxob3ZlcjohMSxib3g6ITEsbWF4RmVhdHVyZXM6MTAsZmVhdHVyZXM6bnVsbCxob3ZlckZlYXR1cmU6bnVsbCxoYW5kbGVyT3B0aW9uczpudWxsLGhhbmRsZXJzOm51bGwsaG92ZXJSZXNwb25zZTpudWxsLGZpbHRlclR5cGU6T3BlbkxheWVycy5GaWx0ZXIuU3BhdGlhbC5CQk9YLGluaXRpYWxpemU6ZnVuY3Rpb24oYSl7YS5oYW5kbGVyT3B0aW9ucz1hLmhhbmRsZXJPcHRpb25zfHx7fTtPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbYV0pO3RoaXMuZmVhdHVyZXM9e307dGhpcy5oYW5kbGVycz1cbnt9O3RoaXMuY2xpY2smJih0aGlzLmhhbmRsZXJzLmNsaWNrPW5ldyBPcGVuTGF5ZXJzLkhhbmRsZXIuQ2xpY2sodGhpcyx7Y2xpY2s6dGhpcy5zZWxlY3RDbGlja30sdGhpcy5oYW5kbGVyT3B0aW9ucy5jbGlja3x8e30pKTt0aGlzLmJveCYmKHRoaXMuaGFuZGxlcnMuYm94PW5ldyBPcGVuTGF5ZXJzLkhhbmRsZXIuQm94KHRoaXMse2RvbmU6dGhpcy5zZWxlY3RCb3h9LE9wZW5MYXllcnMuVXRpbC5leHRlbmQodGhpcy5oYW5kbGVyT3B0aW9ucy5ib3gse2JveERpdkNsYXNzTmFtZTpcIm9sSGFuZGxlckJveFNlbGVjdEZlYXR1cmVcIn0pKSk7dGhpcy5ob3ZlciYmKHRoaXMuaGFuZGxlcnMuaG92ZXI9bmV3IE9wZW5MYXllcnMuSGFuZGxlci5Ib3Zlcih0aGlzLHttb3ZlOnRoaXMuY2FuY2VsSG92ZXIscGF1c2U6dGhpcy5zZWxlY3RIb3Zlcn0sT3BlbkxheWVycy5VdGlsLmV4dGVuZCh0aGlzLmhhbmRsZXJPcHRpb25zLmhvdmVyLHtkZWxheToyNTAscGl4ZWxUb2xlcmFuY2U6Mn0pKSl9LFxuYWN0aXZhdGU6ZnVuY3Rpb24oKXtpZighdGhpcy5hY3RpdmUpZm9yKHZhciBhIGluIHRoaXMuaGFuZGxlcnMpdGhpcy5oYW5kbGVyc1thXS5hY3RpdmF0ZSgpO3JldHVybiBPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmFjdGl2YXRlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sZGVhY3RpdmF0ZTpmdW5jdGlvbigpe2lmKHRoaXMuYWN0aXZlKWZvcih2YXIgYSBpbiB0aGlzLmhhbmRsZXJzKXRoaXMuaGFuZGxlcnNbYV0uZGVhY3RpdmF0ZSgpO3JldHVybiBPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmRlYWN0aXZhdGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxzZWxlY3RDbGljazpmdW5jdGlvbihhKXt2YXIgYj10aGlzLnBpeGVsVG9Cb3VuZHMoYS54eSk7dGhpcy5zZXRNb2RpZmllcnMoYSk7dGhpcy5yZXF1ZXN0KGIse3NpbmdsZTp0aGlzLnNpbmdsZX0pfSxzZWxlY3RCb3g6ZnVuY3Rpb24oYSl7dmFyIGI7aWYoYSBpbnN0YW5jZW9mIE9wZW5MYXllcnMuQm91bmRzKWI9XG50aGlzLm1hcC5nZXRMb25MYXRGcm9tUGl4ZWwoe3g6YS5sZWZ0LHk6YS5ib3R0b219KSxhPXRoaXMubWFwLmdldExvbkxhdEZyb21QaXhlbCh7eDphLnJpZ2h0LHk6YS50b3B9KSxiPW5ldyBPcGVuTGF5ZXJzLkJvdW5kcyhiLmxvbixiLmxhdCxhLmxvbixhLmxhdCk7ZWxzZXtpZih0aGlzLmNsaWNrKXJldHVybjtiPXRoaXMucGl4ZWxUb0JvdW5kcyhhKX10aGlzLnNldE1vZGlmaWVycyh0aGlzLmhhbmRsZXJzLmJveC5kcmFnSGFuZGxlci5ldnQpO3RoaXMucmVxdWVzdChiKX0sc2VsZWN0SG92ZXI6ZnVuY3Rpb24oYSl7dGhpcy5yZXF1ZXN0KHRoaXMucGl4ZWxUb0JvdW5kcyhhLnh5KSx7c2luZ2xlOiEwLGhvdmVyOiEwfSl9LGNhbmNlbEhvdmVyOmZ1bmN0aW9uKCl7dGhpcy5ob3ZlclJlc3BvbnNlJiYodGhpcy5wcm90b2NvbC5hYm9ydCh0aGlzLmhvdmVyUmVzcG9uc2UpLHRoaXMuaG92ZXJSZXNwb25zZT1udWxsLE9wZW5MYXllcnMuRWxlbWVudC5yZW1vdmVDbGFzcyh0aGlzLm1hcC52aWV3UG9ydERpdixcblwib2xDdXJzb3JXYWl0XCIpKX0scmVxdWVzdDpmdW5jdGlvbihhLGIpe3ZhciBiPWJ8fHt9LGM9bmV3IE9wZW5MYXllcnMuRmlsdGVyLlNwYXRpYWwoe3R5cGU6dGhpcy5maWx0ZXJUeXBlLHZhbHVlOmF9KTtPcGVuTGF5ZXJzLkVsZW1lbnQuYWRkQ2xhc3ModGhpcy5tYXAudmlld1BvcnREaXYsXCJvbEN1cnNvcldhaXRcIik7Yz10aGlzLnByb3RvY29sLnJlYWQoe21heEZlYXR1cmVzOiEwPT1iLnNpbmdsZT90aGlzLm1heEZlYXR1cmVzOnZvaWQgMCxmaWx0ZXI6YyxjYWxsYmFjazpmdW5jdGlvbihjKXtjLnN1Y2Nlc3MoKSYmKGMuZmVhdHVyZXMubGVuZ3RoPyEwPT1iLnNpbmdsZT90aGlzLnNlbGVjdEJlc3RGZWF0dXJlKGMuZmVhdHVyZXMsYS5nZXRDZW50ZXJMb25MYXQoKSxiKTp0aGlzLnNlbGVjdChjLmZlYXR1cmVzKTpiLmhvdmVyP3RoaXMuaG92ZXJTZWxlY3QoKToodGhpcy5ldmVudHMudHJpZ2dlckV2ZW50KFwiY2xpY2tvdXRcIiksdGhpcy5jbGlja291dCYmdGhpcy51bnNlbGVjdEFsbCgpKSk7XG5PcGVuTGF5ZXJzLkVsZW1lbnQucmVtb3ZlQ2xhc3ModGhpcy5tYXAudmlld1BvcnREaXYsXCJvbEN1cnNvcldhaXRcIil9LHNjb3BlOnRoaXN9KTshMD09Yi5ob3ZlciYmKHRoaXMuaG92ZXJSZXNwb25zZT1jKX0sc2VsZWN0QmVzdEZlYXR1cmU6ZnVuY3Rpb24oYSxiLGMpe2M9Y3x8e307aWYoYS5sZW5ndGgpe2Zvcih2YXIgYj1uZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChiLmxvbixiLmxhdCksZCxlLGYsZz1OdW1iZXIuTUFYX1ZBTFVFLGg9MDtoPGEubGVuZ3RoJiYhKGQ9YVtoXSxkLmdlb21ldHJ5JiYoZj1iLmRpc3RhbmNlVG8oZC5nZW9tZXRyeSx7ZWRnZTohMX0pLGY8ZyYmKGc9ZixlPWQsMD09ZykpKTsrK2gpOyEwPT1jLmhvdmVyP3RoaXMuaG92ZXJTZWxlY3QoZSk6dGhpcy5zZWxlY3QoZXx8YSl9fSxzZXRNb2RpZmllcnM6ZnVuY3Rpb24oYSl7dGhpcy5tb2RpZmllcnM9e211bHRpcGxlOnRoaXMubXVsdGlwbGV8fHRoaXMubXVsdGlwbGVLZXkmJmFbdGhpcy5tdWx0aXBsZUtleV0sXG50b2dnbGU6dGhpcy50b2dnbGV8fHRoaXMudG9nZ2xlS2V5JiZhW3RoaXMudG9nZ2xlS2V5XX19LHNlbGVjdDpmdW5jdGlvbihhKXshdGhpcy5tb2RpZmllcnMubXVsdGlwbGUmJiF0aGlzLm1vZGlmaWVycy50b2dnbGUmJnRoaXMudW5zZWxlY3RBbGwoKTtPcGVuTGF5ZXJzLlV0aWwuaXNBcnJheShhKXx8KGE9W2FdKTt2YXIgYj10aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJiZWZvcmVmZWF0dXJlc3NlbGVjdGVkXCIse2ZlYXR1cmVzOmF9KTtpZighMSE9PWIpe2Zvcih2YXIgYz1bXSxkLGU9MCxmPWEubGVuZ3RoO2U8ZjsrK2UpZD1hW2VdLHRoaXMuZmVhdHVyZXNbZC5maWR8fGQuaWRdP3RoaXMubW9kaWZpZXJzLnRvZ2dsZSYmdGhpcy51bnNlbGVjdCh0aGlzLmZlYXR1cmVzW2QuZmlkfHxkLmlkXSk6KGI9dGhpcy5ldmVudHMudHJpZ2dlckV2ZW50KFwiYmVmb3JlZmVhdHVyZXNlbGVjdGVkXCIse2ZlYXR1cmU6ZH0pLCExIT09YiYmKHRoaXMuZmVhdHVyZXNbZC5maWR8fGQuaWRdPWQsXG5jLnB1c2goZCksdGhpcy5ldmVudHMudHJpZ2dlckV2ZW50KFwiZmVhdHVyZXNlbGVjdGVkXCIse2ZlYXR1cmU6ZH0pKSk7dGhpcy5ldmVudHMudHJpZ2dlckV2ZW50KFwiZmVhdHVyZXNzZWxlY3RlZFwiLHtmZWF0dXJlczpjfSl9fSxob3ZlclNlbGVjdDpmdW5jdGlvbihhKXt2YXIgYj1hP2EuZmlkfHxhLmlkOm51bGwsYz10aGlzLmhvdmVyRmVhdHVyZT90aGlzLmhvdmVyRmVhdHVyZS5maWR8fHRoaXMuaG92ZXJGZWF0dXJlLmlkOm51bGw7YyYmYyE9YiYmKHRoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcIm91dGZlYXR1cmVcIix7ZmVhdHVyZTp0aGlzLmhvdmVyRmVhdHVyZX0pLHRoaXMuaG92ZXJGZWF0dXJlPW51bGwpO2ImJmIhPWMmJih0aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJob3ZlcmZlYXR1cmVcIix7ZmVhdHVyZTphfSksdGhpcy5ob3ZlckZlYXR1cmU9YSl9LHVuc2VsZWN0OmZ1bmN0aW9uKGEpe2RlbGV0ZSB0aGlzLmZlYXR1cmVzW2EuZmlkfHxhLmlkXTt0aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJmZWF0dXJldW5zZWxlY3RlZFwiLFxue2ZlYXR1cmU6YX0pfSx1bnNlbGVjdEFsbDpmdW5jdGlvbigpe2Zvcih2YXIgYSBpbiB0aGlzLmZlYXR1cmVzKXRoaXMudW5zZWxlY3QodGhpcy5mZWF0dXJlc1thXSl9LHNldE1hcDpmdW5jdGlvbihhKXtmb3IodmFyIGIgaW4gdGhpcy5oYW5kbGVycyl0aGlzLmhhbmRsZXJzW2JdLnNldE1hcChhKTtPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLnNldE1hcC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LHBpeGVsVG9Cb3VuZHM6ZnVuY3Rpb24oYSl7dmFyIGI9YS5hZGQoLXRoaXMuY2xpY2tUb2xlcmFuY2UvMix0aGlzLmNsaWNrVG9sZXJhbmNlLzIpLGE9YS5hZGQodGhpcy5jbGlja1RvbGVyYW5jZS8yLC10aGlzLmNsaWNrVG9sZXJhbmNlLzIpLGI9dGhpcy5tYXAuZ2V0TG9uTGF0RnJvbVBpeGVsKGIpLGE9dGhpcy5tYXAuZ2V0TG9uTGF0RnJvbVBpeGVsKGEpO3JldHVybiBuZXcgT3BlbkxheWVycy5Cb3VuZHMoYi5sb24sYi5sYXQsYS5sb24sYS5sYXQpfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Db250cm9sLkdldEZlYXR1cmVcIn0pO09wZW5MYXllcnMuRm9ybWF0LlF1ZXJ5U3RyaW5nRmlsdGVyPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhKXthPWEucmVwbGFjZSgvJS9nLFwiXFxcXCVcIik7YT1hLnJlcGxhY2UoL1xcXFxcXFxcXFwuKFxcKik/L2csZnVuY3Rpb24oYSxiKXtyZXR1cm4gYj9hOlwiXFxcXFxcXFxfXCJ9KTthPWEucmVwbGFjZSgvXFxcXFxcXFxcXC5cXCovZyxcIlxcXFxcXFxcJVwiKTthPWEucmVwbGFjZSgvKFxcXFwpP1xcLihcXCopPy9nLGZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gYnx8Yz9hOlwiX1wifSk7YT1hLnJlcGxhY2UoLyhcXFxcKT9cXC5cXCovZyxmdW5jdGlvbihhLGIpe3JldHVybiBiP2E6XCIlXCJ9KTthPWEucmVwbGFjZSgvXFxcXFxcLi9nLFwiLlwiKTtyZXR1cm4gYT1hLnJlcGxhY2UoLyhcXFxcKT9cXFxcXFwqL2csZnVuY3Rpb24oYSxiKXtyZXR1cm4gYj9hOlwiKlwifSl9dmFyIGI9e307YltPcGVuTGF5ZXJzLkZpbHRlci5Db21wYXJpc29uLkVRVUFMX1RPXT1cImVxXCI7YltPcGVuTGF5ZXJzLkZpbHRlci5Db21wYXJpc29uLk5PVF9FUVVBTF9UT109XCJuZVwiO2JbT3BlbkxheWVycy5GaWx0ZXIuQ29tcGFyaXNvbi5MRVNTX1RIQU5dPVxuXCJsdFwiO2JbT3BlbkxheWVycy5GaWx0ZXIuQ29tcGFyaXNvbi5MRVNTX1RIQU5fT1JfRVFVQUxfVE9dPVwibHRlXCI7YltPcGVuTGF5ZXJzLkZpbHRlci5Db21wYXJpc29uLkdSRUFURVJfVEhBTl09XCJndFwiO2JbT3BlbkxheWVycy5GaWx0ZXIuQ29tcGFyaXNvbi5HUkVBVEVSX1RIQU5fT1JfRVFVQUxfVE9dPVwiZ3RlXCI7YltPcGVuTGF5ZXJzLkZpbHRlci5Db21wYXJpc29uLkxJS0VdPVwiaWxpa2VcIjtyZXR1cm4gT3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkZvcm1hdCx7d2lsZGNhcmRlZDohMSxzcnNJbkJCT1g6ITEsd3JpdGU6ZnVuY3Rpb24oYyxkKXt2YXIgZD1kfHx7fSxlPWMuQ0xBU1NfTkFNRSxlPWUuc3Vic3RyaW5nKGUubGFzdEluZGV4T2YoXCIuXCIpKzEpO3N3aXRjaChlKXtjYXNlIFwiU3BhdGlhbFwiOnN3aXRjaChjLnR5cGUpe2Nhc2UgT3BlbkxheWVycy5GaWx0ZXIuU3BhdGlhbC5CQk9YOmQuYmJveD1jLnZhbHVlLnRvQXJyYXkoKTt0aGlzLnNyc0luQkJPWCYmYy5wcm9qZWN0aW9uJiZcbmQuYmJveC5wdXNoKGMucHJvamVjdGlvbi5nZXRDb2RlKCkpO2JyZWFrO2Nhc2UgT3BlbkxheWVycy5GaWx0ZXIuU3BhdGlhbC5EV0lUSElOOmQudG9sZXJhbmNlPWMuZGlzdGFuY2U7Y2FzZSBPcGVuTGF5ZXJzLkZpbHRlci5TcGF0aWFsLldJVEhJTjpkLmxvbj1jLnZhbHVlLng7ZC5sYXQ9Yy52YWx1ZS55O2JyZWFrO2RlZmF1bHQ6T3BlbkxheWVycy5Db25zb2xlLndhcm4oXCJVbmtub3duIHNwYXRpYWwgZmlsdGVyIHR5cGUgXCIrYy50eXBlKX1icmVhaztjYXNlIFwiQ29tcGFyaXNvblwiOmU9YltjLnR5cGVdO2lmKHZvaWQgMCE9PWUpe3ZhciBmPWMudmFsdWU7Yy50eXBlPT1PcGVuTGF5ZXJzLkZpbHRlci5Db21wYXJpc29uLkxJS0UmJihmPWEoZiksdGhpcy53aWxkY2FyZGVkJiYoZj1cIiVcIitmK1wiJVwiKSk7ZFtjLnByb3BlcnR5K1wiX19cIitlXT1mO2QucXVlcnlhYmxlPWQucXVlcnlhYmxlfHxbXTtkLnF1ZXJ5YWJsZS5wdXNoKGMucHJvcGVydHkpfWVsc2UgT3BlbkxheWVycy5Db25zb2xlLndhcm4oXCJVbmtub3duIGNvbXBhcmlzb24gZmlsdGVyIHR5cGUgXCIrXG5jLnR5cGUpO2JyZWFrO2Nhc2UgXCJMb2dpY2FsXCI6aWYoYy50eXBlPT09T3BlbkxheWVycy5GaWx0ZXIuTG9naWNhbC5BTkQpe2U9MDtmb3IoZj1jLmZpbHRlcnMubGVuZ3RoO2U8ZjtlKyspZD10aGlzLndyaXRlKGMuZmlsdGVyc1tlXSxkKX1lbHNlIE9wZW5MYXllcnMuQ29uc29sZS53YXJuKFwiVW5zdXBwb3J0ZWQgbG9naWNhbCBmaWx0ZXIgdHlwZSBcIitjLnR5cGUpO2JyZWFrO2RlZmF1bHQ6T3BlbkxheWVycy5Db25zb2xlLndhcm4oXCJVbmtub3duIGZpbHRlciB0eXBlIFwiK2UpfXJldHVybiBkfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Gb3JtYXQuUXVlcnlTdHJpbmdGaWx0ZXJcIn0pfSgpO09wZW5MYXllcnMuQ29udHJvbC5Nb3VzZVBvc2l0aW9uPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Db250cm9sLHthdXRvQWN0aXZhdGU6ITAsZWxlbWVudDpudWxsLHByZWZpeDpcIlwiLHNlcGFyYXRvcjpcIiwgXCIsc3VmZml4OlwiXCIsbnVtRGlnaXRzOjUsZ3JhbnVsYXJpdHk6MTAsZW1wdHlTdHJpbmc6bnVsbCxsYXN0WHk6bnVsbCxkaXNwbGF5UHJvamVjdGlvbjpudWxsLGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLmRlYWN0aXZhdGUoKTtPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmRlc3Ryb3kuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxhY3RpdmF0ZTpmdW5jdGlvbigpe3JldHVybiBPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmFjdGl2YXRlLmFwcGx5KHRoaXMsYXJndW1lbnRzKT8odGhpcy5tYXAuZXZlbnRzLnJlZ2lzdGVyKFwibW91c2Vtb3ZlXCIsdGhpcyx0aGlzLnJlZHJhdyksdGhpcy5tYXAuZXZlbnRzLnJlZ2lzdGVyKFwibW91c2VvdXRcIix0aGlzLHRoaXMucmVzZXQpLFxudGhpcy5yZWRyYXcoKSwhMCk6ITF9LGRlYWN0aXZhdGU6ZnVuY3Rpb24oKXtyZXR1cm4gT3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5kZWFjdGl2YXRlLmFwcGx5KHRoaXMsYXJndW1lbnRzKT8odGhpcy5tYXAuZXZlbnRzLnVucmVnaXN0ZXIoXCJtb3VzZW1vdmVcIix0aGlzLHRoaXMucmVkcmF3KSx0aGlzLm1hcC5ldmVudHMudW5yZWdpc3RlcihcIm1vdXNlb3V0XCIsdGhpcyx0aGlzLnJlc2V0KSx0aGlzLmVsZW1lbnQuaW5uZXJIVE1MPVwiXCIsITApOiExfSxkcmF3OmZ1bmN0aW9uKCl7T3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5kcmF3LmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmVsZW1lbnR8fCh0aGlzLmRpdi5sZWZ0PVwiXCIsdGhpcy5kaXYudG9wPVwiXCIsdGhpcy5lbGVtZW50PXRoaXMuZGl2KTtyZXR1cm4gdGhpcy5kaXZ9LHJlZHJhdzpmdW5jdGlvbihhKXt2YXIgYjtpZihudWxsPT1hKXRoaXMucmVzZXQoKTtlbHNlIGlmKG51bGw9PXRoaXMubGFzdFh5fHxNYXRoLmFicyhhLnh5LngtXG50aGlzLmxhc3RYeS54KT50aGlzLmdyYW51bGFyaXR5fHxNYXRoLmFicyhhLnh5LnktdGhpcy5sYXN0WHkueSk+dGhpcy5ncmFudWxhcml0eSl0aGlzLmxhc3RYeT1hLnh5O2Vsc2UgaWYoYj10aGlzLm1hcC5nZXRMb25MYXRGcm9tUGl4ZWwoYS54eSkpdGhpcy5kaXNwbGF5UHJvamVjdGlvbiYmYi50cmFuc2Zvcm0odGhpcy5tYXAuZ2V0UHJvamVjdGlvbk9iamVjdCgpLHRoaXMuZGlzcGxheVByb2plY3Rpb24pLHRoaXMubGFzdFh5PWEueHksYT10aGlzLmZvcm1hdE91dHB1dChiKSxhIT10aGlzLmVsZW1lbnQuaW5uZXJIVE1MJiYodGhpcy5lbGVtZW50LmlubmVySFRNTD1hKX0scmVzZXQ6ZnVuY3Rpb24oKXtudWxsIT10aGlzLmVtcHR5U3RyaW5nJiYodGhpcy5lbGVtZW50LmlubmVySFRNTD10aGlzLmVtcHR5U3RyaW5nKX0sZm9ybWF0T3V0cHV0OmZ1bmN0aW9uKGEpe3ZhciBiPXBhcnNlSW50KHRoaXMubnVtRGlnaXRzKTtyZXR1cm4gdGhpcy5wcmVmaXgrYS5sb24udG9GaXhlZChiKStcbnRoaXMuc2VwYXJhdG9yK2EubGF0LnRvRml4ZWQoYikrdGhpcy5zdWZmaXh9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkNvbnRyb2wuTW91c2VQb3NpdGlvblwifSk7T3BlbkxheWVycy5Db250cm9sLkdlb2xvY2F0ZT1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuQ29udHJvbCx7Z2VvbG9jYXRpb246bmF2aWdhdG9yLmdlb2xvY2F0aW9uLGJpbmQ6ITAsd2F0Y2g6ITEsZ2VvbG9jYXRpb25PcHRpb25zOm51bGwsZGVzdHJveTpmdW5jdGlvbigpe3RoaXMuZGVhY3RpdmF0ZSgpO09wZW5MYXllcnMuQ29udHJvbC5wcm90b3R5cGUuZGVzdHJveS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGFjdGl2YXRlOmZ1bmN0aW9uKCl7cmV0dXJuIXRoaXMuZ2VvbG9jYXRpb24/KHRoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcImxvY2F0aW9udW5jYXBhYmxlXCIpLCExKTpPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmFjdGl2YXRlLmFwcGx5KHRoaXMsYXJndW1lbnRzKT8odGhpcy53YXRjaD90aGlzLndhdGNoSWQ9dGhpcy5nZW9sb2NhdGlvbi53YXRjaFBvc2l0aW9uKE9wZW5MYXllcnMuRnVuY3Rpb24uYmluZCh0aGlzLmdlb2xvY2F0ZSx0aGlzKSxPcGVuTGF5ZXJzLkZ1bmN0aW9uLmJpbmQodGhpcy5mYWlsdXJlLFxudGhpcyksdGhpcy5nZW9sb2NhdGlvbk9wdGlvbnMpOnRoaXMuZ2V0Q3VycmVudExvY2F0aW9uKCksITApOiExfSxkZWFjdGl2YXRlOmZ1bmN0aW9uKCl7dGhpcy5hY3RpdmUmJm51bGwhPT10aGlzLndhdGNoSWQmJnRoaXMuZ2VvbG9jYXRpb24uY2xlYXJXYXRjaCh0aGlzLndhdGNoSWQpO3JldHVybiBPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmRlYWN0aXZhdGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxnZW9sb2NhdGU6ZnVuY3Rpb24oYSl7dmFyIGI9KG5ldyBPcGVuTGF5ZXJzLkxvbkxhdChhLmNvb3Jkcy5sb25naXR1ZGUsYS5jb29yZHMubGF0aXR1ZGUpKS50cmFuc2Zvcm0obmV3IE9wZW5MYXllcnMuUHJvamVjdGlvbihcIkVQU0c6NDMyNlwiKSx0aGlzLm1hcC5nZXRQcm9qZWN0aW9uT2JqZWN0KCkpO3RoaXMuYmluZCYmdGhpcy5tYXAuc2V0Q2VudGVyKGIpO3RoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcImxvY2F0aW9udXBkYXRlZFwiLHtwb3NpdGlvbjphLHBvaW50Om5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGIubG9uLFxuYi5sYXQpfSl9LGdldEN1cnJlbnRMb2NhdGlvbjpmdW5jdGlvbigpe2lmKCF0aGlzLmFjdGl2ZXx8dGhpcy53YXRjaClyZXR1cm4hMTt0aGlzLmdlb2xvY2F0aW9uLmdldEN1cnJlbnRQb3NpdGlvbihPcGVuTGF5ZXJzLkZ1bmN0aW9uLmJpbmQodGhpcy5nZW9sb2NhdGUsdGhpcyksT3BlbkxheWVycy5GdW5jdGlvbi5iaW5kKHRoaXMuZmFpbHVyZSx0aGlzKSx0aGlzLmdlb2xvY2F0aW9uT3B0aW9ucyk7cmV0dXJuITB9LGZhaWx1cmU6ZnVuY3Rpb24oYSl7dGhpcy5ldmVudHMudHJpZ2dlckV2ZW50KFwibG9jYXRpb25mYWlsZWRcIix7ZXJyb3I6YX0pfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Db250cm9sLkdlb2xvY2F0ZVwifSk7T3BlbkxheWVycy5UaWxlLlVURkdyaWQ9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLlRpbGUse3VybDpudWxsLHV0ZmdyaWRSZXNvbHV0aW9uOjIsanNvbjpudWxsLGZvcm1hdDpudWxsLGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLmNsZWFyKCk7T3BlbkxheWVycy5UaWxlLnByb3RvdHlwZS5kZXN0cm95LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sZHJhdzpmdW5jdGlvbigpe3ZhciBhPU9wZW5MYXllcnMuVGlsZS5wcm90b3R5cGUuZHJhdy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7aWYoYSlpZih0aGlzLmlzTG9hZGluZz8odGhpcy5hYm9ydExvYWRpbmcoKSx0aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJyZWxvYWRcIikpOih0aGlzLmlzTG9hZGluZz0hMCx0aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJsb2Fkc3RhcnRcIikpLHRoaXMudXJsPXRoaXMubGF5ZXIuZ2V0VVJMKHRoaXMuYm91bmRzKSx0aGlzLmxheWVyLnVzZUpTT05QKXt2YXIgYj1uZXcgT3BlbkxheWVycy5Qcm90b2NvbC5TY3JpcHQoe3VybDp0aGlzLnVybCxcbmNhbGxiYWNrOmZ1bmN0aW9uKGEpe3RoaXMuaXNMb2FkaW5nPWZhbHNlO3RoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcImxvYWRlbmRcIik7dGhpcy5qc29uPWEuZGF0YX0sc2NvcGU6dGhpc30pO2IucmVhZCgpO3RoaXMucmVxdWVzdD1ifWVsc2UgdGhpcy5yZXF1ZXN0PU9wZW5MYXllcnMuUmVxdWVzdC5HRVQoe3VybDp0aGlzLnVybCxjYWxsYmFjazpmdW5jdGlvbihhKXt0aGlzLmlzTG9hZGluZz1mYWxzZTt0aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJsb2FkZW5kXCIpO2Euc3RhdHVzPT09MjAwJiZ0aGlzLnBhcnNlRGF0YShhLnJlc3BvbnNlVGV4dCl9LHNjb3BlOnRoaXN9KTtlbHNlIHRoaXMudW5sb2FkKCk7cmV0dXJuIGF9LGFib3J0TG9hZGluZzpmdW5jdGlvbigpe3RoaXMucmVxdWVzdCYmKHRoaXMucmVxdWVzdC5hYm9ydCgpLGRlbGV0ZSB0aGlzLnJlcXVlc3QpO3RoaXMuaXNMb2FkaW5nPSExfSxnZXRGZWF0dXJlSW5mbzpmdW5jdGlvbihhLGIpe3ZhciBjPW51bGw7aWYodGhpcy5qc29uKXt2YXIgZD1cbnRoaXMuZ2V0RmVhdHVyZUlkKGEsYik7bnVsbCE9PWQmJihjPXtpZDpkLGRhdGE6dGhpcy5qc29uLmRhdGFbZF19KX1yZXR1cm4gY30sZ2V0RmVhdHVyZUlkOmZ1bmN0aW9uKGEsYil7dmFyIGM9bnVsbDtpZih0aGlzLmpzb24pe3ZhciBkPXRoaXMudXRmZ3JpZFJlc29sdXRpb24sZD10aGlzLmluZGV4RnJvbUNoYXJDb2RlKHRoaXMuanNvbi5ncmlkW01hdGguZmxvb3IoYi9kKV0uY2hhckNvZGVBdChNYXRoLmZsb29yKGEvZCkpKSxlPXRoaXMuanNvbi5rZXlzOyFpc05hTihkKSYmZCBpbiBlJiYoYz1lW2RdKX1yZXR1cm4gY30saW5kZXhGcm9tQ2hhckNvZGU6ZnVuY3Rpb24oYSl7OTM8PWEmJmEtLTszNTw9YSYmYS0tO3JldHVybiBhLTMyfSxwYXJzZURhdGE6ZnVuY3Rpb24oYSl7dGhpcy5mb3JtYXR8fCh0aGlzLmZvcm1hdD1uZXcgT3BlbkxheWVycy5Gb3JtYXQuSlNPTik7dGhpcy5qc29uPXRoaXMuZm9ybWF0LnJlYWQoYSl9LGNsZWFyOmZ1bmN0aW9uKCl7dGhpcy5qc29uPW51bGx9LFxuQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuVGlsZS5VVEZHcmlkXCJ9KTtPcGVuTGF5ZXJzLkNvbnRyb2wuTmF2aWdhdGlvbkhpc3Rvcnk9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkNvbnRyb2wse3R5cGU6T3BlbkxheWVycy5Db250cm9sLlRZUEVfVE9HR0xFLHByZXZpb3VzOm51bGwscHJldmlvdXNPcHRpb25zOm51bGwsbmV4dDpudWxsLG5leHRPcHRpb25zOm51bGwsbGltaXQ6NTAsYXV0b0FjdGl2YXRlOiEwLGNsZWFyT25EZWFjdGl2YXRlOiExLHJlZ2lzdHJ5Om51bGwsbmV4dFN0YWNrOm51bGwscHJldmlvdXNTdGFjazpudWxsLGxpc3RlbmVyczpudWxsLHJlc3RvcmluZzohMSxpbml0aWFsaXplOmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuQ29udHJvbC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLFthXSk7dGhpcy5yZWdpc3RyeT1PcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHttb3ZlZW5kOnRoaXMuZ2V0U3RhdGV9LHRoaXMucmVnaXN0cnkpO2E9e3RyaWdnZXI6T3BlbkxheWVycy5GdW5jdGlvbi5iaW5kKHRoaXMucHJldmlvdXNUcmlnZ2VyLFxudGhpcyksZGlzcGxheUNsYXNzOnRoaXMuZGlzcGxheUNsYXNzK1wiIFwiK3RoaXMuZGlzcGxheUNsYXNzK1wiUHJldmlvdXNcIn07T3BlbkxheWVycy5VdGlsLmV4dGVuZChhLHRoaXMucHJldmlvdXNPcHRpb25zKTt0aGlzLnByZXZpb3VzPW5ldyBPcGVuTGF5ZXJzLkNvbnRyb2wuQnV0dG9uKGEpO2E9e3RyaWdnZXI6T3BlbkxheWVycy5GdW5jdGlvbi5iaW5kKHRoaXMubmV4dFRyaWdnZXIsdGhpcyksZGlzcGxheUNsYXNzOnRoaXMuZGlzcGxheUNsYXNzK1wiIFwiK3RoaXMuZGlzcGxheUNsYXNzK1wiTmV4dFwifTtPcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKGEsdGhpcy5uZXh0T3B0aW9ucyk7dGhpcy5uZXh0PW5ldyBPcGVuTGF5ZXJzLkNvbnRyb2wuQnV0dG9uKGEpO3RoaXMuY2xlYXIoKX0sb25QcmV2aW91c0NoYW5nZTpmdW5jdGlvbihhKXthJiYhdGhpcy5wcmV2aW91cy5hY3RpdmU/dGhpcy5wcmV2aW91cy5hY3RpdmF0ZSgpOiFhJiZ0aGlzLnByZXZpb3VzLmFjdGl2ZSYmdGhpcy5wcmV2aW91cy5kZWFjdGl2YXRlKCl9LFxub25OZXh0Q2hhbmdlOmZ1bmN0aW9uKGEpe2EmJiF0aGlzLm5leHQuYWN0aXZlP3RoaXMubmV4dC5hY3RpdmF0ZSgpOiFhJiZ0aGlzLm5leHQuYWN0aXZlJiZ0aGlzLm5leHQuZGVhY3RpdmF0ZSgpfSxkZXN0cm95OmZ1bmN0aW9uKCl7T3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5kZXN0cm95LmFwcGx5KHRoaXMpO3RoaXMucHJldmlvdXMuZGVzdHJveSgpO3RoaXMubmV4dC5kZXN0cm95KCk7dGhpcy5kZWFjdGl2YXRlKCk7Zm9yKHZhciBhIGluIHRoaXMpdGhpc1thXT1udWxsfSxzZXRNYXA6ZnVuY3Rpb24oYSl7dGhpcy5tYXA9YTt0aGlzLm5leHQuc2V0TWFwKGEpO3RoaXMucHJldmlvdXMuc2V0TWFwKGEpfSxkcmF3OmZ1bmN0aW9uKCl7T3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5kcmF3LmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLm5leHQuZHJhdygpO3RoaXMucHJldmlvdXMuZHJhdygpfSxwcmV2aW91c1RyaWdnZXI6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnByZXZpb3VzU3RhY2suc2hpZnQoKSxcbmI9dGhpcy5wcmV2aW91c1N0YWNrLnNoaWZ0KCk7dm9pZCAwIT1iPyh0aGlzLm5leHRTdGFjay51bnNoaWZ0KGEpLHRoaXMucHJldmlvdXNTdGFjay51bnNoaWZ0KGIpLHRoaXMucmVzdG9yaW5nPSEwLHRoaXMucmVzdG9yZShiKSx0aGlzLnJlc3RvcmluZz0hMSx0aGlzLm9uTmV4dENoYW5nZSh0aGlzLm5leHRTdGFja1swXSx0aGlzLm5leHRTdGFjay5sZW5ndGgpLHRoaXMub25QcmV2aW91c0NoYW5nZSh0aGlzLnByZXZpb3VzU3RhY2tbMV0sdGhpcy5wcmV2aW91c1N0YWNrLmxlbmd0aC0xKSk6dGhpcy5wcmV2aW91c1N0YWNrLnVuc2hpZnQoYSk7cmV0dXJuIGJ9LG5leHRUcmlnZ2VyOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5uZXh0U3RhY2suc2hpZnQoKTt2b2lkIDAhPWEmJih0aGlzLnByZXZpb3VzU3RhY2sudW5zaGlmdChhKSx0aGlzLnJlc3RvcmluZz0hMCx0aGlzLnJlc3RvcmUoYSksdGhpcy5yZXN0b3Jpbmc9ITEsdGhpcy5vbk5leHRDaGFuZ2UodGhpcy5uZXh0U3RhY2tbMF0sXG50aGlzLm5leHRTdGFjay5sZW5ndGgpLHRoaXMub25QcmV2aW91c0NoYW5nZSh0aGlzLnByZXZpb3VzU3RhY2tbMV0sdGhpcy5wcmV2aW91c1N0YWNrLmxlbmd0aC0xKSk7cmV0dXJuIGF9LGNsZWFyOmZ1bmN0aW9uKCl7dGhpcy5wcmV2aW91c1N0YWNrPVtdO3RoaXMucHJldmlvdXMuZGVhY3RpdmF0ZSgpO3RoaXMubmV4dFN0YWNrPVtdO3RoaXMubmV4dC5kZWFjdGl2YXRlKCl9LGdldFN0YXRlOmZ1bmN0aW9uKCl7cmV0dXJue2NlbnRlcjp0aGlzLm1hcC5nZXRDZW50ZXIoKSxyZXNvbHV0aW9uOnRoaXMubWFwLmdldFJlc29sdXRpb24oKSxwcm9qZWN0aW9uOnRoaXMubWFwLmdldFByb2plY3Rpb25PYmplY3QoKSx1bml0czp0aGlzLm1hcC5nZXRQcm9qZWN0aW9uT2JqZWN0KCkuZ2V0VW5pdHMoKXx8dGhpcy5tYXAudW5pdHN8fHRoaXMubWFwLmJhc2VMYXllci51bml0c319LHJlc3RvcmU6ZnVuY3Rpb24oYSl7dmFyIGIsYztpZih0aGlzLm1hcC5nZXRQcm9qZWN0aW9uT2JqZWN0KCk9PVxuYS5wcm9qZWN0aW9uKWM9dGhpcy5tYXAuZ2V0Wm9vbUZvclJlc29sdXRpb24oYS5yZXNvbHV0aW9uKSxiPWEuY2VudGVyO2Vsc2V7Yj1hLmNlbnRlci5jbG9uZSgpO2IudHJhbnNmb3JtKGEucHJvamVjdGlvbix0aGlzLm1hcC5nZXRQcm9qZWN0aW9uT2JqZWN0KCkpO2M9YS51bml0czt2YXIgZD10aGlzLm1hcC5nZXRQcm9qZWN0aW9uT2JqZWN0KCkuZ2V0VW5pdHMoKXx8dGhpcy5tYXAudW5pdHN8fHRoaXMubWFwLmJhc2VMYXllci51bml0cztjPXRoaXMubWFwLmdldFpvb21Gb3JSZXNvbHV0aW9uKChjJiZkP09wZW5MYXllcnMuSU5DSEVTX1BFUl9VTklUW2NdL09wZW5MYXllcnMuSU5DSEVTX1BFUl9VTklUW2RdOjEpKmEucmVzb2x1dGlvbil9dGhpcy5tYXAuc2V0Q2VudGVyKGIsYyl9LHNldExpc3RlbmVyczpmdW5jdGlvbigpe3RoaXMubGlzdGVuZXJzPXt9O2Zvcih2YXIgYSBpbiB0aGlzLnJlZ2lzdHJ5KXRoaXMubGlzdGVuZXJzW2FdPU9wZW5MYXllcnMuRnVuY3Rpb24uYmluZChmdW5jdGlvbigpe2lmKCF0aGlzLnJlc3RvcmluZyl7dGhpcy5wcmV2aW91c1N0YWNrLnVuc2hpZnQodGhpcy5yZWdpc3RyeVthXS5hcHBseSh0aGlzLFxuYXJndW1lbnRzKSk7aWYoMTx0aGlzLnByZXZpb3VzU3RhY2subGVuZ3RoKXRoaXMub25QcmV2aW91c0NoYW5nZSh0aGlzLnByZXZpb3VzU3RhY2tbMV0sdGhpcy5wcmV2aW91c1N0YWNrLmxlbmd0aC0xKTt0aGlzLnByZXZpb3VzU3RhY2subGVuZ3RoPnRoaXMubGltaXQrMSYmdGhpcy5wcmV2aW91c1N0YWNrLnBvcCgpOzA8dGhpcy5uZXh0U3RhY2subGVuZ3RoJiYodGhpcy5uZXh0U3RhY2s9W10sdGhpcy5vbk5leHRDaGFuZ2UobnVsbCwwKSl9cmV0dXJuITB9LHRoaXMpfSxhY3RpdmF0ZTpmdW5jdGlvbigpe3ZhciBhPSExO2lmKHRoaXMubWFwJiZPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmFjdGl2YXRlLmFwcGx5KHRoaXMpKXtudWxsPT10aGlzLmxpc3RlbmVycyYmdGhpcy5zZXRMaXN0ZW5lcnMoKTtmb3IodmFyIGIgaW4gdGhpcy5saXN0ZW5lcnMpdGhpcy5tYXAuZXZlbnRzLnJlZ2lzdGVyKGIsdGhpcyx0aGlzLmxpc3RlbmVyc1tiXSk7YT0hMDswPT10aGlzLnByZXZpb3VzU3RhY2subGVuZ3RoJiZcbnRoaXMuaW5pdFN0YWNrKCl9cmV0dXJuIGF9LGluaXRTdGFjazpmdW5jdGlvbigpe3RoaXMubWFwLmdldENlbnRlcigpJiZ0aGlzLmxpc3RlbmVycy5tb3ZlZW5kKCl9LGRlYWN0aXZhdGU6ZnVuY3Rpb24oKXt2YXIgYT0hMTtpZih0aGlzLm1hcCYmT3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5kZWFjdGl2YXRlLmFwcGx5KHRoaXMpKXtmb3IodmFyIGIgaW4gdGhpcy5saXN0ZW5lcnMpdGhpcy5tYXAuZXZlbnRzLnVucmVnaXN0ZXIoYix0aGlzLHRoaXMubGlzdGVuZXJzW2JdKTt0aGlzLmNsZWFyT25EZWFjdGl2YXRlJiZ0aGlzLmNsZWFyKCk7YT0hMH1yZXR1cm4gYX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuQ29udHJvbC5OYXZpZ2F0aW9uSGlzdG9yeVwifSk7T3BlbkxheWVycy5Qcm90b2NvbC5IVFRQPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Qcm90b2NvbCx7dXJsOm51bGwsaGVhZGVyczpudWxsLHBhcmFtczpudWxsLGNhbGxiYWNrOm51bGwsc2NvcGU6bnVsbCxyZWFkV2l0aFBPU1Q6ITEsdXBkYXRlV2l0aFBPU1Q6ITEsZGVsZXRlV2l0aFBPU1Q6ITEsd2lsZGNhcmRlZDohMSxzcnNJbkJCT1g6ITEsaW5pdGlhbGl6ZTpmdW5jdGlvbihhKXthPWF8fHt9O3RoaXMucGFyYW1zPXt9O3RoaXMuaGVhZGVycz17fTtPcGVuTGF5ZXJzLlByb3RvY29sLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtpZighdGhpcy5maWx0ZXJUb1BhcmFtcyYmT3BlbkxheWVycy5Gb3JtYXQuUXVlcnlTdHJpbmdGaWx0ZXIpe3ZhciBiPW5ldyBPcGVuTGF5ZXJzLkZvcm1hdC5RdWVyeVN0cmluZ0ZpbHRlcih7d2lsZGNhcmRlZDp0aGlzLndpbGRjYXJkZWQsc3JzSW5CQk9YOnRoaXMuc3JzSW5CQk9YfSk7dGhpcy5maWx0ZXJUb1BhcmFtcz1cbmZ1bmN0aW9uKGEsZCl7cmV0dXJuIGIud3JpdGUoYSxkKX19fSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5oZWFkZXJzPXRoaXMucGFyYW1zPW51bGw7T3BlbkxheWVycy5Qcm90b2NvbC5wcm90b3R5cGUuZGVzdHJveS5hcHBseSh0aGlzKX0scmVhZDpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLlByb3RvY29sLnByb3RvdHlwZS5yZWFkLmFwcGx5KHRoaXMsYXJndW1lbnRzKTthPWF8fHt9O2EucGFyYW1zPU9wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKGEucGFyYW1zLHRoaXMub3B0aW9ucy5wYXJhbXMpO2E9T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoYSx0aGlzLm9wdGlvbnMpO2EuZmlsdGVyJiZ0aGlzLmZpbHRlclRvUGFyYW1zJiYoYS5wYXJhbXM9dGhpcy5maWx0ZXJUb1BhcmFtcyhhLmZpbHRlcixhLnBhcmFtcykpO3ZhciBiPXZvaWQgMCE9PWEucmVhZFdpdGhQT1NUP2EucmVhZFdpdGhQT1NUOnRoaXMucmVhZFdpdGhQT1NULGM9bmV3IE9wZW5MYXllcnMuUHJvdG9jb2wuUmVzcG9uc2Uoe3JlcXVlc3RUeXBlOlwicmVhZFwifSk7XG5iPyhiPWEuaGVhZGVyc3x8e30sYltcIkNvbnRlbnQtVHlwZVwiXT1cImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiLGMucHJpdj1PcGVuTGF5ZXJzLlJlcXVlc3QuUE9TVCh7dXJsOmEudXJsLGNhbGxiYWNrOnRoaXMuY3JlYXRlQ2FsbGJhY2sodGhpcy5oYW5kbGVSZWFkLGMsYSksZGF0YTpPcGVuTGF5ZXJzLlV0aWwuZ2V0UGFyYW1ldGVyU3RyaW5nKGEucGFyYW1zKSxoZWFkZXJzOmJ9KSk6Yy5wcml2PU9wZW5MYXllcnMuUmVxdWVzdC5HRVQoe3VybDphLnVybCxjYWxsYmFjazp0aGlzLmNyZWF0ZUNhbGxiYWNrKHRoaXMuaGFuZGxlUmVhZCxjLGEpLHBhcmFtczphLnBhcmFtcyxoZWFkZXJzOmEuaGVhZGVyc30pO3JldHVybiBjfSxoYW5kbGVSZWFkOmZ1bmN0aW9uKGEsYil7dGhpcy5oYW5kbGVSZXNwb25zZShhLGIpfSxjcmVhdGU6ZnVuY3Rpb24oYSxiKXt2YXIgYj1PcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyhiLHRoaXMub3B0aW9ucyksYz1uZXcgT3BlbkxheWVycy5Qcm90b2NvbC5SZXNwb25zZSh7cmVxRmVhdHVyZXM6YSxcbnJlcXVlc3RUeXBlOlwiY3JlYXRlXCJ9KTtjLnByaXY9T3BlbkxheWVycy5SZXF1ZXN0LlBPU1Qoe3VybDpiLnVybCxjYWxsYmFjazp0aGlzLmNyZWF0ZUNhbGxiYWNrKHRoaXMuaGFuZGxlQ3JlYXRlLGMsYiksaGVhZGVyczpiLmhlYWRlcnMsZGF0YTp0aGlzLmZvcm1hdC53cml0ZShhKX0pO3JldHVybiBjfSxoYW5kbGVDcmVhdGU6ZnVuY3Rpb24oYSxiKXt0aGlzLmhhbmRsZVJlc3BvbnNlKGEsYil9LHVwZGF0ZTpmdW5jdGlvbihhLGIpe3ZhciBiPWJ8fHt9LGM9Yi51cmx8fGEudXJsfHx0aGlzLm9wdGlvbnMudXJsK1wiL1wiK2EuZmlkLGI9T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoYix0aGlzLm9wdGlvbnMpLGQ9bmV3IE9wZW5MYXllcnMuUHJvdG9jb2wuUmVzcG9uc2Uoe3JlcUZlYXR1cmVzOmEscmVxdWVzdFR5cGU6XCJ1cGRhdGVcIn0pO2QucHJpdj1PcGVuTGF5ZXJzLlJlcXVlc3RbdGhpcy51cGRhdGVXaXRoUE9TVD9cIlBPU1RcIjpcIlBVVFwiXSh7dXJsOmMsY2FsbGJhY2s6dGhpcy5jcmVhdGVDYWxsYmFjayh0aGlzLmhhbmRsZVVwZGF0ZSxcbmQsYiksaGVhZGVyczpiLmhlYWRlcnMsZGF0YTp0aGlzLmZvcm1hdC53cml0ZShhKX0pO3JldHVybiBkfSxoYW5kbGVVcGRhdGU6ZnVuY3Rpb24oYSxiKXt0aGlzLmhhbmRsZVJlc3BvbnNlKGEsYil9LFwiZGVsZXRlXCI6ZnVuY3Rpb24oYSxiKXt2YXIgYj1ifHx7fSxjPWIudXJsfHxhLnVybHx8dGhpcy5vcHRpb25zLnVybCtcIi9cIithLmZpZCxiPU9wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKGIsdGhpcy5vcHRpb25zKSxkPW5ldyBPcGVuTGF5ZXJzLlByb3RvY29sLlJlc3BvbnNlKHtyZXFGZWF0dXJlczphLHJlcXVlc3RUeXBlOlwiZGVsZXRlXCJ9KSxlPXRoaXMuZGVsZXRlV2l0aFBPU1Q/XCJQT1NUXCI6XCJERUxFVEVcIixjPXt1cmw6YyxjYWxsYmFjazp0aGlzLmNyZWF0ZUNhbGxiYWNrKHRoaXMuaGFuZGxlRGVsZXRlLGQsYiksaGVhZGVyczpiLmhlYWRlcnN9O3RoaXMuZGVsZXRlV2l0aFBPU1QmJihjLmRhdGE9dGhpcy5mb3JtYXQud3JpdGUoYSkpO2QucHJpdj1PcGVuTGF5ZXJzLlJlcXVlc3RbZV0oYyk7XG5yZXR1cm4gZH0saGFuZGxlRGVsZXRlOmZ1bmN0aW9uKGEsYil7dGhpcy5oYW5kbGVSZXNwb25zZShhLGIpfSxoYW5kbGVSZXNwb25zZTpmdW5jdGlvbihhLGIpe3ZhciBjPWEucHJpdjtiLmNhbGxiYWNrJiYoMjAwPD1jLnN0YXR1cyYmMzAwPmMuc3RhdHVzPyhcImRlbGV0ZVwiIT1hLnJlcXVlc3RUeXBlJiYoYS5mZWF0dXJlcz10aGlzLnBhcnNlRmVhdHVyZXMoYykpLGEuY29kZT1PcGVuTGF5ZXJzLlByb3RvY29sLlJlc3BvbnNlLlNVQ0NFU1MpOmEuY29kZT1PcGVuTGF5ZXJzLlByb3RvY29sLlJlc3BvbnNlLkZBSUxVUkUsYi5jYWxsYmFjay5jYWxsKGIuc2NvcGUsYSkpfSxwYXJzZUZlYXR1cmVzOmZ1bmN0aW9uKGEpe3ZhciBiPWEucmVzcG9uc2VYTUw7aWYoIWJ8fCFiLmRvY3VtZW50RWxlbWVudCliPWEucmVzcG9uc2VUZXh0O3JldHVybiFifHwwPj1iLmxlbmd0aD9udWxsOnRoaXMuZm9ybWF0LnJlYWQoYil9LGNvbW1pdDpmdW5jdGlvbihhLGIpe2Z1bmN0aW9uIGMoYSl7Zm9yKHZhciBiPVxuYS5mZWF0dXJlcz9hLmZlYXR1cmVzLmxlbmd0aDowLGM9QXJyYXkoYiksZT0wO2U8YjsrK2UpY1tlXT1hLmZlYXR1cmVzW2VdLmZpZDtvLmluc2VydElkcz1jO2QuYXBwbHkodGhpcyxbYV0pfWZ1bmN0aW9uIGQoYSl7dGhpcy5jYWxsVXNlckNhbGxiYWNrKGEsYik7bj1uJiZhLnN1Y2Nlc3MoKTtmKys7Zj49bSYmYi5jYWxsYmFjayYmKG8uY29kZT1uP09wZW5MYXllcnMuUHJvdG9jb2wuUmVzcG9uc2UuU1VDQ0VTUzpPcGVuTGF5ZXJzLlByb3RvY29sLlJlc3BvbnNlLkZBSUxVUkUsYi5jYWxsYmFjay5hcHBseShiLnNjb3BlLFtvXSkpfXZhciBiPU9wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKGIsdGhpcy5vcHRpb25zKSxlPVtdLGY9MCxnPXt9O2dbT3BlbkxheWVycy5TdGF0ZS5JTlNFUlRdPVtdO2dbT3BlbkxheWVycy5TdGF0ZS5VUERBVEVdPVtdO2dbT3BlbkxheWVycy5TdGF0ZS5ERUxFVEVdPVtdO2Zvcih2YXIgaCxpLGo9W10saz0wLGw9YS5sZW5ndGg7azxsOysraylpZihoPVxuYVtrXSxpPWdbaC5zdGF0ZV0paS5wdXNoKGgpLGoucHVzaChoKTt2YXIgbT0oMDxnW09wZW5MYXllcnMuU3RhdGUuSU5TRVJUXS5sZW5ndGg/MTowKStnW09wZW5MYXllcnMuU3RhdGUuVVBEQVRFXS5sZW5ndGgrZ1tPcGVuTGF5ZXJzLlN0YXRlLkRFTEVURV0ubGVuZ3RoLG49ITAsbz1uZXcgT3BlbkxheWVycy5Qcm90b2NvbC5SZXNwb25zZSh7cmVxRmVhdHVyZXM6an0pO2g9Z1tPcGVuTGF5ZXJzLlN0YXRlLklOU0VSVF07MDxoLmxlbmd0aCYmZS5wdXNoKHRoaXMuY3JlYXRlKGgsT3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoe2NhbGxiYWNrOmMsc2NvcGU6dGhpc30sYi5jcmVhdGUpKSk7aD1nW09wZW5MYXllcnMuU3RhdGUuVVBEQVRFXTtmb3Ioaz1oLmxlbmd0aC0xOzA8PWs7LS1rKWUucHVzaCh0aGlzLnVwZGF0ZShoW2tdLE9wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKHtjYWxsYmFjazpkLHNjb3BlOnRoaXN9LGIudXBkYXRlKSkpO2g9Z1tPcGVuTGF5ZXJzLlN0YXRlLkRFTEVURV07XG5mb3Ioaz1oLmxlbmd0aC0xOzA8PWs7LS1rKWUucHVzaCh0aGlzW1wiZGVsZXRlXCJdKGhba10sT3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoe2NhbGxiYWNrOmQsc2NvcGU6dGhpc30sYltcImRlbGV0ZVwiXSkpKTtyZXR1cm4gZX0sYWJvcnQ6ZnVuY3Rpb24oYSl7YSYmYS5wcml2LmFib3J0KCl9LGNhbGxVc2VyQ2FsbGJhY2s6ZnVuY3Rpb24oYSxiKXt2YXIgYz1iW2EucmVxdWVzdFR5cGVdO2MmJmMuY2FsbGJhY2smJmMuY2FsbGJhY2suY2FsbChjLnNjb3BlLGEpfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Qcm90b2NvbC5IVFRQXCJ9KTtPcGVuTGF5ZXJzLlN0cmF0ZWd5LkNsdXN0ZXI9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLlN0cmF0ZWd5LHtkaXN0YW5jZToyMCx0aHJlc2hvbGQ6bnVsbCxmZWF0dXJlczpudWxsLGNsdXN0ZXJzOm51bGwsY2x1c3RlcmluZzohMSxyZXNvbHV0aW9uOm51bGwsYWN0aXZhdGU6ZnVuY3Rpb24oKXt2YXIgYT1PcGVuTGF5ZXJzLlN0cmF0ZWd5LnByb3RvdHlwZS5hY3RpdmF0ZS5jYWxsKHRoaXMpO2lmKGEpdGhpcy5sYXllci5ldmVudHMub24oe2JlZm9yZWZlYXR1cmVzYWRkZWQ6dGhpcy5jYWNoZUZlYXR1cmVzLG1vdmVlbmQ6dGhpcy5jbHVzdGVyLHNjb3BlOnRoaXN9KTtyZXR1cm4gYX0sZGVhY3RpdmF0ZTpmdW5jdGlvbigpe3ZhciBhPU9wZW5MYXllcnMuU3RyYXRlZ3kucHJvdG90eXBlLmRlYWN0aXZhdGUuY2FsbCh0aGlzKTthJiYodGhpcy5jbGVhckNhY2hlKCksdGhpcy5sYXllci5ldmVudHMudW4oe2JlZm9yZWZlYXR1cmVzYWRkZWQ6dGhpcy5jYWNoZUZlYXR1cmVzLG1vdmVlbmQ6dGhpcy5jbHVzdGVyLFxuc2NvcGU6dGhpc30pKTtyZXR1cm4gYX0sY2FjaGVGZWF0dXJlczpmdW5jdGlvbihhKXt2YXIgYj0hMDt0aGlzLmNsdXN0ZXJpbmd8fCh0aGlzLmNsZWFyQ2FjaGUoKSx0aGlzLmZlYXR1cmVzPWEuZmVhdHVyZXMsdGhpcy5jbHVzdGVyKCksYj0hMSk7cmV0dXJuIGJ9LGNsZWFyQ2FjaGU6ZnVuY3Rpb24oKXt0aGlzLmZlYXR1cmVzPW51bGx9LGNsdXN0ZXI6ZnVuY3Rpb24oYSl7aWYoKCFhfHxhLnpvb21DaGFuZ2VkKSYmdGhpcy5mZWF0dXJlcylpZihhPXRoaXMubGF5ZXIubWFwLmdldFJlc29sdXRpb24oKSxhIT10aGlzLnJlc29sdXRpb258fCF0aGlzLmNsdXN0ZXJzRXhpc3QoKSl7dGhpcy5yZXNvbHV0aW9uPWE7Zm9yKHZhciBhPVtdLGIsYyxkLGU9MDtlPHRoaXMuZmVhdHVyZXMubGVuZ3RoOysrZSlpZihiPXRoaXMuZmVhdHVyZXNbZV0sYi5nZW9tZXRyeSl7Yz0hMTtmb3IodmFyIGY9YS5sZW5ndGgtMTswPD1mOy0tZilpZihkPWFbZl0sdGhpcy5zaG91bGRDbHVzdGVyKGQsYikpe3RoaXMuYWRkVG9DbHVzdGVyKGQsXG5iKTtjPSEwO2JyZWFrfWN8fGEucHVzaCh0aGlzLmNyZWF0ZUNsdXN0ZXIodGhpcy5mZWF0dXJlc1tlXSkpfXRoaXMubGF5ZXIucmVtb3ZlQWxsRmVhdHVyZXMoKTtpZigwPGEubGVuZ3RoKXtpZigxPHRoaXMudGhyZXNob2xkKXtiPWEuc2xpY2UoKTthPVtdO2U9MDtmb3IoZD1iLmxlbmd0aDtlPGQ7KytlKWM9YltlXSxjLmF0dHJpYnV0ZXMuY291bnQ8dGhpcy50aHJlc2hvbGQ/QXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoYSxjLmNsdXN0ZXIpOmEucHVzaChjKX10aGlzLmNsdXN0ZXJpbmc9ITA7dGhpcy5sYXllci5hZGRGZWF0dXJlcyhhKTt0aGlzLmNsdXN0ZXJpbmc9ITF9dGhpcy5jbHVzdGVycz1hfX0sY2x1c3RlcnNFeGlzdDpmdW5jdGlvbigpe3ZhciBhPSExO2lmKHRoaXMuY2x1c3RlcnMmJjA8dGhpcy5jbHVzdGVycy5sZW5ndGgmJnRoaXMuY2x1c3RlcnMubGVuZ3RoPT10aGlzLmxheWVyLmZlYXR1cmVzLmxlbmd0aClmb3IodmFyIGE9ITAsYj0wO2I8dGhpcy5jbHVzdGVycy5sZW5ndGg7KytiKWlmKHRoaXMuY2x1c3RlcnNbYl0hPVxudGhpcy5sYXllci5mZWF0dXJlc1tiXSl7YT0hMTticmVha31yZXR1cm4gYX0sc2hvdWxkQ2x1c3RlcjpmdW5jdGlvbihhLGIpe3ZhciBjPWEuZ2VvbWV0cnkuZ2V0Qm91bmRzKCkuZ2V0Q2VudGVyTG9uTGF0KCksZD1iLmdlb21ldHJ5LmdldEJvdW5kcygpLmdldENlbnRlckxvbkxhdCgpO3JldHVybiBNYXRoLnNxcnQoTWF0aC5wb3coYy5sb24tZC5sb24sMikrTWF0aC5wb3coYy5sYXQtZC5sYXQsMikpL3RoaXMucmVzb2x1dGlvbjw9dGhpcy5kaXN0YW5jZX0sYWRkVG9DbHVzdGVyOmZ1bmN0aW9uKGEsYil7YS5jbHVzdGVyLnB1c2goYik7YS5hdHRyaWJ1dGVzLmNvdW50Kz0xfSxjcmVhdGVDbHVzdGVyOmZ1bmN0aW9uKGEpe3ZhciBiPWEuZ2VvbWV0cnkuZ2V0Qm91bmRzKCkuZ2V0Q2VudGVyTG9uTGF0KCksYj1uZXcgT3BlbkxheWVycy5GZWF0dXJlLlZlY3RvcihuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChiLmxvbixiLmxhdCkse2NvdW50OjF9KTtiLmNsdXN0ZXI9W2FdO1xucmV0dXJuIGJ9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLlN0cmF0ZWd5LkNsdXN0ZXJcIn0pO09wZW5MYXllcnMuU3RyYXRlZ3kuRmlsdGVyPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5TdHJhdGVneSx7ZmlsdGVyOm51bGwsY2FjaGU6bnVsbCxjYWNoaW5nOiExLGFjdGl2YXRlOmZ1bmN0aW9uKCl7dmFyIGE9T3BlbkxheWVycy5TdHJhdGVneS5wcm90b3R5cGUuYWN0aXZhdGUuYXBwbHkodGhpcyxhcmd1bWVudHMpO2EmJih0aGlzLmNhY2hlPVtdLHRoaXMubGF5ZXIuZXZlbnRzLm9uKHtiZWZvcmVmZWF0dXJlc2FkZGVkOnRoaXMuaGFuZGxlQWRkLGJlZm9yZWZlYXR1cmVzcmVtb3ZlZDp0aGlzLmhhbmRsZVJlbW92ZSxzY29wZTp0aGlzfSkpO3JldHVybiBhfSxkZWFjdGl2YXRlOmZ1bmN0aW9uKCl7dGhpcy5jYWNoZT1udWxsO3RoaXMubGF5ZXImJnRoaXMubGF5ZXIuZXZlbnRzJiZ0aGlzLmxheWVyLmV2ZW50cy51bih7YmVmb3JlZmVhdHVyZXNhZGRlZDp0aGlzLmhhbmRsZUFkZCxiZWZvcmVmZWF0dXJlc3JlbW92ZWQ6dGhpcy5oYW5kbGVSZW1vdmUsc2NvcGU6dGhpc30pO1xucmV0dXJuIE9wZW5MYXllcnMuU3RyYXRlZ3kucHJvdG90eXBlLmRlYWN0aXZhdGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxoYW5kbGVBZGQ6ZnVuY3Rpb24oYSl7aWYoIXRoaXMuY2FjaGluZyYmdGhpcy5maWx0ZXIpe3ZhciBiPWEuZmVhdHVyZXM7YS5mZWF0dXJlcz1bXTtmb3IodmFyIGMsZD0wLGU9Yi5sZW5ndGg7ZDxlOysrZCljPWJbZF0sdGhpcy5maWx0ZXIuZXZhbHVhdGUoYyk/YS5mZWF0dXJlcy5wdXNoKGMpOnRoaXMuY2FjaGUucHVzaChjKX19LGhhbmRsZVJlbW92ZTpmdW5jdGlvbigpe3RoaXMuY2FjaGluZ3x8KHRoaXMuY2FjaGU9W10pfSxzZXRGaWx0ZXI6ZnVuY3Rpb24oYSl7dGhpcy5maWx0ZXI9YTthPXRoaXMuY2FjaGU7dGhpcy5jYWNoZT1bXTt0aGlzLmhhbmRsZUFkZCh7ZmVhdHVyZXM6dGhpcy5sYXllci5mZWF0dXJlc30pOzA8dGhpcy5jYWNoZS5sZW5ndGgmJih0aGlzLmNhY2hpbmc9ITAsdGhpcy5sYXllci5yZW1vdmVGZWF0dXJlcyh0aGlzLmNhY2hlLnNsaWNlKCkpLFxudGhpcy5jYWNoaW5nPSExKTswPGEubGVuZ3RoJiYoYT17ZmVhdHVyZXM6YX0sdGhpcy5oYW5kbGVBZGQoYSksMDxhLmZlYXR1cmVzLmxlbmd0aCYmKHRoaXMuY2FjaGluZz0hMCx0aGlzLmxheWVyLmFkZEZlYXR1cmVzKGEuZmVhdHVyZXMpLHRoaXMuY2FjaGluZz0hMSkpfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5TdHJhdGVneS5GaWx0ZXJcIn0pO09wZW5MYXllcnMuUHJvdG9jb2wuU09TPWZ1bmN0aW9uKGEpe3ZhciBhPU9wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKGEsT3BlbkxheWVycy5Qcm90b2NvbC5TT1MuREVGQVVMVFMpLGI9T3BlbkxheWVycy5Qcm90b2NvbC5TT1NbXCJ2XCIrYS52ZXJzaW9uLnJlcGxhY2UoL1xcLi9nLFwiX1wiKV07aWYoIWIpdGhyb3dcIlVuc3VwcG9ydGVkIFNPUyB2ZXJzaW9uOiBcIithLnZlcnNpb247cmV0dXJuIG5ldyBiKGEpfTtPcGVuTGF5ZXJzLlByb3RvY29sLlNPUy5ERUZBVUxUUz17dmVyc2lvbjpcIjEuMC4wXCJ9O09wZW5MYXllcnMuRm9ybWF0LldGU0Rlc2NyaWJlRmVhdHVyZVR5cGU9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkZvcm1hdC5YTUwse25hbWVzcGFjZXM6e3hzZDpcImh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hXCJ9LHJlYWRlcnM6e3hzZDp7c2NoZW1hOmZ1bmN0aW9uKGEsYil7dmFyIGM9W10sZD17fTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEse2NvbXBsZXhUeXBlczpjLGN1c3RvbVR5cGVzOmR9KTtmb3IodmFyIGU9YS5hdHRyaWJ1dGVzLGYsZyxoPTAsaT1lLmxlbmd0aDtoPGk7KytoKWY9ZVtoXSxnPWYubmFtZSwwPT1nLmluZGV4T2YoXCJ4bWxuc1wiKT90aGlzLnNldE5hbWVzcGFjZShnLnNwbGl0KFwiOlwiKVsxXXx8XCJcIixmLnZhbHVlKTpiW2ddPWYudmFsdWU7Yi5mZWF0dXJlVHlwZXM9YztiLnRhcmdldFByZWZpeD10aGlzLm5hbWVzcGFjZUFsaWFzW2IudGFyZ2V0TmFtZXNwYWNlXTtoPTA7Zm9yKGk9Yy5sZW5ndGg7aDxpOysraCllPWNbaF0sZj1kW2UudHlwZU5hbWVdLFxuZFtlLnR5cGVOYW1lXSYmKGUudHlwZU5hbWU9Zi5uYW1lKX0sY29tcGxleFR5cGU6ZnVuY3Rpb24oYSxiKXt2YXIgYz17dHlwZU5hbWU6YS5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpfTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYyk7Yi5jb21wbGV4VHlwZXMucHVzaChjKX0sY29tcGxleENvbnRlbnQ6ZnVuY3Rpb24oYSxiKXt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYil9LGV4dGVuc2lvbjpmdW5jdGlvbihhLGIpe3RoaXMucmVhZENoaWxkTm9kZXMoYSxiKX0sc2VxdWVuY2U6ZnVuY3Rpb24oYSxiKXt2YXIgYz17ZWxlbWVudHM6W119O3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKTtiLnByb3BlcnRpZXM9Yy5lbGVtZW50c30sZWxlbWVudDpmdW5jdGlvbihhLGIpe2lmKGIuZWxlbWVudHMpe2Zvcih2YXIgYz17fSxkPWEuYXR0cmlidXRlcyxlLGY9MCxnPWQubGVuZ3RoO2Y8ZzsrK2YpZT1kW2ZdLGNbZS5uYW1lXT1lLnZhbHVlO2Q9Yy50eXBlO2R8fChkPXt9LHRoaXMucmVhZENoaWxkTm9kZXMoYSxcbmQpLGMucmVzdHJpY3Rpb249ZCxjLnR5cGU9ZC5iYXNlKTtjLmxvY2FsVHlwZT0oZC5iYXNlfHxkKS5zcGxpdChcIjpcIikucG9wKCk7Yi5lbGVtZW50cy5wdXNoKGMpfWIuY29tcGxleFR5cGVzJiYoZD1hLmdldEF0dHJpYnV0ZShcInR5cGVcIiksYz1kLnNwbGl0KFwiOlwiKS5wb3AoKSxiLmN1c3RvbVR5cGVzW2NdPXtuYW1lOmEuZ2V0QXR0cmlidXRlKFwibmFtZVwiKSx0eXBlOmR9KX0sc2ltcGxlVHlwZTpmdW5jdGlvbihhLGIpe3RoaXMucmVhZENoaWxkTm9kZXMoYSxiKX0scmVzdHJpY3Rpb246ZnVuY3Rpb24oYSxiKXtiLmJhc2U9YS5nZXRBdHRyaWJ1dGUoXCJiYXNlXCIpO3RoaXMucmVhZFJlc3RyaWN0aW9uKGEsYil9fX0scmVhZFJlc3RyaWN0aW9uOmZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPWEuY2hpbGROb2RlcyxkLGUsZj0wLGc9Yy5sZW5ndGg7ZjxnOysrZilkPWNbZl0sMT09ZC5ub2RlVHlwZSYmKGU9ZC5ub2RlTmFtZS5zcGxpdChcIjpcIikucG9wKCksZD1kLmdldEF0dHJpYnV0ZShcInZhbHVlXCIpLFxuYltlXT8oXCJzdHJpbmdcIj09dHlwZW9mIGJbZV0mJihiW2VdPVtiW2VdXSksYltlXS5wdXNoKGQpKTpiW2VdPWQpfSxyZWFkOmZ1bmN0aW9uKGEpe1wic3RyaW5nXCI9PXR5cGVvZiBhJiYoYT1PcGVuTGF5ZXJzLkZvcm1hdC5YTUwucHJvdG90eXBlLnJlYWQuYXBwbHkodGhpcyxbYV0pKTthJiY5PT1hLm5vZGVUeXBlJiYoYT1hLmRvY3VtZW50RWxlbWVudCk7dmFyIGI9e307dGhpcy5yZWFkTm9kZShhLGIpO3JldHVybiBifSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Gb3JtYXQuV0ZTRGVzY3JpYmVGZWF0dXJlVHlwZVwifSk7T3BlbkxheWVycy5Gb3JtYXQuR2VvUlNTPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Gb3JtYXQuWE1MLHtyc3NuczpcImh0dHA6Ly9iYWNrZW5kLnVzZXJsYW5kLmNvbS9yc3MyXCIsZmVhdHVyZU5TOlwiaHR0cDovL21hcHNlcnZlci5naXMudW1uLmVkdS9tYXBzZXJ2ZXJcIixnZW9yc3NuczpcImh0dHA6Ly93d3cuZ2VvcnNzLm9yZy9nZW9yc3NcIixnZW9uczpcImh0dHA6Ly93d3cudzMub3JnLzIwMDMvMDEvZ2VvL3dnczg0X3BvcyNcIixmZWF0dXJlVGl0bGU6XCJVbnRpdGxlZFwiLGZlYXR1cmVEZXNjcmlwdGlvbjpcIk5vIERlc2NyaXB0aW9uXCIsZ21sUGFyc2VyOm51bGwseHk6ITEsY3JlYXRlR2VvbWV0cnlGcm9tSXRlbTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmdldEVsZW1lbnRzQnlUYWdOYW1lTlMoYSx0aGlzLmdlb3Jzc25zLFwicG9pbnRcIiksYz10aGlzLmdldEVsZW1lbnRzQnlUYWdOYW1lTlMoYSx0aGlzLmdlb25zLFwibGF0XCIpLGQ9dGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZU5TKGEsXG50aGlzLmdlb25zLFwibG9uZ1wiKSxlPXRoaXMuZ2V0RWxlbWVudHNCeVRhZ05hbWVOUyhhLHRoaXMuZ2VvcnNzbnMsXCJsaW5lXCIpLGY9dGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZU5TKGEsdGhpcy5nZW9yc3NucyxcInBvbHlnb25cIiksZz10aGlzLmdldEVsZW1lbnRzQnlUYWdOYW1lTlMoYSx0aGlzLmdlb3Jzc25zLFwid2hlcmVcIiksYT10aGlzLmdldEVsZW1lbnRzQnlUYWdOYW1lTlMoYSx0aGlzLmdlb3Jzc25zLFwiYm94XCIpO2lmKDA8Yi5sZW5ndGh8fDA8Yy5sZW5ndGgmJjA8ZC5sZW5ndGgpezA8Yi5sZW5ndGg/KGM9T3BlbkxheWVycy5TdHJpbmcudHJpbShiWzBdLmZpcnN0Q2hpbGQubm9kZVZhbHVlKS5zcGxpdCgvXFxzKy8pLDIhPWMubGVuZ3RoJiYoYz1PcGVuTGF5ZXJzLlN0cmluZy50cmltKGJbMF0uZmlyc3RDaGlsZC5ub2RlVmFsdWUpLnNwbGl0KC9cXHMqLFxccyovKSkpOmM9W3BhcnNlRmxvYXQoY1swXS5maXJzdENoaWxkLm5vZGVWYWx1ZSkscGFyc2VGbG9hdChkWzBdLmZpcnN0Q2hpbGQubm9kZVZhbHVlKV07XG52YXIgaD1uZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChjWzFdLGNbMF0pfWVsc2UgaWYoMDxlLmxlbmd0aCl7Yz1PcGVuTGF5ZXJzLlN0cmluZy50cmltKHRoaXMuZ2V0Q2hpbGRWYWx1ZShlWzBdKSkuc3BsaXQoL1xccysvKTtkPVtdO2U9MDtmb3IoZj1jLmxlbmd0aDtlPGY7ZSs9MiliPW5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGNbZSsxXSxjW2VdKSxkLnB1c2goYik7aD1uZXcgT3BlbkxheWVycy5HZW9tZXRyeS5MaW5lU3RyaW5nKGQpfWVsc2UgaWYoMDxmLmxlbmd0aCl7Yz1PcGVuTGF5ZXJzLlN0cmluZy50cmltKHRoaXMuZ2V0Q2hpbGRWYWx1ZShmWzBdKSkuc3BsaXQoL1xccysvKTtkPVtdO2U9MDtmb3IoZj1jLmxlbmd0aDtlPGY7ZSs9MiliPW5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGNbZSsxXSxjW2VdKSxkLnB1c2goYik7aD1uZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2x5Z29uKFtuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5MaW5lYXJSaW5nKGQpXSl9ZWxzZSAwPFxuZy5sZW5ndGg/KHRoaXMuZ21sUGFyc2VyfHwodGhpcy5nbWxQYXJzZXI9bmV3IE9wZW5MYXllcnMuRm9ybWF0LkdNTCh7eHk6dGhpcy54eX0pKSxoPXRoaXMuZ21sUGFyc2VyLnBhcnNlRmVhdHVyZShnWzBdKS5nZW9tZXRyeSk6MDxhLmxlbmd0aCYmKGM9T3BlbkxheWVycy5TdHJpbmcudHJpbShhWzBdLmZpcnN0Q2hpbGQubm9kZVZhbHVlKS5zcGxpdCgvXFxzKy8pLGQ9W10sMzxjLmxlbmd0aCYmKGI9bmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQoY1sxXSxjWzBdKSxkLnB1c2goYiksYj1uZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChjWzFdLGNbMl0pLGQucHVzaChiKSxiPW5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGNbM10sY1syXSksZC5wdXNoKGIpLGI9bmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQoY1szXSxjWzBdKSxkLnB1c2goYiksYj1uZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChjWzFdLGNbMF0pLGQucHVzaChiKSksaD1uZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2x5Z29uKFtuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5MaW5lYXJSaW5nKGQpXSkpO1xuaCYmKHRoaXMuaW50ZXJuYWxQcm9qZWN0aW9uJiZ0aGlzLmV4dGVybmFsUHJvamVjdGlvbikmJmgudHJhbnNmb3JtKHRoaXMuZXh0ZXJuYWxQcm9qZWN0aW9uLHRoaXMuaW50ZXJuYWxQcm9qZWN0aW9uKTtyZXR1cm4gaH0sY3JlYXRlRmVhdHVyZUZyb21JdGVtOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlR2VvbWV0cnlGcm9tSXRlbShhKSxjPXRoaXMuX2dldENoaWxkVmFsdWUoYSxcIipcIixcInRpdGxlXCIsdGhpcy5mZWF0dXJlVGl0bGUpLGQ9dGhpcy5fZ2V0Q2hpbGRWYWx1ZShhLFwiKlwiLFwiZGVzY3JpcHRpb25cIix0aGlzLl9nZXRDaGlsZFZhbHVlKGEsXCIqXCIsXCJjb250ZW50XCIsdGhpcy5fZ2V0Q2hpbGRWYWx1ZShhLFwiKlwiLFwic3VtbWFyeVwiLHRoaXMuZmVhdHVyZURlc2NyaXB0aW9uKSkpLGU9dGhpcy5fZ2V0Q2hpbGRWYWx1ZShhLFwiKlwiLFwibGlua1wiKTtpZighZSl0cnl7ZT10aGlzLmdldEVsZW1lbnRzQnlUYWdOYW1lTlMoYSxcIipcIixcImxpbmtcIilbMF0uZ2V0QXR0cmlidXRlKFwiaHJlZlwiKX1jYXRjaChmKXtlPVxubnVsbH1hPXRoaXMuX2dldENoaWxkVmFsdWUoYSxcIipcIixcImlkXCIsbnVsbCk7Yj1uZXcgT3BlbkxheWVycy5GZWF0dXJlLlZlY3RvcihiLHt0aXRsZTpjLGRlc2NyaXB0aW9uOmQsbGluazplfSk7Yi5maWQ9YTtyZXR1cm4gYn0sX2dldENoaWxkVmFsdWU6ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuKGE9dGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZU5TKGEsYixjKSkmJmFbMF0mJmFbMF0uZmlyc3RDaGlsZCYmYVswXS5maXJzdENoaWxkLm5vZGVWYWx1ZT90aGlzLmdldENoaWxkVmFsdWUoYVswXSk6dm9pZCAwPT1kP1wiXCI6ZH0scmVhZDpmdW5jdGlvbihhKXtcInN0cmluZ1wiPT10eXBlb2YgYSYmKGE9T3BlbkxheWVycy5Gb3JtYXQuWE1MLnByb3RvdHlwZS5yZWFkLmFwcGx5KHRoaXMsW2FdKSk7dmFyIGI9bnVsbCxiPXRoaXMuZ2V0RWxlbWVudHNCeVRhZ05hbWVOUyhhLFwiKlwiLFwiaXRlbVwiKTswPT1iLmxlbmd0aCYmKGI9dGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZU5TKGEsXCIqXCIsXCJlbnRyeVwiKSk7XG5mb3IodmFyIGE9Yi5sZW5ndGgsYz1BcnJheShhKSxkPTA7ZDxhO2QrKyljW2RdPXRoaXMuY3JlYXRlRmVhdHVyZUZyb21JdGVtKGJbZF0pO3JldHVybiBjfSx3cml0ZTpmdW5jdGlvbihhKXt2YXIgYjtpZihPcGVuTGF5ZXJzLlV0aWwuaXNBcnJheShhKSl7Yj10aGlzLmNyZWF0ZUVsZW1lbnROUyh0aGlzLnJzc25zLFwicnNzXCIpO2Zvcih2YXIgYz0wLGQ9YS5sZW5ndGg7YzxkO2MrKyliLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlRmVhdHVyZVhNTChhW2NdKSl9ZWxzZSBiPXRoaXMuY3JlYXRlRmVhdHVyZVhNTChhKTtyZXR1cm4gT3BlbkxheWVycy5Gb3JtYXQuWE1MLnByb3RvdHlwZS53cml0ZS5hcHBseSh0aGlzLFtiXSl9LGNyZWF0ZUZlYXR1cmVYTUw6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5idWlsZEdlb21ldHJ5Tm9kZShhLmdlb21ldHJ5KSxjPXRoaXMuY3JlYXRlRWxlbWVudE5TKHRoaXMucnNzbnMsXCJpdGVtXCIpLGQ9dGhpcy5jcmVhdGVFbGVtZW50TlModGhpcy5yc3NucyxcInRpdGxlXCIpO1xuZC5hcHBlbmRDaGlsZCh0aGlzLmNyZWF0ZVRleHROb2RlKGEuYXR0cmlidXRlcy50aXRsZT9hLmF0dHJpYnV0ZXMudGl0bGU6XCJcIikpO3ZhciBlPXRoaXMuY3JlYXRlRWxlbWVudE5TKHRoaXMucnNzbnMsXCJkZXNjcmlwdGlvblwiKTtlLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlVGV4dE5vZGUoYS5hdHRyaWJ1dGVzLmRlc2NyaXB0aW9uP2EuYXR0cmlidXRlcy5kZXNjcmlwdGlvbjpcIlwiKSk7Yy5hcHBlbmRDaGlsZChkKTtjLmFwcGVuZENoaWxkKGUpO2EuYXR0cmlidXRlcy5saW5rJiYoZD10aGlzLmNyZWF0ZUVsZW1lbnROUyh0aGlzLnJzc25zLFwibGlua1wiKSxkLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlVGV4dE5vZGUoYS5hdHRyaWJ1dGVzLmxpbmspKSxjLmFwcGVuZENoaWxkKGQpKTtmb3IodmFyIGYgaW4gYS5hdHRyaWJ1dGVzKVwibGlua1wiPT1mfHwoXCJ0aXRsZVwiPT1mfHxcImRlc2NyaXB0aW9uXCI9PWYpfHwoZD10aGlzLmNyZWF0ZVRleHROb2RlKGEuYXR0cmlidXRlc1tmXSksZT1mLC0xIT1cbmYuc2VhcmNoKFwiOlwiKSYmKGU9Zi5zcGxpdChcIjpcIilbMV0pLGU9dGhpcy5jcmVhdGVFbGVtZW50TlModGhpcy5mZWF0dXJlTlMsXCJmZWF0dXJlOlwiK2UpLGUuYXBwZW5kQ2hpbGQoZCksYy5hcHBlbmRDaGlsZChlKSk7Yy5hcHBlbmRDaGlsZChiKTtyZXR1cm4gY30sYnVpbGRHZW9tZXRyeU5vZGU6ZnVuY3Rpb24oYSl7dGhpcy5pbnRlcm5hbFByb2plY3Rpb24mJnRoaXMuZXh0ZXJuYWxQcm9qZWN0aW9uJiYoYT1hLmNsb25lKCksYS50cmFuc2Zvcm0odGhpcy5pbnRlcm5hbFByb2plY3Rpb24sdGhpcy5leHRlcm5hbFByb2plY3Rpb24pKTt2YXIgYjtpZihcIk9wZW5MYXllcnMuR2VvbWV0cnkuUG9seWdvblwiPT1hLkNMQVNTX05BTUUpYj10aGlzLmNyZWF0ZUVsZW1lbnROUyh0aGlzLmdlb3Jzc25zLFwiZ2VvcnNzOnBvbHlnb25cIiksYi5hcHBlbmRDaGlsZCh0aGlzLmJ1aWxkQ29vcmRpbmF0ZXNOb2RlKGEuY29tcG9uZW50c1swXSkpO2Vsc2UgaWYoXCJPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVTdHJpbmdcIj09XG5hLkNMQVNTX05BTUUpYj10aGlzLmNyZWF0ZUVsZW1lbnROUyh0aGlzLmdlb3Jzc25zLFwiZ2VvcnNzOmxpbmVcIiksYi5hcHBlbmRDaGlsZCh0aGlzLmJ1aWxkQ29vcmRpbmF0ZXNOb2RlKGEpKTtlbHNlIGlmKFwiT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludFwiPT1hLkNMQVNTX05BTUUpYj10aGlzLmNyZWF0ZUVsZW1lbnROUyh0aGlzLmdlb3Jzc25zLFwiZ2VvcnNzOnBvaW50XCIpLGIuYXBwZW5kQ2hpbGQodGhpcy5idWlsZENvb3JkaW5hdGVzTm9kZShhKSk7ZWxzZSB0aHJvd1wiQ291bGRuJ3QgcGFyc2UgXCIrYS5DTEFTU19OQU1FO3JldHVybiBifSxidWlsZENvb3JkaW5hdGVzTm9kZTpmdW5jdGlvbihhKXt2YXIgYj1udWxsO2EuY29tcG9uZW50cyYmKGI9YS5jb21wb25lbnRzKTtpZihiKXtmb3IodmFyIGE9Yi5sZW5ndGgsYz1BcnJheShhKSxkPTA7ZDxhO2QrKyljW2RdPWJbZF0ueStcIiBcIitiW2RdLng7Yj1jLmpvaW4oXCIgXCIpfWVsc2UgYj1hLnkrXCIgXCIrYS54O3JldHVybiB0aGlzLmNyZWF0ZVRleHROb2RlKGIpfSxcbkNMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZvcm1hdC5HZW9SU1NcIn0pO09wZW5MYXllcnMuRm9ybWF0LldQU0NhcGFiaWxpdGllcz1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuRm9ybWF0LlhNTC5WZXJzaW9uZWRPR0Mse2RlZmF1bHRWZXJzaW9uOlwiMS4wLjBcIixDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Gb3JtYXQuV1BTQ2FwYWJpbGl0aWVzXCJ9KTtPcGVuTGF5ZXJzLkZvcm1hdC5XUFNDYXBhYmlsaXRpZXMudjFfMF8wPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Gb3JtYXQuWE1MLHtuYW1lc3BhY2VzOntvd3M6XCJodHRwOi8vd3d3Lm9wZW5naXMubmV0L293cy8xLjFcIix3cHM6XCJodHRwOi8vd3d3Lm9wZW5naXMubmV0L3dwcy8xLjAuMFwiLHhsaW5rOlwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGlua1wifSxyZWdFeGVzOnt0cmltU3BhY2U6L15cXHMqfFxccyokL2cscmVtb3ZlU3BhY2U6L1xccyovZyxzcGxpdFNwYWNlOi9cXHMrLyx0cmltQ29tbWE6L1xccyosXFxzKi9nfSxpbml0aWFsaXplOmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuRm9ybWF0LlhNTC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLFthXSl9LHJlYWQ6ZnVuY3Rpb24oYSl7XCJzdHJpbmdcIj09dHlwZW9mIGEmJihhPU9wZW5MYXllcnMuRm9ybWF0LlhNTC5wcm90b3R5cGUucmVhZC5hcHBseSh0aGlzLFthXSkpO2EmJjk9PWEubm9kZVR5cGUmJihhPWEuZG9jdW1lbnRFbGVtZW50KTtcbnZhciBiPXt9O3RoaXMucmVhZE5vZGUoYSxiKTtyZXR1cm4gYn0scmVhZGVyczp7d3BzOntDYXBhYmlsaXRpZXM6ZnVuY3Rpb24oYSxiKXt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYil9LFByb2Nlc3NPZmZlcmluZ3M6ZnVuY3Rpb24oYSxiKXtiLnByb2Nlc3NPZmZlcmluZ3M9e307dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIucHJvY2Vzc09mZmVyaW5ncyl9LFByb2Nlc3M6ZnVuY3Rpb24oYSxiKXt2YXIgYz17cHJvY2Vzc1ZlcnNpb246dGhpcy5nZXRBdHRyaWJ1dGVOUyhhLHRoaXMubmFtZXNwYWNlcy53cHMsXCJwcm9jZXNzVmVyc2lvblwiKX07dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpO2JbYy5pZGVudGlmaWVyXT1jfSxMYW5ndWFnZXM6ZnVuY3Rpb24oYSxiKXtiLmxhbmd1YWdlcz1bXTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYi5sYW5ndWFnZXMpfSxEZWZhdWx0OmZ1bmN0aW9uKGEsYil7dmFyIGM9e2lzRGVmYXVsdDohMH07dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpO2IucHVzaChjKX0sXG5TdXBwb3J0ZWQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz17fTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYyk7Yi5wdXNoKGMpfX0sb3dzOk9wZW5MYXllcnMuRm9ybWF0Lk9XU0NvbW1vbi52MV8xXzAucHJvdG90eXBlLnJlYWRlcnMub3dzfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Gb3JtYXQuV1BTQ2FwYWJpbGl0aWVzLnYxXzBfMFwifSk7T3BlbkxheWVycy5Db250cm9sLlBpbmNoWm9vbT1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuQ29udHJvbCx7dHlwZTpPcGVuTGF5ZXJzLkNvbnRyb2wuVFlQRV9UT09MLGNvbnRhaW5lckNlbnRlcjpudWxsLHBpbmNoT3JpZ2luOm51bGwsY3VycmVudENlbnRlcjpudWxsLGF1dG9BY3RpdmF0ZTohMCxpbml0aWFsaXplOmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuQ29udHJvbC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5oYW5kbGVyPW5ldyBPcGVuTGF5ZXJzLkhhbmRsZXIuUGluY2godGhpcyx7c3RhcnQ6dGhpcy5waW5jaFN0YXJ0LG1vdmU6dGhpcy5waW5jaE1vdmUsZG9uZTp0aGlzLnBpbmNoRG9uZX0sdGhpcy5oYW5kbGVyT3B0aW9ucyl9LGFjdGl2YXRlOmZ1bmN0aW9uKCl7dmFyIGE9T3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5hY3RpdmF0ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7YSYmKHRoaXMubWFwLmV2ZW50cy5vbih7bW92ZWVuZDp0aGlzLnVwZGF0ZUNvbnRhaW5lckNlbnRlcixcbnNjb3BlOnRoaXN9KSx0aGlzLnVwZGF0ZUNvbnRhaW5lckNlbnRlcigpKTtyZXR1cm4gYX0sZGVhY3RpdmF0ZTpmdW5jdGlvbigpe3ZhciBhPU9wZW5MYXllcnMuQ29udHJvbC5wcm90b3R5cGUuZGVhY3RpdmF0ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5tYXAmJnRoaXMubWFwLmV2ZW50cyYmdGhpcy5tYXAuZXZlbnRzLnVuKHttb3ZlZW5kOnRoaXMudXBkYXRlQ29udGFpbmVyQ2VudGVyLHNjb3BlOnRoaXN9KTtyZXR1cm4gYX0sdXBkYXRlQ29udGFpbmVyQ2VudGVyOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tYXAubGF5ZXJDb250YWluZXJEaXY7dGhpcy5jb250YWluZXJDZW50ZXI9e3g6cGFyc2VJbnQoYS5zdHlsZS5sZWZ0LDEwKSs1MCx5OnBhcnNlSW50KGEuc3R5bGUudG9wLDEwKSs1MH19LHBpbmNoU3RhcnQ6ZnVuY3Rpb24oYSl7dGhpcy5jdXJyZW50Q2VudGVyPXRoaXMucGluY2hPcmlnaW49YS54eX0scGluY2hNb3ZlOmZ1bmN0aW9uKGEsYil7dmFyIGM9Yi5zY2FsZSxcbmQ9dGhpcy5jb250YWluZXJDZW50ZXIsZT10aGlzLnBpbmNoT3JpZ2luLGY9YS54eSxnPU1hdGgucm91bmQoZi54LWUueCsoYy0xKSooZC54LWUueCkpLGQ9TWF0aC5yb3VuZChmLnktZS55KyhjLTEpKihkLnktZS55KSk7dGhpcy5hcHBseVRyYW5zZm9ybShcInRyYW5zbGF0ZShcIitnK1wicHgsIFwiK2QrXCJweCkgc2NhbGUoXCIrYytcIilcIik7dGhpcy5jdXJyZW50Q2VudGVyPWZ9LGFwcGx5VHJhbnNmb3JtOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMubWFwLmxheWVyQ29udGFpbmVyRGl2LnN0eWxlO2JbXCItd2Via2l0LXRyYW5zZm9ybVwiXT1hO2JbXCItbW96LXRyYW5zZm9ybVwiXT1hfSxwaW5jaERvbmU6ZnVuY3Rpb24oYSxiLGMpe3RoaXMuYXBwbHlUcmFuc2Zvcm0oXCJcIik7YT10aGlzLm1hcC5nZXRab29tRm9yUmVzb2x1dGlvbih0aGlzLm1hcC5nZXRSZXNvbHV0aW9uKCkvYy5zY2FsZSwhMCk7aWYoYSE9PXRoaXMubWFwLmdldFpvb20oKXx8IXRoaXMuY3VycmVudENlbnRlci5lcXVhbHModGhpcy5waW5jaE9yaWdpbikpe3ZhciBiPVxudGhpcy5tYXAuZ2V0UmVzb2x1dGlvbkZvclpvb20oYSksYz10aGlzLm1hcC5nZXRMb25MYXRGcm9tUGl4ZWwodGhpcy5waW5jaE9yaWdpbiksZD10aGlzLmN1cnJlbnRDZW50ZXIsZT10aGlzLm1hcC5nZXRTaXplKCk7Yy5sb24rPWIqKGUudy8yLWQueCk7Yy5sYXQtPWIqKGUuaC8yLWQueSk7dGhpcy5tYXAuZGl2LmNsaWVudFdpZHRoPXRoaXMubWFwLmRpdi5jbGllbnRXaWR0aDt0aGlzLm1hcC5zZXRDZW50ZXIoYyxhKX19LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkNvbnRyb2wuUGluY2hab29tXCJ9KTtPcGVuTGF5ZXJzLkNvbnRyb2wuVG91Y2hOYXZpZ2F0aW9uPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Db250cm9sLHtkcmFnUGFuOm51bGwsZHJhZ1Bhbk9wdGlvbnM6bnVsbCxwaW5jaFpvb206bnVsbCxwaW5jaFpvb21PcHRpb25zOm51bGwsY2xpY2tIYW5kbGVyT3B0aW9uczpudWxsLGRvY3VtZW50RHJhZzohMSxhdXRvQWN0aXZhdGU6ITAsaW5pdGlhbGl6ZTpmdW5jdGlvbihhKXt0aGlzLmhhbmRsZXJzPXt9O09wZW5MYXllcnMuQ29udHJvbC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLmRlYWN0aXZhdGUoKTt0aGlzLmRyYWdQYW4mJnRoaXMuZHJhZ1Bhbi5kZXN0cm95KCk7dGhpcy5kcmFnUGFuPW51bGw7dGhpcy5waW5jaFpvb20mJih0aGlzLnBpbmNoWm9vbS5kZXN0cm95KCksZGVsZXRlIHRoaXMucGluY2hab29tKTtPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmRlc3Ryb3kuYXBwbHkodGhpcyxcbmFyZ3VtZW50cyl9LGFjdGl2YXRlOmZ1bmN0aW9uKCl7cmV0dXJuIE9wZW5MYXllcnMuQ29udHJvbC5wcm90b3R5cGUuYWN0aXZhdGUuYXBwbHkodGhpcyxhcmd1bWVudHMpPyh0aGlzLmRyYWdQYW4uYWN0aXZhdGUoKSx0aGlzLmhhbmRsZXJzLmNsaWNrLmFjdGl2YXRlKCksdGhpcy5waW5jaFpvb20uYWN0aXZhdGUoKSwhMCk6ITF9LGRlYWN0aXZhdGU6ZnVuY3Rpb24oKXtyZXR1cm4gT3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5kZWFjdGl2YXRlLmFwcGx5KHRoaXMsYXJndW1lbnRzKT8odGhpcy5kcmFnUGFuLmRlYWN0aXZhdGUoKSx0aGlzLmhhbmRsZXJzLmNsaWNrLmRlYWN0aXZhdGUoKSx0aGlzLnBpbmNoWm9vbS5kZWFjdGl2YXRlKCksITApOiExfSxkcmF3OmZ1bmN0aW9uKCl7dmFyIGE9e2NsaWNrOnRoaXMuZGVmYXVsdENsaWNrLGRibGNsaWNrOnRoaXMuZGVmYXVsdERibENsaWNrfSxiPU9wZW5MYXllcnMuVXRpbC5leHRlbmQoe1wiZG91YmxlXCI6ITAsc3RvcERvdWJsZTohMCxcbnBpeGVsVG9sZXJhbmNlOjJ9LHRoaXMuY2xpY2tIYW5kbGVyT3B0aW9ucyk7dGhpcy5oYW5kbGVycy5jbGljaz1uZXcgT3BlbkxheWVycy5IYW5kbGVyLkNsaWNrKHRoaXMsYSxiKTt0aGlzLmRyYWdQYW49bmV3IE9wZW5MYXllcnMuQ29udHJvbC5EcmFnUGFuKE9wZW5MYXllcnMuVXRpbC5leHRlbmQoe21hcDp0aGlzLm1hcCxkb2N1bWVudERyYWc6dGhpcy5kb2N1bWVudERyYWd9LHRoaXMuZHJhZ1Bhbk9wdGlvbnMpKTt0aGlzLmRyYWdQYW4uZHJhdygpO3RoaXMucGluY2hab29tPW5ldyBPcGVuTGF5ZXJzLkNvbnRyb2wuUGluY2hab29tKE9wZW5MYXllcnMuVXRpbC5leHRlbmQoe21hcDp0aGlzLm1hcH0sdGhpcy5waW5jaFpvb21PcHRpb25zKSl9LGRlZmF1bHRDbGljazpmdW5jdGlvbihhKXthLmxhc3RUb3VjaGVzJiYyPT1hLmxhc3RUb3VjaGVzLmxlbmd0aCYmdGhpcy5tYXAuem9vbU91dCgpfSxkZWZhdWx0RGJsQ2xpY2s6ZnVuY3Rpb24oYSl7dGhpcy5tYXAuc2V0Q2VudGVyKHRoaXMubWFwLmdldExvbkxhdEZyb21WaWV3UG9ydFB4KGEueHkpLFxudGhpcy5tYXAuem9vbSsxKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuQ29udHJvbC5Ub3VjaE5hdmlnYXRpb25cIn0pO09wZW5MYXllcnMuU3R5bGUyPU9wZW5MYXllcnMuQ2xhc3Moe2lkOm51bGwsbmFtZTpudWxsLHRpdGxlOm51bGwsZGVzY3JpcHRpb246bnVsbCxsYXllck5hbWU6bnVsbCxpc0RlZmF1bHQ6ITEscnVsZXM6bnVsbCxpbml0aWFsaXplOmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuVXRpbC5leHRlbmQodGhpcyxhKTt0aGlzLmlkPU9wZW5MYXllcnMuVXRpbC5jcmVhdGVVbmlxdWVJRCh0aGlzLkNMQVNTX05BTUUrXCJfXCIpfSxkZXN0cm95OmZ1bmN0aW9uKCl7Zm9yKHZhciBhPTAsYj10aGlzLnJ1bGVzLmxlbmd0aDthPGI7YSsrKXRoaXMucnVsZXNbYV0uZGVzdHJveSgpO2RlbGV0ZSB0aGlzLnJ1bGVzfSxjbG9uZTpmdW5jdGlvbigpe3ZhciBhPU9wZW5MYXllcnMuVXRpbC5leHRlbmQoe30sdGhpcyk7aWYodGhpcy5ydWxlcyl7YS5ydWxlcz1bXTtmb3IodmFyIGI9MCxjPXRoaXMucnVsZXMubGVuZ3RoO2I8YzsrK2IpYS5ydWxlcy5wdXNoKHRoaXMucnVsZXNbYl0uY2xvbmUoKSl9cmV0dXJuIG5ldyBPcGVuTGF5ZXJzLlN0eWxlMihhKX0sXG5DTEFTU19OQU1FOlwiT3BlbkxheWVycy5TdHlsZTJcIn0pO09wZW5MYXllcnMuRm9ybWF0LldGUz1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuRm9ybWF0LkdNTCx7bGF5ZXI6bnVsbCx3ZnNuczpcImh0dHA6Ly93d3cub3Blbmdpcy5uZXQvd2ZzXCIsb2djbnM6XCJodHRwOi8vd3d3Lm9wZW5naXMubmV0L29nY1wiLGluaXRpYWxpemU6ZnVuY3Rpb24oYSxiKXtPcGVuTGF5ZXJzLkZvcm1hdC5HTUwucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbYV0pO3RoaXMubGF5ZXI9Yjt0aGlzLmxheWVyLmZlYXR1cmVOUyYmKHRoaXMuZmVhdHVyZU5TPXRoaXMubGF5ZXIuZmVhdHVyZU5TKTt0aGlzLmxheWVyLm9wdGlvbnMuZ2VvbWV0cnlfY29sdW1uJiYodGhpcy5nZW9tZXRyeU5hbWU9dGhpcy5sYXllci5vcHRpb25zLmdlb21ldHJ5X2NvbHVtbik7dGhpcy5sYXllci5vcHRpb25zLnR5cGVuYW1lJiYodGhpcy5mZWF0dXJlTmFtZT10aGlzLmxheWVyLm9wdGlvbnMudHlwZW5hbWUpfSx3cml0ZTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROUyh0aGlzLndmc25zLFxuXCJ3ZnM6VHJhbnNhY3Rpb25cIik7Yi5zZXRBdHRyaWJ1dGUoXCJ2ZXJzaW9uXCIsXCIxLjAuMFwiKTtiLnNldEF0dHJpYnV0ZShcInNlcnZpY2VcIixcIldGU1wiKTtmb3IodmFyIGM9MDtjPGEubGVuZ3RoO2MrKylzd2l0Y2goYVtjXS5zdGF0ZSl7Y2FzZSBPcGVuTGF5ZXJzLlN0YXRlLklOU0VSVDpiLmFwcGVuZENoaWxkKHRoaXMuaW5zZXJ0KGFbY10pKTticmVhaztjYXNlIE9wZW5MYXllcnMuU3RhdGUuVVBEQVRFOmIuYXBwZW5kQ2hpbGQodGhpcy51cGRhdGUoYVtjXSkpO2JyZWFrO2Nhc2UgT3BlbkxheWVycy5TdGF0ZS5ERUxFVEU6Yi5hcHBlbmRDaGlsZCh0aGlzLnJlbW92ZShhW2NdKSl9cmV0dXJuIE9wZW5MYXllcnMuRm9ybWF0LlhNTC5wcm90b3R5cGUud3JpdGUuYXBwbHkodGhpcyxbYl0pfSxjcmVhdGVGZWF0dXJlWE1MOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuYnVpbGRHZW9tZXRyeU5vZGUoYS5nZW9tZXRyeSksYz10aGlzLmNyZWF0ZUVsZW1lbnROUyh0aGlzLmZlYXR1cmVOUyxcImZlYXR1cmU6XCIrXG50aGlzLmdlb21ldHJ5TmFtZSk7Yy5hcHBlbmRDaGlsZChiKTtiPXRoaXMuY3JlYXRlRWxlbWVudE5TKHRoaXMuZmVhdHVyZU5TLFwiZmVhdHVyZTpcIit0aGlzLmZlYXR1cmVOYW1lKTtiLmFwcGVuZENoaWxkKGMpO2Zvcih2YXIgZCBpbiBhLmF0dHJpYnV0ZXMpe3ZhciBjPXRoaXMuY3JlYXRlVGV4dE5vZGUoYS5hdHRyaWJ1dGVzW2RdKSxlPWQ7LTEhPWQuc2VhcmNoKFwiOlwiKSYmKGU9ZC5zcGxpdChcIjpcIilbMV0pO2U9dGhpcy5jcmVhdGVFbGVtZW50TlModGhpcy5mZWF0dXJlTlMsXCJmZWF0dXJlOlwiK2UpO2UuYXBwZW5kQ2hpbGQoYyk7Yi5hcHBlbmRDaGlsZChlKX1yZXR1cm4gYn0saW5zZXJ0OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TKHRoaXMud2ZzbnMsXCJ3ZnM6SW5zZXJ0XCIpO2IuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVGZWF0dXJlWE1MKGEpKTtyZXR1cm4gYn0sdXBkYXRlOmZ1bmN0aW9uKGEpe2EuZmlkfHxPcGVuTGF5ZXJzLkNvbnNvbGUudXNlckVycm9yKE9wZW5MYXllcnMuaTE4bihcIm5vRklEXCIpKTtcbnZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TKHRoaXMud2ZzbnMsXCJ3ZnM6VXBkYXRlXCIpO2Iuc2V0QXR0cmlidXRlKFwidHlwZU5hbWVcIix0aGlzLmZlYXR1cmVQcmVmaXgrXCI6XCIrdGhpcy5mZWF0dXJlTmFtZSk7Yi5zZXRBdHRyaWJ1dGUoXCJ4bWxuczpcIit0aGlzLmZlYXR1cmVQcmVmaXgsdGhpcy5mZWF0dXJlTlMpO3ZhciBjPXRoaXMuY3JlYXRlRWxlbWVudE5TKHRoaXMud2ZzbnMsXCJ3ZnM6UHJvcGVydHlcIiksZD10aGlzLmNyZWF0ZUVsZW1lbnROUyh0aGlzLndmc25zLFwid2ZzOk5hbWVcIiksZT10aGlzLmNyZWF0ZVRleHROb2RlKHRoaXMuZ2VvbWV0cnlOYW1lKTtkLmFwcGVuZENoaWxkKGUpO2MuYXBwZW5kQ2hpbGQoZCk7ZD10aGlzLmNyZWF0ZUVsZW1lbnROUyh0aGlzLndmc25zLFwid2ZzOlZhbHVlXCIpO2U9dGhpcy5idWlsZEdlb21ldHJ5Tm9kZShhLmdlb21ldHJ5KTthLmxheWVyJiZlLnNldEF0dHJpYnV0ZShcInNyc05hbWVcIixhLmxheWVyLnByb2plY3Rpb24uZ2V0Q29kZSgpKTtcbmQuYXBwZW5kQ2hpbGQoZSk7Yy5hcHBlbmRDaGlsZChkKTtiLmFwcGVuZENoaWxkKGMpO2Zvcih2YXIgZiBpbiBhLmF0dHJpYnV0ZXMpYz10aGlzLmNyZWF0ZUVsZW1lbnROUyh0aGlzLndmc25zLFwid2ZzOlByb3BlcnR5XCIpLGQ9dGhpcy5jcmVhdGVFbGVtZW50TlModGhpcy53ZnNucyxcIndmczpOYW1lXCIpLGQuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVUZXh0Tm9kZShmKSksYy5hcHBlbmRDaGlsZChkKSxkPXRoaXMuY3JlYXRlRWxlbWVudE5TKHRoaXMud2ZzbnMsXCJ3ZnM6VmFsdWVcIiksZC5hcHBlbmRDaGlsZCh0aGlzLmNyZWF0ZVRleHROb2RlKGEuYXR0cmlidXRlc1tmXSkpLGMuYXBwZW5kQ2hpbGQoZCksYi5hcHBlbmRDaGlsZChjKTtjPXRoaXMuY3JlYXRlRWxlbWVudE5TKHRoaXMub2djbnMsXCJvZ2M6RmlsdGVyXCIpO2Y9dGhpcy5jcmVhdGVFbGVtZW50TlModGhpcy5vZ2NucyxcIm9nYzpGZWF0dXJlSWRcIik7Zi5zZXRBdHRyaWJ1dGUoXCJmaWRcIixhLmZpZCk7Yy5hcHBlbmRDaGlsZChmKTtcbmIuYXBwZW5kQ2hpbGQoYyk7cmV0dXJuIGJ9LHJlbW92ZTpmdW5jdGlvbihhKXtpZighYS5maWQpcmV0dXJuIE9wZW5MYXllcnMuQ29uc29sZS51c2VyRXJyb3IoT3BlbkxheWVycy5pMThuKFwibm9GSURcIikpLCExO3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TKHRoaXMud2ZzbnMsXCJ3ZnM6RGVsZXRlXCIpO2Iuc2V0QXR0cmlidXRlKFwidHlwZU5hbWVcIix0aGlzLmZlYXR1cmVQcmVmaXgrXCI6XCIrdGhpcy5mZWF0dXJlTmFtZSk7Yi5zZXRBdHRyaWJ1dGUoXCJ4bWxuczpcIit0aGlzLmZlYXR1cmVQcmVmaXgsdGhpcy5mZWF0dXJlTlMpO3ZhciBjPXRoaXMuY3JlYXRlRWxlbWVudE5TKHRoaXMub2djbnMsXCJvZ2M6RmlsdGVyXCIpLGQ9dGhpcy5jcmVhdGVFbGVtZW50TlModGhpcy5vZ2NucyxcIm9nYzpGZWF0dXJlSWRcIik7ZC5zZXRBdHRyaWJ1dGUoXCJmaWRcIixhLmZpZCk7Yy5hcHBlbmRDaGlsZChkKTtiLmFwcGVuZENoaWxkKGMpO3JldHVybiBifSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5sYXllcj1cbm51bGx9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZvcm1hdC5XRlNcIn0pO09wZW5MYXllcnMuRm9ybWF0LlNMRC52MV8wXzBfR2VvU2VydmVyPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Gb3JtYXQuU0xELnYxXzBfMCx7dmVyc2lvbjpcIjEuMC4wXCIscHJvZmlsZTpcIkdlb1NlcnZlclwiLHJlYWRlcnM6T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoe3NsZDpPcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyh7UHJpb3JpdHk6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLnJlYWRlcnMub2djLl9leHByZXNzaW9uLmNhbGwodGhpcyxhKTtjJiYoYi5wcmlvcml0eT1jKX0sVmVuZG9yT3B0aW9uOmZ1bmN0aW9uKGEsYil7Yi52ZW5kb3JPcHRpb25zfHwoYi52ZW5kb3JPcHRpb25zPXt9KTtiLnZlbmRvck9wdGlvbnNbYS5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpXT10aGlzLmdldENoaWxkVmFsdWUoYSl9fSxPcGVuTGF5ZXJzLkZvcm1hdC5TTEQudjFfMF8wLnByb3RvdHlwZS5yZWFkZXJzLnNsZCl9LE9wZW5MYXllcnMuRm9ybWF0LlNMRC52MV8wXzAucHJvdG90eXBlLnJlYWRlcnMpLFxud3JpdGVyczpPcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyh7c2xkOk9wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKHtQcmlvcml0eTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy53cml0ZXJzLnNsZC5fT0dDRXhwcmVzc2lvbi5jYWxsKHRoaXMsXCJzbGQ6UHJpb3JpdHlcIixhKX0sVmVuZG9yT3B0aW9uOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJzbGQ6VmVuZG9yT3B0aW9uXCIse2F0dHJpYnV0ZXM6e25hbWU6YS5uYW1lfSx2YWx1ZTphLnZhbHVlfSl9LFRleHRTeW1ib2xpemVyOmZ1bmN0aW9uKGEpe3ZhciBiPU9wZW5MYXllcnMuRm9ybWF0LlNMRC52MV8wXzAucHJvdG90eXBlLndyaXRlcnMuc2xkLlRleHRTeW1ib2xpemVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTshMSE9PWEuZ3JhcGhpYyYmKGEuZXh0ZXJuYWxHcmFwaGljfHxhLmdyYXBoaWNOYW1lKSYmdGhpcy53cml0ZU5vZGUoXCJHcmFwaGljXCIsYSxiKTtcInByaW9yaXR5XCJpbiBhJiZcbnRoaXMud3JpdGVOb2RlKFwiUHJpb3JpdHlcIixhLnByaW9yaXR5LGIpO3JldHVybiB0aGlzLmFkZFZlbmRvck9wdGlvbnMoYixhKX0sUG9pbnRTeW1ib2xpemVyOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmFkZFZlbmRvck9wdGlvbnMoT3BlbkxheWVycy5Gb3JtYXQuU0xELnYxXzBfMC5wcm90b3R5cGUud3JpdGVycy5zbGQuUG9pbnRTeW1ib2xpemVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKSxhKX0sTGluZVN5bWJvbGl6ZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuYWRkVmVuZG9yT3B0aW9ucyhPcGVuTGF5ZXJzLkZvcm1hdC5TTEQudjFfMF8wLnByb3RvdHlwZS53cml0ZXJzLnNsZC5MaW5lU3ltYm9saXplci5hcHBseSh0aGlzLGFyZ3VtZW50cyksYSl9LFBvbHlnb25TeW1ib2xpemVyOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmFkZFZlbmRvck9wdGlvbnMoT3BlbkxheWVycy5Gb3JtYXQuU0xELnYxXzBfMC5wcm90b3R5cGUud3JpdGVycy5zbGQuUG9seWdvblN5bWJvbGl6ZXIuYXBwbHkodGhpcyxcbmFyZ3VtZW50cyksYSl9fSxPcGVuTGF5ZXJzLkZvcm1hdC5TTEQudjFfMF8wLnByb3RvdHlwZS53cml0ZXJzLnNsZCl9LE9wZW5MYXllcnMuRm9ybWF0LlNMRC52MV8wXzAucHJvdG90eXBlLndyaXRlcnMpLGFkZFZlbmRvck9wdGlvbnM6ZnVuY3Rpb24oYSxiKXtpZihiLnZlbmRvck9wdGlvbnMpZm9yKHZhciBjIGluIGIudmVuZG9yT3B0aW9ucyl0aGlzLndyaXRlTm9kZShcIlZlbmRvck9wdGlvblwiLHtuYW1lOmMsdmFsdWU6Yi52ZW5kb3JPcHRpb25zW2NdfSxhKTtyZXR1cm4gYX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuRm9ybWF0LlNMRC52MV8wXzBfR2VvU2VydmVyXCJ9KTtPcGVuTGF5ZXJzLkxheWVyLkJveGVzPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5MYXllci5NYXJrZXJzLHtkcmF3TWFya2VyOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMubWFwLmdldExheWVyUHhGcm9tTG9uTGF0KHtsb246YS5ib3VuZHMubGVmdCxsYXQ6YS5ib3VuZHMudG9wfSksYz10aGlzLm1hcC5nZXRMYXllclB4RnJvbUxvbkxhdCh7bG9uOmEuYm91bmRzLnJpZ2h0LGxhdDphLmJvdW5kcy5ib3R0b219KTtudWxsPT1jfHxudWxsPT1iP2EuZGlzcGxheSghMSk6KGI9YS5kcmF3KGIse3c6TWF0aC5tYXgoMSxjLngtYi54KSxoOk1hdGgubWF4KDEsYy55LWIueSl9KSxhLmRyYXdufHwodGhpcy5kaXYuYXBwZW5kQ2hpbGQoYiksYS5kcmF3bj0hMCkpfSxyZW1vdmVNYXJrZXI6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5VdGlsLnJlbW92ZUl0ZW0odGhpcy5tYXJrZXJzLGEpO251bGwhPWEuZGl2JiZhLmRpdi5wYXJlbnROb2RlPT10aGlzLmRpdiYmdGhpcy5kaXYucmVtb3ZlQ2hpbGQoYS5kaXYpfSxcbkNMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkxheWVyLkJveGVzXCJ9KTtPcGVuTGF5ZXJzLkZvcm1hdC5XRlNDYXBhYmlsaXRpZXMudjFfMF8wPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Gb3JtYXQuV0ZTQ2FwYWJpbGl0aWVzLnYxLHtyZWFkZXJzOnt3ZnM6T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoe1NlcnZpY2U6ZnVuY3Rpb24oYSxiKXtiLnNlcnZpY2U9e307dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIuc2VydmljZSl9LEZlZXM6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmdldENoaWxkVmFsdWUoYSk7YyYmXCJub25lXCIhPWMudG9Mb3dlckNhc2UoKSYmKGIuZmVlcz1jKX0sQWNjZXNzQ29uc3RyYWludHM6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmdldENoaWxkVmFsdWUoYSk7YyYmXCJub25lXCIhPWMudG9Mb3dlckNhc2UoKSYmKGIuYWNjZXNzQ29uc3RyYWludHM9Yyl9LE9ubGluZVJlc291cmNlOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5nZXRDaGlsZFZhbHVlKGEpO2MmJlwibm9uZVwiIT1jLnRvTG93ZXJDYXNlKCkmJihiLm9ubGluZVJlc291cmNlPVxuYyl9LEtleXdvcmRzOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5nZXRDaGlsZFZhbHVlKGEpO2MmJlwibm9uZVwiIT1jLnRvTG93ZXJDYXNlKCkmJihiLmtleXdvcmRzPWMuc3BsaXQoXCIsIFwiKSl9LENhcGFiaWxpdHk6ZnVuY3Rpb24oYSxiKXtiLmNhcGFiaWxpdHk9e307dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIuY2FwYWJpbGl0eSl9LFJlcXVlc3Q6ZnVuY3Rpb24oYSxiKXtiLnJlcXVlc3Q9e307dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIucmVxdWVzdCl9LEdldEZlYXR1cmU6ZnVuY3Rpb24oYSxiKXtiLmdldGZlYXR1cmU9e2hyZWY6e30sZm9ybWF0czpbXX07dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIuZ2V0ZmVhdHVyZSl9LFJlc3VsdEZvcm1hdDpmdW5jdGlvbihhLGIpe2Zvcih2YXIgYz1hLmNoaWxkTm9kZXMsZCxlPTA7ZTxjLmxlbmd0aDtlKyspZD1jW2VdLDE9PWQubm9kZVR5cGUmJmIuZm9ybWF0cy5wdXNoKGQubm9kZU5hbWUpfSxEQ1BUeXBlOmZ1bmN0aW9uKGEsYil7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLFxuYil9LEhUVFA6ZnVuY3Rpb24oYSxiKXt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYi5ocmVmKX0sR2V0OmZ1bmN0aW9uKGEsYil7Yi5nZXQ9YS5nZXRBdHRyaWJ1dGUoXCJvbmxpbmVSZXNvdXJjZVwiKX0sUG9zdDpmdW5jdGlvbihhLGIpe2IucG9zdD1hLmdldEF0dHJpYnV0ZShcIm9ubGluZVJlc291cmNlXCIpfSxTUlM6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmdldENoaWxkVmFsdWUoYSk7YyYmKGIuc3JzPWMpfX0sT3BlbkxheWVycy5Gb3JtYXQuV0ZTQ2FwYWJpbGl0aWVzLnYxLnByb3RvdHlwZS5yZWFkZXJzLndmcyl9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZvcm1hdC5XRlNDYXBhYmlsaXRpZXMudjFfMF8wXCJ9KTtPcGVuTGF5ZXJzLkZvcm1hdC5XTVNDYXBhYmlsaXRpZXM9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkZvcm1hdC5YTUwuVmVyc2lvbmVkT0dDLHtkZWZhdWx0VmVyc2lvbjpcIjEuMS4xXCIscHJvZmlsZTpudWxsLENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZvcm1hdC5XTVNDYXBhYmlsaXRpZXNcIn0pO09wZW5MYXllcnMuRm9ybWF0LldNU0NhcGFiaWxpdGllcy52MT1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuRm9ybWF0LlhNTCx7bmFtZXNwYWNlczp7d21zOlwiaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC93bXNcIix4bGluazpcImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmtcIix4c2k6XCJodHRwOi8vd3d3LnczLm9yZy8yMDAxL1hNTFNjaGVtYS1pbnN0YW5jZVwifSxkZWZhdWx0UHJlZml4Olwid21zXCIscmVhZDpmdW5jdGlvbihhKXtcInN0cmluZ1wiPT10eXBlb2YgYSYmKGE9T3BlbkxheWVycy5Gb3JtYXQuWE1MLnByb3RvdHlwZS5yZWFkLmFwcGx5KHRoaXMsW2FdKSk7dmFyIGI9YTthJiY5PT1hLm5vZGVUeXBlJiYoYT1hLmRvY3VtZW50RWxlbWVudCk7dmFyIGM9e307dGhpcy5yZWFkTm9kZShhLGMpO3ZvaWQgMD09PWMuc2VydmljZSYmKGE9bmV3IE9wZW5MYXllcnMuRm9ybWF0Lk9HQ0V4Y2VwdGlvblJlcG9ydCxjLmVycm9yPWEucmVhZChiKSk7cmV0dXJuIGN9LHJlYWRlcnM6e3dtczp7U2VydmljZTpmdW5jdGlvbihhLFxuYil7Yi5zZXJ2aWNlPXt9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxiLnNlcnZpY2UpfSxOYW1lOmZ1bmN0aW9uKGEsYil7Yi5uYW1lPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKX0sVGl0bGU6ZnVuY3Rpb24oYSxiKXtiLnRpdGxlPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKX0sQWJzdHJhY3Q6ZnVuY3Rpb24oYSxiKXtiW1wiYWJzdHJhY3RcIl09dGhpcy5nZXRDaGlsZFZhbHVlKGEpfSxCb3VuZGluZ0JveDpmdW5jdGlvbihhKXt2YXIgYj17fTtiLmJib3g9W3BhcnNlRmxvYXQoYS5nZXRBdHRyaWJ1dGUoXCJtaW54XCIpKSxwYXJzZUZsb2F0KGEuZ2V0QXR0cmlidXRlKFwibWlueVwiKSkscGFyc2VGbG9hdChhLmdldEF0dHJpYnV0ZShcIm1heHhcIikpLHBhcnNlRmxvYXQoYS5nZXRBdHRyaWJ1dGUoXCJtYXh5XCIpKV07YT17eDpwYXJzZUZsb2F0KGEuZ2V0QXR0cmlidXRlKFwicmVzeFwiKSkseTpwYXJzZUZsb2F0KGEuZ2V0QXR0cmlidXRlKFwicmVzeVwiKSl9O2lmKCFpc05hTihhLngpfHwhaXNOYU4oYS55KSliLnJlcz1cbmE7cmV0dXJuIGJ9LE9ubGluZVJlc291cmNlOmZ1bmN0aW9uKGEsYil7Yi5ocmVmPXRoaXMuZ2V0QXR0cmlidXRlTlMoYSx0aGlzLm5hbWVzcGFjZXMueGxpbmssXCJocmVmXCIpfSxDb250YWN0SW5mb3JtYXRpb246ZnVuY3Rpb24oYSxiKXtiLmNvbnRhY3RJbmZvcm1hdGlvbj17fTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYi5jb250YWN0SW5mb3JtYXRpb24pfSxDb250YWN0UGVyc29uUHJpbWFyeTpmdW5jdGlvbihhLGIpe2IucGVyc29uUHJpbWFyeT17fTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYi5wZXJzb25QcmltYXJ5KX0sQ29udGFjdFBlcnNvbjpmdW5jdGlvbihhLGIpe2IucGVyc29uPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKX0sQ29udGFjdE9yZ2FuaXphdGlvbjpmdW5jdGlvbihhLGIpe2Iub3JnYW5pemF0aW9uPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKX0sQ29udGFjdFBvc2l0aW9uOmZ1bmN0aW9uKGEsYil7Yi5wb3NpdGlvbj10aGlzLmdldENoaWxkVmFsdWUoYSl9LENvbnRhY3RBZGRyZXNzOmZ1bmN0aW9uKGEsXG5iKXtiLmNvbnRhY3RBZGRyZXNzPXt9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxiLmNvbnRhY3RBZGRyZXNzKX0sQWRkcmVzc1R5cGU6ZnVuY3Rpb24oYSxiKXtiLnR5cGU9dGhpcy5nZXRDaGlsZFZhbHVlKGEpfSxBZGRyZXNzOmZ1bmN0aW9uKGEsYil7Yi5hZGRyZXNzPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKX0sQ2l0eTpmdW5jdGlvbihhLGIpe2IuY2l0eT10aGlzLmdldENoaWxkVmFsdWUoYSl9LFN0YXRlT3JQcm92aW5jZTpmdW5jdGlvbihhLGIpe2Iuc3RhdGVPclByb3ZpbmNlPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKX0sUG9zdENvZGU6ZnVuY3Rpb24oYSxiKXtiLnBvc3Rjb2RlPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKX0sQ291bnRyeTpmdW5jdGlvbihhLGIpe2IuY291bnRyeT10aGlzLmdldENoaWxkVmFsdWUoYSl9LENvbnRhY3RWb2ljZVRlbGVwaG9uZTpmdW5jdGlvbihhLGIpe2IucGhvbmU9dGhpcy5nZXRDaGlsZFZhbHVlKGEpfSxDb250YWN0RmFjc2ltaWxlVGVsZXBob25lOmZ1bmN0aW9uKGEsXG5iKXtiLmZheD10aGlzLmdldENoaWxkVmFsdWUoYSl9LENvbnRhY3RFbGVjdHJvbmljTWFpbEFkZHJlc3M6ZnVuY3Rpb24oYSxiKXtiLmVtYWlsPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKX0sRmVlczpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKTtjJiZcIm5vbmVcIiE9Yy50b0xvd2VyQ2FzZSgpJiYoYi5mZWVzPWMpfSxBY2Nlc3NDb25zdHJhaW50czpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKTtjJiZcIm5vbmVcIiE9Yy50b0xvd2VyQ2FzZSgpJiYoYi5hY2Nlc3NDb25zdHJhaW50cz1jKX0sQ2FwYWJpbGl0eTpmdW5jdGlvbihhLGIpe2IuY2FwYWJpbGl0eT17bmVzdGVkTGF5ZXJzOltdLGxheWVyczpbXX07dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIuY2FwYWJpbGl0eSl9LFJlcXVlc3Q6ZnVuY3Rpb24oYSxiKXtiLnJlcXVlc3Q9e307dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIucmVxdWVzdCl9LEdldENhcGFiaWxpdGllczpmdW5jdGlvbihhLFxuYil7Yi5nZXRjYXBhYmlsaXRpZXM9e2Zvcm1hdHM6W119O3RoaXMucmVhZENoaWxkTm9kZXMoYSxiLmdldGNhcGFiaWxpdGllcyl9LEZvcm1hdDpmdW5jdGlvbihhLGIpe09wZW5MYXllcnMuVXRpbC5pc0FycmF5KGIuZm9ybWF0cyk/Yi5mb3JtYXRzLnB1c2godGhpcy5nZXRDaGlsZFZhbHVlKGEpKTpiLmZvcm1hdD10aGlzLmdldENoaWxkVmFsdWUoYSl9LERDUFR5cGU6ZnVuY3Rpb24oYSxiKXt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYil9LEhUVFA6ZnVuY3Rpb24oYSxiKXt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYil9LEdldDpmdW5jdGlvbihhLGIpe2IuZ2V0PXt9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxiLmdldCk7Yi5ocmVmfHwoYi5ocmVmPWIuZ2V0LmhyZWYpfSxQb3N0OmZ1bmN0aW9uKGEsYil7Yi5wb3N0PXt9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxiLnBvc3QpO2IuaHJlZnx8KGIuaHJlZj1iLmdldC5ocmVmKX0sR2V0TWFwOmZ1bmN0aW9uKGEsYil7Yi5nZXRtYXA9e2Zvcm1hdHM6W119O1xudGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIuZ2V0bWFwKX0sR2V0RmVhdHVyZUluZm86ZnVuY3Rpb24oYSxiKXtiLmdldGZlYXR1cmVpbmZvPXtmb3JtYXRzOltdfTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYi5nZXRmZWF0dXJlaW5mbyl9LEV4Y2VwdGlvbjpmdW5jdGlvbihhLGIpe2IuZXhjZXB0aW9uPXtmb3JtYXRzOltdfTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYi5leGNlcHRpb24pfSxMYXllcjpmdW5jdGlvbihhLGIpe3ZhciBjLGQ7Yi5jYXBhYmlsaXR5PyhkPWIuY2FwYWJpbGl0eSxjPWIpOmQ9Yjt2YXIgZT1hLmdldEF0dHJpYnV0ZU5vZGUoXCJxdWVyeWFibGVcIiksZj1lJiZlLnNwZWNpZmllZD9hLmdldEF0dHJpYnV0ZShcInF1ZXJ5YWJsZVwiKTpudWxsLGc9KGU9YS5nZXRBdHRyaWJ1dGVOb2RlKFwiY2FzY2FkZWRcIikpJiZlLnNwZWNpZmllZD9hLmdldEF0dHJpYnV0ZShcImNhc2NhZGVkXCIpOm51bGwsZT0oZT1hLmdldEF0dHJpYnV0ZU5vZGUoXCJvcGFxdWVcIikpJiZlLnNwZWNpZmllZD9cbmEuZ2V0QXR0cmlidXRlKFwib3BhcXVlXCIpOm51bGwsaD1hLmdldEF0dHJpYnV0ZShcIm5vU3Vic2V0c1wiKSxpPWEuZ2V0QXR0cmlidXRlKFwiZml4ZWRXaWR0aFwiKSxqPWEuZ2V0QXR0cmlidXRlKFwiZml4ZWRIZWlnaHRcIiksaz1jfHx7fSxsPU9wZW5MYXllcnMuVXRpbC5leHRlbmQ7Yz17bmVzdGVkTGF5ZXJzOltdLHN0eWxlczpjP1tdLmNvbmNhdChjLnN0eWxlcyk6W10sc3JzOmM/bCh7fSxrLnNycyk6e30sbWV0YWRhdGFVUkxzOltdLGJib3g6Yz9sKHt9LGsuYmJveCk6e30sbGxiYm94OmsubGxiYm94LGRpbWVuc2lvbnM6Yz9sKHt9LGsuZGltZW5zaW9ucyk6e30sYXV0aG9yaXR5VVJMczpjP2woe30say5hdXRob3JpdHlVUkxzKTp7fSxpZGVudGlmaWVyczp7fSxrZXl3b3JkczpbXSxxdWVyeWFibGU6ZiYmXCJcIiE9PWY/XCIxXCI9PT1mfHxcInRydWVcIj09PWY6ay5xdWVyeWFibGV8fCExLGNhc2NhZGVkOm51bGwhPT1nP3BhcnNlSW50KGcpOmsuY2FzY2FkZWR8fDAsb3BhcXVlOmU/XCIxXCI9PT1cbmV8fFwidHJ1ZVwiPT09ZTprLm9wYXF1ZXx8ITEsbm9TdWJzZXRzOm51bGwhPT1oP1wiMVwiPT09aHx8XCJ0cnVlXCI9PT1oOmsubm9TdWJzZXRzfHwhMSxmaXhlZFdpZHRoOm51bGwhPWk/cGFyc2VJbnQoaSk6ay5maXhlZFdpZHRofHwwLGZpeGVkSGVpZ2h0Om51bGwhPWo/cGFyc2VJbnQoaik6ay5maXhlZEhlaWdodHx8MCxtaW5TY2FsZTprLm1pblNjYWxlLG1heFNjYWxlOmsubWF4U2NhbGUsYXR0cmlidXRpb246ay5hdHRyaWJ1dGlvbn07Yi5uZXN0ZWRMYXllcnMucHVzaChjKTtjLmNhcGFiaWxpdHk9ZDt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYyk7ZGVsZXRlIGMuY2FwYWJpbGl0eTtpZihjLm5hbWUmJihmPWMubmFtZS5zcGxpdChcIjpcIiksZz1kLnJlcXVlc3QsZT1nLmdldGZlYXR1cmVpbmZvLDA8Zi5sZW5ndGgmJihjLnByZWZpeD1mWzBdKSxkLmxheWVycy5wdXNoKGMpLHZvaWQgMD09PWMuZm9ybWF0cyYmKGMuZm9ybWF0cz1nLmdldG1hcC5mb3JtYXRzKSx2b2lkIDA9PT1jLmluZm9Gb3JtYXRzJiZcbmUpKWMuaW5mb0Zvcm1hdHM9ZS5mb3JtYXRzfSxBdHRyaWJ1dGlvbjpmdW5jdGlvbihhLGIpe2IuYXR0cmlidXRpb249e307dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIuYXR0cmlidXRpb24pfSxMb2dvVVJMOmZ1bmN0aW9uKGEsYil7Yi5sb2dvPXt3aWR0aDphLmdldEF0dHJpYnV0ZShcIndpZHRoXCIpLGhlaWdodDphLmdldEF0dHJpYnV0ZShcImhlaWdodFwiKX07dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIubG9nbyl9LFN0eWxlOmZ1bmN0aW9uKGEsYil7dmFyIGM9e307Yi5zdHlsZXMucHVzaChjKTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYyl9LExlZ2VuZFVSTDpmdW5jdGlvbihhLGIpe3ZhciBjPXt3aWR0aDphLmdldEF0dHJpYnV0ZShcIndpZHRoXCIpLGhlaWdodDphLmdldEF0dHJpYnV0ZShcImhlaWdodFwiKX07Yi5sZWdlbmQ9Yzt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYyl9LE1ldGFkYXRhVVJMOmZ1bmN0aW9uKGEsYil7dmFyIGM9e3R5cGU6YS5nZXRBdHRyaWJ1dGUoXCJ0eXBlXCIpfTtiLm1ldGFkYXRhVVJMcy5wdXNoKGMpO1xudGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpfSxEYXRhVVJMOmZ1bmN0aW9uKGEsYil7Yi5kYXRhVVJMPXt9O3RoaXMucmVhZENoaWxkTm9kZXMoYSxiLmRhdGFVUkwpfSxGZWF0dXJlTGlzdFVSTDpmdW5jdGlvbihhLGIpe2IuZmVhdHVyZUxpc3RVUkw9e307dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIuZmVhdHVyZUxpc3RVUkwpfSxBdXRob3JpdHlVUkw6ZnVuY3Rpb24oYSxiKXt2YXIgYz1hLmdldEF0dHJpYnV0ZShcIm5hbWVcIiksZD17fTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsZCk7Yi5hdXRob3JpdHlVUkxzW2NdPWQuaHJlZn0sSWRlbnRpZmllcjpmdW5jdGlvbihhLGIpe3ZhciBjPWEuZ2V0QXR0cmlidXRlKFwiYXV0aG9yaXR5XCIpO2IuaWRlbnRpZmllcnNbY109dGhpcy5nZXRDaGlsZFZhbHVlKGEpfSxLZXl3b3JkTGlzdDpmdW5jdGlvbihhLGIpe3RoaXMucmVhZENoaWxkTm9kZXMoYSxiKX0sU1JTOmZ1bmN0aW9uKGEsYil7Yi5zcnNbdGhpcy5nZXRDaGlsZFZhbHVlKGEpXT0hMH19fSxcbkNMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZvcm1hdC5XTVNDYXBhYmlsaXRpZXMudjFcIn0pO09wZW5MYXllcnMuRm9ybWF0LldNU0NhcGFiaWxpdGllcy52MV8zPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Gb3JtYXQuV01TQ2FwYWJpbGl0aWVzLnYxLHtyZWFkZXJzOnt3bXM6T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoe1dNU19DYXBhYmlsaXRpZXM6ZnVuY3Rpb24oYSxiKXt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYil9LExheWVyTGltaXQ6ZnVuY3Rpb24oYSxiKXtiLmxheWVyTGltaXQ9cGFyc2VJbnQodGhpcy5nZXRDaGlsZFZhbHVlKGEpKX0sTWF4V2lkdGg6ZnVuY3Rpb24oYSxiKXtiLm1heFdpZHRoPXBhcnNlSW50KHRoaXMuZ2V0Q2hpbGRWYWx1ZShhKSl9LE1heEhlaWdodDpmdW5jdGlvbihhLGIpe2IubWF4SGVpZ2h0PXBhcnNlSW50KHRoaXMuZ2V0Q2hpbGRWYWx1ZShhKSl9LEJvdW5kaW5nQm94OmZ1bmN0aW9uKGEsYil7dmFyIGM9T3BlbkxheWVycy5Gb3JtYXQuV01TQ2FwYWJpbGl0aWVzLnYxLnByb3RvdHlwZS5yZWFkZXJzLndtcy5Cb3VuZGluZ0JveC5hcHBseSh0aGlzLFxuW2EsYl0pO2Muc3JzPWEuZ2V0QXR0cmlidXRlKFwiQ1JTXCIpO2IuYmJveFtjLnNyc109Y30sQ1JTOmZ1bmN0aW9uKGEsYil7dGhpcy5yZWFkZXJzLndtcy5TUlMuYXBwbHkodGhpcyxbYSxiXSl9LEVYX0dlb2dyYXBoaWNCb3VuZGluZ0JveDpmdW5jdGlvbihhLGIpe2IubGxiYm94PVtdO3RoaXMucmVhZENoaWxkTm9kZXMoYSxiLmxsYmJveCl9LHdlc3RCb3VuZExvbmdpdHVkZTpmdW5jdGlvbihhLGIpe2JbMF09dGhpcy5nZXRDaGlsZFZhbHVlKGEpfSxlYXN0Qm91bmRMb25naXR1ZGU6ZnVuY3Rpb24oYSxiKXtiWzJdPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKX0sc291dGhCb3VuZExhdGl0dWRlOmZ1bmN0aW9uKGEsYil7YlsxXT10aGlzLmdldENoaWxkVmFsdWUoYSl9LG5vcnRoQm91bmRMYXRpdHVkZTpmdW5jdGlvbihhLGIpe2JbM109dGhpcy5nZXRDaGlsZFZhbHVlKGEpfSxNaW5TY2FsZURlbm9taW5hdG9yOmZ1bmN0aW9uKGEsYil7Yi5tYXhTY2FsZT1wYXJzZUZsb2F0KHRoaXMuZ2V0Q2hpbGRWYWx1ZShhKSkudG9QcmVjaXNpb24oMTYpfSxcbk1heFNjYWxlRGVub21pbmF0b3I6ZnVuY3Rpb24oYSxiKXtiLm1pblNjYWxlPXBhcnNlRmxvYXQodGhpcy5nZXRDaGlsZFZhbHVlKGEpKS50b1ByZWNpc2lvbigxNil9LERpbWVuc2lvbjpmdW5jdGlvbihhLGIpe3ZhciBjPXtuYW1lOmEuZ2V0QXR0cmlidXRlKFwibmFtZVwiKS50b0xvd2VyQ2FzZSgpLHVuaXRzOmEuZ2V0QXR0cmlidXRlKFwidW5pdHNcIiksdW5pdHN5bWJvbDphLmdldEF0dHJpYnV0ZShcInVuaXRTeW1ib2xcIiksbmVhcmVzdFZhbDpcIjFcIj09PWEuZ2V0QXR0cmlidXRlKFwibmVhcmVzdFZhbHVlXCIpLG11bHRpcGxlVmFsOlwiMVwiPT09YS5nZXRBdHRyaWJ1dGUoXCJtdWx0aXBsZVZhbHVlc1wiKSxcImRlZmF1bHRcIjphLmdldEF0dHJpYnV0ZShcImRlZmF1bHRcIil8fFwiXCIsY3VycmVudDpcIjFcIj09PWEuZ2V0QXR0cmlidXRlKFwiY3VycmVudFwiKSx2YWx1ZXM6dGhpcy5nZXRDaGlsZFZhbHVlKGEpLnNwbGl0KFwiLFwiKX07Yi5kaW1lbnNpb25zW2MubmFtZV09Y30sS2V5d29yZDpmdW5jdGlvbihhLFxuYil7dmFyIGM9e3ZhbHVlOnRoaXMuZ2V0Q2hpbGRWYWx1ZShhKSx2b2NhYnVsYXJ5OmEuZ2V0QXR0cmlidXRlKFwidm9jYWJ1bGFyeVwiKX07Yi5rZXl3b3JkcyYmYi5rZXl3b3Jkcy5wdXNoKGMpfX0sT3BlbkxheWVycy5Gb3JtYXQuV01TQ2FwYWJpbGl0aWVzLnYxLnByb3RvdHlwZS5yZWFkZXJzLndtcyksc2xkOntVc2VyRGVmaW5lZFN5bWJvbGl6YXRpb246ZnVuY3Rpb24oYSxiKXt0aGlzLnJlYWRlcnMud21zLlVzZXJEZWZpbmVkU3ltYm9saXphdGlvbi5hcHBseSh0aGlzLFthLGJdKTtiLnVzZXJTeW1ib2xzLmlubGluZUZlYXR1cmU9MT09cGFyc2VJbnQoYS5nZXRBdHRyaWJ1dGUoXCJJbmxpbmVGZWF0dXJlXCIpKTtiLnVzZXJTeW1ib2xzLnJlbW90ZVdDUz0xPT1wYXJzZUludChhLmdldEF0dHJpYnV0ZShcIlJlbW90ZVdDU1wiKSl9LERlc2NyaWJlTGF5ZXI6ZnVuY3Rpb24oYSxiKXt0aGlzLnJlYWRlcnMud21zLkRlc2NyaWJlTGF5ZXIuYXBwbHkodGhpcyxbYSxiXSl9LEdldExlZ2VuZEdyYXBoaWM6ZnVuY3Rpb24oYSxcbmIpe3RoaXMucmVhZGVycy53bXMuR2V0TGVnZW5kR3JhcGhpYy5hcHBseSh0aGlzLFthLGJdKX19fSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Gb3JtYXQuV01TQ2FwYWJpbGl0aWVzLnYxXzNcIn0pO09wZW5MYXllcnMuTGF5ZXIuWm9vbWlmeT1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuTGF5ZXIuR3JpZCx7c2l6ZTpudWxsLGlzQmFzZUxheWVyOiEwLHN0YW5kYXJkVGlsZVNpemU6MjU2LHRpbGVPcmlnaW5Db3JuZXI6XCJ0bFwiLG51bWJlck9mVGllcnM6MCx0aWxlQ291bnRVcFRvVGllcjpudWxsLHRpZXJTaXplSW5UaWxlczpudWxsLHRpZXJJbWFnZVNpemU6bnVsbCxpbml0aWFsaXplOmZ1bmN0aW9uKGEsYixjLGQpe3RoaXMuaW5pdGlhbGl6ZVpvb21pZnkoYyk7T3BlbkxheWVycy5MYXllci5HcmlkLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsW2EsYixjLHt9LGRdKX0saW5pdGlhbGl6ZVpvb21pZnk6ZnVuY3Rpb24oYSl7dmFyIGE9YS5jbG9uZSgpLGI9bmV3IE9wZW5MYXllcnMuU2l6ZShNYXRoLmNlaWwoYS53L3RoaXMuc3RhbmRhcmRUaWxlU2l6ZSksTWF0aC5jZWlsKGEuaC90aGlzLnN0YW5kYXJkVGlsZVNpemUpKTt0aGlzLnRpZXJTaXplSW5UaWxlcz1bYl07XG5mb3IodGhpcy50aWVySW1hZ2VTaXplPVthXTthLnc+dGhpcy5zdGFuZGFyZFRpbGVTaXplfHxhLmg+dGhpcy5zdGFuZGFyZFRpbGVTaXplOylhPW5ldyBPcGVuTGF5ZXJzLlNpemUoTWF0aC5mbG9vcihhLncvMiksTWF0aC5mbG9vcihhLmgvMikpLGI9bmV3IE9wZW5MYXllcnMuU2l6ZShNYXRoLmNlaWwoYS53L3RoaXMuc3RhbmRhcmRUaWxlU2l6ZSksTWF0aC5jZWlsKGEuaC90aGlzLnN0YW5kYXJkVGlsZVNpemUpKSx0aGlzLnRpZXJTaXplSW5UaWxlcy5wdXNoKGIpLHRoaXMudGllckltYWdlU2l6ZS5wdXNoKGEpO3RoaXMudGllclNpemVJblRpbGVzLnJldmVyc2UoKTt0aGlzLnRpZXJJbWFnZVNpemUucmV2ZXJzZSgpO3RoaXMubnVtYmVyT2ZUaWVycz10aGlzLnRpZXJTaXplSW5UaWxlcy5sZW5ndGg7dGhpcy50aWxlQ291bnRVcFRvVGllcj1bMF07Zm9yKGE9MTthPHRoaXMubnVtYmVyT2ZUaWVyczthKyspdGhpcy50aWxlQ291bnRVcFRvVGllci5wdXNoKHRoaXMudGllclNpemVJblRpbGVzW2EtXG4xXS53KnRoaXMudGllclNpemVJblRpbGVzW2EtMV0uaCt0aGlzLnRpbGVDb3VudFVwVG9UaWVyW2EtMV0pfSxkZXN0cm95OmZ1bmN0aW9uKCl7T3BlbkxheWVycy5MYXllci5HcmlkLnByb3RvdHlwZS5kZXN0cm95LmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLnRpbGVDb3VudFVwVG9UaWVyLmxlbmd0aD0wO3RoaXMudGllclNpemVJblRpbGVzLmxlbmd0aD0wO3RoaXMudGllckltYWdlU2l6ZS5sZW5ndGg9MH0sY2xvbmU6ZnVuY3Rpb24oYSl7bnVsbD09YSYmKGE9bmV3IE9wZW5MYXllcnMuTGF5ZXIuWm9vbWlmeSh0aGlzLm5hbWUsdGhpcy51cmwsdGhpcy5zaXplLHRoaXMub3B0aW9ucykpO3JldHVybiBhPU9wZW5MYXllcnMuTGF5ZXIuR3JpZC5wcm90b3R5cGUuY2xvbmUuYXBwbHkodGhpcyxbYV0pfSxnZXRVUkw6ZnVuY3Rpb24oYSl7dmFyIGE9dGhpcy5hZGp1c3RCb3VuZHMoYSksYj10aGlzLm1hcC5nZXRSZXNvbHV0aW9uKCksYz1NYXRoLnJvdW5kKChhLmxlZnQtdGhpcy50aWxlT3JpZ2luLmxvbikvXG4oYip0aGlzLnRpbGVTaXplLncpKSxhPU1hdGgucm91bmQoKHRoaXMudGlsZU9yaWdpbi5sYXQtYS50b3ApLyhiKnRoaXMudGlsZVNpemUuaCkpLGI9dGhpcy5tYXAuZ2V0Wm9vbSgpLGM9XCJUaWxlR3JvdXBcIitNYXRoLmZsb29yKChjK2EqdGhpcy50aWVyU2l6ZUluVGlsZXNbYl0udyt0aGlzLnRpbGVDb3VudFVwVG9UaWVyW2JdKS8yNTYpK1wiL1wiK2IrXCItXCIrYytcIi1cIithK1wiLmpwZ1wiLGE9dGhpcy51cmw7T3BlbkxheWVycy5VdGlsLmlzQXJyYXkoYSkmJihhPXRoaXMuc2VsZWN0VXJsKGMsYSkpO3JldHVybiBhK2N9LGdldEltYWdlU2l6ZTpmdW5jdGlvbigpe2lmKDA8YXJndW1lbnRzLmxlbmd0aCl7dmFyIGE9dGhpcy5hZGp1c3RCb3VuZHMoYXJndW1lbnRzWzBdKSxiPXRoaXMubWFwLmdldFJlc29sdXRpb24oKSxjPU1hdGgucm91bmQoKGEubGVmdC10aGlzLnRpbGVPcmlnaW4ubG9uKS8oYip0aGlzLnRpbGVTaXplLncpKSxhPU1hdGgucm91bmQoKHRoaXMudGlsZU9yaWdpbi5sYXQtXG5hLnRvcCkvKGIqdGhpcy50aWxlU2l6ZS5oKSksYj10aGlzLm1hcC5nZXRab29tKCksZD10aGlzLnN0YW5kYXJkVGlsZVNpemUsZT10aGlzLnN0YW5kYXJkVGlsZVNpemU7Yz09dGhpcy50aWVyU2l6ZUluVGlsZXNbYl0udy0xJiYoZD10aGlzLnRpZXJJbWFnZVNpemVbYl0udyV0aGlzLnN0YW5kYXJkVGlsZVNpemUpO2E9PXRoaXMudGllclNpemVJblRpbGVzW2JdLmgtMSYmKGU9dGhpcy50aWVySW1hZ2VTaXplW2JdLmgldGhpcy5zdGFuZGFyZFRpbGVTaXplKTtyZXR1cm4gbmV3IE9wZW5MYXllcnMuU2l6ZShkLGUpfXJldHVybiB0aGlzLnRpbGVTaXplfSxzZXRNYXA6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5MYXllci5HcmlkLnByb3RvdHlwZS5zZXRNYXAuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMudGlsZU9yaWdpbj1uZXcgT3BlbkxheWVycy5Mb25MYXQodGhpcy5tYXAubWF4RXh0ZW50LmxlZnQsdGhpcy5tYXAubWF4RXh0ZW50LnRvcCl9LGNhbGN1bGF0ZUdyaWRMYXlvdXQ6ZnVuY3Rpb24oYSxcbmIsYyl7dmFyIGQ9Yyp0aGlzLnRpbGVTaXplLncsYz1jKnRoaXMudGlsZVNpemUuaCxlPWEubGVmdC1iLmxvbixmPU1hdGguZmxvb3IoZS9kKS10aGlzLmJ1ZmZlcixhPWIubGF0LWEudG9wK2MsZz1NYXRoLmZsb29yKGEvYyktdGhpcy5idWZmZXI7cmV0dXJue3RpbGVsb246ZCx0aWxlbGF0OmMsdGlsZW9mZnNldGxvbjpiLmxvbitmKmQsdGlsZW9mZnNldGxhdDpiLmxhdC1jKmcsdGlsZW9mZnNldHg6LShlL2QtZikqdGhpcy50aWxlU2l6ZS53LHRpbGVvZmZzZXR5OihnLWEvYykqdGhpcy50aWxlU2l6ZS5ofX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuTGF5ZXIuWm9vbWlmeVwifSk7T3BlbkxheWVycy5MYXllci5NYXBTZXJ2ZXI9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkxheWVyLkdyaWQse0RFRkFVTFRfUEFSQU1TOnttb2RlOlwibWFwXCIsbWFwX2ltYWdldHlwZTpcInBuZ1wifSxpbml0aWFsaXplOmZ1bmN0aW9uKGEsYixjLGQpe09wZW5MYXllcnMuTGF5ZXIuR3JpZC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5wYXJhbXM9T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHModGhpcy5wYXJhbXMsdGhpcy5ERUZBVUxUX1BBUkFNUyk7aWYobnVsbD09ZHx8bnVsbD09ZC5pc0Jhc2VMYXllcil0aGlzLmlzQmFzZUxheWVyPVwidHJ1ZVwiIT10aGlzLnBhcmFtcy50cmFuc3BhcmVudCYmITAhPXRoaXMucGFyYW1zLnRyYW5zcGFyZW50fSxjbG9uZTpmdW5jdGlvbihhKXtudWxsPT1hJiYoYT1uZXcgT3BlbkxheWVycy5MYXllci5NYXBTZXJ2ZXIodGhpcy5uYW1lLHRoaXMudXJsLHRoaXMucGFyYW1zLHRoaXMuZ2V0T3B0aW9ucygpKSk7XG5yZXR1cm4gYT1PcGVuTGF5ZXJzLkxheWVyLkdyaWQucHJvdG90eXBlLmNsb25lLmFwcGx5KHRoaXMsW2FdKX0sZ2V0VVJMOmZ1bmN0aW9uKGEpe3ZhciBhPXRoaXMuYWRqdXN0Qm91bmRzKGEpLGE9W2EubGVmdCxhLmJvdHRvbSxhLnJpZ2h0LGEudG9wXSxiPXRoaXMuZ2V0SW1hZ2VTaXplKCk7cmV0dXJuIHRoaXMuZ2V0RnVsbFJlcXVlc3RTdHJpbmcoe21hcGV4dDphLGltZ2V4dDphLG1hcF9zaXplOltiLncsYi5oXSxpbWd4OmIudy8yLGltZ3k6Yi5oLzIsaW1neHk6W2IudyxiLmhdfSl9LGdldEZ1bGxSZXF1ZXN0U3RyaW5nOmZ1bmN0aW9uKGEsYil7dmFyIGM9bnVsbD09Yj90aGlzLnVybDpiLGQ9T3BlbkxheWVycy5VdGlsLmV4dGVuZCh7fSx0aGlzLnBhcmFtcyksZD1PcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKGQsYSksZT1PcGVuTGF5ZXJzLlV0aWwuZ2V0UGFyYW1ldGVyU3RyaW5nKGQpO09wZW5MYXllcnMuVXRpbC5pc0FycmF5KGMpJiYoYz10aGlzLnNlbGVjdFVybChlLGMpKTtcbnZhciBlPU9wZW5MYXllcnMuVXRpbC51cHBlckNhc2VPYmplY3QoT3BlbkxheWVycy5VdGlsLmdldFBhcmFtZXRlcnMoYykpLGY7Zm9yKGYgaW4gZClmLnRvVXBwZXJDYXNlKClpbiBlJiZkZWxldGUgZFtmXTtlPU9wZW5MYXllcnMuVXRpbC5nZXRQYXJhbWV0ZXJTdHJpbmcoZCk7ZD1jO2U9ZS5yZXBsYWNlKC8sL2csXCIrXCIpO1wiXCIhPWUmJihmPWMuY2hhckF0KGMubGVuZ3RoLTEpLGQ9XCImXCI9PWZ8fFwiP1wiPT1mP2QrZTotMT09Yy5pbmRleE9mKFwiP1wiKT9kKyhcIj9cIitlKTpkKyhcIiZcIitlKSk7cmV0dXJuIGR9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkxheWVyLk1hcFNlcnZlclwifSk7T3BlbkxheWVycy5SZW5kZXJlci5WTUw9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLlJlbmRlcmVyLkVsZW1lbnRzLHt4bWxuczpcInVybjpzY2hlbWFzLW1pY3Jvc29mdC1jb206dm1sXCIsc3ltYm9sQ2FjaGU6e30sb2Zmc2V0Om51bGwsaW5pdGlhbGl6ZTpmdW5jdGlvbihhKXtpZih0aGlzLnN1cHBvcnRlZCgpKXtpZighZG9jdW1lbnQubmFtZXNwYWNlcy5vbHYpe2RvY3VtZW50Lm5hbWVzcGFjZXMuYWRkKFwib2x2XCIsdGhpcy54bWxucyk7Zm9yKHZhciBiPWRvY3VtZW50LmNyZWF0ZVN0eWxlU2hlZXQoKSxjPVwic2hhcGUgcmVjdCBvdmFsIGZpbGwgc3Ryb2tlIGltYWdlZGF0YSBncm91cCB0ZXh0Ym94XCIuc3BsaXQoXCIgXCIpLGQ9MCxlPWMubGVuZ3RoO2Q8ZTtkKyspYi5hZGRSdWxlKFwib2x2XFxcXDpcIitjW2RdLFwiYmVoYXZpb3I6IHVybCgjZGVmYXVsdCNWTUwpOyBwb3NpdGlvbjogYWJzb2x1dGU7IGRpc3BsYXk6IGlubGluZS1ibG9jaztcIil9T3BlbkxheWVycy5SZW5kZXJlci5FbGVtZW50cy5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLFxuYXJndW1lbnRzKX19LHN1cHBvcnRlZDpmdW5jdGlvbigpe3JldHVybiEhZG9jdW1lbnQubmFtZXNwYWNlc30sc2V0RXh0ZW50OmZ1bmN0aW9uKGEsYil7dmFyIGM9T3BlbkxheWVycy5SZW5kZXJlci5FbGVtZW50cy5wcm90b3R5cGUuc2V0RXh0ZW50LmFwcGx5KHRoaXMsYXJndW1lbnRzKSxkPXRoaXMuZ2V0UmVzb2x1dGlvbigpLGU9YS5sZWZ0L2R8MCxkPWEudG9wL2QtdGhpcy5zaXplLmh8MDtifHwhdGhpcy5vZmZzZXQ/KHRoaXMub2Zmc2V0PXt4OmUseTpkfSxkPWU9MCk6KGUtPXRoaXMub2Zmc2V0LngsZC09dGhpcy5vZmZzZXQueSk7dGhpcy5yb290LmNvb3Jkb3JpZ2luPWUtdGhpcy54T2Zmc2V0K1wiIFwiK2Q7Zm9yKHZhciBlPVt0aGlzLnJvb3QsdGhpcy52ZWN0b3JSb290LHRoaXMudGV4dFJvb3RdLGY9MCxnPWUubGVuZ3RoO2Y8ZzsrK2YpZD1lW2ZdLGQuY29vcmRzaXplPXRoaXMuc2l6ZS53K1wiIFwiK3RoaXMuc2l6ZS5oO3RoaXMucm9vdC5zdHlsZS5mbGlwPVwieVwiO3JldHVybiBjfSxcbnNldFNpemU6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5SZW5kZXJlci5wcm90b3R5cGUuc2V0U2l6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7Zm9yKHZhciBiPVt0aGlzLnJlbmRlcmVyUm9vdCx0aGlzLnJvb3QsdGhpcy52ZWN0b3JSb290LHRoaXMudGV4dFJvb3RdLGM9dGhpcy5zaXplLncrXCJweFwiLGQ9dGhpcy5zaXplLmgrXCJweFwiLGUsZj0wLGc9Yi5sZW5ndGg7ZjxnOysrZillPWJbZl0sZS5zdHlsZS53aWR0aD1jLGUuc3R5bGUuaGVpZ2h0PWR9LGdldE5vZGVUeXBlOmZ1bmN0aW9uKGEsYil7dmFyIGM9bnVsbDtzd2l0Y2goYS5DTEFTU19OQU1FKXtjYXNlIFwiT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludFwiOmM9Yi5leHRlcm5hbEdyYXBoaWM/XCJvbHY6cmVjdFwiOnRoaXMuaXNDb21wbGV4U3ltYm9sKGIuZ3JhcGhpY05hbWUpP1wib2x2OnNoYXBlXCI6XCJvbHY6b3ZhbFwiO2JyZWFrO2Nhc2UgXCJPcGVuTGF5ZXJzLkdlb21ldHJ5LlJlY3RhbmdsZVwiOmM9XCJvbHY6cmVjdFwiO2JyZWFrO2Nhc2UgXCJPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVTdHJpbmdcIjpjYXNlIFwiT3BlbkxheWVycy5HZW9tZXRyeS5MaW5lYXJSaW5nXCI6Y2FzZSBcIk9wZW5MYXllcnMuR2VvbWV0cnkuUG9seWdvblwiOmNhc2UgXCJPcGVuTGF5ZXJzLkdlb21ldHJ5LkN1cnZlXCI6Yz1cblwib2x2OnNoYXBlXCJ9cmV0dXJuIGN9LHNldFN0eWxlOmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBiPWJ8fGEuX3N0eWxlLGM9Y3x8YS5fb3B0aW9ucyxlPWIuZmlsbENvbG9yO2lmKFwiT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludFwiPT09YS5fZ2VvbWV0cnlDbGFzcylpZihiLmV4dGVybmFsR3JhcGhpYyl7Yy5pc0ZpbGxlZD0hMDtiLmdyYXBoaWNUaXRsZSYmKGEudGl0bGU9Yi5ncmFwaGljVGl0bGUpO3ZhciBlPWIuZ3JhcGhpY1dpZHRofHxiLmdyYXBoaWNIZWlnaHQsZj1iLmdyYXBoaWNIZWlnaHR8fGIuZ3JhcGhpY1dpZHRoLGU9ZT9lOjIqYi5wb2ludFJhZGl1cyxmPWY/ZjoyKmIucG9pbnRSYWRpdXMsZz10aGlzLmdldFJlc29sdXRpb24oKSxoPXZvaWQgMCE9Yi5ncmFwaGljWE9mZnNldD9iLmdyYXBoaWNYT2Zmc2V0Oi0oMC41KmUpLGk9dm9pZCAwIT1iLmdyYXBoaWNZT2Zmc2V0P2IuZ3JhcGhpY1lPZmZzZXQ6LSgwLjUqZik7YS5zdHlsZS5sZWZ0PSgoZC54LXRoaXMuZmVhdHVyZUR4KS9cbmctdGhpcy5vZmZzZXQueCtofDApK1wicHhcIjthLnN0eWxlLnRvcD0oZC55L2ctdGhpcy5vZmZzZXQueS0oaStmKXwwKStcInB4XCI7YS5zdHlsZS53aWR0aD1lK1wicHhcIjthLnN0eWxlLmhlaWdodD1mK1wicHhcIjthLnN0eWxlLmZsaXA9XCJ5XCI7ZT1cIm5vbmVcIjtjLmlzU3Ryb2tlZD0hMX1lbHNlIHRoaXMuaXNDb21wbGV4U3ltYm9sKGIuZ3JhcGhpY05hbWUpPyhmPXRoaXMuaW1wb3J0U3ltYm9sKGIuZ3JhcGhpY05hbWUpLGEucGF0aD1mLnBhdGgsYS5jb29yZG9yaWdpbj1mLmxlZnQrXCIsXCIrZi5ib3R0b20sZj1mLnNpemUsYS5jb29yZHNpemU9ZitcIixcIitmLHRoaXMuZHJhd0NpcmNsZShhLGQsYi5wb2ludFJhZGl1cyksYS5zdHlsZS5mbGlwPVwieVwiKTp0aGlzLmRyYXdDaXJjbGUoYSxkLGIucG9pbnRSYWRpdXMpO2MuaXNGaWxsZWQ/YS5maWxsY29sb3I9ZTphLmZpbGxlZD1cImZhbHNlXCI7ZD1hLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiZmlsbFwiKTtkPTA9PWQubGVuZ3RoP251bGw6ZFswXTtpZihjLmlzRmlsbGVkKXtkfHxcbihkPXRoaXMuY3JlYXRlTm9kZShcIm9sdjpmaWxsXCIsYS5pZCtcIl9maWxsXCIpKTtkLm9wYWNpdHk9Yi5maWxsT3BhY2l0eTtpZihcIk9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnRcIj09PWEuX2dlb21ldHJ5Q2xhc3MmJmIuZXh0ZXJuYWxHcmFwaGljJiYoYi5ncmFwaGljT3BhY2l0eSYmKGQub3BhY2l0eT1iLmdyYXBoaWNPcGFjaXR5KSxkLnNyYz1iLmV4dGVybmFsR3JhcGhpYyxkLnR5cGU9XCJmcmFtZVwiLCFiLmdyYXBoaWNXaWR0aHx8IWIuZ3JhcGhpY0hlaWdodCkpZC5hc3BlY3Q9XCJhdG1vc3RcIjtkLnBhcmVudE5vZGUhPWEmJmEuYXBwZW5kQ2hpbGQoZCl9ZWxzZSBkJiZhLnJlbW92ZUNoaWxkKGQpO2U9Yi5yb3RhdGlvbjtpZih2b2lkIDAhPT1lfHx2b2lkIDAhPT1hLl9yb3RhdGlvbilhLl9yb3RhdGlvbj1lLGIuZXh0ZXJuYWxHcmFwaGljPyh0aGlzLmdyYXBoaWNSb3RhdGUoYSxoLGksYiksZC5vcGFjaXR5PTApOlwiT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludFwiPT09YS5fZ2VvbWV0cnlDbGFzcyYmXG4oYS5zdHlsZS5yb3RhdGlvbj1lfHwwKTtoPWEuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzdHJva2VcIik7aD0wPT1oLmxlbmd0aD9udWxsOmhbMF07aWYoYy5pc1N0cm9rZWQpe2lmKGh8fChoPXRoaXMuY3JlYXRlTm9kZShcIm9sdjpzdHJva2VcIixhLmlkK1wiX3N0cm9rZVwiKSxhLmFwcGVuZENoaWxkKGgpKSxoLm9uPSEwLGguY29sb3I9Yi5zdHJva2VDb2xvcixoLndlaWdodD1iLnN0cm9rZVdpZHRoK1wicHhcIixoLm9wYWNpdHk9Yi5zdHJva2VPcGFjaXR5LGguZW5kY2FwPVwiYnV0dFwiPT1iLnN0cm9rZUxpbmVjYXA/XCJmbGF0XCI6Yi5zdHJva2VMaW5lY2FwfHxcInJvdW5kXCIsYi5zdHJva2VEYXNoc3R5bGUpaC5kYXNoc3R5bGU9dGhpcy5kYXNoU3R5bGUoYil9ZWxzZSBhLnN0cm9rZWQ9ITEsaCYmKGgub249ITEpO1wiaW5oZXJpdFwiIT1iLmN1cnNvciYmbnVsbCE9Yi5jdXJzb3ImJihhLnN0eWxlLmN1cnNvcj1iLmN1cnNvcik7cmV0dXJuIGF9LGdyYXBoaWNSb3RhdGU6ZnVuY3Rpb24oYSxiLGMsXG5kKXt2YXIgZD1kfHxhLl9zdHlsZSxlPWQucm90YXRpb258fDAsZixnO2lmKCFkLmdyYXBoaWNXaWR0aHx8IWQuZ3JhcGhpY0hlaWdodCl7dmFyIGg9bmV3IEltYWdlO2gub25yZWFkeXN0YXRlY2hhbmdlPU9wZW5MYXllcnMuRnVuY3Rpb24uYmluZChmdW5jdGlvbigpe2lmKFwiY29tcGxldGVcIj09aC5yZWFkeVN0YXRlfHxcImludGVyYWN0aXZlXCI9PWgucmVhZHlTdGF0ZSlmPWgud2lkdGgvaC5oZWlnaHQsZz1NYXRoLm1heCgyKmQucG9pbnRSYWRpdXMsZC5ncmFwaGljV2lkdGh8fDAsZC5ncmFwaGljSGVpZ2h0fHwwKSxiKj1mLGQuZ3JhcGhpY1dpZHRoPWcqZixkLmdyYXBoaWNIZWlnaHQ9Zyx0aGlzLmdyYXBoaWNSb3RhdGUoYSxiLGMsZCl9LHRoaXMpO2guc3JjPWQuZXh0ZXJuYWxHcmFwaGljfWVsc2V7Zz1NYXRoLm1heChkLmdyYXBoaWNXaWR0aCxkLmdyYXBoaWNIZWlnaHQpO2Y9ZC5ncmFwaGljV2lkdGgvZC5ncmFwaGljSGVpZ2h0O3ZhciBpPU1hdGgucm91bmQoZC5ncmFwaGljV2lkdGh8fFxuZypmKSxqPU1hdGgucm91bmQoZC5ncmFwaGljSGVpZ2h0fHxnKTthLnN0eWxlLndpZHRoPWkrXCJweFwiO2Euc3R5bGUuaGVpZ2h0PWorXCJweFwiO3ZhciBrPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGEuaWQrXCJfaW1hZ2VcIik7a3x8KGs9dGhpcy5jcmVhdGVOb2RlKFwib2x2OmltYWdlZGF0YVwiLGEuaWQrXCJfaW1hZ2VcIiksYS5hcHBlbmRDaGlsZChrKSk7ay5zdHlsZS53aWR0aD1pK1wicHhcIjtrLnN0eWxlLmhlaWdodD1qK1wicHhcIjtrLnNyYz1kLmV4dGVybmFsR3JhcGhpYztrLnN0eWxlLmZpbHRlcj1cInByb2dpZDpEWEltYWdlVHJhbnNmb3JtLk1pY3Jvc29mdC5BbHBoYUltYWdlTG9hZGVyKHNyYz0nJywgc2l6aW5nTWV0aG9kPSdzY2FsZScpXCI7az1lKk1hdGguUEkvMTgwO2U9TWF0aC5zaW4oayk7az1NYXRoLmNvcyhrKTtlPVwicHJvZ2lkOkRYSW1hZ2VUcmFuc2Zvcm0uTWljcm9zb2Z0Lk1hdHJpeChNMTE9XCIraytcIixNMTI9XCIrLWUrXCIsTTIxPVwiK2UrXCIsTTIyPVwiK2srXCIsU2l6aW5nTWV0aG9kPSdhdXRvIGV4cGFuZCcpXFxuXCI7XG4oaz1kLmdyYXBoaWNPcGFjaXR5fHxkLmZpbGxPcGFjaXR5KSYmMSE9ayYmKGUrPVwicHJvZ2lkOkRYSW1hZ2VUcmFuc2Zvcm0uTWljcm9zb2Z0LkJhc2ljSW1hZ2Uob3BhY2l0eT1cIitrK1wiKVxcblwiKTthLnN0eWxlLmZpbHRlcj1lO2U9bmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQoLWIsLWMpO2k9KG5ldyBPcGVuTGF5ZXJzLkJvdW5kcygwLDAsaSxqKSkudG9HZW9tZXRyeSgpO2kucm90YXRlKGQucm90YXRpb24sZSk7aT1pLmdldEJvdW5kcygpO2Euc3R5bGUubGVmdD1NYXRoLnJvdW5kKHBhcnNlSW50KGEuc3R5bGUubGVmdCkraS5sZWZ0KStcInB4XCI7YS5zdHlsZS50b3A9TWF0aC5yb3VuZChwYXJzZUludChhLnN0eWxlLnRvcCktaS5ib3R0b20pK1wicHhcIn19LHBvc3REcmF3OmZ1bmN0aW9uKGEpe2Euc3R5bGUudmlzaWJpbGl0eT1cInZpc2libGVcIjt2YXIgYj1hLl9zdHlsZS5maWxsQ29sb3IsYz1hLl9zdHlsZS5zdHJva2VDb2xvcjtcIm5vbmVcIj09YiYmYS5maWxsY29sb3IhPWImJlxuKGEuZmlsbGNvbG9yPWIpO1wibm9uZVwiPT1jJiZhLnN0cm9rZWNvbG9yIT1jJiYoYS5zdHJva2Vjb2xvcj1jKX0sc2V0Tm9kZURpbWVuc2lvbjpmdW5jdGlvbihhLGIpe3ZhciBjPWIuZ2V0Qm91bmRzKCk7aWYoYyl7dmFyIGQ9dGhpcy5nZXRSZXNvbHV0aW9uKCksYz1uZXcgT3BlbkxheWVycy5Cb3VuZHMoKGMubGVmdC10aGlzLmZlYXR1cmVEeCkvZC10aGlzLm9mZnNldC54fDAsYy5ib3R0b20vZC10aGlzLm9mZnNldC55fDAsKGMucmlnaHQtdGhpcy5mZWF0dXJlRHgpL2QtdGhpcy5vZmZzZXQueHwwLGMudG9wL2QtdGhpcy5vZmZzZXQueXwwKTthLnN0eWxlLmxlZnQ9Yy5sZWZ0K1wicHhcIjthLnN0eWxlLnRvcD1jLnRvcCtcInB4XCI7YS5zdHlsZS53aWR0aD1jLmdldFdpZHRoKCkrXCJweFwiO2Euc3R5bGUuaGVpZ2h0PWMuZ2V0SGVpZ2h0KCkrXCJweFwiO2EuY29vcmRvcmlnaW49Yy5sZWZ0K1wiIFwiK2MudG9wO2EuY29vcmRzaXplPWMuZ2V0V2lkdGgoKStcIiBcIitjLmdldEhlaWdodCgpfX0sZGFzaFN0eWxlOmZ1bmN0aW9uKGEpe2E9XG5hLnN0cm9rZURhc2hzdHlsZTtzd2l0Y2goYSl7Y2FzZSBcInNvbGlkXCI6Y2FzZSBcImRvdFwiOmNhc2UgXCJkYXNoXCI6Y2FzZSBcImRhc2hkb3RcIjpjYXNlIFwibG9uZ2Rhc2hcIjpjYXNlIFwibG9uZ2Rhc2hkb3RcIjpyZXR1cm4gYTtkZWZhdWx0OnJldHVybiBhPWEuc3BsaXQoL1sgLF0vKSwyPT1hLmxlbmd0aD8xKmFbMF0+PTIqYVsxXT9cImxvbmdkYXNoXCI6MT09YVswXXx8MT09YVsxXT9cImRvdFwiOlwiZGFzaFwiOjQ9PWEubGVuZ3RoPzEqYVswXT49MiphWzFdP1wibG9uZ2Rhc2hkb3RcIjpcImRhc2hkb3RcIjpcInNvbGlkXCJ9fSxjcmVhdGVOb2RlOmZ1bmN0aW9uKGEsYil7dmFyIGM9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChhKTtiJiYoYy5pZD1iKTtjLnVuc2VsZWN0YWJsZT1cIm9uXCI7Yy5vbnNlbGVjdHN0YXJ0PU9wZW5MYXllcnMuRnVuY3Rpb24uRmFsc2U7cmV0dXJuIGN9LG5vZGVUeXBlQ29tcGFyZTpmdW5jdGlvbihhLGIpe3ZhciBjPWIsZD1jLmluZGV4T2YoXCI6XCIpOy0xIT1kJiYoYz1jLnN1YnN0cihkK1xuMSkpO3ZhciBlPWEubm9kZU5hbWUsZD1lLmluZGV4T2YoXCI6XCIpOy0xIT1kJiYoZT1lLnN1YnN0cihkKzEpKTtyZXR1cm4gYz09ZX0sY3JlYXRlUmVuZGVyUm9vdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm5vZGVGYWN0b3J5KHRoaXMuY29udGFpbmVyLmlkK1wiX3ZtbFJvb3RcIixcImRpdlwiKX0sY3JlYXRlUm9vdDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5ub2RlRmFjdG9yeSh0aGlzLmNvbnRhaW5lci5pZCthLFwib2x2Omdyb3VwXCIpfSxkcmF3UG9pbnQ6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5kcmF3Q2lyY2xlKGEsYiwxKX0sZHJhd0NpcmNsZTpmdW5jdGlvbihhLGIsYyl7aWYoIWlzTmFOKGIueCkmJiFpc05hTihiLnkpKXt2YXIgZD10aGlzLmdldFJlc29sdXRpb24oKTthLnN0eWxlLmxlZnQ9KChiLngtdGhpcy5mZWF0dXJlRHgpL2QtdGhpcy5vZmZzZXQueHwwKS1jK1wicHhcIjthLnN0eWxlLnRvcD0oYi55L2QtdGhpcy5vZmZzZXQueXwwKS1jK1wicHhcIjtiPTIqYzthLnN0eWxlLndpZHRoPVxuYitcInB4XCI7YS5zdHlsZS5oZWlnaHQ9YitcInB4XCI7cmV0dXJuIGF9cmV0dXJuITF9LGRyYXdMaW5lU3RyaW5nOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuZHJhd0xpbmUoYSxiLCExKX0sZHJhd0xpbmVhclJpbmc6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5kcmF3TGluZShhLGIsITApfSxkcmF3TGluZTpmdW5jdGlvbihhLGIsYyl7dGhpcy5zZXROb2RlRGltZW5zaW9uKGEsYik7Zm9yKHZhciBkPXRoaXMuZ2V0UmVzb2x1dGlvbigpLGU9Yi5jb21wb25lbnRzLmxlbmd0aCxmPUFycmF5KGUpLGcsaCxpPTA7aTxlO2krKylnPWIuY29tcG9uZW50c1tpXSxoPShnLngtdGhpcy5mZWF0dXJlRHgpL2QtdGhpcy5vZmZzZXQueHwwLGc9Zy55L2QtdGhpcy5vZmZzZXQueXwwLGZbaV09XCIgXCIraCtcIixcIitnK1wiIGwgXCI7YS5wYXRoPVwibVwiK2Yuam9pbihcIlwiKSsoYz9cIiB4IGVcIjpcIiBlXCIpO3JldHVybiBhfSxkcmF3UG9seWdvbjpmdW5jdGlvbihhLGIpe3RoaXMuc2V0Tm9kZURpbWVuc2lvbihhLFxuYik7dmFyIGM9dGhpcy5nZXRSZXNvbHV0aW9uKCksZD1bXSxlLGYsZyxoLGksaixrLGwsbSxuO2U9MDtmb3IoZj1iLmNvbXBvbmVudHMubGVuZ3RoO2U8ZjtlKyspe2QucHVzaChcIm1cIik7Zz1iLmNvbXBvbmVudHNbZV0uY29tcG9uZW50cztoPTA9PT1lO2o9aT1udWxsO2s9MDtmb3IobD1nLmxlbmd0aDtrPGw7aysrKW09Z1trXSxuPShtLngtdGhpcy5mZWF0dXJlRHgpL2MtdGhpcy5vZmZzZXQueHwwLG09bS55L2MtdGhpcy5vZmZzZXQueXwwLG49XCIgXCIrbitcIixcIittLGQucHVzaChuKSwwPT1rJiZkLnB1c2goXCIgbFwiKSxofHwoaT9pIT1uJiYoaj9qIT1uJiYoaD0hMCk6aj1uKTppPW4pO2QucHVzaChoP1wiIHggXCI6XCIgXCIpfWQucHVzaChcImVcIik7YS5wYXRoPWQuam9pbihcIlwiKTtyZXR1cm4gYX0sZHJhd1JlY3RhbmdsZTpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuZ2V0UmVzb2x1dGlvbigpO2Euc3R5bGUubGVmdD0oKGIueC10aGlzLmZlYXR1cmVEeCkvYy10aGlzLm9mZnNldC54fDApK1xuXCJweFwiO2Euc3R5bGUudG9wPShiLnkvYy10aGlzLm9mZnNldC55fDApK1wicHhcIjthLnN0eWxlLndpZHRoPShiLndpZHRoL2N8MCkrXCJweFwiO2Euc3R5bGUuaGVpZ2h0PShiLmhlaWdodC9jfDApK1wicHhcIjtyZXR1cm4gYX0sZHJhd1RleHQ6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXMubm9kZUZhY3RvcnkoYSt0aGlzLkxBQkVMX0lEX1NVRkZJWCxcIm9sdjpyZWN0XCIpLGU9dGhpcy5ub2RlRmFjdG9yeShhK3RoaXMuTEFCRUxfSURfU1VGRklYK1wiX3RleHRib3hcIixcIm9sdjp0ZXh0Ym94XCIpLGY9dGhpcy5nZXRSZXNvbHV0aW9uKCk7ZC5zdHlsZS5sZWZ0PSgoYy54LXRoaXMuZmVhdHVyZUR4KS9mLXRoaXMub2Zmc2V0Lnh8MCkrXCJweFwiO2Quc3R5bGUudG9wPShjLnkvZi10aGlzLm9mZnNldC55fDApK1wicHhcIjtkLnN0eWxlLmZsaXA9XCJ5XCI7ZS5pbm5lclRleHQ9Yi5sYWJlbDtcImluaGVyaXRcIiE9Yi5jdXJzb3ImJm51bGwhPWIuY3Vyc29yJiYoZS5zdHlsZS5jdXJzb3I9Yi5jdXJzb3IpO2IuZm9udENvbG9yJiZcbihlLnN0eWxlLmNvbG9yPWIuZm9udENvbG9yKTtiLmZvbnRPcGFjaXR5JiYoZS5zdHlsZS5maWx0ZXI9XCJhbHBoYShvcGFjaXR5PVwiKzEwMCpiLmZvbnRPcGFjaXR5K1wiKVwiKTtiLmZvbnRGYW1pbHkmJihlLnN0eWxlLmZvbnRGYW1pbHk9Yi5mb250RmFtaWx5KTtiLmZvbnRTaXplJiYoZS5zdHlsZS5mb250U2l6ZT1iLmZvbnRTaXplKTtiLmZvbnRXZWlnaHQmJihlLnN0eWxlLmZvbnRXZWlnaHQ9Yi5mb250V2VpZ2h0KTtiLmZvbnRTdHlsZSYmKGUuc3R5bGUuZm9udFN0eWxlPWIuZm9udFN0eWxlKTshMD09PWIubGFiZWxTZWxlY3QmJihkLl9mZWF0dXJlSWQ9YSxlLl9mZWF0dXJlSWQ9YSxlLl9nZW9tZXRyeT1jLGUuX2dlb21ldHJ5Q2xhc3M9Yy5DTEFTU19OQU1FKTtlLnN0eWxlLndoaXRlU3BhY2U9XCJub3dyYXBcIjtlLmluc2V0PVwiMXB4LDBweCwwcHgsMHB4XCI7ZC5wYXJlbnROb2RlfHwoZC5hcHBlbmRDaGlsZChlKSx0aGlzLnRleHRSb290LmFwcGVuZENoaWxkKGQpKTtiPWIubGFiZWxBbGlnbnx8XG5cImNtXCI7MT09Yi5sZW5ndGgmJihiKz1cIm1cIik7YT1lLmNsaWVudFdpZHRoKk9wZW5MYXllcnMuUmVuZGVyZXIuVk1MLkxBQkVMX1NISUZUW2Iuc3Vic3RyKDAsMSldO2U9ZS5jbGllbnRIZWlnaHQqT3BlbkxheWVycy5SZW5kZXJlci5WTUwuTEFCRUxfU0hJRlRbYi5zdWJzdHIoMSwxKV07ZC5zdHlsZS5sZWZ0PXBhcnNlSW50KGQuc3R5bGUubGVmdCktYS0xK1wicHhcIjtkLnN0eWxlLnRvcD1wYXJzZUludChkLnN0eWxlLnRvcCkrZStcInB4XCJ9LG1vdmVSb290OmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMubWFwLmdldExheWVyKGEuY29udGFpbmVyLmlkKTtiIGluc3RhbmNlb2YgT3BlbkxheWVycy5MYXllci5WZWN0b3IuUm9vdENvbnRhaW5lciYmKGI9dGhpcy5tYXAuZ2V0TGF5ZXIodGhpcy5jb250YWluZXIuaWQpKTtiJiZiLnJlbmRlcmVyLmNsZWFyKCk7T3BlbkxheWVycy5SZW5kZXJlci5FbGVtZW50cy5wcm90b3R5cGUubW92ZVJvb3QuYXBwbHkodGhpcyxhcmd1bWVudHMpO2ImJmIucmVkcmF3KCl9LFxuaW1wb3J0U3ltYm9sOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY29udGFpbmVyLmlkK1wiLVwiK2EsYz10aGlzLnN5bWJvbENhY2hlW2JdO2lmKGMpcmV0dXJuIGM7Yz1PcGVuTGF5ZXJzLlJlbmRlcmVyLnN5bWJvbFthXTtpZighYyl0aHJvdyBFcnJvcihhK1wiIGlzIG5vdCBhIHZhbGlkIHN5bWJvbCBuYW1lXCIpO2Zvcih2YXIgYT1uZXcgT3BlbkxheWVycy5Cb3VuZHMoTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFLDAsMCksZD1bXCJtXCJdLGU9MDtlPGMubGVuZ3RoO2UrPTIpe3ZhciBmPWNbZV0sZz1jW2UrMV07YS5sZWZ0PU1hdGgubWluKGEubGVmdCxmKTthLmJvdHRvbT1NYXRoLm1pbihhLmJvdHRvbSxnKTthLnJpZ2h0PU1hdGgubWF4KGEucmlnaHQsZik7YS50b3A9TWF0aC5tYXgoYS50b3AsZyk7ZC5wdXNoKGYpO2QucHVzaChnKTswPT1lJiZkLnB1c2goXCJsXCIpfWQucHVzaChcInggZVwiKTtjPWQuam9pbihcIiBcIik7ZD0oYS5nZXRXaWR0aCgpLWEuZ2V0SGVpZ2h0KCkpLzI7XG4wPGQ/KGEuYm90dG9tLT1kLGEudG9wKz1kKTooYS5sZWZ0Kz1kLGEucmlnaHQtPWQpO2M9e3BhdGg6YyxzaXplOmEuZ2V0V2lkdGgoKSxsZWZ0OmEubGVmdCxib3R0b206YS5ib3R0b219O3JldHVybiB0aGlzLnN5bWJvbENhY2hlW2JdPWN9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLlJlbmRlcmVyLlZNTFwifSk7T3BlbkxheWVycy5SZW5kZXJlci5WTUwuTEFCRUxfU0hJRlQ9e2w6MCxjOjAuNSxyOjEsdDowLG06MC41LGI6MX07T3BlbkxheWVycy5Db250cm9sLkNhY2hlUmVhZD1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuQ29udHJvbCx7ZmV0Y2hFdmVudDpcInRpbGVsb2Fkc3RhcnRcIixsYXllcnM6bnVsbCxhdXRvQWN0aXZhdGU6ITAsc2V0TWFwOmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuQ29udHJvbC5wcm90b3R5cGUuc2V0TWFwLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgYixjPXRoaXMubGF5ZXJzfHxhLmxheWVycztmb3IoYj1jLmxlbmd0aC0xOzA8PWI7LS1iKXRoaXMuYWRkTGF5ZXIoe2xheWVyOmNbYl19KTtpZighdGhpcy5sYXllcnMpYS5ldmVudHMub24oe2FkZGxheWVyOnRoaXMuYWRkTGF5ZXIscmVtb3ZlTGF5ZXI6dGhpcy5yZW1vdmVMYXllcixzY29wZTp0aGlzfSl9LGFkZExheWVyOmZ1bmN0aW9uKGEpe2EubGF5ZXIuZXZlbnRzLnJlZ2lzdGVyKHRoaXMuZmV0Y2hFdmVudCx0aGlzLHRoaXMuZmV0Y2gpfSxyZW1vdmVMYXllcjpmdW5jdGlvbihhKXthLmxheWVyLmV2ZW50cy51bnJlZ2lzdGVyKHRoaXMuZmV0Y2hFdmVudCxcbnRoaXMsdGhpcy5mZXRjaCl9LGZldGNoOmZ1bmN0aW9uKGEpe2lmKHRoaXMuYWN0aXZlJiZ3aW5kb3cubG9jYWxTdG9yYWdlJiZhLnRpbGUgaW5zdGFuY2VvZiBPcGVuTGF5ZXJzLlRpbGUuSW1hZ2Upe3ZhciBiPWEudGlsZSxjPWIudXJsOyFiLmxheWVyLmNyb3NzT3JpZ2luS2V5d29yZCYmKE9wZW5MYXllcnMuUHJveHlIb3N0JiYwPT09Yy5pbmRleE9mKE9wZW5MYXllcnMuUHJveHlIb3N0KSkmJihjPU9wZW5MYXllcnMuQ29udHJvbC5DYWNoZVdyaXRlLnVybE1hcFtjXSk7aWYoYz13aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJvbENhY2hlX1wiK2MpKWIudXJsPWMsXCJ0aWxlZXJyb3JcIj09PWEudHlwZSYmYi5zZXRJbWdTcmMoYyl9fSxkZXN0cm95OmZ1bmN0aW9uKCl7aWYodGhpcy5sYXllcnN8fHRoaXMubWFwKXt2YXIgYSxiPXRoaXMubGF5ZXJzfHx0aGlzLm1hcC5sYXllcnM7Zm9yKGE9Yi5sZW5ndGgtMTswPD1hOy0tYSl0aGlzLnJlbW92ZUxheWVyKHtsYXllcjpiW2FdfSl9dGhpcy5tYXAmJlxudGhpcy5tYXAuZXZlbnRzLnVuKHthZGRsYXllcjp0aGlzLmFkZExheWVyLHJlbW92ZUxheWVyOnRoaXMucmVtb3ZlTGF5ZXIsc2NvcGU6dGhpc30pO09wZW5MYXllcnMuQ29udHJvbC5wcm90b3R5cGUuZGVzdHJveS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkNvbnRyb2wuQ2FjaGVSZWFkXCJ9KTtPcGVuTGF5ZXJzLlByb3RvY29sLldGUy52MV8wXzA9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLlByb3RvY29sLldGUy52MSx7dmVyc2lvbjpcIjEuMC4wXCIsQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuUHJvdG9jb2wuV0ZTLnYxXzBfMFwifSk7T3BlbkxheWVycy5Gb3JtYXQuV01TR2V0RmVhdHVyZUluZm89T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkZvcm1hdC5YTUwse2xheWVySWRlbnRpZmllcjpcIl9sYXllclwiLGZlYXR1cmVJZGVudGlmaWVyOlwiX2ZlYXR1cmVcIixyZWdFeGVzOnt0cmltU3BhY2U6L15cXHMqfFxccyokL2cscmVtb3ZlU3BhY2U6L1xccyovZyxzcGxpdFNwYWNlOi9cXHMrLyx0cmltQ29tbWE6L1xccyosXFxzKi9nfSxnbWxGb3JtYXQ6bnVsbCxyZWFkOmZ1bmN0aW9uKGEpe1wic3RyaW5nXCI9PXR5cGVvZiBhJiYoYT1PcGVuTGF5ZXJzLkZvcm1hdC5YTUwucHJvdG90eXBlLnJlYWQuYXBwbHkodGhpcyxbYV0pKTt2YXIgYj1hLmRvY3VtZW50RWxlbWVudDtpZihiKXZhciBjPXRoaXNbXCJyZWFkX1wiK2Iubm9kZU5hbWVdLGE9Yz9jLmNhbGwodGhpcyxiKToobmV3IE9wZW5MYXllcnMuRm9ybWF0LkdNTCh0aGlzLm9wdGlvbnM/dGhpcy5vcHRpb25zOnt9KSkucmVhZChhKTtyZXR1cm4gYX0scmVhZF9tc0dNTE91dHB1dDpmdW5jdGlvbihhKXt2YXIgYj1cbltdO2lmKGE9dGhpcy5nZXRTaWJsaW5nTm9kZXNCeVRhZ0NyaXRlcmlhKGEsdGhpcy5sYXllcklkZW50aWZpZXIpKWZvcih2YXIgYz0wLGQ9YS5sZW5ndGg7YzxkOysrYyl7dmFyIGU9YVtjXSxmPWUubm9kZU5hbWU7ZS5wcmVmaXgmJihmPWYuc3BsaXQoXCI6XCIpWzFdKTtmPWYucmVwbGFjZSh0aGlzLmxheWVySWRlbnRpZmllcixcIlwiKTtpZihlPXRoaXMuZ2V0U2libGluZ05vZGVzQnlUYWdDcml0ZXJpYShlLHRoaXMuZmVhdHVyZUlkZW50aWZpZXIpKWZvcih2YXIgZz0wO2c8ZS5sZW5ndGg7ZysrKXt2YXIgaD1lW2ddLGk9dGhpcy5wYXJzZUdlb21ldHJ5KGgpLGg9dGhpcy5wYXJzZUF0dHJpYnV0ZXMoaCksaD1uZXcgT3BlbkxheWVycy5GZWF0dXJlLlZlY3RvcihpLmdlb21ldHJ5LGgsbnVsbCk7aC5ib3VuZHM9aS5ib3VuZHM7aC50eXBlPWY7Yi5wdXNoKGgpfX1yZXR1cm4gYn0scmVhZF9GZWF0dXJlSW5mb1Jlc3BvbnNlOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1bXSxhPXRoaXMuZ2V0RWxlbWVudHNCeVRhZ05hbWVOUyhhLFxuXCIqXCIsXCJGSUVMRFNcIiksYz0wLGQ9YS5sZW5ndGg7YzxkO2MrKyl7dmFyIGU9YVtjXSxmPXt9LGcsaD1lLmF0dHJpYnV0ZXMubGVuZ3RoO2lmKDA8aClmb3IoZz0wO2c8aDtnKyspe3ZhciBpPWUuYXR0cmlidXRlc1tnXTtmW2kubm9kZU5hbWVdPWkubm9kZVZhbHVlfWVsc2V7ZT1lLmNoaWxkTm9kZXM7Zz0wO2ZvcihoPWUubGVuZ3RoO2c8aDsrK2cpaT1lW2ddLDMhPWkubm9kZVR5cGUmJihmW2kuZ2V0QXR0cmlidXRlKFwibmFtZVwiKV09aS5nZXRBdHRyaWJ1dGUoXCJ2YWx1ZVwiKSl9Yi5wdXNoKG5ldyBPcGVuTGF5ZXJzLkZlYXR1cmUuVmVjdG9yKG51bGwsZixudWxsKSl9cmV0dXJuIGJ9LGdldFNpYmxpbmdOb2Rlc0J5VGFnQ3JpdGVyaWE6ZnVuY3Rpb24oYSxiKXt2YXIgYz1bXSxkLGUsZixnO2lmKGEmJmEuaGFzQ2hpbGROb2RlcygpKXtkPWEuY2hpbGROb2RlcztmPWQubGVuZ3RoO2Zvcih2YXIgaD0wO2g8ZjtoKyspe2ZvcihnPWRbaF07ZyYmMSE9Zy5ub2RlVHlwZTspZz1nLm5leHRTaWJsaW5nLFxuaCsrO2U9Zz9nLm5vZGVOYW1lOlwiXCI7MDxlLmxlbmd0aCYmLTE8ZS5pbmRleE9mKGIpP2MucHVzaChnKTooZT10aGlzLmdldFNpYmxpbmdOb2Rlc0J5VGFnQ3JpdGVyaWEoZyxiKSwwPGUubGVuZ3RoJiYoMD09Yy5sZW5ndGg/Yz1lOmMucHVzaChlKSkpfX1yZXR1cm4gY30scGFyc2VBdHRyaWJ1dGVzOmZ1bmN0aW9uKGEpe3ZhciBiPXt9O2lmKDE9PWEubm9kZVR5cGUpZm9yKHZhciBhPWEuY2hpbGROb2RlcyxjPWEubGVuZ3RoLGQ9MDtkPGM7KytkKXt2YXIgZT1hW2RdO2lmKDE9PWUubm9kZVR5cGUpe3ZhciBmPWUuY2hpbGROb2RlcyxlPWUucHJlZml4P2Uubm9kZU5hbWUuc3BsaXQoXCI6XCIpWzFdOmUubm9kZU5hbWU7aWYoMD09Zi5sZW5ndGgpYltlXT1udWxsO2Vsc2UgaWYoMT09Zi5sZW5ndGgmJihmPWZbMF0sMz09Zi5ub2RlVHlwZXx8ND09Zi5ub2RlVHlwZSkpZj1mLm5vZGVWYWx1ZS5yZXBsYWNlKHRoaXMucmVnRXhlcy50cmltU3BhY2UsXCJcIiksYltlXT1mfX1yZXR1cm4gYn0sXG5wYXJzZUdlb21ldHJ5OmZ1bmN0aW9uKGEpe3RoaXMuZ21sRm9ybWF0fHwodGhpcy5nbWxGb3JtYXQ9bmV3IE9wZW5MYXllcnMuRm9ybWF0LkdNTCk7dmFyIGE9dGhpcy5nbWxGb3JtYXQucGFyc2VGZWF0dXJlKGEpLGIsYz1udWxsO2EmJihiPWEuZ2VvbWV0cnkmJmEuZ2VvbWV0cnkuY2xvbmUoKSxjPWEuYm91bmRzJiZhLmJvdW5kcy5jbG9uZSgpLGEuZGVzdHJveSgpKTtyZXR1cm57Z2VvbWV0cnk6Yixib3VuZHM6Y319LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkZvcm1hdC5XTVNHZXRGZWF0dXJlSW5mb1wifSk7T3BlbkxheWVycy5Db250cm9sLldNVFNHZXRGZWF0dXJlSW5mbz1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuQ29udHJvbCx7aG92ZXI6ITEscmVxdWVzdEVuY29kaW5nOlwiS1ZQXCIsZHJpbGxEb3duOiExLG1heEZlYXR1cmVzOjEwLGNsaWNrQ2FsbGJhY2s6XCJjbGlja1wiLGxheWVyczpudWxsLHF1ZXJ5VmlzaWJsZTohMCxpbmZvRm9ybWF0OlwidGV4dC9odG1sXCIsdmVuZG9yUGFyYW1zOnt9LGZvcm1hdDpudWxsLGZvcm1hdE9wdGlvbnM6bnVsbCxoYW5kbGVyT3B0aW9uczpudWxsLGhhbmRsZXI6bnVsbCxob3ZlclJlcXVlc3Q6bnVsbCxwZW5kaW5nOjAsaW5pdGlhbGl6ZTpmdW5jdGlvbihhKXthPWF8fHt9O2EuaGFuZGxlck9wdGlvbnM9YS5oYW5kbGVyT3B0aW9uc3x8e307T3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsW2FdKTt0aGlzLmZvcm1hdHx8KHRoaXMuZm9ybWF0PW5ldyBPcGVuTGF5ZXJzLkZvcm1hdC5XTVNHZXRGZWF0dXJlSW5mbyhhLmZvcm1hdE9wdGlvbnMpKTtcbiEwPT09dGhpcy5kcmlsbERvd24mJih0aGlzLmhvdmVyPSExKTt0aGlzLmhvdmVyP3RoaXMuaGFuZGxlcj1uZXcgT3BlbkxheWVycy5IYW5kbGVyLkhvdmVyKHRoaXMse21vdmU6dGhpcy5jYW5jZWxIb3ZlcixwYXVzZTp0aGlzLmdldEluZm9Gb3JIb3Zlcn0sT3BlbkxheWVycy5VdGlsLmV4dGVuZCh0aGlzLmhhbmRsZXJPcHRpb25zLmhvdmVyfHx7fSx7ZGVsYXk6MjUwfSkpOihhPXt9LGFbdGhpcy5jbGlja0NhbGxiYWNrXT10aGlzLmdldEluZm9Gb3JDbGljayx0aGlzLmhhbmRsZXI9bmV3IE9wZW5MYXllcnMuSGFuZGxlci5DbGljayh0aGlzLGEsdGhpcy5oYW5kbGVyT3B0aW9ucy5jbGlja3x8e30pKX0sZ2V0SW5mb0ZvckNsaWNrOmZ1bmN0aW9uKGEpe3RoaXMucmVxdWVzdChhLnh5LHt9KX0sZ2V0SW5mb0ZvckhvdmVyOmZ1bmN0aW9uKGEpe3RoaXMucmVxdWVzdChhLnh5LHtob3ZlcjohMH0pfSxjYW5jZWxIb3ZlcjpmdW5jdGlvbigpe3RoaXMuaG92ZXJSZXF1ZXN0JiYoLS10aGlzLnBlbmRpbmcsXG4wPj10aGlzLnBlbmRpbmcmJihPcGVuTGF5ZXJzLkVsZW1lbnQucmVtb3ZlQ2xhc3ModGhpcy5tYXAudmlld1BvcnREaXYsXCJvbEN1cnNvcldhaXRcIiksdGhpcy5wZW5kaW5nPTApLHRoaXMuaG92ZXJSZXF1ZXN0LmFib3J0KCksdGhpcy5ob3ZlclJlcXVlc3Q9bnVsbCl9LGZpbmRMYXllcnM6ZnVuY3Rpb24oKXtmb3IodmFyIGE9dGhpcy5sYXllcnN8fHRoaXMubWFwLmxheWVycyxiPVtdLGMsZD1hLmxlbmd0aC0xOzA8PWQ7LS1kKWlmKGM9YVtkXSxjIGluc3RhbmNlb2YgT3BlbkxheWVycy5MYXllci5XTVRTJiZjLnJlcXVlc3RFbmNvZGluZz09PXRoaXMucmVxdWVzdEVuY29kaW5nJiYoIXRoaXMucXVlcnlWaXNpYmxlfHxjLmdldFZpc2liaWxpdHkoKSkpaWYoYi5wdXNoKGMpLCF0aGlzLmRyaWxsRG93bnx8dGhpcy5ob3ZlcilicmVhaztyZXR1cm4gYn0sYnVpbGRSZXF1ZXN0T3B0aW9uczpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMubWFwLmdldExvbkxhdEZyb21QaXhlbChiKSxkPVxuYS5nZXRVUkwobmV3IE9wZW5MYXllcnMuQm91bmRzKGMubG9uLGMubGF0LGMubG9uLGMubGF0KSksZD1PcGVuTGF5ZXJzLlV0aWwuZ2V0UGFyYW1ldGVycyhkKSxjPWEuZ2V0VGlsZUluZm8oYyk7T3BlbkxheWVycy5VdGlsLmV4dGVuZChkLHtzZXJ2aWNlOlwiV01UU1wiLHZlcnNpb246YS52ZXJzaW9uLHJlcXVlc3Q6XCJHZXRGZWF0dXJlSW5mb1wiLGluZm9Gb3JtYXQ6dGhpcy5pbmZvRm9ybWF0LGk6Yy5pLGo6Yy5qfSk7T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoZCx0aGlzLnZlbmRvclBhcmFtcyk7cmV0dXJue3VybDpPcGVuTGF5ZXJzLlV0aWwuaXNBcnJheShhLnVybCk/YS51cmxbMF06YS51cmwscGFyYW1zOk9wZW5MYXllcnMuVXRpbC51cHBlckNhc2VPYmplY3QoZCksY2FsbGJhY2s6ZnVuY3Rpb24oYyl7dGhpcy5oYW5kbGVSZXNwb25zZShiLGMsYSl9LHNjb3BlOnRoaXN9fSxyZXF1ZXN0OmZ1bmN0aW9uKGEsYil7dmFyIGI9Ynx8e30sYz10aGlzLmZpbmRMYXllcnMoKTtcbmlmKDA8Yy5sZW5ndGgpe2Zvcih2YXIgZCxlLGY9MCxnPWMubGVuZ3RoO2Y8ZztmKyspZT1jW2ZdLGQ9dGhpcy5ldmVudHMudHJpZ2dlckV2ZW50KFwiYmVmb3JlZ2V0ZmVhdHVyZWluZm9cIix7eHk6YSxsYXllcjplfSksITEhPT1kJiYoKyt0aGlzLnBlbmRpbmcsZD10aGlzLmJ1aWxkUmVxdWVzdE9wdGlvbnMoZSxhKSxkPU9wZW5MYXllcnMuUmVxdWVzdC5HRVQoZCksITA9PT1iLmhvdmVyJiYodGhpcy5ob3ZlclJlcXVlc3Q9ZCkpOzA8dGhpcy5wZW5kaW5nJiZPcGVuTGF5ZXJzLkVsZW1lbnQuYWRkQ2xhc3ModGhpcy5tYXAudmlld1BvcnREaXYsXCJvbEN1cnNvcldhaXRcIil9fSxoYW5kbGVSZXNwb25zZTpmdW5jdGlvbihhLGIsYyl7LS10aGlzLnBlbmRpbmc7MD49dGhpcy5wZW5kaW5nJiYoT3BlbkxheWVycy5FbGVtZW50LnJlbW92ZUNsYXNzKHRoaXMubWFwLnZpZXdQb3J0RGl2LFwib2xDdXJzb3JXYWl0XCIpLHRoaXMucGVuZGluZz0wKTtpZihiLnN0YXR1cyYmKDIwMD5iLnN0YXR1c3x8XG4zMDA8PWIuc3RhdHVzKSl0aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJleGNlcHRpb25cIix7eHk6YSxyZXF1ZXN0OmIsbGF5ZXI6Y30pO2Vsc2V7dmFyIGQ9Yi5yZXNwb25zZVhNTDtpZighZHx8IWQuZG9jdW1lbnRFbGVtZW50KWQ9Yi5yZXNwb25zZVRleHQ7dmFyIGUsZjt0cnl7ZT10aGlzLmZvcm1hdC5yZWFkKGQpfWNhdGNoKGcpe2Y9ITAsdGhpcy5ldmVudHMudHJpZ2dlckV2ZW50KFwiZXhjZXB0aW9uXCIse3h5OmEscmVxdWVzdDpiLGVycm9yOmcsbGF5ZXI6Y30pfWZ8fHRoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcImdldGZlYXR1cmVpbmZvXCIse3RleHQ6Yi5yZXNwb25zZVRleHQsZmVhdHVyZXM6ZSxyZXF1ZXN0OmIseHk6YSxsYXllcjpjfSl9fSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Db250cm9sLldNVFNHZXRGZWF0dXJlSW5mb1wifSk7T3BlbkxheWVycy5TdHJhdGVneS5QYWdpbmc9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLlN0cmF0ZWd5LHtmZWF0dXJlczpudWxsLGxlbmd0aDoxMCxudW06bnVsbCxwYWdpbmc6ITEsYWN0aXZhdGU6ZnVuY3Rpb24oKXt2YXIgYT1PcGVuTGF5ZXJzLlN0cmF0ZWd5LnByb3RvdHlwZS5hY3RpdmF0ZS5jYWxsKHRoaXMpO2lmKGEpdGhpcy5sYXllci5ldmVudHMub24oe2JlZm9yZWZlYXR1cmVzYWRkZWQ6dGhpcy5jYWNoZUZlYXR1cmVzLHNjb3BlOnRoaXN9KTtyZXR1cm4gYX0sZGVhY3RpdmF0ZTpmdW5jdGlvbigpe3ZhciBhPU9wZW5MYXllcnMuU3RyYXRlZ3kucHJvdG90eXBlLmRlYWN0aXZhdGUuY2FsbCh0aGlzKTthJiYodGhpcy5jbGVhckNhY2hlKCksdGhpcy5sYXllci5ldmVudHMudW4oe2JlZm9yZWZlYXR1cmVzYWRkZWQ6dGhpcy5jYWNoZUZlYXR1cmVzLHNjb3BlOnRoaXN9KSk7cmV0dXJuIGF9LGNhY2hlRmVhdHVyZXM6ZnVuY3Rpb24oYSl7dGhpcy5wYWdpbmd8fCh0aGlzLmNsZWFyQ2FjaGUoKSxcbnRoaXMuZmVhdHVyZXM9YS5mZWF0dXJlcyx0aGlzLnBhZ2VOZXh0KGEpKX0sY2xlYXJDYWNoZTpmdW5jdGlvbigpe2lmKHRoaXMuZmVhdHVyZXMpZm9yKHZhciBhPTA7YTx0aGlzLmZlYXR1cmVzLmxlbmd0aDsrK2EpdGhpcy5mZWF0dXJlc1thXS5kZXN0cm95KCk7dGhpcy5udW09dGhpcy5mZWF0dXJlcz1udWxsfSxwYWdlQ291bnQ6ZnVuY3Rpb24oKXtyZXR1cm4gTWF0aC5jZWlsKCh0aGlzLmZlYXR1cmVzP3RoaXMuZmVhdHVyZXMubGVuZ3RoOjApL3RoaXMubGVuZ3RoKX0scGFnZU51bTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm51bX0scGFnZUxlbmd0aDpmdW5jdGlvbihhKXthJiYwPGEmJih0aGlzLmxlbmd0aD1hKTtyZXR1cm4gdGhpcy5sZW5ndGh9LHBhZ2VOZXh0OmZ1bmN0aW9uKGEpe3ZhciBiPSExO3RoaXMuZmVhdHVyZXMmJihudWxsPT09dGhpcy5udW0mJih0aGlzLm51bT0tMSksYj10aGlzLnBhZ2UoKHRoaXMubnVtKzEpKnRoaXMubGVuZ3RoLGEpKTtyZXR1cm4gYn0scGFnZVByZXZpb3VzOmZ1bmN0aW9uKCl7dmFyIGE9XG4hMTt0aGlzLmZlYXR1cmVzJiYobnVsbD09PXRoaXMubnVtJiYodGhpcy5udW09dGhpcy5wYWdlQ291bnQoKSksYT10aGlzLnBhZ2UoKHRoaXMubnVtLTEpKnRoaXMubGVuZ3RoKSk7cmV0dXJuIGF9LHBhZ2U6ZnVuY3Rpb24oYSxiKXt2YXIgYz0hMTtpZih0aGlzLmZlYXR1cmVzJiYwPD1hJiZhPHRoaXMuZmVhdHVyZXMubGVuZ3RoKXt2YXIgZD1NYXRoLmZsb29yKGEvdGhpcy5sZW5ndGgpO2QhPXRoaXMubnVtJiYodGhpcy5wYWdpbmc9ITAsYz10aGlzLmZlYXR1cmVzLnNsaWNlKGEsYSt0aGlzLmxlbmd0aCksdGhpcy5sYXllci5yZW1vdmVGZWF0dXJlcyh0aGlzLmxheWVyLmZlYXR1cmVzKSx0aGlzLm51bT1kLGImJmIuZmVhdHVyZXM/Yi5mZWF0dXJlcz1jOnRoaXMubGF5ZXIuYWRkRmVhdHVyZXMoYyksdGhpcy5wYWdpbmc9ITEsYz0hMCl9cmV0dXJuIGN9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLlN0cmF0ZWd5LlBhZ2luZ1wifSk7T3BlbkxheWVycy5Qcm90b2NvbC5DU1cudjJfMF8yPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Qcm90b2NvbCx7Zm9ybWF0T3B0aW9uczpudWxsLGluaXRpYWxpemU6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5Qcm90b2NvbC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLFthXSk7YS5mb3JtYXR8fCh0aGlzLmZvcm1hdD1uZXcgT3BlbkxheWVycy5Gb3JtYXQuQ1NXR2V0UmVjb3Jkcy52Ml8wXzIoT3BlbkxheWVycy5VdGlsLmV4dGVuZCh7fSx0aGlzLmZvcm1hdE9wdGlvbnMpKSl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLm9wdGlvbnMmJiF0aGlzLm9wdGlvbnMuZm9ybWF0JiZ0aGlzLmZvcm1hdC5kZXN0cm95KCk7dGhpcy5mb3JtYXQ9bnVsbDtPcGVuTGF5ZXJzLlByb3RvY29sLnByb3RvdHlwZS5kZXN0cm95LmFwcGx5KHRoaXMpfSxyZWFkOmZ1bmN0aW9uKGEpe2E9T3BlbkxheWVycy5VdGlsLmV4dGVuZCh7fSxhKTtPcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyhhLFxudGhpcy5vcHRpb25zfHx7fSk7dmFyIGI9bmV3IE9wZW5MYXllcnMuUHJvdG9jb2wuUmVzcG9uc2Uoe3JlcXVlc3RUeXBlOlwicmVhZFwifSksYz10aGlzLmZvcm1hdC53cml0ZShhLnBhcmFtcyk7Yi5wcml2PU9wZW5MYXllcnMuUmVxdWVzdC5QT1NUKHt1cmw6YS51cmwsY2FsbGJhY2s6dGhpcy5jcmVhdGVDYWxsYmFjayh0aGlzLmhhbmRsZVJlYWQsYixhKSxwYXJhbXM6YS5wYXJhbXMsaGVhZGVyczphLmhlYWRlcnMsZGF0YTpjfSk7cmV0dXJuIGJ9LGhhbmRsZVJlYWQ6ZnVuY3Rpb24oYSxiKXtpZihiLmNhbGxiYWNrKXt2YXIgYz1hLnByaXY7MjAwPD1jLnN0YXR1cyYmMzAwPmMuc3RhdHVzPyhhLmRhdGE9dGhpcy5wYXJzZURhdGEoYyksYS5jb2RlPU9wZW5MYXllcnMuUHJvdG9jb2wuUmVzcG9uc2UuU1VDQ0VTUyk6YS5jb2RlPU9wZW5MYXllcnMuUHJvdG9jb2wuUmVzcG9uc2UuRkFJTFVSRTtiLmNhbGxiYWNrLmNhbGwoYi5zY29wZSxhKX19LHBhcnNlRGF0YTpmdW5jdGlvbihhKXt2YXIgYj1cbmEucmVzcG9uc2VYTUw7aWYoIWJ8fCFiLmRvY3VtZW50RWxlbWVudCliPWEucmVzcG9uc2VUZXh0O3JldHVybiFifHwwPj1iLmxlbmd0aD9udWxsOnRoaXMuZm9ybWF0LnJlYWQoYil9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLlByb3RvY29sLkNTVy52Ml8wXzJcIn0pO09wZW5MYXllcnMuRm9ybWF0LldNU0NhcGFiaWxpdGllcy52MV8xPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Gb3JtYXQuV01TQ2FwYWJpbGl0aWVzLnYxLHtyZWFkZXJzOnt3bXM6T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoe1dNVF9NU19DYXBhYmlsaXRpZXM6ZnVuY3Rpb24oYSxiKXt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYil9LEtleXdvcmQ6ZnVuY3Rpb24oYSxiKXtiLmtleXdvcmRzJiZiLmtleXdvcmRzLnB1c2godGhpcy5nZXRDaGlsZFZhbHVlKGEpKX0sRGVzY3JpYmVMYXllcjpmdW5jdGlvbihhLGIpe2IuZGVzY3JpYmVsYXllcj17Zm9ybWF0czpbXX07dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIuZGVzY3JpYmVsYXllcil9LEdldExlZ2VuZEdyYXBoaWM6ZnVuY3Rpb24oYSxiKXtiLmdldGxlZ2VuZGdyYXBoaWM9e2Zvcm1hdHM6W119O3RoaXMucmVhZENoaWxkTm9kZXMoYSxiLmdldGxlZ2VuZGdyYXBoaWMpfSxHZXRTdHlsZXM6ZnVuY3Rpb24oYSxiKXtiLmdldHN0eWxlcz1cbntmb3JtYXRzOltdfTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYi5nZXRzdHlsZXMpfSxQdXRTdHlsZXM6ZnVuY3Rpb24oYSxiKXtiLnB1dHN0eWxlcz17Zm9ybWF0czpbXX07dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIucHV0c3R5bGVzKX0sVXNlckRlZmluZWRTeW1ib2xpemF0aW9uOmZ1bmN0aW9uKGEsYil7dmFyIGM9e3N1cHBvcnRTTEQ6MT09cGFyc2VJbnQoYS5nZXRBdHRyaWJ1dGUoXCJTdXBwb3J0U0xEXCIpKSx1c2VyTGF5ZXI6MT09cGFyc2VJbnQoYS5nZXRBdHRyaWJ1dGUoXCJVc2VyTGF5ZXJcIikpLHVzZXJTdHlsZToxPT1wYXJzZUludChhLmdldEF0dHJpYnV0ZShcIlVzZXJTdHlsZVwiKSkscmVtb3RlV0ZTOjE9PXBhcnNlSW50KGEuZ2V0QXR0cmlidXRlKFwiUmVtb3RlV0ZTXCIpKX07Yi51c2VyU3ltYm9scz1jfSxMYXRMb25Cb3VuZGluZ0JveDpmdW5jdGlvbihhLGIpe2IubGxiYm94PVtwYXJzZUZsb2F0KGEuZ2V0QXR0cmlidXRlKFwibWlueFwiKSkscGFyc2VGbG9hdChhLmdldEF0dHJpYnV0ZShcIm1pbnlcIikpLFxucGFyc2VGbG9hdChhLmdldEF0dHJpYnV0ZShcIm1heHhcIikpLHBhcnNlRmxvYXQoYS5nZXRBdHRyaWJ1dGUoXCJtYXh5XCIpKV19LEJvdW5kaW5nQm94OmZ1bmN0aW9uKGEsYil7dmFyIGM9T3BlbkxheWVycy5Gb3JtYXQuV01TQ2FwYWJpbGl0aWVzLnYxLnByb3RvdHlwZS5yZWFkZXJzLndtcy5Cb3VuZGluZ0JveC5hcHBseSh0aGlzLFthLGJdKTtjLnNycz1hLmdldEF0dHJpYnV0ZShcIlNSU1wiKTtiLmJib3hbYy5zcnNdPWN9LFNjYWxlSGludDpmdW5jdGlvbihhLGIpe3ZhciBjPWEuZ2V0QXR0cmlidXRlKFwibWluXCIpLGQ9YS5nZXRBdHRyaWJ1dGUoXCJtYXhcIiksZT1NYXRoLnBvdygyLDAuNSksZj1PcGVuTGF5ZXJzLklOQ0hFU19QRVJfVU5JVC5tO2IubWF4U2NhbGU9cGFyc2VGbG9hdCgoYy9lKmYqT3BlbkxheWVycy5ET1RTX1BFUl9JTkNIKS50b1ByZWNpc2lvbigxMykpO2IubWluU2NhbGU9cGFyc2VGbG9hdCgoZC9lKmYqT3BlbkxheWVycy5ET1RTX1BFUl9JTkNIKS50b1ByZWNpc2lvbigxMykpfSxcbkRpbWVuc2lvbjpmdW5jdGlvbihhLGIpe3ZhciBjPXtuYW1lOmEuZ2V0QXR0cmlidXRlKFwibmFtZVwiKS50b0xvd2VyQ2FzZSgpLHVuaXRzOmEuZ2V0QXR0cmlidXRlKFwidW5pdHNcIiksdW5pdHN5bWJvbDphLmdldEF0dHJpYnV0ZShcInVuaXRTeW1ib2xcIil9O2IuZGltZW5zaW9uc1tjLm5hbWVdPWN9LEV4dGVudDpmdW5jdGlvbihhLGIpe3ZhciBjPWEuZ2V0QXR0cmlidXRlKFwibmFtZVwiKS50b0xvd2VyQ2FzZSgpO2lmKGMgaW4gYi5kaW1lbnNpb25zKXtjPWIuZGltZW5zaW9uc1tjXTtjLm5lYXJlc3RWYWw9XCIxXCI9PT1hLmdldEF0dHJpYnV0ZShcIm5lYXJlc3RWYWx1ZVwiKTtjLm11bHRpcGxlVmFsPVwiMVwiPT09YS5nZXRBdHRyaWJ1dGUoXCJtdWx0aXBsZVZhbHVlc1wiKTtjLmN1cnJlbnQ9XCIxXCI9PT1hLmdldEF0dHJpYnV0ZShcImN1cnJlbnRcIik7Y1tcImRlZmF1bHRcIl09YS5nZXRBdHRyaWJ1dGUoXCJkZWZhdWx0XCIpfHxcIlwiO3ZhciBkPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKTtjLnZhbHVlcz1kLnNwbGl0KFwiLFwiKX19fSxcbk9wZW5MYXllcnMuRm9ybWF0LldNU0NhcGFiaWxpdGllcy52MS5wcm90b3R5cGUucmVhZGVycy53bXMpfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Gb3JtYXQuV01TQ2FwYWJpbGl0aWVzLnYxXzFcIn0pO09wZW5MYXllcnMuQ29udHJvbC5HcmF0aWN1bGU9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkNvbnRyb2wse2F1dG9BY3RpdmF0ZTohMCxpbnRlcnZhbHM6WzQ1LDMwLDIwLDEwLDUsMiwxLDAuNSwwLjIsMC4xLDAuMDUsMC4wMSwwLjAwNSwwLjAwMiwwLjAwMV0sZGlzcGxheUluTGF5ZXJTd2l0Y2hlcjohMCx2aXNpYmxlOiEwLG51bVBvaW50czo1MCx0YXJnZXRTaXplOjIwMCxsYXllck5hbWU6bnVsbCxsYWJlbGxlZDohMCxsYWJlbEZvcm1hdDpcImRtXCIsbGluZVN5bWJvbGl6ZXI6e3N0cm9rZUNvbG9yOlwiIzMzM1wiLHN0cm9rZVdpZHRoOjEsc3Ryb2tlT3BhY2l0eTowLjV9LGxhYmVsU3ltYm9saXplcjp7fSxncmF0TGF5ZXI6bnVsbCxpbml0aWFsaXplOmZ1bmN0aW9uKGEpe2E9YXx8e307YS5sYXllck5hbWU9YS5sYXllck5hbWV8fE9wZW5MYXllcnMuaTE4bihcIkdyYXRpY3VsZVwiKTtPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbYV0pO1xudGhpcy5sYWJlbFN5bWJvbGl6ZXIuc3Ryb2tlPSExO3RoaXMubGFiZWxTeW1ib2xpemVyLmZpbGw9ITE7dGhpcy5sYWJlbFN5bWJvbGl6ZXIubGFiZWw9XCIke2xhYmVsfVwiO3RoaXMubGFiZWxTeW1ib2xpemVyLmxhYmVsQWxpZ249XCIke2xhYmVsQWxpZ259XCI7dGhpcy5sYWJlbFN5bWJvbGl6ZXIubGFiZWxYT2Zmc2V0PVwiJHt4T2Zmc2V0fVwiO3RoaXMubGFiZWxTeW1ib2xpemVyLmxhYmVsWU9mZnNldD1cIiR7eU9mZnNldH1cIn0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMuZGVhY3RpdmF0ZSgpO09wZW5MYXllcnMuQ29udHJvbC5wcm90b3R5cGUuZGVzdHJveS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5ncmF0TGF5ZXImJih0aGlzLmdyYXRMYXllci5kZXN0cm95KCksdGhpcy5ncmF0TGF5ZXI9bnVsbCl9LGRyYXc6ZnVuY3Rpb24oKXtPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmRyYXcuYXBwbHkodGhpcyxhcmd1bWVudHMpO2lmKCF0aGlzLmdyYXRMYXllcil7dmFyIGE9bmV3IE9wZW5MYXllcnMuU3R5bGUoe30sXG57cnVsZXM6W25ldyBPcGVuTGF5ZXJzLlJ1bGUoe3N5bWJvbGl6ZXI6e1BvaW50OnRoaXMubGFiZWxTeW1ib2xpemVyLExpbmU6dGhpcy5saW5lU3ltYm9saXplcn19KV19KTt0aGlzLmdyYXRMYXllcj1uZXcgT3BlbkxheWVycy5MYXllci5WZWN0b3IodGhpcy5sYXllck5hbWUse3N0eWxlTWFwOm5ldyBPcGVuTGF5ZXJzLlN0eWxlTWFwKHtcImRlZmF1bHRcIjphfSksdmlzaWJpbGl0eTp0aGlzLnZpc2libGUsZGlzcGxheUluTGF5ZXJTd2l0Y2hlcjp0aGlzLmRpc3BsYXlJbkxheWVyU3dpdGNoZXJ9KX1yZXR1cm4gdGhpcy5kaXZ9LGFjdGl2YXRlOmZ1bmN0aW9uKCl7cmV0dXJuIE9wZW5MYXllcnMuQ29udHJvbC5wcm90b3R5cGUuYWN0aXZhdGUuYXBwbHkodGhpcyxhcmd1bWVudHMpPyh0aGlzLm1hcC5hZGRMYXllcih0aGlzLmdyYXRMYXllciksdGhpcy5tYXAuZXZlbnRzLnJlZ2lzdGVyKFwibW92ZWVuZFwiLHRoaXMsdGhpcy51cGRhdGUpLHRoaXMudXBkYXRlKCksITApOiExfSxkZWFjdGl2YXRlOmZ1bmN0aW9uKCl7cmV0dXJuIE9wZW5MYXllcnMuQ29udHJvbC5wcm90b3R5cGUuZGVhY3RpdmF0ZS5hcHBseSh0aGlzLFxuYXJndW1lbnRzKT8odGhpcy5tYXAuZXZlbnRzLnVucmVnaXN0ZXIoXCJtb3ZlZW5kXCIsdGhpcyx0aGlzLnVwZGF0ZSksdGhpcy5tYXAucmVtb3ZlTGF5ZXIodGhpcy5ncmF0TGF5ZXIpLCEwKTohMX0sdXBkYXRlOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tYXAuZ2V0RXh0ZW50KCk7aWYoYSl7dGhpcy5ncmF0TGF5ZXIuZGVzdHJveUZlYXR1cmVzKCk7dmFyIGI9bmV3IE9wZW5MYXllcnMuUHJvamVjdGlvbihcIkVQU0c6NDMyNlwiKSxjPXRoaXMubWFwLmdldFByb2plY3Rpb25PYmplY3QoKSxkPXRoaXMubWFwLmdldFJlc29sdXRpb24oKTtjLnByb2omJlwibG9uZ2xhdFwiPT1jLnByb2oucHJvak5hbWUmJih0aGlzLm51bVBvaW50cz0xKTt2YXIgZT10aGlzLm1hcC5nZXRDZW50ZXIoKSxmPW5ldyBPcGVuTGF5ZXJzLlBpeGVsKGUubG9uLGUubGF0KTtPcGVuTGF5ZXJzLlByb2plY3Rpb24udHJhbnNmb3JtKGYsYyxiKTtmb3IodmFyIGU9dGhpcy50YXJnZXRTaXplKmQsZT1lKmUsZyxkPTA7ZDx0aGlzLmludGVydmFscy5sZW5ndGg7KytkKXtnPVxudGhpcy5pbnRlcnZhbHNbZF07dmFyIGg9Zy8yLGk9Zi5vZmZzZXQoe3g6LWgseTotaH0pLGg9Zi5vZmZzZXQoe3g6aCx5Omh9KTtPcGVuTGF5ZXJzLlByb2plY3Rpb24udHJhbnNmb3JtKGksYixjKTtPcGVuTGF5ZXJzLlByb2plY3Rpb24udHJhbnNmb3JtKGgsYixjKTtpZigoaS54LWgueCkqKGkueC1oLngpKyhpLnktaC55KSooaS55LWgueSk8PWUpYnJlYWt9Zi54PU1hdGguZmxvb3IoZi54L2cpKmc7Zi55PU1hdGguZmxvb3IoZi55L2cpKmc7dmFyIGQ9MCxlPVtmLmNsb25lKCldLGg9Zi5jbG9uZSgpLGo7ZG8gaD1oLm9mZnNldCh7eDowLHk6Z30pLGo9T3BlbkxheWVycy5Qcm9qZWN0aW9uLnRyYW5zZm9ybShoLmNsb25lKCksYixjKSxlLnVuc2hpZnQoaCk7d2hpbGUoYS5jb250YWluc1BpeGVsKGopJiYxRTM+KytkKTtoPWYuY2xvbmUoKTtkbyBoPWgub2Zmc2V0KHt4OjAseTotZ30pLGo9T3BlbkxheWVycy5Qcm9qZWN0aW9uLnRyYW5zZm9ybShoLmNsb25lKCksYixjKSxlLnB1c2goaCk7XG53aGlsZShhLmNvbnRhaW5zUGl4ZWwoaikmJjFFMz4rK2QpO2Q9MDtpPVtmLmNsb25lKCldO2g9Zi5jbG9uZSgpO2RvIGg9aC5vZmZzZXQoe3g6LWcseTowfSksaj1PcGVuTGF5ZXJzLlByb2plY3Rpb24udHJhbnNmb3JtKGguY2xvbmUoKSxiLGMpLGkudW5zaGlmdChoKTt3aGlsZShhLmNvbnRhaW5zUGl4ZWwoaikmJjFFMz4rK2QpO2g9Zi5jbG9uZSgpO2RvIGg9aC5vZmZzZXQoe3g6Zyx5OjB9KSxqPU9wZW5MYXllcnMuUHJvamVjdGlvbi50cmFuc2Zvcm0oaC5jbG9uZSgpLGIsYyksaS5wdXNoKGgpO3doaWxlKGEuY29udGFpbnNQaXhlbChqKSYmMUUzPisrZCk7Zz1bXTtmb3IoZD0wO2Q8aS5sZW5ndGg7KytkKXtqPWlbZF0ueDtmb3IodmFyIGY9W10saz1udWxsLGw9TWF0aC5taW4oZVswXS55LDkwKSxoPU1hdGgubWF4KGVbZS5sZW5ndGgtMV0ueSwtOTApLG09KGwtaCkvdGhpcy5udW1Qb2ludHMsbD1oLGg9MDtoPD10aGlzLm51bVBvaW50czsrK2gpe3ZhciBuPW5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGosXG5sKTtuLnRyYW5zZm9ybShiLGMpO2YucHVzaChuKTtsKz1tO24ueT49YS5ib3R0b20mJiFrJiYoaz1uKX10aGlzLmxhYmVsbGVkJiYoaz1uZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChrLngsYS5ib3R0b20pLGo9e3ZhbHVlOmosbGFiZWw6dGhpcy5sYWJlbGxlZD9PcGVuTGF5ZXJzLlV0aWwuZ2V0Rm9ybWF0dGVkTG9uTGF0KGosXCJsb25cIix0aGlzLmxhYmVsRm9ybWF0KTpcIlwiLGxhYmVsQWxpZ246XCJjYlwiLHhPZmZzZXQ6MCx5T2Zmc2V0OjJ9LHRoaXMuZ3JhdExheWVyLmFkZEZlYXR1cmVzKG5ldyBPcGVuTGF5ZXJzLkZlYXR1cmUuVmVjdG9yKGssaikpKTtmPW5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVTdHJpbmcoZik7Zy5wdXNoKG5ldyBPcGVuTGF5ZXJzLkZlYXR1cmUuVmVjdG9yKGYpKX1mb3IoaD0wO2g8ZS5sZW5ndGg7KytoKWlmKGw9ZVtoXS55LCEoLTkwPmx8fDkwPGwpKXtmPVtdO2Q9aVswXS54O209KGlbaS5sZW5ndGgtMV0ueC1kKS90aGlzLm51bVBvaW50cztcbmo9ZDtrPW51bGw7Zm9yKGQ9MDtkPD10aGlzLm51bVBvaW50czsrK2Qpbj1uZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChqLGwpLG4udHJhbnNmb3JtKGIsYyksZi5wdXNoKG4pLGorPW0sbi54PGEucmlnaHQmJihrPW4pO3RoaXMubGFiZWxsZWQmJihrPW5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGEucmlnaHQsay55KSxqPXt2YWx1ZTpsLGxhYmVsOnRoaXMubGFiZWxsZWQ/T3BlbkxheWVycy5VdGlsLmdldEZvcm1hdHRlZExvbkxhdChsLFwibGF0XCIsdGhpcy5sYWJlbEZvcm1hdCk6XCJcIixsYWJlbEFsaWduOlwicmJcIix4T2Zmc2V0Oi0yLHlPZmZzZXQ6Mn0sdGhpcy5ncmF0TGF5ZXIuYWRkRmVhdHVyZXMobmV3IE9wZW5MYXllcnMuRmVhdHVyZS5WZWN0b3IoayxqKSkpO2Y9bmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuTGluZVN0cmluZyhmKTtnLnB1c2gobmV3IE9wZW5MYXllcnMuRmVhdHVyZS5WZWN0b3IoZikpfXRoaXMuZ3JhdExheWVyLmFkZEZlYXR1cmVzKGcpfX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuQ29udHJvbC5HcmF0aWN1bGVcIn0pO09wZW5MYXllcnMuTGF5ZXIuVVRGR3JpZD1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuTGF5ZXIuWFlaLHtpc0Jhc2VMYXllcjohMSxwcm9qZWN0aW9uOm5ldyBPcGVuTGF5ZXJzLlByb2plY3Rpb24oXCJFUFNHOjkwMDkxM1wiKSx1c2VKU09OUDohMSx0aWxlQ2xhc3M6T3BlbkxheWVycy5UaWxlLlVURkdyaWQsaW5pdGlhbGl6ZTpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLkxheWVyLkdyaWQucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbYS5uYW1lLGEudXJsLHt9LGFdKTt0aGlzLnRpbGVPcHRpb25zPU9wZW5MYXllcnMuVXRpbC5leHRlbmQoe3V0ZmdyaWRSZXNvbHV0aW9uOnRoaXMudXRmZ3JpZFJlc29sdXRpb259LHRoaXMudGlsZU9wdGlvbnMpfSxjbG9uZTpmdW5jdGlvbihhKXtudWxsPT1hJiYoYT1uZXcgT3BlbkxheWVycy5MYXllci5VVEZHcmlkKHRoaXMuZ2V0T3B0aW9ucygpKSk7cmV0dXJuIGE9T3BlbkxheWVycy5MYXllci5HcmlkLnByb3RvdHlwZS5jbG9uZS5hcHBseSh0aGlzLFxuW2FdKX0sZ2V0RmVhdHVyZUluZm86ZnVuY3Rpb24oYSl7dmFyIGI9bnVsbCxhPXRoaXMuZ2V0VGlsZURhdGEoYSk7YS50aWxlJiYoYj1hLnRpbGUuZ2V0RmVhdHVyZUluZm8oYS5pLGEuaikpO3JldHVybiBifSxnZXRGZWF0dXJlSWQ6ZnVuY3Rpb24oYSl7dmFyIGI9bnVsbCxhPXRoaXMuZ2V0VGlsZURhdGEoYSk7YS50aWxlJiYoYj1hLnRpbGUuZ2V0RmVhdHVyZUlkKGEuaSxhLmopKTtyZXR1cm4gYn0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuTGF5ZXIuVVRGR3JpZFwifSk7T3BlbkxheWVycy5MYXllci5BcmNHSVNDYWNoZT1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuTGF5ZXIuWFlaLHt1cmw6bnVsbCx0aWxlT3JpZ2luOm51bGwsdGlsZVNpemU6bmV3IE9wZW5MYXllcnMuU2l6ZSgyNTYsMjU2KSx1c2VBcmNHSVNTZXJ2ZXI6ITAsdHlwZTpcInBuZ1wiLHVzZVNjYWxlczohMSxvdmVycmlkZURQSTohMSxpbml0aWFsaXplOmZ1bmN0aW9uKGEsYixjKXtPcGVuTGF5ZXJzLkxheWVyLlhZWi5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5yZXNvbHV0aW9ucyYmKHRoaXMuc2VydmVyUmVzb2x1dGlvbnM9dGhpcy5yZXNvbHV0aW9ucyx0aGlzLm1heEV4dGVudD10aGlzLmdldE1heEV4dGVudEZvclJlc29sdXRpb24odGhpcy5yZXNvbHV0aW9uc1swXSkpO2lmKHRoaXMubGF5ZXJJbmZvKXt2YXIgZD10aGlzLmxheWVySW5mbyxlPW5ldyBPcGVuTGF5ZXJzLkJvdW5kcyhkLmZ1bGxFeHRlbnQueG1pbixkLmZ1bGxFeHRlbnQueW1pbixcbmQuZnVsbEV4dGVudC54bWF4LGQuZnVsbEV4dGVudC55bWF4KTt0aGlzLnByb2plY3Rpb249XCJFUFNHOlwiK2Quc3BhdGlhbFJlZmVyZW5jZS53a2lkO3RoaXMuc3BoZXJpY2FsTWVyY2F0b3I9MTAyMTAwPT1kLnNwYXRpYWxSZWZlcmVuY2Uud2tpZDt0aGlzLnVuaXRzPVwiZXNyaUZlZXRcIj09ZC51bml0cz9cImZ0XCI6XCJtXCI7aWYoZC50aWxlSW5mbyl7dGhpcy50aWxlU2l6ZT1uZXcgT3BlbkxheWVycy5TaXplKGQudGlsZUluZm8ud2lkdGh8fGQudGlsZUluZm8uY29scyxkLnRpbGVJbmZvLmhlaWdodHx8ZC50aWxlSW5mby5yb3dzKTt0aGlzLnRpbGVPcmlnaW49bmV3IE9wZW5MYXllcnMuTG9uTGF0KGQudGlsZUluZm8ub3JpZ2luLngsZC50aWxlSW5mby5vcmlnaW4ueSk7dmFyIGY9bmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQoZS5sZWZ0LGUudG9wKSxlPW5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGUucmlnaHQsZS5ib3R0b20pO3RoaXMudXNlU2NhbGVzP3RoaXMuc2NhbGVzPVxuW106dGhpcy5yZXNvbHV0aW9ucz1bXTt0aGlzLmxvZHM9W107Zm9yKHZhciBnIGluIGQudGlsZUluZm8ubG9kcylpZihkLnRpbGVJbmZvLmxvZHMuaGFzT3duUHJvcGVydHkoZykpe3ZhciBoPWQudGlsZUluZm8ubG9kc1tnXTt0aGlzLnVzZVNjYWxlcz90aGlzLnNjYWxlcy5wdXNoKGguc2NhbGUpOnRoaXMucmVzb2x1dGlvbnMucHVzaChoLnJlc29sdXRpb24pO3ZhciBpPXRoaXMuZ2V0Q29udGFpbmluZ1RpbGVDb29yZHMoZixoLnJlc29sdXRpb24pO2guc3RhcnRUaWxlQ29sPWkueDtoLnN0YXJ0VGlsZVJvdz1pLnk7aT10aGlzLmdldENvbnRhaW5pbmdUaWxlQ29vcmRzKGUsaC5yZXNvbHV0aW9uKTtoLmVuZFRpbGVDb2w9aS54O2guZW5kVGlsZVJvdz1pLnk7dGhpcy5sb2RzLnB1c2goaCl9dGhpcy5tYXhFeHRlbnQ9dGhpcy5jYWxjdWxhdGVNYXhFeHRlbnRXaXRoTE9EKHRoaXMubG9kc1swXSk7dGhpcy5zZXJ2ZXJSZXNvbHV0aW9ucz10aGlzLnJlc29sdXRpb25zO3RoaXMub3ZlcnJpZGVEUEkmJlxuZC50aWxlSW5mby5kcGkmJihPcGVuTGF5ZXJzLkRPVFNfUEVSX0lOQ0g9ZC50aWxlSW5mby5kcGkpfX19LGdldENvbnRhaW5pbmdUaWxlQ29vcmRzOmZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBPcGVuTGF5ZXJzLlBpeGVsKE1hdGgubWF4KE1hdGguZmxvb3IoKGEueC10aGlzLnRpbGVPcmlnaW4ubG9uKS8odGhpcy50aWxlU2l6ZS53KmIpKSwwKSxNYXRoLm1heChNYXRoLmZsb29yKCh0aGlzLnRpbGVPcmlnaW4ubGF0LWEueSkvKHRoaXMudGlsZVNpemUuaCpiKSksMCkpfSxjYWxjdWxhdGVNYXhFeHRlbnRXaXRoTE9EOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMudGlsZU9yaWdpbi5sb24rYS5zdGFydFRpbGVDb2wqdGhpcy50aWxlU2l6ZS53KmEucmVzb2x1dGlvbixjPXRoaXMudGlsZU9yaWdpbi5sYXQtYS5zdGFydFRpbGVSb3cqdGhpcy50aWxlU2l6ZS5oKmEucmVzb2x1dGlvbjtyZXR1cm4gbmV3IE9wZW5MYXllcnMuQm91bmRzKGIsYy0oYS5lbmRUaWxlUm93LWEuc3RhcnRUaWxlUm93K1xuMSkqdGhpcy50aWxlU2l6ZS5oKmEucmVzb2x1dGlvbixiKyhhLmVuZFRpbGVDb2wtYS5zdGFydFRpbGVDb2wrMSkqdGhpcy50aWxlU2l6ZS53KmEucmVzb2x1dGlvbixjKX0sY2FsY3VsYXRlTWF4RXh0ZW50V2l0aEV4dGVudDpmdW5jdGlvbihhLGIpe3ZhciBjPW5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGEubGVmdCxhLnRvcCksZD1uZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChhLnJpZ2h0LGEuYm90dG9tKSxjPXRoaXMuZ2V0Q29udGFpbmluZ1RpbGVDb29yZHMoYyxiKSxkPXRoaXMuZ2V0Q29udGFpbmluZ1RpbGVDb29yZHMoZCxiKTtyZXR1cm4gdGhpcy5jYWxjdWxhdGVNYXhFeHRlbnRXaXRoTE9EKHtyZXNvbHV0aW9uOmIsc3RhcnRUaWxlQ29sOmMueCxzdGFydFRpbGVSb3c6Yy55LGVuZFRpbGVDb2w6ZC54LGVuZFRpbGVSb3c6ZC55fSl9LGdldFVwcGVyTGVmdFRpbGVDb29yZDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5nZXRDb250YWluaW5nVGlsZUNvb3JkcyhuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludCh0aGlzLm1heEV4dGVudC5sZWZ0LFxudGhpcy5tYXhFeHRlbnQudG9wKSxhKX0sZ2V0TG93ZXJSaWdodFRpbGVDb29yZDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5nZXRDb250YWluaW5nVGlsZUNvb3JkcyhuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludCh0aGlzLm1heEV4dGVudC5yaWdodCx0aGlzLm1heEV4dGVudC5ib3R0b20pLGEpfSxnZXRNYXhFeHRlbnRGb3JSZXNvbHV0aW9uOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuZ2V0VXBwZXJMZWZ0VGlsZUNvb3JkKGEpLGM9dGhpcy5nZXRMb3dlclJpZ2h0VGlsZUNvb3JkKGEpLGQ9dGhpcy50aWxlT3JpZ2luLmxvbitiLngqdGhpcy50aWxlU2l6ZS53KmEsZT10aGlzLnRpbGVPcmlnaW4ubGF0LWIueSp0aGlzLnRpbGVTaXplLmgqYTtyZXR1cm4gbmV3IE9wZW5MYXllcnMuQm91bmRzKGQsZS0oYy55LWIueSsxKSp0aGlzLnRpbGVTaXplLmgqYSxkKyhjLngtYi54KzEpKnRoaXMudGlsZVNpemUudyphLGUpfSxjbG9uZTpmdW5jdGlvbihhKXtudWxsPT1hJiYoYT1uZXcgT3BlbkxheWVycy5MYXllci5BcmNHSVNDYWNoZSh0aGlzLm5hbWUsXG50aGlzLnVybCx0aGlzLm9wdGlvbnMpKTtyZXR1cm4gT3BlbkxheWVycy5MYXllci5YWVoucHJvdG90eXBlLmNsb25lLmFwcGx5KHRoaXMsW2FdKX0sZ2V0TWF4RXh0ZW50OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWF4RXh0ZW50PXRoaXMuZ2V0TWF4RXh0ZW50Rm9yUmVzb2x1dGlvbih0aGlzLm1hcC5nZXRSZXNvbHV0aW9uKCkpfSxnZXRUaWxlT3JpZ2luOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5nZXRNYXhFeHRlbnQoKTtyZXR1cm4gbmV3IE9wZW5MYXllcnMuTG9uTGF0KGEubGVmdCxhLmJvdHRvbSl9LGdldFVSTDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmdldFJlc29sdXRpb24oKSxjPXRoaXMudGlsZU9yaWdpbi5sb24rYip0aGlzLnRpbGVTaXplLncvMixkPXRoaXMudGlsZU9yaWdpbi5sYXQtYip0aGlzLnRpbGVTaXplLmgvMixhPWEuZ2V0Q2VudGVyTG9uTGF0KCksYz1NYXRoLnJvdW5kKE1hdGguYWJzKChhLmxvbi1jKS8oYip0aGlzLnRpbGVTaXplLncpKSksZD1NYXRoLnJvdW5kKE1hdGguYWJzKChkLVxuYS5sYXQpLyhiKnRoaXMudGlsZVNpemUuaCkpKSxhPXRoaXMubWFwLmdldFpvb20oKTtpZih0aGlzLmxvZHMpe2lmKGI9dGhpcy5sb2RzW3RoaXMubWFwLmdldFpvb20oKV0sYzxiLnN0YXJ0VGlsZUNvbHx8Yz5iLmVuZFRpbGVDb2x8fGQ8Yi5zdGFydFRpbGVSb3d8fGQ+Yi5lbmRUaWxlUm93KXJldHVybiBudWxsfWVsc2V7dmFyIGU9dGhpcy5nZXRVcHBlckxlZnRUaWxlQ29vcmQoYiksYj10aGlzLmdldExvd2VyUmlnaHRUaWxlQ29vcmQoYik7aWYoYzxlLnh8fGM+PWIueHx8ZDxlLnl8fGQ+PWIueSlyZXR1cm4gbnVsbH1iPXRoaXMudXJsO2U9XCJcIitjK2QrYTtPcGVuTGF5ZXJzLlV0aWwuaXNBcnJheShiKSYmKGI9dGhpcy5zZWxlY3RVcmwoZSxiKSk7dGhpcy51c2VBcmNHSVNTZXJ2ZXI/Yis9XCIvdGlsZS8ke3p9LyR7eX0vJHt4fVwiOihjPVwiQ1wiK3RoaXMuemVyb1BhZChjLDgsMTYpLGQ9XCJSXCIrdGhpcy56ZXJvUGFkKGQsOCwxNiksYT1cIkxcIit0aGlzLnplcm9QYWQoYSwyLDE2KSxiPVxuYitcIi8ke3p9LyR7eX0vJHt4fS5cIit0aGlzLnR5cGUpO2I9T3BlbkxheWVycy5TdHJpbmcuZm9ybWF0KGIse3g6Yyx5OmQsejphfSk7cmV0dXJuIE9wZW5MYXllcnMuVXRpbC51cmxBcHBlbmQoYixPcGVuTGF5ZXJzLlV0aWwuZ2V0UGFyYW1ldGVyU3RyaW5nKHRoaXMucGFyYW1zKSl9LHplcm9QYWQ6ZnVuY3Rpb24oYSxiLGMpe2ZvcihhPWEudG9TdHJpbmcoY3x8MTApO2EubGVuZ3RoPGI7KWE9XCIwXCIrYTtyZXR1cm4gYX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuTGF5ZXIuQXJjR0lTQ2FjaGVcIn0pO09wZW5MYXllcnMuQ29udHJvbC5XTVNHZXRGZWF0dXJlSW5mbz1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuQ29udHJvbCx7aG92ZXI6ITEsZHJpbGxEb3duOiExLG1heEZlYXR1cmVzOjEwLGNsaWNrQ2FsbGJhY2s6XCJjbGlja1wiLG91dHB1dDpcImZlYXR1cmVzXCIsbGF5ZXJzOm51bGwscXVlcnlWaXNpYmxlOiExLHVybDpudWxsLGxheWVyVXJsczpudWxsLGluZm9Gb3JtYXQ6XCJ0ZXh0L2h0bWxcIix2ZW5kb3JQYXJhbXM6e30sZm9ybWF0Om51bGwsZm9ybWF0T3B0aW9uczpudWxsLGhhbmRsZXJPcHRpb25zOm51bGwsaGFuZGxlcjpudWxsLGhvdmVyUmVxdWVzdDpudWxsLGluaXRpYWxpemU6ZnVuY3Rpb24oYSl7YT1hfHx7fTthLmhhbmRsZXJPcHRpb25zPWEuaGFuZGxlck9wdGlvbnN8fHt9O09wZW5MYXllcnMuQ29udHJvbC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLFthXSk7dGhpcy5mb3JtYXR8fCh0aGlzLmZvcm1hdD1uZXcgT3BlbkxheWVycy5Gb3JtYXQuV01TR2V0RmVhdHVyZUluZm8oYS5mb3JtYXRPcHRpb25zKSk7XG4hMD09PXRoaXMuZHJpbGxEb3duJiYodGhpcy5ob3Zlcj0hMSk7dGhpcy5ob3Zlcj90aGlzLmhhbmRsZXI9bmV3IE9wZW5MYXllcnMuSGFuZGxlci5Ib3Zlcih0aGlzLHttb3ZlOnRoaXMuY2FuY2VsSG92ZXIscGF1c2U6dGhpcy5nZXRJbmZvRm9ySG92ZXJ9LE9wZW5MYXllcnMuVXRpbC5leHRlbmQodGhpcy5oYW5kbGVyT3B0aW9ucy5ob3Zlcnx8e30se2RlbGF5OjI1MH0pKTooYT17fSxhW3RoaXMuY2xpY2tDYWxsYmFja109dGhpcy5nZXRJbmZvRm9yQ2xpY2ssdGhpcy5oYW5kbGVyPW5ldyBPcGVuTGF5ZXJzLkhhbmRsZXIuQ2xpY2sodGhpcyxhLHRoaXMuaGFuZGxlck9wdGlvbnMuY2xpY2t8fHt9KSl9LGdldEluZm9Gb3JDbGljazpmdW5jdGlvbihhKXt0aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJiZWZvcmVnZXRmZWF0dXJlaW5mb1wiLHt4eTphLnh5fSk7T3BlbkxheWVycy5FbGVtZW50LmFkZENsYXNzKHRoaXMubWFwLnZpZXdQb3J0RGl2LFwib2xDdXJzb3JXYWl0XCIpO3RoaXMucmVxdWVzdChhLnh5LFxue30pfSxnZXRJbmZvRm9ySG92ZXI6ZnVuY3Rpb24oYSl7dGhpcy5ldmVudHMudHJpZ2dlckV2ZW50KFwiYmVmb3JlZ2V0ZmVhdHVyZWluZm9cIix7eHk6YS54eX0pO3RoaXMucmVxdWVzdChhLnh5LHtob3ZlcjohMH0pfSxjYW5jZWxIb3ZlcjpmdW5jdGlvbigpe3RoaXMuaG92ZXJSZXF1ZXN0JiYodGhpcy5ob3ZlclJlcXVlc3QuYWJvcnQoKSx0aGlzLmhvdmVyUmVxdWVzdD1udWxsKX0sZmluZExheWVyczpmdW5jdGlvbigpe2Zvcih2YXIgYT10aGlzLmxheWVyc3x8dGhpcy5tYXAubGF5ZXJzLGI9W10sYyxkLGU9YS5sZW5ndGgtMTswPD1lOy0tZSlpZihjPWFbZV0sYyBpbnN0YW5jZW9mIE9wZW5MYXllcnMuTGF5ZXIuV01TJiYoIXRoaXMucXVlcnlWaXNpYmxlfHxjLmdldFZpc2liaWxpdHkoKSkpZD1PcGVuTGF5ZXJzLlV0aWwuaXNBcnJheShjLnVybCk/Yy51cmxbMF06Yy51cmwsITE9PT10aGlzLmRyaWxsRG93biYmIXRoaXMudXJsJiYodGhpcy51cmw9ZCksKCEwPT09dGhpcy5kcmlsbERvd258fFxudGhpcy51cmxNYXRjaGVzKGQpKSYmYi5wdXNoKGMpO3JldHVybiBifSx1cmxNYXRjaGVzOmZ1bmN0aW9uKGEpe3ZhciBiPU9wZW5MYXllcnMuVXRpbC5pc0VxdWl2YWxlbnRVcmwodGhpcy51cmwsYSk7aWYoIWImJnRoaXMubGF5ZXJVcmxzKWZvcih2YXIgYz0wLGQ9dGhpcy5sYXllclVybHMubGVuZ3RoO2M8ZDsrK2MpaWYoT3BlbkxheWVycy5VdGlsLmlzRXF1aXZhbGVudFVybCh0aGlzLmxheWVyVXJsc1tjXSxhKSl7Yj0hMDticmVha31yZXR1cm4gYn0sYnVpbGRXTVNPcHRpb25zOmZ1bmN0aW9uKGEsYixjLGQpe2Zvcih2YXIgZT1bXSxmPVtdLGc9MCxoPWIubGVuZ3RoO2c8aDtnKyspbnVsbCE9YltnXS5wYXJhbXMuTEFZRVJTJiYoZT1lLmNvbmNhdChiW2ddLnBhcmFtcy5MQVlFUlMpLGY9Zi5jb25jYXQodGhpcy5nZXRTdHlsZU5hbWVzKGJbZ10pKSk7Yj1iWzBdO2c9dGhpcy5tYXAuZ2V0UHJvamVjdGlvbigpOyhoPWIucHJvamVjdGlvbikmJmguZXF1YWxzKHRoaXMubWFwLmdldFByb2plY3Rpb25PYmplY3QoKSkmJlxuKGc9aC5nZXRDb2RlKCkpO2Q9T3BlbkxheWVycy5VdGlsLmV4dGVuZCh7c2VydmljZTpcIldNU1wiLHZlcnNpb246Yi5wYXJhbXMuVkVSU0lPTixyZXF1ZXN0OlwiR2V0RmVhdHVyZUluZm9cIixleGNlcHRpb25zOmIucGFyYW1zLkVYQ0VQVElPTlMsYmJveDp0aGlzLm1hcC5nZXRFeHRlbnQoKS50b0JCT1gobnVsbCxiLnJldmVyc2VBeGlzT3JkZXIoKSksZmVhdHVyZV9jb3VudDp0aGlzLm1heEZlYXR1cmVzLGhlaWdodDp0aGlzLm1hcC5nZXRTaXplKCkuaCx3aWR0aDp0aGlzLm1hcC5nZXRTaXplKCkudyxmb3JtYXQ6ZCxpbmZvX2Zvcm1hdDpiLnBhcmFtcy5JTkZPX0ZPUk1BVHx8dGhpcy5pbmZvRm9ybWF0fSwxLjM8PXBhcnNlRmxvYXQoYi5wYXJhbXMuVkVSU0lPTik/e2NyczpnLGk6cGFyc2VJbnQoYy54KSxqOnBhcnNlSW50KGMueSl9OntzcnM6Zyx4OnBhcnNlSW50KGMueCkseTpwYXJzZUludChjLnkpfSk7MCE9ZS5sZW5ndGgmJihkPU9wZW5MYXllcnMuVXRpbC5leHRlbmQoe2xheWVyczplLFxucXVlcnlfbGF5ZXJzOmUsc3R5bGVzOmZ9LGQpKTtPcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyhkLHRoaXMudmVuZG9yUGFyYW1zKTtyZXR1cm57dXJsOmEscGFyYW1zOk9wZW5MYXllcnMuVXRpbC51cHBlckNhc2VPYmplY3QoZCksY2FsbGJhY2s6ZnVuY3Rpb24oYil7dGhpcy5oYW5kbGVSZXNwb25zZShjLGIsYSl9LHNjb3BlOnRoaXN9fSxnZXRTdHlsZU5hbWVzOmZ1bmN0aW9uKGEpe3JldHVybiBhLnBhcmFtcy5TVFlMRVM/YS5wYXJhbXMuU1RZTEVTOk9wZW5MYXllcnMuVXRpbC5pc0FycmF5KGEucGFyYW1zLkxBWUVSUyk/QXJyYXkoYS5wYXJhbXMuTEFZRVJTLmxlbmd0aCk6YS5wYXJhbXMuTEFZRVJTLnJlcGxhY2UoL1teLF0vZyxcIlwiKX0scmVxdWVzdDpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuZmluZExheWVycygpO2lmKDA9PWMubGVuZ3RoKXRoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcIm5vZ2V0ZmVhdHVyZWluZm9cIiksT3BlbkxheWVycy5FbGVtZW50LnJlbW92ZUNsYXNzKHRoaXMubWFwLnZpZXdQb3J0RGl2LFxuXCJvbEN1cnNvcldhaXRcIik7ZWxzZSBpZihiPWJ8fHt9LCExPT09dGhpcy5kcmlsbERvd24pe3ZhciBjPXRoaXMuYnVpbGRXTVNPcHRpb25zKHRoaXMudXJsLGMsYSxjWzBdLnBhcmFtcy5GT1JNQVQpLGQ9T3BlbkxheWVycy5SZXF1ZXN0LkdFVChjKTshMD09PWIuaG92ZXImJih0aGlzLmhvdmVyUmVxdWVzdD1kKX1lbHNle3RoaXMuX251bVJlcXVlc3RzPXRoaXMuX3JlcXVlc3RDb3VudD0wO3RoaXMuZmVhdHVyZXM9W107Zm9yKHZhciBkPXt9LGUsZj0wLGc9Yy5sZW5ndGg7ZjxnO2YrKyl7dmFyIGg9Y1tmXTtlPU9wZW5MYXllcnMuVXRpbC5pc0FycmF5KGgudXJsKT9oLnVybFswXTpoLnVybDtlIGluIGQ/ZFtlXS5wdXNoKGgpOih0aGlzLl9udW1SZXF1ZXN0cysrLGRbZV09W2hdKX1mb3IoZSBpbiBkKWM9ZFtlXSxjPXRoaXMuYnVpbGRXTVNPcHRpb25zKGUsYyxhLGNbMF0ucGFyYW1zLkZPUk1BVCksT3BlbkxheWVycy5SZXF1ZXN0LkdFVChjKX19LHRyaWdnZXJHZXRGZWF0dXJlSW5mbzpmdW5jdGlvbihhLFxuYixjKXt0aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJnZXRmZWF0dXJlaW5mb1wiLHt0ZXh0OmEucmVzcG9uc2VUZXh0LGZlYXR1cmVzOmMscmVxdWVzdDphLHh5OmJ9KTtPcGVuTGF5ZXJzLkVsZW1lbnQucmVtb3ZlQ2xhc3ModGhpcy5tYXAudmlld1BvcnREaXYsXCJvbEN1cnNvcldhaXRcIil9LGhhbmRsZVJlc3BvbnNlOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD1iLnJlc3BvbnNlWE1MO2lmKCFkfHwhZC5kb2N1bWVudEVsZW1lbnQpZD1iLnJlc3BvbnNlVGV4dDtkPXRoaXMuZm9ybWF0LnJlYWQoZCk7ITE9PT10aGlzLmRyaWxsRG93bj90aGlzLnRyaWdnZXJHZXRGZWF0dXJlSW5mbyhiLGEsZCk6KHRoaXMuX3JlcXVlc3RDb3VudCsrLHRoaXMuX2ZlYXR1cmVzPVwib2JqZWN0XCI9PT10aGlzLm91dHB1dD8odGhpcy5fZmVhdHVyZXN8fFtdKS5jb25jYXQoe3VybDpjLGZlYXR1cmVzOmR9KToodGhpcy5fZmVhdHVyZXN8fFtdKS5jb25jYXQoZCksdGhpcy5fcmVxdWVzdENvdW50PT09dGhpcy5fbnVtUmVxdWVzdHMmJlxuKHRoaXMudHJpZ2dlckdldEZlYXR1cmVJbmZvKGIsYSx0aGlzLl9mZWF0dXJlcy5jb25jYXQoKSksZGVsZXRlIHRoaXMuX2ZlYXR1cmVzLGRlbGV0ZSB0aGlzLl9yZXF1ZXN0Q291bnQsZGVsZXRlIHRoaXMuX251bVJlcXVlc3RzKSl9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkNvbnRyb2wuV01TR2V0RmVhdHVyZUluZm9cIn0pO09wZW5MYXllcnMuRm9ybWF0LldNU0NhcGFiaWxpdGllcy52MV8zXzA9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkZvcm1hdC5XTVNDYXBhYmlsaXRpZXMudjFfMyx7dmVyc2lvbjpcIjEuMy4wXCIsQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuRm9ybWF0LldNU0NhcGFiaWxpdGllcy52MV8zXzBcIn0pO09wZW5MYXllcnMuRm9ybWF0LlNPU0dldEZlYXR1cmVPZkludGVyZXN0PU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Gb3JtYXQuWE1MLHtWRVJTSU9OOlwiMS4wLjBcIixuYW1lc3BhY2VzOntzb3M6XCJodHRwOi8vd3d3Lm9wZW5naXMubmV0L3Nvcy8xLjBcIixnbWw6XCJodHRwOi8vd3d3Lm9wZW5naXMubmV0L2dtbFwiLHNhOlwiaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC9zYW1wbGluZy8xLjBcIix4c2k6XCJodHRwOi8vd3d3LnczLm9yZy8yMDAxL1hNTFNjaGVtYS1pbnN0YW5jZVwifSxzY2hlbWFMb2NhdGlvbjpcImh0dHA6Ly93d3cub3Blbmdpcy5uZXQvc29zLzEuMCBodHRwOi8vc2NoZW1hcy5vcGVuZ2lzLm5ldC9zb3MvMS4wLjAvc29zQWxsLnhzZFwiLGRlZmF1bHRQcmVmaXg6XCJzb3NcIixyZWdFeGVzOnt0cmltU3BhY2U6L15cXHMqfFxccyokL2cscmVtb3ZlU3BhY2U6L1xccyovZyxzcGxpdFNwYWNlOi9cXHMrLyx0cmltQ29tbWE6L1xccyosXFxzKi9nfSxyZWFkOmZ1bmN0aW9uKGEpe1wic3RyaW5nXCI9PVxudHlwZW9mIGEmJihhPU9wZW5MYXllcnMuRm9ybWF0LlhNTC5wcm90b3R5cGUucmVhZC5hcHBseSh0aGlzLFthXSkpO2EmJjk9PWEubm9kZVR5cGUmJihhPWEuZG9jdW1lbnRFbGVtZW50KTt2YXIgYj17ZmVhdHVyZXM6W119O3RoaXMucmVhZE5vZGUoYSxiKTtmb3IodmFyIGE9W10sYz0wLGQ9Yi5mZWF0dXJlcy5sZW5ndGg7YzxkO2MrKyl7dmFyIGU9Yi5mZWF0dXJlc1tjXTt0aGlzLmludGVybmFsUHJvamVjdGlvbiYmKHRoaXMuZXh0ZXJuYWxQcm9qZWN0aW9uJiZlLmNvbXBvbmVudHNbMF0pJiZlLmNvbXBvbmVudHNbMF0udHJhbnNmb3JtKHRoaXMuZXh0ZXJuYWxQcm9qZWN0aW9uLHRoaXMuaW50ZXJuYWxQcm9qZWN0aW9uKTtlPW5ldyBPcGVuTGF5ZXJzLkZlYXR1cmUuVmVjdG9yKGUuY29tcG9uZW50c1swXSxlLmF0dHJpYnV0ZXMpO2EucHVzaChlKX1yZXR1cm4gYX0scmVhZGVyczp7c2E6e1NhbXBsaW5nUG9pbnQ6ZnVuY3Rpb24oYSxiKXtpZighYi5hdHRyaWJ1dGVzKXt2YXIgYz1cbnthdHRyaWJ1dGVzOnt9fTtiLmZlYXR1cmVzLnB1c2goYyk7Yj1jfWIuYXR0cmlidXRlcy5pZD10aGlzLmdldEF0dHJpYnV0ZU5TKGEsdGhpcy5uYW1lc3BhY2VzLmdtbCxcImlkXCIpO3RoaXMucmVhZENoaWxkTm9kZXMoYSxiKX0scG9zaXRpb246ZnVuY3Rpb24oYSxiKXt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYil9fSxnbWw6T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoe0ZlYXR1cmVDb2xsZWN0aW9uOmZ1bmN0aW9uKGEsYil7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIpfSxmZWF0dXJlTWVtYmVyOmZ1bmN0aW9uKGEsYil7dmFyIGM9e2F0dHJpYnV0ZXM6e319O2IuZmVhdHVyZXMucHVzaChjKTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYyl9LG5hbWU6ZnVuY3Rpb24oYSxiKXtiLmF0dHJpYnV0ZXMubmFtZT10aGlzLmdldENoaWxkVmFsdWUoYSl9LHBvczpmdW5jdGlvbihhLGIpe3RoaXMuZXh0ZXJuYWxQcm9qZWN0aW9ufHwodGhpcy5leHRlcm5hbFByb2plY3Rpb249bmV3IE9wZW5MYXllcnMuUHJvamVjdGlvbihhLmdldEF0dHJpYnV0ZShcInNyc05hbWVcIikpKTtcbk9wZW5MYXllcnMuRm9ybWF0LkdNTC52My5wcm90b3R5cGUucmVhZGVycy5nbWwucG9zLmFwcGx5KHRoaXMsW2EsYl0pfX0sT3BlbkxheWVycy5Gb3JtYXQuR01MLnYzLnByb3RvdHlwZS5yZWFkZXJzLmdtbCl9LHdyaXRlcnM6e3Nvczp7R2V0RmVhdHVyZU9mSW50ZXJlc3Q6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIkdldEZlYXR1cmVPZkludGVyZXN0XCIse2F0dHJpYnV0ZXM6e3ZlcnNpb246dGhpcy5WRVJTSU9OLHNlcnZpY2U6XCJTT1NcIixcInhzaTpzY2hlbWFMb2NhdGlvblwiOnRoaXMuc2NoZW1hTG9jYXRpb259fSksYz0wLGQ9YS5mb2lzLmxlbmd0aDtjPGQ7YysrKXRoaXMud3JpdGVOb2RlKFwiRmVhdHVyZU9mSW50ZXJlc3RJZFwiLHtmb2k6YS5mb2lzW2NdfSxiKTtyZXR1cm4gYn0sRmVhdHVyZU9mSW50ZXJlc3RJZDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiRmVhdHVyZU9mSW50ZXJlc3RJZFwiLHt2YWx1ZTphLmZvaX0pfX19LFxuQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuRm9ybWF0LlNPU0dldEZlYXR1cmVPZkludGVyZXN0XCJ9KTtPcGVuTGF5ZXJzLkZvcm1hdC5TT1NHZXRPYnNlcnZhdGlvbj1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuRm9ybWF0LlhNTCx7bmFtZXNwYWNlczp7b3dzOlwiaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC9vd3NcIixnbWw6XCJodHRwOi8vd3d3Lm9wZW5naXMubmV0L2dtbFwiLHNvczpcImh0dHA6Ly93d3cub3Blbmdpcy5uZXQvc29zLzEuMFwiLG9nYzpcImh0dHA6Ly93d3cub3Blbmdpcy5uZXQvb2djXCIsb206XCJodHRwOi8vd3d3Lm9wZW5naXMubmV0L29tLzEuMFwiLHNhOlwiaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC9zYW1wbGluZy8xLjBcIix4bGluazpcImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmtcIix4c2k6XCJodHRwOi8vd3d3LnczLm9yZy8yMDAxL1hNTFNjaGVtYS1pbnN0YW5jZVwifSxyZWdFeGVzOnt0cmltU3BhY2U6L15cXHMqfFxccyokL2cscmVtb3ZlU3BhY2U6L1xccyovZyxzcGxpdFNwYWNlOi9cXHMrLyx0cmltQ29tbWE6L1xccyosXFxzKi9nfSxWRVJTSU9OOlwiMS4wLjBcIixzY2hlbWFMb2NhdGlvbjpcImh0dHA6Ly93d3cub3Blbmdpcy5uZXQvc29zLzEuMCBodHRwOi8vc2NoZW1hcy5vcGVuZ2lzLm5ldC9zb3MvMS4wLjAvc29zR2V0T2JzZXJ2YXRpb24ueHNkXCIsXG5kZWZhdWx0UHJlZml4Olwic29zXCIscmVhZDpmdW5jdGlvbihhKXtcInN0cmluZ1wiPT10eXBlb2YgYSYmKGE9T3BlbkxheWVycy5Gb3JtYXQuWE1MLnByb3RvdHlwZS5yZWFkLmFwcGx5KHRoaXMsW2FdKSk7YSYmOT09YS5ub2RlVHlwZSYmKGE9YS5kb2N1bWVudEVsZW1lbnQpO3ZhciBiPXttZWFzdXJlbWVudHM6W10sb2JzZXJ2YXRpb25zOltdfTt0aGlzLnJlYWROb2RlKGEsYik7cmV0dXJuIGJ9LHdyaXRlOmZ1bmN0aW9uKGEpe2E9dGhpcy53cml0ZU5vZGUoXCJzb3M6R2V0T2JzZXJ2YXRpb25cIixhKTthLnNldEF0dHJpYnV0ZShcInhtbG5zOm9tXCIsdGhpcy5uYW1lc3BhY2VzLm9tKTthLnNldEF0dHJpYnV0ZShcInhtbG5zOm9nY1wiLHRoaXMubmFtZXNwYWNlcy5vZ2MpO3RoaXMuc2V0QXR0cmlidXRlTlMoYSx0aGlzLm5hbWVzcGFjZXMueHNpLFwieHNpOnNjaGVtYUxvY2F0aW9uXCIsdGhpcy5zY2hlbWFMb2NhdGlvbik7cmV0dXJuIE9wZW5MYXllcnMuRm9ybWF0LlhNTC5wcm90b3R5cGUud3JpdGUuYXBwbHkodGhpcyxcblthXSl9LHJlYWRlcnM6e29tOntPYnNlcnZhdGlvbkNvbGxlY3Rpb246ZnVuY3Rpb24oYSxiKXtiLmlkPXRoaXMuZ2V0QXR0cmlidXRlTlMoYSx0aGlzLm5hbWVzcGFjZXMuZ21sLFwiaWRcIik7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIpfSxtZW1iZXI6ZnVuY3Rpb24oYSxiKXt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYil9LE1lYXN1cmVtZW50OmZ1bmN0aW9uKGEsYil7dmFyIGM9e307Yi5tZWFzdXJlbWVudHMucHVzaChjKTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYyl9LE9ic2VydmF0aW9uOmZ1bmN0aW9uKGEsYil7dmFyIGM9e307Yi5vYnNlcnZhdGlvbnMucHVzaChjKTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYyl9LHNhbXBsaW5nVGltZTpmdW5jdGlvbihhLGIpe3ZhciBjPXt9O2Iuc2FtcGxpbmdUaW1lPWM7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpfSxvYnNlcnZlZFByb3BlcnR5OmZ1bmN0aW9uKGEsYil7Yi5vYnNlcnZlZFByb3BlcnR5PXRoaXMuZ2V0QXR0cmlidXRlTlMoYSx0aGlzLm5hbWVzcGFjZXMueGxpbmssXG5cImhyZWZcIik7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIpfSxwcm9jZWR1cmU6ZnVuY3Rpb24oYSxiKXtiLnByb2NlZHVyZT10aGlzLmdldEF0dHJpYnV0ZU5TKGEsdGhpcy5uYW1lc3BhY2VzLnhsaW5rLFwiaHJlZlwiKTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYil9LGZlYXR1cmVPZkludGVyZXN0OmZ1bmN0aW9uKGEsYil7dmFyIGM9e2ZlYXR1cmVzOltdfTtiLmZvaXM9W107Yi5mb2lzLnB1c2goYyk7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpO2Zvcih2YXIgZD1bXSxlPTAsZj1jLmZlYXR1cmVzLmxlbmd0aDtlPGY7ZSsrKXt2YXIgZz1jLmZlYXR1cmVzW2VdO2QucHVzaChuZXcgT3BlbkxheWVycy5GZWF0dXJlLlZlY3RvcihnLmNvbXBvbmVudHNbMF0sZy5hdHRyaWJ1dGVzKSl9Yy5mZWF0dXJlcz1kfSxyZXN1bHQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz17fTtiLnJlc3VsdD1jO1wiXCIhPT10aGlzLmdldENoaWxkVmFsdWUoYSk/KGMudmFsdWU9dGhpcy5nZXRDaGlsZFZhbHVlKGEpLGMudW9tPVxuYS5nZXRBdHRyaWJ1dGUoXCJ1b21cIikpOnRoaXMucmVhZENoaWxkTm9kZXMoYSxjKX19LHNhOk9wZW5MYXllcnMuRm9ybWF0LlNPU0dldEZlYXR1cmVPZkludGVyZXN0LnByb3RvdHlwZS5yZWFkZXJzLnNhLGdtbDpPcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyh7VGltZUluc3RhbnQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz17fTtiLnRpbWVJbnN0YW50PWM7dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGMpfSx0aW1lUG9zaXRpb246ZnVuY3Rpb24oYSxiKXtiLnRpbWVQb3NpdGlvbj10aGlzLmdldENoaWxkVmFsdWUoYSl9fSxPcGVuTGF5ZXJzLkZvcm1hdC5TT1NHZXRGZWF0dXJlT2ZJbnRlcmVzdC5wcm90b3R5cGUucmVhZGVycy5nbWwpfSx3cml0ZXJzOntzb3M6e0dldE9ic2VydmF0aW9uOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIkdldE9ic2VydmF0aW9uXCIse2F0dHJpYnV0ZXM6e3ZlcnNpb246dGhpcy5WRVJTSU9OLHNlcnZpY2U6XCJTT1NcIn19KTt0aGlzLndyaXRlTm9kZShcIm9mZmVyaW5nXCIsXG5hLGIpO2EuZXZlbnRUaW1lJiZ0aGlzLndyaXRlTm9kZShcImV2ZW50VGltZVwiLGEsYik7Zm9yKHZhciBjIGluIGEucHJvY2VkdXJlcyl0aGlzLndyaXRlTm9kZShcInByb2NlZHVyZVwiLGEucHJvY2VkdXJlc1tjXSxiKTtmb3IodmFyIGQgaW4gYS5vYnNlcnZlZFByb3BlcnRpZXMpdGhpcy53cml0ZU5vZGUoXCJvYnNlcnZlZFByb3BlcnR5XCIsYS5vYnNlcnZlZFByb3BlcnRpZXNbZF0sYik7YS5mb2kmJnRoaXMud3JpdGVOb2RlKFwiZmVhdHVyZU9mSW50ZXJlc3RcIixhLmZvaSxiKTt0aGlzLndyaXRlTm9kZShcInJlc3BvbnNlRm9ybWF0XCIsYSxiKTthLnJlc3VsdE1vZGVsJiZ0aGlzLndyaXRlTm9kZShcInJlc3VsdE1vZGVsXCIsYSxiKTthLnJlc3BvbnNlTW9kZSYmdGhpcy53cml0ZU5vZGUoXCJyZXNwb25zZU1vZGVcIixhLGIpO3JldHVybiBifSxmZWF0dXJlT2ZJbnRlcmVzdDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJmZWF0dXJlT2ZJbnRlcmVzdFwiKTt0aGlzLndyaXRlTm9kZShcIk9iamVjdElEXCIsXG5hLm9iamVjdElkLGIpO3JldHVybiBifSxPYmplY3RJRDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiT2JqZWN0SURcIix7dmFsdWU6YX0pfSxyZXNwb25zZUZvcm1hdDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwicmVzcG9uc2VGb3JtYXRcIix7dmFsdWU6YS5yZXNwb25zZUZvcm1hdH0pfSxwcm9jZWR1cmU6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcInByb2NlZHVyZVwiLHt2YWx1ZTphfSl9LG9mZmVyaW5nOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJvZmZlcmluZ1wiLHt2YWx1ZTphLm9mZmVyaW5nfSl9LG9ic2VydmVkUHJvcGVydHk6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcIm9ic2VydmVkUHJvcGVydHlcIix7dmFsdWU6YX0pfSxldmVudFRpbWU6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiZXZlbnRUaW1lXCIpO1xuXCJsYXRlc3RcIj09PWEuZXZlbnRUaW1lJiZ0aGlzLndyaXRlTm9kZShcIm9nYzpUTV9FcXVhbHNcIixhLGIpO3JldHVybiBifSxyZXN1bHRNb2RlbDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwicmVzdWx0TW9kZWxcIix7dmFsdWU6YS5yZXN1bHRNb2RlbH0pfSxyZXNwb25zZU1vZGU6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcInJlc3BvbnNlTW9kZVwiLHt2YWx1ZTphLnJlc3BvbnNlTW9kZX0pfX0sb2djOntUTV9FcXVhbHM6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwib2djOlRNX0VxdWFsc1wiKTt0aGlzLndyaXRlTm9kZShcIm9nYzpQcm9wZXJ0eU5hbWVcIix7cHJvcGVydHk6XCJ1cm46b2djOmRhdGE6dGltZTppc284NjAxXCJ9LGIpO1wibGF0ZXN0XCI9PT1hLmV2ZW50VGltZSYmdGhpcy53cml0ZU5vZGUoXCJnbWw6VGltZUluc3RhbnRcIix7dmFsdWU6XCJsYXRlc3RcIn0sYik7cmV0dXJuIGJ9LFByb3BlcnR5TmFtZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwib2djOlByb3BlcnR5TmFtZVwiLFxue3ZhbHVlOmEucHJvcGVydHl9KX19LGdtbDp7VGltZUluc3RhbnQ6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiZ21sOlRpbWVJbnN0YW50XCIpO3RoaXMud3JpdGVOb2RlKFwiZ21sOnRpbWVQb3NpdGlvblwiLGEsYik7cmV0dXJuIGJ9LHRpbWVQb3NpdGlvbjpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiZ21sOnRpbWVQb3NpdGlvblwiLHt2YWx1ZTphLnZhbHVlfSl9fX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuRm9ybWF0LlNPU0dldE9ic2VydmF0aW9uXCJ9KTtPcGVuTGF5ZXJzLkNvbnRyb2wuVVRGR3JpZD1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuQ29udHJvbCx7YXV0b0FjdGl2YXRlOiEwLGxheWVyczpudWxsLGRlZmF1bHRIYW5kbGVyT3B0aW9uczp7ZGVsYXk6MzAwLHBpeGVsVG9sZXJhbmNlOjQsc3RvcE1vdmU6ITEsc2luZ2xlOiEwLFwiZG91YmxlXCI6ITEsc3RvcFNpbmdsZTohMSxzdG9wRG91YmxlOiExfSxoYW5kbGVyTW9kZTpcImNsaWNrXCIsc2V0SGFuZGxlcjpmdW5jdGlvbihhKXt0aGlzLmhhbmRsZXJNb2RlPWE7dGhpcy5yZXNldEhhbmRsZXIoKX0scmVzZXRIYW5kbGVyOmZ1bmN0aW9uKCl7dGhpcy5oYW5kbGVyJiYodGhpcy5oYW5kbGVyLmRlYWN0aXZhdGUoKSx0aGlzLmhhbmRsZXIuZGVzdHJveSgpLHRoaXMuaGFuZGxlcj1udWxsKTtcImhvdmVyXCI9PXRoaXMuaGFuZGxlck1vZGU/dGhpcy5oYW5kbGVyPW5ldyBPcGVuTGF5ZXJzLkhhbmRsZXIuSG92ZXIodGhpcyx7cGF1c2U6dGhpcy5oYW5kbGVFdmVudCxtb3ZlOnRoaXMucmVzZXR9LFxudGhpcy5oYW5kbGVyT3B0aW9ucyk6XCJjbGlja1wiPT10aGlzLmhhbmRsZXJNb2RlP3RoaXMuaGFuZGxlcj1uZXcgT3BlbkxheWVycy5IYW5kbGVyLkNsaWNrKHRoaXMse2NsaWNrOnRoaXMuaGFuZGxlRXZlbnR9LHRoaXMuaGFuZGxlck9wdGlvbnMpOlwibW92ZVwiPT10aGlzLmhhbmRsZXJNb2RlJiYodGhpcy5oYW5kbGVyPW5ldyBPcGVuTGF5ZXJzLkhhbmRsZXIuSG92ZXIodGhpcyx7cGF1c2U6dGhpcy5oYW5kbGVFdmVudCxtb3ZlOnRoaXMuaGFuZGxlRXZlbnR9LHRoaXMuaGFuZGxlck9wdGlvbnMpKTtyZXR1cm4gdGhpcy5oYW5kbGVyPyEwOiExfSxpbml0aWFsaXplOmZ1bmN0aW9uKGEpe2E9YXx8e307YS5oYW5kbGVyT3B0aW9ucz1hLmhhbmRsZXJPcHRpb25zfHx0aGlzLmRlZmF1bHRIYW5kbGVyT3B0aW9ucztPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbYV0pO3RoaXMucmVzZXRIYW5kbGVyKCl9LGhhbmRsZUV2ZW50OmZ1bmN0aW9uKGEpe2lmKG51bGw9PVxuYSl0aGlzLnJlc2V0KCk7ZWxzZXt2YXIgYj10aGlzLm1hcC5nZXRMb25MYXRGcm9tUGl4ZWwoYS54eSk7aWYoYil7dmFyIGM9dGhpcy5maW5kTGF5ZXJzKCk7aWYoMDxjLmxlbmd0aCl7Zm9yKHZhciBkPXt9LGUsZixnPTAsaD1jLmxlbmd0aDtnPGg7ZysrKWU9Y1tnXSxmPU9wZW5MYXllcnMuVXRpbC5pbmRleE9mKHRoaXMubWFwLmxheWVycyxlKSxkW2ZdPWUuZ2V0RmVhdHVyZUluZm8oYik7dGhpcy5jYWxsYmFjayhkLGIsYS54eSl9fX19LGNhbGxiYWNrOmZ1bmN0aW9uKCl7fSxyZXNldDpmdW5jdGlvbigpe3RoaXMuY2FsbGJhY2sobnVsbCl9LGZpbmRMYXllcnM6ZnVuY3Rpb24oKXtmb3IodmFyIGE9dGhpcy5sYXllcnN8fHRoaXMubWFwLmxheWVycyxiPVtdLGMsZD1hLmxlbmd0aC0xOzA8PWQ7LS1kKWM9YVtkXSxjIGluc3RhbmNlb2YgT3BlbkxheWVycy5MYXllci5VVEZHcmlkJiZiLnB1c2goYyk7cmV0dXJuIGJ9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLkNvbnRyb2wuVVRGR3JpZFwifSk7T3BlbkxheWVycy5Gb3JtYXQuQ1FMPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhKXtmdW5jdGlvbiBiKCl7dmFyIGE9ZS5wb3AoKTtzd2l0Y2goYS50eXBlKXtjYXNlIFwiTE9HSUNBTFwiOnZhciBjPWIoKSxnPWIoKTtyZXR1cm4gbmV3IE9wZW5MYXllcnMuRmlsdGVyLkxvZ2ljYWwoe2ZpbHRlcnM6W2csY10sdHlwZTpmW2EudGV4dC50b1VwcGVyQ2FzZSgpXX0pO2Nhc2UgXCJOT1RcIjpyZXR1cm4gYz1iKCksbmV3IE9wZW5MYXllcnMuRmlsdGVyLkxvZ2ljYWwoe2ZpbHRlcnM6W2NdLHR5cGU6T3BlbkxheWVycy5GaWx0ZXIuTG9naWNhbC5OT1R9KTtjYXNlIFwiQkVUV0VFTlwiOnJldHVybiBlLnBvcCgpLGc9YigpLGE9YigpLGM9YigpLG5ldyBPcGVuTGF5ZXJzLkZpbHRlci5Db21wYXJpc29uKHtwcm9wZXJ0eTpjLGxvd2VyQm91bmRhcnk6YSx1cHBlckJvdW5kYXJ5OmcsdHlwZTpPcGVuTGF5ZXJzLkZpbHRlci5Db21wYXJpc29uLkJFVFdFRU59KTtjYXNlIFwiQ09NUEFSSVNPTlwiOnJldHVybiBnPVxuYigpLGM9YigpLG5ldyBPcGVuTGF5ZXJzLkZpbHRlci5Db21wYXJpc29uKHtwcm9wZXJ0eTpjLHZhbHVlOmcsdHlwZTpkW2EudGV4dC50b1VwcGVyQ2FzZSgpXX0pO2Nhc2UgXCJWQUxVRVwiOnJldHVybi9eJy4qJyQvLnRlc3QoYS50ZXh0KT9hLnRleHQuc3Vic3RyKDEsYS50ZXh0Lmxlbmd0aC0yKTpOdW1iZXIoYS50ZXh0KTtjYXNlIFwiU1BBVElBTFwiOnN3aXRjaChhLnRleHQudG9VcHBlckNhc2UoKSl7Y2FzZSBcIkJCT1hcIjp2YXIgYz1iKCksYT1iKCksZz1iKCksaD1iKCksaT1iKCk7cmV0dXJuIG5ldyBPcGVuTGF5ZXJzLkZpbHRlci5TcGF0aWFsKHt0eXBlOk9wZW5MYXllcnMuRmlsdGVyLlNwYXRpYWwuQkJPWCxwcm9wZXJ0eTppLHZhbHVlOk9wZW5MYXllcnMuQm91bmRzLmZyb21BcnJheShbaCxnLGEsY10pfSk7Y2FzZSBcIklOVEVSU0VDVFNcIjpyZXR1cm4gZz1iKCksYz1iKCksbmV3IE9wZW5MYXllcnMuRmlsdGVyLlNwYXRpYWwoe3R5cGU6T3BlbkxheWVycy5GaWx0ZXIuU3BhdGlhbC5JTlRFUlNFQ1RTLFxucHJvcGVydHk6Yyx2YWx1ZTpnfSk7Y2FzZSBcIldJVEhJTlwiOnJldHVybiBnPWIoKSxjPWIoKSxuZXcgT3BlbkxheWVycy5GaWx0ZXIuU3BhdGlhbCh7dHlwZTpPcGVuTGF5ZXJzLkZpbHRlci5TcGF0aWFsLldJVEhJTixwcm9wZXJ0eTpjLHZhbHVlOmd9KTtjYXNlIFwiQ09OVEFJTlNcIjpyZXR1cm4gZz1iKCksYz1iKCksbmV3IE9wZW5MYXllcnMuRmlsdGVyLlNwYXRpYWwoe3R5cGU6T3BlbkxheWVycy5GaWx0ZXIuU3BhdGlhbC5DT05UQUlOUyxwcm9wZXJ0eTpjLHZhbHVlOmd9KTtjYXNlIFwiRFdJVEhJTlwiOnJldHVybiBhPWIoKSxnPWIoKSxjPWIoKSxuZXcgT3BlbkxheWVycy5GaWx0ZXIuU3BhdGlhbCh7dHlwZTpPcGVuTGF5ZXJzLkZpbHRlci5TcGF0aWFsLkRXSVRISU4sdmFsdWU6Zyxwcm9wZXJ0eTpjLGRpc3RhbmNlOk51bWJlcihhKX0pfWNhc2UgXCJHRU9NRVRSWVwiOnJldHVybiBPcGVuTGF5ZXJzLkdlb21ldHJ5LmZyb21XS1QoYS50ZXh0KTtkZWZhdWx0OnJldHVybiBhLnRleHR9fVxuZm9yKHZhciBjPVtdLGU9W107YS5sZW5ndGg7KXt2YXIgZz1hLnNoaWZ0KCk7c3dpdGNoKGcudHlwZSl7Y2FzZSBcIlBST1BFUlRZXCI6Y2FzZSBcIkdFT01FVFJZXCI6Y2FzZSBcIlZBTFVFXCI6ZS5wdXNoKGcpO2JyZWFrO2Nhc2UgXCJDT01QQVJJU09OXCI6Y2FzZSBcIkJFVFdFRU5cIjpjYXNlIFwiTE9HSUNBTFwiOmZvcih2YXIgaT1oW2cudHlwZV07MDxjLmxlbmd0aCYmaFtjW2MubGVuZ3RoLTFdLnR5cGVdPD1pOyllLnB1c2goYy5wb3AoKSk7Yy5wdXNoKGcpO2JyZWFrO2Nhc2UgXCJTUEFUSUFMXCI6Y2FzZSBcIk5PVFwiOmNhc2UgXCJMUEFSRU5cIjpjLnB1c2goZyk7YnJlYWs7Y2FzZSBcIlJQQVJFTlwiOmZvcig7MDxjLmxlbmd0aCYmXCJMUEFSRU5cIiE9Y1tjLmxlbmd0aC0xXS50eXBlOyllLnB1c2goYy5wb3AoKSk7Yy5wb3AoKTswPGMubGVuZ3RoJiZcIlNQQVRJQUxcIj09Y1tjLmxlbmd0aC0xXS50eXBlJiZlLnB1c2goYy5wb3AoKSk7Y2FzZSBcIkNPTU1BXCI6Y2FzZSBcIkVORFwiOmJyZWFrO2RlZmF1bHQ6dGhyb3cgRXJyb3IoXCJVbmtub3duIHRva2VuIHR5cGUgXCIrXG5nLnR5cGUpO319Zm9yKDswPGMubGVuZ3RoOyllLnB1c2goYy5wb3AoKSk7YT1iKCk7aWYoMDxlLmxlbmd0aCl7YT1cIlJlbWFpbmluZyB0b2tlbnMgYWZ0ZXIgYnVpbGRpbmcgQVNUOiBcXG5cIjtmb3IoYz1lLmxlbmd0aC0xOzA8PWM7Yy0tKWErPWVbY10udHlwZStcIjogXCIrZVtjXS50ZXh0K1wiXFxuXCI7dGhyb3cgRXJyb3IoYSk7fXJldHVybiBhfXZhciBiPXtQUk9QRVJUWTovXltfYS16QS1aXVxcdyovLENPTVBBUklTT046L14oPXw8Pnw8PXw8fD49fD58TElLRSkvaSxDT01NQTovXiwvLExPR0lDQUw6L14oQU5EfE9SKS9pLFZBTFVFOi9eKCdcXHcrJ3xcXGQrKFxcLlxcZCopP3xcXC5cXGQrKS8sTFBBUkVOOi9eXFwoLyxSUEFSRU46L15cXCkvLFNQQVRJQUw6L14oQkJPWHxJTlRFUlNFQ1RTfERXSVRISU58V0lUSElOfENPTlRBSU5TKS9pLE5PVDovXk5PVC9pLEJFVFdFRU46L15CRVRXRUVOL2ksR0VPTUVUUlk6ZnVuY3Rpb24oYSl7dmFyIGI9L14oUE9JTlR8TElORVNUUklOR3xQT0xZR09OfE1VTFRJUE9JTlR8TVVMVElMSU5FU1RSSU5HfE1VTFRJUE9MWUdPTnxHRU9NRVRSWUNPTExFQ1RJT04pLy5leGVjKGEpO1xuaWYoYil7dmFyIGM9YS5sZW5ndGgsYj1hLmluZGV4T2YoXCIoXCIsYlswXS5sZW5ndGgpO2lmKC0xPGIpZm9yKHZhciBkPTE7YjxjJiYwPGQ7KXN3aXRjaChiKyssYS5jaGFyQXQoYikpe2Nhc2UgXCIoXCI6ZCsrO2JyZWFrO2Nhc2UgXCIpXCI6ZC0tfXJldHVyblthLnN1YnN0cigwLGIrMSldfX0sRU5EOi9eJC99LGM9e0xQQVJFTjpbXCJHRU9NRVRSWVwiLFwiU1BBVElBTFwiLFwiUFJPUEVSVFlcIixcIlZBTFVFXCIsXCJMUEFSRU5cIl0sUlBBUkVOOltcIk5PVFwiLFwiTE9HSUNBTFwiLFwiRU5EXCIsXCJSUEFSRU5cIl0sUFJPUEVSVFk6W1wiQ09NUEFSSVNPTlwiLFwiQkVUV0VFTlwiLFwiQ09NTUFcIl0sQkVUV0VFTjpbXCJWQUxVRVwiXSxDT01QQVJJU09OOltcIlZBTFVFXCJdLENPTU1BOltcIkdFT01FVFJZXCIsXCJWQUxVRVwiLFwiUFJPUEVSVFlcIl0sVkFMVUU6W1wiTE9HSUNBTFwiLFwiQ09NTUFcIixcIlJQQVJFTlwiLFwiRU5EXCJdLFNQQVRJQUw6W1wiTFBBUkVOXCJdLExPR0lDQUw6W1wiTk9UXCIsXCJWQUxVRVwiLFwiU1BBVElBTFwiLFwiUFJPUEVSVFlcIixcIkxQQVJFTlwiXSxcbk5PVDpbXCJQUk9QRVJUWVwiLFwiTFBBUkVOXCJdLEdFT01FVFJZOltcIkNPTU1BXCIsXCJSUEFSRU5cIl19LGQ9e1wiPVwiOk9wZW5MYXllcnMuRmlsdGVyLkNvbXBhcmlzb24uRVFVQUxfVE8sXCI8PlwiOk9wZW5MYXllcnMuRmlsdGVyLkNvbXBhcmlzb24uTk9UX0VRVUFMX1RPLFwiPFwiOk9wZW5MYXllcnMuRmlsdGVyLkNvbXBhcmlzb24uTEVTU19USEFOLFwiPD1cIjpPcGVuTGF5ZXJzLkZpbHRlci5Db21wYXJpc29uLkxFU1NfVEhBTl9PUl9FUVVBTF9UTyxcIj5cIjpPcGVuTGF5ZXJzLkZpbHRlci5Db21wYXJpc29uLkdSRUFURVJfVEhBTixcIj49XCI6T3BlbkxheWVycy5GaWx0ZXIuQ29tcGFyaXNvbi5HUkVBVEVSX1RIQU5fT1JfRVFVQUxfVE8sTElLRTpPcGVuTGF5ZXJzLkZpbHRlci5Db21wYXJpc29uLkxJS0UsQkVUV0VFTjpPcGVuTGF5ZXJzLkZpbHRlci5Db21wYXJpc29uLkJFVFdFRU59LGU9e30sZj17QU5EOk9wZW5MYXllcnMuRmlsdGVyLkxvZ2ljYWwuQU5ELE9SOk9wZW5MYXllcnMuRmlsdGVyLkxvZ2ljYWwuT1J9LFxuZz17fSxoPXtSUEFSRU46MyxMT0dJQ0FMOjIsQ09NUEFSSVNPTjoxfSxpO2ZvcihpIGluIGQpZC5oYXNPd25Qcm9wZXJ0eShpKSYmKGVbZFtpXV09aSk7Zm9yKGkgaW4gZilmLmhhc093blByb3BlcnR5KGkpJiYoZ1tmW2ldXT1pKTtyZXR1cm4gT3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkZvcm1hdCx7cmVhZDpmdW5jdGlvbihkKXt2YXIgZT1kLGQ9W10sZixnPVtcIk5PVFwiLFwiR0VPTUVUUllcIixcIlNQQVRJQUxcIixcIlBST1BFUlRZXCIsXCJMUEFSRU5cIl07ZG97YTp7Zj1nO2Zvcih2YXIgaD12b2lkIDAsZz12b2lkIDAsaT1mLmxlbmd0aCxoPTA7aDxpO2grKyl7dmFyIGc9ZltoXSxwPWJbZ11pbnN0YW5jZW9mIFJlZ0V4cD9iW2ddLmV4ZWMoZSk6KDAsYltnXSkoZSk7aWYocCl7Zj1wWzBdO2U9ZS5zdWJzdHIoZi5sZW5ndGgpLnJlcGxhY2UoL15cXHMqLyxcIlwiKTtmPXt0eXBlOmcsdGV4dDpmLHJlbWFpbmRlcjplfTticmVhayBhfX1kPVwiRVJST1I6IEluIHBhcnNpbmc6IFtcIitlK1wiXSwgZXhwZWN0ZWQgb25lIG9mOiBcIjtcbmZvcihoPTA7aDxpO2grKylnPWZbaF0sZCs9XCJcXG4gICAgXCIrZytcIjogXCIrYltnXTt0aHJvdyBFcnJvcihkKTt9ZT1mLnJlbWFpbmRlcjtnPWNbZi50eXBlXTtpZihcIkVORFwiIT1mLnR5cGUmJiFnKXRocm93IEVycm9yKFwiTm8gZm9sbG93cyBsaXN0IGZvciBcIitmLnR5cGUpO2QucHVzaChmKX13aGlsZShcIkVORFwiIT1mLnR5cGUpO2Q9YShkKTt0aGlzLmtlZXBEYXRhJiYodGhpcy5kYXRhPWQpO3JldHVybiBkfSx3cml0ZTpmdW5jdGlvbihhKXtpZihhIGluc3RhbmNlb2YgT3BlbkxheWVycy5HZW9tZXRyeSlyZXR1cm4gYS50b1N0cmluZygpO3N3aXRjaChhLkNMQVNTX05BTUUpe2Nhc2UgXCJPcGVuTGF5ZXJzLkZpbHRlci5TcGF0aWFsXCI6c3dpdGNoKGEudHlwZSl7Y2FzZSBPcGVuTGF5ZXJzLkZpbHRlci5TcGF0aWFsLkJCT1g6cmV0dXJuXCJCQk9YKFwiK2EucHJvcGVydHkrXCIsXCIrYS52YWx1ZS50b0JCT1goKStcIilcIjtjYXNlIE9wZW5MYXllcnMuRmlsdGVyLlNwYXRpYWwuRFdJVEhJTjpyZXR1cm5cIkRXSVRISU4oXCIrXG5hLnByb3BlcnR5K1wiLCBcIit0aGlzLndyaXRlKGEudmFsdWUpK1wiLCBcIithLmRpc3RhbmNlK1wiKVwiO2Nhc2UgT3BlbkxheWVycy5GaWx0ZXIuU3BhdGlhbC5XSVRISU46cmV0dXJuXCJXSVRISU4oXCIrYS5wcm9wZXJ0eStcIiwgXCIrdGhpcy53cml0ZShhLnZhbHVlKStcIilcIjtjYXNlIE9wZW5MYXllcnMuRmlsdGVyLlNwYXRpYWwuSU5URVJTRUNUUzpyZXR1cm5cIklOVEVSU0VDVFMoXCIrYS5wcm9wZXJ0eStcIiwgXCIrdGhpcy53cml0ZShhLnZhbHVlKStcIilcIjtjYXNlIE9wZW5MYXllcnMuRmlsdGVyLlNwYXRpYWwuQ09OVEFJTlM6cmV0dXJuXCJDT05UQUlOUyhcIithLnByb3BlcnR5K1wiLCBcIit0aGlzLndyaXRlKGEudmFsdWUpK1wiKVwiO2RlZmF1bHQ6dGhyb3cgRXJyb3IoXCJVbmtub3duIHNwYXRpYWwgZmlsdGVyIHR5cGU6IFwiK2EudHlwZSk7fWNhc2UgXCJPcGVuTGF5ZXJzLkZpbHRlci5Mb2dpY2FsXCI6aWYoYS50eXBlPT1PcGVuTGF5ZXJzLkZpbHRlci5Mb2dpY2FsLk5PVClyZXR1cm5cIk5PVCAoXCIrdGhpcy53cml0ZShhLmZpbHRlcnNbMF0pK1xuXCIpXCI7Zm9yKHZhciBiPVwiKFwiLGM9ITAsZD0wO2Q8YS5maWx0ZXJzLmxlbmd0aDtkKyspYz9jPSExOmIrPVwiKSBcIitnW2EudHlwZV0rXCIgKFwiLGIrPXRoaXMud3JpdGUoYS5maWx0ZXJzW2RdKTtyZXR1cm4gYitcIilcIjtjYXNlIFwiT3BlbkxheWVycy5GaWx0ZXIuQ29tcGFyaXNvblwiOnJldHVybiBhLnR5cGU9PU9wZW5MYXllcnMuRmlsdGVyLkNvbXBhcmlzb24uQkVUV0VFTj9hLnByb3BlcnR5K1wiIEJFVFdFRU4gXCIrdGhpcy53cml0ZShhLmxvd2VyQm91bmRhcnkpK1wiIEFORCBcIit0aGlzLndyaXRlKGEudXBwZXJCb3VuZGFyeSk6YS5wcm9wZXJ0eStcIiBcIitlW2EudHlwZV0rXCIgXCIrdGhpcy53cml0ZShhLnZhbHVlKTtjYXNlIHZvaWQgMDppZihcInN0cmluZ1wiPT09dHlwZW9mIGEpcmV0dXJuXCInXCIrYStcIidcIjtpZihcIm51bWJlclwiPT09dHlwZW9mIGEpcmV0dXJuXCJcIithO2RlZmF1bHQ6dGhyb3cgRXJyb3IoXCJDYW4ndCBlbmNvZGU6IFwiK2EuQ0xBU1NfTkFNRStcIiBcIithKTt9fSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Gb3JtYXQuQ1FMXCJ9KX0oKTtPcGVuTGF5ZXJzLkNvbnRyb2wuU3BsaXQ9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkNvbnRyb2wse2xheWVyOm51bGwsc291cmNlOm51bGwsc291cmNlT3B0aW9uczpudWxsLHRvbGVyYW5jZTpudWxsLGVkZ2U6ITAsZGVmZXJEZWxldGU6ITEsbXV0dWFsOiEwLHRhcmdldEZpbHRlcjpudWxsLHNvdXJjZUZpbHRlcjpudWxsLGhhbmRsZXI6bnVsbCxpbml0aWFsaXplOmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuQ29udHJvbC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLFthXSk7dGhpcy5vcHRpb25zPWF8fHt9O3RoaXMub3B0aW9ucy5zb3VyY2UmJnRoaXMuc2V0U291cmNlKHRoaXMub3B0aW9ucy5zb3VyY2UpfSxzZXRTb3VyY2U6ZnVuY3Rpb24oYSl7dGhpcy5hY3RpdmU/KHRoaXMuZGVhY3RpdmF0ZSgpLHRoaXMuaGFuZGxlciYmKHRoaXMuaGFuZGxlci5kZXN0cm95KCksZGVsZXRlIHRoaXMuaGFuZGxlciksdGhpcy5zb3VyY2U9YSx0aGlzLmFjdGl2YXRlKCkpOnRoaXMuc291cmNlPVxuYX0sYWN0aXZhdGU6ZnVuY3Rpb24oKXt2YXIgYT1PcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmFjdGl2YXRlLmNhbGwodGhpcyk7aWYoYSlpZih0aGlzLnNvdXJjZSl7aWYodGhpcy5zb3VyY2UuZXZlbnRzKXRoaXMuc291cmNlLmV2ZW50cy5vbih7c2tldGNoY29tcGxldGU6dGhpcy5vblNrZXRjaENvbXBsZXRlLGFmdGVyZmVhdHVyZW1vZGlmaWVkOnRoaXMuYWZ0ZXJGZWF0dXJlTW9kaWZpZWQsc2NvcGU6dGhpc30pfWVsc2UgdGhpcy5oYW5kbGVyfHwodGhpcy5oYW5kbGVyPW5ldyBPcGVuTGF5ZXJzLkhhbmRsZXIuUGF0aCh0aGlzLHtkb25lOmZ1bmN0aW9uKGEpe3RoaXMub25Ta2V0Y2hDb21wbGV0ZSh7ZmVhdHVyZTpuZXcgT3BlbkxheWVycy5GZWF0dXJlLlZlY3RvcihhKX0pfX0se2xheWVyT3B0aW9uczp0aGlzLnNvdXJjZU9wdGlvbnN9KSksdGhpcy5oYW5kbGVyLmFjdGl2YXRlKCk7cmV0dXJuIGF9LGRlYWN0aXZhdGU6ZnVuY3Rpb24oKXt2YXIgYT1PcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmRlYWN0aXZhdGUuY2FsbCh0aGlzKTtcbmEmJnRoaXMuc291cmNlJiZ0aGlzLnNvdXJjZS5ldmVudHMmJnRoaXMubGF5ZXIuZXZlbnRzLnVuKHtza2V0Y2hjb21wbGV0ZTp0aGlzLm9uU2tldGNoQ29tcGxldGUsYWZ0ZXJmZWF0dXJlbW9kaWZpZWQ6dGhpcy5hZnRlckZlYXR1cmVNb2RpZmllZCxzY29wZTp0aGlzfSk7cmV0dXJuIGF9LG9uU2tldGNoQ29tcGxldGU6ZnVuY3Rpb24oYSl7dGhpcy5mZWF0dXJlPW51bGw7cmV0dXJuIXRoaXMuY29uc2lkZXJTcGxpdChhLmZlYXR1cmUpfSxhZnRlckZlYXR1cmVNb2RpZmllZDpmdW5jdGlvbihhKXthLm1vZGlmaWVkJiZcImZ1bmN0aW9uXCI9PT10eXBlb2YgYS5mZWF0dXJlLmdlb21ldHJ5LnNwbGl0JiYodGhpcy5mZWF0dXJlPWEuZmVhdHVyZSx0aGlzLmNvbnNpZGVyU3BsaXQoYS5mZWF0dXJlKSl9LHJlbW92ZUJ5R2VvbWV0cnk6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9MCxkPWEubGVuZ3RoO2M8ZDsrK2MpaWYoYVtjXS5nZW9tZXRyeT09PWIpe2Euc3BsaWNlKGMsMSk7YnJlYWt9fSxcbmlzRWxpZ2libGU6ZnVuY3Rpb24oYSl7cmV0dXJuIGEuZ2VvbWV0cnk/YS5zdGF0ZSE9PU9wZW5MYXllcnMuU3RhdGUuREVMRVRFJiZcImZ1bmN0aW9uXCI9PT10eXBlb2YgYS5nZW9tZXRyeS5zcGxpdCYmdGhpcy5mZWF0dXJlIT09YSYmKCF0aGlzLnRhcmdldEZpbHRlcnx8dGhpcy50YXJnZXRGaWx0ZXIuZXZhbHVhdGUoYS5hdHRyaWJ1dGVzKSk6ITF9LGNvbnNpZGVyU3BsaXQ6ZnVuY3Rpb24oYSl7dmFyIGI9ITEsYz0hMTtpZighdGhpcy5zb3VyY2VGaWx0ZXJ8fHRoaXMuc291cmNlRmlsdGVyLmV2YWx1YXRlKGEuYXR0cmlidXRlcykpe2Zvcih2YXIgZD10aGlzLmxheWVyJiZ0aGlzLmxheWVyLmZlYXR1cmVzfHxbXSxlLGYsZz1bXSxoPVtdLGk9dGhpcy5sYXllcj09PXRoaXMuc291cmNlJiZ0aGlzLm11dHVhbCxqPXtlZGdlOnRoaXMuZWRnZSx0b2xlcmFuY2U6dGhpcy50b2xlcmFuY2UsbXV0dWFsOml9LGs9W2EuZ2VvbWV0cnldLGwsbSxuLG89MCxwPWQubGVuZ3RoO288cDsrK28paWYobD1cbmRbb10sdGhpcy5pc0VsaWdpYmxlKGwpKXttPVtsLmdlb21ldHJ5XTtmb3IodmFyIHE9MDtxPGsubGVuZ3RoOysrcSl7bj1rW3FdO2Zvcih2YXIgcj0wO3I8bS5sZW5ndGg7KytyKWlmKGU9bVtyXSxuLmdldEJvdW5kcygpLmludGVyc2VjdHNCb3VuZHMoZS5nZXRCb3VuZHMoKSkmJihlPW4uc3BsaXQoZSxqKSkpaWYoZj10aGlzLmV2ZW50cy50cmlnZ2VyRXZlbnQoXCJiZWZvcmVzcGxpdFwiLHtzb3VyY2U6YSx0YXJnZXQ6bH0pLCExIT09ZiYmKGkmJihmPWVbMF0sMTxmLmxlbmd0aCYmKGYudW5zaGlmdChxLDEpLEFycmF5LnByb3RvdHlwZS5zcGxpY2UuYXBwbHkoayxmKSxxKz1mLmxlbmd0aC0zKSxlPWVbMV0pLDE8ZS5sZW5ndGgpKWUudW5zaGlmdChyLDEpLEFycmF5LnByb3RvdHlwZS5zcGxpY2UuYXBwbHkobSxlKSxyKz1lLmxlbmd0aC0zfW0mJjE8bS5sZW5ndGgmJih0aGlzLmdlb21zVG9GZWF0dXJlcyhsLG0pLHRoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcInNwbGl0XCIse29yaWdpbmFsOmwsXG5mZWF0dXJlczptfSksQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoZyxtKSxoLnB1c2gobCksYz0hMCl9ayYmMTxrLmxlbmd0aCYmKHRoaXMuZ2VvbXNUb0ZlYXR1cmVzKGEsayksdGhpcy5ldmVudHMudHJpZ2dlckV2ZW50KFwic3BsaXRcIix7b3JpZ2luYWw6YSxmZWF0dXJlczprfSksQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoZyxrKSxoLnB1c2goYSksYj0hMCk7aWYoYnx8Yyl7aWYodGhpcy5kZWZlckRlbGV0ZSl7ZD1bXTtvPTA7Zm9yKHA9aC5sZW5ndGg7bzxwOysrbyljPWhbb10sYy5zdGF0ZT09PU9wZW5MYXllcnMuU3RhdGUuSU5TRVJUP2QucHVzaChjKTooYy5zdGF0ZT1PcGVuTGF5ZXJzLlN0YXRlLkRFTEVURSx0aGlzLmxheWVyLmRyYXdGZWF0dXJlKGMpKTt0aGlzLmxheWVyLmRlc3Ryb3lGZWF0dXJlcyhkLHtzaWxlbnQ6ITB9KTtvPTA7Zm9yKHA9Zy5sZW5ndGg7bzxwOysrbylnW29dLnN0YXRlPU9wZW5MYXllcnMuU3RhdGUuSU5TRVJUfWVsc2UgdGhpcy5sYXllci5kZXN0cm95RmVhdHVyZXMoaCxcbntzaWxlbnQ6ITB9KTt0aGlzLmxheWVyLmFkZEZlYXR1cmVzKGcse3NpbGVudDohMH0pO3RoaXMuZXZlbnRzLnRyaWdnZXJFdmVudChcImFmdGVyc3BsaXRcIix7c291cmNlOmEsZmVhdHVyZXM6Z30pfX1yZXR1cm4gYn0sZ2VvbXNUb0ZlYXR1cmVzOmZ1bmN0aW9uKGEsYil7dmFyIGM9YS5jbG9uZSgpO2RlbGV0ZSBjLmdlb21ldHJ5O2Zvcih2YXIgZCxlPTAsZj1iLmxlbmd0aDtlPGY7KytlKWQ9Yy5jbG9uZSgpLGQuZ2VvbWV0cnk9YltlXSxkLnN0YXRlPU9wZW5MYXllcnMuU3RhdGUuSU5TRVJULGJbZV09ZH0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMuYWN0aXZlJiZ0aGlzLmRlYWN0aXZhdGUoKTtPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmRlc3Ryb3kuY2FsbCh0aGlzKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuQ29udHJvbC5TcGxpdFwifSk7T3BlbkxheWVycy5MYXllci5XTVRTPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5MYXllci5HcmlkLHtpc0Jhc2VMYXllcjohMCx2ZXJzaW9uOlwiMS4wLjBcIixyZXF1ZXN0RW5jb2Rpbmc6XCJLVlBcIix1cmw6bnVsbCxsYXllcjpudWxsLG1hdHJpeFNldDpudWxsLHN0eWxlOm51bGwsZm9ybWF0OlwiaW1hZ2UvanBlZ1wiLHRpbGVPcmlnaW46bnVsbCx0aWxlRnVsbEV4dGVudDpudWxsLGZvcm1hdFN1ZmZpeDpudWxsLG1hdHJpeElkczpudWxsLGRpbWVuc2lvbnM6bnVsbCxwYXJhbXM6bnVsbCx6b29tT2Zmc2V0OjAsc2VydmVyUmVzb2x1dGlvbnM6bnVsbCxmb3JtYXRTdWZmaXhNYXA6e1wiaW1hZ2UvcG5nXCI6XCJwbmdcIixcImltYWdlL3BuZzhcIjpcInBuZ1wiLFwiaW1hZ2UvcG5nMjRcIjpcInBuZ1wiLFwiaW1hZ2UvcG5nMzJcIjpcInBuZ1wiLHBuZzpcInBuZ1wiLFwiaW1hZ2UvanBlZ1wiOlwianBnXCIsXCJpbWFnZS9qcGdcIjpcImpwZ1wiLGpwZWc6XCJqcGdcIixqcGc6XCJqcGdcIn0sbWF0cml4Om51bGwsaW5pdGlhbGl6ZTpmdW5jdGlvbihhKXt2YXIgYj1cbnt1cmw6ITAsbGF5ZXI6ITAsc3R5bGU6ITAsbWF0cml4U2V0OiEwfSxjO2ZvcihjIGluIGIpaWYoIShjIGluIGEpKXRocm93IEVycm9yKFwiTWlzc2luZyBwcm9wZXJ0eSAnXCIrYytcIicgaW4gbGF5ZXIgY29uZmlndXJhdGlvbi5cIik7YS5wYXJhbXM9T3BlbkxheWVycy5VdGlsLnVwcGVyQ2FzZU9iamVjdChhLnBhcmFtcyk7T3BlbkxheWVycy5MYXllci5HcmlkLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsW2EubmFtZSxhLnVybCxhLnBhcmFtcyxhXSk7dGhpcy5mb3JtYXRTdWZmaXh8fCh0aGlzLmZvcm1hdFN1ZmZpeD10aGlzLmZvcm1hdFN1ZmZpeE1hcFt0aGlzLmZvcm1hdF18fHRoaXMuZm9ybWF0LnNwbGl0KFwiL1wiKS5wb3AoKSk7aWYodGhpcy5tYXRyaXhJZHMmJihhPXRoaXMubWF0cml4SWRzLmxlbmd0aCkmJlwic3RyaW5nXCI9PT10eXBlb2YgdGhpcy5tYXRyaXhJZHNbMF0pe2I9dGhpcy5tYXRyaXhJZHM7dGhpcy5tYXRyaXhJZHM9QXJyYXkoYSk7Zm9yKGM9MDtjPGE7KytjKXRoaXMubWF0cml4SWRzW2NdPVxue2lkZW50aWZpZXI6YltjXX19fSxzZXRNYXA6ZnVuY3Rpb24oKXtPcGVuTGF5ZXJzLkxheWVyLkdyaWQucHJvdG90eXBlLnNldE1hcC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy51cGRhdGVNYXRyaXhQcm9wZXJ0aWVzKCl9LHVwZGF0ZU1hdHJpeFByb3BlcnRpZXM6ZnVuY3Rpb24oKXtpZih0aGlzLm1hdHJpeD10aGlzLmdldE1hdHJpeCgpKWlmKHRoaXMubWF0cml4LnRvcExlZnRDb3JuZXImJih0aGlzLnRpbGVPcmlnaW49dGhpcy5tYXRyaXgudG9wTGVmdENvcm5lciksdGhpcy5tYXRyaXgudGlsZVdpZHRoJiZ0aGlzLm1hdHJpeC50aWxlSGVpZ2h0JiYodGhpcy50aWxlU2l6ZT1uZXcgT3BlbkxheWVycy5TaXplKHRoaXMubWF0cml4LnRpbGVXaWR0aCx0aGlzLm1hdHJpeC50aWxlSGVpZ2h0KSksdGhpcy50aWxlT3JpZ2lufHwodGhpcy50aWxlT3JpZ2luPW5ldyBPcGVuTGF5ZXJzLkxvbkxhdCh0aGlzLm1heEV4dGVudC5sZWZ0LHRoaXMubWF4RXh0ZW50LnRvcCkpLCF0aGlzLnRpbGVGdWxsRXh0ZW50KXRoaXMudGlsZUZ1bGxFeHRlbnQ9XG50aGlzLm1heEV4dGVudH0sbW92ZVRvOmZ1bmN0aW9uKGEsYixjKXsoYnx8IXRoaXMubWF0cml4KSYmdGhpcy51cGRhdGVNYXRyaXhQcm9wZXJ0aWVzKCk7cmV0dXJuIE9wZW5MYXllcnMuTGF5ZXIuR3JpZC5wcm90b3R5cGUubW92ZVRvLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sY2xvbmU6ZnVuY3Rpb24oYSl7bnVsbD09YSYmKGE9bmV3IE9wZW5MYXllcnMuTGF5ZXIuV01UUyh0aGlzLm9wdGlvbnMpKTtyZXR1cm4gYT1PcGVuTGF5ZXJzLkxheWVyLkdyaWQucHJvdG90eXBlLmNsb25lLmFwcGx5KHRoaXMsW2FdKX0sZ2V0SWRlbnRpZmllcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldFNlcnZlclpvb20oKX0sZ2V0TWF0cml4OmZ1bmN0aW9uKCl7dmFyIGE7aWYoIXRoaXMubWF0cml4SWRzfHwwPT09dGhpcy5tYXRyaXhJZHMubGVuZ3RoKWE9e2lkZW50aWZpZXI6dGhpcy5nZXRJZGVudGlmaWVyKCl9O2Vsc2UgaWYoXCJzY2FsZURlbm9taW5hdG9yXCJpbiB0aGlzLm1hdHJpeElkc1swXSlmb3IodmFyIGI9XG5PcGVuTGF5ZXJzLk1FVEVSU19QRVJfSU5DSCpPcGVuTGF5ZXJzLklOQ0hFU19QRVJfVU5JVFt0aGlzLnVuaXRzXSp0aGlzLmdldFNlcnZlclJlc29sdXRpb24oKS8yLjhFLTQsYz1OdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksZCxlPTAsZj10aGlzLm1hdHJpeElkcy5sZW5ndGg7ZTxmOysrZSlkPU1hdGguYWJzKDEtdGhpcy5tYXRyaXhJZHNbZV0uc2NhbGVEZW5vbWluYXRvci9iKSxkPGMmJihjPWQsYT10aGlzLm1hdHJpeElkc1tlXSk7ZWxzZSBhPXRoaXMubWF0cml4SWRzW3RoaXMuZ2V0SWRlbnRpZmllcigpXTtyZXR1cm4gYX0sZ2V0VGlsZUluZm86ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5nZXRTZXJ2ZXJSZXNvbHV0aW9uKCksYz0oYS5sb24tdGhpcy50aWxlT3JpZ2luLmxvbikvKGIqdGhpcy50aWxlU2l6ZS53KSxhPSh0aGlzLnRpbGVPcmlnaW4ubGF0LWEubGF0KS8oYip0aGlzLnRpbGVTaXplLmgpLGI9TWF0aC5mbG9vcihjKSxkPU1hdGguZmxvb3IoYSk7cmV0dXJue2NvbDpiLFxucm93OmQsaTpNYXRoLmZsb29yKChjLWIpKnRoaXMudGlsZVNpemUudyksajpNYXRoLmZsb29yKChhLWQpKnRoaXMudGlsZVNpemUuaCl9fSxnZXRVUkw6ZnVuY3Rpb24oYSl7dmFyIGE9dGhpcy5hZGp1c3RCb3VuZHMoYSksYj1cIlwiO2lmKCF0aGlzLnRpbGVGdWxsRXh0ZW50fHx0aGlzLnRpbGVGdWxsRXh0ZW50LmludGVyc2VjdHNCb3VuZHMoYSkpe3ZhciBjPXRoaXMuZ2V0VGlsZUluZm8oYS5nZXRDZW50ZXJMb25MYXQoKSksYT10aGlzLmRpbWVuc2lvbnM7aWYoXCJSRVNUXCI9PT10aGlzLnJlcXVlc3RFbmNvZGluZy50b1VwcGVyQ2FzZSgpKWlmKGI9dGhpcy5wYXJhbXMsXCJzdHJpbmdcIj09PXR5cGVvZiB0aGlzLnVybCYmLTEhPT10aGlzLnVybC5pbmRleE9mKFwie1wiKSl7dmFyIGQ9dGhpcy51cmwucmVwbGFjZSgvXFx7L2csXCIke1wiKSxjPXtzdHlsZTp0aGlzLnN0eWxlLFN0eWxlOnRoaXMuc3R5bGUsVGlsZU1hdHJpeFNldDp0aGlzLm1hdHJpeFNldCxUaWxlTWF0cml4OnRoaXMubWF0cml4LmlkZW50aWZpZXIsXG5UaWxlUm93OmMucm93LFRpbGVDb2w6Yy5jb2x9O2lmKGEpe3ZhciBlLGY7Zm9yKGY9YS5sZW5ndGgtMTswPD1mOy0tZillPWFbZl0sY1tlXT1iW2UudG9VcHBlckNhc2UoKV19Yj1PcGVuTGF5ZXJzLlN0cmluZy5mb3JtYXQoZCxjKX1lbHNle2Q9dGhpcy52ZXJzaW9uK1wiL1wiK3RoaXMubGF5ZXIrXCIvXCIrdGhpcy5zdHlsZStcIi9cIjtpZihhKWZvcihmPTA7ZjxhLmxlbmd0aDtmKyspYlthW2ZdXSYmKGQ9ZCtiW2FbZl1dK1wiL1wiKTtkPWQrdGhpcy5tYXRyaXhTZXQrXCIvXCIrdGhpcy5tYXRyaXguaWRlbnRpZmllcitcIi9cIitjLnJvdytcIi9cIitjLmNvbCtcIi5cIit0aGlzLmZvcm1hdFN1ZmZpeDtiPU9wZW5MYXllcnMuVXRpbC5pc0FycmF5KHRoaXMudXJsKT90aGlzLnNlbGVjdFVybChkLHRoaXMudXJsKTp0aGlzLnVybDtiLm1hdGNoKC9cXC8kLyl8fChiKz1cIi9cIik7Yis9ZH1lbHNlXCJLVlBcIj09PXRoaXMucmVxdWVzdEVuY29kaW5nLnRvVXBwZXJDYXNlKCkmJihiPXtTRVJWSUNFOlwiV01UU1wiLFJFUVVFU1Q6XCJHZXRUaWxlXCIsXG5WRVJTSU9OOnRoaXMudmVyc2lvbixMQVlFUjp0aGlzLmxheWVyLFNUWUxFOnRoaXMuc3R5bGUsVElMRU1BVFJJWFNFVDp0aGlzLm1hdHJpeFNldCxUSUxFTUFUUklYOnRoaXMubWF0cml4LmlkZW50aWZpZXIsVElMRVJPVzpjLnJvdyxUSUxFQ09MOmMuY29sLEZPUk1BVDp0aGlzLmZvcm1hdH0sYj1PcGVuTGF5ZXJzLkxheWVyLkdyaWQucHJvdG90eXBlLmdldEZ1bGxSZXF1ZXN0U3RyaW5nLmFwcGx5KHRoaXMsW2JdKSl9cmV0dXJuIGJ9LG1lcmdlTmV3UGFyYW1zOmZ1bmN0aW9uKGEpe2lmKFwiS1ZQXCI9PT10aGlzLnJlcXVlc3RFbmNvZGluZy50b1VwcGVyQ2FzZSgpKXJldHVybiBPcGVuTGF5ZXJzLkxheWVyLkdyaWQucHJvdG90eXBlLm1lcmdlTmV3UGFyYW1zLmFwcGx5KHRoaXMsW09wZW5MYXllcnMuVXRpbC51cHBlckNhc2VPYmplY3QoYSldKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuTGF5ZXIuV01UU1wifSk7T3BlbkxheWVycy5Qcm90b2NvbC5TT1MudjFfMF8wPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Qcm90b2NvbCx7Zm9pczpudWxsLGZvcm1hdE9wdGlvbnM6bnVsbCxpbml0aWFsaXplOmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuUHJvdG9jb2wucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxbYV0pO2EuZm9ybWF0fHwodGhpcy5mb3JtYXQ9bmV3IE9wZW5MYXllcnMuRm9ybWF0LlNPU0dldEZlYXR1cmVPZkludGVyZXN0KHRoaXMuZm9ybWF0T3B0aW9ucykpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5vcHRpb25zJiYhdGhpcy5vcHRpb25zLmZvcm1hdCYmdGhpcy5mb3JtYXQuZGVzdHJveSgpO3RoaXMuZm9ybWF0PW51bGw7T3BlbkxheWVycy5Qcm90b2NvbC5wcm90b3R5cGUuZGVzdHJveS5hcHBseSh0aGlzKX0scmVhZDpmdW5jdGlvbihhKXthPU9wZW5MYXllcnMuVXRpbC5leHRlbmQoe30sYSk7T3BlbkxheWVycy5VdGlsLmFwcGx5RGVmYXVsdHMoYSx0aGlzLm9wdGlvbnN8fFxue30pO3ZhciBiPW5ldyBPcGVuTGF5ZXJzLlByb3RvY29sLlJlc3BvbnNlKHtyZXF1ZXN0VHlwZTpcInJlYWRcIn0pLGM9dGhpcy5mb3JtYXQsYz1PcGVuTGF5ZXJzLkZvcm1hdC5YTUwucHJvdG90eXBlLndyaXRlLmFwcGx5KGMsW2Mud3JpdGVOb2RlKFwic29zOkdldEZlYXR1cmVPZkludGVyZXN0XCIse2ZvaXM6dGhpcy5mb2lzfSldKTtiLnByaXY9T3BlbkxheWVycy5SZXF1ZXN0LlBPU1Qoe3VybDphLnVybCxjYWxsYmFjazp0aGlzLmNyZWF0ZUNhbGxiYWNrKHRoaXMuaGFuZGxlUmVhZCxiLGEpLGRhdGE6Y30pO3JldHVybiBifSxoYW5kbGVSZWFkOmZ1bmN0aW9uKGEsYil7aWYoYi5jYWxsYmFjayl7dmFyIGM9YS5wcml2OzIwMDw9Yy5zdGF0dXMmJjMwMD5jLnN0YXR1cz8oYS5mZWF0dXJlcz10aGlzLnBhcnNlRmVhdHVyZXMoYyksYS5jb2RlPU9wZW5MYXllcnMuUHJvdG9jb2wuUmVzcG9uc2UuU1VDQ0VTUyk6YS5jb2RlPU9wZW5MYXllcnMuUHJvdG9jb2wuUmVzcG9uc2UuRkFJTFVSRTtcbmIuY2FsbGJhY2suY2FsbChiLnNjb3BlLGEpfX0scGFyc2VGZWF0dXJlczpmdW5jdGlvbihhKXt2YXIgYj1hLnJlc3BvbnNlWE1MO2lmKCFifHwhYi5kb2N1bWVudEVsZW1lbnQpYj1hLnJlc3BvbnNlVGV4dDtyZXR1cm4hYnx8MD49Yi5sZW5ndGg/bnVsbDp0aGlzLmZvcm1hdC5yZWFkKGIpfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Qcm90b2NvbC5TT1MudjFfMF8wXCJ9KTtPcGVuTGF5ZXJzLkxheWVyLkthTWFwQ2FjaGU9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkxheWVyLkthTWFwLHtJTUFHRV9FWFRFTlNJT05TOntqcGVnOlwianBnXCIsZ2lmOlwiZ2lmXCIscG5nOlwicG5nXCIscG5nODpcInBuZ1wiLHBuZzI0OlwicG5nXCIsZGl0aGVyZWQ6XCJwbmdcIn0sREVGQVVMVF9GT1JNQVQ6XCJqcGVnXCIsaW5pdGlhbGl6ZTpmdW5jdGlvbihhLGIsYyxkKXtPcGVuTGF5ZXJzLkxheWVyLkthTWFwLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmV4dGVuc2lvbj10aGlzLklNQUdFX0VYVEVOU0lPTlNbdGhpcy5wYXJhbXMuaS50b0xvd2VyQ2FzZSgpfHx0aGlzLkRFRkFVTFRfRk9STUFUXX0sZ2V0VVJMOmZ1bmN0aW9uKGEpe3ZhciBhPXRoaXMuYWRqdXN0Qm91bmRzKGEpLGI9dGhpcy5tYXAuZ2V0UmVzb2x1dGlvbigpLGM9TWF0aC5yb3VuZCgxRTQqdGhpcy5tYXAuZ2V0U2NhbGUoKSkvMUU0LGQ9TWF0aC5yb3VuZChhLmxlZnQvYiksYT1cbi1NYXRoLnJvdW5kKGEudG9wL2IpLGI9TWF0aC5mbG9vcihkL3RoaXMudGlsZVNpemUudy90aGlzLnBhcmFtcy5tZXRhVGlsZVNpemUudykqdGhpcy50aWxlU2l6ZS53KnRoaXMucGFyYW1zLm1ldGFUaWxlU2l6ZS53LGU9TWF0aC5mbG9vcihhL3RoaXMudGlsZVNpemUuaC90aGlzLnBhcmFtcy5tZXRhVGlsZVNpemUuaCkqdGhpcy50aWxlU2l6ZS5oKnRoaXMucGFyYW1zLm1ldGFUaWxlU2l6ZS5oLGM9W1wiL1wiLHRoaXMucGFyYW1zLm1hcCxcIi9cIixjLFwiL1wiLHRoaXMucGFyYW1zLmcucmVwbGFjZSgvXFxzL2csXCJfXCIpLFwiL2RlZi90XCIsZSxcIi9sXCIsYixcIi90XCIsYSxcImxcIixkLFwiLlwiLHRoaXMuZXh0ZW5zaW9uXSxkPXRoaXMudXJsO09wZW5MYXllcnMuVXRpbC5pc0FycmF5KGQpJiYoZD10aGlzLnNlbGVjdFVybChjLmpvaW4oXCJcIiksZCkpO3JldHVybiBkK2Muam9pbihcIlwiKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuTGF5ZXIuS2FNYXBDYWNoZVwifSk7T3BlbkxheWVycy5Qcm90b2NvbC5XRlMudjFfMV8wPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Qcm90b2NvbC5XRlMudjEse3ZlcnNpb246XCIxLjEuMFwiLGluaXRpYWxpemU6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5Qcm90b2NvbC5XRlMudjEucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMub3V0cHV0Rm9ybWF0JiYhdGhpcy5yZWFkRm9ybWF0JiYoXCJnbWwyXCI9PXRoaXMub3V0cHV0Rm9ybWF0LnRvTG93ZXJDYXNlKCk/dGhpcy5yZWFkRm9ybWF0PW5ldyBPcGVuTGF5ZXJzLkZvcm1hdC5HTUwudjIoe2ZlYXR1cmVUeXBlOnRoaXMuZmVhdHVyZVR5cGUsZmVhdHVyZU5TOnRoaXMuZmVhdHVyZU5TLGdlb21ldHJ5TmFtZTp0aGlzLmdlb21ldHJ5TmFtZX0pOlwianNvblwiPT10aGlzLm91dHB1dEZvcm1hdC50b0xvd2VyQ2FzZSgpJiYodGhpcy5yZWFkRm9ybWF0PW5ldyBPcGVuTGF5ZXJzLkZvcm1hdC5HZW9KU09OKSl9LENMQVNTX05BTUU6XCJPcGVuTGF5ZXJzLlByb3RvY29sLldGUy52MV8xXzBcIn0pO09wZW5MYXllcnMuRm9ybWF0LldNU0NhcGFiaWxpdGllcy52MV8xXzE9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkZvcm1hdC5XTVNDYXBhYmlsaXRpZXMudjFfMSx7dmVyc2lvbjpcIjEuMS4xXCIscmVhZGVyczp7d21zOk9wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKHtTUlM6ZnVuY3Rpb24oYSxiKXtiLnNyc1t0aGlzLmdldENoaWxkVmFsdWUoYSldPSEwfX0sT3BlbkxheWVycy5Gb3JtYXQuV01TQ2FwYWJpbGl0aWVzLnYxXzEucHJvdG90eXBlLnJlYWRlcnMud21zKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuRm9ybWF0LldNU0NhcGFiaWxpdGllcy52MV8xXzFcIn0pO09wZW5MYXllcnMuRm9ybWF0LldNU0NhcGFiaWxpdGllcy52MV8xXzFfV01TQz1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuRm9ybWF0LldNU0NhcGFiaWxpdGllcy52MV8xXzEse3ZlcnNpb246XCIxLjEuMVwiLHByb2ZpbGU6XCJXTVNDXCIscmVhZGVyczp7d21zOk9wZW5MYXllcnMuVXRpbC5hcHBseURlZmF1bHRzKHtWZW5kb3JTcGVjaWZpY0NhcGFiaWxpdGllczpmdW5jdGlvbihhLGIpe2IudmVuZG9yU3BlY2lmaWM9e3RpbGVTZXRzOltdfTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYi52ZW5kb3JTcGVjaWZpYyl9LFRpbGVTZXQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz17c3JzOnt9LGJib3g6e30scmVzb2x1dGlvbnM6W119O3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKTtiLnRpbGVTZXRzLnB1c2goYyl9LFJlc29sdXRpb25zOmZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKS5zcGxpdChcIiBcIiksZD0wLGU9Yy5sZW5ndGg7ZDxlO2QrKylcIlwiIT1jW2RdJiZiLnJlc29sdXRpb25zLnB1c2gocGFyc2VGbG9hdChjW2RdKSl9LFxuV2lkdGg6ZnVuY3Rpb24oYSxiKXtiLndpZHRoPXBhcnNlSW50KHRoaXMuZ2V0Q2hpbGRWYWx1ZShhKSl9LEhlaWdodDpmdW5jdGlvbihhLGIpe2IuaGVpZ2h0PXBhcnNlSW50KHRoaXMuZ2V0Q2hpbGRWYWx1ZShhKSl9LExheWVyczpmdW5jdGlvbihhLGIpe2IubGF5ZXJzPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKX0sU3R5bGVzOmZ1bmN0aW9uKGEsYil7Yi5zdHlsZXM9dGhpcy5nZXRDaGlsZFZhbHVlKGEpfX0sT3BlbkxheWVycy5Gb3JtYXQuV01TQ2FwYWJpbGl0aWVzLnYxXzFfMS5wcm90b3R5cGUucmVhZGVycy53bXMpfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Gb3JtYXQuV01TQ2FwYWJpbGl0aWVzLnYxXzFfMV9XTVNDXCJ9KTtPcGVuTGF5ZXJzLkZvcm1hdC5XTVNDYXBhYmlsaXRpZXMudjFfMV8wPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Gb3JtYXQuV01TQ2FwYWJpbGl0aWVzLnYxXzEse3ZlcnNpb246XCIxLjEuMFwiLHJlYWRlcnM6e3dtczpPcGVuTGF5ZXJzLlV0aWwuYXBwbHlEZWZhdWx0cyh7U1JTOmZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPXRoaXMuZ2V0Q2hpbGRWYWx1ZShhKS5zcGxpdCgvICsvKSxkPTAsZT1jLmxlbmd0aDtkPGU7ZCsrKWIuc3JzW2NbZF1dPSEwfX0sT3BlbkxheWVycy5Gb3JtYXQuV01TQ2FwYWJpbGl0aWVzLnYxXzEucHJvdG90eXBlLnJlYWRlcnMud21zKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuRm9ybWF0LldNU0NhcGFiaWxpdGllcy52MV8xXzBcIn0pO09wZW5MYXllcnMuQ29udHJvbC5MYXllclN3aXRjaGVyPU9wZW5MYXllcnMuQ2xhc3MoT3BlbkxheWVycy5Db250cm9sLHtyb3VuZGVkQ29ybmVyOiExLHJvdW5kZWRDb3JuZXJDb2xvcjpcImRhcmtibHVlXCIsbGF5ZXJTdGF0ZXM6bnVsbCxsYXllcnNEaXY6bnVsbCxiYXNlTGF5ZXJzRGl2Om51bGwsYmFzZUxheWVyczpudWxsLGRhdGFMYmw6bnVsbCxkYXRhTGF5ZXJzRGl2Om51bGwsZGF0YUxheWVyczpudWxsLG1pbmltaXplRGl2Om51bGwsbWF4aW1pemVEaXY6bnVsbCxhc2NlbmRpbmc6ITAsaW5pdGlhbGl6ZTpmdW5jdGlvbihhKXtPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMubGF5ZXJTdGF0ZXM9W107dGhpcy5yb3VuZGVkQ29ybmVyJiZPcGVuTGF5ZXJzLkNvbnNvbGUud2FybihcInJvdW5kZWRDb3JuZXIgb3B0aW9uIGlzIGRlcHJlY2F0ZWRcIil9LGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLmNsZWFyTGF5ZXJzQXJyYXkoXCJiYXNlXCIpO1xudGhpcy5jbGVhckxheWVyc0FycmF5KFwiZGF0YVwiKTt0aGlzLm1hcC5ldmVudHMudW4oe2J1dHRvbmNsaWNrOnRoaXMub25CdXR0b25DbGljayxhZGRsYXllcjp0aGlzLnJlZHJhdyxjaGFuZ2VsYXllcjp0aGlzLnJlZHJhdyxyZW1vdmVsYXllcjp0aGlzLnJlZHJhdyxjaGFuZ2ViYXNlbGF5ZXI6dGhpcy5yZWRyYXcsc2NvcGU6dGhpc30pO3RoaXMuZXZlbnRzLnVucmVnaXN0ZXIoXCJidXR0b25jbGlja1wiLHRoaXMsdGhpcy5vbkJ1dHRvbkNsaWNrKTtPcGVuTGF5ZXJzLkNvbnRyb2wucHJvdG90eXBlLmRlc3Ryb3kuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxzZXRNYXA6ZnVuY3Rpb24oYSl7T3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5zZXRNYXAuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMubWFwLmV2ZW50cy5vbih7YWRkbGF5ZXI6dGhpcy5yZWRyYXcsY2hhbmdlbGF5ZXI6dGhpcy5yZWRyYXcscmVtb3ZlbGF5ZXI6dGhpcy5yZWRyYXcsY2hhbmdlYmFzZWxheWVyOnRoaXMucmVkcmF3LFxuc2NvcGU6dGhpc30pO3RoaXMub3V0c2lkZVZpZXdwb3J0Pyh0aGlzLmV2ZW50cy5hdHRhY2hUb0VsZW1lbnQodGhpcy5kaXYpLHRoaXMuZXZlbnRzLnJlZ2lzdGVyKFwiYnV0dG9uY2xpY2tcIix0aGlzLHRoaXMub25CdXR0b25DbGljaykpOnRoaXMubWFwLmV2ZW50cy5yZWdpc3RlcihcImJ1dHRvbmNsaWNrXCIsdGhpcyx0aGlzLm9uQnV0dG9uQ2xpY2spfSxkcmF3OmZ1bmN0aW9uKCl7T3BlbkxheWVycy5Db250cm9sLnByb3RvdHlwZS5kcmF3LmFwcGx5KHRoaXMpO3RoaXMubG9hZENvbnRlbnRzKCk7dGhpcy5vdXRzaWRlVmlld3BvcnR8fHRoaXMubWluaW1pemVDb250cm9sKCk7dGhpcy5yZWRyYXcoKTtyZXR1cm4gdGhpcy5kaXZ9LG9uQnV0dG9uQ2xpY2s6ZnVuY3Rpb24oYSl7YT1hLmJ1dHRvbkVsZW1lbnQ7YT09PXRoaXMubWluaW1pemVEaXY/dGhpcy5taW5pbWl6ZUNvbnRyb2woKTphPT09dGhpcy5tYXhpbWl6ZURpdj90aGlzLm1heGltaXplQ29udHJvbCgpOmEuX2xheWVyU3dpdGNoZXI9PT1cbnRoaXMuaWQmJihhW1wiZm9yXCJdJiYoYT1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChhW1wiZm9yXCJdKSksYS5kaXNhYmxlZHx8KFwicmFkaW9cIj09YS50eXBlPyhhLmNoZWNrZWQ9ITAsdGhpcy5tYXAuc2V0QmFzZUxheWVyKHRoaXMubWFwLmdldExheWVyKGEuX2xheWVyKSkpOihhLmNoZWNrZWQ9IWEuY2hlY2tlZCx0aGlzLnVwZGF0ZU1hcCgpKSkpfSxjbGVhckxheWVyc0FycmF5OmZ1bmN0aW9uKGEpe3RoaXNbYStcIkxheWVyc0RpdlwiXS5pbm5lckhUTUw9XCJcIjt0aGlzW2ErXCJMYXllcnNcIl09W119LGNoZWNrUmVkcmF3OmZ1bmN0aW9uKCl7dmFyIGE9ITE7aWYoIXRoaXMubGF5ZXJTdGF0ZXMubGVuZ3RofHx0aGlzLm1hcC5sYXllcnMubGVuZ3RoIT10aGlzLmxheWVyU3RhdGVzLmxlbmd0aClhPSEwO2Vsc2UgZm9yKHZhciBiPTAsYz10aGlzLmxheWVyU3RhdGVzLmxlbmd0aDtiPGM7YisrKXt2YXIgZD10aGlzLmxheWVyU3RhdGVzW2JdLGU9dGhpcy5tYXAubGF5ZXJzW2JdO2lmKGQubmFtZSE9XG5lLm5hbWV8fGQuaW5SYW5nZSE9ZS5pblJhbmdlfHxkLmlkIT1lLmlkfHxkLnZpc2liaWxpdHkhPWUudmlzaWJpbGl0eSl7YT0hMDticmVha319cmV0dXJuIGF9LHJlZHJhdzpmdW5jdGlvbigpe2lmKCF0aGlzLmNoZWNrUmVkcmF3KCkpcmV0dXJuIHRoaXMuZGl2O3RoaXMuY2xlYXJMYXllcnNBcnJheShcImJhc2VcIik7dGhpcy5jbGVhckxheWVyc0FycmF5KFwiZGF0YVwiKTt2YXIgYT0hMSxiPSExLGM9dGhpcy5tYXAubGF5ZXJzLmxlbmd0aDt0aGlzLmxheWVyU3RhdGVzPUFycmF5KGMpO2Zvcih2YXIgZD0wO2Q8YztkKyspe3ZhciBlPXRoaXMubWFwLmxheWVyc1tkXTt0aGlzLmxheWVyU3RhdGVzW2RdPXtuYW1lOmUubmFtZSx2aXNpYmlsaXR5OmUudmlzaWJpbGl0eSxpblJhbmdlOmUuaW5SYW5nZSxpZDplLmlkfX12YXIgZj10aGlzLm1hcC5sYXllcnMuc2xpY2UoKTt0aGlzLmFzY2VuZGluZ3x8Zi5yZXZlcnNlKCk7ZD0wO2ZvcihjPWYubGVuZ3RoO2Q8YztkKyspe3ZhciBlPWZbZF0sXG5nPWUuaXNCYXNlTGF5ZXI7aWYoZS5kaXNwbGF5SW5MYXllclN3aXRjaGVyKXtnP2I9ITA6YT0hMDt2YXIgaD1nP2U9PXRoaXMubWFwLmJhc2VMYXllcjplLmdldFZpc2liaWxpdHkoKSxpPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtpLmlkPXRoaXMuaWQrXCJfaW5wdXRfXCIrZS5uYW1lO2kubmFtZT1nP3RoaXMuaWQrXCJfYmFzZUxheWVyc1wiOmUubmFtZTtpLnR5cGU9Zz9cInJhZGlvXCI6XCJjaGVja2JveFwiO2kudmFsdWU9ZS5uYW1lO2kuY2hlY2tlZD1oO2kuZGVmYXVsdENoZWNrZWQ9aDtpLmNsYXNzTmFtZT1cIm9sQnV0dG9uXCI7aS5fbGF5ZXI9ZS5pZDtpLl9sYXllclN3aXRjaGVyPXRoaXMuaWQ7IWcmJiFlLmluUmFuZ2UmJihpLmRpc2FibGVkPSEwKTtoPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsYWJlbFwiKTtoW1wiZm9yXCJdPWkuaWQ7T3BlbkxheWVycy5FbGVtZW50LmFkZENsYXNzKGgsXCJsYWJlbFNwYW4gb2xCdXR0b25cIik7aC5fbGF5ZXI9ZS5pZDtoLl9sYXllclN3aXRjaGVyPVxudGhpcy5pZDshZyYmIWUuaW5SYW5nZSYmKGguc3R5bGUuY29sb3I9XCJncmF5XCIpO2guaW5uZXJIVE1MPWUubmFtZTtoLnN0eWxlLnZlcnRpY2FsQWxpZ249Zz9cImJvdHRvbVwiOlwiYmFzZWxpbmVcIjt2YXIgaj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnJcIik7KGc/dGhpcy5iYXNlTGF5ZXJzOnRoaXMuZGF0YUxheWVycykucHVzaCh7bGF5ZXI6ZSxpbnB1dEVsZW06aSxsYWJlbFNwYW46aH0pO2U9Zz90aGlzLmJhc2VMYXllcnNEaXY6dGhpcy5kYXRhTGF5ZXJzRGl2O2UuYXBwZW5kQ2hpbGQoaSk7ZS5hcHBlbmRDaGlsZChoKTtlLmFwcGVuZENoaWxkKGopfX10aGlzLmRhdGFMYmwuc3R5bGUuZGlzcGxheT1hP1wiXCI6XCJub25lXCI7dGhpcy5iYXNlTGJsLnN0eWxlLmRpc3BsYXk9Yj9cIlwiOlwibm9uZVwiO3JldHVybiB0aGlzLmRpdn0sdXBkYXRlTWFwOmZ1bmN0aW9uKCl7Zm9yKHZhciBhPTAsYj10aGlzLmJhc2VMYXllcnMubGVuZ3RoO2E8YjthKyspe3ZhciBjPXRoaXMuYmFzZUxheWVyc1thXTtcbmMuaW5wdXRFbGVtLmNoZWNrZWQmJnRoaXMubWFwLnNldEJhc2VMYXllcihjLmxheWVyLCExKX1hPTA7Zm9yKGI9dGhpcy5kYXRhTGF5ZXJzLmxlbmd0aDthPGI7YSsrKWM9dGhpcy5kYXRhTGF5ZXJzW2FdLGMubGF5ZXIuc2V0VmlzaWJpbGl0eShjLmlucHV0RWxlbS5jaGVja2VkKX0sbWF4aW1pemVDb250cm9sOmZ1bmN0aW9uKGEpe3RoaXMuZGl2LnN0eWxlLndpZHRoPVwiXCI7dGhpcy5kaXYuc3R5bGUuaGVpZ2h0PVwiXCI7dGhpcy5zaG93Q29udHJvbHMoITEpO251bGwhPWEmJk9wZW5MYXllcnMuRXZlbnQuc3RvcChhKX0sbWluaW1pemVDb250cm9sOmZ1bmN0aW9uKGEpe3RoaXMuZGl2LnN0eWxlLndpZHRoPVwiMHB4XCI7dGhpcy5kaXYuc3R5bGUuaGVpZ2h0PVwiMHB4XCI7dGhpcy5zaG93Q29udHJvbHMoITApO251bGwhPWEmJk9wZW5MYXllcnMuRXZlbnQuc3RvcChhKX0sc2hvd0NvbnRyb2xzOmZ1bmN0aW9uKGEpe3RoaXMubWF4aW1pemVEaXYuc3R5bGUuZGlzcGxheT1hP1wiXCI6XCJub25lXCI7XG50aGlzLm1pbmltaXplRGl2LnN0eWxlLmRpc3BsYXk9YT9cIm5vbmVcIjpcIlwiO3RoaXMubGF5ZXJzRGl2LnN0eWxlLmRpc3BsYXk9YT9cIm5vbmVcIjpcIlwifSxsb2FkQ29udGVudHM6ZnVuY3Rpb24oKXt0aGlzLmxheWVyc0Rpdj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO3RoaXMubGF5ZXJzRGl2LmlkPXRoaXMuaWQrXCJfbGF5ZXJzRGl2XCI7T3BlbkxheWVycy5FbGVtZW50LmFkZENsYXNzKHRoaXMubGF5ZXJzRGl2LFwibGF5ZXJzRGl2XCIpO3RoaXMuYmFzZUxibD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO3RoaXMuYmFzZUxibC5pbm5lckhUTUw9T3BlbkxheWVycy5pMThuKFwiQmFzZSBMYXllclwiKTtPcGVuTGF5ZXJzLkVsZW1lbnQuYWRkQ2xhc3ModGhpcy5iYXNlTGJsLFwiYmFzZUxibFwiKTt0aGlzLmJhc2VMYXllcnNEaXY9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtPcGVuTGF5ZXJzLkVsZW1lbnQuYWRkQ2xhc3ModGhpcy5iYXNlTGF5ZXJzRGl2LFwiYmFzZUxheWVyc0RpdlwiKTtcbnRoaXMuZGF0YUxibD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO3RoaXMuZGF0YUxibC5pbm5lckhUTUw9T3BlbkxheWVycy5pMThuKFwiT3ZlcmxheXNcIik7T3BlbkxheWVycy5FbGVtZW50LmFkZENsYXNzKHRoaXMuZGF0YUxibCxcImRhdGFMYmxcIik7dGhpcy5kYXRhTGF5ZXJzRGl2PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7T3BlbkxheWVycy5FbGVtZW50LmFkZENsYXNzKHRoaXMuZGF0YUxheWVyc0RpdixcImRhdGFMYXllcnNEaXZcIik7dGhpcy5hc2NlbmRpbmc/KHRoaXMubGF5ZXJzRGl2LmFwcGVuZENoaWxkKHRoaXMuYmFzZUxibCksdGhpcy5sYXllcnNEaXYuYXBwZW5kQ2hpbGQodGhpcy5iYXNlTGF5ZXJzRGl2KSx0aGlzLmxheWVyc0Rpdi5hcHBlbmRDaGlsZCh0aGlzLmRhdGFMYmwpLHRoaXMubGF5ZXJzRGl2LmFwcGVuZENoaWxkKHRoaXMuZGF0YUxheWVyc0RpdikpOih0aGlzLmxheWVyc0Rpdi5hcHBlbmRDaGlsZCh0aGlzLmRhdGFMYmwpLHRoaXMubGF5ZXJzRGl2LmFwcGVuZENoaWxkKHRoaXMuZGF0YUxheWVyc0RpdiksXG50aGlzLmxheWVyc0Rpdi5hcHBlbmRDaGlsZCh0aGlzLmJhc2VMYmwpLHRoaXMubGF5ZXJzRGl2LmFwcGVuZENoaWxkKHRoaXMuYmFzZUxheWVyc0RpdikpO3RoaXMuZGl2LmFwcGVuZENoaWxkKHRoaXMubGF5ZXJzRGl2KTt0aGlzLnJvdW5kZWRDb3JuZXImJihPcGVuTGF5ZXJzLlJpY28uQ29ybmVyLnJvdW5kKHRoaXMuZGl2LHtjb3JuZXJzOlwidGwgYmxcIixiZ0NvbG9yOlwidHJhbnNwYXJlbnRcIixjb2xvcjp0aGlzLnJvdW5kZWRDb3JuZXJDb2xvcixibGVuZDohMX0pLE9wZW5MYXllcnMuUmljby5Db3JuZXIuY2hhbmdlT3BhY2l0eSh0aGlzLmxheWVyc0RpdiwwLjc1KSk7dmFyIGE9T3BlbkxheWVycy5VdGlsLmdldEltYWdlTG9jYXRpb24oXCJsYXllci1zd2l0Y2hlci1tYXhpbWl6ZS5wbmdcIik7dGhpcy5tYXhpbWl6ZURpdj1PcGVuTGF5ZXJzLlV0aWwuY3JlYXRlQWxwaGFJbWFnZURpdihcIk9wZW5MYXllcnNfQ29udHJvbF9NYXhpbWl6ZURpdlwiLG51bGwsbnVsbCxhLFwiYWJzb2x1dGVcIik7XG5PcGVuTGF5ZXJzLkVsZW1lbnQuYWRkQ2xhc3ModGhpcy5tYXhpbWl6ZURpdixcIm1heGltaXplRGl2IG9sQnV0dG9uXCIpO3RoaXMubWF4aW1pemVEaXYuc3R5bGUuZGlzcGxheT1cIm5vbmVcIjt0aGlzLmRpdi5hcHBlbmRDaGlsZCh0aGlzLm1heGltaXplRGl2KTthPU9wZW5MYXllcnMuVXRpbC5nZXRJbWFnZUxvY2F0aW9uKFwibGF5ZXItc3dpdGNoZXItbWluaW1pemUucG5nXCIpO3RoaXMubWluaW1pemVEaXY9T3BlbkxheWVycy5VdGlsLmNyZWF0ZUFscGhhSW1hZ2VEaXYoXCJPcGVuTGF5ZXJzX0NvbnRyb2xfTWluaW1pemVEaXZcIixudWxsLG51bGwsYSxcImFic29sdXRlXCIpO09wZW5MYXllcnMuRWxlbWVudC5hZGRDbGFzcyh0aGlzLm1pbmltaXplRGl2LFwibWluaW1pemVEaXYgb2xCdXR0b25cIik7dGhpcy5taW5pbWl6ZURpdi5zdHlsZS5kaXNwbGF5PVwibm9uZVwiO3RoaXMuZGl2LmFwcGVuZENoaWxkKHRoaXMubWluaW1pemVEaXYpfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Db250cm9sLkxheWVyU3dpdGNoZXJcIn0pO09wZW5MYXllcnMuRm9ybWF0LkF0b209T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkZvcm1hdC5YTUwse25hbWVzcGFjZXM6e2F0b206XCJodHRwOi8vd3d3LnczLm9yZy8yMDA1L0F0b21cIixnZW9yc3M6XCJodHRwOi8vd3d3Lmdlb3Jzcy5vcmcvZ2VvcnNzXCJ9LGZlZWRUaXRsZTpcInVudGl0bGVkXCIsZGVmYXVsdEVudHJ5VGl0bGU6XCJ1bnRpdGxlZFwiLGdtbFBhcnNlcjpudWxsLHh5OiExLHJlYWQ6ZnVuY3Rpb24oYSl7XCJzdHJpbmdcIj09dHlwZW9mIGEmJihhPU9wZW5MYXllcnMuRm9ybWF0LlhNTC5wcm90b3R5cGUucmVhZC5hcHBseSh0aGlzLFthXSkpO3JldHVybiB0aGlzLnBhcnNlRmVhdHVyZXMoYSl9LHdyaXRlOmZ1bmN0aW9uKGEpe3ZhciBiO2lmKE9wZW5MYXllcnMuVXRpbC5pc0FycmF5KGEpKXtiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcImF0b206ZmVlZFwiKTtiLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcImF0b206dGl0bGVcIix7dmFsdWU6dGhpcy5mZWVkVGl0bGV9KSk7XG5mb3IodmFyIGM9MCxkPWEubGVuZ3RoO2M8ZDtjKyspYi5hcHBlbmRDaGlsZCh0aGlzLmJ1aWxkRW50cnlOb2RlKGFbY10pKX1lbHNlIGI9dGhpcy5idWlsZEVudHJ5Tm9kZShhKTtyZXR1cm4gT3BlbkxheWVycy5Gb3JtYXQuWE1MLnByb3RvdHlwZS53cml0ZS5hcHBseSh0aGlzLFtiXSl9LGJ1aWxkQ29udGVudE5vZGU6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiYXRvbTpjb250ZW50XCIse2F0dHJpYnV0ZXM6e3R5cGU6YS50eXBlfHxudWxsfX0pO2lmKGEuc3JjKWIuc2V0QXR0cmlidXRlKFwic3JjXCIsYS5zcmMpO2Vsc2UgaWYoXCJ0ZXh0XCI9PWEudHlwZXx8bnVsbD09YS50eXBlKWIuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVUZXh0Tm9kZShhLnZhbHVlKSk7ZWxzZSBpZihcImh0bWxcIj09YS50eXBlKXtpZihcInN0cmluZ1wiIT10eXBlb2YgYS52YWx1ZSl0aHJvd1wiSFRNTCBjb250ZW50IG11c3QgYmUgaW4gZm9ybSBvZiBhbiBlc2NhcGVkIHN0cmluZ1wiO2IuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVUZXh0Tm9kZShhLnZhbHVlKSl9ZWxzZVwieGh0bWxcIj09XG5hLnR5cGU/Yi5hcHBlbmRDaGlsZChhLnZhbHVlKTpcInhodG1sXCI9PWEudHlwZXx8YS50eXBlLm1hdGNoKC8oXFwrfFxcLyl4bWwkLyk/Yi5hcHBlbmRDaGlsZChhLnZhbHVlKTpiLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlVGV4dE5vZGUoYS52YWx1ZSkpO3JldHVybiBifSxidWlsZEVudHJ5Tm9kZTpmdW5jdGlvbihhKXt2YXIgYj1hLmF0dHJpYnV0ZXMsYz1iLmF0b218fHt9LGQ9dGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiYXRvbTplbnRyeVwiKTtpZihjLmF1dGhvcnMpZm9yKHZhciBlPU9wZW5MYXllcnMuVXRpbC5pc0FycmF5KGMuYXV0aG9ycyk/Yy5hdXRob3JzOltjLmF1dGhvcnNdLGY9MCxnPWUubGVuZ3RoO2Y8ZztmKyspZC5hcHBlbmRDaGlsZCh0aGlzLmJ1aWxkUGVyc29uQ29uc3RydWN0Tm9kZShcImF1dGhvclwiLGVbZl0pKTtpZihjLmNhdGVnb3JpZXMpZm9yKHZhciBlPU9wZW5MYXllcnMuVXRpbC5pc0FycmF5KGMuY2F0ZWdvcmllcyk/Yy5jYXRlZ29yaWVzOltjLmNhdGVnb3JpZXNdLFxuaCxmPTAsZz1lLmxlbmd0aDtmPGc7ZisrKWg9ZVtmXSxkLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcImF0b206Y2F0ZWdvcnlcIix7YXR0cmlidXRlczp7dGVybTpoLnRlcm0sc2NoZW1lOmguc2NoZW1lfHxudWxsLGxhYmVsOmgubGFiZWx8fG51bGx9fSkpO2MuY29udGVudCYmZC5hcHBlbmRDaGlsZCh0aGlzLmJ1aWxkQ29udGVudE5vZGUoYy5jb250ZW50KSk7aWYoYy5jb250cmlidXRvcnMpe2U9T3BlbkxheWVycy5VdGlsLmlzQXJyYXkoYy5jb250cmlidXRvcnMpP2MuY29udHJpYnV0b3JzOltjLmNvbnRyaWJ1dG9yc107Zj0wO2ZvcihnPWUubGVuZ3RoO2Y8ZztmKyspZC5hcHBlbmRDaGlsZCh0aGlzLmJ1aWxkUGVyc29uQ29uc3RydWN0Tm9kZShcImNvbnRyaWJ1dG9yXCIsZVtmXSkpfWEuZmlkJiZkLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcImF0b206aWRcIix7dmFsdWU6YS5maWR9KSk7aWYoYy5saW5rcyl7ZT1PcGVuTGF5ZXJzLlV0aWwuaXNBcnJheShjLmxpbmtzKT9cbmMubGlua3M6W2MubGlua3NdO2Y9MDtmb3IoZz1lLmxlbmd0aDtmPGc7ZisrKWg9ZVtmXSxkLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcImF0b206bGlua1wiLHthdHRyaWJ1dGVzOntocmVmOmguaHJlZixyZWw6aC5yZWx8fG51bGwsdHlwZTpoLnR5cGV8fG51bGwsaHJlZmxhbmc6aC5ocmVmbGFuZ3x8bnVsbCx0aXRsZTpoLnRpdGxlfHxudWxsLGxlbmd0aDpoLmxlbmd0aHx8bnVsbH19KSl9Yy5wdWJsaXNoZWQmJmQuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiYXRvbTpwdWJsaXNoZWRcIix7dmFsdWU6Yy5wdWJsaXNoZWR9KSk7Yy5yaWdodHMmJmQuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiYXRvbTpyaWdodHNcIix7dmFsdWU6Yy5yaWdodHN9KSk7aWYoYy5zdW1tYXJ5fHxiLmRlc2NyaXB0aW9uKWQuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiYXRvbTpzdW1tYXJ5XCIse3ZhbHVlOmMuc3VtbWFyeXx8XG5iLmRlc2NyaXB0aW9ufSkpO2QuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVFbGVtZW50TlNQbHVzKFwiYXRvbTp0aXRsZVwiLHt2YWx1ZTpjLnRpdGxlfHxiLnRpdGxlfHx0aGlzLmRlZmF1bHRFbnRyeVRpdGxlfSkpO2MudXBkYXRlZCYmZC5hcHBlbmRDaGlsZCh0aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJhdG9tOnVwZGF0ZWRcIix7dmFsdWU6Yy51cGRhdGVkfSkpO2EuZ2VvbWV0cnkmJihiPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcImdlb3Jzczp3aGVyZVwiKSxiLmFwcGVuZENoaWxkKHRoaXMuYnVpbGRHZW9tZXRyeU5vZGUoYS5nZW9tZXRyeSkpLGQuYXBwZW5kQ2hpbGQoYikpO3JldHVybiBkfSxpbml0R21sUGFyc2VyOmZ1bmN0aW9uKCl7dGhpcy5nbWxQYXJzZXI9bmV3IE9wZW5MYXllcnMuRm9ybWF0LkdNTC52Myh7eHk6dGhpcy54eSxmZWF0dXJlTlM6XCJodHRwOi8vZXhhbXBsZS5jb20jZmVhdHVyZVwiLGludGVybmFsUHJvamVjdGlvbjp0aGlzLmludGVybmFsUHJvamVjdGlvbixcbmV4dGVybmFsUHJvamVjdGlvbjp0aGlzLmV4dGVybmFsUHJvamVjdGlvbn0pfSxidWlsZEdlb21ldHJ5Tm9kZTpmdW5jdGlvbihhKXt0aGlzLmdtbFBhcnNlcnx8dGhpcy5pbml0R21sUGFyc2VyKCk7cmV0dXJuIHRoaXMuZ21sUGFyc2VyLndyaXRlTm9kZShcImZlYXR1cmU6X2dlb21ldHJ5XCIsYSkuZmlyc3RDaGlsZH0sYnVpbGRQZXJzb25Db25zdHJ1Y3ROb2RlOmZ1bmN0aW9uKGEsYil7dmFyIGM9W1widXJpXCIsXCJlbWFpbFwiXSxkPXRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcImF0b206XCIrYSk7ZC5hcHBlbmRDaGlsZCh0aGlzLmNyZWF0ZUVsZW1lbnROU1BsdXMoXCJhdG9tOm5hbWVcIix7dmFsdWU6Yi5uYW1lfSkpO2Zvcih2YXIgZT0wLGY9Yy5sZW5ndGg7ZTxmO2UrKyliW2NbZV1dJiZkLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlRWxlbWVudE5TUGx1cyhcImF0b206XCIrY1tlXSx7dmFsdWU6YltjW2VdXX0pKTtyZXR1cm4gZH0sZ2V0Rmlyc3RDaGlsZFZhbHVlOmZ1bmN0aW9uKGEsYixjLFxuZCl7cmV0dXJuKGE9dGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZU5TKGEsYixjKSkmJjA8YS5sZW5ndGg/dGhpcy5nZXRDaGlsZFZhbHVlKGFbMF0sZCk6ZH0scGFyc2VGZWF0dXJlOmZ1bmN0aW9uKGEpe3ZhciBiPXt9LGM9bnVsbCxkPW51bGwsZT1udWxsLGY9dGhpcy5uYW1lc3BhY2VzLmF0b207dGhpcy5wYXJzZVBlcnNvbkNvbnN0cnVjdHMoYSxcImF1dGhvclwiLGIpO2Q9dGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZU5TKGEsZixcImNhdGVnb3J5XCIpOzA8ZC5sZW5ndGgmJihiLmNhdGVnb3JpZXM9W10pO2Zvcih2YXIgZz0wLGg9ZC5sZW5ndGg7ZzxoO2crKyl7Yz17fTtjLnRlcm09ZFtnXS5nZXRBdHRyaWJ1dGUoXCJ0ZXJtXCIpO2lmKGU9ZFtnXS5nZXRBdHRyaWJ1dGUoXCJzY2hlbWVcIikpYy5zY2hlbWU9ZTtpZihlPWRbZ10uZ2V0QXR0cmlidXRlKFwibGFiZWxcIikpYy5sYWJlbD1lO2IuY2F0ZWdvcmllcy5wdXNoKGMpfWQ9dGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZU5TKGEsZixcImNvbnRlbnRcIik7XG5pZigwPGQubGVuZ3RoKXtjPXt9O2lmKGU9ZFswXS5nZXRBdHRyaWJ1dGUoXCJ0eXBlXCIpKWMudHlwZT1lOyhlPWRbMF0uZ2V0QXR0cmlidXRlKFwic3JjXCIpKT9jLnNyYz1lOihjLnZhbHVlPVwidGV4dFwiPT1jLnR5cGV8fFwiaHRtbFwiPT1jLnR5cGV8fG51bGw9PWMudHlwZT90aGlzLmdldEZpcnN0Q2hpbGRWYWx1ZShhLGYsXCJjb250ZW50XCIsbnVsbCk6XCJ4aHRtbFwiPT1jLnR5cGV8fGMudHlwZS5tYXRjaCgvKFxcK3xcXC8peG1sJC8pP3RoaXMuZ2V0Q2hpbGRFbChkWzBdKTp0aGlzLmdldEZpcnN0Q2hpbGRWYWx1ZShhLGYsXCJjb250ZW50XCIsbnVsbCksYi5jb250ZW50PWMpfXRoaXMucGFyc2VQZXJzb25Db25zdHJ1Y3RzKGEsXCJjb250cmlidXRvclwiLGIpO2IuaWQ9dGhpcy5nZXRGaXJzdENoaWxkVmFsdWUoYSxmLFwiaWRcIixudWxsKTtkPXRoaXMuZ2V0RWxlbWVudHNCeVRhZ05hbWVOUyhhLGYsXCJsaW5rXCIpOzA8ZC5sZW5ndGgmJihiLmxpbmtzPUFycmF5KGQubGVuZ3RoKSk7Zm9yKHZhciBpPVtcInJlbFwiLFxuXCJ0eXBlXCIsXCJocmVmbGFuZ1wiLFwidGl0bGVcIixcImxlbmd0aFwiXSxnPTAsaD1kLmxlbmd0aDtnPGg7ZysrKXtjPXt9O2MuaHJlZj1kW2ddLmdldEF0dHJpYnV0ZShcImhyZWZcIik7Zm9yKHZhciBqPTAsaz1pLmxlbmd0aDtqPGs7aisrKShlPWRbZ10uZ2V0QXR0cmlidXRlKGlbal0pKSYmKGNbaVtqXV09ZSk7Yi5saW5rc1tnXT1jfWlmKGM9dGhpcy5nZXRGaXJzdENoaWxkVmFsdWUoYSxmLFwicHVibGlzaGVkXCIsbnVsbCkpYi5wdWJsaXNoZWQ9YztpZihjPXRoaXMuZ2V0Rmlyc3RDaGlsZFZhbHVlKGEsZixcInJpZ2h0c1wiLG51bGwpKWIucmlnaHRzPWM7aWYoYz10aGlzLmdldEZpcnN0Q2hpbGRWYWx1ZShhLGYsXCJzdW1tYXJ5XCIsbnVsbCkpYi5zdW1tYXJ5PWM7Yi50aXRsZT10aGlzLmdldEZpcnN0Q2hpbGRWYWx1ZShhLGYsXCJ0aXRsZVwiLG51bGwpO2IudXBkYXRlZD10aGlzLmdldEZpcnN0Q2hpbGRWYWx1ZShhLGYsXCJ1cGRhdGVkXCIsbnVsbCk7Yz17dGl0bGU6Yi50aXRsZSxkZXNjcmlwdGlvbjpiLnN1bW1hcnksXG5hdG9tOmJ9O2E9dGhpcy5wYXJzZUxvY2F0aW9ucyhhKVswXTthPW5ldyBPcGVuTGF5ZXJzLkZlYXR1cmUuVmVjdG9yKGEsYyk7YS5maWQ9Yi5pZDtyZXR1cm4gYX0scGFyc2VGZWF0dXJlczpmdW5jdGlvbihhKXt2YXIgYj1bXSxjPXRoaXMuZ2V0RWxlbWVudHNCeVRhZ05hbWVOUyhhLHRoaXMubmFtZXNwYWNlcy5hdG9tLFwiZW50cnlcIik7MD09Yy5sZW5ndGgmJihjPVthXSk7Zm9yKHZhciBhPTAsZD1jLmxlbmd0aDthPGQ7YSsrKWIucHVzaCh0aGlzLnBhcnNlRmVhdHVyZShjW2FdKSk7cmV0dXJuIGJ9LHBhcnNlTG9jYXRpb25zOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMubmFtZXNwYWNlcy5nZW9yc3MsYz17Y29tcG9uZW50czpbXX0sZD10aGlzLmdldEVsZW1lbnRzQnlUYWdOYW1lTlMoYSxiLFwid2hlcmVcIik7aWYoZCYmMDxkLmxlbmd0aCl7dGhpcy5nbWxQYXJzZXJ8fHRoaXMuaW5pdEdtbFBhcnNlcigpO2Zvcih2YXIgZT0wLGY9ZC5sZW5ndGg7ZTxmO2UrKyl0aGlzLmdtbFBhcnNlci5yZWFkQ2hpbGROb2RlcyhkW2VdLFxuYyl9Yz1jLmNvbXBvbmVudHM7aWYoKGQ9dGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZU5TKGEsYixcInBvaW50XCIpKSYmMDxkLmxlbmd0aCl7ZT0wO2ZvcihmPWQubGVuZ3RoO2U8ZjtlKyspe3ZhciBnPU9wZW5MYXllcnMuU3RyaW5nLnRyaW0oZFtlXS5maXJzdENoaWxkLm5vZGVWYWx1ZSkuc3BsaXQoL1xccysvKTsyIT1nLmxlbmd0aCYmKGc9T3BlbkxheWVycy5TdHJpbmcudHJpbShkW2VdLmZpcnN0Q2hpbGQubm9kZVZhbHVlKS5zcGxpdCgvXFxzKixcXHMqLykpO2MucHVzaChuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChnWzFdLGdbMF0pKX19dmFyIGg9dGhpcy5nZXRFbGVtZW50c0J5VGFnTmFtZU5TKGEsYixcImxpbmVcIik7aWYoaCYmMDxoLmxlbmd0aClmb3IodmFyIGksZT0wLGY9aC5sZW5ndGg7ZTxmO2UrKyl7ZD1PcGVuTGF5ZXJzLlN0cmluZy50cmltKGhbZV0uZmlyc3RDaGlsZC5ub2RlVmFsdWUpLnNwbGl0KC9cXHMrLyk7aT1bXTtmb3IodmFyIGo9MCxrPWQubGVuZ3RoO2o8XG5rO2orPTIpZz1uZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChkW2orMV0sZFtqXSksaS5wdXNoKGcpO2MucHVzaChuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5MaW5lU3RyaW5nKGkpKX1pZigoYT10aGlzLmdldEVsZW1lbnRzQnlUYWdOYW1lTlMoYSxiLFwicG9seWdvblwiKSkmJjA8YS5sZW5ndGgpe2U9MDtmb3IoZj1hLmxlbmd0aDtlPGY7ZSsrKXtkPU9wZW5MYXllcnMuU3RyaW5nLnRyaW0oYVtlXS5maXJzdENoaWxkLm5vZGVWYWx1ZSkuc3BsaXQoL1xccysvKTtpPVtdO2o9MDtmb3Ioaz1kLmxlbmd0aDtqPGs7ais9MilnPW5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGRbaisxXSxkW2pdKSxpLnB1c2goZyk7Yy5wdXNoKG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvbHlnb24oW25ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVhclJpbmcoYyldKSl9fWlmKHRoaXMuaW50ZXJuYWxQcm9qZWN0aW9uJiZ0aGlzLmV4dGVybmFsUHJvamVjdGlvbil7ZT0wO2ZvcihmPWMubGVuZ3RoO2U8XG5mO2UrKyljW2VdJiZjW2VdLnRyYW5zZm9ybSh0aGlzLmV4dGVybmFsUHJvamVjdGlvbix0aGlzLmludGVybmFsUHJvamVjdGlvbil9cmV0dXJuIGN9LHBhcnNlUGVyc29uQ29uc3RydWN0czpmdW5jdGlvbihhLGIsYyl7Zm9yKHZhciBkPVtdLGU9dGhpcy5uYW1lc3BhY2VzLmF0b20sYT10aGlzLmdldEVsZW1lbnRzQnlUYWdOYW1lTlMoYSxlLGIpLGY9W1widXJpXCIsXCJlbWFpbFwiXSxnPTAsaD1hLmxlbmd0aDtnPGg7ZysrKXt2YXIgaT17fTtpLm5hbWU9dGhpcy5nZXRGaXJzdENoaWxkVmFsdWUoYVtnXSxlLFwibmFtZVwiLG51bGwpO2Zvcih2YXIgaj0wLGs9Zi5sZW5ndGg7ajxrO2orKyl7dmFyIGw9dGhpcy5nZXRGaXJzdENoaWxkVmFsdWUoYVtnXSxlLGZbal0sbnVsbCk7bCYmKGlbZltqXV09bCl9ZC5wdXNoKGkpfTA8ZC5sZW5ndGgmJihjW2IrXCJzXCJdPWQpfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Gb3JtYXQuQXRvbVwifSk7T3BlbkxheWVycy5Db250cm9sLktleWJvYXJkRGVmYXVsdHM9T3BlbkxheWVycy5DbGFzcyhPcGVuTGF5ZXJzLkNvbnRyb2wse2F1dG9BY3RpdmF0ZTohMCxzbGlkZUZhY3Rvcjo3NSxvYnNlcnZlRWxlbWVudDpudWxsLGRyYXc6ZnVuY3Rpb24oKXt0aGlzLmhhbmRsZXI9bmV3IE9wZW5MYXllcnMuSGFuZGxlci5LZXlib2FyZCh0aGlzLHtrZXlkb3duOnRoaXMuZGVmYXVsdEtleVByZXNzfSx7b2JzZXJ2ZUVsZW1lbnQ6dGhpcy5vYnNlcnZlRWxlbWVudHx8ZG9jdW1lbnR9KX0sZGVmYXVsdEtleVByZXNzOmZ1bmN0aW9uKGEpe3ZhciBiLGM9ITA7c3dpdGNoKGEua2V5Q29kZSl7Y2FzZSBPcGVuTGF5ZXJzLkV2ZW50LktFWV9MRUZUOnRoaXMubWFwLnBhbigtdGhpcy5zbGlkZUZhY3RvciwwKTticmVhaztjYXNlIE9wZW5MYXllcnMuRXZlbnQuS0VZX1JJR0hUOnRoaXMubWFwLnBhbih0aGlzLnNsaWRlRmFjdG9yLDApO2JyZWFrO2Nhc2UgT3BlbkxheWVycy5FdmVudC5LRVlfVVA6dGhpcy5tYXAucGFuKDAsXG4tdGhpcy5zbGlkZUZhY3Rvcik7YnJlYWs7Y2FzZSBPcGVuTGF5ZXJzLkV2ZW50LktFWV9ET1dOOnRoaXMubWFwLnBhbigwLHRoaXMuc2xpZGVGYWN0b3IpO2JyZWFrO2Nhc2UgMzM6Yj10aGlzLm1hcC5nZXRTaXplKCk7dGhpcy5tYXAucGFuKDAsLTAuNzUqYi5oKTticmVhaztjYXNlIDM0OmI9dGhpcy5tYXAuZ2V0U2l6ZSgpO3RoaXMubWFwLnBhbigwLDAuNzUqYi5oKTticmVhaztjYXNlIDM1OmI9dGhpcy5tYXAuZ2V0U2l6ZSgpO3RoaXMubWFwLnBhbigwLjc1KmIudywwKTticmVhaztjYXNlIDM2OmI9dGhpcy5tYXAuZ2V0U2l6ZSgpO3RoaXMubWFwLnBhbigtMC43NSpiLncsMCk7YnJlYWs7Y2FzZSA0MzpjYXNlIDYxOmNhc2UgMTg3OmNhc2UgMTA3OnRoaXMubWFwLnpvb21JbigpO2JyZWFrO2Nhc2UgNDU6Y2FzZSAxMDk6Y2FzZSAxODk6Y2FzZSA5NTp0aGlzLm1hcC56b29tT3V0KCk7YnJlYWs7ZGVmYXVsdDpjPSExfWMmJk9wZW5MYXllcnMuRXZlbnQuc3RvcChhKX0sQ0xBU1NfTkFNRTpcIk9wZW5MYXllcnMuQ29udHJvbC5LZXlib2FyZERlZmF1bHRzXCJ9KTtPcGVuTGF5ZXJzLkZvcm1hdC5XTVRTQ2FwYWJpbGl0aWVzLnYxXzBfMD1PcGVuTGF5ZXJzLkNsYXNzKE9wZW5MYXllcnMuRm9ybWF0Lk9XU0NvbW1vbi52MV8xXzAse3ZlcnNpb246XCIxLjAuMFwiLG5hbWVzcGFjZXM6e293czpcImh0dHA6Ly93d3cub3Blbmdpcy5uZXQvb3dzLzEuMVwiLHdtdHM6XCJodHRwOi8vd3d3Lm9wZW5naXMubmV0L3dtdHMvMS4wXCIseGxpbms6XCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rXCJ9LHl4Om51bGwsZGVmYXVsdFByZWZpeDpcIndtdHNcIixpbml0aWFsaXplOmZ1bmN0aW9uKGEpe09wZW5MYXllcnMuRm9ybWF0LlhNTC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLFthXSk7dGhpcy5vcHRpb25zPWE7YT1PcGVuTGF5ZXJzLlV0aWwuZXh0ZW5kKHt9LE9wZW5MYXllcnMuRm9ybWF0LldNVFNDYXBhYmlsaXRpZXMucHJvdG90eXBlLnl4KTt0aGlzLnl4PU9wZW5MYXllcnMuVXRpbC5leHRlbmQoYSx0aGlzLnl4KX0scmVhZDpmdW5jdGlvbihhKXtcInN0cmluZ1wiPT1cbnR5cGVvZiBhJiYoYT1PcGVuTGF5ZXJzLkZvcm1hdC5YTUwucHJvdG90eXBlLnJlYWQuYXBwbHkodGhpcyxbYV0pKTthJiY5PT1hLm5vZGVUeXBlJiYoYT1hLmRvY3VtZW50RWxlbWVudCk7dmFyIGI9e307dGhpcy5yZWFkTm9kZShhLGIpO2IudmVyc2lvbj10aGlzLnZlcnNpb247cmV0dXJuIGJ9LHJlYWRlcnM6e3dtdHM6e0NhcGFiaWxpdGllczpmdW5jdGlvbihhLGIpe3RoaXMucmVhZENoaWxkTm9kZXMoYSxiKX0sQ29udGVudHM6ZnVuY3Rpb24oYSxiKXtiLmNvbnRlbnRzPXt9O2IuY29udGVudHMubGF5ZXJzPVtdO2IuY29udGVudHMudGlsZU1hdHJpeFNldHM9e307dGhpcy5yZWFkQ2hpbGROb2RlcyhhLGIuY29udGVudHMpfSxMYXllcjpmdW5jdGlvbihhLGIpe3ZhciBjPXtzdHlsZXM6W10sZm9ybWF0czpbXSxkaW1lbnNpb25zOltdLHRpbGVNYXRyaXhTZXRMaW5rczpbXSxsYXllcnM6W119O3RoaXMucmVhZENoaWxkTm9kZXMoYSxjKTtiLmxheWVycy5wdXNoKGMpfSxTdHlsZTpmdW5jdGlvbihhLFxuYil7dmFyIGM9e307Yy5pc0RlZmF1bHQ9XCJ0cnVlXCI9PT1hLmdldEF0dHJpYnV0ZShcImlzRGVmYXVsdFwiKTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYyk7Yi5zdHlsZXMucHVzaChjKX0sRm9ybWF0OmZ1bmN0aW9uKGEsYil7Yi5mb3JtYXRzLnB1c2godGhpcy5nZXRDaGlsZFZhbHVlKGEpKX0sVGlsZU1hdHJpeFNldExpbms6ZnVuY3Rpb24oYSxiKXt2YXIgYz17fTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYyk7Yi50aWxlTWF0cml4U2V0TGlua3MucHVzaChjKX0sVGlsZU1hdHJpeFNldDpmdW5jdGlvbihhLGIpe2lmKGIubGF5ZXJzKXt2YXIgYz17bWF0cml4SWRzOltdfTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYyk7Yi50aWxlTWF0cml4U2V0c1tjLmlkZW50aWZpZXJdPWN9ZWxzZSBiLnRpbGVNYXRyaXhTZXQ9dGhpcy5nZXRDaGlsZFZhbHVlKGEpfSxUaWxlTWF0cml4OmZ1bmN0aW9uKGEsYil7dmFyIGM9e3N1cHBvcnRlZENSUzpiLnN1cHBvcnRlZENSU307dGhpcy5yZWFkQ2hpbGROb2RlcyhhLFxuYyk7Yi5tYXRyaXhJZHMucHVzaChjKX0sU2NhbGVEZW5vbWluYXRvcjpmdW5jdGlvbihhLGIpe2Iuc2NhbGVEZW5vbWluYXRvcj1wYXJzZUZsb2F0KHRoaXMuZ2V0Q2hpbGRWYWx1ZShhKSl9LFRvcExlZnRDb3JuZXI6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmdldENoaWxkVmFsdWUoYSkuc3BsaXQoXCIgXCIpLGQ7Yi5zdXBwb3J0ZWRDUlMmJihkPSEhdGhpcy55eFtiLnN1cHBvcnRlZENSUy5yZXBsYWNlKC91cm46b2djOmRlZjpjcnM6KFxcdyspOi4rOihcXHcrKSQvLFwidXJuOm9nYzpkZWY6Y3JzOiQxOjokMlwiKV0pO2IudG9wTGVmdENvcm5lcj1kP25ldyBPcGVuTGF5ZXJzLkxvbkxhdChjWzFdLGNbMF0pOm5ldyBPcGVuTGF5ZXJzLkxvbkxhdChjWzBdLGNbMV0pfSxUaWxlV2lkdGg6ZnVuY3Rpb24oYSxiKXtiLnRpbGVXaWR0aD1wYXJzZUludCh0aGlzLmdldENoaWxkVmFsdWUoYSkpfSxUaWxlSGVpZ2h0OmZ1bmN0aW9uKGEsYil7Yi50aWxlSGVpZ2h0PXBhcnNlSW50KHRoaXMuZ2V0Q2hpbGRWYWx1ZShhKSl9LFxuTWF0cml4V2lkdGg6ZnVuY3Rpb24oYSxiKXtiLm1hdHJpeFdpZHRoPXBhcnNlSW50KHRoaXMuZ2V0Q2hpbGRWYWx1ZShhKSl9LE1hdHJpeEhlaWdodDpmdW5jdGlvbihhLGIpe2IubWF0cml4SGVpZ2h0PXBhcnNlSW50KHRoaXMuZ2V0Q2hpbGRWYWx1ZShhKSl9LFJlc291cmNlVVJMOmZ1bmN0aW9uKGEsYil7Yi5yZXNvdXJjZVVybD1iLnJlc291cmNlVXJsfHx7fTtiLnJlc291cmNlVXJsW2EuZ2V0QXR0cmlidXRlKFwicmVzb3VyY2VUeXBlXCIpXT17Zm9ybWF0OmEuZ2V0QXR0cmlidXRlKFwiZm9ybWF0XCIpLHRlbXBsYXRlOmEuZ2V0QXR0cmlidXRlKFwidGVtcGxhdGVcIil9fSxXU0RMOmZ1bmN0aW9uKGEsYil7Yi53c2RsPXt9O2Iud3NkbC5ocmVmPWEuZ2V0QXR0cmlidXRlKFwieGxpbms6aHJlZlwiKX0sU2VydmljZU1ldGFkYXRhVVJMOmZ1bmN0aW9uKGEsYil7Yi5zZXJ2aWNlTWV0YWRhdGFVcmw9e307Yi5zZXJ2aWNlTWV0YWRhdGFVcmwuaHJlZj1hLmdldEF0dHJpYnV0ZShcInhsaW5rOmhyZWZcIil9LFxuTGVnZW5kVVJMOmZ1bmN0aW9uKGEsYil7Yi5sZWdlbmQ9e307Yi5sZWdlbmQuaHJlZj1hLmdldEF0dHJpYnV0ZShcInhsaW5rOmhyZWZcIik7Yi5sZWdlbmQuZm9ybWF0PWEuZ2V0QXR0cmlidXRlKFwiZm9ybWF0XCIpfSxEaW1lbnNpb246ZnVuY3Rpb24oYSxiKXt2YXIgYz17dmFsdWVzOltdfTt0aGlzLnJlYWRDaGlsZE5vZGVzKGEsYyk7Yi5kaW1lbnNpb25zLnB1c2goYyl9LERlZmF1bHQ6ZnVuY3Rpb24oYSxiKXtiW1wiZGVmYXVsdFwiXT10aGlzLmdldENoaWxkVmFsdWUoYSl9LFZhbHVlOmZ1bmN0aW9uKGEsYil7Yi52YWx1ZXMucHVzaCh0aGlzLmdldENoaWxkVmFsdWUoYSkpfX0sb3dzOk9wZW5MYXllcnMuRm9ybWF0Lk9XU0NvbW1vbi52MV8xXzAucHJvdG90eXBlLnJlYWRlcnMub3dzfSxDTEFTU19OQU1FOlwiT3BlbkxheWVycy5Gb3JtYXQuV01UU0NhcGFiaWxpdGllcy52MV8wXzBcIn0pO1xubW9kdWxlLmV4cG9ydHM9T3BlbkxheWVyczt9KCkpOyIsIi8qXHJcbiAqIENvcHlyaWdodCAoYykgMjAxNCBPY3VsdXMgSW5mbyBJbmMuXHJcbiAqIGh0dHA6Ly93d3cub2N1bHVzaW5mby5jb20vXHJcbiAqXHJcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuICpcclxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weSBvZlxyXG4gKiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluXHJcbiAqIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG9cclxuICogdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXNcclxuICogb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvXHJcbiAqIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcclxuXHJcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbFxyXG4gKiBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxyXG5cclxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxyXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXHJcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcclxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEVcclxuICogU09GVFdBUkUuXHJcbiAqL1xyXG5cclxuKCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICB2YXIgJCA9IHJlcXVpcmUoJ2pxdWVyeScpLFxyXG4gICAgICAgIF8gPSByZXF1aXJlKCdsb2Rhc2gnKTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFByaXZhdGU6IGVuY29kZXMgcGFyYW1ldGVyIG9iamVjdCBpbnRvIGEgZG90IG5vdGF0aW9uIHF1ZXJ5XHJcbiAgICAgKiBwYXJhbWV0ZXIgc3RyaW5nLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBwYXJhbXMge09iamVjdH0gcGFyYW1ldGVyIG9iamVjdFxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBlbmNvZGVRdWVyeVBhcmFtcyggcGFyYW1zICkge1xyXG4gICAgICAgIHZhciBxdWVyeTtcclxuICAgICAgICBmdW5jdGlvbiB0cmF2ZXJzZVBhcmFtcyggcGFyYW1zLCBxdWVyeSApIHtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IFwiXCI7XHJcbiAgICAgICAgICAgIF8uZm9ySW4oIHBhcmFtcywgZnVuY3Rpb24oIHZhbHVlLCBrZXkgKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIHZhbHVlIGluc3RhbmNlb2YgQXJyYXkgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IHF1ZXJ5ICsga2V5ICsgJz0nICsgdmFsdWUuam9pbignLCcpICsgXCImXCI7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCB0eXBlb2YgdmFsdWUgIT09IFwib2JqZWN0XCIgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IHF1ZXJ5ICsga2V5ICsgJz0nICsgdmFsdWUgKyBcIiZcIjtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IHRyYXZlcnNlUGFyYW1zKCBwYXJhbXNbIGtleSBdLCBxdWVyeSArIGtleSArIFwiLlwiICk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBxdWVyeSA9IFwiP1wiICsgdHJhdmVyc2VQYXJhbXMoIHBhcmFtcywgJycgKTtcclxuICAgICAgICByZXR1cm4gcXVlcnkuc2xpY2UoIDAsIHF1ZXJ5Lmxlbmd0aCAtIDEgKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFByaXZhdGU6IGVuY29kZXMgcGFyYW1ldGVyIG9iamVjdCBpbnRvIHF1ZXJ5IHBhcmFtZXRlciBzdHJpbmcuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHhociB7WG1sSHR0cFJlcXVlc3R9IFhtbEh0dHBSZXF1ZXN0IG9iamVjdFxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBoYW5kbGVFcnJvciggeGhyICkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoIHhoci5yZXNwb25zZVRleHQgKTtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCB4aHIgKTtcclxuICAgIH1cclxuXHJcbiAgICBtb2R1bGUuZXhwb3J0cyA9IHtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogR2V0IGEgdGlsZXMgd29ydGggb2YgYW5ub3RhdGlvbnMgZnJvbSB0aGUgc2VydmVyLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIGxheWVySWQgICB7U3RyaW5nfSAgIGFubm90YXRpb24gbGF5ZXIgaWRcclxuICAgICAgICAgKiBAcGFyYW0gbGV2ZWwgICAgIHtpbnR9ICAgICAgdGlsZSBsZXZlbFxyXG4gICAgICAgICAqIEBwYXJhbSB4ICAgICAgICAge2ludH0gICAgICB0aWxlIHggaW5kZXhcclxuICAgICAgICAgKiBAcGFyYW0geSAgICAgICAgIHtpbnR9ICAgICAgdGlsZSB5IGluZGV4XHJcbiAgICAgICAgICogQHBhcmFtIFtwYXJhbXNdICB7T2JqZWN0fSAgIHF1ZXJ5IHBhcmFtZXRlciBjb25maWd1cmF0aW9uIG92ZXJyaWRlcyAob3B0aW9uYWwpXHJcbiAgICAgICAgICogQHBhcmFtIFtzdWNjZXNzXSB7RnVuY3Rpb259IGZ1bmN0aW9uIGNhbGxlZCBhZnRlciBzdWNjZXNzIHJlY2VpdmVkIChvcHRpb25hbClcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRUaWxlSlNPTjogZnVuY3Rpb24oIGxheWVySWQsIGxldmVsLCB4LCB5LCBwYXJhbXMsIHN1Y2Nlc3MgKSB7XHJcbiAgICAgICAgICAgIHZhciBfcGFyYW1zID0gKCB0eXBlb2YgcGFyYW1zID09PSBcIm9iamVjdFwiICkgPyBwYXJhbXMgOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgX3N1Y2Nlc3MgPSAoIHR5cGVvZiBzdWNjZXNzID09PSBcImZ1bmN0aW9uXCIgKSA/IHN1Y2Nlc3MgOiBudWxsO1xyXG4gICAgICAgICAgICAkLmdldChcclxuICAgICAgICAgICAgICAgICdyZXN0L3YxLjAvYW5ub3RhdGlvbi8nXHJcbiAgICAgICAgICAgICAgICArIGxheWVySWQgKyBcIi9cIlxyXG4gICAgICAgICAgICAgICAgKyBsZXZlbCArIFwiL1wiXHJcbiAgICAgICAgICAgICAgICArIHggKyBcIi9cIlxyXG4gICAgICAgICAgICAgICAgKyB5ICsgXCIuanNvblwiICsgZW5jb2RlUXVlcnlQYXJhbXMoIF9wYXJhbXMgKVxyXG4gICAgICAgICAgICApLnRoZW4oXHJcbiAgICAgICAgICAgICAgICBfc3VjY2VzcyxcclxuICAgICAgICAgICAgICAgIGhhbmRsZUVycm9yXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogV3JpdGUgdGhlIGFubm90YXRpb24gdG8gdGhlIHNlcnZlci5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSBsYXllcklkICAgIHtTdHJpbmd9ICAgYW5ub3RhdGlvbiBsYXllciBpZFxyXG4gICAgICAgICAqIEBwYXJhbSBhbm5vdGF0aW9uIHtPYmplY3R9ICAgYW5ub3RhdGlvbiB0byBiZSB3cml0dGVuXHJcbiAgICAgICAgICogQHBhcmFtIFtzdWNjZXNzXSAge0Z1bmN0aW9ufSBmdW5jdGlvbiBjYWxsZWQgYWZ0ZXIgc3VjY2VzcyByZWNlaXZlZCAob3B0aW9uYWwpXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgd3JpdGVBbm5vdGF0aW9uOiBmdW5jdGlvbiggbGF5ZXJJZCwgYW5ub3RhdGlvbiwgc3VjY2VzcyApIHtcclxuICAgICAgICAgICAgdmFyIF9zdWNjZXNzID0gKCB0eXBlb2Ygc3VjY2VzcyA9PT0gXCJmdW5jdGlvblwiICkgPyBzdWNjZXNzIDogbnVsbDtcclxuICAgICAgICAgICAgJC5wb3N0KFxyXG4gICAgICAgICAgICAgICAgJ3Jlc3QvdjEuMC9hbm5vdGF0aW9uLycsXHJcbiAgICAgICAgICAgICAgICBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJ3cml0ZVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGFubm90YXRpb246IGFubm90YXRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgbGF5ZXI6IGxheWVySWRcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICkudGhlbihcclxuICAgICAgICAgICAgICAgIF9zdWNjZXNzLFxyXG4gICAgICAgICAgICAgICAgaGFuZGxlRXJyb3JcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBNb2RpZnkgYW4gdGhlIGFubm90YXRpb24gb24gdGhlIHNlcnZlci5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSBsYXllcklkICAgIHtTdHJpbmd9ICAgYW5ub3RhdGlvbiBsYXllciBpZFxyXG4gICAgICAgICAqIEBwYXJhbSBhbm5vdGF0aW9uIHtPYmplY3R9ICAgYW5ub3RhdGlvbiB0byBiZSBtb2RpZmllZFxyXG4gICAgICAgICAqIEBwYXJhbSBbc3VjY2Vzc10gIHtGdW5jdGlvbn0gZnVuY3Rpb24gY2FsbGVkIGFmdGVyIHN1Y2Nlc3MgcmVjZWl2ZWQgKG9wdGlvbmFsKVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIG1vZGlmeUFubm90YXRpb246IGZ1bmN0aW9uKCBsYXllcklkLCBhbm5vdGF0aW9uLCBzdWNjZXNzICkge1xyXG4gICAgICAgICAgICB2YXIgX3N1Y2Nlc3MgPSAoIHR5cGVvZiBzdWNjZXNzID09PSBcImZ1bmN0aW9uXCIgKSA/IHN1Y2Nlc3MgOiBudWxsO1xyXG4gICAgICAgICAgICAkLnBvc3QoXHJcbiAgICAgICAgICAgICAgICAncmVzdC92MS4wL2Fubm90YXRpb24vJyxcclxuICAgICAgICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm1vZGlmeVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGFubm90YXRpb246IGFubm90YXRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgbGF5ZXI6IGxheWVySWRcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICkudGhlbihcclxuICAgICAgICAgICAgICAgIF9zdWNjZXNzLFxyXG4gICAgICAgICAgICAgICAgaGFuZGxlRXJyb3JcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBSZW1vdmUgdGhlIGFubm90YXRpb24gZnJvbSB0aGUgc2VydmVyLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIGxheWVySWQgICAgIHtTdHJpbmd9ICAgYW5ub3RhdGlvbiBsYXllciBpZFxyXG4gICAgICAgICAqIEBwYXJhbSBjZXJ0aWZpY2F0ZSB7T2JqZWN0fSAgIGNlcnRpZmljYXRlIG9mIGFubm90YXRpb24gdG8gYmUgcmVtb3ZlZFxyXG4gICAgICAgICAqIEBwYXJhbSBbc3VjY2Vzc10gICB7RnVuY3Rpb259IGZ1bmN0aW9uIGNhbGxlZCBhZnRlciBzdWNjZXNzIHJlY2VpdmVkIChvcHRpb25hbClcclxuICAgICAgICAgKi9cclxuICAgICAgICByZW1vdmVBbm5vdGF0aW9uOiBmdW5jdGlvbiggbGF5ZXJJZCwgY2VydGlmaWNhdGUsIHN1Y2Nlc3MgKSB7XHJcbiAgICAgICAgICAgIHZhciBfc3VjY2VzcyA9ICggdHlwZW9mIHN1Y2Nlc3MgPT09IFwiZnVuY3Rpb25cIiApID8gc3VjY2VzcyA6IG51bGw7XHJcbiAgICAgICAgICAgICQucG9zdChcclxuICAgICAgICAgICAgICAgICdyZXN0L3YxLjAvYW5ub3RhdGlvbi8nLFxyXG4gICAgICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwicmVtb3ZlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgY2VydGlmaWNhdGU6IGNlcnRpZmljYXRlLFxyXG4gICAgICAgICAgICAgICAgICAgIGxheWVyOiBsYXllcklkXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApLnRoZW4oXHJcbiAgICAgICAgICAgICAgICBfc3VjY2VzcyxcclxuICAgICAgICAgICAgICAgIGhhbmRsZUVycm9yXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH07XHJcbn0oKSk7XHJcbiIsIi8qXHJcbiAqIENvcHlyaWdodCAoYykgMjAxNCBPY3VsdXMgSW5mbyBJbmMuXHJcbiAqIGh0dHA6Ly93d3cub2N1bHVzaW5mby5jb20vXHJcbiAqXHJcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuICpcclxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weSBvZlxyXG4gKiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluXHJcbiAqIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG9cclxuICogdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXNcclxuICogb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvXHJcbiAqIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcclxuXHJcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbFxyXG4gKiBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxyXG5cclxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxyXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXHJcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcclxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEVcclxuICogU09GVFdBUkUuXHJcbiAqL1xyXG5cclxuKCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICB2YXIgJCA9IHJlcXVpcmUoJ2pxdWVyeScpO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUHJpdmF0ZTogZW5jb2RlcyBwYXJhbWV0ZXIgb2JqZWN0IGludG8gcXVlcnkgcGFyYW1ldGVyIHN0cmluZy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0geGhyIHtYbWxIdHRwUmVxdWVzdH0gWG1sSHR0cFJlcXVlc3Qgb2JqZWN0XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGhhbmRsZUVycm9yKCB4aHIgKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvciggeGhyLnJlc3BvbnNlVGV4dCApO1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoIHhociApO1xyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5leHBvcnRzID0ge1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBSZXF1ZXN0IGFsbCBsYXllcnMgZnJvbSB0aGUgc2VydmVyLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIFtzdWNjZXNzXSB7RnVuY3Rpb259IGZ1bmN0aW9uIGNhbGxlZCBhZnRlciBzdWNjZXNzIHJlY2VpdmVkIChvcHRpb25hbClcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRMYXllcnM6IGZ1bmN0aW9uKCBzdWNjZXNzICkge1xyXG4gICAgICAgICAgICB2YXIgX3N1Y2Nlc3MgPSAoIHR5cGVvZiBzdWNjZXNzID09PSBcImZ1bmN0aW9uXCIgKSA/IHN1Y2Nlc3MgOiBudWxsO1xyXG4gICAgICAgICAgICAkLmdldChcclxuICAgICAgICAgICAgICAgICdyZXN0L3YxLjAvbGF5ZXJzJ1xyXG4gICAgICAgICAgICApLnRoZW4oXHJcbiAgICAgICAgICAgICAgICBfc3VjY2VzcyxcclxuICAgICAgICAgICAgICAgIGhhbmRsZUVycm9yXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogUmVxdWVzdCBhIHNwZWNpZmljIGxheWVyIGZyb20gdGhlIHNlcnZlciwgc2VuZGluZyBpdCB0byB0aGUgbGlzdGVkIGNhbGxiYWNrXHJcbiAgICAgICAgICogZnVuY3Rpb24gd2hlbiBpdCBpcyByZWNlaXZlZC5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSBsYXllcklkICAge1N0cmluZ30gICBsYXllciBpZFxyXG4gICAgICAgICAqIEBwYXJhbSBbc3VjY2Vzc10ge0Z1bmN0aW9ufSBmdW5jdGlvbiBjYWxsZWQgYWZ0ZXIgc3VjY2VzcyByZWNlaXZlZCAob3B0aW9uYWwpXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0TGF5ZXI6IGZ1bmN0aW9uKCBsYXllcklkLCBzdWNjZXNzICkge1xyXG4gICAgICAgICAgICB2YXIgX3N1Y2Nlc3MgPSAoIHR5cGVvZiBzdWNjZXNzID09PSBcImZ1bmN0aW9uXCIgKSA/IHN1Y2Nlc3MgOiBudWxsO1xyXG4gICAgICAgICAgICAkLmdldChcclxuICAgICAgICAgICAgICAgICdyZXN0L3YxLjAvbGF5ZXJzLycgKyBsYXllcklkXHJcbiAgICAgICAgICAgICkudGhlbihcclxuICAgICAgICAgICAgICAgIF9zdWNjZXNzLFxyXG4gICAgICAgICAgICAgICAgaGFuZGxlRXJyb3JcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBTdG9yZSBhIGNvbmZpZ3VyYXRpb24gc3RhdGUgb24gdGhlIHNlcnZlci5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSBsYXllcklkICAge1N0cmluZ30gICBsYXllciBpZFxyXG4gICAgICAgICAqIEBwYXJhbSBwYXJhbXMgICAge09iamVjdH0gICBsYXllciBjb25maWd1cmF0aW9uIHBhcmFtZXRlcnNcclxuICAgICAgICAgKiBAcGFyYW0gW3N1Y2Nlc3NdIHtGdW5jdGlvbn0gZnVuY3Rpb24gY2FsbGVkIGFmdGVyIHN1Y2Nlc3MgcmVjZWl2ZWQgKG9wdGlvbmFsKVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNhdmVMYXllclN0YXRlOiBmdW5jdGlvbiggbGF5ZXJJZCwgcGFyYW1zLCBzdWNjZXNzICkge1xyXG4gICAgICAgICAgICB2YXIgX3N1Y2Nlc3MgPSAoIHR5cGVvZiBzdWNjZXNzID09PSBcImZ1bmN0aW9uXCIgKSA/IHN1Y2Nlc3MgOiBudWxsO1xyXG4gICAgICAgICAgICAkLnBvc3QoXHJcbiAgICAgICAgICAgICAgICAncmVzdC92MS4wL2xheWVycy8nICsgbGF5ZXJJZCArICcvc3RhdGVzJyxcclxuICAgICAgICAgICAgICAgIEpTT04uc3RyaW5naWZ5KCBwYXJhbXMgKVxyXG4gICAgICAgICAgICApLnRoZW4oXHJcbiAgICAgICAgICAgICAgICBfc3VjY2VzcyxcclxuICAgICAgICAgICAgICAgIGhhbmRsZUVycm9yXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogR2V0IGFsbCBjb25maWd1cmF0aW9uIHN0YXRlcyBmb3IgYSBsYXllciBvbiB0aGUgc2VydmVyLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIGxheWVySWQgICB7U3RyaW5nfSAgIGxheWVyIGlkXHJcbiAgICAgICAgICogQHBhcmFtIFtzdWNjZXNzXSB7RnVuY3Rpb259IGZ1bmN0aW9uIGNhbGxlZCBhZnRlciBzdWNjZXNzIHJlY2VpdmVkIChvcHRpb25hbClcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRMYXllclN0YXRlczogZnVuY3Rpb24oIGxheWVySWQsIHN1Y2Nlc3MgKSB7XHJcbiAgICAgICAgICAgIHZhciBfc3VjY2VzcyA9ICggdHlwZW9mIHN1Y2Nlc3MgPT09IFwiZnVuY3Rpb25cIiApID8gc3VjY2VzcyA6IG51bGw7XHJcbiAgICAgICAgICAgICQuZ2V0KFxyXG4gICAgICAgICAgICAgICAgJ3Jlc3QvdjEuMC9sYXllcnMvJyArIGxheWVySWQgKyAnL3N0YXRlcydcclxuICAgICAgICAgICAgKS50aGVuKFxyXG4gICAgICAgICAgICAgICAgX3N1Y2Nlc3MsXHJcbiAgICAgICAgICAgICAgICBoYW5kbGVFcnJvclxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn0oKSk7XHJcbiIsIi8qXHJcbiAqIENvcHlyaWdodCAoYykgMjAxNCBPY3VsdXMgSW5mbyBJbmMuXHJcbiAqIGh0dHA6Ly93d3cub2N1bHVzaW5mby5jb20vXHJcbiAqXHJcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuICpcclxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weSBvZlxyXG4gKiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluXHJcbiAqIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG9cclxuICogdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXNcclxuICogb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvXHJcbiAqIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcclxuXHJcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbFxyXG4gKiBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxyXG5cclxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxyXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXHJcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcclxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEVcclxuICogU09GVFdBUkUuXHJcbiAqL1xyXG5cclxuKCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICB2YXIgJCA9IHJlcXVpcmUoJ2pxdWVyeScpLFxyXG4gICAgICAgIF8gPSByZXF1aXJlKCdsb2Rhc2gnKTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFByaXZhdGU6IGVuY29kZXMgcGFyYW1ldGVyIG9iamVjdCBpbnRvIGEgZG90IG5vdGF0aW9uIHF1ZXJ5XHJcbiAgICAgKiBwYXJhbWV0ZXIgc3RyaW5nLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBwYXJhbXMge09iamVjdH0gcGFyYW1ldGVyIG9iamVjdFxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBlbmNvZGVRdWVyeVBhcmFtcyggcGFyYW1zICkge1xyXG4gICAgICAgIHZhciBxdWVyeTtcclxuICAgICAgICBmdW5jdGlvbiB0cmF2ZXJzZVBhcmFtcyggcGFyYW1zLCBxdWVyeSApIHtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IFwiXCI7XHJcbiAgICAgICAgICAgIF8uZm9ySW4oIHBhcmFtcywgZnVuY3Rpb24oIHZhbHVlLCBrZXkgKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIHZhbHVlIGluc3RhbmNlb2YgQXJyYXkgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IHF1ZXJ5ICsga2V5ICsgJz0nICsgdmFsdWUuam9pbignLCcpICsgXCImXCI7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCB0eXBlb2YgdmFsdWUgIT09IFwib2JqZWN0XCIgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IHF1ZXJ5ICsga2V5ICsgJz0nICsgdmFsdWUgKyBcIiZcIjtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IHRyYXZlcnNlUGFyYW1zKCBwYXJhbXNbIGtleSBdLCBxdWVyeSArIGtleSArIFwiLlwiICk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBxdWVyeSA9IFwiP1wiICsgdHJhdmVyc2VQYXJhbXMoIHBhcmFtcywgJycgKTtcclxuICAgICAgICByZXR1cm4gcXVlcnkuc2xpY2UoIDAsIHF1ZXJ5Lmxlbmd0aCAtIDEgKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFByaXZhdGU6IGVuY29kZXMgcGFyYW1ldGVyIG9iamVjdCBpbnRvIHF1ZXJ5IHBhcmFtZXRlciBzdHJpbmcuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHhociB7WG1sSHR0cFJlcXVlc3R9IFhtbEh0dHBSZXF1ZXN0IG9iamVjdFxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBoYW5kbGVFcnJvciggeGhyICkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoIHhoci5yZXNwb25zZVRleHQgKTtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCB4aHIgKTtcclxuICAgIH1cclxuXHJcbiAgICBtb2R1bGUuZXhwb3J0cyA9IHtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogR2V0IGFuIGVuY29kZWQgaW1hZ2Ugc3RyaW5nIHJlcHJlc2VudGluZyB0aGUgcmVuZGVyaW5nIGxlZ2VuZC5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSBsYXllcklkICAge1N0cmluZ30gICBsYXllciBpZFxyXG4gICAgICAgICAqIEBwYXJhbSBbcGFyYW1zXSAge09iamVjdH0gICBxdWVyeSBwYXJhbWV0ZXIgY29uZmlndXJhdGlvbiBvdmVycmlkZXMgKG9wdGlvbmFsKVxyXG4gICAgICAgICAqIEBwYXJhbSBbc3VjY2Vzc10ge0Z1bmN0aW9ufSBmdW5jdGlvbiBjYWxsZWQgYWZ0ZXIgc3VjY2VzcyByZWNlaXZlZCAob3B0aW9uYWwpXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0RW5jb2RlZEltYWdlOiBmdW5jdGlvbiggbGF5ZXJJZCwgcGFyYW1zLCBzdWNjZXNzICkge1xyXG4gICAgICAgICAgICB2YXIgX3BhcmFtcyA9ICggdHlwZW9mIHBhcmFtcyA9PT0gXCJvYmplY3RcIiApID8gcGFyYW1zIDogbnVsbCxcclxuICAgICAgICAgICAgICAgIF9zdWNjZXNzID0gKCB0eXBlb2Ygc3VjY2VzcyA9PT0gXCJmdW5jdGlvblwiICkgPyBzdWNjZXNzIDogbnVsbDtcclxuICAgICAgICAgICAgJC5nZXQoXHJcbiAgICAgICAgICAgICAgICAncmVzdC92MS4wL2xlZ2VuZC8nICsgbGF5ZXJJZCArIGVuY29kZVF1ZXJ5UGFyYW1zKCBfcGFyYW1zIClcclxuICAgICAgICAgICAgKS50aGVuKFxyXG4gICAgICAgICAgICAgICAgX3N1Y2Nlc3MsXHJcbiAgICAgICAgICAgICAgICBoYW5kbGVFcnJvclxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEdldCBhIHBuZyBpbWFnZSByZXByZXNlbnRpbmcgdGhlIHJlbmRlcmluZyBsZWdlbmQuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gbGF5ZXJJZCAgIHtTdHJpbmd9ICAgbGF5ZXIgaWRcclxuICAgICAgICAgKiBAcGFyYW0gW3BhcmFtc10gIHtPYmplY3R9ICAgcXVlcnkgcGFyYW1ldGVyIGNvbmZpZ3VyYXRpb24gb3ZlcnJpZGVzIChvcHRpb25hbClcclxuICAgICAgICAgKiBAcGFyYW0gW3N1Y2Nlc3NdIHtGdW5jdGlvbn0gZnVuY3Rpb24gY2FsbGVkIGFmdGVyIHN1Y2Nlc3MgcmVjZWl2ZWQgKG9wdGlvbmFsKVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldEltYWdlOiBmdW5jdGlvbiggbGF5ZXJJZCwgcGFyYW1zLCBzdWNjZXNzICkge1xyXG4gICAgICAgICAgICB2YXIgX3BhcmFtcyA9ICggdHlwZW9mIHBhcmFtcyA9PT0gXCJvYmplY3RcIiApID8gcGFyYW1zIDogbnVsbCxcclxuICAgICAgICAgICAgICAgIF9zdWNjZXNzID0gKCB0eXBlb2Ygc3VjY2VzcyA9PT0gXCJmdW5jdGlvblwiICkgPyBzdWNjZXNzIDogbnVsbDtcclxuICAgICAgICAgICAgLy8gZXhwbGljaXRseSBzZXQgb3V0cHV0IHR5cGUgdG8gcG5nIGltYWdlXHJcbiAgICAgICAgICAgIF9wYXJhbXMub3V0cHV0ID0gJ3BuZyc7XHJcbiAgICAgICAgICAgICQuZ2V0KFxyXG4gICAgICAgICAgICAgICAgJ3Jlc3QvdjEuMC9sZWdlbmQvJyArIGxheWVySWQgKyBlbmNvZGVRdWVyeVBhcmFtcyggX3BhcmFtcyApXHJcbiAgICAgICAgICAgICkudGhlbihcclxuICAgICAgICAgICAgICAgIF9zdWNjZXNzLFxyXG4gICAgICAgICAgICAgICAgaGFuZGxlRXJyb3JcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59KCkpO1xyXG4iLCIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgT2N1bHVzIEluZm8gSW5jLlxyXG4gKiBodHRwOi8vd3d3Lm9jdWx1c2luZm8uY29tL1xyXG4gKlxyXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXHJcbiAqXHJcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkgb2ZcclxuICogdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpblxyXG4gKiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvXHJcbiAqIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzXHJcbiAqIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkb1xyXG4gKiBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XHJcblxyXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbiBhbGxcclxuICogY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cclxuXHJcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcclxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXHJcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxyXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXHJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXHJcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFXHJcbiAqIFNPRlRXQVJFLlxyXG4gKi9cclxuXHJcbiggZnVuY3Rpb24oKSB7XHJcbiAgICBcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIHZhciAkID0gcmVxdWlyZSgnanF1ZXJ5JyksXHJcbiAgICAgICAgXyA9IHJlcXVpcmUoJ2xvZGFzaCcpO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUHJpdmF0ZTogZW5jb2RlcyBwYXJhbWV0ZXIgb2JqZWN0IGludG8gYSBkb3Qgbm90YXRpb24gcXVlcnlcclxuICAgICAqIHBhcmFtZXRlciBzdHJpbmcuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHBhcmFtcyB7T2JqZWN0fSBwYXJhbWV0ZXIgb2JqZWN0XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGVuY29kZVF1ZXJ5UGFyYW1zKCBwYXJhbXMgKSB7XHJcbiAgICAgICAgdmFyIHF1ZXJ5O1xyXG4gICAgICAgIGZ1bmN0aW9uIHRyYXZlcnNlUGFyYW1zKCBwYXJhbXMsIHF1ZXJ5ICkge1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gXCJcIjtcclxuICAgICAgICAgICAgXy5mb3JJbiggcGFyYW1zLCBmdW5jdGlvbiggdmFsdWUsIGtleSApIHtcclxuICAgICAgICAgICAgICAgIGlmICggdmFsdWUgaW5zdGFuY2VvZiBBcnJheSApIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gcXVlcnkgKyBrZXkgKyAnPScgKyB2YWx1ZS5qb2luKCcsJykgKyBcIiZcIjtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIHR5cGVvZiB2YWx1ZSAhPT0gXCJvYmplY3RcIiApIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gcXVlcnkgKyBrZXkgKyAnPScgKyB2YWx1ZSArIFwiJlwiO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gdHJhdmVyc2VQYXJhbXMoIHBhcmFtc1sga2V5IF0sIHF1ZXJ5ICsga2V5ICsgXCIuXCIgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHF1ZXJ5ID0gXCI/XCIgKyB0cmF2ZXJzZVBhcmFtcyggcGFyYW1zLCAnJyApO1xyXG4gICAgICAgIHJldHVybiBxdWVyeS5zbGljZSggMCwgcXVlcnkubGVuZ3RoIC0gMSApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUHJpdmF0ZTogZW5jb2RlcyBwYXJhbWV0ZXIgb2JqZWN0IGludG8gcXVlcnkgcGFyYW1ldGVyIHN0cmluZy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0geGhyIHtYbWxIdHRwUmVxdWVzdH0gWG1sSHR0cFJlcXVlc3Qgb2JqZWN0XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGhhbmRsZUVycm9yKCB4aHIgKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvciggeGhyLnJlc3BvbnNlVGV4dCApO1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoIHhociApO1xyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5leHBvcnRzID0ge1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBHZXQgYSB0aWxlcyBkYXRhIGluIEpTT04gZm9ybWF0LlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIGxheWVySWQgICB7U3RyaW5nfSAgIGxheWVyIGlkXHJcbiAgICAgICAgICogQHBhcmFtIGxldmVsICAgICB7aW50fSAgICAgIHRpbGUgbGV2ZWxcclxuICAgICAgICAgKiBAcGFyYW0geCAgICAgICAgIHtpbnR9ICAgICAgdGlsZSB4IGluZGV4XHJcbiAgICAgICAgICogQHBhcmFtIHkgICAgICAgICB7aW50fSAgICAgIHRpbGUgeSBpbmRleFxyXG4gICAgICAgICAqIEBwYXJhbSBbcGFyYW1zXSAge09iamVjdH0gICBxdWVyeSBwYXJhbWV0ZXIgY29uZmlndXJhdGlvbiBvdmVycmlkZXMgKG9wdGlvbmFsKVxyXG4gICAgICAgICAqIEBwYXJhbSBbc3VjY2Vzc10ge0Z1bmN0aW9ufSBmdW5jdGlvbiBjYWxsZWQgYWZ0ZXIgc3VjY2VzcyByZWNlaXZlZCAob3B0aW9uYWwpXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0VGlsZUpTT046IGZ1bmN0aW9uKCBsYXllcklkLCBsZXZlbCwgeCwgeSwgcGFyYW1zLCBzdWNjZXNzICkge1xyXG4gICAgICAgICAgICB2YXIgX3BhcmFtcyA9ICggdHlwZW9mIHBhcmFtcyA9PT0gXCJvYmplY3RcIiApID8gcGFyYW1zIDogbnVsbCxcclxuICAgICAgICAgICAgICAgIF9zdWNjZXNzID0gKCB0eXBlb2Ygc3VjY2VzcyA9PT0gXCJmdW5jdGlvblwiICkgPyBzdWNjZXNzIDogbnVsbDtcclxuICAgICAgICAgICAgJC5nZXQoXHJcbiAgICAgICAgICAgICAgICAncmVzdC92MS4wL3RpbGUvJ1xyXG4gICAgICAgICAgICAgICAgKyBsYXllcklkICsgXCIvXCJcclxuICAgICAgICAgICAgICAgICsgbGV2ZWwgKyBcIi9cIlxyXG4gICAgICAgICAgICAgICAgKyB4ICsgXCIvXCJcclxuICAgICAgICAgICAgICAgICsgeSArIFwiLmpzb25cIiArIGVuY29kZVF1ZXJ5UGFyYW1zKCBfcGFyYW1zIClcclxuICAgICAgICAgICAgKS50aGVuKFxyXG4gICAgICAgICAgICAgICAgX3N1Y2Nlc3MsXHJcbiAgICAgICAgICAgICAgICBoYW5kbGVFcnJvclxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEdldCBhIHRpbGUgcmVuZGVyZWQgYXMgYW4gaW1hZ2UuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gbGF5ZXJJZCAgIHtTdHJpbmd9ICAgbGF5ZXIgaWRcclxuICAgICAgICAgKiBAcGFyYW0gbGV2ZWwgICAgIHtpbnR9ICAgICAgdGlsZSBsZXZlbFxyXG4gICAgICAgICAqIEBwYXJhbSB4ICAgICAgICAge2ludH0gICAgICB0aWxlIHggaW5kZXhcclxuICAgICAgICAgKiBAcGFyYW0geSAgICAgICAgIHtpbnR9ICAgICAgdGlsZSB5IGluZGV4XHJcbiAgICAgICAgICogQHBhcmFtIFtwYXJhbXMgXSB7T2JqZWN0fSAgIHF1ZXJ5IHBhcmFtZXRlciBjb25maWd1cmF0aW9uIG92ZXJyaWRlcyAob3B0aW9uYWwpXHJcbiAgICAgICAgICogQHBhcmFtIFtzdWNjZXNzXSB7RnVuY3Rpb259IGZ1bmN0aW9uIGNhbGxlZCBhZnRlciBzdWNjZXNzIHJlY2VpdmVkIChvcHRpb25hbClcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXRUaWxlSW1hZ2U6IGZ1bmN0aW9uKCBsYXllcklkLCBsZXZlbCwgeCwgeSwgcGFyYW1zLCBzdWNjZXNzICkge1xyXG4gICAgICAgICAgICB2YXIgX3BhcmFtcyA9ICggdHlwZW9mIHBhcmFtcyA9PT0gXCJvYmplY3RcIiApID8gcGFyYW1zIDogbnVsbCxcclxuICAgICAgICAgICAgICAgIF9zdWNjZXNzID0gKCB0eXBlb2Ygc3VjY2VzcyA9PT0gXCJmdW5jdGlvblwiICkgPyBzdWNjZXNzIDogbnVsbDtcclxuICAgICAgICAgICAgJC5nZXQoXHJcbiAgICAgICAgICAgICAgICAncmVzdC92MS4wL3RpbGUvJ1xyXG4gICAgICAgICAgICAgICAgKyBsYXllcklkICsgXCIvXCJcclxuICAgICAgICAgICAgICAgICsgbGV2ZWwgKyBcIi9cIlxyXG4gICAgICAgICAgICAgICAgKyB4ICsgXCIvXCJcclxuICAgICAgICAgICAgICAgICsgeSArIFwiLnBuZ1wiICsgZW5jb2RlUXVlcnlQYXJhbXMoIF9wYXJhbXMgKVxyXG4gICAgICAgICAgICApLnRoZW4oXHJcbiAgICAgICAgICAgICAgICBfc3VjY2VzcyxcclxuICAgICAgICAgICAgICAgIGhhbmRsZUVycm9yXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufSgpKTtcclxuIiwiLypcclxuICogQ29weXJpZ2h0IChjKSAyMDE0IE9jdWx1cyBJbmZvIEluYy5cclxuICogaHR0cDovL3d3dy5vY3VsdXNpbmZvLmNvbS9cclxuICpcclxuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKlxyXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5IG9mXHJcbiAqIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW5cclxuICogdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0b1xyXG4gKiB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllc1xyXG4gKiBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG9cclxuICogc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxyXG5cclxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsXHJcbiAqIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXHJcblxyXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXHJcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxyXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcclxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxyXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxyXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRVxyXG4gKiBTT0ZUV0FSRS5cclxuICovXHJcblxyXG4oIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIHZhciAkID0gcmVxdWlyZSgnanF1ZXJ5JyksXHJcbiAgICAgICAgRFVSQVRJT04gPSAzMDAsXHJcbiAgICAgICAgZ2V0TWF4Q29udGVudEhlaWdodDtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFByaXZhdGU6IEZ1bmN0aW9uIGNvbnN0YW50IHRoYXQgY2FwcyB0aGUgbWF4aW11bSBoZWlnaHQgb2YgdGhlIG92ZXJsYXkgZWxlbWVudC5cclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJucyB7aW50fSBUaGUgbWF4aW11bSBoZWlnaHQuXHJcbiAgICAgKi9cclxuICAgIGdldE1heENvbnRlbnRIZWlnaHQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gIE1hdGguZmxvb3IoICQod2luZG93KS5oZWlnaHQoKSAvIDIgKTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDb25zdHJ1Y3QgYW4gb3ZlcmxheSBidXR0b24uXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHNwZWMge09iamVjdH0gdGhlIHNwZWNpZmljYXRpb24gb2JqZWN0LlxyXG4gICAgICogICAgIGlkIDogdGhlIGVsZW1lbnQgaWQsXHJcbiAgICAgKiAgICAgaGVhZGVyOiB0aGUgaGVhZGVyIGh0bWwsXHJcbiAgICAgKiAgICAgY29udGVudDogdGhlIGNvbnRlbnQgaHRtbCxcclxuICAgICAqICAgICB2ZXJ0aWNhbFBvc2l0aW9uOiB0aGUgdmVydGljYWwgcG9zaXRpb24sIFwiYm90dG9tXCIgb3IgXCJ0b3BcIlxyXG4gICAgICogICAgIGhvcml6b250YWxQb3NpdGlvbjogdGhlIGhvcml6b250YWwgcG9zaXRpb24sIFwibGVmdFwiIG9yIFwicmlnaHRcIlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBPdmVybGF5QnV0dG9uKCBzcGVjICkge1xyXG4gICAgICAgIHZhciB0aGF0ID0gdGhpcyxcclxuICAgICAgICAgICAgb3Blbk92ZXJsYXksXHJcbiAgICAgICAgICAgIGNsb3NlT3ZlcmxheSxcclxuICAgICAgICAgICAgdmVydGljYWwgPSBzcGVjLnZlcnRpY2FsUG9zaXRpb24udG9Mb3dlckNhc2UoKSB8fCAnYm90dG9tJyxcclxuICAgICAgICAgICAgaG9yaXpvbnRhbCA9IHNwZWMuaG9yaXpvbnRhbFBvc2l0aW9uLnRvTG93ZXJDYXNlKCkgfHwgJ3JpZ2h0JyxcclxuICAgICAgICAgICAgcXVhZHJhbnRJZCxcclxuICAgICAgICAgICAgJHF1YWRyYW50Q29udGFpbmVyO1xyXG5cclxuICAgICAgICAvLyBnZXQgcXVhZHJhbnQgaWRcclxuICAgICAgICBxdWFkcmFudElkID0gdmVydGljYWwgKyctJysgaG9yaXpvbnRhbCArJy1vdmVybGF5LXF1YWRyYW50JztcclxuXHJcbiAgICAgICAgLy8gZ2V0IHF1YWRyYW50IGVsZW1lbnRcclxuICAgICAgICAkcXVhZHJhbnRDb250YWluZXIgPSAkKCAnIycrcXVhZHJhbnRJZCApO1xyXG5cclxuICAgICAgICAvLyBpZiBkb2Vzbid0IGV4aXN0LCBjcmVhdGUgaXRcclxuICAgICAgICBpZiAoICRxdWFkcmFudENvbnRhaW5lci5sZW5ndGggPT09IDAgKSB7XHJcbiAgICAgICAgICAgICRxdWFkcmFudENvbnRhaW5lciA9ICQoJzxkaXYgaWQ9XCInK3F1YWRyYW50SWQrJ1wiPjwvZGl2PicgKTtcclxuICAgICAgICAgICAgJCgnYm9keScpLmFwcGVuZCggJHF1YWRyYW50Q29udGFpbmVyICk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmlkID0gc3BlYy5pZDtcclxuICAgICAgICB0aGlzLiRjb250YWluZXIgPSAkKCc8ZGl2IGlkPVwiJyt0aGlzLmlkKydcIiBzdHlsZT1cImZsb2F0OicrIGhvcml6b250YWwrJzsgY2xlYXI6Jytob3Jpem9udGFsKyc7XCI+PC9kaXY+JyApO1xyXG5cclxuICAgICAgICBpZiAoIHZlcnRpY2FsID09PSBcImJvdHRvbVwiICkge1xyXG4gICAgICAgICAgICAkcXVhZHJhbnRDb250YWluZXIucHJlcGVuZCggdGhpcy4kY29udGFpbmVyICk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgJHF1YWRyYW50Q29udGFpbmVyLmFwcGVuZCggdGhpcy4kY29udGFpbmVyICk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLiRjb250YWluZXIuYWRkQ2xhc3MoJ292ZXJsYXktY29udGFpbmVyJyk7XHJcblxyXG4gICAgICAgIHRoaXMuJGhlYWRlciA9ICQoJzxkaXYgaWQ9XCInICsgdGhpcy5pZCArICctaGVhZGVyXCIgY2xhc3M9XCInICt0aGlzLmlkKyAnLWhlYWRlciBvdmVybGF5LWhlYWRlclwiPicrc3BlYy5oZWFkZXIrJzwvZGl2PicpO1xyXG4gICAgICAgIHRoaXMuJGNvbnRlbnQgPSAkKCc8ZGl2IGlkPVwiJyArIHRoaXMuaWQgKyAnLWNvbnRlbnRcIiBjbGFzcz1cIicgK3RoaXMuaWQrICctY29udGVudCBvdmVybGF5LWNvbnRlbnRcIj4nK3NwZWMuY29udGVudCsnPC9kaXY+Jyk7XHJcblxyXG4gICAgICAgIHRoaXMuJGNvbnRhaW5lci5hcHBlbmQodGhpcy4kaGVhZGVyKTtcclxuICAgICAgICB0aGlzLiRjb250YWluZXIuYXBwZW5kKHRoaXMuJGNvbnRlbnQpO1xyXG5cclxuICAgICAgICBvcGVuT3ZlcmxheSA9IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgIHZhciBkZWx0YVdpZHRoLFxyXG4gICAgICAgICAgICAgICAgbWF4SGVpZ2h0ID0gZ2V0TWF4Q29udGVudEhlaWdodCgpO1xyXG5cclxuICAgICAgICAgICAgLy8gbWVhc3VyZSBlbGVtZW50cyBhbmQgY2FsYyBkZWx0YSB3aWR0aCB0byByZS1zaXplIGhlYWRlclxyXG4gICAgICAgICAgICB0aGF0LmluYWN0aXZlV2lkdGggPSB0aGF0LiRoZWFkZXIub3V0ZXJXaWR0aCgpO1xyXG4gICAgICAgICAgICB0aGF0LmFjdGl2ZVdpZHRoID0gdGhhdC4kY29udGVudC5vdXRlcldpZHRoKCk7XHJcbiAgICAgICAgICAgIGRlbHRhV2lkdGggPSB0aGF0LmFjdGl2ZVdpZHRoIC0gdGhhdC5pbmFjdGl2ZVdpZHRoO1xyXG4gICAgICAgICAgICAvLyBzZXQgb3BhY2l0eSB0byAwLCB0byBmYWRlIGluIGZyb21cclxuICAgICAgICAgICAgdGhhdC4kY29udGVudC5jaGlsZHJlbigpLmNzcygnb3BhY2l0eScsIDApO1xyXG4gICAgICAgICAgICAvLyBzZXQgYSBtYXhpbXVtIGhlaWdodFxyXG4gICAgICAgICAgICB0aGF0LiRjb250ZW50LmNzcyggJ21heC1oZWlnaHQnLCBtYXhIZWlnaHQgKTtcclxuICAgICAgICAgICAgIC8vIGRpc2FibGUgY2xpY2sgdW50aWwgYW5pbWF0aW9uIGlzIGNvbXBsZXRlXHJcbiAgICAgICAgICAgIHRoYXQuJGhlYWRlci5vZmYoJ2NsaWNrJyk7XHJcblxyXG4gICAgICAgICAgICB0aGF0LiRoZWFkZXIuYW5pbWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gb3BlbiBoZWFkZXJcclxuICAgICAgICAgICAgICAgICAgICB3aWR0aDogXCIrPVwiK2RlbHRhV2lkdGhcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29tcGxldGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBvcGVuIGNvbnRlbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRlbnRIZWlnaHQgPSBwYXJzZUludCggdGhhdC4kY29udGVudC5jc3MoJ2hlaWdodCcpLCAxMCApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC4kY29udGVudC5jaGlsZHJlbigpLmFuaW1hdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBEVVJBVElPTiApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBjb250ZW50SGVpZ2h0ID49IG1heEhlaWdodCApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNldCB0aW1lb3V0IHRvIG92ZXJyaWRlIGpxdWVyeSBzZXR0aW5nIG92ZXJmbG93IHRvIGhpZGRlbiBkdXJpbmdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFuaW1hdGlvbi4gVGhpcyBhbGxvd3MgdGhlIHNjcm9sbGJhciB0byBhcHBlYXIgaW5zdGFudGx5XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGF0LiRjb250ZW50LmNzcygnb3ZlcmZsb3cnLCcnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC4kY29udGVudC5hbmltYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogJ3RvZ2dsZSdcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcGxldGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJlLWVuYWJsZSBjbGljaywgYnV0IHN3aXRjaCB0byBjbG9zZSBjYWxsYmFja1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuJGhlYWRlci5jbGljayggY2xvc2VPdmVybGF5ICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IERVUkFUSU9OXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IERVUkFUSU9OXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBjbG9zZU92ZXJsYXkgPSBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgIHZhciBkZWx0YVdpZHRoID0gdGhhdC5hY3RpdmVXaWR0aCAtIHRoYXQuaW5hY3RpdmVXaWR0aCxcclxuICAgICAgICAgICAgICAgIGNvbnRlbnRIZWlnaHQgPSBwYXJzZUludCggdGhhdC4kY29udGVudC5jc3MoJ2hlaWdodCcpLCAxMCApLFxyXG4gICAgICAgICAgICAgICAgbWF4SGVpZ2h0ID0gZ2V0TWF4Q29udGVudEhlaWdodCgpO1xyXG5cclxuICAgICAgICAgICAgLy8gZGlzYWJsZSBjbGljayB1bnRpbCBhbmltYXRpb24gaXMgY29tcGxldGVcclxuICAgICAgICAgICAgdGhhdC4kaGVhZGVyLm9mZignY2xpY2snKTtcclxuICAgICAgICAgICAgdGhhdC4kY29udGVudC5jaGlsZHJlbigpLmNzcygnb3BhY2l0eScsIDEpO1xyXG4gICAgICAgICAgICB0aGF0LiRjb250ZW50LmNoaWxkcmVuKCkuYW5pbWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBvcGFjaXR5OiAwXHJcbiAgICAgICAgICAgIH0sIERVUkFUSU9OICk7XHJcblxyXG4gICAgICAgICAgICBpZiAoIGNvbnRlbnRIZWlnaHQgPj0gbWF4SGVpZ2h0ICkge1xyXG4gICAgICAgICAgICAgICAgLy8gc2V0IHRpbWVvdXQgdG8gb3ZlcnJpZGUganF1ZXJ5IHNldHRpbmcgb3ZlcmZsb3cgdG8gaGlkZGVuIGR1cmluZ1xyXG4gICAgICAgICAgICAgICAgLy8gYW5pbWF0aW9uLiBUaGlzIGFsbG93cyB0aGUgc2Nyb2xsYmFyIHRvIGFwcGVhciBpbnN0YW50bHlcclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoYXQuJGNvbnRlbnQuY3NzKCdvdmVyZmxvdycsJycpO1xyXG4gICAgICAgICAgICAgICAgfSwgMSApO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGF0LiRjb250ZW50LmFuaW1hdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodDogJ3RvZ2dsZSdcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29tcGxldGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGF0LiRoZWFkZXIuYW5pbWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IFwiLT1cIitkZWx0YVdpZHRoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyByZS1lbmFibGUgY2xpY2ssIGJ1dCBzd2l0Y2ggdG8gb3BlbiBjYWxsYmFja1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuJGhlYWRlci5jbGljayggb3Blbk92ZXJsYXkgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogRFVSQVRJT05cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogRFVSQVRJT05cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMuJGhlYWRlci5jbGljayggb3Blbk92ZXJsYXkgKTtcclxuXHJcbiAgICAgICAgLy8gYmVnaW4gd2l0aCBjb250ZW50IGNsb3NlZCwgc2tpcCBhbmltYXRpb247XHJcbiAgICAgICAgdGhpcy4kY29udGVudC5hbmltYXRlKHtoZWlnaHQ6ICd0b2dnbGUnfSk7XHJcbiAgICAgICAgdGhpcy4kY29udGVudC5maW5pc2goKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdGhlIGhlYWRlciBET00gZWxlbWVudC5cclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJucyB7alF1ZXJ5fEhUTUxFbGVtZW50fVxyXG4gICAgICovXHJcbiAgICBPdmVybGF5QnV0dG9uLnByb3RvdHlwZS5nZXRIZWFkZXJFbGVtZW50ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuJGhlYWRlcjtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRoZSBjb250ZW50IERPTSBlbGVtZW50LlxyXG4gICAgICpcclxuICAgICAqIEByZXR1cm5zIHtqUXVlcnl8SFRNTEVsZW1lbnR9XHJcbiAgICAgKi9cclxuICAgIE92ZXJsYXlCdXR0b24ucHJvdG90eXBlLmdldENvbnRlbnRFbGVtZW50ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuJGNvbnRlbnQ7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0aGUgY29udGFpbmVyIERPTSBlbGVtZW50LlxyXG4gICAgICpcclxuICAgICAqIEByZXR1cm5zIHtqUXVlcnl8SFRNTEVsZW1lbnR9XHJcbiAgICAgKi9cclxuICAgIE92ZXJsYXlCdXR0b24ucHJvdG90eXBlZ2V0Q29udGFpbmVyRWxlbWVudCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLiRjb250YWluZXI7XHJcbiAgICB9O1xyXG5cclxuICAgIG1vZHVsZS5leHBvcnRzID0gT3ZlcmxheUJ1dHRvbjtcclxufSgpKTtcclxuIiwiLyoqXHJcbiAqIENvcHlyaWdodCAoYykgMjAxNCBPY3VsdXMgSW5mbyBJbmMuXHJcbiAqIGh0dHA6Ly93d3cub2N1bHVzaW5mby5jb20vXHJcbiAqXHJcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuICpcclxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weSBvZlxyXG4gKiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluXHJcbiAqIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG9cclxuICogdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXNcclxuICogb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvXHJcbiAqIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcclxuXHJcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbFxyXG4gKiBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxyXG5cclxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxyXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXHJcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcclxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEVcclxuICogU09GVFdBUkUuXHJcbiAqL1xyXG5cclxuLyoqXHJcbiAgICBBIGhpZXJhcmNoaWNhbCBwdWJsaXNoIGFuZCBzdWJzY3JpYmUgb2JqZWN0LiBDaGFubmVscyBjb25zaXN0IG9mIHN0cmluZ3MsIHN1Yi1jaGFubmVsc1xyXG4gICAgYXJlIHNlcGFyYXRlZCB3aXRoIGEgcGVyaW9kICgnLicpLiBQdWJsaXNoaW5nIHRvIGEgdGFyZ2V0IGNoYW5uZWwgd2lsbCBwcm9wYWdhdGUgdGhlIG1lc3NhZ2VcclxuICAgIGJyZWFkdGggZmlyc3QgYXMgZm9sbG93czpcclxuICAgICAgICAxKSBmcm9tIHRoZSByb290IG9mIHRoZSBoaWVyYXJjaHkgdG8gdGhlIHRhcmdldCBjaGFubmVsLFxyXG4gICAgICAgIDIpIGZyb20gdGhlIHRhcmdldCBjaGFubmVsIHRvIGFsbCBleGlzdGluZyBzdWItY2hhbm5lbHNcclxuXHJcbiAgICBFeC5cclxuXHJcbiAgICAgICAgSGllcmFyY2h5OlxyXG5cclxuICAgICAgICAgICAgYSAtPiBbIGEuYSwgYS5hYiBdIC0+IFsgYS5hLmEsIGEuYS5iLCBhLmEuYyBdXHJcblxyXG4gICAgICAgIFB1Ymxpc2hpbmcgdG8gYS5hIHdpbGwgcHVibGlzaDpcclxuXHJcbiAgICAgICAgICAgIDEpIGZyb20gcm9vdCB0byB0YXJnZXRcclxuXHJcbiAgICAgICAgICAgICAgICBbIGEgLT4gYS5hIClcclxuXHJcbiAgICAgICAgICAgIDIpIGZyb20gdGFyZ2V0IHRvIGFsbCBzdWItY2hhbm5lbHNcclxuXHJcbiAgICAgICAgICAgICAgICBbIGEuYSAtPiBhLmEuYSAtPiBhLmEuYiAtPiBhLmEuYyApXHJcblxyXG4gICAgICAgIFB1Ymxpc2hpbmcgdG8gYS5hLmMgd2lsbCBwdWJsaXNoOlxyXG5cclxuICAgICAgICAgICAgMSkgZnJvbSByb290IHRvIHRhcmdldFxyXG5cclxuICAgICAgICAgICAgICAgIFsgYSAtPiBhLmEgLT4gYS5hLmMgKVxyXG5cclxuICAgICAgICAgICAgMikgZnJvbSB0YXJnZXQgdG8gYWxsIHN1Yi1jaGFubmVsc1xyXG5cclxuICAgICAgICAgICAgICAgIFsgYS5hLmMgLT4gbnVsbCApXHJcbiovXHJcblxyXG4oIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIG1vZHVsZS5leHBvcnRzID0ge1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBTdWJzY3JpYmUgYSBsaXN0ZW5lciBmdW5jdGlvbiB0byB0aGUgc3BlY2lmaWMgY2hhbm5lbCBwYXRoLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIGNoYW5uZWxQYXRoIHtzdHJpbmd9ICAgQSAnLicgZGVsaW1pdGVkIGNoYW5uZWwgcGF0aC5cclxuICAgICAgICAgKiBAcGFyYW0gc3Vic2NyaWJlciAge0Z1bmN0aW9ufSBUaGUgc3Vic2NyaWJlciBmdW5jdGlvbiBhc3NvY2lhdGVkIHdpdGggdGhlIHByb3ZpZGVkIHBhdGguXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc3Vic2NyaWJlOiBmdW5jdGlvbiggY2hhbm5lbFBhdGgsIHN1YnNjcmliZXIgKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgcGF0aHMgPSBjaGFubmVsUGF0aC5zcGxpdCgnLicpLFxyXG4gICAgICAgICAgICAgICAgcGF0aCxcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRQYXRoID0gJycsXHJcbiAgICAgICAgICAgICAgICBjaGFubmVsO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jaGFubmVscyA9IHRoaXMuY2hhbm5lbHMgfHwge1xyXG4gICAgICAgICAgICAgICAgc3Vic2NyaWJlcnMgOiBbXSxcclxuICAgICAgICAgICAgICAgIGNoaWxkcmVuIDoge31cclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGNoYW5uZWwgPSB0aGlzLmNoYW5uZWxzO1xyXG5cclxuICAgICAgICAgICAgd2hpbGUgKCBwYXRocy5sZW5ndGggPiAwICkge1xyXG4gICAgICAgICAgICAgICAgcGF0aCA9IHBhdGhzLnNoaWZ0KCk7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50UGF0aCArPSAoIGN1cnJlbnRQYXRoLmxlbmd0aCA+IDAgKSA/ICcuJyArIHBhdGggOiBwYXRoO1xyXG4gICAgICAgICAgICAgICAgY2hhbm5lbC5jaGlsZHJlblsgcGF0aCBdID0gY2hhbm5lbC5jaGlsZHJlblsgcGF0aCBdIHx8IHtcclxuICAgICAgICAgICAgICAgICAgICBwYXRoIDogY3VycmVudFBhdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgc3Vic2NyaWJlcnMgOiBbXSxcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbiA6IHt9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgY2hhbm5lbCA9IGNoYW5uZWwuY2hpbGRyZW5bIHBhdGggXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjaGFubmVsLnN1YnNjcmliZXJzLnB1c2goIHN1YnNjcmliZXIgKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBQdWJsaXNoIGEgbWVzc2FnZSB0byBhIGNoYW5uZWwgcGF0aC4gUHVibGlzaGluZyB0byBhIHRhcmdldCBjaGFubmVsIHdpbGwgcHJvcGFnYXRlIHRoZSBtZXNzYWdlXHJcbiAgICAgICAgICogICBicmVhZHRoIGZpcnN0IGFzIGZvbGxvd3M6XHJcbiAgICAgICAgICogICAgICAxKSBmcm9tIHRoZSByb290IG9mIHRoZSBoaWVyYXJjaHkgdG8gdGhlIHRhcmdldCBjaGFubmVsXHJcbiAgICAgICAgICogICAgICAyKSBmcm9tIHRoZSB0YXJnZXQgY2hhbm5lbCB0byBhbGwgZXhpc3Rpbmcgc3ViLWNoYW5uZWxzXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gY2hhbm5lbFBhdGgge3N0cmluZ30gICBBICcuJyBkZWxpbWl0ZWQgY2hhbm5lbCBwYXRoLlxyXG4gICAgICAgICAqIEBwYXJhbSBtZXNzYWdlICB7Kn0gICAgICAgVGhlIG1lc3NzYWdlIHRvIGJlIHB1Ymxpc2hlZC5cclxuICAgICAgICAgKi9cclxuICAgICAgICBwdWJsaXNoOiBmdW5jdGlvbiggY2hhbm5lbFBhdGgsIG1lc3NhZ2UgKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgcGF0aHMgPSBjaGFubmVsUGF0aC5zcGxpdCgnLicpLFxyXG4gICAgICAgICAgICAgICAgY2hpbGRyZW4sXHJcbiAgICAgICAgICAgICAgICBzdWJzY3JpYmVycyxcclxuICAgICAgICAgICAgICAgIHF1ZXVlID0gW10sXHJcbiAgICAgICAgICAgICAgICBwYXRoLCBpLCBzdWIsXHJcbiAgICAgICAgICAgICAgICBsZWFmQ2hhbm5lbCxcclxuICAgICAgICAgICAgICAgIGNoYW5uZWwgPSB0aGlzLmNoYW5uZWxzIHx8IHtcclxuICAgICAgICAgICAgICAgICAgICBzdWJzY3JpYmVycyA6IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuIDoge31cclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAvLyBmaW5kIGNoYW5uZWxcclxuICAgICAgICAgICAgd2hpbGUgKCBwYXRocy5sZW5ndGggPiAwICkge1xyXG4gICAgICAgICAgICAgICAgcGF0aCA9IHBhdGhzLnNoaWZ0KCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIGNoYW5uZWwuY2hpbGRyZW5bIHBhdGggXSA9PT0gdW5kZWZpbmVkICkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNoYW5uZWwgPSBjaGFubmVsLmNoaWxkcmVuWyBwYXRoIF07XHJcbiAgICAgICAgICAgICAgICBxdWV1ZS5wdXNoKCBjaGFubmVsICk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGxlYWZDaGFubmVsID0gcXVldWUucG9wKCk7XHJcblxyXG4gICAgICAgICAgICAvLyBicmVhZHRoIGZpcnN0IHB1Ymxpc2hpbmcgZnJvbSByb290IHRvIHRhcmdldFxyXG4gICAgICAgICAgICB3aGlsZSAoIHF1ZXVlLmxlbmd0aCA+IDAgKSB7XHJcbiAgICAgICAgICAgICAgICBjaGFubmVsID0gcXVldWUuc2hpZnQoKTtcclxuICAgICAgICAgICAgICAgIHN1YnNjcmliZXJzID0gY2hhbm5lbC5zdWJzY3JpYmVycztcclxuICAgICAgICAgICAgICAgIC8vIHB1Ymxpc2ggdG8gY3VycmVudCBjaGFubmVsXHJcbiAgICAgICAgICAgICAgICBmb3IgKCBpPTA7IGk8c3Vic2NyaWJlcnMubGVuZ3RoOyBpKysgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3Vic2NyaWJlcnNbaV0oIG1lc3NhZ2UsIGNoYW5uZWxQYXRoICk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHF1ZXVlID0gWyBsZWFmQ2hhbm5lbCBdO1xyXG5cclxuICAgICAgICAgICAgLy8gYnJlYWR0aCBmaXJzdCBwdWJsaXNoaW5nIGZyb20gdGFyZ2V0IHRvIGFsbCBjaGlsZHJlblxyXG4gICAgICAgICAgICB3aGlsZSAoIHF1ZXVlLmxlbmd0aCA+IDAgKSB7XHJcbiAgICAgICAgICAgICAgICBjaGFubmVsID0gcXVldWUuc2hpZnQoKTtcclxuICAgICAgICAgICAgICAgIHN1YnNjcmliZXJzID0gY2hhbm5lbC5zdWJzY3JpYmVycztcclxuICAgICAgICAgICAgICAgIGNoaWxkcmVuID0gY2hhbm5lbC5jaGlsZHJlbjtcclxuICAgICAgICAgICAgICAgIC8vIHB1Ymxpc2ggdG8gY3VycmVudCBjaGFubmVsXHJcbiAgICAgICAgICAgICAgICBmb3IgKCBpPTA7IGk8c3Vic2NyaWJlcnMubGVuZ3RoOyBpKysgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3Vic2NyaWJlcnNbaV0oIG1lc3NhZ2UsIGNoYW5uZWxQYXRoICk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBxdWV1ZSB1cCBjaGlsZHJlbiBmb3IgbGVhZiBjaGFubmVsXHJcbiAgICAgICAgICAgICAgICBmb3IgKCBzdWIgaW4gY2hpbGRyZW4gKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCBjaGlsZHJlbi5oYXNPd25Qcm9wZXJ0eSggc3ViICkgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXVlLnB1c2goIGNoaWxkcmVuWyBzdWIgXSApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn0oKSk7XHJcbiIsIi8qXHJcbiAqIENvcHlyaWdodCAoYykgMjAxNCBPY3VsdXMgSW5mbyBJbmMuXHJcbiAqIGh0dHA6Ly93d3cub2N1bHVzaW5mby5jb20vXHJcbiAqXHJcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuICpcclxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weSBvZlxyXG4gKiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluXHJcbiAqIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG9cclxuICogdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXNcclxuICogb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvXHJcbiAqIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcclxuXHJcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbFxyXG4gKiBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxyXG5cclxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxyXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXHJcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcclxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEVcclxuICogU09GVFdBUkUuXHJcbiAqL1xyXG5cclxuKCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICB2YXIgJCA9IHJlcXVpcmUoJ2pxdWVyeScpLFxyXG4gICAgICAgIHByb3BhZ2F0ZUV2ZW50O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUHJpdmF0ZTogQSBwcm9wYWdhdGlvbiBoYW5kbGVyIHRoYXQgd2lsbCB0ZW1wb3JhcmlseSBkZS1hY3RpdmF0ZSB0aGVcclxuICAgICAqIERPTSBlbGVtZW50IGFuZCBwcm9wYWdhdGUgdGhlIGV2ZW50IHRocm91Z2ggdG8gYW55IHVuZGVybHlpbmcgZWxlbWVudC5cclxuICAgICAqIEBwYXJhbSBldmVudCB7RXZlbnR9IFRoZSBldmVudCBvYmplY3QuXHJcbiAgICAgKi9cclxuICAgIHByb3BhZ2F0ZUV2ZW50ID0gZnVuY3Rpb24oIGV2ZW50ICkge1xyXG4gICAgICAgIHZhciBuZXdFdmVudCA9IG5ldyBldmVudC5jb25zdHJ1Y3RvciggZXZlbnQudHlwZSwgZXZlbnQgKSxcclxuICAgICAgICAgICAgZWxlbWVudCxcclxuICAgICAgICAgICAgYmVmb3JlLFxyXG4gICAgICAgICAgICBiZWxvdztcclxuICAgICAgICBlbGVtZW50ID0gZXZlbnQuY3VycmVudFRhcmdldDtcclxuICAgICAgICBiZWZvcmUgPSBlbGVtZW50LnN0eWxlWydwb2ludGVyLWV2ZW50cyddO1xyXG4gICAgICAgIGVsZW1lbnQuc3R5bGVbJ3BvaW50ZXItZXZlbnRzJ10gPSAnbm9uZSc7XHJcbiAgICAgICAgYmVsb3cgPSBkb2N1bWVudC5lbGVtZW50RnJvbVBvaW50KCBldmVudC5jbGllbnRYLCBldmVudC5jbGllbnRZICk7XHJcbiAgICAgICAgaWYgKCBiZWxvdyApIHtcclxuICAgICAgICAgICAgYmVsb3cuZGlzcGF0Y2hFdmVudCggbmV3RXZlbnQgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxlbWVudC5zdHlsZVsncG9pbnRlci1ldmVudHMnXSA9IGJlZm9yZTtcclxuICAgIH07XHJcblxyXG4gICAgbW9kdWxlLmV4cG9ydHMgPSB7XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEdlbmVyYXRlcyBhbiBSRkM0MTIyIHZlcnNpb24gNCBjb21wbGlhbnQgVVVJRCBzdHJpbmcuXHJcbiAgICAgICAgICogQHJldHVybnMge3N0cmluZ31cclxuICAgICAgICAgKi9cclxuICAgICAgICBnZW5lcmF0ZVV1aWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJ3h4eHh4eHh4LXh4eHgtNHh4eC15eHh4LXh4eHh4eHh4eHh4eCcucmVwbGFjZSgvW3h5XS9nLCBmdW5jdGlvbihjKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgciA9IE1hdGgucmFuZG9tKCkqMTZ8MCwgdiA9IChjID09PSAneCcpID8gciA6IChyJjB4M3wweDgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHYudG9TdHJpbmcoMTYpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBbGxvd3MgdGhlIGdpdmVuIERPTSBlbGVtZW50IG9yIGpRdWVyeSBvYmplY3QgZXZlbnRzIHRvIHByb3BhZ2F0ZSB0aHJvdWdoXHJcbiAgICAgICAgICogYW5kIGludGVyYWN0IHdpdGggdW5kZXJseWluZyBlbGVtZW50c1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIGVsZW0gICAgIHtIVE1MRWxlbWVudCB8IGpRdWVyeX0gVGhlIERPTSBlbGVtZW50LlxyXG4gICAgICAgICAqIEBwYXJhbSBbZXZlbnRzXSB7QXJyYXl9ICAgICAgICAgICAgICAgICBBcnJheSBvZiBldmVudHMgdG8gcHJvcGFnYXRlIHRocm91Z2ggKG9wdGlvbmFsKS5cclxuICAgICAgICAgKi9cclxuICAgICAgICBlbmFibGVFdmVudFByb3BhZ2F0aW9uOiBmdW5jdGlvbiggZWxlbSwgZXZlbnRzICkge1xyXG5cclxuICAgICAgICAgICAgdmFyIGRvbUVsZW1lbnQgPSAoIGVsZW0gaW5zdGFuY2VvZiAkICkgPyBlbGVtWzBdIDogZWxlbSxcclxuICAgICAgICAgICAgICAgIGk7XHJcblxyXG4gICAgICAgICAgICBpZiAoICFldmVudHMgKSB7XHJcbiAgICAgICAgICAgICAgICBkb21FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoICdtb3VzZWRvd24nLCBwcm9wYWdhdGVFdmVudCApO1xyXG4gICAgICAgICAgICAgICAgZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCAnbW91c2V1cCcsIHByb3BhZ2F0ZUV2ZW50ICk7XHJcbiAgICAgICAgICAgICAgICBkb21FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoICdtb3VzZW1vdmUnLCBwcm9wYWdhdGVFdmVudCApO1xyXG4gICAgICAgICAgICAgICAgZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCAnd2hlZWwnLCBwcm9wYWdhdGVFdmVudCApO1xyXG4gICAgICAgICAgICAgICAgZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCAnc2Nyb2xsJywgcHJvcGFnYXRlRXZlbnQgKTtcclxuICAgICAgICAgICAgICAgIGRvbUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ2NsaWNrJywgcHJvcGFnYXRlRXZlbnQgKTtcclxuICAgICAgICAgICAgICAgIGRvbUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ2RibGNsaWNrJywgcHJvcGFnYXRlRXZlbnQgKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGV2ZW50cyA9ICggZXZlbnRzIGluc3RhbmNlb2YgQXJyYXkgKSA/IGV2ZW50cyA6IFtldmVudHNdO1xyXG4gICAgICAgICAgICAgICAgZm9yICggaT0wOyBpPGV2ZW50cy5sZW5ndGg7IGkrKyApIHtcclxuICAgICAgICAgICAgICAgICAgICBkb21FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoIGV2ZW50c1tpXSwgcHJvcGFnYXRlRXZlbnQgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFJlbW92ZXMgcHJldmlvdXNseSBlbmFibGVkIGV2ZW50IHByb3BhZ2F0aW9uLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIGVsZW0gICAgIHtIVE1MRWxlbWVudCB8IGpRdWVyeX0gVGhlIERPTSBlbGVtZW50LlxyXG4gICAgICAgICAqIEBwYXJhbSBbZXZlbnRzXSB7QXJyYXl9ICAgICAgICAgICAgICAgQXJyYXkgb2YgZXZlbnRzIHRvIHJlbW92ZSAob3B0aW9uYWwpLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGRpc2FibGVFdmVudFByb3BhZ2F0aW9uOiBmdW5jdGlvbiggZWxlbSwgZXZlbnRzICkge1xyXG5cclxuICAgICAgICAgICAgdmFyIGRvbUVsZW1lbnQgPSAoIGVsZW0gaW5zdGFuY2VvZiAkICkgPyBlbGVtWzBdIDogZWxlbSxcclxuICAgICAgICAgICAgICAgIGk7XHJcbiAgICAgICAgICAgIGlmICggIWV2ZW50cyApIHtcclxuICAgICAgICAgICAgICAgIGRvbUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ21vdXNlZG93bicsIHByb3BhZ2F0ZUV2ZW50ICk7XHJcbiAgICAgICAgICAgICAgICBkb21FbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoICdtb3VzZXVwJywgcHJvcGFnYXRlRXZlbnQgKTtcclxuICAgICAgICAgICAgICAgIGRvbUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ21vdXNlbW92ZScsIHByb3BhZ2F0ZUV2ZW50ICk7XHJcbiAgICAgICAgICAgICAgICBkb21FbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoICd3aGVlbCcsIHByb3BhZ2F0ZUV2ZW50ICk7XHJcbiAgICAgICAgICAgICAgICBkb21FbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoICdzY3JvbGwnLCBwcm9wYWdhdGVFdmVudCApO1xyXG4gICAgICAgICAgICAgICAgZG9tRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAnY2xpY2snLCBwcm9wYWdhdGVFdmVudCApO1xyXG4gICAgICAgICAgICAgICAgZG9tRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAnZGJsY2xpY2snLCBwcm9wYWdhdGVFdmVudCApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZXZlbnRzID0gKCBldmVudHMgaW5zdGFuY2VvZiBBcnJheSApID8gZXZlbnRzIDogW2V2ZW50c107XHJcbiAgICAgICAgICAgICAgICBmb3IgKCBpPTA7IGk8ZXZlbnRzLmxlbmd0aDsgaSsrICkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRvbUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggZXZlbnRzW2ldLCBwcm9wYWdhdGVFdmVudCApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogUmV0dXJucyBhIHByb3BlciBtb2R1bG8gYXMgdGhlICUgb3BlcmF0b3IgaW4gamF2YXNjcmlwdCBpcyB0aGUgJ3JlbWFpbmRlcicgb3BlcmF0b3IuXHJcbiAgICAgICAgICogQHBhcmFtIHZhbHVlIHtudW1iZXJ9IHRoZSB2YWx1ZVxyXG4gICAgICAgICAqIEBwYXJhbSBuICAgICB7bnVtYmVyfSB0aGUgZGl2aXNvclxyXG4gICAgICAgICAqIEByZXR1cm5zIHtudW1iZXJ9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgbW9kOiBmdW5jdGlvbiggdmFsdWUsIG4gKSB7XHJcbiAgICAgICAgICAgcmV0dXJuICggKHZhbHVlICUgbikgKyBuKSAlIG47XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogUm91bmRzIGEgZ2l2ZW4gdmFsdWUgdG8gYSBzZXQgbnVtYmVyIG9mIGRlY2ltYWxzLiBEZWZhdWx0cyB0byAyLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIHZhbHVlICAgIHtudW1iZXJ9IHZhbHVlIHRvIHJvdW5kXHJcbiAgICAgICAgICogQHBhcmFtIGRlY2ltYWxzIHtpbnR9ICAgIG51bWJlciBvZiBkZWNpbWFsc1xyXG4gICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IHJvdW5kZWQgdmFsdWVcclxuICAgICAgICAgKi9cclxuICAgICAgICByb3VuZFRvRGVjaW1hbHM6IGZ1bmN0aW9uKCB2YWx1ZSwgZGVjaW1hbHMgKSB7XHJcbiAgICAgICAgICAgIHZhciBudW1EZWMgPSBkZWNpbWFscyB8fCAyLFxyXG4gICAgICAgICAgICAgICAgcG93MTAgPSBNYXRoLnBvdyggMTAsIG51bURlYyApO1xyXG4gICAgICAgICAgICByZXR1cm4gcGFyc2VGbG9hdCggTWF0aC5yb3VuZCggdmFsdWUgKiBwb3cxMCApIC8gcG93MTAgKS50b0ZpeGVkKCBkZWNpbWFscyApO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFJlZ2lzdGVycyBhIGNsaWNrIGhhbmRsZXIgdGhhdCBvbmx5IGZpcmVzIGlmIHRoZSBjbGljayBkaWRuJ3RcclxuICAgICAgICAgKiBpbnZvbHZlIGEgbWFwIGRyYWcuIFNpbmNlIHRoZSBtYXAgaXMgbW92aW5nIHVuZGVyIHRoZSBtb3VzZSBjdXJzb3JcclxuICAgICAgICAgKiB0aGUgYnJvd3NlciB3aWxsIHN0aWxsIHJlZ2lzdGVyIGEgY2xpY2sgZGVzcGl0ZSBtb3VzZSBtb3ZlbWVudC4gVGhpc1xyXG4gICAgICAgICAqIGd1YXJkcyBhZ2FpbnN0IHRoYXQuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gZWxlbWVudCAgICAge0hUTUxFbGVtZW50fSBUaGUgRE9NIGVsZW1lbnQgdG8gYXR0YWNoIHRoZSBldmVudC5cclxuICAgICAgICAgKiBAcGFyYW0gY2FsbGJhY2sgICAge0Z1bmN0aW9ufSAgICBUaGUgY2FsbGJhY2sgZnVuY3Rpb24uXHJcbiAgICAgICAgICogQHBhcmFtIFt0aHJlc2hvbGRdIHtpbnR9ICAgICAgICAgVGhlIG1vdmVtZW50IHRocmVzaG9sZCAob3B0aW9uYWwpLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGRyYWdTZW5zaXRpdmVDbGljayA6IGZ1bmN0aW9uKCBlbGVtZW50LCBjYWxsYmFjaywgdGhyZXNob2xkICkge1xyXG4gICAgICAgICAgICB2YXIgZHJhZ1N0YXJ0ID0ge3g6IG51bGwsIHk6IG51bGx9O1xyXG5cclxuICAgICAgICAgICAgdGhyZXNob2xkID0gdGhyZXNob2xkIHx8IDEwO1xyXG5cclxuICAgICAgICAgICAgZWxlbWVudC5vbm1vdXNlZG93biA9IGZ1bmN0aW9uKCBldnQgKSB7XHJcbiAgICAgICAgICAgICAgICBkcmFnU3RhcnQueCA9IGV2dC5wYWdlWDtcclxuICAgICAgICAgICAgICAgIGRyYWdTdGFydC55ID0gZXZ0LnBhZ2VZO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgZWxlbWVudC5vbmNsaWNrID0gZnVuY3Rpb24oIGV2dCApIHtcclxuICAgICAgICAgICAgICAgIGlmIChNYXRoLmFicyggZHJhZ1N0YXJ0LnggLSBldnQucGFnZVggKSA8IHRocmVzaG9sZCAmJlxyXG4gICAgICAgICAgICAgICAgICAgIE1hdGguYWJzKCBkcmFnU3RhcnQueSAtIGV2dC5wYWdlWSApIDwgdGhyZXNob2xkICkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLmNhbGwoIHRoaXMsIGV2dCApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFJldHVybiBhbiBvYmplY3QgY29udGFpbmluZyBhbGwgcGFyYW1ldGVycyBhbmQgdmFsdWVzIGluIHRoZSBjdXJyZW50XHJcbiAgICAgICAgICogVVJMLlxyXG4gICAgICAgICAqIEByZXR1cm5zIHtPYmplY3R9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0VVJMUGFyYW1ldGVyczogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciB1cmwgPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoLnN1YnN0cmluZygxKSxcclxuICAgICAgICAgICAgICAgIHVybFZhcnMgPSB1cmwuc3BsaXQoJyYnKSxcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHt9LFxyXG4gICAgICAgICAgICAgICAga2V5VmFsdWUsXHJcbiAgICAgICAgICAgICAgICBpO1xyXG4gICAgICAgICAgICBmb3IgIChpPTA7IGk8dXJsVmFycy5sZW5ndGg7ICsraSApIHtcclxuICAgICAgICAgICAgICAgIGtleVZhbHVlID0gdXJsVmFyc1tpXS5zcGxpdCgnPScpO1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0WyBrZXlWYWx1ZVswXSBdID0ga2V5VmFsdWVbMV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBSZXR1cm4gdGhlIHZhbHVlIG9mIGEgc3BlY2lmaWMgcGFyYW1ldGVycyBpbiB0aGUgY3VycmVudCBVUkwuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0ga2V5IHtzdHJpbmd9IFRoZSB1cmwgcGFyYW1ldGVyIGtleS5cclxuICAgICAgICAgKiBAcmV0dXJucyB7c3RyaW5nfVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldFVSTFBhcmFtZXRlcjogZnVuY3Rpb24oIGtleSApIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VVJMUGFyYW1ldGVycygpWyBrZXkgXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfTtcclxufSgpKTtcclxuIl19
